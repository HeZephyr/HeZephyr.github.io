[{"categories":null,"content":" /** * å†™åšå®¢çš„åˆè¡·ä¸æ˜¯ä¸ºäº†ç‚«è€€æ‰€çŸ¥ï¼Œè€Œæ˜¯è®°å½•æ— çŸ¥ã€‚ * äººçŸ¥é“å¾—è¶Šå¤šï¼Œå°±ä¼šå‘ç°è‡ªå·±çš„æ— çŸ¥ä¹Ÿè¶Šå¤šã€‚æœ‰æ›´å¹¿é˜”çš„ä¸–ç•Œå¯ä»¥æ¢ç´¢ï¼Œè¿™æ˜¯ä¸€ç§è«å¤§çš„å¿«ä¹ï¼ * åœ¨è¿™ä¸ªä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼ŒçŸ¥è¯†çš„è·å–å˜å¾—å‰æ‰€æœªæœ‰çš„ä¾¿æ·ã€‚ * ç„¶è€Œï¼ŒçœŸæ­£æœ‰ä»·å€¼çš„çŸ¥è¯†å¹¶ä¸æ˜¯æµ…å°è¾„æ­¢çš„ç‰‡æ®µï¼Œè€Œæ˜¯ç»è¿‡æ·±æ€ç†Ÿè™‘å’Œå®è·µéªŒè¯çš„ç»“æ™¶ã€‚ * å†™åšå®¢çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä¸€ä¸ªä¸æ–­åæ€å’Œæ€»ç»“çš„è¿‡ç¨‹ï¼Œè®©æˆ‘ä»¬åœ¨æµ©ç€šçš„çŸ¥è¯†æµ·æ´‹ä¸­æ‰¾åˆ°è‡ªå·±çš„èˆªå‘ã€‚ * @since 2020-06-10 15:42:02 */ #include \u003ciostream\u003e int main() { std::cout \u003c\u003c \"Hello, World!\\n\" \u003c\u003c std::endl; return 0; } ","date":"2024-08-30","objectID":"/about/:0:0","tags":null,"title":"å…³äº","uri":"/about/"},{"categories":null,"content":"1 å…³äºåšå®¢ å†™åšå®¢çš„åˆè¡·ä¸æ˜¯ä¸ºäº†ç‚«è€€æ‰€çŸ¥ï¼Œè€Œæ˜¯ä¸ºäº†è®°å½•æ— çŸ¥ã€‚ åšå®¢å†…å®¹ä¸»è¦æ˜¯ä»¥ç³»ç»Ÿæ¶æ„ã€åç«¯å¼€å‘ä¸ºä¸»ï¼Œåˆ†äº«ä¸€äº›å­¦ä¹ ç¬”è®°ã€æŠ€å·§ã€å¼€å‘æ•™ç¨‹ç­‰ç­‰ã€‚å¦‚æœä½ å¯¹æˆ‘çš„åšå®¢å†…å®¹æ„Ÿå…´è¶£æˆ–è€…æœ‰ä»»ä½•å»ºè®®ï¼Œæ¬¢è¿ä¸æˆ‘ä¸€èµ·è®¨è®ºï¼Œå…±åŒè¿›æ­¥ã€‚ä¹Ÿæ¬¢è¿å…³æ³¨æˆ‘çš„githubã€‚ æˆ–è€…é€šè¿‡ä»¥ä¸‹æ–¹å¼å…³æ³¨æˆ‘çš„åšå®¢ã€‚ RSS CSDN ","date":"2024-08-30","objectID":"/about/:1:0","tags":null,"title":"å…³äº","uri":"/about/"},{"categories":null,"content":"2 å…³äºæˆ‘ å‘ä¸Šè€Œç”Ÿï¼Œå‘å–„è€Œè¡Œï¼Œå‘å¿ƒè€Œæš– ğŸ‘¨â€ğŸ’» ä¸€ååœ¨è¯»ç¡•å£«ç ”ç©¶ç”Ÿï¼Œå¯¹åˆ†å¸ƒå¼ç³»ç»Ÿæœ‰ç€æµ“åšçš„å…´è¶£ ğŸ‘¨â€ğŸ’¼ ENFPï¼Œå¯¹æ–°é²œäº‹ç‰©å……æ»¡çƒ­æƒ…ï¼Œæ•¢äºå®è·µï¼Œæ€»æ˜¯å¯»æ‰¾æœºä¼šå°†åˆ›æ–°çš„æƒ³æ³•è½¬åŒ–ä¸ºå®é™…åº”ç”¨ã€‚ ğŸ“ æˆ‘ç»å¸¸åœ¨CSDNä¸Šæ’°å†™æ–‡ç«  ","date":"2024-08-30","objectID":"/about/:2:0","tags":null,"title":"å…³äº","uri":"/about/"},{"categories":null,"content":"3 Sponsor æ„Ÿè°¢å¤§å®¶çš„æ”¯æŒ ğŸ™ ç»™åšä¸»ä¹°æ¯å¡å¸ƒå¥‡è¯ºï½ èµèµ æ”¯ä»˜å® å¾®ä¿¡ æ€»è®¡ Â¥50.00 å•ç¬”æœ€å¤§ francs çš„ Â¥50.00 francs Â¥50.00 francs é€šè¿‡ æ”¯ä»˜å® æ‰“èµäº† Â¥50.00 å¤‡æ³¨ï¼šå¤§å­¦ç”Ÿæ—¶æœŸï¼Œç¬¬ä¸€æ¬¡æ”¶åˆ°åˆ«äººçš„æ”¯æŒï¼Œå†…å¿ƒè¡¨ç¤ºå—å® è‹¥æƒŠåˆéå¸¸å¼€å¿ƒã€‚éå¸¸æ„Ÿè°¢è€å“¥çš„æ”¯æŒï¼ 2018-09-28 ","date":"2024-08-30","objectID":"/about/:3:0","tags":null,"title":"å…³äº","uri":"/about/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 1 å®éªŒè¦æ±‚ æœ¬å®éªŒæ—¨åœ¨åˆ©ç”¨lab 3ä¸­çš„Raftåº“ï¼Œæ„å»ºä¸€ä¸ªå…·å¤‡å®¹é”™èƒ½åŠ›çš„é”®å€¼å­˜å‚¨æœåŠ¡ã€‚æœåŠ¡å°†ä½œä¸ºä¸€ä¸ªå¤åˆ¶çŠ¶æ€æœºï¼Œç”±å¤šä¸ªæœåŠ¡å™¨ç»„æˆï¼Œå„æœåŠ¡å™¨é€šè¿‡Raftåè®®åŒæ­¥æ•°æ®åº“çŠ¶æ€ã€‚å³ä½¿åœ¨éƒ¨åˆ†æ•…éšœæˆ–ç½‘ç»œéš”ç¦»çš„æƒ…å†µä¸‹ï¼Œåªè¦å¤§å¤šæ•°æœåŠ¡å™¨æ­£å¸¸ï¼ŒæœåŠ¡ä»éœ€ç»§ç»­å“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚åœ¨lab 4å®Œæˆåï¼Œä½ å°†å®ç°å›¾ä¸­Raftäº¤äº’çš„æ‰€æœ‰éƒ¨åˆ†ï¼ˆClerkã€Serviceå’ŒRaftï¼‰ã€‚ å®¢æˆ·ç«¯é€šè¿‡Clerkä¸é”®å€¼æœåŠ¡äº¤äº’ï¼Œå‘é€RPCè¯·æ±‚ï¼Œæ”¯æŒPutã€Appendå’ŒGetä¸‰ç§æ“ä½œã€‚æœåŠ¡éœ€ç¡®ä¿è¿™äº›æ“ä½œçº¿æ€§åŒ–ï¼Œå¦‚æœé€ä¸ªè°ƒç”¨ï¼Œè¿™äº›æ–¹æ³•åº”è¡¨ç°å¾—å¥½åƒç³»ç»Ÿåªæœ‰ä¸€ä¸ªçŠ¶æ€å‰¯æœ¬ï¼Œæ¯ä¸ªè°ƒç”¨éƒ½åº”è§‚å¯Ÿåˆ°å‰åºè°ƒç”¨åºåˆ—å¯¹çŠ¶æ€çš„ä¿®æ”¹ã€‚å¯¹äºå¹¶å‘è°ƒç”¨ï¼Œè¿”å›å€¼å’Œæœ€ç»ˆçŠ¶æ€å¿…é¡»ä¸æ“ä½œæŒ‰æŸç§é¡ºåºé€ä¸ªæ‰§è¡Œæ—¶ç›¸åŒã€‚å¦‚æœè°ƒç”¨åœ¨æ—¶é—´ä¸Šé‡å ï¼Œåˆ™è®¤ä¸ºæ˜¯å¹¶å‘è°ƒç”¨ã€‚ ä¸ºå•ä¸€æœåŠ¡å™¨æä¾›çº¿æ€§åŒ–ç›¸å¯¹å®¹æ˜“ï¼Œä½†å¦‚æœæœåŠ¡æ˜¯å¤åˆ¶çš„ï¼Œåˆ™è¾ƒä¸ºå›°éš¾ï¼Œå› ä¸ºæ‰€æœ‰æœåŠ¡å™¨å¿…é¡»ä¸ºå¹¶å‘è¯·æ±‚é€‰æ‹©ç›¸åŒçš„æ‰§è¡Œé¡ºåºï¼Œé¿å…ä½¿ç”¨è¿‡æ—¶çš„çŠ¶æ€å›å¤å®¢æˆ·ç«¯ï¼Œå¹¶åœ¨æ•…éšœæ¢å¤æ—¶ä»¥ä¿ç•™æ‰€æœ‰ç¡®è®¤çš„å®¢æˆ·ç«¯æ›´æ–°ä¸ºå‰æã€‚Raft ä½œè€…çš„åšå£«è®ºæ–‡çš„ç¬¬ 6.3 å°èŠ‚ä»‹ç»äº†å¦‚ä½•å®ç°çº¿æ€§åŒ–è¯­ä¹‰ï¼Œåœ¨çŸ¥ä¹ä¸Šä¹Ÿæœ‰å…³äºè¿™æ–¹é¢çš„è®¨è®ºï¼Œå¯ä»¥å‚è€ƒ dragonboat ä½œè€…çš„å›ç­”ã€‚ å®éªŒåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šAé˜¶æ®µå®ç°åŸºäºRaftçš„é”®å€¼æœåŠ¡ï¼Œä¸ä½¿ç”¨å¿«ç…§ï¼›Bé˜¶æ®µåˆ™é›†æˆå¿«ç…§åŠŸèƒ½ï¼Œä¼˜åŒ–æ—¥å¿—ç®¡ç†ã€‚ æˆ‘çš„å®éªŒä»£ç ä»“åº“ï¼šhttps://github.com/HeZephyr/MIT6.5840/tree/main/src/kvraftï¼Œå·²é€šè¿‡å‹åŠ›æµ‹è¯•ï¼Œä»£ç ä¸¥æ ¼éµå®ˆä¸Šè¿°æŒ‰è¦æ±‚å®ç°ã€‚ æ³¨æ„ï¼šä¸‹è¿°æ‰€è´´ä»£ç ä¸ºäº†ç®€æ´ä»¥åŠåˆ†å—ï¼Œè¿›è¡Œäº†ä¸€å®šç¨‹åº¦çš„åˆ å‡ï¼Œå¦‚æœéœ€è¦å¤ç°ï¼Œå¯ä»¥å‰å¾€ä»“åº“ã€‚ ","date":"2024-08-30","objectID":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘ Lab 4:Fault-tolerant KVService è®¾è®¡å®ç°","uri":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 2 å®éªŒè®¾è®¡ ","date":"2024-08-30","objectID":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘ Lab 4:Fault-tolerant KVService è®¾è®¡å®ç°","uri":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 2.1 æ€è·¯ lab4éœ€è¦æˆ‘ä»¬åŸºäºlab3å®ç°çš„Raftï¼Œå®ç°ä¸€ä¸ªå¯ç”¨çš„KVæœåŠ¡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¿è¯çº¿æ€§ä¸€è‡´æ€§ï¼ˆè¦æ±‚ä»å¤–éƒ¨è§‚å¯Ÿè€…çš„è§’åº¦æ¥çœ‹ï¼Œæ‰€æœ‰æ“ä½œéƒ½æŒ‰ç…§æŸä¸ªå…¨å±€é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”ç»“æœä¸è¿™äº›æ“ä½œæŒ‰è¯¥é¡ºåºä¸²è¡Œæ‰§è¡Œçš„ç»“æœç›¸åŒï¼‰ã€‚å°½ç®¡ Raft å…±è¯†ç®—æ³•æœ¬èº«æ”¯æŒçº¿æ€§åŒ–è¯­ä¹‰ï¼Œä½†è¦çœŸæ­£ä¿è¯çº¿æ€§åŒ–è¯­ä¹‰åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ç”Ÿæ•ˆï¼Œä»ç„¶éœ€è¦ä¸Šå±‚æœåŠ¡çš„é…åˆã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢è¿™å¼ å›¾ä¸­ï¼šxåˆå§‹å€¼ä¸º0ï¼Œclient1å‘é€putè¯·æ±‚(x,1)ï¼Œclient2å‘é€putè¯·æ±‚(x,2)ï¼Œå¹¶åœ¨putè¯·æ±‚å‰åå‘é€getè¯·æ±‚ï¼Œæ­¤æ—¶å¦‚æœputè¯·æ±‚å› ä¸ºè¶…æ—¶ä¸æ–­é‡å‘ï¼Œå¦‚æœåœ¨client2çš„putè¯·æ±‚ä¹‹åæ‰è¢«åº”ç”¨ï¼Œåˆ™å¯¼è‡´æœ€åclient2è¯»åˆ°çš„æ˜¯1ï¼ŒRaftKVçš„ç»“æœä¹Ÿæ˜¯1ï¼Œè¿™å°±è¿èƒŒäº†çº¿æ€§ä¸€è‡´æ€§ã€‚ è¿™æ˜¯å› ä¸ºå½“å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯æäº¤commandæ—¶ï¼ŒæœåŠ¡ç«¯åœ¨Raftå±‚ä¸­åŒæ­¥ã€æäº¤å¹¶åº”ç”¨åï¼Œå®¢æˆ·ç«¯å› ä¸ºæ²¡æœ‰æ”¶åˆ°è¯·æ±‚å›å¤ï¼Œä¼šé‡è¯•æ­¤æ“ä½œï¼Œè¿™ç§é‡è¯•æœºåˆ¶ä¼šå¯¼è‡´ç›¸åŒçš„å‘½ä»¤è¢«æ‰§è¡Œå¤šæ¬¡ã€‚æ³¨æ„ï¼Œè¿™é‡Œè®¨è®ºçš„éƒ½æ˜¯å†™è¯·æ±‚ï¼Œå› ä¸ºè¯»è¯·æ±‚ä¸ä¼šæ”¹å˜ç³»ç»ŸçŠ¶æ€ï¼Œå¯ä»¥é‡å¤æ‰§è¡Œå¤šæ¬¡ã€‚ ä¸ºäº†è§£å†³é‡å¤æ‰§è¡Œå‘½ä»¤å¯¼è‡´çº¿æ€§ä¸€è‡´æ€§ç ´åçš„é—®é¢˜ï¼ŒRaft ä½œè€…æå‡ºäº†ä¸€ç§è§£å†³æ–¹æ¡ˆï¼šå®¢æˆ·ç«¯ä¸ºæ¯ä¸ªå‘½ä»¤åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„åºåˆ—å·ã€‚çŠ¶æ€æœºä¼šè®°å½•æ¯ä¸ªå®¢æˆ·ç«¯çš„æœ€æ–°åºåˆ—å·åŠå…¶å¯¹åº”çš„æ‰§è¡Œç»“æœã€‚å¦‚æœä¸€ä¸ªå‘½ä»¤çš„åºåˆ—å·å·²ç»è¢«å¤„ç†è¿‡ï¼Œåˆ™ç³»ç»Ÿä¼šç›´æ¥è¿”å›å…ˆå‰çš„ç»“æœï¼Œè€Œä¸ä¼šé‡æ–°æ‰§è¡Œè¯¥å‘½ä»¤ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ¯ä¸ªå‘½ä»¤åªè¢«åº”ç”¨åˆ°çŠ¶æ€æœºä¸€æ¬¡ï¼Œé¿å…äº†é‡å¤æ‰§è¡Œå¯èƒ½å¸¦æ¥çš„çº¿æ€§ä¸€è‡´æ€§é—®é¢˜ã€‚ åœ¨è¿™ä¸ªlabä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æœºåˆ¶å…·ä½“å®ç°ï¼š å®¢æˆ·ç«¯å‘½ä»¤å”¯ä¸€åŒ–ï¼šæ¯ä¸ªå®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡ç«¯çš„æ¯ä¸ªcommandè¯·æ±‚éƒ½æºå¸¦ä¸€ä¸ªç”±ClientIdå’ŒCommandIdç»„æˆçš„äºŒå…ƒç»„ã€‚ClientIdæ˜¯å®¢æˆ·ç«¯çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ŒCommandIdæ˜¯ä¸€ä¸ªé€’å¢çš„æ•´æ•°ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†å®¢æˆ·ç«¯å‘å‡ºçš„æ¯ä¸€ä¸ªå‘½ä»¤ã€‚ æœåŠ¡å™¨ç«¯çŠ¶æ€è®°å½•ï¼šåœ¨æœåŠ¡å™¨ç«¯ï¼Œç»´æŠ¤ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œè¿™ä¸ªæ˜ å°„è¡¨ä»¥ClientIdä½œä¸ºä¸»é”®ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªç»“æ„ä½“åŒ…å«ï¼š æœ€è¿‘æ‰§è¡Œçš„æ¥è‡ªè¯¥å®¢æˆ·ç«¯çš„CommandIdã€‚ å¯¹åº”çš„å‘½ä»¤æ‰§è¡Œç»“æœã€‚ é‡å¤å‘½ä»¤æ£€æµ‹ä¸å¤„ç†ï¼š å½“ä¸€ä¸ªæ–°å‘½ä»¤åˆ°è¾¾æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥æ˜ å°„è¡¨ä¸­æ˜¯å¦å­˜åœ¨å¯¹åº”çš„ClientIdæ¡ç›®ã€‚ å¦‚æœå­˜åœ¨ï¼Œåˆ™æ¯”è¾ƒæ–°å‘½ä»¤çš„CommandIdä¸æ˜ å°„è¡¨ä¸­è®°å½•çš„CommandIdã€‚ å¦‚æœæ–°å‘½ä»¤çš„CommandIdå°äºæˆ–ç­‰äºè®°å½•çš„CommandIdï¼Œåˆ™è¯´æ˜è¿™æ˜¯ä¸€ä¸ªé‡å¤å‘½ä»¤ï¼ŒæœåŠ¡å™¨å¯ä»¥ç›´æ¥è¿”å›ä¹‹å‰å­˜å‚¨çš„ç»“æœã€‚ å¦‚æœæ–°å‘½ä»¤çš„CommandIdå¤§äºè®°å½•çš„CommandIdï¼Œåˆ™è¯´æ˜è¿™æ˜¯æ–°çš„å‘½ä»¤ï¼ŒæœåŠ¡å™¨åº”è¯¥æ­£å¸¸å¤„ç†è¿™ä¸ªå‘½ä»¤ï¼Œå¹¶æ›´æ–°æ˜ å°„è¡¨ä¸­å¯¹åº”ClientIdçš„CommandIdåŠç»“æœã€‚ å¦‚æœä¸å­˜åœ¨å¯¹åº”çš„ClientIdæ¡ç›®ï¼Œåˆ™å°†æ­¤å‘½ä»¤è§†ä¸ºé¦–æ¬¡å‡ºç°çš„å‘½ä»¤è¿›è¡Œå¤„ç†ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªæ–°çš„æ¡ç›®åˆ°æ˜ å°„è¡¨ä¸­ã€‚ ","date":"2024-08-30","objectID":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/:2:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘ Lab 4:Fault-tolerant KVService è®¾è®¡å®ç°","uri":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 2.2 lab4Aï¼šæ— å¿«ç…§ æ•´ä½“çš„æ—¶åºå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š 2.2.1 2.2.1 å®¢æˆ·ç«¯ å¯¹äºå®¢æˆ·ç«¯ï¼Œéœ€è¦æœ‰(clientId, commandId)æ¥æ ‡è¯†å”¯ä¸€å‘½ä»¤ï¼Œå¯¹äºclientIdï¼Œé€šè¿‡labæä¾›çš„éšæœºæ•°ç”Ÿæˆå™¨nrandç”Ÿæˆå³å¯ï¼Œå¯¹äºcommandIdï¼Œå¯ä»¥é‡‡ç”¨é€’å¢çš„æ–¹å¼è¿›è¡Œç®¡ç†ã€‚è¿™æ„å‘³ç€æ¯å½“å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæ–°çš„å‘½ä»¤æ—¶ï¼ŒcommandIdéƒ½ä¼šé€’å¢ä¸€æ¬¡ï¼Œä»è€Œç¡®ä¿æ¯ä¸ªå‘½ä»¤éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œè¿™æ ·ä¹Ÿéœ€è¦ä¿è¯å¦‚æœè¿™æ¡å‘½ä»¤æ²¡å¤„ç†å®Œï¼ˆè¯·æ±‚çš„serverä¸æ˜¯leaderæˆ–è€…è¯·æ±‚è¶…æ—¶ï¼‰éœ€é‡å¤æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸èƒ½æ”¹å˜commandIdã€‚ type CommandArgs struct { Key string Value string Op OpType ClientId int64 CommandId int64 } type CommandReply struct { Err Err Value string } type Clerk struct { servers []*labrpc.ClientEnd leaderId int clientId int64 commandId int64 } func (ck *Clerk) Get(key string) string { return ck.ExecuteCommand(\u0026CommandArgs{Key: key, Op: OpGet}) } func (ck *Clerk) Put(key string, value string) { ck.ExecuteCommand(\u0026CommandArgs{Key: key, Value: value, Op: OpPut}) } func (ck *Clerk) Append(key string, value string) { ck.ExecuteCommand(\u0026CommandArgs{Key: key, Value: value, Op: OpAppend}) } func (ck *Clerk) ExecuteCommand(args *CommandArgs) string { args.ClientId, args.CommandId = ck.clientId, ck.commandId for { reply := new(CommandReply) if !ck.servers[ck.leaderId].Call(\"KVServer.ExecuteCommand\", args, reply) || reply.Err == ErrWrongLeader || reply.Err == ErrTimeout { ck.leaderId = (ck.leaderId + 1) % len(ck.servers) continue } ck.commandId += 1 return reply.Value } } 2.2.2 2.2.2 æœåŠ¡ç«¯ KVServerç»“æ„ä½“è¢«è®¾è®¡æˆä¸€ä¸ªåŸºäºRaftä¸€è‡´æ€§åè®®å®ç°çš„é”®å€¼å­˜å‚¨æœåŠ¡ã€‚ä¸ºäº†ç¡®ä¿å®¢æˆ·ç«¯è¯·æ±‚çš„å¹‚ç­‰æ€§ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ­£ç¡®åœ°å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„é‡å¤è¯·æ±‚ï¼ŒlastOperationsæ˜ å°„è¡¨ç”¨äºè·Ÿè¸ªæ¯ä¸ªå®¢æˆ·ç«¯ï¼ˆç”±clientIdæ ‡è¯†ï¼‰çš„æœ€åå·²åº”ç”¨çš„commandIdä»¥åŠç›¸åº”çš„replyã€‚è¿™ä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿåœ¨æ¥æ”¶åˆ°é‡å¤è¯·æ±‚æ—¶è¿”å›ä¹‹å‰çš„ç»“æœè€Œæ— éœ€å†æ¬¡æ‰§è¡Œç›¸åŒçš„å‘½ä»¤ã€‚ çŠ¶æ€æœºstateMachineåœ¨æ­¤å¤„è¢«å®ç°ä¸ºå†…å­˜ä¸­çš„é”®å€¼å¯¹å­˜å‚¨MemoryKVï¼Œè¿™æ„å‘³ç€æ‰€æœ‰çš„é”®å€¼å¯¹æ•°æ®éƒ½ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿™å¯¹äºå¿«é€Ÿè¯»å†™æ“ä½œæ˜¯éå¸¸æœ‰æ•ˆçš„ï¼Œä½†å¯èƒ½ä¸æ˜¯æŒä¹…åŒ–å­˜å‚¨çš„æœ€ä½³é€‰æ‹©ï¼Œå› ä¸ºå¦‚æœæœåŠ¡å™¨é‡å¯æˆ–å´©æºƒï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¼šä¸¢å¤±ã€‚ lastAppliedå­—æ®µè¢«ç”¨æ¥è®°å½•æœ€ååº”ç”¨åˆ°çŠ¶æ€æœºçš„æ—¥å¿—æ¡ç›®çš„ç´¢å¼•ï¼Œä»¥æ­¤æ¥é¿å…å¤„ç†é‚£äº›å·²ç»è¢«åº”ç”¨è¿‡çš„è¿‡æœŸæ—¥å¿—æ¡ç›®ã€‚ notifyChsæ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œå®ƒçš„é”®æ˜¯æ—¥å¿—æ¡ç›®çš„ç´¢å¼•ï¼Œå€¼æ˜¯ä¸€ä¸ªchannelã€‚ç”¨äºé€šçŸ¥Raftçš„å¤„ç†ç»“æœï¼ˆæœºå³å¤åˆ¶åˆ°å¤§å¤šæ•°å‰¯æœ¬å¹¶ä¸”åº”ç”¨åˆ°çŠ¶æ€æœºä¹‹åï¼‰ã€‚ type KVServer struct { mu sync.RWMutex me int rf *raft.Raft applyCh chan raft.ApplyMsg dead int32 // set by Kill() maxraftstate int // snapshot if log grows this big lastApplied int //record the last applied index to avoid duplicate apply stateMachine KVStateMachine lastOperations map[int64]OperationContext notifyChs map[int]chan *CommandReply } type KVStateMachine interface { Get(key string) (string, Err) Put(key, value string) Err Append(key, value string) Err } type OperationContext struct { MaxAppliedCommandId int64 LastReply *CommandReply } ExecuteCommandRPCå®ç°å¦‚ä¸‹ï¼Œè¿™æ®µé¦–å…ˆæ£€æŸ¥æ˜¯å¦ä¸æ˜¯Getè¯·æ±‚ä¸”ä¸ºé‡å¤çš„å‘½ä»¤ï¼Œå¦‚æœæ˜¯åˆ™è¿”å›ä¸Šæ¬¡çš„ç»“æœï¼Œå¦åˆ™é€šè¿‡Raftçš„Startæ–¹æ³•å¤åˆ¶å¹¶åº”ç”¨æ—¥å¿—ï¼Œå¦‚æœStartæ–¹æ³•è¿”å›ç»“æœå‘ŠçŸ¥å½“å‰serverä¸æ˜¯Leaderï¼Œåˆ™è¿”å›ErrWrongLeaderï¼Œå¦åˆ™ï¼Œå»æ³¨å†Œä¸€ä¸ªchannelå»é˜»å¡ç­‰å¾…æ‰§è¡Œç»“æœï¼ˆå› ä¸ºStartè¿”å›åªæ˜¯ä»£è¡¨æ—¥å¿—è¢«å¤åˆ¶åˆ°å¤§å¤šæ•°èŠ‚ç‚¹ä¸­ï¼Œæœ‰æ²¡æœ‰åº”ç”¨è¿˜ä¸çŸ¥é“ï¼‰ï¼Œè¿™ä¸ªæ‰§è¡Œç»“æœç”±applieråç¨‹pushã€‚ func (kv *KVServer) ExecuteCommand(args *CommandArgs, reply *CommandReply) { kv.mu.RLock() if args.Op != OpGet \u0026\u0026 kv.isDuplicatedCommand(args.ClientId, args.CommandId) { lastReply := kv.lastOperations[args.ClientId].LastReply reply.Value, reply.Err = lastReply.Value, lastReply.Err kv.mu.RUnlock() return } kv.mu.RUnlock() index, _, isLeader := kv.rf.Start(Command{args}) if !isLeader { reply.Err = ErrWrongLeader return } kv.mu.Lock() ch := kv.getNotifyCh(index) kv.mu.Unlock() select { case result := \u003c-ch: reply.Value, reply.Err = result.Value, result.Err case \u003c-time.After(ExecuteTimeout): reply.Err = ErrTimeout } go func() { kv.mu.Lock() kv.deleteNotifyCh(index) kv.mu.Unlock() }() } 2.2.3 2.2.3 applier applieråç¨‹å®ç°å¦‚ä¸‹ï¼Œä¸»è¦æ˜¯ç›‘æ§applyChï¼Œæ ¹æ®Raftçš„åº”ç”¨ç»“æœæ¥è¿›è¡Œå“åº”å¤„ç†ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯æ£€æµ‹æ˜¯å¦ä¸ºé‡å¤çš„å‘½ä»¤ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™éœ€è¦åº”ç”¨åˆ°çŠ¶æ€æœºï¼Œå¹¶ä¿å­˜æœ€è¿‘çš„å“åº”ç»“æœã€‚æœ€åï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯é¢†å¯¼è€…ï¼Œå¹¶ä¸”è¯¥æ—¥å¿—æ¡ç›®å±äºå½“å‰ä»»æœŸï¼Œåˆ™é€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯ã€‚ func (kv *KVServer) applier() { for kv.killed() == false { select { case message := \u003c-kv.applyCh: DPrintf(\"{Node %v} tries to apply message %v\", kv.rf.GetId(), message) if message.CommandValid { kv.mu.Lock() if message.CommandIndex \u003c= kv.lastApplied { DPrintf(\"{Node %v} discards outdated message %v because a newer snapshot which lastApplied is %v has been restored\", kv.rf.GetId(), message, kv.lastApplied) kv.mu.Unlock() continue } kv.lastApplied = message.CommandIndex reply := new(CommandReply) command := message.Command.(Command) // type assertion if command.Op != OpGet \u0026\u0026 kv.isDuplicatedCommand(command.ClientId, command.CommandId) { DPrintf(\"{Node %v} doesn't apply duplicated message %v to stateMachine beca","date":"2024-08-30","objectID":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/:2:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘ Lab 4:Fault-tolerant KVService è®¾è®¡å®ç°","uri":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 2.2 lab4Bï¼šæœ‰å¿«ç…§ å®ç°äº†lab4Aï¼Œlab4Bå°±å¥½åšäº†ï¼Œåªéœ€è¦ä¿®æ”¹applierï¼Œæ¯æ¬¡åº”ç”¨äº†commandä¹‹åï¼Œéƒ½éœ€è¦æ£€æŸ¥æ˜¯å¦è¾¾åˆ°maxraftstateï¼Œå¦‚æœè¾¾åˆ°ï¼Œåˆ™è°ƒç”¨snapshotæ¥åˆ¶ä½œå¿«ç…§ï¼Œéœ€è¦æ³¨æ„ï¼Œå¿«ç…§ä¸­ï¼Œä¸ä»…éœ€è¦ä¿å­˜çŠ¶æ€æœºçš„çŠ¶æ€ï¼Œè¿˜éœ€è¦åŒ…å«ç”¨æ¥å»é‡çš„lastOperationsï¼Œè¿™ä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢åº”ç”¨å¿«ç…§åçš„èŠ‚ç‚¹æˆä¸ºleaderåï¼Œç”±äºæ²¡æœ‰lastOperationså¯¼è‡´é‡å¤æ‰§è¡Œå‘½ä»¤ã€‚ ç„¶åï¼ŒapplyChä¸­è¿˜æœ‰Leaderå‘æ¥çš„å¿«ç…§ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœæœ‰æ•ˆï¼Œåˆ™éœ€è¦æ›´æ–°ç›¸åº”çš„çŠ¶æ€ï¼Œå…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š func (kv *KVServer) applier() { for kv.killed() == false { select { case message := \u003c-kv.applyCh: DPrintf(\"{Node %v} tries to apply message %v\", kv.rf.GetId(), message) if message.CommandValid { kv.mu.Lock() if message.CommandIndex \u003c= kv.lastApplied { DPrintf(\"{Node %v} discards outdated message %v because a newer snapshot which lastApplied is %v has been restored\", kv.rf.GetId(), message, kv.lastApplied) kv.mu.Unlock() continue } kv.lastApplied = message.CommandIndex reply := new(CommandReply) command := message.Command.(Command) // type assertion if command.Op != OpGet \u0026\u0026 kv.isDuplicatedCommand(command.ClientId, command.CommandId) { DPrintf(\"{Node %v} doesn't apply duplicated message %v to stateMachine because maxAppliedCommandId is %v for client %v\", kv.rf.GetId(), message, kv.lastOperations[command.ClientId], command.ClientId) reply = kv.lastOperations[command.ClientId].LastReply } else { reply = kv.applyLogToStateMachine(command) if command.Op != OpGet { kv.lastOperations[command.ClientId] = OperationContext{ MaxAppliedCommandId: command.CommandId, LastReply: reply, } } } // just notify related channel for currentTerm's log when node is leader if currentTerm, isLeader := kv.rf.GetState(); isLeader \u0026\u0026 message.CommandTerm == currentTerm { ch := kv.getNotifyCh(message.CommandIndex) ch \u003c- reply } if kv.needSnapshot() { kv.takeSnapshot(message.CommandIndex) } kv.mu.Unlock() } else if message.SnapshotValid { kv.mu.Lock() if kv.rf.CondInstallSnapshot(message.SnapshotTerm, message.SnapshotIndex, message.Snapshot) { kv.restoreStateFromSnapshot(message.Snapshot) kv.lastApplied = message.SnapshotIndex } kv.mu.Unlock() } else { panic(fmt.Sprintf(\"Invalid ApplyMsg %v\", message)) } } } } ","date":"2024-08-30","objectID":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/:2:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘ Lab 4:Fault-tolerant KVService è®¾è®¡å®ç°","uri":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 3 å‹æµ‹ç»“æœ ç½‘ä¸Šæä¾›äº†ä¸€ä¸ªæµ‹è¯•è„šæœ¬ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚æˆ‘çš„å‹æµ‹ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š ","date":"2024-08-30","objectID":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘ Lab 4:Fault-tolerant KVService è®¾è®¡å®ç°","uri":"/posts/09.mit-6.58406.824-lab4-fault-tolerant-kvservice/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"1 1 ä»‹ç» å¤§å‹åº”ç”¨åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é­é‡å¤šé‡æŒ‘æˆ˜ï¼Œå¦‚å¹¶å‘æ§åˆ¶ã€æ•…éšœæ¢å¤ã€ç½‘ç»œä¸ç¨³å®šåŠæœåŠ¡å™¨æ—¶é’Ÿå¼‚æ­¥ç­‰ã€‚å½¢å¼åŒ–éªŒè¯åˆ™æ˜¯ä¸€ç§ä¸¥æ ¼ç¡®ç«‹ç³»ç»Ÿæ­£ç¡®æ€§çš„æ–¹æ³•ï¼Œå¸®åŠ©å¤„ç†è¾¹ç¼˜æƒ…å†µã€‚ ç§Ÿçº¦æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å…³é”®æŠ€æœ¯ï¼Œç”¨äºä¿è¯ç³»ç»ŸæŸæ–¹é¢åœ¨ä¸€å®šæ—¶é—´å†…ä¸å˜ï¼ŒGFSã€Chubbyå’ŒDynamoDBéƒ½å…·æœ‰ç±»ä¼¼çš„æœºåˆ¶ã€‚ä¾‹å¦‚ç§Ÿçº¦å…è®¸é¢†å¯¼è€…é«˜æ•ˆæ‰§è¡Œåªè¯»æŸ¥è¯¢ï¼Œæ— éœ€é¢‘ç¹éªŒè¯è‡ªèº«é¢†å¯¼æƒï¼Œç„¶è€Œï¼Œè¿™ä¸€æœºåˆ¶çš„æœ‰æ•ˆæ€§éªŒè¯å´æ˜¯ä¸€é¡¹è‰°å·¨ä»»åŠ¡ã€‚ Groveï¼Œä½œä¸ºå‰æ²¿çš„å¹¶å‘åˆ†ç¦»é€»è¾‘ï¼ˆConcurrent Separation Logic, CSLï¼‰åº“ï¼Œé¦–å¼€å…ˆæ²³åœ°è§£å†³äº†åŸºäºæ—¶é—´çš„ç§Ÿçº¦éªŒè¯é—®é¢˜ï¼ŒåŒ…æ‹¬å…¶ä¸ç³»ç»Ÿé‡æ–°é…ç½®ã€æ•…éšœæ¢å¤ã€çº¿ç¨‹çº§å¹¶å‘ä»¥åŠä¸å¯é ç½‘ç»œé€šä¿¡ä¹‹é—´çš„å¤æ‚äº¤äº’ã€‚ CSLçš„åº”ç”¨ç²¾é«“åœ¨äºï¼Œé€šè¿‡å°†ç³»ç»ŸçŠ¶æ€ç»†åˆ†ä¸ºç‹¬ç«‹èµ„æºï¼Œå¹¶å€ŸåŠ©åŒæ­¥åŸè¯­è½¬ç§»èµ„æºæ‰€æœ‰æƒï¼Œä»è€Œå®ç°æ¨¡å—åŒ–ä¸”ç²¾ç¡®çš„æ¨ç†åˆ†æã€‚ Groveçš„åˆ›æ–°äº®ç‚¹å¯æ¦‚æ‹¬å¦‚ä¸‹ï¼š æ—¶é—´æœ‰ç•Œä¸å˜æ€§æ¨ç†ï¼šå¼•å…¥æ–°é¢–çš„æ—¶é—´ç»´åº¦ï¼Œæœ‰æ•ˆè§£æç§Ÿçº¦çš„æœ‰æ•ˆæœŸåŠå…¶å¯¹ç³»ç»ŸçŠ¶æ€çš„å½±å“ã€‚ æ‰©å±•Crash Hoareé€»è¾‘ï¼šå¼ºåŒ–é€»è¾‘ä½“ç³»ï¼Œä½¿ä¹‹èƒ½å¦¥å–„åº”å¯¹åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„èŠ‚ç‚¹å´©æºƒæƒ…å½¢ã€‚ æŠ½è±¡æœºåˆ¶ï¼šæä¾›å·¥å…·é›†ï¼Œæ”¯æŒå¯¹ä»…é™„åŠ æ—¥å¿—åŠå•è°ƒæ—¶é’Ÿè®¡æ•°å™¨çš„ç²¾å‡†æ¨ç†ï¼Œå¢å¼ºç³»ç»Ÿçš„æ—¶é—´ä¸€è‡´æ€§ã€‚ Grove code ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2 2 å¸¸è§ç»„ä»¶-Groveæ¡ˆä¾‹ç ”ç©¶ ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.1 2.1 RPCåº“ RPCæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„é‡è¦æ„å»ºæ¨¡å—ï¼Œå®ƒå…è®¸å®¢æˆ·ç«¯åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè°ƒç”¨è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯è°ƒç”¨rpcClient.Call(\"f\", args)å°†åœ¨ä¸rpcClientç›¸è¿çš„æœåŠ¡å™¨ä¸Šè°ƒç”¨f(args)ã€‚RPCåº“æä¾›çš„æ˜¯ä¸å¯é çš„RPCï¼Œæ„å‘³ç€å®¢æˆ·ç«¯çš„ä¸€æ¬¡è°ƒç”¨å¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¿è¡Œå¯¹åº”çš„å‡½æ•°ä¸€æ¬¡ã€é›¶æ¬¡æˆ–å¤šäºä¸€æ¬¡ã€‚è¿™æ˜¯å› ä¸ºåº•å±‚ç½‘ç»œå¯èƒ½ä¼šä¸¢å¼ƒã€é‡æ’æˆ–å¤åˆ¶æ•°æ®åŒ…ã€‚åº”ç”¨ç¨‹åºé€šå¸¸ä¸ä¼šç›´æ¥è°ƒç”¨RPCï¼Œè€Œæ˜¯ä½¿ç”¨å„ç§ä»£ç†ï¼ˆclerkï¼‰ï¼Œå®ƒä»¬å°è£…äº†RPCå¹¶é™„åŠ é¢å¤–çš„å¤„ç†ï¼ˆå¦‚æ·»åŠ è¯·æ±‚IDã€é‡è¯•ç­‰ï¼‰ã€‚ ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:2:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.2 2.2 å¤åˆ¶çŠ¶æ€æœºåº“ vRSMå¤åˆ¶ç”±åº”ç”¨ç¨‹åºæä¾›çš„çŠ¶æ€æœºï¼Œå…·ä½“çš„æ¥å£å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š vRSMç”±å¤šä¸ªç»„ä»¶å®ç°ï¼Œæ¯ä¸ªç»„ä»¶å¤„ç†çŠ¶æ€æœºå¤åˆ¶çš„ä¸åŒæ–¹é¢ï¼Œä¾‹å¦‚æŒä¹…æ€§å¯ä»¥ä¸å¤åˆ¶åè®®åˆ†å¼€å®ç°ã€‚ å‰¯æœ¬æœåŠ¡å™¨ï¼šå†™å…¥å¤åˆ¶ å‰¯æœ¬ç»„ä»¶ç®¡ç†è¢«å¤åˆ¶çš„çŠ¶æ€æœºçš„å‰¯æœ¬ã€‚ ä¸»è¦è§’è‰²åŒ…æ‹¬ä¸»æœåŠ¡å™¨(Primary)å’Œå¤‡ä»½æœåŠ¡å™¨(Backup)ã€‚ä¸»æœåŠ¡å™¨å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„å†™è¯·æ±‚ï¼Œå¤‡ä»½æœåŠ¡å™¨åˆ™å¤„ç†è¯»è¯·æ±‚ã€‚ ä¸»æœåŠ¡å™¨åœ¨æ”¶åˆ°æ“ä½œåï¼Œä¼šå…ˆåœ¨æœ¬åœ°åº”ç”¨ï¼Œç„¶åå¤åˆ¶åˆ°æ‰€æœ‰å¤‡ä»½æœåŠ¡å™¨ï¼Œæœ€åå›å¤å®¢æˆ·ç«¯ã€‚å¤åˆ¶æ“ä½œæ—¶ï¼Œä¸»æœåŠ¡å™¨ä¼šç”Ÿæˆçº¿ç¨‹ä»¥å¹¶å‘æ–¹å¼å‘æ¯ä¸ªå¤‡ä»½å‘é€RPCï¼Œå¹¶ä½¿ç”¨Go WaitGroupç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆï¼Œç¡®ä¿æ“ä½œè¢«æ‰€æœ‰å‰¯æœ¬æœåŠ¡å™¨åº”ç”¨ã€‚ ä½¿ç”¨configserviceé‡æ–°é…ç½® åˆ©ç”¨epochså’Œconfigserviceæ¥ç®¡ç†æœåŠ¡å™¨çš„æ·»åŠ æˆ–ç§»é™¤ã€‚ç³»ç»Ÿé€šè¿‡epochæ¥è·Ÿè¸ªä¸åŒçš„æœåŠ¡å™¨é…ç½®ã€‚æ¯ä¸ªepochå¯¹åº”ä¸€ç»„ç‰¹å®šçš„æœåŠ¡å™¨é…ç½®ï¼ŒåŒ…æ‹¬ä¸€ä¸ªä¸»æœåŠ¡å™¨å’Œå¤šä¸ªå¤‡ä»½æœåŠ¡å™¨ã€‚æ—¶ä»£åˆ†ä¸ºæ´»è·ƒepochå’Œä¿ç•™epochï¼Œåè€…æŒ‡æœªå®é™…è¿è¡Œçš„é…ç½®ã€‚configservice è´Ÿè´£ç»´æŠ¤å½“å‰ç³»ç»Ÿçš„æœ€æ–°epochå’Œé…ç½®ä¿¡æ¯ã€‚å®ƒå…è®¸å®¢æˆ·ç«¯è·å–å½“å‰é…ç½®ï¼Œå¹¶åœ¨é‡æ–°é…ç½®è¿‡ç¨‹ä¸­æä¾›åŸå­æ“ä½œä»¥æ›´æ–°é…ç½®ã€‚ åœ¨é‡æ–°é…ç½®æœŸé—´ï¼Œå®¢æˆ·ç«¯å¯èƒ½å‘æ—§é…ç½®å‘é€æ“ä½œï¼Œè¿™å¯èƒ½å¯¼è‡´æ–°é…ç½®ä¸­é—æ¼æ“ä½œã€‚ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œé‡æ–°é…ç½®è¿‡ç¨‹é¦–å…ˆä¼šå°é—­æ—§é…ç½®ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½¿å…¶ä¸å†æ¥å—å†™æ“ä½œï¼Œç›´åˆ°è¿›å…¥æ–°çš„epochã€‚ é‡æ–°é…ç½®æ­¥éª¤ åŒ…æ‹¬ï¼š åŸå­æ€§åœ°åˆ›å»ºæ–°epoch ä»æ—§é…ç½®ä¸­è·å–çŠ¶æ€ åœ¨æ–°æœåŠ¡å™¨ä¸Šåˆå§‹åŒ–çŠ¶æ€ æ›´æ–°configserviceä¸­çš„é…ç½®ä¿¡æ¯ æ¿€æ´»æ–°ä¸»æœåŠ¡å™¨ã€‚ // Reserve a new epoch number for reconfiguration, and return the current configuration (set of servers). func (ck *Clerk) ReserveEpochAndGetConfig() (uint64, []Address) // Return current configuration, used by clients to determine what servers to talk to. func (ck *Clerk) GetConfig() []Address // Set new configuration, making epoch live, as long as no higher-numbered epoch has been reserved. func (ck *Clerk) TryWriteConfig(epoch uint64, config []Address) Error // Get a lease for specified epoch, as long as itâ€™s the current epoch, returning the new lease expiration time. func (ck *Clerk) GetLease(epoch uint64) (Error, uint64) func Reconfigure(newServers []Address) { newEpoch, oldServers := configClerk.ReserveEpochAndGetConfig() // get state from a server from old config oldClerk := MakeClerk(oldServers[Rand() % len(oldServers)]) oldState := oldClerk.GetStateAndSeal(newEpoch) // make clerks to all of the new servers var newClerks = make([]Clerk, len(newServers)) for i := 0; i \u003c len(newServers); i++ { newClerks[i] = MakeClerk(newServers[i]) } // set state on all the new servers wg := new(WaitGroup) for i := 0; i \u003c len(newClerks); i++ { wg.Add(1) go func(i int) { newClerks[i].SetNewEpochState(newEpoch, oldState) wg.Done() }(i) } wg.Wait() // write new addresses to config service err := configClerk.TryWriteConfig(newEpoch, newServers) if err == nil { // activate the new primary server newClerks[0].BecomePrimary(newEpoch) } } åœ¨ç½‘ç»œåˆ†åŒºçš„æƒ…å†µä¸‹ï¼Œconfigserviceé€šè¿‡ä»…æ¥å—æœ€é«˜ç¼–å·çš„æ–°epochæ¥é¿å…åˆ›å»ºå¤šä¸ªå†²çªçš„ç³»ç»Ÿå®ä¾‹ã€‚ å‰¯æœ¬æœåŠ¡å™¨ï¼šåŸºäºç§Ÿçº¦çš„è¯»å– å‰¯æœ¬æœåŠ¡å™¨ï¼ˆä¸»æœåŠ¡å™¨å’Œå¤‡ä»½æœåŠ¡å™¨ï¼‰åˆ©ç”¨ç§Ÿçº¦æä¾›çº¿æ€§åŒ–è¯»å–æœåŠ¡ï¼Œæ— éœ€è·¨æœåŠ¡å™¨é€šä¿¡ã€‚ func (s *Server) ApplyReadonly(op) Result { s.mutex.Lock() if s.leaseExpiry \u003e GetTimeRange().latest { e := s.epoch idx, res := s.stateLogger.LocalRead(op) s.mutex.Unlock() // å¦‚æœåœ¨æ­¤æœŸé—´å‘ç”Ÿé‡æ–°é…ç½®ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯é‡è¯• if s.waitForCommitted(e, op, idx) { return res } else { return ErrRetry } } else { s.mutex.Unlock() return ErrRetry } } ç§Ÿçº¦æœºåˆ¶ï¼š ç§Ÿçº¦é˜²æ­¢é‡æ–°é…ç½®æ—¶è¿”å›è¿‡æ—¶æ•°æ®ï¼Œç¡®ä¿å„æœåŠ¡å™¨åŒæ­¥ã€‚ åå°çº¿ç¨‹å®šæœŸæ›´æ–°ç§Ÿçº¦ï¼Œæ‰¿è¯ºé…ç½®ä¸å˜ï¼Œç›´è‡³ç§Ÿçº¦åˆ°æœŸï¼ˆå¦‚1ç§’åï¼‰ã€‚ è¯»å–æµç¨‹ï¼š æœåŠ¡å™¨æ”¶åˆ°åªè¯»è¯·æ±‚ä¸”ç§Ÿçº¦æœ‰æ•ˆæ—¶ï¼Œæ ¹æ®æœ¬åœ°çŠ¶æ€è®¡ç®—å“åº”ã€‚æœ¬åœ°çŠ¶æ€åŒ…å«æ‰€æœ‰å·²æäº¤æ“ä½œï¼Œå¯èƒ½å«æœªæäº¤çš„å†™æ“ä½œã€‚ è¯»å–ä¾èµ–çš„å‰åºå†™æ“ä½œéœ€å…¨éƒ¨æäº¤ï¼Œæ–¹èƒ½å‘å®¢æˆ·ç«¯å‘é€ç»“æœã€‚ Groveä½¿ç”¨ç±»ä¼¼TrueTimeçš„GetTimeRange()APIï¼Œæä¾›å½“å‰æ—¶é—´çš„ä¸Šä¸‹é™ï¼Œè§£å†³æ—¶é’Ÿåç§»é—®é¢˜ã€‚ å­˜å‚¨åº“ï¼šçŠ¶æ€æ—¥å¿—å™¨ å‰¯æœ¬æœåŠ¡å™¨ä½¿ç”¨å­˜å‚¨åº“ç®¡ç†æŒä¹…çŠ¶æ€ï¼Œæä¾›â€œçŠ¶æ€æ—¥å¿—å™¨â€ç”¨äºåœ¨è¿½åŠ å‹æ–‡ä»¶ä¸­æŒä¹…åŒ–æ–°æ“ä½œã€‚çŠ¶æ€æ—¥å¿—å™¨åœ¨å†…å­˜ä¸­ç¼“å†²è¿½åŠ æ“ä½œï¼Œåå°çº¿ç¨‹å¼‚æ­¥è¿½åŠ å¹¶åŒæ­¥ç¼“å†²åŒºåˆ°æ–‡ä»¶ï¼Œä»¥æå‡æ€§èƒ½ã€‚å­˜å‚¨åº“æä¾› Wait() å‡½æ•°ï¼Œå…è®¸ç­‰å¾…ç›´åˆ°æ–‡ä»¶çš„å‰ç¼€éƒ¨åˆ†è¢«æŒä¹…åŒ–ã€‚å‰¯æœ¬åº“åœ¨å›å¤ RPC ä¹‹å‰ä½¿ç”¨ Wait() ç¡®ä¿å˜æ›´è¢«æŒä¹…å­˜å‚¨ã€‚ åŸºäºPaxosçš„å®¹é”™é…ç½®æœåŠ¡ Paxos åº“ç”¨äºå¤„ç†é…ç½®æœåŠ¡è‡ªèº«çš„æœåŠ¡å™¨æ•…éšœï¼Œæ˜¯ä¸€ä¸ªç®€å•çš„åŸºäº Paxos ä¸€è‡´æ€§ç®—æ³•çš„å¤åˆ¶åº“ã€‚Paxosåœ¨å›ºå®šæœåŠ¡å™¨é›†ä¸Šè¿è¡Œï¼Œä»…éœ€è¦å¤šæ•°æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œä½¿ç”¨ leader åè°ƒæ“ä½œï¼Œä½†åœ¨ leader å´©æºƒæ—¶å…è®¸æ›´æ¢ã€‚ä¸ä¸»-å¤‡ä»½å¤åˆ¶çš„å·®å¼‚ï¼š Paxos è‡ªè¡Œé€‰æ‹©æ–°çš„epochç¼–å·ï¼Œå› ä¸ºæœåŠ¡å™¨é›†ä¸ä¼šåœ¨è¿è¡Œæ—¶æ”¹å˜ã€‚ ä»…è¦æ±‚å¤šæ•°æœåŠ¡å™¨æäº¤æ“ä½œï¼Œæ–° leader å¿…é¡»ä»å¤šæ•°æœåŠ¡å™¨è·å–æœ€æ–°çŠ¶æ€ã€‚ Paxos è¾ƒä¸ºç®€å•ï¼Œä¸ä½¿ç”¨ç§Ÿçº¦ï¼Œæ¯æ¬¡æ›´æ–°éƒ½å†™å…¥æ•´ä¸ªçŠ¶æ€åˆ°ç£ç›˜ï¼Œè€Œéè¿½åŠ æ“ä½œåˆ°æ—¥å¿—ã€‚ å†™æ“ä½œæ€§èƒ½è¾ƒä½ï¼Œä½†å¯¹äºé…ç½®æœåŠ¡æ˜¯å¯æ¥å—çš„ï¼›æä¾›å¿«é€Ÿä½†å¼±ä¸€è‡´æ€§çš„è¯»å–ã€‚ Paxosæä¾›çš„æ¥å£å¦‚ä¸‹ï¼š // è¿”å›å½“å‰Paxoså®ä¾‹ä¸­çš„å¤åˆ¶çŠ¶æ€ã€‚å¯èƒ½è¿‡æ—¶æˆ–æœªæäº¤ï¼ŒGetConfig ä½¿ç”¨ WeakRead ä»¥ç¡®ä¿å¿«é€Ÿå“åº” func (p *Paxos) WeakRead() []byte // å¼€å§‹ä¸€ä¸ªæ–°çš„æè®®è¿‡ç¨‹ã€‚å®ƒè¿”å›å½“å‰çš„å¤åˆ¶çŠ¶æ€å’Œä¸€ä¸ªcommitå›è°ƒå‡½æ•°ã€‚ func (p *Paxos) Begin() (oldstate []byte, commit func(newstate []byte) error) // å°è¯•ä½¿å½“å‰èŠ‚ç‚¹æˆä¸ºé¢†å¯¼è€…ã€‚ func (p *Paxos) TryBecomingLeader() è¦æ‰§è¡Œå†™æ“ä½œï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼Œconfigserverä½¿ç”¨Begin()æ–¹æ³•ã€‚ // å‚æ•°argsåœ¨æ­¤å¤„æœªä½¿ç”¨ï¼Œé€šå¸¸ç”¨äºæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚çš„å‚æ•°ã€‚ // reply æ˜¯æ–¹æ³•çš„è¾“å‡ºï¼Œå®ƒå°†åŒ…å«æ“ä½œçš„ç»“æœçŠ¶æ€ä»¥åŠé¢„ç•™çš„æ–°epochå’Œé…ç½®ä¿¡æ¯ã€‚ func (c *ConfigService) ReserveEpochAndGetConfig(args []byte, reply *[]byte) { // ä»Paxoså®ä¾‹å¼€å§‹ä¸€ä¸ªæ–°çš„æè®®ï¼Œè·å–å½“å‰çŠ¶æ€å’Œæäº¤å‡½æ•°ã€‚ // åº”è¯¥åœ¨å½“å‰çš„é¢†å¯¼è€…ä¸Šè°ƒç”¨æ­¤æ–¹æ³•ï¼Œå¦åˆ™æè®®æ— æ³•æˆåŠŸæäº¤ã€‚ oldstate, commit := c.paxos.Begin() // ååºåˆ—åŒ–æ—§çŠ¶æ€ï¼Œä»¥ä¾¿ä¿®æ”¹ã€‚ st := unmarshal(oldstate) // æ›´æ–°çŠ¶æ€ä¸­çš„é¢„ç•™epochå­—æ®µï¼Œå‡†å¤‡è¿›å…¥ä¸‹ä¸€ä¸ªepochã€‚ st.reservedEpoch = st.reservedEpoch + 1 // åºåˆ—åŒ–æ›´æ–°åçš„çŠ¶æ€ï¼Œå‡†å¤‡æäº¤ã€‚ newstate := marshal(st) // ä½¿ç”¨ä»Beginè·å¾—çš„æäº¤å‡½æ•°å°è¯•æäº¤æ–°çŠ¶æ€ã€‚ // æ­¤æ“ä½œä¼šä¸å…¶ä»–æœåŠ¡å™¨é€šä¿¡ï¼Œä»¥ç¡®ä¿æ–°çŠ¶æ€è¢«å¤åˆ¶åˆ°å¤§å¤šæ•°","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:2:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.3 2.3 vRSMä¸Šå±‚åº”ç”¨ vKVå®ç° vKV æ¶æ„ï¼šåŸºäº vRSM å’Œ exactlyonce åº“å®ç°ã€‚ æœåŠ¡å™¨ç«¯ï¼šå®ç° vRSM æœŸæœ›çš„çŠ¶æ€æœºæ¥å£ã€‚ å®¢æˆ·ç«¯ï¼šåŸºäº exactlyonce clerk å®ç°çš„ clerkï¼Œæä¾›ç®€åŒ–çš„ APIï¼ˆPutã€CondPutã€Getï¼‰ã€‚ å®ç°ç»†èŠ‚ï¼švKV å®ç°ç®€å•ï¼ŒåŒ…æ‹¬ (å)åºåˆ—åŒ–æ–¹æ³•å’Œå†…å­˜æ˜ å°„çš„è¯»å†™å‡½æ•°ã€‚ æ€§èƒ½ä¼˜åŒ–ï¼švKV å­˜å‚¨é”®åˆ°å€¼çš„æ˜ å°„ä»¥åŠé”®çš„æœ€åä¿®æ”¹æ“ä½œç´¢å¼•ï¼Œåˆ©ç”¨ vRSM çš„ç‰ˆæœ¬åŒ–çŠ¶æ€æœºæ¥å£æå‡è¯»å–æ€§èƒ½ã€‚ åŸºäºç§Ÿçº¦çš„å®¢æˆ·ç«¯ç¼“å­˜-cachekv cachekv åº“é€šè¿‡åœ¨ vKV ä¸­å­˜å‚¨æ•°æ®å’Œç§Ÿçº¦åˆ°æœŸæ—¶é—´å®ç°åŸºäºç§Ÿçº¦çš„å®¢æˆ·ç«¯ç¼“å­˜ã€‚GetAndCache å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š func (k *CacheKv) GetAndCache(key string, cachetime uint64) string { for { // first attempt to read from the local cache, and if not cached, call vKV's Get. old := k.kv.Get(key) new := old newExpiration := max(GetTimeRange().latest+cachetime, old.leaseExpiration) new.leaseExpiration = newExpiration // Try to update the lease expiration time on the backend resp := k.kv.CondPut(key, old, new) if resp == \"ok\" { k.mu.Lock() k.cache[key] = cacheValue{v: old.v, l: newLeaseExpiration} k.mu.Unlock() return old.v } } } å®ƒè¿”å›æŒ‡å®šé”®çš„å€¼ï¼Œå¹¶åœ¨å†…éƒ¨ç¼“å­˜ï¼Œä½¿ç”¨ CondPut ï¼ˆç¡®ä¿ä»…åœ¨ç§Ÿçº¦è¿‡æœŸæ—¶æ›´æ”¹å€¼ï¼‰åŸå­å¢åŠ ç§Ÿçº¦æŒç»­æ—¶é—´ï¼Œç¡®ä¿å¹¶å‘ä¿®æ”¹ä¸ä¼šæ”¹å˜å€¼ã€‚ é”æœåŠ¡ é”æœåŠ¡æ¥å£åŸºäº vKV å®ç°ï¼Œä½¿ç”¨ vKV çš„ CondPut() æ“ä½œå®ç°é”ã€‚æ¯ä¸ªé”å¯¹åº”ä¸€ä¸ªé”®å€¼å¯¹ï¼Œæä¾› Acquire() å’Œ Release() æ–¹æ³•çš„è§„èŒƒï¼Œæ”¯æŒåº”ç”¨å®ç°ç‹¬å é”ã€‚é”æœåŠ¡çš„è§„èŒƒä¸ä¼ ç»Ÿçš„å¹¶å‘åˆ†ç¦»é€»è¾‘é”è§„èŒƒä¸åŒï¼Œç®€åŒ–äº†èµ„æºä¿æŠ¤ã€‚ é“¶è¡Œäº‹åŠ¡ é¡¶å±‚åº”ç”¨ï¼Œä½¿ç”¨åŸºäº vKV clerk å’Œé”æœåŠ¡æ¥å£æ„å»ºçš„äº‹åŠ¡ã€‚ è´¦æˆ·çŠ¶æ€å­˜å‚¨ï¼šä½¿ç”¨ vKV å®ä¾‹å­˜å‚¨è´¦æˆ·çŠ¶æ€ï¼Œæ¯ä¸ªè´¦æˆ·ä½™é¢ç”¨ä¸€å¯¹é”®å€¼å­˜å‚¨ã€‚ å¹¶å‘è®¿é—®æ§åˆ¶ï¼šä½¿ç”¨é”æœåŠ¡å¤„ç†è´¦æˆ·çš„å¹¶å‘è®¿é—®ï¼Œæ¯æ¬¡è½¬è´¦æ“ä½œè·å–ä¸¤ä¸ªé”ï¼Œç¡®ä¿å¹¶å‘è½¬è´¦çš„å®‰å…¨æ‰§è¡Œã€‚ å®¡è®¡åŠŸèƒ½ (Audit)ï¼šè·å–æ‰€æœ‰è´¦æˆ·çš„é”ï¼Œè®¡ç®—æ€»ä½™é¢ï¼Œå¹¶é‡Šæ”¾é”ã€‚ å®¹é”™å¤„ç†ï¼šè‹¥é“¶è¡ŒèŠ‚ç‚¹å´©æºƒï¼Œé”æœåŠ¡ä¸­çš„é”å°†ä¿æŒé”å®šçŠ¶æ€ï¼Œæ¢å¤éœ€è¦æŸç§å½¢å¼çš„æ’¤é”€æˆ–é‡åšæ—¥å¿—ï¼Œä½†åŸå‹ä¸­æœªå®ç°ã€‚ ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:2:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3 3 Groveæ€§èƒ½è¯„ä¼° å®éªŒç›®çš„ï¼š è¯æ˜ Grove èƒ½å¤ŸéªŒè¯ç°å®ä¸–ç•Œä¸­é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ å±•ç¤º vKV åŸå‹é€šè¿‡ Grove éªŒè¯åèƒ½å¤Ÿå®ç°é«˜æ€§èƒ½ã€‚ ç‰¹åˆ«å¼ºè°ƒç§Ÿçº¦åœ¨ vKV ä¸­å®ç°é«˜æ€§èƒ½è¯»å–çš„é‡è¦æ€§ã€‚ baselineæ€§èƒ½å¯¹æ¯”ï¼šå°†vKVä¸Redisè¿›è¡Œæ¯”è¾ƒï¼Œåè€…æ˜¯é«˜æ€§èƒ½é”®å€¼æœåŠ¡å™¨ï¼Œä»¥Cè¯­è¨€ç¼–å†™ã€‚ä¸ºäº†ä½¿Redisä¸vKVåœ¨æŒä¹…åŒ–ä¿éšœä¸Šå¯æ¯”ï¼ŒRediså¼€å¯appendfsync alwaysé€‰é¡¹ï¼Œè€ŒvKVè¿è¡Œäºå•æ ¸å¹¶ç¦ç”¨å¤‡ä»½å‰¯æœ¬ã€‚ç»“æœæ˜¾ç¤ºï¼ŒvKVååé‡ä¸ºRedisçš„67%-73%ï¼Œè¯·æ±‚å»¶è¿Ÿç›¸å½“ï¼Œå¤šæ ¸ä¸‹vKVååé‡æ›´é«˜ï¼ˆä¾‹å¦‚ï¼Œ8æ ¸ä¸‹YCSB 5%å†™å…¥æƒ…å†µä¸‹ï¼Œååé‡æå‡5.1å€ï¼‰ã€‚ é‡æ–°é…ç½®èƒ½åŠ›ï¼šé€šè¿‡æ·»åŠ æ–°æœåŠ¡å™¨è¿›è¡Œç³»ç»Ÿé‡é…ç½®ï¼ŒåŒæ—¶ç»§ç»­æ­£ç¡®å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„èƒ½åŠ›ã€‚å®éªŒä¸­ï¼Œä¸»æœåŠ¡å™¨åœ¨ 10 ç§’æ—¶è¢«æ€æ‰ï¼Œå¼€å§‹é‡é…ç½®è¿‡ç¨‹ã€‚ä½¿ç”¨ YCSB å·¥ä½œè´Ÿè½½å˜ä½“ï¼Œ100 ä¸ªå®¢æˆ·ç«¯æŒç»­å†™å…¥ï¼Œ100 ä¸ªå®¢æˆ·ç«¯æŒç»­è¯»å–ã€‚é‡é…ç½®æœŸé—´ï¼Œå†™å…¥æ“ä½œä¼šé˜»å¡ï¼Œä½†è¯»å–å¯ä»¥ç»§ç»­ã€‚å®éªŒç»“æœæ˜¾ç¤º vKV å¯ä»¥åœ¨é‡é…ç½®æœŸé—´ç»§ç»­æä¾›è¯»å–æœåŠ¡ã€‚ ç§Ÿçº¦å¯¹è¯»å–æ€§èƒ½çš„å½±å“ï¼šå†™å…¥å¯†é›†å‹å·¥ä½œè´Ÿè½½ï¼ˆ50%æˆ–100%å†™å…¥ï¼‰ï¼Œå¢åŠ å‰¯æœ¬ä¼šé™ä½æ€§èƒ½ï¼Œå› ä¸ºå†™å…¥åœ¨ä¸»æœåŠ¡å™¨é‡åˆ°æ›´å¤šå¼€é”€ï¼Œä¸”å…¶å®ƒå‰¯æœ¬å¤„ç†çš„è¯»å–ä¸è¶³ä»¥æŠµæ¶ˆæˆæœ¬ã€‚å¯¹äºè¯»å–å¯†é›†å‹å·¥ä½œè´Ÿè½½ï¼Œå¢åŠ å‰¯æœ¬å¯ä»¥æå‡æ€§èƒ½ï¼Œä¾‹å¦‚ï¼ŒYCSB 5%å’Œ0%å†™å…¥æƒ…å†µä¸‹ï¼Œ3å°æœåŠ¡å™¨åˆ†åˆ«è¾¾åˆ°å•æœåŠ¡å™¨1.7å€å’Œ2.3å€çš„ååé‡ã€‚ ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4 4 æ€»ç»“ ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.1 4.1 GroveKVç³»ç»Ÿ GroveKVç‰¹ç‚¹ï¼š å®¹é”™ã€çº¿æ€§åŒ–çš„é”®å€¼ï¼ˆKVï¼‰æœåŠ¡ã€‚ æ“ä½œï¼ˆPut/Getï¼‰exactlyonceã€‚ å´©æºƒå®‰å…¨ä¸”å¯é‡é…ç½®ã€‚ è¦è¿›è¡Œé‡é…ç½®ï¼ŒGroveKVä½¿ç”¨configserviceç®¡ç†æœåŠ¡å™¨æ›´æ”¹ã€‚å¦‚æœæ²¡æœ‰configserviceï¼Œç±»ä¼¼VMWare-FTçš„é—®é¢˜ï¼Œå³ä¸¤ä¸ªå¤‡ä»½å¯èƒ½æ˜¯ç½‘ç»œçš„å½¼æ­¤åˆ†åŒºå¹¶ä¸”éƒ½æƒ³æˆä¸ºä¸»åˆ†åŒºã€‚è¿™å¯ä»¥é€šè¿‡ZooKeeperä¹‹ç±»çš„é…ç½®æœåŠ¡è§£å†³ã€‚ lab3ä¹Ÿæ˜¯ä¸€ä¸ªå®¹é”™KVæœåŠ¡ï¼Œä½†GroveKVä½¿ç”¨ä¸»/å¤‡ä»½å¤åˆ¶è€Œä¸æ˜¯Raftã€‚å…³é”®æ“ä½œå¦‚ä¸‹ï¼š å¤åˆ¶ï¼šPrimaryä½¿ç”¨goroutineså¤åˆ¶åˆ°å…¶ä»–æœåŠ¡å™¨ï¼ŒåŸºäºRPCã€‚æ‰§è¡Œæ“ä½œæ—¶éœ€è¦æŒæœ‰é”ã€‚ é‡é…ç½®ï¼šå°é—­å½“å‰çš„æœåŠ¡å™¨ç»„ï¼Œä»ä¸­è·å–çŠ¶æ€å‰¯æœ¬ï¼Œå®‰è£…åˆ°æ–°æœåŠ¡å™¨ã€‚ä½¿ç”¨epochç¼–å·å¤„ç†å¹¶å‘é‡é…ç½®ã€‚ åŸºäºç§Ÿçº¦çš„è¯»å–ï¼šæœåŠ¡å™¨ä¸è·Ÿä»»ä½•äººåè°ƒå›å¤Getè¯·æ±‚ã€‚ ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:4:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.2 4.2 Groveæ ¸å¿ƒ åœ¨æ­£å¼éªŒè¯é¢†åŸŸï¼ŒGrove çš„æ ¸å¿ƒåœ¨äºè¯æ˜ä»£ç åœ¨æ‰€æœ‰å¯èƒ½åœºæ™¯ä¸‹å‡èƒ½è¡¨ç°å¾—å½“ï¼Œè¿™ä¸€è¿‡ç¨‹è¦æ±‚å¯¹ä»£ç æ‰§è¡Œçš„æ•°å­¦æ¨¡å‹æœ‰æ·±åˆ»ç†è§£ï¼Œä»¥åŠå¯¹ç³»ç»Ÿè¡Œä¸ºâ€œæ­£ç¡®â€çš„æ˜ç¡®å®šä¹‰ã€‚é€šè¿‡å¼•å…¥æœºæ¢°è¯æ˜æ£€æŸ¥å™¨ï¼ŒGrove å¤§å¹…é™ä½äº†å¼€å‘è€…åœ¨è¯æ˜è¿‡ç¨‹ä¸­çŠ¯é”™çš„å¯èƒ½æ€§ã€‚ åœ¨ Grove ä¸­ï¼Œè§„èŒƒç”±å‰æ¡ä»¶å’Œåæ¡ä»¶æ„æˆï¼Œç”¨äºæè¿°æ“ä½œå‰åçš„ç³»ç»ŸçŠ¶æ€ã€‚ä»¥ GroveKV ä¸ºä¾‹ï¼ŒPut å’Œ Get æ“ä½œçš„è§„èŒƒä¸ä»…é™å®šäº†æ“ä½œçš„é¢„æœŸç»“æœï¼Œè¿˜æ˜ç¡®äº†æ•°æ®æ‰€æœ‰æƒçš„è½¬ç§»ã€‚ Concurrent Separation Logicï¼ˆCSLï¼‰æ˜¯ä¸€ç§é’ˆå¯¹å¹¶å‘ç¨‹åºçš„å½¢å¼åŒ–éªŒè¯æ–¹æ³•ï¼ŒGrove å¯¹å…¶è¿›è¡Œäº†åˆ›æ–°æ€§çš„æ‹“å±•ï¼Œä½¿ä¹‹é€‚ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚CSL å¼ºè°ƒåŸºäºèµ„æºæ‰€æœ‰æƒçš„ä»£ç åˆ†æï¼Œå…¶ä¸­â€œå †æŒ‡å‘â€æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ï¼Œå®ƒç¡®ä¿äº†æ•°æ®çš„ä¸€è‡´æ€§ä¸å—å¹¶å‘è®¿é—®çš„å½±å“ã€‚ åœ¨ Grove ä¸­ï¼Œä¸å˜é‡æŒ‡çš„æ˜¯ç³»ç»Ÿè¿è¡Œä¸­å¿…é¡»å§‹ç»ˆä¿æŒä¸ºçœŸçš„å±æ€§ï¼Œè€Œæ—¶é—´æœ‰ç•Œä¸å˜é‡ï¼ˆtinvï¼‰åˆ™è¿›ä¸€æ­¥é™åˆ¶äº†ç‰¹å®šèµ„æºçš„æœ‰æ•ˆæœŸã€‚ä¾‹å¦‚ï¼ŒGetTimeRange å‡½æ•°å…è®¸åœ¨ç§Ÿçº¦æœªåˆ°æœŸçš„æƒ…å†µä¸‹ï¼Œä¸´æ—¶è®¿é—®åº•å±‚èµ„æºï¼Œè¿™åœ¨å¤„ç†åŸºäºç§Ÿçº¦çš„è¯»å–æ—¶å°¤ä¸ºå…³é”®ã€‚ å°½ç®¡æ­£å¼éªŒè¯èƒ½å¤Ÿæ˜¾è‘—å‡å°‘æŸäº›ç±»å‹çš„é”™è¯¯ï¼Œä½†å®ƒå¹¶éä¸‡èƒ½è¯ã€‚éªŒè¯ä¸èƒ½ä¿è¯æ‰€æœ‰å®é™…ä¸­å¯èƒ½é‡åˆ°çš„é—®é¢˜éƒ½è¢«è§£å†³ï¼Œç‰¹åˆ«æ˜¯é‚£äº›æ¶‰åŠç³»ç»Ÿæ´»æ€§æ€§çš„é—®é¢˜ï¼Œå¦‚æ­»é”æˆ–é¥¥é¥¿ã€‚æ­¤å¤–ï¼Œç¼–å†™é«˜è´¨é‡çš„è¯æ˜å’Œæµ‹è¯•åŒæ ·éœ€è¦å¤§é‡æ—¶é—´å’Œç²¾åŠ›ï¼Œä¸å¼€å‘ä»£ç æ— å¼‚ï¼Œç”šè‡³æœ‰æ—¶è¿˜éœ€ç»å†é‡æ„çš„è¿‡ç¨‹ã€‚ ","date":"2024-08-30","objectID":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/:4:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Grove: a Separation-Logic Library for Verifying Distributed Systems (Extended Version)","uri":"/posts/09.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0grove/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 1 å®éªŒè¦æ±‚ åœ¨æœ¬å®éªŒä¸­ï¼Œè¦æ±‚å®ç°Raftï¼Œè¿™æ˜¯ä¸€ç§å¤åˆ¶çŠ¶æ€æœºåè®®ï¼Œç”¨äºæ„å»ºä¸€ä¸ªå®¹é”™çš„é”®/å€¼å­˜å‚¨ç³»ç»Ÿã€‚å®éªŒçš„å…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š å®ç°Raftï¼š å°†Raftå®ç°ä¸ºä¸€ä¸ªGoè¯­è¨€çš„å¯¹è±¡ç±»å‹ï¼ŒåŒ…å«ç›¸å…³çš„æ–¹æ³•ï¼Œä»¥ä¾¿ä½œä¸ºæ›´å¤§æœåŠ¡çš„ä¸€ä¸ªæ¨¡å—ä½¿ç”¨ã€‚ Raftå®ä¾‹ä¹‹é—´é€šè¿‡RPCé€šä¿¡ï¼Œä»¥ç»´æŒå¤åˆ¶çš„æ—¥å¿—ä¸€è‡´æ€§ã€‚ æ”¯æŒæ— é™æ•°é‡çš„ç¼–å·å‘½ä»¤ï¼ˆæ—¥å¿—æ¡ç›®ï¼‰ï¼Œå¹¶èƒ½å¤„ç†è¿™äº›æ¡ç›®çš„æäº¤ã€‚å½“ä¸€ä¸ªç‰¹å®šç´¢å¼•çš„æ—¥å¿—æ¡ç›®è¢«æäº¤åï¼ŒRaftå®ç°åº”å°†è¯¥æ¡ç›®å‘é€ç»™æ›´å¤§çš„æœåŠ¡æ‰§è¡Œã€‚ éµå¾ªè®ºæ–‡è®¾è®¡ï¼š éµå¾ªRaftè®ºæ–‡çš„è®¾è®¡ï¼Œé‡ç‚¹å‚è€ƒå›¾2ã€‚ å®ç°è®ºæ–‡ä¸­æè¿°çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ŒåŒ…æ‹¬æŒä¹…çŠ¶æ€çš„ä¿å­˜å’Œæ¢å¤ï¼Œå³ä½¿åœ¨èŠ‚ç‚¹æ•…éšœå’Œé‡å¯åä¹Ÿèƒ½ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚ ä¸éœ€è¦å®ç°é›†ç¾¤æˆå‘˜å˜æ›´çš„éƒ¨åˆ†ï¼ˆè®ºæ–‡ç¬¬å…­èŠ‚ï¼‰ã€‚ è®ºæ–‡å›¾2: Raftäº¤äº’å›¾ï¼š æˆ‘çš„å®éªŒä»£ç ä»“åº“ï¼šhttps://github.com/HeZephyr/MIT6.5840/tree/main/src/raftï¼Œå·²é€šè¿‡å‹åŠ›æµ‹è¯•ï¼Œä»£ç ä¸¥æ ¼éµå®ˆä¸Šè¿°æŒ‰è¦æ±‚å®ç°ã€‚ æ³¨æ„ï¼šä¸‹è¿°æ‰€è´´ä»£ç ä¸ºäº†ç®€æ´ä»¥åŠåˆ†å—ï¼Œè¿›è¡Œäº†ä¸€å®šç¨‹åº¦çš„åˆ å‡ï¼Œå¦‚æœéœ€è¦å¤ç°ï¼Œå¯ä»¥å‰å¾€ä»“åº“ã€‚ ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 2 å®éªŒè®¾è®¡ ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 2.1 æ•´ä½“ç»“æ„ æ­¤Raftç»“æ„ä½“åŸºäºè®ºæ–‡å›¾2ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å…¶ä¸­ä»‹ç»çš„å­—æ®µä»¥åŠlabè‡ªå¸¦çš„å­—æ®µï¼Œå…¶ä¸­å…¶ä»–å±æ€§è®ºæ–‡ä¸­ä¹Ÿé—´æ¥ç®€è¿°å’Œæ”¯æŒï¼Œä»¥ç¡®ä¿RaftèŠ‚ç‚¹èƒ½å¤Ÿé«˜æ•ˆã€ç¨³å®šåœ°è¿ä½œã€‚å¦‚é€‰ä¸¾å®šæ—¶å™¨å’Œå¿ƒè·³å®šæ—¶å™¨ï¼Œè¢«æ˜ç¡®åœ°çº³å…¥äº†Raftç»“æ„ä½“ä¸­ã€‚è¿™äº›å®šæ—¶å™¨å¯¹äºè§¦å‘å…³é”®çš„ç³»ç»Ÿè¡Œä¸ºè‡³å…³é‡è¦â€”â€”é€‰ä¸¾å®šæ—¶å™¨ç¡®ä¿åœ¨å¿…è¦æ—¶å‘èµ·é€‰ä¸¾è¿‡ç¨‹ï¼Œè€Œå¿ƒè·³å®šæ—¶å™¨åˆ™ç»´æŒç€é¢†å¯¼è€…ä¸è·Ÿéšè€…ä¹‹é—´çš„è¿æ¥ï¼Œé˜²æ­¢ä¸å¿…è¦çš„é€‰ä¸¾ã€‚ æ¡ä»¶å˜é‡ï¼ˆsync.Condï¼‰çš„å¼•å…¥åˆ™æ˜¯ä¸ºäº†ç²¾å¦™åœ°æ§åˆ¶ä¸¤ä¸ªæ ¸å¿ƒåå°goroutineçš„æ“ä½œèŠ‚å¥ï¼šæ—¥å¿—åº”ç”¨goroutineï¼ˆapplierï¼Œåªéœ€è¦ä¸€ä¸ªï¼Œä¸“é—¨ç”¨äºç›‘æ§æ—¥å¿—æ¡ç›®çš„æäº¤çŠ¶æ€ï¼Œä¸€æ—¦æ—¥å¿—æ¡ç›®è¢«ç¡®è®¤æäº¤ï¼Œå®ƒå°†è´Ÿè´£å°†è¿™äº›æ¡ç›®åº”ç”¨åˆ°çŠ¶æ€æœºä¸­ã€‚ï¼‰å’Œæ—¥å¿—å¤åˆ¶goroutineï¼ˆreplicatorï¼Œè´Ÿè´£è¿›è¡Œæ—¥å¿—æ¡ç›®çš„åŒæ­¥ã€‚è€ƒè™‘åˆ°é›†ç¾¤ä¸­æ¯ä¸ªpeeréƒ½éœ€è¦ä¸é™¤äº†è‡ªèº«ä»¥å¤–çš„å…¶å®ƒpeerè¿›è¡Œæ—¥å¿—åŒæ­¥ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦len(peers) - 1ä¸ªreplicator goroutinesæ¥åˆ†åˆ«å¤„ç†ä¸æ¯ä¸ªpeerçš„äº¤äº’ï¼‰ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªgoroutine tickerè´Ÿè´£å®šæœŸæ£€æŸ¥é€‰ä¸¾å’Œå¿ƒè·³çš„è¶…æ—¶ï¼Œç¡®ä¿åœ¨é€‚å½“çš„æ—¶é—´é—´éš”å†…è§¦å‘é€‰ä¸¾è¿‡ç¨‹æˆ–å‘é€å¿ƒè·³ä¿¡å·ã€‚ type Raft struct { mu sync.RWMutex // Lock to protect shared access to this peer's state, to use RWLock for better performance peers []*labrpc.ClientEnd // RPC end points of all peers persister *Persister // Object to hold this peer's persisted state me int // this peer's index into peers[] dead int32 // set by Kill() // Persistent state on all servers(Updated on stable storage before responding to RPCs) currentTerm int // latest term server has seen(initialized to 0 on first boot, increases monotonically) votedFor int // candidateId that received vote in current term(or null if none) logs []LogEntry // log entries; each entry contains command for state machine, and term when entry was received by leader(first index is 1) // Volatile state on all servers commitIndex int // index of highest log entry known to be committed(initialized to 0, increases monotonically) lastApplied int // index of highest log entry applied to state machine(initialized to 0, increases monotonically) // Volatile state on leaders(Reinitialized after election) nextIndex []int // for each server, index of the next log entry to send to that server(initialized to leader last log index + 1) matchIndex []int // for each server, index of highest log entry known to be replicated on server(initialized to 0, increases monotonically) // other properties state NodeState // current state of the server electionTimer *time.Timer // timer for election timeout heartbeatTimer *time.Timer // timer for heartbeat applyCh chan ApplyMsg // channel to send apply message to service applyCond *sync.Cond // condition variable for apply goroutine replicatorCond []*sync.Cond // condition variable for replicator goroutine } func Make(peers []*labrpc.ClientEnd, me int, persister *Persister, applyCh chan ApplyMsg) *Raft { rf := \u0026Raft{ mu: sync.RWMutex{}, peers: peers, persister: persister, me: me, dead: 0, currentTerm: 0, votedFor: -1, logs: make([]LogEntry, 1), // dummy entry at index 0 commitIndex: 0, lastApplied: 0, nextIndex: make([]int, len(peers)), matchIndex: make([]int, len(peers)), state: Follower, electionTimer: time.NewTimer(RandomElectionTimeout()), heartbeatTimer: time.NewTimer(StableHeartbeatTimeout()), applyCh: applyCh, replicatorCond: make([]*sync.Cond, len(peers)), } // initialize from state persisted before a crash rf.readPersist(persister.ReadRaftState()) // should use mu to protect applyCond, avoid other goroutine to change the critical section rf.applyCond = sync.NewCond(\u0026rf.mu) // initialize nextIndex and matchIndex, and start replicator goroutine for peer := range peers { rf.matchIndex[peer], rf.nextIndex[peer] = 0, rf.getLastLog().Index+1 if peer != rf.me { rf.replicatorCond[peer] = sync.NewCond(\u0026sync.Mutex{}) // start replicator goroutine to send log entries to peer go rf.replicator(peer) } } // start ticker goroutine to start elections go rf.ticker() // start apply goroutine to apply log entries to state machine go rf.applier() return rf } ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:2:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 2.2 lab3Aï¼šé¢†å¯¼è€…é€‰ä¸¾ æ­¤ä»»åŠ¡éœ€è¦å®ç°Rafté¢†å¯¼äººé€‰ä¸¾å’Œå¿ƒè·³ï¼ˆé€šè¿‡ä¸é™„åŠ æ—¥å¿—æ¡ç›®çš„RPCï¼‰ã€‚å¯¹äºè¿™ä¸ªè¦æ±‚ï¼Œè®ºæ–‡ä¸­å…¶å®ç»™å‡ºäº†çŠ¶æ€è½¬ç§»å›¾ï¼ŒæŒ‡å¯¼æˆ‘ä»¬æ€ä¹ˆå»åšã€‚è¿™ä¸ªé€‰ä¸¾æµç¨‹é€»è¾‘å¦‚ä¸‹ï¼š åœ¨lab3Aå®ç°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ³¨æ„å¦‚ä¸‹å‡ ç‚¹ï¼š å½“å‘èµ·æŠ•ç¥¨æ—¶ï¼ŒåŠ¡å¿…ä½¿ç”¨goroutineå¹¶è¡Œå‘èµ·RPCè°ƒç”¨ï¼Œä»¥é¿å…é˜»å¡tickeråç¨‹ã€‚è¿™æ ·ï¼Œå³ä½¿åœ¨ç­‰å¾…æŠ•ç¥¨å“åº”æœŸé—´ï¼Œå€™é€‰è€…ï¼ˆCandidateï¼‰ä»èƒ½å“åº”æ–°çš„é€‰ä¸¾è¶…æ—¶ï¼Œä»è€Œæœ‰æœºä¼šè‡ªå¢ä»»æœŸå¹¶å¯åŠ¨æ–°ä¸€è½®çš„é€‰ä¸¾ã€‚ æœ‰ä¸¤ç§å¸¸è§çš„å®ç°æŠ•ç¥¨ç»Ÿè®¡çš„æ–¹å¼ï¼šä¸€ç§æ˜¯åœ¨å‡½æ•°ä½œç”¨åŸŸå†…å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶åˆ©ç”¨é—­åŒ…æ¥ç»´æŠ¤æŠ•ç¥¨è®¡æ•°ï¼›å¦ä¸€ç§æ˜¯åœ¨Raftç»“æ„ä½“ä¸­ç»´æŠ¤ä¸€ä¸ªå…¨å±€çš„voteCntå˜é‡ã€‚ä¸ºäº†ä¿æŒRaftç»“æ„ä½“çš„ç®€æ´ï¼Œæ¨èé‡‡ç”¨å±€éƒ¨å˜é‡å’Œé—­åŒ…çš„æ–¹æ¡ˆã€‚ å¯¹äºè¿‡æœŸçš„RPCè¯·æ±‚å›å¤ï¼Œåº”ç›´æ¥å¿½ç•¥ï¼Œä¸ä½œä»»ä½•å¤„ç†ã€‚è¿™æ˜¯å› ä¸ºRaftåè®®å‡è®¾ç½‘ç»œç¯å¢ƒä¸å¯é ï¼Œå¯èƒ½å‘ç”Ÿçš„å»¶è¿Ÿæˆ–é‡æ’­ä¸åº”å½±å“å½“å‰çš„å†³ç­–æµç¨‹ã€‚ å¦‚æœåœ¨RPCé€šä¿¡ä¸­ï¼ŒèŠ‚ç‚¹Aå‘ç°å…¶ä»»æœŸå°äºèŠ‚ç‚¹Bçš„ä»»æœŸï¼Œä¸è®ºèŠ‚ç‚¹Aå½“å‰çš„è§’è‰²å¦‚ä½•ï¼Œéƒ½åº”ç«‹å³è½¬æ¢ä¸ºè·Ÿéšè€…ï¼ˆFollowerï¼‰ã€‚è¿™æ˜¯ä¸ºäº†ç»´æŠ¤ä»»æœŸçš„æƒå¨æ€§ï¼Œç¡®ä¿é›†ç¾¤çš„ä¸€è‡´æ€§ã€‚ ä¸ºé˜²æ­¢å¤šä¸ªèŠ‚ç‚¹å‡ ä¹åŒæ—¶å¯åŠ¨é€‰ä¸¾ï¼Œå¯¼è‡´èµ„æºæµªè´¹å’Œæ½œåœ¨çš„é¢†å¯¼æƒäº‰å¤ºï¼Œåº”ä¸ºé€‰ä¸¾è¶…æ—¶è®¾ç½®ä¸€ä¸ªéšæœºçš„è¯¯å·®èŒƒå›´ï¼ˆå¦‚150~300msï¼‰ï¼Œä»¥æ‹‰é•¿ä¸åŒèŠ‚ç‚¹é€‰ä¸¾çš„æ—¶é—´é—´éš”ï¼Œè¿™é‡Œé‡‡ç”¨æ—¶é—´æˆ³ä½œä¸ºéšæœºç§å­ã€‚ä¸”æ¯ä¸€æ¬¡ä¸€ä¸ªèŠ‚ç‚¹é‡ç½®è‡ªå·±çš„é€‰ä¸¾å®šæ—¶å™¨æ—¶ï¼Œéƒ½éœ€è¦é‡æ–°é€‰æ‹©ä¸€ä¸ªéšæœºçš„è¶…æ—¶æ—¶é—´ã€‚é¿å…æœåŠ¡å™¨ä¼šä»¥æå°çš„æ¦‚ç‡é€‰æ‹©ç›¸åŒçš„éšæœºè¶…æ—¶æ—¶é—´ï¼Œé‚£ä¹ˆä¼šæ°¸è¿œå¤„äºåˆ†å‰²é€‰ç¥¨çš„åœºæ™¯ä¸­ã€‚ Go RPC ä»…å‘é€åç§°ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„ç»“æ„ä½“å­—æ®µã€‚å­ç»“æ„è¿˜å¿…é¡»å…·æœ‰å¤§å†™çš„å­—æ®µåç§°ï¼ˆä¾‹å¦‚æ•°ç»„ä¸­æ—¥å¿—è®°å½•çš„å­—æ®µï¼‰ã€‚è¿™ labgob è½¯ä»¶åŒ…ä¼šè­¦å‘Šæ‚¨è¿™ä¸€ç‚¹ï¼›ä¸è¦å¿½è§†è­¦å‘Šã€‚ åœ¨åŒä¸€ä¸ªä»»æœŸå†…ï¼ŒFolloweråªèƒ½æŠ•å‡ºä¸€ç¥¨ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢å‡ºç°å¤šä¸ªLeaderçš„æƒ…å†µã€‚ç¥¨æ•°çš„åˆ·æ–°åº”åœ¨ä»»æœŸè½¬æ¢æ—¶è¿›è¡Œï¼Œä»¥ç¡®ä¿æŠ•ç¥¨çš„æœ‰æ•ˆæ€§å’Œä¸€è‡´æ€§ã€‚ ä¸ºäº†æé«˜å¹¶å‘æ€§èƒ½ï¼Œåº”å°½é‡ç¼©çŸ­ä¸´ç•ŒåŒºçš„é•¿åº¦ã€‚åˆç†çš„é”ä½¿ç”¨ç­–ç•¥æ˜¯åªåœ¨çœŸæ­£éœ€è¦ä¿æŠ¤å…±äº«èµ„æºçš„æœ€å°æ—¶é—´å†…ä½¿ç”¨é”ã€‚ æ ¸å¿ƒçš„Tickerå®ç°ï¼š func (rf *Raft) ticker() { for rf.killed() == false { select { case \u003c-rf.electionTimer.C: rf.mu.Lock() rf.ChangeState(Candidate) rf.currentTerm += 1 // start election rf.StartElection() rf.electionTimer.Reset(RandomElectionTimeout()) // reset election timer in case of split vote rf.mu.Unlock() case \u003c-rf.heartbeatTimer.C: rf.mu.Lock() if rf.state == Leader { // should send heartbeat rf.BroadcastHeartbeat(true) rf.heartbeatTimer.Reset(StableHeartbeatTimeout()) } rf.mu.Unlock() } } } StartElectionå‡½æ•°å®ç°ï¼š func (rf *Raft) StartElection() { rf.votedFor = rf.me args := rf.genRequestVoteArgs() grantedVotes := 1 for peer := range rf.peers { if peer == rf.me { continue } go func(peer int) { reply := new(RequestVoteReply) if rf.sendRequestVote(peer, args, reply) { rf.mu.Lock() defer rf.mu.Unlock() if args.Term == rf.currentTerm \u0026\u0026 rf.state == Candidate { if reply.VoteGranted { grantedVotes += 1 // check over half of the votes if grantedVotes \u003e len(rf.peers)/2 { rf.ChangeState(Leader) rf.BroadcastHeartbeat(true) } } else if reply.Term \u003e rf.currentTerm { rf.ChangeState(Follower) rf.currentTerm, rf.votedFor = reply.Term, -1 } } } }(peer) } } RequestVoteRPCä¸¥æ ¼æŒ‰ç…§å›¾2æè¿°å®ç°ï¼š func (rf *Raft) RequestVote(args *RequestVoteArgs, reply *RequestVoteReply) { rf.mu.Lock() defer rf.mu.Unlock() defer DPrintf(\"{Node %v}'s state is {state %v, term %v}} after processing RequestVote, RequestVoteArgs %v and RequestVoteReply %v \", rf.me, rf.state, rf.currentTerm, args, reply) // Reply false if term \u003c currentTerm(Â§5.1) // if the term is same as currentTerm, and the votedFor is not null and not the candidateId, then reject the vote(Â§5.2) if args.Term \u003c rf.currentTerm || (args.Term == rf.currentTerm \u0026\u0026 rf.votedFor != -1 \u0026\u0026 rf.votedFor != args.CandidateId) { reply.Term, reply.VoteGranted = rf.currentTerm, false return } if args.Term \u003e rf.currentTerm { rf.ChangeState(Follower) rf.currentTerm, rf.votedFor = args.Term, -1 } // if candidate's log is not up-to-date, reject the vote(Â§5.4) if !rf.isLogUpToDate(args.LastLogIndex, args.LastLogTerm) { reply.Term, reply.VoteGranted = rf.currentTerm, false return } rf.votedFor = args.CandidateId rf.electionTimer.Reset(RandomElectionTimeout()) reply.Term, reply.VoteGranted = rf.currentTerm, true } ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:2:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 2.3 lab3Bï¼šæ—¥å¿— åœ¨Lab3Bé˜¶æ®µï¼Œæˆ‘ä»¬çš„ç›®æ ‡è½¬å‘å®ç°Raftåè®®ä¸­è‡³å…³é‡è¦çš„æ—¥å¿—å¤åˆ¶æœºåˆ¶ã€‚å…¶ä¸­å…¥å£æ˜¯Startå‡½æ•°ï¼ˆåº”ç”¨ç¨‹åºä¸Raftçš„æ¥å£ï¼‰ã€‚å…·ä½“çš„æ—¥å¿—å¤åˆ¶æµç¨‹ï¼š ä¸€æ—¦Leaderæ¥æ”¶åˆ°æ–°çš„æ—¥å¿—æ¡ç›®ï¼Œå®ƒé¦–å…ˆä¼šåœ¨è‡ªå·±çš„æ—¥å¿—ä¸­è¿½åŠ è¿™ä¸ªæ¡ç›®ã€‚ éšåï¼ŒLeaderé€šè¿‡BroadcastHeartbeatå‡½æ•°å°†è¿™ä¸ªæ—¥å¿—æ¡ç›®å¹¿æ’­è‡³é›†ç¾¤ä¸­çš„æ‰€æœ‰Peerï¼Œç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½åŒæ­¥æœ€æ–°çš„çŠ¶æ€ã€‚æ­¤è¿‡ç¨‹æ¶‰åŠå¯¹æ—¥å¿—æ¡ç›®çš„æ ¡éªŒä¸å†²çªè§£å†³ï¼Œç¡®ä¿æ¯ä¸ªPeerçš„æ—¥å¿—ä¿æŒä¸€è‡´ä¸”æœ€æ–°ã€‚ åœ¨æ—¥å¿—æ¡ç›®è¢«å‘é€ç»™Peersåï¼ŒLeaderä¼šç­‰å¾…æ¥è‡ªPeerçš„ç¡®è®¤å›å¤ã€‚åªæœ‰å½“Leaderæ”¶åˆ°å¤§å¤šæ•°Peerï¼ˆå³è¶…è¿‡åŠæ•°ï¼‰çš„ç¡®è®¤ï¼Œè¡¨æ˜è¿™äº›Peerå·²ç»æˆåŠŸå¤åˆ¶äº†æ—¥å¿—æ¡ç›®ï¼ŒLeaderæ‰èƒ½è®¤ä¸ºè¯¥æ—¥å¿—æ¡ç›®å·²ç»è¢«å®‰å…¨åœ°å¤åˆ¶ã€‚è¿™æ˜¯Raftåè®®ä¸­â€œå¤šæ•°åŸåˆ™â€çš„ä½“ç°ï¼Œç¡®ä¿äº†å³ä½¿åœ¨éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä»ç„¶èƒ½å¤Ÿè¾¾æˆä¸€è‡´ã€‚å½“ç„¶ï¼Œä¹Ÿéœ€è¦æ ¹æ®å›å¤ç¡®è®¤è‡ªå·±Leaderçš„åœ°ä½ï¼Œå¦‚æœä¸å†æ˜¯Leaderï¼Œéœ€è¦æ›´æ”¹ä¸ºFollowerã€‚ ä¸€æ—¦æ—¥å¿—æ¡ç›®è¢«ç¡®è®¤å¤åˆ¶åˆ°äº†å¤§å¤šæ•°èŠ‚ç‚¹ï¼ŒLeaderå°±ä¼šæ ‡è®°è¿™ä¸ªæ¡ç›®ä¸ºå·²æäº¤ï¼ˆcommittedï¼‰ã€‚éšåï¼ŒLeaderä¼šé€šè¿‡AppendEntries RPCå°†æœ€æ–°çš„LeaderCommitä¿¡æ¯å¹¿æ’­ç»™æ‰€æœ‰Peerï¼ŒæŒ‡ç¤ºå®ƒä»¬å“ªäº›æ—¥å¿—æ¡ç›®ç°åœ¨å¯ä»¥è¢«æäº¤å¹¶åº”ç”¨åˆ°å„è‡ªçš„çŠ¶æ€æœºä¸­ã€‚æ¯ä¸ªPeeræ ¹æ®æ¥æ”¶åˆ°çš„LeaderCommitå€¼æ¥å†³å®šå…¶æ—¥å¿—ä¸­å“ªäº›æ¡ç›®å¯ä»¥è¢«æäº¤ï¼Œä»è€Œç¡®ä¿æ‰€æœ‰æ´»è·ƒPeerçš„çŠ¶æ€æœºä¿æŒä¸€è‡´ã€‚ åœ¨lab3Bå®ç°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ³¨æ„å¦‚ä¸‹å‡ ç‚¹ï¼š åœ¨å‘é€RPCã€æ¥æ”¶RPCã€æ¨é€å’Œæ¥æ”¶channelæ—¶ï¼Œç»å¯¹ä¸è¦æŒæœ‰é”ï¼Œå¦åˆ™ææ˜“å¼•å‘æ­»é”ã€‚è¿™åœ¨lockingåšå®¢ä¸­æœ‰è¯¦ç»†ä»‹ç»ï¼Œåº”æ—¶åˆ»ç‰¢è®°ã€‚ä½¿ç”¨è¯»å†™é”æ—¶ï¼Œå¯¹äºåªè¯»æ“ä½œï¼Œåªéœ€æŒæœ‰è¯»é”ï¼Œé¿å…ä¸å¿…è¦çš„å†™é”æŒæœ‰ï¼Œä»¥æé«˜å¹¶å‘æ€§èƒ½ã€‚ å¯¹äºè¿‡æœŸçš„RPCè¯·æ±‚å›å¤ï¼Œåº”ç›´æ¥å¿½ç•¥ï¼Œé¿å…æ‰§è¡Œä»»ä½•ä¸šåŠ¡é€»è¾‘ æ ¹æ®å›¾2çš„è§„å®šï¼ŒRaft Leaderåªèƒ½æäº¤å±äºå½“å‰ä»»æœŸçš„æ—¥å¿—æ¡ç›®ï¼Œä¸å¾—æäº¤å‰ä»»æœŸçš„æ—¥å¿—ã€‚åœ¨æ ¹æ®matchIndex[]åˆ¤æ–­æ˜¯å¦å¯ä»¥æäº¤æ—¥å¿—æ—¶ï¼Œå¿…é¡»æ£€æŸ¥è¯¥æ—¥å¿—çš„ä»»æœŸæ˜¯å¦ä¸å½“å‰Leaderçš„ä»»æœŸç›¸åŒ¹é…ã€‚ Followerå¯¹Leaderçš„leaderCommitåº”æ— æ¡ä»¶æœä»ï¼Œæ— éœ€é¢å¤–åˆ¤æ–­ã€‚ Leaderéœ€ç»´æŠ¤å¥½matchIndex[]ï¼ˆè·Ÿè¸ªFollowerçš„æäº¤çŠ¶æ€ï¼‰å’ŒnextIndex[]ï¼ˆè¿½è¸ªFollowerçš„æ—¥å¿—å¤åˆ¶è¿›åº¦ï¼‰ï¼Œå¹¶åœ¨Leaderå´©æºƒåæ­£ç¡®åœ°åˆå§‹åŒ–è¿™ä¸¤ä¸ªæ•°ç»„ã€‚ å½“Followeræ¥æ”¶åˆ°æ—¥å¿—æ—¶ï¼Œéœ€æ£€æŸ¥RPCä¸­Leaderè®¤å®šçš„å½“å‰Followerçš„prevLogIndexå’ŒprevLogTermï¼Œåˆ¤æ–­æ—¥å¿—æ˜¯å¦å­˜åœ¨å†²çªï¼Œè‹¥å­˜åœ¨å†²çªï¼Œéœ€ç”±Leaderä»å†²çªç‚¹å¼€å§‹å¼ºåˆ¶è¦†ç›–Followerçš„æ—¥å¿—ã€‚ æ–°çš„Leaderçš„æ—¥å¿—éœ€ç¡®ä¿åŒ…å«äº†æ‰€æœ‰å·²æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚Followerå¯èƒ½åœ¨Leaderæäº¤æ—¥å¿—æœŸé—´è¿›å…¥ä¸å¯ç”¨çŠ¶æ€ï¼Œä»è€Œå¯¼è‡´è¢«é€‰ä¸ºæ–°Leaderçš„Followerå¯èƒ½è¦†ç›–å·²æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œé€‰ä¸¾æ—¶éœ€åŠ å…¥Leaderé™åˆ¶æœºåˆ¶ï¼Œå³Followeråªç»™ä»»æœŸå’Œæ—¥å¿—æ›´æ–°çš„CandidateæŠ•ç¥¨ï¼Œå…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š å¦‚æœä»»æœŸå·ä¸åŒï¼Œä»»æœŸå·è¾ƒå¤§çš„Candidateæ›´æ–°ï¼› å¦‚æœä»»æœŸå·ç›¸åŒï¼Œæ—¥å¿—ç´¢å¼•å€¼è¾ƒå¤§ï¼ˆå³æ—¥å¿—æ›´é•¿ï¼‰çš„Candidateæ›´æ–°ã€‚ æ ¸å¿ƒçš„AppendEntries RPCå®ç°ï¼š func (rf *Raft) AppendEntries(args *AppendEntriesArgs, reply *AppendEntriesReply) { // Your code here (3A, 3B). rf.mu.Lock() defer rf.mu.Unlock() defer DPrintf(\"{Node %v}'s state is {state %v, term %v}} after processing AppendEntries, AppendEntriesArgs %v and AppendEntriesReply %v \", rf.me, rf.state, rf.currentTerm, args, reply) // Reply false if term \u003c currentTerm(Â§5.1) if args.Term \u003c rf.currentTerm { reply.Term, reply.Success = rf.currentTerm, false return } // indicate the peer is the leader if args.Term \u003e rf.currentTerm { rf.currentTerm, rf.votedFor = args.Term, -1 } rf.ChangeState(Follower) rf.electionTimer.Reset(RandomElectionTimeout()) // Reply false if log doesnâ€™t contain an entry at prevLogIndex whose term matches prevLogTerm(Â§5.3) if args.PrevLogIndex \u003c rf.getFirstLog().Index { reply.Term, reply.Success = rf.currentTerm, false return } // check the log is matched, if not, return the conflict index and term // if an existing entry conflicts with a new one (same index but different terms), delete the existing entry and all that follow it(Â§5.3) if !rf.isLogMatched(args.PrevLogIndex, args.PrevLogTerm) { reply.Term, reply.Success = rf.currentTerm, false lastLogIndex := rf.getLastLog().Index // find the first index of the conflicting term if lastLogIndex \u003c args.PrevLogIndex { // the last log index is smaller than the prevLogIndex, then the conflict index is the last log index reply.ConflictIndex, reply.ConflictTerm = lastLogIndex+1, -1 } else { firstLogIndex := rf.getFirstLog().Index // find the first index of the conflicting term index := args.PrevLogIndex for index \u003e= firstLogIndex \u0026\u0026 rf.logs[index-firstLogIndex].Term == args.PrevLogTerm { index-- } reply.ConflictIndex, reply.ConflictTerm = index+1, args.PrevLogTerm } return } // append any new entries not already in the log firstLogIndex := rf.getFirstLog().Index for index, entry := range args.Entries { // find the junction of the existing log and the appended log. if entry.Index-firstLogIndex \u003e= len(rf.logs) || rf.logs[entry.Index-firstLogIndex].Term != entry.Term { rf.logs = append(rf.logs[:entry.Index-firstLogIndex], args.Entries[index:]...) break } } // If leaderCommit \u003e commitIndex, set commitIndex = min(leaderCommit, index of last new entry) (paper) newCommitIndex := Min(args.LeaderCommit, rf.getLastLog().Index) if newCommitIndex \u003e rf.commitIndex { rf.commitIndex = newCommitIndex rf.applyCond.Signal() } reply.Term, reply.Success = rf.currentTerm, true } replicateOnceRoundç”¨æ¥è°ƒç”¨AppendEntriesRPCï¼Œå¹¶æ ¹æ®replyç»§ç»­ç›¸åº”å¤„ç†ï¼š func (rf *Raft) replicateOnceRound(peer int) { rf.mu.RLock() if rf.state != Lea","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:2:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.4 2.4 lab3Cï¼šæŒä¹…åŒ– å¦‚æœåŸºäº Raft çš„æœåŠ¡å™¨é‡æ–°å¯åŠ¨ï¼Œå®ƒåº”è¯¥ä»ä¸­æ–­å¤„æ¢å¤æœåŠ¡ã€‚è¿™è¦æ±‚ Raft ä¿æŒåœ¨é‡å¯åä»ç„¶å­˜åœ¨çš„æŒä¹…çŠ¶æ€ã€‚è®ºæ–‡çš„å›¾ 2 æåˆ°äº†å“ªç§çŠ¶æ€åº”è¯¥æ˜¯æŒä¹…çš„ï¼Œå³logsã€currentTermå’ŒvotedForã€‚åœ¨Lab3Cä¸­ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡ä¾¿æ˜¯å®ç°persist()å’ŒreadPersist()è¿™ä¸¤ä¸ªæ ¸å¿ƒå‡½æ•°ï¼Œå‰è€…è´Ÿè´£ä¿å­˜Raftçš„çŠ¶æ€ï¼Œåè€…åˆ™æ˜¯åœ¨Raftå¯åŠ¨æ—¶æ¢å¤ä¹‹å‰ä¿å­˜çš„æ•°æ®ã€‚ readPersistå‡½æ•°å®ç°ï¼š func (rf *Raft) readPersist(data []byte) { if data == nil || len(data) \u003c 1 { // bootstrap without any state? return } r := bytes.NewBuffer(data) d := labgob.NewDecoder(r) var currentTerm, votedFor int var logs []LogEntry if d.Decode(\u0026currentTerm) != nil || d.Decode(\u0026votedFor) != nil || d.Decode(\u0026logs) != nil { DPrintf(\"{Node %v} fails to decode persisted state\", rf.me) } rf.currentTerm, rf.votedFor, rf.logs = currentTerm, votedFor, logs rf.lastApplied, rf.commitIndex = rf.getFirstLog().Index, rf.getFirstLog().Index } persistå‡½æ•°å®ç°ï¼š func (rf *Raft) encodeState() []byte { w := new(bytes.Buffer) e := labgob.NewEncoder(w) e.Encode(rf.currentTerm) e.Encode(rf.votedFor) e.Encode(rf.logs) return w.Bytes() } func (rf *Raft) persist() { rf.persister.SaveStateAndSnapshot(rf.encodeState(), nil) } å®ç°å¥½åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å…¥å£å¤„Makeè°ƒç”¨readPersistå³å¯ï¼Œå…³é”®éœ€è¦åœ¨ä»€ä¹ˆæ—¶å€™ä¿å­˜çŠ¶æ€å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦å¯¹æˆ‘ä»¬éœ€è¦æŒä¹…åŒ–çš„ä¸‰ä¸ªå­—æ®µä¿®æ”¹çš„æ—¶å€™å°±è¿›è¡Œpersistæ“ä½œã€‚å³persist()æ“ä½œåº”å½“åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹è¢«è§¦å‘ï¼š æ—¥å¿—æ¡ç›®æ›´æ–°ï¼šå½“æœ‰æ–°çš„æ—¥å¿—æ¡ç›®è¢«æ·»åŠ åˆ°logsä¸­ï¼Œæˆ–æ˜¯å·²æœ‰æ¡ç›®è¢«åˆ é™¤æˆ–æ›¿æ¢æ—¶ã€‚ ä»»æœŸå˜æ›´ï¼šå½“currentTermå‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚åœ¨é€‰ä¸¾æœŸé—´æˆ–æ¥æ”¶åˆ°æ›´é«˜ä»»æœŸçš„é¢†å¯¼è€…ä¿¡æ¯æ—¶ã€‚ æŠ•ç¥¨è¡Œä¸ºï¼šå½“votedForå­—æ®µè¢«æ›´æ–°ï¼Œæ„å‘³ç€èŠ‚ç‚¹æŠ•å‡ºäº†æ–°çš„ä¸€ç¥¨æˆ–å–æ¶ˆäº†ä¹‹å‰çš„æŠ•ç¥¨ã€‚ ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:2:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.5 2.5 lab3Dï¼šæ—¥å¿—å‹ç¼© æŒ‰ç…§ç›®å‰çš„æƒ…å†µï¼Œé‡æ–°å¯åŠ¨çš„æœåŠ¡å™¨ä¼šé‡æ”¾å®Œæ•´çš„ Raft æ—¥å¿—ä»¥æ¢å¤å…¶çŠ¶æ€ã€‚ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ªé•¿æœŸè¿è¡Œçš„æœåŠ¡æ¥è¯´ï¼Œæ°¸è¿œè®°å½•å®Œæ•´çš„ Raft æ—¥å¿—æ˜¯ä¸åˆ‡å®é™…çš„ã€‚éœ€è¦ä½¿ç”¨å¿«ç…§æœåŠ¡é…åˆï¼Œæ­¤æ—¶Raftä¼šä¸¢å¼ƒå¿«ç…§ä¹‹å‰çš„æ—¥å¿—æ¡ç›®ã€‚lab3Då°±æ˜¯éœ€è¦æˆ‘ä»¬å®ç°æ—¥å¿—å‹ç¼©ï¼Œå…·ä½“æ¥è¯´æ˜¯æ ¸å¿ƒæ˜¯Snapshotï¼ˆå¿«ç…§ä¿å­˜å‡½æ•°ï¼‰ä»¥åŠInstallSnapshotRPCï¼Œå¿«ç…§å‹ç¼©çš„æµç¨‹ï¼š æ¯ä¸ªpeeréƒ½ä¼šé€šè¿‡Snapshotæ•è·å½“å‰ç³»ç»ŸçŠ¶æ€çš„ä¸€ä¸ªå¿«ç…§ã€‚è¿™é€šå¸¸åŒ…æ‹¬ä½†ä¸é™äºçŠ¶æ€æœºçš„å½“å‰çŠ¶æ€ã€ä»»ä½•å¿…è¦çš„å…ƒæ•°æ®ã€ä»¥åŠå¿«ç…§ç”Ÿæˆæ—¶çš„ä»»æœŸä¿¡æ¯ã€‚ å½“Leaderè®¤ä¸ºæœ‰å¿…è¦å‘Followerå‘é€å¿«ç…§æ—¶ï¼Œå®ƒå°†å‘èµ·InstallSnapshotRPCè°ƒç”¨ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨Followerçš„æ—¥å¿—çŠ¶æ€ä¸Leaderä¸¥é‡è„±èŠ‚æ—¶ï¼Œä¾‹å¦‚æ—¥å¿—å†²çªæ— æ³•é€šè¿‡å¸¸è§„çš„AppendEntriesRPCè§£å†³ã€‚ Followeræ¥æ”¶åˆ°å¿«ç…§åï¼Œä¼šéªŒè¯å…¶å®Œæ•´æ€§å’Œä¸€è‡´æ€§ï¼Œç„¶ååº”ç”¨å¿«ç…§ä»¥æ›¿æ¢å…¶å½“å‰çŠ¶æ€å’Œæ—¥å¿—ã€‚è¿™åŒ…æ‹¬æ¸…é™¤å¿«ç…§ç‚¹ä¹‹å‰çš„æ‰€æœ‰æ—¥å¿—æ¡ç›®ï¼Œå¹¶å°†çŠ¶æ€æœºæ¢å¤åˆ°å¿«ç…§æ‰€è¡¨ç¤ºçš„çŠ¶æ€ã€‚ Followeråœ¨æˆåŠŸåº”ç”¨å¿«ç…§åï¼Œåº”é€šè¿‡RPCå›å¤å‘Leaderç¡®è®¤ï¼Œè¡¨æ˜å¿«ç…§å·²è¢«æ­£ç¡®å®‰è£…ã€‚Leaderæ®æ­¤æ›´æ–°å…¶matchIndexå’ŒnextIndexæ•°ç»„ï¼Œä»¥åæ˜ Followerçš„æœ€æ–°çŠ¶æ€ã€‚ åœ¨lab3Då®ç°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š åœ¨æ›´æ–° lastApplied æ—¶ï¼Œå¿…é¡»é‡‡ç”¨å‰ä¸€æ—¶åˆ»çš„ commitIndex å€¼ï¼Œè€Œéå®æ—¶çš„ rf.commitIndexã€‚è¿™æ˜¯å› ä¸ºï¼Œåœ¨æ‰§è¡Œ push applyCh è¿‡ç¨‹ä¸­ï¼Œrf.commitIndex å¯èƒ½å› å…¶ä»–æ“ä½œè€ŒåŠ¨æ€å˜åŒ–ï¼Œä½¿ç”¨å…¶å†å²å€¼å¯ä»¥ä¿è¯ lastApplied æ›´æ–°çš„å‡†ç¡®æ€§ã€‚ éœ€è¦æ³¨æ„ä½¿ç”¨CondInstallSnapshotæ¥éªŒè¯å¿«ç…§çš„æœ‰æ•ˆæ€§ã€‚ åœ¨ä¿®å‰ªlogçš„æ—¶å€™æ³¨æ„ç•™ä¸€ä¸ªdummy log ä½¿ç”¨ Max(rf.lastApplied, commitIndex) è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ commitIndex æ¥é¿å…å¹¶å‘ InstallSnapshot RPC å¯¼è‡´ lastApplied å›æ»š InstallSnapshot RPCå®ç°å¦‚ä¸‹ï¼š func (rf *Raft) InstallSnapshot(args *InstallSnapshotArgs, reply *InstallSnapshotReply) { rf.mu.Lock() defer rf.mu.Unlock() reply.Term = rf.currentTerm // reply immediately if term \u003c currentTerm if args.Term \u003c rf.currentTerm { return } if args.Term \u003e rf.currentTerm { rf.currentTerm, rf.votedFor = args.Term, -1 rf.persist() } rf.ChangeState(Follower) rf.electionTimer.Reset(RandomElectionTimeout()) // check the snapshot is more up-to-date than the current log if args.LastIncludedIndex \u003c= rf.commitIndex { return } go func() { rf.applyCh \u003c- ApplyMsg{ SnapshotValid: true, Snapshot: args.Data, SnapshotTerm: args.LastIncludedTerm, SnapshotIndex: args.LastIncludedIndex, } }() } Snapshotå‡½æ•°å®ç°å¦‚ä¸‹ï¼Œå®ƒæ¥æ”¶å®¢æˆ·ç«¯åˆ›å»ºçš„å¿«ç…§ã€‚ func (rf *Raft) Snapshot(index int, snapshot []byte) { rf.mu.Lock() defer rf.mu.Unlock() snapshotIndex := rf.getFirstLog().Index if index \u003c= snapshotIndex || index \u003e rf.getLastLog().Index { DPrintf(\"{Node %v} rejects replacing log with snapshotIndex %v as current snapshotIndex %v is larger in term %v\", rf.me, index, snapshotIndex, rf.currentTerm) return } // remove log entries up to index rf.logs = rf.logs[index-snapshotIndex:] rf.logs[0].Command = nil rf.persister.SaveStateAndSnapshot(rf.encodeState(), snapshot) } è¿˜æœ‰ä¸€ä¸ªCondInstallSnapshotï¼Œç”¨æ¥peeråˆ¤æ–­leaderå‘è¿‡æ¥çš„å¿«ç…§æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³ï¼Œåˆ™å®‰è£…å¿«ç…§ã€‚è¿™ä¸ªéœ€è¦ä¿®æ”¹åˆ°config.goæ–‡ä»¶ä¸­ã€‚ func (rf *Raft) CondInstallSnapshot(lastIncludedTerm int, lastIncludedIndex int, snapshot []byte) bool { rf.mu.Lock() defer rf.mu.Unlock() // outdated snapshot if lastIncludedIndex \u003c= rf.commitIndex { return false } // need dummy entry at index 0 if lastIncludedIndex \u003e rf.getLastLog().Index { rf.logs = make([]LogEntry, 1) } else { rf.logs = rf.logs[lastIncludedIndex-rf.getFirstLog().Index:] rf.logs[0].Command = nil } rf.logs[0].Term, rf.logs[0].Index = lastIncludedTerm, lastIncludedIndex rf.commitIndex, rf.lastApplied = lastIncludedIndex, lastIncludedIndex rf.persister.SaveStateAndSnapshot(rf.encodeState(), snapshot) } ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:2:5","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 3 å‹æµ‹è„šæœ¬ æˆ‘è‡ªå·±å®ç°äº†ä¸€ä¸ªå‹æµ‹è„šæœ¬ï¼š #!/bin/bash # check the number of arguments if [ \"$#\" -ne 2 ]; then echo \"Usage: $0 \u003ctest_type\u003e \u003citerations\u003e\" echo \"test_type must be one of 3A, 3B, 3C, 3D\" exit 1 fi test_type=$1 iterations=$2 # check the test_type if [[ \"$test_type\" != \"3A\" \u0026\u0026 \"$test_type\" != \"3B\" \u0026\u0026 \"$test_type\" != \"3C\" \u0026\u0026 \"$test_type\" != \"3D\" ]]; then echo \"Invalid test_type: $test_type\" echo \"test_type must be one of 3A, 3B, 3C, 3D\" exit 1 fi # check the iterations is a positive integer if ! [[ \"$iterations\" =~ ^[0-9]+$ ]]; then echo \"Invalid iterations: $iterations\" echo \"iterations must be a positive integer\" exit 1 fi echo \"go test -run $test_type\" for ((i=1; i\u003c=iterations; i++)) do echo \"Running test iteration $i\" output=$(go test -run $test_type 2\u003e\u00261) # 2\u003e\u00261 redirects stderr to stdout if [[ $? -ne 0 ]]; then echo \"Error in iteration $i:\" echo \"$output\" fi done ç½‘ä¸Šä¹Ÿæä¾›äº†ä¸€ä¸ªæµ‹è¯•è„šæœ¬ï¼ŒåŠŸèƒ½æ›´ä¸ºå¼ºå¤§ã€‚å‹æµ‹ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 4 ä¼˜åŒ– å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„ç©ºé—´å°‘äºæ•°ç»„çš„ä¸€åŠï¼Œæˆ‘ä»¬å°±æ›¿æ¢è¯¥æ•°ç»„ã€‚è¿™ä¸ªæ•°å­—æ˜¯ç›¸å½“ä»»æ„çš„ï¼Œé€‰æ‹©å®ƒæ˜¯ä¸ºäº†å¹³è¡¡å†…å­˜ä½¿ç”¨ä¸åˆ†é…æ•°é‡ï¼Œè¿™ä¸ªæ•°å­—å¯èƒ½è¿˜å¯ä»¥æ”¹è¿›ã€‚ func shrinkEntries(entries []LogEntry) []LogEntry { const lenMultiple = 2 if cap(entries) \u003e len(entries)*lenMultiple { newEntries := make([]LogEntry, len(entries)) copy(newEntries, entries) return newEntries } return entries } å› ä¸ºæ—¥å¿—çš„ç´¢å¼•æ˜¯å•è°ƒé€’å¢çš„ï¼Œè€Œtermåˆ™æ˜¯éé€’å‡çš„ã€‚æ‰€ä»¥è¿™é‡Œåº”è¯¥å¯ä»¥ä½¿ç”¨äºŒåˆ†ä¼˜åŒ–ã€‚ ","date":"2024-08-11","objectID":"/posts/08.mit-6.58406.824-lab3-raft/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab3:Raft è®¾è®¡å®ç°","uri":"/posts/08.mit-6.58406.824-lab3-raft/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"1 æ‘˜è¦ è¿™ç¯‡è®ºæ–‡ä»‹ç»äº†ZooKeeperï¼Œä¸€ä¸ªç”¨äºåè°ƒåˆ†å¸ƒå¼åº”ç”¨è¿›ç¨‹çš„æœåŠ¡ã€‚ZooKeeperæ—¨åœ¨æä¾›ä¸€ä¸ªç®€å•ä¸”é«˜æ€§èƒ½çš„å†…æ ¸ï¼Œç”¨äºæ„å»ºæ›´å¤æ‚çš„å®¢æˆ·ç«¯åè°ƒåŸè¯­ã€‚å®ƒæ•´åˆäº†ç»„æ¶ˆæ¯ä¼ é€’ã€å…±äº«å¯„å­˜å™¨å’Œåˆ†å¸ƒå¼é”æœåŠ¡çš„å…ƒç´ ï¼Œå½¢æˆäº†ä¸€ä¸ªå¤åˆ¶çš„ã€é›†ä¸­å¼çš„æœåŠ¡ã€‚Zookeeperæä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œå…·æœ‰å…±äº«å¯„å­˜å™¨çš„æ— ç­‰å¾…ç‰¹æ€§å’Œç±»ä¼¼åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿç¼“å­˜å¤±æ•ˆçš„äº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼Œä»¥æä¾›ç®€å•è€Œå¼ºå¤§çš„åè°ƒæœåŠ¡ã€‚ZooKeeperè¿˜ä¿è¯äº†æ¯ä¸ªå®¢æˆ·ç«¯è¯·æ±‚çš„FIFOæ‰§è¡Œå’Œæ‰€æœ‰æ›´æ”¹ZooKeeperçŠ¶æ€çš„è¯·æ±‚çš„çº¿æ€§åŒ–ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2 1 ä»‹ç» åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åŸºæœ¬åè°ƒæœºåˆ¶ï¼š é…ç½®ï¼šæœ€åŸºæœ¬çš„å½¢å¼ï¼Œå¯èƒ½æ˜¯é™æ€æˆ–åŠ¨æ€çš„æ“ä½œå‚æ•°åˆ—è¡¨ã€‚ ç»„æˆå‘˜èµ„æ ¼å’Œé¢†å¯¼è€…é€‰ä¸¾ï¼šè¿›ç¨‹éœ€è¦äº†è§£å…¶ä»–è¿›ç¨‹çš„çŠ¶æ€åŠèŒè´£ã€‚ é”ï¼šå®ç°å¯¹ä¸´ç•ŒåŒºçš„äº’æ–¥è®¿é—®çš„å¼ºå¤§åè°ƒåŸè¯­ã€‚ ä¸€ç§åè°ƒæ–¹æ³•æ˜¯ä¸ºæ¯ç§ä¸åŒçš„åè°ƒéœ€æ±‚ï¼ˆå¦‚é˜Ÿåˆ—æœåŠ¡ã€é¢†å¯¼è€…é€‰ä¸¾æœåŠ¡ï¼‰å¼€å‘æœåŠ¡ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´å¼ºå¤§çš„æœåŠ¡æ¥å®ç°å…¶ä»–åŸè¯­ï¼ˆå¦‚Chubbyæ˜¯ä¸€ç§å…·æœ‰å¼ºåŒæ­¥ä¿è¯çš„é”æœåŠ¡ï¼Œå®ƒå¯ä»¥ç”¨äºå®ç°é¢†å¯¼è€…é€‰ä¸¾ã€ç»„æˆå‘˜èµ„æ ¼ç­‰ï¼‰ã€‚ ZooKeeperçš„è®¾è®¡åŸåˆ™ï¼š APIæš´éœ²ã€‚ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿå®ç°è‡ªå·±çš„åŸè¯­ï¼Œè€Œä¸æ˜¯åœ¨æœåŠ¡å™¨ç«¯å®ç°ç‰¹å®šåŸè¯­ã€‚ æ— ç­‰å¾…æ•°æ®å¯¹è±¡ã€‚é¿å…ä½¿ç”¨é˜»å¡åŸè¯­ï¼ˆå¦‚é”ï¼‰ï¼Œä½¿ç³»ç»Ÿæ€§èƒ½æ›´é«˜ã€å®¹é”™æ€§æ›´å¥½ã€‚ æ“ä½œé¡ºåºä¿è¯ã€‚å®ç°FIFOå®¢æˆ·ç«¯æ’åºå’Œå¯çº¿æ€§åŒ–å†™å…¥ã€‚ Zookeeperå®ç°äº†ä¸€ä¸ªAPIï¼Œç”¨äºæ“ä½œåƒæ–‡ä»¶ç³»ç»Ÿé‚£æ ·å±‚æ¬¡åŒ–ç»„ç»‡çš„ç®€å•æ— ç­‰å¾…æ•°æ®å¯¹è±¡ã€‚ZooKeeperæœåŠ¡ç”±ä¸€ç»„ä½¿ç”¨å¤åˆ¶æ¥å®ç°é«˜å¯ç”¨æ€§å’Œé«˜æ€§èƒ½çš„æœåŠ¡å™¨ç»„æˆï¼Œå¹¶ä¸”ä½¿ç”¨æµæ°´çº¿æ¶æ„å®ç°ï¼Œè¯¥æ¶æ„æ”¯æŒå¤§é‡æœªå®Œæˆè¯·æ±‚ï¼Œä¿æŒä½å»¶è¿Ÿã€‚è¿™æ ·çš„æµæ°´çº¿è‡ªç„¶åœ°æ”¯æŒäº†å•ä¸ªå®¢æˆ·ç«¯æŒ‰FIFOé¡ºåºæ‰§è¡Œæ“ä½œã€‚ä¿è¯FIFOå®¢æˆ·ç«¯é¡ºåºä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥å¼‚æ­¥æäº¤æ“ä½œã€‚é€šè¿‡å¼‚æ­¥æ“ä½œï¼Œå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶æœ‰å¤šä¸ªæœªå®Œæˆçš„æ“ä½œã€‚ ä¸ºäº†ä¿è¯æ›´æ–°æ“ä½œæ»¡è¶³å¯çº¿æ€§åŒ–ï¼Œä½œè€…å®ç°äº†ä¸€ä¸ªåŸºäºé¢†å¯¼è€…çš„åŸå­å¹¿æ’­åè®®ï¼Œç§°ä¸ºZabã€‚ç„¶è€Œï¼ŒZookeeperåº”ç”¨ç¨‹åºçš„å…¸å‹å·¥ä½œè´Ÿè½½ä¸»è¦æ˜¯è¯»æ“ä½œï¼Œå› æ­¤éœ€è¦è¿›è¡Œè¯»æ“ä½œä¼˜åŒ–ï¼Œå³ä¸ä½¿ç”¨Zabå¯¹å®ƒä»¬è¿›è¡Œå…¨åºæ’åºï¼Œè€Œæ˜¯æœ¬åœ°å¤„ç†è¯»æ“ä½œï¼Œåˆ©ç”¨å®¢æˆ·ç«¯ç¼“å­˜å’Œç›‘è§†æœºåˆ¶ï¼ˆåªç¼“å­˜ä¸ç›´æ¥ç®¡ç†ï¼‰æé«˜æ€§èƒ½ã€‚Chubbyç›´æ¥ç®¡ç†å®¢æˆ·ç«¯ç¼“å­˜ï¼Œå…¶ä½¿ç”¨ç§Ÿçº¦æ¥é˜²æ­¢æ•…éšœå®¢æˆ·ç«¯æ— é™æœŸåœ°é˜»å¡ç³»ç»Ÿã€‚ç„¶è€Œï¼Œç§Ÿçº¦åªèƒ½é™åˆ¶æ…¢æˆ–æ•…éšœå®¢æˆ·ç«¯çš„å½±å“ï¼Œè€ŒZooKeeperçš„ç›‘è§†æœºåˆ¶åˆ™å®Œå…¨é¿å…äº†è¿™ä¸ªé—®é¢˜ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3 2 ZookeeperæœåŠ¡ å®¢æˆ·ç«¯é€šè¿‡ZooKeeperå®¢æˆ·ç«¯åº“çš„APIå‘ZooKeeperæœåŠ¡æäº¤è¯·æ±‚ï¼Œè¯¥åº“ä¸ä»…æä¾›äº†æœåŠ¡æ¥å£ï¼Œè¿˜è´Ÿè´£ç®¡ç†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œè¿æ¥ã€‚å®¢æˆ·ç«¯åœ¨è¿æ¥ZooKeeperæ—¶å»ºç«‹ä¼šè¯ï¼Œå¹¶é€šè¿‡ä¼šè¯å¥æŸ„å‘é€è¯·æ±‚ã€‚ ç›¸å…³æœ¯è¯­ï¼š å®¢æˆ·ç«¯ï¼šZooKeeperæœåŠ¡çš„ç”¨æˆ· æœåŠ¡å™¨ï¼šæä¾›ZooKeeperæœåŠ¡çš„è¿›ç¨‹ znodeï¼šZooKeeperæ•°æ®ä¸­çš„å†…å­˜æ•°æ®èŠ‚ç‚¹ï¼Œè¯¥æ•°æ®èŠ‚ç‚¹ç»„ç»‡åœ¨ç§°ä¸ºæ•°æ®æ ‘çš„åˆ†å±‚å‘½åç©ºé—´ä¸­ â€œupdate\"å’Œ\"writeâ€ï¼šæ¥æŒ‡ä»£ä»»ä½•ä¿®æ”¹æ•°æ®æ ‘çŠ¶æ€çš„æ“ä½œã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.1 2.1 æœåŠ¡æ¦‚è¿° ZooKeeperæœåŠ¡ä¸ºå®¢æˆ·ç«¯æä¾›äº†æ•°æ®èŠ‚ç‚¹ï¼ˆznodesï¼‰çš„æŠ½è±¡æ¦‚å¿µï¼Œè¿™äº›èŠ‚ç‚¹åœ¨å±‚æ¬¡å‘½åç©ºé—´ä¸­ç»„ç»‡ï¼Œç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚/A/B/Cè¡¨ç¤ºznode Cçš„è·¯å¾„ï¼Œå…¶ä¸­Cçˆ¶èŠ‚ç‚¹æ˜¯Bï¼‰ï¼Œä¾¿äºç”¨æˆ·ç†è§£å’Œç»„ç»‡æ•°æ®ã€‚æ¯ä¸ªznodeéƒ½å­˜å‚¨æ•°æ®ï¼Œé™¤äº†ä¸´æ—¶znodeå¤–ï¼Œéƒ½å¯ä»¥æœ‰å­èŠ‚ç‚¹ã€‚å®¢æˆ·ç«¯å¯ä»¥åˆ›å»ºä¸¤ç§ç±»å‹znodeï¼š å¸¸è§„znodeï¼šå®¢æˆ·ç«¯æ˜¾ç¤ºåˆ›å»ºå’Œåˆ é™¤ ä¸´æ—¶znodeï¼šå®¢æˆ·ç«¯æ˜¾ç¤ºåˆ›å»ºå’Œåˆ é™¤ï¼Œæˆ–è€…åœ¨åˆ›å»ºå®ƒä»¬çš„ä¼šè¯ç»ˆæ­¢åç”±ç³»ç»Ÿè‡ªåŠ¨åˆ é™¤ã€‚ã€ åˆ›å»ºznodeæ—¶ï¼Œå¯ä»¥è®¾ç½®é¡ºåºæ ‡å¿—ï¼Œä½¿ç”¨é¡ºåºæ ‡å¿—åˆ›å»ºçš„znodeåœ¨å…¶åç§°åé™„åŠ ä¸€ä¸ªå•è°ƒé€’å¢çš„è®¡æ•°å™¨å€¼ï¼Œç¡®ä¿èŠ‚ç‚¹åç§°çš„å”¯ä¸€æ€§ã€‚ ZooKeeperçš„ç›‘è§†æœºåˆ¶å…è®¸å®¢æˆ·ç«¯åœ¨å˜æ›´å‘ç”Ÿæ—¶æ¥æ”¶é€šçŸ¥ï¼Œæ— éœ€è½®è¯¢ã€‚è¿™ç§æœºåˆ¶æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸ä¼šè¯å…³è”ï¼Œè§¦å‘åæˆ–ä¼šè¯å…³é—­æ—¶å–æ¶ˆã€‚å®¢æˆ·ç«¯é€šè¿‡ç›‘è§†äº‹ä»¶å¾—çŸ¥æ•°æ®å˜åŒ–ï¼Œä½†ä¸ä¼šè·å¾—å˜åŒ–çš„å…·ä½“å†…å®¹ã€‚ ZooKeeperçš„æ•°æ®æ¨¡å‹æœ¬è´¨æ˜¯ä¸€ä¸ªç®€åŒ–APIçš„æ–‡ä»¶ç³»ç»Ÿæˆ–å…·æœ‰å±‚æ¬¡é”®çš„é”®å€¼è¡¨ï¼Œå±‚æ¬¡åŒ–å‘½åç©ºé—´å¯¹äºä¸åŒåº”ç”¨ç¨‹åºçš„å‘½åç©ºé—´åˆ†é…å­æ ‘å’Œè®¾ç½®è¿™äº›å­æ ‘çš„è®¿é—®æƒé™éå¸¸æœ‰ç”¨ã€‚znodeä¸æ˜¯ä¸ºä¸€èˆ¬æ•°æ®å­˜å‚¨è®¾è®¡ï¼Œè€Œæ˜¯ä½œä¸ºå®¢æˆ·ç«¯åº”ç”¨åè°ƒçš„æŠ½è±¡ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¸‹å›¾ä¸­ï¼Œæœ‰ä¸¤ä¸ªå­æ ‘ï¼Œä¸€ä¸ªç”¨äºapp1ï¼ˆ/app1ï¼‰ï¼Œå¦ä¸€ä¸ªç”¨äºapp2ï¼ˆ/app2ï¼‰ã€‚app1çš„å­æ ‘å®ç°äº†ä¸€ä¸ªç®€å•çš„ç»„æˆå‘˜åè®®ï¼šæ¯ä¸ªå®¢æˆ·ç«¯è¿›ç¨‹p_iåœ¨/app1ä¸‹åˆ›å»ºä¸€ä¸ªznode p_iï¼Œè¯¥znodeåœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´æŒç»­å­˜åœ¨ã€‚ZooKeeperå…è®¸å®¢æˆ·ç«¯ç”¨znodeå­˜å‚¨ä¸€äº›å¯ä»¥ç”¨äºåˆ†å¸ƒå¼è®¡ç®—çš„å…ƒæ•°æ®æˆ–é…ç½®çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚å½“å‰é¢†å¯¼è€…ä¿¡æ¯ï¼‰ã€‚znodeè¿˜åŒ…å«æ—¶é—´æˆ³å’Œç‰ˆæœ¬è®¡æ•°å™¨ï¼Œä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿè¿½è¸ªå˜æ›´å¹¶æ‰§è¡Œæ¡ä»¶æ›´æ–°ã€‚ å®¢æˆ·ç«¯ä¸ZooKeeperçš„ä¼šè¯å…·æœ‰è¶…æ—¶æœºåˆ¶ï¼Œè¶…æ—¶æœªæ”¶åˆ°ä¿¡æ¯å³è®¤ä¸ºå®¢æˆ·ç«¯æ•…éšœã€‚å½“å®¢æˆ·ç«¯æ˜¾å¼å…³é—­ä¼šè¯å¥æŸ„æˆ–ZooKeeperæ£€æµ‹åˆ°å®¢æˆ·ç«¯æ•…éšœæ—¶ï¼Œä¼šè¯ç»“æŸã€‚ä¼šè¯æœŸé—´ï¼Œå®¢æˆ·ç«¯å¯ä»¥è·¨æœåŠ¡å™¨é€æ˜è¿ç§»ï¼Œä¿æŒçŠ¶æ€è¿ç»­æ€§ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:3:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.2 2.2 å®¢æˆ·ç«¯API ä»¥ä¸‹æ˜¯ZooKeeper APIçš„ç›¸å…³å­é›†ï¼š create(path, data, flags)ï¼šåˆ›å»ºä¸€ä¸ªå…·æœ‰è·¯å¾„åpathçš„znodeï¼Œå­˜å‚¨data[]ï¼Œå¹¶è¿”å›æ–°znodeçš„åç§°ã€‚flagsä½¿å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©znodeçš„ç±»å‹ï¼šå¸¸è§„ã€ä¸´æ—¶ï¼Œå¹¶è®¾ç½®é¡ºåºæ ‡å¿—ã€‚ delete(path, version)ï¼šå¦‚æœznodeçš„ç‰ˆæœ¬ä¸é¢„æœŸç‰ˆæœ¬åŒ¹é…ï¼Œåˆ™åˆ é™¤è·¯å¾„ä¸ºpathçš„znodeã€‚ exists(path, watch)ï¼šå¦‚æœè·¯å¾„ä¸ºpathçš„znodeå­˜åœ¨ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚watchæ ‡å¿—å…è®¸å®¢æˆ·ç«¯åœ¨znodeä¸Šè®¾ç½®ç›‘è§†ã€‚ getData(path, watch)ï¼šè¿”å›ä¸znodeå…³è”çš„æ•°æ®å’Œå…ƒæ•°æ®ï¼ˆå¦‚ç‰ˆæœ¬ä¿¡æ¯ï¼‰ã€‚watchæ ‡å¿—çš„å·¥ä½œæ–¹å¼ä¸exists()ç›¸åŒï¼Œåªæ˜¯å¦‚æœznodeä¸å­˜åœ¨ï¼ŒZooKeeperä¸ä¼šè®¾ç½®ç›‘è§†ã€‚ setData(path, data, version)ï¼šå¦‚æœznodeçš„ç‰ˆæœ¬å·æ˜¯å½“å‰ç‰ˆæœ¬ï¼Œåˆ™å°†data[]å†™å…¥è·¯å¾„ä¸ºpathçš„znodeã€‚ getChildren(path, watch)ï¼šè¿”å›znodeçš„å­èŠ‚ç‚¹åç§°é›†åˆã€‚ sync(path)ï¼šç­‰å¾…åœ¨æ“ä½œå¼€å§‹æ—¶æŒ‚èµ·çš„æ‰€æœ‰æ›´æ–°ä¼ æ’­åˆ°å®¢æˆ·ç«¯è¿æ¥çš„æœåŠ¡å™¨ã€‚å½“å‰å¿½ç•¥è·¯å¾„ã€‚ æ‰€æœ‰æ–¹æ³•åœ¨APIä¸­éƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥ç‰ˆæœ¬ã€‚å½“åº”ç”¨ç¨‹åºéœ€è¦æ‰§è¡Œå•ä¸ªZooKeeperæ“ä½œä¸”æ²¡æœ‰å¹¶å‘ä»»åŠ¡æ—¶ï¼Œä½¿ç”¨åŒæ­¥APIï¼Œä½¿å…¶é˜»å¡ç›´åˆ°å®Œæˆã€‚è€Œå¼‚æ­¥APIå…è®¸åº”ç”¨ç¨‹åºæ‰§è¡Œå¤šä¸ªZooKeeperæ“ä½œå’Œå…¶ä»–ä»»åŠ¡ï¼ŒZooKeeperå®¢æˆ·ç«¯ä¿è¯æŒ‰é¡ºåºè°ƒç”¨æ¯ä¸ªæ“ä½œçš„ç›¸åº”å›è°ƒã€‚ ZooKeeperä¸ä½¿ç”¨å¥æŸ„è®¿é—®znodeã€‚æ¯ä¸ªè¯·æ±‚éƒ½åŒ…æ‹¬è¢«æ“ä½œçš„znodeçš„å®Œæ•´è·¯å¾„ã€‚è¿™ä¸ä»…ç®€åŒ–äº†APIï¼ˆæ²¡æœ‰open()æˆ–close()æ–¹æ³•ï¼‰ï¼Œè¿˜æ¶ˆé™¤äº†æœåŠ¡å™¨éœ€è¦ç»´æŠ¤çš„é¢å¤–çŠ¶æ€ã€‚æ¯ä¸ªæ›´æ–°æ–¹æ³•éƒ½æ¥å—ä¸€ä¸ªé¢„æœŸç‰ˆæœ¬å·ï¼Œå¦‚æœznodeçš„å®é™…ç‰ˆæœ¬å·ä¸é¢„æœŸç‰ˆæœ¬å·ä¸åŒ¹é…ï¼Œæ›´æ–°å°†å¤±è´¥å¹¶è¿”å›ç‰ˆæœ¬é”™è¯¯ã€‚å¦‚æœç‰ˆæœ¬å·ä¸º-1ï¼Œåˆ™ä¸è¿›è¡Œç‰ˆæœ¬æ£€æŸ¥ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:3:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.3 2.3 Zookeeperä¿è¯ ZooKeeperé€šè¿‡ä¸¤é¡¹åŸºæœ¬çš„é¡ºåºä¿è¯æ¥ç¡®ä¿æ“ä½œçš„ä¸€è‡´æ€§å’Œå¯é¢„æµ‹æ€§ï¼š çº¿æ€§åŒ–å†™å…¥ï¼šæ‰€æœ‰æ›´æ–°ZooKeeperçŠ¶æ€çš„è¯·æ±‚éƒ½æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œå¹¶ä¸”éµå¾ªä¼˜å…ˆçº§ã€‚ FIFOå®¢æˆ·ç«¯é¡ºåºï¼šæ¥è‡ªåŒä¸€å®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚æŒ‰ç…§å®ƒä»¬è¢«å‘é€çš„é¡ºåºæ‰§è¡Œã€‚ ZooKeeperçš„çº¿æ€§åŒ–å®šä¹‰æ‰©å±•äº†Herlihyçš„åŸå§‹å®šä¹‰ï¼Œç§°ä¸ºå¼‚æ­¥çº¿æ€§åŒ–ï¼Œå…è®¸å®¢æˆ·ç«¯æœ‰å¤šä¸ªæœªå®Œæˆçš„æ“ä½œï¼Œå¹¶ä¿è¯è¿™äº›æ“ä½œçš„FIFOé¡ºåºã€‚ è¿™ç§é¡ºåºä¿è¯å¯¹äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„é¢†å¯¼è€…é€‰ä¸¾å’Œé…ç½®æ›´æ–°è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œå½“æ–°é¢†å¯¼è€…éœ€è¦æ›´æ–°å¤§é‡é…ç½®å‚æ•°æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ZooKeeperçš„é¡ºåºä¿è¯æ¥ç¡®ä¿é…ç½®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚æ–°é¢†å¯¼è€…é€šè¿‡åˆ›å»ºä¸€ä¸ªready znodeæ¥æ§åˆ¶é…ç½®çš„æ›´æ–°ï¼Œå…¶ä»–è¿›ç¨‹åªæœ‰åœ¨è¯¥znodeå­˜åœ¨æ—¶æ‰ä¼šé‡‡ç”¨æ–°çš„é…ç½®ã€‚æ–°é¢†å¯¼è€…é€šè¿‡åˆ é™¤readyã€æ›´æ–°å„ç§é…ç½®znodeå’Œåˆ›å»ºreadyæ¥è¿›è¡Œé…ç½®æ›´æ”¹ã€‚æ‰€æœ‰è¿™äº›æ›´æ”¹å¯ä»¥æµæ°´çº¿å¤„ç†ï¼Œå¹¶å¼‚æ­¥å‘å¸ƒï¼Œä»¥å¿«é€Ÿæ›´æ–°é…ç½®çŠ¶æ€ã€‚ æ­¤å¤–ï¼ŒZooKeeperçš„é€šçŸ¥æœºåˆ¶ç¡®ä¿äº†å®¢æˆ·ç«¯èƒ½å¤ŸåŠæ—¶æ¥æ”¶åˆ°å˜æ›´é€šçŸ¥ï¼Œè€Œsyncæ“ä½œåˆ™å…è®¸å®¢æˆ·ç«¯åœ¨éœ€è¦æ—¶å¼ºåˆ¶æ›´æ–°è¯»å–ï¼Œä»¥è·å–æœ€æ–°çš„ç³»ç»ŸçŠ¶æ€ã€‚ ZooKeeperçš„è®¾è®¡å…è®¸å®ƒåœ¨ä¿æŒé«˜ååé‡çš„åŒæ—¶ï¼Œä¹Ÿä¿è¯äº†ç³»ç»Ÿçš„æ´»æ€§å’ŒæŒä¹…æ€§ã€‚åªè¦å¤§å¤šæ•°æœåŠ¡å™¨å¤„äºæ´»åŠ¨çŠ¶æ€å¹¶èƒ½å¤Ÿé€šä¿¡ï¼ŒæœåŠ¡å°±èƒ½ä¿æŒå¯ç”¨ã€‚è€Œä¸”ï¼Œä¸€æ—¦æœåŠ¡æˆåŠŸå“åº”äº†æ›´æ”¹è¯·æ±‚ï¼Œé‚£ä¹ˆåªè¦æ³•å®šæ•°é‡çš„æœåŠ¡å™¨èƒ½å¤Ÿæ¢å¤ï¼Œè¿™äº›æ›´æ”¹èƒ½åœ¨ä»»ä½•æ•°é‡çš„æ•…éšœä¸­æŒä¹…åŒ–ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:3:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.4 2.4 åŸè¯­ç¤ºä¾‹ ZooKeeper APIæä¾›äº†å®ç°å¤æ‚åŸè¯­çš„èƒ½åŠ›ï¼Œè¿™äº›åŸè¯­å®Œå…¨åœ¨å®¢æˆ·ç«¯å®ç°ï¼ŒæœåŠ¡ç«¯å¹¶ä¸æ„ŸçŸ¥ã€‚æ— è®ºæ˜¯é…ç½®ç®¡ç†ã€æ±‡åˆç‚¹ã€ç»„æˆå‘˜å…³ç³»è¿˜æ˜¯é”æœºåˆ¶ï¼ŒZooKeeperéƒ½èƒ½é€šè¿‡å…¶APIæä¾›æ”¯æŒã€‚ZooKeeperçš„é¡ºåºä¿è¯å…è®¸é«˜æ•ˆåœ°æ¨ç†ç³»ç»ŸçŠ¶æ€ï¼Œè€Œç›‘è§†åˆ™å…è®¸é«˜æ•ˆåœ°ç­‰å¾…ã€‚ é…ç½®ç®¡ç†ï¼šæœ€ç®€å•çš„å½¢å¼æ˜¯å°†é…ç½®å­˜å‚¨åœ¨ä¸€ä¸ª znodeï¼ˆ$z_c$ï¼‰ä¸­ã€‚è¿›ç¨‹å¯åŠ¨æ—¶è·å– $z_c$ çš„å®Œæ•´è·¯å¾„åã€‚å¯åŠ¨çš„è¿›ç¨‹é€šè¿‡è¯»å– $z_c$ å¹¶å°†ç›‘è§†æ ‡å¿—è®¾ç½®ä¸º true æ¥è·å¾—å…¶é…ç½®ã€‚å¦‚æœ $z_c$ ä¸­çš„é…ç½®è¢«æ›´æ–°ï¼Œè¿›ç¨‹ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è¯»å–æ–°é…ç½®ï¼Œé‡æ–°è®¾ç½®ç›‘è§†æ ‡å¿—ä¸º trueã€‚ åœ¨è¿™ç§æ–¹æ¡ˆä¸­ï¼Œå°½ç®¡æœ‰å¾ˆå¤šæ¬¡å˜åŒ–ï¼Œä½†é€šå¸¸è¿›ç¨‹åªä¼šæ”¶åˆ°ä¸€æ¬¡ï¼Œè¿™å¹¶ä¸ä¼šå½±å“è¿›ç¨‹çš„è¡Œä¸ºï¼Œå› ä¸ºç›‘è§†æ˜¯ç”¨æ¥é€šçŸ¥è¿›ç¨‹å®ƒå·²ç»çŸ¥é“çš„ä¿¡æ¯ï¼šå®ƒæ‰€æ‹¥æœ‰çš„ $z_c$ ä¿¡æ¯æ˜¯è¿‡æ—¶çš„ã€‚ æ±‡åˆç‚¹ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶å¹¶ä¸æ€»æ˜¯èƒ½äº‹å…ˆæ˜ç¡®æœ€ç»ˆçš„ç³»ç»Ÿé…ç½®ã€‚å¯ä»¥ä½¿ç”¨ ZooKeeper å¤„ç†è¿™ç§æƒ…å†µï¼Œé€šè¿‡ä¸€ä¸ªç§°ä¸ºæ±‡åˆç‚¹çš„ znodeï¼ˆ$z_r$ï¼‰ï¼Œè¿™æ˜¯ç”±å®¢æˆ·ç«¯åˆ›å»ºçš„èŠ‚ç‚¹ã€‚å®¢æˆ·ç«¯å°† $z_r$ çš„å®Œæ•´è·¯å¾„åä½œä¸ºå¯åŠ¨å‚æ•°ä¼ é€’ç»™ä¸»è¿›ç¨‹å’Œå·¥ä½œè¿›ç¨‹ã€‚å½“ä¸»è¿›ç¨‹å¯åŠ¨æ—¶ï¼Œå®ƒä¼šå°†å…¶ä½¿ç”¨çš„åœ°å€å’Œç«¯å£ä¿¡æ¯å¡«å……åˆ° $z_r$ ä¸­ã€‚å½“å·¥ä½œè¿›ç¨‹å¯åŠ¨æ—¶ï¼Œå®ƒä»¬ä¼šè¯»å– $z_r$ å¹¶å°†ç›‘è§†è®¾ç½®ä¸º trueã€‚å¦‚æœ $z_r$ å°šæœªå¡«å……ï¼Œå·¥ä½œè¿›ç¨‹å°†ç­‰å¾…è¢«é€šçŸ¥ $z_r$ æ›´æ–°ã€‚å¦‚æœ $z_r$ æ˜¯ä¸€ä¸ªä¸´æ—¶èŠ‚ç‚¹ï¼Œä¸»è¿›ç¨‹å’Œå·¥ä½œè¿›ç¨‹å¯ä»¥ç›‘è§† $z_r$ çš„åˆ é™¤ï¼Œå¹¶åœ¨å®¢æˆ·ç«¯ç»“æŸæ—¶è¿›è¡Œæ¸…ç†ã€‚ ç»„æˆå‘˜å…³ç³»ï¼šæˆ‘ä»¬åˆ©ç”¨ä¸´æ—¶èŠ‚ç‚¹å…è®¸æŸ¥çœ‹åˆ›å»ºè¯¥èŠ‚ç‚¹çš„ä¼šè¯çŠ¶æ€ã€‚é¦–å…ˆæŒ‡å®šä¸€ä¸ª znodeï¼ˆ$z_g$ï¼‰æ¥ä»£è¡¨ç»„ã€‚å½“ç»„ä¸­çš„ä¸€ä¸ªè¿›ç¨‹æˆå‘˜å¯åŠ¨æ—¶ï¼Œå®ƒä¼šåœ¨ $z_g$ ä¸‹åˆ›å»ºä¸€ä¸ªä¸´æ—¶å­ znodeã€‚å¦‚æœæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å”¯ä¸€çš„åç§°æˆ–æ ‡è¯†ç¬¦ï¼Œåˆ™è¯¥åç§°ç”¨äºå­ znode çš„åç§°ï¼›å¦åˆ™ï¼Œè¿›ç¨‹å°†ä½¿ç”¨ SEQUENTIAL æ ‡å¿—åˆ›å»º znode ä»¥è·å¾—å”¯ä¸€çš„åç§°åˆ†é…ã€‚ è¿›ç¨‹å¯ä»¥å°†è¿›ç¨‹ä¿¡æ¯æ”¾å…¥å­ znode çš„æ•°æ®ä¸­ï¼Œä¾‹å¦‚è¿›ç¨‹ä½¿ç”¨çš„åœ°å€å’Œç«¯å£ã€‚åœ¨ $z_g$ ä¸‹åˆ›å»ºå­ znode åï¼Œè¿›ç¨‹æ­£å¸¸å¯åŠ¨ï¼Œä¸éœ€è¦åšå…¶ä»–ä»»ä½•äº‹æƒ…ã€‚å¦‚æœè¿›ç¨‹å¤±è´¥æˆ–ç»“æŸï¼Œä»£è¡¨å®ƒçš„ znode åœ¨ $z_g$ ä¸‹è‡ªåŠ¨ç§»é™¤ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡åˆ—å‡º $z_g$ çš„å­èŠ‚ç‚¹æ¥è·å–ç»„ä¿¡æ¯ã€‚å¦‚æœè¿›ç¨‹æƒ³ç›‘è§†ç»„æˆå‘˜å˜åŠ¨ï¼Œå¯ä»¥å°†ç›‘è§†æ ‡å¿—è®¾ç½®ä¸º trueï¼Œå¹¶åœ¨æ”¶åˆ°å˜åŠ¨é€šçŸ¥æ—¶åˆ·æ–°ç»„ä¿¡æ¯ï¼ˆå§‹ç»ˆå°†ç›‘è§†æ ‡å¿—è®¾ç½®ä¸º trueï¼‰ã€‚ ç®€å•é”ï¼šå°½ç®¡ ZooKeeper ä¸æ˜¯ä¸€ä¸ªé”æœåŠ¡ï¼Œä½†å®ƒå¯ä»¥ç”¨æ¥å®ç°é”ï¼Œä»¥å®ç°å„ç§é€šç”¨åŒæ­¥åŸè¯­ã€‚æœ€ç®€å•çš„é”å®ç°ä½¿ç”¨â€œé”æ–‡ä»¶â€ã€‚é”ç”±ä¸€ä¸ª znode è¡¨ç¤ºã€‚ è¦è·å–é”ï¼Œå®¢æˆ·ç«¯å°è¯•åˆ›å»ºå¸¦æœ‰ EPHEMERAL æ ‡å¿—çš„æŒ‡å®š znodeã€‚å¦‚æœåˆ›å»ºæˆåŠŸï¼Œå®¢æˆ·ç«¯æŒæœ‰é”ã€‚å¦åˆ™ï¼Œå®¢æˆ·ç«¯å¯ä»¥è¯»å– znode å¹¶è®¾ç½®ç›‘è§†æ ‡å¿—ï¼Œä»¥ä¾¿åœ¨å½“å‰æŒæœ‰é”çš„å®¢æˆ·ç«¯æ­»äº¡æ—¶æ”¶åˆ°é€šçŸ¥ã€‚ å®¢æˆ·ç«¯åœ¨æ­»äº¡æˆ–æ˜¾å¼åˆ é™¤ znode æ—¶é‡Šæ”¾é”ã€‚ç­‰å¾…é”çš„å…¶ä»–å®¢æˆ·ç«¯åœ¨è§‚å¯Ÿåˆ° znode è¢«åˆ é™¤åå†æ¬¡å°è¯•è·å–é”ã€‚ è™½ç„¶è¿™ç§ç®€å•çš„é”åè®®æœ‰æ•ˆï¼Œä½†å®ƒç¡®å®å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚ å®ƒé­å—ç¾¤ä½“æ•ˆåº”ã€‚å¦‚æœæœ‰è®¸å¤šå®¢æˆ·ç«¯ç­‰å¾…è·å–é”ï¼Œå½“é”è¢«é‡Šæ”¾æ—¶ï¼Œå®ƒä»¬éƒ½ä¼šäº‰å¤ºé”ï¼Œå°½ç®¡åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥è·å–é”ã€‚ å®ƒåªå®ç°äº†ç‹¬å é”ã€‚ ä»¥ä¸‹ä¸¤ä¸ªåŸè¯­å±•ç¤ºäº†å¦‚ä½•å…‹æœè¿™ä¸¤ä¸ªé—®é¢˜ã€‚ æ— ç¾¤ä½“æ•ˆåº”çš„ç®€å•é”ï¼šæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé” znodeï¼ˆ$l$ï¼‰æ¥å®ç°è¿™æ ·çš„é”ã€‚ç›´è§‚ä¸Šï¼Œæˆ‘ä»¬å°†æ‰€æœ‰è¯·æ±‚é”çš„å®¢æˆ·ç«¯æ’é˜Ÿï¼Œæ¯ä¸ªå®¢æˆ·ç«¯æŒ‰è¯·æ±‚åˆ°è¾¾çš„é¡ºåºè·å–é”ã€‚å› æ­¤ï¼Œå®¢æˆ·ç«¯å¸Œæœ›è·å–é”æ—¶æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š # Lock # ä½¿ç”¨ SEQUENTIAL æ ‡å¿—å°†å®¢æˆ·ç«¯è·å–é”çš„å°è¯•æŒ‰ä¸å…¶ä»–æ‰€æœ‰å°è¯•çš„é¡ºåºæ’åˆ—ã€‚nä»£è¡¨Zookeeperè‡ªåŠ¨åˆ†é…çš„å”¯ä¸€åºåˆ—å· 1 n = create(l + â€œ/lock-â€, EPHEMERAL|SEQUENTIAL) # è·å–é”è·¯å¾„ä¸‹æ‰€æœ‰å­èŠ‚ç‚¹çš„åˆ—è¡¨ã€‚ 2 C = getChildren(l, false) # å¦‚æœå½“å‰åˆ›å»ºçš„èŠ‚ç‚¹ n æ˜¯å­èŠ‚ç‚¹åˆ—è¡¨ C ä¸­æœ€å°çš„ä¸€ä¸ªï¼Œå³æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹æœ‰æ›´å°çš„åºå·ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¢æˆ·ç«¯è·å¾—äº†é”ï¼Œé€€å‡ºã€‚ 3 if n is lowest znode in C, exit # æœå½“å‰èŠ‚ç‚¹ n ä¸æ˜¯æœ€å°çš„ï¼Œæ‰¾åˆ°åˆ—è¡¨ä¸­ç›´æ¥æ’åœ¨ n å‰é¢çš„èŠ‚ç‚¹ pã€‚ï¼ˆå³æ¯ä¸ªéƒ½ç­‰å¾…å‰ä¸€ä¸ªï¼Œè¿™æ ·é¿å…äº†ç¾¤ä½“æ•ˆåº”ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨é”è¢«é‡Šæ”¾æˆ–é”è¯·æ±‚è¢«æ”¾å¼ƒæ—¶è¢«å”¤é†’ï¼‰ 4 p = znode in C ordered just before n # æ£€æŸ¥èŠ‚ç‚¹ p æ˜¯å¦ä»ç„¶å­˜åœ¨ã€‚ç”±äºèŠ‚ç‚¹æ˜¯ä¸´æ—¶çš„ï¼Œå¦‚æœæŒæœ‰é”çš„å®¢æˆ·ç«¯æ–­å¼€äº†è¿æ¥ï¼ŒèŠ‚ç‚¹ p å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚ 5 if exists(p, true) # è®¾ç½®ä¸€ä¸ªç›‘è§†å™¨ï¼Œç­‰å¾…èŠ‚ç‚¹ p çš„çŠ¶æ€å˜åŒ–äº‹ä»¶ wait for watch event # å¦‚æœ p ä¸å­˜åœ¨ï¼Œè¯´æ˜é‚£ä¸ªå®¢æˆ·ç«¯å·²ç»é‡Šæ”¾äº†é”ï¼Œä»ç„¶æœ‰ä¸€ä¸ªæ›´ä½åºåˆ—å·çš„ znode æ­£åœ¨ç­‰å¾…æˆ–æŒæœ‰é”ï¼Œæ‰€ä»¥å½“å‰å®¢æˆ·ç«¯åº”è¯¥å†æ¬¡æ£€æŸ¥è‡ªå·±æ˜¯å¦æ˜¯æœ€å°çš„èŠ‚ç‚¹ã€‚ 6 goto 2 # Unlock 1 delete(n) è¿™ç§é”æ–¹æ¡ˆå…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š znode çš„åˆ é™¤åªä¼šå”¤é†’ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå› ä¸ºæ¯ä¸ª znode åªæœ‰ä¸€ä¸ªå…¶ä»–å®¢æˆ·ç«¯åœ¨ç›‘è§†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰ç¾¤ä½“æ•ˆåº”ï¼› æ²¡æœ‰è½®è¯¢æˆ–è¶…æ—¶ï¼› ç”±äºæˆ‘ä»¬å®ç°é”çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æµè§ˆ ZooKeeper æ•°æ®æŸ¥çœ‹é”äº‰ç”¨æƒ…å†µã€ç ´åé”å’Œè°ƒè¯•é”é—®é¢˜ã€‚ è¯»/å†™é”ï¼šä¸ºäº†å®ç°è¯»/å†™é”ï¼Œæˆ‘ä»¬ç¨å¾®æ›´æ”¹äº†é”è¿‡ç¨‹ï¼Œå¹¶æœ‰å•ç‹¬çš„è¯»é”å’Œå†™é”è¿‡ç¨‹ã€‚è§£é”è¿‡ç¨‹ä¸å…¨å±€é”çš„æƒ…å†µç›¸åŒã€‚ # Write Lock 1 n = create(l + â€œ/write-â€, EPHEMERAL|SEQUENTIAL) 2 C = getChildren(l, false) 3 if n is lowest znode in C, exit 4 p = znode in C ordered just before n 5 if exists(p, true) wait for event 6 goto 2 # Read Lock 1 n = create(l + â€œ/read-â€, EPHEMERAL|SEQUENTIAL) 2 C = getChildren(l, false) 3 if no write znodes lower than n in C, exit 4 p = write znode in C ordered just before n 5 if exists(p, true) wait for event 6 goto 3 æ­¤é”è¿‡ç¨‹ä¸ä¹‹å‰çš„é”ç•¥æœ‰ä¸åŒã€‚å†™é”ä»…åœ¨å‘½åä¸Šæœ‰æ‰€ä¸åŒã€‚è¯»é”ç¬¬ 3 è¡Œå’Œç¬¬ 4 è¡Œæœ‰æ‰€ä¸åŒï¼Œå› ä¸ºåªæœ‰è¾ƒæ—©çš„å†™é” znode ä¼šé˜»æ­¢å®¢æˆ·ç«¯è·å–è¯»é”ã€‚çœ‹èµ·æ¥å½“æœ‰å¤šä¸ªå®¢æˆ·ç«¯ç­‰å¾…è¯»é”æ—¶ï¼Œä¼šå‡ºç°â€œç¾¤ä½“æ•ˆåº”â€ï¼Œå¹¶åœ¨è¾ƒä½åºåˆ—å·çš„â€œwrite-â€ znode è¢«åˆ é™¤æ—¶æ”¶åˆ°é€šçŸ¥ï¼›å®é™…ä¸Šï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„è¡Œä¸ºã€‚ä¸€æ—¦å†™é”è¢«é‡Šæ”¾ï¼Œæ‰€æœ‰ç­‰å¾…è¯»é”çš„å®¢æˆ·ç«¯éƒ½åº”è¯¥è¢«å”¤é†’ï¼Œå› ä¸ºå®ƒä»¬ç°åœ¨æœ‰å¯èƒ½å…±åŒæŒæœ‰è¯»é”ã€‚è¿™æ˜¯å› ä¸ºè¯»é”æ˜¯å¯ä»¥å…±äº«çš„ï¼Œä¸€æ—¦æ²¡æœ‰ä»»ä½•å†™é”å­˜åœ¨ï¼Œæ‰€æœ‰çš„è¯»é”è¯·æ±‚éƒ½å¯ä»¥è¢«æ»¡è¶³ï¼Œæ‰€æœ‰ç­‰å¾…è¯»é”çš„å®¢æˆ·ç«¯éƒ½èƒ½ç»§ç»­å®ƒä»¬çš„æ“ä½œï¼Œæ— éœ€å†ç­‰å¾…ã€‚è¿™ç§æœºåˆ¶ç¡®ä¿äº†è¯»æ“ä½œçš„é«˜å¹¶å‘æ€§ï¼ŒåŒæ—¶ä¿è¯äº†å†™æ“ä½œçš„ç‹¬å æ€§ï¼Œä»è€Œç»´æŠ¤äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚ åŒé‡å±éšœï¼šåŒé‡å±éšœæœºåˆ¶ä¸ºå®¢æˆ·ç«¯æä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥åŒæ­¥è®¡ç®—é˜¶æ®µçš„å¯åŠ¨ä¸ç»ˆæ­¢ï¼Œç¡®ä¿æ‰€æœ‰å‚ä¸æ–¹åœ¨ç»Ÿä¸€çš„ä¿¡å·ä¸‹ååŒè¡ŒåŠ¨ã€‚å½“åŠ å…¥å±éšœçš„è¿›ç¨‹æ•°é‡è¶…è¿‡å±éšœé˜ˆå€¼æ—¶ï¼Œæ ‡å¿—ç€è®¡ç®—æ´»åŠ¨çš„å¼€å¯ï¼›è€Œéšç€å„è¿›ç¨‹å®Œæˆä»»åŠ¡å¹¶ç›¸ç»§é€€å‡ºï¼Œå±éšœäº¦éšä¹‹è§£é™¤ã€‚åœ¨è¿™ä¸€æœºåˆ¶ä¸­ï¼Œå±éšœè‡ªèº«ä»¥ZooKeeperä¸­çš„ znode è¡¨ç¤ºï¼Œæˆ‘ä»¬å°†å…¶å‘½åä¸º $b$ã€‚ æ¯å½“è¿›ç¨‹ $p$ æ¬²è¿›å…¥å±éšœï¼Œå®ƒé¦–å…ˆé€šè¿‡åœ¨ $b$ ä¸‹åˆ›å»ºä¸€ä¸ªå­ znode æ¥è¿›è¡Œæ³¨å†Œï¼Œè¡¨æ˜è‡ªèº«å·²åŠ å…¥è®¡ç®—é¢„å¤‡é˜Ÿåˆ—ï¼›è€Œå½“è¿›ç¨‹å‡†å¤‡æ’¤ç¦»å±éšœï¼Œå³å®£å‘Šä»»åŠ¡å®Œæˆä¹‹æ—¶ï¼Œå®ƒå°†ç§»é™¤å…ˆå‰åˆ›å»ºçš„å­ znodeï¼Œä»¥æ­¤æ¥æ³¨é”€ã€‚å±éšœçš„æ¿€æ´»ä¸é‡Šæ”¾ï¼Œåˆ†åˆ«å¯¹åº”äº $b$ ä¸‹å­èŠ‚ç‚¹æ•°ç›®è¶Šè¿‡é˜ˆå€¼åŠå…¨éƒ¨å­èŠ‚ç‚¹è¢«æ¸…é™¤è¿™ä¸¤ä¸ªæ¡ä»¶ã€‚ ä¸ºäº†ç¡®ä¿è¿›ç¨‹é«˜æ•ˆç­‰å¾…è¿›å…¥ä¸é€€å‡ºæ¡ä»¶çš„è¾¾æˆï¼ŒZookeeperå·§å¦™åœ°è¿ç”¨äº†ç›‘è§†å™¨ã€‚åœ¨è¿›ç¨‹å¯»æ±‚è¿›å…¥å±éšœæ—¶ï¼Œå®ƒä¼šè®¾ç½®ç›‘è§†å™¨ä»¥ç›‘å¬ $b$ çš„æŸä¸ªå­ znode çš„å­˜åœ¨çŠ¶æ€â€”â€”è¿™ä¸ªå­ znode æ˜¯ç”±å¯¼è‡´å­èŠ‚ç‚¹æ•°é‡é¦–æ¬¡è¶…è¶Šå±éšœé˜ˆå€¼çš„é‚£ä¸ªè¿›ç¨‹åˆ›å»ºçš„ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œè¿›ç¨‹å¾—ä»¥å®æ—¶çŸ¥æ™“å±éšœå¼€å¯çš„ç¬é—´ã€‚ç›¸åï¼Œåœ¨è¿›ç¨‹æ„æ¬²é€€å‡ºå±éšœä¹‹é™…ï¼Œå®ƒå°†ç›‘è§†æŸä¸ªç‰¹å®šçš„å­ znode çš„æ¶ˆå¤±ï¼Œåªæœ‰å½“è¿™ä¸ªæ ‡è®°ç€å±éšœå³å°†è§£é™¤çš„å­ znode è¢«ç§»é™¤åï¼Œè¿›ç¨‹æ‰æ£€æŸ¥æ˜¯å¦æ»¡è¶³é€€å‡ºæ¡ä»¶ï¼Œè¿›è€Œå®‰å…¨æœ‰åºåœ°è„±ç¦»å±éšœç¯å¢ƒã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:3:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4 3 ZooKeeperåº”ç”¨ ZooKeeperä½œä¸ºä¸€ç§å¼ºå¤§çš„åè°ƒæœåŠ¡ï¼Œåœ¨å¤šç§åº”ç”¨ç¨‹åºä¸­å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚ Yahoo!çš„æŠ“å–æœåŠ¡ï¼ˆFSï¼‰åˆ©ç”¨ZooKeeperæ¥ç®¡ç†é…ç½®å…ƒæ•°æ®ã€è¿›è¡Œé¢†å¯¼è€…é€‰ä¸¾ï¼Œå¹¶ä»ä¸»è¿›ç¨‹æ•…éšœä¸­æ¢å¤ï¼Œç¡®ä¿æœåŠ¡çš„é«˜å¯ç”¨æ€§ã€‚æ­¤å¤–ï¼ŒZooKeeperçš„ç›‘è§†æœºåˆ¶å…è®¸FSåœ¨ä¸ç›´æ¥ä¸æœåŠ¡å™¨é€šä¿¡çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡è¯»å–ZooKeeperä¸­çš„çŠ¶æ€ä¿¡æ¯æ¥å‘å¥åº·çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚ Kattaä½œä¸ºä¸€ä¸ªéYahoo!çš„åˆ†å¸ƒå¼ç´¢å¼•å™¨ï¼Œä½¿ç”¨ZooKeeperè¿›è¡Œåè°ƒï¼Œé€šè¿‡åˆ†ç‰‡æ¥åˆ†é…ç´¢å¼•å·¥ä½œã€‚Kattaä½¿ç”¨ZooKeeperæ¥è·Ÿè¸ªä¸»ä»æœåŠ¡å™¨çš„çŠ¶æ€ï¼ˆç»„æˆå‘˜å…³ç³»ï¼‰ï¼Œå¹¶å¤„ç†ä¸»æœåŠ¡å™¨çš„æ•…éšœè½¬ç§»ï¼ˆé¢†å¯¼è€…é€‰ä¸¾ï¼‰ã€‚Kattaè¿˜ä½¿ç”¨ZooKeeperæ¥è·Ÿè¸ªå’Œç®¡ç†åˆ†ç‰‡åˆ†é…ç»™ä»æœåŠ¡å™¨çš„åˆ†é…ï¼ˆé…ç½®ç®¡ç†ï¼‰ã€‚ Yahoo!æ¶ˆæ¯ä»£ç†ï¼ˆYMBï¼‰æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å‘å¸ƒ-è®¢é˜…ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿç®¡ç†æ•°åƒä¸ªä¸»é¢˜ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘å¸ƒæ¶ˆæ¯å¹¶æ¥æ”¶æ¶ˆæ¯ã€‚ä¸ºäº†æä¾›å¯æ‰©å±•æ€§ï¼Œä¸»é¢˜åˆ†å¸ƒåœ¨ä¸€ç»„æœåŠ¡å™¨ä¸­ã€‚æ¯ä¸ªä¸»é¢˜éƒ½ä½¿ç”¨ä¸»-å¤‡æ–¹æ¡ˆè¿›è¡Œå¤åˆ¶ï¼Œç¡®ä¿æ¶ˆæ¯è¢«å¤åˆ¶åˆ°ä¸¤å°æœºå™¨ä¸Šï¼Œä»¥ç¡®ä¿å¯é åœ°æ¶ˆæ¯ä¼ é€’ã€‚æ„æˆYMBçš„æœåŠ¡å™¨ä½¿ç”¨æ— å…±äº«åˆ†å¸ƒå¼æ¶æ„ï¼Œè¿™ä½¿å¾—åè°ƒå¯¹äºæ­£ç¡®æ“ä½œè‡³å…³é‡è¦ã€‚YMBä½¿ç”¨ZooKeeperæ¥ç®¡ç†ä¸»é¢˜çš„åˆ†é…ï¼ˆé…ç½®å…ƒæ•°æ®ï¼‰ï¼Œå¤„ç†ç³»ç»Ÿä¸­æœºå™¨çš„æ•…éšœï¼ˆæ•…éšœæ£€æµ‹å’Œç»„æˆå‘˜å…³ç³»ï¼‰ï¼Œä»¥åŠæ§åˆ¶ç³»ç»Ÿæ“ä½œã€‚YMBçš„znodeæ•°æ®å¸ƒå±€æ˜¾ç¤ºäº†å¦‚ä½•é€šè¿‡ZooKeeperå®ç°å¯¹æ´»è·ƒæœåŠ¡å™¨çš„è´Ÿè½½å’ŒçŠ¶æ€ä¿¡æ¯çš„ç›‘æ§ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡é›†ä¸­æ§åˆ¶å®ç°å¯¹æœåŠ¡çš„ç®¡ç†å’Œåè°ƒã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5 4 Zookeeperå®ç° ZooKeeperé€šè¿‡åœ¨æ„æˆå…¶æœåŠ¡çš„æ¯å°æœåŠ¡å™¨ä¸Šè¿›è¡Œæ•°æ®å¤åˆ¶æ¥ä¿éšœé«˜å¯ç”¨æ€§ã€‚è¿™ä¸€è®¾è®¡è€ƒè™‘åˆ°äº†æœåŠ¡å™¨å¯èƒ½å‘ç”Ÿçš„æ•…éšœï¼ŒåŒæ—¶å‡è®¾æ•…éšœæœåŠ¡å™¨åœ¨åæœŸèƒ½å¤Ÿæ¢å¤ã€‚ä¸ºäº†ç»´æŒæœåŠ¡çš„è¿ç»­æ€§å’Œä¸€è‡´æ€§ï¼ŒZooKeeperé‡‡ç”¨äº†æ‰€ä¸‹å›¾æ‰€å±•ç¤ºçš„ä¸€ç³»åˆ—å…³é”®ç»„ä»¶ï¼Œç¡®ä¿äº†å³ä½¿åœ¨å•ä¸ªæœåŠ¡å™¨æ•…éšœçš„æƒ…å†µä¸‹ï¼Œæ•´ä½“æœåŠ¡ä»èƒ½ç»§ç»­è¿è¡Œã€‚ å½“ZooKeeperæœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œé¦–å…ˆé€šè¿‡è¯·æ±‚å¤„ç†å™¨è¿›è¡Œé¢„å¤„ç†ã€‚å¦‚æœè¯·æ±‚æ¶‰åŠæœåŠ¡å™¨é—´çš„åä½œï¼ˆå¦‚å†™æ“ä½œï¼‰ï¼Œåˆ™ä¼šå¯åŠ¨ä¸€ä¸ªåŸºäºåŸå­å¹¿æ’­åè®®çš„å…±è¯†æœºåˆ¶ã€‚è¿™ç§æœºåˆ¶ç¡®ä¿æ‰€æœ‰æœåŠ¡å™¨æœ€ç»ˆå°†è¯·æ±‚å¯¼è‡´çš„å˜æ›´åŒæ­¥è‡³å®Œå…¨å¤åˆ¶çš„æ•°æ®åº“ä¸­ï¼Œä»è€Œç»´æŠ¤æ•°æ®çš„ä¸€è‡´æ€§ã€‚å¯¹äºåªè¯»è¯·æ±‚ï¼Œåˆ™å¯ä»¥ç›´æ¥ä»æœåŠ¡å™¨æœ¬åœ°çš„æ•°æ®åº“å‰¯æœ¬ä¸­è·å–æ•°æ®å¹¶å½¢æˆå“åº”ï¼Œæ— éœ€è§¦å‘å¤æ‚çš„å…±è¯†è¿‡ç¨‹ï¼Œè¿™å¤§å¤§æå‡äº†è¯»å–æ“ä½œçš„æ•ˆç‡ã€‚ æ•°æ®åº“æ˜¯å†…å­˜ä¸­çš„ï¼ŒåŒ…å«æ•´ä¸ªæ•°æ®æ ‘ï¼Œæ¯ä¸ªznodeé»˜è®¤å­˜å‚¨æœ€å¤§1MBçš„æ•°æ®ï¼Œä½†æ­¤å€¼å¯é…ç½®ã€‚ä¸ºäº†ç¡®ä¿å¯æ¢å¤æ€§ï¼Œæ›´æ–°é«˜æ•ˆåœ°è®°å½•åˆ°ç£ç›˜ï¼Œä¸”åœ¨åº”ç”¨äºå†…å­˜æ•°æ®åº“å‰ï¼Œå¼ºåˆ¶å†™å…¥ç£ç›˜ã€‚å¦‚åŒChubbyï¼Œæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªé‡æ’­æ—¥å¿—ï¼Œå³å†™å‰æ—¥å¿—ï¼Œè®°å½•å·²æäº¤çš„æ“ä½œï¼Œå¹¶å®šæœŸç”Ÿæˆå†…å­˜æ•°æ®åº“çš„å¿«ç…§ã€‚ æ¯ä¸ªZooKeeperæœåŠ¡å™¨æœåŠ¡äºå®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è¿æ¥è‡³æŸä¸€å°æœåŠ¡å™¨æäº¤è¯·æ±‚ã€‚è¯»è¯·æ±‚ä»å„æœåŠ¡å™¨æœ¬åœ°æ•°æ®åº“çš„å‰¯æœ¬ä¸­æœåŠ¡ï¼Œè€Œå†™è¯·æ±‚åˆ™é€šè¿‡å…±è¯†åè®®å¤„ç†ã€‚ä½œä¸ºå…±è¯†åè®®çš„ä¸€éƒ¨åˆ†ï¼Œå†™è¯·æ±‚è¢«è½¬å‘è‡³è¢«ç§°ä¸ºé¢†å¯¼è€…çš„å•ä¸€æœåŠ¡å™¨ã€‚å…¶ä½™æœåŠ¡å™¨ï¼Œå³è·Ÿéšè€…ï¼Œæ¥æ”¶æ¥è‡ªé¢†å¯¼è€…çš„çŠ¶æ€å˜æ›´æè®®ï¼Œå¹¶å¯¹çŠ¶æ€å˜æ›´è¾¾æˆä¸€è‡´ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.1 4.1 è¯·æ±‚å¤„ç† ç”±äºæ¶ˆæ¯å±‚çš„åŸå­æ€§ï¼ŒZookeeperä¿è¯æœ¬åœ°å‰¯æœ¬ä¸ä¼šåˆ†æ­§ï¼Œå°½ç®¡ä»»ä¸€æ—¶åˆ»æŸäº›æœåŠ¡å™¨å¯èƒ½åº”ç”¨äº†æ›´å¤šäº‹åŠ¡ã€‚ä¸åŒäºå®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œäº‹åŠ¡æ˜¯å¹‚ç­‰çš„ã€‚å½“é¢†å¯¼è€…æ¥æ”¶åˆ°å†™è¯·æ±‚æ—¶ï¼Œå®ƒè®¡ç®—å‡ºå†™æ“ä½œåº”ç”¨åçš„ç³»ç»ŸçŠ¶æ€ï¼Œå¹¶è½¬æ¢ä¸ºæ•æ‰æ–°çŠ¶æ€çš„äº‹åŠ¡ã€‚å¿…é¡»è®¡ç®—æœªæ¥çŠ¶æ€ï¼Œå› ä¸ºå¯èƒ½æœ‰å°šæœªåº”ç”¨åˆ°æ•°æ®åº“çš„å¾…å¤„ç†äº‹åŠ¡ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯æ‰§è¡Œæ¡ä»¶setDataæ“ä½œï¼Œå¦‚æœè¯·æ±‚ä¸­çš„ç‰ˆæœ¬å·ä¸å¾…æ›´æ–°znodeçš„æœªæ¥ç‰ˆæœ¬å·åŒ¹é…ï¼ŒæœåŠ¡ç”ŸæˆåŒ…å«æ–°æ•°æ®ã€æ–°ç‰ˆæœ¬å·å’Œæ›´æ–°æ—¶é—´æˆ³çš„setDataTXNã€‚è‹¥å‡ºç°é”™è¯¯ï¼Œå¦‚ç‰ˆæœ¬å·ä¸åŒ¹é…æˆ–å¾…æ›´æ–°çš„znodeä¸å­˜åœ¨ï¼Œå°†ç”ŸæˆerrorTXNã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:5:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.2 4.2 åŸå­å¹¿æ’­ æ‰€æœ‰æ›´æ–°ZooKeeperçŠ¶æ€çš„è¯·æ±‚å‡è½¬å‘è‡³é¢†å¯¼è€…ã€‚é¢†å¯¼è€…æ‰§è¡Œè¯·æ±‚å¹¶é€šè¿‡Zabï¼Œä¸€ç§åŸå­å¹¿æ’­åè®®ï¼Œå¹¿æ’­çŠ¶æ€å˜æ›´ã€‚æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚çš„æœåŠ¡å™¨åœ¨äº¤ä»˜ç›¸åº”çŠ¶æ€å˜æ›´æ—¶å“åº”å®¢æˆ·ç«¯ã€‚Zabé»˜è®¤ä½¿ç”¨ç®€å•å¤šæ•°ç¥¨æœºåˆ¶å†³å®šææ¡ˆï¼Œå› æ­¤Zabå’ŒZooKeeperä»…åœ¨å¤šæ•°æœåŠ¡å™¨æ­£å¸¸ï¼ˆå³åœ¨$2f+1$æœåŠ¡å™¨ä¸­å¯å®¹å¿$f$æ¬¡æ•…éšœï¼‰æ—¶å·¥ä½œã€‚ ä¸ºäº†å®ç°é«˜ååé‡ï¼ŒZooKeeperå°½åŠ›ä¿æŒè¯·æ±‚å¤„ç†ç®¡é“æ»¡è½½ï¼Œå¯èƒ½æœ‰æˆåƒä¸Šä¸‡çš„è¯·æ±‚å¤„äºç®¡é“çš„ä¸åŒéƒ¨åˆ†ã€‚ç”±äºçŠ¶æ€å˜æ›´ä¾èµ–äºå…ˆå‰çŠ¶æ€å˜æ›´çš„åº”ç”¨ï¼ŒZabæä¾›äº†æ¯”å¸¸è§„åŸå­å¹¿æ’­æ›´å¼ºçš„é¡ºåºä¿è¯ï¼š ç”±é¢†å¯¼è€…å¹¿æ’­çš„å˜æ›´æŒ‰ç…§å‘é€é¡ºåºäº¤ä»˜ æ‰€æœ‰æ¥è‡ªä¹‹å‰é¢†å¯¼è€…çš„å˜æ›´åœ¨æ–°é¢†å¯¼è€…å¹¿æ’­è‡ªèº«å˜æ›´å‰äº¤ä»˜ã€‚ ä½¿ç”¨TCPä½œä¸ºä¼ è¾“å±‚ç®€åŒ–äº†å®æ–½ï¼Œå› ä¸ºæ¶ˆæ¯é¡ºåºç”±ç½‘ç»œç»´æŠ¤ã€‚Zabé€‰å‡ºçš„é¢†å¯¼è€…åŒæ—¶ä¹Ÿæ˜¯ZooKeeperçš„é¢†å¯¼è€…ï¼Œåˆ›å»ºäº‹åŠ¡çš„åŒæ—¶ä¹Ÿæè®®äº‹åŠ¡ã€‚ä½¿ç”¨æ—¥å¿—ä½œä¸ºå†…å­˜æ•°æ®åº“çš„å†™å‰æ—¥å¿—ï¼Œé¿å…äº†ä¸¤æ¬¡å†™ç£ç›˜ã€‚Zabåœ¨å¸¸è§„æ“ä½œä¸­ç¡®å®æŒ‰é¡ºåºå’Œæ°å¥½ä¸€æ¬¡äº¤ä»˜æ‰€æœ‰æ¶ˆæ¯ï¼Œä½†ç”±äºZabæœªæŒä¹…è®°å½•æ¯ä¸ªå·²äº¤ä»˜æ¶ˆæ¯çš„IDï¼Œå› æ­¤åœ¨æ¢å¤è¿‡ç¨‹ä¸­å¯èƒ½é‡ä¼ æ¶ˆæ¯ã€‚ç”±äºä½¿ç”¨äº†å¹‚ç­‰äº‹åŠ¡ï¼Œåªè¦æŒ‰é¡ºåºäº¤ä»˜ï¼Œå¤šæ¬¡äº¤ä»˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:5:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.3 4.3 å¤åˆ¶æ•°æ®åº“ æ¯ä¸ªå‰¯æœ¬åœ¨å†…å­˜ä¸­ä¿å­˜ä¸€ä»½ZooKeeperçŠ¶æ€çš„æ‹·è´ã€‚å½“æœåŠ¡å™¨ä»å´©æºƒä¸­æ¢å¤ï¼Œéœ€è¦æ¢å¤æ­¤å†…éƒ¨çŠ¶æ€ã€‚é‡æ”¾æ‰€æœ‰å·²äº¤ä»˜çš„æ¶ˆæ¯ä»¥æ¢å¤çŠ¶æ€å¯èƒ½è€—æ—¶è¿‡é•¿ï¼Œæ•…ZooKeeperä½¿ç”¨å‘¨æœŸæ€§å¿«ç…§ï¼Œä»…è¦æ±‚é‡ä¼ è‡ªå¿«ç…§å¼€å§‹ä»¥æ¥çš„æ¶ˆæ¯ã€‚æˆ‘ä»¬ç§°ZooKeeperå¿«ç…§ä¸ºæ¨¡ç³Šå¿«ç…§ï¼Œå› ä¸ºä¸é”å®šZooKeeperçŠ¶æ€æ¥ç”Ÿæˆå¿«ç…§ï¼›ç›¸åï¼Œè¿›è¡Œæ·±æœï¼ŒåŸå­è¯»å–æ¯ä¸ªznodeçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Œå†™å…¥ç£ç›˜ã€‚ä½†æ˜¯ï¼Œç”±äºå¿«ç…§çš„ç”Ÿæˆå¹¶éç¬æ—¶å®Œæˆï¼Œè¿™æ„å‘³ç€åœ¨å¿«ç…§ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œæ–°çš„çŠ¶æ€å˜æ›´å¯èƒ½ä¼šå‘ç”Ÿã€‚å› æ­¤ï¼Œæœ€ç»ˆçš„å¿«ç…§å¯èƒ½åŒ…å«äº†éƒ¨åˆ†å·²æäº¤ä½†æœªè¢«å¿«ç…§æ•è·çš„çŠ¶æ€å˜æ›´ï¼Œå¯¼è‡´å¿«ç…§ä¸­çš„æ•°æ®å¹¶ä¸å®Œå…¨åæ˜ æŸä¸ªæ—¶é—´ç‚¹çš„ç³»ç»ŸçŠ¶æ€ã€‚ç„¶è€Œï¼Œç”±äºçŠ¶æ€å˜æ›´æ˜¯å¹‚ç­‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰é¡ºåºé‡å¤åº”ç”¨å®ƒä»¬ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ZooKeeperæ•°æ®æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹/fooå’Œ/gooåˆ†åˆ«å…·æœ‰å€¼f1å’Œg1ï¼Œä¸”ç‰ˆæœ¬å‡ä¸º$1$ï¼Œå½“æ¨¡ç³Šå¿«ç…§å¼€å§‹æ—¶ï¼Œä»¥ä¸‹çŠ¶æ€å˜æ›´æµ\u003ctransactionType, path, value, new-version\u003eåˆ°è¾¾ï¼š \u003cSetDataTXN, /foo, f2, 2\u003e \u003cSetDataTXN, /goo, g2, 2\u003e \u003cSetDataTXN, /foo, f3, 3\u003e å¤„ç†è¿™äº›çŠ¶æ€å˜æ›´åï¼Œ/fooå’Œ/gooçš„å€¼åˆ†åˆ«ä¸ºf3å’Œg2ï¼Œç‰ˆæœ¬ä¸º$3$å’Œ$2$ã€‚ç„¶è€Œï¼Œæ¨¡ç³Šå¿«ç…§å¯èƒ½è®°å½•äº†/fooå’Œ/gooçš„å€¼ä¸ºf3å’Œg1ï¼Œç‰ˆæœ¬ä¸º$3$å’Œ$1$ï¼Œå³ç¬¬ä¸€ä¸ªå˜æ›´å’Œç¬¬ä¸‰ä¸ªå˜æ›´è¢«å¿«ç…§æ•è·ï¼Œä½†ç¬¬äºŒä¸ªå˜æ›´ä¹‹å‰å¿«ç…§ç”Ÿæˆå®Œæˆï¼Œè¿™ä¸æ˜¯ZooKeeperæ•°æ®æ ‘çš„æœ‰æ•ˆçŠ¶æ€ã€‚ å½“æœåŠ¡å™¨å´©æºƒå¹¶é‡æ–°å¯åŠ¨æ—¶ï¼Œå®ƒä¼šä»æœ€è¿‘çš„å¿«ç…§æ¢å¤ï¼Œç„¶åé‡æ”¾è‡ªè¯¥å¿«ç…§ä¹‹åçš„æ‰€æœ‰äº‹åŠ¡æ—¥å¿—ã€‚ç”±äºäº‹åŠ¡æ˜¯å¹‚ç­‰çš„ï¼Œå³ä½¿å¿«ç…§ä¸­çš„çŠ¶æ€ä¸å®é™…çš„æŸæ—¶åˆ»çŠ¶æ€ä¸å®Œå…¨ä¸€è‡´ï¼Œé‡æ”¾äº‹åŠ¡æ—¥å¿—ä¹Ÿèƒ½ç¡®ä¿æœåŠ¡å™¨æ¢å¤åˆ°æœ€åä¸€è‡´çš„çŠ¶æ€ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:5:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.4 4.4 å®¢æˆ·ç«¯-æœåŠ¡å™¨äº¤äº’ ZooKeeperé€šè¿‡å®¢æˆ·ç«¯-æœåŠ¡å™¨äº¤äº’å®ç°é«˜æ•ˆçš„åˆ†å¸ƒå¼åè°ƒã€‚æœåŠ¡å™¨åœ¨å¤„ç†å†™è¯·æ±‚æ—¶ï¼Œä¼šå‘é€å¹¶æ¸…é™¤ç›¸å…³ç›‘è§†é€šçŸ¥ï¼Œä¿è¯é€šçŸ¥çš„é¡ºåºæ€§ã€‚æœåŠ¡å™¨é¡ºåºå¤„ç†å†™è¯·æ±‚ï¼Œè€Œè¯»è¯·æ±‚åˆ™åœ¨æœ¬åœ°æœåŠ¡å™¨ä¸Šç‹¬ç«‹å¤„ç†ï¼Œæ¯ä¸ªè¯»è¯·æ±‚éƒ½ä¼šæ ‡è®°ä¸€ä¸ªzxidï¼Œä»£è¡¨æœåŠ¡å™¨å·²çœ‹åˆ°çš„æœ€åäº‹åŠ¡ï¼Œä»è€Œç¡®ä¿è¯»å†™è¯·æ±‚çš„éƒ¨åˆ†é¡ºåºæ€§ã€‚ æœ¬åœ°å¤„ç†è¯»è¯·æ±‚å¸¦æ¥äº†å‡ºè‰²çš„è¯»å–æ€§èƒ½ï¼Œå› ä¸ºå®ƒä»…ä»…æ˜¯æœ¬åœ°æœåŠ¡å™¨ä¸Šçš„å†…å­˜æ“ä½œï¼Œæ— éœ€ç£ç›˜æ´»åŠ¨æˆ–è¿è¡Œåè®®ã€‚ç„¶è€Œï¼Œè¿™ç§å¿«é€Ÿè¯»å–å¯èƒ½ä¸ä¿è¯è¯»æ“ä½œçš„é¡ºåºæ€§ï¼Œå¯èƒ½ä¼šè¿”å›è¿‡æ—¶çš„æ•°æ®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒZooKeeperæä¾›äº†åŒæ­¥æ“ä½œsync()ï¼Œé€šè¿‡é¢†å¯¼è€…å¼‚æ­¥æ‰§è¡Œå¹¶æ’åºï¼Œå®¢æˆ·ç«¯åªéœ€è¯»å–åç«‹å³è°ƒç”¨sync()ï¼Œç¡®ä¿è¯»æ“ä½œèƒ½å¤Ÿè¿”å›æœ€æ–°ï¼ˆsyncä¹‹å‰æ‰€æœ‰çš„å˜æ›´ï¼‰çš„æ•°æ®ã€‚ ZooKeeperæœåŠ¡å™¨ä½¿ç”¨FIFOé¡ºåºå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶åœ¨å“åº”ä¸­åŒ…å«ç›¸å…³çš„zxidï¼Œç¡®ä¿å®¢æˆ·ç«¯å³ä½¿åœ¨æœåŠ¡å™¨é—´åˆ‡æ¢æ—¶ä¹Ÿèƒ½çœ‹åˆ°æœ€æ–°çš„æ•°æ®ï¼ˆéœ€è¦æ£€æŸ¥zxidï¼‰ã€‚æ­¤å¤–ï¼ŒZooKeeperä½¿ç”¨è¶…æ—¶æœºåˆ¶æ¥æ£€æµ‹å®¢æˆ·ç«¯ä¼šè¯æ•…éšœï¼Œå®¢æˆ·ç«¯é€šè¿‡å‘é€å¿ƒè·³æ¶ˆæ¯ï¼ˆåŒ…å«æœ€åä¸€ä¸ªzxidï¼‰æ¥ç»´æŒä¼šè¯ï¼Œå¦‚æœæ— æ³•ä¸å½“å‰æœåŠ¡å™¨é€šä¿¡ï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–æœåŠ¡å™¨ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:5:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"6 5 è¯„ä¼° ZooKeeperå±•ç°å‡ºäº†å“è¶Šçš„æ€§èƒ½ï¼Œå…¶é«˜ååé‡å’Œä½è¯·æ±‚å»¶è¿Ÿåœ¨å¤šä¸ªåŸºå‡†æµ‹è¯•ä¸­å¾—åˆ°äº†è¯æ˜ã€‚åœ¨æ¨¡ä»¿ChubbyåŸºå‡†çš„æµ‹è¯•ä¸­ï¼Œå³ä½¿å¤„ç†çš„æ•°æ®é‡å¢åŠ ï¼ŒZooKeeperçš„ååé‡ä¹Ÿè¾¾åˆ°äº†Chubbyçš„ä¸‰å€ä»¥ä¸Šã€‚å…·ä½“æ¥è¯´ï¼Œå•ä¸ªå·¥ä½œè¿›ç¨‹åœ¨ä¸‰ä¸ªæœåŠ¡å™¨ä¸Šçš„å¹³å‡è¯·æ±‚å»¶è¿Ÿä»…ä¸º1.2æ¯«ç§’ï¼Œåœ¨ä¹ä¸ªæœåŠ¡å™¨ä¸Šä¸º1.4æ¯«ç§’ã€‚ åœ¨å±éšœæ€§èƒ½æµ‹è¯•ä¸­ï¼ŒZooKeeperå¤„ç†å±éšœæ“ä½œçš„èƒ½åŠ›éšç€å±éšœæ•°é‡å’Œå®¢æˆ·ç«¯æ•°é‡çš„å¢åŠ è€Œçº¿æ€§å¢é•¿ï¼Œæ˜¾ç¤ºå‡ºå¯¹å¹¶å‘è®¿é—®çš„é«˜æ•ˆç®¡ç†ï¼Œå¹¶æ²¡æœ‰å‡ºç°æ„å¤–çš„å»¶è¿Ÿã€‚å³ä½¿åœ¨é«˜æ¯”ä¾‹çš„è¯»æ“ä½œä¸‹ï¼ˆ80%ï¼‰ï¼ŒZooKeeperçš„å±éšœæ“ä½œååé‡ä¹Ÿä¿æŒåœ¨æ¯ç§’1,950åˆ°3,100æ¬¡ä¹‹é—´ï¼Œè¿œé«˜äºå®é™…åº”ç”¨ä¸­æ‰€éœ€çš„æ€§èƒ½ã€‚ ","date":"2024-08-11","objectID":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/:6:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","ZAP","ZooKeeper"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ZooKeeper: Wait-free coordination for Internet-scale systems","uri":"/posts/08.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0zookeeper-wait-free-coordination-for-internet-scale-systems/"},{"categories":["å·¥å…·"],"content":"1 tunnelmole source Tunnelmole æ˜¯ä¸€ä¸ªç®€å•çš„å·¥å…·ï¼Œå¯ä»¥ä¸ºæœ¬åœ°è¿è¡Œçš„ HTTP(s) æœåŠ¡å™¨æä¾›å…¬å…± URLã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è·å¾—ä¸€ä¸ªå…¬å…± URLï¼š ç½‘ç»œæœåŠ¡å™¨ Dockerå®¹å™¨ API é™æ€ç½‘ç«™ etc.. å®‰è£…æ–¹æ³•å¦‚ä¸‹ï¼š curl -O https://install.tunnelmole.com/n3d5g/install \u0026\u0026 sudo bash install ä½¿ç”¨æ–¹æ³•ï¼š tmole \u003cyour_server_port\u003e ä¾‹å¦‚ï¼š ","date":"2024-08-02","objectID":"/posts/03.%E7%BD%91%E7%BB%9C%E5%B7%A5%E5%85%B7/:1:0","tags":["network"],"title":"å¥½ç”¨çš„å·¥å…·","uri":"/posts/03.%E7%BD%91%E7%BB%9C%E5%B7%A5%E5%85%B7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 è„‘è£‚ è®¸å¤šå®¹é”™ç³»ç»Ÿä½¿ç”¨ä¸€ä¸ªå•ä¸»èŠ‚ç‚¹æ¥å†³å®šä¸»å‰¯æœ¬ã€‚ MapReduceï¼šç”±å•ä¸»èŠ‚ç‚¹æ§åˆ¶è®¡ç®—å¤åˆ¶ã€‚ GFSï¼šä¸»å¤‡å¤åˆ¶æ•°æ®ï¼Œå¹¶ç”±å•ä¸»èŠ‚ç‚¹ç¡®å®šä¸»æ‹·è´çš„ä½ç½®ã€‚ VMware FTï¼šä¸»è™šæœºå’Œå¤‡ä»½è™šæœºä¹‹é—´å¤åˆ¶æŒ‡ä»¤ï¼Œéœ€è¦å•ç‚¹çš„Test-and-SetæœåŠ¡ç¡®è®¤ä¸»è™šæœºã€‚ è¿™ä¸‰ä¸ªä¾‹å­éƒ½æ˜¯ä¸€ä¸ªå¤šå‰¯æœ¬ç³»ç»Ÿï¼Œç³»ç»Ÿå®¹é”™çš„å…³é”®ç‚¹è½¬ç§»åˆ°è¿™ä¸ªä¸»èŠ‚ç‚¹ä¸Šã€‚ ä½¿ç”¨å•ä¸»èŠ‚ç‚¹ï¼Œæˆ‘ä»¬åˆ™éœ€è¦é¿å…è„‘è£‚ï¼ˆSplit-Brainï¼‰é—®é¢˜ã€‚è„‘è£‚æŒ‡çš„æ˜¯åœ¨å¤šå‰¯æœ¬ç³»ç»Ÿä¸­ï¼Œå› ç½‘ç»œåˆ†è£‚å¯¼è‡´å¤šä¸ªå‰¯æœ¬éƒ½è®¤ä¸ºè‡ªå·±æ˜¯ä¸»å‰¯æœ¬ï¼Œä»è€Œå‡ºç°æ•°æ®ä¸ä¸€è‡´æˆ–åŠŸèƒ½å†²çªçš„é—®é¢˜ã€‚ è¿™é‡Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆ æ„å»ºé«˜å¯é ç½‘ç»œï¼šå¦‚æœç½‘ç»œå®Œå…¨ä¸å‡ºç°æ•…éšœï¼Œå®¢æˆ·ç«¯æ— æ³•è®¿é—®çš„æœåŠ¡å™¨å³è¢«è®¤ä¸ºæ˜¯å…³æœºï¼Œè¿™æ ·å¯ä»¥æ’é™¤è„‘è£‚çš„å¯èƒ½ã€‚ä½†éœ€è¦å¤§é‡èµ„é‡‘å’Œæ§åˆ¶ç‰©ç†ç¯å¢ƒã€‚ äººå·¥è§£å†³é—®é¢˜ï¼šå®¢æˆ·ç«¯é»˜è®¤ç­‰å¾…ä¸¤ä¸ªæœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœåªæ”¶åˆ°ä¸€ä¸ªå“åº”ï¼Œéœ€äººå·¥æ£€æŸ¥ä¸¤ä¸ªæœåŠ¡å™¨çš„çŠ¶æ€ã€‚äººå·¥æ£€æŸ¥è™½ç„¶èƒ½è§£å†³é—®é¢˜ï¼Œä½†å¯èƒ½ä¸å¤ŸåŠæ—¶ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 è¿‡åŠç¥¨å†³ åœ¨æ„å»ºèƒ½è‡ªåŠ¨æ¢å¤ï¼ŒåŒæ—¶åˆé¿å…è„‘è£‚çš„å¤šå‰¯æœ¬ç³»ç»Ÿæ—¶ï¼Œå…³é”®ç‚¹åœ¨äºè¿‡åŠç¥¨å†³ï¼ˆMajority Voteï¼‰ï¼Œè¿™æ˜¯Raftè®ºæ–‡ä¸­æå‡ºçš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œå³åœ¨ä¸€ä¸ªå¤šå‰¯æœ¬ç³»ç»Ÿä¸­ï¼Œä»»ä½•æ“ä½œå¿…é¡»å¾—åˆ°è¶…è¿‡ä¸€åŠçš„æœåŠ¡å™¨åŒæ„æ‰èƒ½å®Œæˆã€‚ä¸ºäº†æœ‰æ•ˆä½¿ç”¨è¿‡åŠç¥¨å†³ï¼ŒæœåŠ¡å™¨æ•°é‡åº”è¯¥æ˜¯å¥‡æ•°ã€‚è¿™æ ·åœ¨å‡ºç°ç½‘ç»œåˆ†åŒºæ—¶ï¼Œä¸€ä¸ªåˆ†åŒºæ— æ³•æ‹¥æœ‰è¶…è¿‡åŠæ•°çš„æœåŠ¡å™¨ï¼Œä»è€Œé¿å…è„‘è£‚ã€‚å¯¹äºè¿‡åŠç¥¨å†³ï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªé€šç”¨æ–¹ç¨‹æ¥æè¿°ï¼š å¦‚æœç³»ç»Ÿæœ‰$2\\times F+1$ä¸ªæœåŠ¡å™¨ï¼Œé‚£ä¹ˆç³»ç»Ÿæœ€å¤šå¯ä»¥æ¥å—$F$ä¸ªæœåŠ¡å™¨å‡ºç°æ•…éšœã€‚ Raftåè®®ä¾èµ–è¿‡åŠç¥¨å†³æ¥è¿›è¡ŒLeaderé€‰ä¸¾å’Œæ—¥å¿—æäº¤ã€‚æ¯ä¸ªæ“ä½œéœ€è¦è¿‡åŠçš„æœåŠ¡å™¨æ‰¹å‡†ã€‚ä»»ä½•ä¸¤ä¸ªæ“ä½œçš„è¿‡åŠæœåŠ¡å™¨è‡³å°‘æœ‰ä¸€ä¸ªé‡å ã€‚ Leaderé€‰ä¸¾ï¼šæ–°é€‰å‡ºçš„Leaderå¿…ç„¶è·å¾—è¿‡åŠæœåŠ¡å™¨çš„é€‰ç¥¨ï¼Œè€Œè¿™äº›æœåŠ¡å™¨ä¸æ—§Leaderçš„æœåŠ¡å™¨æœ‰é‡å ï¼Œå› æ­¤çŸ¥é“æ—§Leaderçš„ä»»æœŸå·ã€‚ æ—¥å¿—ä¸€è‡´æ€§ï¼šæ–°Leaderçš„è¿‡åŠæœåŠ¡å™¨åŒ…å«äº†æ—§Leaderçš„æ“ä½œï¼Œç¡®ä¿æ—¥å¿—ä¸€è‡´æ€§ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 Raftæ¦‚è¿° Raftåè®®ä½œä¸ºåº“ï¼ˆLibraryï¼‰å­˜åœ¨äºæœåŠ¡ä¸­ï¼Œæ¯ä¸ªRaftå‰¯æœ¬åŒ…å«åº”ç”¨ç¨‹åºä»£ç å’ŒRaftåº“ã€‚åº”ç”¨ç¨‹åºä»£ç å¤„ç†RPCæˆ–å…¶ä»–å®¢æˆ·ç«¯è¯·æ±‚ï¼ŒRaftåº“è´Ÿè´£åŒæ­¥å¤šå‰¯æœ¬ä¹‹é—´çš„æ“ä½œã€‚ æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š å®¢æˆ·ç«¯è¯·æ±‚ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ˆå¦‚Putæˆ–Getï¼‰åˆ°Rafté›†ç¾¤çš„LeaderèŠ‚ç‚¹ã€‚ è¯·æ±‚å¤„ç†ï¼š Raftå±‚ï¼šLeaderèŠ‚ç‚¹å°†è¯·æ±‚æ“ä½œä¼ é€’ç»™Raftå±‚ï¼Œè¦æ±‚å°†æ“ä½œå†™å…¥æ—¥å¿—ã€‚RaftèŠ‚ç‚¹ä¹‹é—´çš„äº¤äº’ç¡®ä¿æ“ä½œè¢«è¿‡åŠèŠ‚ç‚¹å¤åˆ¶ã€‚å½“LeaderèŠ‚ç‚¹ç¡®è®¤è¿‡åŠå‰¯æœ¬éƒ½æœ‰æ“ä½œçš„æ‹·è´åï¼Œé€šçŸ¥åº”ç”¨ç¨‹åºå±‚æ‰§è¡Œæ“ä½œã€‚ åº”ç”¨ç¨‹åºå±‚ï¼šä»…åœ¨æ”¶åˆ°Raftå±‚çš„ç¡®è®¤åæ‰æ‰§è¡Œæ“ä½œï¼ˆæ›´æ–°æ•°æ®åº“æˆ–è¯»å–å€¼ï¼‰ã€‚ æ“ä½œæäº¤ï¼š Raftå±‚ï¼šé€šçŸ¥åº”ç”¨ç¨‹åºå±‚ï¼Œæ“ä½œå·²åœ¨è¿‡åŠå‰¯æœ¬ä¸­å¤åˆ¶å®Œæˆï¼Œå¯ä»¥æ‰§è¡Œã€‚ åº”ç”¨ç¨‹åºå±‚ï¼šæ‰§è¡Œæ“ä½œå¹¶æœ€ç»ˆè¿”å›ç»“æœç»™å®¢æˆ·ç«¯ã€‚ ä¸ºä½•ä¸éœ€è¦æ‹·è´åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Ÿ ä¸ºäº†å®¹é”™ï¼Œç³»ç»Ÿåªéœ€è¿‡åŠçš„å‰¯æœ¬å³å¯å®Œæˆæ“ä½œï¼Œè¿™æ ·å³ä½¿éƒ¨åˆ†æœåŠ¡å™¨æ•…éšœï¼Œç³»ç»Ÿä»èƒ½ç»§ç»­å·¥ä½œã€‚ é™¤äº†LeaderèŠ‚ç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹çš„åº”ç”¨ç¨‹åºå±‚ä¼šæœ‰ä»€ä¹ˆæ ·çš„åŠ¨ä½œï¼Ÿ åœ¨æ“ä½œåœ¨LeaderèŠ‚ç‚¹æäº¤åï¼Œå…¶ä»–å‰¯æœ¬çš„Raftå±‚å°†æ“ä½œä¼ é€’ç»™æœ¬åœ°åº”ç”¨ç¨‹åºå±‚ï¼Œç¡®ä¿æ‰€æœ‰å‰¯æœ¬çš„æ“ä½œåºåˆ—ä¸€è‡´ï¼ŒçŠ¶æ€æœ€ç»ˆä¿æŒä¸€è‡´ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 æ—¥å¿— å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå±•ç¤ºäº†Raftåè®®åœ¨å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚æ—¶çš„æ¶ˆæ¯äº¤äº’æµç¨‹ï¼ŒAEä»£è¡¨AppendEntries RPCã€‚ å®¢æˆ·ç«¯è¯·æ±‚ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªPutè¯·æ±‚åˆ°å½“å‰Rafté›†ç¾¤çš„LeaderèŠ‚ç‚¹ï¼ˆS1ï¼‰ã€‚ LeaderèŠ‚ç‚¹å¤„ç†ï¼šS1çš„Raftå±‚å‘é€AppendEntries RPCåˆ°å…¶ä»–ä¸¤ä¸ªå‰¯æœ¬èŠ‚ç‚¹ï¼ˆS2ã€S3ï¼‰ã€‚S1ç­‰å¾…è‡³å°‘ä¸€ä¸ªFollowerèŠ‚ç‚¹ï¼ˆS2æˆ–S3ï¼‰çš„å“åº”ä»¥è¾¾åˆ°è¿‡åŠèŠ‚ç‚¹çš„å“åº”ã€‚ FollowerèŠ‚ç‚¹å“åº”ï¼šS2ã€S3æ¥æ”¶AppendEntries RPCå¹¶è¿”å›å“åº”ç»™Leaderï¼ˆS1ï¼‰ã€‚S1åªéœ€ç­‰å¾…ä¸€ä¸ªFollowerèŠ‚ç‚¹çš„æ­£ç¡®å“åº”å³å¯ã€‚ æ“ä½œæäº¤ï¼šä¸€æ—¦S1æ”¶åˆ°è¿‡åŠèŠ‚ç‚¹çš„æ­£ç¡®å“åº”ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰ï¼ŒS1æ‰§è¡Œå®¢æˆ·ç«¯è¯·æ±‚å¹¶è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ã€‚ é€šçŸ¥å…¶ä»–å‰¯æœ¬ï¼šS2ã€S3åœ¨æ”¶åˆ°AppendEntriesåä¸ç¡®å®šè¯·æ±‚æ˜¯å¦è¢«Leaderæäº¤ã€‚Leaderéœ€è¦åœ¨ä¸‹ä¸€æ¬¡AppendEntriesæˆ–å¿ƒè·³æ¶ˆæ¯ä¸­é€šçŸ¥å…¶ä»–å‰¯æœ¬è¯·æ±‚å·²è¢«commitã€‚å…¶ä»–å‰¯æœ¬æ”¶åˆ°æ­¤æ¶ˆæ¯åï¼Œæ›´æ–°æœ¬åœ°çŠ¶æ€ï¼Œæ‰§è¡Œå·²æäº¤çš„è¯·æ±‚ã€‚ Raftç³»ç»Ÿå¯¹Logçš„å…³æ³¨æœ‰å‡ ä¸ªå…³é”®åŸå› ï¼š æ“ä½œæ’åºï¼šæ‰€æœ‰å‰¯æœ¬ä¸ä»…è¦æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œè¿˜è¦ä»¥ç›¸åŒçš„é¡ºåºæ‰§è¡Œè¿™äº›æ“ä½œã€‚Logç”±ç¼–å·çš„æ§½ä½ï¼ˆç±»ä¼¼ä¸€ä¸ªæ•°ç»„ï¼‰ç»„æˆï¼Œæ§½ä½çš„æ•°å­—è¡¨ç¤ºäº†Leaderé€‰æ‹©çš„é¡ºåºã€‚ ä¸´æ—¶å­˜å‚¨ï¼šFolloweræ”¶åˆ°æ“ä½œä½†è¿˜æœªæ‰§è¡Œæ—¶ï¼Œéœ€è¦å°†æ“ä½œå­˜æ”¾åœ¨æŸå¤„ï¼Œç›´åˆ°æ”¶åˆ°Leaderå‘é€çš„commitå·ã€‚Logå°±æ˜¯è¿™ä¸ªä¸´æ—¶å­˜å‚¨çš„åœ°æ–¹ã€‚Followeråœ¨æ“ä½œcommitå‰ä¸ç¡®å®šè¿™äº›æ“ä½œæ˜¯å¦ä¼šè¢«æ‰§è¡Œï¼Œæœ‰æ—¶è¿™äº›æ“ä½œå¯èƒ½ä¼šè¢«ä¸¢å¼ƒã€‚ é‡ä¼ æœºåˆ¶ï¼šLeaderè®°å½•æ“ä½œåœ¨å…¶Logä¸­ï¼Œå› ä¸ºè¿™äº›æ“ä½œå¯èƒ½éœ€è¦é‡ä¼ ç»™Followerã€‚å¦‚æœFollowerçŸ­æ—¶é—´ç¦»çº¿æˆ–ä¸¢å¤±äº†ä¸€äº›æ¶ˆæ¯ï¼ŒLeaderéœ€è¦èƒ½å¤Ÿå‘Followeré‡ä¼ ä¸¢å¤±çš„Logæ¶ˆæ¯ã€‚å³ä½¿æ˜¯å·²commitçš„è¯·æ±‚ï¼Œä¸ºäº†å‘ä¸¢å¤±ç›¸åº”æ“ä½œçš„å‰¯æœ¬é‡ä¼ ï¼ŒLeaderä¹Ÿéœ€è¦åœ¨Logä¸­å­˜å‚¨è¿™äº›æ“ä½œã€‚ çŠ¶æ€æ¢å¤ï¼šLogå¸®åŠ©é‡å¯çš„æœåŠ¡å™¨æ¢å¤çŠ¶æ€ã€‚æ•…éšœé‡å¯åçš„æœåŠ¡å™¨ä½¿ç”¨å­˜å‚¨åœ¨ç£ç›˜ä¸­çš„Logï¼Œä»å¤´æ‰§è¡Œå…¶ä¸­çš„æ“ä½œï¼Œé‡å»ºæ•…éšœå‰çš„çŠ¶æ€å¹¶ç»§ç»­è¿è¡Œã€‚æ¯ä¸ªRaftèŠ‚ç‚¹éƒ½éœ€è¦å°†Logå†™å…¥ç£ç›˜ï¼Œç¡®ä¿æ•…éšœé‡å¯åLogèƒ½ä¿ç•™ï¼Œå¸®åŠ©æœåŠ¡å™¨æ¢å¤çŠ¶æ€ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 åº”ç”¨å±‚æ¥å£ åœ¨Rafté›†ç¾¤ä¸­ï¼Œæ¯ä¸€ä¸ªå‰¯æœ¬ä¸Šï¼Œåº”ç”¨å±‚ï¼ˆå¦‚key-valueæ•°æ®åº“ï¼‰å’ŒRaftå±‚ä¹‹é—´ä¸»è¦æœ‰ä¸¤ä¸ªæ¥å£ã€‚è¿™ä¸¤ä¸ªæ¥å£åˆ†åˆ«ç”¨äºè½¬å‘å®¢æˆ·ç«¯è¯·æ±‚ç»™Raftå±‚ï¼Œä»¥åŠRaftå±‚é€šçŸ¥åº”ç”¨å±‚è¯·æ±‚å·²è¢«commitã€‚ ç¬¬ä¸€ä¸ªæ¥å£æ˜¯key-valueå±‚ç”¨æ¥è½¬å‘å®¢æˆ·ç«¯è¯·æ±‚çš„æ¥å£â€”Startå‡½æ•°ã€‚å½“å®¢æˆ·ç«¯å‘é€è¯·æ±‚ç»™key-valueå±‚æ—¶ï¼Œkey-valueå±‚ä¼šå°†è¯·æ±‚è½¬å‘ç»™Raftå±‚ï¼Œå¹¶å‘Šè¯‰Raftå±‚å°†è¯·æ±‚å­˜æ”¾åœ¨Logä¸­ã€‚Startå‡½æ•°åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå³å®¢æˆ·ç«¯è¯·æ±‚ã€‚Startå‡½æ•°çš„è¿”å›å€¼åŒ…æ‹¬ï¼š è¯·æ±‚åœ¨Logä¸­çš„ä½ç½®ï¼ˆindexï¼‰ å½“å‰çš„ä»»æœŸå·ï¼ˆterm numberï¼‰ å…¶ä»–ä¿¡æ¯ ç¬¬äºŒä¸ªæ¥å£æ˜¯applyCh channelï¼Œä»¥Go channelä¸­çš„ä¸€æ¡æ¶ˆæ¯å½¢å¼å­˜åœ¨ã€‚Raftå±‚ä¼šé€šè¿‡å‘é€ApplyMsgæ¶ˆæ¯ç»™applyChæ¥é€šçŸ¥key-valueå±‚å“ªäº›è¯·æ±‚å·²ç»commitï¼Œkey-valueå±‚è¯»å–è¿™äº›æ¶ˆæ¯ã€‚ApplyMsgåŒ…å«ï¼š è¯·æ±‚ï¼ˆcommandï¼‰ å¯¹åº”çš„Logä½ç½®ï¼ˆindexï¼‰ æ‰€æœ‰çš„å‰¯æœ¬éƒ½ä¼šæ”¶åˆ°ApplyMsgæ¶ˆæ¯ï¼ŒçŸ¥é“åº”è¯¥æ‰§è¡Œè¯·æ±‚å¹¶åº”ç”¨åœ¨æœ¬åœ°çŠ¶æ€ä¸­ã€‚Leaderéœ€è¦çŸ¥é“ApplyMsgä¸­çš„è¯·æ±‚å¯¹åº”å“ªä¸ªå®¢æˆ·ç«¯è¯·æ±‚ï¼Œä»¥ä¾¿å“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 Leader é€‰ä¸¾ å¼•å…¥Leaderçš„åŸå› ï¼š æœ‰Leaderç³»ç»Ÿæ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºè¯·æ±‚åªéœ€ä¸€è½®æ¶ˆæ¯å³å¯è·å¾—è¿‡åŠè®¤å¯ã€‚ æ— Leaderç³»ç»Ÿéœ€è¦ä¸€è½®æ¶ˆæ¯ç¡®è®¤ä¸´æ—¶Leaderï¼Œå†ä¸€è½®ç¡®è®¤è¯·æ±‚ï¼Œæ•ˆç‡è¾ƒä½ã€‚ Raftä½¿ç”¨ä»»æœŸå·ï¼ˆterm numberï¼‰åŒºåˆ†ä¸åŒçš„Leaderã€‚æ¯ä¸ªä»»æœŸæœ€å¤šæœ‰ä¸€ä¸ªLeaderã€‚Followersåªéœ€çŸ¥é“å½“å‰çš„ä»»æœŸå·ã€‚ Leaderé€‰ä¸¾è¿‡ç¨‹å¦‚ä¸‹ï¼š å¦‚æœFolloweråœ¨é€‰ä¸¾å®šæ—¶å™¨æ—¶é—´å†…æœªæ”¶åˆ°Leaderæ¶ˆæ¯ï¼Œä¼šè®¤ä¸ºLeaderä¸‹çº¿ï¼Œå¼€å§‹é€‰ä¸¾ã€‚ å½“å‰èŠ‚ç‚¹å¢åŠ ä»»æœŸå·ï¼Œå‘èµ·é€‰ä¸¾ã€‚ èŠ‚ç‚¹å‘é€RequestVote RPCç»™å…¶ä»–èŠ‚ç‚¹ï¼Œè‡ªå·±æŠ•ç¥¨ç»™è‡ªå·±ã€‚ èŠ‚ç‚¹éœ€è¦è·å¾—è¿‡åŠæœåŠ¡å™¨çš„è®¤å¯æŠ•ç¥¨æ‰èƒ½æˆä¸ºLeaderã€‚ ä»»æœŸå†…æ¯ä¸ªèŠ‚ç‚¹åªæŠ•ä¸€æ¬¡ç¥¨ï¼Œå°±ä¸å¯èƒ½æœ‰ä¸¤ä¸ªå€™é€‰äººåŒæ—¶è·å¾—è¿‡åŠçš„é€‰ç¥¨ï¼Œç¡®ä¿æ¯ä¸ªä»»æœŸæœ€å¤šä¸€ä¸ªLeaderã€‚æˆåŠŸå½“é€‰åï¼ŒLeaderç«‹å³å‘é€AppendEntriesæ¶ˆæ¯ï¼ˆå¿ƒè·³ï¼‰é€šçŸ¥å…¶ä»–èŠ‚ç‚¹è‡ªå·±å½“é€‰ã€‚ å¦‚æœLeaderåœ¨ç½‘ç»œåˆ†åŒºä¸­å°‘æ•°æœåŠ¡å™¨å†…ï¼Œæ— æ³•è·å¾—è¿‡åŠè®¤å¯ï¼Œä¸èƒ½commitè¯·æ±‚ã€‚æ—§Leaderåœ¨å°åˆ†åŒºå†…è¿è¡Œï¼Œä½†ä¸èƒ½æ‰§è¡Œå®¢æˆ·ç«¯è¯·æ±‚ï¼Œåªèƒ½å‘é€å¿ƒè·³ã€‚ æœ‰æ²¡æœ‰å¯èƒ½å‡ºç°æç«¯çš„æƒ…å†µï¼Œå¯¼è‡´å•å‘çš„ç½‘ç»œå‡ºç°æ•…éšœï¼Œè¿›è€Œä½¿å¾—Raftç³»ç»Ÿä¸èƒ½å·¥ä½œï¼Ÿ å¦‚æœå½“å‰Leaderçš„ç½‘ç»œå•è¾¹å‡ºç°æ•…éšœï¼ŒLeaderå¯ä»¥å‘å‡ºå¿ƒè·³ï¼Œä½†æ˜¯åˆä¸èƒ½æ”¶åˆ°ä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚ã€‚å®ƒå‘å‡ºçš„å¿ƒè·³è¢«é€è¾¾äº†ï¼Œå› ä¸ºå®ƒçš„å‡ºæ–¹å‘ç½‘ç»œæ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆå®ƒçš„å¿ƒè·³ä¼šæŠ‘åˆ¶å…¶ä»–æœåŠ¡å™¨å¼€å§‹ä¸€æ¬¡æ–°çš„é€‰ä¸¾ã€‚ä½†æ˜¯å®ƒçš„å…¥æ–¹å‘ç½‘ç»œæ˜¯æ•…éšœçš„ï¼Œè¿™ä¼šé˜»æ­¢å®ƒæ¥æ”¶æˆ–è€…æ‰§è¡Œä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚ã€‚è¿™ä¸ªåœºæ™¯æ˜¯Raftå¹¶æ²¡æœ‰è€ƒè™‘çš„ä¼—å¤šæç«¯çš„ç½‘ç»œæ•…éšœåœºæ™¯ä¹‹ä¸€ã€‚ å¯ä»¥é€šè¿‡ä¸€ä¸ªåŒå‘çš„å¿ƒè·³æœºåˆ¶æ¥è§£å†³ã€‚å³Leaderå‘é€å¿ƒè·³ï¼ŒFollowerè¦å“åº”è¿™ä¸ªå¿ƒè·³ï¼Œå¦‚æœLeaderæ²¡æœ‰æ”¶åˆ°å“åº”ï¼Œåˆ™ä¼šå†³å®šå¸ä»»ã€‚ æ‰€æœ‰RaftèŠ‚ç‚¹æ”¶åˆ°ä»»ä½•ä¸€æ¡AppendEntriesæ¶ˆæ¯éƒ½ä¼šé‡ç½®å…¶é€‰ä¸¾å®šæ—¶å™¨ã€‚åªè¦Leaderä»¥åˆç†çš„é€Ÿç‡å‘é€å¿ƒè·³æˆ–å…¶ä»–AppendEntriesæ¶ˆæ¯ï¼ŒFollowerså°±ä¼šé‡ç½®é€‰ä¸¾å®šæ—¶å™¨ï¼Œé˜»æ­¢å…¶ä»–èŠ‚ç‚¹æˆä¸ºå€™é€‰äººã€‚åœ¨æ²¡æœ‰ç½‘ç»œæ•…éšœæˆ–ä¸¢åŒ…çš„æƒ…å†µä¸‹ï¼Œè¿ç»­çš„å¿ƒè·³æ¶ˆæ¯ä¼šé˜²æ­¢æ–°çš„é€‰ä¸¾å‘ç”Ÿã€‚ å¦‚æœå‡ºç°æœåŠ¡å™¨æ•…éšœæˆ–ç½‘ç»œé—®é¢˜æˆ–è€…åˆ†å‰²é€‰ç¥¨ï¼ˆå¤šä¸ªå€™é€‰äººå‡ ä¹åŒæ—¶ç«é€‰ï¼Œé€‰ç¥¨åˆ†æ•£ï¼‰ï¼Œå¯èƒ½å¯¼è‡´æ— æ³•å‡‘é½è¿‡åŠæœåŠ¡å™¨ï¼Œæ— æ³•é€‰å‡ºLeaderï¼Œè¿™æ¬¡é€‰ä¸¾å°±å¤±è´¥äº†ã€‚ Raftä¸èƒ½å®Œå…¨é¿å…åˆ†å‰²é€‰ç¥¨é—®é¢˜ï¼Œä½†å¯ä»¥å¤§å¤§é™ä½å‘ç”Ÿæ¦‚ç‡ã€‚é€šè¿‡éšæœºé€‰æ‹©é€‰ä¸¾å®šæ—¶å™¨çš„è¶…æ—¶æ—¶é—´ï¼Œå‡å°‘åŒæ­¥è¶…æ—¶çš„æ¦‚ç‡ã€‚ è¶…æ—¶æ—¶é—´è®¾ç½®ï¼š ä¸‹é™ï¼šè‡³å°‘å¤§äºLeaderçš„å¿ƒè·³é—´éš”ï¼Œå¤šæ¬¡å¿ƒè·³é—´éš”æ›´å¥½ï¼ˆä¾‹å¦‚3æ¬¡å¿ƒè·³é—´éš”ï¼‰ã€‚ ä¸Šé™ï¼šè¿œå°äºæœåŠ¡å™¨ä¸¤æ¬¡æ•…éšœä¹‹é—´çš„å¹³å‡æ—¶é—´ã€‚ æ—¶é—´å·®ï¼šè¶³å¤Ÿå¤§ä»¥ç¡®ä¿ç¬¬ä¸€ä¸ªè¶…æ—¶èŠ‚ç‚¹èƒ½å¤Ÿå®Œæˆä¸€è½®é€‰ä¸¾ï¼Œè‡³å°‘éœ€è¦å¤§äºå‘é€ä¸€æ¡RPCçš„å¾€è¿”æ—¶é—´ã€‚ lab tip æ¯ä¸€æ¬¡ä¸€ä¸ªèŠ‚ç‚¹é‡ç½®è‡ªå·±çš„é€‰ä¸¾å®šæ—¶å™¨æ—¶ï¼Œéƒ½éœ€è¦é‡æ–°é€‰æ‹©ä¸€ä¸ªéšæœºçš„è¶…æ—¶æ—¶é—´ã€‚é¿å…æœåŠ¡å™¨ä¼šä»¥æå°çš„æ¦‚ç‡é€‰æ‹©ç›¸åŒçš„éšæœºè¶…æ—¶æ—¶é—´ï¼Œé‚£ä¹ˆä¼šæ°¸è¿œå¤„äºåˆ†å‰²é€‰ç¥¨çš„åœºæ™¯ä¸­ ","date":"2024-07-25","objectID":"/posts/07.raft/:6:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 æ—¥å¿—æ¢å¤ Leaderæ­£å¸¸è¿è¡Œæ—¶ï¼ŒFollowerå¿…é¡»åŒæ„å¹¶æ¥æ”¶Leaderçš„æ—¥å¿—ã€‚ä½†Leaderæ•…éšœåï¼Œæ–°Leaderéœ€è¦æ•´ç†å„å‰¯æœ¬å¯èƒ½ä¸ä¸€è‡´çš„æ—¥å¿—ã€‚ æ–°Leaderä¼šå‘é€åŒ…å«prevLogIndexå’ŒprevLogTermçš„AppendEntries RPCã€‚ Followeræ£€æŸ¥æœ¬åœ°æ—¥å¿—æ˜¯å¦åŒ¹é…ï¼š ä¸åŒ¹é…ï¼šæ‹’ç»AppendEntriesï¼ŒLeaderå‡å°‘nextIndexå¹¶é‡è¯•ã€‚ åŒ¹é…ï¼šæ¥å—AppendEntriesï¼Œæ›´æ–°æœ¬åœ°æ—¥å¿—ã€‚ ä¸ºä»€ä¹ˆRaftç³»ç»Ÿå¯ä»¥å®‰å…¨çš„åˆ é™¤ä¸ä¸€è‡´çš„æ—¥å¿—ï¼Ÿ å¦‚æœæ—¥å¿—æ¡ç›®æœªå­˜åœ¨äºè¿‡åŠæœåŠ¡å™¨ä¸­ï¼Œæ—§Leaderä¸å¯èƒ½commitè¯¥æ¡ç›®ï¼Œä¹Ÿå°±ä¸å¯èƒ½å°†å®ƒåº”ç”¨åˆ°åº”ç”¨ç¨‹åºçš„çŠ¶æ€ä¸­ï¼Œå®‰å…¨åˆ é™¤æ— å½±å“ã€‚å¹¶ä¸”å¦‚æœå®¢æˆ·ç«¯æœªæ”¶åˆ°å›å¤ï¼Œå°†é‡å‘è¯·æ±‚ï¼Œç¡®ä¿è¯·æ±‚æœ€ç»ˆè¢«å¤„ç†ã€‚ ä¸ºä»€ä¹ˆæ€»æ˜¯åˆ é™¤Followersçš„Logçš„ç»“å°¾éƒ¨åˆ†ï¼Ÿ Leaderå…·æœ‰å®Œæ•´çš„Logè®°å½•ï¼Œå¯ä»¥åœ¨ä»»ä½•éœ€è¦çš„æ—¶å€™å¡«å……Followersçš„æ—¥å¿—ã€‚å¦‚æœç³»ç»Ÿåˆšå¯åŠ¨ï¼Œæˆ–å‘ç”Ÿåå¸¸æƒ…å†µï¼ŒLeaderèƒ½å¤Ÿä»ç¬¬ä¸€æ¡è®°å½•å¼€å§‹æ¢å¤Followersçš„æ—¥å¿—ï¼Œå› ä¸ºå®ƒæœ‰æ‰€æœ‰å¿…è¦çš„ä¿¡æ¯ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:7:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 é€‰ä¸¾çº¦æŸ ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„æ­£ç¡®æ€§ï¼Œå¹¶éä»»æ„èŠ‚ç‚¹éƒ½å¯ä»¥æˆä¸ºLeaderã€‚ä¸æ˜¯è¯´ç¬¬ä¸€ä¸ªé€‰ä¸¾å®šæ—¶å™¨è¶…æ—¶äº†å¹¶è§¦å‘é€‰ä¸¾çš„èŠ‚ç‚¹ï¼Œå°±ä¸€å®šæ˜¯Leaderã€‚Raftå¯¹äºè°å¯ä»¥æˆä¸ºLeaderï¼Œå­˜åœ¨ä¸€äº›é™åˆ¶ã€‚é™åˆ¶æ¡ä»¶å¦‚ä¸‹ï¼š å€™é€‰äººæœ€åä¸€æ¡Logæ¡ç›®çš„ä»»æœŸå·å¤§äºæœ¬åœ°æœ€åä¸€æ¡Logæ¡ç›®çš„ä»»æœŸå·ï¼› æˆ–è€…ï¼Œå€™é€‰äººæœ€åä¸€æ¡Logæ¡ç›®çš„ä»»æœŸå·ç­‰äºæœ¬åœ°æœ€åä¸€æ¡Logæ¡ç›®çš„ä»»æœŸå·ï¼Œä¸”å€™é€‰äººçš„Logè®°å½•é•¿åº¦å¤§äºç­‰äºæœ¬åœ°Logè®°å½•é•¿åº¦ã€‚ æ‰€ä»¥Raftæ›´å€¾å‘äºé€‰æ‹©æ‹¥æœ‰æ›´é«˜ä»»æœŸå·è®°å½•çš„å€™é€‰äººï¼Œç¡®ä¿ç³»ç»Ÿä¸€è‡´æ€§ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:8:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"9 å¿«é€Ÿæ¢å¤ åŸºäºä¸Šè¿°ä»‹ç»ï¼ŒLeaderç°è¡Œæœºåˆ¶æ˜¯æ¯æ¬¡å›é€€ä¸€æ¡Logæ¡ç›®æ¥è§£å†³æ—¥å¿—å†²çªã€‚å¦‚æœFolloweré•¿æ—¶é—´å…³æœºï¼Œé”™è¿‡å¤§é‡AppendEntriesæ¶ˆæ¯ã€‚Leaderé‡å¯åéœ€é€æ¡RPCå›é€€Logæ¡ç›®ï¼Œè€—æ—¶è¾ƒé•¿ã€‚ Raftè®ºæ–‡ä¸­æä¾›äº†ä¸€ä¸ªå¿«é€Ÿæ¢å¤æ–¹æ³•ã€‚Followerè¿”å›è¶³å¤Ÿä¿¡æ¯ç»™Leaderï¼Œä½¿Leaderèƒ½æŒ‰ä»»æœŸï¼ˆTermï¼‰ä¸ºå•ä½å›é€€ï¼Œè€Œéé€æ¡å›é€€ã€‚Followeræ‹’ç»AppendEntriesæ¶ˆæ¯æ—¶ï¼Œè¿”å›ä»¥ä¸‹3ä¸ªä¿¡æ¯ï¼š XTermï¼šFollowerä¸­ä¸Leaderå†²çªçš„Logæ¡ç›®çš„ä»»æœŸå·ã€‚ XIndexï¼šFollowerä¸­ï¼Œä»»æœŸå·ä¸ºXTermçš„ç¬¬ä¸€æ¡Logæ¡ç›®çš„æ§½ä½å·ã€‚ XLenï¼šFollowerä¸­ç©ºç™½Logæ§½ä½æ•°ã€‚ å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç­‰æ›´é«˜æ•ˆçš„æ–¹æ³•è¿›ä¸€æ­¥åŠ é€Ÿã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:9:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"10 æŒä¹…åŒ– åœ¨Raftåè®®ä¸­ï¼ŒæŒä¹…åŒ–å­˜å‚¨ï¼ˆpersistenceï¼‰å’ŒéæŒä¹…åŒ–å­˜å‚¨ï¼ˆvolatileï¼‰çš„åŒºåˆ«åœ¨äºæœåŠ¡å™¨é‡å¯æ—¶çš„çŠ¶æ€ä¿æŒã€‚æŒä¹…åŒ–å­˜å‚¨ç¡®ä¿æœåŠ¡å™¨é‡å¯åèƒ½å¤Ÿæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œä»è€Œä¿è¯æœåŠ¡çš„è¿ç»­æ€§å’Œæ•°æ®çš„ä¸€è‡´æ€§ã€‚æŒä¹…åŒ–å­˜å‚¨é€šå¸¸ä½¿ç”¨ç£ç›˜æˆ–ç”µæ± ä¾›ç”µçš„RAMæ¥ä¿å­˜æ•°æ®ã€‚ æ ¹æ®Raftè®ºæ–‡å›¾2ï¼Œä»¥ä¸‹ä¸‰ä¸ªæ•°æ®éœ€è¦æŒä¹…åŒ–å­˜å‚¨ï¼š Logï¼šä¿å­˜æ‰€æœ‰çš„æ—¥å¿—æ¡ç›®ï¼Œæ˜¯å”¯ä¸€è®°å½•åº”ç”¨ç¨‹åºçŠ¶æ€çš„åœ°æ–¹ã€‚ currentTermï¼šå½“å‰çš„ä»»æœŸå·ï¼Œç”¨äºç¡®ä¿æ¯ä¸ªä»»æœŸåªæœ‰ä¸€ä¸ªLeaderã€‚ votedForï¼šè®°å½•å½“å‰ä»»æœŸæŠ•ç¥¨ç»™äº†å“ªä¸ªæœåŠ¡å™¨ï¼Œç”¨äºç¡®ä¿æ¯ä¸ªä»»æœŸå†…åªæœ‰ä¸€ä¸ªLeaderè¢«é€‰ä¸¾å‡ºæ¥ã€‚ æ¯å½“Logã€currentTermæˆ–votedForå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒæœåŠ¡å™¨å¿…é¡»å°†è¿™äº›æ•°æ®å†™å…¥ç£ç›˜ä»¥ç¡®ä¿å…¶æŒä¹…åŒ–ã€‚è¿™å¯ä»¥é€šè¿‡è°ƒç”¨ç³»ç»Ÿçš„writeå’Œfsyncå‡½æ•°æ¥å®ç°ï¼Œå…¶ä¸­fsyncç¡®ä¿æ•°æ®åœ¨ç£ç›˜ä¸Šå®‰å…¨å­˜å‚¨ã€‚ ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¯ä»¥é‡‡ç”¨æ‰¹é‡æ“ä½œçš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå½“Leaderæ¥æ”¶åˆ°å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œå¯ä»¥ç´¯ç§¯è¿™äº›è¯·æ±‚ï¼Œç„¶åä¸€æ¬¡æ€§æŒä¹…åŒ–å­˜å‚¨å¤šä¸ªLogæ¡ç›®ï¼Œå‡å°‘æŒä¹…åŒ–å­˜å‚¨çš„æ¬¡æ•°ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:10:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"11 æ—¥å¿—å¿«ç…§ åœ¨Raftä¸€è‡´æ€§ç®—æ³•ä¸­ï¼Œæ—¥å¿—æ¡ç›®ï¼ˆLog entriesï¼‰ä¼šéšç€ç³»ç»Ÿè¿è¡Œæ—¶é—´çš„å»¶é•¿è€Œä¸æ–­å¢åŠ ã€‚è¿™ä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜ï¼š å­˜å‚¨ç©ºé—´ï¼šæ—¥å¿—æ¡ç›®æ•°é‡è¿‡å¤šï¼Œä¼šå ç”¨å¤§é‡çš„å†…å­˜å’Œç£ç›˜ç©ºé—´ã€‚ ç³»ç»Ÿé‡å¯ï¼šå¦‚æœæœåŠ¡å™¨é‡å¯ï¼Œéœ€è¦é‡æ”¾æ‰€æœ‰æ—¥å¿—æ¡ç›®æ¥æ¢å¤çŠ¶æ€ï¼Œè€—æ—¶è¾ƒé•¿ã€‚ ä¸ºäº†åº”å¯¹ä¸Šè¿°é—®é¢˜ï¼ŒRaftå¼•å…¥äº†å¿«ç…§æœºåˆ¶ã€‚å¿«ç…§æ˜¯å¯¹åº”ç”¨ç¨‹åºçŠ¶æ€çš„å‹ç¼©è¡¨ç¤ºã€‚é€šè¿‡åˆ›å»ºå¿«ç…§ï¼Œå¯ä»¥ä¸¢å¼ƒéƒ¨åˆ†å·²åº”ç”¨çš„æ—¥å¿—æ¡ç›®ï¼Œå‡å°‘å­˜å‚¨ç©ºé—´ï¼Œå¹¶åŠ å¿«é‡å¯æ—¶çš„æ¢å¤è¿‡ç¨‹ã€‚ Raftä¼šå°†åº”ç”¨ç¨‹åºåˆ›å»ºçš„å¿«ç…§å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œç¡®ä¿æ•°æ®çš„æŒä¹…æ€§ã€‚æœåŠ¡å™¨é‡å¯æ—¶ï¼ŒRaftä¼šä»ç£ç›˜è¯»å–æœ€è¿‘çš„å¿«ç…§ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™åº”ç”¨ç¨‹åºï¼Œæ¢å¤åˆ°å¿«ç…§å¯¹åº”çš„çŠ¶æ€ã€‚ç„¶åï¼Œä»å¿«ç…§ä¹‹åçš„æ—¥å¿—æ¡ç›®å¼€å§‹ç»§ç»­æ¢å¤ã€‚ å¦‚æœæŸä¸ªFollowerçš„æ—¥å¿—æ¯”Leaderçš„çŸ­ï¼Œä¸”çŸ­äºLeaderå¿«ç…§çš„èµ·å§‹ä½ç½®ï¼Œé‚£ä¹ˆLeaderæ— æ³•é€šè¿‡å‘é€æ—¥å¿—æ¡ç›®æ¥åŒæ­¥Followerçš„æ—¥å¿—ã€‚Raftå¼•å…¥äº†InstallSnapshot RPCã€‚å½“Followerçš„æ—¥å¿—é•¿åº¦ä¸å¤Ÿæ—¶ï¼ŒLeaderä¼šå‘é€å¿«ç…§ç»™Followerï¼Œç„¶åç»§ç»­é€šè¿‡AppendEntries RPCå‘é€åç»­çš„æ—¥å¿—æ¡ç›®ã€‚ å¿«ç…§çš„ç”Ÿæˆå’Œæ¢å¤éœ€è¦åº”ç”¨ç¨‹åºä¸Raftç»„ä»¶ä¹‹é—´çš„ç´§å¯†ååŒã€‚åº”ç”¨ç¨‹åºè´Ÿè´£ç”Ÿæˆå’Œå¸çº³å¿«ç…§ï¼ŒRaftè´Ÿè´£ç®¡ç†å¿«ç…§å’Œæ—¥å¿—æ¡ç›®çš„æŒä¹…åŒ–å­˜å‚¨ã€‚Leaderå¯èƒ½å¹¶å‘å‘é€å¤šä¸ªRPCæ¶ˆæ¯ï¼ŒåŒ…æ‹¬AppendEntrieså’ŒInstallSnapshotï¼Œéœ€è¦å¤„ç†å¯èƒ½çš„ä¹±åºå’Œå†—ä½™æ¶ˆæ¯ã€‚ å¿«ç…§ç”Ÿæˆæ˜¯å¦ä¾èµ–åº”ç”¨ç¨‹åº æ˜¯çš„ï¼Œå¿«ç…§ç”Ÿæˆå‡½æ•°æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œåº”ç”¨ç¨‹åºè´Ÿè´£ç”Ÿæˆå’Œæ¢å¤å¿«ç…§ã€‚åªæœ‰åº”ç”¨ç¨‹åºè‡ªå·±æ‰çŸ¥é“è‡ªå·±çš„çŠ¶æ€ï¼ˆè¿›è€Œèƒ½ç”Ÿæˆå¿«ç…§ï¼‰ã€‚è€Œé€šè¿‡å¿«ç…§åå‘ç”Ÿæˆåº”ç”¨ç¨‹åºçŠ¶æ€çš„å‡½æ•°ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¾èµ–åº”ç”¨ç¨‹åºçš„ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:11:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"12 è¯¾ç¨‹QA Raft é€šå¸¸ç”¨äºä»€ä¹ˆï¼Ÿæ˜¯å¦ç”¨äºå®é™…è½¯ä»¶ä¸­ï¼Ÿ Raftï¼ˆä»¥åŠ Paxosï¼‰ä¸»è¦ç”¨äºæ„å»ºå®¹é”™çš„â€œé…ç½®æœåŠ¡â€ï¼Œè·Ÿè¸ªåœ¨å¤§å‹éƒ¨ç½²ä¸­çš„æœåŠ¡å™¨èŒè´£åˆ†é…ã€‚è¿™ç§æœåŠ¡å¯¹å¤åˆ¶éƒ¨ç½²å°¤ä¸ºé‡è¦ï¼Œå¯ä»¥é¿å…è„‘è£‚é—®é¢˜ã€‚Raft è¿˜è¢«ä¸€äº›æ•°æ®åº“ï¼ˆå¦‚ Spannerã€CockroachDBï¼‰ç”¨äºæ•°æ®å¤åˆ¶ã€‚ æœ‰å¤šä¸ªå®é™…åº”ç”¨ä½¿ç”¨ Raftï¼Œå¦‚ Dockerã€etcd å’Œ MongoDBã€‚è®¸å¤šåŸºäº Paxos çš„ç³»ç»Ÿï¼ˆå¦‚ Chubbyã€ZooKeeperï¼‰ä¹Ÿåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ Raft å¦‚ä½•ä¸ VMware FT æ¯”è¾ƒï¼Ÿ Raft æ›´å…·å®¹é”™æ€§ï¼Œæ²¡æœ‰å•ç‚¹æ•…éšœï¼Œè€Œ VMware FT å­˜åœ¨ä¸€ä¸ªæµ‹è¯•å’Œè®¾ç½®æœåŠ¡å™¨ä½œä¸ºå•ç‚¹æ•…éšœã€‚Raft ç”¨ä½œåº“é›†æˆåœ¨åº”ç”¨è½¯ä»¶ä¸­ï¼Œè€Œ VMware FT å¯ç”¨äºä»»ä½•è™šæ‹Ÿæœºã€‚ Raft å¦‚ä½•é˜²æ­¢æ¶æ„æ”»å‡»ï¼Ÿ Raft é»˜è®¤æ²¡æœ‰é˜²å¾¡æ¶æ„æ”»å‡»çš„æœºåˆ¶ã€‚å®é™…éƒ¨ç½²ä¸­éœ€è¦é€šè¿‡é˜²ç«å¢™ä¿æŠ¤ï¼Œæˆ–ä½¿ç”¨åŠ å¯†éªŒè¯ Raft æ•°æ®åŒ…ã€‚ Raft çš„â€œéæ‹œå åº­â€æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ Raft å‡è®¾æœåŠ¡å™¨è¦ä¹ˆæŒ‰åè®®è¿è¡Œï¼Œè¦ä¹ˆåœæ­¢è¿è¡Œã€‚æ‹œå åº­æ•…éšœæŒ‡è®¡ç®—æœºæ‰§è¡Œé”™è¯¯æ“ä½œï¼Œè¿™å¯èƒ½å¯¼è‡´ Raft å‘é€ä¸æ­£ç¡®çš„ç»“æœã€‚ Raft å¯ä»¥åœ¨åœ°ç†åˆ†å¸ƒçš„æ•°æ®ä¸­å¿ƒä¸­ä½¿ç”¨å—ï¼Ÿ é€šå¸¸ï¼ŒRaft éƒ¨ç½²åœ¨å•ä¸€æ•°æ®ä¸­å¿ƒã€‚è·¨æ•°æ®ä¸­å¿ƒçš„ç³»ç»Ÿï¼ˆå¦‚ Spannerï¼‰æ›´é€‚åˆæ— é¢†å¯¼åè®®ï¼Œä»¥ä¾¿å®¢æˆ·å¯ä»¥ä¸æœ¬åœ°å‰¯æœ¬é€šä¿¡ã€‚ Raft çš„æ—¥å¿—ä¸ºä½•æ˜¯ä» 1 å¼€å§‹ç¼–å·çš„ï¼Ÿ æ—¥å¿—ä»é›¶ç¼–å·ï¼Œä½†ç¬¬ä¸€ä¸ªæ¡ç›®ï¼ˆç´¢å¼•ä¸º 0ï¼‰å…·æœ‰Term 0ï¼Œä½¿å¾—åˆå§‹ AppendEntries RPC å¯ä»¥åŒ…å«æœ‰æ•ˆçš„ PrevLogIndexã€‚ Raft çš„å‰¯æœ¬ä¼˜åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ å‰¯æœ¬ä¼˜åŒ–é€šè¿‡åœ¨æœåŠ¡å¿«ç…§æ—¶ä½¿ç”¨ fork()ï¼Œå®ç°äº†â€œå†™æ—¶å¤åˆ¶â€ã€‚æ“ä½œç³»ç»Ÿä¼šå»¶è¿Ÿå®é™…çš„å†…å­˜å¤åˆ¶ï¼Œä¼˜åŒ–äº†æ€§èƒ½ã€‚ ä¸ºä»€ä¹ˆæ–°é¢†å¯¼åœ¨å…¶ä»»æœŸå¼€å§‹æ—¶éœ€è¦æäº¤ä¸€ä¸ªæ— æ“ä½œï¼ˆno-opï¼‰æ—¥å¿—æ¡ç›®ï¼Ÿ æ–°é¢†å¯¼æäº¤æ— æ“ä½œæ—¥å¿—æ¡ç›®å¯ä»¥ç¡®ä¿å…¶æ—¥å¿—ä¸­æ‰€æœ‰ä¹‹å‰çš„æ¡ç›®éƒ½æ˜¯å·²æäº¤çš„ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢æ–°é¢†å¯¼åœ¨è‡ªå·±å¤±è´¥æ—¶ï¼Œå‰ä¸€ä¸ªé¢†å¯¼çš„æ—¥å¿—æ¡ç›®æœªè¢«æäº¤ï¼Œä»è€Œä¿æŒç³»ç»Ÿä¸€è‡´æ€§ã€‚ ä½¿ç”¨å¿ƒè·³æœºåˆ¶æä¾›ç§Ÿçº¦ï¼ˆleasesï¼‰è¿›è¡Œåªè¯»æ“ä½œæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æ—¶é—´åŒæ­¥ï¼Ÿ é¢†å¯¼è€…é€šè¿‡åœ¨å¿ƒè·³æ¶ˆæ¯ä¸­æš—ç¤ºä¸‹ä¸€æ®µæ—¶é—´å†…ä¸èƒ½é€‰ä¸¾æ–°é¢†å¯¼ï¼Œä»è€Œæä¾›åªè¯»æ“ä½œçš„ç§Ÿçº¦ã€‚ä¸ºäº†ä¿è¯å®‰å…¨ï¼ŒæœåŠ¡å™¨çš„æ—¶é’Ÿéœ€è¦ä¿æŒåŒæ­¥ï¼Œç¡®ä¿ç§Ÿçº¦æ—¶é—´çš„å‡†ç¡®æ€§ã€‚ åœ¨ Raft çš„é…ç½®å˜æ›´è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•ç†è§£æ—§é…ç½®ï¼ˆ$C_\\text{old}$ï¼‰åˆ°æ–°é…ç½®ï¼ˆ$C_\\text{new}$ï¼‰çš„è¿‡æ¸¡ï¼Ÿ åœ¨è”åˆå…±è¯†é˜¶æ®µï¼ˆ$C_\\text{old,new}$ï¼‰ï¼Œé¢†å¯¼è€…éœ€è¦è·å¾—æ—§é…ç½®å’Œæ–°é…ç½®çš„å¤šæ•°æ”¯æŒã€‚é…ç½®å˜æ›´æ—¥å¿—æ¡ç›®éœ€è¦åŒæ—¶è¢«æ—§é…ç½®å’Œæ–°é…ç½®çš„å¤šæ•°æœåŠ¡å™¨ç¡®è®¤ã€‚ å¿«ç…§ï¼ˆsnapshotï¼‰çš„åˆ›å»ºå’Œæ¢å¤è¿‡ç¨‹ä¸­çš„æ•°æ®æ˜¯å¦éœ€è¦å‹ç¼©ï¼Ÿ å¿«ç…§é€šå¸¸ä¼šå¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œä»¥å‡å°‘ä¼ è¾“å’Œå­˜å‚¨æˆæœ¬ã€‚å‹ç¼©æ–¹æ¡ˆåº”æ ¹æ®å…·ä½“åº”ç”¨çš„æ•°æ®ç±»å‹æ¥é€‰æ‹©ï¼Œå¦‚ä½¿ç”¨ JPEG å‹ç¼©å›¾åƒæ•°æ®ï¼Œæˆ–ä½¿ç”¨é€šç”¨å‹ç¼©ç®—æ³•å¦‚ ZIPã€‚ é¢†å¯¼è€…å¦‚ä½•å†³å®šä»€ä¹ˆæ—¶å€™å‘è·Ÿéšè€…å‘é€å¿«ç…§ï¼Ÿ é¢†å¯¼è€…ä¼šåœ¨è·Ÿéšè€…çš„ matchIndex å°äºå…¶æ—¥å¿—å¼€å§‹ç´¢å¼•æ—¶å‘é€å¿«ç…§ï¼Œä»¥ç¡®ä¿è·Ÿéšè€…èƒ½å¤Ÿèµ¶ä¸Šæœ€æ–°çš„æ—¥å¿—çŠ¶æ€ã€‚ åœ¨ Raft ä¸­ï¼Œæ·»åŠ æ—¥å¿—æ¡ç›®æ˜¯å¦ç®—ä½œæ‰§è¡Œæ“ä½œï¼Ÿ ä¸ç®—ã€‚ä»…å½“é¢†å¯¼è€…å°†æ—¥å¿—æ¡ç›®æ ‡è®°ä¸ºå·²æäº¤åï¼ŒæœåŠ¡å™¨æ‰ä¼šæ‰§è¡Œæ—¥å¿—æ¡ç›®ä¸­çš„æ“ä½œã€‚æ‰§è¡Œæ“ä½œæŒ‡çš„æ˜¯å°†æ—¥å¿—æ¡ç›®äº¤ç»™å®é™…æœåŠ¡è¿›è¡Œå¤„ç†ã€‚ ","date":"2024-07-25","objectID":"/posts/07.raft/:12:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘Raft","uri":"/posts/07.raft/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"1 æ‘˜è¦ SkexGenæ˜¯ä¸€ç§æ–°é¢–çš„è‡ªå›å½’ç”Ÿæˆæ¨¡å‹ï¼Œç”¨äºåˆ›å»ºCADæ„é€ åºåˆ—ï¼Œå…¶ä¸­åŒ…å«è‰å›¾å’Œæ‹‰ä¼¸å»ºæ¨¡æ“ä½œã€‚è¿™ä¸ªæ¨¡å‹åˆ©ç”¨ä¸åŒçš„Transformeræ¶æ„å°†æ„é€ åºåˆ—ä¸­çš„æ‹“æ‰‘ã€å‡ ä½•å’Œæ‹‰ä¼¸å˜åŒ–ç¼–ç åˆ°è§£è€¦çš„ç æœ¬ä¸­ã€‚è‡ªå›å½’Transformerè§£ç å™¨æ ¹æ®ç æœ¬å‘é‡ç”Ÿæˆå…·æœ‰ç‰¹å®šå±æ€§çš„CADæ„é€ åºåˆ—ã€‚å¹¿æ³›çš„å®éªŒè¡¨æ˜ï¼Œæˆ‘ä»¬çš„è§£è€¦ç æœ¬è¡¨ç¤ºå¯ä»¥ç”Ÿæˆå¤šæ ·ä¸”é«˜è´¨é‡çš„CADæ¨¡å‹ï¼Œå¢å¼ºäº†ç”¨æˆ·çš„æ§åˆ¶èƒ½åŠ›ï¼Œå¹¶èƒ½å¤Ÿæœ‰æ•ˆæ¢ç´¢è®¾è®¡ç©ºé—´ã€‚ ã€codeã€‘ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:1:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"2 å¼•è¨€ SkexGenæ˜¯ä¸€ç§æ–°é¢–çš„è‡ªå›å½’ç”Ÿæˆæ¨¡å‹ï¼Œä½¿ç”¨ç¦»æ•£ç æœ¬è¿›è¡ŒCADæ¨¡å‹ç”Ÿæˆã€‚ä½œè€…é‡‡ç”¨è‰å›¾å’Œæ‹‰ä¼¸å»ºæ¨¡è¯­è¨€æ¥æè¿°CADæ„é€ åºåˆ—ï¼Œå…¶ä¸­è‰å›¾æ“ä½œåˆ›å»ºäºŒç»´åŸè¯­ï¼Œæ‹‰ä¼¸æ“ä½œå°†å®ƒä»¬æå‡å¹¶ç»„åˆæˆä¸‰ç»´ã€‚Transformerç¼–ç å™¨å­¦ä¹ åˆ°è§£è€¦çš„æ½œåœ¨è¡¨ç¤ºï¼Œä½œä¸ºä¸‰ä¸ªç æœ¬ï¼Œåˆ†åˆ«æ•æ‰æ„é€ åºåˆ—çš„æ‹“æ‰‘ã€å‡ ä½•å’Œæ‹‰ä¼¸å˜åŒ–ã€‚ç»™å®šç æœ¬å‘é‡ï¼Œè‡ªå›å½’Transformerè§£ç å™¨ç”Ÿæˆè‰å›¾å’Œæ‹‰ä¼¸æ„é€ åºåˆ—ï¼Œè¿›è€Œå¤„ç†æˆCADæ¨¡å‹ã€‚ ä½œè€…åœ¨ä¸€ä¸ªå¤§è§„æ¨¡è‰å›¾å’Œæ‹‰ä¼¸æ•°æ®é›†ï¼ˆDeepCADæ•°æ®é›†ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºSkexGenæ ¼å¼ï¼‰ä¸Šè¯„ä¼°äº†SkexGenã€‚ä¸å¤šä¸ªbaselineå’Œæœ€å…ˆè¿›æ–¹æ³•è¿›è¡Œçš„å®šæ€§å’Œå®šé‡è¯„ä¼°è¡¨æ˜ï¼ŒSkexGenç”Ÿæˆäº†æ›´çœŸå®å’Œå¤šæ ·çš„CADæ¨¡å‹ï¼ŒåŒæ—¶å®ç°äº†æœ‰æ•ˆçš„æ§åˆ¶å’Œé«˜æ•ˆçš„è®¾è®¡ç©ºé—´æ¢ç´¢ï¼Œè¿™æ˜¯ä»¥å¾€æ–¹æ³•æ— æ³•å®ç°çš„ã€‚ä½œè€…åšå‡ºäº†ä»¥ä¸‹è´¡çŒ®ï¼š SkexGenæ¶æ„ï¼Œè‡ªå›å½’ç”Ÿæˆé«˜è´¨é‡å’Œå¤šæ ·åŒ–çš„CADæ„é€ åºåˆ—ã€‚ è§£è€¦çš„ç æœ¬ï¼Œç¼–ç æ„é€ åºåˆ—çš„æ‹“æ‰‘ã€å‡ ä½•å’Œæ‹‰ä¼¸å˜åŒ–ï¼Œå®ç°äº†è®¾è®¡çš„æœ‰æ•ˆæ§åˆ¶å’Œæ¢ç´¢ã€‚ åœ¨å…¬å…±åŸºå‡†ä¸Šçš„å¹¿æ³›å®šæ€§å’Œå®šé‡è¯„ä¼°ï¼Œå±•ç¤ºäº†æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:2:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"3 ç›¸å…³å·¥ä½œ æ„é€ æ€§å®ä½“å‡ ä½•ï¼ˆCSGï¼‰ 3Då½¢çŠ¶ç”±å‚æ•°åŒ–åŸºå…ƒé€šè¿‡å¸ƒå°”è¿ç®—ç»„æˆçš„CSGæ ‘è¡¨è¾¾ã€‚è¿™ç§è½»é‡çº§è¡¨ç¤ºå·²å¹¿æ³›ç”¨äºä¸ç¨‹åºåˆæˆã€ç¥ç»å¼•å¯¼ç¨‹åºåˆæˆã€æ— ç›‘ç£å­¦ä¹ å’Œä¸“ç”¨å‚æ•°åŒ–åŸºå…ƒç»“åˆçš„é‡å»ºä»»åŠ¡ä¸­ã€‚ä½†å‚æ•°åŒ–CADä»ä¸»å¯¼æœºæ¢°è®¾è®¡ï¼Œå¹¶ä¸”å¹¿æ³›ä½¿ç”¨è‰å›¾å’Œæ‹‰ä¼¸å»ºæ¨¡æ“ä½œã€‚ æ„é€ åºåˆ—ç”Ÿæˆ PolyGenå¼€åˆ›ï¼šä½¿ç”¨Transformerå’ŒæŒ‡é’ˆç½‘ç»œé¢„æµ‹n-gonç½‘æ ¼é¡¶ç‚¹å’Œé¢ã€‚ æ•°æ®é›†æ¨åŠ¨ï¼šå¤§è§„æ¨¡CADå»ºæ¨¡æ“ä½œæ•°æ®é›†ä¿ƒè¿›ç›´æ¥å­¦ä¹ ç”¨æˆ·å»ºæ¨¡æ“ä½œã€‚ æ‹‰ä¼¸æ“ä½œé¢„æµ‹ï¼šé¢„æµ‹æ‹‰ä¼¸æ“ä½œåºåˆ—ä»¥éƒ¨åˆ†æ¢å¤æ„é€ åºåˆ—ï¼Œä½†æ²¡æœ‰åº•å±‚è‰å›¾ä¿¡æ¯ã€‚é¢„æµ‹çº¿ã€å¼§ã€åœ†ç­‰è‰å›¾åŸºå…ƒçš„åºåˆ—æ˜¯å½¢æˆCADäºŒç»´åŸºç¡€çš„å…³é”®æ„é€ å—ï¼Œå¯é€šè¿‡æ·»åŠ æ‹‰ä¼¸æ“ä½œè½»æ¾æ‰©å±•åˆ°3Dã€‚ Transformeræ¶æ„çš„åº”ç”¨ï¼šåº”ç”¨äºè‰å›¾å’Œæ‹‰ä¼¸åºåˆ—ç”Ÿæˆï¼Œä½†åœ¨ç”¨æˆ·æ§åˆ¶æ–¹é¢å­˜åœ¨å±€é™ã€‚ ç°æœ‰çš„æ–¹æ³•é€šå¸¸å°†ç½‘ç»œæ¡ä»¶è®¾ç½®ä¸ºç”¨æˆ·æä¾›çš„å›¾åƒã€ç‚¹äº‘æˆ–æ‰‹ç»˜è‰å›¾ï¼Œåªæ˜¯å°†ç°æœ‰è®¾è®¡è½¬æ¢ä¸ºCADæ„é€ åºåˆ—è¡¨ç¤ºï¼Œè€Œæ²¡æœ‰æä¾›å¯¹æ‹“æ‰‘å’Œå‡ ä½•çš„å•ç‹¬æ§åˆ¶æ¥æ¢ç´¢ç›¸å…³è®¾è®¡çš„ç©ºé—´ã€‚ä½œè€…çš„æ–¹æ³•åˆ™æä¾›å¯¹æ‹“æ‰‘å’Œå‡ ä½•çš„å•ç‹¬æ§åˆ¶ã€‚ ç æœ¬æ¶æ„ è‡ªå¼•å…¥ä»¥æ¥ï¼Œç æœ¬å·²åœ¨è®¸å¤šå›¾åƒå’ŒéŸ³é¢‘ç”Ÿæˆä»»åŠ¡ä¸­è¯æ˜æœ‰æ•ˆï¼Œæé«˜äº†ç”Ÿæˆå›¾åƒçš„å¤šæ ·æ€§å¹¶æä¾›äº†é¢å¤–çš„ç”¨æˆ·æ§åˆ¶ã€‚ç”±äºå…¶é«˜ç»“æ„è§„å¾‹æ€§ï¼Œå®ƒä»¬ç‰¹åˆ«é€‚åˆäºç¼–ç CADå»ºæ¨¡åºåˆ—ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:3:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"4 è‰å›¾å’Œæ‹‰ä¼¸æ„é€ åºåˆ— ä½œè€…å®šä¹‰äº†ä¸€ä¸ªè‰å›¾å’Œæ‹‰ä¼¸æ„é€ åºåˆ—è¡¨ç¤ºæ³•ï¼Œä½œä¸ºåŸºå…ƒçš„å±‚æ¬¡ç»“æ„ï¼Œè¿™ä¸€æ„é€ åŸºäºTurtleGenå’ŒDeepCADçš„åŸºç¡€ï¼Œå¹¶è¿›è¡Œäº†è‹¥å¹²ä¿®æ”¹ï¼Œä½¿è¡¨ç¤ºæ³•æ›´å…·è¡¨ç°åŠ›å’Œå­¦ä¹ é€‚åº”æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥ç¤ºä¾‹æ¨¡å‹ç”±ä¸¤ä¸ªè‰å›¾ç»„æˆï¼Œè¿™äº›è‰å›¾ç”±é¢ã€ç¯å’Œæ›²çº¿æ„æˆã€‚åºåˆ—ä»¥æ‹“æ‰‘tokenï¼ˆ$T_1$ï¼‰å¼€å§‹ï¼Œè¡¨ç¤ºæ›²çº¿çš„èµ·ç‚¹ï¼ˆç±»å‹ä¸ºå¼§çº¿ï¼‰ï¼Œæ¥ç€ä¸¤ä¸ªå‡ ä½•tokenï¼ˆ$G_1,G_2$ï¼‰ï¼Œæ¯ä¸ªtokenå­˜å‚¨ä¸€ä¸ªäºŒç»´ç‚¹åæ ‡ï¼Œã€‚ åŸºå…ƒå±‚æ¬¡ç»“æ„ï¼š æ›²çº¿ï¼šæœ€ä½çº§åˆ«çš„åŸºå…ƒï¼ŒåŒ…æ‹¬ç›´çº¿ã€å¼§çº¿æˆ–åœ†ã€‚ ç¯ï¼šä¸€ä¸ªé—­åˆè·¯å¾„ï¼Œç”±ä¸€ä¸ªï¼ˆä¾‹å¦‚åœ†ï¼‰æˆ–å¤šä¸ªæ›²çº¿ï¼ˆä¾‹å¦‚ç›´çº¿-å¼§çº¿-ç›´çº¿ï¼‰ç»„æˆã€‚ é¢ï¼šä¸€ä¸ªç”±ç¯é™å®šçš„äºŒç»´åŒºåŸŸï¼Œè¿™æ˜¯æˆ‘ä»¬çš„è¡¨ç¤ºæ³•ä¸­æ–°å¢åŠ çš„ã€‚å…·ä½“æ¥è¯´ï¼Œä¸€ä¸ªé¢ç”±ä¸€ä¸ªå¤–ç¯å’Œè‹¥å¹²å†…ç¯ï¼ˆæ´ï¼‰æ„æˆï¼Œè¿™åœ¨è®¸å¤šCADç³»ç»Ÿä¸­æ˜¯ä¸€ä¸ªæƒ¯ä¾‹ã€‚ è‰å›¾ï¼šç”±ä¸€ä¸ªæˆ–å¤šä¸ªé¢ç»„æˆã€‚ æ‹‰ä¼¸è‰å›¾ï¼šé€šè¿‡æ‹‰ä¼¸è‰å›¾å½¢æˆçš„ä¸‰ç»´ä½“ç§¯ã€‚ è‰å›¾å’Œæ‹‰ä¼¸æ¨¡å‹ï¼šé€šè¿‡å¸ƒå°”æ“ä½œï¼ˆä¾‹å¦‚äº¤é›†ã€å¹¶é›†å’Œå·®é›†ï¼‰ç”±å¤šä¸ªæ‹‰ä¼¸è‰å›¾ç»„æˆã€‚æ³¨æ„ï¼ŒDeepCADçš„è¡¨ç¤ºæ³•æ²¡æœ‰é¢åŸºå…ƒï¼Œæ— æ³•è¡¨ç¤ºå…·æœ‰å¤šä¸ªé¢çš„è‰å›¾ï¼ˆä¾‹å¦‚Figure 1ä¸­çš„ES1ï¼‰ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:4:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5 SkexGenæ¶æ„ SkexGen æ˜¯ä¸€ç§è‡ªå›å½’ç”Ÿæˆæ¨¡å‹ï¼Œé€šè¿‡ä¸¤ä¸ªç½‘ç»œåˆ†æ”¯ä¸­çš„ä¸‰ä¸ªè§£è€¦ç æœ¬å­¦ä¹ è‰å›¾å’Œæ‹‰ä¼¸æ¨¡å‹çš„å˜ä½“ã€‚å›¾2å±•ç¤ºäº†SkexGençš„æ¶æ„ã€‚â€œè‰å›¾â€åˆ†æ”¯å­¦ä¹ äºŒç»´è‰å›¾çš„æ‹“æ‰‘å’Œå‡ ä½•å˜ä½“ï¼Œâ€œæ‹‰ä¼¸â€åˆ†æ”¯å­¦ä¹ ä¸‰ç»´æ‹‰ä¼¸çš„å˜ä½“ï¼ˆå¦‚æ–¹å‘ï¼‰ã€‚ä¸¤ä¸ªåˆ†æ”¯æ¶æ„ç±»ä¼¼ï¼Œæœ¬èŠ‚é‡ç‚¹ä»‹ç»è‰å›¾åˆ†æ”¯ï¼ŒåŒ…å«ä¸¤ä¸ªç¼–ç å™¨å’Œä¸€ä¸ªè§£ç å™¨ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:5:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5.1 æ‹“æ‰‘ç¼–ç å™¨ æ‹“æ‰‘ç¼–ç å™¨æ¥æ”¶è¾“å…¥çš„å­åºåˆ—ï¼Œtokenä¸ºï¼š æ‹“æ‰‘tokenï¼ˆTï¼‰ï¼šè¡¨ç¤ºä¸‰ç§æ›²çº¿ç±»å‹ä¹‹ä¸€ï¼ˆç›´çº¿/å¼§çº¿/åœ†ï¼‰ã€‚ ç»“æŸåŸºå…ƒtokenï¼ˆEï¼‰ï¼šè¡¨ç¤ºä¸‰ç§åŸºå…ƒç±»å‹ä¹‹ä¸€ï¼ˆç¯/é¢/è‰å›¾ï¼‰çš„ç»“æŸã€‚ ç»“æŸåºåˆ—tokenï¼ˆEndï¼‰ï¼šè¡¨ç¤ºåºåˆ—çš„ç»“æŸã€‚ å› æ­¤ï¼Œtokenåˆå§‹åŒ–ä¸ºä¸€ä¸ª7ç»´ï¼ˆ= 3+3+1ï¼‰çš„ç‹¬çƒ­å‘é‡ åµŒå…¥ ç‹¬çƒ­å‘é‡è½¬æ¢ä¸º256ç»´åµŒå…¥ã€‚ä½œè€…è€ƒè™‘æ‹“æ‰‘token $T$ï¼Œå…¶ä¸­$h_{T} ^{tp}$æ˜¯7ç»´ç‹¬çƒ­å‘é‡ï¼Œ$i_T$è¡¨ç¤ºå…¶åœ¨è¾“å…¥å­åºåˆ—ä¸­çš„ç´¢å¼•ï¼Œå…¶åµŒå…¥å‘é‡è®¡ç®—å…¬å¼ä¸ºï¼š $$ T \\leftarrow \\mathbf{W}^\\text{tp} h_{T} ^{tp} + \\mathbf{p}^{(i_T)} $$ å…¶ä¸­$\\mathbf{W}^\\text{tp}\\in \\mathbb{R}^{d_E\\times 7}$è¡¨ç¤ºå¯å­¦ä¹ çŸ©é˜µï¼Œ$\\mathbf{p}^{(i_T)}$è¡¨ç¤ºæ‹“æ‰‘å­åºåˆ—ç´¢å¼•$i_T$å¤„çš„å¯å­¦ä¹ ä½ç½®ç¼–ç ã€‚ æ¶æ„ ç¼–ç å™¨åŸºäºTransformerï¼ˆå››å±‚ï¼Œæ¯å±‚åŒ…å«å…«å¤´è‡ªæ³¨æ„å±‚ã€å±‚è§„èŒƒåŒ–å’Œå‰é¦ˆå±‚ï¼‰ã€‚æ ¹æ®Vision Transformerï¼Œè¾“å…¥çš„æ‹“æ‰‘ä¿¡æ¯ç¼–ç ä¸ºä¸€ä¸ªâ€œç tokenâ€ï¼Œé¢„å…ˆåŠ å…¥åˆ°è¾“å…¥ä¸­ï¼Œå¹¶åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¯å­¦ä¹ çš„åµŒå…¥$Z_{tp}$ã€‚ä»¤$Z_{tp}^e$ä¸ºç¼–ç å™¨è¾“å‡ºçš„ç tokenåµŒå…¥ã€‚åµŒå…¥$Z_{tp}^e$è¢«é‡åŒ–ä¸ºå¤§å°ä¸º$N({\\mathbf{b}_{tp}\\text{ | }i=1,2\\cdots N})$çš„ç æœ¬æœ€è¿‘ç ã€‚ ç¼–ç å’Œé‡åŒ–åçš„æœ€ç»ˆç token $Z_{tp}^Q$è¢«ä¼ é€’ç»™è§£ç å™¨ã€‚ $$ Z^Q_{tp} \\leftarrow \\mathbf{b}^{(k)}_{tp}, \\text{where } k = \\text{argmin}_{j} | Z^e_{_{tp}} - b^{(j)}_{tp} |^2 $$ fè¿™é‡Œä¸ºäº†ç®€å•èµ·è§ï¼Œåªå‡è®¾äº†ä¸€ä¸ªç tokenï¼Œæ‹“æ‰‘ç¼–ç å™¨å®é™…ä¸Šç”±å››ä¸ªç tokenï¼Œå¹¶äº§ç”Ÿå››ä¸ªè¾“å‡ºç tokenï¼ˆ$Z^{Q_{(1)}}_{tp},Z^{Q_{(2)}}_{tp},Z^{Q_{(3)}}_{tp},Z^{Q_{(4)}}_{tp}$ï¼‰ã€‚ä½œè€…å°è¯•äº†ä¸åŒçš„ç æœ¬å¤§å°ï¼Œå‘ç° $N = 500$ å¯ä»¥å–å¾—è‰¯å¥½æ•ˆæœã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:5:1","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5.2 å‡ ä½•ç¼–ç å™¨ è¾“å…¥token å‡ ä½•tokenï¼ˆGï¼‰ï¼šåŒ…å«ä¸€ä¸ªäºŒç»´ç‚¹åæ ‡ ç»“æŸåŸºå…ƒtokenï¼ˆEï¼‰ï¼šè¡¨ç¤ºå››ç§åŸºå…ƒç±»å‹ä¹‹ä¸€ï¼ˆæ›²çº¿/é¢/ç¯/è‰å›¾ï¼‰çš„ç»“æŸ ç»“æŸåºåˆ—tokenï¼ˆEndï¼‰ å‡ ä½•token G æŒ‡å®šæ²¿æ›²çº¿çš„ä¸€ä¸ªäºŒç»´ç‚¹åæ ‡ã€‚ç”±äºåæ ‡æ˜¯æ•°å€¼å‹çš„ï¼Œä½œè€…å°†è‰å›¾ç¦»æ•£åŒ–ä¸º$64\\times 64$ï¼ˆ6ä½ï¼‰åƒç´ ï¼Œå¹¶è€ƒè™‘$64^2$ä¸ªå¯èƒ½çš„åƒç´ ä½ç½®ã€‚å› æ­¤ï¼Œä¸€ä¸ª$4101(=64^2+4+1)$ç»´çš„ç‹¬çƒ­å‘é‡å”¯ä¸€ç¡®å®šäº†tokenä¿¡æ¯ã€‚ åµŒå…¥ æˆ‘ä»¬æŒ‰ç…§4.1ä¸­çš„åµŒå…¥å…¬å¼å¹¶ä½¿ç”¨$\\mathbf{W^{ge}}\\in\\mathbb{R}^{d_E\\times 4101}$å’Œä½ç½®ç¼–ç æ¥åˆå§‹åŒ–è¾“å…¥tokenåµŒå…¥ã€‚token Eå’ŒEndç±»ä¼¼äºæ‹“æ‰‘Tokençš„åˆå§‹åŒ–ï¼Œé€šè¿‡å°†å®ƒä»¬çš„ç‹¬çƒ­å‘é‡$h^{ge}_G\\in \\mathbb{R}^{4101}$ä¹˜ä»¥$\\mathbf{W^{ge}}$å¹¶åŠ ä¸Šä½ç½®ç¼–ç ã€‚å‡ ä½•Token Gçš„åˆå§‹åŒ–ä¸åŒï¼š $$ G \\leftarrow \\mathbf{W^{ge}} h^{ge}_G + \\mathbf{W}^xh^x_G + \\mathbf{W}^y h^y_G + \\mathbf{p}^{(i_G)}. $$ å‡ ä½•token $G$å…·æœ‰é™„åŠ çš„åæ ‡åµŒå…¥ï¼Œ$h^x_G,h^y_G\\in \\mathbb{R}^{64}$æ˜¯æŒ‡ç¤ºåƒç´ çš„$x,y$åæ ‡çš„ç‹¬çƒ­å‘é‡ã€‚åæ ‡åµŒå…¥æ˜¯å¯é€‰çš„ï¼Œä½†å¯ä»¥è¿›ä¸€æ­¥æé«˜å®éªŒç»“æœã€‚ æ¶æ„ ç±»ä¼¼äºæ‹“æ‰‘ç¼–ç å™¨ï¼ŒåŸºäºTransformerã€‚ ç”ŸæˆåµŒå…¥ $Z^{{e_{(i)}}}_{ge}$ å’Œé‡åŒ–åçš„ç token $Z^{Q_{(i)}}_{ge}$ ã€‚ ä½¿ç”¨ä¸¤ä¸ªç tokenï¼Œç æœ¬å¤§å° $N = 1000$ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:5:2","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5.3 è‰å›¾è§£ç å™¨ è‰å›¾è§£ç å™¨ä»¥æ‹“æ‰‘å’Œå‡ ä½•ç æœ¬ä¸ºè¾“å…¥ï¼Œç”Ÿæˆå‡ ä½•token $G$å’Œç»“æŸåŸºå…ƒtoken $E$ï¼ˆç”¨äºæ›²çº¿/ç¯/é¢/è‰å›¾ï¼‰ï¼Œä»¥æ¢å¤è‰å›¾å­åºåˆ—ã€‚ æ³¨æ„ï¼Œä¸ç”Ÿæˆæ‹“æ‰‘æ ‡è®°Tï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æ ¹æ®æ¯æ¡æ›²çº¿å†…çš„å‡ ä½•æ ‡è®°æ•°é‡æ¨æ–­å‡ºæ¥ï¼ˆå³ï¼Œç›´çº¿/å¼§çº¿/åœ†åˆ†åˆ«æœ‰1/2/4ä¸ªGæ ‡è®°ï¼‰ã€‚è¿™æ„å‘³ç€å‡ ä½•ç¼–ç å™¨å’Œè‰å›¾è§£ç å™¨æœ‰ç›¸ä¼¼çš„å­åºåˆ—ï¼ˆFigure 2ï¼‰ã€‚ è¾“å…¥ ç»™å®šå‰$k-1$ä¸ªtokenï¼Œè‡ªå›å½’è§£ç å™¨é¢„æµ‹ç¬¬$k$ä¸ªtokençš„æ¡ä»¶æ¦‚ç‡ã€‚è®­ç»ƒè¾“å…¥åºåˆ—å‘å³ç§»ä¸€ä½ï¼Œå‰é¢æ·»åŠ â€œstartâ€ç¬¦å·ï¼ˆç”±ä½ç½®ç¼–ç åˆå§‹åŒ–ï¼‰ã€‚ç”±äºè§£ç å™¨ä¸­å¯èƒ½çš„tokenç±»å‹ä¸å‡ ä½•ç¼–ç å™¨ç›¸åŒï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„$4101$ç»´ç‹¬çƒ­ç¼–ç æ–¹æ¡ˆï¼Œå¹¶ä½¿ç”¨å¸¦æœ‰ä½ç½®ç¼–ç çš„å¯å­¦ä¹ çŸ©é˜µï¼ˆå¤§å°ä¸º $d_E \\times 4101$ï¼‰åˆå§‹åŒ–åµŒå…¥å‘é‡ã€‚ è¾“å‡º è§£ç å™¨ç”Ÿæˆâ€œå‘å·¦ç§»ä¸€ä½â€çš„å­åºåˆ—ï¼Œå³é¢„æµ‹è¾“å…¥ä¸­çš„åŸå§‹$k$ä¸ªæ ‡è®°ï¼ˆè§Figure 2ï¼‰ã€‚ä»¤$K$ä¸ºè‰å›¾è§£ç å™¨è¾“å‡ºä¸­çš„ä¸€ä¸ªæ ‡è®°ï¼Œå…¶å…·æœ‰ $d_E$ ç»´åµŒå…¥ã€‚æˆ‘ä»¬ä½¿ç”¨å¯å­¦ä¹ çŸ©é˜µ $\\mathbf{W^{out}} \\in \\mathbb{R}^{4101 \\times d_E}$ æ¥é¢„æµ‹4101ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼š$h^\\text{out}_K \\leftarrow \\text{softmax} (\\mathbf{W^\\text{out}} K)$ äº¤å‰æ³¨æ„åŠ› Transformeræ¶æ„é€šè¿‡äº¤å‰æ³¨æ„åŠ›ä»æ‹“æ‰‘å’Œå‡ ä½•ç æœ¬ä¸­åˆ†åˆ«å–å››ä¸ªå’Œä¸¤ä¸ªé‡åŒ–ç æœ¬å‘é‡ã€‚ä¸ºäº†åŒºåˆ†ä¸¤ä¸ªä¸åŒçš„ç æœ¬ï¼Œæˆ‘ä»¬å€Ÿé‰´ä½ç½®ç¼–ç çš„æ€æƒ³ï¼Œåˆ†åˆ«å‘æ‹“æ‰‘ç  ${ Z^{Q_{(i)}}_{tp} }$ å’Œå‡ ä½•ç  ${ Z^{Q_{(i)}}_{ge} }$ æ·»åŠ å¯å­¦ä¹ åµŒå…¥å‘é‡ $\\mathbf{p}^{(q_{tp})} \\in \\mathbb{R}^{4 \\times d_E}$å’Œ $\\mathbf{p}^{(q_{ge})} \\in \\mathbb{R}^{2 \\times d_E}$ ï¼š $$ Z^{{Q_{(i)}}}_{tp} + p^{(q_{tp})} \\quad \\text{or} \\quad Z^{Q_{(i)}}_{ge}+ p^{(q_{ge})}. $$ åŸºç¡€ç½‘ç»œè®¾ç½®ä¸ç¼–ç å™¨ç›¸åŒï¼ˆå³å››å±‚ï¼Œæ¯å±‚å…«å¤´ï¼‰ï¼Œä½†å®ƒæ˜¯å¸¦æ©ç çš„è‡ªå›å½’ï¼ˆä»…å…³æ³¨å…ˆå‰çš„æ ‡è®°ï¼‰ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:5:3","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5.4 è®­ç»ƒ æ‹“æ‰‘ç¼–ç å™¨ã€å‡ ä½•ç¼–ç å™¨å’Œè‰å›¾è§£ç å™¨é€šè¿‡ä¸‰ç§æŸå¤±å‡½æ•°è”åˆè®­ç»ƒï¼š $$ \\sum_K \\text{CrossEntropy}(h^\\text{out}_K, h^\\text{gt}_K) + \\ | \\text{sg} (Z^{e}_{tp}) - \\mathbf{b}_{tp} |_2^2 + \\beta | Z^{e}_{tp} - \\text{sg} (\\mathbf{b}_{tp}) |_2^2 + \\ | \\text{sg} (Z^{e}_{ge}) - \\mathbf{b}_{ge} |_2^2 + \\beta | Z^{e}_{ge} - \\text{sg} (b_{ge}) |_2^2. $$ ç¬¬ä¸€è¡Œè®¡ç®—åºåˆ—é‡å»ºæŸå¤±ï¼Œå…¶ä¸­ $h^\\text{out}_K$ æ˜¯è‰å›¾è§£ç å™¨é¢„æµ‹çš„æ¦‚ç‡ï¼Œ $h^\\text{gt}_K$ æ˜¯çœŸå®çš„ç‹¬çƒ­å‘é‡ï¼Œåˆ©ç”¨äº¤å‰ç†µæŸå¤±è¡¡é‡å‡†ç¡®åº¦ã€‚ ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œæ˜¯VQ-VAEä½¿ç”¨çš„æ ‡å‡†ç æœ¬å’Œæ‰¿è¯ºæŸå¤±ã€‚ $\\text{sg}$ è¡¨ç¤ºåœæ­¢æ¢¯åº¦æ“ä½œï¼Œåœ¨å‰å‘ä¼ æ’­ä¸­æ˜¯æ’ç­‰å‡½æ•°ï¼Œä½†åœ¨åå‘ä¼ æ’­ä¸­é˜»æ­¢æ¢¯åº¦ã€‚ $\\beta$ ç¼©æ”¾æ‰¿è¯ºæŸå¤±ï¼Œè®¾ä¸º$0.25$ï¼Œç”¨äºè°ƒæ•´æ‰¿è¯ºæŸå¤±çš„æƒé‡ï¼Œè¿™ç¡®ä¿ç¼–ç å™¨è¾“å‡ºç»‘å®šä¸€ä¸ªç å‘é‡ã€‚ ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬çœç•¥äº†æ¯ä¸ªç¼–ç å™¨ä¸­å¤šä¸ªç æœ¬æ ‡è®°çš„æ˜ç¡®å†™å‡ºã€‚ç»™å®šä¸€ä¸ªçœŸå®å­åºåˆ—ï¼Œæˆ‘ä»¬è¿è¡Œä¸¤ä¸ªç¼–ç å™¨å¹¶è‡ªå›å½’åœ°è¿è¡Œè§£ç å™¨ï¼Œç›´åˆ°ç”Ÿæˆç›¸åŒæ•°é‡çš„æ ‡è®°ã€‚è®­ç»ƒé‡‡ç”¨æ•™å¸ˆå¼ºåˆ¶çš„æ–¹å¼ï¼Œå³å°†çœŸå®tokenè€Œéé¢„æµ‹tokenè¾“å…¥è§£ç å™¨ï¼Œä¿è¯æ¯æ¬¡è¿­ä»£è§£ç å™¨ä»…ä¸“æ³¨äºå•æ­¥è®­ç»ƒï¼Œä»è€Œç®€åŒ–è®­ç»ƒæµç¨‹å¹¶æå‡æ•ˆç‡ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:5:4","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5.5 ç”Ÿæˆ SkexGen ç”Ÿæˆ CAD æ¨¡å‹åˆ†ä¸¤æ­¥ï¼š ä»ä¸‰ä¸ªç æœ¬ç”Ÿæˆç ã€‚ é‡‡ç”¨è®­ç»ƒå®Œæˆçš„ç¼–ç å™¨ï¼ˆæ‹“æ‰‘ã€å‡ ä½•ã€æ‹‰ä¼¸ï¼‰ä»æ ·æœ¬ä¸­æå–ç ã€‚ Transformerè§£ç å™¨è¢«è®­ç»ƒæ¥ç”Ÿæˆè¿™äº›éæ­£æ€åˆ†å¸ƒçš„é‡åŒ–ç ï¼Œå³ä»ç æœ¬ä¸­æŒ‘é€‰ç ç´¢å¼•ã€‚ å…è®¸æ¶æ„å¾®å°ä¿®æ”¹ä»¥æ”¯æŒæ¡ä»¶ç ç”Ÿæˆï¼Œå¦‚â€œæ‹“æ‰‘æ¡ä»¶ç é€‰æ‹©å™¨â€ï¼Œå®ƒåŸºäºç»™å®šæ‹“æ‰‘ç æ¥æŒ‘é€‰ç›¸åº”çš„å‡ ä½•å’Œæ‹‰ä¼¸ç ã€‚ ç»™å®šç ç”Ÿæˆè‰å›¾å’Œæ‹‰ä¼¸æ„é€ åºåˆ—ã€‚ ç»™å®šç ï¼Œè‰å›¾å’Œæ‹‰ä¼¸è§£ç å™¨ä¾¿é€šè¿‡æ ¸é‡‡æ ·ï¼Œè‡ªå›å½’æ–¹å¼ç”Ÿæˆæ„é€ å­åºåˆ—ã€‚ è¿™äº›å­åºåˆ—æ•´åˆæˆå®Œæ•´çš„è‰å›¾å’Œæ‹‰ä¼¸åºåˆ—ï¼Œæœ€ç»ˆç”±CADè½¯ä»¶è§£æä¸ºè¾¹ç•Œè¡¨ç¤ºã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:5:5","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"6 å®éªŒ å®éªŒéªŒè¯ç›®æ ‡ï¼š SkexGenç”Ÿæˆé«˜è´¨é‡å’Œå¤šæ ·åŒ–ç»“æœçš„èƒ½åŠ› ç æœ¬å¯¹ç”Ÿæˆè¿‡ç¨‹æ§åˆ¶çš„ç¨‹åº¦ SkexGenåœ¨è®¾è®¡æ¢ç´¢å’Œæ’å€¼åº”ç”¨ä¸­çš„è¡¨ç° ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:6:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"6.1 å®éªŒè®¾ç½® æ•°æ®é›†ï¼šä½¿ç”¨DeepCADæ•°æ®é›†ï¼ŒåŒ…å«178,238ä¸ªåºåˆ—ï¼Œç»å»é‡å’Œæ— æ•ˆæ“ä½œå‰”é™¤ï¼Œæœ€ç»ˆè®­ç»ƒé›†å«74,584ä¸ªè‰å›¾å­åºåˆ—ä¸86,417ä¸ªæ‹‰ä¼¸å­åºåˆ—ã€‚é’ˆå¯¹å•ä¸€è‰å›¾å®éªŒï¼Œç»è¿‡ä»æ„é€ åºåˆ—çš„æ­¥éª¤ä¸­æå–è‰å›¾å¹¶å»é‡åï¼Œæœ€ç»ˆæ”¶é›†åˆ°114,985ä¸ªè®­ç»ƒæ ·æœ¬ã€‚ å®ç°ç»†èŠ‚ï¼šSkexGenåŸºäºPyTorchå¼€å‘ï¼Œåœ¨RTX A5000ä¸Šè®­ç»ƒã€‚é‡‡ç”¨ä¸DeepCADä¸€è‡´çš„è®¾ç½®ï¼Œå››å±‚Transformerç»“æ„ï¼Œæ¯å±‚å«å…«ä¸ªæ³¨æ„åŠ›å¤´ï¼Œå±‚è§„èŒƒåŒ–ï¼Œå‰é¦ˆç»´åº¦512ï¼Œè¾“å…¥åµŒå…¥256ç»´ï¼ŒDropoutç‡0.1ã€‚ä½¿ç”¨Adamä¼˜åŒ–å™¨ï¼Œå­¦ä¹ ç‡0.001ã€‚çº¿æ€§é¢„çƒ­å’Œæ¢¯åº¦è£å‰ªä¸ DeepCAD ä¸€è‡´ã€‚æˆ‘ä»¬åœ¨å‰25ä¸ªepochä¸­è·³è¿‡ä»£ç é‡åŒ–ï¼Œå‘ç°è¿™æœ‰åŠ©äºç¨³å®šç æœ¬è®­ç»ƒã€‚å¯¹äºæ•°æ®å¢å¼ºï¼Œæˆ‘ä»¬å‘å‡ ä½•æ ‡è®°çš„åæ ‡æ·»åŠ å°çš„éšæœºå™ªå£°ã€‚è®­ç»ƒ300ä¸ªepochï¼Œæ‰¹é‡å¤§å°128ã€‚è‰å›¾ä¸æ‹‰ä¼¸å­åºåˆ—æœ€å¤§é•¿åº¦åˆ†åˆ«ä¸º200ä¸100ã€‚åœ¨æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨æ ¸é‡‡æ ·æ–¹æ³•ä»¥è‡ªå›å½’æ–¹å¼é‡‡æ ·ç é€‰æ‹©å™¨å’Œè§£ç å™¨ã€‚ æŒ‡æ ‡ï¼š FrÃ©chet Inception Distance (FID)ï¼šæ¯”è¾ƒçœŸå®å’Œç”Ÿæˆæ•°æ®åˆ†å¸ƒçš„å‡å€¼å’Œåæ–¹å·®æ¥è¡¡é‡ç”Ÿæˆçš„ä¿çœŸåº¦ã€‚ è¦†ç›–ç‡ï¼ˆCOVï¼‰ï¼šåŸºäºè¡¨é¢ä¸Š2,000ä¸ªå‡åŒ€é‡‡æ ·ç‚¹çš„æœ€å° Chamfer è·ç¦»æ¥è¡¡é‡çœŸå®æ•°æ®ä¸ç”Ÿæˆæ•°æ®çš„åŒ¹é…ç™¾åˆ†æ¯”ã€‚ æœ€å°åŒ¹é…è·ç¦» (MMD)ï¼šç”Ÿæˆæ ·æœ¬ä¸å…¶åœ¨çœŸå®æ•°æ®é›†ä¸­æœ€è¿‘é‚»çš„å¹³å‡æœ€å°åŒ¹é…è·ç¦»ã€‚ Jensen-Shannonæ•£åº¦ (JSD)ï¼šåŸºäºè¾¹ç¼˜ç‚¹åˆ†å¸ƒè¡¡é‡çœŸå®å’Œç”Ÿæˆåˆ†å¸ƒçš„ç›¸ä¼¼æ€§ã€‚ Novel Scoreï¼šç”Ÿæˆæ•°æ®ä¸­æœªå‡ºç°åœ¨è®­ç»ƒé›†ä¸­çš„ç™¾åˆ†æ¯”ã€‚ Unique Scoreï¼šç”Ÿæˆæ ·æœ¬ä¸­ä»…å‡ºç°ä¸€æ¬¡çš„æ•°æ®ç™¾åˆ†æ¯”ï¼Œå¦‚æœåºåˆ—ä¸­çš„æ‰€æœ‰tokenåœ¨6ä½é‡åŒ–åç›¸åŒï¼Œæˆ‘ä»¬è®¤ä¸ºä¸¤ä¸ªæ•°æ®æ ·æœ¬æ˜¯ç›¸åŒçš„ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:6:1","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"6.2 éšæœºç”Ÿæˆ ä¸ºäº†è¯„ä¼° SkexGen ç”Ÿæˆé«˜è´¨é‡å’Œå¤šæ ·åŒ–ç»“æœçš„èƒ½åŠ›ï¼Œæˆ‘ä»¬éšæœºç”Ÿæˆæ¯ç§ç±»å‹çš„20,000ä¸ªæ ·æœ¬ï¼Œå¹¶å°† SkexGen ä¸å››ä¸ªå…¶ä»–åŸºçº¿è¿›è¡Œæ¯”è¾ƒï¼š CurveGen DeepCAD å•ä¸€ç æœ¬çš„ SkexGen å¸¦ VAE çš„ SkexGenã€‚ ç”±äºå…¶ä»–æ¥è‡ªåŒæ—¶ç ”ç©¶çš„è‰å›¾ç”Ÿæˆæ¨¡å‹ä¾èµ–äºè‰å›¾çº¦æŸæ ‡ç­¾ï¼Œå¹¶ä¸”ç†æƒ³æƒ…å†µä¸‹éœ€è¦è‰å›¾çº¦æŸæ±‚è§£å™¨ï¼Œè¿™ä½¿å¾—å®ƒä»¬æ— æ³•ç›´æ¥æ¯”è¾ƒã€‚ è‰å›¾ç”Ÿæˆè¯„ä¼°ï¼šç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚SkexGenFIDåˆ†æ•°è¡¨ç°æœ€ä¼˜ï¼Œè¯æ˜å…¶ç”Ÿæˆçš„è‰å›¾è´¨é‡æœ€é«˜ã€‚SkexGenåœ¨Novelä¸Šè™½ä¸åŠDeepCADï¼Œä½†åœ¨Uniqueä¸Šä¸CurveGenç›¸å½“æˆ–æ›´ä¼˜ã€‚ä¸”å®šæ€§åˆ†ææ˜¾ç¤ºï¼ŒDeepCADè™½ç„¶Novelå¾—åˆ†é«˜ï¼Œä½†å­˜åœ¨å¤§é‡æ— æ•ˆç»“æœï¼Œå¦‚è‡ªç›¸äº¤æ›²çº¿å’Œæœªé—­åˆå‡ ä½•ï¼Œå½±å“äº†FIDè¯„åˆ†ã€‚æ€»ä½“è€Œè¨€ï¼š SkexGen ç”Ÿæˆçš„è‰å›¾åœ¨è´¨é‡ä¸Šæ›´å¥½ï¼Œå½¢çŠ¶æ›´å¤æ‚ï¼Œè‡ªç›¸äº¤æ›´å°‘ï¼Œå¯¹ç§°æ€§æ›´å¼ºã€‚ CurveGen ä¹Ÿç”Ÿæˆäº†è´¨é‡ä¸é”™çš„ç»“æœï¼Œä½†çŸ©å½¢å’Œåœ†çš„å¤æ‚æ’åˆ—è¾ƒå°‘ã€‚ DeepCAD å¯ä»¥ç”Ÿæˆæ¯” CurveGen æ›´å¤æ‚çš„å½¢çŠ¶ï¼Œä½†å™ªéŸ³å¾ˆå¤šã€‚ CADæ¨¡å‹ç”Ÿæˆè¯„ä¼°ï¼šç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼ŒSkexGenåœ¨æ‰€æœ‰è¯„ä¼°æŒ‡æ ‡ä¸Šé¢†å…ˆï¼Œå°¤å…¶åœ¨å½¢çŠ¶å¤æ‚åº¦ã€å¯¹ç§°æ€§ä»¥åŠé¢‘ç¹ä½¿ç”¨å¼§çº¿æ–¹é¢è¡¨ç°å‡ºè‰²ã€‚SkexGenèƒ½ç”Ÿæˆæ¶‰åŠå¤šæ­¥éª¤è‰å›¾å’Œæ‹‰ä¼¸åºåˆ—çš„CADæ¨¡å‹ï¼Œè€ŒDeepCADåˆ™ä¸»è¦ç”Ÿæˆå•æ­¥æ¨¡å‹ã€‚è¡¨ä¸­é—´ä¸¤è¡Œå±•ç¤ºäº†å¤šä¸ªè§£è€¦ç æœ¬çš„æœ‰æ•ˆæ€§ã€‚å‡å°‘åˆ°å•ä¸ªç æœ¬åï¼Œç”Ÿæˆè´¨é‡ä¸‹é™ï¼ŒSkexGen ç±»ä¼¼äº VQ-VAEã€‚å½“ä¸ä½¿ç”¨ç æœ¬æ—¶ï¼Œç»“æœæœ€å·®ï¼ŒSkexGen å®é™…ä¸Šå˜æˆäº† VAEã€‚ è¿è¡Œæ—¶é—´è¯„ä¼°ï¼šå°½ç®¡SkexGençš„è‡ªå›å½’é‡‡æ ·è¿‡ç¨‹ä½¿å…¶æ¯”DeepCADæ…¢ï¼Œä½†æ¯”CurveGenï¼ˆå…·æœ‰ä¸¤ä¸ªä¾èµ–çš„è‡ªå›å½’è§£ç å™¨ï¼‰å¿«ï¼Œæ˜¾ç¤ºå‡ºé‡‡æ ·æ•ˆç‡çš„ä¼˜åŒ–ç©ºé—´ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:6:2","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"6.3 å¯æ§ç”Ÿæˆ è§£è€¦ç æœ¬å®ç°äº†è®¾è®¡æ§åˆ¶ä¸æ¢ç´¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå·¦ä¾§â€œæ‹“æ‰‘æ¡ä»¶â€ï¼šå›ºå®šæ‹“æ‰‘ç ï¼Œå…¶ä»–ç é€šè¿‡æ ¸é‡‡æ ·è·å¾—ï¼Œå±•ç¤ºç›¸åŒç»“æ„çš„ä¸åŒå˜ä½“ã€‚å³ä¾§â€œå‡ ä½•æ¡ä»¶â€ï¼šå›ºå®šå‡ ä½•ç ï¼Œæ”¹å˜å…¶ä»–ç ï¼Œä½“ç°ä¸€è‡´å‡ ä½•ä¸‹çš„å¤šæ ·å½¢æ€ã€‚ ä¸ºäº†å®šé‡è¡¡é‡ä¸‰ä¸ªç æœ¬ä¹‹é—´çš„è§£è€¦ç¨‹åº¦ï¼Œä½œè€…å‚è€ƒäº†$\\beta\\text{-VAE}$çš„è¯„ä¼°æ–¹æ³•ã€‚é€šè¿‡ä¿æŒä¸€ä¸ªæ‹“æ‰‘ã€å‡ ä½•æˆ–æ‹‰ä¼¸æ ‡è®°ç›¸åŒï¼Œå¹¶å¯¹å…¶ä»–éƒ¨åˆ†è¿›è¡Œé‡‡æ ·ï¼Œç”Ÿæˆä¸€å¯¹è‰å›¾å’Œæ‹‰ä¼¸åºåˆ—ã€‚ç„¶åè®­ç»ƒä¸€ä¸ªå°å‹åŸºäºTransformerçš„åˆ†ç±»å™¨ï¼Œé€šè¿‡ç¼–ç æ½œåœ¨ç©ºé—´ä¸­æ‰€æœ‰æ•°æ®å¯¹çš„å¹³å‡æˆå¯¹å·®å¼‚æ¥è¯†åˆ«å›ºå®šçš„ç ã€‚SkexGençš„åˆ†ç±»å‡†ç¡®ç‡ä¸º99.8 Â± 0.1%ï¼Œè¯å®ç æœ¬é—´è§£è€¦æ•ˆæœæ˜¾è‘—ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:6:3","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"6.4 åº”ç”¨ æ’å€¼åº”ç”¨ åˆ©ç”¨çº¿æ€§æ’å€¼æŠ€æœ¯åœ¨æ¨¡å‹çš„ç ä¹‹é—´æ¢ç´¢ï¼Œç”Ÿæˆè¿‡æ¸¡æ¨¡å‹ã€‚è¿‡ç¨‹åŒ…æ‹¬ï¼šç¼–ç æ¨¡å‹æå–å…³é”®ç ã€çº¿æ€§æ’å€¼è¿™äº›ç ï¼Œå†é‡åŒ–åŠç”Ÿæˆæ’å€¼æ¨¡å‹ã€‚æ’å€¼ç»“æœç¤ºä¾‹å¦‚Figureæ‰€ç¤ºï¼Œçº¿æ¡æ¼”åŒ–ä¸ºåœ†ï¼ŒçŸ©å½¢å®ä½“è½¬ä¸ºåœ†å½¢ç©ºå¿ƒç›˜ï¼Œæ˜¾ç¤ºæ‹“æ‰‘å’Œå‡ ä½•åŠ¨æ€å˜åŒ–ã€‚æ’å€¼æ•ˆæœå¯èƒ½ä¸å¹³æ»‘ï¼Œå› æ¶‰åŠå¤æ‚çš„ç¦»æ•£æ‹“æ‰‘å˜æ¢ã€‚ ç æ··åˆåº”ç”¨ é€šè¿‡æ··åˆä¸åŒæ•°æ®çš„æ‹“æ‰‘ã€å‡ ä½•å’Œæ‹‰ä¼¸ç ï¼Œåˆ›é€ æ–°é¢–è®¾è®¡ç»„åˆã€‚å›¾8ç¤ºä¾‹ï¼šä¿æŒæ‹“æ‰‘å½¢çŠ¶ï¼Œè°ƒæ•´å‡ ä½•ä½ç½®ï¼Œå¦‚å¤šä¸ªåœ†æŸ±æŒ‰æ–¹å½¢å¸ƒå±€æ’åˆ—ã€‚è¿™äº›æ··åˆç»“æœä½“ç°äº†ç³»ç»Ÿçš„åˆ›æ–°è®¾è®¡èƒ½åŠ›ï¼Œè¶…è¶Šäº†ä¼ ç»Ÿæ–¹æ³•çš„å±€é™ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:6:4","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"7 æ€»ç»“ SkexGenæ˜¯ä¸€ç§æ–°é¢–çš„è‡ªå›å½’ç”Ÿæˆæ¨¡å‹ï¼Œä¸“ä¸ºCADæ„é€ åºåˆ—è®¾è®¡ã€‚å®ƒåˆ©ç”¨ä¸åŒçš„Transformeræ¶æ„å°†CADæ„é€ åºåˆ—ä¸­çš„æ‹“æ‰‘ã€å‡ ä½•å’Œæ‹‰ä¼¸å˜åŒ–ç¼–ç ä¸ºè§£è€¦ç æœ¬ã€‚è¿™äº›è§£ç å™¨å¯ä»¥ç”Ÿæˆå…·æœ‰ç‰¹å®šå±æ€§çš„CADæ„é€ åºåˆ—ã€‚SkexGençš„ä¼˜åŠ¿åœ¨äºå…¶èƒ½å¤Ÿç”Ÿæˆå¤šæ ·ä¸”é«˜è´¨é‡çš„CADæ¨¡å‹ï¼ŒåŒæ—¶æé«˜ç”¨æˆ·çš„æ§åˆ¶èƒ½åŠ›å’Œè®¾è®¡ç©ºé—´çš„æ¢ç´¢æ•ˆç‡ã€‚ æ¨¡å‹çš„è¯„ä¼°åœ¨ä¸€ä¸ªå¤§è§„æ¨¡çš„CADæ•°æ®é›†ä¸Šè¿›è¡Œï¼Œç»“æœè¡¨æ˜ï¼ŒSkexGenç›¸æ¯”å¤šä¸ªåŸºå‡†å’Œæœ€æ–°æ–¹æ³•ï¼Œç”Ÿæˆçš„CADæ¨¡å‹æ›´ä¸ºçœŸå®å’Œå¤šæ ·ã€‚æ­¤å¤–ï¼ŒSkexGençš„æ¶æ„ä¹Ÿå¢å¼ºäº†ç”¨æˆ·åœ¨è®¾è®¡è¿‡ç¨‹ä¸­çš„æ§åˆ¶èƒ½åŠ›ï¼Œä½¿å…¶èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°æ¢ç´¢ä¸åŒè®¾è®¡ç©ºé—´ã€‚ 7.0.1 é™åˆ¶ æ•°æ®ä¾èµ–ï¼šSkexGenä¾èµ–äºå¤§é‡çš„å·²æ ‡æ³¨CADæ•°æ®é›†ï¼Œè¿™äº›æ•°æ®é›†çš„è´¨é‡å’Œå¤šæ ·æ€§ç›´æ¥å½±å“æ¨¡å‹çš„è¡¨ç°ã€‚ æ¨¡å‹å¤æ‚æ€§ï¼šè¯¥æ¨¡å‹ä½¿ç”¨å¤šä¸ªTransformerç¼–ç å™¨å’Œè§£ç å™¨æ¥å¤„ç†å¤æ‚çš„CADæ„å»ºåºåˆ—ï¼Œè¿™å¢åŠ äº†æ¨¡å‹çš„å¤æ‚æ€§å’Œè®¡ç®—æˆæœ¬ã€‚ æ‹“æ‰‘å’Œå‡ ä½•çš„åˆ†ç¦»ï¼šè™½ç„¶è¿™ç§åˆ†ç¦»æœ‰åŠ©äºæé«˜æ§åˆ¶å’Œç”Ÿæˆå¤šæ ·æ€§ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹éš¾ä»¥å­¦ä¹ åˆ°æ‹“æ‰‘å’Œå‡ ä½•ä¹‹é—´çš„å¤æ‚å…³ç³»ã€‚ æœ‰é™çš„å»ºæ¨¡æ“ä½œï¼šSkexGenä¸»è¦å…³æ³¨è‰å›¾å’Œæ‹‰ä¼¸æ“ä½œï¼Œæœªæ¶‰åŠå…¶ä»–çš„CADå»ºæ¨¡æ“ä½œï¼Œå¦‚æ—‹è½¬ã€æ‰«æ ã€å¸ƒå°”è¿ç®—ç­‰ï¼Œé™åˆ¶äº†å…¶åº”ç”¨èŒƒå›´ï¼ˆä½†å¯ä»¥é€šè¿‡å¯¼å…¥CADå·¥å…·åç¼–è¾‘å®ç°å…¶ä»–CADå»ºæ¨¡æ“ä½œï¼‰ã€‚ 7.0.2 åˆ›æ–°ç‚¹ è‡ªå›å½’ç”Ÿæˆæ¨¡å‹ï¼šSkexGenæ˜¯ä¸€ä¸ªè‡ªå›å½’ç”Ÿæˆæ¨¡å‹ï¼Œèƒ½å¤Ÿç”Ÿæˆé«˜è´¨é‡å’Œå¤šæ ·åŒ–çš„CADæ„å»ºåºåˆ—ã€‚ è§£è€¦ç æœ¬ï¼šä½¿ç”¨äº†è§£è€¦ç æœ¬æ¶æ„ï¼Œåˆ†åˆ«ç¼–ç CADæ„å»ºåºåˆ—ä¸­çš„æ‹“æ‰‘ã€å‡ ä½•å’Œæ‹‰ä¼¸å˜åŒ–ï¼Œæé«˜äº†ç”¨æˆ·æ§åˆ¶å’Œè®¾è®¡ç©ºé—´çš„æ¢ç´¢æ•ˆç‡ã€‚ ","date":"2024-07-19","objectID":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/:7:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘ SkexGen: Autoregressive Generation of CAD Construction Sequences with Disentangled Codebooks","uri":"/posts/06.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0skexgen/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"1 æ‘˜è¦ ä½œè€…æå‡ºäº†ä¸€ç§CADçš„åˆ›æ–°ç”Ÿæˆæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å°†CADæ¨¡å‹çš„é«˜çº§è®¾è®¡æ¦‚å¿µè¡¨ç¤ºä¸ºä»å…¨å±€éƒ¨ä»¶æ’åˆ—åˆ°å±€éƒ¨æ›²çº¿å‡ ä½•çš„ä¸‰å±‚ç¥ç»ä»£ç çš„å±‚çº§æ ‘ï¼Œå¹¶ä¸”é€šè¿‡æŒ‡å®šç›®æ ‡è®¾è®¡çš„ä»£ç æ ‘æ¥æ§åˆ¶CADæ¨¡å‹çš„ç”Ÿæˆæˆ–å®Œæˆã€‚å…·ä½“è€Œè¨€ï¼Œä¸€ç§å¸¦æœ‰â€œæ©ç è·³è¿‡è¿æ¥â€çš„å‘é‡é‡åŒ–å˜åˆ†è‡ªç¼–ç å™¨(VAE)çš„æ–°å˜ä½“åœ¨ä¸‰ä¸ªå±‚æ¬¡ä¸Šæå–è®¾è®¡å˜åŒ–ä½œä¸ºç¥ç»ç æœ¬ã€‚ä¸¤é˜¶æ®µçš„çº§è”è‡ªå›å½’Transformerå­¦ä¹ ä»ä¸å®Œæ•´çš„CADæ¨¡å‹ç”Ÿæˆä»£ç æ ‘ï¼Œç„¶åæ ¹æ®é¢„æœŸè®¾è®¡å®ŒæˆCADæ¨¡å‹ã€‚å¹¿æ³›çš„å®éªŒè¡¨æ˜ï¼Œåœ¨æ— æ¡ä»¶ç”Ÿæˆç­‰ä¼ ç»Ÿä»»åŠ¡ä¸Šè¡¨ç°å‡ºä¼˜è¶Šæ€§èƒ½ï¼ŒåŒæ—¶åœ¨æ¡ä»¶ç”Ÿæˆä»»åŠ¡ä¸­å®ç°äº†æ–°é¢–çš„äº¤äº’èƒ½åŠ›ã€‚ ã€codeã€‘ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:1:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"2 å¼•è¨€ å¤§å¤šæ•°ç°ä»£CADè®¾è®¡å·¥å…·é‡‡ç”¨â€œè‰å›¾å’Œæ‹‰ä¼¸â€é£æ ¼çš„å·¥ä½œæµç¨‹ï¼Œä»¥è¿™ç§æ–¹å¼åˆ›å»ºçš„CADæ¨¡å‹å…·æœ‰è‡ªç„¶çš„æ ‘ç»“æ„ï¼Œæ”¯æŒå±€éƒ¨ç¼–è¾‘ã€‚æ ‘å¶å¤„çš„æ›²çº¿å¯ä»¥è°ƒæ•´å¹¶é‡æ–°ç”Ÿæˆæ‹‰ä¼¸ä»¥æ›´æ–°æœ€ç»ˆå½¢çŠ¶ã€‚å¯¹äºè®¾è®¡å¸ˆæ¥è¯´ï¼Œé‡è¦çš„æ˜¯ç¼–è¾‘è¦ä¿ç•™â€œè®¾è®¡æ„å›¾â€ã€‚è€Œè®¾è®¡æ„å›¾å®šä¹‰ä¹Ÿæœ‰ä¸åŒï¼š Oteyç­‰äººå°†è®¾è®¡æ„å›¾å®šä¹‰ä¸ºâ€œåœ¨ä¿®æ”¹æ—¶CADæ¨¡å‹çš„é¢„æœŸè¡Œä¸ºâ€ Martinæè¿°ä¸ºâ€œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œä½¿å¾—å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ›´æ”¹å¯ä»¥è‡ªåŠ¨ä¼ æ’­åˆ°å…¶ä»–å¯¹è±¡â€ã€‚ è™½ç„¶â€œè‰å›¾å’Œæ‹‰ä¼¸â€å…è®¸å±€éƒ¨æ›´æ”¹ï¼Œä½†å®ƒä¸æä¾›åœ¨ç¼–è¾‘æ¨¡å‹æ—¶ç»™å‡ºé¢„æœŸè¡Œä¸ºæ‰€éœ€çš„å…³ç³»ã€‚ä¸€ä¸ªèƒ½ç†è§£è®¾è®¡æ„å›¾çš„è®¡ç®—ç³»ç»Ÿå°†å½»åº•æ”¹å˜CADçš„å®è·µã€‚è¿™ç§ç³»ç»Ÿå¯ä»¥å¸®åŠ©è®¾è®¡å¸ˆåœ¨ï¼š æ ¹æ®é«˜çº§è®¾è®¡æ¦‚å¿µç”Ÿæˆå¤šæ ·åŒ–çš„CADæ¨¡å‹ï¼› åœ¨çº¦æŸæŸäº›æ¨¡å‹å±æ€§çš„æƒ…å†µä¸‹ä¿®æ”¹ç°æœ‰çš„CADæ¨¡å‹ï¼› äº¤äº’å¼åœ°è‡ªåŠ¨å®Œæˆè®¾è®¡ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚ ä½†ç›®å‰è¿˜æ²¡æœ‰è¿™æ ·çš„ç³»ç»Ÿï¼Œå½“å‰è¡Œä¸šæ ‡å‡†é€šè¿‡æ‰‹åŠ¨æŒ‡å®šå‚æ•°å’Œæ–¹ç¨‹ï¼Œä»¥å®šä¹‰è½®å»“çš„ä½ç½®å’Œå°ºå¯¸ï¼Œä»¥åŠç”¨äºå¯¹é½å‡ ä½•çš„çº¦æŸï¼Œè¿™ç§ç§°ä¸ºå‚æ•°åŒ–CADçš„è¿‡ç¨‹éœ€è¦ä¸“ä¸šæŠ€èƒ½ï¼Œå¹¶ä¸”åœ¨æ„å¤–ç¼–è¾‘æ—¶å¾ˆå®¹æ˜“å‡ºé”™ã€‚ä¸‹å›¾å±•ç¤ºäº†ç¼–è¾‘çº¦æŸä¸è‰¯çš„CADæ¨¡å‹çš„å‡ ä½•å½¢çŠ¶æ—¶åŸå§‹è®¾è®¡æ„å›¾è¢«ç ´åçš„ç¤ºä¾‹ã€‚ ç°æœ‰çš„å·¥ä½œå¹¶æœªåˆ©ç”¨CADè®¾è®¡çš„å±‚æ¬¡æ€§æ¥æä¾›æœ‰æ•ˆçš„è®¾è®¡æ§åˆ¶ã€‚ä½œè€…æå‡ºäº†ä¸€ç§æ–°é¢–çš„ç”Ÿæˆç½‘ç»œï¼Œå°†CADæ¨¡å‹çš„è®¾è®¡æ„å›¾æ•è·ä¸ºä»å±€éƒ¨å‡ ä½•ç‰¹å¾åˆ°å…¨å±€éƒ¨ä»¶æ’åˆ—çš„ä¸‰å±‚ç¥ç»ä»£ç æ ‘ï¼Œå¹¶æ ¹æ®ç¼–ç æ ‘æˆ–ä¸å®Œæ•´çš„CADæ¨¡å‹æŒ‡å®šçš„è®¾è®¡æ„å›¾æ§åˆ¶CADæ¨¡å‹çš„ç”Ÿæˆæˆ–å®Œæˆã€‚CADæ¨¡å‹ä»¥å»ºæ¨¡æ“ä½œçš„åºåˆ—å½¢å¼ç”Ÿæˆï¼Œç„¶åè½¬æ¢ä¸ºå·¥ä¸šæ ‡å‡†çš„è¾¹ç•Œè¡¨ç¤ºï¼ˆB-Repï¼‰æ ¼å¼ï¼Œä»¥ä¾¿åœ¨CADè½¯ä»¶ä¸­è¿›è¡Œç¼–è¾‘ã€‚ å…·ä½“æ¥è¯´ï¼Œä½œè€…æå‡ºäº†ä¸€ç§å¸¦æœ‰â€œæ©ç è·³è¿‡è¿æ¥â€çš„çŸ¢é‡é‡åŒ–VAEå˜ä½“ï¼Œä»å¤§è§„æ¨¡è‰å›¾å’Œæ‹‰ä¼¸CADæ•°æ®é›†ï¼ˆDeepCADæ•°æ®é›†ï¼‰ä¸­å­¦ä¹ è®¾è®¡å˜åŒ–å½¢æˆä¸‰ä¸ªç¥ç»ç æœ¬ã€‚æ©ç è·³è¿‡è¿æ¥ç®€å•ä½†æœ‰æ•ˆï¼Œå¯ä»¥æå–é«˜åº¦æŠ½è±¡çš„ç æœ¬ï¼Œä½¿ä»£ç ä¸ç”Ÿæˆçš„å‡ ä½•å½¢çŠ¶ä¹‹é—´çš„å…³ç³»å˜å¾—ç›´è§‚ã€‚ç„¶åï¼Œä¸¤é˜¶æ®µçº§è”è‡ªå›å½’Transformerå­¦ä¹ ç”Ÿæˆï¼š ç»™å®šä¸å®Œæ•´CADæ¨¡å‹çš„ä¸‰å±‚ä»£ç æ ‘ ç»™å®šç¼–ç æ ‘å’Œä¸å®Œæ•´æ•°æ®çš„å®Œæ•´CADæ¨¡å‹ è®¾è®¡å¸ˆè¿˜å¯ä»¥ç›´æ¥æä¾›ç¼–ç æ ‘ä»¥ç”Ÿæˆæ¨¡å‹ã€‚ ä¸å…¶ä»–ç”Ÿæˆbaselineçš„å®šæ€§å’Œå®šé‡è¯„ä¼°è¡¨æ˜ï¼Œåœ¨éšæœºç”Ÿæˆä»»åŠ¡ä¸­ï¼Œè¯¥ç³»ç»Ÿç”Ÿæˆäº†æ›´é€¼çœŸå’Œå¤æ‚çš„æ¨¡å‹ã€‚åœ¨ç”¨æˆ·æ§åˆ¶çš„æ¡ä»¶ç”Ÿæˆä»»åŠ¡ä¸­ï¼Œç³»ç»Ÿå±•ç¤ºäº†çµæ´»å’Œä¼˜è¶Šçš„å‡ ä½•æ§åˆ¶ï¼Œè¿™å¾—ç›Šäºå±‚æ¬¡ç¼–ç æ ‘è¡¨ç¤ºï¼Œä¼˜äºå½“å‰æœ€å…ˆè¿›çš„åŸºäºæ·±åº¦å­¦ä¹ çš„ç”Ÿæˆæ¨¡å‹ï¼ˆä¾‹å¦‚SkexGenï¼ŒDeepCADï¼‰ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬çš„è´¡çŒ®åŒ…æ‹¬ï¼š ç¼–ç å±‚æ¬¡è®¾è®¡æ¦‚å¿µçš„ç¥ç»ä»£ç æ ‘è¡¨ç¤ºï¼Œæ”¯æŒé«˜è´¨é‡å’Œå¤æ‚æ¨¡å‹çš„ç”Ÿæˆã€è®¾è®¡æ„å›¾æ„ŸçŸ¥çš„ç”¨æˆ·ç¼–è¾‘å’Œè®¾è®¡è‡ªåŠ¨å®Œæˆã€‚ å¸¦æœ‰æ©ç è·³è¿‡è¿æ¥çš„æ–°å‹å‘é‡é‡åŒ–å˜åˆ†è‡ªç¼–ç å™¨ï¼Œç”¨äºå¢å¼ºä»£ç ç°¿å­¦ä¹ ã€‚ åœ¨CADæ¨¡å‹ç”Ÿæˆæ–¹é¢ç›¸å¯¹äºä¹‹å‰çš„æœ€å…ˆè¿›æ–¹æ³•çš„æ€§èƒ½æå‡ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:2:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"3 ç›¸å…³å·¥ä½œ æ„é€ æ€§å®ä½“å‡ ä½•ï¼ˆCSGï¼‰ 3Då½¢çŠ¶ç”±å‚æ•°åŒ–åŸºå…ƒé€šè¿‡å¸ƒå°”è¿ç®—ç»„æˆçš„CSGæ ‘è¡¨è¾¾ã€‚è¿™ç§è½»é‡çº§è¡¨ç¤ºé€šè¿‡ç¨‹åºåˆæˆå’Œæ— ç›‘ç£å­¦ä¹ é‡å»ºCADå½¢çŠ¶ã€‚ä½†å‚æ•°åŒ–CADä»ä¸»å¯¼æœºæ¢°è®¾è®¡ï¼Œå¹¶ä¸”å¹¿æ³›ä½¿ç”¨è‰å›¾å’Œæ‹‰ä¼¸å»ºæ¨¡æ“ä½œã€‚ ç›´æ¥CADç”Ÿæˆ æœ€è¿‘ä¸€äº›å·¥ä½œä¸“æ³¨äºåœ¨æ²¡æœ‰ä»»ä½•CADå»ºæ¨¡åºåˆ—ç›‘ç£çš„æƒ…å†µä¸‹ç›´æ¥ç”ŸæˆCADæ¨¡å‹ã€‚ä½œè€…æ›´ä¸“æ³¨äºä»¥è‰å›¾å’Œæ‹‰ä¼¸åºåˆ—å½¢å¼è¿›è¡Œçš„å‚æ•°åŒ–CADçš„å¯æ§ç”Ÿæˆã€‚ è‰å›¾å’Œæ‹‰ä¼¸CADç”Ÿæˆ æœ€è¿‘å¤§è§„æ¨¡å‚æ•°åŒ–CADæ•°æ®é›†çš„å¯ç”¨æ€§ä½¿åŸºäºå­¦ä¹ çš„æ–¹æ³•èƒ½å¤Ÿåˆ©ç”¨CADå»ºæ¨¡åºåˆ—å†å²å’Œè‰å›¾çº¦æŸç”Ÿæˆå·¥ç¨‹è‰å›¾å’Œå®ä½“æ¨¡å‹ã€‚ç”Ÿæˆçš„åºåˆ—å¯ä»¥ç”¨å®ä½“å»ºæ¨¡å†…æ ¸è§£æï¼Œä»¥è·å¾—åŒ…å«2Då·¥ç¨‹è‰å›¾æˆ–3D CADå½¢çŠ¶çš„å¯ç¼–è¾‘å‚æ•°åŒ–CADæ–‡ä»¶ã€‚æ­¤å¤–ï¼Œç”Ÿæˆå¯ä»¥å—ç›®æ ‡B-repã€è‰å›¾ã€å›¾åƒã€ä½“ç´ ç½‘æ ¼æˆ–ç‚¹äº‘çš„å½±å“ã€‚ä½†è¿™ç§æ§åˆ¶æ˜¯å…¨å±€çº§åˆ«çš„ï¼Œè€Œä½œè€…æ—¨åœ¨æ”¯æŒè®¾è®¡ä¿æŒç¼–è¾‘å’Œè‡ªåŠ¨å®Œæˆç­‰åº”ç”¨ç¨‹åºçš„å…¨å±€å’Œå±€éƒ¨çº§åˆ«çš„å±‚æ¬¡æ§åˆ¶ã€‚ ç”¨æˆ·æ§åˆ¶çš„CADç”Ÿæˆ æä¾›ç”¨æˆ·å¯¹ç”Ÿæˆè¿‡ç¨‹çš„æ§åˆ¶ï¼ŒåŒæ—¶ä¿æŒè®¾è®¡æ„å›¾ï¼Œæ˜¯ç”Ÿæˆæ¨¡å‹åœ¨å®é™…CADè½¯ä»¶ä¸­é‡‡ç”¨çš„å…³é”®ã€‚å°½ç®¡ä»¥å‰çš„æ–¹æ³•å¯ä»¥åŸºäºé«˜çº§æŒ‡å¯¼ç”Ÿæˆå¤šæ ·åŒ–çš„å½¢çŠ¶ï¼Œä½†ä½¿ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶ç”Ÿæˆè¿‡ç¨‹æ›´å…·æŒ‘æˆ˜æ€§ã€‚Sketch2CADå’ŒFree2CADä¸“æ³¨äºè®¾è®¡è¿‡ç¨‹çš„å±€éƒ¨æ§åˆ¶ï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„è¾“å…¥ã€‚æœ€è¿‘çš„ä¸€äº›å·¥ä½œè¿˜åˆ©ç”¨æ–‡æœ¬æç¤ºå’Œç”¨æˆ·æŒ‡å®šçš„æŒ‡å¯¼ã€‚SkexGenå…è®¸ç”¨æˆ·é€šè¿‡è§£è€¦å…¨å±€æ§åˆ¶CADå½¢çŠ¶çš„æ‹“æ‰‘å’Œå‡ ä½•æ¥æ¢ç´¢è®¾è®¡å˜åŒ–ã€‚ç„¶è€Œï¼Œå…¶æ–¹æ³•ä»…æœ‰åŠ©äºä»é›¶å¼€å§‹åˆ›å»ºæ–°è®¾è®¡ï¼Œæ— æ³•è½»æ˜“ä¿®æ”¹ä»¥æä¾›ç”¨æˆ·æœŸæœ›çš„æ™ºèƒ½ç¼–è¾‘CADæ¨¡å‹æˆ–è‡ªåŠ¨å®Œæˆä¸‹ä¸€æ­¥æ“ä½œçš„äº¤äº’ä½“éªŒã€‚ä¸ç°æœ‰å·¥ä½œä¸åŒï¼Œä½œè€…çš„æ–¹æ³•åˆ©ç”¨CADæ¨¡å‹å†…éƒ¨å­˜åœ¨çš„è‡ªç„¶å±‚æ¬¡ç»“æ„ï¼Œæä¾›å¯¹ç”Ÿæˆè¿‡ç¨‹çš„å…¨å±€å’Œå±€éƒ¨æ§åˆ¶ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:3:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"4 å±‚æ¬¡CADå±æ€§ è‰å›¾å’Œæ‹‰ä¼¸çš„CADæ¨¡å‹å…·æœ‰è‡ªç„¶çš„å±‚æ¬¡ç»“æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å…¶ä¸­ä¸€ä¸ªç¯å®šä¹‰äº†ä¸€æ¡å°é—­çš„æ›²çº¿è·¯å¾„ï¼Œä¸€ä¸ªè½®å»“åœ¨è‰å›¾å¹³é¢å†…ç”±ä¸€ä¸ªå¤–ç¯å’Œä¸€äº›å†…ç¯é™å®šäº†ä¸€ä¸ªå°é—­åŒºåŸŸï¼Œè€Œä¸€ä¸ªå®ä½“åˆ™è¡¨ç¤ºä¸€ç»„æ‹‰ä¼¸çš„è½®å»“ç»„åˆæˆæ•´ä¸ªæ¨¡å‹ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®ç°åœ¨ç”ŸæˆCADæ¨¡å‹æ—¶çš„å±€éƒ¨å’Œå…¨å±€æ§åˆ¶ï¼Œå³ç”¨æˆ·å¯ä»¥ç¼–è¾‘ä»»ä½•ä¸€ä¸ªå®ä½“ï¼Œå¹¶æœŸæœ›å…¶ä½™éƒ¨åˆ†è‡ªåŠ¨è¿›è¡Œåˆç†çš„æ›´æ–°ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬åœ¨ç¥ç»ç½‘ç»œçš„æ½œåœ¨ç©ºé—´ä¸­æ•æ‰è¿™ç§å±‚æ¬¡ç»“æ„ã€‚åœ¨å±‚æ¬¡ç»“æ„çš„è¾ƒé«˜å±‚ä¸Šï¼Œç½‘ç»œå­¦ä¹ è¾ƒä½å±‚æ¬¡å‡ ä½•å®ä½“çš„ç›¸å¯¹ä½ç½®ï¼Œå³æ„æˆæ¨¡å‹çš„è½®å»“å’Œæ‹‰ä¼¸çš„è¾¹ç•Œæ¡†ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†CADæ¨¡å‹è§†ä¸ºä¸€ä¸ªå®å¿ƒï¼ˆSï¼‰â€”è½®å»“ï¼ˆPï¼‰â€”ç¯ï¼ˆLï¼‰æ ‘ï¼š ç¯ï¼ˆLï¼‰ ï¼šåœ¨æ ‘çš„å¶å­ä¸Šï¼Œæˆ‘ä»¬æœ‰ç¯ã€‚æ¯ä¸ªç¯ç”±ä¸€ç»„çº¿å’Œå¼§æˆ–ä¸€ä¸ªåœ†ç»„æˆã€‚ç¯ï¼ˆLï¼‰çš„å±æ€§å®šä¹‰ä¸ºä¸€ç³»åˆ—ç”±ç‰¹æ®Š$\\text{\u003cSEP\u003e}$ tokenåˆ†éš”çš„x-yåæ ‡ï¼š $$ L = {(x_1, y_1), (x_2, y_2), \\text{\u003cSEP\u003e}, (x_3, y_3), \\ldots}. $$ çº¿ç”±ä¸¤ä¸ªç‚¹ï¼ˆèµ·ç‚¹å’Œç»ˆç‚¹ï¼‰çš„xyåæ ‡è¡¨ç¤ºï¼›å¼§ç”±ä¸‰ä¸ªç‚¹è¡¨ç¤ºï¼ŒåŒ…æ‹¬èµ·ç‚¹ã€ä¸­ç‚¹å’Œç»ˆç‚¹ï¼›åœ†ç”±æ›²çº¿ä¸Šå››ä¸ªå‡åŒ€åˆ†å¸ƒçš„ç‚¹è¡¨ç¤ºã€‚ä½¿ç”¨è¿™ç§è¡¨ç¤ºæ³•ï¼Œå¯ä»¥é€šè¿‡ç‚¹çš„æ•°é‡è¯†åˆ«æ›²çº¿ç±»å‹ã€‚æˆ‘ä»¬å¯¹ç¯ä¸­çš„æ›²çº¿è¿›è¡Œæ’åºï¼Œä½¿å¾—åˆå§‹æ›²çº¿æ˜¯èµ·ç‚¹åæ ‡æœ€å°çš„æ›²çº¿ï¼Œä¸‹ä¸€æ¡æ˜¯ä¸å…¶é€†æ—¶é’ˆæ–¹å‘ç›¸è¿çš„æ›²çº¿ã€‚ è½®å»“ï¼ˆPï¼‰ï¼šè½®å»“ä½äºå¶å­å±‚ä¹‹ä¸Šã€‚ç”±äºç¯çš„å‡ ä½•ç»“æ„åœ¨å¶å­å±‚æ•æ‰ï¼Œè½®å»“èŠ‚ç‚¹çš„å±æ€§å®šä¹‰ä¸ºè‰å›¾å¹³é¢å†…ç¯çš„äºŒç»´è¾¹ç•Œæ¡†å‚æ•°ç³»åˆ—ï¼š $$ P = {(x_i, y_i, w_i, h_i)}_{i=1}^{N^{\\text{loop}}_i}. $$ å…¶ä¸­$i$æ˜¯è½®å»“å†…$N^{\\text{loop}}_i$ä¸ªç¯çš„ç´¢å¼•ã€‚$(x_i, y_i)$æ˜¯è¾¹ç•Œæ¡†çš„å·¦ä¸‹è§’ï¼Œ$(w_i, h_i)$æ˜¯å®½åº¦å’Œé«˜åº¦ã€‚æˆ‘ä»¬é€šè¿‡å¯¹æ‰€æœ‰äºŒç»´è¾¹ç•Œæ¡†çš„å·¦ä¸‹è§’è¿›è¡Œå‡åºæ’åºæ¥ç¡®å®šè½®å»“$P$ä¸­è¾¹ç•Œæ¡†å‚æ•°çš„é¡ºåºã€‚ å®ä½“ï¼ˆSï¼‰ï¼šåœ¨è½®å»“å±‚ä¹‹ä¸Šï¼Œæˆ‘ä»¬æœ‰é€šè¿‡æ‹‰ä¼¸ä¸€ä¸ªæˆ–å¤šä¸ªè½®å»“å½¢æˆçš„ä¸‰ç»´å®ä½“æ¨¡å‹ã€‚å®ä½“èŠ‚ç‚¹çš„å±æ€§æ•è·æ‹‰ä¼¸è½®å»“çš„æ’åˆ—ï¼Œä½¿ç”¨ä¸€ç³»åˆ—ä¸‰ç»´è¾¹ç•Œæ¡†å‚æ•°ï¼š $$ S = {(x_j, y_j, z_j, w_j, h_j, d_j)}_{j=1}^{N^{\\text{profile}}_j}. $$ å…¶ä¸­$j$æ˜¯æ¨¡å‹ä¸­$N^{\\text{profile}}_j$ä¸ªæ‹‰ä¼¸è½®å»“çš„ç´¢å¼•ã€‚$(x_j, y_j, z_j)$æ˜¯è¾¹ç•Œæ¡†çš„å·¦ä¸‹è§’ï¼Œ$(w_j, h_j, d_j)$æ˜¯å…¶å°ºå¯¸ã€‚åŒæ ·ï¼Œ$S$ä¸­çš„å‚æ•°æŒ‰æ‰€æœ‰æ‹‰ä¼¸çš„ä¸‰ç»´è¾¹ç•Œæ¡†çš„å·¦ä¸‹è§’è¿›è¡Œå‡åºæ’åºã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:4:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5 ä¸‰å±‚ç æœ¬å­¦ä¹  ç»™å®šä¸€ä¸ªä»¥S-P-Læ ‘æ ¼å¼è¡¨ç¤ºçš„è‰å›¾å’Œæ‹‰ä¼¸CADæ¨¡å‹æ•°æ®é›†ï¼Œä¸€ç§æ–°çš„å‘é‡é‡åŒ–VAEï¼ˆVQ-VAEï¼‰å˜ä½“å­¦ä¹ å®ƒä»¬çš„æ½œåœ¨æ¨¡å¼ï¼Œä½œä¸ºä¸‰ä¸ªç¦»æ•£çš„ç æœ¬ï¼Œè¿™äº›ç æœ¬å°†CADæ¨¡å‹ç¼–ç ä¸ºä¸€æ£µç¥ç»ç æ ‘ï¼Œç”¨äºä¸‹æ¸¸åº”ç”¨ã€‚ éµå¾ªSkexGenï¼Œæˆ‘ä»¬ç”¨äºå­¦ä¹ ç æœ¬çš„æ¶æ„åŸºç¡€æ˜¯ä¸€ä¸ªVQ-VAEï¼Œç”±ä¸€ä¸ªTransformerç¼–ç å™¨$E$å’Œè§£ç å™¨$D$ç»„æˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æˆ‘ä»¬ç‹¬ç«‹å­¦ä¹ Lã€På’ŒSçš„ç æœ¬ã€‚ä¸SkexGenå’Œä¹‹å‰çš„æ©ç å­¦ä¹ å·¥ä½œä¸åŒï¼Œæˆ‘ä»¬åœ¨ä»ç¼–ç å™¨è¾“å…¥åˆ°è§£ç å™¨è¾“å…¥çš„è·³è¿‡è¿æ¥ä¸Šåº”ç”¨æ©ç ã€‚ç›´è§‚æ¥è¯´ï¼Œä¸€ä¸ªæ ‡å‡†çš„VQ-VAEï¼ˆå³æ²¡æœ‰è·³è¿‡è¿æ¥ï¼‰è¢«è®­ç»ƒç”¨æ¥æ¢å¤å®ä¾‹ç‰¹å®šçš„è¾“å…¥ç»†èŠ‚ï¼Œè¿™å¯¹äºæ­£åœ¨å­¦ä¹ å®ä¾‹æ— å…³è®¾è®¡æ¨¡å¼çš„é‡åŒ–ç æ¥è¯´æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚ä¸€ä¸ªå¤©çœŸçš„è·³è¿‡è¿æ¥å…è®¸è§£ç å™¨é€šè¿‡ç›´æ¥å¤åˆ¶è¾“å…¥æ¥ä½œå¼Šã€‚æ©ç è·³è¿‡è¿æ¥è¿«ä½¿è§£ç å™¨ä»æœªæ©ç å…ƒç´ ä¸­å…³è”éƒ¨åˆ†ç»†èŠ‚å’Œå¡«è¡¥ç¼ºå¤±éƒ¨åˆ†ï¼Œå…¶ä¸­å…³ç³»ç”±ç¼–ç åœ¨ç ä¸­çš„è®¾è®¡æ¨¡å¼å¼•å¯¼ã€‚ ç¼–ç å™¨ï¼š è€ƒè™‘ä¸€ä¸ª$L$ï¼ˆæ–¹ç¨‹1ï¼‰ï¼ŒåŒ…å«ä¸€ç³»åˆ—çš„x-yåæ ‡å’Œç‰¹æ®Šçš„$\\text{\u003cSEP\u003e}$ tokenã€‚æˆ‘ä»¬ä½¿ç”¨65ç»´çš„ç‹¬çƒ­å‘é‡æ¥è¡¨ç¤ºä¸€ä¸ªtokenï¼Œå…¶ä¸­ä¸€ä¸ªåæ ‡è¢«é‡åŒ–ä¸º6ä½ï¼ˆå³64ç»´ï¼‰ï¼Œ$\\text{\u003cSEP\u003e}$éœ€è¦ä¸€ä¸ªé¢å¤–çš„ç»´åº¦ã€‚è®¾$T^E_t$è¡¨ç¤ºTransformerç¼–ç å™¨çš„ç¬¬$t$ä¸ªtokençš„256ç»´åµŒå…¥ã€‚åµŒå…¥åˆå§‹åŒ–ä¸ºï¼š $$ T_t^E\\leftarrow\\begin{cases}\\text{MLP}(W_\\text{emb}x_t\\parallel W_\\text{emb}y_t)+\\gamma_t\\quad\\text{(for x-y)},\\\\text{MLP} (W_\\text{emb}\u003c\\text{SEP}\u003e\\parallel W_\\text{emb}\u003c\\text{SEP}\u003e)+ \\gamma_t.\\end{cases} $$ $W_\\text{emb}$æ˜¯ä¸€ä¸ª$65\\times 32$çš„tokenåµŒå…¥çŸ©é˜µã€‚$\\parallel$æ˜¯æ‹¼æ¥è¿ç®—ç¬¦ã€‚$\\text{MLP}$æ˜¯ä¸€ä¸ªä¸¤å±‚çš„å¤šå±‚æ„ŸçŸ¥å™¨ã€‚$\\gamma_t$æ˜¯ä¸€ä¸ªå¯å­¦ä¹ çš„256ç»´ä½ç½®åµŒå…¥ã€‚ç¬¬äºŒç§æƒ…å†µæ˜¯å¯¹äº$\\text{\u003cSEP\u003e}$ï¼Œå…¶å€¼é‡å¤ä¸¤æ¬¡ã€‚å¯¹äºPå’ŒSï¼Œæˆ‘ä»¬å¤„ç†æ¯ä¸ªäºŒç»´æˆ–ä¸‰ç»´è¾¹ç•Œæ¡†å‚æ•°çš„æ–¹å¼ä¸$x_t, y_t$åæ ‡ç›¸åŒï¼Œä½†æ²¡æœ‰$\\text{\u003cSEP\u003e}$ tokenã€‚ å‘é‡é‡åŒ–ï¼š ç¼–ç å™¨$E$çš„è¾“å‡ºï¼Œåºåˆ—é•¿åº¦ä¸º$T$ï¼Œé¦–å…ˆè¿›è¡Œå¹³å‡æ± åŒ–ï¼Œå½¢æˆ$\\overline{E}(T^E)$ã€‚ç„¶ååº”ç”¨æ ‡å‡†çš„å‘é‡é‡åŒ–ç¨‹åºæ¥è·å¾—ä¸€ä¸ª256ç»´çš„ç æœ¬å‘é‡$c$ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬æ¯”è¾ƒç æœ¬å‘é‡$\\mathbf{b}$å’Œç¼–ç çš„$\\overline{E}(T^E)$ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œå¹¶æ‰§è¡Œæœ€è¿‘é‚»æŸ¥æ‰¾ã€‚ $$ \\mathbf{c}\\leftarrow\\mathbf{b}_k,\\quad\\text{where}\\quad k=\\mathrm{argmin}_i\\left|\\left|\\overline{E}(T^E)-\\mathbf{b}_i\\right|\\right|^2. $$ å¸¦æ©ç è·³è¿‡è¿æ¥çš„è§£ç å™¨ï¼š è§£ç å™¨æ¥æ”¶é‡åŒ–ç $c$å’Œæ©ç çš„x-yåæ ‡å’Œ$\\text{\u003cSEP\u003e}$ tokenåºåˆ—ï¼Œå¹¶é¢„æµ‹è¢«æ©ç çš„tokenã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç¯èŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼Œä»»ä½•$x_t, y_t$å’Œ$\\text{\u003cSEP\u003e}$ tokenéƒ½å¯ä»¥è¢«æ©ç ï¼ˆå…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªæ¨¡å‹éšæœºæ©ç 30%åˆ°70%çš„tokenï¼‰ã€‚è®¾$T^D_t$è¡¨ç¤ºä¸ºè§£ç å™¨è¾“å…¥çš„ç¬¬$t$ä¸ªtokençš„åµŒå…¥ã€‚æ¯ä¸ªtokençš„åµŒå…¥æ–¹å¼ä¸ç¼–ç å™¨åµŒå…¥æ–¹ç¨‹å®Œå…¨ç›¸åŒï¼Œåªæ˜¯è¢«æ©ç çš„tokençš„åµŒå…¥è¢«ä¸€ä¸ªå¯å­¦ä¹ çš„å…±äº«32ç»´æ©ç tokenåµŒå…¥$m$å–ä»£ã€‚æ¥è‡ªç¼–ç å™¨çš„256ç»´ç æœ¬å‘é‡$c$ä¸${T^D_t}$æ‹¼æ¥åœ¨ä¸€èµ·å¹¶ä¼ é€’ç»™è§£ç å™¨$D$ï¼Œè§£ç å™¨æœ‰å››ä¸ªè‡ªæ³¨æ„åŠ›å±‚ã€‚è¿™é‡Œçš„æ€æƒ³æ˜¯è¿«ä½¿ç¼–ç å™¨å­¦ä¹ æœ‰ç”¨çš„æ½œåœ¨ç‰¹å¾ï¼Œå¯ä»¥å¸®åŠ©è§£ç å™¨é¢„æµ‹è¢«æ©ç çš„tokenã€‚æœ€åï¼Œåœ¨è§£ç å™¨åå¯¹æ¯ä¸ªtokenåµŒå…¥ï¼ˆé™¤äº†ç æœ¬å‘é‡ï¼‰åº”ç”¨ä¸€ä¸ªMLPï¼Œä»¥ç”Ÿæˆ(2 Ã— 65)ç»´çš„logitsï¼Œå³ä¸€å¯¹åœ¨65ç±»æ ‡ç­¾ä¸Šçš„æ¦‚ç‡å€¼ï¼Œåˆ†åˆ«ç”¨äºé¢„æµ‹xyåæ ‡æˆ–$\\text{\u003cSEP\u003e}$ tokenã€‚ æŸå¤±å‡½æ•°ï¼š è®­ç»ƒæŸå¤±ç”±ä¸‰é¡¹ç»„æˆï¼š $$ \\begin{aligned}\u0026\\sum_{t}\\mathrm{EMD}\\Big(D(\\mathbf{c},{T_{t}^{D}}) , \\mathbb{1}_{T_{t}}\\Big)+\\\u0026\\left|\\left|sg[\\overline{E}(T^{E})]-\\mathbf{c}\\right|\\right|_{2}^{2}+\\beta\\left|\\left|\\overline{E}(T^{E})-sg[\\mathbf{c}]\\right|\\right|_{2}^{2}.\\end{aligned} $$ ç¬¬ä¸€é¡¹æ˜¯è§£ç å™¨è¾“å‡ºæ¦‚ç‡å’Œç›¸åº”æ•°æ®å±æ€§çš„ç‹¬çƒ­ç¼–ç $\\mathbb{1}_{T_t}$ä¹‹é—´çš„å¹³æ–¹EMDæŸå¤±ã€‚æŸå¤±ä»…åº”ç”¨äºè¢«æ©ç çš„tokenã€‚æˆ‘ä»¬ä½¿ç”¨çš„EMDæŸå¤±å‡½æ•°ï¼Œè¯¥å‡½æ•°å‡è®¾æœ‰åºçš„ç±»æ ‡ç­¾ï¼Œå¹¶å¯¹æ¥è¿‘çœŸå®å€¼çš„é¢„æµ‹è¿›è¡Œè¾ƒå°‘çš„æƒ©ç½šã€‚è¿™æ¯”äº¤å‰ç†µæŸå¤±æ›´å¥½ï¼Œå› ä¸ºx-yåæ ‡æºå¸¦è·ç¦»å…³ç³»ï¼Œä½¿å¾—æŸå¤±å¯ä»¥é›†ä¸­åœ¨è¿œç¦»çœŸå®å€¼çš„é¢„æµ‹ä¸Šã€‚æ³¨æ„ï¼Œæˆ‘ä»¬å¯¹ç¯æ•°æ®å±æ€§ä¸­çš„$\\text{\u003cSEP\u003e}$ tokenå¤„ç†ä¸åŒï¼Œåº”ç”¨æ ‡å‡†çš„äº¤å‰ç†µæŸå¤±ï¼Œå› ä¸ºè¿™ä¸æ˜¯ä¸€ä¸ªæœ‰åºç±»æ ‡ç­¾ã€‚ ç¬¬äºŒå’Œç¬¬ä¸‰é¡¹æ˜¯VQ-VAEä¸­ä½¿ç”¨çš„ç æœ¬å’Œæ‰¿è¯ºæŸå¤±ã€‚$sg$è¡¨ç¤ºåœæ­¢æ¢¯åº¦æ“ä½œï¼Œåœ¨å‰å‘ä¼ æ’­ä¸­æ˜¯æ’ç­‰å‡½æ•°ï¼Œä½†åœ¨åå‘ä¼ æ’­ä¸­é˜»æ­¢æ¢¯åº¦ã€‚$\\beta$ç¼©æ”¾æ‰¿è¯ºæŸå¤±ï¼Œè®¾ä¸º$0.25$ã€‚æˆ‘ä»¬ä½¿ç”¨è¡°å‡ç‡ä¸º$0.99$çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡æ›´æ–°ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:5:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"6 å¯æ§CADç”Ÿæˆ ç¯ã€è½®å»“å’Œå®ä½“ç æœ¬ä½¿æˆ‘ä»¬èƒ½å¤Ÿå°†CADæ¨¡å‹çš„è®¾è®¡æ¦‚å¿µè¡¨è¾¾ä¸ºå±‚æ¬¡åŒ–çš„ç¥ç»ä»£ç ï¼Œä»è€Œå®ç°å¤šæ ·åŒ–å’Œé«˜è´¨é‡çš„ç”Ÿæˆã€æ–°é¢–çš„ç”¨æˆ·æ§åˆ¶ä»¥æŒ‡å®šè®¾è®¡æ„å›¾ï¼Œä»¥åŠè‡ªåŠ¨å®Œæˆä¸å®Œæ•´çš„CADæ¨¡å‹ã€‚å…·ä½“æ¥è¯´ï¼Œç»™å®šä¸€ä¸ªä¸å®Œæ•´çš„CADæ¨¡å‹ä½œä¸ºè‰å›¾å’Œæ‹‰ä¼¸æ„å»ºåºåˆ—ï¼š æ¨¡å‹ç¼–ç å™¨å°†è¾“å…¥åºåˆ—è½¬æ¢ä¸ºæ½œåœ¨åµŒå…¥ï¼› è‡ªå›å½’Transformeræ ¹æ®åµŒå…¥çš„è¾“å…¥åºåˆ—ç”Ÿæˆä»£ç æ ‘ï¼› ç¬¬äºŒä¸ªè‡ªå›å½’Transformeræ ¹æ®åµŒå…¥çš„è¾“å…¥åºåˆ—å’Œä»£ç æ ‘ç”Ÿæˆå®Œæ•´çš„CADæ¨¡å‹ã€‚ æ¨¡å‹ç¼–ç å™¨ï¼š æ¨¡å‹ç¼–ç å™¨çš„ä¸»ä½“æ˜¯æ ‡å‡†çš„Transformerç¼–ç å™¨æ¨¡å—ï¼Œå…·æœ‰6ä¸ªè‡ªæ³¨æ„åŠ›å±‚ã€‚æˆ‘ä»¬å€Ÿç”¨äº†SkexGenä¸­ä½¿ç”¨çš„æ ¼å¼ï¼Œå¹¶å°†æ¨¡å‹è¡¨ç¤ºä¸ºä¸€ä¸ªtokenåºåˆ—ï¼Œæ¯ä¸ªtokenæ˜¯ä¸€ä¸ªç‹¬çƒ­å‘é‡ï¼Œå”¯ä¸€ç¡®å®šä¸€ä¸ªæ›²çº¿ç±»å‹ã€é‡åŒ–æ›²çº¿å‚æ•°å’Œé‡åŒ–æ‹‰ä¼¸å‚æ•°ã€‚ç¼–ç å™¨å°†ç‹¬çƒ­å‘é‡è½¬æ¢ä¸ºä¸€ç³»åˆ—256ç»´çš„æ½œåœ¨åµŒå…¥${T^E_t}$ã€‚ ç¼–ç æ ‘ç”Ÿæˆå™¨ï¼š $G_\\text{code}$æ˜¯ä¸€ä¸ªè‡ªå›å½’è§£ç å™¨ï¼Œå®ƒç”Ÿæˆä»£ç çš„å±‚æ¬¡ç»“æ„${T^C_t}$ã€‚æ¯ä¸ªå®ä½“ã€è½®å»“æˆ–ç¯ä»ç›¸åº”çš„ç æœ¬ä¸­åˆ†é…ä¸€ä¸ªä»£ç ï¼Œæ¡ä»¶æ˜¯ç¼–ç çš„åµŒå…¥${T^E_t}$ã€‚ç±»ä¼¼äºå±‚æ¬¡å±æ€§è¡¨ç¤ºï¼Œå±‚æ¬¡ä»£ç è¡¨ç¤ºä¸ºä¸€ç³»åˆ—ç‰¹å¾å‘é‡ï¼ŒæŒ‡ç¤ºä»£ç æˆ–åˆ†éš”tokenã€‚å…·ä½“æ¥è¯´ï¼Œä¸€ä¸ªç‰¹å¾æ˜¯ä¸€ä¸ªç‹¬çƒ­å‘é‡ï¼Œå…¶å¤§å°æ˜¯ä¸‰ä¸ªç æœ¬ä¸­ä»£ç çš„æ€»æ•°åŠ ä¸Šä¸€ä¸ªåˆ†éš”ç¬¦ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸Šå›¾ç¤ºä¾‹ä¸­çš„ä»£ç æ ‘ï¼ŒåŒ…å«ä¸€ä¸ªå®ä½“ã€ä¸¤ä¸ªè½®å»“å’Œä¸¤ä¸ªæˆ–å››ä¸ªç¯ã€‚è¿™ä¸ªæ ‘çš„ç‰¹å¾è¡¨ç¤ºä¸º$[S, \\text{\u003cSEP\u003e}, P, L, L, \\text{\u003cSEP\u003e}, P, L, L, L, L]$ã€‚è¿™é‡Œæˆ‘ä»¬æ‰§è¡Œç¥ç»ä»£ç æ ‘çš„æ·±åº¦ä¼˜å…ˆéå†ï¼Œè¾¹ç•Œå‘½ä»¤$\\text{\u003cSEP\u003e}$ç”¨äºæŒ‡ç¤ºè½®å»“å’Œç¯ä»£ç çš„æ–°åˆ†ç»„ã€‚ $G_\\text{code}$æœ‰6ä¸ªè‡ªæ³¨æ„åŠ›ï¼ˆSAï¼‰å±‚ä¸6ä¸ªäº¤å‰æ³¨æ„åŠ›ï¼ˆCAï¼‰å±‚äº¤æ›¿ã€‚ç¬¬ä¸€ä¸ªSAå±‚æ˜¯åœ¨æŸ¥è¯¢token${T^{\\bar{C}}_t}$ä¸Šï¼Œæ¯ä¸ªæŸ¥è¯¢tokenç”±ä½ç½®ç¼–ç $\\gamma_t$åˆå§‹åŒ–å¹¶è‡ªå›å½’ä¼°è®¡ã€‚æ¯ä¸ªCAå±‚çš„è¾“å…¥æ˜¯${T^E_t}$ã€‚æ¯ä¸ªSAæˆ–CAå±‚éƒ½æœ‰8ä¸ªå¤´çš„æ³¨æ„åŠ›ï¼Œéšåæ˜¯ä¸€ä¸ªAdd-Normå±‚ã€‚ä¸€ä¸ªæŸ¥è¯¢token ${T^{\\bar{c}}_t}$å°†æœ‰ä¸€ä¸ªç”Ÿæˆçš„ä»£ç ç´¢å¼•ï¼Œè¯¥ç´¢å¼•è½¬æ¢ä¸ºä¸€ä¸ªä»£ç ${T^C_t}$ã€‚åˆ†éš”ç¬¦è¢«ä¸€ä¸ªå¯å­¦ä¹ çš„åµŒå…¥å–ä»£ã€‚ Codebookè¡¨ç¤ºä»ä»£ç ç´¢å¼•åˆ°ä»£ç çš„æ˜ å°„ã€‚æˆ‘ä»¬ä½¿ç”¨æ ‡å‡†çš„äº¤å‰ç†µæŸå¤±è®­ç»ƒ$G_\\text{code}$ã€‚æ³¨æ„ï¼Œå¯¹äºæ— æ¡ä»¶ç”Ÿæˆï¼Œæˆ‘ä»¬åˆ é™¤éƒ¨åˆ†CADæ¨¡å‹ç¼–ç å™¨ï¼Œå¹¶ä»…ä½¿ç”¨æŸ¥è¯¢token ${T^{\\bar{C}}_t}$è®­ç»ƒSAå±‚ï¼Œæ²¡æœ‰äº¤å‰æ³¨æ„åŠ›å±‚å’Œ${T^E_t}$ã€‚ æ¨¡å‹ç”Ÿæˆå™¨ï¼š æ¨¡å‹ç”Ÿæˆå™¨æ˜¯ç¬¬äºŒä¸ªè‡ªå›å½’è§£ç å™¨$G_\\text{cad}$ï¼Œç”Ÿæˆä¸€ä¸ªè‰å›¾å’Œæ‹‰ä¼¸çš„CADæ¨¡å‹ã€‚$G_\\text{cad}$ä¸SkexGenè§£ç å™¨ç›¸åŒï¼Œä¸åŒçš„æ˜¯éƒ¨åˆ†CADæ¨¡å‹åµŒå…¥${T^E_t}$å’Œå±‚æ¬¡ç¥ç»ä»£ç ${T^C_t}$é€šè¿‡äº¤å‰æ³¨æ„åŠ›å±‚æ§åˆ¶ç”Ÿæˆï¼Œè€ŒSkexGenä»…å…è®¸å…¨å±€ä»£ç çš„æŒ‡å®šã€‚æ¶æ„è§„æ ¼ä¸ç¬¬ä¸€ä¸ªè§£ç å™¨ç›¸åŒã€‚æŸ¥è¯¢token ($T^\\text{out}_t$)åŒ…å«ç”Ÿæˆçš„CADå‘½ä»¤åºåˆ—ä½œä¸ºç‹¬çƒ­å‘é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„æ ‡å‡†äº¤å‰ç†µæŸå¤±ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:6:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"7 å®éªŒ æœ¬èŠ‚å±•ç¤ºäº†æ— æ¡ä»¶å’Œæœ‰æ¡ä»¶ç”Ÿæˆçš„ç»“æœï¼Œè¯æ˜äº†ä»¥ä¸‹å‡ ç‚¹ï¼š ç›¸è¾ƒäºå½“å‰æœ€å…ˆè¿›çš„æŠ€æœ¯ï¼Œç”Ÿæˆçš„è´¨é‡æ›´é«˜ã€ç§ç±»æ›´å¤šã€å¤æ‚æ€§æ›´å¼ºï¼› é€šè¿‡å±‚æ¬¡åŒ–ç¥ç»ä»£ç å®ç°å¯æ§ç”Ÿæˆï¼› ä¸¤ä¸ªé‡è¦åº”ç”¨ï¼Œç”¨æˆ·ç¼–è¾‘å’Œè‡ªåŠ¨è¡¥å…¨ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:7:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"7.1 å®éªŒè®¾ç½® æ•°æ®é›†: ä½¿ç”¨å¤§è§„æ¨¡DeepCADæ•°æ®é›†ï¼ŒåŒ…å«178,238ä¸ªè‰å›¾åŠæ‹‰ä¼¸æ¨¡å‹ï¼ŒæŒ‰90%è®­ç»ƒã€5%éªŒè¯ã€5%æµ‹è¯•åˆ’åˆ†ã€‚å»é™¤é‡å¤æ¨¡å‹å’Œå±æ€§ï¼Œå¹¶é™åˆ¶è®­ç»ƒæ¨¡å‹çš„å¤æ‚åº¦ï¼ˆæœ€å¤š5ä¸ªå®ä½“ã€20ä¸ªç¯/è½®å»“ã€60æ¡æ›²çº¿/ç¯ã€200ä¸ªå‘½ä»¤/åºåˆ—ï¼‰ï¼Œæœ€ç»ˆè®­ç»ƒé›†åŒ…å«102,114ä¸ªå®ä½“ã€60,584ä¸ªè½®å»“ã€150,158ä¸ªç¯å’Œ124,451ä¸ªè‰å›¾å’Œæ‹‰ä¼¸åºåˆ—ç”¨äºCADæ¨¡å‹è®­ç»ƒã€‚å¯¹äºCADå·¥ç¨‹å›¾ï¼Œæˆ‘ä»¬éµå¾ªSkexGenå¹¶ä»DeepCADä¸­æå–è‰å›¾ã€‚åœ¨ç§»é™¤é‡å¤åï¼Œå…±æœ‰99,650ä¸ªè‰å›¾ç”¨äºè®­ç»ƒã€‚ å®æ–½ç»†èŠ‚: åœ¨Nvidia RTX A6000 GPUä¸Šè®­ç»ƒï¼Œæ‰¹æ¬¡å¤§å°256ã€‚ç æœ¬æ¨¡å—å’Œç”Ÿæˆæ¨¡å—åˆ†åˆ«è®­ç»ƒ250å’Œ350è½®ã€‚é‡‡ç”¨æ”¹è¿›çš„Transformerä¸»å¹²ï¼Œè¾“å…¥åµŒå…¥ç»´åº¦256ï¼Œå‰é¦ˆç»´åº¦512ï¼ŒDropoutç‡0.1ï¼Œå„å«6å±‚ã€æ¯å±‚8å¤´æ³¨æ„åŠ›ã€‚ç æœ¬å­¦ä¹ ç½‘ç»œæœ‰4å±‚ã€‚ä½¿ç”¨AdamWä¼˜åŒ–å™¨ï¼Œå­¦ä¹ ç‡0.001ï¼Œçº¿æ€§é¢„çƒ­2000æ­¥ã€‚æµ‹è¯•æ—¶é‡‡ç”¨æ ¸é‡‡æ ·ï¼Œå¯¹è¾“å…¥æ›²çº¿åæ ‡æ·»åŠ éšæœºå™ªå£°å‡å°‘è¿‡æ‹Ÿåˆï¼Œé’ˆå¯¹ç æœ¬åå¡Œé—®é¢˜é‡‡å–é‡æ–°åˆå§‹åŒ–ç­–ç•¥ã€‚æœ€ä¼˜ä»£ç æœ¬å¤§å°çº¦ä¸ºè½®å»“å’Œå®ä½“3,500ï¼Œç¯2,500ï¼Œå‹ç¼©æ¯”çº¦60xã€17xå’Œ29xã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:7:1","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"7.2 æŒ‡æ ‡ äº”ä¸ªå·²å»ºç«‹çš„æŒ‡æ ‡å®šé‡è¯„ä¼°éšæœºç”Ÿæˆ ç‚¹äº‘æŒ‡æ ‡ï¼šåŸºäºæ¨¡å‹è¡¨é¢é‡‡æ ·çš„2000ç‚¹æ¯”è¾ƒç”Ÿæˆå’ŒçœŸå®æ•°æ®çš„ç‚¹äº‘é›†ï¼Œè¯„ä¼°å¤šæ ·æ€§ä¸è´¨é‡ã€‚ è¦†ç›–ç‡ï¼ˆCOVï¼‰ï¼šè‡³å°‘åŒ¹é…ä¸€ä¸ªç”Ÿæˆæ ·æœ¬çš„çœŸå®æ¨¡å‹ç™¾åˆ†æ¯”ï¼Œåæ˜ ç”Ÿæˆå½¢çŠ¶çš„å¤šæ ·æ€§ã€‚ æœ€å°åŒ¹é…è·ç¦»ï¼ˆMMDï¼‰ï¼šå¹³å‡æœ€å°åŒ¹é…è·ç¦»ï¼Œè¡¡é‡ä¸¤ç»„ä¹‹é—´çš„æ¥è¿‘ç¨‹åº¦ã€‚ Jensen-Shannonæ•£åº¦ï¼ˆJSDï¼‰ï¼šä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒé—´çš„ç›¸ä¼¼æ€§ï¼Œè®¡ç®—å ç”¨ç›¸åŒç©ºé—´ä½ç½®çš„é¢‘ç‡ã€‚ tokenæŒ‡æ ‡ï¼šè¡¡é‡å”¯ä¸€æ€§ã€‚æ•°å€¼å­—æ®µé‡åŒ–ä¸º6ä½ã€‚ æ–°é¢–æ€§ï¼ˆNovelï¼‰ï¼šæœªå‡ºç°åœ¨è®­ç»ƒé›†ä¸­çš„ç”ŸæˆCADåºåˆ—æ¯”ä¾‹ã€‚ å”¯ä¸€æ€§ï¼ˆUniqueï¼‰ï¼šåœ¨ç”Ÿæˆé›†ä¸­ä»…å‡ºç°ä¸€æ¬¡çš„æ•°æ®æ¯”ä¾‹ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:7:2","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"7.3 æ— æ¡ä»¶ç”Ÿæˆ å¯¹æ¯”DeepCADä¸SkexGenï¼Œæ‰€æœ‰æ–¹æ³•ç”Ÿæˆ10,000ä¸ªCADæ¨¡å‹ï¼Œä¸æµ‹è¯•é›†éšæœºé€‰å–çš„2,500ä¸ªçœŸå®æ¨¡å‹æ¯”è¾ƒã€‚ **å®šé‡è¯„ä¼°ï¼š**å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨æ‰€æœ‰ä¸‰ä¸ªç‚¹äº‘è¯„ä¼°æŒ‡æ ‡ä¸Šè¶…è¶Šbaselineï¼Œå±•ç°æ˜¾è‘—çš„è´¨é‡å’Œå¤šæ ·æ€§æå‡ã€‚åœ¨UniqueæŒ‡æ ‡ä¸Šï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸SkexGenç›¸å½“ï¼Œè¿œè¶…DeepCADã€‚NovelæŒ‡æ ‡ä¸Šç•¥é€ŠäºSkexGenï¼Œä½†æ˜æ˜¾ä¼˜äºDeepCADï¼›æ­¤å·®è·æºäºè¾ƒå°ä¸”å¤šæ ·æ€§ä¸è¶³çš„è®­ç»ƒé›†ï¼Œä¸”ä»…åŒ…å«å°‘é‡å¤æ‚å½¢çŠ¶æ‰€è‡´ã€‚SkexGenå› æ— æ³•ç”Ÿæˆéå¸¸å¤æ‚çš„æ¨¡å‹è€Œå—æ­¤å½±å“è¾ƒå°ã€‚ å®šæ€§è¯„ä¼°ï¼š ä¸‹å›¾æ˜¾ç¤ºæˆ‘ä»¬çš„æ–¹æ³•èƒ½ç”Ÿæˆç»“æ„è‰¯å¥½ã€å‡ ä½•å½¢çŠ¶å¤æ‚ã€éƒ¨ä»¶å¸ƒå±€ç²¾ç»†çš„CADæ¨¡å‹ï¼Œä¸çœŸå®ä¸–ç•Œå®ä¾‹ç›¸ä¼¼ã€‚ äººå·¥è¯„ä¼°ï¼š é€šè¿‡äºšé©¬é€Šä¼—åŒ…å¹³å°è¿›è¡Œäººç±»æ„ŸçŸ¥è´¨é‡è¯„ä¼°ï¼Œé’ˆå¯¹å…·æœ‰ä¸‰ä¸ªæˆ–æ›´å¤šæ‹‰ä¼¸çš„æ¨¡å‹ã€‚åœ¨ä¸çœŸå®æ¨¡å‹å¹¶åˆ—å±•ç¤ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨â€œçœŸå®æ„Ÿâ€è¯„åˆ†ä¸Šè¡¨ç°çªå‡ºï¼Œåˆ†å¸ƒå¯¹ç§°ï¼Œè¡¨æ˜ç”Ÿæˆæ¨¡å‹éš¾ä»¥è¢«åŒºåˆ†ã€‚æ¯”è¾ƒä¹‹ä¸‹ï¼ŒDeepCADå’ŒSkexGençš„åˆ†å¸ƒåå‘â€œè¾ƒä¸çœŸå®â€ï¼Œè¡¨æ˜æ˜“è¢«è¯†åˆ«ä¸ºç®€å•æˆ–ä¸è§„èŒƒçš„æ¨¡å‹ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¸­æœ‰49.2%çš„ç”Ÿæˆæ¨¡å‹è¢«è®¤å®šä¸ºæ¯”è®­ç»ƒæ•°æ®æ›´â€œçœŸå®â€ï¼ŒSkexGenä¸º46.9%ï¼ŒDeepCADä¸º38.7%ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:7:3","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"7.4 å¯æ§ç”Ÿæˆ æˆ‘ä»¬åœ¨ä¸¤ç§â€œç¼–è¾‘â€å’Œä¸€ç§â€œè‡ªåŠ¨è¡¥å…¨â€åº”ç”¨åœºæ™¯ä¸­å±•ç¤ºäº†å¯æ§ç”Ÿæˆã€‚ ä»£ç æ ‘ç¼–è¾‘ï¼š ç”¨æˆ·å¯ç¼–è¾‘ä¸åŒå±‚æ¬¡çš„ä»£ç èŠ‚ç‚¹ï¼Œå®ç°å±€éƒ¨åˆ°å…¨å±€çš„CADå±‚æ¬¡ä¿®æ”¹ï¼Œè¿™æ˜¯ä»¥å¾€æ–¹æ³•æ‰€ä¸å…·å¤‡çš„ã€‚ç¼–è¾‘ç»“æœå¤šæ ·åŒ–ä¸”æ§åˆ¶ç²¾ç¡®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä¿æŒè®¾è®¡çš„ç¼–è¾‘ï¼š åœ¨å›ºå®šä»£ç æ ‘çš„åŸºç¡€ä¸Šï¼Œç”¨æˆ·å¯è¿­ä»£åœ°è°ƒæ•´æ¨¡å‹å‚æ•°ä»¥ç»†åŒ–è®¾è®¡ï¼ŒåŒæ—¶ä¿æŒå½“å‰è®¾è®¡ä¸å˜ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå±€éƒ¨å°ºå¯¸è°ƒæ•´åï¼Œç›¸å…³éƒ¨åˆ†ä¼šè‡ªåŠ¨è°ƒæ•´ä»¥é€‚åº”æ›´æ”¹ã€‚ ä»ç”¨æˆ·è¾“å…¥çš„è‡ªåŠ¨è¡¥å…¨ï¼š æ ¹æ®ç”¨æˆ·æä¾›çš„éƒ¨åˆ†è½®å»“æˆ–ç¯ï¼Œé¢„æµ‹å¯èƒ½çš„ä»£ç é›†ä»¥å®ŒæˆCADæ¨¡å‹ã€‚å›¾9å’Œå›¾10å±•ç¤ºäº†ä»éƒ¨åˆ†è½®å»“å’Œæ‹‰ä¼¸è½®å»“å¼€å§‹çš„è‡ªåŠ¨è¡¥å…¨ç»“æœï¼Œæ¯è¡Œå±•ç¤ºä¸åŒç”Ÿæˆä»£ç çš„ç»“æœã€‚ç›¸æ¯”æœ€è¿‘é‚»æœç´¢baselineï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨å¤šæ ·æ€§å’Œç²¾ç¡®åŒ¹é…ç”¨æˆ·è¾“å…¥æ–¹é¢è¡¨ç°æ›´ä¼˜ï¼Œå¦‚å›¾11æ‰€ç¤ºã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:7:4","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"8 æ€»ç»“ ä½œè€…å¼•å…¥äº†ä¸€ç§æ–°é¢–çš„å¯æ§CADç”Ÿæˆæ¨¡å‹ã€‚æ–¹æ³•çš„å…³é”®æ˜¯ä¸‰å±‚ç¥ç»ç¼–ç ï¼Œå®ƒåœ¨å»ºæ¨¡å±‚æ¬¡ç»“æ„çš„ä¸åŒå±‚æ¬¡ä¸Šæ•è·è®¾è®¡æ¨¡å¼å’Œæ„å›¾ã€‚æœ¬æ–‡åœ¨åŒ…å«ç”¨æˆ·åé¦ˆçš„æ™ºèƒ½ç”Ÿæˆè®¾è®¡æ–¹å‘ä¸Šåˆè¿ˆå‡ºäº†é‡è¦ä¸€æ­¥ã€‚å¹¿æ³›çš„è¯„ä¼°æ˜¾ç¤ºï¼Œç”Ÿæˆè´¨é‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œå¹¶å±•ç¤ºäº†ä½œè€…çš„åˆ†å±‚ç¥ç»ç¼–ç åœ¨æ„å›¾æ„ŸçŸ¥ç¼–è¾‘å’Œè‡ªåŠ¨è¡¥å…¨ç­‰åº”ç”¨ä¸­çš„å·¨å¤§æ½œåŠ›ã€‚å…¶ä¸»è¦åˆ›æ–°ç‚¹å’Œé™åˆ¶å¦‚ä¸‹ï¼š åˆ›æ–°ç‚¹ï¼š åˆ†å±‚ç¥ç»ç¼–ç ï¼šæå‡ºäº†ä¸€ç§ä¸‰å±‚æ¬¡çš„ç¥ç»ç¼–ç æ–¹æ³•ï¼Œå°†CADæ¨¡å‹çš„é«˜çº§è®¾è®¡æ¦‚å¿µè¡¨ç¤ºä¸ºä»å…¨å±€éƒ¨ä»¶å¸ƒå±€åˆ°å±€éƒ¨æ›²çº¿å‡ ä½•çš„æ ‘çŠ¶ç»“æ„ã€‚ è®¾è®¡æ„å›¾çš„æ•æ‰ä¸æ§åˆ¶ï¼šé€šè¿‡æŒ‡å®šç›®æ ‡è®¾è®¡æ¥ç”Ÿæˆæˆ–å®ŒæˆCADæ¨¡å‹ï¼Œä½¿ç”¨ä»£ç æ ‘æ¥æ§åˆ¶ç”Ÿæˆè¿‡ç¨‹ã€‚ æ–°å‹å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVAEï¼‰ï¼šæå‡ºäº†ä¸€ç§æ–°å‹çš„å‘é‡é‡åŒ–VAEå˜ä½“ï¼Œå…·æœ‰â€œæ©è”½è·³è·ƒè¿æ¥â€ï¼Œç”¨äºä»å¤§è§„æ¨¡è‰å›¾å’ŒæŒ¤å‡ºCADæ•°æ®é›†ä¸­æå–è®¾è®¡å˜åŒ–ä½œä¸ºç¥ç»ä»£ç æœ¬ã€‚ ä¸¤é˜¶æ®µçº§è”è‡ªå›å½’å˜æ¢å™¨ï¼šç”¨äºä»ä¸å®Œæ•´çš„CADæ¨¡å‹ç”Ÿæˆä»£ç æ ‘ï¼Œç„¶åæ ¹æ®é¢„æœŸè®¾è®¡å®ŒæˆCADæ¨¡å‹ã€‚ é™åˆ¶ï¼š æœ‰æ•ˆæ€§é—®é¢˜ï¼šå½“å‰ç³»ç»Ÿåœ¨ç”Ÿæˆå…·æœ‰è‡ªç›¸äº¤è¾¹æˆ–å®ä½“çš„CADæ¨¡å‹æ—¶å¯èƒ½å­˜åœ¨æœ‰æ•ˆæ€§é—®é¢˜ï¼Œå› ä¸ºæŸå¤±å‡½æ•°æ²¡æœ‰æ˜ç¡®åœ°æƒ©ç½šæ— æ•ˆçš„å‡ ä½•å½¢çŠ¶ã€‚æœªæ¥çš„å·¥ä½œæ˜¯å¢åŠ ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œåˆ©ç”¨é¢†åŸŸçŸ¥è¯†æ˜ç¡®å¯¹ CAD æ¨¡å‹çš„æ— æ•ˆæ€§è¿›è¡Œæƒ©ç½šã€‚ æ¢å¤å¤±è´¥çš„èƒ½åŠ›ï¼šç³»ç»Ÿåœ¨é¢å¯¹å¤±è´¥æƒ…å†µæ—¶ï¼Œç¼ºä¹ä»é”™è¯¯ä¸­æ¢å¤çš„èƒ½åŠ›ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºç¼ºä¹â€œæ— æ•ˆCADæ¨¡å‹æ•°æ®é›†â€æ¥è®­ç»ƒè¿™ç§æ¢å¤æœºåˆ¶ã€‚ æ¨¡å‹æ ¼å¼é™åˆ¶ï¼šè¯¥æ–¹æ³•ä½¿ç”¨çš„æ˜¯è‰å›¾å’Œæ‹‰ä¼¸CADæ ¼å¼ï¼Œè¿™å¯èƒ½æ’é™¤äº†å…¶ä»–æµè¡Œçš„å»ºæ¨¡æ“ä½œï¼Œå¦‚æ—‹è½¬ã€é•œåƒå’Œæ‰«æ ç­‰ã€‚ ","date":"2024-07-19","objectID":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/:8:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Hierarchical Neural Coding for Controllable CAD Model Generation","uri":"/posts/07.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0hierarchical-neural-coding-for-controllable-cad-model-generation/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"1 ä»‹ç» åˆ†å¸ƒå¼ä¸€è‡´æ€§å…±è¯†ç®—æ³•æŒ‡çš„æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä½¿å¾—æ‰€æœ‰èŠ‚ç‚¹å¯¹åŒä¸€ä»½æ•°æ®çš„è®¤çŸ¥èƒ½å¤Ÿè¾¾æˆå…±è¯†çš„ç®—æ³•ã€‚ä¸”ç®—æ³•å…è®¸æ‰€æœ‰èŠ‚ç‚¹åƒä¸€ä¸ªæ•´ä½“ä¸€æ ·å·¥ä½œï¼Œå³ä½¿å…¶ä¸­ä¸€äº›èŠ‚ç‚¹å‡ºç°æ•…éšœä¹Ÿèƒ½å¤Ÿç»§ç»­å·¥ä½œã€‚ä¹‹å‰çš„å¤§éƒ¨åˆ†ä¸€è‡´æ€§ç®—æ³•å®ç°éƒ½æ˜¯åŸºäºPaxosï¼Œä½†Paxoséš¾ä»¥ç†è§£å’Œå®ç°ï¼Œä¸ºæ­¤ä½œè€…å¼€å§‹å¯»æ‰¾ä¸€ç§æ–°çš„æ˜“äºç†è§£çš„ä¸€è‡´æ€§ç®—æ³•ï¼ŒRaftåˆ™æ˜¯ä½œè€…å·¥ä½œçš„äº§å‡ºã€‚ åœ¨è®¾è®¡Raftçš„è¿‡ç¨‹ä¸­ï¼Œä½œè€…é‡‡ç”¨äº†ä¸€ç³»åˆ—ç­–ç•¥æ¥å¢å¼ºå…¶å¯ç†è§£æ€§ï¼ŒåŒ…æ‹¬ï¼š ç®—æ³•åˆ†è§£ï¼šRaftå°†æ ¸å¿ƒåŠŸèƒ½æ¨¡å—åŒ–ï¼Œåˆ†ç¦»å‡ºé¢†å¯¼äººé€‰ä¸¾ã€æ—¥å¿—å¤åˆ¶å’Œå®‰å…¨æ€§ä¸‰ä¸ªå…³é”®éƒ¨åˆ†ï¼Œä½¿æ¯ä¸ªéƒ¨åˆ†çš„é€»è¾‘æ›´åŠ æ¸…æ™°ã€‚ çŠ¶æ€ç©ºé—´ç¼©å‡ï¼šç›¸æ¯”äºPaxosï¼ŒRaftå‡å°‘äº†ä¸ç¡®å®šæ€§å’ŒæœåŠ¡å™¨é—´çš„ä¸ä¸€è‡´æ€§çŠ¶æ€ï¼Œç®€åŒ–äº†çŠ¶æ€æœºæ¨¡å‹ï¼Œä»è€Œé™ä½äº†ç†è§£å’Œå®ç°çš„éš¾åº¦ã€‚ Raft ç®—æ³•åœ¨è®¸å¤šæ–¹é¢å’Œç°æœ‰çš„ä¸€è‡´æ€§ç®—æ³•éƒ½å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰ä¸€äº›ç‰¹æ€§ï¼š å¼ºé¢†å¯¼äººæœºåˆ¶ï¼šRafté‡‡ç”¨äº†æ›´å¼ºçš„é¢†å¯¼äººè§’è‰²ï¼Œæ‰€æœ‰æ—¥å¿—æ¡ç›®ä»…ç”±é¢†å¯¼äººå‘é€ç»™å…¶ä»–æœåŠ¡å™¨ï¼Œè¿™ç§é›†ä¸­æ§åˆ¶æ–¹å¼ç®€åŒ–äº†æ—¥å¿—ç®¡ç†ï¼Œå¢å¼ºäº†ç®—æ³•çš„ç›´è§‚æ€§ã€‚ é¢†å¯¼äººé€‰ä¸¾ï¼šRaftä½¿ç”¨éšæœºè®¡æ—¶å™¨æ¥è§¦å‘é¢†å¯¼äººé€‰ä¸¾ï¼Œè¿™ç§æœºåˆ¶åœ¨å¿ƒè·³æœºåˆ¶çš„åŸºç¡€ä¸Šå¢åŠ äº†å°‘è®¸å¤æ‚æ€§ï¼Œä½†æœ‰æ•ˆåœ°è§£å†³äº†é€‰ä¸¾å†²çªï¼Œå®ç°äº†å¿«é€Ÿè€Œç®€å•çš„å†³ç­–è¿‡ç¨‹ã€‚ æˆå‘˜å…³ç³»è°ƒæ•´ï¼šRaft ä½¿ç”¨ä¸€ç§è”åˆå…±è¯†çš„æ–¹æ³•æ¥å¤„ç†é›†ç¾¤æˆå‘˜å˜æ¢çš„é—®é¢˜ï¼Œåœ¨è¿™ç§æ–¹æ³•ä¸‹ï¼Œå¤„äºè°ƒæ•´è¿‡ç¨‹ä¸­çš„ä¸¤ç§ä¸åŒçš„é…ç½®é›†ç¾¤ä¸­å¤§å¤šæ•°æœºå™¨ä¼šæœ‰é‡å ï¼Œè¿™å°±ä½¿å¾—é›†ç¾¤åœ¨æˆå‘˜å˜æ¢çš„æ—¶å€™ä¾ç„¶å¯ä»¥ç»§ç»­å·¥ä½œã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2 å¤åˆ¶çŠ¶æ€æœº å¤åˆ¶çŠ¶æ€æœºæ˜¯å…±è¯†ç®—æ³•çš„æ ¸å¿ƒåº”ç”¨èƒŒæ™¯ï¼Œå®ƒæ˜¯æŒ‡ä¸€ç»„æœåŠ¡å™¨ä¸Šçš„çŠ¶æ€æœºç”Ÿæˆç›¸åŒçŠ¶æ€çš„å‰¯æœ¬ï¼Œå³ä½¿éƒ¨åˆ†æœåŠ¡å™¨å®•æœºä¹Ÿèƒ½æŒç»­è¿è¡Œã€‚è¿™ç§æ¶æ„åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å°¤å…¶é‡è¦ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿè§£å†³ä¸€ç³»åˆ—å®¹é”™é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¤§è§„æ¨¡çš„ç³»ç»Ÿä¸­é€šå¸¸éƒ½æœ‰ä¸€ä¸ªé›†ç¾¤é¢†å¯¼äººï¼Œåƒ GFSã€HDFS å’Œ RAMCloudï¼Œå…¸å‹åº”ç”¨å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¤åˆ¶çŠ¶æ€æœºå»ç®¡ç†é¢†å¯¼äººé€‰ä¸¾å’Œå­˜å‚¨é…ç½®ä¿¡æ¯å¹¶ä¸”åœ¨é¢†å¯¼äººå®•æœºçš„æƒ…å†µä¸‹ä¹Ÿè¦å­˜æ´»ä¸‹æ¥ã€‚æ¯”å¦‚ Chubby å’Œ ZooKeeperã€‚ å¤åˆ¶çŠ¶æ€æœºé€šå¸¸éƒ½æ˜¯åŸºäºå¤åˆ¶æ—¥å¿—å®ç°çš„ï¼Œå¦‚å›¾ 1ã€‚æ¯ä¸ªæœåŠ¡å™¨å­˜å‚¨ä¸€ä¸ªåŒ…å«ä¸€ç³»åˆ—æŒ‡ä»¤çš„æ—¥å¿—ï¼Œå¹¶ä¸”æŒ‰ç…§æ—¥å¿—çš„é¡ºåºè¿›è¡Œæ‰§è¡Œã€‚æ‰€æœ‰æ—¥å¿—éƒ½åŒ…å«ç›¸åŒçš„æŒ‡ä»¤åºåˆ—ï¼Œç¡®ä¿çŠ¶æ€æœºä¸€è‡´ï¼Œå› ä¸ºæ¯ä¸ªçŠ¶æ€æœºéƒ½æ˜¯ç¡®å®šçš„ï¼Œæ¯ä¸€æ¬¡æ‰§è¡Œæ“ä½œéƒ½äº§ç”Ÿç›¸åŒçš„çŠ¶æ€å’ŒåŒæ ·çš„åºåˆ—ã€‚ ä¸€è‡´æ€§ç®—æ³•çš„ä»»åŠ¡æ˜¯ä¿è¯å¤åˆ¶æ—¥å¿—çš„ä¸€è‡´æ€§ã€‚æœåŠ¡å™¨ä¸Šçš„ä¸€è‡´æ€§æ¨¡å—æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æŒ‡ä»¤ç„¶åæ·»åŠ åˆ°è‡ªå·±çš„æ—¥å¿—ä¸­ã€‚å®ƒå’Œå…¶ä»–æœåŠ¡å™¨ä¸Šçš„ä¸€è‡´æ€§æ¨¡å—è¿›è¡Œé€šä¿¡æ¥ä¿è¯æ¯ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„æ—¥å¿—æœ€ç»ˆéƒ½ä»¥ç›¸åŒçš„é¡ºåºåŒ…å«ç›¸åŒçš„è¯·æ±‚ï¼Œå³ä½¿æœ‰äº›æœåŠ¡å™¨å‘ç”Ÿæ•…éšœã€‚ä¸€æ—¦æŒ‡ä»¤è¢«æ­£ç¡®çš„å¤åˆ¶ï¼Œæ¯ä¸€ä¸ªæœåŠ¡å™¨çš„çŠ¶æ€æœºæŒ‰ç…§æ—¥å¿—é¡ºåºå¤„ç†ä»–ä»¬ï¼Œç„¶åè¾“å‡ºç»“æœè¢«è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨é›†ç¾¤çœ‹èµ·æ¥å½¢æˆäº†ä¸€ä¸ªé«˜å¯é çš„çŠ¶æ€æœºã€‚ å®é™…ç³»ç»Ÿä¸­ä½¿ç”¨çš„ä¸€è‡´æ€§ç®—æ³•ä¸»è¦æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š å®‰å…¨æ€§ä¿è¯ï¼ˆç»å¯¹ä¸ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯çš„ç»“æœï¼‰ã€‚ å³ä½¿éƒ¨åˆ†æœåŠ¡å™¨å¤±è´¥ï¼Œåªè¦å¤šæ•°æœåŠ¡å™¨è¿è¡Œï¼Œç³»ç»Ÿä¾ç„¶å¯ç”¨ã€‚ ä¸ä¾èµ–äºæ—¶åºï¼Œèƒ½å¤Ÿåº”å¯¹æ—¶é’Ÿé”™è¯¯å’Œæ¶ˆæ¯å»¶è¿Ÿã€‚ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒæŒ‡ä»¤å¯ä»¥åœ¨ä¸€è½®è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åå®Œæˆï¼Œä¸å—å°‘æ•°æ…¢èŠ‚ç‚¹å½±å“ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3 Paxosçš„é—®é¢˜ Paxosæå…¶éš¾ä»¥ç†è§£ã€‚ æ²¡æœ‰ä¸ºæ„å»ºå®é™…ç³»ç»Ÿå®ç°æä¾›è‰¯å¥½çš„åŸºç¡€ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4 ä¸ºäº†å¯ç†è§£æ€§çš„è®¾è®¡ è®¾è®¡Raftç®—æ³•çš„åˆè¡·ï¼š å¿…é¡»æä¾›ä¸€ä¸ªå®Œæ•´çš„å®é™…çš„ç³»ç»Ÿå®ç°åŸºç¡€ï¼Œå‡å°‘å¼€å‘è€…å·¥ä½œé‡ï¼› å¿…é¡»åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯å®‰å…¨çš„å¹¶ä¸”åœ¨å¤§å¤šæ•°çš„æƒ…å†µä¸‹éƒ½æ˜¯å¯ç”¨çš„ï¼› å®ƒçš„å¤§éƒ¨åˆ†æ“ä½œå¿…é¡»æ˜¯é«˜æ•ˆçš„ï¼› å¯ç†è§£æ€§ï¼Œå®ƒå¿…é¡»ä¿è¯å¯¹äºæ™®éçš„äººç¾¤éƒ½å¯ä»¥ååˆ†å®¹æ˜“çš„å»ç†è§£ï¼› ä¾¿äºç³»ç»Ÿæ„å»ºè€…å½¢æˆç›´è§‚ç†è§£ï¼Œä¾¿äºå®é™…åº”ç”¨å’Œæ‰©å±•ï¼› Raftè®¾è®¡åŸåˆ™ï¼š é—®é¢˜åˆ†è§£ï¼šå°†å¤æ‚é—®é¢˜æ‹†è§£ä¸ºç‹¬ç«‹ã€æ˜“äºç†è§£å’Œè§£å†³çš„å­é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒRaft çš„é¢†å¯¼äººé€‰ä¸¾ã€æ—¥å¿—å¤åˆ¶ã€å®‰å…¨æ€§å’Œæˆå‘˜å˜æ›´ã€‚ çŠ¶æ€ç©ºé—´ç®€åŒ–ï¼šå‡å°‘çŠ¶æ€æ•°é‡ï¼Œé™ä½ç³»ç»Ÿå¤æ‚æ€§å¹¶åœ¨å¯èƒ½çš„æ—¶å€™æ¶ˆé™¤ä¸ç¡®å®šæ€§ã€‚ç¡®ä¿æ—¥å¿—æ— ç©ºæ´ï¼Œé™åˆ¶æ—¥å¿—ä¸ä¸€è‡´çš„å¯èƒ½æ€§ã€‚ éšæœºåŒ–åº”ç”¨ï¼šåœ¨é¢†å¯¼äººé€‰ä¸¾ä¸­ä½¿ç”¨éšæœºåŒ–ï¼Œç®€åŒ–æœºåˆ¶ï¼Œå¿«é€Ÿè§£å†³å†²çªã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5 Raftä¸€è‡´æ€§ç®—æ³• Raft æ˜¯ä¸€ç§ç®¡ç†å¤åˆ¶æ—¥å¿—çš„ä¸€è‡´æ€§ç®—æ³•ï¼Œé€šè¿‡é€‰ä¸¾é¢†å¯¼äººå¹¶ç”±å…¶ç®¡ç†æ—¥å¿—æ¥å®ç°ä¸€è‡´æ€§ã€‚é¢†å¯¼äººä»å®¢æˆ·ç«¯æ¥æ”¶æ—¥å¿—æ¡ç›®ï¼ŒæŠŠæ—¥å¿—æ¡ç›®å¤åˆ¶åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šï¼Œå¹¶å‘Šè¯‰å…¶ä»–çš„æœåŠ¡å™¨ä»€ä¹ˆæ—¶å€™å¯ä»¥å®‰å…¨åœ°å°†æ—¥å¿—æ¡ç›®åº”ç”¨åˆ°ä»–ä»¬çš„çŠ¶æ€æœºä¸­ã€‚è¿™ä¸€å†³ç­–è¿‡ç¨‹æ— éœ€ä¸å…¶ä»–æœåŠ¡å™¨è¿›è¡Œå•†è®®ï¼Œä»è€Œç®€åŒ–äº†æ•´ä¸ªå¤åˆ¶æ—¥å¿—çš„ç®¡ç†æµç¨‹ï¼Œå¹¶ä¸”æ•°æ®éƒ½ä»é¢†å¯¼äººæµå‘å…¶ä»–æœåŠ¡å™¨ã€‚ä¸€ä¸ªé¢†å¯¼äººå¯èƒ½ä¼šå‘ç”Ÿæ•…éšœï¼Œæˆ–è€…å’Œå…¶ä»–æœåŠ¡å™¨å¤±å»è¿æ¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¸€ä¸ªæ–°çš„é¢†å¯¼äººä¼šè¢«é€‰ä¸¾å‡ºæ¥ã€‚ Raftç®—æ³•çš„ä¸€è‡´æ€§é—®é¢˜è¢«å·§å¦™åœ°åˆ†è§£ä¸ºä¸‰ä¸ªå…³é”®å­é—®é¢˜ï¼š é¢†å¯¼é€‰ä¸¾ï¼šå½“é¢†å¯¼äººå‘ç”Ÿæ•…éšœçš„æ—¶å€™, ä¸€ä¸ªæ–°çš„é¢†å¯¼äººéœ€è¦è¢«é€‰ä¸¾å‡ºæ¥ï¼Œç¡®ä¿ç³»ç»Ÿçš„è¿ç»­æ€§å’Œç¨³å®šæ€§ï¼ˆ5.2ï¼‰ æ—¥å¿—å¤åˆ¶ï¼šé¢†å¯¼äººå¿…é¡»ä»å®¢æˆ·ç«¯æ¥æ”¶æ—¥å¿—æ¡ç›®ç„¶åå¤åˆ¶åˆ°é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼Œå¹¶å¼ºåˆ¶è¦æ±‚å…¶ä»–èŠ‚ç‚¹çš„æ—¥å¿—å’Œè‡ªå·±ä¿æŒä¸€è‡´ã€‚ å®‰å…¨æ€§ï¼šRafté€šè¿‡ç‰¹å®šçš„æœºåˆ¶ï¼ˆ5.4ï¼‰ç¡®ä¿ä¸€æ—¦æ—¥å¿—æ¡ç›®è¢«åº”ç”¨åˆ°æŸä¸ªæœåŠ¡å™¨çš„çŠ¶æ€æœºä¸­ï¼Œå…¶ä»–æœåŠ¡å™¨ä¸ä¼šåœ¨åŒä¸€æ—¥å¿—ç´¢å¼•ä½ç½®åº”ç”¨ä¸åŒçš„æŒ‡ä»¤ï¼Œä»è€Œä¿éšœäº†ç³»ç»ŸçŠ¶æ€çš„ä¸€è‡´æ€§å’Œå®‰å…¨æ€§ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.1 RaftåŸºç¡€ ä¸€ä¸ª Raft é›†ç¾¤ç”±è‹¥å¹²ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹æ„æˆï¼Œå¦‚å¸¸è§çš„ 5 èŠ‚ç‚¹é…ç½®ï¼Œèƒ½å®¹å¿æœ€å¤š 2 ä¸ªèŠ‚ç‚¹å¤±æ•ˆã€‚èŠ‚ç‚¹æœ‰ä»¥ä¸‹ä¸‰ç§çŠ¶æ€ï¼š é¢†å¯¼äººï¼šå”¯ä¸€å†³ç­–è€…ï¼Œå¤„ç†æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶ä¸”ç®¡ç†å¤åˆ¶æ—¥å¿—ã€‚ è·Ÿéšè€…ï¼šè¢«åŠ¨è§’è‰²ï¼Œä»…å“åº”é¢†å¯¼äººå’Œå€™é€‰äººçš„è¯·æ±‚ã€‚ å€™é€‰äººï¼šç«é€‰çŠ¶æ€ï¼Œç”¨äºé€‰ä¸¾æ–°é¢†å¯¼äºº è·Ÿéšè€…åœ¨æ”¶ä¸åˆ°æ¶ˆæ¯æ—¶ï¼Œå‡çº§ä¸ºå€™é€‰äººï¼Œå¯åŠ¨é€‰ä¸¾ï¼›è·å¾—å¤šæ•°ç¥¨çš„å€™é€‰äººæˆä¸ºé¢†å¯¼äººï¼›é¢†å¯¼äººå®•æœºæˆ–å‘ç°ä»»æœŸè¿‡æœŸï¼Œé™çº§ä¸ºè·Ÿéšè€…ã€‚ Raft é€šè¿‡ä»»æœŸæ¥åˆ’åˆ†æ—¶é—´ï¼Œæ¯ä¸ªä»»æœŸéƒ½å§‹äºä¸€æ¬¡é€‰ä¸¾ã€‚ä»»æœŸç”¨æ•´æ•°æ ‡è®°ï¼Œæ¯æ®µä»»æœŸæœ‰å…¶é€‰ä¸¾è¿‡ç¨‹ã€‚å¦‚æœé€‰ä¸¾æˆåŠŸï¼Œé€‰å‡ºçš„é¢†å¯¼äººå°†è´Ÿè´£ç®¡ç†é›†ç¾¤ï¼Œç›´åˆ°è¯¥ä»»æœŸç»“æŸã€‚ä»»æœŸåœ¨Raftä¸­å……å½“é€»è¾‘æ—¶é’Ÿçš„ä½œç”¨ï¼Œå¸®åŠ©èŠ‚ç‚¹æ£€æµ‹è¿‡æœŸä¿¡æ¯ï¼Œå¦‚è¿‡æœŸçš„é¢†å¯¼äººã€‚ æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªå½“å‰ä»»æœŸå·ï¼Œé€šä¿¡æ—¶äº¤æ¢ä»»æœŸå·ï¼ŒèŠ‚ç‚¹è‡ªåŠ¨æ›´æ–°è‡³è¾ƒå¤§å€¼ï¼Œé¢†å¯¼äººæˆ–å€™é€‰äººå¦‚æœå‘ç°ä»»æœŸå·è¿‡æœŸï¼Œä¼šæ¢å¤ä¸ºè·Ÿéšè€…ï¼›èŠ‚ç‚¹æ‹’ç»è¿‡æœŸä»»æœŸè¯·æ±‚ã€‚ åœ¨ Raft ç®—æ³•ä¸­ï¼ŒèŠ‚ç‚¹é—´çš„é€šä¿¡ä¾èµ–äºRPCã€‚åŸºæœ¬çš„ä¸€è‡´æ€§ç®—æ³•ä¸»è¦ä½¿ç”¨ä¸¤ç§ç±»å‹çš„ RPCsï¼š è¯·æ±‚æŠ•ç¥¨RPCï¼šå€™é€‰äººå‘èµ·ï¼Œç”¨äºé€‰ä¸¾ã€‚ é™„åŠ æ¡ç›®RPCï¼šé¢†å¯¼äººå‘èµ·ï¼Œå¤åˆ¶æ—¥å¿—å’Œæä¾›å¿ƒè·³æœºåˆ¶ã€‚ å®‰è£…å¿«ç…§PRCï¼šé¢†å¯¼äººå‘èµ·ï¼Œå®‰è£…å¿«ç…§ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼ŒæœåŠ¡å™¨åœ¨æœªåŠæ—¶æ”¶åˆ°å“åº”æ—¶ä¼šé‡è¯• RPCï¼Œå¹¶ä¸”èƒ½å¤Ÿå¹¶è¡Œå‘èµ· RPCã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:5:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.2 é¢†å¯¼äººé€‰ä¸¾ Raft ç®—æ³•é‡‡ç”¨å¿ƒè·³æœºåˆ¶æ¥è§¦å‘é¢†å¯¼äººé€‰ä¸¾è¿‡ç¨‹ã€‚æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œé»˜è®¤å¤„äºè·Ÿéšè€…çŠ¶æ€ï¼Œä»…å½“æ¥æ”¶åˆ°æ¥è‡ªé¢†å¯¼äººæˆ–å€™é€‰äººçš„æœ‰æ•ˆ RPC æ—¶æ‰ä¿æŒè¿™ä¸€çŠ¶æ€ã€‚é¢†å¯¼äººå®šæœŸå‘æ‰€æœ‰è·Ÿéšè€…å‘é€å¿ƒè·³åŒ…ï¼Œå³ä¸å«æ—¥å¿—é¡¹çš„é™„åŠ æ¡ç›®RPCï¼Œä»¥æ­¤ç»´æŠ¤å…¶é¢†å¯¼åœ°ä½ã€‚è‹¥è·Ÿéšè€…åœ¨è®¾å®šçš„é€‰ä¸¾è¶…æ—¶æ—¶é—´å†…æœªæ”¶åˆ°ä»»ä½•æ¶ˆæ¯ï¼Œå®ƒå°†å‡å®šæ— æœ‰æ•ˆé¢†å¯¼äººå¹¶å‘èµ·é€‰ä¸¾ï¼Œä»¥é€‰å‡ºæ–°çš„é¢†å¯¼äººã€‚ é€‰ä¸¾æµç¨‹å¼€å§‹æ—¶ï¼Œè·Ÿéšè€…å¢åŠ è‡ªå·±çš„å½“å‰ä»»æœŸå·å¹¶è½¬æ¢ä¸ºå€™é€‰äººçŠ¶æ€ï¼Œç„¶åå‘é›†ç¾¤ä¸­å…¶ä»–æœåŠ¡å™¨èŠ‚ç‚¹å‘é€è¯·æ±‚æŠ•ç¥¨RPCæ¥ç»™è‡ªå·±æŠ•ç¥¨ã€‚å€™é€‰äººä¿æŒè¯¥çŠ¶æ€ï¼Œç›´è‡³å‡ºç°ä»¥ä¸‹ä¸‰ç§æƒ…å†µä¹‹ä¸€ï¼š èµ¢å¾—é€‰ä¸¾ã€‚ å…¶ä»–æœåŠ¡å™¨æˆä¸ºé¢†å¯¼äººã€‚ åœ¨ä¸€å®šæ—¶é—´å†…æ— æ˜ç¡®è·èƒœè€…ã€‚ èµ¢å¾—é€‰ä¸¾çš„æ¡ä»¶æ˜¯è·å¾—é›†ç¾¤å¤§å¤šæ•°æœåŠ¡å™¨èŠ‚ç‚¹çš„é€‰ç¥¨ï¼Œæ¯å°æœåŠ¡å™¨å¯¹åŒä¸€ä»»æœŸå·çš„æŠ•ç¥¨éµå¾ªå…ˆæ¥å…ˆæœåŠ¡åŸåˆ™ï¼Œå¹¶æœ‰é¢å¤–é™åˆ¶ï¼ˆ5.4ï¼‰ä»¥ç¡®ä¿é€‰ä¸¾å®‰å…¨æ€§ï¼Œé¿å…äº†è„‘è£‚ï¼ˆåŒä¸€äººæ°”ï¼Œé›†ç¾¤å‡ºç°ä¸¤ä¸ªé¢†å¯¼äººï¼‰ã€‚ä¸€æ—¦å½“é€‰ï¼Œå€™é€‰äººå³åˆ»è½¬å˜ä¸ºé¢†å¯¼äººï¼Œé€šè¿‡å‘é€å¿ƒè·³æ¶ˆæ¯ç¡®ç«‹é¢†å¯¼åœ°ä½å¹¶é˜»æ­¢å‘èµ·æ–°é€‰ä¸¾ã€‚ åœ¨ç­‰å¾…æŠ•ç¥¨çš„è¿‡ç¨‹ä¸­ï¼Œå€™é€‰äººå¯èƒ½æ¥æ”¶åˆ°é¢†å¯¼äººå‘é€çš„é™„åŠ æ¡ç›®RPCï¼Œå¦‚æœè¯¥é¢†å¯¼äººä»»æœŸå·ä¸ä½äºå€™é€‰äººçš„ä»»æœŸå·ï¼Œå€™é€‰äººå°†è®¤å¯å…¶åˆæ³•æ€§ï¼Œå›å½’è·Ÿéšè€…çŠ¶æ€ï¼›åä¹‹ï¼Œå€™é€‰äººå°†æ‹’ç»RPCï¼Œç»§ç»­ç«é€‰ã€‚è‹¥å¤šä¸ªå€™é€‰äººåŒæ—¶å‘èµ·é€‰ä¸¾ï¼Œé€‰ç¥¨åˆ†æ•£å¯èƒ½å¯¼è‡´æ— äººèƒœå‡ºï¼Œæ‰€æœ‰å€™é€‰äººå‡ä¼šå› è¶…æ—¶è€Œé‡æ–°å¼€å§‹é€‰ä¸¾ï¼Œä½†ä»»æœŸå·ä¼šé€’å¢ã€‚ ä¸ºé˜²æ­¢é€‰ç¥¨åˆ†æ•£ï¼ŒRaftç®—æ³•å¼•å…¥äº†éšæœºåŒ–é€‰ä¸¾è¶…æ—¶æ—¶é—´ç­–ç•¥ã€‚å„æœåŠ¡å™¨åœ¨å›ºå®šæ—¶é—´èŒƒå›´å†…ï¼ˆä¾‹å¦‚$[150,200]$ï¼‰éšæœºé€‰å–è¶…æ—¶å€¼ï¼Œä½¿å¾—é€šå¸¸æƒ…å†µä¸‹ä»…æœ‰ä¸€å°æœåŠ¡å™¨è¶…æ—¶ï¼Œè¿›è€Œé¡ºåˆ©èµ¢å¾—é€‰ä¸¾å¹¶åœ¨å…¶ä»–æœåŠ¡å™¨è¶…æ—¶å‰å‘é€å¿ƒè·³ã€‚å³ä½¿å‘ç”Ÿé€‰ç¥¨åˆ†æ•£ï¼ŒéšæœºåŒ–çš„è¶…æ—¶æœºåˆ¶ä¹Ÿé™ä½äº†ä¸‹ä¸€è½®é€‰ä¸¾ä¸­å†æ¬¡åˆ†æ•£çš„å¯èƒ½æ€§ã€‚ ä½œè€…æœ€åˆè®¾è®¡è€ƒè™‘è¿‡å¼•å…¥æ’åç³»ç»Ÿä»¥å†³å®šä¼˜å…ˆçº§ï¼Œä½†å‘ç°è¿™å¯èƒ½å¯¼è‡´é«˜æ’åæœåŠ¡å™¨æ•…éšœæ—¶çš„å¯ç”¨æ€§é—®é¢˜ï¼Œä¸”ç®—æ³•è°ƒæ•´å¤æ‚ï¼Œéš¾ä»¥ç¡®ä¿æ²¡æœ‰å‰¯ä½œç”¨ã€‚ç»è¿‡å¤šæ¬¡è°ƒæ•´ï¼Œæœ€ç»ˆç¡®å®šéšæœºé‡è¯•æ–¹æ³•æ›´ä¸ºç›´è§‚æ˜“æ‡‚ï¼Œä¸”é¿å…äº†æ’åç³»ç»Ÿå¸¦æ¥çš„å¤æ‚æ€§å’Œæ½œåœ¨é—®é¢˜ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:5:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.3 æ—¥å¿—å¤åˆ¶ ä¸€æ—¦é€‰ä¸¾äº§ç”Ÿé¢†å¯¼äººï¼Œå®ƒä¾¿å¼€å§‹å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚æºå¸¦ä¸€æ¡è¢«å¤åˆ¶çŠ¶æ€æœºæ‰§è¡Œçš„æŒ‡ä»¤ã€‚é¢†å¯¼äººå°†æ­¤æŒ‡ä»¤ä½œä¸ºæ–°æ—¥å¿—æ¡ç›®è¿½åŠ è‡³æ—¥å¿—ä¸­ï¼Œå¹¶å¹¶è¡Œå‘èµ·é™„åŠ æ¡ç›®RPCç»™å…¶ä»–æœåŠ¡å™¨å¤åˆ¶ï¼Œæ—¥å¿—æ¡ç›®åœ¨è¢«å®‰å…¨å¤åˆ¶åï¼Œé¢†å¯¼äººå°†å…¶åº”ç”¨åˆ°çŠ¶æ€æœºå¹¶å°†æ‰§è¡Œç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå³ä½¿é¢å¯¹è·Ÿéšè€…å´©æºƒã€å»¶è¿Ÿæˆ–ç½‘ç»œä¸¢åŒ…ï¼Œé¢†å¯¼äººä¹Ÿä¼šæŒç»­é‡è¯•RPCï¼ˆå°½ç®¡å·²ç»å›å¤äº†å®¢æˆ·ç«¯ï¼‰ç›´è‡³æ‰€æœ‰è·Ÿéšè€…å­˜å‚¨æ‰€æœ‰æ—¥å¿—æ¡ç›®ã€‚ æ—¥å¿—ç»“æ„å¦‚å›¾6æ‰€ç¤ºï¼Œæ¡ç›®æŒ‰åºç¼–å·ï¼ŒåŒ…å«åˆ›å»ºæ—¶çš„ä»»æœŸå·åŠå¾…æ‰§è¡ŒæŒ‡ä»¤ã€‚æ—¥å¿—æ¡ç›®åœ¨æ»¡è¶³ä¸€å®šæ¡ä»¶æ—¶å˜ä¸ºå¯æäº¤çŠ¶æ€ï¼Œå³å®‰å…¨åœ°åº”ç”¨åˆ°çŠ¶æ€æœºä¸­ã€‚é¢†å¯¼äººå†³å®šä½•æ—¶æäº¤æ—¥å¿—æ¡ç›®ï¼ŒRaftç®—æ³•ä¿è¯æ‰€æœ‰æäº¤æ¡ç›®æŒä¹…åŒ–å¹¶æœ€ç»ˆè¢«æ‰§è¡Œã€‚æ—¥å¿—æ¡ç›®åœ¨è¢«å¤åˆ¶åˆ°å¤šæ•°æœåŠ¡å™¨æ—¶å³è¢«æäº¤ï¼ŒåŒ…æ‹¬å‰ä»»é¢†å¯¼äººåˆ›å»ºçš„æ¡ç›®ã€‚é¢†å¯¼äººè¿½è¸ªæœ€å¤§å·²æäº¤æ¡ç›®ç´¢å¼•ï¼Œå¹¶åœ¨é™„åŠ æ¡ç›®RPCä¸­åŒ…å«è¯¥ç´¢å¼•ï¼Œä½¿è·Ÿéšè€…åŒæ­¥åº”ç”¨å·²æäº¤æ¡ç›®ã€‚ Raftçš„æ—¥å¿—æœºåˆ¶ç»´æŒä¸åŒæœåŠ¡å™¨æ—¥å¿—ä¹‹é—´çš„é«˜å±‚æ¬¡ä¸€è‡´æ€§ï¼Œç®€åŒ–ç³»ç»Ÿè¡Œä¸ºå¹¶å¢å¼ºå¯é¢„æµ‹æ€§ï¼Œæ˜¯å®‰å…¨æ€§çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚å…³é”®ç‰¹æ€§æ˜¯è‹¥ä¸¤æ—¥å¿—æ¡ç›®ç´¢å¼•å’Œä»»æœŸå·ç›¸åŒï¼Œåˆ™å®ƒä»¬å­˜å‚¨ç›¸åŒæŒ‡ä»¤ï¼Œå¹¶ä¸”å‰åºæ¡ç›®ä¹Ÿç›¸åŒã€‚ã€‚è¿™æ˜¯å› ä¸ºæ—¥å¿—åŒ¹é…ç‰¹æ€§ï¼Œé¢†å¯¼äººæœ€å¤šåœ¨ä¸€ä¸ªä»»æœŸå†…ç‰¹å®šç´¢å¼•åˆ›å»ºæ—¥å¿—æ¡ç›®ï¼Œä¸”æ—¥å¿—æ¡ç›®ä½ç½®å›ºå®šä¸å˜ã€‚é™„åŠ æ¡ç›®RPCåŒ…å«å‰ä¸€æ¡ç›®çš„ç´¢å¼•å’Œä»»æœŸå·ï¼Œè‹¥è·Ÿéšè€…æ‰¾ä¸åˆ°åŒ¹é…æ¡ç›®åˆ™æ‹’ç»ï¼Œç¡®ä¿æ—¥å¿—åŒ¹é…ç‰¹æ€§ã€‚ æ­£å¸¸è¿è¡Œæ—¶ï¼Œé¢†å¯¼äººä¸è·Ÿéšè€…æ—¥å¿—ä¸€è‡´ï¼Œä½†åœ¨é¢†å¯¼äººå´©æºƒåå¯èƒ½å‡ºç°ä¸ä¸€è‡´ï¼Œå¦‚å›¾7æ‰€ç¤ºã€‚é¢†å¯¼äººé€šè¿‡å¼ºåˆ¶è·Ÿéšè€…å¤åˆ¶è‡ªå·±çš„æ—¥å¿—è§£å†³ä¸ä¸€è‡´ï¼Œè¦†ç›–å†²çªæ¡ç›®ã€‚é¢†å¯¼äººç»´æŠ¤nextIndexè®°å½•æ¯ä¸ªè·Ÿéšè€…ä¸‹ä¸€ä¸ªå¾…å‘é€æ¡ç›®ç´¢å¼•ï¼Œåˆå§‹åŒ–ä¸ºè‡ªèº«æœ€åæ¡ç›®ç´¢å¼•+1ã€‚å½“ä¸€è‡´æ€§æ£€æŸ¥å¤±è´¥ï¼Œé¢†å¯¼äººå°±ä¼šå‡å°nextIndexç›´è‡³æ‰¾åˆ°å…±åŒç‚¹ï¼Œåˆ é™¤è·Ÿéšè€…å†²çªæ¡ç›®å¹¶å‘é€è‡ªèº«æ¡ç›®ã€‚æˆåŠŸåï¼Œè·Ÿéšè€…æ—¥å¿—ä¸é¢†å¯¼äººä¿æŒä¸€ç›´ã€‚ ç®—æ³•å¯ä¼˜åŒ–å‡å°‘æ‹’ç»æ¬¡æ•°ï¼Œè·Ÿéšè€…å¯è¿”å›å†²çªæ¡ç›®ä»»æœŸå·åŠå¯¹åº”æœ€å°ç´¢å¼•ï¼Œé¢†å¯¼äººæ®æ­¤ä¸€æ¬¡æ€§è·³è¿‡å†²çªä»»æœŸæ‰€æœ‰æ¡ç›®ã€‚ä½†å®è·µä¸­ï¼Œè¿™ç§ä¼˜åŒ–å¯èƒ½éå¿…éœ€ï¼Œå› ä¸ä¸€è‡´æ€§ç½•è§ä¸”æ¶‰åŠæ¡ç›®ä¸å¤šã€‚ é€šè¿‡æ—¥å¿—å¤åˆ¶æœºåˆ¶ï¼Œé¢†å¯¼äººæ— éœ€ç‰¹æ®Šæ“ä½œå³å¯æ¢å¤ä¸€è‡´æ€§ï¼Œåªéœ€æ‰§è¡Œå¸¸è§„æµç¨‹ï¼Œæ—¥å¿—åœ¨å“åº”ä¸€è‡´æ€§æ£€æŸ¥å¤±è´¥æ—¶è‡ªåŠ¨å¯¹é½ã€‚é¢†å¯¼äººä»ä¸è¦†ç›–æˆ–åˆ é™¤è‡ªèº«æ—¥å¿—ï¼Œç¡®ä¿ä¸€è‡´æ€§ã€‚æ—¥å¿—å¤åˆ¶æœºåˆ¶ä½“ç°äº†é«˜å¯ç”¨æ€§ã€å¿«é€Ÿå¤åˆ¶åŠå¯¹æ…¢è·Ÿéšè€…çš„å®¹å¿åº¦ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:5:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.4 å®‰å…¨æ€§ åœ¨ Raft ç®—æ³•ä¸­ï¼Œå°½ç®¡å·²ç»æè¿°äº†é¢†å¯¼äººçš„é€‰ä¸¾å’Œæ—¥å¿—çš„å¤åˆ¶è¿‡ç¨‹ï¼Œä½†è¿™äº›æœºåˆ¶æœ¬èº«å¹¶ä¸è¶³ä»¥ä¿è¯æ‰€æœ‰çŠ¶æ€æœºæŒ‰ç…§ç›¸åŒçš„é¡ºåºæ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ã€‚å­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå³ä¸€ä¸ªè·Ÿéšè€…åœ¨é¢†å¯¼äººæäº¤äº†è‹¥å¹²æ—¥å¿—æ¡ç›®åå˜å¾—ä¸å¯ç”¨ï¼Œä¹‹åè¿™ä¸ªè·Ÿéšè€…å¯èƒ½è¢«é€‰ä¸¾ä¸ºæ–°çš„é¢†å¯¼äººï¼Œå¹¶å¯èƒ½è¦†ç›–è¿™äº›å·²æäº¤çš„æ—¥å¿—æ¡ç›®ï¼Œå¯¼è‡´ä¸åŒçŠ¶æ€æœºå¯èƒ½æ‰§è¡Œä¸åŒçš„æŒ‡ä»¤åºåˆ—ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRaft ç®—æ³•åœ¨é¢†å¯¼é€‰ä¸¾æ—¶å¢åŠ äº†é™åˆ¶ï¼Œç¡®ä¿ä»»ä½•ç»™å®šä»»æœŸçš„é¢†å¯¼äººéƒ½æ‹¥æœ‰ä¹‹å‰ä»»æœŸçš„æ‰€æœ‰å·²æäº¤çš„æ—¥å¿—æ¡ç›®ï¼ˆå³é¢†å¯¼äººå®Œæ•´ç‰¹æ€§ï¼‰ã€‚è¿™ä¸€é™åˆ¶ç®€åŒ–äº†æäº¤è§„åˆ™ï¼Œå¹¶ä¸ºå¤åˆ¶çŠ¶æ€æœºçš„æ­£ç¡®è¡Œä¸ºæä¾›äº†è¯æ˜ã€‚ 5.4.1 é€‰ä¸¾é™åˆ¶ åœ¨åŸºäºé¢†å¯¼äººçš„ä¸€è‡´æ€§ç®—æ³•ä¸­ï¼Œé¢†å¯¼äººéƒ½å¿…é¡»å­˜å‚¨æ‰€æœ‰å·²æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚Raft ç®—æ³•é€šè¿‡ç®€å•çš„æ–¹æ³•ç¡®ä¿æ–°é€‰ä¸¾çš„é¢†å¯¼äººæ‹¥æœ‰ä¹‹å‰ä»»æœŸä¸­æ‰€æœ‰å·²æäº¤çš„æ—¥å¿—æ¡ç›®ï¼Œé¿å…äº†é¢å¤–çš„æ—¥å¿—ä¼ è¾“æœºåˆ¶å’Œå¤æ‚æ€§ã€‚ Raft ä½¿ç”¨æŠ•ç¥¨æœºåˆ¶æ¥é˜»æ­¢æœªåŒ…å«æ‰€æœ‰å·²æäº¤æ—¥å¿—æ¡ç›®çš„å€™é€‰äººèµ¢å¾—é€‰ä¸¾ã€‚å€™é€‰äººå¿…é¡»è·å¾—é›†ç¾¤ä¸­å¤§å¤šæ•°èŠ‚ç‚¹çš„åŒæ„ï¼Œè¿™ç¡®ä¿äº†æ‰€æœ‰å·²æäº¤çš„æ—¥å¿—æ¡ç›®è‡³å°‘å­˜åœ¨äºä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚å¦‚æœå€™é€‰äººçš„æ—¥å¿—è‡³å°‘å’Œå¤§å¤šæ•°çš„æœåŠ¡å™¨èŠ‚ç‚¹ä¸€æ ·æ–°ï¼Œé‚£ä¹ˆä»–ä¸€å®šæŒæœ‰äº†æ‰€æœ‰å·²ç»æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚è¯·æ±‚æŠ•ç¥¨RPC å®ç°äº†è¿™æ ·çš„é™åˆ¶ï¼šRPC ä¸­åŒ…å«äº†å€™é€‰äººçš„æ—¥å¿—ä¿¡æ¯ï¼Œç„¶åæŠ•ç¥¨äººä¼šæ‹’ç»æ‰é‚£äº›æ—¥å¿—æ²¡æœ‰è‡ªå·±æ–°çš„æŠ•ç¥¨è¯·æ±‚ã€‚ Rafté€šè¿‡æ¯”è¾ƒæ—¥å¿—ä¸­æœ€åä¸€æ¡æ¡ç›®çš„ä»»æœŸå·å’Œç´¢å¼•æ¥åˆ¤æ–­å“ªä¸ªæ—¥å¿—æ›´â€œæ–°â€ã€‚ å¦‚æœä»»æœŸå·ä¸åŒï¼Œä»»æœŸå·æ›´å¤§çš„æ—¥å¿—æ›´â€œæ–°â€ã€‚ å¦‚æœä»»æœŸå·ç›¸åŒï¼Œåˆ™æ¡ç›®æ›´å¤šï¼ˆç´¢å¼•å€¼æ›´å¤§ï¼‰çš„æ—¥å¿—æ›´â€œæ–°â€ã€‚ 5.4.2 æäº¤ä¹‹å‰ä»»æœŸå†…çš„æ—¥å¿—æ¡ç›® é¢†å¯¼äººåœ¨å½“å‰ä»»æœŸå†…åˆ›å»ºçš„æ—¥å¿—æ¡ç›®ï¼Œå½“è¢«å¤åˆ¶åˆ°å¤§å¤šæ•°æœåŠ¡å™¨ä¸Šæ—¶ï¼Œåˆ™å¯è®¤ä¸ºæ˜¯å¯æäº¤çš„ã€‚å¦‚æœä¸€ä¸ªé¢†å¯¼äººåœ¨æäº¤æ—¥å¿—æ¡ç›®ä¹‹å‰å´©æºƒäº†ï¼Œæœªæ¥åç»­çš„é¢†å¯¼äººä¼šç»§ç»­å°è¯•å¤åˆ¶è¿™æ¡æ—¥å¿—è®°å½•ã€‚ç„¶è€Œï¼Œå¯¹äºä¹‹å‰ä»»æœŸä¸­çš„æ—¥å¿—æ¡ç›®ï¼Œå³ä½¿å®ƒä»¬å·²ç»è¢«å¤åˆ¶åˆ°å¤§å¤šæ•°æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿä¸èƒ½ç®€å•åœ°é€šè¿‡å‰¯æœ¬æ•°é‡æ¥ç¡®å®šå®ƒä»¬æ˜¯å¦å·²æäº¤ï¼Œå¦‚å›¾8æ‰€ç¤ºã€‚è¿™æ˜¯å› ä¸ºåœ¨é¢†å¯¼äººå´©æºƒå’Œé‡æ–°é€‰ä¸¾çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°æ–°çš„é¢†å¯¼äººå¹¶ä¸åŒ…å«æ‰€æœ‰ä¹‹å‰ä»»æœŸçš„æ—¥å¿—æ¡ç›®ï¼Œè¿™å¯èƒ½å¯¼è‡´å·²å¤åˆ¶çš„æ—¥å¿—è¢«è¦†ç›–ã€‚ ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒRaftä¸ä¼šé€šè¿‡å‰¯æœ¬æ•°ç›®å»æäº¤ä¸€ä¸ªä¹‹å‰ä»»æœŸå†…çš„æ—¥å¿—æ¡ç›®ï¼Œåªæœ‰å½“å‰ä»»æœŸçš„æ—¥å¿—æ¡ç›®æ‰èƒ½é€šè¿‡å¤åˆ¶åˆ°å¤§å¤šæ•°æœåŠ¡å™¨æ¥æäº¤ã€‚ä¸€æ—¦å½“å‰ä»»æœŸçš„æ—¥å¿—æ¡ç›®è¢«æäº¤ï¼Œæ ¹æ®æ—¥å¿—åŒ¹é…ç‰¹æ€§ï¼Œä¹‹å‰ä»»æœŸçš„æ—¥å¿—æ¡ç›®ä¹Ÿä¼šè¢«é—´æ¥çš„æäº¤ã€‚ Raft åœ¨å¤„ç†æ—¥å¿—æ—¶ä¿ç•™äº†åŸå§‹çš„ä»»æœŸå·ï¼Œè¿™è™½ç„¶å¢åŠ äº†æäº¤è§„åˆ™çš„å¤æ‚æ€§ï¼Œä½†ç®€åŒ–äº†æ—¥å¿—çš„è¯†åˆ«å’Œç®¡ç†ã€‚ä¸å…¶å®ƒç®—æ³•ä¸åŒï¼ŒRaft åœ¨å¤åˆ¶ä¹‹å‰ä»»æœŸæ—¥å¿—ä¸éœ€è¦ä½¿ç”¨æ–°çš„ä»»æœŸå·ï¼Œåœ¨æäº¤å‰ä¸ç”¨å‘é€å†—ä½™çš„æ—¥å¿—æ¡ç›®æ¥é‡æ–°ç¼–å·ï¼Œ 5.4.3 å®‰å…¨æ€§è®ºè¯ åœ¨ Raft ç®—æ³•ä¸­ï¼Œé¢†å¯¼äººå®Œæ•´æ€§ç‰¹æ€§æ˜¯ç¡®ä¿ä¸€è‡´æ€§çš„å…³é”®ã€‚è¿™ä¸€ç‰¹æ€§ä¿è¯äº†åœ¨ä»»æœŸ T çš„é¢†å¯¼äººæäº¤çš„æ—¥å¿—æ¡ç›®ï¼Œå¿…é¡»è¢«å­˜å‚¨åœ¨æœªæ¥ä»»æœŸçš„é¢†å¯¼äººæ—¥å¿—ä¸­ã€‚ è®¾ä»»æœŸUï¼ˆ\u003eTï¼‰çš„é¢†å¯¼äººUç¼ºå¤±è¯¥æ¡ç›®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨Uçš„é€‰ä¸¾ä¸­ï¼Œè‡³å°‘å­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå¦‚S3ï¼‰åŒæ—¶æŒæœ‰Tä»»æœŸçš„æ—¥å¿—å¹¶æŠ•ç¥¨ç»™Uã€‚ å…³é”®ç‚¹ï¼šæ­¤èŠ‚ç‚¹åœ¨æŠ•ç¥¨å‰æ¥å—Tä»»æœŸå·²æäº¤æ—¥å¿—ï¼Œä¸”åœ¨æŠ•ç¥¨æ—¶ä»ä¿å­˜è¯¥æ¡ç›®ã€‚ çŸ›ç›¾ä¸€ï¼šæ­¤èŠ‚ç‚¹æŠŠè‡ªå·±é€‰ç¥¨æŠ•ç»™é¢†å¯¼äºº U æ—¶ï¼Œè¯´æ˜é¢†å¯¼äºº U çš„æ—¥å¿—å¿…é¡»å’ŒæŠ•ç¥¨è€…è‡ªå·±ä¸€æ ·æ–°ã€‚ä½†å‡è®¾Uä¸åŒ…å«Tä»»æœŸæäº¤çš„æ—¥å¿—ã€‚ çŸ›ç›¾äºŒï¼šè‹¥Uæœ€åæ—¥å¿—ä»»æœŸå¤§äºæ­¤èŠ‚ç‚¹ï¼Œåˆ™å‰é¢†å¯¼äººå¿…å«æäº¤æ—¥å¿—ï¼Œç”±æ—¥å¿—åŒ¹é…ç‰¹æ€§çŸ¥Uäº¦åº”å«è¯¥æ—¥å¿—ï¼Œäº§ç”ŸçŸ›ç›¾ã€‚ æ•…æ‰€æœ‰å¤§äºTä»»æœŸçš„é¢†å¯¼äººå¿…å®šåŒ…å«Tä»»æœŸä¸­æ‰€æœ‰å·²æäº¤æ—¥å¿—æ¡ç›®ã€‚æ—¥å¿—åŒ¹é…åŸåˆ™ç¡®ä¿æœªæ¥é¢†å¯¼äººåŒæ ·åŒ…å«é—´æ¥æäº¤çš„æ¡ç›®ã€‚é¢†å¯¼äººå®Œæ•´æ€§ç‰¹æ€§æ”¯æ’‘çŠ¶æ€æœºå®‰å…¨ç‰¹æ€§ï¼Œé˜²æ­¢ä¸åŒæ—¥å¿—åœ¨ç›¸åŒç´¢å¼•å€¼ä¸Šè¢«åº”ç”¨ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:5:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.5 è¿½éšè€…å’Œå€™é€‰äººå´©æºƒ å´©æºƒå½±å“ï¼šå´©æºƒå¯¼è‡´åç»­RPCå¤±è´¥ï¼Œå½±å“é€šä¿¡å’Œä¸€è‡´æ€§ã€‚ å¤„ç†æœºåˆ¶ï¼š æ— é™é‡è¯•ï¼šç³»ç»Ÿé€šè¿‡æŒç»­é‡è¯•RPCæ¥å¤„ç†è¿™ç±»å¤±è´¥ã€‚ é‡å¯æ¢å¤ï¼šå½“å´©æºƒæœåŠ¡å™¨é‡å¯ï¼Œæœªå®Œæˆçš„RPCèƒ½å¤Ÿç»§ç»­æ‰§è¡Œè‡³æˆåŠŸã€‚ RPCå¹‚ç­‰æ€§ä¿éšœï¼šæŒ‡å¤šæ¬¡æ‰§è¡Œç›¸åŒæ“ä½œäº§ç”Ÿçš„æ•ˆæœç­‰åŒäºä¸€æ¬¡æ‰§è¡Œï¼Œæ•…é‡å¤æ‰§è¡ŒRPCä¹Ÿä¸ä¼šå¼•èµ·ä¸ä¸€è‡´æˆ–é”™è¯¯çŠ¶æ€ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:5:5","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.6 æ—¶é—´å’Œå¯ç”¨æ€§ Raft ç®—æ³•çš„ä¸€ä¸ªæ ¸å¿ƒè¦æ±‚æ˜¯å®‰å…¨æ€§ä¸åº”ä¾èµ–äºæ—¶é—´ï¼Œå³ç³»ç»Ÿä¸åº”å› ä¸ºäº‹ä»¶çš„å¿«æ…¢è€Œäº§ç”Ÿé”™è¯¯çš„ç»“æœã€‚ç„¶è€Œï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§ï¼Œå³åŠæ—¶å“åº”å®¢æˆ·ç«¯çš„èƒ½åŠ›ï¼Œä¸å¯é¿å…åœ°ä¾èµ–äºæ—¶é—´å› ç´ ã€‚ç‰¹åˆ«æ˜¯åœ¨é¢†å¯¼äººé€‰ä¸¾è¿‡ç¨‹ä¸­ï¼Œæ—¶é—´è¦æ±‚å°¤ä¸ºå…³é”®ã€‚ å…³é”®çš„æ—¶é—´å› ç´ æœ‰ï¼š å¹¿æ’­æ—¶é—´ (Broadcast Time)ï¼šæœåŠ¡å™¨å‘é›†ç¾¤æˆå‘˜å¹¶è¡Œå‘é€RPCå¹¶æ¥æ”¶å“åº”çš„å¹³å‡æ—¶é—´ã€‚ é€‰ä¸¾è¶…æ—¶æ—¶é—´ (Election Timeout)ï¼šè·Ÿéšè€…ç­‰å¾…é¢†å¯¼äººå¿ƒè·³çš„æœ€é•¿æ—¶é™ï¼Œè¿‡æœŸåˆ™å‘èµ·é€‰ä¸¾ã€‚ å¹³å‡æ•…éšœé—´éš”æ—¶é—´ (Mean Time Between Failures, MTBF)ï¼šæœåŠ¡å™¨ä¸¤æ¬¡æ•…éšœä¹‹é—´çš„å¹³å‡æ—¶é—´ã€‚ Raft è¦æ±‚æ»¡è¶³ä»¥ä¸‹æ—¶é—´ä¸ç­‰å¼ä»¥ä¿è¯ç³»ç»Ÿæ­£å¸¸è¿è¡Œï¼š $\\text{Broadcast Time}\\ll\\text{Election Timeout}\\ll\\text{MTBF}$ å¹¿æ’­æ—¶é—´å’Œå¹³å‡æ•…éšœé—´éš”æ—¶é—´æ˜¯ç”±ç³»ç»Ÿå†³å®šçš„ï¼Œä½†æ˜¯é€‰ä¸¾è¶…æ—¶æ—¶é—´æ˜¯æˆ‘ä»¬è‡ªå·±é€‰æ‹©çš„ã€‚å¹¿æ’­æ—¶é—´å—å­˜å‚¨æŠ€æœ¯å½±å“ï¼ŒèŒƒå›´çº¦ä¸º$[0.5,20]\\text{ ms}$ï¼Œé€‰ä¸¾è¶…æ—¶æ—¶é—´åŸºäºå¹¿æ’­æ—¶é—´è®¾ç½®ï¼Œè¦æ¯”å¹¿æ’­æ—¶é—´å¤§å‡ ä¸ªæ•°é‡çº§ï¼Œä¸€èˆ¬åœ¨$[10,500]\\text{ ms}$ï¼Œè€ŒMTBFé€šå¸¸æ•°æœˆä»¥ä¸Šï¼Œè¿œå¤§äºé€‰ä¸¾è¶…æ—¶æ—¶é—´ï¼Œæ»¡è¶³ç³»ç»Ÿç¨³å®šè¿è¡Œéœ€æ±‚ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:5:6","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"6 é›†ç¾¤æˆå‘˜å˜åŒ– Raft ç®—æ³•åœ¨è®¾è®¡æ—¶å‡è®¾é›†ç¾¤é…ç½®æ˜¯å›ºå®šçš„ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé›†ç¾¤é…ç½®éœ€è¦åŠ¨æ€è°ƒæ•´ï¼Œå¦‚æ›¿æ¢å®•æœºçš„æœºå™¨æˆ–æ”¹å˜å¤åˆ¶çº§åˆ«ã€‚ç›´æ¥æ›´æ”¹é›†ç¾¤é…ç½®å­˜åœ¨é£é™©ï¼Œå¯èƒ½å¯¼è‡´åŒä¸€ä»»æœŸå†…ä¸¤ä¸ªé¢†å¯¼äººåŒæ—¶å­˜åœ¨ï¼Œå› æ­¤éœ€è¦ä¸€ç§å®‰å…¨çš„é…ç½®å˜æ›´æœºåˆ¶ã€‚ä¸ºäº†ç¡®ä¿é…ç½®å˜æ›´çš„å®‰å…¨æ€§ï¼Œå¿…é¡»é‡‡ç”¨ä¸¤é˜¶æ®µæ–¹æ³•ã€‚åœ¨Raftä¸­ï¼Œé›†ç¾¤åˆ‡æ¢åˆ°ä¸€ä¸ªè¿‡æ¸¡é…ç½®ï¼Œç§°ä¸ºè”åˆå…±è¯†ï¼Œç»“åˆäº†æ–°æ—§é…ç½®ï¼š æ—¥å¿—æ¡ç›®è¢«å¤åˆ¶ç»™æ–°æ—§é…ç½®çš„æ‰€æœ‰æœåŠ¡å™¨ã€‚ æ–°æ—§é…ç½®çš„æœåŠ¡å™¨éƒ½å¯ä»¥æˆä¸ºé¢†å¯¼äººã€‚ è¾¾æˆä¸€è‡´ï¼ˆé€‰ä¸¾å’Œæäº¤ï¼‰éœ€è¦åˆ†åˆ«åœ¨æ–°æ—§é…ç½®ä¸Šè·å¾—å¤§å¤šæ•°æ”¯æŒã€‚ è”åˆå…±è¯†å…è®¸ç‹¬ç«‹çš„æœåŠ¡å™¨åœ¨ä¸å½±å“å®‰å…¨æ€§çš„å‰æä¸‹ï¼Œåœ¨ä¸åŒçš„æ—¶é—´è¿›è¡Œé…ç½®è½¬æ¢è¿‡ç¨‹ã€‚æ­¤å¤–ï¼Œè”åˆå…±è¯†å¯ä»¥è®©é›†ç¾¤åœ¨é…ç½®è½¬æ¢çš„è¿‡ç¨‹ä¸­ä¾ç„¶å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚é…ç½®å˜æ›´è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¯·æ±‚æ¥æ”¶ï¼šé¢†å¯¼äººæ¥æ”¶åˆ°ä» $C_\\text{old}$ åˆ° $C_\\text{new}$ çš„é…ç½®å˜æ›´è¯·æ±‚ã€‚ è”åˆå…±è¯†æ—¥å¿—æ¡ç›®ï¼šé¢†å¯¼äººåˆ›å»º $C_\\text{old,new}$ é…ç½®æ¡ç›®å¹¶å°†å…¶ä½œä¸ºæ—¥å¿—æ¡ç›®å­˜å‚¨å’Œå¤åˆ¶ã€‚ æäº¤è”åˆå…±è¯†ï¼šä¸€æ—¦ $C_\\text{old,new}$ è¢«æäº¤ï¼Œæ–°æ—§é…ç½®éƒ½ä¸èƒ½å•æ–¹é¢åšå‡ºå†³å®šï¼Œåªæœ‰æ‹¥æœ‰ $C_\\text{old,new}$ æ—¥å¿—æ¡ç›®çš„æœåŠ¡å™¨æ‰èƒ½æˆä¸ºé¢†å¯¼äººã€‚ æ–°é…ç½®æ—¥å¿—æ¡ç›®ï¼šè¿™ä¸ªæ—¶å€™ï¼Œé¢†å¯¼äººåˆ›å»º $C_\\text{new}$ é…ç½®æ¡ç›®å¹¶å¤åˆ¶ç»™é›†ç¾¤ï¼Œæœ€ç»ˆåœ¨ $C_\\text{new}$ è§„åˆ™ä¸‹æäº¤ï¼Œæ—§çš„é…ç½®å˜å¾—æ— å…³ç´§è¦ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:6:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"7 æ—¥å¿—å‹ç¼© Raft ç®—æ³•é€šè¿‡å¤åˆ¶æ—¥å¿—æ¥ç»´æŠ¤ä¸€è‡´æ€§ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ—¥å¿—ä¼šä¸æ–­å¢é•¿ï¼Œå ç”¨å¤§é‡ç©ºé—´å¹¶å½±å“æ€§èƒ½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRaft ä½¿ç”¨å¿«ç…§æŠ€æœ¯å‹ç¼©æ—¥å¿—ï¼Œé€šè¿‡å­˜å‚¨ç³»ç»ŸçŠ¶æ€è‡³æŒä¹…åŒ–å­˜å‚¨ï¼Œéšåä¸¢å¼ƒå…ˆå‰æ—¥å¿—ã€‚ ä¸‹å›¾å±•ç¤ºäº†å¿«ç…§çš„åŸºæœ¬æ€æƒ³ï¼Œæ¯ä¸ªæœåŠ¡å™¨ç‹¬ç«‹åˆ›å»ºå¿«ç…§ï¼ŒåªåŒ…å«å·²æäº¤çš„æ—¥å¿—æ¡ç›®ï¼Œä¸»è¦çš„å·¥ä½œåŒ…æ‹¬å°†çŠ¶æ€æœºçš„çŠ¶æ€å†™å…¥å¿«ç…§ä¸­ã€‚Raftä¹ŸåŒ…å«ä¸€äº›å°‘é‡å…ƒæ•°æ®åˆ°å¿«ç…§ä¸­ï¼šæœ€åç´¢å¼•å’Œä»»æœŸå·ã€‚ä¿ç•™è¿™äº›æ•°æ®æ˜¯ä¸ºäº†æ”¯æŒä¸€è‡´æ€§æ£€æŸ¥ï¼Œå…è®¸æœåŠ¡å™¨æ¸…é™¤è¿‡æœŸæ—¥å¿—ã€‚ é¢†å¯¼äººå¶å°”ä¹Ÿéœ€è¦é€šè¿‡å®‰è£…å¿«ç…§RPCå°†å¿«ç…§åˆ†å—å‘é€ç»™ä¸€äº›è½åçš„è¿½éšè€…ï¼Œè¿½éšè€…æ”¶åˆ°å¿«ç…§åï¼Œä»–å¿…é¡»è‡ªå·±å†³å®šå¯¹äºå·²ç»å­˜åœ¨çš„æ—¥å¿—è¯¥å¦‚ä½•å¤„ç†ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯è¦†ç›–å†²çªæ—¥å¿—ï¼Œä¿ç•™åç»­æœªå†²çªæ—¥å¿—ã€‚ åœ¨å¿«ç…§æ—¶ï¼Œæœ‰ä¸¤ä¸ªæ€§èƒ½ç›¸å…³çš„å› ç´ éœ€è¦è€ƒè™‘ï¼š åˆ›å»ºæ—¶æœºï¼šæœåŠ¡å™¨éœ€è¦å†³å®šä½•æ—¶åˆ›å»ºå¿«ç…§ï¼Œä»¥é¿å…é¢‘ç¹å†™å…¥æˆ–å­˜å‚¨ç©ºé—´è€—å°½ã€‚Raft çš„ç­–ç•¥æ˜¯å½“æ—¥å¿—å¤§å°è¾¾åˆ°ä¸€ä¸ªé˜ˆå€¼ä¹‹åï¼Œå°±å¼€å§‹å¿«ç…§ã€‚ å†™å…¥æ—¶é—´ï¼šå†™å…¥å¿«ç…§å¯èƒ½éœ€è¦æ˜¾è‘—æ—¶é—´ï¼Œä¸ºäº†ä¸å½±å“æ­£å¸¸çš„æ“ä½œï¼Œåº”é€šè¿‡å†™æ—¶å¤åˆ¶æŠ€æœ¯é¿å…å½±å“æ­£å¸¸æ“ä½œã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:7:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"8 å®¢æˆ·ç«¯äº¤äº’ Raftä¸­çš„å®¢æˆ·ç«¯å‘é€æ‰€æœ‰è¯·æ±‚ç»™é¢†å¯¼äººã€‚å®¢æˆ·ç«¯åˆå§‹åŒ–æ—¶éšæœºé€‰æ‹©æœåŠ¡å™¨ï¼Œéé¢†å¯¼äººæœåŠ¡å™¨ä¼šæ‹’ç»å®¢æˆ·ç«¯è¯·æ±‚å¹¶æä¾›æœ€è¿‘æ¥æ”¶åˆ°çš„é¢†å¯¼äººä¿¡æ¯ã€‚å¦‚æœé¢†å¯¼äººå´©æºƒåï¼Œå®¢æˆ·ç«¯è¯·æ±‚è¶…æ—¶ï¼Œé‡å¯éšæœºé€‰æ‹©è¿‡ç¨‹ç›´è‡³æ‰¾åˆ°æ–°é¢†å¯¼äººã€‚ Raftç›®æ ‡æ˜¯è¦å®ç°çº¿æ€§åŒ–è¯­ä¹‰ï¼Œç”±äºRaftæ˜¯å¯èƒ½åŒæ—¶æ‰§è¡ŒåŒä¸€æ¡å‘½ä»¤å¤šæ¬¡çš„ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®¢æˆ·ç«¯ä¸ºæ¯æ¡æŒ‡ä»¤åˆ†é…å”¯ä¸€åºåˆ—å·ï¼ŒçŠ¶æ€æœºè·Ÿè¸ªæ¯ä¸ªå®¢æˆ·ç«¯çš„æœ€æ–°åºåˆ—å·å’Œç›¸åº”å“åº”ã€‚å¦‚æœæ¥æ”¶åˆ°çš„æŒ‡ä»¤åºåˆ—å·å·²ç»è¢«æ‰§è¡Œï¼ŒçŠ¶æ€æœºç›´æ¥è¿”å›ç»“æœè€Œä¸é‡æ–°æ‰§è¡Œã€‚ åªè¯»æ“ä½œå¯ä»¥ä¸å†™å…¥æ—¥å¿—ç›´æ¥å¤„ç†ã€‚ä½†ä¸è®°å½•æ—¥å¿—å¯èƒ½å¯¼è‡´è¿”å›è„æ•°æ®ï¼Œå³é¢†å¯¼äººåœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹è¢«æ–°é¢†å¯¼äººå–ä»£ã€‚çº¿æ€§åŒ–çš„è¯»æ“ä½œå¿…é¡»ä¸èƒ½è¿”å›è„æ•°æ®ï¼ŒRaft éœ€è¦ä½¿ç”¨ä¸¤ä¸ªé¢å¤–çš„æªæ–½åœ¨ä¸ä½¿ç”¨æ—¥å¿—çš„æƒ…å†µä¸‹ä¿è¯è¿™ä¸€ç‚¹ã€‚ æœ€æ–°æäº¤æ—¥å¿—ä¿¡æ¯ï¼šé¢†å¯¼äººéœ€è¦çŸ¥é“ä»»æœŸå†…æ‰€æœ‰è¢«æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚Raft é€šè¿‡è®©é¢†å¯¼äººåœ¨ä»»æœŸå¼€å§‹æ—¶æäº¤ä¸€ä¸ªç©ºç™½æ—¥å¿—æ¡ç›®æ¥å®ç°ã€‚ é¢†å¯¼äººçŠ¶æ€æ£€æŸ¥ï¼šåœ¨å¤„ç†åªè¯»è¯·æ±‚å‰ï¼Œé¢†å¯¼äººå¿…é¡»æ£€æŸ¥è‡ªå·±æ˜¯å¦å·²è¢«åºŸé»œã€‚Raft é€šè¿‡è®©é¢†å¯¼äººåœ¨å“åº”åªè¯»è¯·æ±‚å‰ä¸é›†ç¾¤å¤§å¤šæ•°èŠ‚ç‚¹äº¤æ¢å¿ƒè·³ä¿¡æ¯æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:8:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"9 æ€»ç»“ Raft æ˜¯ä¸€ç§ç”¨äºç®¡ç†å¤åˆ¶æ—¥å¿—çš„ä¸€è‡´æ€§ç®—æ³•ï¼Œæ—¨åœ¨è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€è‡´æ€§é—®é¢˜ã€‚å®ƒé€šè¿‡é¢†å¯¼äººé€‰ä¸¾ã€æ—¥å¿—å¤åˆ¶å’Œå®‰å…¨æ€§ä¿è¯æ¥å®ç°ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§å’Œä¸€è‡´æ€§ã€‚ Raft çš„äº”å¤§ä¿è¯ï¼š é€‰ä¸¾å®‰å…¨æ€§ï¼šåœ¨ä»»ä¸€ç»™å®šä»»æœŸå†…ï¼Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªé¢†å¯¼äººè¢«é€‰ä¸¾å‡ºæ¥ã€‚ é¢†å¯¼äººåªè¿½åŠ ï¼šé¢†å¯¼äººä¸ä¼šè¦†ç›–æˆ–åˆ é™¤å…¶æ—¥å¿—ä¸­çš„æ¡ç›®ï¼›å®ƒåªè¿½åŠ æ–°çš„æ¡ç›®ã€‚ æ—¥å¿—åŒ¹é…ï¼šå¦‚æœä¸¤ä¸ªæ—¥å¿—åœ¨ç›¸åŒç´¢å¼•å’Œä»»æœŸå·å¤„å«æœ‰ç›¸åŒçš„æ¡ç›®ï¼Œåˆ™åœ¨è¯¥ç´¢å¼•ä¹‹å‰çš„æ‰€æœ‰æ¡ç›®éƒ½æ˜¯ç›¸åŒçš„ã€‚ é¢†å¯¼äººå®Œæ•´æ€§ï¼šå¦‚æœä¸€ä¸ªæ—¥å¿—æ¡ç›®åœ¨ç»™å®šä»»æœŸè¢«æäº¤ï¼Œé‚£ä¹ˆè¯¥æ¡ç›®å°†å‡ºç°åœ¨æ‰€æœ‰æ›´é«˜ç¼–å·ä»»æœŸçš„é¢†å¯¼äººçš„æ—¥å¿—ä¸­ã€‚ çŠ¶æ€æœºå®‰å…¨æ€§ï¼šå¦‚æœä¸€ä¸ªæœåŠ¡å™¨å°†æŸä¸ªç´¢å¼•çš„æ—¥å¿—æ¡ç›®åº”ç”¨åˆ°å…¶çŠ¶æ€æœºä¸­ï¼Œå…¶ä»–æœåŠ¡å™¨ä¸ä¼šå¯¹è¯¥ç´¢å¼•åº”ç”¨ä¸åŒçš„æ—¥å¿—æ¡ç›®ã€‚ ","date":"2024-07-19","objectID":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/:9:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","Raft"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘In Search of an Understandable Consensus Algorithm (Extended Version)","uri":"/posts/03.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0in-search-of-an-understandable-consensus-algorithm-extended-version/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"1 å¼•è¨€ ç°æœ‰3Dç”Ÿæˆæ¨¡å‹ï¼š 3Dç‚¹äº‘ï¼šå¤§é‡ç¦»æ•£çš„3Dç‚¹ç»„æˆçš„æ•°æ®è¡¨ç¤ºå½¢å¼ï¼› å¤šè¾¹å½¢ç½‘æ ¼ï¼šä¸€ç³»åˆ—ç›¸è¿çš„å¤šè¾¹å½¢ç»„æˆçš„3Dæ¨¡å‹ï¼› æ°´å¹³é›†åœºï¼šä½¿ç”¨æ•°å€¼å‡½æ•°æ¥è¡¨ç¤ºç‰©ä½“çš„è¾¹ç•Œï¼Œå¹¶æ ¹æ®å‡½æ•°å€¼çš„æ­£è´Ÿæ¥ç¡®å®šç‰©ä½“å†…éƒ¨å’Œå¤–éƒ¨çš„åŒºåŸŸï¼› ä»…èƒ½åˆ›å»º3Då½¢çŠ¶çš„ç¦»æ•£è¡¨ç¤ºï¼Œéƒ½ç¼ºå°‘ç”Ÿæˆ3Då½¢çŠ¶è®¾è®¡æœ¬è´¨çš„èƒ½åŠ›â€”ç»˜åˆ¶è¿‡ç¨‹ã€‚ ä½œè€…æå‡ºäº†ä¸€ä¸ªæ·±åº¦ç”Ÿæˆç½‘ç»œDeepCADï¼Œèƒ½å¤Ÿè¾“å‡ºCADå·¥å…·ï¼ˆå¦‚AutoCADï¼‰ä¸­ç”¨äºæ„å»º3Då½¢çŠ¶çš„æ“ä½œåºåˆ—ï¼Œè¿™æ˜¯CADæ¨¡å‹çš„â€œç»˜åˆ¶â€è¿‡ç¨‹ã€‚ è¿™æ˜¯CADè®¾è®¡çš„ç”Ÿæˆæ¨¡å‹çš„ç¬¬ä¸€ä¸ªå·¥ä½œï¼ŒæŒ‘æˆ˜åœ¨äºCADè®¾è®¡çš„é¡ºåºå’Œå‚æ•°åŒ–æ€§è´¨ã€‚CADæ¨¡å‹ç”±ä¸€ç³»åˆ—å‡ ä½•æ“ä½œï¼ˆä¾‹å¦‚ï¼Œæ›²çº¿è‰å›¾ã€æ‹‰ä¼¸ã€åœ†è§’ã€å¸ƒå°”ã€å€’è§’ï¼‰ç»„æˆï¼Œæ¯ä¸ªæ“ä½œç”±æŸäº›ä¸è§„åˆ™çš„å‚æ•°ï¼ˆç¦»æ•£æˆ–è¿ç»­ï¼‰æ§åˆ¶ã€‚æ•…ä»¥å‰å¼€å‘çš„3Dç”Ÿæˆæ¨¡å‹ä¸é€‚åˆCADæ¨¡å‹ç”Ÿæˆã€‚ ä¸ºäº†å…‹æœè¿™äº›æŒ‘æˆ˜ï¼Œéœ€è¦å¯»æ±‚ä¸€ç§èƒ½å¤Ÿåè°ƒCADæ¨¡å‹ä¸­çš„ä¸è§„åˆ™æ€§çš„è¡¨ç¤ºï¼Œä½œè€…è€ƒè™‘æœ€å¸¸ç”¨çš„CADæ“ä½œï¼ˆå‘½ä»¤ï¼‰ï¼Œå¹¶å°†å®ƒä»¬ç»Ÿä¸€åœ¨ä¸€ä¸ªå…¬å…±ç»“æ„ä¸­ï¼Œè¯¥ç»“æ„å¯¹å…¶å‘½ä»¤ç±»å‹ã€å‚æ•°å’Œåºåˆ—é¡ºåºè¿›è¡Œç¼–ç ï¼Œé€šè¿‡ç±»æ¯”CADå‘½ä»¤åºåˆ—å’Œè‡ªç„¶è¯­è¨€ï¼Œä½œè€…æå‡ºäº†ä¸€ç§åŸºäºTransformerç½‘ç»œçš„è‡ªç¼–ç å™¨ï¼Œå®ƒå°†CADæ¨¡å‹åµŒå…¥åˆ°æ½œåœ¨ç©ºé—´ä¸­ï¼Œç„¶åå°†æ½œåœ¨å‘é‡è§£ç æˆCADæ¨¡å‹ã€‚ã€codeã€‘ ä¸ºäº†è®­ç»ƒè¿™ä¸ªè‡ªç¼–ç å™¨ï¼Œä½œè€…è¿˜åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„CADå‘½ä»¤åºåˆ—æ•°æ®é›†ï¼Œä»¥ä¿ƒè¿›æœªæ¥åŸºäºå­¦ä¹ çš„CADè®¾è®¡çš„ç ”ç©¶ã€‚ã€datasetã€‘ ä¸‹å›¾æ˜¯DeepCADçš„ç”Ÿæˆæ¼”ç¤ºã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:1:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"2 ç›¸å…³å·¥ä½œ å‚æ•°åŒ–å½¢çŠ¶æ¨æ–­ æ·±åº¦å­¦ä¹ çš„è¿›æ­¥ä½¿å¾—ç¥ç»ç½‘ç»œæ¨¡å‹èƒ½å¤Ÿåˆ†æå‡ ä½•æ•°æ®ï¼Œæ¨æ–­å‡ºå‚æ•°åŒ–å½¢çŠ¶ã€‚å…·ä½“å·¥ä½œå¦‚ä¸‹ï¼š ParSeNetï¼šå°†3Dç‚¹äº‘åˆ†è§£ä¸ºä¸€ç»„å‚æ•°åŒ–çš„è¡¨é¢è¡¥ä¸ã€‚ PIE-NETï¼šä»3Dç‚¹äº‘ä¸­æå–å‚æ•°åŒ–çš„è¾¹ç•Œæ›²çº¿ã€‚ UV-Net å’Œ BrepNetï¼šä¸“æ³¨äºç¼–ç å‚æ•°åŒ–æ¨¡å‹çš„è¾¹ç•Œæ›²çº¿å’Œè¡¨é¢ã€‚ Liç­‰äººï¼šè®­ç»ƒäº†ä¸€ç§ç¥ç»ç½‘ç»œï¼Œåœ¨åˆæˆæ•°æ®ä¸Šå°†2Dç”¨æˆ·è‰å›¾è½¬æ¢ä¸ºCADæ“ä½œã€‚ Xuç­‰äººï¼šåº”ç”¨ç¥ç»å¼•å¯¼æœç´¢ï¼Œä»å‚æ•°åŒ–å®å¿ƒå½¢çŠ¶ä¸­æ¨æ–­å‡ºCADå»ºæ¨¡åºåˆ—ã€‚ 3Då½¢çŠ¶ç”Ÿæˆæ¨¡å‹ å¤§å¤šæ•°ç°æœ‰æ–¹æ³•ç”Ÿæˆç¦»æ•£å½¢å¼çš„3Då½¢çŠ¶ï¼Œå¦‚ä½“ç´ åŒ–å½¢çŠ¶ã€ç‚¹äº‘ã€å¤šè¾¹å½¢ç½‘æ ¼ã€éšå¼ç­¾åè·ç¦»åœºã€‚ç”Ÿæˆçš„å½¢çŠ¶å¯èƒ½å­˜åœ¨å™ªå£°ï¼Œç¼ºä¹é”åˆ©çš„å‡ ä½•ç‰¹å¾ï¼Œä¸ä¾¿äºç”¨æˆ·ç¼–è¾‘ã€‚æ–°æ–¹æ³•ä½¿ç”¨ç¥ç»ç½‘ç»œæ¨¡å‹ç”Ÿæˆ3Då½¢çŠ¶ä½œä¸ºä¸€ç³»åˆ—å‡ ä½•æ“ä½œã€‚ CSGNetï¼šåŸºäºä½“ç´ åŒ–å½¢çŠ¶è¾“å…¥æ¨æ–­CSGæ“ä½œåºåˆ—ã€‚ UCSG-Netï¼šæ— ç›‘ç£æƒ…å†µä¸‹æ¨æ–­CSGæ ‘ã€‚ é¢†åŸŸç‰¹å®šè¯­è¨€ï¼ˆDSLsï¼‰ï¼šé€šè¿‡DSLsåˆæˆ3Då½¢çŠ¶ï¼Œå¦‚ShapeAssemblyã€‚ ä½œè€…å·¥ä½œï¼šè‡ªç¼–ç å™¨ç½‘ç»œè¾“å‡ºä¸€ç³»åˆ—CADæ“ä½œæŒ‡å®šçš„CADæ¨¡å‹ã€‚CADæ¨¡å‹æˆä¸ºå·¥ä¸šç”Ÿäº§æ ‡å‡†å½¢çŠ¶è¡¨ç¤ºï¼Œå¯ä»¥ç›´æ¥å¯¼å…¥CADå·¥å…·è¿›è¡Œç”¨æˆ·ç¼–è¾‘ï¼Œä¹Ÿå¯è½¬æ¢ä¸ºç‚¹äº‘å’Œå¤šè¾¹å½¢ç½‘æ ¼ã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªç›´æ¥ç”ŸæˆCADè®¾è®¡çš„ç”Ÿæˆæ¨¡å‹ã€‚ åŸºäºTransformerçš„æ¨¡å‹ Transformerç½‘ç»œä½œä¸ºåŸºäºæ³¨æ„åŠ›çš„æ„å»ºæ¨¡å—ï¼ŒæˆåŠŸåº”ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ã€å›¾åƒå¤„ç†å’Œå…¶ä»–ç±»å‹æ•°æ®ã€‚å¹¶è¡Œå·¥ä½œåœ¨çº¦æŸçš„CADè‰å›¾ç”Ÿæˆä¸Šä¹Ÿä¾èµ–äºTransformerç½‘ç»œã€‚ ä¸ä½œè€…å·¥ä½œç›¸å…³çš„è¿˜æœ‰DeepSVG-ç”¨äºç”Ÿæˆå¯ç¼©æ”¾çŸ¢é‡å›¾ï¼ˆSVGï¼‰å›¾åƒçš„Transformerç½‘ç»œã€‚SVGå›¾åƒç”±å‚æ•°åŒ–åŸè¯­ï¼ˆå¦‚ç›´çº¿å’Œæ›²çº¿ï¼‰æè¿°ï¼ŒåŸè¯­æ— ç‰¹å®šé¡ºåºæˆ–ä¾èµ–å…³ç³»ã€‚ ä¸SVGä¸åŒï¼ŒCADå‘½ä»¤åœ¨3Dä¸­æè¿°ï¼Œå¯ä»¥æ˜¯ç›¸äº’ä¾èµ–çš„ï¼Œå¿…é¡»éµå¾ªç‰¹å®šé¡ºåºã€‚æ‰€ä»¥éœ€è¦å¯»æ±‚ä¸€ç§æ–°çš„æ–¹æ³•åœ¨åŸºäºTransformerçš„è‡ªç¼–ç å™¨ä¸­ç¼–ç CADå‘½ä»¤åŠå…¶é¡ºåºã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:2:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"3 æ–¹æ³• DeepCADå›´ç»•å¯¹CADå‘½ä»¤åºåˆ—çš„æ–°è¡¨ç¤ºæ–¹æ³•ï¼ˆ3.1.2ï¼‰ï¼Œè¿™ç§CADè¡¨ç¤ºæ–¹æ³•ç‰¹åˆ«é€‚åˆäºè¾“å…¥åˆ°ç¥ç»ç½‘ç»œä¸­ã€‚æ­¤å¤–ï¼Œè¿™ç§è¡¨ç¤ºæ³•è¿˜å¼•å¯¼å‡ºä¸€ä¸ªè‡ªç„¶çš„è®­ç»ƒç›®æ ‡å‡½æ•°ï¼ˆ3.4ï¼‰ã€‚ä¸ºäº†è®­ç»ƒDeepCADï¼Œä½œè€…åˆ›å»ºäº†ä¸€ä¸ªæ–°æ•°æ®é›†ï¼Œå…¶è§„æ¨¡è¿œè¿œå¤§äºåŒç±»æ•°æ®é›†ï¼ˆ3.3ï¼‰ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:3:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"3.1 ç¥ç»ç½‘ç»œçš„CADè¡¨ç¤º CAD æ¨¡å‹æä¾›äº†ä¸¤ä¸ªå±‚æ¬¡çš„è¡¨ç¤ºã€‚ åœ¨ç”¨æˆ·äº¤äº’å±‚é¢ï¼ŒCAD æ¨¡å‹è¢«æè¿°ä¸ºç”¨æˆ·åœ¨ CAD è½¯ä»¶ä¸­åˆ›å»ºå®å¿ƒå½¢çŠ¶æ—¶æ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼Œä¾‹å¦‚ç”¨æˆ·åœ¨äºŒç»´å¹³é¢ä¸Šç»˜åˆ¶ä¸€ä¸ªé—­åˆæ›²çº¿è½®å»“ï¼Œç„¶åå°†å…¶æ‹‰ä¼¸æˆä¸‰ç»´å®å¿ƒå½¢çŠ¶ï¼Œå†é€šè¿‡å¸ƒå°”è¿ç®—ç­‰è¿›è¡Œå¤„ç†ã€‚æˆ‘ä»¬å°†è¿™ç§è§„èŒƒç§°ä¸º CAD å‘½ä»¤åºåˆ—ã€‚ åœ¨å‘½ä»¤åºåˆ—èƒŒåï¼Œæ˜¯ CAD æ¨¡å‹çš„å†…æ ¸è¡¨ç¤ºï¼Œå¹¿ä¸ºäººçŸ¥çš„æ˜¯è¾¹ç•Œè¡¨ç¤ºï¼ˆB-repï¼‰ã€‚ç»™å®šä¸€ä¸ªå‘½ä»¤åºåˆ—ï¼Œå…¶ B-rep ä¼šè‡ªåŠ¨è®¡ç®—å‡ºæ¥ï¼Œé€šå¸¸é€šè¿‡è¡Œä¸šæ ‡å‡†åº“ Parasolidã€‚å®ƒç”±æ‹“æ‰‘ç»„ä»¶åŠå…¶è¿æ¥ç»„æˆï¼Œä»¥å½¢æˆä¸€ä¸ªå®å¿ƒå½¢çŠ¶ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç”Ÿæˆ CAD å‘½ä»¤åºåˆ—çš„æ¨¡å‹ï¼Œè€Œä¸æ˜¯ B-repã€‚è¿™æ˜¯å› ä¸º B-rep æ˜¯å‘½ä»¤åºåˆ—çš„æŠ½è±¡ï¼šå‘½ä»¤åºåˆ—å¯ä»¥å¾ˆå®¹æ˜“åœ°è½¬æ¢ä¸º B-repï¼Œä½†åä¹‹åˆ™å¾ˆéš¾ï¼Œå› ä¸ºä¸åŒçš„å‘½ä»¤åºåˆ—å¯èƒ½ä¼šç”Ÿæˆç›¸åŒçš„ B-repã€‚æ­¤å¤–ï¼Œå‘½ä»¤åºåˆ—æ˜¯äººç±»å¯ç†è§£çš„ï¼Œä¾¿äºç¼–è¾‘å’Œåº”ç”¨äºå„ç§ä¸‹æ¸¸ä»»åŠ¡ã€‚ 3.1.1 CADå‘½ä»¤çš„è§„èŒƒ CAD å·¥å…·æ”¯æŒä¸°å¯Œçš„å‘½ä»¤é›†ï¼Œä½œè€…ä»…è€ƒè™‘äº†ä¸€ç»„å¸¸ç”¨çš„å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤åˆ†ä¸ºä¸¤ç±»ï¼šè‰å›¾å’Œæ‹‰ä¼¸ã€‚ å°½ç®¡æ¦‚å¿µä¸Šç®€å•ï¼Œä½†å®ƒä»¬è¶³å¤Ÿè¡¨è¾¾ç”Ÿæˆå„ç§å½¢çŠ¶ã€‚ è‰å›¾å‘½ä»¤ç”¨äºåœ¨ä¸‰ç»´ç©ºé—´ä¸­çš„äºŒç»´å¹³é¢ä¸ŠæŒ‡å®šé—­åˆæ›²çº¿ï¼Œæ¯ä¸ªé—­åˆæ›²çº¿ç§°ä¸ºä¸€ä¸ªç¯ï¼Œå¤šä¸ªç¯å½¢æˆä¸€ä¸ªé—­åˆåŒºåŸŸï¼Œç§°ä¸ºè½®å»“ã€‚æˆ‘ä»¬çš„è¡¨ç¤ºæ–¹æ³•ä¸­ï¼Œä¸€ä¸ªè½®å»“ç”±å…¶è¾¹ç•Œä¸Šçš„ç¯åˆ—è¡¨æè¿°ï¼ˆå¦‚Figure 2ä¸­çš„â€œSketch 1â€ï¼‰ï¼›ä¸€ä¸ªç¯æ€»æ˜¯ä»¥æŒ‡ç¤ºå‘½ä»¤å¼€å§‹ï¼Œåè·Ÿä¸€ç³»åˆ—æ›²çº¿å‘½ä»¤ã€‚æˆ‘ä»¬åˆ—å‡ºç¯ä¸Šçš„æ‰€æœ‰æ›²çº¿ï¼Œå¹¶æŒ‰é€†æ—¶é’ˆé¡ºåºæ’åˆ—ï¼Œå¼€å§‹ç‚¹ä¸ºæœ€å·¦ä¸‹è§’çš„æ›²çº¿ã€‚å®é™…ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸‰ç§æœ€å¸¸ç”¨çš„æ›²çº¿å‘½ä»¤ï¼šç”»ç›´çº¿ã€å¼§çº¿å’Œåœ†ã€‚è¿™äº›å‘½ä»¤å äº†æˆ‘ä»¬å¤§è§„æ¨¡ç°å®æ•°æ®é›†ä¸­ 92% çš„æ¯”ä¾‹ã€‚ æ¯ä¸ªæ›²çº¿å‘½ä»¤ç”±å…¶æ›²çº¿ç±»å‹ï¼ˆ$t_i\\in {\\langle\\text{SQL}\\rangle,\\text{L,A,R}}$ï¼‰å’Œå‚æ•°ï¼ˆTable 1ï¼‰æè¿°ï¼Œæ›²çº¿å‚æ•°æŒ‡å®šäº†æ›²çº¿åœ¨è‰å›¾å¹³é¢çš„å±€éƒ¨å‚è€ƒæ¡†æ¶ä¸­çš„äºŒç»´ä½ç½®ã€‚ç”±äºæ¯ä¸ªç¯ä¸­çš„æ›²çº¿æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªè¿æ¥çš„ï¼Œä¸ºäº†ç®€æ´ï¼Œæˆ‘ä»¬ä»å‚æ•°åˆ—è¡¨ä¸­æ’é™¤äº†æ›²çº¿çš„èµ·å§‹ä½ç½®ï¼›ç¬¬ä¸€æ¡æ›²çº¿æ€»æ˜¯ä»è‰å›¾å¹³é¢çš„åŸç‚¹å¼€å§‹ï¼ŒåŸç‚¹çš„ä¸–ç•Œç©ºé—´åæ ‡åœ¨æ‹‰ä¼¸å‘½ä»¤ä¸­æŒ‡å®šã€‚ç®€è¨€ä¹‹ï¼Œä¸€ä¸ªè‰å›¾è½®å»“ç”±ä¸€ä¸ªç¯åˆ—è¡¨æè¿°ï¼ˆ$S=[Q_1,\\dots,Q_N]$ï¼‰ï¼Œæ¯ä¸ªç¯$Q_i$ç”±ä¸€ç³»åˆ—ä»æŒ‡ç¤ºå‘½ä»¤å¼€å§‹çš„æ›²çº¿ç»„æˆï¼Œä¾‹å¦‚$Q_i=[\\langle\\text{SQL}\\rangle, C_1,\\dots,C_{n_i}]$ï¼Œæ¯ä¸ªæ›²çº¿å‘½ä»¤$C_j=(t_j,p_j)$æŒ‡å®šæ›²çº¿ç±»å‹$t_j$åŠå…¶å½¢çŠ¶å‚æ•°$p_j$ã€‚ æ‹‰ä¼¸å‘½ä»¤æœ‰ä¸¤ä¸ªç›®çš„ã€‚ å®ƒå°†è‰å›¾è½®å»“ä»äºŒç»´å¹³é¢æ‹‰ä¼¸æˆä¸‰ç»´å®ä½“ï¼Œæ‹‰ä¼¸ç±»å‹å¯ä»¥æ˜¯å•å‘ã€å¯¹ç§°æˆ–åŒå‘ã€‚ å®ƒé€šè¿‡å¸ƒå°”è¿ç®—æŒ‡å®šå¦‚ä½•å°†æ–°æ‹‰ä¼¸çš„ä¸‰ç»´å®ä½“ä¸å…ˆå‰åˆ›å»ºçš„å½¢çŠ¶åˆå¹¶ï¼šåˆ›å»ºæ–°å®ä½“ï¼Œæˆ–è€…ä¸ç°æœ‰å®ä½“è¿æ¥ã€åˆ‡å‰²æˆ–ç›¸äº¤ã€‚ æ‹‰ä¼¸å‘½ä»¤è¿˜éœ€è¦å®šä¹‰è‰å›¾å¹³é¢çš„ä¸‰ç»´æ–¹å‘å’Œå…¶äºŒç»´å±€éƒ¨å‚è€ƒæ¡†æ¶ï¼Œè¿™æ˜¯é€šè¿‡æ—‹è½¬çŸ©é˜µï¼ˆTable 1ä¸­$(\\theta,\\gamma,\\phi)$å‚æ•°ç¡®å®šï¼‰å®šä¹‰çš„ï¼ˆä¸ºäº†è·Ÿå¹³é¢å±€éƒ¨å‚è€ƒç³»å¯¹é½ï¼Œå¹¶å°†$z$è½´ä¸å¹³é¢çš„æ³•çº¿æ–¹å‘å¯¹é½ï¼‰ã€‚å‘½ä»¤å‚æ•°åŒ…æ‹¬ä¸€ä¸ªæ‹‰ä¼¸è½®å»“çš„æ¯”ä¾‹å› å­$s$ã€‚ é€šè¿‡è¿™äº›å‘½ä»¤ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ª CAD æ¨¡å‹$M$æè¿°ä¸ºäº¤æ›¿å‡ºç°çš„æ›²çº¿å‘½ä»¤å’Œæ‹‰ä¼¸å‘½ä»¤åºåˆ—ã€‚æ¢å¥è¯è¯´$M=[C_1,\\dots,C_{N_c}]$ï¼Œå…¶ä¸­æ¯ä¸ª$C_i=(c_i,p_i)$æŒ‡å®šå‘½ä»¤ç±»å‹å’Œå‚æ•°ã€‚ 3.1.2 ç½‘ç»œå‹å¥½çš„è¡¨ç¤º æˆ‘ä»¬çš„ CAD æ¨¡å‹ M çš„è§„èŒƒç±»ä¼¼äºè‡ªç„¶è¯­è¨€ï¼Œè¯æ±‡è¡¨ç”±ä¸€ç³»åˆ— CAD å‘½ä»¤ç»„æˆï¼Œå½¢æˆå¥å­ã€‚å¥å­çš„ä¸»è¯­æ˜¯è‰å›¾è½®å»“ï¼›è°“è¯­æ˜¯æ‹‰ä¼¸ã€‚è¿™ç§ç±»æ¯”è¡¨æ˜æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­æˆåŠŸçš„ç½‘ç»œç»“æ„ï¼ˆå¦‚ Transformer ç½‘ç»œï¼ŒLLMsï¼‰æ¥å®ç°æˆ‘ä»¬çš„ç›®æ ‡ã€‚ ç„¶è€Œï¼ŒCAD å‘½ä»¤åœ¨å‡ ä¸ªæ–¹é¢ä¸è‡ªç„¶è¯­è¨€ä¸åŒã€‚æ¯ä¸ªå‘½ä»¤æœ‰ä¸åŒæ•°é‡çš„å‚æ•°ã€‚åœ¨æŸäº›å‘½ä»¤ï¼ˆä¾‹å¦‚æ‹‰ä¼¸ï¼‰ä¸­ï¼Œå‚æ•°æ˜¯è¿ç»­å€¼å’Œç¦»æ•£å€¼çš„æ··åˆï¼Œå‚æ•°å€¼è·¨è¶Šä¸åŒèŒƒå›´ã€‚è¿™äº›ç‰¹æ€§ä½¿å¾—å‘½ä»¤åºåˆ—ä¸é€‚åˆç›´æ¥ç”¨äºç¥ç»ç½‘ç»œã€‚ ä¸ºäº†å…‹æœè¿™ä¸€æŒ‘æˆ˜ï¼Œæˆ‘ä»¬å¯¹å‘½ä»¤åºåˆ—çš„ç»´åº¦è¿›è¡Œæ­£åˆ™åŒ–ã€‚ é¦–å…ˆï¼Œå¯¹äºæ¯ä¸ªå‘½ä»¤ï¼Œå…¶å‚æ•°å †å æˆä¸€ä¸ª $16Ã—1$ çš„å‘é‡ï¼Œå…¶å…ƒç´ å¯¹åº”äºTable 1ä¸­æ‰€æœ‰å‘½ä»¤çš„é›†åˆå‚æ•°ï¼ˆä¾‹å¦‚$p_i=[x,y,\\alpha,f,r,\\theta,\\phi,\\gamma,p_x,p_y,p_z,s,e_1,e_2,b,u]$ï¼‰ã€‚æ¯ä¸ªå‘½ä»¤çš„æœªä½¿ç”¨å‚æ•°è®¾ç½®ä¸º -1ã€‚ æ¥ç€ï¼Œæˆ‘ä»¬å›ºå®šæ¯ä¸ª CAD æ¨¡å‹ $M$ çš„å‘½ä»¤æ€»æ•° $N_c$ï¼Œå¹¶é€šè¿‡æ·»åŠ ç©ºå‘½ä»¤æ¥å¡«å…… CAD æ¨¡å‹çš„å‘½ä»¤åºåˆ—ï¼Œç›´åˆ°åºåˆ—é•¿åº¦è¾¾åˆ° $N_c$ã€‚æˆ‘ä»¬é€‰æ‹© $N_c = 60$ï¼Œè¿™æ˜¯è®­ç»ƒæ•°æ®é›†ä¸­å‡ºç°çš„æœ€å¤§å‘½ä»¤åºåˆ—é•¿åº¦ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬é€šè¿‡é‡åŒ–è¿ç»­å‚æ•°æ¥ç»Ÿä¸€è¿ç»­å’Œç¦»æ•£å‚æ•°ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†æ¯ä¸ª CAD æ¨¡å‹è§„èŒƒåŒ–åˆ°ä¸€ä¸ª $2Ã—2Ã—2$ çš„ç«‹æ–¹ä½“å†…ï¼›æˆ‘ä»¬è¿˜å°†æ¯ä¸ªè‰å›¾è½®å»“è§„èŒƒåŒ–åˆ°å…¶è¾¹ç•Œæ¡†å†…ï¼Œå¹¶åœ¨æ‹‰ä¼¸å‘½ä»¤ä¸­åŒ…æ‹¬ä¸€ä¸ªæ¯”ä¾‹å› å­$s$æ¥æ¢å¤è§„èŒƒåŒ–è½®å»“åˆ°å…¶åŸå§‹å¤§å°ã€‚è¿™ç§è§„èŒƒåŒ–é™åˆ¶äº†è¿ç»­å‚æ•°çš„èŒƒå›´ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿå°†å…¶å€¼é‡åŒ–ä¸º $256$ ä¸ªçº§åˆ«ï¼Œå¹¶ä½¿ç”¨ $8$ ä½æ•´æ•°è¡¨ç¤ºã€‚ç»“æœæ˜¯ï¼Œæ‰€æœ‰å‘½ä»¤å‚æ•°éƒ½åªæœ‰ç¦»æ•£å€¼é›†åˆã€‚å‚æ•°é‡åŒ–ä¸ä»…æ˜¯è®­ç»ƒåŸºäº Transformer ç½‘ç»œçš„å¸¸è§å®è·µï¼Œå¯¹äº CAD æ¨¡å‹æ¥è¯´ï¼Œå®ƒå¯¹äºæé«˜ç”Ÿæˆè´¨é‡å°¤ä¸ºé‡è¦ã€‚åœ¨ CAD è®¾è®¡ä¸­ï¼Œå¿…é¡»éµå¾ªæŸäº›å‡ ä½•å…³ç³»ï¼Œä¾‹å¦‚å¹³è¡Œå’Œå‚ç›´çš„è‰å›¾çº¿æ¡ã€‚ç„¶è€Œï¼Œå¦‚æœç”Ÿæˆæ¨¡å‹ç›´æ¥ç”Ÿæˆè¿ç»­å‚æ•°ï¼Œé€šè¿‡å‚æ•°å›å½’è·å¾—çš„å€¼å®¹æ˜“äº§ç”Ÿé”™è¯¯ï¼Œç ´åè¿™äº›ä¸¥æ ¼çš„å…³ç³»ã€‚ç›¸åï¼Œå‚æ•°é‡åŒ–ä½¿ç½‘ç»œèƒ½å¤Ÿå°†å‚æ•°â€œåˆ†ç±»â€åˆ°ç‰¹å®šçº§åˆ«ï¼Œä»è€Œæ›´å¥½åœ°éµå¾ªå­¦ä¹ åˆ°çš„å‡ ä½•å…³ç³»ã€‚ ä½œè€…åœ¨ 4.1 ä¸­é€šè¿‡æ¶ˆèç ”ç©¶å®éªŒè¯æ˜å¯¹ CAD å‘½ä»¤è¡¨ç¤ºé€‰æ‹©çš„æ­£ç¡®æ€§ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:3:1","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"3.2 CADæ¨¡å‹çš„è‡ªç¼–ç å™¨ DeepCADçš„ç½‘ç»œæ¶æ„å¦‚ä¸‹ï¼š ä¸€æ—¦è®­ç»ƒå®Œæˆï¼Œç½‘ç»œçš„è§£ç å™¨éƒ¨åˆ†å°†è‡ªç„¶åœ°ä½œä¸º CAD ç”Ÿæˆæ¨¡å‹ã€‚æˆ‘ä»¬çš„è‡ªç¼–ç å™¨åŸºäº Transformer ç½‘ç»œï¼Œå—å…¶åœ¨å¤„ç†åºåˆ—æ•°æ®æ–¹é¢æˆåŠŸçš„å¯å‘ã€‚è‡ªç¼–ç å™¨è¾“å…¥ä¸€ä¸ª CAD å‘½ä»¤åºåˆ—$M = [C1,\\dots , C_{N_c}]$ï¼Œå…¶ä¸­ $N_c$ æ˜¯å›ºå®šæ•°é‡ã€‚ é¦–å…ˆï¼Œæ¯ä¸ªå‘½ä»¤ $C_i$ è¢«åˆ†åˆ«æŠ•å°„åˆ°ç»´åº¦ä¸º $d_E = 256$ çš„è¿ç»­åµŒå…¥ç©ºé—´ã€‚ç„¶åï¼Œå°†æ‰€æœ‰åµŒå…¥ç»„åˆèµ·æ¥è¾“å…¥ç¼–ç å™¨ $E$ï¼Œè¾“å‡ºä¸€ä¸ªæ½œåœ¨å‘é‡ $z\\in \\mathbb{R}^{256}$ã€‚è§£ç å™¨ä»¥æ½œåœ¨å‘é‡ $z$ ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºç”Ÿæˆçš„ CAD å‘½ä»¤åºåˆ— $\\hat{M}$ã€‚ åµŒå…¥éƒ¨åˆ† ä¸è‡ªç„¶è¯­è¨€å¤„ç†çš„æ–¹æ³•ç±»ä¼¼ï¼Œæˆ‘ä»¬é¦–å…ˆå°†æ¯ä¸ªå‘½ä»¤ $C_i$ æŠ•å°„åˆ°ä¸€ä¸ªå…¬å…±åµŒå…¥ç©ºé—´ã€‚ç„¶è€Œï¼Œä¸åŒäºè‡ªç„¶è¯­è¨€ä¸­çš„è¯è¯­ï¼Œä¸€ä¸ª CAD å‘½ä»¤ $C_i = (t_i, p_i)$ æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šå‘½ä»¤ç±»å‹ $t_i$ å’Œå‚æ•° $p_i$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°† $C_i$ çš„åµŒå…¥è®¡ç®—ä¸ºä¸‰ä¸ªåµŒå…¥çš„æ€»å’Œï¼Œå³ $$ e(C_i) = e^\\text{cmd}_i + e^{\\text{param}}_i + e^\\text{pos}_i\\in \\R^{d_E}, $$ ç¬¬ä¸€ä¸ªåµŒå…¥ $e^{\\text{cmd}}_i$ è¡¨ç¤ºå‘½ä»¤ç±»å‹ $t_i$ï¼Œç”± $e^\\text{cmd}_i=W_\\text{cmd} \\delta_i^c$ ç»™å‡ºã€‚è¿™é‡Œ $W_\\text{cmd}\\in\\R^{d_E\\times 6}$ æ˜¯ä¸€ä¸ªå¯å­¦ä¹ çŸ©é˜µï¼Œ$\\delta_i^c\\in \\R^6$ æ˜¯ä¸€ä¸ªæŒ‡ç¤ºå‘½ä»¤ç±»å‹ $t_i$ çš„ç‹¬çƒ­å‘é‡ã€‚ ç¬¬äºŒä¸ªåµŒå…¥$e^{\\text{param}}_i$ è€ƒè™‘å‘½ä»¤å‚æ•°ã€‚æ¯ä¸ªå‘½ä»¤æœ‰ $16$ ä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°è¢«é‡åŒ–ä¸ºä¸€ä¸ª $8$ ä½æ•´æ•°ã€‚æˆ‘ä»¬å°†è¿™äº›æ•´æ•°è½¬æ¢ä¸ºç»´åº¦ä¸º $2^8+1=257$ çš„ç‹¬çƒ­å‘é‡$\\delta^p_{i,j}(j=1\\dots16)$ï¼Œå¹¶å°†æ‰€æœ‰ç‹¬çƒ­å‘é‡å †å æˆçŸ©é˜µ$\\delta^p_i\\in\\R^{257\\times16}$ã€‚ç„¶åä½¿ç”¨å¦ä¸€ä¸ªå¯å­¦ä¹ çŸ©é˜µ $W_\\text{param}^b\\in\\R^{d_E\\times 257}$ å•ç‹¬åµŒå…¥æ¯ä¸ªå‚æ•°ï¼Œå¹¶é€šè¿‡çº¿æ€§å±‚ $W_\\text{param}^a\\in\\R^{d_E\\times 16d_E}$ç»„åˆè¿™äº›å•ç‹¬çš„åµŒå…¥ï¼Œå³ $$ e^{\\text{param}}_i=W_\\text{param}^a\\text{flat}(W_\\text{param}^b\\delta^p_i), $$ å…¶ä¸­$\\text{flat}(\\cdot)$å°†è¾“å…¥çŸ©é˜µå±•å¹³ä¸ºå‘é‡ æœ€åï¼Œä½ç½®åµŒå…¥ $e^\\text{pos}_i$ è¡¨ç¤ºå‘½ä»¤ $C_i$ åœ¨æ•´ä¸ªå‘½ä»¤åºåˆ—ä¸­çš„ç´¢å¼•ï¼Œç”± $e^\\text{pos}_i = W_\\text{pos}\\delta_i$ å®šä¹‰ï¼Œå…¶ä¸­ $W_\\text{pos}\\delta_i\\in\\R^{d_E\\times N_c}$ æ˜¯ä¸€ä¸ªå¯å­¦ä¹ çŸ©é˜µï¼Œ$\\delta_i\\in\\R^{N_c}$ æ˜¯ä¸€ä¸ªåœ¨ç´¢å¼• $i$ å¤„å¡«å…… $1$ å…¶ä»–ä½ç½®å¡«å……$0$çš„ç‹¬çƒ­å‘é‡ã€‚ ç¼–ç å™¨ ç¼–ç å™¨ $E$ ç”±å››å±‚ Transformer å—ç»„æˆï¼Œæ¯å±‚æœ‰å…«ä¸ªæ³¨æ„åŠ›å¤´å’Œ $512$ çš„å‰é¦ˆç»´åº¦ã€‚ç¼–ç å™¨å°†åµŒå…¥åºåˆ— $[e_1, \\dots, e_{N_c}]$ ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºå‘é‡ $[eâ€™_1,\\dots, eâ€™_{N_c}]$ï¼Œæ¯ä¸ªå‘é‡çš„ç»´åº¦ä¸º $d_E = 256$ã€‚è¾“å‡ºå‘é‡æœ€ç»ˆè¢«å¹³å‡ä»¥ç”Ÿæˆä¸€ä¸ª $d_E$ ç»´çš„æ½œåœ¨å‘é‡ $z$ã€‚ è§£ç å™¨ è§£ç å™¨ $D$ ä¹Ÿå»ºç«‹åœ¨ Transformer å—ä¸Šï¼Œå…·æœ‰ä¸ç¼–ç å™¨ç›¸åŒçš„è¶…å‚æ•°è®¾ç½®ã€‚å®ƒä»¥å­¦ä¹ åˆ°çš„å¸¸é‡åµŒå…¥ä¸ºè¾“å…¥ï¼ŒåŒæ—¶å…³æ³¨æ½œåœ¨å‘é‡ $z$ã€‚æœ€åä¸€ä¸ª Transformer å—çš„è¾“å‡ºè¢«é€å…¥çº¿æ€§å±‚ï¼Œä»¥é¢„æµ‹ CAD å‘½ä»¤åºåˆ— $\\hat{M} = [ \\hat{C}_1,\\dots, \\hat{C}_{N_c}]$ï¼ŒåŒ…æ‹¬æ¯ä¸ªå‘½ä»¤çš„å‘½ä»¤ç±»å‹ $\\hat{t}_i$ å’Œå‚æ•° $\\hat{t}_i$ã€‚ä¸è‡ªç„¶è¯­è¨€å¤„ç†ä¸­å¸¸ç”¨çš„è‡ªå›å½’ç­–ç•¥ä¸åŒï¼Œæˆ‘ä»¬é‡‡ç”¨å‰é¦ˆç­–ç•¥ï¼Œæ¨¡å‹çš„é¢„æµ‹å¯ä»¥åˆ†è§£ä¸º $$ p(\\hat{M}|z,\\Theta)=\\prod_{i=1}^{N_c}p(\\hat{t}_i,\\hat{p}_i|z,\\Theta), $$ å…¶ä¸­$\\Theta$è¡¨ç¤ºè§£ç å™¨çš„ç½‘ç»œå‚æ•°ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:3:2","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"3.3 CADæ•°æ®é›†çš„åˆ›å»º ç°æœ‰æ•°æ®é›†ï¼š ABCæ•°æ®é›†ï¼šè™½åŒ…å«ç™¾ä¸‡çº§åˆ«çš„CADè®¾è®¡ï¼Œä½†è¿™äº›è®¾è®¡é‡‡ç”¨B-repæ ¼å¼ï¼Œç¼ºä¹å¦‚ä½•é€šè¿‡CADæ“ä½œæ„å»ºè®¾è®¡çš„å…·ä½“ä¿¡æ¯ï¼› Fusion 360 Galleryæ•°æ®é›†ï¼šè™½ç„¶æä¾›äº†CADè®¾è®¡åŠå…¶æ„å»ºæŒ‡ä»¤åºåˆ—ï¼Œä½†è§„æ¨¡ä»…æœ‰çº¦8000ä¸ªè®¾è®¡ï¼Œä¸è¶³ä»¥è®­ç»ƒå‡ºæ³›åŒ–èƒ½åŠ›å¼ºå¤§çš„ç”Ÿæˆæ¨¡å‹ã€‚ é‰´äºæ­¤ï¼Œä½œè€…å†³å®šåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ã€å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†ä¸ä»…æ•°é‡åºå¤§ï¼Œè¿˜æä¾›äº†CADå‘½ä»¤åºåˆ—ï¼Œæ—¨åœ¨æ»¡è¶³è®­ç»ƒè‡ªåŠ¨ç¼–ç ç½‘ç»œçš„éœ€æ±‚ï¼Œå¹¶ä¸ºæœªæ¥çš„ç ”ç©¶æä¾›èµ„æºã€‚ æ–°æ•°æ®é›†æ„å»ºè¿‡ç¨‹å§‹äºABCæ•°æ®é›†ï¼š åˆ©ç”¨å…¶ä¸­æ¯ä¸ªCADæ¨¡å‹é“¾æ¥è‡³Onshapeçš„åŸå§‹è®¾è®¡ã€‚ æ¥ç€ï¼Œé€šè¿‡Onshapeçš„FeatureScriptè¯­è¨€ï¼ˆä¸€ç§ä¸“é—¨ç”¨äºè§£æCADæ“ä½œä¸å‚æ•°çš„é¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰ï¼Œä½œè€…ç­›é€‰å‡ºä»…ä½¿ç”¨â€œè‰å›¾â€å’Œâ€œæ‹‰ä¼¸â€æ“ä½œçš„æ¨¡å‹ï¼Œèˆå¼ƒäº†é‚£äº›é‡‡ç”¨æ›´å¤æ‚æ“ä½œçš„æ¨¡å‹ã€‚ å¯¹äºç¬¦åˆæ¡ä»¶çš„æ¨¡å‹ï¼Œä½œè€…ç¼–å†™äº†ä¸€æ®µFeatureScriptç¨‹åºæ¥æå–å…¶è‰å›¾è½®å»“å’Œæ‹‰ä¼¸æ“ä½œï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºTable 1ä¸­åˆ—å‡ºçš„å‘½ä»¤æ ¼å¼ã€‚ æœ€ç»ˆï¼Œä½œè€…æ”¶é›†åˆ°äº†æ€»è®¡178,238ä¸ªä»¥CADå‘½ä»¤åºåˆ—å½¢å¼æè¿°çš„CADè®¾è®¡ï¼Œè¿™ä¸ªæ•°é‡çº§è¿œè¶…ç°æœ‰åŒç±»å‹æ•°æ®é›†ã€‚æ•°æ®é›†è¿›ä¸€æ­¥è¢«éšæœºåˆ’åˆ†ä¸º90%çš„è®­ç»ƒé›†ã€5%çš„éªŒè¯é›†ä»¥åŠ5%çš„æµ‹è¯•é›†ï¼Œä»¥å¤‡è®­ç»ƒå’Œæµ‹è¯•ä¹‹ç”¨ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:3:3","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"3.4 è®­ç»ƒå’Œè¿è¡Œæ—¶ç”Ÿæˆ 3.4.1 è®­ç»ƒé˜¶æ®µ æˆ‘ä»¬åˆ©ç”¨æ„å»ºçš„æ•°æ®é›†å¯¹è‡ªç¼–ç å™¨ç½‘ç»œè¿›è¡Œè®­ç»ƒï¼Œé‡‡ç”¨æ ‡å‡†çš„äº¤å‰ç†µæŸå¤±å‡½æ•°ä½œä¸ºä¼˜åŒ–ç›®æ ‡ã€‚å…·ä½“è€Œè¨€ï¼Œå®šä¹‰é¢„æµ‹çš„CADæ¨¡å‹$\\hat{M}$ä¸çœŸå®æ¨¡å‹$M$ä¹‹é—´çš„æŸå¤±å‡½æ•°ä¸ºï¼š $$ \\mathcal{L} = \\sum_{i=1}^{N_c} \\ell(\\hat{t}_i,t_i) + \\beta \\sum_{i=1}^{N_c} \\sum_{j=1}^{N_p} \\ell(\\hat{p}_{i,j},p_{i,j}), $$ å…¶ä¸­ï¼Œ$\\mathcal{L}(Â·, Â·)$è¡¨ç¤ºæ ‡å‡†çš„äº¤å‰ç†µæŸå¤±ï¼Œ$N_p$æ¯ä¸ªå‘½ä»¤çš„å‚æ•°æ•°é‡ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œ$N_p = 16$ï¼‰ï¼Œè€Œ$\\beta$æ˜¯ä¸€ä¸ªæƒé‡é¡¹ï¼Œç”¨äºå¹³è¡¡ä¸¤é¡¹æŸå¤±ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œ$\\beta = 2$ï¼‰ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨çœŸå®çš„å‘½ä»¤åºåˆ—ä¸­ï¼Œæœ‰äº›å‘½ä»¤æ˜¯ç©ºçš„ï¼ˆå³å¡«å……å‘½ä»¤$\\langle \\text{EOS} \\rangle$ï¼‰ï¼Œè€Œæœ‰äº›å‘½ä»¤å‚æ•°æœªä½¿ç”¨ï¼ˆæ ‡è®°ä¸º$-1$ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™äº›å…ƒç´ å¯¹ä¸Šè¿°æŸå¤±å‡½æ•°ä¸­çš„æ±‚å’Œéƒ¨åˆ†ä¸åšè´¡çŒ®ã€‚ è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Adamä¼˜åŒ–å™¨ï¼Œåˆå§‹å­¦ä¹ ç‡ä¸º$0.001$ï¼Œå¹¶è®¾ç½®çº¿æ€§é¢„çƒ­æœŸä¸ºå‰$2000$æ­¥ã€‚æ‰€æœ‰Transformeræ¨¡å—çš„Dropoutç‡è®¾å®šä¸º$0.1$ï¼Œå¹¶åœ¨åå‘ä¼ æ’­ä¸­åº”ç”¨æ¢¯åº¦è£å‰ªå€¼ä¸º$1.0$ã€‚æˆ‘ä»¬ä»¥æ‰¹å¤„ç†å¤§å°$512$å¯¹ç½‘ç»œè¿›è¡Œ$1000$è½®çš„è®­ç»ƒã€‚ 3.4.2 CADç”Ÿæˆé˜¶æ®µ å½“è‡ªç¼–ç å™¨è®­ç»ƒå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª$256$ç»´çš„æ½œåœ¨å‘é‡$z$æ¥è¡¨ç¤ºä¸€ä¸ªCADæ¨¡å‹ã€‚ä¸ºäº†è‡ªåŠ¨ç”ŸæˆCADæ¨¡å‹ï¼Œæˆ‘ä»¬è¿ç”¨latent-GANæŠ€æœ¯äºå·²å­¦å¾—çš„æ½œåœ¨ç©ºé—´ä¸Šã€‚ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨éƒ½æ˜¯ç®€å•çš„å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ç½‘ç»œï¼Œå„è‡ªåŒ…å«å››å±‚éšè—å±‚ï¼Œå®ƒä»¬çš„è®­ç»ƒé‡‡ç”¨å¸¦æœ‰æ¢¯åº¦æƒ©ç½šçš„Wasserstein-GANç­–ç•¥ã€‚æœ€åï¼Œç”ŸæˆCADæ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬ä»å¤šå…ƒé«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·ä¸€ä¸ªéšæœºå‘é‡ï¼Œå¹¶å°†å…¶è¾“å…¥GANçš„ç”Ÿæˆå™¨ä¸­ã€‚GANçš„è¾“å‡ºæ˜¯ä¸€ä¸ªæ½œåœ¨å‘é‡$z$ï¼Œéšåå°†å…¶è¾“å…¥åŸºäºTransformerçš„è§£ç å™¨ï¼Œä»è€Œç”ŸæˆCADæ¨¡å‹ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:3:4","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"4 å®éªŒ æˆ‘ä»¬ä»ä¸¤ä¸ªè§’åº¦è¯„ä¼°æˆ‘ä»¬çš„è‡ªç¼–ç å™¨ç½‘ç»œï¼šCADæ¨¡å‹çš„è‡ªç¼–ç æ€§èƒ½ï¼ˆ4.1ï¼‰å’Œæ½œåœ¨ç©ºé—´å½¢çŠ¶ç”Ÿæˆï¼ˆ4.2ï¼‰ã€‚æˆ‘ä»¬è¿˜è®¨è®ºäº†å¯ä»¥å—ç›ŠäºCADç”Ÿæˆæ¨¡å‹çš„æ½œåœ¨åº”ç”¨ï¼ˆ4.3ï¼‰ã€‚ç”±äºä¹‹å‰æ²¡æœ‰é’ˆå¯¹CADè®¾è®¡çš„ç”Ÿæˆæ¨¡å‹ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€šè¿‡ä¸€ç³»åˆ—æ¶ˆèå®éªŒç†è§£æ¨¡å‹åœ¨ä¸åŒæŒ‡æ ‡ä¸‹çš„æ€§èƒ½ï¼Œå¹¶éªŒè¯æˆ‘ä»¬çš„ç®—æ³•é€‰æ‹©ã€‚ 4.0.3 CADæ¨¡å‹çš„è‡ªç¼–ç  è‡ªç¼–ç æ€§èƒ½é€šå¸¸ç”¨äºæŒ‡ç¤ºç”Ÿæˆæ¨¡å‹è¡¨è¾¾ç›®æ ‡æ•°æ®åˆ†å¸ƒçš„ç¨‹åº¦ã€‚æˆ‘ä»¬ä½¿ç”¨è‡ªç¼–ç å™¨ç½‘ç»œå¯¹è®­ç»ƒæ•°æ®é›†ä¸­ä¸å­˜åœ¨çš„CADæ¨¡å‹$M$è¿›è¡Œç¼–ç ï¼Œç„¶åå°†æ‰€å¾—çš„æ½œåœ¨å‘é‡è§£ç æˆCADæ¨¡å‹$\\hat{M}$ã€‚é€šè¿‡æ¯”è¾ƒ$M$å’Œ$\\hat{M}$çš„å·®å¼‚æ¥è¯„ä¼°è‡ªç¼–ç å™¨çš„æ€§èƒ½ã€‚ æŒ‡æ ‡ å‘½ä»¤å‡†ç¡®ç‡ï¼ˆ$\\text{ACC}_{\\text{cmd}}$ï¼‰ï¼šè¡¡é‡é¢„æµ‹çš„CADå‘½ä»¤ç±»å‹çš„æ­£ç¡®æ€§ï¼› $$ \\text{ACC}_{\\text{cmd}}=\\frac{1}{N_c} \\sum_{t=1}^{N_c}\\mathbb{I}[t_i=\\hat{t_i}] , $$ å‚æ•°å‡†ç¡®ç‡ï¼ˆ$\\text{ACC}_\\text{param}$ï¼‰ï¼šè¡¡é‡å‘½ä»¤å‚æ•°çš„æ­£ç¡®æ€§ï¼› $$ \\text{ACC}_\\text{param} = \\frac{1}{K} \\sum_{i=1}^{N_c} \\sum_{j=1}^{\\left| \\hat{p}_i \\right|} \\mathbb{I}[|p_{i,j} - \\hat{p}_{i,j}| \u003c \\eta]\\mathbb{I}[t_i = \\hat{t}_i], $$ å…¶ä¸­$K=\\sum_{i=1}^{N_c}\\mathbb{I}[t_i=\\hat{t}_i]|p_i|$æ˜¯æ‰€æœ‰æ­£ç¡®æ¢å¤å‘½ä»¤ä¸­çš„å‚æ•°æ€»æ•°ã€‚æ³¨æ„$p_{i,j}$å’Œ$\\hat{p}_{i,j}$éƒ½è¢«é‡åŒ–ä¸º$8$ä½æ•´æ•°ï¼Œé€‰æ‹©$\\eta$æ˜¯ä½œä¸ºè€ƒè™‘å‚æ•°é‡åŒ–çš„å®¹å·®é˜ˆå€¼ï¼Œåœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©äº†$\\eta=3$ï¼ˆ256ä¸ªçº§åˆ«ï¼‰ æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨Chamferè·ç¦»ï¼ˆCDï¼‰æ¥è¯„ä¼°3Då‡ ä½•ä½“çš„è´¨é‡ï¼Œé€šè¿‡å‡åŒ€é‡‡æ ·2000ä¸ªç‚¹æ¥è®¡ç®—å‚è€ƒå½¢çŠ¶å’Œç”Ÿæˆå½¢çŠ¶ä¹‹é—´çš„CDã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜æŠ¥å‘Šæ— æ•ˆç‡ï¼Œå³æ— æ³•è½¬æ¢ä¸ºç‚¹äº‘çš„è¾“å‡ºCADæ¨¡å‹çš„ç™¾åˆ†æ¯”ã€‚ æ¯”è¾ƒæ–¹æ³• ç”±äºç¼ºä¹ç°æœ‰çš„CADç”Ÿæˆæ¨¡å‹ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†å‡ ç§æ¨¡å‹å˜ä½“ä»¥éªŒè¯æˆ‘ä»¬çš„æ•°æ®è¡¨ç¤ºå’Œè®­ç»ƒç­–ç•¥ã€‚å…·ä½“åŒ…æ‹¬ä»¥ä¸‹å‡ ç§å˜ä½“ï¼šAlt-Relã€Alt-Transã€Alt-ArcMidã€Alt-Regrå’ŒOurs+Augã€‚æ¯ç§å˜ä½“åœ¨æ•°æ®è¡¨ç¤ºæˆ–è®­ç»ƒç­–ç•¥ä¸Šæœ‰æ‰€ä¸åŒã€‚ æ€»ä½“è€Œè¨€ï¼ŒOurs+Augï¼ˆå³ä½¿ç”¨åˆæˆæ•°æ®å¢å¼ºè®­ç»ƒï¼‰è¡¨ç°æœ€ä½³ï¼Œè¡¨æ˜éšæœºç»„åˆæ•°æ®å¯ä»¥æé«˜ç½‘ç»œçš„æ³›åŒ–èƒ½åŠ›ã€‚Alt-ArcMidçš„æ€§èƒ½ä¸Oursç›¸ä¼¼ï¼Œè¯´æ˜ä¸­ç‚¹è¡¨ç¤ºæ³•æ˜¯è¡¨ç¤ºå¼§çš„å¯è¡Œæ›¿ä»£æ–¹æ³•ã€‚Alt-Transåœ¨CDæ–¹é¢ç•¥é€ŠäºOursã€‚è™½ç„¶Alt-Relçš„å‚æ•°å‡†ç¡®ç‡ï¼ˆACCparamï¼‰é«˜äºOursï¼Œä½†å…¶CDåˆ†æ•°è¾ƒå¤§ä¸”æœ‰æ—¶ä¼šå‡ºç°æ— æ•ˆæ‹“æ‰‘ï¼Œä¾‹å¦‚åœ¨Figure 4ä¸­ç¬¬äºŒè¡Œä¸­çš„é»„è‰²æ¨¡å‹æœ‰ä¸¤ä¸ªä¸‰è§’å½¢ç¯è·¯ç›¸äº’ç›¸äº¤ï¼Œå¯¼è‡´æ‹“æ‰‘æ— æ•ˆï¼Œè¿™æ˜¯ç”±äºé¢„æµ‹æ›²çº¿ä½ç½®çš„è¯¯å·®ç´¯ç§¯å¯¼è‡´çš„ã€‚Alt-Regrç”±äºä¸é‡åŒ–è¿ç»­å‚æ•°ï¼Œè¯¯å·®è¾ƒå¤§ï¼Œå¯èƒ½ç ´åå…³é”®çš„å‡ ä½•å…³ç³»ï¼Œå¦‚å¹³è¡Œè¾¹å’Œå‚ç›´è¾¹ï¼Œä¾‹å¦‚Figure 4ä¸­çš„ç¬¬ä¸€è¡Œã€‚ æˆ‘ä»¬è¿˜éªŒè¯äº†æˆ‘ä»¬è‡ªç¼–ç å™¨çš„æ³›åŒ–ï¼Œåœ¨å…¶ä»–æ›´å°çš„æ•°æ®é›†ï¼ˆæ¥è‡ªAutodesk Fusion 360ï¼‰ä¸Šè¯„ä¼°å®ƒè¡¨ç°å‡ºè‰¯å¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œå®ç°äº†å¯æ¯”è¾ƒçš„å®šé‡æ€§èƒ½ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:4:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"4.1 å½¢çŠ¶ç”Ÿæˆ ç”±äºCADè®¾è®¡æ²¡æœ‰ç°æˆçš„ç”Ÿæˆæ¨¡å‹ï¼Œæˆ‘ä»¬é€‰æ‹©å°†æˆ‘ä»¬çš„æ¨¡å‹ä¸l-GANè¿›è¡Œæ¯”è¾ƒï¼Œl-GANæ˜¯ä¸€ç§è¢«å¹¿æ³›ç ”ç©¶çš„ç‚¹äº‘ä¸‰ç»´å½¢çŠ¶ç”Ÿæˆæ¨¡å‹ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å¹¶ä¸æ˜¯è¦æ˜¾ç¤ºå‡ºå­°ä¼˜å­°åŠ£ï¼Œå› ä¸ºè¿™ä¸¤ç§ç”Ÿæˆæ¨¡å‹æœ‰ä¸åŒçš„åº”ç”¨é¢†åŸŸã€‚ç›¸åï¼Œæˆ‘ä»¬è¯æ˜äº†æˆ‘ä»¬çš„æ¨¡å‹å³ä½¿åœ¨ç‚¹äº‘ç”Ÿæˆæ¨¡å‹çš„åº¦é‡ä¸‹ä¹Ÿèƒ½äº§ç”Ÿå¯æ¯”çš„å½¢çŠ¶è´¨é‡ã€‚ æ­¤å¤–ï¼Œå¦‚Figure 5æ‰€ç¤ºï¼Œæˆ‘ä»¬æ¨¡å‹ä¸­çš„å½¢çŠ¶å…·æœ‰æ›´æ¸…æ™°çš„å‡ ä½•ç»†èŠ‚ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°è¿›è¡Œç”¨æˆ·ç¼–è¾‘(Figure 7)ã€‚ ä¸ºäº†ä¸ç‚¹äº‘ç”Ÿæˆæ¨¡å‹è¿›è¡Œå®šé‡æ¯”è¾ƒï¼Œæˆ‘ä»¬éµå¾ªl-GANä¸­ä½¿ç”¨çš„æŒ‡æ ‡ã€‚è¿™äº›åº¦é‡æ ‡å‡†ç”¨äºè¡¡é‡ä¸¤ç»„3Dç‚¹äº‘å½¢çŠ¶ä¹‹é—´çš„å·®å¼‚ï¼Œå³çœŸå®å½¢çŠ¶é›†åˆ$S$å’Œç”Ÿæˆå½¢çŠ¶é›†åˆ$G$ã€‚ è¦†ç›–ç‡ï¼ˆCOVï¼‰ï¼šè¡¡é‡$S$ä¸­çš„å½¢çŠ¶æœ‰å¤šå°‘å¯ä»¥å¾ˆå¥½åœ°è¿‘ä¼¼ä¸ºGä¸­çš„å½¢çŠ¶ï¼› æœ€å°åŒ¹é…è·ç¦»ï¼ˆMMDï¼‰ï¼šè¡¨ç¤º$S$å’Œ$G$ä¸­ä¸¤ä¸ªç‚¹äº‘ä¹‹é—´çš„æœ€å°åŒ¹é…è·ç¦»æ¥è¡¡é‡$G$çš„ä¿çœŸåº¦ï¼› Jensen-Shannonæ•£åº¦(JSD)ï¼šè¡¡é‡$S$å’Œ$G$çš„ç‚¹äº‘åˆ†å¸ƒçš„ç›¸ä¼¼æ€§ ç„¶åï¼Œæˆ‘ä»¬å°†çœŸå®å’Œç”Ÿæˆçš„CADæ¨¡å‹è½¬æ¢ä¸ºç‚¹äº‘ï¼Œå¹¶è¯„ä¼°è¿™äº›åº¦é‡æ ‡å‡†ã€‚ç»“æœå¦‚ä¸‹ï¼š è¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•åœ¨ç‚¹äº‘åº¦é‡æ ‡å‡†æ–¹é¢ä¸l-GANå…·æœ‰å¯æ¯”æ€§çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œç”±äºå…¶å‚æ•°åŒ–è¡¨ç¤ºï¼ŒCADæ¨¡å‹å…·æœ‰æ¯”ç‚¹äº‘æ›´å¹³æ»‘çš„è¡¨é¢å’Œæ›´é”åˆ©çš„å‡ ä½•ç‰¹å¾ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:4:1","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"4.2 æœªæ¥åº”ç”¨ å€ŸåŠ©CADç”Ÿæˆæ¨¡å‹ï¼Œå¯ä»¥å°†ç‚¹äº‘ï¼ˆä¾‹å¦‚é€šè¿‡3Dæ‰«æè·å–çš„ï¼‰é‡å»ºä¸ºCADæ¨¡å‹ï¼Œä¾‹å¦‚ä½œè€…è¿™é‡Œä½¿ç”¨è‡ªç¼–ç å™¨å°†CADæ¨¡å‹$M$ç¼–ç ä¸ºæ½œåœ¨å‘é‡$c$ã€‚ç„¶åï¼Œåˆ©ç”¨PointNet++ç¼–ç å™¨è®­ç»ƒå®ƒå°†$M$çš„ç‚¹äº‘è¡¨ç¤ºç¼–ç ä¸ºç›¸åŒçš„æ½œåœ¨å‘é‡$c$ã€‚åœ¨æ¨æ–­æ—¶ï¼Œç»™å®šä¸€ä¸ªç‚¹äº‘ï¼Œæˆ‘ä»¬ä½¿ç”¨PointNet++ç¼–ç å™¨å°†å…¶æ˜ å°„åˆ°æ½œåœ¨å‘é‡ï¼Œç„¶åä½¿ç”¨æˆ‘ä»¬çš„è‡ªç¼–ç å™¨è§£ç ä¸ºCADæ¨¡å‹ã€‚ ç”Ÿæˆçš„CADæ¨¡å‹å¯ä»¥ç›´æ¥å¯¼å…¥CADå·¥å…·è¿›è¡Œç”¨æˆ·ç¼–è¾‘ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:4:2","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»","CAD"],"content":"5 æ€»ç»“ ä½œè€…æå‡ºäº†DeepCADï¼Œç¬¬ä¸€ä¸ªä¸€ä¸ªç”¨äºCADè®¾è®¡çš„æ·±åº¦ç”Ÿæˆæ¨¡å‹ã€‚å‡ ä¹æ‰€æœ‰ä»¥å‰çš„3Dç”Ÿæˆæ¨¡å‹éƒ½äº§ç”Ÿç¦»æ•£çš„3Då½¢çŠ¶ï¼Œå¦‚ä½“ç´ ã€ç‚¹äº‘å’Œç½‘æ ¼ã€‚ä¸ºæ­¤ï¼Œä½œè€…è¿˜å¼•å…¥äº†ä¸€ä¸ªå¤§å‹CADæ¨¡å‹æ•°æ®é›†ï¼Œæ¯ä¸ªæ¨¡å‹éƒ½è¡¨ç¤ºä¸ºä¸€ä¸ªCADå‘½ä»¤åºåˆ—ã€‚ åœ¨æ„å»ºCADç”Ÿæˆæ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œä½œè€…çš„æ–¹æ³•å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªä¸»è¦é™åˆ¶ï¼š æ›²çº¿å‘½ä»¤ç±»å‹æœ‰é™ï¼šç›®å‰ï¼Œä½œè€…ä»…è€ƒè™‘äº†ä¸‰ç§æœ€å¸¸ç”¨çš„æ›²çº¿å‘½ä»¤ç±»å‹ï¼ˆç›´çº¿ã€å¼§çº¿å’Œåœ†ï¼‰ã€‚ç„¶è€Œï¼Œå…¶ä»–æ›²çº¿å‘½ä»¤ä¹Ÿå¯ä»¥è½»æ¾æ·»åŠ ï¼Œä¾‹å¦‚å¯ä»¥é€šè¿‡ä¸‰ä¸ªæ§åˆ¶ç‚¹ä»¥åŠèµ·ç‚¹æ¥æŒ‡å®šçš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼Œå…¶å‚æ•°ç»“æ„å¯ä»¥æŒ‰ç…§3.1ä¸­æè¿°çš„æ–¹å¼è¿›è¡Œã€‚ æ“ä½œå‘½ä»¤çš„å±€é™æ€§ï¼šè™½ç„¶åƒæ—‹è½¬è‰å›¾è¿™æ ·çš„æ“ä½œå¯ä»¥ç±»ä¼¼äºæ‹‰ä¼¸å‘½ä»¤è¿›è¡Œç¼–ç ï¼Œä½†æŸäº›CADæ“ä½œï¼ˆå¦‚å€’è§’ï¼‰ä½œç”¨äºå½¢çŠ¶è¾¹ç•Œçš„éƒ¨åˆ†ï¼Œå› æ­¤éœ€è¦å‚è€ƒæ¨¡å‹çš„B-repï¼ˆè¾¹ç•Œè¡¨ç¤ºï¼‰ï¼Œè€Œä¸ä»…ä»…æ˜¯å…¶ä»–å‘½ä»¤ã€‚å°†è¿™äº›å‘½ä»¤çº³å…¥ç”Ÿæˆæ¨¡å‹ä»éœ€è¿›ä¸€æ­¥ç ”ç©¶ã€‚ æ‹“æ‰‘æœ‰æ•ˆæ€§æ— æ³•ä¿è¯ï¼šå¹¶éæ¯ä¸ªCADå‘½ä»¤åºåˆ—éƒ½èƒ½ç”Ÿæˆæ‹“æ‰‘ä¸Šæœ‰æ•ˆçš„å½¢çŠ¶ã€‚ä½œè€…çš„ç”Ÿæˆç½‘ç»œä¸èƒ½ä¿è¯å…¶è¾“å‡ºçš„CADåºåˆ—çš„æ‹“æ‰‘ä¸€è‡´æ€§ã€‚åœ¨å®è·µä¸­ï¼Œç”Ÿæˆçš„CADå‘½ä»¤åºåˆ—å¾ˆå°‘å¤±è´¥ï¼Œä½†éšç€å‘½ä»¤åºåˆ—å˜é•¿ï¼Œå¤±è´¥çš„å¯èƒ½æ€§å¢åŠ ã€‚ ","date":"2024-07-17","objectID":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/:5:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½","CAD"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘DeepCAD: A Deep Generative Network for Computer-Aided Design Models","uri":"/posts/05.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0deepcad/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"1 å¼•è¨€ å¾ªç¯ç¥ç»ç½‘ç»œ(RNN)ï¼Œç‰¹åˆ«æ˜¯é•¿çŸ­æœŸè®°å¿†å’Œé—¨æ§å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆç¼–ç å™¨-è§£ç å™¨æ¶æ„ï¼‰ï¼Œå·²æˆä¸ºåºåˆ—å»ºæ¨¡å’Œè½¬æ¢é—®é¢˜ï¼ˆå¦‚è¯­è¨€å»ºæ¨¡å’Œæœºå™¨ç¿»è¯‘ï¼‰çš„å…ˆè¿›æ–¹æ³•ï¼Œä¼—å¤šç ”ç©¶åœ¨ä¸æ–­æ¨åŠ¨å…¶å‘å±•ã€‚ ä½†RNNé€šå¸¸æ²¿è¾“å…¥å’Œè¾“å‡ºåºåˆ—çš„ç¬¦å·ä½ç½®è¿›è¡Œè®¡ç®—ï¼Œå…¶å›ºæœ‰çš„é¡ºåºæ€§å¯¼è‡´è®­ç»ƒç¤ºä¾‹å†…éš¾ä»¥å¹¶è¡ŒåŒ–ï¼Œåœ¨åºåˆ—é•¿åº¦è¾ƒé•¿æ—¶ï¼Œç”±äºå†…å­˜é™åˆ¶è·¨ç¤ºä¾‹çš„æ‰¹å¤„ç†ï¼Œè¿™ä¸€é—®é¢˜æ›´åŠ çªå‡ºã€‚å°½ç®¡è¿‘æœŸé€šè¿‡ä¸€äº›æŠ€æœ¯æ”¹è¿›äº†è®¡ç®—æ•ˆç‡ï¼Œä½†é¡ºåºè®¡ç®—çš„åŸºæœ¬é™åˆ¶ä»æœªæ”¹å˜ã€‚ ä¸”RNNä½¿ç”¨å…±äº«æƒå€¼çŸ©é˜µï¼Œåœ¨é¢ä¸´è¾ƒé•¿åºåˆ—æ—¶ï¼Œä¼šæœ‰æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜(ä¹Ÿå¯ä»¥è¯´æ˜¯åé¢è¯çš„æ¢¯åº¦ä¼šè¦†ç›–å‰é¢çš„æ¢¯åº¦)ã€‚å³ä½¿ååºçš„LSTMå’ŒGRUå¯¹è¿™ä¸€éƒ¨åˆ†åšäº†æ”¹è¿›ï¼Œä½†ä¹Ÿæ— æ³•å®Œå…¨è§£å†³è¯¥é—®é¢˜ã€‚ æ³¨æ„åŠ›æœºåˆ¶å·²æˆä¸ºå„ç§åºåˆ—å»ºæ¨¡å’Œè½¬æ¢æ¨¡å‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œèƒ½åœ¨ä¸è€ƒè™‘è¾“å…¥æˆ–è¾“å‡ºåºåˆ—è·ç¦»çš„æƒ…å†µä¸‹å¯¹ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¸å¾ªç¯ç½‘ç»œç»“åˆä½¿ç”¨ã€‚ ä½œè€…æå‡ºäº† Transformer æ¨¡å‹ï¼Œè¯¥æ¨¡å‹æ‘’å¼ƒäº†å¾ªç¯å•å…ƒå’Œå·ç§¯å•å…ƒï¼Œå®Œå…¨ä¾èµ–æ³¨æ„åŠ›æœºåˆ¶æ¥å»ºç«‹è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å…¨å±€ä¾èµ–å…³ç³»ï¼Œå…è®¸æ›´å¤šçš„å¹¶è¡ŒåŒ–ã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:1:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"2 èƒŒæ™¯ å‡å°‘åºåˆ—è®¡ç®—é‡å’ŒåŠ é€Ÿè®¡ç®—æ˜¯åºåˆ—å¤„ç†æ¨¡å‹ä¸­çš„åŸºæœ¬æ€æƒ³ã€‚ByteNetå’ŒConvS2Sé€šè¿‡ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œå¹¶è¡Œè®¡ç®—ï¼Œè®¡ç®—é‡å’Œåºåˆ—ä¸­ä½ç½®çš„è·ç¦»ç›¸å…³ã€‚ConvS2Sæ˜¯çº¿æ€§å…³ç³»ï¼Œè€ŒByteNetæ˜¯å¯¹æ•°å…³ç³»ï¼Œä½¿å¾—é•¿è·ç¦»å…³ç³»å­¦ä¹ å›°éš¾ã€‚Transformerå°†è¿™ä¸ªè¿‡ç¨‹å‡å°‘åˆ°å¸¸æ•°è§„æ¨¡ï¼Œå°½ç®¡é™ä½äº†æœ‰æ•ˆåˆ†è¾¨ç‡ï¼Œä½†å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶å¼¥è¡¥äº†è¿™ä¸€ç‚¹ã€‚ è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆå†…éƒ¨æ³¨æ„åŠ›æœºåˆ¶ï¼‰ä¸ºåºåˆ—çš„ä¸åŒä½ç½®åˆ†é…æƒé‡ï¼Œå¹¶å­¦ä¹ è¡¨ç¤ºå‘é‡ï¼Œå·²åœ¨é˜…è¯»ç†è§£ã€æ–‡æœ¬æ‘˜è¦ç­‰ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ã€‚ ç«¯åˆ°ç«¯è®°å¿†ç½‘ç»œé€šå¸¸åŸºäºå¾ªç¯æ³¨æ„åŠ›æœºåˆ¶ï¼Œå·²ç”¨äºç®€å•è¯­è¨€ç¿»è¯‘ç­‰ä»»åŠ¡ã€‚è€ŒTransformer æ˜¯ç¬¬ä¸€ä¸ªå®Œå…¨ä¾èµ–è‡ªæ³¨æ„åŠ›æ¥è®¡ç®—å…¶è¾“å…¥å’Œè¾“å‡ºè¡¨ç¤ºçš„è½¬æ¢æ¨¡å‹ã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:2:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"3 æ¨¡å‹æ¶æ„ Transformerä¸­æ²¿ç”¨äº†éå¸¸ç»å…¸çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„ï¼Œç¼–ç å™¨å°†è¾“å…¥çš„åºåˆ—$(x_1,\\dots,x_n)$è½¬åŒ–æˆä¸€ä¸ªè¡¨ç¤ºå‘é‡$\\boldsymbol{z}=(z_1,\\dots,z_n)$ï¼Œè€Œç¼–ç å™¨ä¾æ®å‘é‡$\\boldsymbol{z}$é€æ­¥ç”Ÿæˆè¾“å‡ºåºåˆ—$(y_1,\\dots,y_m)$ï¼Œå¹¶ä¸”æ¨¡å‹åœ¨æ¯ä¸ªæ­¥éª¤ä¸­éƒ½æ˜¯è‡ªå›å½’çš„ï¼Œä¼šå°†å…ˆå‰ç”Ÿæˆçš„ç¬¦å·ä½œä¸ºç”Ÿæˆä¸‹ä¸€ä¸ªçš„é¢å¤–è¾“å…¥ï¼Œä¾‹å¦‚è¿™ä¸€æ­¥è¦ç”Ÿæˆ$y_t$ï¼Œè¦å°†$(y_1,\\dots,y_{t-1})$éƒ½æ‹¿åˆ°ä¹Ÿä½œä¸ºè¾“å…¥ã€‚ åŒæ—¶Transformeræ¨¡å‹åœ¨ç¼–ç å™¨å’Œè§£ç å™¨ä¸­éƒ½ä½¿ç”¨å †å è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œé€ç‚¹å…¨è¿æ¥å±‚ï¼Œå¦‚ä¸‹å›¾çš„å·¦åŠéƒ¨åˆ†å’Œå³åŠéƒ¨åˆ†æ‰€ç¤ºã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:3:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"3.1 ç¼–ç å™¨å †å å’Œè§£ç å™¨å †å  ç¼–ç å™¨ç”± $6$ ä¸ªç›¸åŒçš„å±‚å †å è€Œæˆã€‚æ¯ä¸ªå±‚åŒ…å«ä¸¤ä¸ªå­å±‚ï¼šå¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œé€ä½ç½®å…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œã€‚æ¯ä¸ªå­å±‚éƒ½ä½¿ç”¨äº†æ®‹å·®è¿æ¥ï¼Œç„¶åè¿›è¡Œå±‚è§„èŒƒåŒ–ï¼ˆé˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆï¼‰ã€‚å‡è®¾æ¯ä¸€å±‚çš„è¾“å…¥æ˜¯$x$ï¼Œé‚£ä¹ˆæ¯ä¸€å±‚çš„è¾“å‡ºç»“æœå¯ä»¥è¡¨ç¤ºä¸ºï¼š $$ \\text{LayerNorm}(x+\\text{Sublayer(x)}) $$ å…¶ä¸­ $\\text{SubLayer}$æ˜¯å½“å‰å­å±‚æœ¬èº«å®ç°çš„è¿ç®—å‡½æ•°ï¼Œæ¯”å¦‚æ³¨æ„åŠ›è¿ç®—å’Œå…¨è¿æ¥è¿ç®—ï¼› æ¨¡å‹ä¸­çš„æ‰€æœ‰å­å±‚ä»¥åŠåµŒå…¥å±‚çš„è¾“å‡ºç»´åº¦å‡ä¸º $d_{\\text{model}} = 512$ï¼ˆä¾¿äºæ®‹å·®è¿æ¥ï¼‰ã€‚ è§£ç å™¨åŒæ ·ç”± 6 ä¸ªå±‚ç»„æˆã€‚å…¶ç»“æ„ä¸ç¼–ç å™¨ç±»ä¼¼ï¼Œä½†å¤šäº†ä¸€ä¸ªå¯¹ç¼–ç å™¨è¾“å‡ºè¿›è¡Œå…³æ³¨çš„å¤šå¤´æ³¨æ„åŠ›å­å±‚ã€‚å¹¶ä¸”åœ¨è‡ªæ³¨æ„åŠ›å­å±‚ä¸­è¿›è¡Œäº†ä¿®æ”¹ï¼Œä»¥é˜²æ­¢ä¿¡æ¯å·¦å‘æµåŠ¨ã€‚è¿™ç§æ©ç æœºåˆ¶ï¼Œç»“åˆè¾“å‡ºåµŒå…¥å‘é‡å‘ååç§»ä¸€ä¸ªä½ç½®ï¼Œç¡®ä¿ä½ç½® $i$ çš„é¢„æµ‹ä»…ä¾èµ–äºä½ç½®å°äº $i$ çš„å·²çŸ¥è¾“å‡ºã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:3:1","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"3.2 æ³¨æ„åŠ›æœºåˆ¶ æ³¨æ„åŠ›æœºåˆ¶å°±æ˜¯å¯¹ä¸€ç³»åˆ—çš„queryå’Œä¸€ç³»åˆ—çš„key-valueå¯¹ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šå¯¹äºæ¯ä¸ªqueryè€Œè¨€ä¸åŒ value çš„é‡è¦ç¨‹åº¦ï¼Œè€Œè¿™ä¸ªæƒé‡æ˜¯æ ¹æ® query å’Œkey çš„ç›¸å…³åº¦è®¡ç®—å¾—åˆ°çš„ã€‚ 3.2.1 ç¼©æ”¾çš„ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶ Transformeræ¨¡å‹ä¸­ä½¿ç”¨çš„æ˜¯ç¼©æ”¾çš„ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶ã€‚åœ¨è¿™ç§æœºåˆ¶ä¸­ï¼Œæ³¨æ„åŠ›è®¡ç®—æ¶‰åŠqueryå’Œkeyçš„ç»´åº¦ä¸º $d_k$ )ï¼Œä»¥åŠvalueçš„ç»´åº¦ä¸º $d_v$ ã€‚é€šè¿‡å¼•å…¥ä¸€ä¸ªç¼©æ”¾å› å­$\\sqrt{d_k}$ï¼Œå¯ä»¥æ§åˆ¶æ³¨æ„åŠ›åˆ†å¸ƒçš„ç¨³å®šæ€§å’Œè®¡ç®—æ•ˆç‡ã€‚ æˆ‘ä»¬ç”¨å‘é‡åŒ–çš„æ–¹å¼å¯ä»¥å°†è¿™ç§æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—è¿‡ç¨‹è¡¨ç¤ºæˆï¼š $$ \\text{Attention}(Q,K,V)=\\text{softmax}(\\frac{QK^T}{\\sqrt{d_k}})V $$ ä¸ä¼ ç»Ÿçš„æ³¨æ„åŠ›æœºåˆ¶ç›¸æ¯”ï¼Œç¼©æ”¾çš„ç‚¹ç§¯æ³¨æ„åŠ›è®¡ç®—é€Ÿåº¦æ›´å¿«ã€‚ç¼©æ”¾å‚æ•°ç”¨äºè°ƒèŠ‚æ³¨æ„åŠ›è®¡ç®—çš„è§„æ¨¡ï¼Œä»¥ç¡®ä¿å¯¹äºä¸åŒå¤§å°çš„è¾“å…¥ï¼Œæ³¨æ„åŠ›æƒé‡çš„è®¡ç®—ç»“æœéƒ½èƒ½ä¿æŒåœ¨åˆç†çš„èŒƒå›´å†…ã€‚ç‰¹åˆ«æ˜¯åœ¨$\\text{softmax}$å‡½æ•°çš„åº”ç”¨ä¸­ï¼Œç”±äºæŒ‡æ•°å‡½æ•°çš„å¿«é€Ÿå¢é•¿ç‰¹æ€§ï¼Œç¼©æ”¾å¯ä»¥æœ‰æ•ˆé˜²æ­¢æŸäº›æƒé‡è¿‡å¤§ï¼Œè€Œå…¶ä»–æƒé‡æ¥è¿‘é›¶çš„æƒ…å†µï¼Œç¡®ä¿äº†è®¡ç®—ç»“æœçš„å¹³ç¨³æ€§å’Œæœ‰æ•ˆæ€§ã€‚ 3.2.2 å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ 3.2.3 Transformeré‡‡ç”¨äº†å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œå°†queryã€keyå’Œvalueè¿›è¡Œ$h$æ¬¡æŠ•å½±ï¼Œç„¶åå¯¹$h$ä¸ªæŠ•å½±å¹¶è¡Œè®¡ç®—æ³¨æ„åŠ›ï¼Œå†å°†è¿™äº›ç»“æœç»„åˆå¹¶çº¿æ€§æŠ•å½±ç”Ÿæˆæœ€ç»ˆçš„å¤šå¤´æ³¨æ„åŠ›è¾“å‡ºã€‚å¤šå¤´æ³¨æ„åŠ›ä½¿æ¨¡å‹èƒ½å¤Ÿå…±åŒå…³æ³¨ä¸åŒè¡¨ç¤ºå­ç©ºé—´å’Œä¸åŒä½ç½®çš„ä¿¡æ¯ã€‚ å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—å…¬å¼ä¸ºï¼š $$ \\operatorname{MultiHead}(Q, K, V) = \\text{Concat}(\\text{head}_1, \\ldots, \\text{head}_h) W^O $$ å…¶ä¸­æ¯ä¸ªå¤´çš„è®¡ç®—æ–¹å¼ä¸ºï¼š $$ \\text{head}_i = \\text{Attention}(QW_i^Q, KW_i^K, VW_i^V) $$ å‚æ•°çš„ç»´åº¦å¦‚ä¸‹ï¼š $( Q, K, V)$ çš„è¾“å…¥ç»´åº¦ä¸º $( d_{model} )$ï¼ˆé€šå¸¸ä¸º$512$ï¼‰ $W_i^Q \\in \\mathbb{R}^{d_{model} \\times d_k}, W_i^K \\in \\mathbb{R}^{d_{model} \\times d_k}, W_i^V \\in \\mathbb{R}^{d_{model} \\times d_v}, W^O \\in \\mathbb{R}^{hd_v \\times d_{model}}$ ä½œè€…åœ¨Transformerä¸­è®¾ç½® $h = 8$ ä¸ªå¤´ï¼Œæ¯ä¸ªå¤´çš„ç»´åº¦ä¸º $d_k = d_v = \\frac{d_{model}}{h} = 64$ã€‚ 3.2.4 Transformerä¸­æ³¨æ„åŠ›æœºåˆ¶çš„åº”ç”¨ åœ¨è§£ç å™¨çš„â€œç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›å±‚â€ä¸­ï¼Œquery æ¥è‡ªä¸Šä¸€ä¸ªè§£ç å™¨å±‚ï¼Œè€Œ key å’Œå€¼ value æ¥è‡ªç¼–ç å™¨çš„è¾“å‡ºã€‚è¿™ä½¿å¾—è§£ç å™¨ä¸­çš„æ¯ä¸ªä½ç½®éƒ½å¯ä»¥å‚ä¸åˆ°è¾“å…¥åºåˆ—æ‰€æœ‰ä½ç½®çš„æ³¨æ„åŠ›è®¡ç®—ä¸­ã€‚ ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›å±‚ï¼š åœ¨è¿™ä¸€å±‚ä¸­ï¼Œquery æ¥è‡ªä¸Šä¸€ä¸ªè§£ç å™¨ï¼Œè€Œè®°å¿† key å’Œ value æ¥è‡ªç¼–ç å™¨çš„è¾“å‡ºã€‚è¿™ä½¿å¾—è§£ç å™¨ä¸­çš„æ¯ä¸ªä½ç½®éƒ½å¯ä»¥å…³æ³¨è¾“å…¥åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®ã€‚ ç¼–ç å™¨ä¸­çš„è‡ªæ³¨æ„åŠ›å±‚ï¼š ç¼–ç å™¨åŒ…å«è‡ªæ³¨æ„åŠ›å±‚ã€‚åœ¨è¿™ç§è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸­ï¼Œquery, key å’Œ value éƒ½æ¥è‡ªåŒä¸€ä½ç½®ï¼Œå³ç¼–ç å™¨å‰ä¸€å±‚çš„è¾“å‡ºã€‚è¿™æ ·ï¼Œç¼–ç å™¨ä¸­çš„æ¯ä¸ªä½ç½®éƒ½å¯ä»¥å…³æ³¨ç¼–ç å™¨å‰ä¸€å±‚ä¸­çš„æ‰€æœ‰ä½ç½®ï¼Œä»è€Œæ•æ‰è¾“å…¥åºåˆ—ä¸­ä¸åŒä½ç½®ä¹‹é—´çš„å…¨å±€ä¾èµ–å…³ç³»ã€‚ è§£ç å™¨ä¸­çš„è‡ªæ³¨æ„åŠ›å±‚ï¼š è§£ç å™¨ä¸­çš„è‡ªæ³¨æ„åŠ›å±‚çš„keyï¼Œvalueå’Œqueryä¹Ÿæ˜¯åŒæºçš„ã€‚ä½†ä¸ºäº†ä¿æŒè‡ªå›å½’å±æ€§ï¼Œé˜²æ­¢åºåˆ—ä¸­å‰é¢çš„å†…å®¹è¢«åé¢çš„å†…å®¹æ‰€å½±å“ï¼Œè§£ç å™¨åœ¨è‡ªæ³¨æ„åŠ›è®¡ç®—ä¸­åŠ å…¥äº†æ©ç æœºåˆ¶ã€‚å…·ä½“æ¥è¯´ï¼Œé€šè¿‡åœ¨ç¼©æ”¾çš„ç‚¹ç§¯æ³¨æ„åŠ›ä¸­ï¼Œå°†$\\operatorname{softmax}$è¾“å…¥ä¸­å¯¹åº”éæ³•è¿æ¥çš„å€¼è®¾ç½®ä¸º$-\\infin$ï¼Œæ¥å±è”½è¿™äº›è¿æ¥ã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:3:2","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"3.3 é€ä½ç½®å…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:3:3","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"3.4 Transformerä¸­çš„é€ä½ç½®å…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œ åœ¨Transformerä¸­ï¼Œé€ä½ç½®å…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œç”¨äºå¢å¼ºæ¨¡å‹å¯¹åºåˆ—ä¸­æ¯ä¸ªä½ç½®ä¿¡æ¯çš„å¤„ç†èƒ½åŠ›ï¼Œè¿™ç§ç½‘ç»œç»“æ„åŒ…å«ä¸¤ä¸ªçº¿æ€§å˜æ¢å±‚å’Œ$\\operatorname{ReLU}$æ¿€æ´»å‡½æ•°ï¼Œç”¨äºæ¯ä¸ªä½ç½®ç‹¬ç«‹åœ°è¿›è¡Œç›¸åŒçš„æ“ä½œã€‚å…¶æ•°å­¦è¡¨ç¤ºå¦‚ä¸‹ï¼š $$ \\text{FFN}(x) = \\max(0, x W_1 + b_1) W_2 + b_2 $$ è™½ç„¶ä¸åŒä½ç½®çš„çº¿æ€§å˜æ¢ç›¸åŒï¼Œä½†å„å±‚ä½¿ç”¨çš„å‚æ•°ä¸åŒã€‚å…¶ä¸­ï¼Œ$x$ æ˜¯è¾“å…¥å‘é‡ï¼Œç»´åº¦ä¸º $d_{\\text{model}} = 512$ ï¼Œè€Œå†…å±‚çš„ç»´åº¦ä¸º$d_{ff}=2048$ï¼Œ$W_1$ å’Œ $W_2$ æ˜¯ä¸¤ä¸ªçº¿æ€§å˜æ¢çš„æƒé‡çŸ©é˜µï¼Œ$b_1$ å’Œ $b_2$ æ˜¯ç›¸åº”çš„åç½®å‘é‡ã€‚è¿™ä¸ªç»“æ„ç±»ä¼¼äºkernel sizeä¸º1çš„å·ç§¯æ“ä½œã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:3:4","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"3.5 åµŒå…¥å’ŒSoftmax å’Œå…¶ä»–åºåˆ—è½¬æ¢æ¨¡å‹ç±»ä¼¼ï¼ŒTransformer ä½¿ç”¨å­¦ä¹ å¾—åˆ°çš„åµŒå…¥å°†è¾“å…¥çš„tokenå’Œè¾“å‡ºçš„tokenè½¬æ¢ä¸ºç»´åº¦ä¸º $ d_{\\text{model}} $ çš„å‘é‡ã€‚Transformer è¿˜ä½¿ç”¨å­¦ä¹ å¾—åˆ°çš„çº¿æ€§å˜æ¢å’Œ$\\text{softmax}$å‡½æ•°å°†è§£ç å™¨çš„è¾“å‡ºè½¬æ¢ä¸ºé¢„æµ‹çš„ä¸‹ä¸€ä¸ªtokençš„æ¦‚ç‡ã€‚åœ¨Transformerä¸­ä¸¤ä¸ªåµŒå…¥å±‚å’Œ$\\text{softmax}$ä¹‹å‰çš„çº¿æ€§å˜æ¢å±‚ä¹‹é—´å…±äº«ç›¸åŒçš„æƒé‡çŸ©é˜µï¼ˆå‡å°‘æ¨¡å‹çš„å‚æ•°æ•°é‡ï¼Œé™ä½è¿‡æ‹Ÿåˆçš„é£é™©ï¼‰ï¼ŒåŒæ—¶åœ¨åµŒå…¥å±‚ä¸­ï¼Œæˆ‘ä»¬å°†è¿™äº›æƒé‡ä¹˜ä»¥ $\\sqrt{d_{\\text{model}}}$ï¼ˆç¼©æ”¾åµŒå…¥æƒé‡ï¼Œé˜²æ­¢æ¢¯åº¦æ¶ˆå¤±ï¼‰ã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:3:5","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"3.6 ä½ç½®ç¼–ç  åœ¨Transformeræ¨¡å‹ä¸­ï¼Œç”±äºæ²¡æœ‰å¾ªç¯å’Œå·ç§¯å•å…ƒï¼Œä¸ºäº†å¤„ç†åºåˆ—æ•°æ®çš„ä½ç½®ä¿¡æ¯ï¼Œå¼•å…¥äº†ä½ç½®ç¼–ç ã€‚ä½ç½®ç¼–ç æ˜¯ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®æ·»åŠ ç‰¹å®šçš„å‘é‡è¡¨ç¤ºï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤ŸåŒºåˆ†ä¸åŒä½ç½®çš„tokenã€‚åœ¨Transformerä¸­çš„ä½ç½®ç¼–ç ä½¿ç”¨äº†sinå‡½æ•°å’Œcoså‡½æ•°ï¼Œè¿™ç§æ–¹æ³•ä¸åŒäºä¼ ç»Ÿçš„å­¦ä¹ å¾—åˆ°çš„ä½ç½®åµŒå…¥ï¼Œè€Œæ˜¯é‡‡ç”¨å›ºå®šçš„å‡½æ•°å½¢å¼ï¼Œå³ è¿™é‡Œçš„$\\text{pos}$è¡¨ç¤ºä½ç½®è€Œ$i$è¡¨ç¤ºç»´åº¦ï¼Œä¹Ÿå°±æ˜¯å¯¹äºä½äº$\\text{pos}$ä½ç½®çš„tokençš„åµŒå…¥å‘é‡ç¬¬$i$ç»´åŠ ä¸Šè¿™æ ·ä¸€ä¸ªå€¼ã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:3:6","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"4 ä¸ºä»€ä¹ˆä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ åœ¨å¤„ç†åºåˆ—æ•°æ®æ—¶ï¼Œé•¿è·ç¦»ä¾èµ–å…³ç³»çš„å­¦ä¹ æ˜¯ä¸€ä¸ªå…³é”®æŒ‘æˆ˜ã€‚è®ºæ–‡ä¸­å¯¹æ¯”äº†ä½¿ç”¨è‡ªæ³¨æ„åŠ›ã€å¾ªç¯å•å…ƒå’Œå·ç§¯å•å…ƒç­‰ä¸åŒæ¨¡å‹ç»“æ„æ—¶çš„è®¡ç®—é‡ã€æ—¶é—´å¤æ‚åº¦å’Œæœ€å¤§ä¾èµ–è·¯å¾„é•¿åº¦ã€‚å…¶ä¸­ï¼Œæœ€å¤§ä¾èµ–è·¯å¾„é•¿åº¦æŒ‡çš„æ˜¯ä»»æ„ä¸¤ä¸ªè¾“å…¥è¾“å‡ºä½ç½®ä¹‹é—´ä¿¡æ¯ä¼ é€’çš„æœ€é•¿è·¯å¾„ã€‚ åœ¨ä¼ ç»Ÿçš„å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ä¸­ï¼Œä¿¡æ¯æ˜¯é€æ­¥ä¼ é€’çš„ï¼Œå› æ­¤å…¨å±€è§†è§’ä¸‹ï¼Œä»»æ„ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„æœ€é•¿ä¿¡æ¯ä¼ é€’è·¯å¾„å¾€å¾€æ˜¯ä»¥åºåˆ—é•¿åº¦ $n$ ä¸ºé‡çº§çš„ã€‚è¿™ç§é€æ­¥ä¼ é€’å¯¼è‡´äº†RNNåœ¨æ•æ‰é•¿è·ç¦»ä¾èµ–æ—¶å¯èƒ½é¢ä¸´çš„æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†é•¿åºåˆ—æ—¶æ•ˆæœä¸ä½³ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼ŒTransformeråˆ©ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ç›´æ¥å°†æ¯ä¸ªä½ç½®ä¸æ‰€æœ‰å…¶ä»–ä½ç½®è¿›è¡Œå…³è”ï¼Œé¿å…äº†é€æ­¥ä¼ é€’çš„è¿‡ç¨‹ï¼Œä½¿å¾—ä»»æ„ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„ä¿¡æ¯ä¼ é€’è·¯å¾„å˜å¾—æä¸ºç›´æ¥å’Œé«˜æ•ˆã€‚è¿™ç§ç›´æ¥çš„è·¯å¾„ä¼ é€’æ–¹å¼ä½¿å¾—Transformerèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°æ•æ‰åˆ°é•¿è·ç¦»çš„ä¾èµ–å…³ç³»ï¼Œè€Œä¸å—åºåˆ—é•¿åº¦çš„é™åˆ¶ã€‚ å› æ­¤ï¼ŒTransformerå‡­å€Ÿå…¶ç‹¬ç‰¹çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œå®ç°äº†â€œAttention is all you needâ€çš„ç†å¿µï¼Œå¼ºè°ƒäº†åœ¨åºåˆ—å»ºæ¨¡ä¸­æ³¨æ„åŠ›æœºåˆ¶çš„é‡è¦æ€§å’Œæ•ˆæœã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ç§æ¨¡å‹ç»“æ„çš„åˆ›æ–°ï¼Œæ›´æ˜¯åœ¨è§£å†³é•¿è·ç¦»ä¾èµ–é—®é¢˜ä¸Šçš„ä¸€æ¬¡é‡å¤§çªç ´ã€‚Transformerçš„æˆåŠŸä¸ä»…åœ¨äºå…¶é«˜æ•ˆçš„ä¿¡æ¯ä¼ é€’è·¯å¾„ï¼Œè¿˜åœ¨äºå…¶èƒ½å¤Ÿåœ¨æ›´å¤§èŒƒå›´å†…æ•æ‰å’Œåˆ©ç”¨åºåˆ—ä¸­çš„å…³è”ä¿¡æ¯ï¼Œä»è€Œæå‡äº†åºåˆ—å»ºæ¨¡ä»»åŠ¡çš„æ€§èƒ½å’Œæ•ˆæœã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:4:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"5 è®­ç»ƒ åœ¨è®ºæ–‡ä¸­ï¼Œè®­ç»ƒTransformeræ¨¡å‹æ¶‰åŠåˆ°å‡ ä¸ªå…³é”®çš„ä¼˜åŒ–å’Œæ­£åˆ™åŒ–ç­–ç•¥ã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:5:0","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"5.1 ä¼˜åŒ–å™¨ æ¨¡å‹çš„è®­ç»ƒä½¿ç”¨äº†Adamä¼˜åŒ–å™¨ï¼Œå¹¶é‡‡ç”¨äº†ä¸€ç§è‡ªé€‚åº”çš„å­¦ä¹ ç‡ã€‚å­¦ä¹ ç‡ $\\text{lr}$ çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹æ‰€ç¤ºï¼š è¿™ç§è‡ªé€‚åº”å­¦ä¹ ç‡çš„è®¾è®¡æœ‰åŠ©äºåœ¨è®­ç»ƒåˆæœŸå¿«é€Ÿæå‡å­¦ä¹ ç‡ï¼Œä»¥åŠ é€Ÿæ¨¡å‹æ”¶æ•›ï¼Œè€Œåœ¨è®­ç»ƒåæœŸé€æ¸é™ä½å­¦ä¹ ç‡ï¼Œä»¥æ›´ç»†è‡´åœ°è°ƒæ•´æ¨¡å‹å‚æ•°ï¼Œæå‡è®­ç»ƒçš„ç¨³å®šæ€§å’Œæ•ˆæœã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:5:1","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["æ·±åº¦å­¦ä¹ ","è®ºæ–‡é˜…è¯»"],"content":"5.2 æ­£åˆ™åŒ– Transformeræ¨¡å‹é‡‡ç”¨äº†å¤šç§æ­£åˆ™åŒ–æ–¹æ³•ï¼Œä»¥æå‡æ³›åŒ–èƒ½åŠ›å’Œè®­ç»ƒç¨³å®šæ€§ï¼š æ®‹å·®è¿æ¥ï¼šåœ¨æ¯ä¸ªå­å±‚ä¹‹é—´éƒ½ä½¿ç”¨äº†æ®‹å·®è¿æ¥ï¼Œè¿™ç§è¿æ¥æ–¹å¼æœ‰åŠ©äºå‡å°‘æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå¹¶ç®€åŒ–äº†æ¨¡å‹çš„è®­ç»ƒå’Œä¼˜åŒ–è¿‡ç¨‹ã€‚ Dropoutï¼šåœ¨è¾“å…¥åµŒå…¥å‘é‡å’Œä½ç½®ç¼–ç ç›¸åŠ åçš„å±‚ä¸­ä½¿ç”¨äº†Dropoutï¼Œé€‰æ‹©çš„Dropoutæ¦‚ç‡ä¸º0.1ã€‚Dropouté€šè¿‡éšæœºåœ°å°†éƒ¨åˆ†ç¥ç»å…ƒçš„è¾“å‡ºç½®ä¸ºé›¶ï¼Œæœ‰åŠ©äºé˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆï¼Œå¹¶å¢å¼ºæ³›åŒ–èƒ½åŠ›ã€‚ æ ‡ç­¾å¹³æ»‘å¤„ç†ï¼šè¿™æ˜¯ä¸€ç§ç”¨äºæ”¹å–„æ¨¡å‹è®­ç»ƒå’Œæé«˜è¯„ä»·æŒ‡æ ‡ï¼ˆå¦‚BLEUåˆ†æ•°ï¼‰çš„æŠ€æœ¯ã€‚æ ‡ç­¾å¹³æ»‘å¤„ç†é€šè¿‡å°†çœŸå®æ ‡ç­¾æ›¿æ¢ä¸ºä¸€ä¸ªåˆ†å¸ƒæ›´å¹³æ»‘çš„ç›®æ ‡åˆ†å¸ƒï¼Œä»è€Œå‡å°‘æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®ä¸­ç‰¹å®šæ ‡ç­¾çš„è¿‡åº¦è‡ªä¿¡ï¼Œæå‡æ³›åŒ–èƒ½åŠ›å’Œæ€§èƒ½è¯„ä¼°çš„ä¸€è‡´æ€§ã€‚ ","date":"2024-07-07","objectID":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/:5:2","tags":["Transformer","æ¨¡å‹","äººå·¥æ™ºèƒ½"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘Attention Is All You Need","uri":"/posts/04.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0transformer/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ç»Ÿè®¡æ–‡ä»¶çš„è¡Œæ•° ç¼–å†™ä¸€ä¸ªshellè„šæœ¬ä»¥è¾“å‡ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­çš„è¡Œæ•° #!/bin/bash # æ–¹æ³•1ï¼šä½¿ç”¨ wc -l å’Œ awk # ç»Ÿè®¡è¡Œæ•°å¹¶ä½¿ç”¨ awk æå–ç¬¬ä¸€ä¸ªå­—æ®µï¼Œå³è¡Œæ•° lines=$(wc -l nowcoder.txt | awk '{print $1}') echo \"ä½¿ç”¨ wc -l å’Œ awkï¼š$lines è¡Œ\" # æ–¹æ³•2ï¼šé€šè¿‡è¾“å…¥æµä¼ é€’æ–‡ä»¶å†…å®¹ç»™ wc -l # ä½¿ç”¨ \u003c æ“ä½œç¬¦ lines=$(wc -l \u003c nowcoder.txt) echo \"é€šè¿‡è¾“å…¥æµï¼š$lines è¡Œ\" # æ–¹æ³•3ï¼šä½¿ç”¨ cat å’Œç®¡é“ä¼ é€’ç»™ wc -l # ä½¿ç”¨ cat å‘½ä»¤å’Œç®¡é“ lines=$(cat nowcoder.txt | wc -l) echo \"é€šè¿‡ç®¡é“ï¼š$lines è¡Œ\" # æ–¹æ³•4ï¼šä½¿ç”¨ sed ç»Ÿè®¡è¡Œæ•° # ä½¿ç”¨ sed çš„ -n '$=' é€‰é¡¹ lines=$(sed -n '$=' nowcoder.txt) echo \"ä½¿ç”¨ sedï¼š$lines è¡Œ\" ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:1:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æ‰“å°æ–‡ä»¶çš„æœ€å5è¡Œ æŸ¥çœ‹æ—¥å¿—çš„æ—¶å€™ï¼Œç»å¸¸ä¼šä»æ–‡ä»¶çš„æœ«å°¾å¾€å‰æŸ¥çœ‹ï¼Œè¯·ä½ å†™ä¸€ä¸ªbash shellè„šæœ¬ä»¥è¾“å‡ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­çš„æœ€å5è¡Œã€‚ #!/bin/bash # æŸ¥çœ‹æ–‡ä»¶çš„å‰5è¡Œ echo \"å‰5è¡Œï¼š\" head -5 nowcoder.txt echo \"\" # æŸ¥çœ‹æ–‡ä»¶çš„å5è¡Œ echo \"å5è¡Œï¼š\" tail -5 nowcoder.txt echo \"\" # æŸ¥çœ‹æ–‡ä»¶çš„ç¬¬5è¡Œåˆ°ç¬¬20è¡Œ echo \"ç¬¬5è¡Œåˆ°ç¬¬20è¡Œï¼š\" sed -n '5,20p' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:2:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 è¾“å‡º 0 åˆ° 500 ä¸­ 7 çš„å€æ•° å†™ä¸€ä¸ª bashè„šæœ¬ä»¥è¾“å‡ºæ•°å­— $0$ åˆ° $500$ ä¸­ $7$ çš„å€æ•°$(0 7 14 21â€¦)$çš„å‘½ä»¤ #!/bin/bash # æ–¹æ³•1ï¼šä½¿ç”¨ Bash çš„æ‰©å±•è¯­æ³•çš„ for å¾ªç¯ echo \"æ–¹æ³•1ï¼šä½¿ç”¨ Bash çš„æ‰©å±•è¯­æ³•çš„ for å¾ªç¯\" for item in {0..500..7} do echo $item done echo \"\" # åˆ†éš”è¡Œ # æ–¹æ³•2ï¼šä½¿ç”¨ seq å‘½ä»¤ # seq [é€‰é¡¹]... é¦–éƒ¨ å¢é‡ å°¾éƒ¨ echo \"æ–¹æ³•2ï¼šä½¿ç”¨ seq å‘½ä»¤\" seq 0 7 500 echo \"\" # åˆ†éš”è¡Œ # æ–¹æ³•3ï¼šä½¿ç”¨ while å¾ªç¯ echo \"æ–¹æ³•3ï¼šä½¿ç”¨ while å¾ªç¯\" # åˆå§‹åŒ–å˜é‡ i=0 # ä½¿ç”¨ while å¾ªç¯ while [ $i -le 500 ] do # è¾“å‡ºå½“å‰çš„ 7 çš„å€æ•° echo $i # å¢åŠ  7 i=$((i + 7)) done ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:3:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 è¾“å‡ºç¬¬5è¡Œçš„å†…å®¹ ç¼–å†™ä¸€ä¸ªbashè„šæœ¬ä»¥è¾“å‡ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­ç¬¬$5$è¡Œçš„å†…å®¹ã€‚ #!/bin/bash # head å‘½ä»¤æ‹¿åˆ°å‰äº”è¡Œï¼Œå†é€šè¿‡é€šé“ï¼Œé€šè¿‡tailå–å‡ºæ¥æœ€åä¸€è¡Œï¼Œå³ç¬¬äº”è¡Œ head -n 5 nowcoder.txt | tail -n 1 #!/bin/bash # ä½¿ç”¨sed å‘½ä»¤ä¸­çš„ pé€‰é¡¹ï¼Œæ‰“å°ç¬¬äº”è¡Œ sed -n 5p nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:4:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 æ‰“å°ç©ºè¡Œçš„è¡Œå· ç¼–å†™ä¸€ä¸ªshellè„šæœ¬ä»¥è¾“å‡ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­ç©ºè¡Œçš„è¡Œå·ï¼ˆç©ºè¡Œå¯èƒ½è¿ç»­ï¼Œä»1å¼€å§‹è¾“å‡ºï¼‰ #!/bin/bash # ä½¿ç”¨ grep å‘½ä»¤åŒ¹é…æ‰€æœ‰ç©ºè¡Œï¼Œå¹¶ä¸”è¾“å‡ºåŒ¹é…çš„è¡Œå·ã€‚-n é€‰é¡¹è¡¨ç¤ºè¾“å‡ºåŒ¹é…è¡Œçš„è¡Œå·ï¼Œ'^$' åŒ¹é…ç©ºè¡Œã€‚ä½¿ç”¨ cut å‘½ä»¤ä»¥ : ä½œä¸ºåˆ†éš”ç¬¦ï¼Œæå–æ¯è¡Œçš„ç¬¬ä¸€ä¸ªå­—æ®µï¼Œå³è¡Œå·ã€‚ grep -n '^$' nowcoder.txt | cut -d':' -f1 # ä½¿ç”¨ awk å‘½ä»¤ï¼ŒNF è¡¨ç¤ºå½“å‰è¡Œçš„å­—æ®µæ•°ï¼ŒNR è¡¨ç¤ºå½“å‰è¡Œå·ã€‚å½“å­—æ®µæ•°ä¸º0æ—¶ï¼Œå³å½“å‰è¡Œä¸ºç©ºè¡Œï¼Œ{ print NR } è¾“å‡ºå½“å‰è¡Œçš„è¡Œå·ã€‚ awk 'NF == 0 { print NR }' nowcoder.txt # ä½¿ç”¨ sed å‘½ä»¤åŒ¹é…æ‰€æœ‰ç©ºè¡Œï¼Œå¹¶è¾“å‡ºåŒ¹é…è¡Œçš„è¡Œå·ã€‚-n é€‰é¡¹è¡¨ç¤ºåªè¾“å‡ºæŒ‡å®šçš„è¡Œï¼Œ/^$/ åŒ¹é…ç©ºè¡Œï¼Œ=è¡¨ç¤ºè¾“å‡ºåŒ¹é…è¡Œçš„è¡Œå·ã€‚ sed -n '/^$/=' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:5:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 å»æ‰ç©ºè¡Œ å†™ä¸€ä¸ª bashè„šæœ¬ä»¥å»æ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­çš„ç©ºè¡Œ #!/bin/bash # ä½¿ç”¨ grep å‘½ä»¤åŒ¹é…æ‰€æœ‰éç©ºè¡Œã€‚-v é€‰é¡¹è¡¨ç¤ºåè½¬åŒ¹é…ï¼Œ'^$' åŒ¹é…ç©ºè¡Œã€‚ grep -v '^$' nowcoder.txt # ä½¿ç”¨ sed å‘½ä»¤åˆ é™¤åŒ¹é…ç©ºè¡Œçš„è¡Œã€‚/^$/ åŒ¹é…ç©ºè¡Œï¼Œd å‘½ä»¤åˆ é™¤åŒ¹é…çš„è¡Œ sed '/^$/d' nowcoder.txt \u003e nowcoder_no_empty_lines.txt # ä½¿ç”¨ awk å‘½ä»¤ï¼ŒNF è¡¨ç¤ºå­—æ®µæ•°ï¼ŒNF ä¸ºçœŸæ—¶è¡¨ç¤ºéç©ºè¡Œã€‚ awk 'NF' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:6:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 æ‰“å°å­—æ¯æ•°å°äº8çš„å•è¯ å†™ä¸€ä¸ªbashè„šæœ¬ä»¥ç»Ÿè®¡ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­å­—æ¯æ•°å°äº8çš„å•è¯ã€‚ #!/bin/bash # ä½¿ç”¨ awk å‘½ä»¤éå†æ¯ä¸ªå•è¯ï¼ŒNF è¡¨ç¤ºå½“å‰è¡Œçš„å•è¯æ•°ï¼Œlength($i) è¡¨ç¤ºå½“å‰å•è¯çš„å­—æ¯æ•°ï¼Œå¦‚æœå­—æ¯æ•°å°äº8ï¼Œåˆ™æ‰“å°å½“å‰å•è¯ã€‚ awk '{ for (i=1; i\u003c=NF; i++) if (length($i)\u003c8) print $i }' nowcoder.txt # ä½¿ç”¨ grep å‘½ä»¤åŒ¹é…å­—æ¯æ•°å°äº8çš„å•è¯ã€‚-o é€‰é¡¹è¡¨ç¤ºåªè¾“å‡ºåŒ¹é…çš„å†…å®¹ï¼Œ\\b è¡¨ç¤ºå•è¯è¾¹ç•Œï¼Œ\\w\\{1,7\\} åŒ¹é…å­—æ¯æ•°åœ¨1åˆ°7ä¹‹é—´çš„å•è¯ã€‚ grep -o '\\b\\w\\{1,7\\}\\b' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:7:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 ç»Ÿè®¡æ‰€æœ‰è¿›ç¨‹å ç”¨å†…å­˜ç™¾åˆ†æ¯”çš„å’Œ å‡è®¾ nowcoder.txt å†…å®¹å¦‚ä¸‹ï¼š USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.4 77744 8332 ? Ss 2021 1:15 /sbin/init noibrs splash root 2 0.0 0.0 0 0 ? S 2021 0:00 [kthreadd] root 4 0.0 0.0 0 0 ? I\u003c 2021 0:00 [kworker/0:0H] daemon 486 0.0 0.1 28340 2372 ? Ss 2021 0:00 /usr/sbin/atd -f root 586 0.0 0.3 72308 6244 ? Ss 2021 0:01 /usr/sbin/sshd -D root 12847 0.0 0.0 4528 68 ? S\u003c Jan03 0:13 /usr/sbin/atopacctd root 16306 1.7 1.2 151964 26132 ? S\u003csl Apr15 512:03 /usr/local/aegis/aegis_client/aegis_11_25/AliYunDun root 24143 0.0 0.4 25608 8652 ? S\u003cLs 00:00 0:03 /usr/bin/atop -R -w /var/log/atop/atop_20220505 600 root 24901 0.0 0.3 107792 7008 ? Ss 15:37 0:00 sshd: root@pts/0 root 24903 0.0 0.3 76532 7580 ? Ss 15:37 0:00 /lib/systemd/systemd --user root 24904 0.0 0.1 111520 2392 ? S 15:37 0:00 (sd-pam) ä»¥ä¸Šå†…å®¹æ˜¯é€šè¿‡ps auxå‘½ä»¤è¾“å‡ºåˆ°nowcoder.txtæ–‡ä»¶ä¸­çš„ï¼Œè¯·ä½ å†™ä¸€ä¸ªè„šæœ¬è®¡ç®—ä¸€ä¸‹æ‰€æœ‰è¿›ç¨‹å ç”¨å†…å­˜å¤§å°çš„å’Œã€‚ #!/bin/bash # ä½¿ç”¨awkå‘½ä»¤è¿‡æ»¤åˆ°ç¬¬ä¸€è¡Œå¹¶ç´¯åŠ $4 awk 'BEGIN { sum=0 } NR \u003e 1 { sum+=$4 } END { print sum }' nowcoder.txt # ä½¿ç”¨whileå¾ªç¯è¯»å–ï¼Œå¹¶ç”¨ifè·³è¿‡ç¬¬ä¸€è¡Œï¼Œä½¿ç”¨bcè¿›è¡Œæµ®ç‚¹æ•°åŠ æ³•è¿ç®— sum=0 cnt=1 while read -r line; do if [ $cnt -gt 1 ]; then mem=$(echo $line | awk '{ print $4 }') sum=$(echo \"$sum+$mem\" | bc) fi cnt=$((cnt+1)) done echo $sum #!/bin/bash sum=0 tail -n +2 nowcoder.txt | while read -r line; do mem=$(echo $line | awk '{ print $4 }') sum=$(echo \"$sum+$mem\" | bc) echo $sum done echo $sum åœ¨ Bash ä¸­ï¼Œç®¡é“ä¸­çš„å‘½ä»¤ä¼šåœ¨å­ shell ä¸­æ‰§è¡Œï¼Œå› æ­¤å˜é‡ä¿®æ”¹ä¸ä¼šå½±å“ä¸» shell ä¸­çš„å˜é‡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆçœ‹åˆ° sum åœ¨å¾ªç¯å†…éƒ¨è¢«æ­£ç¡®æ›´æ–°ï¼Œä½†åœ¨å¾ªç¯å¤–éƒ¨ä»ç„¶æ˜¯åˆå§‹å€¼ 0ã€‚ ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:8:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"9 ç»Ÿè®¡æ¯ä¸ªå•è¯å‡ºç°çš„ä¸ªæ•° å†™ä¸€ä¸ªbashè„šæœ¬ä»¥ç»Ÿè®¡ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txt ä¸­æ¯ä¸ªå•è¯å‡ºç°çš„ä¸ªæ•°ã€‚ ä¸ºäº†ç®€å•èµ·è§ï¼Œä½ å¯ä»¥å‡è®¾ï¼š nowcoder.txtåªåŒ…æ‹¬å°å†™å­—æ¯å’Œç©ºæ ¼ï¼Œæ¯ä¸ªå•è¯åªç”±å°å†™å­—æ¯ç»„æˆï¼Œå•è¯é—´ç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼å­—ç¬¦åˆ†éš”ã€‚ #!/bin/bash # å°†ç©ºæ ¼è½¬æ¢ä¸ºæ¢è¡Œç¬¦ï¼Œä»¥ä¾¿æ¯ä¸ªå•è¯å ä¸€è¡Œ tr -s ' ' '\\n' \u003cnowcoder.txt | # å¯¹å•è¯è¿›è¡Œæ’åº sort | # ç»Ÿè®¡æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•° uniq -c | # è°ƒæ•´è¾“å‡ºæ ¼å¼ä¸º\"å•è¯ è¯é¢‘\" awk '{ print $2, $1 }' | # æŒ‰è¯é¢‘å‡åºæ’åºï¼Œ-k2,2 æ„å‘³ç€åªä½¿ç”¨ç¬¬äºŒåˆ—è¿›è¡Œæ’åºï¼Œè¡¨ç¤ºæŒ‰æ•°å€¼è¿›è¡Œæ’åºï¼ˆé»˜è®¤æƒ…å†µæŒ‰å­—å…¸åºæ’åºï¼‰ sort -k2,2n # ä½¿ç”¨ awk ç»Ÿè®¡æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•° # NF è¡¨ç¤ºå½“å‰è¡Œçš„å­—æ®µæ•°ï¼Œå³å•è¯æ•° # ä½¿ç”¨ä¸€ä¸ªå…³è”æ•°ç»„ cnt å­˜å‚¨æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•° awk '{ for (i=1; i\u003c=NF; i++) # éå†å½“å‰è¡Œçš„æ¯ä¸ªå•è¯ cnt[$i] += 1 # å°†å•è¯åŠ å…¥å…³è”æ•°ç»„ cntï¼Œç»Ÿè®¡å‡ºç°æ¬¡æ•° } END { for (x in cnt) # éå†å…³è”æ•°ç»„ cnt print x, cnt[x] # è¾“å‡ºå•è¯å’Œå¯¹åº”çš„å‡ºç°æ¬¡æ•° }' nowcoder.txt | sort -k2,2n ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:9:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"10 ç¬¬äºŒåˆ—æ˜¯å¦æœ‰é‡å¤ ç»™å®šä¸€ä¸ªnowcoder.txtæ–‡ä»¶ï¼Œå…¶ä¸­æœ‰3åˆ—ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š 20201001 python 99 20201002 go 80 20201002 c++ 88 20201003 php 77 20201001 go 88 20201005 shell 89 20201006 java 70 20201008 c 100 20201007 java 88 20201006 go 97 ç¼–å†™ä¸€ä¸ªshellè„šæœ¬æ¥æ£€æŸ¥æ–‡ä»¶ç¬¬äºŒåˆ—æ˜¯å¦æœ‰é‡å¤ï¼Œä¸”æœ‰å‡ ä¸ªé‡å¤ï¼Œå¹¶æå–å‡ºé‡å¤çš„è¡Œçš„ç¬¬äºŒåˆ—ä¿¡æ¯ï¼ˆå…ˆæŒ‰æ¬¡æ•°æ’åºï¼Œå¦‚æœæ¬¡æ•°ç›¸åŒï¼ŒæŒ‰ç…§å•è¯å­—æ¯é¡ºåºæ’åºï¼‰ï¼Œè¾“å…¥å¦‚ä¸‹ï¼š 2 java 3 go #!/bin/bash cat nowcoder.txt | awk '{ print $2 }' | sort | uniq -c | awk '{ print $1, $2 }' | # é‡æ–°æ ¼å¼åŒ–è¾“å‡º sort -k1,1n -k2,2 | # æŒ‰ç…§å‡ºç°æ¬¡æ•°å’Œå­—æ¯é¡ºåºæ’åº grep -v '1' # è¿‡æ»¤å‡ºç°æ¬¡æ•°ä¸ä¸º 1 çš„è¡Œ ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:10:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"11 è½¬ç½®æ–‡ä»¶çš„å†…å®¹ å†™ä¸€ä¸ªbashè„šæœ¬æ¥è½¬ç½®æ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­çš„æ–‡ä»¶å†…å®¹ã€‚ æ–‡ä»¶ä¸­æ¯è¡Œåˆ—æ•°ç›¸åŒï¼Œå¹¶ä¸”æ¯ä¸ªå­—æ®µç”±ç©ºæ ¼åˆ†éš” #!/bin/bash # è¯»å–æ–‡ä»¶å¹¶ä½¿ç”¨ awk è½¬ç½®æ–‡ä»¶å†…å®¹ awk ' { # éå†å½“å‰è¡Œçš„æ¯ä¸€ä¸ªå­—æ®µ for (i = 1; i \u003c= NF; i++) { a[NR, i] = $i # å°†æ¯ä¸ªå­—æ®µå­˜å‚¨åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œa[è¡Œå·, åˆ—å·] = å€¼ } } NF \u003e p { p = NF } # å¦‚æœå½“å‰è¡Œçš„å­—æ®µæ•°å¤§äº pï¼Œåˆ™æ›´æ–° p ä¸ºå½“å‰è¡Œçš„å­—æ®µæ•° END { # éå†æ¯ä¸€åˆ—ï¼ˆç”±æœ€å¤§å­—æ®µæ•° p ç¡®å®šï¼‰ for (i = 1; i \u003c= p; i++) { # éå†æ¯ä¸€è¡Œï¼ˆç”±æ€»è¡Œæ•° NR ç¡®å®šï¼‰ for (j = 1; j \u003c= NR; j++) { printf(\"%s%s\", a[j,i], (j==NR ? \"\" : \" \")) # è¾“å‡ºæ•°ç»„ä¸­å¯¹åº”çš„å­—æ®µå€¼ï¼Œå¹¶åœ¨æ¯ä¸ªå­—æ®µåæ·»åŠ ç©ºæ ¼ï¼Œé™¤éæ˜¯æœ€åä¸€ä¸ªå­—æ®µ } printf(\"\\n\") # æ¯ä¸€åˆ—è¾“å‡ºå®Œä¹‹åæ¢è¡Œ } }' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:11:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"12 æ‰“å°æ¯ä¸€è¡Œå‡ºç°çš„æ•°å­—ä¸ªæ•° å†™ä¸€ä¸ªbashè„šæœ¬ï¼Œç»Ÿè®¡ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtä¸­æ¯ä¸€è¡Œå‡ºç°çš„1~5æ•°å­—çš„ä¸ªæ•°ï¼Œå¹¶ä¸”è®¡ç®—ä¸€ä¸‹æ•´ä¸ªæ–‡æ¡£ä¸­ä¸€å…±å‡ºç°äº†å‡ ä¸ª1~5æ•°å­—çš„æ€»æ•°ã€‚ #!/bin/bash # ä½¿ç”¨ awk è¯»å–æ–‡ä»¶å¹¶ç»Ÿè®¡æ¯è¡Œä¸­åŒ…å«çš„ç‰¹å®šæ•°å­—ï¼ˆ1, 2, 3, 4, 5ï¼‰çš„æ•°é‡ awk -F \"[1,2,3,4,5]\" ' BEGIN { sum = 0 # åˆå§‹åŒ– sum å˜é‡ï¼Œç”¨äºå­˜å‚¨æ€»å’Œ } { # æ‰“å°å½“å‰è¡Œå· NR ä»¥åŠå½“å‰è¡Œä¸­åŒ…å«çš„ç‰¹å®šæ•°å­—çš„æ•°é‡ (NF - 1) print(\"line\" NR \" number: \" (NF - 1)) # å°†å½“å‰è¡Œä¸­åŒ…å«çš„ç‰¹å®šæ•°å­—çš„æ•°é‡ç´¯åŠ åˆ° sum sum += (NF - 1) } END { # æ‰“å°æ€»å’Œ print(\"sum is \" sum) }' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:12:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"13 å»æ‰æ‰€æœ‰åŒ…å«thisçš„å¥å­ ç¼–å†™ä¸€ä¸ªshellè„šæœ¬ä»¥å®ç°å¦‚ä¸‹åŠŸèƒ½ï¼šå»æ‰è¾“å…¥ä¸­å«æœ‰thisçš„è¯­å¥ï¼ŒæŠŠä¸å«thisçš„è¯­å¥è¾“å‡º #!/bin/bash # -v åè½¬åŒ¹é… grep -v \"this\" nowcoder.txt # sed å‘½ä»¤ -\u003e d åˆ é™¤ -\u003e // åŒ…å«è¦æœç´¢çš„å­—ç¬¦ä¸² sed '/this/d' nowcoder.txt # awk å‘½ä»¤ï¼Œ$0ä¸ºå½“å‰è¡Œçš„æ‰€æœ‰å†…å®¹ï¼Œ!~ æ˜¯ awk çš„æ¨¡å¼åŒ¹é…è¿ç®—ç¬¦ï¼Œè¡¨ç¤ºæ¨¡å¼ä¸åŒ¹é… awk '$0!~/this/ {print $0}' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:13:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"14 æ±‚å¹³å‡å€¼ å†™ä¸€ä¸ªbashè„šæœ¬ä»¥å®ç°ä¸€ä¸ªéœ€æ±‚ï¼Œæ±‚è¾“å…¥çš„ä¸€ä¸ªæ•°ç»„çš„å¹³å‡å€¼ ç¬¬1è¡Œä¸ºè¾“å…¥çš„æ•°ç»„é•¿åº¦N ç¬¬2~Nè¡Œä¸ºæ•°ç»„çš„å…ƒç´ ï¼Œå¦‚ä»¥ä¸‹ä¸º: æ•°ç»„é•¿åº¦ä¸º4ï¼Œæ•°ç»„å…ƒç´ ä¸º1 2 9 8 #!/bin/bash awk 'BEGIN { sum = 0 }{ if (NR == 1) { N = $1 # å°†ç¬¬ä¸€è¡Œçš„æ•°å­—æ•°é‡ä¿å­˜åˆ°å˜é‡ N ä¸­ } else { sum += $1 # å¯¹éšåçš„æ•°å­—è¿›è¡Œç´¯åŠ æ±‚å’Œ } } END { printf(\"%.3f\", sum / N) # è¾“å‡ºå¹³å‡å€¼ï¼Œä¿ç•™ä¸‰ä½å°æ•° }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:14:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"15 å»æ‰ä¸éœ€è¦çš„å•è¯ å†™ä¸€ä¸ªbashè„šæœ¬ä»¥å®ç°ä¸€ä¸ªéœ€æ±‚ï¼Œå»æ‰è¾“å…¥ä¸­å«æœ‰Bå’Œbçš„å•è¯ã€‚ #!/bin/bash # ä½¿ç”¨ sed -n å‘½ä»¤æ‰“å°ä¸åŒ…å« 'B' å’Œ 'b' çš„è¡Œ # /^[^bB]*$/ è¡¨ç¤ºåŒ¹é…ä¸åŒ…å« 'B' å’Œ 'b' çš„è¡Œï¼Œ^ è¡¨ç¤ºè¡Œå¼€å¤´ï¼Œ[^bB] è¡¨ç¤ºä¸åŒ…å« 'B' å’Œ 'b' çš„ä»»ä½•å­—ç¬¦ï¼Œ* è¡¨ç¤ºé›¶æ¬¡æˆ–å¤šæ¬¡é‡å¤ï¼Œ$ è¡¨ç¤ºè¡Œç»“å°¾ sed -n '/^[^bB]*$/p' nowcoder.txt # ä½¿ç”¨ grep -E -v å‘½ä»¤æ’é™¤åŒ…å« 'B' å’Œ 'b' çš„è¡Œ # -E é€‰é¡¹å¯ç”¨æ‰©å±•çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œ-v é€‰é¡¹è¡¨ç¤ºåè½¬åŒ¹é… grep -E -v \"[bB]\" nowcoder.txt # ä½¿ç”¨ awk å‘½ä»¤ï¼Œéå†æ¯ä¸ªå•è¯ï¼Œå¦‚æœä¸åŒ…å« 'B' å’Œ 'b'ï¼Œåˆ™è¾“å‡ºè¯¥å•è¯ awk '{ for (i = 1;i \u003c= NF; i++) { if ($i !~ /b|B/) { # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å•è¯ä¸­ä¸åŒ…å« 'B' å’Œ 'b' çš„éƒ¨åˆ† printf(\"%s \", $i) # è¾“å‡ºä¸åŒ…å« 'B' å’Œ 'b' çš„å•è¯ } } }' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:15:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"16 åˆ¤æ–­è¾“å…¥çš„æ˜¯å¦ä¸ºIPåœ°å€ å†™ä¸€ä¸ªè„šæœ¬ç»Ÿè®¡æ–‡ä»¶nowcoder.txtä¸­çš„æ¯ä¸€è¡Œæ˜¯å¦æ˜¯æ­£ç¡®çš„IPåœ°å€ã€‚ å¦‚æœæ˜¯æ­£ç¡®çš„IPåœ°å€è¾“å‡ºï¼šyes å¦‚æœæ˜¯é”™è¯¯çš„IPåœ°å€ï¼Œä¸”æ˜¯å››æ®µå·ç çš„è¯è¾“å‡ºï¼šnoï¼Œå¦åˆ™çš„è¯è¾“å‡ºï¼šerror #!/bin/bash awk -F \".\" '{ flag = \"error\" if (NF == 4) { flag = \"yes\" for (i = 1; i \u003c= NF; i++) { if ($i \u003e 255) { flag = \"no\"; break; } } } printf(flag\"\\n\") }' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:16:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"17 å°†å­—æ®µé€†åºè¾“å‡ºæ–‡ä»¶çš„æ¯è¡Œ ç¼–å†™ä¸€ä¸ªshellè„šæœ¬ï¼Œå°†æ–‡ä»¶nowcoder.txtä¸­æ¯ä¸€è¡Œçš„å­—æ®µé€†åºè¾“å‡ºï¼Œå…¶ä¸­å­—æ®µä¹‹é—´ä½¿ç”¨è‹±æ–‡å†’å·:ç›¸åˆ†éš”ã€‚ å‡è®¾nowcoder.txtå†…å®¹å¦‚ä¸‹ï¼š nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false root:*:0:0:System Administrator:/var/root:/bin/sh ä½ çš„è„šæœ¬åº”å½“è¾“å‡º /usr/bin/false:/var/empty:Unprivileged User:-2:-2:*:nobody /bin/sh:/var/root:System Administrator:0:0:*:root #!/bin/bash awk -F \":\" '{ for (i = 1; i \u003c= NF; i++) { temp[i] = $i } for (i = NF; i \u003e= 1; i--) { printf(\"%s%s\", temp[i], (i == 1 ? \"\\n\" : \":\")) } }' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:17:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"18 åŸŸåè¿›è¡Œè®¡æ•°æ’åºå¤„ç† å‡è®¾æœ‰ä¸€äº›åŸŸåï¼Œå­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œç°åœ¨éœ€è¦å†™ä¸€ä¸ªshellè„šæœ¬ï¼Œå°†åŸŸåå–å‡ºå¹¶æ ¹æ®åŸŸåè¿›è¡Œè®¡æ•°æ’åºå¤„ç†ï¼ˆé™åºï¼‰ã€‚ å‡è®¾nowcoder.txtå†…å®¹å¦‚ä¸‹ï¼š http://www.nowcoder.com/index.html http://www.nowcoder.com/1.html http://m.nowcoder.com/index.html ä½ çš„è„šæœ¬åº”è¯¥è¾“å‡ºï¼š 2 www.nowcoder.com 1 m.nowcoder.com #!/bin/bash awk -F '/' '{ print($3) }' nowcoder.txt | sort | uniq -c | sort -r | awk '{ print($1\" \"$2) }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:18:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"19 æ‰“å°ç­‰è…°ä¸‰è§’å½¢ ç¼–å†™ä¸€ä¸ªshellè„šæœ¬ï¼Œè¾“å…¥æ­£æ•´æ•°nï¼Œæ‰“å°è¾¹é•¿ä¸ºnçš„ç­‰è…°ä¸‰è§’å½¢ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼š5 è¾“å‡ºï¼š * * * * * * * * * * * * * * * #!/bin/bash read n for ((i = 1; i \u003c= n; i++)) do for ((j = 1; j \u003c= n - i; j++)) do printf \" \" done for ((j = 1; j \u003c= i; j++)) do if [[ $j -eq $i ]]; then printf \"*\" else printf \"* \" fi done printf \"\\n\" done ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:19:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"20 æ‰“å°åªæœ‰ä¸€ä¸ªæ•°å­—çš„è¡Œ å‡è®¾æœ‰ä¸€ä¸ªnowcoder.txtï¼Œç¼–å†™è„šæœ¬ï¼Œæ‰“å°åªæœ‰ä¸€ä¸ªæ•°å­—çš„è¡Œã€‚ #!/bin/bash awk -F \"[0-9]\" '{ if (NF == 2) { print($0) } }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:20:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"21 æ ¼å¼åŒ–è¾“å‡º æœ‰ä¸€ä¸ªæ–‡ä»¶nowcoder.txtï¼Œé‡Œé¢çš„æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªæ•°å­—ä¸²ï¼Œç¼–å†™ä¸€ä¸ªshellè„šæœ¬å¯¹æ–‡ä»¶ä¸­æ¯ä¸€è¡Œçš„æ•°å­—ä¸²è¿›è¡Œæ ¼å¼åŒ–ï¼šæ¯$3$ä¸ªæ•°å­—åŠ å…¥ä¸€ä¸ªé€—å·ï¼ˆ,ï¼‰ã€‚ ä¾‹å¦‚ï¼šæ•°å­—ä¸²ä¸ºâ€œ123456789â€ï¼Œé‚£ä¹ˆéœ€è¦æ ¼å¼åŒ–ä¸º123,456,789ã€‚ #!/bin/bash # ä½¿ç”¨-Fåˆ†å‰²æ•°å­—ä¸² awk -F \"\" '{ for (i = 1; i \u003c= NF; i++) { printf($i) if ((NF - i) % 3 == 0 \u0026\u0026 i != NF) { printf(\",\") } } printf(\"\\n\") }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:21:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"22 å¤„ç†æ–‡æœ¬ æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶nowcoder.txtï¼Œå‡è®¾å†…å®¹æ ¼å¼å¦‚ä¸‹ï¼š 111:13443 222:13211 111:13643 333:12341 222:12123 ç°åœ¨éœ€è¦ç¼–å†™ä¸€ä¸ªshellè„šæœ¬ï¼ŒæŒ‰ç…§ä»¥ä¸‹çš„æ ¼å¼è¾“å‡ºï¼š [111] 13443 13643 [222] 13211 12123 [333] 12341 #!/bin/bash awk -F \":\" '{ cnt[$1] = cnt[$1] $2 \"\\n\" } END { for (i in cnt) { printf(\"[%s]\\n%s\", i, cnt[i]) } }' nowcoder.txt ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:22:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"23 Nginxæ—¥å¿—åˆ†æ1-IPè®¿é—®æ¬¡æ•°ç»Ÿè®¡ å‡è®¾ Nginx çš„æ—¥å¿—å­˜å‚¨åœ¨ nowcoder.txt é‡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š 192.168.1.20 - - [21/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [21/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [21/Apr/2020:21:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.23 - - [21/Apr/2020:22:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [22/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [22/Apr/2020:15:26:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:08:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:09:20:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:15:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:16:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [23/Apr/2020:20:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:20:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:15:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" ç°åœ¨éœ€è¦ç¼–å†™ Shell è„šæœ¬ç»Ÿè®¡å‡º 2020 å¹´ 4 æœˆ 23 å·è®¿é—® IP çš„å¯¹åº”æ¬¡æ•°ï¼Œå¹¶ä¸”æŒ‰ç…§æ¬¡æ•°é™åºæ’åºã€‚ä½ çš„è„šæœ¬åº”è¯¥è¾“å‡ºï¼š 5 192.168.1.22 4 192.168.1.21 3 192.168.1.20 2 192.168.1.25 1 192.168.1.24 #!/bin/bash # é€šè¿‡grepè¿‡æ»¤ï¼Œå†ç»Ÿè®¡æ’åº grep \"23/Apr/2020\" nowcoder.txt | awk '{ print $1 }' | sort | uniq -c | sort -r | awk '{ print $1, $2 }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:23:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"24 Nginxæ—¥å¿—åˆ†æ2-ç»Ÿè®¡æŸä¸ªæ—¶é—´æ®µçš„IPè®¿é—®é‡ å‡è®¾ Nginx çš„æ—¥å¿—å­˜å‚¨åœ¨ nowcoder.txt é‡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š 192.168.1.20 - - [21/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [21/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [21/Apr/2020:21:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.23 - - [21/Apr/2020:22:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [22/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [22/Apr/2020:15:26:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:08:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:09:20:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:15:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:16:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [23/Apr/2020:20:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:20:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:22:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:23:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" ç°åœ¨éœ€è¦ç¼–å†™ Shell è„šæœ¬ç»Ÿè®¡ 2020å¹´04æœˆ23æ—¥20ç‚¹è‡³23ç‚¹å»é‡åçš„ IP è®¿é—®é‡ï¼Œä½ çš„è„šæœ¬åº”è¯¥è¾“å‡ºï¼š 5 è¾“å‡ºè¯´æ˜ï¼š2020å¹´04æœˆ23æ—¥20ç‚¹è‡³23ç‚¹ï¼Œå…±æœ‰ 192.168.1.24ã€192.168.1.25ã€192.168.1.20ã€192.168.1.21ã€192.168.1.22 å…± 5 ä¸ª IP è®¿é—®äº†ã€‚ #!/bin/bash grep \"23/Apr/2020:2[0-3]\" nowcoder.txt | awk '{ print $1 }' | sort | uniq | wc -l ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:24:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"25 nginxæ—¥å¿—åˆ†æ3-ç»Ÿè®¡è®¿é—®3æ¬¡ä»¥ä¸Šçš„IP å‡è®¾nginxçš„æ—¥å¿—æˆ‘ä»¬å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š 192.168.1.20 - - [21/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [21/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [21/Apr/2020:21:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.23 - - [21/Apr/2020:22:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [22/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [22/Apr/2020:15:26:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:08:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:09:20:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:15:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:16:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [23/Apr/2020:20:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:20:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:22:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:23:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" ç°åœ¨éœ€è¦ç¼–å†™shellè„šæœ¬ç»Ÿè®¡è®¿é—®3æ¬¡ä»¥ä¸Šçš„IPï¼Œä½ çš„è„šæœ¬åº”è¯¥è¾“å‡ºï¼š 6 192.168.1.22 5 192.168.1.21 4 192.168.1.20 #!/bin/bash awk '{ print $1 }' nowcoder.txt | sort | uniq -c | sort -r | awk '{ if ($1 \u003e 3) { print $1, $2 } }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:25:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"26 Nginxæ—¥å¿—åˆ†æ4-æŸ¥è¯¢æŸä¸ªIPçš„è¯¦ç»†è®¿é—®æƒ…å†µ å‡è®¾Nginxçš„æ—¥å¿—å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š 192.168.1.20 - - [21/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [21/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [21/Apr/2020:21:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.23 - - [21/Apr/2020:22:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [22/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [22/Apr/2020:15:26:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:08:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:09:20:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:14:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:15:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:15:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:16:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [23/Apr/2020:20:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:20:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:22:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:23:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" ç°åœ¨éœ€è¦ç¼–å†™shellè„šæœ¬æŸ¥è¯¢192.168.1.22çš„è¯¦ç»†è®¿é—®æ¬¡æ•°æƒ…å†µï¼ŒæŒ‰è®¿é—®é¢‘ç‡é™åºæ’åºã€‚ä½ çš„è„šæœ¬åº”è¯¥è¾“å‡ºï¼š 4 /1/index.php 2 /3/index.php #!/bin/bash grep \"192.168.1.22\" | awk '{ print $7 }' | sort | uniq -c | sort -r | awk '{ print $1, $2 }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:26:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"27 nginxæ—¥å¿—åˆ†æ5-ç»Ÿè®¡çˆ¬è™«æŠ“å–404çš„æ¬¡æ•° å‡è®¾nginxçš„æ—¥å¿—å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š 192.168.1.20 - - [21/Apr/2020:14:12:49 +0800] \"GET /1/index.php HTTP/1.1\" 301 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [21/Apr/2020:15:00:49 +0800] \"GET /2/index.php HTTP/1.1\" 500 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [21/Apr/2020:21:21:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.23 - - [21/Apr/2020:22:10:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [22/Apr/2020:15:00:49 +0800] \"GET /2/index.php HTTP/1.1\" 200 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [22/Apr/2020:15:26:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:08:05:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)\" 192.168.1.21 - - [23/Apr/2020:09:20:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 200 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:14:12:49 +0800] \"GET /1/index.php HTTP/1.1\" 200 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:15:00:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:15:00:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)\" 192.168.1.22 - - [23/Apr/2020:15:00:49 +0800] \"GET /3/index.php HTTP/1.1\" 200 490 \"-\" \"Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)\" 192.168.1.24 - - [23/Apr/2020:20:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:20:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 200 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 300 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 500 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:22:10:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:23:59:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" ç°åœ¨éœ€è¦ç¼–å†™shellè„šæœ¬ç»Ÿè®¡ç™¾åº¦çˆ¬è™«æŠ“å–404çš„æ¬¡æ•°ï¼Œä½ çš„è„šæœ¬åº”è¯¥è¾“å‡º 2 #!/bin/bash grep \"404\" | grep \"www.baidu.com\" | wc -l ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:27:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"28 Nginxæ—¥å¿—åˆ†æ6-ç»Ÿè®¡æ¯åˆ†é’Ÿçš„è¯·æ±‚æ•° å‡è®¾Nginxçš„æ—¥å¿—å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š 192.168.1.20 - - [21/Apr/2020:14:12:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [21/Apr/2020:15:00:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [21/Apr/2020:21:21:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.23 - - [21/Apr/2020:22:10:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [22/Apr/2020:15:00:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [22/Apr/2020:15:26:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:08:05:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Baiduspider\" 192.168.1.21 - - [23/Apr/2020:09:20:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:10:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:14:12:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:15:00:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:15:00:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Baiduspider\" 192.168.1.25 - - [23/Apr/2020:16:15:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.24 - - [23/Apr/2020:20:27:49 +0800] \"GET /2/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.25 - - [23/Apr/2020:20:27:49 +0800] \"GET /3/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.20 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:20:27:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.22 - - [23/Apr/2020:22:10:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" 192.168.1.21 - - [23/Apr/2020:23:59:49 +0800] \"GET /1/index.php HTTP/1.1\" 404 490 \"-\" \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0\" ç°åœ¨éœ€è¦ç¼–å†™Shellè„šæœ¬ç»Ÿè®¡æ¯åˆ†é’Ÿçš„è¯·æ±‚æ•°ï¼Œå¹¶ä¸”æŒ‰ç…§è¯·æ±‚æ•°é™åºæ’åºã€‚ä½ çš„è„šæœ¬åº”è¯¥è¾“å‡ºï¼š 5 20:27 4 15:00 2 22:10 2 14:12 2 10:27 1 23:59 1 21:21 1 16:15 1 15:26 1 09:20 1 08:05 #!/bin/bash awk -F \":\" '{ print $2\":\"$3 }' | sort | uniq -c | sort -r | awk '{ print $1, $2 }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:28:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"29 netstatç»ƒä¹ 1-æŸ¥çœ‹å„ä¸ªçŠ¶æ€çš„è¿æ¥æ•° å‡è®¾netstatå‘½ä»¤è¿è¡Œçš„ç»“æœæˆ‘ä»¬å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:6160 0.0.0.0:* LISTEN tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 172.16.56.200:41856 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49822 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49674 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:42316 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:44076 172.16.240.74:6379 ESTABLISHED tcp 0 0 172.16.56.200:49656 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:58248 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:50108 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41944 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:35548 100.100.32.118:80 TIME_WAIT tcp 0 0 172.16.56.200:39024 100.100.45.106:443 TIME_WAIT tcp 0 0 172.16.56.200:41788 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58260 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:41812 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:41854 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58252 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:49586 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41754 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:50466 120.55.222.235:80 TIME_WAIT tcp 0 0 172.16.56.200:38514 100.100.142.5:80 TIME_WAIT tcp 0 0 172.16.56.200:49832 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:52162 100.100.30.25:80 ESTABLISHED tcp 0 0 172.16.56.200:50372 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:50306 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49600 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41908 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:60292 100.100.142.1:80 TIME_WAIT tcp 0 0 172.16.56.200:37650 100.100.54.133:80 TIME_WAIT tcp 0 0 172.16.56.200:41938 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49736 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41890 172.16.34.144:3306 ESTABLISHED udp 0 0 127.0.0.1:323 0.0.0.0:* udp 0 0 0.0.0.0:45881 0.0.0.0:* udp 0 0 127.0.0.53:53 0.0.0.0:* udp 0 0 172.16.56.200:68 0.0.0.0:* udp6 0 0 ::1:323 :::* raw6 0 0 :::58 :::* 7 ç°åœ¨éœ€è¦ç¼–å†™shellè„šæœ¬æŸ¥çœ‹ç³»ç»Ÿtcpè¿æ¥ä¸­å„ä¸ªçŠ¶æ€çš„è¿æ¥æ•°ï¼Œå¹¶ä¸”æŒ‰ç…§è¿æ¥æ•°é™åºè¾“å‡ºã€‚ä½ çš„è„šæœ¬åº”è¯¥è¾“å‡ºå¦‚ä¸‹ï¼š ESTABLISHED 22 TIME_WAIT 9 LISTEN 3 #!/bin/bash grep \"tcp\" | awk '{ print $6 }' | sort | uniq -c | sort -nr | awk '{ print $2, $1 }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:29:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"30 netstatç»ƒä¹ 2-æŸ¥çœ‹å’Œ3306ç«¯å£å»ºç«‹çš„è¿æ¥ å‡è®¾netstatå‘½ä»¤è¿è¡Œçš„ç»“æœæˆ‘ä»¬å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:6160 0.0.0.0:* LISTEN tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 172.16.56.200:41856 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49822 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49674 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:42316 172.16.34.143:3306 ESTABLISHED tcp 0 0 172.16.56.200:44076 172.16.240.74:6379 ESTABLISHED tcp 0 0 172.16.56.200:49656 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:58248 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:50108 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41944 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:35548 100.100.32.118:80 TIME_WAIT tcp 0 0 172.16.56.200:39024 100.100.45.106:443 TIME_WAIT tcp 0 0 172.16.56.200:41788 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58260 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:41812 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:41854 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58252 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:49586 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41754 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:50466 120.55.222.235:80 TIME_WAIT tcp 0 0 172.16.56.200:38514 100.100.142.5:80 TIME_WAIT tcp 0 0 172.16.56.200:49832 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:52162 100.100.30.25:80 ESTABLISHED tcp 0 0 172.16.56.200:50372 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:50306 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49600 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41908 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:60292 100.100.142.1:80 TIME_WAIT tcp 0 0 172.16.56.200:37650 100.100.54.133:80 TIME_WAIT tcp 0 0 172.16.56.200:41938 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49736 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41890 172.16.34.144:3306 ESTABLISHED udp 0 0 127.0.0.1:323 0.0.0.0:* udp 0 0 0.0.0.0:45881 0.0.0.0:* udp 0 0 127.0.0.53:53 0.0.0.0:* udp 0 0 172.16.56.200:68 0.0.0.0:* udp6 0 0 ::1:323 :::* raw6 0 0 :::58 :::* 7 ç°åœ¨éœ€è¦ä½ æŸ¥çœ‹å’Œæœ¬æœº3306ç«¯å£å»ºç«‹è¿æ¥å¹¶ä¸”çŠ¶æ€æ˜¯establishedçš„æ‰€æœ‰IPï¼ŒæŒ‰ç…§è¿æ¥æ•°é™åºæ’åºã€‚ä½ çš„è„šæœ¬åº”è¯¥è¾“å‡º 10 172.16.0.24 9 172.16.34.144 1 172.16.34.143 #!/bin/bash grep \"tcp.*ESTABLISHED\" | awk '{ print $5 }' | awk -F \":\" '$2 == 3306 { print $1 }' | sort | uniq -c | sort -nr | awk '{ print $1, $2 }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:30:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"31 netstatç»ƒä¹ 3-è¾“å‡ºæ¯ä¸ªIPçš„è¿æ¥æ•° å‡è®¾netstatå‘½ä»¤è¿è¡Œçš„ç»“æœæˆ‘ä»¬å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:6160 0.0.0.0:* LISTEN tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 172.16.56.200:41856 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49822 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49674 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:42316 172.16.34.143:3306 ESTABLISHED tcp 0 0 172.16.56.200:44076 172.16.240.74:6379 ESTABLISHED tcp 0 0 172.16.56.200:49656 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:58248 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:50108 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41944 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:35548 100.100.32.118:80 TIME_WAIT tcp 0 0 172.16.56.200:39024 100.100.45.106:443 TIME_WAIT tcp 0 0 172.16.56.200:41788 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58260 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:41812 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:41854 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58252 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:49586 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41754 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:50466 120.55.222.235:80 TIME_WAIT tcp 0 0 172.16.56.200:38514 100.100.142.5:80 TIME_WAIT tcp 0 0 172.16.56.200:49832 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:52162 100.100.30.25:80 ESTABLISHED tcp 0 0 172.16.56.200:50372 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:50306 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49600 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41908 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:60292 100.100.142.1:80 TIME_WAIT tcp 0 0 172.16.56.200:37650 100.100.54.133:80 TIME_WAIT tcp 0 0 172.16.56.200:41938 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49736 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41890 172.16.34.144:3306 ESTABLISHED udp 0 0 127.0.0.1:323 0.0.0.0:* udp 0 0 0.0.0.0:45881 0.0.0.0:* udp 0 0 127.0.0.53:53 0.0.0.0:* udp 0 0 172.16.56.200:68 0.0.0.0:* udp6 0 0 ::1:323 :::* raw6 0 0 :::58 :::* 7 ç°åœ¨éœ€è¦ä½ è¾“å‡ºæ¯ä¸ªIPçš„è¿æ¥æ•°ï¼ŒæŒ‰ç…§è¿æ¥æ•°é™åºæ’åºã€‚ä½ çš„è„šæœ¬åº”è¯¥è¾“å‡º 172.16.0.24 10 172.16.34.144 9 100.100.142.4 3 0.0.0.0 3 172.16.34.143 1 172.16.240.74 1 120.55.222.235 1 100.100.54.133 1 100.100.45.106 1 100.100.32.118 1 100.100.30.25 1 100.100.142.5 1 100.100.142.1 1 #!/bin/bash grep \"tcp\" | awk '{ print $5 }' | awk -F \":\" '{ print $1 }' | sort | uniq -c | sort -nr | awk '{ print $2, $1 }' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:31:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"32 netstatç»ƒä¹ 4-è¾“å‡ºå’Œ3306ç«¯å£å»ºç«‹è¿æ¥æ€»çš„å„ä¸ªçŠ¶æ€çš„æ•°ç›® å‡è®¾netstatå‘½ä»¤è¿è¡Œçš„ç»“æœæˆ‘ä»¬å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:6160 0.0.0.0:* LISTEN tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 172.16.56.200:41856 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49822 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49674 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:42316 172.16.34.143:3306 ESTABLISHED tcp 0 0 172.16.56.200:44076 172.16.240.74:6379 ESTABLISHED tcp 0 0 172.16.56.200:49656 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:58248 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:50108 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41944 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:35548 100.100.32.118:80 TIME_WAIT tcp 0 0 172.16.56.200:39024 100.100.45.106:443 TIME_WAIT tcp 0 0 172.16.56.200:41788 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58260 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:41812 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:41854 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:58252 100.100.142.4:80 TIME_WAIT tcp 0 0 172.16.56.200:49586 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41754 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:50466 120.55.222.235:80 TIME_WAIT tcp 0 0 172.16.56.200:38514 100.100.142.5:80 TIME_WAIT tcp 0 0 172.16.56.200:49832 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:52162 100.100.30.25:80 ESTABLISHED tcp 0 0 172.16.56.200:50372 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:50306 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:49600 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41908 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:60292 100.100.142.1:80 TIME_WAIT tcp 0 0 172.16.56.200:37650 100.100.54.133:80 TIME_WAIT tcp 0 0 172.16.56.200:41938 172.16.34.144:3306 ESTABLISHED tcp 0 0 172.16.56.200:49736 172.16.0.24:3306 ESTABLISHED tcp 0 0 172.16.56.200:41890 172.16.34.144:3306 ESTABLISHED udp 0 0 127.0.0.1:323 0.0.0.0:* udp 0 0 0.0.0.0:45881 0.0.0.0:* udp 0 0 127.0.0.53:53 0.0.0.0:* udp 0 0 172.16.56.200:68 0.0.0.0:* udp6 0 0 ::1:323 :::* raw6 0 0 :::58 :::* 7 ç°åœ¨éœ€è¦ä½ è¾“å‡ºå’Œæœ¬æœº3306ç«¯å£å»ºç«‹è¿æ¥çš„å„ä¸ªçŠ¶æ€çš„æ•°ç›®ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¾“å‡º TOTAL_IPè¡¨ç¤ºå»ºç«‹è¿æ¥çš„ipæ•°ç›® TOTAL_LINKè¡¨ç¤ºå»ºç«‹è¿æ¥çš„æ€»æ•°ç›® TOTAL_IP 3 ESTABLISHED 20 TOTAL_LINK 20 #!/bin/bash # ç»Ÿè®¡åŒ…å«3306ä¸”åè®®ä¸ºtcpçš„æ€»IPæ•°é‡ TOTAL_IP=$(grep \"tcp\" nowcoder.txt | awk '{ print $5 }' | awk -F: '$2 == 3306 {print $1, $2 }' | sort | uniq | wc -l) echo \"TOTAL_IP $TOTAL_IP\" # ç»Ÿè®¡åŒ…å«3306ä¸”çŠ¶æ€ä¸ºESTABLISHEDä¸”åè®®ä¸ºtcpçš„æ•°é‡ ESTABLISHED=$(awk '/3306/ { if ($6 == \"ESTABLISHED\" \u0026\u0026 $1 == \"tcp\") print $5 }' nowcoder.txt | wc -l) echo \"ESTABLISHED $ESTABLISHED\" # ç»Ÿè®¡åŒ…å«3306ä¸”åè®®ä¸ºtcpçš„è¿æ¥æ•°é‡ TOTAL_LINK=$(awk '/3306/ { if ($1 == \"tcp\") print $5 }' nowcoder.txt | wc -l) echo \"TOTAL_LINK $TOTAL_LINK\" ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:32:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"33 ä¸šåŠ¡åˆ†æ-æå–å€¼ å‡è®¾æˆ‘ä»¬çš„æ—¥å¿—nowcoder.txté‡Œï¼Œå†…å®¹å¦‚ä¸‹ 12-May-2017 10:02:22.789 ä¿¡æ¯ [main] org.apache.catalina.startup.VersionLoggerListener.log Server version:Apache Tomcat/8.5.15 12-May-2017 10:02:22.813 ä¿¡æ¯ [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:May 5 2017 11:03:04 UTC 12-May-2017 10:02:22.813 ä¿¡æ¯ [main] org.apache.catalina.startup.VersionLoggerListener.log Server number:8.5.15.0 12-May-2017 10:02:22.814 ä¿¡æ¯ [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:Windows, OS Version:10 12-May-2017 10:02:22.814 ä¿¡æ¯ [main] org.apache.catalina.startup.VersionLoggerListener.log Architecture:x86_64 ç°åœ¨éœ€è¦ä½ æå–å‡ºå¯¹åº”çš„å€¼ï¼Œè¾“å‡ºå†…å®¹å¦‚ä¸‹ serverVersion:Apache Tomcat/8.5.15 serverName:8.5.15.0 osName:Windows osVersion:10 #!/bin/bash grep -o \"Server version:.*\" nowcoder.txt | awk -F \":\" '{print \"serverVersion:\" $2}' grep -o \"Server number:.*\" nowcoder.txt | awk -F \":\" '{print \"serverName:\" $2}' grep -o \"OS Name:.*\" nowcoder.txt | awk -F \"[:,]\" '{print \"osName:\" $2}' grep -o \"OS Version:.*\" nowcoder.txt | awk -F \":\" '{print \"osVersion:\" $2}' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:33:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"34 psåˆ†æ-ç»Ÿè®¡VSZ,RSSå„è‡ªæ€»å’Œ å‡è®¾å‘½ä»¤è¿è¡Œçš„ç»“æœæˆ‘ä»¬å­˜å‚¨åœ¨nowcoder.txté‡Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.1 37344 4604 ? Ss 2020 2:13 /sbin/init root 231 0.0 1.5 166576 62740 ? Ss 2020 15:15 /lib/systemd/systemd-journald root 237 0.0 0.0 0 0 ? S\u003c 2020 2:06 [kworker/0:1H] root 259 0.0 0.0 45004 3416 ? Ss 2020 0:25 /lib/systemd/systemd-udevd root 476 0.0 0.0 0 0 ? S\u003c 2020 0:00 [edac-poller] root 588 0.0 0.0 276244 2072 ? Ssl 2020 9:49 /usr/lib/accountsservice/accounts-daemon message+ 592 0.0 0.0 42904 3032 ? Ss 2020 0:01 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation root 636 0.0 0.0 65532 3200 ? Ss 2020 1:51 /usr/sbin/sshd -D daemon 637 0.0 0.0 26044 2076 ? Ss 2020 0:00 /usr/sbin/atd -f root 639 0.0 0.0 29476 2696 ? Ss 2020 3:29 /usr/sbin/cron -f root 643 0.0 0.0 20748 1992 ? Ss 2020 0:26 /lib/systemd/systemd-logind syslog 645 0.0 0.0 260636 3024 ? Ssl 2020 3:17 /usr/sbin/rsyslogd -n root 686 0.0 0.0 773124 2836 ? Ssl 2020 26:45 /usr/sbin/nscd root 690 0.0 0.0 19472 252 ? Ss 2020 14:39 /usr/sbin/irqbalance --pid=/var/run/irqbalance.pid ntp 692 0.0 0.0 98204 776 ? Ss 2020 25:18 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -u 108:114 uuidd 767 0.0 0.0 28624 192 ? Ss 2020 0:00 /usr/sbin/uuidd --socket-activation root 793 0.0 0.0 128812 3148 ? Ss 2020 0:00 nginx: master process /usr/sbin/nginx -g daemon on; master_process on; www-data 794 0.0 0.2 133376 9120 ? S 2020 630:57 nginx: worker process www-data 795 0.0 0.2 133208 8968 ? S 2020 633:02 nginx: worker process www-data 796 0.0 0.2 133216 9120 ? S 2020 634:24 nginx: worker process www-data 797 0.0 0.2 133228 9148 ? S 2020 632:56 nginx: worker process web 955 0.0 0.0 36856 2112 ? Ss 2020 0:00 /lib/systemd/systemd --user web 956 0.0 0.0 67456 1684 ? S 2020 0:00 (sd-pam) root 1354 0.0 0.0 8172 440 tty1 Ss+ 2020 0:00 /sbin/agetty --noclear tty1 linux root 1355 0.0 0.0 7988 344 ttyS0 Ss+ 2020 0:00 /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220 root 2513 0.0 0.0 0 0 ? S 13:07 0:00 [kworker/u4:1] root 2587 0.0 0.0 0 0 ? S 13:13 0:00 [kworker/u4:2] root 2642 0.0 0.0 0 0 ? S 13:17 0:00 [kworker/1:0] root 2679 0.0 0.0 0 0 ? S 13:19 0:00 [kworker/u4:0] root 2735 0.0 0.1 102256 7252 ? Ss 13:24 0:00 sshd: web [priv] web 2752 0.0 0.0 102256 3452 ? R 13:24 0:00 sshd: web@pts/0 web 2753 0.5 0.1 14716 4708 pts/0 Ss 13:24 0:00 -bash web 2767 0.0 0.0 29596 1456 pts/0 R+ 13:24 0:00 ps aux root 10634 0.0 0.0 0 0 ? S Nov16 0:00 [kworker/0:0] root 16585 0.0 0.0 0 0 ? S\u003c 2020 0:00 [bioset] root 19526 0.0 0.0 0 0 ? S Nov16 0:00 [kworker/1:1] root 28460 0.0 0.0 0 0 ? S Nov15 0:03 [kworker/0:2] root 30685 0.0 0.0 36644 2760 ? Ss 2020 0:00 /lib/systemd/systemd --user root 30692 0.0 0.0 67224 1664 ? S 2020 0:00 (sd-pam) root 32689 0.0 0.0 47740 2100 ? Ss 2020 0:00 /usr/local/ilogtail/ilogtail root 32691 0.2 0.5 256144 23708 ? Sl 2020 1151:31 /usr/local/ilogtail/ilogtail ç°åœ¨éœ€è¦ä½ ç»Ÿè®¡VSZï¼ŒRSSå„è‡ªçš„æ€»å’Œï¼ˆä»¥Må…†ä¸ºç»Ÿè®¡ï¼‰ï¼Œè¾“å‡ºæ ¼å¼å¦‚ä¸‹ MEM TOTAL VSZ_SUM:3250.8M,RSS_SUM:179.777M #!/bin/bash awk '{ sum_vsz = sum_vsz + $5 sum_rss = sum_rss + $6 }END{ print(\"MEM TOTAL \\n\" \"VSZ_SUM:\" sum_vsz/1024 \"M,\" \"RSS_SUM:\" sum_rss/1024 \"M\")}' ","date":"2024-06-09","objectID":"/posts/07.shell%E5%AE%9E%E6%88%98/:34:0","tags":["Shell"],"title":"Shell 23é“ä¾‹é¢˜å®æˆ˜","uri":"/posts/07.shell%E5%AE%9E%E6%88%98/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"1 åŸºç¡€ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:1:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"1.1 è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„é€šè¿‡å°†å¤æ‚çš„ç½‘ç»œé€šä¿¡åˆ†è§£æˆä¸åŒçš„å±‚æ¬¡ï¼Œæ¥æ ‡å‡†åŒ–äº¤äº’çš„è¿‡ç¨‹ã€‚å¸¸è§çš„æ¨¡å‹åŒ…æ‹¬ OSI ä¸ƒå±‚æ¨¡å‹ã€TCP/IP å››å±‚æ¨¡å‹å’Œäº”å±‚ä½“ç³»ç»“æ„ã€‚OSI æ˜¯ç†è®ºä¸Šçš„ç½‘ç»œé€šä¿¡æ¨¡å‹ï¼ŒTCP/IP æ˜¯å®é™…åº”ç”¨å±‚é¢ä¸Šçš„ç½‘ç»œé€šä¿¡æ¨¡å‹ï¼Œäº”å±‚ç»“æ„æ˜¯ä¸ºäº†æ–¹ä¾¿ç†è§£å’Œè®°å¿†ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:1:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"1.2 è¯´è¯´ OSI ä¸ƒå±‚æ¨¡å‹ï¼Ÿ OSIä¸ƒå±‚æ¨¡å‹æ˜¯ä¸€ä¸ªç”¨æ¥æè¿°è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„çš„æ ‡å‡†æ¨¡å‹ã€‚å®ƒå°†ç½‘ç»œé€šä¿¡åˆ’åˆ†ä¸ºä¸ƒä¸ªæŠ½è±¡å±‚ï¼Œæ¯ä¸€å±‚éƒ½è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½ï¼Œä»ç‰©ç†è¿æ¥åˆ°åº”ç”¨ç¨‹åºã€‚è¿™äº›å±‚ä»ä¸‹åˆ°ä¸Šåˆ†åˆ«æ˜¯ï¼š ç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰ï¼šè´Ÿè´£ä¼ è¾“æ¯”ç‰¹æµï¼Œå¹¶ç®¡ç†ç‰©ç†ä»‹è´¨ã€‚ æ•°æ®é“¾è·¯å±‚ï¼ˆData Link Layerï¼‰ï¼šå¤„ç†å¸§çš„ä¼ è¾“ï¼Œé€šè¿‡ç‰©ç†åœ°å€è¿›è¡Œå¯»å€ã€‚ ç½‘ç»œå±‚ï¼ˆNetwork Layerï¼‰ï¼šè´Ÿè´£æ•°æ®åŒ…çš„è·¯ç”±å’Œè½¬å‘ï¼Œå®ç°ä¸åŒç½‘ç»œä¹‹é—´çš„é€šä¿¡ã€‚ ä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰ï¼šæä¾›ç«¯åˆ°ç«¯çš„å¯é æ•°æ®ä¼ è¾“ï¼ŒåŒ…æ‹¬é”™è¯¯æ£€æµ‹ã€æµé‡æ§åˆ¶å’Œåˆ†æ®µé‡ç»„ã€‚ ä¼šè¯å±‚ï¼ˆSession Layerï¼‰ï¼šè´Ÿè´£å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢ä¼šè¯è¿æ¥ï¼Œä»¥åŠæ•°æ®çš„åŒæ­¥å’Œæ¢å¤ã€‚ è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰ï¼šå¤„ç†æ•°æ®çš„æ ¼å¼åŒ–å’Œè¡¨ç¤ºï¼Œç¡®ä¿ä¸åŒç³»ç»Ÿçš„æ•°æ®æ ¼å¼èƒ½å¤Ÿäº’ç›¸ç†è§£ã€‚ åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰ï¼šæä¾›ç”¨æˆ·ä¸ç½‘ç»œæœåŠ¡çš„æ¥å£ï¼ŒåŒ…æ‹¬å„ç§åº”ç”¨ç¨‹åºå’Œåè®®ï¼Œå¦‚HTTPã€FTPå’ŒSMTPã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:1:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"1.3 è¯´è¯´ TCP/IP å››å±‚æ¨¡å‹ï¼Ÿ TCP/IP åˆå¹¶äº† OSI çš„éƒ¨åˆ†å±‚æ¬¡ï¼Œä¸“æ³¨äºé«˜æ•ˆçš„ç½‘ç»œé€šä¿¡å®è·µï¼Œæ›´å…·å®ç”¨æ€§ã€‚ ç½‘ç»œæ¥å£å±‚ï¼ˆNetwork Interface Layerï¼‰ï¼šå¯¹åº”äº OSI æ¨¡å‹çš„ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚ã€‚è´Ÿè´£æ•°æ®å¸§çš„ç‰©ç†ä¼ è¾“ï¼ŒåŒ…æ‹¬ç¡¬ä»¶åœ°å€å¯»å€ï¼ˆMAC åœ°å€ï¼‰ï¼Œæ•°æ®å°è£…å’Œè§£å°è£…ï¼Œé”™è¯¯æ£€æµ‹å’Œçº æ­£ç­‰ã€‚ ç½‘é™…å±‚ï¼ˆInternet Layerï¼‰å¯¹åº”äº OSI æ¨¡å‹çš„ç½‘ç»œå±‚ã€‚ä¸»è¦åè®®æ˜¯ IPï¼Œè´Ÿè´£æ•°æ®åŒ…çš„å¯»å€å’Œè·¯ç”±ã€‚è¿™ä¸€å±‚è¿˜åŒ…æ‹¬ ICMP åè®®ã€‚ ä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰ï¼šå¯¹åº”äº OSI æ¨¡å‹çš„ä¼ è¾“å±‚ã€‚è´Ÿè´£æä¾›ç«¯åˆ°ç«¯çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ŒåŒ…æ‹¬æ•°æ®åˆ†å‰²ã€æµé‡æ§åˆ¶ã€é”™è¯¯æ¢å¤ç­‰ã€‚ä¸»è¦çš„åè®®æœ‰ TCP å’Œ UDP åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰ï¼šå¯¹åº”äº OSI æ¨¡å‹çš„ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚ã€‚åŒ…æ‹¬æ‰€æœ‰ä¸ç½‘ç»œæœ‰å…³çš„é«˜çº§åè®®ï¼Œå¦‚ HTTPã€FTPã€SMTP ç­‰ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:1:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"1.4 è¯´è¯´äº”å±‚ä½“ç³»ç»“æ„ï¼Ÿ æ˜¯å¯¹ OSI å’Œ TCP/IP çš„æŠ˜è¡·ï¼Œå®ƒä¿ç•™äº† TCP/IP çš„å®ç”¨æ€§ï¼ŒåŒæ—¶æä¾›äº†æ¯”å››å±‚æ¨¡å‹æ›´ç»†è‡´çš„åˆ†å±‚ï¼Œä¾¿äºæ•™å­¦å’Œç†è§£ç½‘ç»œçš„å„ä¸ªæ–¹é¢ã€‚ åº”ç”¨å±‚ï¼šä½œä¸ºç½‘ç»œæœåŠ¡å’Œæœ€ç»ˆç”¨æˆ·ä¹‹é—´çš„æ¥å£ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨çš„åè®®ï¼Œå¦‚ HTTPï¼ˆç½‘é¡µï¼‰ã€FTPï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰ã€SMTPï¼ˆé‚®ä»¶ä¼ è¾“ï¼‰ç­‰ã€‚ä½¿ç”¨æˆ·çš„åº”ç”¨ç¨‹åºå¯ä»¥è®¿é—®ç½‘ç»œæœåŠ¡ã€‚ ä¼ è¾“å±‚ï¼šæä¾›è¿›ç¨‹åˆ°è¿›ç¨‹çš„é€šä¿¡ç®¡ç†ï¼Œè¿™ä¸€å±‚ç¡®ä¿æ•°æ®æŒ‰é¡ºåºã€æ— é”™è¯¯åœ°ä¼ è¾“ã€‚ä¸»è¦åè®®åŒ…æ‹¬ TCP å’Œ UDPã€‚ ç½‘ç»œå±‚ï¼šè´Ÿè´£æ•°æ®åŒ…ä»æºåˆ°ç›®çš„åœ°çš„ä¼ è¾“å’Œè·¯ç”±é€‰æ‹©ï¼ŒåŒ…æ‹¬è·¨è¶Šå¤šä¸ªç½‘ç»œï¼ˆå³äº’è”ç½‘ï¼‰ã€‚å®ƒä½¿ç”¨é€»è¾‘åœ°å€ï¼ˆå¦‚ IP åœ°å€ï¼‰æ¥å”¯ä¸€æ ‡è¯†è®¾å¤‡ã€‚è·¯ç”±å™¨æ˜¯ç½‘ç»œå±‚è®¾å¤‡ã€‚ æ•°æ®é“¾è·¯å±‚ï¼šç¡®ä¿ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„å¯é ã€æœ‰æ•ˆçš„æ•°æ®ä¼ è¾“ã€‚äº¤æ¢æœºã€ç½‘æ¡¥æ˜¯æ•°æ®é“¾è·¯å±‚è®¾å¤‡ã€‚ ç‰©ç†å±‚ï¼šç”µç¼†ã€å…‰çº¤ã€æ— çº¿ç”µé¢‘è°±ã€ç½‘ç»œé€‚é…å™¨ç­‰ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:1:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"1.5 è¯´ä¸€ä¸‹æ¯ä¸€å±‚å¯¹åº”çš„ç½‘ç»œåè®®æœ‰å“ªäº›ï¼Ÿ OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹ TCP/IPå››å±‚æ¨¡å‹ å¯¹åº”çš„ç½‘ç»œåè®® åº”ç”¨å±‚ åº”ç”¨å±‚ HTTPã€DNSã€FTPã€NFSã€WAISã€SMIPã€Telnetã€SNMP è¡¨ç¤ºå±‚ åº”ç”¨å±‚ TIFFã€GIFã€JPEGã€PICT ä¼šè¯å±‚ åº”ç”¨å±‚ RPCã€SQLã€NFSã€NetBIOSã€namesã€AppleTalk ä¼ è¾“å±‚ ä¼ è¾“å±‚ TCPã€UDP ç½‘ç»œå±‚ ç½‘ç»œå±‚ IPã€ICMPã€ARPã€RAPPã€RIPã€IPX æ•°æ®é“¾è·¯å±‚ ç½‘ç»œæ¥å£å±‚ FDDIã€Frame Relayã€HDLCã€PPP ç‰©ç†å±‚ ç½‘ç»œæ¥å£å±‚ EIA/TIA-232ã€EIA/TIA-499 ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:1:5","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"1.6 æ•°æ®åœ¨å„å±‚ä¹‹é—´æ˜¯æ€ä¹ˆä¼ è¾“çš„å‘¢ï¼Ÿ å¯¹äºå‘é€æ–¹è€Œè¨€ï¼Œä»ä¸Šå±‚åˆ°ä¸‹å±‚å±‚å±‚åŒ…è£…ï¼Œå¯¹äºæ¥æ”¶æ–¹è€Œè¨€ï¼Œä»ä¸‹å±‚åˆ°ä¸Šå±‚ï¼Œå±‚å±‚è§£å¼€åŒ…è£…ã€‚ å‘é€æ–¹çš„åº”ç”¨è¿›ç¨‹å‘æ¥æ”¶æ–¹çš„åº”ç”¨è¿›ç¨‹ä¼ é€æ•°æ® AP å…ˆå°†æ•°æ®äº¤ç»™æœ¬ä¸»æœºçš„åº”ç”¨å±‚ï¼Œåº”ç”¨å±‚åŠ ä¸Šæœ¬å±‚çš„æ§åˆ¶ä¿¡æ¯ H5 å°±å˜æˆäº†ä¸‹ä¸€å±‚çš„æ•°æ®å•å…ƒ ä¼ è¾“å±‚æ”¶åˆ°è¿™ä¸ªæ•°æ®å•å…ƒåï¼ŒåŠ ä¸Šæœ¬å±‚çš„æ§åˆ¶ä¿¡æ¯ H4ï¼Œå†äº¤ç»™ç½‘ç»œå±‚ï¼Œæˆä¸ºç½‘ç»œå±‚çš„æ•°æ®å•å…ƒ åˆ°äº†æ•°æ®é“¾è·¯å±‚ï¼Œæ§åˆ¶ä¿¡æ¯è¢«åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«åŠ åˆ°æœ¬å±‚æ•°æ®å•å…ƒçš„é¦–éƒ¨ï¼ˆH2ï¼‰å’Œå°¾éƒ¨ï¼ˆT2ï¼‰ æœ€åçš„ç‰©ç†å±‚ï¼Œè¿›è¡Œæ¯”ç‰¹æµçš„ä¼ è¾“ è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼å†™ä¿¡ï¼Œå†™ä¸€å°ä¿¡ï¼Œæ¯åˆ°ä¸€å±‚ï¼Œå°±åŠ ä¸€ä¸ªä¿¡å°ï¼Œå†™ä¸€äº›åœ°å€çš„ä¿¡æ¯ã€‚åˆ°äº†ç›®çš„åœ°ä¹‹åï¼Œåˆä¸€å±‚å±‚è§£å°ï¼Œä¼ å‘ä¸‹ä¸€ä¸ªç›®çš„åœ°ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:1:6","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"2 ç½‘ç»œç»¼åˆ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:2:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"2.1 ä»æµè§ˆå™¨åœ°å€æ è¾“å…¥ URL åˆ°æ˜¾ç¤ºä¸»é¡µçš„è¿‡ç¨‹ ä»åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ URL åˆ°æ˜¾ç¤ºä¸»é¡µçš„è¿‡ç¨‹åŒ…æ‹¬å¤šä¸ªæ­¥éª¤ï¼Œæ¶µç›–äº† DNS è§£æã€TCP è¿æ¥ã€å‘é€ HTTP è¯·æ±‚ã€æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å› HTTP å“åº”ã€æµè§ˆå™¨å¤„ç†å“åº”å¹¶æ¸²æŸ“é¡µé¢ç­‰å¤šä¸ªç¯èŠ‚ã€‚ DNS è§£æï¼šæµè§ˆå™¨å‘èµ·ä¸€ä¸ª DNS è¯·æ±‚åˆ° DNS æœåŠ¡å™¨ï¼Œå°†åŸŸåè§£æä¸ºæœåŠ¡å™¨çš„ IP åœ°å€ã€‚ TCP è¿æ¥ï¼šæµè§ˆå™¨é€šè¿‡è§£æå¾—åˆ°çš„ IP åœ°å€ä¸æœåŠ¡å™¨å»ºç«‹ TCP è¿æ¥ï¼ˆé€šå¸¸æ˜¯é€šè¿‡ 443 ç«¯å£è¿›è¡Œ SSL åŠ å¯†çš„ HTTPS è¿æ¥ï¼‰ã€‚è¿™ä¸€æ­¥æ¶‰åŠåˆ° TCP çš„ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ï¼Œç¡®ä¿åŒæ–¹éƒ½å‡†å¤‡å¥½è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚ å‘é€ HTTP è¯·æ±‚ï¼šæµè§ˆå™¨æ„å»º HTTP è¯·æ±‚æ¶ˆæ¯ï¼ŒåŒ…æ‹¬è¯·æ±‚è¡Œï¼ˆå¦‚ GET / HTTP/1.1ï¼‰ã€è¯·æ±‚å¤´ï¼ˆåŒ…å«ç”¨æˆ·ä»£ç†ã€æ¥å—çš„å†…å®¹ç±»å‹ç­‰ä¿¡æ¯ï¼‰å’Œè¯·æ±‚ä½“ï¼ˆå¦‚æœæœ‰ï¼‰ï¼›å°†è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼šæœåŠ¡å™¨æ¥æ”¶åˆ° HTTP è¯·æ±‚åï¼Œæ ¹æ®è¯·æ±‚çš„èµ„æºè·¯å¾„ï¼Œç»è¿‡åç«¯å¤„ç†ï¼ˆå¯èƒ½åŒ…æ‹¬æ•°æ®åº“æŸ¥è¯¢ç­‰ï¼‰ï¼Œç”Ÿæˆ HTTP å“åº”æ¶ˆæ¯ï¼›å“åº”æ¶ˆæ¯åŒ…æ‹¬çŠ¶æ€è¡Œï¼ˆå¦‚ HTTP/1.1 200 OKï¼‰ã€å“åº”å¤´ï¼ˆå†…å®¹ç±»å‹ã€ç¼“å­˜æ§åˆ¶ç­‰ä¿¡æ¯ï¼‰å’Œå“åº”ä½“ï¼ˆè¯·æ±‚çš„èµ„æºå†…å®¹ï¼‰ã€‚ æµè§ˆå™¨æ¥æ”¶ HTTP å“åº”ï¼šæµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ HTTP å“åº”æ•°æ®ï¼Œå¼€å§‹è§£æå“åº”ä½“ä¸­çš„ HTML å†…å®¹ï¼›ç„¶åæ„å»º DOM æ ‘ã€è§£æ CSS å’Œ JavaScript æ–‡ä»¶ç­‰ï¼Œæœ€ç»ˆæ¸²æŸ“é¡µé¢ã€‚ æ–­å¼€è¿æ¥ï¼šTCP å››æ¬¡æŒ¥æ‰‹ï¼Œè¿æ¥ç»“æŸ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:2:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"2.2 å„ä¸ªè¿‡ç¨‹éƒ½ä½¿ç”¨äº†å“ªäº›åè®®ï¼Ÿ DNS:è·å–åŸŸåå¯¹åº”çš„IP TCP:ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥å’Œæ–­å¼€è¿æ¥ IPï¼šä½¿ç”¨TCPåè®®æ—¶ï¼Œç½‘ç»œå±‚éœ€è¦ä½¿ç”¨IPåè®®ã€‚ OPSFï¼šIPæ•°æ®åŒ…åœ¨è·¯ç”±å™¨ä¹‹é—´ï¼Œè·¯ç”±é€‰æ‹©ä½¿ç”¨OPSFåè®® ARPï¼šè·¯ç”±å™¨å†ä¸æœåŠ¡å™¨é€šä¿¡æ—¶ï¼Œéœ€è¦å°†IPåœ°å€è½¬æ¢ä¸ºMACåœ°å€ï¼Œéœ€è¦ä½¿ç”¨ARPåè®® HTTPï¼šTCPè¿æ¥å»ºç«‹å®Œæˆä¹‹åï¼Œä½¿ç”¨HTTPåè®®ä¼ é€’HTTPæŠ¥æ–‡ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:2:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"2.3 è¯´è¯´ DNS çš„è§£æè¿‡ç¨‹ï¼Ÿ DNS çš„å…¨ç§°æ˜¯ Domain Name Systemï¼Œä¹Ÿå°±æ˜¯åŸŸåè§£æç³»ç»Ÿï¼Œå®ƒå¯ä»¥å°†åŸŸåæ˜ å°„åˆ°å¯¹åº”çš„ IP åœ°å€ä¸Šï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬è®¿é—® www.google.comï¼Œå®é™…ä¸Šè®¿é—®çš„æ˜¯è°·æ­Œçš„ä¸€å°æœåŠ¡å™¨ï¼Œå®ƒçš„ IP åœ°å€æ˜¯ xxx.xxx.xxx.xxxã€‚å¯ä»¥é€šè¿‡ IP åœ°å€ç›´æ¥è®¿é—®æœåŠ¡å™¨ï¼Œä½†ä¸æ–¹ä¾¿è®°å¿†ï¼Œæ‰€ä»¥å°±æœ‰äº†åŸŸåç³»ç»Ÿã€‚åŸŸååˆ° IP ä¹‹é—´çš„æ˜ å°„ï¼Œå°±éœ€è¦ DNS æ¥å®Œæˆã€‚ å‡è®¾æˆ‘ä»¬åœ¨æµè§ˆå™¨åœ°å€æ é‡Œé”®å…¥äº†www.google.comï¼š æµè§ˆå™¨ä¼šé¦–å…ˆæ£€æŸ¥è‡ªå·±çš„ç¼“å­˜ä¸­æ˜¯å¦æœ‰è¿™ä¸ªåŸŸåå¯¹åº”çš„ IP åœ°å€ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›ï¼›å¦‚æœæ²¡æœ‰ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ã€‚ æ£€æŸ¥æœ¬åœ° DNS ç¼“å­˜æ˜¯å¦æœ‰è¯¥åŸŸåçš„è®°å½•ã€‚ å¦‚æœæ²¡æœ‰ï¼Œå‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œæ ¹åŸŸåæœåŠ¡å™¨å°†è¯·æ±‚æŒ‡å‘æ›´å…·ä½“çš„æœåŠ¡ï¼Œå¦‚ com é¡¶çº§åŸŸåæœåŠ¡å™¨ã€‚ é¡¶çº§åŸŸåæœåŠ¡å™¨å†å°†è¯·æ±‚æŒ‡å‘æƒé™åŸŸåæœåŠ¡å™¨ï¼Œé€šå¸¸ç”±åŸŸåæ³¨å†Œæœºæ„ç›´æ¥ç®¡ç†ï¼Œæ‰€ä»¥æœºæ„ä¼šæä¾›å¯¹åº”çš„ DNS è§£ææœåŠ¡ï¼Œå°†åŸŸåå’Œè°·æ­ŒæœåŠ¡å™¨ç»‘å®šèµ·æ¥ã€‚ æœ€ç»ˆï¼Œæµè§ˆå™¨ä½¿ç”¨è·å¾—çš„ IP åœ°å€å‘èµ·ä¸€ä¸ª HTTP è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œç„¶åè¯¥æœåŠ¡å™¨è¿”å›æ‰€è¯·æ±‚çš„ç½‘é¡µå†…å®¹ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:2:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"2.4 è¯´è¯´ WebSocket ä¸ Socket çš„åŒºåˆ«ï¼Ÿ Socket å…¶å®å°±æ˜¯ç­‰äº IP åœ°å€ + ç«¯å£ + åè®®ã€‚å…·ä½“æ¥è¯´ï¼ŒSocket æ˜¯ä¸€å¥—æ ‡å‡†ï¼Œå®ƒå®Œæˆäº†å¯¹ TCP/IP çš„é«˜åº¦å°è£…ï¼Œå±è”½ç½‘ç»œç»†èŠ‚ï¼Œä»¥æ–¹ä¾¿å¼€å‘è€…æ›´å¥½åœ°è¿›è¡Œç½‘ç»œç¼–ç¨‹ã€‚ WebSocket: æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œå±äºåº”ç”¨å±‚åè®®ã€‚å®ƒæ˜¯åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„åè®®ï¼Œè®¾è®¡ç”¨äºæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œç”¨æ¥è§£å†³ http ä¸æ”¯æŒæŒä¹…åŒ–è¿æ¥çš„é—®é¢˜ã€‚ Socket ä¸€ä¸ªæ˜¯ç½‘ç»œç¼–ç¨‹çš„æ ‡å‡†æ¥å£ï¼Œè€Œ WebSocket åˆ™æ˜¯åº”ç”¨å±‚é€šä¿¡åè®®ã€‚ Socketå·¥ä½œåœ¨ä¼ è¾“å±‚ï¼Œå¯ä»¥åŸºäº TCP æˆ– UDP åè®®ã€‚å®ƒéœ€è¦å¼€å‘è€…è‡ªå·±å¤„ç†æ•°æ®çš„å‘é€å’Œæ¥æ”¶ã€è¿æ¥çš„å»ºç«‹å’Œæ–­å¼€ç­‰ä½å±‚æ¬¡çš„ç»†èŠ‚ã€‚ WebSocketå·¥ä½œåœ¨åº”ç”¨å±‚ï¼Œä¾èµ–äº TCP åè®®ã€‚WebSocket åœ¨åˆæ¬¡è¿æ¥æ—¶é€šè¿‡ HTTP è¯·æ±‚è¿›è¡Œæ¡æ‰‹ï¼Œä¸€æ—¦è¿æ¥å»ºç«‹ï¼Œåç»­çš„æ•°æ®ä¼ è¾“éƒ½åœ¨ WebSocket åè®®ä¸Šè¿›è¡Œï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½å¯ä»¥ä¸»åŠ¨å‘å¯¹æ–¹å‘é€æ•°æ®ï¼Œä¿æŒè¿æ¥ç›´åˆ°æ˜¾å¼æ–­å¼€ã€‚ Socketä¼ è¾“çš„æ˜¯å­—èŠ‚æµï¼Œéœ€è¦å¼€å‘è€…è‡ªè¡Œå®šä¹‰æ•°æ®çš„æ ¼å¼å’Œåè®®ã€‚WebSocketä¼ è¾“çš„æ˜¯æ–‡æœ¬å¸§æˆ–äºŒè¿›åˆ¶å¸§ï¼Œåè®®æœ¬èº«å®šä¹‰äº†æ¶ˆæ¯çš„æ ¼å¼ï¼Œèƒ½å¤Ÿç›´æ¥å‘é€ JSON æˆ–äºŒè¿›åˆ¶æ•°æ®ï¼Œæ–¹ä¾¿å¼€å‘è€…ä½¿ç”¨ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:2:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"2.5 è¯´ä¸€ä¸‹ä½ äº†è§£çš„ç«¯å£åŠå¯¹åº”çš„æœåŠ¡ï¼Ÿ ç«¯å£ æœåŠ¡ ç”¨é€” 21 FTP(æ–‡ä»¶ä¼ è¾“åè®®) ç”¨äºåœ¨è®¡ç®—æœºä¹‹é—´ä¼ è¾“æ–‡ä»¶ 22 SSH ç”¨äºè¿œç¨‹ç™»å½•ã€æ–‡ä»¶ä¼ è¾“å’Œå‘½ä»¤è¡Œç•Œé¢äº¤äº’ 23 Telnet(è¿œç¨‹ç™»å½•æœåŠ¡) å…è®¸ç”¨æˆ·ä»ä¸€å°è®¡ç®—æœºç™»å½•åˆ°å¦ä¸€å°è®¡ç®—æœº 53 DNSåŸŸåè§£ææœåŠ¡ å°†åŸŸåè½¬æ¢ä¸ºIPåœ°å€ä»¥ä¾¿è®¿é—®ç½‘ç«™ 80 HTTPè¶…æ–‡æœ¬ä¼ è¾“åè®® ç”¨äºåœ¨ä¸‡ç»´ç½‘ä¸Šäº¤æ¢ä¿¡æ¯ 443 HTTPS æä¾›å®‰å…¨çš„HTTPé€šä¿¡ 1080 SOCKS ç”¨äºåœ¨è®¡ç®—æœºä¹‹é—´å®‰å…¨åœ°ä¼ è¾“æ•°æ®ã€‚å®ƒé€šè¿‡ä»£ç†æœåŠ¡å™¨æ¥éšè—åŸå§‹çš„IPåœ°å€å’Œç«¯å£å·ï¼Œä»è€Œæä¾›åŒ¿åæ€§å’Œå®‰å…¨æ€§ 3306 MySQLé»˜è®¤ç«¯å£å· ç”¨äºMySQLæ•°æ®åº“æœåŠ¡å™¨ä¸Šçš„æ•°æ®è®¿é—® ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:2:5","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3 HTTP ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.1 è¯´è¯´ HTTP å¸¸ç”¨çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ï¼Ÿ HTTP å“åº”çŠ¶æ€ç æ˜¯ç”±æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç”¨äºè¡¨ç¤ºå¯¹è¯·æ±‚çš„å“åº”ç»“æœã€‚ è¿™äº›çŠ¶æ€ç åˆ†ä¸ºäº”ä¸ªä¸åŒçš„ç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«ç”¨ä¸€ä¸ªæ•°å­—å¼€å¤´ï¼Œå…±æœ‰ä¸‰ä½æ•°ï¼š 1XXï¼šä¿¡æ¯æ€§çŠ¶æ€ç ï¼Œä¸´æ—¶çš„å“åº”ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­è¯·æ±‚ã€‚ 2XXï¼šæˆåŠŸçŠ¶æ€ç ï¼Œè¯·æ±‚å·²æˆåŠŸè¢«æœåŠ¡å™¨æ¥æ”¶ã€‚ 3XXï¼šé‡å®šå‘çŠ¶æ€ç ï¼Œç”¨æ¥é‡å®šå‘ã€‚ 4XXï¼šå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼Œè¯·æ±‚å¯èƒ½å‡ºé”™ã€‚ 5XXï¼šæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼ŒæœåŠ¡å™¨åœ¨å°è¯•å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚ å¸¸è§HTTPçŠ¶æ€ç å¦‚ä¸‹ï¼š çŠ¶æ€ç  å«ä¹‰ 101 Switching Protocols åˆ‡æ¢è¯·æ±‚åè®® 200 OK è¯·æ±‚æˆåŠŸ 301 Moved Permanently è¯·æ±‚èµ„æºæ°¸ä¹…ç§»åŠ¨ï¼Œè¿”å›æ–°URI 302 Found è¯·æ±‚èµ„æºä¸´æ—¶ç§»åŠ¨ï¼Œç»§ç»­ä½¿ç”¨åŸæœ‰URI 400 Bad Request å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡ç«¯æ— æ³•ç†è§£ 401 Unauthorized å½“å‰è¯·æ±‚éœ€è¦è®¤è¯ 403 Forbidden æœåŠ¡å™¨æ‹’ç»è¯·æ±‚ï¼Œå®¢æˆ·ç«¯æ— æƒè®¿é—®è¯¥èµ„æº 404 Not Found è¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šä¸å­˜åœ¨ 500 Internal Server Error æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.2 HTTP æœ‰å“ªäº›è¯·æ±‚æ–¹å¼ï¼Ÿ HTTP åè®®å®šä¹‰äº†å¤šç§è¯·æ±‚æ–¹å¼ï¼Œç”¨ä»¥æŒ‡ç¤ºè¯·æ±‚çš„ç›®çš„ã€‚å¸¸è§çš„è¯·æ±‚æ–¹å¼æœ‰ GETã€POSTã€DELETEã€PUTã€‚åœ¨æ­£ç¡®å®ç°çš„æ¡ä»¶ä¸‹ï¼ŒGETã€HEADã€PUT å’Œ DELETE ç­‰æ–¹æ³•éƒ½æ˜¯å¹‚ç­‰çš„ï¼Œè€Œ POST æ–¹æ³•ä¸æ˜¯ï¼ˆæ¯æ¬¡å‘é€ POST è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šç”Ÿæˆæ–°çš„èµ„æº ID æˆ–å¤„ç†ç”Ÿæˆçš„å”¯ä¸€å€¼ï¼ˆå¦‚è®¢å•å·ã€äº‹åŠ¡ IDï¼‰ã€‚å› æ­¤ï¼Œé‡å¤å‘é€ POST è¯·æ±‚ä¼šå¯¼è‡´åˆ›å»ºå¤šä¸ªä¸åŒçš„èµ„æºæˆ–å¤šæ¬¡æ‰§è¡ŒæŸä¸ªæ“ä½œï¼‰ã€‚ GETï¼šè¯·æ±‚æ£€ç´¢æŒ‡å®šçš„èµ„æºã€‚åº”è¯¥åªç”¨äºè·å–æ•°æ®ï¼Œå¹¶ä¸”æ˜¯å¹‚ç­‰çš„ï¼Œå³å¤šæ¬¡æ‰§è¡Œç›¸åŒçš„ GET è¯·æ±‚åº”è¯¥è¿”å›ç›¸åŒçš„ç»“æœï¼Œå¹¶ä¸”ä¸ä¼šæ”¹å˜èµ„æºçš„çŠ¶æ€ã€‚ POSTï¼šå‘æŒ‡å®šèµ„æºæäº¤æ•°æ®ï¼Œè¯·æ±‚æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼ˆå¦‚æäº¤è¡¨å•æˆ–ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚å¯èƒ½ä¼šåˆ›å»ºæ–°çš„èµ„æºæˆ–ä¿®æ”¹ç°æœ‰èµ„æºã€‚ DELETEï¼šåˆ é™¤æŒ‡å®šçš„èµ„æºã€‚ PUTï¼šç”¨äºæ›¿æ¢æŒ‡å®šçš„èµ„æºã€‚å¦‚æœæŒ‡å®šçš„èµ„æºä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°èµ„æºã€‚ HEADï¼šç±»ä¼¼äº GET è¯·æ±‚ï¼Œä½†åªè¯·æ±‚å“åº”å¤´ä¿¡æ¯ï¼Œä¸ä¼šè¿”å›å“åº”ä½“ã€‚å¸¸ç”¨äºæ£€æŸ¥èµ„æºæ˜¯å¦å­˜åœ¨ä»¥åŠèµ„æºçš„å…ƒæ•°æ®ï¼ˆå¦‚æ£€æŸ¥é“¾æ¥æ˜¯å¦æœ‰æ•ˆï¼‰ã€‚ OPTIONSï¼šè¯·æ±‚æœåŠ¡å™¨è¿”å›è¯¥èµ„æºæ‰€æ”¯æŒçš„æ‰€æœ‰ HTTP æ–¹æ³•ã€‚å¸¸ç”¨äºæ£€æŸ¥æœåŠ¡å™¨çš„åŠŸèƒ½æˆ–èµ„æºçš„é€šä¿¡é€‰é¡¹ã€‚ PATCHï¼šç”¨äºå¯¹èµ„æºè¿›è¡Œéƒ¨åˆ†ä¿®æ”¹ï¼Œè€Œä¸æ˜¯å®Œå…¨æ›¿ä»£èµ„æºã€‚ TRACEï¼šå›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•å’Œè¯Šæ–­ã€‚ CONNECTï¼šç”¨äºå°†è¯·æ±‚è¿æ¥è½¬æ¢ä¸ºé€æ˜çš„ TCP/IP éš§é“ï¼Œé€šå¸¸ç”¨äº HTTPS é€šè¿‡ä»£ç†æœåŠ¡å™¨çš„è¯·æ±‚ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.3 HTTP çš„ GET æ–¹æ³•å¯ä»¥å®ç°å†™æ“ä½œå—? ä¸¥æ ¼æ¥è¯´ï¼ŒHTTP çš„ GET æ–¹æ³•ä¸åº”è¯¥ç”¨äºå®ç°å†™æ“ä½œï¼Œå› ä¸ºå®ƒè®¾è®¡ä¸ºä¸€ç§å®‰å…¨çš„ã€å¹‚ç­‰çš„è¯»å–æ“ä½œã€‚GET è¯·æ±‚çš„ä¸»è¦ä½œç”¨æ˜¯ä»æœåŠ¡å™¨è·å–èµ„æºï¼Œè€Œä¸åº”å¯¹æœåŠ¡å™¨ä¸Šçš„æ•°æ®è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚ ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œæœ‰äº› Web åº”ç”¨å¯èƒ½ä¼šæ»¥ç”¨ GET è¯·æ±‚è¿›è¡Œå†™æ“ä½œï¼Œä¾‹å¦‚é€šè¿‡åœ¨ URL ä¸­ä¼ é€’å‚æ•°æ¥ä¿®æ”¹æœåŠ¡å™¨ä¸Šçš„æ•°æ®ã€‚è¿™ç§åšæ³•æ˜¯ä¸æ¨èçš„ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š å®‰å…¨æ€§ï¼šGET è¯·æ±‚ä¼šå°†å‚æ•°åŒ…å«åœ¨ URL ä¸­ï¼Œè¿™ä½¿å¾—æ•æ„Ÿæ•°æ®å®¹æ˜“æš´éœ²ï¼Œä¸”å®¹æ˜“å—åˆ°æ”»å‡»ï¼ˆå¦‚ CSRF æ”»å‡»ï¼‰ã€‚ ç¼“å­˜é—®é¢˜ï¼šGET è¯·æ±‚é€šå¸¸ä¼šè¢«ç¼“å­˜ï¼Œè€Œç¼“å­˜çš„ GET è¯·æ±‚ä¸åº”å¼•å‘æœåŠ¡å™¨çŠ¶æ€çš„å˜åŒ–ã€‚å¦‚æœ GET è¯·æ±‚ç”¨äºå†™æ“ä½œï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¼“å­˜çš„å‰¯ä½œç”¨ã€‚ å¹‚ç­‰æ€§å’Œå®‰å…¨æ€§ï¼šHTTP æ ‡å‡†è¦æ±‚ GET è¯·æ±‚æ˜¯å¹‚ç­‰çš„ï¼ˆå¤šæ¬¡ç›¸åŒçš„è¯·æ±‚åº”äº§ç”Ÿç›¸åŒçš„ç»“æœï¼‰å’Œå®‰å…¨çš„ï¼ˆä¸åº”å¯¹æœåŠ¡å™¨çŠ¶æ€äº§ç”Ÿå‰¯ä½œç”¨ï¼‰ã€‚ä½¿ç”¨ GET å®ç°å†™æ“ä½œè¿èƒŒäº†è¿™äº›åŸåˆ™ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.4 è¯´ä¸€ä¸‹ GET å’Œ POST çš„åŒºåˆ«ï¼Ÿ ä» HTTP æŠ¥æ–‡å±‚é¢ï¼š GET è¯·æ±‚ï¼šå°†è¯·æ±‚å‚æ•°æ”¾åœ¨ URL ä¸­ï¼Œå› æ­¤ URL çš„é•¿åº¦æœ‰é™åˆ¶ã€‚æ•°æ®åœ¨ URL ä¸­ä¼ è¾“ï¼Œä¸å®‰å…¨ï¼Œå®¹æ˜“è¢«çªƒå–ã€‚ POST è¯·æ±‚ï¼šå°†è¯·æ±‚å‚æ•°æ”¾åœ¨è¯·æ±‚ä½“ä¸­ï¼Œæ²¡æœ‰é•¿åº¦é™åˆ¶ã€‚æ•°æ®åœ¨æŠ¥æ–‡ä½“ä¸­ä¼ è¾“ï¼Œç›¸å¯¹æ›´å®‰å…¨ã€‚ ä»å¹‚ç­‰æ€§å’Œå®‰å…¨æ€§ï¼š GET è¯·æ±‚ï¼š å¹‚ç­‰æ€§ï¼šå¤šæ¬¡è¯·æ±‚ä¸ä¼šæ”¹å˜æœåŠ¡å™¨çŠ¶æ€ï¼Œæ¯æ¬¡ç»“æœç›¸åŒã€‚ å®‰å…¨æ€§ï¼šä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºè¿›è¡Œä¿®æ”¹ã€‚ POST è¯·æ±‚ï¼š ä¸å¹‚ç­‰ï¼šæ¯æ¬¡è¯·æ±‚å¯èƒ½å¯¼è‡´æœåŠ¡å™¨çŠ¶æ€å˜åŒ–ï¼ˆå¦‚åˆ›å»ºèµ„æºï¼‰ã€‚ ä¸å®‰å…¨ï¼šè¯·æ±‚ä¼šå¯¹æœåŠ¡å™¨èµ„æºè¿›è¡Œä¿®æ”¹ã€‚ ä»å…¶ä»–å±‚é¢ï¼š GET è¯·æ±‚ï¼šèƒ½å¤Ÿè¢«ç¼“å­˜ï¼Œå‡è½»æœåŠ¡å™¨è´Ÿæ‹…ã€‚èƒ½å¤Ÿä¿å­˜åœ¨æµè§ˆå™¨çš„æµè§ˆè®°å½•é‡Œã€‚URL å¯ä»¥ä¿å­˜ä¸ºæµè§ˆå™¨ä¹¦ç­¾ã€‚ POST è¯·æ±‚ï¼šä¸èƒ½è¢«ç¼“å­˜ï¼Œä¸ä¿å­˜åœ¨æµè§ˆå™¨å†å²è®°å½•é‡Œã€‚URL ä¸ä¾¿äºä¿å­˜ä¸ºä¹¦ç­¾ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.5 GET çš„é•¿åº¦é™åˆ¶æ˜¯å¤šå°‘ï¼Ÿ HTTP ä¸­çš„ GET æ–¹æ³•æ˜¯é€šè¿‡ URL ä¼ é€’æ•°æ®çš„ï¼Œä½†æ˜¯ URL æœ¬èº«å…¶å®å¹¶æ²¡æœ‰å¯¹æ•°æ®çš„é•¿åº¦è¿›è¡Œé™åˆ¶ï¼ŒçœŸæ­£é™åˆ¶ GET é•¿åº¦çš„æ˜¯æµè§ˆå™¨ã€‚ ä¾‹å¦‚ IE æµè§ˆå™¨å¯¹ URL çš„æœ€å¤§é™åˆ¶æ˜¯ 2000 å¤šä¸ªå­—ç¬¦ï¼Œå¤§æ¦‚ 2kb å·¦å³ï¼Œåƒ Chromeã€Firefox ç­‰æµè§ˆå™¨æ”¯æŒçš„ URL å­—ç¬¦æ•°æ›´å¤šï¼Œå…¶ä¸­ FireFox ä¸­ URL çš„æœ€å¤§é•¿åº¦é™åˆ¶æ˜¯ 65536 ä¸ªå­—ç¬¦ï¼ŒChrome åˆ™æ˜¯ 8182 ä¸ªå­—ç¬¦ã€‚ è¿™ä¸ªé•¿åº¦é™åˆ¶ä¹Ÿä¸æ˜¯é’ˆå¯¹æ•°æ®éƒ¨åˆ†ï¼Œè€Œæ˜¯é’ˆå¯¹æ•´ä¸ª URLã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:5","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.6 HTTP è¯·æ±‚çš„è¿‡ç¨‹ä¸åŸç†ï¼Ÿ HTTP å…¨ç§°æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHyperText Transfer Protocolï¼‰ï¼Œæ˜¯ä¸€ä¸ªåŸºäºè¯·æ±‚ä¸å“åº”æ¨¡å¼çš„åº”ç”¨å±‚åè®®ï¼ŒåŸºäº TCP/IP åè®®ä¼ è¾“æ•°æ®ã€‚ HTTP éµå¾ªæ ‡å‡†çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹ï¼Œå®¢æˆ·ç«¯æ‰“å¼€è¿æ¥ä»¥å‘å‡ºè¯·æ±‚ï¼Œç„¶åç­‰å¾…å®ƒæ”¶åˆ°æœåŠ¡å™¨ç«¯å“åº”ã€‚ åœ¨æµè§ˆå™¨è¾“å…¥ URL åï¼Œæµè§ˆå™¨é¦–å…ˆä¼šé€šè¿‡ DNS è§£æè·å–åˆ°æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œç„¶åä¸æœåŠ¡å™¨å»ºç«‹ TCP è¿æ¥ã€‚ TCP è¿æ¥å»ºç«‹åï¼Œæµè§ˆå™¨ä¼šå‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ã€‚ æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä¼šæ ¹æ®è¯·æ±‚çš„ä¿¡æ¯å¤„ç†è¯·æ±‚ã€‚ å¤„ç†å®Œè¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ª HTTP å“åº”ç»™æµè§ˆå™¨ã€‚ æµè§ˆå™¨æ”¶åˆ°å“åº”åï¼Œä¼šæ ¹æ®å“åº”çš„ä¿¡æ¯æ¸²æŸ“é¡µé¢ã€‚ç„¶åï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨æ–­å¼€ TCP è¿æ¥ã€‚ å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å›ä¸€ä¸ªå“åº”ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯åœ¨å‘é€è¯·æ±‚åå¿…é¡»ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ã€‚åœ¨ç­‰å¾…å“åº”çš„è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯ä¸ä¼šå‘é€å…¶ä»–è¯·æ±‚ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:6","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.7 è¯´ä¸€ä¸‹ HTTP çš„æŠ¥æ–‡ç»“æ„ï¼Ÿ HTTP çš„æŠ¥æ–‡ç»“æ„å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šè¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ã€‚ä¸¤è€…åœ¨ç»“æ„ä¸Šç›¸ä¼¼ï¼Œéƒ½åŒ…å«äº†èµ·å§‹è¡Œã€å¤´éƒ¨å’Œæ¶ˆæ¯æ­£æ–‡ã€‚ è¯·æ±‚æŠ¥æ–‡ç»“æ„ è¯·æ±‚è¡Œ (Request Line) æ–¹æ³• (Method)ï¼šå¦‚ GETã€POSTã€PUTã€DELETE ç­‰ã€‚ è¯·æ±‚ç›®æ ‡ (Request-URI)ï¼šå³è¯·æ±‚çš„èµ„æºè·¯å¾„ã€‚ HTTP ç‰ˆæœ¬ (HTTP-Version)ï¼šå¦‚ HTTP/1.1ã€‚ è¯·æ±‚å¤´éƒ¨ (Request Headers) åŒ…å«å¤šä¸ªé¦–éƒ¨å­—æ®µï¼Œæ¯ä¸ªå­—æ®µç”±å­—æ®µåå’Œå­—æ®µå€¼ç»„æˆã€‚ ç”¨äºæä¾›å®¢æˆ·ç«¯ä¿¡æ¯ã€è¯·æ±‚çš„èµ„æºä¿¡æ¯ç­‰ã€‚ å¸¸è§è¯·æ±‚å¤´ï¼š Hostï¼šè¯·æ±‚çš„ä¸»æœºåå’Œç«¯å£ã€‚ User-Agentï¼šå‘èµ·è¯·æ±‚çš„å®¢æˆ·ç«¯ä¿¡æ¯ã€‚ Acceptï¼šå®¢æˆ·ç«¯å¯æ¥å—çš„å“åº”å†…å®¹ç±»å‹ã€‚ Content-Typeï¼šè¯·æ±‚ä½“çš„åª’ä½“ç±»å‹ã€‚ Authorizationï¼šè®¤è¯ä¿¡æ¯ã€‚ ç©ºè¡Œï¼šç”¨äºåˆ†éš”è¯·æ±‚å¤´éƒ¨å’Œè¯·æ±‚ä¸»ä½“ã€‚ è¯·æ±‚ä¸»ä½“ (Request Body)ï¼šåŒ…å«å®é™…è¦å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œä»…åœ¨ POSTã€PUT ç­‰æ–¹æ³•ä¸­å­˜åœ¨ã€‚ GET /index.html HTTP/1.1 Host: www.example.com User-Agent: Mozilla/5.0 Accept: text/html å“åº”æŠ¥æ–‡ç»“æ„ çŠ¶æ€è¡Œ (Status Line) HTTP ç‰ˆæœ¬ (HTTP-Version)ï¼šå¦‚ HTTP/1.1ã€‚ çŠ¶æ€ç  (Status Code)ï¼šå¦‚ 200ã€404ã€500 ç­‰ã€‚ åŸå› çŸ­è¯­ (Reason-Phrase)ï¼šå¯¹çŠ¶æ€ç çš„ç®€çŸ­æè¿°ã€‚ å“åº”å¤´éƒ¨ (Response Headers) åŒ…å«å¤šä¸ªé¦–éƒ¨å­—æ®µï¼Œæ¯ä¸ªå­—æ®µç”±å­—æ®µåå’Œå­—æ®µå€¼ç»„æˆã€‚ ç”¨äºæä¾›æœåŠ¡å™¨ä¿¡æ¯ã€å“åº”çš„èµ„æºä¿¡æ¯ç­‰ã€‚ å¸¸è§å“åº”å¤´ï¼š Dateï¼šå“åº”ç”Ÿæˆçš„æ—¥æœŸå’Œæ—¶é—´ã€‚ Content-Typeï¼šå“åº”ä½“çš„åª’ä½“ç±»å‹ã€‚ Content-Lengthï¼šå“åº”ä½“çš„é•¿åº¦ã€‚ Set-Cookieï¼šè®¾ç½® HTTP Cookieã€‚ ç©ºè¡Œï¼šç”¨äºåˆ†éš”å“åº”å¤´éƒ¨å’Œå“åº”ä¸»ä½“ã€‚ å“åº”ä¸»ä½“ (Response Body)ï¼šåŒ…å«å®é™…è¦è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®ã€‚ HTTP/1.1 200 OK Date: Mon, 27 Jul 2009 12:28:53 GMT Content-Type: text/html Content-Length: 138 \u003chtml\u003e \u003cbody\u003e \u003ch1\u003eHello, World!\u003c/h1\u003e \u003c/body\u003e \u003c/html\u003e ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:7","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.8 URI å’Œ URL æœ‰ä»€ä¹ˆåŒºåˆ«? å±æ€§ URI URL å®šä¹‰ ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼Œç”¨äºæ ‡è¯†ä¸€ä¸ªèµ„æº ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œæä¾›èµ„æºçš„å®šä½æ–¹æ³• ç»„æˆéƒ¨åˆ† [scheme:][//authority][path][?query][#fragment] scheme://authority/path[?query][#fragment]ï¼ˆå¿…é¡»åŒ…å«schemeï¼ˆåè®®ï¼‰ï¼Œauthorityï¼ˆåŸŸå/IPï¼‰ï¼Œè·¯å¾„ï¼‰ ä¾‹å­ urn:isbn:0451450523ï¼ˆä¸ºURNï¼Œä¸æ˜¯URLï¼Œä½†æ˜¯URIï¼‰ https://www.example.com/index.html å­é›† å¯ä»¥æ˜¯ URL æˆ– URN æ˜¯ URI çš„å­é›† ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:8","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.9 è¯´ä¸‹ HTTP1.0ï¼Œ1.1ï¼Œ2.0 çš„åŒºåˆ«ï¼Ÿ HTTP1.0 é»˜è®¤çŸ­è¿æ¥ï¼ŒHTTP 1.1 é»˜è®¤é•¿è¿æ¥ï¼ŒHTTP 2.0 é‡‡ç”¨å¤šè·¯å¤ç”¨ã€‚ ç‰¹æ€§ HTTP/1.0 HTTP/1.1 HTTP/2.0 è¿æ¥ç®¡ç† çŸ­è¿æ¥ï¼ˆé»˜è®¤æ¯ä¸ªè¯·æ±‚/å“åº”å¯¹åéƒ½å…³é—­è¿æ¥ï¼‰ é•¿è¿æ¥ï¼ˆé»˜è®¤ keep-aliveï¼‰ å¤šè·¯å¤ç”¨ï¼ˆåŒä¸€è¿æ¥å¤šè¯·æ±‚ï¼‰ Host å¤´éƒ¨ ä¸æ”¯æŒ æ”¯æŒ æ”¯æŒ ç¼“å­˜æ§åˆ¶ ç®€å•çš„ Expires å¤´éƒ¨ å¤æ‚çš„ Cache-Control å¤´éƒ¨ åŒ HTTP/1.1 ä¼ è¾“ç¼–ç  æ—  æ”¯æŒåˆ†å—ä¼ è¾“ç¼–ç  äºŒè¿›åˆ¶åˆ†å¸§ è¯·æ±‚æ–¹æ³• GET, POST GET, POST, PUT, DELETE, OPTIONS ç­‰ åŒ HTTP/1.1 å¤´éƒ¨å‹ç¼© æ—  æ—  HPACK å‹ç¼©ï¼ˆå‡å°‘äº†å†—ä½™å¤´éƒ¨ä¿¡æ¯çš„å¸¦å®½æ¶ˆè€—ï¼‰ æœåŠ¡å™¨æ¨é€ æ—  æ—  æ”¯æŒ æµä¼˜å…ˆçº§ æ—  æ—  æ”¯æŒ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:9","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.10 HTTP/3 äº†è§£å—ï¼Ÿ HTTP/2.0 åŸºäº TCP åè®®ï¼Œè€Œ HTTP/3.0 åˆ™åŸºäº QUIC åè®®ï¼ŒQuick UDP Connectionsï¼Œç›´è¯‘ä¸ºå¿«é€Ÿ UDP ç½‘ç»œè¿æ¥ã€‚ åŸºäº TCP çš„ HTTP/2.0ï¼Œå°½ç®¡ä»é€»è¾‘ä¸Šæ¥è¯´ï¼Œä¸åŒçš„æµä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œä¸ä¼šç›¸äº’å½±å“ï¼Œä½†åœ¨å®é™…ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®è¿˜æ˜¯è¦ä¸€å¸§ä¸€å¸§çš„å‘é€å’Œæ¥æ”¶ï¼Œä¸€æ—¦æŸä¸€ä¸ªæµçš„æ•°æ®æœ‰ä¸¢åŒ…ï¼Œä»ç„¶ä¼šé˜»å¡åœ¨å®ƒä¹‹åä¼ è¾“çš„æµæ•°æ®ã€‚ è€ŒåŸºäº UDP çš„ QUIC åè®®å¯ä»¥æ›´å½»åº•è§£å†³äº† HTTP/2 ä¸­çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼Œè®©ä¸åŒçš„æµä¹‹é—´çœŸæ­£çš„å®ç°ç›¸äº’ç‹¬ç«‹ä¼ è¾“ï¼Œäº’ä¸å¹²æ‰°ã€‚åŒæ—¶ï¼ŒQUIC åè®®åœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­å°±å®Œæˆäº† TLS åŠ å¯†æ¡æ‰‹ï¼Œæ›´ç›´æ¥äº†ã€‚ ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯å“ªä¸ªHTTPç‰ˆæœ¬è¿˜æ˜¯æ˜¯ HTTP/2ï¼Œåœ¨ 2022 å¹´ 1 æœˆè¾¾åˆ°å³°å€¼ï¼Œå æ‰€æœ‰ç½‘ç«™çš„ 46.9%ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:10","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.11 HTTP å¦‚ä½•å®ç°é•¿è¿æ¥ï¼Ÿåœ¨ä»€ä¹ˆæ—¶å€™ä¼šè¶…æ—¶ï¼Ÿ ä»€ä¹ˆæ˜¯ HTTP çš„é•¿è¿æ¥ï¼Ÿ HTTP åˆ†ä¸ºé•¿è¿æ¥å’ŒçŸ­è¿æ¥ï¼Œæœ¬è´¨ä¸Šè¯´çš„æ˜¯ TCP çš„é•¿çŸ­è¿æ¥ã€‚TCP è¿æ¥æ˜¯ä¸€ä¸ªåŒå‘çš„é€šé“ï¼Œå®ƒæ˜¯å¯ä»¥ä¿æŒä¸€æ®µæ—¶é—´ä¸å…³é—­çš„ï¼Œå› æ­¤ TCP è¿æ¥æ‰å…·æœ‰çœŸæ­£çš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥è¿™ä¸€è¯´æ³•ã€‚ TCP é•¿è¿æ¥å¯ä»¥å¤ç”¨ä¸€ä¸ª TCP è¿æ¥ï¼Œæ¥å‘èµ·å¤šæ¬¡çš„ HTTP è¯·æ±‚ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘èµ„æºæ¶ˆè€—ï¼Œæ¯”å¦‚ä¸€æ¬¡è¯·æ±‚ HTMLï¼Œå¦‚æœæ˜¯çŸ­è¿æ¥çš„è¯ï¼Œå¯èƒ½è¿˜éœ€è¦è¯·æ±‚åç»­çš„ JS/CSSã€‚ é€šè¿‡åœ¨å¤´éƒ¨ï¼ˆè¯·æ±‚å’Œå“åº”å¤´ï¼‰è®¾ç½® Connection å­—æ®µæŒ‡å®šä¸ºkeep-aliveï¼ŒHTTP/1.0 åè®®æ”¯æŒï¼Œä½†æ˜¯æ˜¯é»˜è®¤å…³é—­çš„ï¼Œä» HTTP/1.1 ä»¥åï¼Œè¿æ¥é»˜è®¤éƒ½æ˜¯é•¿è¿æ¥ã€‚ åœ¨ä»€ä¹ˆæ—¶å€™ä¼šè¶…æ—¶å‘¢ï¼Ÿ HTTP ä¸€èˆ¬ä¼šæœ‰ httpd å®ˆæŠ¤è¿›ç¨‹ï¼Œé‡Œé¢å¯ä»¥è®¾ç½® keep-alive timeoutï¼Œå½“ tcp è¿æ¥é—²ç½®è¶…è¿‡è¿™ä¸ªæ—¶é—´å°±ä¼šå…³é—­ï¼Œä¹Ÿå¯ä»¥åœ¨ HTTP çš„ header é‡Œé¢è®¾ç½®è¶…æ—¶æ—¶é—´ TCP çš„ keep-alive åŒ…å«ä¸‰ä¸ªå‚æ•°ï¼Œæ”¯æŒåœ¨ç³»ç»Ÿå†…æ ¸çš„ net.ipv4 é‡Œé¢è®¾ç½®ï¼›å½“ TCP è¿æ¥ä¹‹åï¼Œé—²ç½®äº† tcp_keepalive_timeï¼Œåˆ™ä¼šå‘ç”Ÿä¾¦æµ‹åŒ…ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°å¯¹æ–¹çš„ ACKï¼Œé‚£ä¹ˆä¼šæ¯éš” tcp_keepalive_intvl å†å‘ä¸€æ¬¡ï¼Œç›´åˆ°å‘é€äº† tcp_keepalive_probesï¼Œå°±ä¼šä¸¢å¼ƒè¯¥è¿æ¥ã€‚ tcp_keepalive_intvl = 15 tcp_keepalive_probes = 5 tcp_keepalive_time = 1800 ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:11","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.12 è¯´è¯´ HTTP ä¸ HTTPS æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ HTTPS æ˜¯ HTTP çš„å¢å¼ºç‰ˆï¼Œåœ¨ HTTP çš„åŸºç¡€ä¸ŠåŠ å…¥äº† SSL/TLS åè®®ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯åŠ å¯†çš„ã€‚SSL/TLS éœ€è¦å‘ CAï¼ˆè¯ä¹¦æƒå¨æœºæ„ï¼‰ç”³è¯·æ•°å­—è¯ä¹¦ï¼Œç”¨äºéªŒè¯æœåŠ¡å™¨çš„èº«ä»½ã€‚ HTTP çš„é»˜è®¤ç«¯â¼å·æ˜¯ 80ï¼ŒURL ä»¥http://å¼€å¤´ï¼›HTTPS çš„é»˜è®¤ç«¯â¼å·æ˜¯ 443ï¼ŒURL ä»¥https://å¼€å¤´ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:12","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.13 ä¸ºä»€ä¹ˆè¦ç”¨ HTTPSï¼Ÿè§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ ä½¿ç”¨ HTTPS ä¸»è¦æ˜¯ä¸ºäº†è§£å†³ HTTP ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä¸€äº›å®‰å…¨é—®é¢˜ï¼Œå› ä¸º HTTP æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œæ‰€ä»¥ HTTPS åœ¨ HTTP çš„åŸºç¡€ä¸ŠåŠ å…¥äº† SSL/TLS åè®®ã€‚ HTTPS ä¸»è¦è§£å†³äº†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š çªƒå¬é£é™©ï¼šç¬¬ä¸‰æ–¹å¯ä»¥æˆªè·ä¼ è¾“çš„æ•°æ®åŒ…ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ã€‚ ç¯¡æ”¹é£é™©ï¼šç¬¬ä¸‰æ–¹å¯ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ç¯¡æ”¹æ•°æ®åŒ…ï¼Œä¿®æ”¹æ•°æ®ã€‚ å†’å……é£é™©ï¼šç¬¬ä¸‰æ–¹å¯ä»¥å†’å……æœåŠ¡å™¨ï¼Œä¸å®¢æˆ·ç«¯é€šä¿¡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:13","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.14 HTTPS å·¥ä½œæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ HTTPS çš„è¿æ¥å»ºç«‹åœ¨ SSL/TLS æ¡æ‰‹ä¹‹ä¸Šï¼Œå·¥ä½œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¦‚æœé€šä¿¡å†…å®¹è¢«æˆªå–ï¼Œä½†ç”±äºæ²¡æœ‰ä¼šè¯å¯†é’¥ï¼Œæ‰€ä»¥æ— æ³•è§£å¯†ã€‚å½“é€šä¿¡ç»“æŸåï¼Œè¿æ¥ä¼šè¢«å…³é—­ï¼Œä¼šè¯å¯†é’¥ä¹Ÿä¼šè¢«é”€æ¯ï¼Œä¸‹æ¬¡é€šä¿¡ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªä¼šè¯å¯†é’¥ã€‚ HTTPS åœ¨ä¸åŒé˜¶æ®µä¼šä½¿ç”¨ä¸åŒçš„åŠ å¯†æ–¹å¼ï¼š éå¯¹ç§°åŠ å¯†ï¼šåœ¨æ¡æ‰‹é˜¶æ®µä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¯†é’¥äº¤æ¢è¿‡ç¨‹ä¸­ã€‚éå¯¹ç§°åŠ å¯†ä½¿ç”¨å…¬é’¥å’Œç§é’¥ï¼Œå…¶ä¸­å…¬é’¥å¯ä»¥å…¬å¼€ï¼Œç§é’¥ä¿å¯†ã€‚å®¢æˆ·ç«¯ä½¿ç”¨å…¬é’¥åŠ å¯†ä¿¡æ¯ï¼ŒæœåŠ¡å™¨ä½¿ç”¨ç§é’¥è§£å¯†ã€‚ å¯¹ç§°åŠ å¯†ï¼šåœ¨å®Œæˆæ¡æ‰‹åï¼Œæ‰€æœ‰çš„æ•°æ®ä¼ è¾“éƒ½ä½¿ç”¨å¯¹ç§°åŠ å¯†ã€‚å¯¹ç§°åŠ å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œè¿™ç§åŠ å¯†æ–¹å¼æ¯”éå¯¹ç§°åŠ å¯†æ›´å¿«ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:14","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.15 HTTPS ä¼šåŠ å¯† URL å—ï¼Ÿ HTTPS é€šè¿‡ SSL/TLS åè®®ç¡®ä¿äº†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´äº¤æ¢çš„æ•°æ®è¢«åŠ å¯†ï¼Œè¿™åŒ…æ‹¬ HTTP å¤´éƒ¨å’Œæ­£æ–‡ã€‚è€Œ URL æ˜¯ HTTP å¤´éƒ¨çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä¿¡æ¯ä¹Ÿæ˜¯åŠ å¯†çš„ã€‚ä½†å› ä¸ºæ¶‰åŠåˆ° SSL æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥åŸŸåä¿¡æ¯ä¼šè¢«æš´éœ²å‡ºæ¥ï¼Œéœ€è¦æ³¨æ„ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:15","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.16 å®¢æˆ·ç«¯æ€ä¹ˆå»æ ¡éªŒè¯ä¹¦çš„åˆæ³•æ€§ï¼Ÿ é¦–å…ˆï¼Œæ‰€æœ‰çš„è¯ä¹¦éƒ½æ˜¯ç”± CA æœºæ„ç­¾å‘çš„ï¼ŒCA æœºæ„æ˜¯ä¸€ä¸ªå—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹æœºæ„ï¼Œå®ƒä¼šå¯¹è¯ä¹¦çš„ç”³è¯·è€…è¿›è¡Œèº«ä»½éªŒè¯ï¼Œç„¶åç­¾å‘è¯ä¹¦ï¼Œå®ƒå…·æœ‰æé«˜çš„å¯ä¿¡åº¦ã€‚ å®¢æˆ·ç«¯ï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼Œé€šå¸¸ä¼šé›†æˆ CA çš„å…¬é’¥ä¿¡æ¯ï¼‰åœ¨æ ¡éªŒè¯ä¹¦çš„åˆæ³•æ€§æ—¶ï¼Œä¸»è¦é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥æ ¡éªŒè¯ä¹¦çš„åˆæ³•æ€§ã€‚ æµè§ˆå™¨ä¼šè¯»å–è¯ä¹¦çš„æ‰€æœ‰è€…ã€æœ‰æ•ˆæœŸã€é¢å‘è€…ç­‰ä¿¡æ¯ï¼Œå…ˆæ ¡éªŒç½‘ç«™åŸŸåæ˜¯å¦ä¸€è‡´ï¼Œç„¶åæ ¡éªŒè¯ä¹¦çš„æœ‰æ•ˆæœŸæ˜¯å¦è¿‡æœŸï¼› æµè§ˆå™¨å¼€å§‹æŸ¥æ‰¾å†…ç½®çš„ CAï¼Œä¸æœåŠ¡å™¨è¿”å›è¯ä¹¦ä¸­çš„é¢å‘è€…è¿›è¡Œå¯¹æ¯”ï¼Œç¡®è®¤æ˜¯å¦ä¸ºåˆæ³•æœºæ„ï¼› å¦‚æœæ˜¯ï¼Œä»å†…éƒ¨æ¤å…¥çš„ CA å…¬é’¥è§£å¯† Certificate çš„ Signature å†…å®¹ï¼Œå¾—åˆ°â¼€ä¸ª Hash å€¼ H2ï¼› ä½¿â½¤åŒæ ·çš„ Hash ç®—æ³•è·å–è¯ä¹¦çš„ Hash å€¼ H1ï¼Œâ½è¾ƒ H1 å’Œ H2ï¼Œå¦‚æœå€¼ç›¸åŒï¼Œåˆ™ä¸ºå¯ä¿¡èµ–çš„è¯ä¹¦ï¼Œå¦åˆ™å‘Šè­¦ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:16","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.17 å¦‚ä½•ç†è§£ HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ï¼Ÿ è¿™ä¸ªæ— çŠ¶æ€çš„çš„çŠ¶æ€å€¼çš„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å®¢æˆ·ç«¯çš„çŠ¶æ€ï¼Œæ‰€ä»¥å­—é¢æ„æ€ï¼Œå°±æ˜¯ HTTP åè®®ä¸­æœåŠ¡ç«¯ä¸ä¼šä¿å­˜å®¢æˆ·ç«¯çš„ä»»ä½•ä¿¡æ¯ã€‚ æ¯”å¦‚å½“æµè§ˆå™¨ç¬¬ä¸€æ¬¡å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨å“åº”äº†ï¼›å¦‚æœåŒä¸ªæµè§ˆå™¨å‘èµ·ç¬¬äºŒæ¬¡è¯·æ±‚ç»™æœåŠ¡å™¨æ—¶ï¼Œå®ƒè¿˜æ˜¯ä¼šå“åº”ï¼Œä½†æ˜¯å‘¢ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“ä½ å°±æ˜¯åˆšæ‰çš„é‚£ä¸ªæµè§ˆå™¨ã€‚ é‚£æœ‰ä»€ä¹ˆåŠæ³•è®°å½•çŠ¶æ€å‘¢ï¼Ÿ ä¸»è¦æœ‰ä¸¤ä¸ªåŠæ³•ï¼ŒSession å’Œ Cookieã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:17","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"3.18 è¯´è¯´ Session å’Œ Cookie æœ‰ä»€ä¹ˆè”ç³»å’ŒåŒºåˆ«? Cookie æ˜¯ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„ä¸€å°å—æ–‡æœ¬ä¸²çš„æ•°æ®ã€‚å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡ç«¯ä¼šå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª Cookieï¼Œå®¢æˆ·ç«¯å°±æŠŠ Cookie ä¿å­˜èµ·æ¥ã€‚åœ¨å®¢æˆ·ç«¯ä¸‹æ¬¡å‘åŒä¸€æœåŠ¡å™¨å†å‘èµ·è¯·æ±‚æ—¶ï¼ŒCookie è¢«æºå¸¦å‘é€åˆ°æœåŠ¡å™¨ï¼ˆé€šè¿‡ HTTP è¯·æ±‚å¤´çš„ Cookie å­—æ®µåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’ï¼‰ã€‚æœåŠ¡ç«¯å¯ä»¥æ ¹æ®è¿™ä¸ª Cookie åˆ¤æ–­ç”¨æˆ·çš„èº«ä»½å’ŒçŠ¶æ€ã€‚Cookieå¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚å¦‚æœä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåˆ™ Cookie åœ¨ä¼šè¯ç»“æŸï¼ˆæµè§ˆå™¨å…³é—­ï¼‰æ—¶å¤±æ•ˆã€‚å¯ä»¥é€šè¿‡è®¾ç½® Expires æˆ– Max-Age å±æ€§æ¥å®šä¹‰ Cookie çš„æŒä¹…æ€§ã€‚ Session æŒ‡çš„å°±æ˜¯æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸€æ¬¡ä¼šè¯çš„è¿‡ç¨‹ã€‚å®ƒæ˜¯å¦ä¸€ç§è®°å½•å®¢æˆ·çŠ¶æ€çš„æœºåˆ¶ã€‚ä¸åŒçš„æ˜¯ cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ï¼Œè€Œ session ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼ˆå®¢æˆ·ç«¯åªä¿å­˜ Session IDï¼‰ã€‚å®¢æˆ·ç«¯æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æŠŠå®¢æˆ·ç«¯ä¿¡æ¯ä»¥æŸç§å½¢å¼è®°å½•åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™å°±æ˜¯ sessionã€‚å®¢æˆ·ç«¯æµè§ˆå™¨å†æ¬¡è®¿é—®æ—¶åªéœ€è¦ä»è¯¥ session ä¸­æŸ¥æ‰¾ç”¨æˆ·çš„çŠ¶æ€ã€‚Sessionä¸€èˆ¬åœ¨ç”¨æˆ·ä¼šè¯ç»“æŸæ—¶ï¼ˆä¾‹å¦‚å…³é—­æµè§ˆå™¨ã€è¶…æ—¶ï¼‰å¤±æ•ˆã€‚æœåŠ¡å™¨ç«¯å¯ä»¥é…ç½® Session çš„è¿‡æœŸæ—¶é—´ã€‚ Session å’Œ Cookie è”ç³»ï¼šä¾èµ–äº Cookie æ¥ä¼ é€’ Session IDï¼ˆé€šå¸¸æ˜¯æœåŠ¡å™¨åœ¨åˆ›å»º Session æ—¶è®¾ç½®ä¸€ä¸ª Cookie æ¥å­˜å‚¨ Session IDï¼‰ã€‚ Session å’Œ Cookie çš„ä½¿ç”¨åœºæ™¯ä¹Ÿä¸åŒï¼š Cookieï¼šé€‚ç”¨äºå­˜å‚¨ç”¨æˆ·åå¥½ã€ç™»å½•çŠ¶æ€ç­‰è¾ƒå°çš„æ•°æ®ï¼Œå¯ä»¥è·¨é¡µé¢æŒä¹…åŒ–æ•°æ®ã€‚å¸¸ç”¨äºè®°å½•ç”¨æˆ·ä¿¡æ¯ã€è·Ÿè¸ªç”¨æˆ·è¡Œä¸ºç­‰ã€‚ Sessionï¼šé€‚ç”¨äºå­˜å‚¨ç”¨æˆ·ä¼šè¯ä¸­çš„ä¸´æ—¶ä¿¡æ¯ï¼Œå¦‚è´­ç‰©è½¦ã€ç™»å½•çŠ¶æ€ç­‰ã€‚æ›´é€‚åˆéœ€è¦è¾ƒé«˜å®‰å…¨æ€§çš„åœºæ™¯ï¼Œå› ä¸ºæ•°æ®å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ã€‚ åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ Session æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ç»è¿‡è´Ÿè½½å‡è¡¡ï¼Œå¯èƒ½ä¼šåˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå‡å¦‚ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ä¸¤æ¬¡æ²¡æœ‰è½åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆåœ¨æ–°çš„æœåŠ¡å™¨ä¸Šå°±æ²¡æœ‰è®°å½•ç”¨æˆ·çŠ¶æ€çš„ Sessionã€‚ å¯ä»¥ä½¿ç”¨ Redis ç­‰åˆ†å¸ƒå¼ç¼“å­˜æ¥å­˜å‚¨ Sessionï¼Œåœ¨å¤šå°æœåŠ¡å™¨ä¹‹é—´å…±äº«ã€‚ å®¢æˆ·ç«¯æ— æ³•ä½¿ç”¨ Cookie æ€ä¹ˆåŠï¼Ÿ æœ‰å¯èƒ½å®¢æˆ·ç«¯æ— æ³•ä½¿ç”¨ Cookieï¼Œæ¯”å¦‚æµè§ˆå™¨ç¦ç”¨ Cookieï¼Œæˆ–è€…å®¢æˆ·ç«¯æ˜¯å®‰å“ã€IOS ç­‰ç­‰ã€‚ è¿™æ—¶å€™æ€ä¹ˆåŠï¼ŸSessionID æ€ä¹ˆå­˜ï¼Ÿæ€ä¹ˆä¼ ç»™æœåŠ¡ç«¯å‘¢ï¼Ÿé¦–å…ˆæ˜¯ SessionID çš„å­˜å‚¨ï¼Œå¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯çš„æœ¬åœ°å­˜å‚¨ï¼Œæ¯”å¦‚æµè§ˆå™¨çš„ sessionStorageã€‚ æ¥ä¸‹æ¥æ€ä¹ˆä¼ å‘¢ï¼Ÿ æ‹¼æ¥åˆ° URL é‡Œï¼šç›´æ¥æŠŠ SessionID ä½œä¸º URL çš„è¯·æ±‚å‚æ•° æ”¾åˆ°è¯·æ±‚å¤´é‡Œï¼šæŠŠ SessionID æ”¾åˆ°è¯·æ±‚çš„ Header é‡Œï¼Œæ¯”è¾ƒå¸¸ç”¨ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:3:18","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4 TCP ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.1 è¯¦ç»†è¯´ä¸€ä¸‹ TCP çš„ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶ï¼Ÿ TCPï¼ˆTransmission Control Protocolï¼‰æ˜¯ä¸€ä¸ªé¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚åè®®ã€‚TCP é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶æ¥å»ºç«‹è¿æ¥ï¼Œç¡®ä¿åŒæ–¹å‡†å¤‡å°±ç»ªå¹¶èƒ½å¯é åœ°è¿›è¡Œé€šä¿¡ã€‚ä»¥ä¸‹æ˜¯ä¸‰æ¬¡æ¡æ‰‹çš„è¯¦ç»†è¿‡ç¨‹ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ å®¢æˆ·ç«¯ï¼šå‘é€ä¸€ä¸ªå¸¦æœ‰ SYN æ ‡å¿—çš„ TCP æŠ¥æ–‡æ®µï¼ˆç§°ä¸º SYN æŠ¥æ–‡æ®µï¼‰ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªåˆå§‹åºåˆ—å· seq = xã€‚ æœåŠ¡å™¨ï¼šæ”¶åˆ°è¿™ä¸ª SYN æŠ¥æ–‡æ®µåï¼ŒæœåŠ¡å™¨å¤„äº â€œSYN_RCVDâ€ çŠ¶æ€ã€‚ ç›®çš„ï¼šå®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡å™¨å®ƒå¸Œæœ›å»ºç«‹è¿æ¥ï¼Œå¹¶å‘ŠçŸ¥æœåŠ¡å™¨è‡ªå·±çš„åˆå§‹åºåˆ—å·ã€‚ æŠ¥æ–‡å†…å®¹ï¼š å®¢æˆ·ç«¯ --\u003e æœåŠ¡å™¨: SYN, seq = x ç¬¬äºŒæ¬¡æ¡æ‰‹ æœåŠ¡å™¨ï¼šæœåŠ¡å™¨æ”¶åˆ° SYN æŠ¥æ–‡æ®µåï¼Œå›å¤ä¸€ä¸ªå¸¦æœ‰ SYN å’Œ ACK æ ‡å¿—çš„ TCP æŠ¥æ–‡æ®µï¼ˆç§°ä¸º SYN-ACK æŠ¥æ–‡æ®µï¼‰ã€‚è¯¥æŠ¥æ–‡æ®µä¸­åŒ…å«æœåŠ¡å™¨é€‰æ‹©çš„åˆå§‹åºåˆ—å· seq = yï¼Œä»¥åŠå¯¹å®¢æˆ·ç«¯åºåˆ—å· x çš„ç¡®è®¤ ack = x + 1ã€‚ å®¢æˆ·ç«¯ï¼šæ”¶åˆ°è¿™ä¸ª SYN-ACK æŠ¥æ–‡æ®µåï¼Œå®¢æˆ·ç«¯å¤„äº â€œESTABLISHEDâ€ çŠ¶æ€ã€‚ ç›®çš„ï¼šæœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå®ƒçš„è¿æ¥è¯·æ±‚è¢«æ¥å—äº†ï¼Œå¹¶é€šçŸ¥å®¢æˆ·ç«¯è‡ªå·±çš„åˆå§‹åºåˆ—å·ã€‚ æŠ¥æ–‡å†…å®¹ï¼š æœåŠ¡å™¨ --\u003e å®¢æˆ·ç«¯: SYN, ACK, seq = y, ack = x + 1 ç¬¬ä¸‰æ¬¡æ¡æ‰‹ å®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯æ”¶åˆ° SYN-ACK æŠ¥æ–‡æ®µåï¼Œå›å¤ä¸€ä¸ªå¸¦æœ‰ ACK æ ‡å¿—çš„ TCP æŠ¥æ–‡æ®µï¼ˆç§°ä¸º ACK æŠ¥æ–‡æ®µï¼‰ã€‚è¯¥æŠ¥æ–‡æ®µä¸­åŒ…å«å¯¹æœåŠ¡å™¨åºåˆ—å· y çš„ç¡®è®¤ ack = y + 1ã€‚ æœåŠ¡å™¨ï¼šæ”¶åˆ°è¿™ä¸ª ACK æŠ¥æ–‡æ®µåï¼ŒæœåŠ¡å™¨å¤„äº â€œESTABLISHEDâ€ çŠ¶æ€ï¼Œè¿æ¥å»ºç«‹å®Œæˆã€‚ ç›®çš„ï¼šå®¢æˆ·ç«¯ç¡®è®¤æ”¶åˆ°äº†æœåŠ¡å™¨çš„åŒæ­¥åº”ç­”ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œå»ºç«‹è¿æ¥ã€‚ æŠ¥æ–‡å†…å®¹ï¼š å®¢æˆ·ç«¯ --\u003e æœåŠ¡å™¨: ACK, seq = x + 1, ack = y + 1 ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.2 TCP æ¡æ‰‹ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡ï¼Œä¸ºä»€ä¹ˆä¸èƒ½æ˜¯ä¸¤æ¬¡ï¼Ÿä¸èƒ½æ˜¯å››æ¬¡ï¼Ÿ ä½¿ç”¨ä¸‰æ¬¡æ¡æ‰‹å¯ä»¥å»ºç«‹ä¸€ä¸ªå¯é çš„è¿æ¥ã€‚è¿™ä¸€è¿‡ç¨‹çš„ç›®çš„æ˜¯ç¡®ä¿åŒæ–¹éƒ½çŸ¥é“å¯¹æ–¹å·²å‡†å¤‡å¥½è¿›è¡Œé€šä¿¡ï¼Œå¹¶åŒæ­¥åŒæ–¹çš„åºåˆ—å·ï¼Œä»è€Œä¿æŒæ•°æ®åŒ…çš„é¡ºåºå’Œå®Œæ•´æ€§ã€‚ ä¸¤æ¬¡æ¡æ‰‹æ— æ³•ç¡®ä¿è¿æ¥çš„å¯é æ€§ã€‚å…·ä½“åŸå› å¦‚ä¸‹ï¼š æ—§çš„é‡å¤æŠ¥æ–‡å¹²æ‰°ï¼šåœ¨ä¸¤æ¬¡æ¡æ‰‹æƒ…å†µä¸‹ï¼Œæ—§çš„ SYN æŠ¥æ–‡å¯èƒ½ä¼šè¢«é”™è¯¯åœ°å½“ä½œæ–°çš„è¿æ¥è¯·æ±‚ã€‚å¦‚æœæœåŠ¡å™¨å‘é€ SYN-ACK æŠ¥æ–‡åå®¢æˆ·ç«¯æ²¡æœ‰å“åº”ï¼ŒæœåŠ¡å™¨ä¼šè®¤ä¸ºè¿æ¥å¤±è´¥ï¼Œä½†å®é™…ä¸Šå®¢æˆ·ç«¯å¯èƒ½å·²ç»æ”¶åˆ°äº† SYN-ACK æŠ¥æ–‡ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æœåŠ¡å™¨èµ„æºæµªè´¹å’Œè¿æ¥ä¸ä¸€è‡´ã€‚ ç¡®è®¤æœºåˆ¶ä¸å®Œæ•´ï¼šä¸¤æ¬¡æ¡æ‰‹ä¸èƒ½ä¿è¯åŒæ–¹éƒ½èƒ½æ­£ç¡®æ¥æ”¶åˆ°å¯¹æ–¹çš„ç¡®è®¤æŠ¥æ–‡ã€‚æœåŠ¡å™¨æ— æ³•ç¡®è®¤å®¢æˆ·ç«¯æ˜¯å¦æ”¶åˆ°äº†è‡ªå·±çš„ SYN-ACK æŠ¥æ–‡ï¼Œè€Œå®¢æˆ·ç«¯ä¹Ÿæ— æ³•ç¡®è®¤æœåŠ¡å™¨æ˜¯å¦æ”¶åˆ°äº†è‡ªå·±çš„ SYN æŠ¥æ–‡ã€‚ å››æ¬¡æ¡æ‰‹åœ¨æ­£å¸¸æƒ…å†µä¸‹æ˜¯å¤šä½™çš„ï¼Œä¼šå¢åŠ è¿æ¥å»ºç«‹çš„å¤æ‚æ€§å’Œå¼€é”€ã€‚ä¸‰æ¬¡æ¡æ‰‹å·²ç»è¶³å¤Ÿä¿è¯è¿æ¥çš„å¯é æ€§å’Œæ­£ç¡®æ€§ï¼š å¢åŠ å¤æ‚æ€§å’Œå¼€é”€ï¼šå››æ¬¡æ¡æ‰‹ä¼šå¢åŠ é¢å¤–çš„ä¸€ä¸ªæŠ¥æ–‡ä¼ è¾“ï¼Œä½¿å¾—è¿æ¥å»ºç«‹çš„è¿‡ç¨‹å˜å¾—å¤æ‚ï¼Œä¸å¿…è¦åœ°å¢åŠ äº†ä¼ è¾“çš„å»¶è¿Ÿå’Œå¼€é”€ã€‚ ä¸‰æ¬¡æ¡æ‰‹è¶³å¤Ÿå¯é ï¼šä¸‰æ¬¡æ¡æ‰‹å·²ç»å¯ä»¥ç¡®ä¿åŒæ–¹éƒ½èƒ½ç¡®è®¤è¿æ¥çš„å»ºç«‹ï¼Œå¹¶ä¸”å¯ä»¥é¿å…æ—§çš„é‡å¤æŠ¥æ–‡çš„å¹²æ‰°ï¼Œå†å¢åŠ ä¸€æ¬¡æ¡æ‰‹å¹¶ä¸ä¼šå¸¦æ¥é¢å¤–çš„å®‰å…¨æ€§æˆ–å¯é æ€§æå‡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.3 ä¸‰æ¬¡æ¡æ‰‹ä¸­æ¯ä¸€æ¬¡æ²¡æ”¶åˆ°æŠ¥æ–‡ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ åœ¨TCPä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€æ¬¡æ²¡æ”¶åˆ°æŠ¥æ–‡éƒ½ä¼šè§¦å‘é‡ä¼ æœºåˆ¶ï¼Œå¹¶æœ€ç»ˆå¯¼è‡´è¿æ¥å»ºç«‹å¤±è´¥ã€‚å…·ä½“æƒ…å†µå¦‚ä¸‹ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ SYN æŠ¥æ–‡ æƒ…å†µï¼šå¦‚æœå®¢æˆ·ç«¯å‘é€çš„ SYN æŠ¥æ–‡æ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨çš„ SYN-ACK æŠ¥æ–‡ï¼ˆæ¯”å¦‚æŠ¥æ–‡ä¸¢å¤±æˆ–æœåŠ¡å™¨æ²¡æœ‰å“åº”ï¼‰ã€‚ å¤„ç†ï¼šå®¢æˆ·ç«¯ä¼šè¿›è¡Œè¶…æ—¶é‡ä¼ ã€‚å®¢æˆ·ç«¯åœ¨å‘é€ SYN æŠ¥æ–‡åä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¦‚æœåœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨çš„å“åº”ï¼ˆSYN-ACK æŠ¥æ–‡ï¼‰ï¼Œå®¢æˆ·ç«¯ä¼šé‡ä¼  SYN æŠ¥æ–‡ã€‚ ç»“æœï¼šé‡ä¼ æ¬¡æ•°è¾¾åˆ°ä¸€å®šæ¬¡æ•°ï¼ˆé€šå¸¸æ˜¯ä¸‰æ¬¡ï¼‰åï¼Œå®¢æˆ·ç«¯ä¼šæ”¾å¼ƒè¿æ¥ï¼ŒæŠ¥é”™å¹¶å…³é—­è¿æ¥è¯·æ±‚ã€‚ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨å‘é€ SYN-ACK æŠ¥æ–‡ æƒ…å†µï¼šå¦‚æœæœåŠ¡å™¨å‘é€çš„ SYN-ACK æŠ¥æ–‡æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ ACK æŠ¥æ–‡ï¼ˆæ¯”å¦‚æŠ¥æ–‡ä¸¢å¤±æˆ–å®¢æˆ·ç«¯æ²¡æœ‰å“åº”ï¼‰ã€‚ å¤„ç†ï¼šæœåŠ¡å™¨ä¼šè¿›è¡Œè¶…æ—¶é‡ä¼ ã€‚æœåŠ¡å™¨åœ¨å‘é€ SYN-ACK æŠ¥æ–‡åä¹Ÿä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¦‚æœåœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ ACK æŠ¥æ–‡ï¼ŒæœåŠ¡å™¨ä¼šé‡ä¼  SYN-ACK æŠ¥æ–‡ã€‚ ç»“æœï¼šé‡ä¼ æ¬¡æ•°è¾¾åˆ°ä¸€å®šæ¬¡æ•°åï¼ŒæœåŠ¡å™¨ä¼šæ”¾å¼ƒè¿æ¥ï¼ŒæŠ¥é”™å¹¶å…³é—­è¿æ¥è¯·æ±‚ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ ACK æŠ¥æ–‡ æƒ…å†µï¼šå¦‚æœå®¢æˆ·ç«¯å‘é€çš„ ACK æŠ¥æ–‡æ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨çš„ç¡®è®¤ï¼ˆACK æŠ¥æ–‡æœ¬èº«ä¸€èˆ¬ä¸ä¼šå•ç‹¬ç¡®è®¤ï¼Œä½†æ­¤å¤„å‡è®¾æœåŠ¡å™¨æœªèƒ½è¿›å…¥ ESTABLISHED çŠ¶æ€ï¼‰ã€‚ å¤„ç†ï¼šæœåŠ¡å™¨ä¼šå› ä¸ºæ²¡æœ‰æ”¶åˆ° ACK æŠ¥æ–‡è€Œä¿æŒåœ¨ SYN-RECEIVED çŠ¶æ€ï¼Œå¹¶å¯èƒ½æœ€ç»ˆè¶…æ—¶å¹¶å…³é—­è¿æ¥ã€‚ ç»“æœï¼šå®¢æˆ·ç«¯ä¼šè®¤ä¸ºè¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶è¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œä½†å¦‚æœæœåŠ¡å™¨è¶…æ—¶å…³é—­è¿æ¥ï¼Œå®¢æˆ·ç«¯åœ¨å°è¯•å‘é€æ•°æ®æ—¶ä¼šå‘ç°è¿æ¥æ— æ³•ä½¿ç”¨ï¼Œä»è€ŒæŠ¥é”™å¹¶å…³é—­è¿æ¥ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.4 ç¬¬äºŒæ¬¡æ¡æ‰‹ä¼ å›äº† ACKï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä¼ å› SYNï¼Ÿ ACK æ ‡å¿—æ˜¯ä¸ºäº†å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå®ƒå‘é€çš„ SYN æŠ¥æ–‡å·²ç»è¢«æœåŠ¡å™¨æ­£ç¡®æ¥æ”¶ã€‚ è€Œä¼ å› SYN æ˜¯ä¸ºäº†å‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨ä¹Ÿå¸Œæœ›å»ºç«‹è¿æ¥ï¼Œå¹¶ä¸”å“åº”çš„ç¡®å®æ˜¯å®¢æˆ·ç«¯å‘é€çš„æŠ¥æ–‡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.5 ç¬¬ 3 æ¬¡æ¡æ‰‹å¯ä»¥æºå¸¦æ•°æ®å—ï¼Ÿ ç¬¬ 3 æ¬¡æ¡æ‰‹æ˜¯å¯ä»¥æºå¸¦æ•°æ®çš„ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å·²ç»å¤„äº ESTABLISHED çŠ¶æ€ã€‚å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œå®ƒå·²ç»å»ºç«‹è¿æ¥æˆåŠŸï¼Œå¹¶ä¸”ç¡®è®¤æœåŠ¡ç«¯çš„æ¥æ”¶å’Œå‘é€èƒ½åŠ›æ˜¯æ­£å¸¸çš„ã€‚ ä½†å®é™…åº”ç”¨ä¸­é€šå¸¸ä¸ä¼šæºå¸¦æ•°æ®ï¼Œå› ä¸ºåœ¨ç¬¬ä¸‰æ¬¡æ¡æ‰‹ä¸­å‘é€æ•°æ®å¯èƒ½ä¼šå¼•å‘å®‰å…¨å’Œå¯é æ€§é—®é¢˜ã€‚æ­¤æ—¶è¿æ¥è¿˜æœªå®Œå…¨å»ºç«‹ï¼Œå‘é€æ•°æ®å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–å®‰å…¨æ¼æ´ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ä¸èƒ½æºå¸¦æ•°æ®æ˜¯å‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼Œå› ä¸ºå¦‚æœå…è®¸æºå¸¦æ•°æ®ï¼Œæ”»å‡»è€…æ¯æ¬¡åœ¨ SYN æŠ¥æ–‡ä¸­æºå¸¦å¤§é‡æ•°æ®ï¼Œå°±ä¼šå¯¼è‡´æœåŠ¡ç«¯æ¶ˆè€—æ›´å¤šçš„æ—¶é—´å’Œç©ºé—´å»å¤„ç†è¿™äº›æŠ¥æ–‡ï¼Œä¼šé€ æˆ CPU å’Œå†…å­˜çš„æ¶ˆè€—ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:5","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.6 è¯´è¯´åŠè¿æ¥é˜Ÿåˆ—å’Œ SYN Flood æ”»å‡»çš„å…³ç³»ï¼Ÿ TCP è¿›å…¥ä¸‰æ¬¡æ¡æ‰‹å‰ï¼ŒæœåŠ¡ç«¯ä¼šä» CLOSED çŠ¶æ€å˜ä¸º LISTEN çŠ¶æ€, åŒæ—¶åœ¨å†…éƒ¨åˆ›å»ºäº†ä¸¤ä¸ªé˜Ÿåˆ—ï¼šåŠè¿æ¥é˜Ÿåˆ—ï¼ˆSYN é˜Ÿåˆ—ï¼‰å’Œå…¨è¿æ¥é˜Ÿåˆ—ï¼ˆACCEPT é˜Ÿåˆ—ï¼‰ã€‚ åŠè¿æ¥é˜Ÿåˆ—ï¼ˆHalf-Open Connection Queueï¼‰æ˜¯æŒ‡åœ¨ TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨åœ¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡åï¼Œè¿”å› SYN-ACK æŠ¥æ–‡å¹¶ç­‰å¾…å®¢æˆ·ç«¯çš„ ACK æŠ¥æ–‡ç¡®è®¤è¿æ¥çš„è¿™æ®µæ—¶é—´å†…ï¼ŒæœåŠ¡å™¨ä¸ºæ¯ä¸ªæœªå®Œæˆçš„è¿æ¥åˆ†é…çš„èµ„æºé˜Ÿåˆ—ã€‚ SYN Flood æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…å‘é€å¤§é‡çš„ SYN æŠ¥æ–‡è¯·æ±‚ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œä½†åœ¨æœåŠ¡å™¨è¿”å› SYN-ACK æŠ¥æ–‡åï¼Œæ”»å‡»è€…ä¸å‘é€æœ€ç»ˆçš„ ACK æŠ¥æ–‡å®Œæˆæ¡æ‰‹ã€‚è¿™æ ·ï¼ŒæœåŠ¡å™¨çš„åŠè¿æ¥é˜Ÿåˆ—ä¼šè¢«å¤§é‡æœªå®Œæˆçš„è¿æ¥å æ»¡ï¼Œå¯¼è‡´æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œæ— æ³•å¤„ç†æ­£å¸¸çš„è¿æ¥è¯·æ±‚ï¼Œè¿›è€Œé€ æˆæ‹’ç»æœåŠ¡ï¼ˆDenial of Serviceï¼ŒDoSï¼‰ã€‚ å› æ­¤ï¼ŒSYN Flood æ”»å‡»çš„æ ¸å¿ƒåœ¨äºåˆ©ç”¨åŠè¿æ¥é˜Ÿåˆ—çš„æœ‰é™èµ„æºï¼Œé€šè¿‡å¤§é‡ä¼ªé€ çš„è¿æ¥è¯·æ±‚ä½¿æœåŠ¡å™¨æ— æ³•å¤„ç†åˆæ³•ç”¨æˆ·çš„è¿æ¥ã€‚ é‚£æœ‰ä»€ä¹ˆåº”å¯¹æ–¹æ¡ˆå‘¢ï¼Ÿ ä¸»è¦æœ‰ syn cookie å’Œ SYN Proxy é˜²ç«å¢™ç­‰ã€‚ syn cookieï¼šåœ¨æ”¶åˆ° SYN åŒ…åï¼ŒæœåŠ¡å™¨æ ¹æ®ä¸€å®šçš„æ–¹æ³•ï¼Œä»¥æ•°æ®åŒ…çš„æºåœ°å€ã€ç«¯å£ç­‰ä¿¡æ¯ä¸ºå‚æ•°è®¡ç®—å‡ºä¸€ä¸ª cookie å€¼ä½œä¸ºè‡ªå·±çš„ SYNACK åŒ…çš„åºåˆ—å·ï¼Œå›å¤ SYN+ACK åï¼ŒæœåŠ¡å™¨å¹¶ä¸ç«‹å³åˆ†é…èµ„æºè¿›è¡Œå¤„ç†ï¼Œç­‰æ”¶åˆ°å‘é€æ–¹çš„ ACK åŒ…åï¼Œé‡æ–°æ ¹æ®æ•°æ®åŒ…çš„æºåœ°å€ã€ç«¯å£è®¡ç®—è¯¥åŒ…ä¸­çš„ç¡®è®¤åºåˆ—å·æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®åˆ™å»ºç«‹è¿æ¥ï¼Œå¦åˆ™ä¸¢å¼ƒè¯¥åŒ…ã€‚ SYN Proxy é˜²ç«å¢™ï¼šæœåŠ¡å™¨é˜²ç«å¢™ä¼šå¯¹æ”¶åˆ°çš„æ¯ä¸€ä¸ª SYN æŠ¥æ–‡è¿›è¡Œä»£ç†å’Œå›åº”ï¼Œå¹¶ä¿æŒåŠè¿æ¥ã€‚ç­‰å‘é€æ–¹å°† ACK åŒ…è¿”å›åï¼Œå†é‡æ–°æ„é€  SYN åŒ…å‘åˆ°æœåŠ¡å™¨ï¼Œå»ºç«‹çœŸæ­£çš„ TCP è¿æ¥ã€‚ ç¼©çŸ­ SYN-ACK è¶…æ—¶æ—¶é—´ï¼šè°ƒæ•´ç³»ç»Ÿçš„ SYN-ACK è¶…æ—¶æ—¶é—´ï¼Œä½¿æœªå®Œæˆçš„è¿æ¥è¯·æ±‚èƒ½å¤Ÿæ›´å¿«åœ°è¢«æ¸…ç†å‡ºé˜Ÿåˆ—ã€‚ åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡é˜²æŠ¤ï¼ˆDDoS Protection Servicesï¼‰ï¼šä½¿ç”¨ä¸“ä¸šçš„ DDoS é˜²æŠ¤æœåŠ¡ï¼Œå¦‚ Cloudflareã€Akamai ç­‰ï¼Œè¿™äº›æœåŠ¡å¯ä»¥åœ¨ç½‘ç»œè¾¹ç¼˜è¿‡æ»¤æ¶æ„æµé‡ï¼Œå‡è½»æœåŠ¡å™¨çš„å‹åŠ›ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:6","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.7 è¯´è¯´ TCP å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ï¼Ÿ TCP å››æ¬¡æŒ¥æ‰‹æ˜¯æŒ‡ TCP è¿æ¥ç»ˆæ­¢æ—¶æ‰€è¿›è¡Œçš„å››ä¸ªæ­¥éª¤ï¼Œæ•°æ®ä¼ è¾“ç»“æŸä¹‹åï¼Œé€šä¿¡åŒæ–¹éƒ½å¯ä»¥ä¸»åŠ¨å‘èµ·æ–­å¼€è¿æ¥è¯·æ±‚ï¼Œè¿™é‡Œå‡å®šå®¢æˆ·ç«¯å‘èµ·ï¼ˆé€šå¸¸æ˜¯å®¢æˆ·ç«¯ï¼‰ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šFIN æŠ¥æ–‡ï¼š å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æŠ¥æ–‡æ®µï¼Œè¡¨æ˜å®ƒå·²ç»å®Œæˆäº†æ•°æ®å‘é€ï¼Œè¯·æ±‚å…³é—­è¿æ¥ã€‚å®¢æˆ·ç«¯è¿›å…¥ FIN_WAIT_1 çŠ¶æ€ã€‚ æŠ¥æ–‡æ®µæ ¼å¼ï¼šFIN=1, seq=xã€‚ ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šACK æŠ¥æ–‡ï¼š æœåŠ¡å™¨æ¥æ”¶åˆ° FIN æŠ¥æ–‡åï¼Œè¿”å›ä¸€ä¸ª ACK æŠ¥æ–‡æ®µï¼Œç¡®è®¤æ”¶åˆ°äº†å…³é—­è¯·æ±‚ã€‚å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›å…¥ CLOSE_WAIT çŠ¶æ€ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿™ä¸ªç¡®è®¤åŒ…ä¹‹åï¼Œè¿›å…¥ FIN_WAIT_2 çŠ¶æ€ã€‚ æŠ¥æ–‡æ®µæ ¼å¼ï¼šACK=1, ack=x+1ã€‚ æ­¤æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½è¿˜éœ€è¦ç»§ç»­å‘é€æ•°æ®ï¼Œå› æ­¤è¿æ¥å¤„äºåŠå…³é—­çŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šFIN æŠ¥æ–‡ï¼š æœåŠ¡ç«¯åœ¨å®Œæˆæ•°æ®å‘é€åï¼Œå‘é€ä¸€ä¸ª FIN æŠ¥æ–‡æ®µï¼Œè¡¨æ˜å®ƒä¹Ÿå·²ç»å®Œæˆäº†æ•°æ®å‘é€ï¼Œè¯·æ±‚å…³é—­è¿æ¥ã€‚å‘é€å®Œæ¯•åï¼ŒæœåŠ¡å™¨ç«¯è¿›å…¥ LAST_ACK çŠ¶æ€ï¼Œç­‰å¾…æ¥è‡ªå®¢æˆ·ç«¯çš„æœ€åä¸€ä¸ª ACKã€‚ æŠ¥æ–‡æ®µæ ¼å¼ï¼šFIN=1, seq=yã€‚ ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šACK æŠ¥æ–‡ï¼š å®¢æˆ·ç«¯æ¥æ”¶åˆ° FIN æŠ¥æ–‡åï¼Œè¿”å›ä¸€ä¸ª ACK æŠ¥æ–‡æ®µï¼Œç¡®è®¤æ”¶åˆ°äº†å…³é—­è¯·æ±‚ï¼Œå¹¶è¿›å…¥ TIME_WAIT çŠ¶æ€ï¼Œç­‰å¾…äº†æŸä¸ªå›ºå®šæ—¶é—´ï¼ˆä¸¤ä¸ªæœ€å¤§æ®µç”Ÿå‘½å‘¨æœŸï¼Œ2MSLï¼Œ2 Maximum Segment Lifetimeï¼‰ä¹‹åï¼Œæ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„ ACK ï¼Œè®¤ä¸ºæœåŠ¡å™¨ç«¯å·²ç»æ­£å¸¸å…³é—­è¿æ¥ï¼Œäºæ˜¯è‡ªå·±ä¹Ÿå…³é—­è¿æ¥ï¼Œè¿›å…¥ CLOSED çŠ¶æ€ã€‚æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¿™ä¸ªç¡®è®¤åŒ…ä¹‹åï¼Œå…³é—­è¿æ¥ï¼Œè¿›å…¥ CLOSED çŠ¶æ€ã€‚ æŠ¥æ–‡æ®µæ ¼å¼ï¼šACK=1, ack=y+1ã€‚ æ­¤æ—¶ï¼Œè¿æ¥æ­£å¼å…³é—­ï¼ŒåŒæ–¹éƒ½å®Œæˆäº†è¿æ¥çš„é‡Šæ”¾ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:7","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.8 TCP æŒ¥æ‰‹ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡å‘¢ï¼Ÿã€‚ å…³é—­è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ FIN æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå®¢æˆ·ç«¯ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ã€‚ æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„ FIN æŠ¥æ–‡æ—¶ï¼Œå…ˆå›ä¸€ä¸ª ACK åº”ç­”æŠ¥æ–‡ï¼Œè€ŒæœåŠ¡ç«¯å¯èƒ½è¿˜æœ‰æ•°æ®éœ€è¦å¤„ç†å’Œå‘é€ï¼Œç­‰æœåŠ¡ç«¯ä¸å†å‘é€æ•°æ®æ—¶ï¼Œæ‰å‘é€ FIN æŠ¥æ–‡ç»™å®¢æˆ·ç«¯æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ã€‚ ä»ä¸Šé¢è¿‡ç¨‹å¯çŸ¥ï¼ŒæœåŠ¡ç«¯é€šå¸¸éœ€è¦ç­‰å¾…å®Œæˆæ•°æ®çš„å‘é€å’Œå¤„ç†ï¼Œæ‰€ä»¥æœåŠ¡ç«¯çš„ ACK å’Œ FIN ä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ï¼Œä»è€Œæ¯”ä¸‰æ¬¡æ¡æ‰‹å¯¼è‡´å¤šäº†ä¸€æ¬¡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:8","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.9 TCP å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ä¸­ï¼Œä¸ºä»€ä¹ˆéœ€è¦ç­‰å¾… 2MSL, æ‰è¿›å…¥ CLOSED å…³é—­çŠ¶æ€ï¼Ÿ ä¸ºäº†ä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ª ACK æŠ¥æ–‡æ®µèƒ½å¤Ÿåˆ°è¾¾æœåŠ¡ç«¯ã€‚ è¿™ä¸ª ACK æŠ¥æ–‡æ®µæœ‰å¯èƒ½ä¸¢å¤±ï¼Œå› è€Œä½¿å¤„åœ¨ LAST-ACK çŠ¶æ€çš„æœåŠ¡ç«¯å°±æ”¶ä¸åˆ°å¯¹å·²å‘é€çš„ FIN æŠ¥æ–‡æ®µçš„ç¡®è®¤ã€‚æœåŠ¡ç«¯ä¼šè¶…æ—¶é‡ä¼ è¿™ä¸ª FIN æŠ¥æ–‡æ®µï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨ 2MSL æ—¶é—´å†…ï¼ˆè¶…æ—¶ + 1MSL ä¼ è¾“ï¼‰æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„ FIN æŠ¥æ–‡æ®µã€‚æ¥ç€å®¢æˆ·ç«¯é‡ä¼ ä¸€æ¬¡ç¡®è®¤ï¼Œé‡æ–°å¯åŠ¨ 2MSL è®¡æ—¶å™¨ã€‚æœ€åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½æ­£å¸¸è¿›å…¥åˆ° CLOSED çŠ¶æ€ã€‚ é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯åœ¨å‘é€å®Œæœ€åä¸€ä¸ª ACK æŠ¥æ–‡æ®µåï¼Œå†ç»è¿‡æ—¶é—´ 2MSLï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ä¸‹ä¸€ä¸ªè¿æ¥ä¸­ä¸ä¼šå‡ºç°è¿™ç§æ—§çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚ ä¸ºä»€ä¹ˆç­‰å¾…çš„æ—¶é—´æ˜¯ 2MSLï¼Ÿ MSL æ˜¯ Maximum Segment Lifetimeï¼ŒæŠ¥â½‚æœ€â¼¤â½£å­˜æ—¶é—´ï¼Œå®ƒæ˜¯ä»»ä½•æŠ¥â½‚åœ¨â½¹ç»œä¸Šå­˜åœ¨çš„æœ€â»“æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´æŠ¥â½‚å°†è¢«ä¸¢å¼ƒã€‚ TIME_WAIT ç­‰å¾… 2 å€çš„ MSLï¼Œâ½è¾ƒåˆç†çš„è§£é‡Šæ˜¯ï¼šâ½¹ç»œä¸­å¯èƒ½å­˜åœ¨æ¥â¾ƒå‘é€â½…çš„æ•°æ®åŒ…ï¼Œå½“è¿™äº›å‘é€â½…çš„æ•°æ®åŒ…è¢«æ¥æ”¶â½…å¤„ç†åâ¼œä¼šå‘å¯¹â½…å‘é€å“åº”ï¼Œæ‰€ä»¥â¼€æ¥â¼€å›éœ€è¦ç­‰å¾… 2 å€çš„æ—¶é—´ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:9","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.10 ä¿æ´»è®¡æ—¶å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ é™¤æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨å¤–ï¼ŒTCP è¿˜æœ‰ä¸€ä¸ªä¿æ´»è®¡æ—¶å™¨ï¼ˆkeepalive timerï¼‰ï¼Œç”¨äºåœ¨é•¿æ—¶é—´é—²ç½®çš„ TCP è¿æ¥ä¸­æ£€æµ‹å¯¹ç«¯æ˜¯å¦ä»ç„¶å­˜æ´»ï¼Œå¹¶é˜²æ­¢è¿æ¥å› ä¸ºé•¿æ—¶é—´æ²¡æœ‰æ´»åŠ¨è€Œè¢«è®¤ä¸ºæ˜¯ä¸æ´»è·ƒçš„è€Œè¢«å…³é—­ã€‚ è®¾æƒ³è¿™æ ·çš„åœºæ™¯ï¼šå®¢æˆ·å·²ä¸»åŠ¨ä¸æœåŠ¡å™¨å»ºç«‹äº† TCP è¿æ¥ã€‚ä½†åæ¥å®¢æˆ·ç«¯çš„ä¸»æœºçªç„¶å‘ç”Ÿæ•…éšœã€‚æ˜¾ç„¶ï¼ŒæœåŠ¡å™¨ä»¥åå°±ä¸èƒ½å†æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ã€‚å› æ­¤ï¼Œåº”å½“æœ‰æªæ–½ä½¿æœåŠ¡å™¨ä¸è¦å†ç™½ç™½ç­‰å¾…ä¸‹å»ã€‚è¿™å°±éœ€è¦ä½¿ç”¨ä¿æ´»è®¡æ—¶å™¨äº†ã€‚ æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œå°±é‡æ–°è®¾ç½®ä¿æ´»è®¡æ—¶å™¨ï¼Œæ—¶é—´çš„è®¾ç½®é€šå¸¸æ˜¯ä¸¤ä¸ªå°æ—¶ã€‚è‹¥ä¸¤ä¸ªå°æ—¶éƒ½æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„æ•°æ®ï¼ŒæœåŠ¡ç«¯å°±å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥ååˆ™æ¯éš” 75 ç§’é’Ÿå‘é€ä¸€æ¬¡ã€‚è‹¥è¿ç»­å‘é€ 10 ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µåä»ç„¶æ— å®¢æˆ·ç«¯çš„å“åº”ï¼ŒæœåŠ¡ç«¯å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿™ä¸ªè¿æ¥ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:10","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.11 CLOSE-WAIT å’Œ TIME-WAIT çš„çŠ¶æ€å’Œæ„ä¹‰ï¼Ÿ CLOSE-WAIT çŠ¶æ€æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯å…³é—­è¿æ¥çš„è¯·æ±‚å¹¶ç¡®è®¤ä¹‹åï¼Œå°±ä¼šè¿›å…¥ CLOSE-WAIT çŠ¶æ€ã€‚æ­¤æ—¶æœåŠ¡ç«¯å¯èƒ½è¿˜æœ‰ä¸€äº›æ•°æ®æ²¡æœ‰ä¼ è¾“å®Œæˆï¼Œå› æ­¤ä¸èƒ½ç«‹å³å…³é—­è¿æ¥ï¼Œè€Œ CLOSE-WAIT çŠ¶æ€å°±æ˜¯ä¸ºäº†ä¿è¯æœåŠ¡ç«¯åœ¨å…³é—­è¿æ¥ä¹‹å‰å°†å¾…å‘é€çš„æ•°æ®å¤„ç†å®Œã€‚ TIME-WAIT æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ TIME-WAIT çŠ¶æ€å‘ç”Ÿåœ¨ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼Œå½“å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ ACK ç¡®è®¤æŠ¥æ–‡åè¿›å…¥ TIME-WAIT çŠ¶æ€ã€‚ é˜²â½Œæ—§è¿æ¥çš„æ•°æ®åŒ… ä¿è¯è¿æ¥æ­£ç¡®å…³é—­ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:11","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.12 TIME_WAIT çŠ¶æ€è¿‡å¤šä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ TIME_WAIT çŠ¶æ€è¿‡å¤šä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜? å¦‚æœæœåŠ¡å™¨æœ‰å¤„äº TIME-WAIT çŠ¶æ€çš„ TCPï¼Œåˆ™è¯´æ˜æ˜¯ç”±æœåŠ¡å™¨â½…ä¸»åŠ¨å‘èµ·çš„æ–­å¼€è¯·æ±‚ã€‚ ä»€ä¹ˆåœºæ™¯ä¸‹æœåŠ¡ç«¯ä¼šä¸»åŠ¨æ–­å¼€è¿æ¥å‘¢ï¼Ÿ HTTP æ²¡æœ‰ä½¿ç”¨é•¿è¿æ¥ HTTP é•¿è¿æ¥è¶…æ—¶ HTTP é•¿è¿æ¥çš„è¯·æ±‚æ•°é‡è¾¾åˆ°ä¸Šé™ è¿‡å¤šçš„ TIME-WAIT çŠ¶æ€ä¸»è¦çš„å±å®³æœ‰ä¸¤ç§ï¼š ç«¯å£èµ„æºè€—å°½ï¼šæ¯ä¸ªå¤„äº TIME_WAIT çŠ¶æ€çš„è¿æ¥éƒ½ä¼šå ç”¨ä¸€ä¸ªæœ¬åœ°ç«¯å£ã€‚å¦‚æœ TIME_WAIT çŠ¶æ€çš„è¿æ¥è¿‡å¤šï¼Œå¯èƒ½ä¼šå¯¼è‡´å¯ç”¨çš„æœ¬åœ°ç«¯å£èµ„æºè€—å°½ï¼Œæ–°çš„è¿æ¥è¯·æ±‚æ— æ³•åˆ†é…ç«¯å£ï¼Œä»è€Œå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚ å†…å­˜å’Œèµ„æºå ç”¨ï¼šTIME_WAIT çŠ¶æ€çš„è¿æ¥ä¼šå ç”¨ä¸€å®šçš„ç³»ç»Ÿå†…å­˜å’Œèµ„æºã€‚å¦‚æœè¿æ¥è¿‡å¤šï¼Œä¼šå¯¼è‡´ç³»ç»Ÿèµ„æºè¢«å¤§é‡å ç”¨ï¼Œå½±å“æœåŠ¡å™¨çš„æ€§èƒ½å’Œå…¶ä»–åº”ç”¨çš„è¿è¡Œã€‚ æ€ä¹ˆè§£å†³ TIME_WAIT çŠ¶æ€è¿‡å¤šï¼Ÿ æœåŠ¡å™¨å¯ä»¥è®¾ç½® SO_REUSEADDR å¥—æ¥å­—æ¥é€šçŸ¥å†…æ ¸ï¼Œå¦‚æœç«¯å£è¢«å ç”¨ï¼Œä½†æ˜¯ TCP è¿æ¥ä½äº TIME_WAIT çŠ¶æ€æ—¶å¯ä»¥é‡ç”¨ç«¯å£ã€‚ è¿˜å¯ä»¥ä½¿ç”¨é•¿è¿æ¥çš„æ–¹å¼æ¥å‡å°‘ TCP çš„è¿æ¥å’Œæ–­å¼€ï¼Œåœ¨é•¿è¿æ¥çš„ä¸šåŠ¡é‡Œå¾€å¾€ä¸éœ€è¦è€ƒè™‘ TIME_WAIT çŠ¶æ€ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:12","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.13 è¯´è¯´ TCP æŠ¥æ–‡å¤´éƒ¨çš„æ ¼å¼ï¼Ÿ ä¸€ä¸ª TCP æŠ¥æ–‡æ®µä¸»è¦ç”±æŠ¥æ–‡æ®µå¤´éƒ¨ï¼ˆHeaderï¼‰å’Œæ•°æ®ä¸¤éƒ¨åˆ†ç»„æˆã€‚å¤´éƒ¨åŒ…å«äº†ç¡®ä¿æ•°æ®å¯é ä¼ è¾“æ‰€éœ€çš„å„ç§æ§åˆ¶ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´åºåˆ—å·ã€ç¡®è®¤å·ã€çª—å£å¤§å°ç­‰ã€‚ 0 1 2 3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Source Port | Destination Port | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Sequence Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Acknowledgment Number | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Data |Reser-| Flags | | | Offset|ved | (6 bits) | Window | | (4 | (6 | | | | | bits)| bits)| | | | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Checksum | Urgent Pointer | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Options (if any) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | | | data | | | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ æºç«¯å£å·ï¼ˆSource Portï¼‰ï¼š16 ä½ï¼ˆ2 ä¸ªå­—èŠ‚ï¼‰ï¼Œç”¨äºæ ‡è¯†å‘é€ç«¯çš„åº”ç”¨ç¨‹åºã€‚ ç›®æ ‡ç«¯å£å·ï¼ˆDestination Portï¼‰ï¼šä¹Ÿæ˜¯ 16 ä½ï¼Œç”¨äºæ ‡è¯†æ¥æ”¶ç«¯çš„åº”ç”¨ç¨‹åºã€‚ åºåˆ—å·ï¼ˆSequence Numberï¼‰ï¼š32 ä½ï¼Œç”¨äºæ ‡è¯†ä» TCP å‘é€è€…å‘é€çš„æ•°æ®å­—èŠ‚æµä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„é¡ºåºå·ã€‚ç¡®ä¿æ•°æ®æŒ‰é¡ºåºæ¥æ”¶ã€‚ ç¡®è®¤å·ï¼ˆAcknowledgment Numberï¼‰ï¼š32 ä½ï¼Œå¦‚æœ ACK æ ‡å¿—è¢«è®¾ç½®ï¼Œåˆ™è¯¥å­—æ®µåŒ…å«å‘é€ç¡®è®¤çš„åºåˆ—å·ï¼Œå³æ¥æ”¶ TCP å¸Œæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªåºåˆ—å·ã€‚ æ•°æ®åç§»ï¼ˆData Offsetï¼‰ï¼š4 ä½ï¼Œè¡¨ç¤º TCP æŠ¥æ–‡å¤´éƒ¨çš„é•¿åº¦ï¼Œç”¨äºæŒ‡ç¤ºæ•°æ®å¼€å§‹çš„ä½ç½®ã€‚ ä¿ç•™ï¼ˆReservedï¼‰ï¼š6 ä½ï¼Œä¸ºå°†æ¥ä½¿ç”¨é¢„ç•™ï¼Œç›®å‰å¿…é¡»ç½®ä¸º 0ã€‚ æ§åˆ¶ä½ï¼ˆFlagsï¼‰ï¼šå…± 6 ä½ï¼ŒåŒ…æ‹¬ URGï¼ˆç´§æ€¥æŒ‡é’ˆå­—æ®µæ˜¯å¦æœ‰æ•ˆï¼‰ã€ACKï¼ˆç¡®è®¤å­—æ®µæ˜¯å¦æœ‰æ•ˆï¼‰ã€PSHï¼ˆæç¤ºæ¥æ”¶ç«¯åº”è¯¥å°½å¿«å°†è¿™ä¸ªæŠ¥æ–‡æ®µäº¤ç»™åº”ç”¨å±‚ï¼‰ã€RSTï¼ˆé‡ç½®è¿æ¥ï¼‰ã€SYNï¼ˆåŒæ­¥åºå·ï¼Œç”¨äºå»ºç«‹è¿æ¥ï¼‰ã€FINï¼ˆç»“æŸå‘é€æ•°æ®ï¼‰ã€‚ çª—å£å¤§å°ï¼ˆWindowï¼‰ï¼š16 ä½ï¼Œç”¨äºæµé‡æ§åˆ¶ï¼Œè¡¨ç¤ºæ¥æ”¶ç«¯è¿˜èƒ½æ¥æ”¶çš„æ•°æ®çš„å­—èŠ‚æ•°ï¼ˆåŸºäºæ¥æ”¶ç¼“å†²åŒºçš„å¤§å°ï¼‰ã€‚ æ ¡éªŒå’Œï¼ˆChecksumï¼‰ï¼š16 ä½ï¼Œè¦†ç›–æ•´ä¸ª TCP æŠ¥æ–‡æ®µï¼ˆåŒ…æ‹¬ TCP å¤´éƒ¨ã€æ•°æ®å’Œä¸€ä¸ªä¼ªå¤´éƒ¨ï¼‰çš„æ ¡éªŒå’Œï¼Œç”¨äºæ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–ã€‚ ç´§æ€¥æŒ‡é’ˆï¼ˆUrgent Pointerï¼‰ï¼š16 ä½ï¼Œåªæœ‰å½“ URG æ§åˆ¶ä½è¢«è®¾ç½®æ—¶æ‰æœ‰æ•ˆï¼ŒæŒ‡å‡ºåœ¨æŠ¥æ–‡æ®µä¸­æœ‰ç´§æ€¥æ•°æ®çš„ä½ç½®ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:13","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.14 TCP æ˜¯å¦‚ä½•ä¿è¯å¯é æ€§çš„ï¼Ÿ TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰é€šè¿‡å¤šç§æœºåˆ¶æ¥ç¡®ä¿æ•°æ®ä¼ è¾“çš„å¯é æ€§ã€‚ä»¥ä¸‹æ˜¯TCPä¿è¯å¯é æ€§çš„ä¸»è¦æ–¹æ³•ï¼š è¿æ¥ç®¡ç†ï¼ˆConnection Managementï¼‰ï¼šTCP ä½¿ç”¨ä¸‰æ¬¡æ¡æ‰‹ï¼ˆThree-Way Handshakeï¼‰å»ºç«‹è¿æ¥å’Œå››æ¬¡æŒ¥æ‰‹ï¼ˆFour-Way Handshakeï¼‰å…³é—­è¿æ¥ï¼Œç¡®ä¿è¿æ¥çš„å»ºç«‹å’Œé‡Šæ”¾è¿‡ç¨‹å¯é ã€æ— è¯¯ã€‚ æ ¡éªŒå’Œï¼ˆChecksumï¼‰ï¼šTCP æŠ¥æ–‡æ®µåŒ…å«ä¸€ä¸ªæ ¡éªŒå’Œå­—æ®µï¼Œç”¨äºéªŒè¯æŠ¥æ–‡æ®µåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦è¢«æŸåã€‚å‘é€æ–¹è®¡ç®—å¹¶å¡«å……æ ¡éªŒå’Œï¼Œæ¥æ”¶æ–¹æ ¹æ®æ¥æ”¶åˆ°çš„æ•°æ®é‡æ–°è®¡ç®—æ ¡éªŒå’Œå¹¶è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚ åºåˆ—å·ï¼ˆSequence Numbersï¼‰ï¼šTCP ä¸ºæ¯ä¸ªå­—èŠ‚åˆ†é…ä¸€ä¸ªåºåˆ—å·ã€‚å‘é€æ–¹å’Œæ¥æ”¶æ–¹ä½¿ç”¨åºåˆ—å·æ¥ç¡®ä¿æ•°æ®æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ¥æ”¶å¹¶é‡ç»„ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±æˆ–é‡å¤ã€‚ ç¡®è®¤åº”ç­”ï¼ˆAcknowledgments, ACKsï¼‰ï¼šTCP ä½¿ç”¨ç¡®è®¤åº”ç­”æœºåˆ¶æ¥ç¡®è®¤æ•°æ®çš„æ¥æ”¶ã€‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°æ•°æ®åï¼Œä¼šå‘é€ä¸€ä¸ªå¸¦æœ‰ç¡®è®¤å·çš„ACKæŠ¥æ–‡æ®µï¼Œå‘ŠçŸ¥å‘é€æ–¹å·²æˆåŠŸæ¥æ”¶åˆ°çš„æ•°æ®ã€‚è¿™ç§æœºåˆ¶ç¡®ä¿äº†æ•°æ®çš„ä¼ é€’å’Œç¡®è®¤ã€‚ æ‹¥å¡æ§åˆ¶ï¼ˆCongestion Controlï¼‰ï¼šTCP é€šè¿‡æ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ å’Œå¿«æ¢å¤ç­‰ç®—æ³•æ¥é˜²æ­¢ç½‘ç»œæ‹¥å¡ï¼Œä¿è¯æ•°æ®ä¼ è¾“çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚ æµé‡æ§åˆ¶ï¼ˆFlow Controlï¼‰ï¼šTCP è¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ï¼ŒTCP çš„æ¥æ”¶ç«¯åªå…è®¸å‘é€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºèƒ½æ¥çº³çš„æ•°æ®ã€‚å½“æ¥æ”¶æ–¹æ¥ä¸åŠå¤„ç†å‘é€æ–¹çš„æ•°æ®ï¼Œèƒ½æç¤ºå‘é€æ–¹é™ä½å‘é€çš„é€Ÿç‡ï¼Œé˜²æ­¢åŒ…ä¸¢å¤±ã€‚TCP ä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯å¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®ã€‚ï¼ˆTCP åˆ©ç”¨æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶ï¼‰ é‡ä¼ æœºåˆ¶ï¼ˆRetransmissionï¼‰ï¼šå‘é€æ–¹åœ¨å‘é€æ•°æ®åä¼šå¯åŠ¨ä¸€ä¸ªè®¡æ—¶å™¨ã€‚å¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…æœªæ”¶åˆ°å¯¹åº”çš„ACKæŠ¥æ–‡æ®µï¼Œå‘é€æ–¹ä¼šè®¤ä¸ºè¯¥æ•°æ®åŒ…ä¸¢å¤±å¹¶è¿›è¡Œé‡ä¼ ã€‚TCPè¿˜ä½¿ç”¨å¿«é€Ÿé‡ä¼ æœºåˆ¶ï¼Œå½“æ”¶åˆ°ä¸‰ä¸ªé‡å¤çš„ACKæ—¶ï¼Œç«‹å³é‡ä¼ ç›¸åº”çš„æ•°æ®åŒ…ã€‚ æœ€å¤§æ¶ˆæ¯é•¿åº¦ï¼ˆMaximum Message Lengthï¼‰ï¼šåœ¨å»ºç«‹ TCP è¿æ¥çš„æ—¶å€™ï¼ŒåŒæ–¹çº¦å®šä¸€ä¸ªæœ€å¤§çš„é•¿åº¦ï¼ˆMSSï¼‰ä½œä¸ºå‘é€çš„å•ä½ï¼Œé‡ä¼ çš„æ—¶å€™ä¹Ÿæ˜¯ä»¥è¿™ä¸ªå•ä½æ¥è¿›è¡Œé‡ä¼ ã€‚ç†æƒ³çš„æƒ…å†µä¸‹æ˜¯è¯¥é•¿åº¦çš„æ•°æ®åˆšå¥½ä¸è¢«ç½‘ç»œå±‚åˆ†å—ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:14","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.15 è¯´è¯´ TCP çš„æµé‡æ§åˆ¶ï¼Ÿ TCP æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥è®©å‘é€ç«¯æ ¹æ®æ¥æ”¶ç«¯çš„å®é™…æ¥æ”¶èƒ½åŠ›æ§åˆ¶å‘é€çš„æ•°æ®é‡ï¼Œä»¥ç¡®ä¿æ¥æ”¶æ–¹èƒ½å¤ŸåŠæ—¶å¤„ç†æ•°æ®è€Œä¸ä¼šå› ä¸ºæ•°æ®è¿‡å¤šè€Œæº¢å‡ºç¼“å†²åŒºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚ TCP çš„æµé‡æ§åˆ¶ä¸»è¦é€šè¿‡æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰æœºåˆ¶æ¥å®ç°ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:15","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.16 è¯¦ç»†è¯´è¯´ TCP çš„æ»‘åŠ¨çª—å£ï¼Ÿ TCP å‘é€ä¸€ä¸ªæ•°æ®ï¼Œå¦‚æœéœ€è¦æ”¶åˆ°ç¡®è®¤åº”ç­”ï¼Œæ‰ä¼šå‘é€ä¸‹ä¸€ä¸ªæ•°æ®ã€‚è¿™æ ·çš„è¯å°±ä¼šæœ‰ä¸ªç¼ºç‚¹ï¼šæ•ˆç‡ä¼šæ¯”è¾ƒä½ã€‚è€Œæ»‘åŠ¨çª—å£å…è®¸å‘é€æ–¹åœ¨æœªæ¥æ”¶åˆ° ACK ç¡®è®¤ä¹‹å‰å¯ä»¥å‘é€å¤šä¸ªæ•°æ®æ®µï¼Œä»¥æé«˜ç½‘ç»œçš„åˆ©ç”¨ç‡å’Œä¼ è¾“æ•ˆç‡ï¼ŒåŒæ—¶é¿å…äº†å‘é€æ–¹è¿‡åº¦å‘é€å¯¼è‡´æ¥æ”¶æ–¹ç¼“å†²åŒºæº¢å‡ºã€‚ TCP æ»‘åŠ¨çª—å£åˆ†ä¸ºä¸¤ç§: å‘é€çª—å£å’Œæ¥æ”¶çª—å£ã€‚å‘é€ç«¯çš„æ»‘åŠ¨çª—å£åŒ…å«å››å¤§éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š å·²å‘é€ä¸”å·²æ”¶åˆ° ACK ç¡®è®¤ å·²å‘é€ä½†æœªæ”¶åˆ° ACK ç¡®è®¤ æœªå‘é€ä½†å¯ä»¥å‘é€ æœªå‘é€ä¹Ÿä¸å¯ä»¥å‘é€ è“è‰²æ¡†é‡Œå°±æ˜¯å‘é€çª—å£ã€‚SND.WND è¡¨ç¤ºå‘é€çª—å£çš„å¤§å°ï¼ŒSND.NXTè¡¨ç¤ºä¸‹ä¸€ä¸ªå‘é€çš„ä½ç½®ï¼Œå®ƒæŒ‡å‘æœªå‘é€ä½†å¯ä»¥å‘é€çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºåˆ—å·ï¼›SND.UNA: ä¸€ä¸ªç»å¯¹æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘çš„æ˜¯å·²å‘é€ä½†æœªç¡®è®¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºåˆ—å·ã€‚ æ¥æ”¶æ–¹çš„æ»‘åŠ¨çª—å£åŒ…å«ä¸‰å¤§éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š å·²æˆåŠŸæ¥æ”¶å¹¶ç¡®è®¤ æœªæ”¶åˆ°æ•°æ®ä½†å¯ä»¥æ¥æ”¶ æœªæ”¶åˆ°æ•°æ®å¹¶ä¸å¯ä»¥æ¥æ”¶çš„æ•°æ® è“è‰²æ¡†å†…ï¼Œå°±æ˜¯æ¥æ”¶çª—å£ã€‚REV.WND è¡¨ç¤ºæ¥æ”¶çª—å£çš„å¤§å°ï¼›REV.NXTè¡¨ç¤ºä¸‹ä¸€ä¸ªæ¥æ”¶çš„ä½ç½®ï¼Œå®ƒæŒ‡å‘æœªæ”¶åˆ°ä½†å¯ä»¥æ¥æ”¶çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºåˆ—å·ã€‚ å‘é€æ–¹å’Œæ¥æ”¶æ–¹é€šè¿‡ ACK ç¡®è®¤æŠ¥æ–‡æ®µæ¥åå•†çª—å£å¤§å°ã€‚å‘é€æ–¹æ ¹æ®æ¥æ”¶æ–¹çš„æ¥æ”¶çª—å£å¤§å°æ¥è°ƒæ•´è‡ªå·±çš„å‘é€çª—å£å¤§å°ï¼Œä»¥ç¡®ä¿ä¸ä¼šå‘é€è¶…å‡ºæ¥æ”¶æ–¹èƒ½åŠ›çš„æ•°æ®é‡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:16","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.17 äº†è§£ Nagle ç®—æ³•å’Œå»¶è¿Ÿç¡®è®¤å—ï¼Ÿ Nagle ç®—æ³•å’Œå»¶è¿Ÿç¡®è®¤æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ å½“æˆ‘ä»¬ TCP æŠ¥â½‚çš„æ‰¿è½½çš„æ•°æ®â¾®å¸¸â¼©çš„æ—¶å€™ï¼Œä¾‹å¦‚â¼ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆæ•´ä¸ªâ½¹ç»œçš„æ•ˆç‡æ˜¯å¾ˆä½çš„ï¼Œå› ä¸ºæ¯ä¸ª TCP æŠ¥â½‚ä¸­éƒ½ä¼šæœ‰ 20 ä¸ªå­—èŠ‚çš„ TCP å¤´éƒ¨ï¼Œä¹Ÿä¼šæœ‰ 20 ä¸ªå­—èŠ‚çš„ IP å¤´éƒ¨ï¼Œâ½½æ•°æ®åªæœ‰â¼ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åœ¨æ•´ä¸ªæŠ¥â½‚ä¸­æœ‰æ•ˆæ•°æ®å æœ‰çš„æ¯”ä¾‹å°±ä¼šâ¾®å¸¸ä½ã€‚ é‚£ä¹ˆå°±å‡ºç°äº†å¸¸â»…çš„ä¸¤ç§ç­–ç•¥ï¼Œæ¥å‡å°‘â¼©æŠ¥â½‚çš„ä¼ è¾“ï¼Œåˆ†åˆ«æ˜¯ï¼š Nagle ç®—æ³•ï¼šå½“åº”ç”¨ç¨‹åºå‘é€æ•°æ®æ—¶ï¼ŒNagle ç®—æ³•ä¼šå…ˆå°†æ•°æ®æ”¾å…¥ç¼“å†²åŒºï¼Œå¹¶ç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼ˆç§°ä¸º Nagle ç®—æ³•å®šæ—¶å™¨ï¼‰ï¼Œä»¥ä¾¿å°†å¤šä¸ªå°æ•°æ®åŒ…åˆå¹¶æˆä¸€ä¸ªå¤§æ•°æ®åŒ…ä¸€èµ·å‘é€ã€‚åªæœ‰å½“ç¼“å†²åŒºä¸­çš„æ•°æ®é‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼ï¼ˆNagle ç®—æ³•çš„æœ€å°ä¼ è¾“å•å…ƒï¼‰æˆ–è€…å®šæ—¶å™¨è¶…æ—¶æ—¶ï¼Œæ‰ä¼šè§¦å‘æ•°æ®çš„å‘é€ã€‚Nagle ç®—æ³•ä¸»è¦ç”¨äºé¿å…å‘é€å¤§é‡å°æ•°æ®åŒ…çš„æƒ…å†µï¼Œä»è€Œå‡å°‘ç½‘ç»œçš„æ‹¥å¡ï¼Œæé«˜ç½‘ç»œçš„æ€§èƒ½å’Œæ•ˆç‡ã€‚ å»¶è¿Ÿç¡®è®¤ï¼šå½“æ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®æ—¶ï¼Œä¸ä¼šç«‹å³å‘é€ ACK ç¡®è®¤æŠ¥æ–‡ï¼Œè€Œæ˜¯ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆä¸€èˆ¬æ˜¯ç­‰å¾… 200 æ¯«ç§’å·¦å³ï¼‰ï¼Œä»¥ä¾¿å°†å¤šä¸ª ACK åˆå¹¶æˆä¸€ä¸ª ACK ä¸€èµ·å‘é€ã€‚å¦‚æœåœ¨å»¶è¿Ÿæ—¶é—´å†…æ”¶åˆ°æ–°çš„æ•°æ®åŒ…ï¼Œåˆ™ä¼šç«‹å³å‘é€ ACK æŠ¥æ–‡ï¼Œä»¥ç¡®è®¤æ”¶åˆ°çš„æ•°æ®ã€‚å»¶è¿Ÿç¡®è®¤ä¸»è¦ç”¨äºå‡å°‘ç¡®è®¤æŠ¥æ–‡çš„æ•°é‡ï¼Œé¿å…ç½‘ç»œä¸­å‡ºç°è¿‡å¤šçš„ ACK æŠ¥æ–‡ï¼Œä»è€Œå‡å°‘ç½‘ç»œçš„è´Ÿè½½å’Œæé«˜ç½‘ç»œçš„ååé‡ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒNagle ç®—æ³•å’Œå»¶è¿Ÿç¡®è®¤ä¸èƒ½ä¸€èµ·ä½¿ç”¨ï¼ŒNagle ç®—æ³•æ„å‘³ç€å»¶è¿Ÿå‘ï¼Œå»¶è¿Ÿç¡®è®¤æ„å‘³ç€å»¶è¿Ÿæ¥æ”¶ï¼Œä¸¤ä¸ªå‡‘åœ¨ä¸€èµ·å°±ä¼šé€ æˆæ›´å¤§çš„å»¶è¿Ÿï¼Œä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:17","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.18 è¯´è¯´ TCP çš„æ‹¥å¡æ§åˆ¶ï¼Ÿ ä»€ä¹ˆæ˜¯æ‹¥å¡æ§åˆ¶ï¼Ÿä¸æ˜¯æœ‰äº†æµé‡æ§åˆ¶å—ï¼Ÿ å‰â¾¯çš„æµé‡æ§åˆ¶æ˜¯é¿å…å‘é€â½…çš„æ•°æ®å¡«æ»¡æ¥æ”¶â½…çš„ç¼“å­˜ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“æ•´ä¸ªâ½¹ç»œä¹‹ä¸­å‘â½£äº†ä»€ä¹ˆã€‚ â¼€èˆ¬æ¥è¯´ï¼Œè®¡ç®—æœºâ½¹ç»œéƒ½å¤„åœ¨â¼€ä¸ªå…±äº«çš„ç¯å¢ƒã€‚å› æ­¤ä¹Ÿæœ‰å¯èƒ½ä¼šå› ä¸ºå…¶ä»–ä¸»æœºä¹‹é—´çš„é€šä¿¡ä½¿å¾—â½¹ç»œæ‹¥å µã€‚ åœ¨â½¹ç»œå‡ºç°æ‹¥å µæ—¶ï¼Œå¦‚æœç»§ç»­å‘é€â¼¤é‡æ•°æ®åŒ…ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®åŒ…æ—¶å»¶ã€ä¸¢å¤±ç­‰ï¼Œè¿™æ—¶ TCP å°±ä¼šé‡ä¼ æ•°æ®ï¼Œä½†æ˜¯â¼€é‡ä¼ å°±ä¼šå¯¼è‡´â½¹ç»œçš„è´Ÿæ‹…æ›´é‡ï¼Œäºæ˜¯ä¼šå¯¼è‡´æ›´â¼¤çš„å»¶è¿Ÿä»¥åŠæ›´å¤šçš„ä¸¢åŒ…ï¼Œè¿™ä¸ªæƒ…å†µå°±ä¼šè¿›â¼Šæ¶æ€§å¾ªç¯è¢«ä¸æ–­åœ°æ”¾â¼¤â€¦. æ‰€ä»¥ï¼ŒTCP ä¸èƒ½å¿½ç•¥æ•´ä¸ªç½‘ç»œä¸­å‘â½£çš„äº‹ï¼Œå®ƒè¢«è®¾è®¡æˆâ¼€ä¸ªâ½†ç§çš„åè®®ï¼Œå½“â½¹ç»œå‘é€æ‹¥å¡æ—¶ï¼ŒTCP ä¼šâ¾ƒæˆ‘ç‰ºç‰²ï¼Œé™ä½å‘é€çš„æ•°æ®æµã€‚ äºæ˜¯ï¼Œå°±æœ‰äº†æ‹¥å¡æ§åˆ¶ï¼Œæ§åˆ¶çš„â½¬çš„å°±æ˜¯é¿å…å‘é€â½…çš„æ•°æ®å¡«æ»¡æ•´ä¸ªâ½¹ç»œã€‚ å‘é€æ–¹ç»´æŠ¤ä¸€ä¸ªæ‹¥å¡çª—å£ cwndï¼ˆcongestion windowï¼‰ çš„å˜é‡ï¼Œè°ƒèŠ‚æ‰€è¦å‘é€æ•°æ®çš„é‡ã€‚ ä»€ä¹ˆæ˜¯æ‹¥å¡çª—â¼ï¼Ÿå’Œå‘é€çª—â¼æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ æ‹¥å¡çª—â¼ cwndæ˜¯å‘é€â½…ç»´æŠ¤çš„â¼€ä¸ªçš„çŠ¶æ€å˜é‡ï¼Œå®ƒä¼šæ ¹æ®â½¹ç»œçš„æ‹¥å¡ç¨‹åº¦åŠ¨æ€å˜åŒ–çš„ã€‚ å‘é€çª—â¼ swnd å’Œæ¥æ”¶çª—â¼ rwnd æ˜¯çº¦ç­‰äºçš„å…³ç³»ï¼Œé‚£ä¹ˆç”±äºåŠ â¼Šäº†æ‹¥å¡çª—â¼çš„æ¦‚å¿µåï¼Œæ­¤æ—¶å‘é€çª—â¼çš„å€¼æ˜¯ swnd = min(cwnd, rwnd)ï¼Œä¹Ÿå°±æ˜¯æ‹¥å¡çª—â¼å’Œæ¥æ”¶çª—â¼ä¸­çš„æœ€â¼©å€¼ã€‚ æ‹¥å¡çª—â¼ cwnd å˜åŒ–çš„è§„åˆ™ï¼š åªè¦â½¹ç»œä¸­æ²¡æœ‰å‡ºç°æ‹¥å¡ï¼Œ cwnd å°±ä¼šå¢â¼¤ï¼› ä½†â½¹ç»œä¸­å‡ºç°äº†æ‹¥å¡ï¼Œ cwnd å°±å‡å°‘ï¼› æ‹¥å¡æ§åˆ¶æœ‰å“ªäº›å¸¸ç”¨ç®—æ³•ï¼Ÿ æ‹¥å¡æ§åˆ¶ä¸»è¦æœ‰è¿™å‡ ç§å¸¸ç”¨ç®—æ³•ï¼š æ…¢å¯åŠ¨ï¼šå…ˆå‘å‡ºå°‘é‡æ•°æ®ï¼Œå°±åƒæ¢è·¯ä¸€æ ·ï¼Œå…ˆæ‘¸æ¸…å½“å‰çš„ç½‘ç»œæ‹¥å µçŠ¶æ€åï¼Œå†å†³å®šæŒ‰ç…§å¤šå¤§çš„é€Ÿåº¦ä¼ é€æ•°æ®ï¼‰ æ‹¥å¡é¿å…ï¼šåœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼ŒTCPçš„æ‹¥å¡çª—å£ä»¥çº¿æ€§å¢é•¿çš„æ–¹å¼å¢åŠ ï¼Œè€Œä¸æ˜¯æŒ‡æ•°çº§å¢é•¿ å¿«é‡ä¼ ï¼šå‘é€æ–¹ä¸å¿…ç­‰å¾…è¶…æ—¶è®¡æ—¶å™¨çš„åˆ°æœŸï¼Œè€Œæ˜¯ç«‹å³è¿›è¡Œå¿«é€Ÿé‡ä¼ ï¼Œé‡ä¼ ä¸¢å¤±çš„æ•°æ®åŒ… å¿«æ¢å¤ï¼šå¿«æ¢å¤ç®—æ³•ç”¨äºåœ¨æ”¶åˆ°é‡å¤ACKæ—¶ï¼Œè¿…é€Ÿè°ƒæ•´æ‹¥å¡çª—å£å¤§å°ä»¥æ¢å¤ä¼ è¾“é€Ÿåº¦ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:18","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.19 è¯´è¯´ TCP çš„é‡ä¼ æœºåˆ¶ï¼Ÿ TCP çš„é‡ä¼ æœºåˆ¶æ˜¯ç¡®ä¿æ•°æ®ä¼ è¾“å¯é æ€§çš„é‡è¦éƒ¨åˆ†ä¹‹ä¸€ã€‚å®ƒé€šè¿‡åœ¨å‘é€æ–¹å®šæ—¶å™¨è¶…æ—¶æˆ–è€…æ¥æ”¶åˆ°è¿ç»­çš„é‡å¤ç¡®è®¤æ—¶è§¦å‘ï¼Œé‡æ–°å‘é€ä¸¢å¤±æˆ–è€…æœªç¡®è®¤çš„æ•°æ®æ®µï¼Œä»¥ç¡®ä¿æ•°æ®èƒ½å¤Ÿåœ¨ç½‘ç»œä¸­æ­£ç¡®ä¼ è¾“ã€‚ä»¥ä¸‹æ˜¯ TCP çš„é‡ä¼ æœºåˆ¶çš„ä¸»è¦åŸç†ï¼š è¶…æ—¶é‡ä¼ ï¼šå½“å‘é€æ–¹å‘é€æ•°æ®åï¼Œåœ¨ç­‰å¾…ä¸€å®šæ—¶é—´å†…æœªæ”¶åˆ°ç¡®è®¤ ACK æŠ¥æ–‡æ—¶ï¼Œè§¦å‘è¶…æ—¶é‡ä¼ æœºåˆ¶ï¼Œé‡æ–°å‘é€æœªç¡®è®¤çš„æ•°æ®æ®µã€‚è¶…æ—¶æ—¶é—´é€šå¸¸æ ¹æ®ç½‘ç»œå¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰åŠ¨æ€è°ƒæ•´ï¼Œä»¥é€‚åº”ç½‘ç»œå»¶è¿Ÿçš„å˜åŒ–ã€‚ å¿«é€Ÿé‡ä¼ ï¼šå½“å‘é€æ–¹æ¥æ”¶åˆ°è¿ç»­çš„é‡å¤ ACK æŠ¥æ–‡æ—¶ï¼Œè¡¨æ˜æ¥æ”¶æ–¹å·²ç»æˆåŠŸæ¥æ”¶äº†ä¸€äº›æ•°æ®ï¼Œä½†æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®æ®µä¸¢å¤±ã€‚ä¸ºäº†å°½å¿«é‡ä¼ ä¸¢å¤±çš„æ•°æ®æ®µï¼Œå‘é€æ–¹ç«‹å³è§¦å‘å¿«é€Ÿé‡ä¼ æœºåˆ¶ï¼Œé‡æ–°å‘é€ä¸¢å¤±çš„æ•°æ®æ®µï¼Œè€Œä¸å¿…ç­‰å¾…è¶…æ—¶å®šæ—¶å™¨çš„åˆ°æœŸã€‚ å¸¦é€‰æ‹©ç¡®è®¤çš„é‡ä¼ ï¼ˆSACKï¼‰ï¼šé€‰æ‹©ç¡®è®¤ï¼ˆSACKï¼‰ä¸ºäº†è§£å†³åº”è¯¥é‡ä¼ å¤šå°‘ä¸ªåŒ…çš„é—®é¢˜ï¼Œå…è®¸æ¥æ”¶æ–¹åœ¨ç¡®è®¤æŠ¥æ–‡ä¸­æŒ‡ç¤ºå‡ºè¿ç»­çš„æ•°æ®æ®µä¸­å“ªäº›å·²ç»æˆåŠŸæ¥æ”¶ï¼Œå“ªäº›ä¸¢å¤±äº†ã€‚å‘é€æ–¹å¯ä»¥æ ¹æ® SACK æŠ¥æ–‡ä¸­æŒ‡ç¤ºçš„ä¸¢å¤±æ•°æ®æ®µä¿¡æ¯ï¼Œé€‰æ‹©æ€§åœ°è¿›è¡Œé‡ä¼ ï¼Œè€Œä¸æ˜¯é‡ä¼ æ•´ä¸ªçª—å£å†…çš„æ‰€æœ‰æœªç¡®è®¤æ•°æ®æ®µã€‚ é‡å¤ SACKï¼šæ˜¯åœ¨ SACK çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›æ‰©å±•ï¼Œåœ¨æ¥æ”¶æ–¹æ”¶åˆ°è¿ç»­çš„é‡å¤æ•°æ®æ®µæ—¶ï¼Œä¼šç”Ÿæˆå¤šä¸ªç›¸åŒçš„ SACK æŠ¥æ–‡ï¼Œç”¨äºæŒ‡ç¤ºå“ªäº›æ•°æ®æ®µå·²ç»æˆåŠŸæ¥æ”¶ã€‚ä¸»è¦ç”¨æ¥å‘Šè¯‰å‘é€æ–¹ï¼Œæœ‰å“ªäº›æ•°æ®åŒ…ï¼Œè‡ªå·±é‡å¤æ¥å—äº†ã€‚DSACK çš„ç›®çš„æ˜¯å¸®åŠ©å‘é€æ–¹åˆ¤æ–­ï¼Œæ˜¯å¦å‘ç”Ÿäº†åŒ…å¤±åºã€ACK ä¸¢å¤±ã€åŒ…é‡å¤æˆ–ä¼ªé‡ä¼ ã€‚è®© TCP å¯ä»¥æ›´å¥½çš„åšç½‘ç»œæµæ§ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:19","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.20 è¯´è¯´ TCP çš„ç²˜åŒ…å’Œæ‹†åŒ…ï¼Ÿ TCP æ˜¯é¢å‘æµï¼Œæ²¡æœ‰ç•Œé™çš„ä¸€ä¸²æ•°æ®ã€‚TCP åº•å±‚å¹¶ä¸äº†è§£ä¸Šå±‚ä¸šåŠ¡æ•°æ®çš„å…·ä½“å«ä¹‰ï¼Œå®ƒä¼šæ ¹æ® TCP ç¼“å†²åŒºçš„å®é™…æƒ…å†µè¿›è¡ŒåŒ…çš„åˆ’åˆ†ã€‚ ç²˜åŒ…æŒ‡çš„æ˜¯åœ¨ TCP è¿æ¥ä¸­ï¼Œå‘é€æ–¹å‘é€çš„å¤šä¸ªæ•°æ®åŒ…åœ¨æ¥æ”¶æ–¹æ¥æ”¶æ—¶è¢«åˆå¹¶æˆä¸€ä¸ªæ•°æ®åŒ…ã€‚è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨ä»¥ä¸‹å‡ ç§åœºæ™¯ä¸­ï¼š å‘é€æ–¹å‘é€æ•°æ®è¿‡äºé¢‘ç¹ï¼Œå‘é€çš„æ•°æ®é‡è¾ƒå°ï¼Œå¤šä¸ªå°æ•°æ®åŒ…åœ¨å‘é€æ—¶è¢«åˆå¹¶æˆä¸€ä¸ªæ•°æ®åŒ…ã€‚Nagle ç®—æ³•çš„ä½œç”¨ä½¿å¾—å‘é€æ–¹åœ¨ç½‘ç»œæœªç¡®è®¤å‰å°†å°æ•°æ®åŒ…åˆå¹¶å‘é€ã€‚ æ¥æ”¶æ–¹è¯»å–æ•°æ®ä¸åŠæ—¶ï¼Œä¸€æ¬¡æ€§è¯»å–å¤šä¸ªæ•°æ®åŒ…ã€‚ æ‹†åŒ…æŒ‡çš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…åœ¨æ¥æ”¶æ–¹æ¥æ”¶æ—¶è¢«æ‹†åˆ†æˆäº†å¤šä¸ªæ•°æ®åŒ…ã€‚è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨ä»¥ä¸‹å‡ ç§åœºæ™¯ä¸­ï¼š ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œç”±äº MTUï¼ˆæœ€å¤§ä¼ è¾“å•å…ƒï¼‰çš„é™åˆ¶ï¼Œä¸€ä¸ªå¤§çš„æ•°æ®åŒ…è¢«æ‹†åˆ†æˆå¤šä¸ªå°çš„æ•°æ®åŒ…è¿›è¡Œä¼ è¾“ã€‚ å¾…å‘é€æ•°æ®å¤§äº MSSï¼ˆæœ€å¤§æŠ¥æ–‡é•¿åº¦ï¼‰ï¼ŒTCP åœ¨ä¼ è¾“å‰å°†è¿›è¡Œæ‹†åŒ…ã€‚å³ TCP æŠ¥æ–‡é•¿åº¦ - TCP å¤´éƒ¨é•¿åº¦ \u003e MSSã€‚ é‚£æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ å‘é€ç«¯å°†æ¯ä¸ªæ•°æ®åŒ…å°è£…ä¸ºå›ºå®šé•¿åº¦ï¼› åœ¨æ•°æ®å°¾éƒ¨å¢åŠ ç‰¹æ®Šå­—ç¬¦è¿›è¡Œåˆ†å‰²ï¼› å°†æ•°æ®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯å¤´éƒ¨ï¼Œä¸€éƒ¨åˆ†æ˜¯å†…å®¹ä½“ï¼›å…¶ä¸­å¤´éƒ¨ç»“æ„å¤§å°å›ºå®šï¼Œä¸”æœ‰ä¸€ä¸ªå­—æ®µå£°æ˜å†…å®¹ä½“çš„å¤§å°ï¼› è®¾è®¡ç‰¹å®šçš„åº”ç”¨å±‚åè®®ï¼ŒåŒ…å«æ•°æ®åŒ…å¤´éƒ¨ï¼ˆä¾‹å¦‚ï¼Œæ ‡è¯†ç¬¦ã€é•¿åº¦å­—æ®µã€æ ¡éªŒå’Œç­‰ï¼‰å’Œæ•°æ®éƒ¨åˆ†ã€‚æ¥æ”¶æ–¹æ ¹æ®åè®®è§£ææ•°æ®åŒ…ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:20","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.21 å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯æœåŠ¡ç«¯çš„è¿›ç¨‹å´©æºƒä¼šå‘ç”Ÿä»€ä¹ˆï¼ŸæœåŠ¡å™¨æ–­ç”µå‘¢ï¼Ÿ TCP çš„è¿æ¥ä¿¡æ¯æ˜¯ç”±å†…æ ¸ç»´æŠ¤çš„ï¼Œæ‰€ä»¥å½“æœåŠ¡ç«¯çš„è¿›ç¨‹å´©æºƒåï¼Œå†…æ ¸éœ€è¦å›æ”¶è¯¥è¿›ç¨‹çš„æ‰€æœ‰ TCP è¿æ¥èµ„æºï¼Œäºæ˜¯å†…æ ¸ä¼šå‘é€ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ FIN æŠ¥æ–‡ï¼Œåç»­çš„æŒ¥æ‰‹è¿‡ç¨‹ä¹Ÿéƒ½æ˜¯åœ¨å†…æ ¸å®Œæˆï¼Œå¹¶ä¸éœ€è¦è¿›ç¨‹çš„å‚ä¸ï¼Œæ‰€ä»¥å³ä½¿æœåŠ¡ç«¯çš„è¿›ç¨‹é€€å‡ºäº†ï¼Œè¿˜æ˜¯èƒ½ä¸å®¢æˆ·ç«¯å®Œæˆ TCP å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ã€‚ å½“æœåŠ¡å™¨æ–­ç”µæ—¶ï¼Œæƒ…å†µä¼šæœ‰æ‰€ä¸åŒï¼šå®¢æˆ·ç«¯åœ¨å°è¯•ä¸æœåŠ¡å™¨é€šä¿¡æ—¶ï¼Œä¼šå‘ç°è¿æ¥ä¸­æ–­ï¼Œé€šå¸¸ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯ï¼ˆå¦‚ ECONNRESET æˆ– ETIMEDOUTï¼‰ï¼Œå®¢æˆ·ç«¯çš„åº”ç”¨ç¨‹åºéœ€è¦å¤„ç†è¿™ä¸ªé”™è¯¯ï¼Œå¹¶å¯èƒ½å°è¯•é‡æ–°å»ºç«‹è¿æ¥æˆ–é‡‡å–å…¶ä»–åº”å¯¹æªæ–½ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:21","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.22 å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ å®¢æˆ·ç«¯å‡ºç°æ•…éšœæŒ‡çš„æ˜¯å®¢æˆ·ç«¯çš„ä¸»æœºå‘ç”Ÿäº†å®•æœºï¼Œæˆ–è€…æ–­ç”µçš„åœºæ™¯ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œå¦‚æœæœåŠ¡ç«¯ä¸€ç›´ä¸ä¼šå‘é€æ•°æ®ç»™å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯æ˜¯æ°¸è¿œæ— æ³•æ„ŸçŸ¥åˆ°å®¢æˆ·ç«¯å®•æœºè¿™ä¸ªäº‹ä»¶çš„ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯çš„ TCP è¿æ¥å°†ä¸€ç›´å¤„äº ESTABLISH çŠ¶æ€ï¼Œå ç”¨ç€ç³»ç»Ÿèµ„æºã€‚ ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒTCP æäº†ä¸ªä¿æ´»æœºåˆ¶ã€‚è¿™ä¸ªæœºåˆ¶çš„åŸç†æ˜¯è¿™æ ·çš„ï¼š å®šä¹‰ä¸€ä¸ªæ—¶é—´æ®µï¼Œåœ¨è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•è¿æ¥ç›¸å…³çš„æ´»åŠ¨ï¼ŒTCP ä¿æ´»æœºåˆ¶ä¼šå¼€å§‹ä½œç”¨ï¼Œæ¯éš”ä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œå‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œè¯¥æ¢æµ‹æŠ¥æ–‡åŒ…å«çš„æ•°æ®éå¸¸å°‘ï¼Œå¦‚æœè¿ç»­å‡ ä¸ªæ¢æµ‹æŠ¥æ–‡éƒ½æ²¡æœ‰å¾—åˆ°å“åº”ï¼Œåˆ™è®¤ä¸ºå½“å‰çš„ TCP è¿æ¥å·²ç»æ­»äº¡ï¼Œç³»ç»Ÿå†…æ ¸å°†é”™è¯¯ä¿¡æ¯é€šçŸ¥ç»™ä¸Šå±‚åº”ç”¨ç¨‹åºã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:22","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"4.23 æœåŠ¡å™¨å‡ºç°å¤§é‡ CLOSE_WAIT çŠ¶æ€çš„åŸå› æœ‰å“ªäº›ï¼Ÿ CLOSE_WAIT çŠ¶æ€æ˜¯ã€è¢«åŠ¨å…³é—­æ–¹ã€‘æ‰ä¼šæœ‰çš„çŠ¶æ€ï¼Œè€Œä¸”å¦‚æœã€è¢«åŠ¨å…³é—­æ–¹ã€‘æ²¡æœ‰è°ƒç”¨ close å‡½æ•°å…³é—­è¿æ¥ï¼Œé‚£ä¹ˆå°±æ— æ³•å‘å‡º FIN æŠ¥æ–‡ï¼Œä»è€Œæ— æ³•ä½¿å¾— CLOSE_WAIT çŠ¶æ€çš„è¿æ¥è½¬å˜ä¸º LAST_ACK çŠ¶æ€ã€‚ æ‰€ä»¥ï¼Œå½“æœåŠ¡ç«¯å‡ºç°å¤§é‡ CLOSE_WAIT çŠ¶æ€çš„è¿æ¥çš„æ—¶å€™ï¼Œè¯´æ˜æœåŠ¡ç«¯çš„ç¨‹åºæ²¡æœ‰è°ƒç”¨ close å‡½æ•°å…³é—­è¿æ¥ã€‚ æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸ªæ™®é€šçš„ TCP æœåŠ¡ç«¯çš„æµç¨‹ï¼š åˆ›å»ºæœåŠ¡ç«¯ socketï¼Œbind ç»‘å®šç«¯å£ã€listen ç›‘å¬ç«¯å£ å°†æœåŠ¡ç«¯ socket æ³¨å†Œåˆ° epoll epoll_wait ç­‰å¾…è¿æ¥åˆ°æ¥ï¼Œè¿æ¥åˆ°æ¥æ—¶ï¼Œè°ƒç”¨ accpet è·å–å·²è¿æ¥çš„ socket å°†å·²è¿æ¥çš„ socket æ³¨å†Œåˆ° epoll epoll_wait ç­‰å¾…äº‹ä»¶å‘ç”Ÿ å¯¹æ–¹è¿æ¥å…³é—­æ—¶ï¼Œæˆ‘æ–¹è°ƒç”¨ close å¯èƒ½å¯¼è‡´æœåŠ¡ç«¯æ²¡æœ‰è°ƒç”¨ close å‡½æ•°çš„åŸå› æ˜¯ï¼š2ï¼Œ3ï¼Œ4ï¼Œ6æ­¥æ²¡æœ‰åš ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:4:23","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"5 UDP ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:5:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"5.1 è¯´è¯´ TCP å’Œ UDP çš„åŒºåˆ«ï¼Ÿ ç‰¹æ€§ TCP UDP è¿æ¥ é¢å‘è¿æ¥ï¼Œä¼ è¾“æ•°æ®å‰éœ€å»ºç«‹è¿æ¥ æ— éœ€è¿æ¥ï¼Œç«‹å³ä¼ è¾“æ•°æ® æœåŠ¡å¯¹è±¡ ä¸€å¯¹ä¸€çš„ä¸¤ç‚¹æœåŠ¡ æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡ å¯é æ€§ å¯é äº¤ä»˜ï¼Œæ•°æ®æ— å·®é”™ã€ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€æŒ‰åºåˆ°è¾¾ å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œä¸ä¿è¯å¯é äº¤ä»˜æ•°æ® æ‹¥å¡æ§åˆ¶ã€æµé‡æ§åˆ¶ æœ‰æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶æœºåˆ¶ æ— æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶æœºåˆ¶ï¼Œå‘é€é€Ÿç‡ä¸å—ç½‘ç»œæ‹¥å µå½±å“ é¦–éƒ¨å¼€é”€ é¦–éƒ¨é•¿åº¦è¾ƒé•¿ï¼ˆ20 å­—èŠ‚â€”60å­—èŠ‚ï¼‰ é¦–éƒ¨åªæœ‰ 8 å­—èŠ‚ï¼Œä¸”å›ºå®šä¸å˜ï¼Œå¼€é”€è¾ƒå° ä¼ è¾“æ–¹å¼ å­—èŠ‚æµå¼ä¼ è¾“ï¼Œæ— è¾¹ç•Œï¼Œä¿è¯é¡ºåºå’Œå¯é  æ•°æ®æ®µæŠ¥æ–‡ä¼ è¾“ï¼Œæœ‰è¾¹ç•Œï¼Œå¯èƒ½ä¸¢åŒ…å’Œä¹±åº åˆ†ç‰‡ åœ¨ä¼ è¾“å±‚è¿›è¡Œåˆ†ç‰‡ï¼Œä¸¢å¤±åˆ†ç‰‡æ—¶åªé‡ä¼ ä¸¢å¤±éƒ¨åˆ† åœ¨ IP å±‚è¿›è¡Œåˆ†ç‰‡ï¼Œæ¥æ”¶ååœ¨ IP å±‚ç»„è£…å†ä¼ ç»™ä¼ è¾“å±‚ åº”ç”¨åœºæ™¯ æ–‡ä»¶ä¼ è¾“ã€é‚®ä»¶ä¼ è¾“ å³æ—¶é€šè®¯ã€åŸŸåè½¬æ¢ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:5:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"5.2 ä¸ºä»€ä¹ˆ QQ é‡‡ç”¨ UDP åè®®ï¼Ÿ é¦–å…ˆï¼ŒQQ å¹¶ä¸æ˜¯å®Œå…¨åŸºäº UDP å®ç°ã€‚æ¯”å¦‚åœ¨ä½¿ç”¨ QQ è¿›è¡Œæ–‡ä»¶ä¼ è¾“ç­‰æ´»åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šä½¿ç”¨ TCP ä½œä¸ºå¯é ä¼ è¾“çš„ä¿è¯ã€‚ ä½¿ç”¨ UDP è¿›è¡Œäº¤äº’é€šä¿¡çš„å¥½å¤„åœ¨äºï¼Œå»¶è¿Ÿè¾ƒçŸ­ï¼Œå¯¹æ•°æ®ä¸¢å¤±çš„å¤„ç†æ¯”è¾ƒç®€å•ã€‚åŒæ—¶ï¼ŒTCP æ˜¯ä¸€ä¸ªå…¨åŒå·¥åè®®ï¼Œéœ€è¦å»ºç«‹è¿æ¥ï¼Œæ‰€ä»¥ç½‘ç»œå¼€é”€ä¹Ÿä¼šç›¸å¯¹å¤§ã€‚ å¦‚æœä½¿ç”¨ QQ è¯­éŸ³å’Œ QQ è§†é¢‘çš„è¯ï¼ŒUDP çš„ä¼˜åŠ¿å°±æ›´ä¸ºçªå‡ºäº†ï¼Œé¦–å…ˆå»¶è¿Ÿè¾ƒå°ã€‚æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ä¸å¯é ä¼ è¾“ï¼Œè¿™æ„å‘³ç€å¦‚æœæ•°æ®ä¸¢å¤±çš„è¯ï¼Œä¸ä¼šæœ‰é‡ä¼ ã€‚å› ä¸ºç”¨æˆ·ä¸€èˆ¬æ¥è¯´å¯ä»¥æ¥å—å›¾åƒç¨å¾®æ¨¡ç³Šä¸€ç‚¹ï¼Œå£°éŸ³ç¨å¾®ä¸æ¸…æ™°ä¸€ç‚¹ï¼Œä½†æ˜¯å¦‚æœåœ¨å‡ ç§’é’Ÿä»¥åå†å‡ºç°ä¹‹å‰ä¸¢å¤±çš„ç”»é¢å’Œå£°éŸ³ï¼Œè¿™ææ€•æ˜¯å¾ˆéš¾æ¥å—çš„ã€‚ ç”±äº QQ çš„æœåŠ¡å™¨è®¾è®¡å®¹é‡æ˜¯æµ·é‡çº§çš„åº”ç”¨ï¼Œä¸€å°æœåŠ¡å™¨è¦åŒæ—¶å®¹çº³åå‡ ä¸‡çš„å¹¶å‘è¿æ¥ï¼Œå› æ­¤æœåŠ¡å™¨ç«¯åªæœ‰é‡‡ç”¨ UDP åè®®ä¸å®¢æˆ·ç«¯è¿›è¡Œé€šè®¯æ‰èƒ½ä¿è¯è¿™ç§è¶…å¤§è§„æ¨¡çš„æœåŠ¡ ç®€å•æ€»ç»“ä¸€ä¸‹ï¼šUDP åè®®æ˜¯æ— è¿æ¥æ–¹å¼çš„åè®®ï¼Œå®ƒçš„æ•ˆç‡é«˜ï¼Œé€Ÿåº¦å¿«ï¼Œå èµ„æºå°‘ï¼Œå¯¹æœåŠ¡å™¨çš„å‹åŠ›æ¯”è¾ƒå°ã€‚ä½†æ˜¯å…¶ä¼ è¾“æœºåˆ¶ä¸ºä¸å¯é ä¼ é€ï¼Œå¿…é¡»ä¾é è¾…åŠ©çš„ç®—æ³•æ¥å®Œæˆä¼ è¾“æ§åˆ¶ã€‚QQ é‡‡ç”¨çš„é€šä¿¡åè®®ä»¥ UDP ä¸ºä¸»ï¼Œè¾…ä»¥ TCP åè®®ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:5:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"5.3 UDP åè®®ä¸ºä»€ä¹ˆä¸å¯é ï¼Ÿ UDP åœ¨ä¼ è¾“æ•°æ®ä¹‹å‰ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œè¿œåœ°ä¸»æœºçš„è¿è¾“å±‚åœ¨æ¥æ”¶åˆ° UDP æŠ¥æ–‡åï¼Œä¸éœ€è¦ç¡®è®¤ï¼Œæä¾›ä¸å¯é äº¤ä»˜ã€‚æ€»ç»“å°±ä»¥ä¸‹å››ç‚¹ï¼š ä¸ä¿è¯æ¶ˆæ¯äº¤ä»˜ï¼šä¸ç¡®è®¤ï¼Œä¸é‡ä¼ ï¼Œæ— è¶…æ—¶ ä¸ä¿è¯äº¤ä»˜é¡ºåºï¼šä¸è®¾ç½®åŒ…åºå·ï¼Œä¸é‡æ’ï¼Œä¸ä¼šå‘ç”Ÿé˜Ÿé¦–é˜»å¡ ä¸è·Ÿè¸ªè¿æ¥çŠ¶æ€ï¼šä¸å¿…å»ºç«‹è¿æ¥æˆ–é‡å¯çŠ¶æ€æœº ä¸è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼šä¸å†…ç½®å®¢æˆ·ç«¯æˆ–ç½‘ç»œåé¦ˆæœºåˆ¶ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:5:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"5.4 DNS ä¸ºä»€ä¹ˆè¦ç”¨ UDP? æ›´å‡†ç¡®åœ°è¯´ï¼ŒDNS æ—¢ä½¿ç”¨ TCP åˆä½¿ç”¨ UDPã€‚ å½“è¿›è¡ŒåŒºåŸŸä¼ é€ï¼ˆä¸»åŸŸåæœåŠ¡å™¨å‘è¾…åŠ©åŸŸåæœåŠ¡å™¨ä¼ é€å˜åŒ–çš„é‚£éƒ¨åˆ†æ•°æ®ï¼‰æ—¶ä¼šä½¿ç”¨ TCPï¼Œå› ä¸ºæ•°æ®åŒæ­¥ä¼ é€çš„æ•°æ®é‡æ¯”ä¸€ä¸ªè¯·æ±‚å’Œåº”ç­”çš„æ•°æ®é‡è¦å¤šï¼Œè€Œ TCP å…è®¸çš„æŠ¥æ–‡é•¿åº¦æ›´é•¿ï¼Œå› æ­¤ä¸ºäº†ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼Œä¼šä½¿ç”¨åŸºäºå¯é è¿æ¥çš„ TCPã€‚å³åœ¨éœ€è¦å¯é ä¼ è¾“æˆ–å¤„ç†å¤§æ•°æ®åŒ…çš„ç‰¹å®šåœºæ™¯ä¸‹ï¼ŒDNS ä¹Ÿä¼šä½¿ç”¨ TCP ä»¥ç¡®ä¿ä¼ è¾“çš„å¯é æ€§å’Œå®Œæ•´æ€§ã€‚ å½“å®¢æˆ·ç«¯æƒ³ DNS æœåŠ¡å™¨æŸ¥è¯¢åŸŸåï¼ˆåŸŸåè§£æï¼‰çš„æ—¶å€™ï¼Œä¸€èˆ¬è¿”å›çš„å†…å®¹ä¸ä¼šè¶…è¿‡ UDP æŠ¥æ–‡çš„æœ€å¤§é•¿åº¦ï¼Œå³ 512 å­—èŠ‚ï¼Œç”¨ UDP ä¼ è¾“æ—¶ï¼Œä¸éœ€è¦åˆ›å»ºè¿æ¥ï¼Œä»è€Œå¤§å¤§æé«˜äº†å“åº”é€Ÿåº¦ï¼Œä½†è¿™è¦æ±‚åŸŸåè§£ææœåŠ¡å™¨å’ŒåŸŸåæœåŠ¡å™¨éƒ½å¿…é¡»è‡ªå·±å¤„ç†è¶…æ—¶å’Œé‡ä¼ ä»è€Œä¿è¯å¯é æ€§ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:5:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"5.5 ä½ ä¼šå¦‚ä½•è®¾è®¡QQä¸­çš„ç½‘ç»œåè®®ï¼Ÿ é¦–å…ˆï¼Œæˆ‘ä»¬è¦å®ç°ç™»å½•åŠŸèƒ½ï¼Œè¿™æ˜¯ä½¿ç”¨ QQ çš„ç¬¬ä¸€æ­¥ï¼Œä¸ºäº†ä¿è¯è´¦å·å’Œå¯†ç çš„å®‰å…¨æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹© TCP + SSL/TLS åè®®æ¥è¿›è¡Œç™»å½•ã€‚ å› ä¸º TCP åè®®æ˜¯ä¸€ç§å¯é çš„ä¼ è¾“åè®®ï¼Œèƒ½å¤Ÿä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œè€Œ SSL/TLS èƒ½å¤Ÿå¯¹é€šä¿¡è¿›è¡ŒåŠ å¯†ï¼Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ¶ˆæ¯ä¼ é€’çš„å®æ—¶æ€§ï¼Œå¦‚è¯­éŸ³è§†é¢‘é€šè¯ç­‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥é€‰æ‹© UDP åè®®ã€‚UDP çš„ä¼ è¾“é€Ÿåº¦æ›´å¿«ï¼Œå¯¹äºå®æ—¶æ€§æœåŠ¡æ¥è¯´ï¼Œé€Ÿåº¦æ˜¯æœ€é‡è¦çš„ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:5:5","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"5.6 UDPå¦‚ä½•å°½é‡ä¿è¯æ¶ˆæ¯çš„ä¸ä¸¢å¤± å¯¹äº TCP åè®®æ¥è¯´ï¼Œå¦‚æœæ•°æ®åŒ…åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸¢å¤±ï¼ŒTCP åè®®ä¼šè‡ªåŠ¨è¿›è¡Œé‡ä¼ ã€‚ è€Œå¯¹äº UDP åè®®æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åº”ç”¨å±‚çš„é‡ä¼ æœºåˆ¶æ¥ä¿è¯æ¶ˆæ¯çš„ä¸ä¸¢å¤±ã€‚å½“æ¥æ”¶æ–¹æ”¶åˆ°æ¶ˆæ¯åï¼Œè¿”å›ä¸€ä¸ªç¡®è®¤ä¿¡æ¯ç»™å‘é€æ–¹ï¼Œå¦‚æœå‘é€æ–¹åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ä¿¡æ¯ï¼Œå°±é‡æ–°å‘é€æ¶ˆæ¯ã€‚ åŒæ—¶ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½é™„å¸¦ä¸€ä¸ªå”¯ä¸€çš„åºåˆ—å·ï¼Œæ¥æ”¶æ–¹æ ¹æ®åºåˆ—å·åˆ¤æ–­æ˜¯å¦æœ‰æ¶ˆæ¯ä¸¢å¤±ï¼Œå¦‚æœå‘ç°åºåˆ—å·ä¸è¿ç»­ï¼Œå°±å¯ä»¥è¦æ±‚å‘é€æ–¹é‡æ–°å‘é€ã€‚è¿™æ ·è¿˜å¯ä»¥é˜²æ­¢æ¶ˆæ¯é‡å¤ã€‚ å½“ç„¶äº†ï¼Œæ¶ˆæ¯æŒä¹…åŒ–ä¹Ÿå¾ˆé‡è¦ï¼Œå¯ä»¥å°†æ¶ˆæ¯ä¿å­˜åœ¨æœåŠ¡å™¨æˆ–è€…æœ¬åœ°çš„æ•°æ®åº“ä¸­ï¼Œå³ä½¿åœ¨ç½‘ç»œä¸­æ–­æˆ–è€…å…¶ä»–å¼‚å¸¸æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½ä»æ•°æ®åº“ä¸­æ¢å¤æ¶ˆæ¯ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:5:6","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"6 QUIC ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:6:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"6.1 QUICæ˜¯å¦‚ä½•å®ç°å¯é ä¼ è¾“çš„ï¼Ÿï¼ˆUDPå¦‚ä½•å®ç°å¯é ä¼ è¾“ï¼Ÿï¼‰ æŠŠTCPå¯é ä¼ è¾“çš„ç‰¹æ€§ï¼ˆåºå·ï¼Œç¡®è®¤åº”ç­”ï¼Œè¶…æ—¶é‡ä¼ ï¼Œæµé‡æ§åˆ¶ï¼‰åœ¨åº”ç”¨å±‚å®ç°ä¸€éã€‚ åŸºäºUDPï¼šQUIC å»ºç«‹åœ¨ UDP ä¹‹ä¸Šï¼Œé€šè¿‡åœ¨ UDP æ•°æ®æŠ¥ä¸­å°è£…è‡ªå·±çš„æ•°æ®åŒ…æ¥å®ç°å¯é ä¼ è¾“ã€‚ å¯é ä¼ è¾“ï¼šQUIC æä¾›äº†ç±»ä¼¼äº TCP çš„å¯é ä¼ è¾“æœºåˆ¶ï¼ŒåŒ…æ‹¬åºåˆ—å·ã€ç¡®è®¤åº”ç­”ã€é‡ä¼ å’Œæµé‡æ§åˆ¶ã€‚ å¤šè·¯å¤ç”¨ï¼šQUIC æ”¯æŒå¤šæ¡ç‹¬ç«‹çš„æµï¼Œè§£å†³äº† TCP çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚ æ‹¥å¡æ§åˆ¶ï¼šQUIC å®ç°äº†æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œç¡®ä¿é«˜æ•ˆçš„æ•°æ®ä¼ è¾“ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:6:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"6.2 QUICæ˜¯å¦‚ä½•è§£å†³TCPé˜Ÿå¤´é˜»å¡é—®é¢˜çš„ï¼Ÿ TCPçš„é˜Ÿå¤´é˜»å¡ï¼ˆHead-of-Line Blockingï¼‰é—®é¢˜æ˜¯æŒ‡åœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæŸä¸ªæ•°æ®åŒ…ä¸¢å¤±äº†ï¼Œåç»­çš„æ•°æ®åŒ…å³ä½¿å·²ç»åˆ°è¾¾æ¥æ”¶æ–¹ï¼Œä¹Ÿæ— æ³•è¢«å¤„ç†ï¼Œå› ä¸ºæ¥æ”¶æ–¹å¿…é¡»æŒ‰é¡ºåºå¤„ç†æ•°æ®åŒ…ã€‚ QUICé€šè¿‡ä»¥ä¸‹æœºåˆ¶è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š å¤šè·¯å¤ç”¨ï¼šQUICå…è®¸å¤šä¸ªç‹¬ç«‹çš„æµåœ¨åŒä¸€ä¸ªè¿æ¥ä¸­ä¼ è¾“ï¼Œæ¯ä¸ªæµéƒ½æœ‰è‡ªå·±çš„åºåˆ—å·å’Œç¡®è®¤æœºåˆ¶ã€‚è¿™æ„å‘³ç€å³ä½¿æŸä¸ªæµçš„æ•°æ®åŒ…ä¸¢å¤±äº†ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–æµçš„æ•°æ®ä¼ è¾“ã€‚ ç‹¬ç«‹æµå¤„ç†ï¼šæ¥æ”¶æ–¹å¯ä»¥ç‹¬ç«‹å¤„ç†æ¯ä¸ªæµçš„æ•°æ®åŒ…ï¼Œå³ä½¿æŸä¸ªæµçš„æ•°æ®åŒ…ä¸¢å¤±äº†ï¼Œæ¥æ”¶æ–¹ä»ç„¶å¯ä»¥å¤„ç†å…¶ä»–æµçš„æ•°æ®åŒ…ï¼Œé¿å…äº†é˜Ÿå¤´é˜»å¡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:6:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"6.3 QUICæ˜¯å¦‚ä½•åšæµé‡æ§åˆ¶çš„ï¼Ÿ QUICçš„æµé‡æ§åˆ¶æœºåˆ¶ä¸TCPç±»ä¼¼ï¼Œä½†æ›´ä¸ºçµæ´»å’Œé«˜æ•ˆï¼š æµçº§åˆ«çš„æµé‡æ§åˆ¶ï¼šæ¯ä¸ªæµéƒ½æœ‰è‡ªå·±çš„æµé‡æ§åˆ¶çª—å£ï¼Œå‘é€æ–¹åœ¨å‘é€æ•°æ®ä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿æ•°æ®å¤§å°ä¸è¶…è¿‡æ¥æ”¶æ–¹ä¸ºè¯¥æµè®¾å®šçš„çª—å£å¤§å°ã€‚ è¿æ¥çº§åˆ«çš„æµé‡æ§åˆ¶ï¼šé™¤äº†æµçº§åˆ«çš„æµé‡æ§åˆ¶ï¼ŒQUICè¿˜æ”¯æŒè¿æ¥çº§åˆ«çš„æµé‡æ§åˆ¶ï¼Œé™åˆ¶æ•´ä¸ªè¿æ¥ä¸Šçš„æœªç¡®è®¤æ•°æ®æ€»é‡ï¼Œé˜²æ­¢ç½‘ç»œæ‹¥å¡ã€‚ åŠ¨æ€è°ƒæ•´çª—å£å¤§å°ï¼šQUICå¯ä»¥æ ¹æ®ç½‘ç»œçŠ¶å†µåŠ¨æ€è°ƒæ•´æµé‡æ§åˆ¶çª—å£çš„å¤§å°ï¼Œæé«˜æ•°æ®ä¼ è¾“çš„æ•ˆç‡å’Œé€‚åº”æ€§ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:6:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"6.4 QUICæ˜¯å¦‚ä½•è¿ç§»è¿æ¥çš„ï¼Ÿ åŸºäº TCP ä¼ è¾“åè®®çš„ HTTP åè®®ï¼Œç”±äºæ˜¯é€šè¿‡å››å…ƒç»„ï¼ˆæº IPã€æºç«¯å£ã€ç›®çš„ IPã€ç›®çš„ç«¯å£ï¼‰ç¡®å®šä¸€æ¡ TCP è¿æ¥ã€‚ é‚£ä¹ˆå½“ç§»åŠ¨è®¾å¤‡çš„ç½‘ç»œä» 4G åˆ‡æ¢åˆ° WIFI æ—¶ï¼Œæ„å‘³ç€ IP åœ°å€å˜åŒ–äº†ï¼Œé‚£ä¹ˆå°±å¿…é¡»è¦æ–­å¼€è¿æ¥ï¼Œç„¶åé‡æ–°å»ºç«‹ TCP è¿æ¥ã€‚ è€Œå»ºç«‹è¿æ¥çš„è¿‡ç¨‹åŒ…å« TCP ä¸‰æ¬¡æ¡æ‰‹å’Œ TLS å››æ¬¡æ¡æ‰‹çš„æ—¶å»¶ï¼Œä»¥åŠ TCP æ…¢å¯åŠ¨çš„å‡é€Ÿè¿‡ç¨‹ï¼Œç»™ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯ç½‘ç»œçªç„¶å¡é¡¿äº†ä¸€ä¸‹ï¼Œå› æ­¤è¿æ¥çš„è¿ç§»æˆæœ¬æ˜¯å¾ˆé«˜çš„ã€‚ QUIC åè®®æ²¡æœ‰ç”¨å››å…ƒç»„çš„æ–¹å¼æ¥â€œç»‘å®šâ€è¿æ¥ï¼Œè€Œæ˜¯é€šè¿‡ä»¥ä¸‹æœºåˆ¶ï¼š è¿æ¥IDï¼šQUICä¸ºæ¯ä¸ªè¿æ¥åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„è¿æ¥IDï¼Œè¿æ¥IDä¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£æ— å…³ã€‚å› æ­¤ï¼Œå³ä½¿å®¢æˆ·ç«¯çš„IPåœ°å€æˆ–ç«¯å£å‘ç”Ÿå˜åŒ–ï¼Œåªè¦è¿æ¥IDä¸å˜ï¼Œè¿æ¥ä»ç„¶æœ‰æ•ˆã€‚ è·¯å¾„éªŒè¯ï¼šåœ¨è¿ç§»è¿æ¥æ—¶ï¼ŒQUICä¼šéªŒè¯æ–°çš„è·¯å¾„æ˜¯å¦å¯ç”¨ï¼Œç¡®ä¿æ•°æ®èƒ½å¤Ÿé€šè¿‡æ–°è·¯å¾„ä¼ è¾“ã€‚ è¿ç§»è¿‡ç¨‹ï¼šå½“å®¢æˆ·ç«¯æ£€æµ‹åˆ°ç½‘ç»œå˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œä»WiFiåˆ‡æ¢åˆ°ç§»åŠ¨ç½‘ç»œï¼‰æ—¶ï¼Œä¼šé€šçŸ¥æœåŠ¡å™¨æ–°çš„åœ°å€å’Œç«¯å£ã€‚æœåŠ¡å™¨éªŒè¯æ–°çš„è·¯å¾„åï¼Œç»§ç»­é€šè¿‡æ–°çš„è·¯å¾„ä¼ è¾“æ•°æ®ã€‚ æ— ç¼åˆ‡æ¢ï¼šé€šè¿‡è¿æ¥IDå’Œè·¯å¾„éªŒè¯æœºåˆ¶ï¼ŒQUICå®ç°äº†è¿æ¥çš„æ— ç¼è¿ç§»ï¼Œé¿å…äº†å› ç½‘ç»œå˜åŒ–å¯¼è‡´çš„è¿æ¥ä¸­æ–­å’Œæ•°æ®ä¸¢å¤±ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:6:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7 IP ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.1 IP åè®®çš„å®šä¹‰å’Œä½œç”¨ï¼Ÿ IP åè®®ï¼ˆInternet Protocolï¼‰åˆè¢«ç§°ä¸ºäº’è”ç½‘åè®®ï¼Œæ˜¯æ”¯æŒç½‘é—´äº’è”çš„æ•°æ®åŒ…åè®®ï¼Œå·¥ä½œåœ¨ç½‘é™…å±‚ï¼Œä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†æé«˜ç½‘ç»œçš„å¯æ‰©å±•æ€§ã€‚ é€šè¿‡ç½‘é™…åè®® IPï¼Œå¯ä»¥æŠŠå‚ä¸äº’è”çš„ï¼Œæ€§èƒ½å„å¼‚çš„ç½‘ç»œçœ‹ä½œä¸€ä¸ªç»Ÿä¸€çš„ç½‘ç»œã€‚ å’Œä¼ è¾“å±‚ TCP ç›¸æ¯”ï¼ŒIP åè®®æ˜¯ä¸€ç§æ— è¿æ¥/ä¸å¯é ã€å°½åŠ›è€Œä¸ºçš„æ•°æ®åŒ…ä¼ è¾“æœåŠ¡ï¼Œå’Œ TCP åè®®ä¸€èµ·æ„æˆäº† TCP/IP åè®®çš„æ ¸å¿ƒã€‚ IP åè®®æœ‰å“ªäº›ä½œç”¨ï¼Ÿ IP åè®®ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä½œç”¨ï¼š å¯»å€å’Œè·¯ç”±ï¼šåœ¨ IP æ•°æ®æŠ¥ä¸­æºå¸¦æº IP åœ°å€å’Œç›®çš„ IP åœ°å€æ¥è¡¨ç¤ºè¯¥æ•°æ®åŒ…çš„æºä¸»æœºå’Œç›®æ ‡ä¸»æœºã€‚IP æ•°æ®æŠ¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªä¸­é—´èŠ‚ç‚¹ï¼ˆIP ç½‘å…³ã€è·¯ç”±å™¨ï¼‰åªæ ¹æ®ç½‘ç»œåœ°å€æ¥è¿›è¡Œè½¬å‘ï¼Œå¦‚æœä¸­é—´èŠ‚ç‚¹æ˜¯è·¯ç”±å™¨ï¼Œåˆ™è·¯ç”±å™¨ä¼šæ ¹æ®è·¯ç”±è¡¨é€‰æ‹©åˆé€‚çš„è·¯å¾„ã€‚IP åè®®æ ¹æ®è·¯ç”±é€‰æ‹©åè®®æä¾›çš„è·¯ç”±ä¿¡æ¯å¯¹ IP æ•°æ®æŠ¥è¿›è¡Œè½¬å‘ï¼Œç›´è‡³ç›®æ ‡ä¸»æœºã€‚ åˆ†æ®µå’Œé‡ç»„ï¼šIP æ•°æ®æŠ¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½ä¼šç»è¿‡ä¸åŒçš„ç½‘ç»œï¼Œåœ¨ä¸åŒçš„ç½‘ç»œä¸­æ•°æ®æŠ¥çš„æœ€å¤§é•¿åº¦é™åˆ¶æ˜¯ä¸åŒçš„ï¼ŒIP åè®®é€šè¿‡ç»™æ¯ä¸ª IP æ•°æ®æŠ¥åˆ†é…ä¸€ä¸ªæ ‡è¯†ç¬¦ä»¥åŠåˆ†æ®µä¸ç»„è£…çš„ç›¸å…³ä¿¡æ¯ï¼Œä½¿å¾—æ•°æ®æŠ¥åœ¨ä¸åŒçš„ç½‘ç»œä¸­èƒ½å¤Ÿè¢«ä¼ è¾“ï¼Œè¢«åˆ†æ®µåçš„ IP æ•°æ®æŠ¥å¯ä»¥ç‹¬ç«‹åœ°åœ¨ç½‘ç»œä¸­è¿›è¡Œè½¬å‘ï¼Œåœ¨è¾¾åˆ°ç›®æ ‡ä¸»æœºåç”±ç›®æ ‡ä¸»æœºå®Œæˆé‡ç»„å·¥ä½œï¼Œæ¢å¤å‡ºåŸæ¥çš„ IP æ•°æ®æŠ¥ã€‚ å·®é”™å¤„ç†ï¼šè™½ç„¶ IP æ˜¯å°½åŠ›è€Œä¸ºçš„åè®®ï¼Œä¸ä¿è¯æ•°æ®æŠ¥ä¸€å®šåˆ°è¾¾ç›®çš„åœ°ï¼Œä½†å®ƒåŒ…å«ä¸€äº›åŸºæœ¬çš„å·®é”™å¤„ç†æœºåˆ¶ï¼Œä¾‹å¦‚æ ¡éªŒå’Œï¼ˆchecksumï¼‰ï¼Œç”¨äºæ£€æµ‹æ•°æ®æŠ¥å¤´éƒ¨çš„é”™è¯¯ã€‚ æ§åˆ¶ä¿¡æ¯ï¼šIP å¤´éƒ¨åŒ…å«äº†å¤šä¸ªå­—æ®µï¼Œç”¨äºæ§åˆ¶å’Œç®¡ç†æ•°æ®æŠ¥çš„ä¼ è¾“ï¼Œå¦‚ç”Ÿå­˜æ—¶é—´ï¼ˆTTLï¼ŒTime to Liveï¼‰å­—æ®µï¼Œé˜²æ­¢æ•°æ®æŠ¥åœ¨ç½‘ç»œä¸­æ— é™å¾ªç¯ã€‚ ä¼ è¾“å±‚åè®®å’Œç½‘ç»œå±‚åè®®æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç½‘ç»œå±‚åè®®è´Ÿè´£æä¾›ä¸»æœºé—´çš„é€»è¾‘é€šä¿¡ï¼›ä¼ è¾“å±‚åè®®è´Ÿè´£æä¾›è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.2 IP åœ°å€æœ‰å“ªäº›åˆ†ç±»ï¼Ÿ IPåœ°å€ï¼ˆInternet Protocol Addressï¼‰æ˜¯ç”¨äºæ ‡è¯†ç½‘ç»œä¸­è®¾å¤‡çš„å”¯ä¸€åœ°å€ã€‚IPåœ°å€æœ‰ä¸¤ç§ç‰ˆæœ¬ï¼šIPv4å’ŒIPv6ã€‚IPv4æ˜¯ç›®å‰æœ€å¹¿æ³›ä½¿ç”¨çš„ç‰ˆæœ¬ï¼ŒIPv6æ˜¯ä¸ºè§£å†³IPv4åœ°å€è€—å°½é—®é¢˜è€Œè®¾è®¡çš„æ–°ç‰ˆæœ¬ã€‚ IPv4åœ°å€æ˜¯32ä½é•¿çš„äºŒè¿›åˆ¶æ•°ï¼Œé€šå¸¸è¡¨ç¤ºä¸ºå››ä¸ªåè¿›åˆ¶æ•°ï¼ˆæ¯ä¸ªæ•°å¯¹åº”8ä½ï¼‰ä¹‹é—´ç”¨ç‚¹åˆ†éš”ï¼ˆä¾‹å¦‚ï¼Œ192.168.1.1ï¼‰ã€‚IPv4åœ°å€å¯ä»¥æŒ‰å…¶ç”¨é€”å’Œç»“æ„åˆ†ä¸ºAï¼ŒBï¼ŒCï¼ŒDï¼ŒEäº”å¤§ç±»ï¼š A ç±»åœ°å€ (1~126)ï¼šä»¥ 0 å¼€å¤´ï¼Œç½‘ç»œå·å å‰ 8 ä½ï¼Œä¸»æœºå·å åé¢ 24 ä½ï¼Œä¸»è¦ç”¨äºå¤§å‹ç½‘ç»œï¼› B ç±»åœ°å€ (128~191)ï¼šä»¥ 10 å¼€å¤´ï¼Œç½‘ç»œå·å å‰ 16 ä½ï¼Œä¸»æœºå·å åé¢ 16 ä½ï¼Œä¸»è¦ç”¨äºä¸­å‹ç½‘ç»œï¼› C ç±»åœ°å€ (192~223)ï¼šä»¥ 110 å¼€å¤´ï¼Œç½‘ç»œå·å å‰ 24 ä½ï¼Œä¸»æœºå·å åé¢ 8 ä½ï¼Œä¸»è¦ç”¨äºå°å‹ç½‘ç»œï¼› D ç±»åœ°å€ (224~239)ï¼šä»¥ 1110 å¼€å¤´ï¼Œä¿ç•™ä¸ºå¤šæ’­åœ°å€ï¼Œç”¨äºä¸€å¯¹å¤šé€šä¿¡ï¼› E ç±»åœ°å€ (240~255)ï¼šä»¥ 1111 å¼€å¤´ï¼Œä¿ç•™ä½ä¸ºå°†æ¥ä½¿ç”¨ï¼Œç”¨äºå®éªŒå’Œç ”ç©¶ã€‚ IPv4æœ‰ä»¥ä¸‹ç‰¹æ®Šåœ°å€ï¼š æœ¬åœ°å›ç¯åœ°å€ï¼ˆLoopback Addressï¼‰ï¼š127.0.0.0 åˆ° 127.255.255.255ï¼Œç”¨äºä¸»æœºè‡ªæˆ‘æµ‹è¯•ï¼Œé€šå¸¸ä½¿ç”¨127.0.0.1ã€‚ å¹¿æ’­åœ°å€ï¼ˆBroadcast Addressï¼‰ï¼šç”¨äºå°†ä¿¡æ¯å‘é€åˆ°ç½‘ç»œä¸Šçš„æ‰€æœ‰è®¾å¤‡ã€‚ä¾‹å¦‚ï¼Œ192.168.1.255ã€‚ ç§æœ‰åœ°å€ï¼ˆPrivate Addressï¼‰ï¼šç”¨äºå±€åŸŸç½‘ï¼ˆLANï¼‰å†…éƒ¨é€šä¿¡ï¼Œä¸å¯åœ¨äº’è”ç½‘ä¸Šä½¿ç”¨ã€‚åŒ…æ‹¬ä»¥ä¸‹èŒƒå›´ï¼š Aç±»ï¼š10.0.0.0 åˆ° 10.255.255.255 Bç±»ï¼š172.16.0.0 åˆ° 172.31.255.255 Cç±»ï¼š192.168.0.0 åˆ° 192.168.255.255 IPv6åœ°å€æ˜¯128ä½é•¿çš„äºŒè¿›åˆ¶æ•°ï¼Œé€šå¸¸è¡¨ç¤ºä¸ºå…«ç»„åå…­è¿›åˆ¶æ•°ä¹‹é—´ç”¨å†’å·åˆ†éš”ï¼ˆä¾‹å¦‚ï¼Œ2001:0db8:85a3:0000:0000:8a2e:0370:7334ï¼‰ã€‚IPv6åœ°å€ç±»å‹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š å•æ’­åœ°å€ï¼ˆUnicast Addressï¼‰ï¼šæ ‡è¯†å•ä¸€æ¥å£çš„åœ°å€ã€‚ å…¨çƒå•æ’­åœ°å€ï¼ˆGlobal Unicast Addressï¼‰ï¼šç±»ä¼¼äºIPv4çš„å…¬æœ‰åœ°å€ã€‚ é“¾è·¯æœ¬åœ°åœ°å€ï¼ˆLink-Local Addressï¼‰ï¼šä»…åœ¨å•ä¸€é“¾è·¯ä¸Šæœ‰æ•ˆï¼Œå‰ç¼€ä¸ºfe80::/10ã€‚ ç«™ç‚¹æœ¬åœ°åœ°å€ï¼ˆSite-Local Addressï¼‰ï¼šç±»ä¼¼äºIPv4çš„ç§æœ‰åœ°å€ï¼Œä½†å·²è¢«å¼ƒç”¨ï¼Œå‰ç¼€ä¸ºfec0::/10ã€‚ å¤šæ’­åœ°å€ï¼ˆMulticast Addressï¼‰ï¼šç”¨äºä¸€å¯¹å¤šé€šä¿¡ï¼Œå‰ç¼€ä¸ºff00::/8ã€‚ ä»»æ’­åœ°å€ï¼ˆAnycast Addressï¼‰ï¼šåˆ†é…ç»™å¤šä¸ªæ¥å£ï¼Œä½†æ•°æ®åŒ…ä»…å‘é€åˆ°è·ç¦»æœ€è¿‘çš„æ¥å£ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.3 åŸŸåå’Œ IP çš„å…³ç³»ï¼Ÿä¸€ä¸ª IP å¯ä»¥å¯¹åº”å¤šä¸ªåŸŸåå—ï¼Ÿä¸€ä¸ªåŸŸåå¯ä»¥å¯¹åº”å¤šä¸ªIPå—ï¼Ÿ åŸŸåï¼ˆDomain Nameï¼‰ï¼šäººç±»å¯è¯»çš„åœ°å€ï¼Œç”¨äºæ ‡è¯†å’Œè®¿é—®ç½‘ç«™åŠå…¶ä»–ç½‘ç»œèµ„æºï¼ˆä¾‹å¦‚ï¼Œwww.example.comï¼‰ã€‚ IPåœ°å€ï¼ˆInternet Protocol Addressï¼‰ï¼šè®¡ç®—æœºå¯è¯»çš„åœ°å€ï¼Œç”¨äºæ ‡è¯†ç½‘ç»œä¸­çš„è®¾å¤‡ï¼ˆä¾‹å¦‚ï¼Œ192.168.1.1ï¼‰ã€‚ åŸŸåå’ŒIPåœ°å€ä¹‹é—´æ˜¯é€šè¿‡DNSï¼ˆDomain Name Systemï¼‰æ¥è¿›è¡Œæ˜ å°„å’Œè§£æçš„ã€‚ ä¸€ä¸ªåŸŸåå¯ä»¥å¯¹åº”å¤šä¸ª IPï¼Œä½†è¿™ç§æƒ…å†µ DNS åšè´Ÿè½½å‡è¡¡çš„ï¼Œåœ¨ç”¨æˆ·è®¿é—®è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªåŸŸååªèƒ½å¯¹åº”ä¸€ä¸ª IPã€‚ è€Œä¸€ä¸ªIPå´å¯ä»¥å¯¹åº”å¤šä¸ªåŸŸåï¼Œæ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.4 IPV4 åœ°å€ä¸å¤Ÿå¦‚ä½•è§£å†³ï¼Ÿ DHCPï¼šåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼ŒåŠ¨æ€åˆ†é… IP åœ°å€ï¼Œåªç»™æ¥å…¥ç½‘ç»œçš„è®¾å¤‡åˆ†é… IP åœ°å€ï¼Œå› æ­¤åŒä¸€ä¸ª MAC åœ°å€çš„è®¾å¤‡ï¼Œæ¯æ¬¡æ¥å…¥äº’è”ç½‘æ—¶ï¼Œå¾—åˆ°çš„ IP åœ°å€ä¸ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œè¯¥åè®®ä½¿å¾—ç©ºé—²çš„ IP åœ°å€å¯ä»¥å¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚ CIDRï¼šæ— ç±»åˆ«åŸŸé—´è·¯ç”±ã€‚CIDR æ¶ˆé™¤äº†ä¼ ç»Ÿçš„ A ç±»ã€B ç±»ã€C ç±»åœ°å€ä»¥åŠåˆ’åˆ†å­ç½‘çš„æ¦‚å¿µï¼Œå› è€Œæ›´åŠ æœ‰æ•ˆåœ°åˆ†é… IPv4 çš„åœ°å€ç©ºé—´ï¼Œä½†æ— æ³•ä»æ ¹æœ¬ä¸Šè§£å†³åœ°å€è€—å°½çš„é—®é¢˜ã€‚ NATï¼šç½‘ç»œåœ°å€è½¬æ¢åè®®ï¼Œæˆ‘ä»¬çŸ¥é“å±äºä¸åŒå±€åŸŸç½‘çš„ä¸»æœºå¯ä»¥ä½¿ç”¨ç›¸åŒçš„ IP åœ°å€ï¼Œä»è€Œä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº† IP èµ„æºæ¯ç«­çš„é—®é¢˜ï¼Œç„¶è€Œä¸»æœºåœ¨å±€åŸŸç½‘ä¸­ä½¿ç”¨çš„ IP åœ°å€æ˜¯ä¸èƒ½åœ¨å…¬ç½‘ä¸­ä½¿ç”¨çš„ï¼Œå½“å±€åŸŸç½‘ä¸»æœºæƒ³è¦ä¸å…¬ç½‘ä¸»æœºè¿›è¡Œé€šä¿¡æ—¶ï¼ŒNAT æ–¹æ³•å¯ä»¥å°†è¯¥ä¸»æœº IP åœ°å€è½¬æ¢ä¸ºå…¨çƒ IP åœ°å€ã€‚è¯¥åè®®èƒ½å¤Ÿæœ‰æ•ˆè§£å†³ IP åœ°å€ä¸è¶³çš„é—®é¢˜ã€‚ IPv6ï¼šä½œä¸ºæ¥æ›¿ IPv4 çš„ä¸‹ä¸€ä»£äº’è”ç½‘åè®®ï¼Œå…¶å¯ä»¥å®ç° 2 çš„ 128 æ¬¡æ–¹ä¸ªåœ°å€ï¼Œè€Œè¿™ä¸ªæ•°é‡çº§ï¼Œå³ä½¿ç»™åœ°çƒä¸Šæ¯ä¸€ç²’æ²™å­éƒ½åˆ†é…ä¸€ä¸ª IP åœ°å€ä¹Ÿå¤Ÿç”¨ï¼Œè¯¥åè®®èƒ½å¤Ÿä»æ ¹æœ¬ä¸Šè§£å†³ IPv4 åœ°å€ä¸å¤Ÿç”¨çš„é—®é¢˜ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.5 è¯´ä¸‹ ARP åè®®çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿ ARPï¼ˆAddress Resolution Protocolï¼Œåœ°å€è§£æåè®®ï¼‰æ˜¯ç”¨äºå°†IPåœ°å€è§£æä¸ºå¯¹åº”ç‰©ç†ç½‘ç»œåœ°å€ï¼ˆå¦‚MACåœ°å€ï¼‰çš„åè®®ï¼Œä¸»è¦åœ¨IPv4ç½‘ç»œä¸­ä½¿ç”¨ã€‚å®ƒåœ¨å±€åŸŸç½‘ï¼ˆLANï¼‰ä¸­èµ·åˆ°äº†å…³é”®ä½œç”¨ï¼Œä½¿è®¾å¤‡èƒ½å¤Ÿé€šè¿‡IPåœ°å€æ‰¾åˆ°å¯¹åº”çš„ç¡¬ä»¶åœ°å€ï¼Œä»è€Œå®ç°æ•°æ®å¸§åœ¨å±€åŸŸç½‘ä¸­çš„æ­£ç¡®ä¼ è¾“ã€‚ ARPè¯·æ±‚ï¼šå½“ä¸»æœº A è¦å‘é€æ•°æ®ç»™ä¸»æœº B æ—¶ï¼Œé¦–å…ˆä¼šåœ¨è‡ªå·±çš„ ARP ç¼“å­˜ä¸­æŸ¥æ‰¾ä¸»æœº B çš„ MAC åœ°å€ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œä¸»æœº A ä¼šå‘ç½‘ç»œä¸­å¹¿æ’­ä¸€ä¸ª ARP è¯·æ±‚æ•°æ®åŒ…ï¼Œè¯·æ±‚ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºå‘Šè¯‰å®ƒä»¬çš„ MAC åœ°å€ï¼›è¿™ä¸ªè¯·æ±‚åŒ…å«äº†è¯·æ±‚è®¾å¤‡å’Œç›®æ ‡è®¾å¤‡çš„ IP å’Œ MAC åœ°å€ã€‚ ARPåº”ç­”ï¼šç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºéƒ½ä¼šæ”¶åˆ°è¿™ä¸ª ARP è¯·æ±‚ï¼Œä½†åªæœ‰ä¸»æœº B ä¼šå›å¤ ARP åº”ç­”ï¼Œå‘Šè¯‰ä¸»æœº A è‡ªå·±çš„ MAC åœ°å€ã€‚å¹¶ä¸”ä¸»æœº B ä¼šå°†ä¸»æœº A çš„ IP å’Œ MAC åœ°å€æ˜ å°„å…³ç³»ç¼“å­˜åˆ°è‡ªå·±çš„ ARP ç¼“å­˜ä¸­ï¼Œä»¥ä¾¿ä¸‹æ¬¡é€šä¿¡æ—¶ç›´æ¥ä½¿ç”¨ã€‚ æ•°æ®ä¼ è¾“ï¼šåœ¨è·å¾—ä¸»æœºBçš„MACåœ°å€åï¼Œä¸»æœºAï¼ˆä¹Ÿä¼šå°†ä¸»æœº B çš„ IP å’Œ MAC åœ°å€æ˜ å°„å…³ç³»ç¼“å­˜åˆ°è‡ªå·±çš„ ARP ç¼“å­˜ä¸­ï¼‰å°±å¯ä»¥å°†ç›®æ ‡MACåœ°å€è®¾ç½®ä¸ºä¸»æœºBçš„MACåœ°å€ï¼Œä»è€Œæ­£ç¡®åœ°æ„å»ºä»¥å¤ªç½‘å¸§å¹¶å‘é€åˆ°å±€åŸŸç½‘ä¸­ï¼Œè¿™äº›æ•°æ®å¸§ä¼šé€šè¿‡äº¤æ¢æœºæˆ–é›†çº¿å™¨ç­‰ç½‘ç»œè®¾å¤‡æ­£ç¡®åœ°ä¼ é€åˆ°ä¸»æœºBã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:5","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.6 ä¸ºä»€ä¹ˆæ—¢æœ‰ IP åœ°å€ï¼Œåˆæœ‰ MAC åœ°å€ï¼Ÿ MAC åœ°å€å’Œ IP åœ°å€éƒ½æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ MAC åœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯å†™åœ¨ç½‘å¡ä¸Šçš„ç‰©ç†åœ°å€ï¼Œç”¨æ¥å®šä¹‰ç½‘ç»œè®¾å¤‡çš„ä½ç½®ï¼Œä¸å¯å˜æ›´ã€‚ IP åœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€ã€‚IP åœ°å€ç”¨æ¥åŒºåˆ«ç½‘ç»œä¸Šçš„è®¡ç®—æœºã€‚ ä¸ºä»€ä¹ˆæœ‰äº† MAC åœ°å€è¿˜éœ€è¦ IP åœ°å€ï¼Ÿ å¦‚æœæˆ‘ä»¬åªä½¿ç”¨ MAC åœ°å€è¿›è¡Œå¯»å€çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦è·¯ç”±å™¨è®°ä½æ¯ä¸ª MAC åœ°å€å±äºå“ªä¸ªå­ç½‘ï¼Œä¸ç„¶ä¸€æ¬¡è·¯ç”±å™¨æ”¶åˆ°æ•°æ®åŒ…éƒ½è¦æ»¡ä¸–ç•Œå¯»æ‰¾ç›®çš„ MAC åœ°å€ã€‚è€Œæˆ‘ä»¬çŸ¥é“ MAC åœ°å€çš„é•¿åº¦ä¸º 48 ä½ï¼Œä¹Ÿå°±æ˜¯æœ€å¤šå…±æœ‰ 2 çš„ 48 æ¬¡æ–¹ä¸ª MAC åœ°å€ï¼Œè¿™å°±æ„å‘³ç€æ¯ä¸ªè·¯ç”±å™¨éœ€è¦ 256T çš„å†…å­˜ï¼Œæ˜¾ç„¶æ˜¯ä¸ç°å®çš„ã€‚ å’Œ MAC åœ°å€ä¸åŒï¼ŒIP åœ°å€æ˜¯å’Œåœ°åŸŸç›¸å…³çš„ï¼Œåœ¨ä¸€ä¸ªå­ç½‘ä¸­çš„è®¾å¤‡ï¼Œæˆ‘ä»¬ç»™å…¶åˆ†é…çš„ IP åœ°å€å‰ç¼€éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ ·è·¯ç”±å™¨å°±èƒ½æ ¹æ® IP åœ°å€çš„å‰ç¼€çŸ¥é“è¿™ä¸ªè®¾å¤‡å±äºå“ªä¸ªå­ç½‘ï¼Œå‰©ä¸‹çš„å¯»å€å°±äº¤ç»™å­ç½‘å†…éƒ¨å®ç°ï¼Œä»è€Œå¤§å¤§å‡å°‘äº†è·¯ç”±å™¨æ‰€éœ€è¦çš„å†…å­˜ã€‚ ä¸ºä»€ä¹ˆæœ‰äº† IP åœ°å€è¿˜éœ€è¦ MAC åœ°å€ï¼Ÿ åªæœ‰å½“è®¾å¤‡è¿å…¥ç½‘ç»œæ—¶ï¼Œæ‰èƒ½æ ¹æ®ä»–è¿›å…¥äº†å“ªä¸ªå­ç½‘æ¥ä¸ºå…¶åˆ†é… IP åœ°å€ï¼Œåœ¨è®¾å¤‡è¿˜æ²¡æœ‰ IP åœ°å€çš„æ—¶å€™ï¼Œæˆ–è€…åœ¨åˆ†é… IP çš„è¿‡ç¨‹ä¸­ã€‚æˆ‘ä»¬éœ€è¦ MAC åœ°å€æ¥åŒºåˆ†ä¸åŒçš„è®¾å¤‡ã€‚ IP åœ°å€å¯ä»¥æ¯”ä½œä¸ºåœ°å€ï¼ŒMAC åœ°å€ä¸ºæ”¶ä»¶äººï¼Œåœ¨ä¸€æ¬¡é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä¸¤è€…æ˜¯ç¼ºä¸€ä¸å¯çš„ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:6","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.7 ICMP åè®®çš„åŠŸèƒ½ï¼Ÿ ICMPï¼ˆInternet Control Message Protocolï¼Œç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ï¼‰ æ˜¯ç”¨äºåœ¨IPç½‘ç»œä¸­ä¼ é€’æ§åˆ¶å’Œé”™è¯¯ä¿¡æ¯çš„åè®®ã€‚å®ƒæ˜¯åœ¨ç½‘ç»œå±‚ï¼ˆOSIæ¨¡å‹çš„ç¬¬ä¸‰å±‚ï¼‰ä¹‹ä¸Šè¿è¡Œçš„åè®®ï¼Œä¸»è¦ç”¨äºåœ¨IPç½‘ç»œä¸­è¿›è¡Œè¯Šæ–­ã€é”™è¯¯æŠ¥å‘Šå’Œæ§åˆ¶æ¶ˆæ¯çš„ä¼ é€’ã€‚ICMPåè®®çš„åŠŸèƒ½åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç‚¹ï¼š é”™è¯¯æŠ¥å‘Šï¼šICMPç”¨äºå‘å‘é€è€…æŠ¥å‘Šç½‘ç»œå±‚å‘ç”Ÿçš„é”™è¯¯ï¼Œä¾‹å¦‚ç›®æ ‡ä¸å¯è¾¾ã€è¶…æ—¶ã€è·¯ç”±å™¨å‘ç”Ÿæ•…éšœç­‰ã€‚ è·¯ç”±å™¨å‘ç°ï¼šICMPå¯ç”¨äºè·¯ç”±å™¨çš„å‘ç°å’Œé…ç½®ï¼Œä¾‹å¦‚è·¯ç”±å™¨é€šå‘Šæ¶ˆæ¯ï¼ˆRouter Advertisementï¼‰å’Œè·¯ç”±å™¨è¯·æ±‚æ¶ˆæ¯ï¼ˆRouter Solicitationï¼‰ã€‚ Pingæµ‹è¯•ï¼šICMPçš„Echoè¯·æ±‚å’ŒEchoåº”ç­”æ¶ˆæ¯è¢«ç”¨äºPingæµ‹è¯•ï¼Œä»¥æµ‹è¯•ä¸»æœºä¹‹é—´çš„è¿é€šæ€§å’Œå»¶è¿Ÿã€‚ TTLè¿‡æœŸï¼šICMPçš„TTLï¼ˆTime to Liveï¼‰è¿‡æœŸæ¶ˆæ¯ç”¨äºæŠ¥å‘Šæ•°æ®åŒ…åœ¨ç½‘ç»œä¸­è¢«ä¸¢å¼ƒçš„æƒ…å†µï¼Œé€šå¸¸ç”±äºæ•°æ®åŒ…åœ¨è½¬å‘è¿‡ç¨‹ä¸­è¶…è¿‡äº†å…¶TTLå€¼ã€‚ ç‰‡æ®µè¶…æ—¶ï¼šICMPçš„ç‰‡æ®µè¶…æ—¶æ¶ˆæ¯ç”¨äºæŠ¥å‘ŠIPæ•°æ®æŠ¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ä¸¢å¼ƒçš„æƒ…å†µï¼Œé€šå¸¸ç”±äºæ•°æ®åŒ…ç‰‡æ®µæœªèƒ½åœ¨è¶…æ—¶æ—¶é—´å†…åˆ°è¾¾ç›®çš„åœ°è€Œè¢«ä¸¢å¼ƒã€‚ é‡å®šå‘ï¼šICMPçš„é‡å®šå‘æ¶ˆæ¯ç”¨äºå‘ŠçŸ¥å‘é€è€…ä¿®æ”¹å…¶è·¯ç”±è¡¨ä»¥æ”¹è¿›æ•°æ®åŒ…çš„è½¬å‘æ•ˆç‡ã€‚ MTUæ¢æµ‹ï¼šICMPçš„è·¯å¾„MTUæ¢æµ‹ï¼ˆPath MTU Discoveryï¼‰ç”¨äºå‘ç°é€šå‘ç›®æ ‡ä¸»æœºçš„æœ€å¤§ä¼ è¾“å•å…ƒï¼ˆMTUï¼‰ä»¥é¿å…åˆ†ç‰‡ã€‚ å¤šæ’­/ä»»æ’­æµ‹è¯•ï¼šICMPç”¨äºè¿›è¡Œå¤šæ’­å’Œä»»æ’­åœ°å€çš„æµ‹è¯•å’Œè¯Šæ–­ã€‚ æ¯”å¦‚æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨å¾—æ¯”è¾ƒå¤šçš„ pingï¼Œå°±æ˜¯åŸºäº ICMP çš„ã€‚ åœ¨ IP é€šä¿¡ä¸­å¦‚æœæŸä¸ª IP åŒ…å› ä¸ºæŸç§åŸå› æœªèƒ½è¾¾åˆ°ç›®æ ‡åœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸ªå…·ä½“çš„åŸå› å°†ç”± ICMP è´Ÿè´£é€šçŸ¥ã€‚ ICMP æŠ¥æ–‡æ˜¯å°è£…åœ¨ IP åŒ…é‡Œé¢ï¼Œå®ƒå·¥ä½œåœ¨ç½‘ç»œå±‚ï¼Œæ˜¯ IP åè®®çš„åŠ©æ‰‹ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:7","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.8 pingçš„å·¥ä½œåŸç† pingï¼ŒPacket Internet Groperï¼Œä¸€ä¸ªç½‘ç»œå·¥å…·ï¼Œä¸»è¦ç”¨æ¥æµ‹è¯•ç½‘ç»œè¿æ¥çš„å¯è¾¾æ€§å’Œå»¶è¿Ÿã€‚ ping çš„è¿‡ç¨‹ä¸»è¦åŸºäº ICMPï¼ˆInternet Control Message Protocolï¼Œäº’è”ç½‘æ§åˆ¶æ¶ˆæ¯åè®®ï¼‰å®ç°ï¼Œå…¶åŸºæœ¬è¿‡ç¨‹åŒ…æ‹¬ï¼š å½“æ‰§è¡Œ Ping å‘½ä»¤ï¼Œå¦‚ping www.google.comï¼ŒPing é¦–å…ˆè§£æåŸŸåè·å– IP åœ°å€ï¼Œç„¶åå‘ç›®æ ‡ IP å‘é€ä¸€ä¸ª ICMP Echo Request æ¶ˆæ¯ã€‚ å½“ç›®æ ‡ IP æ”¶åˆ° ICMP Echo Request æ¶ˆæ¯åï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ª ICMP Echo Reply æ¶ˆæ¯å¹¶è¿”å›ï¼Œå³ Ping å“åº”æ¶ˆæ¯ã€‚ å‘èµ· Ping å‘½ä»¤çš„è®¾å¤‡æ¥æ”¶åˆ° ICMP Echo Reply æ¶ˆæ¯åï¼Œè®¡ç®—å¹¶æ˜¾ç¤ºä»å‘é€ Echo Request åˆ°æ¥æ”¶åˆ° Echo Reply çš„æ—¶é—´ï¼ˆé€šå¸¸ç§°ä¸ºå¾€è¿”æ—¶é—´ RTTï¼ŒRound-Trip Timeï¼‰ï¼Œä»¥åŠå¯èƒ½çš„ä¸¢åŒ…æƒ…å†µã€‚ Ping é€šå¸¸ä¼šå‘é€å¤šä¸ªè¯·æ±‚ï¼Œä»¥ä¾¿æä¾›å¹³å‡å“åº”æ—¶é—´å’Œä¸¢åŒ…ç‡ç­‰ä¿¡æ¯ï¼Œä»¥ä¾¿æˆ‘ä»¬äº†è§£ç½‘ç»œè¿æ¥çš„è´¨é‡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:8","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.9 æ–­ç½‘äº†ï¼Œè¿˜èƒ½pingé€š127.0.0.1å—ï¼Ÿ é€šå¸¸æƒ…å†µä¸‹ï¼Œå³ä½¿ç½‘ç»œè¿æ¥æ–­å¼€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å›ç¯æ¥å£ï¼ˆLoopback Interfaceï¼‰pingé€šæœ¬åœ°ä¸»æœºçš„å›ç¯åœ°å€127.0.0.1ã€‚å›ç¯åœ°å€æ˜¯æœ¬åœ°ä¸»æœºè‡ªèº«çš„è™šæ‹Ÿç½‘ç»œæ¥å£ï¼Œç”¨äºåœ¨æœ¬åœ°ä¸»æœºå†…éƒ¨è¿›è¡Œé€šä¿¡ï¼Œä¸ç»è¿‡ç‰©ç†ç½‘ç»œè®¾å¤‡ï¼Œå› æ­¤å³ä½¿ç½‘ç»œæ–­å¼€ä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œã€‚ å›ç¯æ¥å£æ˜¯ç½‘ç»œåè®®æ ˆä¸­çš„ä¸€ä¸ªè™šæ‹Ÿæ¥å£ï¼Œç”¨äºæ¨¡æ‹Ÿæ•°æ®åœ¨ç½‘ç»œä¸­çš„ä¼ è¾“ã€‚å½“æ•°æ®å‘é€åˆ°å›ç¯åœ°å€æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†æ•°æ®ç›´æ¥ä¼ è¾“ç»™å›ç¯æ¥å£ï¼Œç„¶åå†ä»å›ç¯æ¥å£å‘é€åˆ°ç›®æ ‡åœ°å€ï¼Œå®ç°äº†æ•°æ®çš„å›ç¯ä¼ è¾“ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:9","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"7.10 å’Œ localhost ä»¥åŠ 0.0.0.0 æœ‰åŒºåˆ«å— 127.0.0.1ï¼š127.0.0.1æ˜¯å›ç¯åœ°å€ï¼ˆLoopback Addressï¼‰ï¼Œé€šå¸¸ç”¨äºæœ¬åœ°ä¸»æœºå†…éƒ¨è¿›è¡Œé€šä¿¡ã€‚å½“æ•°æ®å‘é€åˆ°127.0.0.1æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†æ•°æ®ä¼ è¾“ç»™å›ç¯æ¥å£ï¼Œç„¶åå†ä»å›ç¯æ¥å£å‘é€åˆ°ç›®æ ‡åœ°å€ï¼Œå®ç°äº†æ•°æ®çš„å›ç¯ä¼ è¾“ã€‚127.0.0.1å§‹ç»ˆæŒ‡å‘æœ¬åœ°ä¸»æœºè‡ªèº«ï¼Œä¸ä¼šé€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œç”¨äºæµ‹è¯•æœ¬åœ°ä¸»æœºçš„ç½‘ç»œåè®®æ ˆæ˜¯å¦æ­£å¸¸å·¥ä½œä»¥åŠç½‘ç»œæœåŠ¡æ˜¯å¦å¯ç”¨ã€‚ localhostï¼šlocalhostæ˜¯ä¸€ä¸ªä¸»æœºåï¼ˆHostnameï¼‰ï¼Œé€šå¸¸æ˜ å°„åˆ°å›ç¯åœ°å€127.0.0.1ã€‚å½“åœ¨è®¡ç®—æœºä¸Šä½¿ç”¨localhostæ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨ä½¿ç”¨å›ç¯åœ°å€127.0.0.1ï¼Œç”¨äºè®¿é—®æœ¬åœ°ä¸»æœºä¸Šçš„ç½‘ç»œæœåŠ¡ã€‚localhostæ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œæ ‡è¯†ç¬¦ï¼Œç”¨äºæŒ‡ä»£æœ¬åœ°ä¸»æœºã€‚ 0.0.0.0ï¼š0.0.0.0æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„IPåœ°å€ï¼Œé€šå¸¸ç”¨äºè¡¨ç¤ºä»»æ„ä¸»æœºæˆ–ä»»æ„åœ°å€ã€‚å½“æœåŠ¡å™¨é…ç½®ä¸ºç›‘å¬0.0.0.0æ—¶ï¼Œè¡¨ç¤ºå®ƒå°†æ¥å—æ¥è‡ªä»»ä½•IPåœ°å€çš„è¿æ¥ï¼Œå¯ä»¥ç”¨äºåœ¨æ‰€æœ‰å¯ç”¨ç½‘ç»œæ¥å£ä¸Šç›‘å¬æœåŠ¡ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ0.0.0.0ä¹Ÿç”¨äºæŒ‡ç¤ºç›®æ ‡åœ°å€æœªæŒ‡å®šæˆ–æœªçŸ¥ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:7:10","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"8 ç½‘ç»œå®‰å…¨ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:8:0","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"8.1 è¯´è¯´æœ‰å“ªäº›å®‰å…¨æ”»å‡»ï¼Ÿ ç»œå®‰å…¨æ”»å‡»ä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œè¢«åŠ¨æ”»å‡»å’Œä¸»åŠ¨æ”»å‡» è¢«åŠ¨æ”»å‡»ï¼šæ˜¯æŒ‡æ”»å‡»è€…ä»ç½‘ç»œä¸Šçªƒå¬ä»–äººçš„é€šä¿¡å†…å®¹ï¼Œé€šå¸¸æŠŠè¿™ç±»æ”»å‡»ç§°ä¸ºæˆªè·ï¼Œè¢«åŠ¨æ”»å‡»ä¸»è¦æœ‰ä¸¤ç§å½¢å¼ï¼šæ¶ˆæ¯å†…å®¹æ³„éœ²æ”»å‡»å’Œæµé‡åˆ†ææ”»å‡»ã€‚ç”±äºæ”»å‡»è€…æ²¡æœ‰ä¿®æ”¹æ•°æ®ï¼Œä½¿å¾—è¿™ç§æ”»å‡»å¾ˆéš¾è¢«æ£€æµ‹åˆ°ã€‚ ä¸»åŠ¨æ”»å‡»ï¼šç›´æ¥å¯¹ç°æœ‰çš„æ•°æ®å’ŒæœåŠ¡é€ æˆå½±å“ï¼Œå¸¸è§çš„ä¸»åŠ¨æ”»å‡»ç±»å‹æœ‰ï¼š ç¯¡æ”¹ï¼šæ”»å‡»è€…æ•…æ„ç¯¡æ”¹ç½‘ç»œä¸Šé€çš„æŠ¥æ–‡ï¼Œç”šè‡³æŠŠå®Œå…¨ä¼ªé€ çš„æŠ¥æ–‡ä¼ é€ç»™æ¥æ”¶æ–¹ã€‚ æ¶æ„ç¨‹åºï¼šæ¶æ„ç¨‹åºç§ç±»ç¹å¤šï¼ŒåŒ…æ‹¬è®¡ç®—æœºç—…æ¯’ã€è®¡ç®—æœºè •è™«ã€ç‰¹æ´›ä¼Šæœ¨é©¬ã€åé—¨å…¥ä¾µã€æµæ°“è½¯ä»¶ç­‰ç­‰ã€‚ æ‹’ç»æœåŠ¡ Dosï¼šæ”»å‡»è€…å‘æœåŠ¡å™¨ä¸åœåœ°å‘é€åˆ†ç»„ï¼Œä½¿æœåŠ¡å™¨æ— æ³•æä¾›æ­£å¸¸æœåŠ¡ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:8:1","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"8.2 DNS åŠ«æŒäº†è§£å—ï¼Ÿ DNSåŠ«æŒæ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»ï¼Œé€šè¿‡ç¯¡æ”¹DNSï¼ˆDomain Name Systemï¼‰è§£æç»“æœæ¥åŠ«æŒç”¨æˆ·çš„ç½‘ç»œæµé‡ã€‚DNSåŠ«æŒæ”»å‡»è€…ä¼šä¿®æ”¹DNSè§£æè¯·æ±‚æˆ–å“åº”ï¼Œå°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ¬ºéª—é¡µé¢ã€‚ DNSåŠ«æŒå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š æœ¬åœ°DNSåŠ«æŒï¼šæ”»å‡»è€…åœ¨å—å®³è€…è®¡ç®—æœºæˆ–ç½‘ç»œä¸­æ¤å…¥æ¶æ„è½¯ä»¶ï¼Œä½¿å…¶ä¿®æ”¹æœ¬åœ°ä¸»æœºçš„DNSè®¾ç½®ï¼Œå°†åˆæ³•çš„DNSæœåŠ¡å™¨æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„æ¶æ„DNSæœåŠ¡å™¨ã€‚ è·¯ç”±å™¨DNSåŠ«æŒï¼šæ”»å‡»è€…å…¥ä¾µè·¯ç”±å™¨æˆ–è€…é€šè¿‡ç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µè·å–è·¯ç”±å™¨ç®¡ç†æƒé™ï¼Œç„¶åä¿®æ”¹è·¯ç”±å™¨çš„DNSè®¾ç½®ï¼Œä½¿å…¶æŒ‡å‘æ¶æ„DNSæœåŠ¡å™¨ã€‚ ISPçº§åˆ«çš„DNSåŠ«æŒï¼šæ”»å‡»è€…æ§åˆ¶äº†å—å®³è€…æ‰€ä½¿ç”¨çš„ISPï¼ˆInternet Service Providerï¼Œäº’è”ç½‘æœåŠ¡æä¾›å•†ï¼‰çš„DNSæœåŠ¡å™¨ï¼Œé€šè¿‡ç¯¡æ”¹ISPçš„DNSè§£æç»“æœæ¥å®ç°DNSåŠ«æŒã€‚ ä¸­é—´äººæ”»å‡»ï¼šæ”»å‡»è€…é€šè¿‡ä¸­é—´äººæ”»å‡»æ‹¦æˆªDNSè¯·æ±‚æˆ–å“åº”ï¼Œç„¶åç¯¡æ”¹å…¶ä¸­çš„åŸŸåè§£æç»“æœï¼Œå°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ¬ºéª—é¡µé¢ã€‚ æ€ä¹ˆåº”å¯¹ DNS åŠ«æŒï¼Ÿ ç›´æ¥é€šè¿‡ IP åœ°å€è®¿é—®ç½‘ç«™ï¼Œé¿å¼€ DNS åŠ«æŒ ç”±äºåŸŸååŠ«æŒå¾€å¾€åªèƒ½åœ¨ç‰¹å®šçš„ç½‘ç»œèŒƒå›´å†…è¿›è¡Œï¼Œå› æ­¤ä¸€äº›é«˜çº§ç”¨æˆ·å¯ä»¥é€šè¿‡ç½‘ç»œè®¾ç½®è®© DNS æŒ‡å‘æ­£å¸¸çš„åŸŸåæœåŠ¡å™¨ä»¥å®ç°å¯¹ç›®æ ‡ç½‘å€çš„æ­£å¸¸è®¿é—®ï¼Œä¾‹å¦‚è®¡ç®—æœºé¦–é€‰ DNS æœåŠ¡å™¨çš„åœ°å€å›ºå®šä¸º 8.8.8.8ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:8:2","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"8.3 ä»€ä¹ˆæ˜¯ CSRF æ”»å‡»ï¼Ÿå¦‚ä½•é¿å…ï¼Ÿ CSRFï¼ˆCross-Site Request Forgeryï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ”»å‡»æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨æ”»å‡»ï¼Œåˆ©ç”¨ç”¨æˆ·åœ¨å·²è®¤è¯çš„Webåº”ç”¨ç¨‹åºä¸Šçš„èº«ä»½éªŒè¯ä¿¡æ¯æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚æ”»å‡»è€…é€šè¿‡è¯±ä½¿å—å®³è€…åœ¨è®¿é—®åŒ…å«æ¶æ„ä»£ç çš„ç½‘é¡µæ—¶ï¼Œè§¦å‘å‘ç›®æ ‡ç½‘ç«™å‘é€è¯·æ±‚çš„è¡Œä¸ºï¼Œä»è€Œåœ¨ç”¨æˆ·ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ“ä½œï¼Œå¦‚è½¬è´¦ã€æ›´æ”¹å¯†ç ç­‰ã€‚ CSRFæ”»å‡»é€šå¸¸åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š æ”»å‡»è€…å‡†å¤‡å¥½ä¸€ä¸ªåŒ…å«æ¶æ„è¯·æ±‚çš„é¡µé¢ï¼Œä¾‹å¦‚ä¸€ä¸ªé’“é±¼ç½‘ç«™æˆ–è€…æ³¨å…¥äº†æ¶æ„ä»£ç çš„å¹¿å‘Šã€‚ å—å®³è€…åœ¨å·²ç»ç™»å½•çš„æƒ…å†µä¸‹è®¿é—®äº†åŒ…å«æ¶æ„è¯·æ±‚çš„é¡µé¢ã€‚ å—å®³è€…çš„æµè§ˆå™¨è‡ªåŠ¨å‘é€äº†è¢«ä¼ªé€ çš„è¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç”±äºå—å®³è€…å·²ç»åœ¨ç›®æ ‡ç½‘ç«™ç™»å½•ï¼Œå› æ­¤è¯·æ±‚è¢«è®¤ä¸ºæ˜¯åˆæ³•çš„ï¼Œä»è€Œæ‰§è¡Œäº†æ”»å‡»è€…çš„æ“ä½œã€‚ è¦é˜²æ­¢CSRFæ”»å‡»ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š ä½¿ç”¨CSRF Tokenï¼šåœ¨Webåº”ç”¨ç¨‹åºä¸­å¼•å…¥CSRF Tokenï¼Œç¡®ä¿æ¯ä¸ªè¯·æ±‚éƒ½åŒ…å«ä¸€ä¸ªéšæœºç”Ÿæˆçš„Tokenï¼Œå¹¶åœ¨æœåŠ¡ç«¯éªŒè¯Tokençš„æœ‰æ•ˆæ€§ã€‚æ”»å‡»è€…æ— æ³•è·å–åˆ°æœ‰æ•ˆçš„CSRF Tokenï¼Œå› æ­¤æ— æ³•ä¼ªé€ æœ‰æ•ˆçš„è¯·æ±‚ã€‚ æ£€æŸ¥Refererå¤´ï¼šWebåº”ç”¨ç¨‹åºå¯ä»¥æ£€æŸ¥è¯·æ±‚çš„Refererå¤´ï¼Œç¡®ä¿è¯·æ±‚æ¥è‡ªåˆæ³•çš„æ¥æºã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRefererå¤´å¯èƒ½ä¼šè¢«ç¯¡æ”¹æˆ–è€…ç¼ºå¤±ï¼Œå› æ­¤ä¸èƒ½å•ç‹¬ä¾èµ–Refererå¤´æ¥é˜²æ­¢CSRFæ”»å‡»ã€‚ é™åˆ¶æ•æ„Ÿæ“ä½œï¼šå¯¹äºæ¶‰åŠåˆ°æ•æ„Ÿæ“ä½œçš„è¯·æ±‚ï¼Œåº”è¯¥è¦æ±‚ç”¨æˆ·è¾“å…¥é¢å¤–çš„èº«ä»½éªŒè¯ä¿¡æ¯ï¼Œä¾‹å¦‚å¯†ç ã€éªŒè¯ç ç­‰ï¼Œä»¥å¢åŠ æ”»å‡»è€…æ‰§è¡ŒCSRFæ”»å‡»çš„éš¾åº¦ã€‚ ä½¿ç”¨SameSiteå±æ€§ï¼šåœ¨è®¾ç½®Cookieæ—¶ï¼Œå¯ä»¥ä½¿ç”¨SameSiteå±æ€§æ¥é™åˆ¶Cookieçš„å‘é€ï¼Œé˜²æ­¢ç¬¬ä¸‰æ–¹ç½‘ç«™æºå¸¦Cookieå‘é€CSRFæ”»å‡»ã€‚å¯ä»¥å°†Cookieè®¾ç½®ä¸ºSameSite=Strictæˆ–è€…SameSite=Laxï¼Œä»¥é™åˆ¶Cookieä»…åœ¨åŒæºè¯·æ±‚ä¸­å‘é€ã€‚ å®šæœŸå®¡æŸ¥å’Œæ›´æ–°ä»£ç ï¼šå®šæœŸå®¡æŸ¥å’Œæ›´æ–°Webåº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä¿®è¡¥å·²çŸ¥çš„å®‰å…¨æ¼æ´ï¼Œå¹¶éµå¾ªå®‰å…¨æœ€ä½³å®è·µï¼Œä»¥å‡å°‘CSRFæ”»å‡»çš„é£é™©ã€‚ æ·»åŠ æ ¡éªŒ tokenï¼šä»¥åœ¨ HTTP è¯·æ±‚ä¸­ä»¥å‚æ•°çš„å½¢å¼åŠ å…¥ä¸€ä¸ªéšæœºäº§ç”Ÿçš„ tokenï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯å»ºç«‹ä¸€ä¸ªæ‹¦æˆªå™¨æ¥éªŒè¯è¿™ä¸ª tokenï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰ token æˆ–è€… token å†…å®¹ä¸æ­£ç¡®ï¼Œåˆ™è®¤ä¸ºå¯èƒ½æ˜¯ CSRF æ”»å‡»è€Œæ‹’ç»è¯¥è¯·æ±‚ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:8:3","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"8.4 ä»€ä¹ˆæ˜¯ DoSã€DDoSã€DRDoS æ”»å‡»ï¼Ÿ DoSï¼ˆDenial of Serviceï¼Œæ‹’ç»æœåŠ¡ï¼‰æ”»å‡»ã€DDoSï¼ˆDistributed Denial of Serviceï¼Œåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ï¼‰æ”»å‡»å’ŒDRDoSï¼ˆDistributed Reflection Denial of Serviceï¼Œåˆ†å¸ƒå¼åå°„æ‹’ç»æœåŠ¡ï¼‰æ”»å‡»éƒ½æ˜¯é’ˆå¯¹ç½‘ç»œæœåŠ¡çš„æ”»å‡»æ‰‹æ³•ï¼Œæ—¨åœ¨ä½¿ç›®æ ‡ç³»ç»Ÿæ— æ³•æ­£å¸¸æä¾›æœåŠ¡ï¼Œä»è€Œå¯¼è‡´æœåŠ¡ä¸å¯ç”¨æˆ–ä¸¥é‡å—æŸã€‚ DoS æ”»å‡»ï¼šDoSæ”»å‡»æ˜¯ç”±å•ä¸ªæ”»å‡»è€…å‘èµ·çš„æ”»å‡»ï¼Œé€šè¿‡å‘ç›®æ ‡ç³»ç»Ÿå‘é€å¤§é‡çš„è¯·æ±‚æˆ–è€…æ¶æ„æ•°æ®åŒ…ï¼Œè€—å°½ç›®æ ‡ç³»ç»Ÿçš„èµ„æºï¼ˆå¦‚å¸¦å®½ã€å¤„ç†èƒ½åŠ›ã€å­˜å‚¨ç©ºé—´ç­‰ï¼‰ï¼Œä»è€Œä½¿æ­£å¸¸ç”¨æˆ·æ— æ³•è®¿é—®æˆ–ä½¿ç”¨ç›®æ ‡ç³»ç»Ÿçš„æœåŠ¡ã€‚DoSæ”»å‡»å¯ä»¥é‡‡ç”¨å¤šç§æ‰‹æ®µå®ç°ï¼ŒåŒ…æ‹¬ç½‘ç»œå±‚æ”»å‡»ï¼ˆå¦‚SYN Floodã€UDP Floodï¼‰ã€åº”ç”¨å±‚æ”»å‡»ï¼ˆå¦‚HTTP Floodã€Slowlorisæ”»å‡»ï¼‰ç­‰ã€‚ DDoS æ”»å‡»ï¼šDDoSæ”»å‡»æ˜¯ç”±å¤šä¸ªæ”»å‡»è€…ååŒå‘èµ·çš„æ”»å‡»ï¼Œé€šè¿‡åˆ†å¸ƒåœ¨å…¨çƒå„åœ°çš„å¤§é‡â€œåƒµå°¸â€è®¡ç®—æœºï¼ˆä¹Ÿç§°ä¸ºâ€œè‚‰é¸¡â€æˆ–â€œåƒµå°¸ç½‘ç»œâ€ï¼‰å‘ç›®æ ‡ç³»ç»Ÿå‘é€å¤§é‡çš„è¯·æ±‚æˆ–è€…æ¶æ„æ•°æ®åŒ…ï¼Œé€ æˆç›®æ ‡ç³»ç»Ÿè¿‡è½½ï¼Œä»è€Œä½¿å…¶æ— æ³•æ­£å¸¸æä¾›æœåŠ¡ã€‚DDoSæ”»å‡»é€šå¸¸è§„æ¨¡æ›´å¤§ã€æ›´éš¾ä»¥åº”å¯¹ï¼Œå› ä¸ºæ”»å‡»æµé‡æ¥è‡ªäºå¤šä¸ªæ¥æºï¼Œå¹¶ä¸”æ”»å‡»è€…å¯ä»¥å¾ˆå®¹æ˜“åœ°æ§åˆ¶å’Œä¼ªè£…æ”»å‡»æµé‡çš„æ¥æºã€‚ DRDoS æ”»å‡»ï¼šDRDoSæ”»å‡»æ˜¯ä¸€ç§åˆ©ç”¨ç¬¬ä¸‰æ–¹ç³»ç»Ÿçš„èµ„æºåå°„æ”»å‡»ç›®æ ‡ç³»ç»Ÿçš„æ”»å‡»æ–¹å¼ã€‚æ”»å‡»è€…å‘ç¬¬ä¸‰æ–¹ç³»ç»Ÿå‘é€è¯·æ±‚ï¼Œä¼ªè£…æˆç›®æ ‡ç³»ç»Ÿçš„IPåœ°å€ï¼Œå¹¶è¯·æ±‚è¿”å›å¤§é‡çš„å“åº”æ•°æ®ï¼Œè¿™äº›å“åº”æ•°æ®ä¼šå‘é€åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œé€ æˆç›®æ ‡ç³»ç»Ÿçš„è¿‡è½½ã€‚DRDoSæ”»å‡»åˆ©ç”¨äº†ç¬¬ä¸‰æ–¹ç³»ç»Ÿçš„åå°„å“åº”ç‰¹æ€§ï¼Œä½¿æ”»å‡»è€…èƒ½å¤Ÿè½»æ˜“åœ°æ”¾å¤§æ”»å‡»æµé‡ï¼Œå¹¶ä¸”å¾ˆéš¾è¿½æº¯åˆ°æ”»å‡»è€…çš„çœŸå®èº«ä»½ã€‚ å¦‚ä½•é˜²èŒƒ DDoS? é’ˆå¯¹ DDoS ä¸­çš„æµé‡æ”»å‡»ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•æ˜¯å¢åŠ å¸¦å®½ï¼Œç†è®ºä¸Šåªè¦å¸¦å®½å¤§äºæ”»å‡»æµé‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æˆæœ¬éå¸¸é«˜ã€‚åœ¨æœ‰å……è¶³å¸¦å®½çš„å‰æä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡æå‡è·¯ç”±å™¨ã€ç½‘å¡ã€äº¤æ¢æœºç­‰ç¡¬ä»¶è®¾æ–½çš„é…ç½®ã€‚ é’ˆå¯¹èµ„æºè€—å°½æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥å‡çº§ä¸»æœºæœåŠ¡å™¨ç¡¬ä»¶ï¼Œåœ¨ç½‘ç»œå¸¦å®½å¾—åˆ°ä¿è¯çš„å‰æä¸‹ï¼Œä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿæœ‰æ•ˆå¯¹æŠ—æµ·é‡çš„ SYN æ”»å‡»åŒ…ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å®‰è£…ä¸“ä¸šçš„æŠ— DDoS é˜²ç«å¢™ï¼Œä»è€Œå¯¹æŠ— SYN Flood ç­‰æµé‡å‹æ”»å‡»ã€‚ç“·ç¢—ï¼Œè´Ÿè½½å‡è¡¡ï¼ŒCDN ç­‰æŠ€æœ¯éƒ½èƒ½æœ‰æ•ˆå¯¹æŠ— DDos æ”»å‡»ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:8:4","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"8.5 ä»€ä¹ˆæ˜¯ XSS æ”»å‡»ï¼Œå¦‚ä½•é¿å…? XSSï¼ˆCross-Site Scriptingï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œå®‰å…¨æ”»å‡»ï¼Œæ”»å‡»è€…é€šè¿‡åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œæ¥æ‰§è¡Œæ¶æ„æ“ä½œã€‚è¿™äº›è„šæœ¬é€šå¸¸ä»¥HTMLã€JavaScriptç­‰å½¢å¼å­˜åœ¨ï¼Œå¯ä»¥çªƒå–ç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ã€ç¯¡æ”¹ç½‘é¡µå†…å®¹ã€é‡å®šå‘ç”¨æˆ·åˆ°æ¶æ„ç½‘ç«™ç­‰ã€‚XSSæ”»å‡»é€šå¸¸åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ï¼š å­˜å‚¨å‹ XSSï¼šæ”»å‡»è€…å°†æ¶æ„è„šæœ¬å­˜å‚¨åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ï¼Œå½“ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„è„šæœ¬çš„é¡µé¢æ—¶ï¼Œè„šæœ¬ä¼šä»æœåŠ¡å™¨ç«¯åŠ è½½å¹¶æ‰§è¡Œã€‚ åå°„å‹ XSSï¼šæ”»å‡»è€…å°†æ¶æ„è„šæœ¬ä½œä¸ºå‚æ•°æˆ–è€…URLçš„ä¸€éƒ¨åˆ†ï¼Œå‘é€ç»™ç›®æ ‡ç”¨æˆ·ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æ—¶ï¼Œè„šæœ¬ä¼šåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚ DOM-based XSSï¼šæ”»å‡»è€…åˆ©ç”¨å®¢æˆ·ç«¯çš„DOMç¯å¢ƒï¼Œé€šè¿‡ä¿®æ”¹é¡µé¢çš„DOMç»“æ„æ¥æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ å¦‚ä½•åº”å¯¹ XSS æ”»å‡»ï¼Ÿ å¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œè¿‡æ»¤æ ‡ç­¾ç­‰ï¼Œåªå…è®¸åˆæ³•å€¼ã€‚ HTML è½¬ä¹‰ å¯¹äºé“¾æ¥è·³è½¬ï¼Œå¦‚\u003ca href=\"xxx\" ç­‰ï¼Œè¦æ ¡éªŒå†…å®¹ï¼Œç¦æ­¢ä»¥ script å¼€å¤´çš„éæ³•é“¾æ¥ã€‚ é™åˆ¶è¾“å…¥é•¿åº¦ å°†Cookieè®¾ç½®ä¸ºHttpOnlyæ ‡å¿—ï¼Œå¯ä»¥é˜²æ­¢JavaScriptè®¿é—®Cookieï¼Œä»è€Œå‡å°‘XSSæ”»å‡»çš„é£é™©ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:8:5","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","è®¡ç®—æœºç½‘ç»œ"],"content":"8.6 å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†æ˜¯ä¸¤ç§å¸¸è§çš„åŠ å¯†ç®—æ³•ï¼Œå®ƒä»¬ä¹‹é—´æœ‰å‡ ä¸ªå…³é”®åŒºåˆ«ï¼š å¯†é’¥æ•°é‡ï¼š å¯¹ç§°åŠ å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥æ¥åŠ å¯†å’Œè§£å¯†æ•°æ®ï¼Œå› æ­¤åªéœ€è¦ä¸€ä¸ªå¯†é’¥ã€‚å‘é€æ–¹ä½¿ç”¨è¯¥å¯†é’¥å°†æ•°æ®åŠ å¯†ï¼Œæ¥æ”¶æ–¹ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å°†æ•°æ®è§£å¯†ã€‚ éå¯¹ç§°åŠ å¯†ä½¿ç”¨ä¸€å¯¹å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚å…¬é’¥ç”¨äºåŠ å¯†æ•°æ®ï¼Œç§é’¥ç”¨äºè§£å¯†æ•°æ®ã€‚å› æ­¤ï¼Œå‘é€æ–¹ä½¿ç”¨æ¥æ”¶æ–¹çš„å…¬é’¥æ¥åŠ å¯†æ•°æ®ï¼Œæ¥æ”¶æ–¹ä½¿ç”¨è‡ªå·±çš„ç§é’¥æ¥è§£å¯†æ•°æ®ã€‚ å¯†é’¥åˆ†å‘ï¼š å¯¹ç§°åŠ å¯†éœ€è¦ç¡®ä¿åŠ å¯†å’Œè§£å¯†åŒæ–¹éƒ½å®‰å…¨åœ°å…±äº«ç›¸åŒçš„å¯†é’¥ã€‚è¿™æ„å‘³ç€å¿…é¡»åœ¨é€šä¿¡åŒæ–¹ä¹‹é—´å»ºç«‹ä¸€ä¸ªå®‰å…¨çš„æ¸ é“æ¥ä¼ è¾“å¯†é’¥ï¼Œå¦åˆ™å¯†é’¥å¯èƒ½ä¼šè¢«çªƒå–æˆ–ç¯¡æ”¹ã€‚ éå¯¹ç§°åŠ å¯†ä¸éœ€è¦åœ¨é€šä¿¡åŒæ–¹ä¹‹é—´å…±äº«å¯†é’¥ã€‚æ¥æ”¶æ–¹å°†è‡ªå·±çš„å…¬é’¥å…¬å¼€å‘å¸ƒï¼Œå‘é€æ–¹ä½¿ç”¨è¯¥å…¬é’¥åŠ å¯†æ•°æ®ï¼Œæ¥æ”¶æ–¹ä½¿ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†æ•°æ®ã€‚å› æ­¤ï¼Œä¸éœ€è¦å»ºç«‹å®‰å…¨çš„é€šé“æ¥ä¼ è¾“å¯†é’¥ã€‚ æ€§èƒ½ï¼š å¯¹ç§°åŠ å¯†é€šå¸¸æ¯”éå¯¹ç§°åŠ å¯†æ›´å¿«é€Ÿï¼Œå› ä¸ºå®ƒä½¿ç”¨çš„å¯†é’¥è¾ƒå°‘ï¼ŒåŠ å¯†å’Œè§£å¯†è¿‡ç¨‹æ›´ç®€å•ã€‚ éå¯¹ç§°åŠ å¯†é€šå¸¸æ¯”å¯¹ç§°åŠ å¯†æ›´æ…¢ï¼Œå› ä¸ºå®ƒä½¿ç”¨æ›´å¤æ‚çš„æ•°å­¦è¿ç®—æ¥åŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚ é€‚ç”¨åœºæ™¯ï¼š å¯¹ç§°åŠ å¯†é€šå¸¸ç”¨äºåŠ å¯†å¤§é‡æ•°æ®ï¼Œå¦‚ä¼ è¾“æ–‡ä»¶æˆ–é€šä¿¡å†…å®¹ã€‚ éå¯¹ç§°åŠ å¯†é€šå¸¸ç”¨äºåŠ å¯†å°å—æ•°æ®ï¼Œå¦‚æ•°å­—ç­¾åã€SSL/TLSæ¡æ‰‹è¿‡ç¨‹ç­‰ã€‚ ","date":"2024-06-02","objectID":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/:8:6","tags":[null],"title":"è®¡ç®—æœºç½‘ç»œ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 æ’åºç®—æ³• æ’åºç®—æ³• å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å·®æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ æ•°æ®å¯¹è±¡ç¨³å®šæ€§ ç®—æ³•åŸºæœ¬æ€è·¯ å†’æ³¡æ’åº $$O(n^2)$$ $$O(n^2)$$ $$O(1)$$ ç¨³å®š åå¤äº¤æ¢ç›¸é‚»é€†åºçš„å…ƒç´ ï¼Œç›´åˆ°æ²¡æœ‰é€†åºå¯¹ é€‰æ‹©æ’åº $$O(n^2)$$ $$O(n^2)$$ $$O(1)$$ æ•°ç»„ä¸ç¨³å®šã€é“¾è¡¨ç¨³å®š åå¤é€‰æ‹©æœªæ’åºéƒ¨åˆ†ä¸­çš„æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œæ”¾åœ¨å·²æ’åºéƒ¨åˆ†çš„æœ«å°¾ æ’å…¥æ’åº $$O(n^2)$$ $$O(n^2)$$ $$O(1)$$ ç¨³å®š é€ä¸€é€‰æ‹©æœªæ’åºå…ƒç´ ï¼Œå°†å…¶æ’å…¥åˆ°å·²æ’åºéƒ¨åˆ†çš„æ­£ç¡®ä½ç½® å¿«é€Ÿæ’åº $$O(n \\log_2 n)$$ $$O(n^2)$$ $$O(\\log_2 n)$$ ä¸ç¨³å®š é€‰æ‹©åŸºå‡†ï¼Œå°†æ•°ç»„åˆ†ä¸ºå°äºå’Œå¤§äºåŸºå‡†çš„ä¸¤éƒ¨åˆ†ï¼Œé€’å½’æ’åº å †æ’åº $$O(n \\log_2 n)$$ $$O(n \\log_2 n)$$ $$O(1)$$ ä¸ç¨³å®š æ„å»ºæœ€å¤§ï¼ˆå°ï¼‰å †ï¼Œå°†å †é¡¶å…ƒç´ ä¸æœ«å°¾å…ƒç´ äº¤æ¢ï¼Œè°ƒæ•´å † å½’å¹¶æ’åº $$O(n \\log_2 n)$$ $$O(n \\log_2 n)$$ $$O(n)$$ ç¨³å®š é€’å½’åœ°å°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«æ’åºååˆå¹¶ å¸Œå°”æ’åº $$O(n \\log_2 n)$$ $$O(n^2)$$ $$O(1)$$ ä¸ç¨³å®š åˆ†ç»„è¿›è¡Œæ’å…¥æ’åºï¼Œé€æ¸å‡å°‘é—´éš”ï¼Œç›´åˆ°é—´éš”ä¸º1 è®¡æ•°æ’åº $$O(n + m)$$ $$O(n + m)$$ $$O(n + m)$$ ç¨³å®š ç»Ÿè®¡æ¯ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°ï¼Œæ ¹æ®è®¡æ•°å¯¹å…ƒç´ è¿›è¡Œæ’åº æ¡¶æ’åº $$O(n)$$ $$O(n)$$ $$O(m)$$ ç¨³å®š å°†å…ƒç´ åˆ†é…åˆ°ä¸åŒçš„æ¡¶ä¸­ï¼Œåˆ†åˆ«æ’åºååˆå¹¶ åŸºæ•°æ’åº $$O(k \\cdot n)$$ $$O(n^2)$$ å–å†³äºå®ç° ç¨³å®š é€ä½æ’åºï¼Œä»æœ€ä½æœ‰æ•ˆä½åˆ°æœ€é«˜æœ‰æ•ˆä½è¿›è¡Œ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:1:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 æ ˆä¸é˜Ÿåˆ—çš„åŒºåˆ« é˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼šæ˜¯é™å®šåªèƒ½åœ¨è¡¨çš„ä¸€ç«¯è¿›è¡Œæ’å…¥å’Œåœ¨å¦ä¸€ç«¯è¿›è¡Œåˆ é™¤æ“ä½œçš„çº¿æ€§è¡¨ï¼› æ ˆï¼ˆStackï¼‰ï¼šæ˜¯é™å®šåªèƒ½åœ¨è¡¨çš„ä¸€ç«¯è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„çº¿æ€§è¡¨ã€‚ é˜Ÿåˆ—å…ˆè¿›å…ˆå‡ºï¼Œæ ˆå…ˆè¿›åå‡ºã€‚ æ ˆåªèƒ½åœ¨è¡¨å°¾æ’å…¥åˆ é™¤ï¼Œé˜Ÿåˆ—åœ¨è¡¨å°¾æ’å…¥è¡¨å¤´åˆ é™¤ã€‚ åº”ç”¨åœºæ™¯ä¸åŒï¼š æ ˆï¼šæ‹¬å·é—®é¢˜çš„æ±‚è§£ç­‰ é˜Ÿåˆ—ï¼šè®¡ç®—æœºç³»ç»Ÿä¸­å„ç§èµ„æºçš„ç®¡ç†ç­‰ã€‚ éå†é€Ÿåº¦ä¸åŒï¼š é˜Ÿåˆ—ï¼šåŸºäºåœ°å€æŒ‡é’ˆè¿›è¡Œéå†ï¼Œè€Œä¸”å¯ä»¥ä»å¤´éƒ¨æˆ–è€…å°¾éƒ¨è¿›è¡Œéå†ï¼Œä½†ä¸èƒ½åŒæ—¶éå†ï¼Œæ— éœ€å¼€è¾Ÿç©ºé—´ï¼Œå› ä¸ºåœ¨éå†çš„è¿‡ç¨‹ä¸­ä¸å½±å“æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥éå†é€Ÿåº¦è¦å¿«ï¼› æ ˆï¼šåªèƒ½ä»é¡¶éƒ¨å–æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å…ˆè¿›å…¥æ ˆåº•çš„ï¼Œéœ€è¦éå†æ•´ä¸ªæ ˆæ‰èƒ½å–å‡ºæ¥ï¼Œè€Œä¸”åœ¨éå†æ•°æ®çš„åŒæ—¶éœ€è¦ä¸ºæ•°æ®å¼€è¾Ÿä¸´æ—¶ç©ºé—´ï¼Œä¿æŒæ•°æ®åœ¨éå†å‰çš„ä¸€è‡´æ€§ã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:2:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ— ä½¿ç”¨ä¸¤ä¸ªæ ˆæ¥å®ç°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨æ ˆçš„ç‰¹æ€§ï¼ˆåè¿›å…ˆå‡ºï¼‰æ¥æ¨¡æ‹Ÿé˜Ÿåˆ—çš„ç‰¹æ€§ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ ˆæ¥åˆ†ç¦»å…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œï¼Œå…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š æ ˆ1ï¼ˆstack1ï¼‰ç”¨äºå¤„ç†å…¥é˜Ÿæ“ä½œã€‚ æ ˆ2ï¼ˆstack2ï¼‰ç”¨äºå¤„ç†å‡ºé˜Ÿæ“ä½œã€‚ å…¥é˜Ÿåˆ—ï¼šç›´æ¥å‹å…¥å…ƒç´ è‡³stack1å³å¯ å‡ºé˜Ÿåˆ—ï¼šå¦‚æœstack2ä¸ä¸ºç©ºï¼ŒæŠŠstack2ä¸­çš„æ ˆé¡¶å…ƒç´ ç›´æ¥å¼¹å‡ºã€‚å¦åˆ™ï¼ŒæŠŠstack1çš„æ‰€æœ‰å…ƒç´ å…¨éƒ¨å¼¹å‡ºå‹å…¥stack2ä¸­ï¼Œå†å¼¹å‡ºstack2çš„æ ˆé¡¶å…ƒç´  void enqueue(int x) { stack1.push(x); } int dequeue() { if (stack2.empty()) { while (!stack1.empty()) { stack2.push(stack1.top()); stack1.pop(); } } if (stack2.empty()) { throw std::runtime_error(\"Queue is empty\"); } int result = stack2.top(); stack2.pop(); return result; } ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:3:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 ä¸¤ä¸ªé˜Ÿåˆ—å®ç°æ ˆ ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ¥å®ç°ä¸€ä¸ªæ ˆï¼Œå¯ä»¥åˆ©ç”¨é˜Ÿåˆ—çš„ç‰¹æ€§ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æ¥æ¨¡æ‹Ÿæ ˆçš„ç‰¹æ€§ï¼ˆåè¿›å…ˆå‡ºï¼‰ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ¥åˆ†ç¦»å…¥æ ˆå’Œå‡ºæ ˆæ“ä½œï¼Œå…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š é˜Ÿåˆ—1ï¼ˆqueue1ï¼‰ç”¨äºå­˜å‚¨å…ƒç´ ã€‚ é˜Ÿåˆ—2ï¼ˆqueue2ï¼‰ä½œä¸ºè¾…åŠ©é˜Ÿåˆ—ç”¨äºæ“ä½œå…ƒç´ ã€‚ å…¥æ ˆæ“ä½œï¼šå°†å…ƒç´ ç›´æ¥å…¥é˜Ÿåˆ°queue1ä¸­ã€‚ å‡ºæ ˆæ“ä½œï¼š å°†queue1ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆé™¤äº†æœ€åä¸€ä¸ªï¼‰é€ä¸ªå‡ºé˜Ÿå¹¶å…¥é˜Ÿåˆ°queue2ä¸­ã€‚ æœ€åä¸€ä¸ªå…ƒç´ æ˜¯æ ˆé¡¶å…ƒç´ ï¼Œå°†å…¶å‡ºé˜Ÿã€‚ äº¤æ¢queue1å’Œqueue2ï¼Œä»¥ä¿æŒqueue1å§‹ç»ˆä¸ºä¸»é˜Ÿåˆ—ã€‚ void push(int x) { queue1.push(x); } int pop() { if (queue1.empty()) { throw std::runtime_error(\"Stack is empty\"); } while (queue1.size() \u003e 1) { queue2.push(queue1.front()); queue1.pop(); } int result = queue1.front(); queue1.pop(); std::swap(queue1, queue2); return result; } ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:4:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5 é“¾è¡¨ä¸æ•°ç»„çš„åŒºåˆ« æ•°ç»„é™æ€åˆ†é…å†…å­˜ï¼Œé“¾è¡¨åŠ¨æ€åˆ†é…å†…å­˜ï¼›ã€‚ æ•°ç»„åœ¨å†…å­˜ä¸­è¿ç»­ï¼Œé“¾è¡¨ä¸è¿ç»­ã€‚ æ•°ç»„åˆ©ç”¨ä¸‹æ ‡å®šä½ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œé“¾è¡¨å®šä½å…ƒç´ æ—¶é—´å¤æ‚åº¦O(n)ã€‚ æ•°ç»„æ’å…¥æˆ–åˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦O(n)ï¼Œé“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦O(1)ã€‚ æ•°ç»„å…ƒç´ åœ¨æ ˆåŒºï¼Œé“¾è¡¨å…ƒç´ åœ¨å †åŒºã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:5:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6 ä»€ä¹ˆæ˜¯å †ï¼Ÿ å¦‚æœä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„ä»»æ„ä¸€ä¸ªéç»ˆç«¯ç»“ç‚¹çš„å…ƒç´ éƒ½ä¸å°äºå…¶å·¦å„¿å­ç»“ç‚¹å’Œå³å„¿å­ç»“ç‚¹ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ çš„å…ƒç´ ï¼Œåˆ™ç§°æ­¤å®Œå…¨äºŒå‰æ ‘ä¸ºæœ€å¤§å †ã€‚ åŒæ ·ï¼Œå¦‚æœä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„ä»»æ„ä¸€ä¸ªéç»ˆç«¯ç»“ç‚¹çš„å…ƒç´ éƒ½ä¸å¤§äºå…¶å·¦å„¿å­ç»“ç‚¹å’Œå³å„¿å­ç»“ç‚¹ï¼ˆå¦‚æœ æœ‰çš„è¯ï¼‰çš„å…ƒç´ ï¼Œåˆ™ç§°æ­¤å®Œå…¨äºŒå‰æ ‘ä¸ºæœ€å°å †ã€‚ æœ€å¤§å †çš„æ ¹ç»“ç‚¹ä¸­çš„å…ƒç´ åœ¨æ•´ä¸ªå †ä¸­æ˜¯æœ€å¤§çš„ï¼› æœ€å°å †çš„æ ¹ç»“ç‚¹ä¸­çš„å…ƒç´ åœ¨æ•´ä¸ªå †ä¸­æ˜¯æœ€å°çš„ã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:6:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"7 ä»€ä¹ˆæ˜¯äºŒå‰æ’åºæ ‘ äºŒå‰æ’åºæ ‘ï¼ˆBinary Sort Treeï¼‰åˆç§°äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆBinary Search Treeï¼‰ï¼Œäº¦ç§°äºŒå‰æœç´¢æ ‘ã€‚ äºŒå‰æ’åºæ ‘æˆ–è€…æ˜¯ä¸€æ£µç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘ï¼š è‹¥å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼› è‹¥å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºæˆ–ç­‰äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼› å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘ï¼› æ²¡æœ‰é”®å€¼ç›¸ç­‰çš„èŠ‚ç‚¹ äºŒåˆ†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(log(n))ï¼Œæœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼ˆç›¸å½“äºé¡ºåºæŸ¥æ‰¾ï¼‰ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:7:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"8 ä»€ä¹ˆæ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Ÿ å¹³è¡¡äºŒå‰æ ‘ï¼ˆbalanced binary treeï¼‰,åˆç§° AVL æ ‘ã€‚å®ƒæˆ–è€…æ˜¯ä¸€æ£µç©ºæ ‘,æˆ–è€…æ˜¯å…·æœ‰å¦‚ä¸‹æ€§è´¨çš„äºŒå‰æ ‘ï¼š å®ƒçš„å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Œ å·¦å­æ ‘å’Œå³å­æ ‘çš„æ·±åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ã€‚ å¹³è¡¡äºŒå‰æ ‘æ˜¯å¯¹äºŒå‰æœç´¢æ ‘(åˆç§°ä¸ºäºŒå‰æ’åºæ ‘)çš„ä¸€ç§æ”¹è¿›ã€‚äºŒå‰æœç´¢æ ‘æœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ï¼Œæ ‘çš„ç»“æ„æ˜¯æ— æ³•é¢„æ–™çš„ï¼Œéšæ„æ€§å¾ˆå¤§ï¼Œå®ƒåªä¸èŠ‚ç‚¹çš„å€¼å’Œæ’å…¥çš„é¡ºåºæœ‰å…³ç³»ï¼Œå¾€å¾€å¾—åˆ°çš„æ˜¯ä¸€ä¸ªä¸å¹³è¡¡çš„äºŒå‰æ ‘ã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå•æ”¯äºŒå‰æ ‘ï¼Œå…¶é«˜åº¦å’ŒèŠ‚ç‚¹æ•°ç›¸åŒï¼Œç›¸å½“äºä¸€ä¸ªå•é“¾è¡¨ï¼Œå¯¹å…¶æ­£å¸¸çš„æ—¶é—´å¤æ‚åº¦æœ‰O(log(n))å˜æˆäº†O(n)ï¼Œä»è€Œä¸§å¤±äº†äºŒå‰æ’åºæ ‘çš„ä¸€äº›åº”è¯¥æœ‰çš„ä¼˜ç‚¹ã€‚ æ—‹è½¬æ˜¯å¹³è¡¡äºŒå‰æ ‘ç»´æŠ¤å¹³è¡¡æ€§çš„æ ¸å¿ƒæ“ä½œï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š å•å³æ—‹è½¬ï¼ˆRight Rotationï¼‰ï¼šç”¨äºä¿®å¤å·¦å­æ ‘è¿‡é«˜çš„æƒ…å†µã€‚ å•å·¦æ—‹è½¬ï¼ˆLeft Rotationï¼‰ï¼šç”¨äºä¿®å¤å³å­æ ‘è¿‡é«˜çš„æƒ…å†µã€‚ åŒæ—‹è½¬ï¼ˆDouble Rotationï¼‰ï¼šåŒ…æ‹¬å…ˆå·¦åå³æ—‹è½¬å’Œå…ˆå³åå·¦æ—‹è½¬ï¼Œç”¨äºä¿®å¤ç‰¹å®šçš„ä¸å¹³è¡¡æƒ…å†µã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:8:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"9 ä»€ä¹ˆæ˜¯Bæ ‘ Bæ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„å¤šè·¯æŸ¥æ‰¾æ ‘ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªå­èŠ‚ç‚¹å’Œå¤šä¸ªé”®ã€‚Bæ ‘å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š èŠ‚ç‚¹åŒ…å«å¤šä¸ªé”®å’Œå­èŠ‚ç‚¹ï¼šæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨å¤šä¸ªé”®å’Œå­èŠ‚ç‚¹ã€‚èŠ‚ç‚¹ä¸­çš„é”®æŒ‰ç…§é€’å¢é¡ºåºå­˜å‚¨ã€‚ æ ¹èŠ‚ç‚¹è‡³å°‘æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼ˆå¦‚æœä¸æ˜¯å¶èŠ‚ç‚¹ï¼‰ã€‚ å†…éƒ¨èŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°å—é™ï¼šä¸€ä¸ªå†…éƒ¨èŠ‚ç‚¹è‡³å°‘æœ‰$$[m/2]$$ä¸ªå­èŠ‚ç‚¹ï¼Œæœ€å¤šæœ‰ $$m$$ä¸ªå­èŠ‚ç‚¹ï¼ˆè¿™é‡Œçš„$m$æ˜¯Bæ ‘çš„é˜¶ï¼‰ã€‚ æ‰€æœ‰å¶å­èŠ‚ç‚¹å¤„äºåŒä¸€å±‚ï¼šBæ ‘çš„æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼Œä¿è¯æ ‘çš„å¹³è¡¡æ€§ã€‚ Bæ ‘çš„æ€§è´¨å¦‚ä¸‹ï¼š å¹³è¡¡æ€§ï¼šBæ ‘æ˜¯è‡ªå¹³è¡¡çš„ï¼Œæ‰€æœ‰å¶å­èŠ‚ç‚¹å¤„åœ¨åŒä¸€å±‚ï¼Œæ ‘çš„é«˜åº¦é€šå¸¸è¾ƒå°ï¼Œå› è€Œèƒ½å¤Ÿä¿è¯è¾ƒå¿«çš„æœç´¢ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚ é«˜æ•ˆçš„ç£ç›˜I/Oæ“ä½œï¼šç”±äºèŠ‚ç‚¹å¯ä»¥åŒ…å«å¤šä¸ªé”®å’Œå­èŠ‚ç‚¹ï¼ŒBæ ‘é€šå¸¸ç”¨äºç£ç›˜å­˜å‚¨ä¸­ï¼Œå‡å°‘ç£ç›˜I/Oæ“ä½œçš„æ¬¡æ•°ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šæœç´¢ã€æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‡ä¸º$O(\\log n)$ï¼Œå…¶ä¸­$n$æ˜¯æ ‘ä¸­çš„é”®çš„æ€»æ•°ã€‚ Bæ ‘çš„æ“ä½œå¦‚ä¸‹ï¼š æœç´¢ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ ¹æ®å½“å‰èŠ‚ç‚¹ä¸­çš„é”®èŒƒå›´ï¼Œé€’å½’æˆ–è¿­ä»£åœ°é€‰æ‹©ç›¸åº”çš„å­èŠ‚ç‚¹è¿›è¡Œæœç´¢ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡é”®æˆ–åˆ°è¾¾å¶å­èŠ‚ç‚¹ã€‚ æ’å…¥ï¼š åœ¨å¶å­èŠ‚ç‚¹æ’å…¥æ–°é”®ã€‚ å¦‚æœå¶å­èŠ‚ç‚¹å·²æ»¡ï¼Œåˆ™è¿›è¡Œåˆ†è£‚æ“ä½œï¼Œå°†ä¸­é—´é”®æå‡åˆ°çˆ¶èŠ‚ç‚¹ï¼Œå¹¶å°†å¶å­èŠ‚ç‚¹åˆ†è£‚ä¸ºä¸¤ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœçˆ¶èŠ‚ç‚¹ä¹Ÿæ»¡ï¼Œåˆ™é€’å½’è¿›è¡Œåˆ†è£‚ï¼Œç›´åˆ°æ ‘æ ¹ã€‚ åˆ é™¤ï¼š ä»æ ‘ä¸­åˆ é™¤é”®ã€‚ å¦‚æœåˆ é™¤é”®å¯¼è‡´èŠ‚ç‚¹ä¸‹æº¢ï¼ˆé”®æ•°å°‘äº$[m/2]$ï¼‰ï¼Œåˆ™è¿›è¡Œåˆå¹¶æˆ–å€Ÿç”¨æ“ä½œï¼Œä»¥ä¿æŒBæ ‘çš„å¹³è¡¡æ€§ã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:9:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"10 Trie æ ‘ Trie æ ‘ï¼Œåˆç§°å‰ç¼€æ ‘ï¼Œå­—å…¸æ ‘ï¼Œ æ˜¯ä¸€ç§æœ‰åºæ ‘ï¼Œç”¨äºä¿å­˜å…³è”æ•°ç»„ï¼Œå…¶ä¸­çš„é”®é€šå¸¸æ˜¯å­—ç¬¦ä¸²ã€‚ä¸äºŒå‰æŸ¥æ‰¾æ ‘ä¸åŒï¼Œé”®ä¸æ˜¯ç›´æ¥ä¿å­˜åœ¨èŠ‚ç‚¹ä¸­ï¼Œè€Œæ˜¯ç”±èŠ‚ç‚¹åœ¨æ ‘ä¸­çš„ä½ç½®å†³å®šã€‚ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å­å­™éƒ½æœ‰ç›¸åŒçš„å‰ç¼€ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œè€Œæ ¹èŠ‚ç‚¹å¯¹åº”ç©ºå­—ç¬¦ä¸²ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸æ˜¯æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æœ‰å¯¹åº”çš„å€¼ï¼Œåªæœ‰å¶å­èŠ‚ç‚¹å’Œéƒ¨åˆ†å†…éƒ¨èŠ‚ç‚¹æ‰€å¯¹åº”çš„é”®æ‰æœ‰ç›¸å…³çš„å€¼ã€‚ Trie æ ‘æŸ¥è¯¢å’Œæ’å…¥æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(n)ï¼Œæ˜¯ä¸€ç§ä»¥ç©ºé—´æ¢æ—¶é—´çš„æ–¹æ³•ã€‚å½“èŠ‚ç‚¹æ ‘è¾ƒå¤šçš„æ—¶å€™ï¼ŒTrie æ ‘å ç”¨çš„å†…å­˜ä¼šå¾ˆå¤§ã€‚ Trie æ ‘å¸¸ç”¨äºæœç´¢æç¤ºã€‚å¦‚å½“è¾“å…¥ä¸€ä¸ªç½‘å€ï¼Œå¯ä»¥è‡ªåŠ¨æœç´¢å‡ºå¯èƒ½çš„é€‰æ‹©ã€‚å½“æ²¡æœ‰å®Œå…¨åŒ¹é…çš„æœç´¢ç»“æœï¼Œå¯ä»¥è¿”å›å‰ç¼€æœ€ç›¸ä¼¼çš„å¯èƒ½ã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:10:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"11 B+æ ‘ B+æ ‘é€šå¸¸ç”¨äºæ•°æ®åº“å’Œæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒB+æ ‘çš„ç»“æ„å¦‚ä¸‹ï¼š æ ¹èŠ‚ç‚¹ï¼ˆRoot Nodeï¼‰ï¼šB+æ ‘çš„æ ¹èŠ‚ç‚¹å¯ä»¥æ˜¯å¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å†…éƒ¨èŠ‚ç‚¹ã€‚ å†…éƒ¨èŠ‚ç‚¹ï¼ˆInternal Nodesï¼‰ï¼šå­˜å‚¨é”®å€¼ç”¨äºå¯¼èˆªï¼Œä¸å­˜å‚¨å®é™…æ•°æ®ã€‚æ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹åŒ…å«è‹¥å¹²ä¸ªé”®å’ŒæŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚ å¶å­èŠ‚ç‚¹ï¼ˆLeaf Nodesï¼‰ï¼šå­˜å‚¨æ‰€æœ‰çš„å®é™…æ•°æ®ï¼Œå¹¶ä¸”åŒ…å«æŒ‡å‘ç›¸é‚»å¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå½¢æˆä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚ B+æ ‘çš„æ€§è´¨ï¼š æœ‰åºæ€§ï¼šæ‰€æœ‰é”®æŒ‰å‡åºæ’åˆ—ã€‚ å¹³è¡¡æ€§ï¼šæ ‘çš„æ‰€æœ‰å¶å­èŠ‚ç‚¹å¤„äºåŒä¸€å±‚çº§ï¼Œä¿è¯äº†å¹³è¡¡æ€§ã€‚ å¤šè·¯æ€§ï¼šæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œå…·ä½“æ•°é‡ç”±æ ‘çš„é˜¶ï¼ˆorderï¼‰å†³å®šã€‚ B+æ ‘çš„æ“ä½œï¼š æŸ¥æ‰¾ï¼ˆSearchï¼‰ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡æ¯”è¾ƒé”®å€¼ï¼Œæ²¿ç€æŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆé€’å½’æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡å¶å­èŠ‚ç‚¹ã€‚ æ’å…¥ï¼ˆInsertï¼‰ï¼šå°†æ–°é”®æ’å…¥é€‚å½“çš„å¶å­èŠ‚ç‚¹ï¼Œå¦‚æœå¶å­èŠ‚ç‚¹æ»¡äº†ï¼Œåˆ™åˆ†è£‚å¶å­èŠ‚ç‚¹å¹¶å°†ä¸­é—´é”®ä¸Šç§»åˆ°çˆ¶èŠ‚ç‚¹ï¼Œé€’å½’è¿›è¡Œåˆ†è£‚ç›´åˆ°æ ‘æ¢å¤å¹³è¡¡ã€‚ åˆ é™¤ï¼ˆDeleteï¼‰ï¼šä»å¶å­èŠ‚ç‚¹åˆ é™¤é”®ï¼Œå¦‚æœåˆ é™¤å¯¼è‡´èŠ‚ç‚¹é”®æ•°ç›®ä¸è¶³ï¼Œåˆ™è¿›è¡ŒèŠ‚ç‚¹åˆå¹¶æˆ–é”®é‡æ–°åˆ†é…ï¼Œç›´åˆ°æ ‘æ¢å¤å¹³è¡¡ã€‚ B+æ ‘çš„ä¼˜ç‚¹ï¼š é«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢ï¼šç”±äºæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸­ï¼Œå¹¶ä¸”å¶å­èŠ‚ç‚¹å½¢æˆåŒå‘é“¾è¡¨ï¼ŒB+æ ‘èƒ½å¤Ÿé«˜æ•ˆåœ°è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼ˆrange queryï¼‰ã€‚ é«˜å­˜å‚¨åˆ©ç”¨ç‡ï¼šå†…éƒ¨èŠ‚ç‚¹åªå­˜å‚¨é”®ï¼Œæ•°æ®å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸­ï¼ŒèŠ‚ç‚¹åˆ†è£‚å’Œåˆå¹¶æ›´åŠ é«˜æ•ˆã€‚ ä½æ ‘é«˜ï¼ˆTree Heightï¼‰ï¼šB+æ ‘çš„å¤šè·¯æ€§ä½¿å¾—å…¶æ ‘é«˜è¾ƒä½ï¼ŒæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º$O(\\log_mn$ï¼Œå…¶ä¸­$m$ä¸ºæ ‘çš„é˜¶ã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:11:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"12 ä»€ä¹ˆæ˜¯çº¢é»‘æ ‘ï¼Ÿ çº¢é»‘æ ‘ï¼ˆä¸ºäº†è§£å†³å¹³è¡¡æ ‘åœ¨æ’å…¥ã€åˆ é™¤ç­‰æ“ä½œéœ€è¦é¢‘ç¹è°ƒæ•´çš„æƒ…å†µï¼‰æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆBSTï¼‰ï¼Œå¹¿æ³›ç”¨äºè®¡ç®—æœºç§‘å­¦ä¸­å®ç°é«˜æ•ˆçš„æ•°æ®å­˜å‚¨å’Œæ£€ç´¢ã€‚å®ƒé€šè¿‡åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šé™„åŠ ä¸€ä¸ªé¢œè‰²å±æ€§ï¼ˆçº¢æˆ–é»‘ï¼‰æ¥ä¿æŒæ ‘çš„å¹³è¡¡ï¼Œä»è€Œç¡®ä¿æ ‘çš„é«˜åº¦åœ¨å¯¹æ•°çº§åˆ«ï¼Œæä¾›è¾ƒå¥½çš„æ—¶é—´å¤æ‚åº¦æ€§èƒ½ã€‚ çº¢é»‘æ ‘çš„æ€§è´¨ï¼š æ¯ä¸ªç»“ç‚¹ä¸æ˜¯çº¢è‰²å°±æ˜¯é»‘è‰²ï¼› æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²çš„ï¼› å¶å­èŠ‚ç‚¹ï¼ˆNILèŠ‚ç‚¹ï¼‰æ˜¯é»‘è‰²ï¼šçº¢é»‘æ ‘ä¸­çš„å¶å­èŠ‚ç‚¹ï¼Œå³æ ‘å°¾ç«¯çš„æ‰€æœ‰NULLèŠ‚ç‚¹ï¼Œéƒ½æ˜¯é»‘è‰²çš„ã€‚ çº¢è‰²èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ï¼Œå³ä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹ã€‚ ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰è·¯å¾„åŒ…å«ç›¸åŒæ•°é‡çš„é»‘è‰²èŠ‚ç‚¹ï¼šè¿™ä¿è¯äº†æ²¡æœ‰ä¸€æ¡è·¯å¾„ä¼šæ¯”å…¶ä»–è·¯å¾„é•¿å‡ºå¤ªå¤šï¼Œä»è€Œç¡®ä¿äº†æ ‘çš„å¹³è¡¡ã€‚ çº¢é»‘æ ‘çš„æ“ä½œï¼šçº¢é»‘æ ‘çš„æ“ä½œåŒ…æ‹¬æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾ï¼ŒåŸºæœ¬çš„æ“ä½œæ­¥éª¤ä¸æ™®é€šçš„äºŒå‰æŸ¥æ‰¾æ ‘ç±»ä¼¼ï¼Œä½†åœ¨ç»´æŠ¤å¹³è¡¡æ€§æ–¹é¢æœ‰æ‰€ä¸åŒã€‚ æ’å…¥æ“ä½œ æ™®é€šBSTæ’å…¥ï¼šæŒ‰äºŒå‰æŸ¥æ‰¾æ ‘çš„æ’å…¥è§„åˆ™ï¼Œå°†æ–°èŠ‚ç‚¹æ’å…¥é€‚å½“ä½ç½®ã€‚ èŠ‚ç‚¹æŸ“è‰²ä¸ºçº¢è‰²ï¼šæ–°æ’å…¥çš„èŠ‚ç‚¹åˆå§‹ä¸ºçº¢è‰²ã€‚ è°ƒæ•´å¹³è¡¡ï¼šé€šè¿‡æ—‹è½¬å’Œé‡æ–°æŸ“è‰²æ¥ä¿æŒçº¢é»‘æ ‘çš„æ€§è´¨ã€‚ æƒ…å†µ1ï¼šæ’å…¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯é»‘è‰²ï¼šä¸éœ€è¦è¿›ä¸€æ­¥æ“ä½œã€‚ æƒ…å†µ2ï¼šæ’å…¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼šæ ¹æ®å”èŠ‚ç‚¹çš„é¢œè‰²ï¼Œæœ‰ä¸åŒçš„è°ƒæ•´æ–¹æ³•ï¼ŒåŒ…æ‹¬é‡æ–°æŸ“è‰²å’Œæ—‹è½¬ã€‚ åˆ é™¤æ“ä½œ æ™®é€šBSTåˆ é™¤ï¼šæŒ‰äºŒå‰æŸ¥æ‰¾æ ‘çš„åˆ é™¤è§„åˆ™ï¼Œæ‰¾åˆ°å¹¶åˆ é™¤èŠ‚ç‚¹ã€‚ è°ƒæ•´å¹³è¡¡ï¼šåˆ é™¤èŠ‚ç‚¹åå¯èƒ½ç ´åçº¢é»‘æ ‘çš„æ€§è´¨ï¼Œéœ€è¦é€šè¿‡æ—‹è½¬å’Œé‡æ–°æŸ“è‰²æ¥æ¢å¤å¹³è¡¡ã€‚ æƒ…å†µ1ï¼šåˆ é™¤èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼šä¸éœ€è¦è¿›ä¸€æ­¥æ“ä½œã€‚ æƒ…å†µ2ï¼šåˆ é™¤èŠ‚ç‚¹æ˜¯é»‘è‰²ï¼šé€šè¿‡åŒé‡é»‘è‰²èŠ‚ç‚¹çš„æ¦‚å¿µå’Œè°ƒæ•´ï¼ŒåŒ…æ‹¬é‡æ–°æŸ“è‰²å’Œæ—‹è½¬ï¼Œæ¥æ¢å¤çº¢é»‘æ ‘çš„å¹³è¡¡ã€‚ çº¢é»‘æ ‘çš„ä¼˜ç‚¹ï¼š è‡ªå¹³è¡¡ï¼šé€šè¿‡é¢œè‰²å±æ€§å’Œæ—‹è½¬æ“ä½œï¼Œçº¢é»‘æ ‘å¯ä»¥ä¿æŒå¹³è¡¡ï¼Œç¡®ä¿åŸºæœ¬æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º$$O(\\log n)$$ã€‚ é«˜æ•ˆæŸ¥æ‰¾ï¼šç”±äºå¹³è¡¡æ€§ï¼Œçº¢é»‘æ ‘åœ¨æœ€åæƒ…å†µä¸‹çš„é«˜åº¦ä¸º$$2\\log(n+1)$$ï¼Œä¿è¯äº†æŸ¥æ‰¾æ“ä½œçš„é«˜æ•ˆæ€§ã€‚ é«˜æ•ˆæ’å…¥å’Œåˆ é™¤ï¼šæ’å…¥å’Œåˆ é™¤æ“ä½œåœ¨è¿›è¡Œå¹³è¡¡è°ƒæ•´æ—¶ï¼Œæ—‹è½¬å’Œé‡æ–°æŸ“è‰²çš„æˆæœ¬è¾ƒä½ï¼Œç¡®ä¿äº†é«˜æ•ˆæ€§ã€‚ çº¢é»‘æ ‘å¹¿æ³›åº”ç”¨äºè®¸å¤šè®¡ç®—æœºç³»ç»Ÿå’Œè½¯ä»¶ä¸­ï¼ŒåŒ…æ‹¬ï¼š å…³è”å®¹å™¨ï¼šC++çš„STLä¸­çš„mapå’Œsetï¼ŒJavaçš„TreeMapå’ŒTreeSetéƒ½åŸºäºçº¢é»‘æ ‘å®ç°ã€‚ å†…å­˜ç®¡ç†ï¼šLinuxå†…æ ¸ä¸­çš„å†…å­˜ç®¡ç†ä½¿ç”¨çº¢é»‘æ ‘æ¥ç®¡ç†ç©ºé—²å†…å­˜å—ã€‚ æ•°æ®åº“ç´¢å¼•ï¼šä¸€äº›æ•°æ®åº“ç³»ç»Ÿä½¿ç”¨çº¢é»‘æ ‘ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œå®ç°é«˜æ•ˆçš„æ•°æ®æ£€ç´¢ã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:12:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"13 ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨ï¼Ÿå“ˆå¸Œè¡¨çš„å®ç°æ–¹å¼ï¼Ÿæ€ä¹ˆé¿å…å“ˆå¸Œå†²çª å“ˆå¸Œè¡¨ï¼ˆHash Tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®é”®å€¼ (Key-Value) è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠé”®å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚å“ˆå¸Œè¡¨çš„å®ç°ä¸»è¦éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼Œå“ˆå¸Œå‡½æ•°å’Œå†²çªè§£å†³ã€‚ å“ˆå¸Œå‡½æ•°ä¹Ÿç§°ä¸ºæ•£åˆ—å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªé”®ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°å“ˆå¸Œè¡¨çš„ä¸€ä¸ªä½ç½®ä¸Šã€‚ç†æƒ³çš„å“ˆå¸Œå‡½æ•°åº”è¯¥èƒ½å¤Ÿå°†é”®å‡åŒ€åœ°åˆ†å¸ƒåˆ°å“ˆå¸Œè¡¨çš„ä¸åŒä½ç½®ä¸Šï¼ŒåŒæ—¶å…·æœ‰è‰¯å¥½çš„è®¡ç®—æ•ˆç‡ã€‚å¸¸è§çš„å“ˆå¸Œå‡½æ•°åŒ…æ‹¬å–ä½™æ³•ã€ä¹˜æ³•å“ˆå¸Œæ³•ã€MD5ã€SHAç­‰ã€‚é€‰æ‹©åˆé€‚çš„å“ˆå¸Œå‡½æ•°å–å†³äºåº”ç”¨åœºæ™¯å’Œæ€§èƒ½è¦æ±‚ã€‚ å½“ä¸¤ä¸ªä¸åŒçš„é”®ç»è¿‡å“ˆå¸Œå‡½æ•°æ˜ å°„åå¾—åˆ°ç›¸åŒçš„ä½ç½®æ—¶ï¼Œå°±ä¼šå‘ç”Ÿå“ˆå¸Œå†²çªã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¸¸è§çš„å†²çªè§£å†³æ–¹æ³•åŒ…æ‹¬ï¼š å¼€æ”¾å®šå€æ³•ï¼ˆOpen Addressingï¼‰ï¼šå½“å‘ç”Ÿå†²çªæ—¶ï¼Œé¡ºåºåœ°æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå¯ç”¨çš„ä½ç½®ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç©ºæ§½ä½ã€‚å¸¸è§çš„å¼€æ”¾å®šå€æ³•åŒ…æ‹¬çº¿æ€§æ¢æµ‹ã€äºŒæ¬¡æ¢æµ‹ã€åŒé‡å“ˆå¸Œç­‰ã€‚ é“¾åœ°å€æ³•ï¼ˆChainingï¼‰ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼šå°†å“ˆå¸Œè¡¨çš„æ¯ä¸ªæ§½ä½éƒ½è¿æ¥ä¸€ä¸ªé“¾è¡¨ï¼ˆæˆ–å…¶ä»–æ•°æ®ç»“æ„ï¼‰ï¼Œå½“å‘ç”Ÿå†²çªæ—¶ï¼Œå°†å†²çªçš„å…ƒç´ æ’å…¥åˆ°å¯¹åº”ä½ç½®çš„é“¾è¡¨ä¸­ã€‚è¿™æ ·ï¼Œç›¸åŒå“ˆå¸Œå€¼çš„å…ƒç´ éƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ªé“¾è¡¨ä¸­ã€‚ å†å“ˆå¸Œæ³•ï¼ˆRehashingï¼‰ï¼šä½¿ç”¨å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°è®¡ç®—æ–°çš„å“ˆå¸Œå€¼ï¼Œç„¶åå†æ¬¡æŸ¥æ‰¾ç©ºæ§½ä½ã€‚è¿™æ ·å¯ä»¥å‡å°‘å†²çªçš„æ¦‚ç‡ï¼Œæé«˜å“ˆå¸Œè¡¨çš„æ€§èƒ½ã€‚ å»ºç«‹å…¬å…±æº¢å‡ºåŒºï¼šå°†å“ˆå¸Œè¡¨çš„ä¸€éƒ¨åˆ†ç©ºé—´ä½œä¸ºæº¢å‡ºåŒºï¼Œå½“å‘ç”Ÿå†²çªæ—¶ï¼Œå°†å†²çªçš„å…ƒç´ å­˜å‚¨åœ¨æº¢å‡ºåŒºä¸­ã€‚è¿™æ ·ï¼Œå“ˆå¸Œè¡¨çš„ä¸»è¦éƒ¨åˆ†ä»ç„¶ä¿æŒè¾ƒä½çš„è´Ÿè½½å› å­ï¼Œæé«˜äº†æ€§èƒ½ã€‚ ","date":"2024-06-01","objectID":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/:13:0","tags":[null],"title":"æ•°æ®ç»“æ„ä¸ç®—æ³• é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/02.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E9%9D%A2%E7%BB%8F/"},{"categories":["é¢è¯•","æŠ€æœ¯åŸºç¡€"],"content":" constçŸ¥é“å—ï¼Ÿè§£é‡Šå…¶ä½œç”¨ ä¿®é¥°å˜é‡ï¼Œè¯´æ˜è¯¥å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ï¼› ä¿®é¥°æŒ‡é’ˆï¼Œåˆ†ä¸ºæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼ˆpointer to constï¼‰å’Œè‡ªèº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼ˆå¸¸é‡æŒ‡é’ˆï¼Œconst pointerï¼‰ï¼› ä¿®é¥°å¼•ç”¨ï¼ŒæŒ‡å‘å¸¸é‡çš„å¼•ç”¨ï¼ˆreference to constï¼‰ï¼Œç”¨äºå½¢å‚ç±»å‹ï¼Œæ—¢é¿å…äº†æ‹·è´ï¼Œåˆé¿å…äº†å‡½æ•°å¯¹å€¼çš„ä¿®æ”¹ï¼› ä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œè¯´æ˜è¯¥æˆå‘˜å‡½æ•°å†…ä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡ã€‚ å®å®šä¹‰ #define å’Œ const å¸¸é‡ å®å®šä¹‰ #define const å¸¸é‡ å®å®šä¹‰ï¼Œç›¸å½“äºå­—ç¬¦æ›¿æ¢ | å¸¸é‡å£°æ˜ | é¢„å¤„ç†å™¨å¤„ç† | ç¼–è¯‘å™¨å¤„ç† | æ— ç±»å‹å®‰å…¨æ£€æŸ¥ | æœ‰ç±»å‹å®‰å…¨æ£€æŸ¥ | ä¸åˆ†é…å†…å­˜ | è¦åˆ†é…å†…å­˜ | å­˜å‚¨åœ¨ä»£ç æ®µ | å­˜å‚¨åœ¨æ•°æ®æ®µ | å¯é€šè¿‡ #undef å–æ¶ˆ | ä¸å¯å–æ¶ˆ | staticçš„ä½œç”¨ ä¿®é¥°æ™®é€šå˜é‡ï¼Œä¿®æ”¹å˜é‡çš„å­˜å‚¨åŒºåŸŸå’Œç”Ÿå‘½å‘¨æœŸï¼Œä½¿å˜é‡å­˜å‚¨åœ¨é™æ€åŒºï¼Œåœ¨ main å‡½æ•°è¿è¡Œå‰å°±åˆ†é…äº†ç©ºé—´ï¼Œå¦‚æœæœ‰åˆå§‹å€¼å°±ç”¨åˆå§‹å€¼åˆå§‹åŒ–å®ƒï¼Œå¦‚æœæ²¡æœ‰åˆå§‹å€¼ç³»ç»Ÿç”¨é»˜è®¤å€¼åˆå§‹åŒ–å®ƒã€‚ ä¿®é¥°æ™®é€šå‡½æ•°ï¼Œè¡¨æ˜å‡½æ•°çš„ä½œç”¨èŒƒå›´ï¼Œä»…åœ¨å®šä¹‰è¯¥å‡½æ•°çš„æ–‡ä»¶å†…æ‰èƒ½ä½¿ç”¨ã€‚åœ¨å¤šäººå¼€å‘é¡¹ç›®æ—¶ï¼Œä¸ºäº†é˜²æ­¢ä¸ä»–äººå‘½åç©ºé—´é‡Œçš„å‡½æ•°é‡åï¼Œå¯ä»¥å°†å‡½æ•°å®šä½ä¸º staticã€‚ ä¿®é¥°æˆå‘˜å˜é‡ï¼Œä¿®é¥°æˆå‘˜å˜é‡ä½¿æ‰€æœ‰çš„å¯¹è±¡åªä¿å­˜ä¸€ä¸ªè¯¥å˜é‡ï¼Œè€Œä¸”ä¸éœ€è¦ç”Ÿæˆå¯¹è±¡å°±å¯ä»¥è®¿é—®è¯¥æˆå‘˜ã€‚ ä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œä¿®é¥°æˆå‘˜å‡½æ•°ä½¿å¾—ä¸éœ€è¦ç”Ÿæˆå¯¹è±¡å°±å¯ä»¥è®¿é—®è¯¥å‡½æ•°ï¼Œä½†æ˜¯åœ¨ static å‡½æ•°å†…ä¸èƒ½è®¿é—®éé™æ€æˆå‘˜ã€‚ è¯´è¯´thisæŒ‡é’ˆ this æŒ‡é’ˆæ˜¯ä¸€ä¸ªéšå«äºæ¯ä¸€ä¸ªéé™æ€æˆå‘˜å‡½æ•°ä¸­çš„ç‰¹æ®ŠæŒ‡é’ˆã€‚å®ƒæŒ‡å‘è°ƒç”¨è¯¥æˆå‘˜å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚ å½“å¯¹ä¸€ä¸ªå¯¹è±¡è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œç¼–è¯‘ç¨‹åºå…ˆå°†å¯¹è±¡çš„åœ°å€èµ‹ç»™ this æŒ‡é’ˆï¼Œç„¶åè°ƒç”¨æˆå‘˜å‡½æ•°ï¼Œæ¯æ¬¡æˆå‘˜å‡½æ•°å­˜å–æ•°æ®æˆå‘˜æ—¶ï¼Œéƒ½éšå¼ä½¿ç”¨ this æŒ‡é’ˆã€‚ å½“ä¸€ä¸ªæˆå‘˜å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè‡ªåŠ¨å‘å®ƒä¼ é€’ä¸€ä¸ªéšå«çš„å‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘è¿™ä¸ªæˆå‘˜å‡½æ•°æ‰€åœ¨çš„å¯¹è±¡çš„æŒ‡é’ˆã€‚ this æŒ‡é’ˆè¢«éšå«åœ°å£°æ˜ä¸º: ClassName *const thisï¼Œè¿™æ„å‘³ç€ä¸èƒ½ç»™ this æŒ‡é’ˆèµ‹å€¼ï¼›åœ¨ ClassName ç±»çš„ const æˆå‘˜å‡½æ•°ä¸­ï¼Œthis æŒ‡é’ˆçš„ç±»å‹ä¸ºï¼šconst ClassName* constï¼Œè¿™è¯´æ˜ä¸èƒ½å¯¹ this æŒ‡é’ˆæ‰€æŒ‡å‘çš„è¿™ç§å¯¹è±¡æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼ˆå³ä¸èƒ½å¯¹è¿™ç§å¯¹è±¡çš„æ•°æ®æˆå‘˜è¿›è¡Œèµ‹å€¼æ“ä½œï¼‰ï¼› this å¹¶ä¸æ˜¯ä¸€ä¸ªå¸¸è§„å˜é‡ï¼Œè€Œæ˜¯ä¸ªå³å€¼ï¼Œæ‰€ä»¥ä¸èƒ½å–å¾— this çš„åœ°å€ï¼ˆä¸èƒ½ \u0026thisï¼‰ã€‚ åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ï¼Œç»å¸¸éœ€è¦æ˜¾å¼å¼•ç”¨thisæŒ‡é’ˆï¼š ä¸ºå®ç°å¯¹è±¡çš„é“¾å¼å¼•ç”¨ï¼› ä¸ºé¿å…å¯¹åŒä¸€å¯¹è±¡è¿›è¡Œèµ‹å€¼æ“ä½œï¼› åœ¨å®ç°ä¸€äº›æ•°æ®ç»“æ„æ—¶ï¼Œå¦‚ listã€‚ è¯´è¯´inlineå†…è”å‡½æ•° ç›¸å½“äºæŠŠå†…è”å‡½æ•°é‡Œé¢çš„å†…å®¹å†™åœ¨è°ƒç”¨å†…è”å‡½æ•°å¤„ï¼Œå³ä¸ç”¨æ‰§è¡Œè¿›å…¥å‡½æ•°çš„æ­¥éª¤ï¼Œç›´æ¥æ‰§è¡Œå‡½æ•°ä½“ï¼›ç›¸å½“äºå®ï¼Œå´æ¯”å®å¤šäº†ç±»å‹æ£€æŸ¥ï¼ŒçœŸæ­£å…·æœ‰å‡½æ•°ç‰¹æ€§ï¼›ç¼–è¯‘å™¨ä¸€èˆ¬ä¸å†…è”åŒ…å«å¾ªç¯ã€é€’å½’ã€switch ç­‰å¤æ‚æ“ä½œçš„å†…è”å‡½æ•°ï¼›åœ¨ç±»å£°æ˜ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œé™¤äº†è™šå‡½æ•°çš„å…¶ä»–å‡½æ•°éƒ½ä¼šè‡ªåŠ¨éšå¼åœ°å½“æˆå†…è”å‡½æ•°ï¼ˆä½†è™šå‡½æ•°ä¹Ÿå¯ä»¥æ˜¯å†…è”å‡½æ•°ï¼Œä½†æ˜¯å½“è™šå‡½æ•°è¡¨ç°å‡ºå¤šæ€æ€§æ—¶ä¸èƒ½å†…è”ï¼‰ã€‚ ä¼˜ç‚¹ï¼š å†…è”å‡½æ•°åŒå®å‡½æ•°ä¸€æ ·å°†åœ¨è¢«è°ƒç”¨å¤„è¿›è¡Œä»£ç å±•å¼€ï¼Œçœå»äº†å‚æ•°å‹æ ˆã€æ ˆå¸§å¼€è¾Ÿä¸å›æ”¶ï¼Œç»“æœè¿”å›ç­‰ï¼Œä»è€Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚ åœ¨ç±»ä¸­å£°æ˜åŒæ—¶å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºå†…è”å‡½æ•°ï¼Œå› æ­¤å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œå®å®šä¹‰åˆ™ä¸èƒ½ã€‚ å†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶å¯è°ƒè¯•ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥ã€‚ ç¼ºç‚¹ï¼š ä»£ç è†¨èƒ€ã€‚å†…è”æ˜¯ä»¥ä»£ç è†¨èƒ€ï¼ˆå¤åˆ¶ï¼‰ä¸ºä»£ä»·ï¼Œæ¶ˆé™¤å‡½æ•°è°ƒç”¨å¸¦æ¥çš„å¼€é”€ã€‚å¦‚æœæ‰§è¡Œå‡½æ•°ä½“å†…ä»£ç çš„æ—¶é—´ï¼Œç›¸æ¯”äºå‡½æ•°è°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œé‚£ä¹ˆæ•ˆç‡çš„æ”¶è·ä¼šå¾ˆå°‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¯ä¸€å¤„å†…è”å‡½æ•°çš„è°ƒç”¨éƒ½è¦å¤åˆ¶ä»£ç ï¼Œå°†ä½¿ç¨‹åºçš„æ€»ä»£ç é‡å¢å¤§ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚ inline å‡½æ•°æ— æ³•éšç€å‡½æ•°åº“å‡çº§è€Œå‡çº§ã€‚inlineå‡½æ•°çš„æ”¹å˜éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œä¸åƒ non-inline å¯ä»¥ç›´æ¥é“¾æ¥ã€‚ æ˜¯å¦å†…è”ï¼Œç¨‹åºå‘˜ä¸å¯æ§ã€‚å†…è”å‡½æ•°åªæ˜¯å¯¹ç¼–è¯‘å™¨çš„å»ºè®®ï¼Œæ˜¯å¦å¯¹å‡½æ•°å†…è”ï¼Œå†³å®šæƒåœ¨äºç¼–è¯‘å™¨ã€‚ è¯´è¯´volatileå…³é”®å­— volatile å…³é”®å­—æ˜¯ä¸€ç§ç±»å‹ä¿®é¥°ç¬¦ï¼Œç”¨å®ƒå£°æ˜çš„ç±»å‹å˜é‡è¡¨ç¤ºå¯ä»¥è¢«æŸäº›ç¼–è¯‘å™¨æœªçŸ¥çš„å› ç´ ï¼ˆæ“ä½œç³»ç»Ÿã€ç¡¬ä»¶ã€å…¶å®ƒçº¿ç¨‹ç­‰ï¼‰æ›´æ”¹ã€‚æ‰€ä»¥ä½¿ç”¨ volatile å‘Šè¯‰ç¼–è¯‘å™¨ä¸åº”å¯¹è¿™æ ·çš„å¯¹è±¡è¿›è¡Œä¼˜åŒ–ã€‚ volatile å…³é”®å­—å£°æ˜çš„å˜é‡ï¼Œæ¯æ¬¡è®¿é—®æ—¶éƒ½å¿…é¡»ä»å†…å­˜ä¸­å–å‡ºå€¼ï¼ˆæ²¡æœ‰è¢« volatile ä¿®é¥°çš„å˜é‡ï¼Œå¯èƒ½ç”±äºç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼Œä» CPU å¯„å­˜å™¨ä¸­å–å€¼ï¼‰ const å¯ä»¥æ˜¯ volatile ï¼ˆå¦‚åªè¯»çš„çŠ¶æ€å¯„å­˜å™¨ï¼‰ æŒ‡é’ˆå¯ä»¥æ˜¯ volatile è¯´è¯´assert() æ–­è¨€ï¼Œæ˜¯å®ï¼Œè€Œéå‡½æ•°ã€‚assert å®çš„åŸå‹å®šä¹‰åœ¨ \u003cassert.h\u003eï¼ˆCï¼‰ã€\u003ccassert\u003eï¼ˆC++ï¼‰ä¸­ï¼Œå…¶ä½œç”¨æ˜¯å¦‚æœå®ƒçš„æ¡ä»¶è¿”å›é”™è¯¯ï¼Œåˆ™ç»ˆæ­¢ç¨‹åºæ‰§è¡Œã€‚å¯ä»¥é€šè¿‡å®šä¹‰ NDEBUG æ¥å…³é—­ assertï¼Œä½†æ˜¯éœ€è¦åœ¨æºä»£ç çš„å¼€å¤´ï¼Œinclude \u003cassert.h\u003e ä¹‹å‰ã€‚ static_assert æ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶æ–­è¨€ï¼Œç”¨äºåœ¨ç¼–è¯‘æœŸé—´æ£€æŸ¥å¸¸é‡è¡¨è¾¾å¼æ˜¯å¦ä¸º trueã€‚å®ƒå®šä¹‰åœ¨ C++11 åŠæ›´é«˜ç‰ˆæœ¬çš„æ ‡å‡†ä¸­ã€‚static_assert é€šå¸¸ç”¨äºæ¨¡æ¿ç¼–ç¨‹å’Œå¸¸é‡è¡¨è¾¾å¼ä¸­ï¼Œä»¥ç¡®ä¿æŸäº›ç¼–è¯‘æ—¶æ¡ä»¶æˆç«‹ã€‚ä¸ assert ä¸åŒçš„æ˜¯ï¼Œstatic_assert åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æŸ¥ï¼Œå› æ­¤å®ƒä¸ä¼šå½±å“è¿è¡Œæ—¶æ€§èƒ½ã€‚ è¯´è¯´sizeof() sizeof å¯¹æ•°ç»„ï¼Œå¾—åˆ°æ•´ä¸ªæ•°ç»„æ‰€å ç©ºé—´å¤§å°ã€‚ sizeof å¯¹æŒ‡é’ˆï¼Œå¾—åˆ°æŒ‡é’ˆæœ¬èº«æ‰€å ç©ºé—´å¤§å°ã€‚ #pragma pack(n) è®¾å®šç»“æ„ä½“ã€è”åˆä»¥åŠç±»æˆå‘˜å˜é‡ä»¥ n å­—èŠ‚æ–¹å¼å¯¹é½ï¼Œ#pragma pack(pop) æ¢å¤å¯¹é½çŠ¶æ€ extern \"C\" è¢« extern é™å®šçš„å‡½æ•°æˆ–å˜é‡æ˜¯ extern ç±»å‹çš„ï¼Œè¢« extern â€œCâ€ ä¿®é¥°çš„å˜é‡å’Œå‡½æ•°æ˜¯æŒ‰ç…§ C è¯­è¨€æ–¹å¼ç¼–è¯‘å’Œé“¾æ¥çš„ C++ ä¸­ struct å’Œ class æ€»çš„æ¥è¯´ï¼Œstruct æ›´é€‚åˆçœ‹æˆæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„çš„å®ç°ä½“ï¼Œclass æ›´é€‚åˆçœ‹æˆæ˜¯ä¸€ä¸ªå¯¹è±¡çš„å®ç°ä½“ã€‚ æœ€æœ¬è´¨çš„ä¸€ä¸ªåŒºåˆ«å°±æ˜¯é»˜è®¤çš„è®¿é—®æ§åˆ¶ï¼Œstruct é»˜è®¤çš„æ•°æ®è®¿é—®æ§åˆ¶æ˜¯ public çš„ï¼Œclass é»˜è®¤çš„æˆå‘˜å˜é‡è®¿é—®æ§åˆ¶æ˜¯ private çš„ã€‚ union è”åˆ è”åˆï¼ˆunionï¼‰æ˜¯ä¸€ç§èŠ‚çœç©ºé—´çš„ç‰¹æ®Šçš„ç±»ï¼Œä¸€ä¸ª union å¯ä»¥æœ‰å¤šä¸ªæ•°æ®æˆå‘˜ï¼Œä½†æ˜¯åœ¨ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªæ•°æ®æˆå‘˜å¯ä»¥æœ‰å€¼ã€‚å½“æŸä¸ªæˆå‘˜è¢«èµ‹å€¼åå…¶ä»–æˆå‘˜å˜ä¸ºæœªå®šä¹‰çŠ¶æ€ã€‚è”åˆæœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š é»˜è®¤è®¿é—®æ§åˆ¶ç¬¦ä¸º public å¯ä»¥å«æœ‰æ„é€ å‡½æ•°ã€ææ„å‡½æ•° ä¸èƒ½å«æœ‰å¼•ç”¨ç±»å‹çš„æˆå‘˜ ä¸èƒ½ç»§æ‰¿è‡ªå…¶ä»–ç±»ï¼Œä¸èƒ½ä½œä¸ºåŸºç±» ä¸èƒ½å«æœ‰è™šå‡½æ•° åŒ¿å union åœ¨å®šä¹‰æ‰€åœ¨ä½œç”¨åŸŸå¯ç›´æ¥è®¿é—® union æˆå‘˜ åŒ¿å union ä¸èƒ½åŒ…å« protected æˆå‘˜æˆ– private æˆå‘˜ å…¨å±€åŒ¿åè”åˆå¿…é¡»æ˜¯é™æ€ï¼ˆstaticï¼‰çš„ C å®ç° C++ ç±» C å®ç° C++ çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼ˆå°è£…ã€ç»§æ‰¿ã€å¤šæ€ï¼‰ å°è£…ï¼šä½¿ç”¨å‡½æ•°æŒ‡é’ˆæŠŠå±æ€§ä¸æ–¹æ³•å°è£…åˆ°ç»“æ„ä½“ä¸­ ç»§æ‰¿ï¼šç»“æ„ä½“åµŒå¥— å¤šæ€ï¼šçˆ¶ç±»ä¸å­ç±»æ–¹æ³•çš„å‡½æ•°æŒ‡é’ˆä¸åŒ explicitï¼ˆæ˜¾å¼ï¼‰å…³é”®å­— explicit ä¿®é¥°æ„é€ å‡½æ•°æ—¶ï¼Œå¯ä»¥é˜²æ­¢éšå¼è½¬æ¢å’Œå¤åˆ¶åˆå§‹åŒ– explicit ä¿®é¥°è½¬æ¢å‡½æ•°æ—¶ï¼Œå¯ä»¥é˜²æ­¢éšå¼è½¬æ¢ï¼Œä½† æŒ‰è¯­å¢ƒè½¬æ¢ é™¤å¤– friend å‹å…ƒç±»å’Œå‹å…ƒå‡½æ•° èƒ½è®¿é—®ç§æœ‰æˆå‘˜ ç ´åå°è£…æ€§ å‹å…ƒå…³ç³»ä¸å¯ä¼ é€’ å‹å…ƒå…³ç³»çš„å•å‘æ€§ å‹å…ƒå£°æ˜çš„å½¢å¼åŠæ•°é‡ä¸å—é™åˆ¶ è°ˆè°ˆusing using å…³é”®å­—åœ¨ C++ ä¸­æœ‰å¤šç§ç”¨é€”ï¼Œä¸»è¦åŒ…æ‹¬ç±»å‹åˆ«åã€å¼•å…¥å‘½åç©ºé—´ä¸­çš„æ ‡è¯†ç¬¦ã€‚å¹¶ä¸”C++11 å¼•å…¥äº†åˆ«åæ¨¡æ¿ï¼Œå¯ä»¥ä½¿ç”¨ using åˆ›å»ºæ¨¡æ¿çš„åˆ«åã€‚ å°½é‡å°‘ä½¿ç”¨ using æŒ‡ç¤ºï¼šusing namespace std;ï¼Œä¼šæ±¡æŸ“å‘½åç©ºé—´ :: èŒƒå›´è§£æè¿ç®—ç¬¦ å…¨å±€ä½œç”¨åŸŸç¬¦ï¼ˆ::nameï¼‰ï¼šç”¨äºç±»å‹åç§°ï¼ˆç±»ã€ç±»æˆå‘˜ã€æˆå‘˜å‡½æ•°ã€å˜é‡ç­‰ï¼‰å‰ï¼Œè¡¨ç¤ºä½œç”¨åŸŸä¸ºå…¨å±€å‘½åç©ºé—´ int count = 11; // å…¨å±€ï¼ˆ::ï¼‰çš„ count ::count = 12; // æµ‹è¯• 1ï¼šè®¾ç½®å…¨å±€çš„ count çš„å€¼ä¸º 12 ç±»ä½œç”¨åŸŸç¬¦ï¼ˆclass::nameï¼‰ï¼šç”¨äºè¡¨ç¤ºæŒ‡å®šç±»å‹çš„ä½œç”¨åŸŸèŒƒå›´æ˜¯å…·ä½“æŸä¸ªç±»çš„ class A { public: static int count; // ç±» A çš„ countï¼ˆA::countï¼‰ }; int A::count = 21; å‘½åç©ºé—´ä½œç”¨åŸŸç¬¦ï¼ˆnamespace::nameï¼‰:ç”¨äºè¡¨ç¤ºæŒ‡å®šç±»å‹çš„ä½œç”¨åŸŸèŒƒå›´æ˜¯å…·ä½“æŸä¸ªå‘½åç©ºé—´çš„ std::cout \u003c\u003c \"Hello, World!\" \u003c\u003c std::endl; è°ˆè°ˆdecltypeå…³é”®å­— decltype å…³é”®å­—ç”¨äºæ£€æŸ¥å®ä½“çš„å£°æ˜ç±»å‹æˆ–è¡¨è¾¾å¼çš„ç±»å‹åŠå€¼åˆ†ç±»ï¼Œè¿”å›å€¼ä¸ºæ‰€å±ç±»å‹ã€‚è¯­æ³•ï¼šdecltype ( expression ) è°ˆè°ˆå¼•ç”¨ åœ¨ C++ ä¸­ï¼Œå¼•ç”¨ï¼ˆreferenceï¼‰æ˜¯ä¸€ç§ä¸ºå·²å­˜åœ¨çš„å˜é‡åˆ›å»ºåˆ«åçš„æœºåˆ¶ã€‚å¼•ç”¨å¯ä»¥è®©ä½ é€šè¿‡å¦ä¸€ä¸ªåå­—è®¿é—®åŒä¸€ä¸ªå˜é‡ã€‚C++ ä¸­çš„å¼•ç”¨ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ï¼š å·¦å€¼å¼•ç”¨ï¼ˆL-value Referencesï¼‰ï¼šå·¦å€¼å¼•ç”¨ç”¨äºå¼•ç”¨å†…å­˜ä¸­å·²ç»å­˜åœ¨çš„å¯¹è±¡ï¼Œé€šå¸¸ç”¨äºå‡½æ•°å‚æ•°ä¼ é€’å’Œè¿”å›å€¼ã€‚ å³å€¼å¼•ç”¨ï¼ˆR-value Referencesï¼‰ï¼šå³å€¼å¼•ç”¨åœ¨ C++11 å¼•å…¥ï¼ˆint\u0026\u0026 rvalueRef = 10ï¼‰ï¼Œä¸»è¦ç”¨äºå¼•ç”¨ä¸´æ—¶å¯¹è±¡ï¼ˆå³å€¼ï¼‰ï¼Œæ”¯æŒç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚ å¼•ç”¨æŠ˜å ï¼ˆReference Collapsingï¼‰ï¼šå¼•ç”¨æŠ˜å æ˜¯ä¸€ç§å¤æ‚çš„è§„åˆ™ï¼Œå†³å®šäº†å¤šå±‚å¼•ç”¨çš„ç»“æœã€‚å®ƒåœ¨æ¨¡æ¿ç¼–ç¨‹å’Œå®Œç¾è½¬å‘ä¸­éå¸¸é‡è¦ã€‚ X\u0026 \u0026ã€X\u0026 \u0026\u0026ã€X\u0026\u0026 \u0026 å¯æŠ˜å æˆ X\u0026 X\u0026\u0026 \u0026\u0026 å¯æŠ˜å æˆ X\u0026\u0026 æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ å¥½å¤„ æ›´é«˜æ•ˆï¼šå°‘äº†ä¸€æ¬¡è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°çš„è¿‡ç¨‹ã€‚ æœ‰äº›åœºåˆå¿…é¡»è¦ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼š å¸¸é‡æˆå‘˜ï¼Œå› ä¸ºå¸¸é‡åªèƒ½åˆå§‹åŒ–","date":"2024-06-01","objectID":"/posts/01.c-%E9%9D%A2%E7%BB%8F/:0:0","tags":["C++"],"title":"C/C++ é¢è¯•é¢˜ç›®æ€»ç»“","uri":"/posts/01.c-%E9%9D%A2%E7%BB%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿéš¾ç‚¹ åœ¨è®¾è®¡å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–å­˜å‚¨ç³»ç»Ÿæ—¶ï¼Œåˆè¡·é€šå¸¸æ˜¯ä¸ºäº†è·å¾—æ˜¾è‘—çš„æ€§èƒ½æå‡ï¼Œé€šè¿‡æ•°ç™¾å°è®¡ç®—æœºçš„èµ„æºæ¥å¹¶è¡Œå®Œæˆå¤§é‡å·¥ä½œã€‚å› æ­¤ï¼Œæ€§èƒ½é—®é¢˜æˆä¸ºæœ€åˆçš„å…³æ³¨ç‚¹ã€‚ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯å°†æ•°æ®åˆ†ç‰‡ï¼ˆShardingï¼‰ï¼Œåˆ†å¸ƒåˆ°å¤§é‡æœåŠ¡å™¨ä¸Šï¼Œä»è€Œå¹¶è¡Œè¯»å–æ•°æ®ã€‚ å½“ä½ åœ¨æˆç™¾ä¸Šåƒå°æœåŠ¡å™¨ä¸Šè¿›è¡Œåˆ†ç‰‡æ—¶ï¼ŒæœåŠ¡å™¨æ•…éšœå°†æˆä¸ºå¸¸æ€ã€‚å¦‚æœä½ æœ‰æ•°åƒå°æœåŠ¡å™¨ï¼Œæ¯å¤©ç”šè‡³æ¯å°æ—¶éƒ½å¯èƒ½æœ‰æœåŠ¡å™¨å®•æœºã€‚å› æ­¤ï¼Œéœ€è¦è‡ªåŠ¨åŒ–çš„æ–¹æ³•æ¥ä¿®å¤é”™è¯¯ï¼Œè€Œä¸æ˜¯ä¾èµ–äººå·¥ä»‹å…¥ã€‚ä¸ºæ­¤ï¼Œè‡ªåŠ¨å®¹é”™ç³»ç»Ÿè‡³å…³é‡è¦ï¼Œè¿™å¼•å‡ºäº†å®¹é”™ï¼ˆfault toleranceï¼‰çš„æ¦‚å¿µã€‚ å®ç°å®¹é”™æœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨æ•°æ®å¤åˆ¶ï¼Œåªéœ€ç»´æŠ¤2-3ä¸ªæ•°æ®å‰¯æœ¬ï¼Œå½“å…¶ä¸­ä¸€ä¸ªæ•…éšœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªã€‚å› æ­¤ï¼Œè¦å®ç°å®¹é”™ï¼Œå¿…é¡»è¿›è¡Œæ•°æ®å¤åˆ¶ï¼ˆreplicationï¼‰ã€‚ ç„¶è€Œï¼Œæ•°æ®å¤åˆ¶å¸¦æ¥äº†ä¸ä¸€è‡´æ€§ï¼ˆinconsistencyï¼‰é—®é¢˜ã€‚æ‹¥æœ‰å¤šä¸ªæ•°æ®å‰¯æœ¬ï¼Œå¦‚æœç®¡ç†ä¸å½“ï¼Œå‰¯æœ¬ä¹‹é—´å¯èƒ½ä¸ä¸€è‡´ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¯ä»¥ä»»æ„ä½¿ç”¨ä»»ä¸€å‰¯æœ¬è¿›è¡Œå®¹é”™ï¼Œä½†å¦‚æœå‰¯æœ¬ä¸ä¸€è‡´ï¼Œåº”ç”¨ç¨‹åºå°†é¢ä¸´éº»çƒ¦ã€‚å› æ­¤ï¼Œæ•°æ®å¤åˆ¶ä¸å¯é¿å…åœ°ä¼šå¼•å‘ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚ é€šè¿‡ç²¾å·§çš„è®¾è®¡ï¼Œå¯ä»¥å‡å°‘ç”šè‡³é¿å…ä¸ä¸€è‡´æ€§ï¼Œä½¿æ•°æ®è¡¨ç°å¾—ç¬¦åˆé¢„æœŸã€‚ä½†è¦å®ç°è¿™ä¸€ç‚¹ï¼ŒæœåŠ¡å™¨ä¹‹é—´éœ€è¦è¿›è¡Œé¢å¤–çš„ç½‘ç»œäº¤äº’ï¼Œè¿™ä¼šé™ä½æ€§èƒ½ã€‚å› æ­¤ï¼Œå¦‚æœè¿½æ±‚ä¸€è‡´æ€§ï¼ˆconsistencyï¼‰ï¼Œå¿…é¡»ä»˜å‡ºæ€§èƒ½çš„ä»£ä»·ï¼Œè¿™ä¸æœ€åˆçš„é«˜æ€§èƒ½ç›®æ ‡ç›¸æ‚–ã€‚ å°½ç®¡å¯ä»¥æ„å»ºé«˜æ€§èƒ½ç³»ç»Ÿï¼Œä½†ä¸å¯é¿å…åœ°ä¼šé™·å…¥æ€§èƒ½ä¸ä¸€è‡´æ€§çš„æƒè¡¡ä¹‹ä¸­ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸ºäº†è·å¾—è‰¯å¥½çš„ä¸€è‡´æ€§ï¼Œå¿…é¡»ä»˜å‡ºç›¸åº”çš„ä»£ä»·ã€‚å¦‚æœä¸æ„¿ä»˜å‡ºä»£ä»·ï¼Œå°±éœ€è¦å¿å—ä¸€å®šç¨‹åº¦çš„ä¸ç¡®å®šæ€§ã€‚å¾ˆå¤šç³»ç»Ÿä¸­éƒ½å­˜åœ¨è¿™ç§æƒè¡¡ï¼Œäººä»¬å¾€å¾€ä¸æ„¿ä¸ºé«˜ä¸€è‡´æ€§ç‰ºç‰²æ€§èƒ½ã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 é”™è¯¯çš„è®¾è®¡ å¯¹äºå¼ºä¸€è‡´æ€§ç³»ç»Ÿï¼Œåº”ç”¨ç¨‹åºæˆ–å®¢æˆ·ç«¯æ„Ÿå—åˆ°çš„å°±åƒåœ¨ä¸ä¸€å°æœåŠ¡å™¨é€šä¿¡ã€‚å°½ç®¡ç³»ç»Ÿç”±æ•°ç™¾å°è®¡ç®—æœºç»„æˆï¼Œä½†ç†æƒ³çš„å¼ºä¸€è‡´æ¨¡å‹è®©å®ƒçœ‹èµ·æ¥åƒåªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä¸€ä»½æ•°æ®ï¼Œå¹¶ä¸”ä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†æ¯ä¸ªè¯·æ±‚èƒ½çœ‹åˆ°ä¹‹å‰æ‰€æœ‰è¯·æ±‚æŒ‰é¡ºåºæ‰§è¡Œçš„ç»“æœã€‚ å¯¹äºå­˜å‚¨æœåŠ¡å™¨æ¥è¯´ï¼Œå®ƒé€šå¸¸åŒ…å«ä¸€å—ç£ç›˜ã€‚æ‰§è¡Œå†™è¯·æ±‚å¯èƒ½æ„å‘³ç€å‘ç£ç›˜å†™å…¥æ•°æ®æˆ–å¯¹æ•°æ®è¿›è¡Œè‡ªå¢æ“ä½œã€‚å¦‚æœæ˜¯ä¸€æ¬¡ä¿®æ”¹æ“ä½œï¼Œå¹¶ä¸”æˆ‘ä»¬æœ‰ä¸€ä¸ªä»¥ key-value ä¸ºç´¢å¼•çš„æ•°æ®è¡¨å•ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šæ›´æ–°è¿™ä¸ªè¡¨å•ã€‚å¦‚æœæ˜¯è¯»å–æ“ä½œï¼Œåªéœ€ä»è¡¨å•ä¸­å–å‡ºä¹‹å‰å†™å…¥çš„æ•°æ®å³å¯ã€‚ä¸ºäº†ä¿è¯è¿™ä¸ªç®€å•æœåŠ¡çš„è¡Œä¸ºå¯é¢„æœŸï¼Œéœ€è¦éµå¾ªä¸€ä¸ªè§„åˆ™ï¼šæ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ ·ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½èƒ½çœ‹åˆ°ä¹‹å‰æ‰€æœ‰è¯·æ±‚æŒ‰é¡ºåºæ‰§è¡Œåçš„ç»“æœã€‚å¦‚æœæœåŠ¡å™¨æŒ‰æŸç§é¡ºåºä¾æ¬¡å¤„ç†å†™è¯·æ±‚ï¼Œå½“ä½ è¯»å–æ•°æ®æ—¶ï¼Œä½ å°±èƒ½çœ‹åˆ°é¢„æœŸçš„æ•°æ®ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œå®¢æˆ·ç«¯ C1 å‘èµ·å†™è¯·æ±‚å°† X è®¾ç½®ä¸º 1ï¼ŒåŒæ—¶å®¢æˆ·ç«¯ C2 å‘èµ·å†™è¯·æ±‚å°† X è®¾ç½®ä¸º 2ã€‚å¾… C1 å’Œ C2 çš„å†™è¯·æ±‚éƒ½æ‰§è¡Œå®Œæ¯•åï¼Œå®¢æˆ·ç«¯ C3 å‘é€è¯»å– X çš„è¯·æ±‚ï¼Œå¾—åˆ°ä¸€ä¸ªç»“æœï¼›å®¢æˆ·ç«¯ C4 ä¹Ÿå‘é€è¯»å– X çš„è¯·æ±‚ï¼Œå¾—åˆ°å¦ä¸€ä¸ªç»“æœã€‚æ­¤æ—¶ï¼Œé—®é¢˜æ˜¯è¿™ä¸¤ä¸ªå®¢æˆ·ç«¯çœ‹åˆ°çš„ç»“æœä¼šæ˜¯ä»€ä¹ˆã€‚ å³ä½¿åœ¨ä¸€ä¸ªéå¸¸ç®€å•çš„ç³»ç»Ÿä¸­ï¼Œä»ä¼šå‡ºç°ä¸€äº›æ¨¡ç³Šåœºæ™¯ï¼Œä½¿ä½ æ— æ³•ç¡®å®šç³»ç»Ÿçš„æ‰§è¡Œè¿‡ç¨‹åŠå…¶è¾“å‡ºç»“æœã€‚ä½ åªèƒ½æ ¹æ®ç»“æœåˆ¤æ–­ç³»ç»Ÿæ˜¯å¦ä¿æŒäº†ä¸€è‡´æ€§ã€‚ å¦‚æœ C3 è¯»å– X å¾—åˆ° 2ï¼Œé‚£ä¹ˆ C4 ä¹Ÿåº”è¯¥è¯»å–åˆ° 2ï¼Œå› ä¸ºè¿™è¡¨æ˜å†™ X ä¸º 2 çš„è¯·æ±‚æ˜¯ç¬¬äºŒä¸ªæ‰§è¡Œçš„å†™è¯·æ±‚ã€‚å½“ C4 è¯»å– X æ—¶ï¼Œå†™ X ä¸º 2 åº”è¯¥ä»ç„¶æ˜¯ç¬¬äºŒä¸ªå†™è¯·æ±‚ã€‚ ç„¶è€Œï¼Œå•æœåŠ¡å™¨è®¾è®¡å­˜åœ¨å®¹é”™èƒ½åŠ›å·®çš„é—®é¢˜ã€‚å¦‚æœæœåŠ¡å™¨æ•…éšœæˆ–ç£ç›˜æŸåï¼Œç³»ç»Ÿå°†æ— æ³•ä½¿ç”¨ã€‚å› æ­¤ï¼Œç°å®ä¸­æˆ‘ä»¬ä¼šæ„å»ºå¤šå‰¯æœ¬çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè¿™å¼•å‘äº†ä¸€ç³»åˆ—æ–°çš„é—®é¢˜ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸¤å°æœåŠ¡å™¨ï¼Œæ¯å°æœåŠ¡å™¨éƒ½æœ‰æ•°æ®çš„ä¸€ä»½å®Œæ•´æ‹·è´ï¼Œå¹¶åœ¨ç£ç›˜ä¸Šå­˜å‚¨ä¸€ä¸ª key-value è¡¨å•ã€‚æˆ‘ä»¬å¸Œæœ›è¿™ä¸¤ä¸ªè¡¨å•å®Œå…¨ä¸€è‡´ï¼Œè¿™æ ·å½“ä¸€å°æœåŠ¡å™¨æ•…éšœæ—¶ï¼Œå¯ä»¥åˆ‡æ¢åˆ°å¦ä¸€å°æœåŠ¡å™¨ç»§ç»­è¯»å†™æ“ä½œã€‚ ä¸¤ä¸ªè¡¨å•å®Œå…¨ä¸€è‡´æ„å‘³ç€ï¼Œæ¯ä¸€ä¸ªå†™è¯·æ±‚éƒ½å¿…é¡»åœ¨ä¸¤å°æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œè€Œè¯»è¯·æ±‚åªéœ€è¦åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œå¦åˆ™å°±æ²¡æœ‰å®¹é”™æ€§äº†ã€‚å› ä¸ºå¦‚æœè¯»è¯·æ±‚ä¹Ÿéœ€è¦ä»ä¸¤å°æœåŠ¡å™¨è¯»æ•°æ®ï¼Œé‚£ä¹ˆä¸€å°æœåŠ¡å™¨æ•…éšœæˆ‘ä»¬å°±æ²¡æ³•æä¾›æœåŠ¡äº†ã€‚ç°åœ¨é—®é¢˜æ¥äº†ï¼Œå‡è®¾å®¢æˆ·ç«¯C1å’ŒC2éƒ½æƒ³æ‰§è¡Œå†™è¯·æ±‚ï¼Œå…¶ä¸­ä¸€ä¸ªè¦å†™Xä¸º1ï¼Œå¦ä¸€ä¸ªå†™Xä¸º2ã€‚C1ä¼šå°†å†™Xä¸º1çš„è¯·æ±‚å‘é€ä¸ªä¸¤ä¸ªæœåŠ¡å™¨ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦æ›´æ–°ä¸¤å°æœåŠ¡å™¨ä¸Šçš„æ•°æ®ã€‚C2ä¹Ÿä¼šå°†å†™Xä¸º2çš„è¯·æ±‚å‘é€ç»™ä¸¤ä¸ªæœåŠ¡å™¨ã€‚ è¿™é‡Œä¼šå‡ºç°ä»€ä¹ˆé”™è¯¯å‘¢ï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰åšä»»ä½•äº‹æƒ…æ¥ä¿éšœä¸¤å°æœåŠ¡å™¨ä»¥ç›¸åŒçš„é¡ºåºå¤„ç†è¿™2ä¸ªè¯·æ±‚ã€‚å¦‚æœæœåŠ¡å™¨1ï¼ˆS1ï¼‰å…ˆå¤„ç†C1çš„è¯·æ±‚ï¼Œé‚£ä¹ˆåœ¨å®ƒçš„è¡¨å•é‡Œé¢ï¼ŒXå…ˆæ˜¯1ï¼Œä¹‹åS1çœ‹åˆ°äº†æ¥è‡ªC2çš„è¯·æ±‚ï¼Œä¼šå°†è‡ªå·±è¡¨å•ä¸­çš„Xè¦†ç›–æˆ2ã€‚ä½†æ˜¯ï¼Œå¦‚æœS2æ°å¥½ä»¥ä¸åŒçš„é¡ºåºæ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚ï¼Œé‚£ä¹ˆS2ä¼šå…ˆæ‰§è¡ŒC2çš„è¯·æ±‚ï¼Œå°†Xè®¾ç½®ä¸º2ï¼Œä¹‹åæ”¶åˆ°C1çš„è¯·æ±‚ï¼Œå°†Xè®¾ç½®ä¸º1ã€‚ ä¹‹åï¼Œå¦‚æœå¦å¤–ä¸€äº›å®¢æˆ·ç«¯ï¼Œå‡è®¾C3ä»S1è¯»æ•°æ®ï¼ŒC4ä»S2è¯»æ•°æ®ï¼Œæˆ‘ä»¬å°±ä¼šé¢ä¸´ä¸€ä¸ªå¯æ€•çš„åœºæ™¯ï¼šè¿™ä¸¤ä¸ªå®¢æˆ·ç«¯è¯»å–çš„æ•°æ®ä¸ä¸€æ ·ã€‚ä½†æ˜¯ä»å‰ä¸€ä¸ªä¾‹å­ä¸­çš„ç®€å•æ¨¡å‹å¯ä»¥çœ‹å‡ºï¼Œç›¸è¿çš„è¯»è¯·æ±‚åº”è¯¥è¯»å‡ºç›¸åŒçš„æ•°æ®ã€‚ è¿™é‡Œçš„é—®é¢˜å¯ä»¥ä»¥å¦ä¸€ç§æ–¹å¼æš´éœ²å‡ºæ¥ã€‚å‡è®¾æˆ‘ä»¬å°è¯•ä¿®å¤ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬è®©å®¢æˆ·ç«¯åœ¨S1è¿˜åœ¨çº¿çš„æ—¶å€™ï¼Œåªä»S1è¯»å–æ•°æ®ï¼ŒS1ä¸åœ¨çº¿äº†å†ä»S2è¯»å–æ•°æ®ã€‚è¿™æ ·æœ€å¼€å§‹æ‰€æœ‰çš„å®¢æˆ·ç«¯è¯»Xéƒ½èƒ½å¾—åˆ°2ã€‚ä½†æ˜¯çªç„¶ï¼Œå¦‚æœS1æ•…éšœäº†ï¼Œå°½ç®¡æ²¡æœ‰å†™è¯·æ±‚å°†Xæ”¹æˆ1ï¼Œå®¢æˆ·ç«¯è¯»Xå¾—åˆ°çš„æ•°æ®å°†ä¼šä»2å˜æˆ1ã€‚å› ä¸ºS1æ•…éšœä¹‹åï¼Œæ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½ä¼šåˆ‡æ¢åˆ°S2å»è¯»æ•°æ®ã€‚è¿™ç§æ•°æ®çš„ç¥å¥‡å˜åŒ–ä¸ä»»ä½•å†™æ“ä½œéƒ½æ²¡æœ‰å…³è”ï¼Œå¹¶ä¸”ä¹Ÿä¸å¯èƒ½åœ¨å‰ä¸€ä¸ªä¾‹å­çš„ç®€å•æ¨¡å‹ä¸­å‘ç”Ÿã€‚ å½“ç„¶ï¼Œè¿™é‡Œçš„é—®é¢˜æ˜¯å¯ä»¥ä¿®å¤çš„ï¼Œä¿®å¤éœ€è¦æœåŠ¡å™¨ä¹‹é—´æ›´å¤šçš„é€šä¿¡ï¼Œå¹¶ä¸”å¤æ‚åº¦ä¹Ÿä¼šæå‡ã€‚ç”±äºè·å–å¼ºä¸€è‡´ä¼šå¸¦æ¥ä¸å¯é¿å…çš„å¤æ‚æ€§çš„æå‡ï¼Œæœ‰å¤§é‡çš„æ–¹æ³•å¯ä»¥åœ¨å¥½çš„ä¸€è‡´æ€§å’Œä¸€äº›å°ç‘•ç–µè¡Œä¸ºä¹‹é—´è¿½æ±‚ä¸€ä¸ªå¹³è¡¡ã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 GFSè®¾è®¡ç›®æ ‡ Googleçš„ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªå¤§å‹ä¸”å¿«é€Ÿçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆGFSï¼‰ï¼Œä»¥ä¾¿å„ç§åº”ç”¨ç¨‹åºéƒ½èƒ½å…¨å±€è®¿é—®æ•°æ®ã€‚ä¼ ç»Ÿçš„æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºæ„å»ºç‰¹å®šçš„å­˜å‚¨ç³»ç»Ÿï¼Œä½†è¿™ä¼šå¯¼è‡´é‡å¤å»ºè®¾ã€‚GFS ä½œä¸ºä¸€ä¸ªå…¨å±€é€šç”¨çš„å­˜å‚¨ç³»ç»Ÿï¼Œå…è®¸ä¸åŒåº”ç”¨ç¨‹åºå…±äº«å’Œè®¿é—®æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå­˜å‚¨äº†å¤§é‡äº’è”ç½‘æŠ“å–æ•°æ®åï¼Œå…¶ä»–ç”¨æˆ·å¯ä»¥é€šè¿‡ç”³è¯·æƒé™æŸ¥çœ‹è¿™äº›æ•°æ®ï¼Œå› ä¸ºå¤§å®¶ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿã€‚è¿™æ ·ï¼ŒGoogle å†…éƒ¨çš„äººå‘˜å¯ä»¥æ ¹æ®åå­—è¯»å– GFS ä¸­å¯å…±äº«çš„å†…å®¹ã€‚ ä¸ºäº†å®ç°å¤§å®¹é‡å’Œé«˜é€Ÿæ€§èƒ½ï¼ŒGFS å°†æ•°æ®æ–‡ä»¶è‡ªåŠ¨åˆ†å‰²å¹¶å­˜å‚¨åœ¨å¤šå°æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å¯ä»¥å¹¶è¡Œè¯»å–åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä»è€Œè·å¾—æ›´é«˜çš„èšåˆååé‡ã€‚æ–‡ä»¶åˆ†å‰²å­˜å‚¨è¿˜å…è®¸å­˜å‚¨æ¯”å•ä¸ªç£ç›˜æ›´å¤§çš„æ–‡ä»¶ã€‚ç”±äºå­˜å‚¨ç³»ç»Ÿåˆ†å¸ƒåœ¨æ•°ç™¾å°æœåŠ¡å™¨ä¸Šï¼ŒGFS å…·å¤‡è‡ªåŠ¨æ•…éšœä¿®å¤åŠŸèƒ½ï¼Œä¸éœ€è¦äººå·¥å¹²é¢„æ¥ä¿®å¤æœåŠ¡å™¨æˆ–è¿ç§»æ•°æ®ã€‚ GFS çš„ä¸€äº›ç‰¹å¾å¹¶éè®¾è®¡ç›®æ ‡ã€‚ä¾‹å¦‚ï¼ŒGFS åªåœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒå†…è¿è¡Œï¼Œå¤šä¸ªå‰¯æœ¬å¹¶æœªåˆ†å¸ƒåœ¨å…¨çƒå„åœ°ã€‚ç†è®ºä¸Šï¼Œæ•°æ®å‰¯æœ¬åº”è¯¥åœ°ç†åˆ†æ•£ï¼Œä½†å®ç°èµ·æ¥å¾ˆéš¾ï¼Œæ‰€ä»¥ GFS å±€é™äºå•ä¸ªæ•°æ®ä¸­å¿ƒå†…ã€‚ æ­¤å¤–ï¼ŒGFS é¢å‘ Google å†…éƒ¨ä½¿ç”¨ï¼Œä¾›å·¥ç¨‹å¸ˆå¼€å‘åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸ç›´æ¥é¢å‘æ™®é€šç”¨æˆ·ã€‚è™½ç„¶ Google å¯èƒ½ä¼šå‡ºå”®åŸºäº GFS çš„æœåŠ¡ï¼Œä½† GFS æœ¬èº«å¹¶ä¸å¯¹å¤–æä¾›ã€‚ æœ€åï¼ŒGFS ä¸“æ³¨äºå¯¹å¤§å‹é¡ºåºæ–‡ä»¶çš„è¯»å†™ä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œé“¶è¡Œè´¦æˆ·ç³»ç»Ÿéœ€è¦èƒ½å¤Ÿè¯»å†™å°æ•°æ®å—çš„æ•°æ®åº“ï¼Œè€Œ GFS é’ˆå¯¹ TB çº§åˆ«çš„æ–‡ä»¶è¿›è¡Œä¼˜åŒ–ï¼Œåªæ”¯æŒé¡ºåºå¤„ç†è€Œééšæœºè®¿é—®ã€‚æŸç§ç¨‹åº¦ä¸Šï¼Œå®ƒæ›´åƒæ‰¹å¤„ç†ç³»ç»Ÿï¼Œæ³¨é‡å·¨å¤§çš„ååé‡è€Œéä½å»¶è¿Ÿï¼Œæ¯æ¬¡æ“ä½œéƒ½æ¶‰åŠ MB çº§åˆ«çš„æ•°æ®ã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 MasterèŠ‚ç‚¹ å‡è®¾æˆ‘ä»¬æœ‰ä¸Šç™¾ä¸ªå®¢æˆ·ç«¯å’Œä¸€ä¸ªMasterèŠ‚ç‚¹ã€‚è™½ç„¶å®é™…ä¸­å¯ä»¥æœ‰å¤šå°æœºå™¨ä½œä¸ºMasterèŠ‚ç‚¹ï¼Œä½†GFSä¸­Masteré‡‡ç”¨Active-Standbyæ¨¡å¼ï¼ˆç³»ç»ŸåŒ…å«ä¸¤ä¸ªæˆ–å¤šä¸ªå®ä¾‹ï¼Œå…¶ä¸­ä¸€ä¸ªå®ä¾‹ï¼ˆActiveï¼‰æ­£åœ¨è¿è¡Œå¹¶å¤„ç†æ‰€æœ‰çš„è¯·æ±‚ï¼Œè€Œå…¶ä»–å®ä¾‹ï¼ˆStandbyï¼‰åˆ™å¤„äºå¾…å‘½çŠ¶æ€ï¼Œå‡†å¤‡åœ¨Activeå®ä¾‹å‘ç”Ÿæ•…éšœæ—¶ç«‹å³æ¥ç®¡å·¥ä½œã€‚ï¼‰ï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªMasterèŠ‚ç‚¹åœ¨å·¥ä½œã€‚MasterèŠ‚ç‚¹ä¿å­˜äº†æ–‡ä»¶åå’Œå­˜å‚¨ä½ç½®çš„å¯¹åº”å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¤§é‡çš„ChunkæœåŠ¡å™¨ï¼Œæ¯ä¸ªChunkæœåŠ¡å™¨ä¸Šéƒ½æœ‰1-2å—ç£ç›˜ã€‚ MasterèŠ‚ç‚¹ç®¡ç†æ–‡ä»¶å’ŒChunkçš„ä¿¡æ¯ï¼Œè€ŒChunkæœåŠ¡å™¨å­˜å‚¨å®é™…æ•°æ®ã€‚è¿™ç§è®¾è®¡å°†ç®¡ç†å’Œå­˜å‚¨åˆ†å¼€å¤„ç†ï¼Œæé«˜äº†ç³»ç»Ÿæ•ˆç‡ã€‚åœ¨GFSä¸­ï¼ŒMasterèŠ‚ç‚¹çŸ¥é“æ¯ä¸ªæ–‡ä»¶å¯¹åº”çš„æ‰€æœ‰Chunk handleï¼Œè¿™äº›Chunkæ¯ä¸ªæ˜¯64MBå¤§å°ï¼Œå…±åŒæ„æˆä¸€ä¸ªæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª1GBçš„æ–‡ä»¶ä¼šåˆ†æˆå¤šä¸ªChunkï¼ŒMasterèŠ‚ç‚¹çŸ¥é“æ¯ä¸ªChunkå­˜å‚¨åœ¨å“ªã€‚è¯»å–æ–‡ä»¶æ—¶ï¼Œéœ€è¦å…ˆå‘MasterèŠ‚ç‚¹æŸ¥è¯¢Chunkä½ç½®ï¼Œç„¶åä»å¯¹åº”çš„ChunkæœåŠ¡å™¨è¯»å–æ•°æ®ã€‚ æˆ‘ä»¬éœ€è¦äº†è§£MasterèŠ‚ç‚¹å†…ä¿å­˜çš„æ•°æ®å†…å®¹ï¼Œè¿™é‡Œæˆ‘ä»¬å…³å¿ƒçš„ä¸»è¦æ˜¯ä¸¤ä¸ªè¡¨å•ï¼š æ–‡ä»¶ååˆ°Chunk handleçš„å¯¹åº”å…³ç³»ï¼šMasterèŠ‚ç‚¹æœ‰ä¸€ä¸ªè¡¨å•è®°å½•äº†æ–‡ä»¶ååˆ°Chunk handleæ•°ç»„çš„å¯¹åº”å…³ç³»ã€‚ Chunk handleåˆ°Chunkæ•°æ®çš„å¯¹åº”å…³ç³»ï¼šå¦ä¸€ä¸ªè¡¨å•è®°å½•äº†Chunk handleå’Œå®ƒä»¬çš„æ•°æ®çš„å¯¹åº”å…³ç³»ï¼ŒåŒ…æ‹¬æ¯ä¸ªChunkçš„æœåŠ¡å™¨åˆ—è¡¨ã€å½“å‰ç‰ˆæœ¬å·ã€ä¸»Chunkï¼ˆPrimary Chunkï¼‰å’Œç§Ÿçº¦è¿‡æœŸæ—¶é—´ã€‚ è¿™äº›æ•°æ®éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä½†ä¸ºäº†é˜²æ­¢æ•°æ®ä¸¢å¤±ï¼ŒMasterèŠ‚ç‚¹ä¹Ÿå°†éƒ¨åˆ†æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚MasterèŠ‚ç‚¹çš„å†™æ“ä½œä¼šè®°å½•åˆ°ç£ç›˜çš„æ—¥å¿—ï¼ˆlogï¼‰ä¸­ï¼Œå¹¶å®šæœŸç”Ÿæˆæ£€æŸ¥ç‚¹ï¼ˆCheckPointï¼‰ã€‚ æœ‰äº›æ•°æ®éœ€è¦å­˜åœ¨ç£ç›˜ä¸Šï¼Œè€Œæœ‰äº›ä¸ç”¨ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ï¼š Chunk Handleæ•°ç»„ï¼ˆéæ˜“å¤±æ€§ï¼ŒNVï¼‰ï¼šä¿å­˜åˆ°ç£ç›˜ä¸Šã€‚ ChunkæœåŠ¡å™¨åˆ—è¡¨ï¼ˆæ˜“å¤±æ€§ï¼ŒVï¼‰ï¼šä¸ç”¨å†™å…¥ç£ç›˜ï¼Œé‡å¯åå¯é‡æ–°è·å–ã€‚ ç‰ˆæœ¬å·ï¼ˆéæ˜“å¤±æ€§ï¼ŒNVï¼‰ï¼šå†™å…¥ç£ç›˜ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚ ä¸»Chunkçš„handleï¼ˆæ˜“å¤±æ€§ï¼ŒVï¼‰ï¼šä¸å†™å…¥ç£ç›˜ï¼Œé‡å¯åå¯é‡æ–°åˆ†é…ã€‚ ç§Ÿçº¦è¿‡æœŸæ—¶é—´ï¼ˆæ˜“å¤±æ€§ï¼ŒVï¼‰ï¼šä¸å†™å…¥ç£ç›˜ã€‚ å½“æ–‡ä»¶æ‰©å±•åˆ°æ–°çš„64MBæˆ–ä¸»Chunkå˜æ›´æ—¶ï¼ŒMasterèŠ‚ç‚¹ä¼šå‘ç£ç›˜æ—¥å¿—ä¸­è¿½åŠ è®°å½•ã€‚è¿™ç§æ—¥å¿—è¿½åŠ æ–¹å¼æ¯”æ•°æ®åº“é«˜æ•ˆï¼Œå› ä¸ºå®ƒåªéœ€é¡ºåºå†™å…¥ï¼Œä¸æ¶‰åŠç£ç›˜çš„éšæœºè®¿é—®ã€‚ MasterèŠ‚ç‚¹æ•…éšœé‡å¯æ—¶ï¼Œä¼šä»æœ€è¿‘çš„æ£€æŸ¥ç‚¹å¼€å§‹æ¢å¤çŠ¶æ€ï¼Œç„¶åé€šè¿‡æ‰§è¡Œæ—¥å¿—ä¸­çš„è®°å½•æ¢å¤åˆ°æœ€æ–°çŠ¶æ€ã€‚è¿™ç§æ–¹å¼é¿å…äº†ä»æ—¥å¿—æœ€å¼€å§‹é‡å»ºçŠ¶æ€çš„ä½æ•ˆé—®é¢˜ã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 è¯»æ–‡ä»¶ å¯¹äºè¯»è¯·æ±‚æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºæˆ–GFSå®¢æˆ·ç«¯ä¼šæä¾›ä¸€ä¸ªæ–‡ä»¶åå’Œè¯»å–çš„åç§»é‡ï¼ˆoffsetï¼‰ã€‚é¦–å…ˆï¼Œå®¢æˆ·ç«¯å°†è¿™äº›ä¿¡æ¯å‘é€ç»™MasterèŠ‚ç‚¹ã€‚MasterèŠ‚ç‚¹ä»è‡ªå·±çš„æ–‡ä»¶è¡¨å•ä¸­æŸ¥æ‰¾æ–‡ä»¶åï¼Œè·å–å¯¹åº”çš„Chunk handleæ•°ç»„ã€‚æ¯ä¸ªChunkå¤§å°ä¸º64MBï¼Œå› æ­¤å¯ä»¥é€šè¿‡åç§»é‡é™¤ä»¥64MBæ¥ç¡®å®šå¯¹åº”çš„Chunk handleã€‚æ¥ç€ï¼ŒMasterèŠ‚ç‚¹ä»Chunkè¡¨å•ä¸­æ‰¾åˆ°åŒ…å«è¯¥Chunkçš„æœåŠ¡å™¨åˆ—è¡¨ï¼Œå¹¶å°†è¿™ä¸ªåˆ—è¡¨è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š å®¢æˆ·ç«¯ï¼ˆæˆ–åº”ç”¨ç¨‹åºï¼‰å°†æ–‡ä»¶åå’Œåç§»é‡å‘é€ç»™MasterèŠ‚ç‚¹ã€‚ MasterèŠ‚ç‚¹å°†Chunk Handleï¼ˆå³Chunk IDï¼‰å’ŒæœåŠ¡å™¨åˆ—è¡¨å‘é€ç»™å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯æ¥ä¸‹æ¥å¯ä»¥ä»æœåŠ¡å™¨åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªæœåŠ¡å™¨æ¥è¯»å–æ•°æ®ã€‚æ ¹æ®GFSè®ºæ–‡çš„æè¿°ï¼Œå®¢æˆ·ç«¯ä¼šé€‰æ‹©ä¸€ä¸ªåœ¨ç½‘ç»œä¸Šæœ€è¿‘çš„æœåŠ¡å™¨ï¼ˆåœ¨Googleçš„æ•°æ®ä¸­å¿ƒä¸­ï¼Œé€šè¿‡IPåœ°å€çš„å·®å¼‚å¯ä»¥åˆ¤æ–­ç½‘ç»œä½ç½®çš„è¿œè¿‘ï¼‰ï¼Œç„¶åå°†è¯»è¯·æ±‚å‘é€åˆ°è¿™ä¸ªæœåŠ¡å™¨ã€‚ç”±äºå®¢æˆ·ç«¯æ¯æ¬¡å¯èƒ½åªè¯»å–1MBæˆ–64KBçš„æ•°æ®ï¼Œå®ƒå¯èƒ½ä¼šå¤šæ¬¡è¯»å–åŒä¸€ä¸ªChunkçš„ä¸åŒéƒ¨åˆ†ã€‚ä¸ºæ­¤ï¼Œå®¢æˆ·ç«¯ä¼šç¼“å­˜Chunkå’ŒæœåŠ¡å™¨çš„å¯¹åº”å…³ç³»ï¼Œè¿™æ ·åœ¨åç»­è¯»å–ç›¸åŒChunkæ•°æ®æ—¶ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½å‘Masterè¯·æ±‚ç›¸åŒçš„ä¿¡æ¯ã€‚ æ¥ä¸‹æ¥ï¼Œå®¢æˆ·ç«¯ä¼šä¸é€‰å®šçš„ChunkæœåŠ¡å™¨é€šä¿¡ï¼Œå°†Chunk Handleå’Œåç§»é‡å‘é€ç»™è¯¥æœåŠ¡å™¨ã€‚ChunkæœåŠ¡å™¨åœ¨æœ¬åœ°ç¡¬ç›˜ä¸Šå°†æ¯ä¸ªChunkå­˜å‚¨ä¸ºç‹¬ç«‹çš„Linuxæ–‡ä»¶ï¼Œå¹¶é€šè¿‡æ™®é€šçš„Linuxæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œç®¡ç†ã€‚å¯ä»¥æ¨æµ‹ï¼ŒChunkæ–‡ä»¶ä¼šæŒ‰ç…§Handleï¼ˆå³IDï¼‰å‘½åã€‚å› æ­¤ï¼ŒChunkæœåŠ¡å™¨éœ€è¦åšçš„å°±æ˜¯æ ¹æ®æ–‡ä»¶åæ‰¾åˆ°å¯¹åº”çš„Chunkæ–‡ä»¶ï¼Œä»æ–‡ä»¶ä¸­è¯»å–ç›¸åº”çš„æ•°æ®æ®µï¼Œå¹¶å°†æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 å†™æ–‡ä»¶ å¯¹äºåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå†™æ–‡ä»¶çš„è¿‡ç¨‹ä¸è¯»æ–‡ä»¶çš„æ¥å£éå¸¸ç±»ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡è°ƒç”¨GFSçš„åº“å‡½æ•°è¿›è¡Œæ“ä½œã€‚åœ¨å†™æ–‡ä»¶æ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šå‘Šè¯‰åº“å‡½æ•°ï¼Œè¦å°†ç¼“å†²åŒºä¸­çš„æ•°æ®è¿½åŠ åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ã€‚ä¸ºäº†ç®€åŒ–è®¨è®ºï¼Œæˆ‘ä»¬åªè€ƒè™‘GFSè®ºæ–‡ä¸­çš„è®°å½•è¿½åŠ ï¼ˆRecord Appendï¼‰çš„æƒ…å†µã€‚ æ‰€ä»¥å†æ¬¡æè¿°ä¸€ä¸‹ï¼Œå¯¹äºå†™æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯ä¼šå‘MasterèŠ‚ç‚¹å‘é€è¯·æ±‚è¯´ï¼šæˆ‘æƒ³å‘è¿™ä¸ªæ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶è¿½åŠ æ•°æ®ï¼Œè¯·å‘Šè¯‰æˆ‘æ–‡ä»¶ä¸­æœ€åä¸€ä¸ªChunkçš„ä½ç½®ã€‚ å½“æœ‰å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å†™åŒä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯å¹¶ä¸èƒ½çŸ¥é“æ–‡ä»¶ç©¶ç«Ÿæœ‰å¤šé•¿ã€‚å› ä¸ºå¦‚æœåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯åœ¨å†™æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯è‡ªå·±å¯ä»¥è®°å½•æ–‡ä»¶é•¿åº¦ï¼Œè€Œå¤šä¸ªå®¢æˆ·ç«¯æ—¶ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯æ²¡æ³•çŸ¥é“å…¶ä»–å®¢æˆ·ç«¯å†™äº†å¤šå°‘ã€‚ä¾‹å¦‚ï¼Œä¸åŒå®¢æˆ·ç«¯å†™åŒä¸€ä»½æ—¥å¿—æ–‡ä»¶ï¼Œæ²¡æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯ä¼šçŸ¥é“æ–‡ä»¶ç©¶ç«Ÿæœ‰å¤šé•¿ï¼Œå› æ­¤ä¹Ÿå°±ä¸çŸ¥é“è¯¥å¾€ä»€ä¹ˆæ ·çš„åç§»é‡ï¼Œæˆ–è€…è¯´å‘å“ªä¸ªChunkå»è¿½åŠ æ•°æ®ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘MasterèŠ‚ç‚¹æŸ¥è¯¢å“ªä¸ªChunkæœåŠ¡å™¨ä¿å­˜äº†æ–‡ä»¶çš„æœ€åä¸€ä¸ªChunkã€‚ å¯¹äºè¯»æ“ä½œï¼Œå¯ä»¥ä»ä»»ä½•æœ€æ–°çš„Chunkå‰¯æœ¬è¯»å–æ•°æ®ï¼Œä½†å†™æ“ä½œå¿…é¡»é€šè¿‡Chunkçš„ä¸»å‰¯æœ¬ï¼ˆPrimary Chunkï¼‰è¿›è¡Œã€‚MasterèŠ‚ç‚¹éœ€è¦ç¡®ä¿Chunkçš„ä¸»å‰¯æœ¬å­˜åœ¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼ŒMasterèŠ‚ç‚¹ä¼šæŸ¥æ‰¾æ‰€æœ‰å­˜æœ‰è¯¥Chunkæœ€æ–°å‰¯æœ¬çš„ChunkæœåŠ¡å™¨ã€‚MasterèŠ‚ç‚¹ç¡®å®šå“ªäº›å‰¯æœ¬æ˜¯æœ€æ–°çš„ï¼ˆå‰¯æœ¬ä¸­ä¿å­˜çš„ç‰ˆæœ¬å·ä¸Masterä¸­è®°å½•çš„Chunkçš„ç‰ˆæœ¬å·ä¸€è‡´ï¼‰ï¼Œå¹¶ä»ä¸­é€‰æ‹©ä¸€ä¸ªä½œä¸ºPrimaryï¼Œå…¶ä½™ä½œä¸ºSecondaryã€‚ ä¹‹åï¼ŒMasterèŠ‚ç‚¹å¢åŠ Chunkçš„ç‰ˆæœ¬å·ï¼Œå¹¶å°†æ–°çš„ç‰ˆæœ¬å·å†™å…¥ç£ç›˜ã€‚MasterèŠ‚ç‚¹é€šçŸ¥Primaryå’ŒSecondaryæœåŠ¡å™¨æ–°çš„Chunkç‰ˆæœ¬å·ï¼Œå¹¶æŒ‡å®šå®ƒä»¬çš„è§’è‰²ã€‚Primaryå’ŒSecondaryæœåŠ¡å™¨å°†æ–°ç‰ˆæœ¬å·å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸­ï¼Œä»¥ä¾¿åœ¨é‡å¯æ—¶æŠ¥å‘Šç»™Masterã€‚ æ‰€ä»¥å®¢æˆ·ç«¯å°†è¦è¿½åŠ çš„æ•°æ®å‘é€ç»™Primaryå’ŒSecondaryæœåŠ¡å™¨ï¼Œè¿™äº›æœåŠ¡å™¨å°†æ•°æ®å†™å…¥ä¸´æ—¶ä½ç½®ã€‚æ‰€ä»¥æœ€å¼€å§‹ï¼Œè¿™äº›æ•°æ®ä¸ä¼šè¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚å½“æ‰€æœ‰æœåŠ¡å™¨ç¡®è®¤æ•°æ®å·²å†™å…¥ä¸´æ—¶ä½ç½®åï¼Œå®¢æˆ·ç«¯å‘Primaryå‘é€æ¶ˆæ¯ï¼Œè¦æ±‚å°†æ•°æ®è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚PrimaryæŒ‰ç…§é¡ºåºå¤„ç†æ¥è‡ªå¤šä¸ªå®¢æˆ·ç«¯çš„å¹¶å‘è¯·æ±‚ï¼Œç¡®ä¿æ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ªè¯·æ±‚ã€‚Primaryå°†æ•°æ®å†™å…¥Chunkçš„æœ«å°¾ï¼Œå¹¶é€šçŸ¥æ‰€æœ‰SecondaryæœåŠ¡å™¨ä¹Ÿå°†æ•°æ®å†™å…¥å®ƒä»¬çš„Chunkæœ«å°¾ã€‚ SecondaryæœåŠ¡å™¨å°†æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜åï¼Œå‘Primaryå‘é€ç¡®è®¤æ¶ˆæ¯ã€‚å¦‚æœæ‰€æœ‰SecondaryæœåŠ¡å™¨æˆåŠŸå†™å…¥æ•°æ®å¹¶å›å¤â€œyesâ€ï¼ŒPrimaryå‘å®¢æˆ·ç«¯è¿”å›å†™å…¥æˆåŠŸã€‚å¦‚æœä»»ä½•SecondaryæœåŠ¡å™¨å†™å…¥å¤±è´¥ï¼ŒPrimaryå‘å®¢æˆ·ç«¯è¿”å›å†™å…¥å¤±è´¥ã€‚ å¦‚æœå®¢æˆ·ç«¯æ¥åˆ°å†™å…¥å¤±è´¥çš„æ¶ˆæ¯ï¼Œåº”é‡æ–°å‘èµ·æ•´ä¸ªè¿½åŠ è¿‡ç¨‹ã€‚é¦–å…ˆï¼Œå®¢æˆ·ç«¯å†æ¬¡ä¸MasterèŠ‚ç‚¹äº¤äº’ï¼Œæ‰¾åˆ°æ–‡ä»¶æœ«å°¾çš„Chunkï¼Œç„¶åé‡æ–°å‘Primaryå’ŒSecondaryå‘èµ·è¿½åŠ æ“ä½œã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:6:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 GFSçš„ä¸€è‡´æ€§ åœ¨GFSä¸­ï¼Œè¿½åŠ æ•°æ®çš„è¿‡ç¨‹ç›¸å¯¹å¤æ‚ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šè¿™ä¸€è¿‡ç¨‹ã€‚ **æ•°æ®è¿½åŠ è¯·æ±‚ï¼š**å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¿½åŠ æ•°æ®çš„è¯·æ±‚ï¼Œä¾‹å¦‚æ•°æ®Aï¼Œè¦å°†æ•°æ®Aè¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ã€‚Chunkçš„ä¸‰ä¸ªå‰¯æœ¬ï¼ˆä¸€ä¸ªPrimaryå’Œä¸¤ä¸ªSecondaryï¼‰éƒ½æˆåŠŸå°†æ•°æ®Aè¿½åŠ åˆ°äº†Chunkä¸­ï¼Œå› æ­¤Chunkä¸­çš„ç¬¬ä¸€ä¸ªè®°å½•æ˜¯Aã€‚ **ç½‘ç»œé—®é¢˜å¯¼è‡´çš„éƒ¨åˆ†å†™å…¥ï¼š**ç¬¬äºŒä¸ªå®¢æˆ·ç«¯åŠ å…¥ï¼Œæƒ³è¦è¿½åŠ æ•°æ®Bã€‚ä½†ç”±äºç½‘ç»œé—®é¢˜ï¼Œæ¶ˆæ¯åªè¢«Primaryå’Œä¸€ä¸ªSecondaryæ”¶åˆ°å¹¶å¤„ç†ã€‚å› æ­¤ï¼Œä¸¤ä¸ªå‰¯æœ¬è¿½åŠ äº†æ•°æ®Bï¼Œè€Œå¦ä¸€ä¸ªå‰¯æœ¬æ²¡æœ‰ã€‚ **åç»­å†™å…¥ï¼š**ç¬¬ä¸‰ä¸ªå®¢æˆ·ç«¯æƒ³è¦è¿½åŠ æ•°æ®Cï¼Œå¹¶ä¸”Primaryé€‰æ‹©äº†åç§»é‡å¹¶é€šçŸ¥Secondaryã€‚ä¸‰ä¸ªå‰¯æœ¬éƒ½æˆåŠŸè¿½åŠ äº†æ•°æ®Cã€‚ **å¤„ç†å†™å…¥å¤±è´¥ï¼š**ç”±äºç½‘ç»œé—®é¢˜ï¼Œç¬¬äºŒä¸ªå®¢æˆ·ç«¯ä¼šæ”¶åˆ°å†™å…¥å¤±è´¥çš„å›å¤ï¼Œå¹¶é‡æ–°å‘èµ·è¿½åŠ æ•°æ®Bçš„è¯·æ±‚ã€‚å‡è®¾è¿™æ¬¡æ•°æ®Bæ²¡æœ‰ä¸¢åŒ…ï¼Œä¸‰ä¸ªå‰¯æœ¬éƒ½æˆåŠŸè¿½åŠ äº†æ•°æ®Bã€‚ç°åœ¨ï¼Œä¸‰ä¸ªå‰¯æœ¬éƒ½åœ¨çº¿ï¼Œå¹¶ä¸”éƒ½æœ‰æœ€æ–°çš„ç‰ˆæœ¬å·ã€‚ **è¯»å–æ•°æ®çš„å½±å“ï¼š**å®¢æˆ·ç«¯è¯»å–æ–‡ä»¶æ—¶ï¼Œè¯»å–çš„å†…å®¹å–å†³äºè¯»å–çš„æ˜¯å“ªä¸ªå‰¯æœ¬ã€‚ä¾‹å¦‚ï¼š è¯»å–ç¬¬ä¸€ä¸ªå‰¯æœ¬æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°æ•°æ®Aã€Bã€Cï¼Œç„¶åæ˜¯é‡å¤çš„Bã€‚ è¯»å–ç¬¬ä¸‰ä¸ªå‰¯æœ¬æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°æ•°æ®Aã€ä¸€ä¸ªç©ºç™½æ•°æ®ã€ç„¶åæ˜¯Cã€Bã€‚ æ‰€ä»¥ä¸åŒçš„è¯»è¯·æ±‚å¯èƒ½å¾—åˆ°ä¸åŒçš„ç»“æœï¼Œå…·ä½“å–å†³äºè¯»å–çš„æ˜¯å“ªä¸ªå‰¯æœ¬ã€‚ **å¤„ç†å†™å…¥å¤±è´¥çš„å¤æ‚æƒ…å†µï¼š**åœ¨æœ€åæƒ…å†µä¸‹ï¼ŒæŸä¸ªSecondaryæœªèƒ½æˆåŠŸæ‰§è¡Œæ•°æ®è¿½åŠ æ“ä½œï¼Œå®¢æˆ·ç«¯ä»Primaryæ”¶åˆ°å†™å…¥å¤±è´¥çš„å›å¤ã€‚åœ¨å®¢æˆ·ç«¯é‡æ–°å‘é€å†™æ–‡ä»¶è¯·æ±‚ä¹‹å‰ï¼Œå®¢æˆ·ç«¯å¯èƒ½æ•…éšœï¼Œå¯¼è‡´æ•°æ®Dåªå­˜åœ¨äºæŸäº›å‰¯æœ¬ä¸­ï¼Œè€Œå…¶ä»–å‰¯æœ¬å®Œå…¨æ²¡æœ‰ã€‚ åœ¨GFSçš„è¿™ç§å·¥ä½œæ–¹å¼ä¸‹ï¼Œå¦‚æœPrimaryè¿”å›å†™å…¥æˆåŠŸï¼Œä¸€åˆ‡æ­£å¸¸ã€‚å¦‚æœPrimaryè¿”å›å†™å…¥å¤±è´¥ï¼Œä¸åŒå‰¯æœ¬çš„æ•°æ®å¯èƒ½ä¸åŒã€‚GFSçš„è®¾è®¡ç®€å•ï¼Œä½†å¯èƒ½ä¼šæš´éœ²ä¸€äº›å¥‡æ€ªçš„æ•°æ®é¡ºåºé—®é¢˜ã€‚åº”ç”¨ç¨‹åºéœ€è¦å®¹å¿æ•°æ®ä¹±åºï¼Œæˆ–é€šè¿‡åœ¨æ–‡ä»¶ä¸­å†™å…¥åºåˆ—å·æ¥è¯†åˆ«é¡ºåºã€‚å¦‚æœåº”ç”¨ç¨‹åºå¯¹æ•°æ®é¡ºåºæ•æ„Ÿï¼Œå¯ä»¥é¿å…å¹¶å‘å†™å…¥ï¼Œä¾‹å¦‚ï¼Œç”µå½±æ–‡ä»¶çš„å†™å…¥åº”ä½¿ç”¨ä¸€ä¸ªå®¢æˆ·ç«¯é¡ºåºè¿½åŠ æ•°æ®ã€‚ å¦‚æœè¦å°†GFSå‡çº§ä¸ºå¼ºä¸€è‡´ç³»ç»Ÿï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š **æ£€æµ‹é‡å¤è¯·æ±‚ï¼š**Primaryéœ€è¦èƒ½å¤Ÿæ£€æµ‹é‡å¤çš„è¯·æ±‚ï¼Œç¡®ä¿æ•°æ®ä¸ä¼šé‡å¤å†™å…¥ã€‚ **Secondaryçš„å¼ºåˆ¶æ‰§è¡Œï¼š**Secondaryå¿…é¡»æ‰§è¡ŒPrimaryçš„è¯·æ±‚ï¼Œè€Œä¸èƒ½ç®€å•åœ°è¿”å›é”™è¯¯ã€‚å¯¹äºæ°¸ä¹…æ€§æ•…éšœçš„Secondaryï¼Œéœ€è¦æœ‰æœºåˆ¶å°†å…¶ç§»é™¤ã€‚ **ä¸¤é˜¶æ®µæäº¤ï¼š**å†™è¯·æ±‚éœ€è¦ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆPrimaryå‘Secondaryå‘å‡ºè¯·æ±‚å¹¶ç­‰å¾…ç¡®è®¤ï¼›å¦‚æœæ‰€æœ‰Secondaryéƒ½ç¡®è®¤ï¼ŒPrimaryå†æŒ‡ç¤ºå®é™…æ‰§è¡Œæ“ä½œã€‚ **å¤„ç†Primaryå´©æºƒï¼š**å½“Primaryå´©æºƒæ—¶ï¼Œæ–°Primaryéœ€è¦ä¸SecondaryåŒæ­¥ï¼Œç¡®ä¿æ“ä½œå†å²ä¸€è‡´ã€‚ **Secondaryçš„ç§Ÿçº¦ç³»ç»Ÿï¼š**Secondaryéœ€è¦ä¸€ä¸ªç±»ä¼¼Primaryçš„ç§Ÿçº¦ç³»ç»Ÿï¼Œç¡®ä¿åœ¨åˆæ³•æ—¶é—´å†…å“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚ æ€»ä½“è€Œè¨€ï¼ŒGFSå–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œè®¸å¤šGoogleçš„åº”ç”¨éƒ½ä¾èµ–äºå®ƒã€‚ä¾‹å¦‚ï¼ŒBigTableå’ŒMapReduceç­‰å…³é”®åŸºç¡€æ¶æ„éƒ½æ˜¯æ„å»ºåœ¨GFSä¹‹ä¸Šçš„ï¼Œå› æ­¤GFSåœ¨Googleå†…éƒ¨å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚ç„¶è€Œï¼ŒGFSä¹Ÿæœ‰å…¶å±€é™æ€§ï¼Œæœ€ä¸¥é‡çš„é—®é¢˜åœ¨äºå®ƒåªæœ‰ä¸€ä¸ªMasterèŠ‚ç‚¹ï¼Œè¿™å¸¦æ¥äº†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š **å†…å­˜é™åˆ¶ï¼š**MasterèŠ‚ç‚¹å¿…é¡»ä¸ºæ¯ä¸ªæ–‡ä»¶å’Œæ¯ä¸ªChunkç»´æŠ¤è¡¨å•ã€‚éšç€ä½¿ç”¨é‡çš„å¢åŠ ï¼Œæ–‡ä»¶æ•°é‡ä¸æ–­ä¸Šå‡ï¼Œæœ€ç»ˆMasterèŠ‚ç‚¹ä¼šè€—å°½å†…å­˜æ¥å­˜å‚¨è¿™äº›è¡¨å•ã€‚è™½ç„¶å¯ä»¥å¢åŠ å†…å­˜ï¼Œä½†å•å°è®¡ç®—æœºçš„å†…å­˜æ€»æœ‰ä¸Šé™ï¼Œè¿™æˆä¸ºäº†æ—©æœŸé‡åˆ°çš„ä¸€ä¸ªæ˜¾è‘—é—®é¢˜ã€‚ **å¤„ç†èƒ½åŠ›ï¼š**å•ä¸ªMasterèŠ‚ç‚¹éœ€è¦å¤„ç†æ•°åƒä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œè€Œå…¶CPUæ¯ç§’åªèƒ½å¤„ç†æ•°ç™¾ä¸ªè¯·æ±‚ã€‚å°¤å…¶å½“MasterèŠ‚ç‚¹è¿˜éœ€è¦å°†éƒ¨åˆ†æ•°æ®å†™å…¥ç£ç›˜æ—¶ï¼Œè¿™ä¸ªé—®é¢˜å˜å¾—æ›´åŠ ä¸¥é‡ï¼Œå¯¼è‡´å®¢æˆ·ç«¯æ•°é‡å¾ˆå¿«è¶…è¿‡äº†å•ä¸ªMasterçš„å¤„ç†èƒ½åŠ›ã€‚ **å¤æ‚çš„è¯­ä¹‰ï¼š**åº”ç”¨ç¨‹åºå‘ç°å¾ˆéš¾å¤„ç†GFSå¤æ‚çš„è¯­ä¹‰ï¼Œç‰¹åˆ«æ˜¯å‰¯æœ¬æ•°æ®åŒæ­¥é—®é¢˜ï¼ˆæˆ–ä¸åŒæ­¥é—®é¢˜ï¼‰ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†å¼€å‘éš¾åº¦ã€‚ **æ•…éšœåˆ‡æ¢ï¼š**ä»GFSè®ºæ–‡ä¸­å¯ä»¥äº†è§£åˆ°ï¼ŒMasterèŠ‚ç‚¹çš„æ•…éšœåˆ‡æ¢ä¸æ˜¯è‡ªåŠ¨çš„ã€‚å½“MasterèŠ‚ç‚¹æ°¸ä¹…æ•…éšœæ—¶ï¼Œéœ€è¦äººå·¥å¹²é¢„æ¥æ›´æ¢æ–°çš„æœåŠ¡å™¨ï¼Œè¿™å¯èƒ½éœ€è¦å‡ ååˆ†é’Ÿç”šè‡³æ›´é•¿æ—¶é—´æ¥å¤„ç†ã€‚å¯¹äºæŸäº›åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè¿™æ ·çš„åœæœºæ—¶é—´æ˜¯ä¸å¯æ¥å—çš„ã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:7:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 FAQ åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“Chunkçš„å“ªäº›éƒ¨åˆ†ç”±å¡«å……å’Œé‡å¤è®°å½•ç»„æˆï¼Ÿ ä¸ºäº†æ£€æµ‹å¡«å……ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åœ¨æœ‰æ•ˆè®°å½•çš„å¼€å¤´æ”¾ç½®ä¸€ä¸ªå¯é¢„æµ‹çš„å¹»æ•°ï¼Œæˆ–è€…åŒ…å«ä¸€ä¸ªæ ¡éªŒå’Œï¼Œè¯¥æ ¡éªŒå’Œå¯èƒ½ä»…åœ¨è®°å½•æœ‰æ•ˆæ—¶æ‰æœ‰æ•ˆã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡åœ¨è®°å½•ä¸­åŒ…å«å”¯ä¸€ ID æ¥æ£€æµ‹é‡å¤é¡¹ã€‚ç„¶åï¼Œå¦‚æœå®ƒè¯»å–çš„è®°å½•ä¸ä¹‹å‰çš„è®°å½•å…·æœ‰ç›¸åŒçš„ IDï¼Œå®ƒå°±çŸ¥é“å®ƒä»¬æ˜¯å½¼æ­¤çš„é‡å¤é¡¹ã€‚ GFS ä¸ºå¤„ç†è¿™äº›æƒ…å†µçš„åº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªåº“ã€‚ GFS è®¾è®¡çš„è¿™ä¸€æ–¹é¢æœ‰æ•ˆåœ°å°†å¤æ‚æ€§ä» GFS è½¬ç§»åˆ°äº†åº”ç”¨ç¨‹åºï¼Œä½†è¿™å¯èƒ½å¹¶ä¸ç†æƒ³ã€‚ æ€æ ·çŸ¥é“ä¸€ä¸ªæ–‡ä»¶å­˜å‚¨åœ¨å“ªå°æœºå™¨ä¸Šï¼Ÿ æ ¹æ®masterä¸­æ–‡ä»¶åˆ°chunkå†åˆ°chunkä½ç½®çš„æ˜ å°„æ¥å®šä½å…·ä½“çš„chunkserverã€‚ è®ºæ–‡æåˆ°äº†å¼•ç”¨è®¡æ•°â€”â€”å®ƒä»¬æ˜¯ä»€ä¹ˆï¼Ÿ å®ƒä»¬æ˜¯å¿«ç…§å†™æ—¶å¤åˆ¶å®ç°çš„ä¸€éƒ¨åˆ†ã€‚å½“GFSåˆ›å»ºå¿«ç…§æ—¶ï¼Œå®ƒä¸ä¼šå¤åˆ¶å—ï¼Œè€Œæ˜¯å¢åŠ æ¯ä¸ªå—çš„å¼•ç”¨è®¡æ•°å™¨ã€‚è¿™ä½¿å¾—åˆ›å»ºå¿«ç…§çš„æˆæœ¬å¾ˆä½ã€‚å¦‚æœå®¢æˆ·ç«¯å†™å…¥ä¸€ä¸ªchunkå¹¶ä¸”ä¸»æœåŠ¡å™¨æ³¨æ„åˆ°å¼•ç”¨è®¡æ•°å¤§äº 1ï¼Œåˆ™ä¸»æœåŠ¡å™¨é¦–å…ˆåˆ›å»ºä¸€ä¸ªå‰¯æœ¬ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯å¯ä»¥æ›´æ–°è¯¥å‰¯æœ¬ï¼ˆè€Œä¸æ˜¯å±äºå¿«ç…§ä¸€éƒ¨åˆ†çš„å—ï¼‰ã€‚æ‚¨å¯ä»¥å°†æ­¤è§†ä¸ºå»¶è¿Ÿå¤åˆ¶ï¼Œç›´åˆ°ç»å¯¹å¿…è¦ä¸ºæ­¢ã€‚å¸Œæœ›å¹¶éæ‰€æœ‰å—éƒ½ä¼šè¢«ä¿®æ”¹ï¼Œå¹¶ä¸”å¯ä»¥é¿å…åˆ¶ä½œä¸€äº›å‰¯æœ¬ã€‚ ä»€ä¹ˆæ˜¯ç§Ÿçº¦ï¼Ÿ å¯¹äº GFSï¼Œç§Ÿçº¦æ˜¯masteræˆäºˆ chunkserver å……å½“ç‰¹å®š chunk çš„ä¸»chunkserverçš„èƒ½åŠ›çš„ä¸€æ®µæ—¶é—´ã€‚masterä¿è¯åœ¨ç§Ÿçº¦æœŸé—´ä¸ä¼šåˆ†é…ä¸åŒçš„ä¸»chunkserverï¼Œå¹¶ä¸”ä¸»æœåŠ¡å™¨åŒæ„åœ¨ç§Ÿçº¦åˆ°æœŸä¹‹å‰åœæ­¢å……å½“ä¸»chunkserverï¼ˆé™¤éä¸»chunkserverè¦æ±‚masterå»¶é•¿ç§Ÿçº¦ï¼‰ã€‚ç§Ÿçº¦æ˜¯é¿å…ä¸»chunkserverå¿…é¡»åå¤è¯¢é—®masteræ˜¯å¦ä»ç„¶æ˜¯ä¸»chunkserverçš„ä¸€ç§æ–¹æ³•â€”å®ƒçŸ¥é“å®ƒå¯ä»¥åœ¨ä¸‹ä¸€åˆ†é’Ÿï¼ˆæˆ–æ— è®ºç§Ÿçº¦é—´éš”æ˜¯å¤šå°‘ï¼‰å……å½“ä¸»chunkserverï¼Œè€Œæ— éœ€å†æ¬¡ä¸masteré€šä¿¡ã€‚ ä»€ä¹ˆæ˜¯å†…éƒ¨ç¢ç‰‡ï¼Ÿä¸ºä»€ä¹ˆæƒ°æ€§åˆ†é…æœ‰å¸®åŠ©ï¼Ÿ å†…éƒ¨ç¢ç‰‡æ˜¯å½“ç³»ç»Ÿä½¿ç”¨å¤§äºæ‰€è¯·æ±‚åˆ†é…æ‰€éœ€çš„åˆ†é…å•å…ƒæ—¶æµªè´¹çš„ç©ºé—´ã€‚å¦‚æœ GFS ä»¥ 64MB ä¸ºå•ä½åˆ†é…ç£ç›˜ç©ºé—´ï¼Œé‚£ä¹ˆä¸€ä¸ª 1 å­—èŠ‚çš„æ–‡ä»¶å°†æµªè´¹è¿‘ 64MB çš„ç£ç›˜ç©ºé—´ã€‚ GFS é€šè¿‡å»¶è¿Ÿåˆ†é…ç£ç›˜ç©ºé—´æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚æ¯ä¸ªå—éƒ½æ˜¯ä¸€ä¸ªLinuxæ–‡ä»¶ï¼ŒLinuxæ–‡ä»¶ç³»ç»Ÿä½¿ç”¨çš„å—å¤§å°ä¸ºå‡ åKBï¼›å› æ­¤ï¼Œå½“åº”ç”¨ç¨‹åºåˆ›å»ºä¸€å­—èŠ‚ GFS æ–‡ä»¶æ—¶ï¼Œè¯¥æ–‡ä»¶çš„å—ä»…æ¶ˆè€— 1 ä¸ª Linux ç£ç›˜å—ï¼Œè€Œä¸æ˜¯ 64 MBã€‚ Google è¿˜åœ¨ä½¿ç”¨ GFS å—ï¼Ÿ æœ‰ä¼ è¨€ç§° GFS å·²è¢« Colossus æ‰€å–ä»£ï¼Œæ€»ä½“ç›®æ ‡ç›¸åŒï¼Œä½†åœ¨ä¸»æ€§èƒ½å’Œå®¹é”™æ€§æ–¹é¢æœ‰æ‰€æ”¹è¿›ã€‚æ­¤å¤–ï¼ŒGoogleå†…éƒ¨çš„è®¸å¤šåº”ç”¨ç¨‹åºå·²ç»è½¬å‘æ›´å¤šç±»ä¼¼æ•°æ®åº“çš„å­˜å‚¨ç³»ç»Ÿï¼Œä¾‹å¦‚BigTableå’ŒSpannerã€‚ç„¶è€Œï¼ŒGFS çš„å¤§éƒ¨åˆ†è®¾è®¡ä»ç„¶å­˜åœ¨äº HDFSï¼ˆHadoop å¼€æº MapReduce çš„å­˜å‚¨ç³»ç»Ÿï¼‰ä¸­ã€‚ ","date":"2024-05-28","objectID":"/posts/04.gfs/:8:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘GFS","uri":"/posts/04.gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"Testing Distributed Systems for Linearizability åŸæ–‡ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:0:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¼•è¨€ æ­£ç¡®å®ç°ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯éå¸¸æœ‰æŒ‘æˆ˜çš„ä¸€ä»¶äº‹æƒ…ï¼Œå› ä¸ºéœ€è¦å¾ˆå¥½çš„å¤„ç†å¹¶å‘å’Œå¤±è´¥è¿™äº›é—®é¢˜ã€‚ç½‘ç»œåŒ…å¯èƒ½è¢«å»¶è¿Ÿï¼Œé‡å¤ï¼Œä¹±åºæˆ–è€…ä¸¢å¼ƒï¼Œæœºå™¨å¯èƒ½åœ¨ä»»ä½•æ—¶å€™å®•æœºã€‚å³ä½¿ä¸€äº›è®¡è¢«è®ºæ–‡è¯æ˜æ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿä»ç„¶å¾ˆéš¾å†å®ç°ä¸­é¿å… bugã€‚ é™¤éæˆ‘ä»¬ä½¿ç”¨å½¢å¼æ–¹æ³•ï¼Œä¸ç„¶ï¼Œå³ä½¿æˆ‘ä»¬å‡è®¾å®ç°æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å»æµ‹è¯•ç³»ç»Ÿã€‚æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿä¹Ÿæ˜¯ä¸€ä»¶éå¸¸æœ‰æŒ‘æˆ˜çš„äº‹æƒ…ã€‚å¹¶å‘å’Œä¸ç¡®å®šæ€§ä½¿å¾—æˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™éå¸¸éš¾æŠ“ä½ bugï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº›æç«¯æƒ…å†µä¸‹é¢æ‰ä¼šå‡ºç°çš„ bugï¼Œè­¬å¦‚åŒæ—¶æœºå™¨å®•æœºæˆ–è€…æç«¯ç½‘ç»œå»¶è¿Ÿã€‚ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æ­£ç¡®æ€§ åœ¨è®¨è®ºæµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ­£ç¡®æ€§ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸‹ä»€ä¹ˆæ˜¯ â€œæ­£ç¡®æ€§â€ã€‚å³ä½¿å¯¹äºä¸€äº›ç®€å•çš„ç³»ç»Ÿï¼Œè¦å®Œå…¨çš„ç¡®å®šç³»ç»Ÿç¬¦åˆé¢„æœŸä¹Ÿæ˜¯ä¸€ä»¶ç›¸å½“å¤æ‚çš„äº‹æƒ…ã€‚ è€ƒè™‘ä¸€ä¸ªç®€å•çš„ key-value storeï¼Œè­¬å¦‚ etcdï¼Œæ”¯æŒä¸¤ä¸ªæ“ä½œï¼šPut(key, value) å’Œ Get(key)ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å®ƒåœ¨é¡ºåºæƒ…å†µä¸‹é¢çš„è¡Œä¸ºã€‚ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 é¡ºåºè§„èŒƒ é€šå¸¸å¯¹äºä¸€ä¸ª key-value storeï¼Œæˆ‘ä»¬å¯¹äºå®ƒåœ¨é¡ºåºæ“ä½œä¸‹é¢çš„è¡Œä¸ºéƒ½èƒ½æœ‰ä¸€ä¸ªç›´è§‚çš„è®¤è¯†ï¼šGet æ“ä½œå¦‚æœåœ¨ Put çš„åé¢ï¼Œé‚£ä¹ˆä¸€å®šèƒ½å¾—åˆ° Put çš„ç»“æœã€‚è­¬å¦‚ï¼Œå¦‚æœ Put(\"x\", \"y\") ï¼Œé‚£ä¹ˆåé¢çš„ Get(\"x\") å°±èƒ½å¾—åˆ° â€œyâ€ï¼Œå¦‚æœå¾—åˆ°äº† â€œzâ€ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸å¯¹çš„ã€‚ æˆ‘ä»¬ä½¿ç”¨ Python å®šä¹‰ä¸€ä¸ªç®€å•çš„ key-value storeï¼š ä¸Šé¢çš„ä»£ç æ¯”è¾ƒç®€å•ï¼Œä½†åŒ…å«äº†è¶³å¤Ÿçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆå§‹çŠ¶æ€æ˜¯æ€æ ·çš„ï¼Œå†…éƒ¨çŠ¶æ€æ˜¯å¦‚ä½•è¢«æ“ä½œçš„ç»“æœæ”¹å˜çš„ï¼Œä» key-valueå­˜å‚¨é‡Œé¢æ“ä½œè¿”å›çš„ç»“æœæ˜¯æ€æ ·çš„ã€‚è¿™é‡Œéœ€è¦ç•™æ„ä¸‹ Get() å¯¹äºä¸å­˜åœ¨çš„ key çš„å¤„ç†ï¼Œé€šå¸¸ä¼šè¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:2:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 çº¿æ€§ä¸€è‡´æ€§ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è€ƒè™‘æˆ‘ä»¬çš„ key-value storeåœ¨å¹¶å‘ä¸‹é¢ä¼šæœ‰æ€æ ·çš„è¡Œä¸ºã€‚éœ€è¦æ³¨æ„é¡ºåºè§„èŒƒå¹¶æ²¡æœ‰æŒ‡æ˜åœ¨å¹¶å‘æ“ä½œä¸‹é¢ä¼šå‘ç”Ÿä»€ä¹ˆã€‚è­¬å¦‚ï¼Œé¡ºåºè§„èŒƒå¹¶æ²¡æœ‰è¯´ key-value store åœ¨ä¸‹é¢è¿™ä¸ªåœºæ™¯ä¸‹å¯ä»¥å…è®¸çš„æ“ä½œã€‚ æˆ‘ä»¬å¹¶ä¸èƒ½ç«‹åˆ»çŸ¥é“ Get(\"x\") è¿™ä¸ªæ“ä½œä¼šå…è®¸è¿”å›æ€æ ·çš„ç»“æœã€‚ç›´è§‰ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¯´Get(\"x\") æ˜¯è·Ÿ Put(\"x\", \"y\") å’Œ Put(\"x\", \"z\") ä¸€èµ·æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¯èƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œç”šè‡³ä¹Ÿå¯èƒ½è¿”å› \"\"ã€‚ å¦‚æœæœ‰å¦ä¸€ä¸ª Get(\"x\") çš„æ“ä½œåœ¨æ›´åé¢æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥è¯´è¿™ä¸ªä¸€å®šèƒ½è¿”å› \"z\"ï¼Œå› ä¸ºå®ƒæ˜¯æœ€åä¸€æ¬¡å†™å…¥çš„å€¼ï¼Œè€Œä¸”é‚£ä¸ªæ—¶å€™å¹¶æ²¡æœ‰å…¶ä»–çš„å¹¶å‘å†™å…¥ã€‚ å¯¹äºä¸€ä¸ªåŸºäºé¡ºåºè§„èŒƒçš„å¹¶å‘æ“ä½œæ¥è¯´ï¼Œæˆ‘ä»¬ä¼šç”¨ä¸€ä¸ªä¸€è‡´æ€§æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯çº¿æ€§ä¸€è‡´æ€§æ¥è¯´æ˜å®ƒçš„æ­£ç¡®æ€§ã€‚åœ¨ä¸€ä¸ªçº¿æ€§ä¸€è‡´æ€§çš„ç³»ç»Ÿé‡Œé¢ï¼Œä»»ä½•æ“ä½œéƒ½å¯èƒ½åœ¨è°ƒç”¨æˆ–è€…è¿”å›ä¹‹é—´åŸå­å’Œç¬é—´æ‰§è¡Œã€‚é™¤äº†çº¿æ€§ä¸€è‡´æ€§ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–ä¸€è‡´æ€§çš„æ¨¡å‹ï¼Œä½†å¤šæ•°åˆ†å¸ƒå¼ç³»ç»Ÿéƒ½æä¾›äº†çº¿æ€§ä¸€è‡´æ€§çš„æ“ä½œï¼šçº¿æ€§ä¸€è‡´æ€§æ˜¯ä¸€ä¸ªå¼ºçš„ä¸€è‡´æ€§æ¨¡å‹ï¼Œå¹¶ä¸”åŸºäºçº¿æ€§ä¸€è‡´æ€§ç³»ç»Ÿï¼Œå¾ˆå®¹æ˜“å»æ„å»ºå…¶ä»–çš„ç³»ç»Ÿã€‚è€ƒè™‘åˆ°å¦‚ä¸‹å¯¹ key-value store æ“ä½œçš„å†å²ä¾‹å­ï¼š è¿™ä¸ªå†å²æ˜¯ä¸€ä¸ªçº¿æ€§çš„ã€‚åœ¨ä¸‹é¢å›¾ç‰‡çš„è“è‰²åœ°æ–¹ï¼Œæˆ‘ä»¬ç°å®çš„æ ‡æ˜äº†çº¿æ€§ä¸€è‡´çš„ç‚¹ã€‚è¿™ä¸ªé¡ºåºå†å² Put(\"x\", \"0\"), Get(\"x\") -\u003e \"0\", Put(\"x\", \"1\"), Get(\"x\") -\u003e \"1\"ï¼Œå¯¹äºé¡ºåºè§„èŒƒæ¥è¯´å°±æ˜¯ä¸€ä¸ªæ­£ç¡®çš„å†å²ã€‚ å¯¹åº”çš„ï¼Œä¸‹é¢çš„å†å²å°±ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ã€‚ å¯¹äºé¡ºåºè§„èŒƒæ¥è¯´ï¼Œè¿™ä¸ªå†å²å¹¶ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼šæˆ‘ä»¬å¹¶ä¸èƒ½åœ¨è¿™ä¸ªå†å²çš„æ“ä½œé‡Œé¢æŒ‡å®šå‡ºçº¿æ€§ä¸€è‡´çš„ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥ç”»å‡º client 1ï¼Œ2 å’Œ 3 çš„ï¼Œä½†æˆ‘ä»¬å¹¶ä¸èƒ½ç”»å‡º client 4 çš„ï¼Œå› ä¸ºè¿™æ˜æ˜¾æ˜¯ä¸€ä¸ªè¿‡æœŸçš„å€¼ã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”»å‡º client 1ï¼Œ2 å’Œ 4 çš„ï¼Œé‚£ä¹ˆ client 2 çš„æ“ä½œä¸€å®šä¼šåœ¨ 4 çš„æ“ä½œå¼€å§‹çš„åé¢ï¼Œä½†è¿™æ ·æˆ‘ä»¬å°±ä¸èƒ½å¤„ç† client 3ï¼Œå®ƒåªå¯èƒ½åˆæ³•çš„è¿”å› \"\"æˆ–è€… \"0\"ã€‚ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 æµ‹è¯• æœ‰äº†ä¸€ä¸ªæ­£ç¡®æ€§çš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘å¦‚ä½•å»æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿäº†ã€‚é€šå¸¸çš„åšæ³•å°±æ˜¯å¯¹äºæ­£ç¡®çš„æ“ä½œï¼Œä¸åœçš„è¿›è¡Œéšæœºçš„é”™è¯¯æ³¨å…¥ï¼Œç±»ä¼¼æœºå™¨å®•æœºï¼Œç½‘ç»œéš”ç¦»ç­‰ã€‚æˆ‘ä»¬ç”šè‡³èƒ½æ¨¡æ‹Ÿæ•´ä¸ªç½‘ç»œï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åšé•¿æ—¶é—´çš„ç½‘ç»œå»¶è¿Ÿç­‰ã€‚å› ä¸ºæµ‹è¯•æ—¶éšæœºçš„ï¼Œæˆ‘ä»¬éœ€è¦è·‘å¾ˆå¤šæ¬¡ä»è€Œç¡®å®šä¸€ä¸ªç³»ç»Ÿçš„å®ç°æ˜¯æ­£ç¡®çš„ã€‚ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.1 ä¸´æ—¶æµ‹è¯• æˆ‘ä»¬å®é™…å¦‚ä½•åšæ­£ç¡®æ“ä½œçš„æµ‹è¯•å‘¢ï¼Ÿåœ¨æœ€ç®€å•çš„è½¯ä»¶é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¾“å…¥è¾“å‡ºæµ‹è¯•ï¼Œè­¬å¦‚ assert(expected_output == f(input))ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸Šé¢ä½¿ç”¨ä¸€ä¸ªç±»ä¼¼çš„æ–¹æ³•ï¼Œè­¬å¦‚ï¼Œå¯¹äº key-value storeï¼Œå½“å¤šä¸ª client å¼€å§‹æ‰§è¡Œæ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰å¦‚ä¸‹çš„æµ‹è¯•ï¼š å¦‚æœæµ‹è¯•æŒ‚æ‰äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªç³»ç»Ÿä¸€å®šä¸æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæµ‹è¯•å¹¶ä¸æ˜¯å¾ˆå®Œå¤‡ï¼Œå› ä¸ºæœ‰å¯èƒ½ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿä¹Ÿå¯èƒ½é€šè¿‡è¿™ä¸ªæµ‹è¯•ã€‚ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:4:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.2 çº¿æ€§ä¸€è‡´æ€§ ä¸€ä¸ªæ›´å¥½çš„åŠæ³•å°±æ˜¯å¹¶å‘çš„å®¢æˆ·ç«¯å®Œå…¨è·‘éšæœºçš„æ“ä½œã€‚è­¬å¦‚ï¼Œå¾ªç¯çš„å»è°ƒç”¨ kvstore.put(rand(), rand()) å’Œ kvstore.get(rand())ï¼Œæœ‰å¯èƒ½ä¼šåªç”¨å¾ˆå°‘çš„ key å»å¢å¤§å†²çªçš„æ¦‚ç‡ã€‚ä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•å®šä¹‰ä»€ä¹ˆæ˜¯æ­£ç¡®çš„æ“ä½œå‘¢ï¼Ÿåœ¨ä¸Šé¢çš„ç®€å•çš„æµ‹è¯•é‡Œé¢ï¼Œå› ä¸ºæ¯ä¸ª client éƒ½æ“ä½œçš„æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ keyï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éå¸¸æ˜ç¡®çš„çŸ¥é“è¾“å‡ºç»“æœã€‚ ä½†æ˜¯ clients å¹¶å‘çš„æ“ä½œåŒä¸€å † keysï¼Œäº‹æƒ…å°±å˜å¾—å¤æ‚äº†ã€‚æˆ‘ä»¬å¹¶ä¸èƒ½é¢„çŸ¥æ¯ä¸ªæ“ä½œçš„è¿”å›å€¼å› ä¸ºè¿™å¹¶æ²¡æ ·ä¸€ä¸ªå”¯ä¸€çš„ç­”æ¡ˆã€‚ä½†æˆ‘ä»¬å¯ä»¥ç”¨å¦ä¸€ä¸ªåŠæ³•ï¼šæˆ‘ä»¬å¯ä»¥è®°å½•æ•´ä¸ªæ“ä½œçš„å†å²ï¼Œç„¶åå»éªŒè¯è¿™ä¸ªæ“ä½œå†å²æ˜¯çº¿æ€§ä¸€è‡´çš„ã€‚ 4.2.1 çº¿æ€§ä¸€è‡´æ€§éªŒè¯ ä¸€ä¸ªçº¿æ€§ä¸€è‡´æ€§éªŒè¯å™¨ä¼šä½¿ç”¨ä¸€ä¸ªé¡ºåºè§„èŒƒå’Œä¸€ä¸ªå¹¶å‘æ“ä½œçš„å†å²ï¼Œç„¶åæ‰§è¡Œä¸€ä¸ªåˆ¤å®šç¨‹åºå»æ£€æŸ¥è¿™ä¸ªå†å²åœ¨è§„èŒƒä¸‹é¢æ˜¯å¦çº¿æ€§ä¸€è‡´ã€‚ 4.2.2 NP å®Œå¤‡ ä½†ä¸å¹¸çš„æ˜¯ï¼Œçº¿æ€§ä¸€è‡´æ€§éªŒè¯æ˜¯ NP å®Œå¤‡çš„ã€‚è¿™ä¸ªè¯æ˜éå¸¸ç®€å•ï¼šæˆ‘ä»¬èƒ½è¯´æ˜çº¿æ€§ä¸€è‡´æ€§éªŒè¯æ˜¯ NP é—®é¢˜ï¼Œå¹¶ä¸”ä¹Ÿèƒ½å±•ç¤ºä¸€ä¸ª NP å›°éš¾é—®é¢˜èƒ½è¢«ç®€åŒ–æˆçº¿æ€§ä¸€è‡´æ€§éªŒè¯ã€‚æ˜æ˜¾çš„ï¼Œçº¿æ€§ä¸€è‡´æ€§éªŒè¯æ˜¯ NP é—®é¢˜ï¼Œè­¬å¦‚ï¼Œæ‰€æœ‰æ“ä½œçš„çº¿æ€§ä¸€è‡´æ€§ç‚¹ï¼Œæ ¹æ®ç›¸å…³çš„é¡ºåºè§„èŒƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´é‡ŒéªŒè¯ã€‚ ä¸ºäº†è¯´æ˜çº¿æ€§ä¸€è‡´æ€§éªŒè¯æ˜¯ NP å›°éš¾çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å­é›†åˆé—®é¢˜ç®€åŒ–æˆçº¿æ€§ä¸€è‡´æ€§éªŒè¯ã€‚å¯¹äºå­é›†åˆé—®é¢˜ï¼Œæˆ‘ä»¬ç»™å‡ºéè´Ÿæ•°çš„é›†åˆ $S={s_1,s_2,â€¦,s_n}$ å’Œç›®æ ‡ç»“æœ $t$ï¼Œç„¶åæˆ‘ä»¬å¿…é¡»ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå­é›† $S$ çš„å’Œç­‰äº $t$ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªé—®é¢˜ç®€åŒ–æˆå¦‚ä¸‹çš„çº¿æ€§ä¸€è‡´æ€§éªŒè¯ã€‚è€ƒè™‘é¡ºåºè§„èŒƒï¼š ä»¥åŠå†å²ï¼š å½“ä¸”ä»…å½“å­é›†å’Œé—®é¢˜çš„ç­”æ¡ˆä¸ºâ€œæ˜¯â€æ—¶ï¼Œè¯¥å†å²æ‰å¯çº¿æ€§åŒ–ã€‚å¦‚æœå†å²æ˜¯å¯çº¿æ€§åŒ–çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨åœ¨ Get() æ“ä½œä¹‹å‰å…·æœ‰çº¿æ€§åŒ–ç‚¹çš„æ‰€æœ‰æ“ä½œ Add(s_i) ï¼Œå¹¶ä¸”è¿™äº›æ“ä½œå¯¹åº”äºä¸­çš„å…ƒç´  $s_i$æ€»å’Œä¸º $t$ çš„å­é›†ã€‚å¦‚æœè¯¥é›†åˆç¡®å®æœ‰ä¸€ä¸ªæ€»å’Œä¸º$t$çš„å­é›†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸å­é›†ä¸­çš„å…ƒç´ $s_i$å¯¹åº”çš„æ“ä½œ Add(s_i) æ¥æ„é€ çº¿æ€§åŒ–æ”¾ç½®åœ¨ Get() æ“ä½œä¹‹å‰ï¼Œå¹¶ä½¿å…¶ä½™æ“ä½œå‘ç”Ÿåœ¨ Get() æ“ä½œä¹‹åã€‚ 4.2.3 å®ç° å³ä½¿çº¿æ€§ä¸€è‡´æ€§éªŒè¯æ˜¯ NP å®Œå…¨çš„ï¼Œåœ¨å®é™…ä¸­ï¼Œå®ƒä»ç„¶èƒ½åœ¨ä¸€äº›å°çš„å†å²ä¸Šé¢å¾ˆå¥½çš„å·¥ä½œã€‚çº¿æ€§ä¸€è‡´æ€§éªŒè¯å™¨çš„å®ç°ä¼šç”¨ä¸€ä¸ªå¯æ‰§è¡Œçš„è§„èŒƒï¼ŒåŠ ä¸Šä¸€ä¸ªå†å²ï¼Œæ‰§è¡Œä¸€ä¸ªæœç´¢è¿‡ç¨‹å»æ„é€ ä¸€ä¸ªçº¿æ€§åŒ–ï¼Œå¹¶ä½¿ç”¨ä¸€äº›æŠ€å·§æ¥é™åˆ¶å‡å°‘æœç´¢çš„ç©ºé—´ã€‚ ç°æœ‰çš„çº¿æ€§åŒ–æ£€æŸ¥å™¨å¦‚ Knossosï¼Œç”¨äº Jepsen æµ‹è¯•ç³»ç»Ÿã€‚ä½†ä¸å¹¸çš„æ˜¯ï¼Œåœ¨æµ‹è¯•ä¸€äº›åˆ†å¸ƒå¼ key-value store çš„æ—¶å€™ï¼ŒKnossos å¹¶ä¸èƒ½å¾ˆå¥½çš„å·¥ä½œï¼Œå®ƒå¯èƒ½åªèƒ½é€‚ç”¨äºä¸€äº›å°‘çš„å¹¶å‘ clientsï¼Œä»¥åŠåªæœ‰å‡ ç™¾çš„äº‹ä»¶çš„å†å²ã€‚ä½†åœ¨ä¸€äº›æµ‹è¯•é‡Œé¢ï¼Œæœ‰å¾ˆå¤šçš„ clientsï¼Œä»¥åŠä¼šç”Ÿæˆæ›´å¤šçš„å†å²äº‹ä»¶ã€‚ ä¸ºäº†è§£å†³ Knossos çš„é—®é¢˜ï¼Œä½œè€…å¼€å‘äº† Procupineï¼Œä¸€ä¸ªç”¨ Go å†™çš„æ›´å¿«çš„çº¿æ€§ä¸€è‡´æ€§éªŒè¯å·¥å…·ã€‚Porcupine ä½¿ç”¨ä¸€ä¸ªç”¨ Go å¼€å‘çš„æ‰§è¡Œè§„èŒƒå»éªŒè¯å†å²æ˜¯å¦æ˜¯çº¿æ€§çš„ã€‚æ ¹æ®å®é™…æµ‹è¯•çš„æƒ…å†µï¼ŒPorcupine æ¯” Knossos å¿«å¾ˆå¤šå€ã€‚ Procupine Github 4.2.4 æ•ˆæœ ä½¿ç”¨æ•…éšœæ³¨å…¥å’Œçº¿æ€§åŒ–æ£€æŸ¥æ¥æµ‹è¯•å¯çº¿æ€§åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•ã€‚ ä½œä¸ºå¯¹æ¯”ï¼Œåœ¨ä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•ç”¨ Porcupine æµ‹è¯• key-value store çš„æ—¶å€™ï¼Œä½œè€…ä½¿ç”¨äº†è¿™ä¸¤ç§æ–¹å¼ã€‚ä½œè€…åœ¨å®ç°å®ƒè‡ªå·±çš„ key-value store çš„æ—¶å€™å¼•å…¥ä¸åŒçš„è®¾è®¡é”™è¯¯ï¼Œè­¬å¦‚åœ¨ä¿®æ”¹ä¹‹åä¼šå‡ºç°è¿‡æœŸè¯»ï¼Œæ¥çœ‹è¿™äº›æµ‹è¯•æ˜¯å¦ä¼šæŒ‚æ‰ã€‚ä¸“é—¨æµ‹è¯•ä¼šæ•æ‰åˆ°å¾ˆå¤š bugsï¼Œä½†å¹¶æ²¡æœ‰èƒ½åŠ›å»æ•æ‰åˆ°æ›´å¤šçš„ç‹¡çŒ¾çš„ bugsã€‚ç›¸å¯¹è€Œè¨€ï¼Œä½œè€…ç°åœ¨è¿˜æ²¡æ‰¾åˆ°ä¸€ä¸ªæ­£ç¡®æ€§çš„ bug æ˜¯çº¿æ€§ä¸€è‡´æ€§æµ‹è¯•ä¸èƒ½æŠ“ä½çš„ã€‚ å½¢å¼æ–¹æ³•èƒ½å¤Ÿä¿è¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ­£ç¡®æ€§ã€‚ä¾‹å¦‚ï¼ŒUM PLSE ç ”ç©¶å°ç»„æœ€è¿‘ä½¿ç”¨ Coq proof assistnt æ¥éªŒè¯äº† Raft ä¸€è‡´æ€§åè®®ã€‚ä½†ä¸å¹¸çš„çš„æ˜¯ï¼ŒéªŒè¯éœ€è¦ç‰¹å®šçš„çŸ¥è¯†ï¼Œå¦å¤–éªŒè¯å®é™…çš„ç³»ç»Ÿéœ€è¦åšå¤§é‡çš„å·¥ä½œã€‚æ²¡å‡†æœ‰ä¸€å¤©ï¼ŒéªŒè¯èƒ½è¢«ç”¨åœ¨å®é™…ç³»ç»Ÿä¸Šé¢ï¼Œä½†ç°åœ¨ï¼Œä¸»è¦è¿˜æ˜¯æµ‹è¯•ï¼Œè€Œä¸æ˜¯éªŒè¯ã€‚ ç†è®ºä¸Šï¼Œæ‰€æœ‰çš„ç”Ÿäº§ç³»ç»Ÿéƒ½ä¼šæœ‰ä¸€ä¸ªå½¢å¼è§„èŒƒï¼Œè€Œä¸”ä¸€äº›ç³»ç»Ÿä¹Ÿå·²ç»æœ‰äº†ï¼Œè­¬å¦‚ Raft å°±æœ‰ä¸€ä¸ªç”¨ TLA+ å†™çš„å½¢å¼è§„èŒƒã€‚ä½†ä¸å¹¸çš„æ˜¯ï¼Œå¤§éƒ¨åˆ†çš„ç³»ç»Ÿæ˜¯æ²¡æœ‰çš„ã€‚ ","date":"2024-05-22","objectID":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/:4:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ æµ‹è¯•åˆ†å¸ƒå¼ç³»ç»Ÿçš„çº¿æ€§ä¸€è‡´æ€§","uri":"/posts/03.%E6%B5%8B%E8%AF%95%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ä¸ºä»€ä¹ˆé€‰æ‹©Go åœ¨å®ç°åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œé€‰æ‹©åˆé€‚çš„ç¼–ç¨‹è¯­è¨€éå¸¸é‡è¦ã€‚Goæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š ä¼˜ç§€çš„çº¿ç¨‹æ”¯æŒï¼› ä¾¿æ·çš„RPCæœºåˆ¶ã€ç±»å‹ï¼› å†…å­˜å®‰å…¨ä»¥åŠåƒåœ¾å›æ”¶æœºåˆ¶ã€‚ è¿™ä½¿Goæˆä¸ºäº†ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©ã€‚Goä¸ä»…ç›¸å¯¹ç®€å•ï¼Œè€Œä¸”å…¶åƒåœ¾å›æ”¶æœºåˆ¶ä½¿çº¿ç¨‹ç®¡ç†æ›´åŠ å®¹æ˜“ï¼Œé¿å…äº†ä½¿ç”¨åé‡Šæ”¾é—®é¢˜ã€‚ç”±äºè¿™äº›ä¼˜åŠ¿ï¼ŒGoåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¢«å¹¿æ³›åº”ç”¨ã€‚ Go Tutorial ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 çº¿ç¨‹ä¸Goä¸­çš„Goroutine çº¿ç¨‹æ˜¯ä¸€ç§æœ‰ç”¨çš„ç»“æ„å·¥å…·ï¼Œå…è®¸ä¸€ä¸ªç¨‹åºåŒæ—¶æ‰§è¡Œå¤šé¡¹ä»»åŠ¡ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸²è¡Œæ‰§è¡Œï¼Œå°±åƒéçº¿ç¨‹ç¨‹åºä¸€æ ·ã€‚Goä¸­ç§°çº¿ç¨‹ä¸ºGoroutineï¼Œæ¯ä¸ªGoroutineåœ¨æ‰§è¡Œæ—¶åŒ…å«è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ã€å¯„å­˜å™¨å’Œæ ˆï¼Œä½†å…±äº«å†…å­˜ã€‚ä½¿ç”¨çº¿ç¨‹å¯ä»¥æé«˜I/Oå¹¶å‘æ€§å’Œå¤šæ ¸æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿åå°ä»»åŠ¡çš„å¤„ç†ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 ä¸ºä»€ä¹ˆä½¿ç”¨çº¿ç¨‹ï¼Ÿ I/Oå¹¶å‘æ€§ï¼šå®¢æˆ·ç«¯å¯ä»¥å¹¶è¡Œå‘å¤šä¸ªæœåŠ¡å™¨å‘é€è¯·æ±‚å¹¶ç­‰å¾…å›å¤ï¼ŒæœåŠ¡å™¨å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚ã€‚ å¤šæ ¸æ€§èƒ½ï¼šåœ¨å¤šæ ¸å¤„ç†å™¨ä¸Šå¹¶è¡Œæ‰§è¡Œä»£ç ï¼Œæé«˜è®¡ç®—æ•ˆç‡ã€‚ ä¾¿æ·æ€§ï¼šåå°çº¿ç¨‹å¯ä»¥å®šæœŸæ£€æŸ¥å„ä¸ªworkerçº¿ç¨‹æ˜¯å¦ä»ç„¶æ´»è·ƒã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:2:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 çº¿ç¨‹çš„æ›¿ä»£æ–¹æ¡ˆ äº‹ä»¶é©±åŠ¨ç¼–ç¨‹ï¼ˆEvent-driven programmingï¼‰æ˜¯ä¸€ç§æ›¿ä»£ä¼ ç»Ÿå¤šçº¿ç¨‹ç¼–ç¨‹çš„æ–¹å¼ï¼Œé€šè¿‡åœ¨å•çº¿ç¨‹ä¸­æ˜¾å¼äº¤é”™å¤„ç†æ´»åŠ¨æ¥å®ç°I/Oå¹¶å‘æ€§ã€‚è¿™ç§ç¼–ç¨‹æ¨¡å‹å¸¸ç”¨äºå¤„ç†å¤§é‡I/Oæ“ä½œçš„åœºæ™¯ï¼Œä¾‹å¦‚ç½‘ç»œæœåŠ¡å™¨å’Œå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰åº”ç”¨ã€‚ åœ¨äº‹ä»¶é©±åŠ¨ç¼–ç¨‹ä¸­ï¼Œç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰ï¼Œä¸æ–­æ£€æŸ¥å¹¶å¤„ç†äº‹ä»¶é˜Ÿåˆ—ä¸­çš„äº‹ä»¶ã€‚æ¯ä¸ªäº‹ä»¶é€šå¸¸å¯¹åº”æŸç§å¤–éƒ¨è¾“å…¥æˆ–çŠ¶æ€å˜åŒ–ï¼Œå¦‚ç½‘ç»œè¯·æ±‚åˆ°è¾¾ã€ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æˆ–å®šæ—¶å™¨åˆ°æœŸã€‚äº‹ä»¶å¤„ç†ç¨‹åºï¼ˆevent handlerï¼‰è¢«æ³¨å†Œåˆ°ç‰¹å®šäº‹ä»¶ä¸Šï¼Œå½“ç›¸åº”äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¤„ç†ç¨‹åºè¢«è°ƒç”¨æ¥æ‰§è¡Œé¢„å®šä¹‰çš„æ“ä½œã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:2:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 çº¿ç¨‹ç¼–ç¨‹æŒ‘æˆ˜ å®‰å…¨å…±äº«æ•°æ®ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«æ•°æ®æ—¶å¯èƒ½å¯¼è‡´ç«äº‰æ¡ä»¶ï¼Œå¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨é”ï¼ˆå¦‚Goçš„sync.Mutexï¼‰æˆ–è€…é¿å…å…±äº«å¯å˜æ•°æ®ã€‚ çº¿ç¨‹é—´åè°ƒï¼šä¸€ä¸ªçº¿ç¨‹ç”Ÿäº§æ•°æ®ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ¶ˆè´¹æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨Goçš„é€šé“ï¼ˆchannelï¼‰æˆ–æ¡ä»¶å˜é‡ï¼ˆsync.Condï¼‰æˆ–ç­‰å¾…ç»„ï¼ˆsync.WaitGroupï¼‰è¿›è¡Œåè°ƒã€‚ æ­»é”ï¼šçº¿ç¨‹ä¹‹é—´é€šè¿‡é”æˆ–channelæˆ–RPCç›¸äº’ç­‰å¾…èµ„æºæ—¶å¯èƒ½å¯¼è‡´æ­»é”ï¼Œéœ€è¦å°å¿ƒé¿å…ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:2:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ä»¥ç½‘ç»œçˆ¬è™«ä¸ºä¾‹çš„çº¿ç¨‹åº”ç”¨ ç½‘ç»œçˆ¬è™«çš„ç›®æ ‡æ˜¯æŠ“å–æ‰€æœ‰ç½‘é¡µå†…å®¹ï¼Œå¸¸è§çš„å®ç°æ–¹å¼æœ‰ä¸²è¡Œå’Œå¹¶å‘ä¸¤ç§ã€‚å¹¶å‘çˆ¬è™«åˆ©ç”¨çº¿ç¨‹æé«˜æŠ“å–æ•ˆç‡ï¼Œä½†ä¹Ÿéœ€è¦è§£å†³é¿å…é‡å¤æŠ“å–å’Œå¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚ åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¡«å……çš„Fetcheræ¥æ¨¡æ‹ŸæŠ“å–ã€‚fetcherç»“æ„å¦‚ä¸‹ï¼š type fakeResult struct { body string urls []string } func (f fakeFetcher) Fetch(url string) ([]string, error) { if res, ok := f[url]; ok { fmt.Printf(\"found: %s\\n\", url) return res.urls, nil } fmt.Printf(\"missing: %s\\n\", url) return nil, fmt.Errorf(\"not found: %s\", url) } // fetcher is a populated fakeFetcher. var fetcher = fakeFetcher{ \"http://golang.org/\": \u0026fakeResult{ \"The Go Programming Language\", []string{ \"http://golang.org/pkg/\", \"http://golang.org/cmd/\", }, }, \"http://golang.org/pkg/\": \u0026fakeResult{ \"Packages\", []string{ \"http://golang.org/\", \"http://golang.org/cmd/\", \"http://golang.org/pkg/fmt/\", \"http://golang.org/pkg/os/\", }, }, \"http://golang.org/pkg/fmt/\": \u0026fakeResult{ \"Package fmt\", []string{ \"http://golang.org/\", \"http://golang.org/pkg/\", }, }, \"http://golang.org/pkg/os/\": \u0026fakeResult{ \"Package os\", []string{ \"http://golang.org/\", \"http://golang.org/pkg/\", }, }, } ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 ä¸²è¡Œçˆ¬è™« ä¸²è¡Œçˆ¬è™«é€šè¿‡é€’å½’è°ƒç”¨å®ç°æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œä½¿ç”¨ä¸€ä¸ªå…±äº«çš„mapè®°å½•å·²æŠ“å–çš„URLï¼Œé˜²æ­¢é‡å¤æŠ“å–ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹å¼åªèƒ½ä¸€æ¬¡æŠ“å–ä¸€ä¸ªé¡µé¢ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚ä»£ç å¦‚ä¸‹ï¼š func Serial(url string, fetcher Fetcher, fetched map[string]bool) { // Use a map to keep track of fetched URLs if fetched[url] { return } fetched[url] = true urls, err := fetcher.Fetch(url) if err != nil { return } // Recursively fetch URLs for _, u := range urls { Serial(u, fetcher, fetched) } return } æˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨Serial()è°ƒç”¨å‰é¢æ”¾ä¸€ä¸ªgoå‘¢ åœ¨ Serial() è°ƒç”¨å‰æ·»åŠ  go å…³é”®å­—ä¼šå¯¼è‡´å¹¶å‘æ‰§è¡Œå¤šä¸ªçˆ¬è™«ä»»åŠ¡ï¼Œä»è€Œå¯èƒ½å¯¼è‡´é‡å¤æŠ“å–ç›¸åŒçš„é¡µé¢ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ªçˆ¬è™«ä»»åŠ¡éƒ½ä¼šå°è¯•ä»æœªæŠ“å–è¿‡çš„é¡µé¢å¼€å§‹é€’å½’æŠ“å–ï¼Œè€Œå¹¶å‘æ‰§è¡Œå¯èƒ½å¯¼è‡´å¤šä¸ªçˆ¬è™«åŒæ—¶é€‰æ‹©ç›¸åŒçš„é¡µé¢ä½œä¸ºèµ·å§‹ç‚¹ï¼Œè¿›è€Œé‡å¤æŠ“å–ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:3:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 å¹¶å‘çˆ¬è™« ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:3:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 ä½¿ç”¨é” æ¯ä¸ªé¡µé¢çš„æŠ“å–åœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸­è¿›è¡Œï¼Œä¸ºäº†ç¡®ä¿æŠ“å–è¿‡ç¨‹çš„æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†äº’æ–¥é”æ¥ä¿æŠ¤å…±äº«çš„ fetchState ç»“æ„ä½“ï¼Œé¿å…äº†é‡å¤æŠ“å–å’Œå¹¶å‘å†²çªçš„é—®é¢˜ã€‚åœ¨æŠ“å–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†é€’å½’è°ƒç”¨ ConcurrentMutex å‡½æ•°æ¥å¤„ç†å½“å‰é¡µé¢çš„æ‰€æœ‰å­é“¾æ¥ã€‚æ¯å½“å‘ç°ä¸€ä¸ªæ–°çš„å­é“¾æ¥æ—¶ï¼Œæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªæ–°çš„ Goroutine æ¥å¹¶å‘åœ°æŠ“å–è¯¥é“¾æ¥ï¼Œä»è€Œå®ç°äº†å¤šä¸ªé¡µé¢çš„å¹¶è¡ŒæŠ“å–ã€‚ä½¿ç”¨ sync.WaitGroup æ¥ç­‰å¾…æ‰€æœ‰çš„å­é“¾æ¥æŠ“å–ä»»åŠ¡å®Œæˆï¼Œç¡®ä¿ä¸»çº¿ç¨‹åœ¨æ‰€æœ‰ä»»åŠ¡å®Œæˆåæ‰è¿”å›ï¼Œä»¥é¿å…æå‰ç»“æŸæŠ“å–è¿‡ç¨‹ã€‚ä»£ç å¦‚ä¸‹ï¼š type fetchState struct { mu sync.Mutex // protect concurrent crawls fetched map[string]bool // Used to store crawled URLs. The key is URL and the value is whether it has been crawled. } func (fs *fetchState) testAndSet(url string) bool { fs.mu.Lock() defer fs.mu.Unlock() r := fs.fetched[url] fs.fetched[url] = true return r // Return to previous crawling status } func ConcurrentMutex(url string, fetcher Fetcher, fs *fetchState) { if fs.testAndSet(url) { return } urls, err := fetcher.Fetch(url) if err != nil { return } var done sync.WaitGroup // Create a wait group that waits for all subtasks to complete for _, u := range urls { done.Add(1) // Increase the counter of the waiting group go func(u string) { // Start a Go coroutine to concurrently crawl sub-links defer done.Done() ConcurrentMutex(u, fetcher, fs) // Recursive call ConcurrentMutex, fetching sub-links. }(u) } done.Wait() // Wait for all subtasks to complete return } ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:3:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 ä½¿ç”¨é€šé“ æ¯ä¸ªworkerçº¿ç¨‹å°†æŠ“å–åˆ°çš„URLå‘é€åˆ°ä¸€ä¸ªé€šé“ï¼Œcoordinatorä»é€šé“ä¸­è¯»å–URLå¹¶å¯åŠ¨æ–°çš„workerçº¿ç¨‹ã€‚è¿™ç§æ–¹å¼é¿å…äº†é”çš„ä½¿ç”¨ï¼Œä½†éœ€è¦å°å¿ƒé¿å…é€šé“é˜»å¡å¯¼è‡´çš„æ­»é”ã€‚ä»£ç å¦‚ä¸‹ï¼š func worker(url string, ch chan []string, fetcher Fetcher) { urls, err := fetcher.Fetch(url) if err != nil { ch \u003c- []string{} } else { ch \u003c- urls } } func coordinator(ch chan []string, fetcher Fetcher) { n := 1 // è®°å½•æ­£åœ¨å¤„ç†çš„ä»»åŠ¡æ•°é‡ï¼Œåˆå§‹å€¼ä¸º 1ï¼Œå› ä¸ºæœ€å¼€å§‹åªæœ‰ä¸€ä¸ªåˆå§‹ URL fetched := make(map[string]bool) // è®°å½•å·²ç»æŠ“å–çš„ URL for urls := range ch { // ä¸æ–­ä»é€šé“ä¸­æ¥æ”¶æŠ“å–åˆ°çš„é“¾æ¥åˆ—è¡¨ï¼Œç›´åˆ°é€šé“è¢«å…³é—­ for _, u := range urls { // éå†æ¥æ”¶åˆ°çš„é“¾æ¥åˆ—è¡¨ if fetched[u] == false { fetched[u] = true n += 1 go worker(u, ch, fetcher) // å¯åŠ¨ä¸€ä¸ªæ–°çš„ worker åç¨‹æŠ“å–è¯¥é“¾æ¥çš„å­é“¾æ¥ } } n -= 1 if n == 0 { // å¦‚æœå½“å‰æ²¡æœ‰æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ï¼Œåˆ™é€€å‡ºå¾ªç¯ï¼Œç»“æŸå¹¶å‘æŠ“å–è¿‡ç¨‹ break } } } // ConcurrentChannel å‡½æ•°æ˜¯å¹¶å‘æŠ“å–çš„å…¥å£å‡½æ•°ï¼Œåˆ©ç”¨é€šé“åè°ƒå¹¶å‘æŠ“å–çš„è¿‡ç¨‹ã€‚ func ConcurrentChannel(url string, fetcher Fetcher) { ch := make(chan []string) // åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹çš„é€šé“ go func() { // å¯åŠ¨ä¸€ä¸ªåŒ¿åå‡½æ•°çš„ Go åç¨‹ï¼Œç”¨äºå‘é€šé“å‘é€ URL ch \u003c- []string{url} // å‘é€šé“å‘é€åŒ…å«åˆå§‹ URL çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ }() coordinator(ch, fetcher) // è°ƒç”¨ coordinator å‡½æ•°ï¼Œå¼€å§‹å¹¶å‘æŠ“å–çš„åè°ƒè¿‡ç¨‹ } åœ¨ worker å‡½æ•°ä¸­ï¼Œæ¯ä¸ªworkerçº¿ç¨‹ä¼šå°è¯•æŠ“å–æŒ‡å®šçš„URLï¼Œå¹¶å°†æŠ“å–åˆ°çš„å­é“¾æ¥å‘é€åˆ°é€šé“ä¸­ã€‚å¦‚æœæŠ“å–å¤±è´¥ï¼Œåˆ™å‘é€ä¸€ä¸ªç©ºçš„å­—ç¬¦ä¸²åˆ‡ç‰‡åˆ°é€šé“ï¼Œä»¥ä¾¿é€šçŸ¥coordinatorä»»åŠ¡å¤±è´¥ã€‚ åœ¨ coordinator å‡½æ•°ä¸­ï¼Œcoordinatorä¸æ–­ä»é€šé“ä¸­è¯»å–æŠ“å–åˆ°çš„é“¾æ¥åˆ—è¡¨ï¼Œç„¶åéå†è¿™äº›é“¾æ¥ï¼Œå¦‚æœå‘ç°ä¹‹å‰æœªæŠ“å–è¿‡çš„æ–°é“¾æ¥ï¼Œåˆ™å°†å…¶æ ‡è®°ä¸ºå·²æŠ“å–å¹¶å¯åŠ¨ä¸€ä¸ªæ–°çš„workerçº¿ç¨‹è¿›è¡ŒæŠ“å–ã€‚åŒæ—¶ï¼Œcoordinatorä¼šç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ n æ¥è®°å½•å½“å‰æ­£åœ¨å¤„ç†çš„ä»»åŠ¡æ•°é‡ï¼Œå½“æ‰€æœ‰ä»»åŠ¡éƒ½å¤„ç†å®Œæˆåï¼Œcoordinatorç»“æŸå¹¶å‘æŠ“å–çš„è¿‡ç¨‹ã€‚ åœ¨ ConcurrentChannel å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹çš„é€šé“ï¼Œå¹¶å¯åŠ¨äº†ä¸€ä¸ªåŒ¿åçš„ Goroutine æ¥å‘é€šé“å‘é€åˆå§‹çš„ URLã€‚ç„¶åï¼Œè°ƒç”¨ coordinator å‡½æ•°å¼€å§‹å¹¶å‘æŠ“å–çš„åè°ƒè¿‡ç¨‹ã€‚ coordinatorå¦‚ä½•çŸ¥é“å®ƒå·²ç»å®Œæˆï¼Ÿ coordinatorçŸ¥é“å®ƒå·²å®Œæˆçš„æ¡ä»¶æ˜¯ n è®¡æ•°å™¨çš„å€¼å½’é›¶ã€‚coordinatoré€šè¿‡ç»´æŠ¤ n è®¡æ•°å™¨æ¥è·Ÿè¸ªå½“å‰æ­£åœ¨å¤„ç†çš„ä»»åŠ¡æ•°é‡ï¼Œæ¯ä¸ªworkerçº¿ç¨‹å¤„ç†å®Œæˆåä¼šå°† n å‡ä¸€ã€‚å½“ n è®¡æ•°å™¨çš„å€¼ä¸ºé›¶æ—¶ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²ç»å®Œæˆï¼Œcoordinatorå°±çŸ¥é“è‡ªå·±çš„å·¥ä½œå·²ç»å®Œæˆã€‚ é€šé“åœ¨è¿™é‡Œæœ‰ä¸¤ä¸ªä½œç”¨ï¼š - é€šä¿¡å€¼ï¼šworkerçº¿ç¨‹å°†æŠ“å–åˆ°çš„é“¾æ¥åˆ—è¡¨å‘é€åˆ°é€šé“ä¸­ï¼Œä»¥ä¾¿coordinatorå¯ä»¥è¯»å–å¹¶å¤„ç†ã€‚ - äº‹ä»¶é€šçŸ¥ï¼šé€šé“çš„å…³é—­å¯ä½œä¸ºäº‹ä»¶é€šçŸ¥ï¼Œå½“é€šé“å…³é—­æ—¶ï¼Œcoordinatorä¼šçŸ¥é“æ‰€æœ‰çš„workerçº¿ç¨‹éƒ½å·²å®Œæˆï¼Œå¹¶ä¸”æ²¡æœ‰æ–°çš„ä»»åŠ¡éœ€è¦å¤„ç†ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:3:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.1 ä»‹ç» ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:4:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.2 è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ï¼Œå®ƒä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡å˜å¾—ç®€å•è€Œç›´è§‚ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸åŒçš„èŠ‚ç‚¹å¯èƒ½åˆ†å¸ƒåœ¨ä¸åŒçš„ç‰©ç†æœºå™¨ä¸Šï¼ŒRPCå…è®¸è¿™äº›èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œè¿œç¨‹é€šä¿¡ï¼Œå°±åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ï¼Œæ— éœ€äº†è§£åº•å±‚çš„ç½‘ç»œåè®®ç»†èŠ‚ã€‚ RPCçš„ç›®æ ‡æ˜¯å®ç°æ˜“äºç¼–ç¨‹çš„å®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡ï¼Œå®ƒéšè—äº†åº•å±‚ç½‘ç»œé€šä¿¡çš„å¤æ‚æ€§ï¼Œä¸ºå¼€å‘äººå‘˜æä¾›äº†ç®€å•çš„æ¥å£ã€‚é€šè¿‡RPCï¼Œå¼€å‘äººå‘˜å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œè€Œæ— éœ€æ‹…å¿ƒç½‘ç»œé€šä¿¡çš„ç»†èŠ‚ã€‚ åœ¨RPCä¸­ï¼Œæ•°æ®åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œå› æ­¤éœ€è¦å°†æ•°æ®è½¬æ¢ä¸ºâ€œæœ‰çº¿æ ¼å¼â€ï¼ˆwire formatï¼‰ã€‚RPCåº“è´Ÿè´£å¤„ç†æ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä»¥ç¡®ä¿æ•°æ®å¯ä»¥åœ¨ç½‘ç»œä¸Šä¼ è¾“å¹¶åœ¨å¦ä¸€ç«¯æ­£ç¡®è§£æã€‚ RPCæ¶ˆæ¯çš„åŸºæœ¬ç»“æ„æ˜¯è¯·æ±‚-å“åº”æ¨¡å¼ã€‚å®¢æˆ·ç«¯å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶å‘é€å“åº”ç»™å®¢æˆ·ç«¯ã€‚è¿™ç§ç®€å•çš„è¯·æ±‚-å“åº”æ¨¡å¼ä½¿å¾—RPCæˆä¸ºäº†ä¸€ç§éå¸¸æœ‰æ•ˆçš„é€šä¿¡æ–¹å¼ã€‚ åœ¨RPCçš„è½¯ä»¶ç»“æ„ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªç»„ä»¶ï¼š å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼šè´Ÿè´£å‘èµ·RPCè¯·æ±‚çš„åº”ç”¨ç¨‹åºã€‚ å­˜æ ¹å‡½æ•°ï¼ˆStub functionsï¼‰ï¼šå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºè°ƒç”¨çš„æ¥å£å‡½æ•°ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªæœ¬åœ°ä»£ç†ï¼Œè´Ÿè´£å°†RPCè°ƒç”¨è½¬å‘ç»™è¿œç¨‹æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨å¤„ç†å‡½æ•°ï¼ˆHandler functionsï¼‰ï¼šæœåŠ¡å™¨ç«¯å®é™…æ‰§è¡Œä¸šåŠ¡é€»è¾‘çš„å‡½æ•°ã€‚ è°ƒåº¦å™¨ï¼ˆDispatcherï¼‰ï¼šè´Ÿè´£å°†RPCè¯·æ±‚åˆ†å‘ç»™æ­£ç¡®çš„å¤„ç†å‡½æ•°ã€‚ RPCåº“ï¼šæä¾›äº†RPCé€šä¿¡æ‰€éœ€çš„åŸºæœ¬åŠŸèƒ½ï¼Œä¾‹å¦‚åºåˆ—åŒ–ã€ç½‘ç»œé€šä¿¡ç­‰ã€‚ é€šè¿‡RPCï¼Œä¸åŒè¯­è¨€ç¼–å†™çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥è¿›è¡Œé€šä¿¡ï¼Œå®ç°äº†è·¨è¯­è¨€çš„å¯ç§»æ¤æ€§å’Œäº’æ“ä½œæ€§ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:4:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.3 Goçš„RPCå®ç° åœ¨Goä¸­ï¼Œå®ç°RPCéœ€è¦å®šä¹‰è¯·æ±‚å’Œå›å¤çš„ç»“æ„ä½“ï¼Œå¹¶ä½¿ç”¨Goçš„RPCåº“æ¥å¤„ç†é€šä¿¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨Goä¸­å®ç°ä¸€ä¸ªç®€å•çš„é”®å€¼å­˜å‚¨æœåŠ¡å™¨ï¼ˆkey/value storage serverï¼‰ï¼Œå¹¶ä½¿ç”¨RPCè¿›è¡Œé€šä¿¡ã€‚ è¯·æ±‚å›å¤ç»“æ„ä½“ åœ¨é”®å€¼å­˜å‚¨æœåŠ¡å™¨çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ç”¨äºPutå’ŒGetæ“ä½œçš„è¯·æ±‚å’Œå›å¤ç»“æ„ä½“ï¼š type PutArgs struct { Key string Value string } type PutReply struct { } type GetArgs struct { Key string } type GetReply struct { Value string } æœåŠ¡å™¨ç«¯ï¼ˆServerï¼‰ åœ¨æœåŠ¡å™¨ç«¯ï¼Œé¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¸Šæ³¨å†Œå¤„ç†å‡½æ•°ä½œä¸ºRPCå¤„ç†ç¨‹åºã€‚è¿™äº›å¤„ç†å‡½æ•°å°†å¤„ç†å®¢æˆ·ç«¯å‘é€çš„RPCè¯·æ±‚ã€‚æœåŠ¡å™¨æ¥å—TCPè¿æ¥å¹¶å°†å…¶ä¼ é€’ç»™RPCåº“ã€‚RPCåº“è´Ÿè´£è¯»å–æ¯ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„Goroutineè¿›è¡Œå¤„ç†ã€‚å¤„ç†å‡½æ•°ä¼šè¯»å–è¯·æ±‚å‚æ•°ï¼Œå¹¶æ ¹æ®è¯·æ±‚è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚å¤„ç†å®Œè¯·æ±‚åï¼ŒæœåŠ¡å™¨å°†å›å¤ä¿¡æ¯è¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶é€šè¿‡TCPè¿æ¥å‘é€å›å®¢æˆ·ç«¯ã€‚æœåŠ¡å™¨ç«¯çš„å¤„ç†å‡½æ•°å¿…é¡»ä½¿ç”¨é”è¿›è¡ŒåŒæ­¥ï¼Œå› ä¸ºRPCåº“ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Goroutineã€‚å¤„ç†å‡½æ•°éœ€è¦è¯»å–è¯·æ±‚å‚æ•°å¹¶ä¿®æ”¹å›å¤ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦ç¡®ä¿å¹¶å‘è®¿é—®çš„å®‰å…¨æ€§ã€‚ type KV struct { mu sync.Mutex // äº’æ–¥é”ï¼Œä¿æŠ¤æ•°æ®å¹¶å‘è®¿é—® data map[string]string } func server() { kv := \u0026KV{data: map[string]string{}} // åˆ›å»ºé”®å€¼å­˜å‚¨æœåŠ¡å™¨å®ä¾‹ rpcs := rpc.NewServer() // åˆ›å»ºä¸€ä¸ª RPC æœåŠ¡å™¨ rpcs.Register(kv) // æ³¨å†Œ kv ä¸º RPC æœåŠ¡å™¨çš„æœåŠ¡å¯¹è±¡ l, e := net.Listen(\"tcp\", \":1234\") // ç›‘å¬ TCP ç«¯å£ 1234 if e != nil { log.Fatal(\"listen error:\", e) } go func() { // å¯åŠ¨ä¸€ä¸ªåç¨‹æ¥å¤„ç†å®¢æˆ·ç«¯è¿æ¥ for { conn, err := l.Accept() // æ¥å—å®¢æˆ·ç«¯è¿æ¥ if err == nil { go rpcs.ServeConn(conn) // å¯åŠ¨ä¸€ä¸ªåç¨‹æ¥ä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡ } else { break } } l.Close() // å…³é—­ç›‘å¬å™¨ }() } // Get æ–¹æ³•ç”¨äºå¤„ç†å®¢æˆ·ç«¯å‘é€çš„ Get è¯·æ±‚ï¼Œè·å–æŒ‡å®šé”®çš„å€¼ã€‚ func (kv *KV) Get(args *GetArgs, reply *GetReply) error { kv.mu.Lock() defer kv.mu.Unlock() reply.Value = kv.data[args.Key] return nil } // Put æ–¹æ³•ç”¨äºå¤„ç†å®¢æˆ·ç«¯å‘é€çš„ Put è¯·æ±‚ï¼Œå­˜å‚¨é”®å€¼å¯¹ã€‚ func (kv *KV) Put(args *PutArgs, reply *PutReply) error { kv.mu.Lock() defer kv.mu.Unlock() kv.data[args.Key] = args.Value return nil } å®¢æˆ·ç«¯ï¼ˆClientï¼‰ åœ¨å®¢æˆ·ç«¯ï¼Œé¦–å…ˆéœ€è¦ä½¿ç”¨Dialå‡½æ•°å»ºç«‹ä¸æœåŠ¡å™¨çš„TCPè¿æ¥ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯éœ€è¦å®šä¹‰RPCè¯·æ±‚çš„å‚æ•°ç»“æ„ä½“å’Œå›å¤ç»“æ„ä½“ï¼Œå¹¶å®ç°å¯¹åº”çš„å¤„ç†å‡½æ•°ã€‚å®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨Callå‡½æ•°å‘èµ·RPCè°ƒç”¨ï¼ŒæŒ‡å®šè¿æ¥ã€å‡½æ•°åç§°ã€å‚æ•°ä»¥åŠå­˜æ”¾å›å¤çš„ä½ç½®ã€‚RPCåº“è´Ÿè´£å¯¹å‚æ•°è¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶å°†è¯·æ±‚å‘é€ç»™æœåŠ¡å™¨ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯ç­‰å¾…å¹¶æ¥æ”¶æœåŠ¡å™¨çš„å›å¤ï¼Œå¹¶å°†å›å¤ååºåˆ—åŒ–ä¸ºæŒ‡å®šçš„å›å¤ç»“æ„ä½“ã€‚Callå‡½æ•°çš„è¿”å›å€¼æŒ‡ç¤ºæ˜¯å¦æˆåŠŸæ¥æ”¶åˆ°äº†å›å¤ï¼Œé€šå¸¸è¿˜åŒ…æ‹¬æœåŠ¡çº§åˆ«çš„é”™è¯¯ä¿¡æ¯ã€‚ // connect å‡½æ•°ç”¨äºä¸é”®å€¼å­˜å‚¨æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œå¹¶è¿”å›ä¸€ä¸ª RPC å®¢æˆ·ç«¯å¯¹è±¡ã€‚ func connect() *rpc.Client { client, err := rpc.Dial(\"tcp\", \":1234\") // ä½¿ç”¨ TCP åè®®è¿æ¥æœåŠ¡å™¨ if err != nil { log.Fatal(\"dialing:\", err) // å¦‚æœè¿æ¥å¤±è´¥ï¼Œåˆ™è®°å½•é”™è¯¯å¹¶ç»ˆæ­¢ç¨‹åº } return client } func get(key string) string { client := connect() // å»ºç«‹è¿æ¥ args := GetArgs{key} // æ„é€  Get è¯·æ±‚çš„å‚æ•° reply := GetReply{} // å‡†å¤‡æ¥æ”¶æœåŠ¡å™¨çš„å“åº” err := client.Call(\"KV.Get\", \u0026args, \u0026reply) // è°ƒç”¨è¿œç¨‹æ–¹æ³• Getï¼Œå¹¶ä¼ é€’å‚æ•° argsï¼Œå°†å“åº”å†™å…¥ reply if err != nil { log.Fatal(\"error:\", err) } client.Close() // å…³é—­è¿æ¥ return reply.Value // è¿”å›æœåŠ¡å™¨è¿”å›çš„å€¼ } // put å‡½æ•°ç”¨äºå‘é”®å€¼å­˜å‚¨æœåŠ¡å™¨å‘é€ Put è¯·æ±‚ï¼Œå­˜å‚¨é”®å€¼å¯¹ã€‚ func put(key string, val string) { client := connect() args := PutArgs{key, val} reply := PutReply{} err := client.Call(\"KV.Put\", \u0026args, \u0026reply) if err != nil { log.Fatal(\"error:\", err) } client.Close() } å…¶ä»–ç»†èŠ‚ï¼š ç»‘å®šï¼ˆBindingï¼‰ï¼šå®¢æˆ·ç«¯å¦‚ä½•çŸ¥é“è¦ä¸å“ªå°æœåŠ¡å™¨é€šä¿¡ï¼Ÿ åœ¨Goçš„RPCä¸­ï¼ŒæœåŠ¡å™¨çš„åç§°å’Œç«¯å£æ˜¯Dialå‡½æ•°çš„å‚æ•°ã€‚åœ¨å¤§å‹ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ç§åç§°æˆ–é…ç½®æœåŠ¡å™¨æ¥ç®¡ç†è¿™äº›ä¿¡æ¯ã€‚ åºåˆ—åŒ–ï¼ˆMarshallingï¼‰ï¼šæ•°æ®æ ¼å¼åŒ–ä¸ºæ•°æ®åŒ…ã€‚Goçš„RPCåº“å¯ä»¥ä¼ é€’å­—ç¬¦ä¸²ã€æ•°ç»„ã€å¯¹è±¡ã€æ˜ å°„ç­‰ç±»å‹çš„æ•°æ®ã€‚Goé€šè¿‡å¤åˆ¶æŒ‡å‘çš„æ•°æ®æ¥ä¼ é€’æŒ‡é’ˆï¼Œä½†ä¸èƒ½ä¼ é€’é€šé“æˆ–å‡½æ•°ã€‚RPCåº“åªåºåˆ—åŒ–å¯¼å‡ºå­—æ®µï¼ˆå³å¤§å†™å­—æ¯å¼€å¤´çš„å­—æ®µï¼‰ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:4:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.4 å¤„ç†RPCä¸­çš„å¤±è´¥ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç½‘ç»œæ•…éšœå’ŒæœåŠ¡å™¨æ•…éšœæ˜¯ä¸å¯é¿å…çš„ã€‚ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯â€œå°½åŠ›è€Œä¸ºâ€çš„RPCï¼Œå³åœ¨è¶…æ—¶åé‡è¯•è¯·æ±‚ï¼Œä½†è¿™å¯èƒ½å¯¼è‡´é‡å¤æ“ä½œã€‚ è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œé‡è¯•è¯·æ±‚å¯èƒ½å¯¼è‡´æ“ä½œè¢«é‡å¤æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š client.Put(\"k\", 10) client.Put(\"k\", 20) å¦‚æœç¬¬äºŒä¸ªPutè¯·æ±‚å› ç½‘ç»œæ•…éšœé‡è¯•å¤šæ¬¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸ä¸€è‡´çš„ç»“æœï¼š æ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯â€œè‡³å¤šä¸€æ¬¡â€çš„RPCï¼Œâ€œè‡³å¤šä¸€æ¬¡â€çš„RPCé€šè¿‡ä»¥ä¸‹æœºåˆ¶å®ç°æ›´å¯é çš„è¡Œä¸ºï¼š å®¢æˆ·ç«¯åœ¨æœªæ”¶åˆ°å“åº”æ—¶é‡æ–°å‘é€è¯·æ±‚ã€‚ æœåŠ¡å™¨æ£€æµ‹é‡å¤è¯·æ±‚ï¼Œå¹¶è¿”å›ä¹‹å‰çš„å“åº”ï¼Œè€Œä¸æ˜¯é‡æ–°æ‰§è¡Œå¤„ç†å‡½æ•°ã€‚ ä¸ºäº†æ£€æµ‹é‡å¤è¯·æ±‚ï¼Œå®¢æˆ·ç«¯åœ¨æ¯ä¸ªè¯·æ±‚ä¸­åŒ…å«ä¸€ä¸ªå”¯ä¸€çš„IDï¼ˆXIDï¼‰ã€‚æ¯ä¸ªè¯·æ±‚ä½¿ç”¨ç›¸åŒçš„ XID é‡æ–°å‘é€æœåŠ¡å™¨ï¼š if seen[xid] { reply = old[xid] } else { reply = handler() old[xid] = reply seen[xid] = true } ä¸€äº›â€œè‡³å¤šä¸€æ¬¡â€å¤æ‚æ€§é—®é¢˜ï¼š å¦‚æœä¸¤ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ç›¸åŒçš„XIDï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å¤§éšæœºæ•°ç”Ÿæˆå”¯ä¸€IDã€‚ å¦‚ä½•é¿å…seen[xid]è¡¨è¿‡å¤§ï¼Ÿ æ¯ä¸ªå®¢æˆ·ç«¯æœ‰ä¸€ä¸ªå”¯ä¸€IDï¼Œä½¿ç”¨åºåˆ—å·ã€‚ å®¢æˆ·ç«¯åœ¨æ¯æ¬¡RPCä¸­åŒ…å«â€œå·²è§åˆ°çš„æœ€å¤§å›å¤â€ä¿¡æ¯ï¼Œç±»ä¼¼äºTCPåºåˆ—å·å’Œç¡®è®¤å·ã€‚ æœåŠ¡å™¨å´©æºƒå’Œé‡å¯ï¼š å¦‚æœâ€œè‡³å¤šä¸€æ¬¡â€ä¿¡æ¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼ŒæœåŠ¡å™¨é‡å¯åå°†å¿˜è®°è¿™äº›ä¿¡æ¯ï¼Œå¯èƒ½ä¼šæ¥å—é‡å¤è¯·æ±‚ã€‚ è§£å†³æ–¹æ¡ˆï¼šå°†é‡å¤æ£€æµ‹ä¿¡æ¯å†™å…¥ç£ç›˜ï¼Œæˆ–ä½¿ç”¨å¤åˆ¶æœåŠ¡å™¨åŒæ­¥è¿™äº›ä¿¡æ¯ã€‚ Goçš„RPCåº“æ˜¯â€œè‡³å¤šä¸€æ¬¡â€ç­–ç•¥çš„ç®€å•å®ç°ï¼š æ‰“å¼€TCPè¿æ¥ã€‚ å°†è¯·æ±‚å†™å…¥TCPè¿æ¥ã€‚ Go RPCä»ä¸é‡å‘è¯·æ±‚ï¼Œå› æ­¤æœåŠ¡å™¨ä¸ä¼šçœ‹åˆ°é‡å¤è¯·æ±‚ã€‚ å¦‚æœæœªæ”¶åˆ°å›å¤ï¼ŒGo RPCä»£ç è¿”å›é”™è¯¯ï¼ˆå¯èƒ½æ˜¯ç”±äºTCPè¶…æ—¶ï¼‰ã€‚ å…³äºâ€œæ°å¥½ä¸€æ¬¡â€çš„RPC â€œæ°å¥½ä¸€æ¬¡â€çš„RPCåŒ…æ‹¬æ— é™é‡è¯•ã€é‡å¤æ£€æµ‹å’Œå®¹é”™æœåŠ¡ï¼Œè¿™ç§æ–¹æ³•æ›´å¤æ‚ï¼Œåœ¨å®é™…ç³»ç»Ÿä¸­éœ€è¦å®ç°å®¹é”™æœºåˆ¶ã€‚ ä¾‹å¦‚ï¼Œlab 4ä¸­å°†æ¢è®¨â€œæ°å¥½ä¸€æ¬¡â€RPCçš„å®ç°ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:4:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 FAQ Goé€šé“æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ŸGoå¦‚ä½•ç¡®ä¿å®ƒä»¬åœ¨å¤šä¸ªgoroutinesä¹‹é—´åŒæ­¥ï¼Ÿ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æºç ï¼Œå°½ç®¡ä¸æ˜“ç†è§£ã€‚é«˜å±‚æ¬¡ä¸Šï¼Œé€šé“æ˜¯ä¸€ä¸ªåŒ…å«ç¼“å†²åŒºå’Œé”çš„ç»“æ„ä½“ã€‚å‘é€åˆ°é€šé“æ¶‰åŠè·å–é”ï¼Œç­‰å¾…ï¼ˆå¯èƒ½é‡Šæ”¾CPUï¼‰ç›´åˆ°æŸä¸ªçº¿ç¨‹æ¥æ”¶ï¼Œå¹¶äº¤ä»˜æ¶ˆæ¯ã€‚æ¥æ”¶æ¶‰åŠè·å–é”å¹¶ç­‰å¾…å‘é€è€…ã€‚å¯ä»¥ä½¿ç”¨Goçš„sync.Mutexå’Œsync.Condè‡ªå·±å®ç°é€šé“ã€‚ æˆ‘ä½¿ç”¨é€šé“å”¤é†’å¦ä¸€ä¸ªgoroutineï¼Œé€šè¿‡åœ¨é€šé“ä¸Šå‘é€ä¸€ä¸ªè™šæ‹Ÿçš„boolå€¼ã€‚ä½†å¦‚æœå¦ä¸€ä¸ªgoroutineå·²ç»åœ¨è¿è¡Œï¼ˆå› æ­¤æ²¡æœ‰åœ¨é€šé“ä¸Šæ¥æ”¶ï¼‰ï¼Œå‘é€goroutineä¼šé˜»å¡ã€‚æˆ‘åº”è¯¥æ€ä¹ˆåšï¼Ÿ å°è¯•ä½¿ç”¨æ¡ä»¶å˜é‡ï¼ˆGoçš„sync.Condï¼‰è€Œä¸æ˜¯é€šé“ã€‚æ¡ä»¶å˜é‡éå¸¸é€‚åˆé€šçŸ¥å¯èƒ½ï¼ˆæˆ–å¯èƒ½ä¸ï¼‰ç­‰å¾…æŸäº‹çš„goroutinesã€‚ç”±äºé€šé“æ˜¯åŒæ­¥çš„ï¼Œå¦‚æœä¸ç¡®å®šé€šé“å¦ä¸€ç«¯æ˜¯å¦æœ‰goroutineåœ¨ç­‰å¾…ï¼Œä½¿ç”¨é€šé“ä¼šæ˜¾å¾—å¾ˆå°´å°¬ã€‚ å¦‚ä½•è®©ä¸€ä¸ªgoroutineç­‰å¾…æ¥è‡ªå¤šä¸ªä¸åŒé€šé“çš„è¾“å…¥ï¼Ÿå¦‚æœæ²¡æœ‰ä»»ä½•å†…å®¹å¯è¯»å–ï¼Œåˆ™å°è¯•åœ¨ä»»ä½•ä¸€ä¸ªé€šé“ä¸Šæ¥æ”¶éƒ½ä¼šé˜»å¡ï¼Œä»è€Œé˜»æ­¢ goroutine æ£€æŸ¥å…¶ä»–é€šé“ã€‚ å°è¯•ä¸ºæ¯ä¸ªé€šé“åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„goroutineï¼Œæ¯ä¸ªgoroutineé˜»å¡åœ¨å…¶é€šé“ä¸Šã€‚è¿™ä¸æ˜¯æ€»èƒ½å®ç°ï¼Œä½†åœ¨å¯è¡Œæ—¶é€šå¸¸æ˜¯æœ€ç®€å•çš„æ–¹æ³•ã€‚å¦åˆ™ï¼Œå°è¯•ä½¿ç”¨Goçš„selectã€‚ ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨sync.WaitGroupè€Œä¸æ˜¯é€šé“ï¼Ÿåä¹‹äº¦ç„¶ï¼Ÿ WaitGroupç”¨é€”è¾ƒä¸ºç‰¹æ®Šï¼›å®ƒä»…åœ¨ç­‰å¾…ä¸€å †æ´»åŠ¨å®Œæˆæ—¶æœ‰ç”¨ã€‚é€šé“ç”¨é€”æ›´å¹¿æ³›ï¼›ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡é€šé“ä¼ é€’å€¼ã€‚å°½ç®¡æ¯”WaitGroupéœ€è¦å¤šå†™å‡ è¡Œä»£ç ï¼Œä½†ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé“ç­‰å¾…å¤šä¸ªgoroutinesã€‚ å¦‚ä½•åˆ›å»ºä¸€ä¸ªé€šè¿‡äº’è”ç½‘è¿æ¥çš„Goé€šé“ï¼Ÿå¦‚ä½•æŒ‡å®šç”¨äºå‘é€æ¶ˆæ¯çš„åè®®ï¼Ÿ Goé€šé“ä»…åœ¨å•ä¸ªç¨‹åºå†…å·¥ä½œï¼›é€šé“ä¸èƒ½ç”¨äºä¸å…¶ä»–ç¨‹åºæˆ–è®¡ç®—æœºé€šä¿¡ã€‚å¯ä»¥æŸ¥çœ‹Goçš„RPCåŒ…ï¼Œå®ƒå…è®¸ä½ é€šè¿‡äº’è”ç½‘ä¸å…¶ä»–Goç¨‹åºé€šä¿¡ï¼š https://golang.org/pkg/net/rpc/ ä¸€äº›é‡è¦/æœ‰ç”¨çš„Goç‰¹å®šå¹¶å‘æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ è¿™æ˜¯ä¸€ä¸ªå…³äºè¯¥ä¸»é¢˜çš„å¹»ç¯ç‰‡ï¼Œç”±Goä¸“å®¶ç¼–å†™ï¼š https://talks.golang.org/2012/concurrency.slide åˆ‡ç‰‡æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ åˆ‡ç‰‡æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆä»¥åŠè¯¥æ•°ç»„çš„å¼€å§‹å’Œç»“æŸç´¢å¼•ã€‚è¿™ç§å®‰æ’å…è®¸å¤šä¸ªåˆ‡ç‰‡å…±äº«ä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œæ¯ä¸ªåˆ‡ç‰‡å¯èƒ½æš´éœ²æ•°ç»„å…ƒç´ çš„ä¸åŒèŒƒå›´ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªæ›´è¯¦ç»†çš„è®¨è®ºï¼š https://blog.golang.org/go-slices-usage-and-internals Goåˆ‡ç‰‡æ¯”Goæ•°ç»„æ›´çµæ´»ï¼Œå› ä¸ºæ•°ç»„çš„å¤§å°æ˜¯å…¶ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä»¥åˆ‡ç‰‡ä½œä¸ºå‚æ•°çš„å‡½æ•°å¯ä»¥æ¥å—ä»»ä½•é•¿åº¦çš„åˆ‡ç‰‡ã€‚ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŒæ­¥RPCè°ƒç”¨ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¼‚æ­¥RPCè°ƒç”¨ï¼Ÿ å¤§å¤šæ•°ä»£ç éœ€è¦åœ¨ç»§ç»­æ‰§è¡Œå‰è·å¾—RPCå›å¤ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨åŒæ­¥RPCæ˜¯åˆç†çš„ã€‚ä½†æœ‰æ—¶å®¢æˆ·ç«¯å¸Œæœ›å¯åŠ¨è®¸å¤šå¹¶å‘RPCï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¼‚æ­¥å¯èƒ½æ›´å¥½ã€‚æˆ–è€…å®¢æˆ·ç«¯å¸Œæœ›åœ¨ç­‰å¾…RPCå®Œæˆæ—¶åšå…¶ä»–å·¥ä½œï¼Œå¯èƒ½æ˜¯å› ä¸ºæœåŠ¡å™¨å¾ˆè¿œï¼ˆæ‰€ä»¥å…‰é€Ÿæ—¶é—´å¾ˆé«˜ï¼‰æˆ–å› ä¸ºæœåŠ¡å™¨å¯èƒ½ä¸å¯è¾¾ï¼Œä»è€ŒRPCç»å†é•¿æ—¶é—´çš„è¶…æ—¶ã€‚æˆ‘(Robert)ä»æœªåœ¨Goä¸­ä½¿ç”¨å¼‚æ­¥RPCã€‚å½“æˆ‘æƒ³å‘é€RPCä½†ä¸å¿…ç­‰å¾…ç»“æœæ—¶ï¼Œæˆ‘åˆ›å»ºä¸€ä¸ªgoroutineï¼Œå¹¶è®©è¿™ä¸ªgoroutineè¿›è¡ŒåŒæ­¥Call()ã€‚ å¼€å‘äººå‘˜åœ¨å¼€å§‹ä½¿ç”¨Goæ—¶å¸¸è§çš„é—®é¢˜æœ‰å“ªäº›ï¼Ÿ ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§é—®é¢˜ï¼š - æœªåœ¨å¹¶å‘è®¿é—®æ—¶ä½¿ç”¨é”ä¿æŠ¤æ˜ å°„ã€‚ä½¿ç”¨Goçš„ç«æ€æ£€æµ‹å™¨ï¼ - ä½¿ç”¨é€šé“æ—¶çš„æ­»é”ã€‚ - åœ¨åˆ›å»ºgoroutineæ—¶æœªæ•è·å˜é‡ã€‚ - æ³„æ¼çš„goroutinesã€‚ Goæ˜¯å¦æ”¯æŒç»§æ‰¿ï¼Ÿï¼ˆåƒJava/C++é‚£æ ·çš„â€œæ‰©å±•â€æ–¹å¼ï¼Ÿï¼‰ Goä¸æ”¯æŒC++é£æ ¼çš„ç»§æ‰¿ï¼Œä½†æœ‰æ¥å£å’ŒåµŒå…¥ç»“æ„ä½“ï¼Œå¯ä»¥å®Œæˆåœ¨C++ä¸­ä½¿ç”¨ç»§æ‰¿çš„è®¸å¤šäº‹æƒ…ã€‚è¿™æ˜¯Goè®¾è®¡ä¸­å¤‡å—äº‰è®®çš„éƒ¨åˆ†ï¼›å¯ä»¥æœç´¢â€œgolang genericsâ€ã€‚ æˆ‘å¯¹é€‰æ‹©å€¼æ¥æ”¶å™¨æˆ–æŒ‡é’ˆæ¥æ”¶å™¨ä»æœ‰äº›å›°æƒ‘ã€‚èƒ½å¦æä¾›ä¸€äº›å…·ä½“çš„å®é™…ä¾‹å­è¯´æ˜æˆ‘ä»¬åº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªï¼Ÿ å½“ä½ æƒ³ä¿®æ”¹æ¥æ”¶å™¨çš„çŠ¶æ€æ—¶ï¼Œå¿…é¡»ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ã€‚å¦‚æœç»“æ„ä½“éå¸¸å¤§ï¼Œä½ å¯èƒ½æƒ³ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ï¼Œå› ä¸ºå€¼æ¥æ”¶å™¨æ“ä½œçš„æ˜¯ä¸€ä¸ªå‰¯æœ¬ã€‚å¦‚æœä¸¤è€…éƒ½ä¸é€‚ç”¨ï¼Œå¯ä»¥ä½¿ç”¨å€¼æ¥æ”¶å™¨ã€‚ç„¶è€Œï¼Œè¦å°å¿ƒä½¿ç”¨å€¼æ¥æ”¶å™¨ï¼›ä¾‹å¦‚ï¼Œå¦‚æœç»“æ„ä½“ä¸­æœ‰ä¸€ä¸ªäº’æ–¥é”ï¼Œä½ ä¸èƒ½å°†å…¶ä½œä¸ºå€¼æ¥æ”¶å™¨ï¼Œå› ä¸ºäº’æ–¥é”ä¼šè¢«å¤åˆ¶ï¼Œä»è€Œå¤±å»å…¶ä½œç”¨ã€‚ ","date":"2024-05-15","objectID":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ä½¿ç”¨Goè¿›è¡Œçº¿ç¨‹å’ŒRPCç¼–ç¨‹","uri":"/posts/02.%E4%BD%BF%E7%94%A8go%E8%BF%9B%E8%A1%8C%E7%BA%BF%E7%A8%8B%E5%92%8Crpc%E7%BC%96%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å®éªŒè¦æ±‚ åœ¨æœ¬æ¬¡ Lab ä¸­ï¼Œä½ å°†åœ¨å•æœºä¸Šæ„å»ºä¸€ä¸ªé”®/å€¼æœåŠ¡å™¨ï¼Œä»¥ç¡®ä¿å³ä½¿ç½‘ç»œå‡ºç°æ•…éšœï¼Œæ¯ä¸ªæ“ä½œä¹Ÿåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”æ“ä½œæ˜¯å¯çº¿æ€§åŒ–çš„ã€‚ å®¢æˆ·ç«¯å¯ä»¥å‘é”®/å€¼æœåŠ¡å™¨å‘é€ä¸‰ä¸ªä¸åŒçš„ RPCï¼š Put(key, value) ã€ Append(key, arg) å’Œ Get(key) ã€‚æœåŠ¡å™¨åœ¨å†…å­˜ä¸­ç»´æŠ¤é”®/å€¼å¯¹çš„mapã€‚é”®å’Œå€¼æ˜¯å­—ç¬¦ä¸²ã€‚ Put(key, value) è®¾ç½®æˆ–æ›¿æ¢mapä¸­ç»™å®šé”®çš„å€¼ï¼Œ Append(key, arg) å°† arg é™„åŠ åˆ°é”®çš„å€¼å¹¶è¿”å›æ—§å€¼ï¼Œ Get(key) è·å–é”®çš„å½“å‰å€¼ã€‚ä¸å­˜åœ¨çš„é”®çš„ Getè¯·æ±‚åº”è¿”å›ç©ºå­—ç¬¦ä¸²ï¼›å¯¹äºä¸å­˜åœ¨çš„é”®çš„ Append è¯·æ±‚åº”è¯¥è¡¨ç°ä¸ºç°æœ‰å€¼æ˜¯é›¶é•¿åº¦å­—ç¬¦ä¸²ã€‚æ¯ä¸ªå®¢æˆ·ç«¯éƒ½é€šè¿‡Clerkçš„ Put/Append/Get æ–¹æ³•ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ã€‚ Clerk ç®¡ç†ä¸æœåŠ¡å™¨çš„ RPC äº¤äº’ã€‚ ä½ çš„æœåŠ¡å™¨å¿…é¡»ä¿è¯åº”ç”¨ç¨‹åºå¯¹Clerk Get/Put/Append æ–¹æ³•çš„è°ƒç”¨æ˜¯çº¿æ€§ä¸€è‡´çš„ã€‚ å¦‚æœå®¢æˆ·ç«¯è¯·æ±‚ä¸æ˜¯å¹¶å‘çš„ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯ Get/Put/Append è°ƒç”¨æ—¶èƒ½å¤Ÿçœ‹åˆ°ä¹‹å‰è°ƒç”¨åºåˆ—å¯¼è‡´çš„çŠ¶æ€å˜æ›´ã€‚ å¯¹äºå¹¶å‘çš„è¯·æ±‚æ¥è¯´ï¼Œè¿”å›çš„ç»“æœå’Œæœ€ç»ˆçŠ¶æ€éƒ½å¿…é¡»å’Œè¿™äº›æ“ä½œé¡ºåºæ‰§è¡Œçš„ç»“æœä¸€è‡´ã€‚å¦‚æœä¸€äº›è¯·æ±‚åœ¨æ—¶é—´ä¸Šé‡å ï¼Œåˆ™å®ƒä»¬æ˜¯å¹¶å‘çš„ï¼šä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯ X è°ƒç”¨ Clerk.Put() ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ Y è°ƒç”¨ Clerk.Append() ï¼Œç„¶åå®¢æˆ·ç«¯ X çš„è°ƒç”¨ è¿”å›ã€‚ ä¸€ä¸ªè¯·æ±‚å¿…é¡»èƒ½å¤Ÿçœ‹åˆ°å·²å®Œæˆçš„æ‰€æœ‰è°ƒç”¨å¯¼è‡´çš„çŠ¶æ€å˜æ›´ã€‚ ä¸€ä¸ªåº”ç”¨å®ç°çº¿æ€§ä¸€è‡´æ€§å°±åƒä¸€å°å•æœºæœåŠ¡å™¨ä¸€æ¬¡å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„è¡Œä¸ºä¸€æ ·ç®€å•ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªæ›´æ–°è¯·æ±‚å¹¶ä»æœåŠ¡å™¨è·å–äº†å“åº”ï¼Œéšåä»å…¶ä»–å®¢æˆ·ç«¯å‘èµ·çš„è¯»æ“ä½œå¯ä»¥ä¿è¯èƒ½çœ‹åˆ°æ”¹æ›´æ–°çš„ç»“æœã€‚åœ¨å•å°æœåŠ¡å™¨ä¸Šæä¾›çº¿æ€§ä¸€è‡´æ€§æ˜¯ç›¸å¯¹æ¯”è¾ƒå®¹æ˜“çš„ã€‚ Lab åœ¨ src/kvsrv ä¸­æä¾›äº†æ¡†æ¶ä»£ç å’Œå•å…ƒæµ‹è¯•ã€‚ä½ éœ€è¦æ›´æ”¹ kvsrv/client.goã€kvsrv/server.go å’Œ kvsrv/common.go æ–‡ä»¶ã€‚ ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æ— ç½‘ç»œæ•…éšœçš„KV Server ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 ä»»åŠ¡è¦æ±‚ æ­¤ä»»åŠ¡éœ€è¦å®ç°ä¸€ä¸ªåœ¨æ²¡æœ‰ä¸¢å¤±æ¶ˆæ¯çš„æƒ…å†µä¸‹æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ä½ éœ€è¦åœ¨ client.go ä¸­ï¼Œåœ¨ Clerk çš„ Put/Append/Get æ–¹æ³•ä¸­æ·»åŠ  RPC çš„å‘é€ä»£ç ï¼›å¹¶ä¸”å®ç° server.go ä¸­ Putã€Appendã€Get ä¸‰ä¸ª RPC handlerã€‚ å½“ä½ é€šè¿‡äº†å‰ä¸¤ä¸ªæµ‹è¯• caseï¼šone clientã€many clients æ—¶è¡¨ç¤ºå®Œæˆè¯¥ä»»åŠ¡ã€‚ ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:2:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 è®¾è®¡å®ç° è¿™ä¸ªä»»åŠ¡æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®å®éªŒè¦æ±‚çš„é€»è¾‘è¿›è¡Œå®ç°å³å¯ã€‚ server.go ä½¿ç”¨mapä¿å­˜é”®å€¼ä¿¡æ¯ï¼Œä¸‰ç§æ“ä½œéƒ½éœ€è¦é€šè¿‡é”æ¥ä¿è¯äº’æ–¥è®¿é—®å…±äº«mapã€‚ func (kv *KVServer) Get(args *GetArgs, reply *GetReply) { kv.mu.Lock() defer kv.mu.Unlock() reply.Value = kv.data[args.Key] } func (kv *KVServer) Put(args *PutAppendArgs, reply *PutAppendReply) { kv.mu.Lock() defer kv.mu.Unlock() kv.data[args.Key] = args.Value } func (kv *KVServer) Append(args *PutAppendArgs, reply *PutAppendReply) { kv.mu.Lock() defer kv.mu.Unlock() oldValue := kv.data[args.Key] kv.data[args.Key] = oldValue + args.Value reply.Value = oldValue } client.go åªéœ€è¦æ·»åŠ RPCçš„å‘é€ä»£ç ã€‚ func (ck *Clerk) Get(key string) string { args := \u0026GetArgs{ Key: key, } reply := \u0026GetReply{} ck.server.Call(\"KVServer.Get\", args, reply) return reply.Value } func (ck *Clerk) PutAppend(key string, value string, op string) string { arg := \u0026PutAppendArgs{ Key: key, Value: value, } reply := \u0026PutAppendReply{} ck.server.Call(\"KVServer.\"+op, arg, reply) return reply.Value } func (ck *Clerk) Put(key string, value string) { ck.PutAppend(key, value, \"Put\") } ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:2:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 å¯èƒ½ä¸¢å¼ƒæ¶ˆæ¯çš„KV Server ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 ä»»åŠ¡è¦æ±‚ ç°åœ¨ï¼Œæ‚¨åº”è¯¥ä¿®æ”¹æ‚¨çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥ä¾¿åœ¨é‡åˆ°ä¸¢å¤±çš„æ¶ˆæ¯ï¼ˆä¾‹å¦‚ RPC è¯·æ±‚å’Œ RPC å›å¤ï¼‰æ—¶ç»§ç»­å·¥ä½œã€‚å¦‚æœæ¶ˆæ¯ä¸¢å¤±ï¼Œåˆ™å®¢æˆ·ç«¯çš„ ck.server.Call() å°†è¿”å› false ï¼ˆæ›´å‡†ç¡®åœ°è¯´ï¼Œ Call() ç­‰å¾…å“åº”ç›´è‡³è¶…å¸‚ï¼Œå¦‚æœåœ¨æ­¤æ—¶é—´å†…æ²¡æœ‰å“åº”å°±è¿”å›falseï¼‰ã€‚æ‚¨å°†é¢ä¸´çš„ä¸€ä¸ªé—®é¢˜æ˜¯ Clerk å¯èƒ½éœ€è¦å¤šæ¬¡å‘é€ RPCï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚ä½†æ˜¯ï¼Œæ¯æ¬¡è°ƒç”¨ Clerk.Put() æˆ– Clerk.Append() åº”è¯¥åªä¼šå¯¼è‡´ä¸€æ¬¡æ‰§è¡Œï¼Œå› æ­¤æ‚¨å¿…é¡»ç¡®ä¿é‡æ–°å‘é€ä¸ä¼šå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œè¯·æ±‚ä¸¤æ¬¡ã€‚ ä½ çš„ä»»åŠ¡æ˜¯åœ¨ Clerk ä¸­æ·»åŠ é‡è¯•é€»è¾‘ï¼Œå¹¶ä¸”åœ¨ server.go ä¸­æ¥è¿‡æ»¤é‡å¤è¯·æ±‚ã€‚ Hint æ‚¨éœ€è¦å”¯ä¸€åœ°æ ‡è¯†clientæ“ä½œï¼Œä»¥ç¡®ä¿KV Serverä»…æ‰§è¡Œæ¯ä¸ªæ“ä½œä¸€æ¬¡ã€‚ æ‚¨å¿…é¡»ä»”ç»†è€ƒè™‘serverå¿…é¡»ç»´æŒä»€ä¹ˆçŠ¶æ€æ¥å¤„ç†é‡å¤çš„ Get() ã€ Put() å’Œ Append() è¯·æ±‚ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ æ‚¨çš„é‡å¤æ£€æµ‹æ–¹æ¡ˆåº”è¯¥å¿«é€Ÿé‡Šæ”¾æœåŠ¡å™¨å†…å­˜ï¼Œä¾‹å¦‚è®©æ¯ä¸ª RPC æš—ç¤ºclientå·²çœ‹åˆ°å…¶å‰ä¸€ä¸ª RPC çš„å›å¤ã€‚å¯ä»¥å‡è®¾clientä¸€æ¬¡åªå‘Clerkå‘èµ·ä¸€æ¬¡è°ƒç”¨ã€‚ ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:3:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 æ–¹æ¡ˆè®¾è®¡ æ ¹æ®æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºPutå’ŒAppendæ¶ˆæ¯æ·»åŠ æ ‡è¯†IDï¼ˆGetæ¶ˆæ¯åªéœ€ä¸æ–­é‡è¯•ï¼Œä¸ä¼šæœ‰å½±å“ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦ç”¨åˆ°sync.Mapç”¨äºåœ¨é”®/å€¼æœåŠ¡å™¨ä¸­è·Ÿè¸ªå¤„ç†è¿‡çš„è¯·æ±‚IDï¼Œä»¥é˜²æ­¢é‡å¤å¤„ç†è¯·æ±‚ã€‚æ¯å½“æœåŠ¡å™¨æ¥æ”¶åˆ°ä¸€ä¸ªæ–°çš„RPCè¯·æ±‚æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥è¯·æ±‚IDæ˜¯å¦å·²å­˜åœ¨äºsync.Mapä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™è¡¨æ˜è¯¥è¯·æ±‚å·²ç»å¤„ç†è¿‡ï¼ŒæœåŠ¡å™¨å¯ä»¥è·³è¿‡é‡å¤çš„å¤„ç†ï¼Œç›´æ¥è¿”å›ä¹‹å‰å¤„ç†è¿‡çš„å€¼ã€‚å¦åˆ™ï¼ŒæœåŠ¡å™¨ä¼šè®°å½•è¯¥è¯·æ±‚IDå¤„ç†è¯·æ±‚ï¼Œå¹¶å°†å›å¤ç»“æœè®°å½•ã€‚è¿™ç§æœºåˆ¶ç¡®ä¿äº†æ“ä½œçš„å¹‚ç­‰æ€§ï¼Œé¿å…äº†ç”±äºç½‘ç»œæ•…éšœæˆ–é‡è¯•æœºåˆ¶å¯¼è‡´çš„é‡å¤æ‰§è¡Œã€‚ å½“ç„¶ï¼Œè¿˜éœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æœåŠ¡å™¨ä¼šä¸æ–­ç§¯å‹å¤„ç†è¿‡çš„è¯·æ±‚IDä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¿«é€Ÿé‡Šæ”¾æœåŠ¡å™¨å†…å­˜ï¼Œå³è®©Clienté€šçŸ¥Serverè¿™ä¸ªä»»åŠ¡æ“ä½œå·²ç»å®Œæˆï¼Œåˆ é™¤ç›¸å…³çš„è®°å½•ä¿¡æ¯ã€‚æ•…æˆ‘ä»¬è¿˜éœ€è¦ç»™æ¶ˆæ¯ç»“æ„æ·»åŠ ä¸€ä¸ªTypeå­—æ®µæ ‡è¯†ä¸ºModifyè¿˜æ˜¯Reportã€‚ æ•´ä¸ªæµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:3:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 ä»£ç å®ç° å®éªŒä»£ç å®ç°ä»“åº“ï¼šhttps://github.com/unique-pure/MIT6.5840/tree/main/src/kvsrvï¼Œå®éªŒä»£ç å·²é€šè¿‡å®éªŒæµ‹è¯•ã€‚ common.go type MessageType int const ( Modify = iota Report ) // Put or Append type PutAppendArgs struct { Key string Value string MessageType MessageType // Modify or Report MessageID int64 // Unique ID for each message } server.go type KVServer struct { mu sync.Mutex data map[string]string record sync.Map } func (kv *KVServer) Get(args *GetArgs, reply *GetReply) { kv.mu.Lock() defer kv.mu.Unlock() reply.Value = kv.data[args.Key] } func (kv *KVServer) Put(args *PutAppendArgs, reply *PutAppendReply) { if args.MessageType == Report { kv.record.Delete(args.MessageID) } res, ok := kv.record.Load(args.MessageID) if ok { reply.Value = res.(string) // é‡å¤è¯·æ±‚ï¼Œè¿”å›ä¹‹å‰çš„ç»“æœ return } kv.mu.Lock() old := kv.data[args.Key] kv.data[args.Key] = args.Value reply.Value = old kv.mu.Unlock() kv.record.Store(args.MessageID, old) // è®°å½•è¯·æ±‚ } func (kv *KVServer) Append(args *PutAppendArgs, reply *PutAppendReply) { if args.MessageType == Report { kv.record.Delete(args.MessageID) } res, ok := kv.record.Load(args.MessageID) if ok { reply.Value = res.(string) // é‡å¤è¯·æ±‚ï¼Œè¿”å›ä¹‹å‰çš„ç»“æœ return } kv.mu.Lock() old := kv.data[args.Key] kv.data[args.Key] = old + args.Value reply.Value = old kv.mu.Unlock() kv.record.Store(args.MessageID, old) // è®°å½•è¯·æ±‚ } client.go func (ck *Clerk) Get(key string) string { args := \u0026GetArgs{ Key: key, } reply := \u0026GetReply{} for !ck.server.Call(\"KVServer.Get\", args, reply) { } // keep trying forever return reply.Value } func (ck *Clerk) PutAppend(key string, value string, op string) string { MessageID := nrand() arg := \u0026PutAppendArgs{ Key: key, Value: value, MessageID: MessageID, MessageType: Modify, } reply := \u0026PutAppendReply{} for !ck.server.Call(\"KVServer.\"+op, arg, reply) { } arg = \u0026PutAppendArgs{ MessageType: Report, MessageID: MessageID, } for !ck.server.Call(\"KVServer.\"+op, arg, reply) { } return reply.Value } â¯ go test Test: one client ... Passed -- t 3.3 nrpc 20037 ops 13359 Test: many clients ... ... Passed -- t 3.7 nrpc 85009 ops 56718 Test: unreliable net, many clients ... ... Passed -- t 3.3 nrpc 1161 ops 632 Test: concurrent append to same key, unreliable ... ... Passed -- t 0.4 nrpc 131 ops 52 Test: memory use get ... ... Passed -- t 0.6 nrpc 8 ops 0 Test: memory use put ... ... Passed -- t 0.3 nrpc 4 ops 0 Test: memory use append ... ... Passed -- t 0.5 nrpc 4 ops 0 Test: memory use many put clients ... ... Passed -- t 36.7 nrpc 200000 ops 0 Test: memory use many get client ... ... Passed -- t 22.6 nrpc 100002 ops 0 Test: memory use many appends ... 2024/05/15 12:48:26 m0 411000 m1 1550088 ... Passed -- t 2.6 nrpc 2000 ops 0 PASS ok 6.5840/kvsrv 75.329s ","date":"2024-05-15","objectID":"/posts/06.mit-6.58406.824-lab2-kv-server/:3:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824) ã€‘Lab2:Key/Value Server è®¾è®¡å®ç°","uri":"/posts/06.mit-6.58406.824-lab2-kv-server/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ä»‹ç» æœ¬æ¬¡å®éªŒæ˜¯å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆæœ¬çš„MapReduceï¼Œä½ éœ€è¦å®ç°ä¸€ä¸ªå·¥ä½œç¨‹åºï¼ˆworker processï¼‰å’Œä¸€ä¸ªè°ƒåº¦ç¨‹åºï¼ˆcoordinator processï¼‰ã€‚å·¥ä½œç¨‹åºç”¨æ¥è°ƒç”¨Mapå’ŒReduceå‡½æ•°ï¼Œå¹¶å¤„ç†æ–‡ä»¶çš„è¯»å–å’Œå†™å…¥ã€‚è°ƒåº¦ç¨‹åºç”¨æ¥åè°ƒå·¥ä½œä»»åŠ¡å¹¶å¤„ç†å¤±è´¥çš„ä»»åŠ¡ã€‚ä½ å°†æ„å»ºå‡ºè·Ÿ MapReduceè®ºæ–‡ é‡Œæè¿°çš„ç±»ä¼¼çš„ä¸œè¥¿ã€‚ï¼ˆæ³¨æ„ï¼šæœ¬å®éªŒä¸­ç”¨\"coordinator\"æ›¿ä»£é‡Œè®ºæ–‡ä¸­çš„\"master\"ã€‚ï¼‰ å®éªŒå…ˆå†³æ¡ä»¶ï¼š é˜…è¯»MapReduceè®ºæ–‡ é˜…è¯»labæ–‡æ¡£ ç†è§£MapReduceæ¡†æ¶ ç†è§£åŸæ¡†æ¶ä»£ç ï¼Œç†æ¸…æ‰€éœ€å®Œæˆä»»åŠ¡ å®éªŒä»£ç å®ç°ä»“åº“ï¼šhttps://github.com/unique-pure/MIT6.5840/tree/main/src/mrï¼Œå®éªŒä»£ç å·²é€šè¿‡å®éªŒæµ‹è¯•ï¼Œå¹¶åœ¨ä»¥ä¸‹æ¸…å•ä¸­åˆ—å‡ºäº†å®ç°çš„åŠŸèƒ½åŠå¾…åŠäº‹é¡¹ã€‚ Complete the basic requirements for MapReduce Handling worker failures No data competition, a big lock ensures safety Pass lab test Communicate over TCP/IP and read/write files using a shared file system ","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 åŸæ¡†æ¶è§£æ src/mrapps/wc.go è¿™æ˜¯ä¸€ä¸ªç”¨äº MapReduce çš„å­—æ•°ç»Ÿè®¡ï¼ˆWord Countï¼‰æ’ä»¶ã€‚è¯¥æ’ä»¶åŒ…å« Map å’Œ Reduce å‡½æ•°ï¼Œç”¨äºç»Ÿè®¡è¾“å…¥æ–‡æœ¬ä¸­çš„å•è¯é¢‘ç‡ã€‚ func Map(filename string, contents string) []mr.KeyValue { // function to detect word separators. ff := func(r rune) bool { return !unicode.IsLetter(r) } // split contents into an array of words. words := strings.FieldsFunc(contents, ff) kva := []mr.KeyValue{} for _, w := range words { kv := mr.KeyValue{w, \"1\"} kva = append(kva, kv) } return kva } func Reduce(key string, values []string) string { // return the number of occurrences of this word. return strconv.Itoa(len(values)) } src/main/mrcoordinator.go mrcoordinator.go å®šä¹‰äº†è°ƒåº¦å™¨ï¼ˆCoordinatorï¼‰çš„ä¸»è¦é€»è¾‘ã€‚è°ƒåº¦å™¨é€šè¿‡ MakeCoordinator å¯åŠ¨ä¸€ä¸ª Coordinator å®ä¾‹ cï¼Œå¹¶åœ¨ c.server() ä¸­é€šè¿‡åç¨‹ go http.Serve(l, nil) å¯åŠ¨ä¸€ä¸ª HTTP æœåŠ¡å™¨æ¥æ¥æ”¶å’Œå¤„ç† RPC è°ƒç”¨ã€‚ func (c *Coordinator) server() { rpc.Register(c) rpc.HandleHTTP() //l, e := net.Listen(\"tcp\", \":1234\") sockname := coordinatorSock() os.Remove(sockname) l, e := net.Listen(\"unix\", sockname) if e != nil { log.Fatal(\"listen error:\", e) } go http.Serve(l, nil) } func MakeCoordinator(files []string, nReduce int) *Coordinator { c := Coordinator{} c.server() return \u0026c } æ³¨æ„ï¼šåœ¨ Go çš„ net/http åŒ…ä¸­ï¼Œä½¿ç”¨ http.Serve(l, nil) å¯åŠ¨ HTTP æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šä¸ºæ¯ä¸ªä¼ å…¥çš„è¯·æ±‚è‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªæ–°çš„åç¨‹ã€‚è¿™æ„å‘³ç€æ¯ä¸ª RPC è°ƒç”¨éƒ½æ˜¯åœ¨ç‹¬ç«‹çš„åç¨‹ä¸­å¤„ç†çš„ï¼Œä»è€Œå…è®¸å¹¶å‘å¤„ç†å¤šä¸ªè¯·æ±‚ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡æ—¶å¯èƒ½éœ€è¦ä½¿ç”¨é”ç­‰åŒæ­¥åŸè¯­æ¥ä¿æŠ¤å…±äº«èµ„æºã€‚æ­¤å¤–ï¼ŒCoordinator ä¸ä¼šä¸»åŠ¨ä¸ Worker é€šä¿¡ï¼ˆé™¤éé¢å¤–å®ç°ï¼‰ï¼Œåªèƒ½é€šè¿‡ Worker çš„ RPC é€šä¿¡æ¥å®Œæˆä»»åŠ¡ã€‚åŒæ—¶ï¼Œå½“æ‰€æœ‰ä»»åŠ¡å®Œæˆæ—¶ï¼ŒDone æ–¹æ³•å°†è¿”å› falseï¼Œä»è€Œå…³é—­ Coordinatorã€‚ src/main/mrworker.go mrworker.go é€šè¿‡ Worker å‡½æ•°è¿è¡Œã€‚å› æ­¤ï¼ŒWorker å‡½æ•°éœ€è¦å®Œæˆè¯·æ±‚ä»»åŠ¡ã€æ‰§è¡Œä»»åŠ¡ã€æŠ¥å‘Šä»»åŠ¡çŠ¶æ€ç­‰å¤šä¸ªä»»åŠ¡ã€‚å¯ä»¥æ¨æµ‹ï¼ŒWorker éœ€è¦åœ¨è¿™ä¸ªå‡½æ•°ä¸­ä¸æ–­åœ°è½®è¯¢ Coordinatorï¼Œå¹¶æ ¹æ® Coordinator çš„ä¸åŒå›å¤æ¥é©±åŠ¨å½“å‰ Worker å®Œæˆå„ç§ä»»åŠ¡ã€‚ src/main/mrsequential.go mrsequential.go å®ç°äº†ä¸€ä¸ªç®€å•çš„é¡ºåº MapReduce åº”ç”¨ç¨‹åºã€‚è¯¥ç¨‹åºè¯»å–è¾“å…¥æ–‡ä»¶ï¼Œæ‰§è¡Œ Map å’Œ Reduce æ“ä½œï¼Œå¹¶å°†ç»“æœå†™å…¥è¾“å‡ºæ–‡ä»¶ã€‚ ","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 è®¾è®¡å®ç° ","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 ä»»åŠ¡åˆ†æ æ€»ä½“è€Œè¨€ï¼ŒWorkeré€šè¿‡RPCè½®è¯¢Coordinatorè¯·æ±‚ä»»åŠ¡ï¼Œä¾‹å¦‚Mapæˆ–è€…Reduceä»»åŠ¡ï¼ŒCoordinatorå°†å‰©ä½™ä»»åŠ¡åˆ†é…ç»™Workerå¤„ç†ï¼ˆå…ˆå¤„ç†å®ŒMapä»»åŠ¡æ‰èƒ½å¤„ç†Reduceä»»åŠ¡ï¼‰ã€‚ å…¶ä¸­ï¼Œåœ¨æ­¤å®éªŒä¸­Mapä»»åŠ¡æ•°é‡å°±æ˜¯è¾“å…¥æ–‡ä»¶æ•°é‡ï¼Œæ¯ä¸ªMap Taskçš„ä»»åŠ¡å°±æ˜¯å¤„ç†ä¸€ä¸ª.txtæ–‡ä»¶ï¼›Reduceä»»åŠ¡çš„æ•°é‡æ˜¯nReduceã€‚ ç”±äºMapä»»åŠ¡ä¼šå°†æ–‡ä»¶çš„å†…å®¹åˆ†å‰²ä¸ºæŒ‡å®šçš„nReduceä»½ï¼Œæ¯ä¸€ä»½åº”å½“ç”±åºå·æ ‡æ˜ï¼Œæ‹¥æœ‰è¿™æ ·çš„åºå·çš„å¤šä¸ªMapä»»åŠ¡çš„è¾“å‡ºæ±‡æ€»èµ·æ¥å°±æ˜¯å¯¹åº”çš„Reduceä»»åŠ¡çš„è¾“å…¥ã€‚ è¯·æ±‚å®Œä»»åŠ¡åï¼ŒWorkeréœ€è¦æ ¹æ®ä»»åŠ¡ç±»å‹è¿›è¡Œå¤„ç†ï¼Œè¿™æ®µå¤„ç†è¿‡ç¨‹è·Ÿmrsequential.goåŸºæœ¬ä¸€è‡´ï¼Œä½†éœ€è¦æ³¨æ„çš„å°±æ˜¯è®ºæ–‡ä¸­æåˆ°çš„ï¼Œå¦‚æœåŒä¸€ä¸ªä»»åŠ¡è¢«å¤šä¸ªWorkeræ‰§è¡Œï¼Œé’ˆå¯¹åŒä¸€ä¸ªæœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶å°†æœ‰å¤šä¸ªé‡å‘½åæ“ä½œæ‰§è¡Œã€‚æˆ‘ä»¬è¿™å°±ä¾èµ–åº•å±‚æ–‡ä»¶ç³»ç»Ÿæä¾›çš„é‡å‘½åæ“ä½œçš„åŸå­æ€§æ¥ä¿è¯æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä»…ä»…åŒ…å«ä¸€ä¸ªä»»åŠ¡äº§ç”Ÿçš„æ•°æ®ã€‚å³é€šè¿‡os.Rename()ã€‚ å¤„ç†å®Œä»»åŠ¡åï¼ŒWorkeré€šè¿‡RPCå‘ŠçŸ¥Coordinatorä»»åŠ¡ç»“æœã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“Coordinatorç®¡ç†ç€ä»»åŠ¡çŠ¶æ€å’Œä»»åŠ¡åˆ†é…ï¼Œè€Œæ— éœ€è®°å½•Workerçš„ä¿¡æ¯ï¼ŒWorkerå®ç°ä»»åŠ¡å¤„ç†ã€‚ æ•´ä¸ªä»»åŠ¡æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š MapReduceå¤„ç†WordCountç¨‹åºçš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:3:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 RPC é€šä¿¡æ—¶é¦–å…ˆéœ€è¦ç¡®å®šè¿™ä¸ªæ¶ˆæ¯æ˜¯ä»€ä¹ˆç±»å‹, é€šè¿‡å‰è¿°åˆ†æå¯çŸ¥ï¼š å¯¹äºWorkerå‘é€æ¶ˆæ¯ï¼ŒWorkeréœ€è¦è·ŸCoordinatoræŠ¥å‘ŠMapæˆ–Reduceä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µ(æˆåŠŸæˆ–å¤±è´¥) type TaskCompletedStatus int const ( MapTaskCompleted = iota MapTaskFailed ReduceTaskCompleted ReduceTaskFailed ) å¯¹äºCoordinatorå›å¤æ¶ˆæ¯ï¼ŒCoordinatoréœ€è¦åˆ†é…Reduceæˆ–Mapä»»åŠ¡ï¼Œå‘ŠçŸ¥ä»»åŠ¡çš„ç±»å‹ï¼Œæˆ–è€…å‘ŠçŸ¥Workerä¼‘çœ ï¼ˆæš‚æ—¶æ²¡æœ‰ä»»åŠ¡éœ€è¦æ‰§è¡Œï¼‰ã€Workeré€€å‡ºï¼ˆæ‰€æœ‰ä»»åŠ¡æ‰§è¡ŒæˆåŠŸï¼‰ type TaskType int const ( MapTask = iota ReduceTask Wait Exit ) åŒæ—¶ï¼Œæ¶ˆæ¯è¿˜éœ€è¦é™„å¸¦é¢å¤–çš„ä¿¡æ¯ï¼Œæˆ‘è¿™é‡Œçš„è®¾è®¡æ˜¯å‘é€æ¶ˆæ¯åŒ…å«ä»»åŠ¡IDï¼Œä»¥ä¾¿Coordinatoræ›´æ–°ä»»åŠ¡çŠ¶æ€ï¼Œç»“æ„å¦‚ä¸‹ï¼š type MessageSend struct { TaskID int // task id TaskCompletedStatus TaskCompletedStatus // task completed status } å›å¤æ¶ˆæ¯ç»“æ„å¦‚ä¸‹ï¼š type MessageReply struct { TaskID int // task id TaskType TaskType // task type, map or reduce or wait or exit TaskFile string // task file name NReduce int // reduce number, indicate the number of reduce tasks NMap int // map number, indicate the number of map tasks } è¿™äº›å­—æ®µéƒ½æ˜¯ä¸ºäº†è¾…åŠ©Workerè¿›è¡Œä»»åŠ¡å¤„ç†ï¼Œå¦‚NMapæ˜¯ä¸ºäº†æä¾›Mapä»»åŠ¡çš„æ•°é‡ï¼Œä»¥ä¾¿ç”Ÿæˆä¸­é—´æ–‡ä»¶åï¼ŒTaskFileæ˜¯ä¿å­˜Mapä»»åŠ¡éœ€è¦å¤„ç†çš„è¾“å…¥æ–‡ä»¶ã€‚ å¯¹äºé€šä¿¡ï¼ŒåŸæ¡†æ¶å·²æä¾›Unixå¥—æ¥å­—é€šä¿¡ï¼Œå¦‚æœæœ‰æƒ³æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°† RPC è®¾ç½®ä¸ºé€šè¿‡ TCP/IP è€Œä¸æ˜¯ Unix å¥—æ¥å­—è¿›è¡Œé€šä¿¡ï¼ˆè¯·å‚é˜… Coordinator.server() ä¸­æ³¨é‡Šæ‰çš„è¡Œï¼‰ï¼Œå¹¶ä½¿ç”¨å…±äº«æ–‡ä»¶ç³»ç»Ÿè¯»/å†™æ–‡ä»¶ã€‚ ","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:3:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 Coordinator 3.3.1 ç»“æ„ å¦‚å‰æ‰€è¿°ï¼ŒCoordinatoréœ€è¦ç®¡ç†ä»»åŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¯¹äºä¸€ä¸ªä»»åŠ¡è€Œè¨€ï¼Œæˆ‘ä»¬è¿™é‡Œå®šä¹‰å®ƒçš„çŠ¶æ€ä¸ºï¼šæœªåˆ†é…ã€å·²åˆ†é…ã€å®Œæˆã€å¤±è´¥ã€‚ type TaskStatus int const ( Unassigned = iota Assigned Completed Failed ) é‚£ä¹ˆï¼Œä»»åŠ¡ç»“æ„åº”è¯¥åŒ…æ‹¬ä»»åŠ¡çŠ¶æ€ï¼ŒåŒæ—¶ï¼Œå¦‚è®ºæ–‡ä¸­æåˆ°çš„ï¼Œå¯èƒ½æœ‰Workeræˆä¸ºè½ä¼è€…ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘ä¸€ä¸ªä»»åŠ¡æ˜¯å¦æ‰§è¡Œäº†å¾ˆé•¿æ—¶é—´è¿˜æ²¡ç»“æŸï¼Œæ•…è¿™é‡Œéœ€è¦è®°å½•ä»»åŠ¡åˆ†é…æ—¶çš„æ—¶é—´æˆ³ï¼Œä»¥ä¾¿è®¡ç®—è¿è¡Œæ—¶é—´ã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå­—æ®µæ¥å­˜å‚¨éœ€è¦å¤„ç†çš„ä»»åŠ¡æ–‡ä»¶åã€‚æ•…ä»»åŠ¡ä¿¡æ¯ç»“æ„å¦‚ä¸‹ï¼š type TaskInfo struct { TaskStatus TaskStatus // task status TaskFile string // task file TimeStamp time.Time // time stamp, indicating the running time of the task } å¯¹äºCoordinatorç»“æ„ï¼Œé¦–å…ˆè‚¯å®šæ˜¯éœ€è¦ä¸¤ä¸ªæ•°æ®ç»“æ„æ¥å­˜å‚¨æ‰€æœ‰çš„Mapä»»åŠ¡çŠ¶æ€å’ŒReduceä»»åŠ¡çŠ¶æ€ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„åˆ—è¡¨ï¼›ç„¶åç”±äºæ˜¯å¹¶å‘æ‰§è¡Œï¼Œæ›´æ–°å…±äº«ä»»åŠ¡çŠ¶æ€æ•°æ®ï¼Œéœ€è¦ä¸€æŠŠå¤§é”ä¿å¹³å®‰ï¼›æœ€åéœ€è¦ä¸€äº›é¢å¤–å˜é‡å­˜å‚¨ä»»åŠ¡æ•°é‡ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥len(list)ï¼‰ä»¥åŠæ ‡å¿—æŸé˜¶æ®µä»»åŠ¡æ˜¯å¦å®Œæˆï¼ˆå¦‚åœ¨Reduceä»»åŠ¡è¿›è¡Œä¹‹å‰Mapä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆï¼‰ã€‚ type Coordinator struct { NMap int // number of map tasks NReduce int // number of reduce tasks MapTasks []TaskInfo // map task ReduceTasks []TaskInfo // reduce task AllMapTaskCompleted bool // whether all map tasks have been completed AllReduceTaskCompleted bool // whether all reduce tasks have been completed Mutex sync.Mutex // mutex, used to protect the shared data } 3.3.2 åˆå§‹åŒ– æˆ‘ä»¬éœ€è¦å¯¹Coordinatoråˆå§‹åŒ–ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯æ›´æ–°ä»»åŠ¡åˆå§‹çŠ¶æ€ï¼Œä¸€å¼€å§‹éƒ½æ˜¯æœªåˆ†é…ï¼Œ func (c *Coordinator) InitTask(file []string) { for idx := range file { c.MapTasks[idx] = TaskInfo{ TaskFile: file[idx], TaskStatus: Unassigned, TimeStamp: time.Now(), } } for idx := range c.ReduceTasks { c.ReduceTasks[idx] = TaskInfo{ TaskStatus: Unassigned, } } } func MakeCoordinator(files []string, nReduce int) *Coordinator { c := Coordinator{ NReduce: nReduce, NMap: len(files), MapTasks: make([]TaskInfo, len(files)), ReduceTasks: make([]TaskInfo, nReduce), AllMapTaskCompleted: false, AllReduceTaskCompleted: false, Mutex: sync.Mutex{}, } c.InitTask(files) c.server() return \u0026c } 3.3.3 RequestTaskå‡½æ•° è¿™éƒ¨åˆ†æ¯”è¾ƒå¤æ‚ï¼Œæ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„åˆ†æï¼Œå¤„ç†é€»è¾‘å¦‚ä¸‹ï¼š å¦‚æœæœ‰æœªåˆ†é…çš„ä»»åŠ¡ã€ä¹‹å‰æ‰§è¡Œå¤±è´¥ã€å·²åˆ†é…ä½†å·²ç»è¶…æ—¶ï¼ˆ10sï¼‰çš„Mapä»»åŠ¡ï¼Œåˆ™é€‰æ‹©è¿™ä¸ªä»»åŠ¡è¿›è¡Œåˆ†é…ï¼› å¦‚æœä»¥ä¸Šçš„Mapä»»åŠ¡å‡ä¸å­˜åœ¨ï¼Œä½†Mapåˆæ²¡æœ‰å…¨éƒ¨æ‰§è¡Œå®Œæˆï¼Œå‘ŠçŸ¥Workerå…ˆç­‰å¾…ï¼› Mapä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæˆçš„æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§1å’Œ2ç›¸åŒçš„é€»è¾‘è¿›è¡ŒReduceä»»åŠ¡çš„åˆ†é…ï¼› æ‰€æœ‰çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆäº†, å‘ŠçŸ¥Workeré€€å‡ºã€‚ å› æ­¤ï¼Œå¤„ç†ä»£ç å¦‚ä¸‹ï¼š func (c *Coordinator) RequestTask(args *MessageSend, reply *MessageReply) error { // lock c.Mutex.Lock() defer c.Mutex.Unlock() // assign map task if !c.AllMapTaskCompleted { // count the number of completed map tasks NMapTaskCompleted := 0 for idx, taskInfo := range c.MapTasks { if taskInfo.TaskStatus == Unassigned || taskInfo.TaskStatus == Failed || (taskInfo.TaskStatus == Assigned \u0026\u0026 time.Since(taskInfo.TimeStamp) \u003e 10*time.Second) { reply.TaskFile = taskInfo.TaskFile reply.TaskID = idx reply.TaskType = MapTask reply.NReduce = c.NReduce reply.NMap = c.NMap c.MapTasks[idx].TaskStatus = Assigned // mark the task as assigned c.MapTasks[idx].TimeStamp = time.Now() // update the time stamp return nil } else if taskInfo.TaskStatus == Completed { NMapTaskCompleted++ } } // check if all map tasks have been completed if NMapTaskCompleted == len(c.MapTasks) { c.AllMapTaskCompleted = true } else { reply.TaskType = Wait return nil } } // assign reduce task if !c.AllReduceTaskCompleted { // count the number of completed reduce tasks NReduceTaskCompleted := 0 for idx, taskInfo := range c.ReduceTasks { if taskInfo.TaskStatus == Unassigned || taskInfo.TaskStatus == Failed || (taskInfo.TaskStatus == Assigned \u0026\u0026 time.Since(taskInfo.TimeStamp) \u003e 10*time.Second) { reply.TaskID = idx reply.TaskType = ReduceTask reply.NReduce = c.NReduce reply.NMap = c.NMap c.ReduceTasks[idx].TaskStatus = Assigned // mark the task as assigned c.ReduceTasks[idx].TimeStamp = time.Now() // update the time stamp return nil } else if taskInfo.TaskStatus == Completed { NReduceTaskCompleted++ } } // check if all reduce tasks have been completed if NReduceTaskCompleted == len(c.ReduceTasks) { c.AllReduceTaskCompleted = true } else { reply.TaskType = Wait return nil } } // all tasks have been completed reply.TaskType = Exit return nil } 3.3.4 ReportTaskå‡½æ•° è¿™ä¸ªå‡½æ•°åˆ™æ˜¯æ ¹æ®Workerå‘é€çš„æ¶ˆæ¯ä»»åŠ¡å®ŒæˆçŠ¶æ€æ¥æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¿¡æ¯å³å¯ï¼Œè®°ä½ï¼Œä¸€æŠŠå¤§é”ä¿å¹³å®‰ã€‚ func (c *Coordinator) ReportTask(args *MessageSend, reply *MessageReply) error { c.Mutex.Lock() defer c.Mutex.Unlock() if args.TaskCompletedStatus == MapTaskCompleted { c.MapTasks[args.TaskID].TaskStatus = Completed return nil } else if args.TaskC","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:3:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 Worker 3.4.1 Workerè½®è¯¢ Workeréœ€è¦é€šè¿‡RPCè½®è¯¢Coordinatorè¯·æ±‚ä»»åŠ¡ï¼Œç„¶åæ ¹æ®è¿”å›çš„ä»»åŠ¡ç±»å‹è¿›è¡Œå¤„ç†ï¼ˆå³è°ƒç”¨ç›¸åº”å‡½æ•°ï¼‰ï¼š func Worker(mapf func(string, string) []KeyValue, reducef func(string, []string) string) { for { args := MessageSend{} reply := MessageReply{} call(\"Coordinator.RequestTask\", \u0026args, \u0026reply) switch reply.TaskType { case MapTask: HandleMapTask(\u0026reply, mapf) case ReduceTask: HandleReduceTask(\u0026reply, reducef) case Wait: time.Sleep(1 * time.Second) case Exit: os.Exit(0) default: time.Sleep(1 * time.Second) } } } 3.4.2 å¤„ç†Mapä»»åŠ¡ è·Ÿmrsequential.goå¤„ç†åŸºæœ¬ä¸€è‡´ï¼Œå¤„ç†å®Œæˆåéœ€è¦é€šè¿‡RPCå‘ŠçŸ¥Coordinatorç»“æœã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡os.Rename()åŸå­é‡å‘½åæ¥ä¿è¯æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä»…ä»…åŒ…å«ä¸€ä¸ªä»»åŠ¡äº§ç”Ÿçš„æ•°æ®ã€‚ func HandleMapTask(reply *MessageReply, mapf func(string, string) []KeyValue) { // open the file file, err := os.Open(reply.TaskFile) if err != nil { log.Fatalf(\"cannot open %v\", reply.TaskFile) return } // read the file, get the content content, err := io.ReadAll(file) if err != nil { log.Fatalf(\"cannot read %v\", reply.TaskFile) return } file.Close() // call the map function to get the key-value pairs kva := mapf(reply.TaskFile, string(content)) // create intermediate files intermediate := make([][]KeyValue, reply.NReduce) for _, kv := range kva { r := ihash(kv.Key) % reply.NReduce intermediate[r] = append(intermediate[r], kv) } // write the intermediate files for r, kva := range intermediate { oname := fmt.Sprintf(\"mr-%v-%v\", reply.TaskID, r) ofile, err := os.CreateTemp(\"\", oname) if err != nil { log.Fatalf(\"cannot create tempfile %v\", oname) } enc := json.NewEncoder(ofile) for _, kv := range kva { // write the key-value pairs to the intermediate file enc.Encode(kv) } ofile.Close() // Atomic file renamingï¼šrename the tempfile to the final intermediate file os.Rename(ofile.Name(), oname) } // send the task completion message to the coordinator args := MessageSend{ TaskID: reply.TaskID, TaskCompletedStatus: MapTaskCompleted, } call(\"Coordinator.ReportTask\", \u0026args, \u0026MessageReply{}) } 3.4.3 å¤„ç†Reduceä»»åŠ¡ è¿™é‡Œåˆ©ç”¨æˆ‘ä»¬ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶åç‰¹ç‚¹ï¼Œå¯¹äºæ¯ä¸ªReduceä»»åŠ¡ï¼Œå®ƒçš„è¾“å…¥æ–‡ä»¶ï¼ˆä¸­é—´æ–‡ä»¶ï¼‰åä¸ºmr-MapID-ReduceIDï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ å‡ºè¾“å…¥æ–‡ä»¶æ•°ç»„ï¼Œå°†å…¶è§£ç å¾—åˆ°é”®å€¼å¯¹ï¼Œå†è¿›è¡Œå¤„ç†ã€‚ // generate the intermediate files for reduce tasks func generateFileName(r int, NMap int) []string { var fileName []string for TaskID := 0; TaskID \u003c NMap; TaskID++ { fileName = append(fileName, fmt.Sprintf(\"mr-%d-%d\", TaskID, r)) } return fileName } func HandleReduceTask(reply *MessageReply, reducef func(string, []string) string) { // load the intermediate files var intermediate []KeyValue // get the intermediate file names intermediateFiles := generateFileName(reply.TaskID, reply.NMap) // fmt.Println(intermediateFiles) for _, filename := range intermediateFiles { file, err := os.Open(filename) if err != nil { log.Fatalf(\"cannot open %v\", filename) return } // decode the intermediate file dec := json.NewDecoder(file) for { kv := KeyValue{} if err := dec.Decode(\u0026kv); err == io.EOF { break } intermediate = append(intermediate, kv) } file.Close() } // sort the intermediate key-value pairs by key sort.Slice(intermediate, func(i, j int) bool { return intermediate[i].Key \u003c intermediate[j].Key }) // write the key-value pairs to the output file oname := fmt.Sprintf(\"mr-out-%v\", reply.TaskID) ofile, err := os.Create(oname) if err != nil { log.Fatalf(\"cannot create %v\", oname) return } for i := 0; i \u003c len(intermediate); { j := i + 1 for j \u003c len(intermediate) \u0026\u0026 intermediate[j].Key == intermediate[i].Key { j++ } var values []string for k := i; k \u003c j; k++ { values = append(values, intermediate[k].Value) } // call the reduce function to get the output output := reducef(intermediate[i].Key, values) // write the key-value pairs to the output file fmt.Fprintf(ofile, \"%v %v\\n\", intermediate[i].Key, output) i = j } ofile.Close() // rename the output file to the final output file os.Rename(ofile.Name(), oname) // send the task completion message to the coordinator args := MessageSend{ TaskID: reply.TaskID, TaskCompletedStatus: ReduceTaskCompleted, } call(\"Coordinator.ReportTask\", \u0026args, \u0026MessageReply{}) } ","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:3:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 æµ‹è¯•å’Œå¸¸è§é—®é¢˜ test-mr.shä¸ºæµ‹è¯•è„šæœ¬ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿è¡Œsh test-mr-many.sh næ¥è¿è¡Œ$n$æ¬¡æµ‹è¯•ã€‚ â¯ bash test-mr.sh *** Starting wc test --- wc test: PASS *** Starting indexer test. --- indexer test: PASS *** Starting map parallelism test. --- map parallelism test: PASS *** Starting reduce parallelism test. --- reduce parallelism test: PASS *** Starting job count test. --- job count test: PASS *** Starting early exit test. --- early exit test: PASS *** Starting crash test. --- crash test: PASS *** PASSED ALL TESTS å¸¸è§çš„é—®é¢˜å¦‚ä¸‹ï¼š ä¸èƒ½é€šè¿‡job-countæµ‹è¯• *** Starting job count test. --- map jobs ran incorrect number of times (10 != 8) --- job count test: FAIL å› ä¸ºå¤šæ¬¡å¤„ç†åŒä¸€ä¸ªä»»åŠ¡ï¼Œä¸”ä»»åŠ¡æ²¡æœ‰å¼‚å¸¸ã€‚è¿™æ˜¯å› ä¸ºåœ¨åˆ†é…ä»»åŠ¡åæ²¡æœ‰æ›´æ–°ä»»åŠ¡çš„çŠ¶æ€ï¼Œä¾‹å¦‚æ ‡è®°ä¸ºå·²åˆ†é…å’Œè®°å½•å½“å‰æ—¶é—´æˆ³ã€‚ ","date":"2024-05-14","objectID":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)ã€‘Lab1:MapReduce è®¾è®¡å®ç°","uri":"/posts/05.mit-6.58406.824-lab1mapreduce-%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 æ¦‚å¿µ å½“æˆ‘ä»¬è°ˆè®ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯ä¸€ç»„é€šè¿‡ç½‘ç»œè¿æ¥çš„è®¡ç®—æœºï¼Œå®ƒä»¬ååŒå·¥ä½œä»¥å®ŒæˆæŸç§å…±åŒçš„ä»»åŠ¡æˆ–ç›®æ ‡ã€‚ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé€šä¿¡æ˜¯é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œçš„ã€‚è¿™æ„å‘³ç€å„ä¸ªè®¡ç®—èŠ‚ç‚¹ä¹‹é—´é€šè¿‡å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ¥è¿›è¡Œé€šä¿¡ï¼Œè€Œä¸æ˜¯é€šè¿‡å…±äº«å†…å­˜ã€‚è¿™ç§æ¶ˆæ¯ä¼ é€’æ¨¡å‹ä½¿å¾—åˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°æ›´ä¸ºçµæ´»ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ç‹¬ç«‹åœ°è¿è¡Œï¼Œå¹¶é€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥è¿›è¡Œåä½œã€‚ å°½ç®¡æ¶ˆæ¯ä¼ é€’æ¨¡å‹å…·æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä½†ä¹Ÿéœ€è¦æ³¨æ„åˆ°å®ƒå¼•å…¥äº†ä¸€äº›å¤æ‚æ€§ã€‚ä¾‹å¦‚ï¼Œéœ€è¦è€ƒè™‘æ¶ˆæ¯çš„ä¼ é€’å»¶è¿Ÿã€é¡ºåºå’Œå¯é æ€§ç­‰é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œéœ€è¦ä»”ç»†è€ƒè™‘å¦‚ä½•æœ‰æ•ˆåœ°ç®¡ç†æ¶ˆæ¯ä¼ é€’ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œæ€§èƒ½ã€‚ TIPï¼šåœ¨è®¾è®¡ç³»ç»Ÿæˆ–è§£å†³é—®é¢˜æ—¶ï¼Œåº”è¯¥å§‹ç»ˆä¼˜å…ˆè€ƒè™‘åœ¨å•å°è®¡ç®—æœºä¸Šè§£å†³ã€‚åªæœ‰åœ¨é—®é¢˜è§„æ¨¡è¶…å‡ºå•å°è®¡ç®—æœºçš„å¤„ç†èƒ½åŠ›ï¼Œæˆ–è€…éœ€è¦æ»¡è¶³é«˜å¯ç”¨æ€§ã€å®¹é”™æ€§ç­‰éœ€æ±‚æ—¶ï¼Œæ‰éœ€è¦è€ƒè™‘é‡‡ç”¨åˆ†å¸ƒå¼ç³»ç»Ÿã€‚å› æ­¤ï¼Œæ·±å…¥äº†è§£é—®é¢˜çš„æ€§è´¨å’Œéœ€æ±‚ï¼Œä»¥åŠæƒè¡¡åˆ©å¼Šï¼Œæ˜¯è®¾è®¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…³é”®ã€‚ ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 é©±åŠ¨åŠ›å’ŒæŒ‘æˆ˜ å½“äººä»¬æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œé©±åŠ¨åŠ›ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š è¿½æ±‚æ›´é«˜çš„è®¡ç®—æ€§èƒ½ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿèƒ½å¤Ÿåˆ©ç”¨å¤§é‡çš„è®¡ç®—èµ„æºï¼Œå®ç°å¹¶è¡Œè¿ç®—ï¼Œå……åˆ†åˆ©ç”¨å¤šä¸ªCPUã€å¤§å®¹é‡å†…å­˜å’Œç£ç›˜èµ„æºã€‚ å®ç°å®¹é”™æ€§ï¼šå³ä½¿åœ¨å…¶ä¸­ä¸€å°è®¡ç®—æœºå‘ç”Ÿæ•…éšœæ—¶ï¼Œç³»ç»Ÿä»ç„¶èƒ½å¤Ÿä¿æŒæ­£å¸¸è¿è¡Œã€‚ è§£å†³ç©ºé—´åˆ†å¸ƒæ€§é—®é¢˜ï¼šæŸäº›é—®é¢˜å¤©ç„¶å…·æœ‰ç©ºé—´åˆ†å¸ƒæ€§ï¼Œéœ€è¦è·¨è¶Šä¸åŒåœ°ç†ä½ç½®çš„è®¡ç®—èµ„æºå’Œæ•°æ®è¿›è¡ŒååŒå¤„ç†ã€‚ä¾‹å¦‚ï¼Œé“¶è¡Œè·¨åœ°åŸŸçš„èµ„é‡‘è½¬ç§»éœ€è¦åè°ƒä¸åŒåœ°ç‚¹çš„æ•°æ®å’Œæ“ä½œï¼Œè¿™å°±éœ€è¦åˆ†å¸ƒå¼ç³»ç»Ÿæ¥å®ç°æ•°æ®çš„åŒæ­¥å’Œåè°ƒï¼Œä»¥ç¡®ä¿äº¤æ˜“çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚ æé«˜å®‰å…¨æ€§ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥é€šè¿‡å°†ç³»ç»Ÿåˆ†æ•£åœ¨å¤šä¸ªè®¡ç®—æœºä¸Šæ¥æé«˜å®‰å…¨æ€§ã€‚ä¸ä¿¡ä»»çš„ä»£ç æˆ–ç³»ç»Ÿå¯èƒ½å­˜åœ¨æ½œåœ¨çš„å®‰å…¨é£é™©ï¼Œé€šè¿‡åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è¿è¡Œä»£ç å¹¶é‡‡ç”¨åŠ å¯†é€šä¿¡ç­‰å®‰å…¨æªæ–½ï¼Œå¯ä»¥æœ‰æ•ˆé™ä½é£é™©ï¼Œå¹¶é™åˆ¶é”™è¯¯å’Œæ”»å‡»çš„å½±å“èŒƒå›´ã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿçš„æŒ‘æˆ˜æºè‡ªå…¶é©±åŠ¨åŠ›ï¼š å¹¶å‘æ‰§è¡Œå’Œå¤æ‚äº¤äº’ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡å¹¶å‘æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œä»¥åŠå¤æ‚çš„äº¤äº’å…³ç³»ã€‚è¿™å¯¼è‡´äº†åœ¨å¹¶å‘ç¼–ç¨‹ä¸­é‡åˆ°å„ç§é—®é¢˜ï¼Œä¾‹å¦‚åŒæ­¥ã€å¼‚æ­¥æ“ä½œçš„ç®¡ç†ä»¥åŠå¤„ç†æ—¶é—´ä¾èµ–æ€§ã€‚ æ„å¤–æ•…éšœï¼šåˆ†å¸ƒå¼ç³»ç»Ÿç”±å¤šä¸ªç»„æˆéƒ¨åˆ†å’Œè®¡ç®—æœºç½‘ç»œç»„æˆï¼Œå› æ­¤å®¹æ˜“å—åˆ°æ„å¤–æ•…éšœçš„å½±å“ã€‚ä¸å•ä¸ªè®¡ç®—æœºä¸åŒï¼Œè¿™äº›ç»„ä»¶å¯èƒ½åœ¨å·¥ä½œæˆ–åœæ­¢çŠ¶æ€ä¹‹é—´åˆ‡æ¢ï¼ŒåŒæ—¶è¿˜å—åˆ°ç½‘ç»œä¸­æ–­æˆ–ä¸ç¨³å®šæ€§çš„å½±å“ã€‚ æ€§èƒ½é¢„æœŸï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡æ—¨åœ¨å®ç°æ›´é«˜çš„æ€§èƒ½ï¼Œä¾‹å¦‚åˆ©ç”¨å¤§é‡è®¡ç®—èµ„æºå®ç°å¹¶è¡Œå¤„ç†ã€‚ä½†å®é™…è¯„ä¼°å¤šå°è®¡ç®—æœºæˆ–ç£ç›˜è‡‚çš„æ€§èƒ½å­˜åœ¨ä¸€å®šæŒ‘æˆ˜ï¼Œéœ€è¦ä»”ç»†çš„è®¾è®¡å’Œè°ƒæ•´ä»¥å®ç°é¢„æœŸçš„æ€§èƒ½æ°´å¹³ã€‚ ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 æŠ½è±¡å’Œå®ç°å·¥å…· åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€æ¶æ„ä¸»è¦åŒ…æ‹¬å­˜å‚¨ã€é€šä¿¡ï¼ˆç½‘ç»œï¼‰å’Œè®¡ç®—è¿™ä¸‰ç§ç±»å‹ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®¾è®¡ç®€å•çš„æ¥å£ï¼Œä½¿ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºèƒ½å¤Ÿè½»æ¾ä½¿ç”¨è¿™äº›åˆ†å¸ƒå¼å­˜å‚¨å’Œè®¡ç®—åŠŸèƒ½ï¼Œè¿™æ ·æ‰èƒ½ç®€å•çš„åœ¨è¿™äº›åŸºç¡€æ¶æ„ä¹‹ä¸Šï¼Œæ„å»ºç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºã€‚ é€šè¿‡è¿™ç§æŠ½è±¡æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å°†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤æ‚æ€§éšè—åœ¨ç³»ç»Ÿå†…éƒ¨ï¼Œä½¿ç”¨æˆ·ä¸“æ³¨äºåº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨å­˜å‚¨æ–¹é¢ï¼Œç”¨æˆ·å¯ä»¥å°†æ•´ä¸ªç³»ç»Ÿè§†ä¸ºéåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç±»ä¼¼äºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæˆ–è€…å¸¸è§„çš„ç¼–ç¨‹æ¨¡å‹ï¼Œè€Œä¸å¿…æ‹…å¿ƒåˆ†å¸ƒå¼ç³»ç»Ÿçš„ç»†èŠ‚ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªæ¥å£ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒä¸€ä¸ªéåˆ†å¸ƒå¼å­˜å‚¨å’Œè®¡ç®—ç³»ç»Ÿï¼Œä½†å®é™…ä¸Šå´å…·å¤‡äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„é«˜æ€§èƒ½å’Œå®¹é”™æ€§ã€‚ ä½†å®é™…ä¸Šï¼Œå¾ˆéš¾èƒ½æ‰¾åˆ°ä¸€ä¸ªæŠ½è±¡æ¥æè¿°åˆ†å¸ƒå¼çš„å­˜å‚¨æˆ–è€…è®¡ç®—ï¼Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿåƒéåˆ†å¸ƒå¼ç³»ç»Ÿä¸€æ ·æœ‰ç®€å•æ˜“æ‡‚çš„æ¥å£ã€‚ æŠ½è±¡çš„å®é™…å®ç°æ˜¯æˆ‘ä»¬é¦–å…ˆè¦è€ƒè™‘çš„é—®é¢˜ã€‚åœ¨æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œäººä»¬ä½¿ç”¨äº†è®¸å¤šå·¥å…·ï¼š RPCï¼ˆRemote Procedure Callï¼‰ï¼šRPCæ—¨åœ¨æ©ç›–åœ¨ä¸å¯é ç½‘ç»œä¸Šé€šä¿¡çš„å¤æ‚æ€§ï¼Œä½¿å¾—è¿œç¨‹è°ƒç”¨è¿‡ç¨‹æ›´ä¸ºç®€å•ç›´æ¥ã€‚ çº¿ç¨‹ï¼šçº¿ç¨‹æ˜¯ä¸€ç§é‡è¦çš„ç¼–ç¨‹æŠ€æœ¯ï¼Œå¯ç”¨äºå……åˆ†åˆ©ç”¨å¤šæ ¸å¿ƒè®¡ç®—æœºã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸ºäº†æé«˜è®¡ç®—æœºçš„åˆ©ç”¨ç‡ï¼Œæ›´é‡è¦çš„æ˜¯æä¾›äº†ç»“æ„åŒ–çš„å¹¶å‘æ“ä½œæ–¹å¼ï¼Œç®€åŒ–äº†ç¨‹åºå‘˜å¯¹å¹¶å‘æ“ä½œçš„å¤„ç†ã€‚ åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼šåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„å­˜å‚¨å·¥å…·ä¹‹ä¸€ï¼Œå®ƒæä¾›äº†åˆ†å¸ƒå¼çš„æ•°æ®å­˜å‚¨å’Œè®¿é—®æ¥å£ã€‚é€šè¿‡åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥å®ç°æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨å’Œç®¡ç†ï¼Œä»è€Œæ”¯æŒå¤§è§„æ¨¡æ•°æ®å¤„ç†å’Œåˆ†å¸ƒå¼è®¡ç®—ä»»åŠ¡çš„æ‰§è¡Œã€‚ ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 åˆ†å¸ƒå¼ç³»ç»Ÿç‰¹æ€§ ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.1 å¯æ‰©å±•æ€§ åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸»è¦ç‰¹æ€§æ˜¯å¯æ‰©å±•æ€§ï¼ˆScalabilityï¼‰ã€‚å¯æ‰©å±•æ€§æŒ‡çš„æ˜¯ï¼Œå¢åŠ è®¡ç®—èµ„æºåç³»ç»Ÿèƒ½å¤Ÿä»¥ç›¸åº”çš„æ–¹å¼æé«˜æ€§èƒ½æˆ–ååé‡ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä¸€å°è®¡ç®—æœºèƒ½å¤Ÿè§£å†³ä¸€å®šé‡çš„é—®é¢˜ï¼Œé‚£ä¹ˆå¢åŠ ç¬¬äºŒå°è®¡ç®—æœºåï¼Œç³»ç»Ÿèƒ½å¤Ÿä»¥æ›´å¿«çš„é€Ÿåº¦è§£å†³ç›¸åŒæ•°é‡çš„é—®é¢˜ï¼Œæˆ–è€…åœ¨ç›¸åŒæ—¶é—´å†…å¤„ç†æ›´å¤šçš„é—®é¢˜ã€‚å¦‚æœç”±ä¸¤å°è®¡ç®—æœºç»„æˆçš„ç³»ç»Ÿèƒ½å¤Ÿå®ç°ä¸¤å€çš„æ€§èƒ½æˆ–ååé‡ï¼Œé‚£å°±è¾¾åˆ°äº†å¯æ‰©å±•æ€§çš„æ ‡å‡†ã€‚ è¿™æ˜¯ä¸€ä¸ªæä¸ºå¼ºå¤§çš„ç‰¹æ€§ï¼Œå› ä¸ºåªéœ€èŠ±é’±å°±å¯ä»¥è´­ä¹°è®¡ç®—æœºã€‚å¦‚æœæ„å»ºçš„ç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡å¢åŠ è®¡ç®—æœºæ•°é‡æ¥æé«˜æ€§èƒ½æˆ–ååé‡ï¼Œé‚£å°†æ˜¯ä¸€ä¸ªå·¨å¤§çš„æˆå°±ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œé€šè¿‡é›‡ä½£ç¨‹åºå‘˜æ¥ä¼˜åŒ–ç³»ç»Ÿæˆ–åº”ç”¨æ›´ä¼˜çš„ç®—æ³•é€šå¸¸æ˜¯ä¸€ç§æ˜‚è´µçš„æ–¹æ³•ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡å¢åŠ è®¡ç®—æœºæ•°é‡ï¼Œä»åå°æå‡åˆ°ä¸€åƒå°ï¼Œæ¥åº”å¯¹ä¸€ç™¾å€çš„æµé‡ã€‚ ä¾‹å¦‚åœ¨æ„å»ºä¸€ä¸ªå¸¸è§„ç½‘ç«™æ—¶ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªHTTPæœåŠ¡å™¨ã€ä¸€äº›ç”¨æˆ·å’Œæµè§ˆå™¨ä»¥åŠåŸºäºPythonæˆ–PHPçš„WebæœåŠ¡å™¨ï¼Œå®ƒä»¬ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚ åœ¨åˆå§‹é˜¶æ®µï¼Œä¸€å°è®¡ç®—æœºå¯ä»¥è¿è¡ŒWebæœåŠ¡å™¨å’Œæ•°æ®åº“ï¼Œæˆ–è€…å°†WebæœåŠ¡å™¨å’Œæ•°æ®åº“åˆ†åˆ«éƒ¨ç½²åœ¨ä¸¤å°è®¡ç®—æœºä¸Šã€‚ä½†æ˜¯ï¼Œå½“ç½‘ç«™çªç„¶è¿æ¥æ•°ä»¥äº¿è®¡çš„ç”¨æˆ·ç™»å½•è¯·æ±‚æ—¶ï¼Œå•ä¸€æœåŠ¡å™¨æ˜¾ç„¶æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚ ä¸ºäº†åº”å¯¹é«˜æµé‡ï¼Œç¬¬ä¸€æ­¥æ˜¯è´­ä¹°æ›´å¤šçš„WebæœåŠ¡å™¨ï¼Œå¹¶å°†ç”¨æˆ·åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚è¿™æ ·ï¼Œä¸åŒçš„ç”¨æˆ·å¯ä»¥è®¿é—®ä¸åŒçš„WebæœåŠ¡å™¨ï¼Œä½†å®ƒä»¬éœ€è¦è®¿é—®ç›¸åŒçš„æ•°æ®ï¼Œå› æ­¤æ‰€æœ‰çš„WebæœåŠ¡å™¨éƒ½éœ€è¦ä¸åç«¯æ•°æ®åº“é€šä¿¡ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œé€šè¿‡æ·»åŠ æ›´å¤šçš„WebæœåŠ¡å™¨æ¥æé«˜ä»£ç æ•ˆç‡æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ–¹æ³•ï¼Œå‰ææ˜¯å•ä¸ªæœåŠ¡å™¨ä¸ä¼šç»™æ•°æ®åº“å¸¦æ¥è¿‡å¤§çš„å‹åŠ›ã€‚ ç„¶è€Œï¼Œå¯æ‰©å±•æ€§å¹¶éæ— é™çš„ã€‚éšç€WebæœåŠ¡å™¨æ•°é‡çš„å¢åŠ ï¼Œæ•°æ®åº“å¾ˆå¯èƒ½æˆä¸ºæ€§èƒ½çš„ç“¶é¢ˆã€‚å³ä½¿å¢åŠ æ›´å¤šçš„WebæœåŠ¡å™¨ä¹Ÿæ— æ³•è§£å†³é—®é¢˜ã€‚åœ¨æŸä¸ªä¸´ç•Œç‚¹ï¼Œç³»ç»Ÿä¸­æ·»åŠ æ›´å¤šè®¡ç®—æœºå°†ä¸å†æœ‰æ•ˆï¼Œè€Œç“¶é¢ˆå°†è½¬ç§»åˆ°å…¶ä»–åœ°æ–¹ï¼Œæ¯”å¦‚ä»WebæœåŠ¡å™¨è½¬ç§»åˆ°æ•°æ®åº“ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»è¿›è¡Œä¸€äº›é‡æ„å·¥ä½œã€‚ç„¶è€Œï¼Œé‡æ„ä¸€ä¸ªå•ä¸€çš„æ•°æ®åº“æ˜¯å›°éš¾çš„ï¼Œå°½ç®¡å¯ä»¥å°†æ•°æ®åº“æ‹†åˆ†ä¸ºå¤šä¸ªæ¥æé«˜æ€§èƒ½ï¼Œä½†è¿™éœ€è¦å¤§é‡çš„å·¥ä½œã€‚ ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:4:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.2 å¯ç”¨æ€§ åœ¨æ„å»ºç³»ç»Ÿæ—¶ï¼Œä½¿ç”¨å•å°è®¡ç®—æœºå¾€å¾€å…·æœ‰è¾ƒé«˜çš„å¯é æ€§ã€‚å•å°è®¡ç®—æœºé€šå¸¸å¯ä»¥é•¿æ—¶é—´ç¨³å®šè¿è¡Œï¼Œè¿™æ˜¯å› ä¸ºè®¡ç®—æœºå’Œæ“ä½œç³»ç»Ÿéƒ½å¾ˆå¯é ï¼Œè€Œä¸”ç”µæºä¹Ÿå¾ˆç¨³å®šã€‚ç„¶è€Œï¼Œå¦‚æœç³»ç»Ÿç”±æ•°åƒå°è®¡ç®—æœºæ„æˆï¼Œå³ä½¿æ¯å°è®¡ç®—æœºéƒ½èƒ½ç¨³å®šè¿è¡Œä¸€å¹´ï¼Œæ¯å¤©ä¹Ÿä¼šæœ‰å¤šå°è®¡ç®—æœºå‘ç”Ÿæ•…éšœã€‚ å› æ­¤ï¼Œå¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯æ”¾å¤§ä¸€äº›ç½•è§é—®é¢˜çš„å½±å“ã€‚åœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­ï¼Œæ€»ä¼šæœ‰ä¸€äº›æœºå™¨æ•…éšœã€è¿è¡Œé”™è¯¯ã€æ‰§è¡Œç¼“æ…¢æˆ–æ‰§è¡Œé”™è¯¯ä»»åŠ¡çš„æƒ…å†µå‘ç”Ÿã€‚ç½‘ç»œé—®é¢˜ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„æŒ‘æˆ˜ï¼Œæ¯”å¦‚ç½‘çº¿è¸©æ–­æˆ–äº¤æ¢æœºæ•…éšœã€‚è¿™äº›å°é—®é¢˜åœ¨å¤§è§„æ¨¡ç³»ç»Ÿä¸­ä¼šå˜æˆæŒç»­ä¸æ–­çš„é—®é¢˜ã€‚ å› æ­¤ï¼Œåœ¨è®¾è®¡ç³»ç»Ÿæ—¶å¿…é¡»è€ƒè™‘ç³»ç»Ÿçš„å®¹é”™æ€§ï¼Œå³ä½¿å‘ç”Ÿé”™è¯¯ä¹Ÿè¦èƒ½å¤Ÿç»§ç»­è¿è¡Œã€‚åŒæ—¶ï¼Œä¸ºäº†ç®€åŒ–åº”ç”¨å¼€å‘äººå‘˜çš„å·¥ä½œï¼Œéœ€è¦æ„å»ºä¸€ä¸ªåŸºç¡€æ¶æ„ï¼Œèƒ½å¤Ÿå°½å¯èƒ½å±è”½å’Œæ©ç›–é”™è¯¯ã€‚ å®¹é”™æœ‰å¤šç§æ¦‚å¿µå’Œè¡¨è¿°æ–¹å¼ï¼Œå…¶ä¸­ä¸€ä¸ªé‡è¦æ€æƒ³æ˜¯å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€‚é€šè¿‡ç²¾å¿ƒè®¾è®¡ï¼Œç³»ç»Ÿå¯ä»¥åœ¨ç‰¹å®šç±»å‹çš„é”™è¯¯å‘ç”Ÿæ—¶ç»§ç»­æä¾›æœåŠ¡ï¼Œå°±åƒæ²¡æœ‰é”™è¯¯ä¸€æ ·ã€‚æŸäº›ç³»ç»Ÿé€šè¿‡å¤šå‰¯æœ¬çš„æ–¹å¼å®ç°å¯ç”¨æ€§ã€‚æ¯”å¦‚ï¼Œæ„å»ºä¸€ä¸ªæœ‰ä¸¤ä¸ªæ‹·è´çš„å¤šå‰¯æœ¬ç³»ç»Ÿï¼Œå…¶ä¸­ä¸€ä¸ªæ•…éšœäº†ï¼Œå¦ä¸€ä¸ªä»ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œã€‚å¯ç”¨æ€§æ„å‘³ç€åœ¨ç‰¹å®šçš„æ•…éšœèŒƒå›´å†…ï¼Œç³»ç»Ÿä»èƒ½æä¾›æœåŠ¡ã€‚ å¦ä¸€ç§å®¹é”™ç‰¹æ€§æ˜¯è‡ªæˆ‘å¯æ¢å¤æ€§ï¼ˆRecoverabilityï¼‰ï¼Œå³åœ¨å‡ºç°é—®é¢˜åç³»ç»Ÿåœæ­¢å·¥ä½œï¼Œä¸å†å“åº”è¯·æ±‚ï¼Œç­‰å¾…ä¿®å¤ï¼Œç„¶åæ¢å¤æ­£å¸¸è¿è¡Œã€‚ å¯æ¢å¤æ€§æ˜¯ä¸€ä¸ªé‡è¦çš„éœ€æ±‚ï¼Œå°½ç®¡å®ƒæ¯”å¯ç”¨æ€§æ›´å¼±ã€‚åœ¨æ•…éšœå‘ç”Ÿåˆ°ä¿®å¤æœŸé—´ï¼Œç³»ç»Ÿå°†å®Œå…¨åœæ­¢å·¥ä½œã€‚ä½†ä¿®å¤åï¼Œç³»ç»Ÿåº”èƒ½æ­£ç¡®è¿è¡Œï¼Œå› æ­¤å¯æ¢å¤æ€§è‡³å…³é‡è¦ã€‚å¯¹äºå¯æ¢å¤çš„ç³»ç»Ÿï¼Œé€šå¸¸éœ€è¦é‡‡å–ä¸€äº›æªæ–½ï¼Œå¦‚å°†æœ€æ–°æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼Œä»¥ä¾¿åœ¨ä¾›ç”µæ¢å¤åæ£€ç´¢ã€‚ç”šè‡³å¯¹äºå…·å¤‡å¯ç”¨æ€§çš„ç³»ç»Ÿï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¹Ÿéœ€è¦å…·å¤‡å¯æ¢å¤æ€§ã€‚ ä¸ºäº†å®ç°è¿™äº›ç‰¹æ€§ï¼Œæœ‰ä¸¤ä¸ªå…³é”®å·¥å…·ã€‚ ä¸€ä¸ªæ˜¯éæ˜“å¤±å­˜å‚¨ï¼ˆNon-volatile storageï¼‰ï¼Œå¦‚ç¡¬ç›˜æˆ–é—ªå­˜ï¼Œç”¨äºå­˜å‚¨ç³»ç»ŸçŠ¶æ€çš„checkpointæˆ–æ—¥å¿—ã€‚è¿™æ ·ï¼Œå³ä½¿å‡ºç°ç”µæºæ•…éšœï¼Œç³»ç»Ÿä¹Ÿèƒ½ä»å­˜å‚¨ä¸­è¯»å–æœ€æ–°çŠ¶æ€ï¼Œå¹¶ç»§ç»­è¿è¡Œã€‚ å¦ä¸€ä¸ªé‡è¦å·¥å…·æ˜¯å¤åˆ¶ï¼ˆReplicationï¼‰ï¼Œå³é€šè¿‡å¤šå‰¯æœ¬ç³»ç»Ÿå®ç°å®¹é”™ã€‚ç®¡ç†å¤åˆ¶çš„å¤šå‰¯æœ¬ç³»ç»Ÿå¯èƒ½ä¼šé¢ä¸´åŒæ­¥åç§»ç­‰é—®é¢˜ï¼Œè¿™åœ¨å®¹é”™ç³»ç»Ÿä¸­æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚ ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:4:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.3 ä¸€è‡´æ€§ æœ€åä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§æ˜¯ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€‚ä¸€è‡´æ€§å®šä¹‰äº†æ“ä½œçš„è¡Œä¸ºï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚åœ¨åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œä¾‹å¦‚é”®å€¼ï¼ˆKVï¼‰æœåŠ¡ï¼Œputæ“ä½œå°†ä¸€ä¸ªå€¼å­˜å‚¨åˆ°ä¸€ä¸ªé”®ä¸­ï¼Œè€Œgetæ“ä½œä»é”®ä¸­è·å–å€¼ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªå‰¯æœ¬å¯èƒ½å­˜åœ¨ä¸åŒç‰ˆæœ¬çš„æ•°æ®ï¼Œå› æ­¤ä¸€è‡´æ€§å˜å¾—è‡³å…³é‡è¦ã€‚ å¼ºä¸€è‡´æ€§ï¼ˆStrong Consistencyï¼‰è¦æ±‚getè¯·æ±‚æ€»æ˜¯è¿”å›æœ€è¿‘ä¸€æ¬¡å®Œæˆçš„putè¯·æ±‚å†™å…¥çš„å€¼ï¼Œè¿™ç¡®ä¿äº†æ•°æ®çš„å®Œå…¨ä¸€è‡´ã€‚ç„¶è€Œï¼Œå®ç°å¼ºä¸€è‡´æ€§éœ€è¦å¤§é‡çš„é€šä¿¡å’Œå»¶è¿Ÿã€‚å¼±ä¸€è‡´æ€§ï¼ˆWeak Consistencyï¼‰ä¸ä¿è¯getè¯·æ±‚è·å–åˆ°æœ€æ–°çš„æ•°æ®ï¼Œä½†é€šå¸¸å¯ä»¥æä¾›æ›´é«˜çš„æ€§èƒ½ã€‚ å› æ­¤ï¼Œä¸ºäº†å°½å¯èƒ½å‡å°‘é€šä¿¡ï¼Œç‰¹åˆ«æ˜¯å½“å‰¯æœ¬ç›¸è·å¾ˆè¿œæ—¶ï¼Œäººä»¬ä¼šæ„å»ºå¼±ä¸€è‡´æ€§ç³»ç»Ÿï¼Œåªéœ€è¦æ›´æ–°æœ€è¿‘çš„æ•°æ®å‰¯æœ¬ï¼Œå¹¶ä¸”åªéœ€è¦ä»æœ€è¿‘çš„å‰¯æœ¬è·å–æ•°æ®ï¼Œå¹¶å…è®¸è¯»å–æ—§æ•°æ®ã€‚å½“ç„¶ï¼Œä¸ºäº†ä½¿å¼±ä¸€è‡´æ€§æ›´å…·å®é™…æ„ä¹‰ï¼Œäººä»¬ä¼šå®šä¹‰æ›´å¤šçš„è§„åˆ™ã€‚ ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:4:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 MapReduceè®ºæ–‡é˜…è¯»ç¬”è®° MapReduceè®ºæ–‡é˜…è¯»ç¬”è®° ","date":"2024-05-14","objectID":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ"],"title":"ã€MIT 6.5840(6.824)å­¦ä¹ ç¬”è®°ã€‘ åˆ†å¸ƒå¼ç³»ç»Ÿä»‹ç»","uri":"/posts/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"1 æ¦‚å¿µ MapReduce æ˜¯ä¸€ç§ç”¨äºåœ¨å¤§å‹é›†ç¾¤ä¸Šè¿›è¡Œç®€åŒ–æ•°æ®å¤„ç†çš„ç¼–ç¨‹æ¨¡å‹å’Œè®¡ç®—æ¡†æ¶ã€‚å®ƒæœ€åˆç”± Google å…¬å¸è®¾è®¡ç”¨äºè§£å†³å¤§è§„æ¨¡æ•°æ®å¤„ç†é—®é¢˜ï¼Œåæ¥è¢«å¹¿æ³›åº”ç”¨äºå„ç§å¤§æ•°æ®å¤„ç†åœºæ™¯ã€‚ MapReduce æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†å¤§è§„æ¨¡çš„æ•°æ®é›†åˆ†è§£æˆå¤šä¸ªå°çš„æ•°æ®å—ï¼Œç„¶ååˆ†é…ç»™é›†ç¾¤ä¸­çš„å¤šä¸ªè®¡ç®—èŠ‚ç‚¹è¿›è¡Œå¹¶è¡Œå¤„ç†ï¼Œæœ€ç»ˆå°†ç»“æœåˆå¹¶æˆæœ€ç»ˆçš„è¾“å‡ºã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2 ç¼–ç¨‹æ¨¡å‹ MapReduce ç¼–ç¨‹æ¨¡å‹ç”±ä¸¤ä¸ªä¸»è¦é˜¶æ®µç»„æˆï¼šmap é˜¶æ®µå’Œ reduce é˜¶æ®µã€‚ map é˜¶æ®µï¼šåœ¨ map é˜¶æ®µï¼Œè¾“å…¥æ•°æ®è¢«åˆ†å‰²æˆè‹¥å¹²ä¸ªæ•°æ®å—ï¼Œå¹¶ç”±ä¸åŒçš„è®¡ç®—èŠ‚ç‚¹è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹éƒ½ä¼šæ‰§è¡Œç”¨æˆ·å®šä¹‰çš„ map å‡½æ•°ï¼Œå°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºé”®å€¼å¯¹çš„å½¢å¼ï¼Œå¹¶å‘å‡ºä¸­é—´ç»“æœã€‚ reduce é˜¶æ®µï¼šåœ¨ reduce é˜¶æ®µï¼Œä¼šå°†ä¸­é—´ç»“æœæŒ‰ç…§é”®è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ç”±ä¸åŒçš„è®¡ç®—èŠ‚ç‚¹è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚æ¯ä¸ªè®¡ç®—èŠ‚ç‚¹éƒ½ä¼šæ‰§è¡Œç”¨æˆ·å®šä¹‰çš„ reduce å‡½æ•°ï¼Œå¯¹ç›¸åŒé”®çš„æ•°æ®è¿›è¡Œåˆå¹¶å’Œå¤„ç†ï¼Œæœ€ç»ˆç”Ÿæˆæœ€ç»ˆçš„è¾“å‡ºç»“æœã€‚ å¯¹äºç”¨æˆ·(MapReduceçš„ä½¿ç”¨è€…)è€Œè¨€ï¼šMapReduceæ˜¯ä¸€ç§æŠ½è±¡åŒ–çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå®ƒéšè—äº†åˆ†å¸ƒå¼æ•°æ®å¤„ç†çš„ç»†èŠ‚ï¼Œä»…å¯¹å¤–æš´éœ²mapå’Œreduceçš„æŠ½è±¡ï¼Œç”¨æˆ·æ¥å®ç°å…·ä½“çš„mapå’ŒreduceåŠŸèƒ½ã€‚MapReduceè‡ªèº«å…³æ³¨çš„æ˜¯å¹¶è¡Œè®¡ç®—ã€å®¹é”™ã€åˆ†å¸ƒå¼æ•°æ®ã€è´Ÿè½½å‡è¡¡ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œå¹¶ä¸”ä¿è¯åˆ†å¸ƒè®¡ç®—çš„ç»“æœå’Œæ— é”™è¯¯çš„ä¸²å½¢è®¡ç®—çš„ç»“æœä¸€è‡´ã€‚ å½¢å¼åŒ–åœ°è¯´ï¼Œç”±ç”¨æˆ·æä¾›çš„ map å‡½æ•°å’Œ reduce å‡½æ•°åº”æœ‰å¦‚ä¸‹ç±»å‹ï¼š $$ \\begin{align*} \\text{map} \u0026\\quad (k_1, v_1)\\quad\\quad\\quad\\rightarrow\\quad\\text{list}(k_2, v_2)\\ \\text{reduce} \u0026\\quad (k_2,\\text{list}(v_2))\\quad\\rightarrow\\quad\\text{list}(v_2) \\end{align*} $$ å…¶ä¸­ï¼Œè¾“å…¥çš„ key å’Œ value å€¼ä¸è¾“å‡ºçš„ key å’Œ value å€¼åœ¨ç±»å‹ä¸Šæ¨å¯¼çš„åŸŸä¸åŒã€‚æ­¤å¤–ï¼Œä¸­é—´ç»“æœ key å’Œ value å€¼ä¸è¾“å‡º key å’Œ value å€¼åœ¨ç±»å‹ä¸Šæ¨å¯¼çš„åŸŸç›¸åŒã€‚ ä¾‹å¦‚ï¼Œè®¡ç®—ä¸€ä¸ªå¤§çš„æ–‡æ¡£é›†åˆä¸­æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°ï¼Œä¸‹é¢æ˜¯ä¼ªä»£ç æ®µï¼š map(String key, String value): // key: document name // value: document contents for each word w in value: EmitIntermediate(w, â€œ1â€³); reduce(String key, Iterator values): // key: a word // values: a list of counts int result = 0; for each v in values: result += ParseInt(v); Emit(AsString(result)); map å‡½æ•°è¾“å‡ºæ–‡æ¡£ä¸­çš„æ¯ä¸ªè¯ã€ä»¥åŠè¿™ä¸ªè¯çš„å‡ºç°æ¬¡æ•°(åœ¨è¿™ä¸ªç®€å•çš„ä¾‹å­é‡Œå°±æ˜¯ 1)ã€‚reduce å‡½æ•°æŠŠ map å‡½æ•°äº§ç”Ÿçš„æ¯ä¸€ä¸ªç‰¹å®šçš„è¯çš„è®¡æ•°ç´¯åŠ èµ·æ¥ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®é™…çš„å®ç°ä¸­ MapReduce æ¡†æ¶ä½¿ç”¨ Iterator æ¥ä»£è¡¨ä½œä¸ºè¾“å…¥çš„é›†åˆï¼Œä¸»è¦æ˜¯ä¸ºäº†é¿å…é›†åˆè¿‡å¤§ï¼Œæ— æ³•è¢«å®Œæ•´åœ°æ”¾å…¥åˆ°å†…å­˜ä¸­ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3 å®ç° ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.1 MapReduceæ‰§è¡Œæµç¨‹ ä¸‹å›¾å±•ç¤ºäº†MapReduceæ“ä½œçš„å…¨éƒ¨æµç¨‹ã€‚å½“ç”¨æˆ·è°ƒç”¨ MapReduce å‡½æ•°æ—¶ï¼Œå°†å‘ç”Ÿä¸‹é¢çš„ä¸€ ç³»åˆ—åŠ¨ä½œï¼ˆä¸‹é¢çš„åºå·å’Œå›¾ä¸­çš„åºå·ä¸€ä¸€å¯¹åº”ï¼‰ï¼š ç”¨æˆ·ç¨‹åºé¦–å…ˆè°ƒç”¨çš„ MapReduce åº“å°†è¾“å…¥æ–‡ä»¶åˆ†æˆ $M$ ä¸ªæ•°æ®ç‰‡åº¦ï¼Œæ¯ä¸ªæ•°æ®ç‰‡æ®µçš„å¤§å°ä¸€èˆ¬ä» $16\\text{ MB}$ åˆ°$64\\text{ MB}$(å¯ä»¥é€šè¿‡å¯é€‰çš„å‚æ•°æ¥æ§åˆ¶æ¯ä¸ªæ•°æ®ç‰‡æ®µçš„å¤§å°)ã€‚ç„¶åç”¨æˆ·ç¨‹åºåœ¨é›†ç¾¤ä¸­åˆ›å»ºå¤§é‡çš„ç¨‹åºå‰¯æœ¬ã€‚ è¿™äº›ç¨‹åºå‰¯æœ¬ä¸­çš„æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç¨‹åºâ€”masterã€‚å‰¯æœ¬ä¸­å…¶å®ƒçš„ç¨‹åºéƒ½æ˜¯ worker ç¨‹åºï¼Œç”± master åˆ†é… ä»»åŠ¡ã€‚æœ‰ $M$ ä¸ª map ä»»åŠ¡å’Œ $R$ ä¸ª reduce ä»»åŠ¡å°†è¢«åˆ†é…ï¼Œmaster å°†ä¸€ä¸ª map ä»»åŠ¡æˆ– reduce ä»»åŠ¡åˆ†é…ç»™ä¸€ä¸ªç©ºé—²çš„ workerã€‚ è¢«åˆ†é…äº† map ä»»åŠ¡çš„ worker ç¨‹åºè¯»å–ç›¸å…³çš„è¾“å…¥æ•°æ®ç‰‡æ®µï¼Œä»è¾“å…¥çš„æ•°æ®ç‰‡æ®µä¸­è§£æå‡ºé”®å€¼å¯¹ï¼Œç„¶åæŠŠé”®å€¼å¯¹ä¼ é€’ç»™ç”¨æˆ·è‡ªå®šä¹‰çš„ Map å‡½æ•°ï¼Œç”± Map å‡½æ•°ç”Ÿæˆå¹¶è¾“å‡ºçš„ä¸­é—´ç»“æœé”®å€¼å¯¹ï¼Œå¹¶ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚ ç¼“å­˜ä¸­çš„é”®å€¼å¯¹é€šè¿‡åˆ†åŒºå‡½æ•°ï¼ˆå¯ç”±ç”¨æˆ·æŒ‡å®šï¼Œé»˜è®¤ä¸ºhasy(key) mod Rï¼‰åˆ†æˆ $R$ ä¸ªåŒºåŸŸï¼Œä¹‹åå‘¨æœŸæ€§çš„å†™å…¥åˆ°æœ¬åœ°ç£ç›˜ä¸Šã€‚ç¼“å­˜çš„é”®å€¼å¯¹åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„å­˜å‚¨ä½ç½®å°†è¢«å›ä¼ ç»™ masterï¼Œç”± master è´Ÿè´£æŠŠè¿™äº›å­˜å‚¨ä½ç½®å†ä¼ é€ç»™ reduce workerã€‚ å½“ reduce worker ç¨‹åºæ¥æ”¶åˆ° master ç¨‹åºå‘æ¥çš„æ•°æ®å­˜å‚¨ä½ç½®ä¿¡æ¯åï¼Œä½¿ç”¨ RPC ä» Map worker æ‰€åœ¨ä¸»æœºçš„ç£ç›˜ä¸Šè¯»å–è¿™äº›ç¼“å­˜æ•°æ®ã€‚å½“ reduce worker è¯»å–äº†æ‰€æœ‰çš„ä¸­é—´æ•°æ®åï¼Œé€šè¿‡å¯¹ key è¿›è¡Œæ’åºåä½¿å¾—å…·æœ‰ç›¸åŒ key å€¼çš„æ•°æ®èšåˆåœ¨ä¸€èµ·ã€‚ç”±äºè®¸å¤šä¸åŒçš„ key å€¼ä¼šæ˜ å°„åˆ°ç›¸åŒçš„ reduce ä»»åŠ¡ä¸Šï¼Œ å› æ­¤å¿…é¡»è¿›è¡Œæ’åºã€‚å¦‚æœä¸­é—´æ•°æ®å¤ªå¤§æ— æ³•åœ¨å†…å­˜ä¸­å®Œæˆæ’åºï¼Œé‚£ä¹ˆå°±è¦åœ¨å¤–éƒ¨è¿›è¡Œæ’åºã€‚ reduce worker ç¨‹åºéå†æ’åºåçš„ä¸­é—´æ•°æ®ï¼Œå¯¹äºæ¯ä¸€ä¸ªå”¯ä¸€çš„ä¸­é—´ key å€¼ï¼Œreduce worker ç¨‹åºå°†è¿™ ä¸ª key å€¼å’Œå®ƒç›¸å…³çš„ä¸­é—´ç»“æœvalue å€¼çš„é›†åˆä¼ é€’ç»™ç”¨æˆ·è‡ªå®šä¹‰çš„ reduce å‡½æ•°ã€‚reduce å‡½æ•°çš„è¾“å‡ºè¢«è¿½åŠ åˆ°æ‰€å±åˆ†åŒºçš„è¾“å‡ºæ–‡ä»¶ã€‚ å½“æ‰€æœ‰çš„ map å’Œ reduce ä»»åŠ¡éƒ½å®Œæˆä¹‹åï¼Œmaster å”¤é†’ç”¨æˆ·ç¨‹åºã€‚åœ¨è¿™ä¸ªæ—¶å€™ï¼Œåœ¨ç”¨æˆ·ç¨‹åºé‡Œçš„å¯¹ MapReduce è°ƒç”¨æ‰è¿”å›ã€‚ åœ¨æˆåŠŸå®Œæˆä»»åŠ¡ä¹‹åï¼ŒMapReduce çš„è¾“å‡ºå­˜æ”¾åœ¨ $R$ ä¸ªè¾“å‡ºæ–‡ä»¶ä¸­ï¼ˆå¯¹åº”æ¯ä¸ª reduce ä»»åŠ¡äº§ç”Ÿä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œæ–‡ä»¶åç”±ç”¨æˆ·æŒ‡å®šï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”¨æˆ·ä¸éœ€è¦å°†è¿™ $R$ ä¸ªè¾“å‡ºæ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶â€”ä»–ä»¬ç»å¸¸æŠŠè¿™äº›æ–‡ä»¶ä½œä¸ºå¦å¤–ä¸€ä¸ª MapReduce çš„è¾“å…¥ï¼Œæˆ–è€…åœ¨å¦å¤–ä¸€ä¸ªå¯ä»¥å¤„ç†å¤šä¸ªåˆ†å‰²æ–‡ä»¶çš„åˆ†å¸ƒå¼åº”ç”¨ä¸­ä½¿ç”¨ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:3:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.2 masteræ•°æ®ç»“æ„ master æŒæœ‰ä¸€äº›æ•°æ®ç»“æ„ï¼Œå®ƒå­˜å‚¨æ¯ä¸€ä¸ª map å’Œ reduce ä»»åŠ¡çš„çŠ¶æ€ï¼ˆç©ºé—²ã€å·¥ä½œä¸­æˆ–å®Œæˆ)ï¼Œä»¥åŠ worker æœºå™¨(éç©ºé—²ä»»åŠ¡çš„æœºå™¨)çš„æ ‡è¯†ã€‚ master å°±åƒä¸€ä¸ªæ•°æ®ç®¡é“ï¼Œä¸­é—´æ–‡ä»¶å­˜å‚¨åŒºåŸŸçš„ä½ç½®ä¿¡æ¯é€šè¿‡è¿™ä¸ªç®¡é“ä» map ä¼ é€’åˆ° reduceã€‚å› æ­¤ï¼Œ å¯¹äºæ¯ä¸ªå·²ç»å®Œæˆçš„ map ä»»åŠ¡ï¼Œmaster å­˜å‚¨äº† map ä»»åŠ¡äº§ç”Ÿçš„ $R$ ä¸ªä¸­é—´æ–‡ä»¶å­˜å‚¨åŒºåŸŸçš„å¤§å°å’Œä½ç½®ã€‚å½“ map ä»»åŠ¡å®Œæˆæ—¶ï¼Œmaster æ¥æ”¶åˆ°ä½ç½®å’Œå¤§å°çš„æ›´æ–°ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯è¢«é€æ­¥é€’å¢çš„æ¨é€ç»™é‚£äº›æ­£åœ¨å·¥ä½œçš„ reduce ä»»åŠ¡ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:3:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.3 å®¹é”™æœºåˆ¶ 3.3.1 workeræ•…éšœ æ•…éšœåˆ¤å®š master å‘¨æœŸæ€§çš„ ping æ¯ä¸ª workerã€‚å¦‚æœåœ¨ä¸€ä¸ªçº¦å®šçš„æ—¶é—´èŒƒå›´å†…æ²¡æœ‰æ”¶åˆ° worker è¿”å›çš„ä¿¡æ¯ï¼Œmaster å°† æŠŠè¿™ä¸ª worker æ ‡è®°ä¸ºå¤±æ•ˆã€‚ æ•…éšœå¤„ç† æ­£åœ¨è¿è¡Œï¼šæ­£åœ¨è¿è¡Œçš„ map æˆ– reduce ä»»åŠ¡å°†è¢«é‡æ–°ç½®ä¸ºç©ºé—²çŠ¶æ€ï¼Œç­‰å¾…é‡æ–°è°ƒåº¦ã€‚ å·²å®Œæˆï¼šæ‰€æœ‰ç”±è¿™ä¸ªæ•…éšœçš„worker å®Œæˆçš„ map ä»»åŠ¡ä¹Ÿä¼šè¢«é‡è®¾ä¸ºåˆå§‹çš„ç©ºé—²çŠ¶æ€ï¼Œç­‰å¾…é‡æ–°è°ƒåº¦ï¼Œå› ä¸ºè¯¥ worker ä¸å¯ç”¨ä¹Ÿæ„å‘³ç€å­˜å‚¨åœ¨è¯¥ worker æœ¬åœ°ç£ç›˜ä¸Šçš„ä¸­é—´ç»“æœä¹Ÿä¸å¯ç”¨äº†ï¼›å·²ç»å®Œæˆçš„ reduce ä»»åŠ¡çš„è¾“å‡ºå­˜å‚¨åœ¨å…¨å±€æ–‡ä»¶ç³»ç»Ÿï¼ˆeg. Google File Systemï¼‰ä¸Šï¼Œå› æ­¤ä¸éœ€è¦é‡æ–°æ‰§è¡Œã€‚ å½“ä¸€ä¸ª map ä»»åŠ¡é¦–å…ˆè¢« worker A æ‰§è¡Œï¼Œä¹‹åç”±äº worker A æ•…éšœäº†åˆè¢«è°ƒåº¦åˆ° worker B æ‰§è¡Œï¼Œè¿™ä¸ªâ€œé‡æ–°æ‰§è¡Œâ€çš„åŠ¨ä½œä¼šè¢«é€šçŸ¥ç»™æ‰€æœ‰æ‰§è¡Œ reduce ä»»åŠ¡çš„ workerã€‚ä»»ä½•è¿˜æ²¡æœ‰ä» worker A è¯»å–æ•°æ®çš„ reduce ä»»åŠ¡ å°†ä» worker Bè¯»å–æ•°æ®ã€‚ 3.3.2 masteræ•…éšœ ä¸€ä¸ªç®€å•çš„è§£å†³åŠæ³•æ˜¯è®© master å‘¨æœŸæ€§çš„å°†ä¸Šé¢æè¿°çš„masteræ•°æ®ç»“æ„çš„å†™å…¥ç£ç›˜ï¼Œå³æ£€æŸ¥ç‚¹ï¼ˆcheckpointï¼‰ã€‚å¦‚æœè¿™ä¸ª master ä»»åŠ¡å¤±è´¥äº†ï¼Œå¯ä»¥ä»æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹ï¼ˆcheckpointï¼‰å¼€å§‹å¯åŠ¨å¦ä¸€ä¸ª master è¿›ç¨‹ã€‚ ç„¶è€Œï¼Œç”±äºåªæœ‰ä¸€ä¸ª master è¿›ç¨‹ï¼Œmaster å¤±æ•ˆåå†æ¢å¤æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œå› æ­¤ç°åœ¨çš„å®ç°æ˜¯å¦‚æœ master æ•…éšœï¼Œå°±ä¸­æ­¢MapReduce è¿ç®—ã€‚ç”¨æˆ·å¯ä»¥æ£€æŸ¥åˆ°è¿™ä¸ªçŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦é‡æ–°æ‰§è¡Œ MapReduce æ“ä½œã€‚ 3.3.3 å‡ºç°æ•…éšœæ—¶çš„è¯­ä¹‰ å½“ç”¨æˆ·æä¾›çš„ map å’Œ reduce æ“ä½œæ˜¯è¾“å…¥ç¡®å®šæ€§å‡½æ•°ï¼ˆå³ç›¸åŒçš„è¾“å…¥äº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼‰æ—¶ï¼ŒMapReduceä¿è¯ä»»ä½•æƒ…å†µä¸‹çš„è¾“å‡ºéƒ½å’Œæ‰€æœ‰ç¨‹åºæ²¡æœ‰å‡ºç°ä»»ä½•é”™è¯¯ã€é¡ºåºçš„æ‰§è¡Œäº§ç”Ÿçš„è¾“å‡ºæ˜¯ä¸€æ ·çš„ã€‚ è¿™ä¾èµ–å¯¹ map å’Œ reduce ä»»åŠ¡çš„è¾“å‡ºæ˜¯åŸå­æäº¤çš„æ¥å®Œæˆè¿™ä¸ªç‰¹æ€§ã€‚ æ¯ä¸ªå·¥ä½œä¸­çš„ä»»åŠ¡æŠŠå®ƒçš„è¾“å‡ºå†™åˆ°ç§æœ‰çš„ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ æ¯ä¸ª reduce ä»»åŠ¡ç”Ÿæˆä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶ï¼Œè€Œæ¯ä¸ª map ä»»åŠ¡åˆ™ç”Ÿæˆ $R$ ä¸ªè¿™æ ·çš„æ–‡ä»¶ï¼ˆä¸€ ä¸ª reduce ä»»åŠ¡å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ï¼‰ã€‚ å½“ä¸€ä¸ª map ä»»åŠ¡å®Œæˆçš„æ—¶ï¼Œworker å‘é€ä¸€ä¸ªåŒ…å« R ä¸ªä¸´æ—¶æ–‡ä»¶åçš„å®Œæˆæ¶ˆæ¯ç»™masterã€‚å¦‚æœ master ä»ä¸€ä¸ªå·²ç»å®Œæˆçš„ map ä»»åŠ¡å†æ¬¡æ¥æ”¶åˆ°åˆ°ä¸€ä¸ªå®Œæˆæ¶ˆæ¯ï¼Œmaster å°†å¿½ç•¥è¿™ä¸ªæ¶ˆæ¯ï¼›å¦ åˆ™ï¼Œmaster å°†è¿™ $R$ ä¸ªæ–‡ä»¶çš„åå­—è®°å½•åœ¨æ•°æ®ç»“æ„é‡Œã€‚ å½“ reduce ä»»åŠ¡å®Œæˆæ—¶ï¼Œreduce worker è¿›ç¨‹ä»¥åŸå­çš„æ–¹å¼æŠŠä¸´æ—¶æ–‡ä»¶é‡å‘½åä¸ºæœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶ã€‚å¦‚æœåŒä¸€ä¸ª reduce ä»»åŠ¡åœ¨å¤šå°æœºå™¨ä¸Šæ‰§è¡Œï¼Œé’ˆå¯¹åŒä¸€ä¸ªæœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶å°†æœ‰å¤šä¸ªé‡å‘½åæ“ä½œæ‰§è¡Œã€‚è¿™å°±ä¾èµ–åº•å±‚æ–‡ä»¶ç³»ç»Ÿæä¾›çš„é‡å‘½åæ“ä½œçš„åŸå­æ€§æ¥ä¿è¯æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€ä»…ä»…åŒ…å«ä¸€ä¸ª reduceä»»åŠ¡äº§ç”Ÿçš„æ•°æ®ã€‚ ä½¿ç”¨ MapReduce æ¨¡å‹çš„ç¨‹åºå‘˜å¯ä»¥å¾ˆå®¹æ˜“çš„ç†è§£ä»–ä»¬ç¨‹åºçš„è¡Œä¸ºï¼Œå› ä¸ºæˆ‘ä»¬ç»å¤§å¤šæ•°çš„ map å’Œ reduce æ“ä½œæ˜¯ç¡®å®šæ€§çš„ï¼Œè€Œä¸”å­˜åœ¨è¿™æ ·çš„ä¸€ä¸ªäº‹å®ï¼šæˆ‘ä»¬çš„è¯­ä¹‰ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºå¤„ç†æœºåˆ¶ï¼‰ç­‰ä»·äºä¸€ä¸ªé¡ºåºçš„æ‰§è¡Œçš„æ“ä½œã€‚ å½“ map and/or reduce æ“ä½œæ˜¯ä¸ç¡®å®šæ€§çš„æ—¶å€™ï¼ŒMapReduceæä¾›è™½ç„¶è¾ƒå¼±ä½†æ˜¯ä¾ç„¶åˆç†çš„è¯­ä¹‰ã€‚å½“ä½¿ç”¨éç¡®å®šæ“ä½œçš„æ—¶å€™ï¼Œ ä¸€ä¸ª reduce ä»»åŠ¡ $R_1$ çš„è¾“å‡ºç­‰ä»·äºä¸€ä¸ªéç¡®å®šæ€§ç¨‹åºé¡ºåºæ‰§è¡Œäº§ç”Ÿæ—¶çš„è¾“å‡ºã€‚ä½†æ˜¯ï¼Œå¦ä¸€ä¸ª reduce ä»»åŠ¡ $R_2$çš„è¾“å‡ºä¹Ÿè®¸ç¬¦åˆä¸€ä¸ªä¸åŒçš„éç¡®å®šç¨‹åºé¡ºåºæ‰§è¡Œäº§ç”Ÿçš„ $R_2$ çš„è¾“å‡ºã€‚ è€ƒè™‘ map ä»»åŠ¡ $M$ å’Œ reduce ä»»åŠ¡ $R_1$ã€$R_2$ çš„æƒ…å†µã€‚æˆ‘ä»¬è®¾å®š $e(R_i)$æ˜¯ $R_i$ å·²ç»æäº¤çš„æ‰§è¡Œè¿‡ç¨‹ï¼ˆæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªè¿™æ ·çš„æ‰§è¡Œè¿‡ç¨‹ï¼‰ã€‚å‡ºç°è¾ƒå¼±è¯­ä¹‰æ˜¯å› ä¸º $e(R_1)$å¯èƒ½è¯»å–äº†$M$ ä¸€æ¬¡æ‰§è¡Œäº§ç”Ÿçš„è¾“å‡ºï¼Œè€Œ $e(R_2)$å¯èƒ½è¯»å–äº† $M$ çš„å¦ä¸€æ¬¡æ‰§è¡Œäº§ç”Ÿçš„è¾“å‡ºã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:3:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.4 å­˜å‚¨ä½ç½® æ ¸å¿ƒæ€æƒ³ï¼šå°½é‡æŠŠè¾“å…¥æ•°æ®(ç”± GFS ç®¡ç†)å­˜å‚¨åœ¨é›†ç¾¤ä¸­æœºå™¨çš„æœ¬åœ°ç£ç›˜ä¸Šæ¥èŠ‚çœç½‘ç»œå¸¦å®½ã€‚ GFS æŠŠæ¯ä¸ªæ–‡ä»¶æŒ‰ 64MB ä¸€ä¸ª Block åˆ†éš”ï¼Œæ¯ä¸ª Block ä¿å­˜ åœ¨å¤šå°æœºå™¨ä¸Šï¼Œç¯å¢ƒä¸­å°±å­˜æ”¾äº†å¤šä»½æ‹·è´(ä¸€èˆ¬æ˜¯ 3 ä¸ªæ‹·è´)ã€‚MapReduce çš„ master åœ¨è°ƒåº¦ map ä»»åŠ¡æ—¶ä¼šè€ƒè™‘è¾“å…¥æ–‡ä»¶çš„ä½ç½®ä¿¡æ¯ï¼Œå°½é‡å°†ä¸€ä¸ª map ä»»åŠ¡è°ƒåº¦åœ¨åŒ…å«ç›¸å…³è¾“å…¥æ•°æ®æ‹·è´çš„æœºå™¨ä¸Šæ‰§è¡Œï¼› å¦‚æœä¸Šè¿°åŠªåŠ›å¤±è´¥ äº†ï¼Œmaster å°†å°è¯•åœ¨ä¿å­˜æœ‰è¾“å…¥æ•°æ®æ‹·è´çš„æœºå™¨é™„è¿‘çš„æœºå™¨ä¸Šæ‰§è¡Œ map ä»»åŠ¡(ä¾‹å¦‚ï¼Œåˆ†é…åˆ°ä¸€ä¸ªå’ŒåŒ…å«è¾“å…¥æ•°æ®çš„æœºå™¨åœ¨ä¸€ä¸ª switch é‡Œçš„ worker æœºå™¨ä¸Šæ‰§è¡Œ)ã€‚å½“åœ¨ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ cluster é›†ç¾¤ä¸Šè¿è¡Œå¤§å‹ MapReduce æ“ä½œçš„æ—¶å€™ï¼Œå¤§éƒ¨åˆ†çš„è¾“å…¥æ•°æ®éƒ½èƒ½ä»æœ¬åœ°æœºå™¨è¯»å–ï¼Œå› æ­¤æ¶ˆè€—éå¸¸å°‘çš„ç½‘ç»œå¸¦å®½ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:3:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.5 ä»»åŠ¡ç²’åº¦ ç†æƒ³æƒ…å†µä¸‹ï¼Œ$M$ å’Œ $R$ åº”å½“æ¯”é›†ç¾¤ä¸­ worker çš„æœºå™¨æ•°é‡è¦å¤šå¾—å¤šã€‚åœ¨æ¯å° worker æœºå™¨éƒ½æ‰§è¡Œå¤§é‡çš„ä¸åŒä»»åŠ¡èƒ½å¤Ÿæé«˜é›†ç¾¤çš„åŠ¨æ€çš„è´Ÿè½½å‡è¡¡èƒ½åŠ›ï¼Œå¹¶ä¸”èƒ½å¤ŸåŠ å¿«æ•…éšœæ¢å¤çš„é€Ÿåº¦ï¼šå¤±æ•ˆæœºå™¨ä¸Šæ‰§è¡Œçš„å¤§é‡ map ä»»åŠ¡éƒ½å¯ä»¥åˆ†å¸ƒåˆ°æ‰€æœ‰å…¶ä»–çš„ worker æœºå™¨ä¸Šå»æ‰§è¡Œã€‚ ä½†æ˜¯å®é™…ä¸Šï¼Œåœ¨å…·ä½“å®ç°ä¸­å¯¹ $M$ å’Œ $R$ çš„å–å€¼éƒ½æœ‰ä¸€å®šçš„å®¢è§‚é™åˆ¶ï¼Œå› ä¸º master å¿…é¡»æ‰§è¡Œ $O(M+R) $æ¬¡è°ƒåº¦ï¼Œå¹¶ä¸”åœ¨å†…å­˜ä¸­ä¿å­˜ $O(M\\times R)$ä¸ªçŠ¶æ€ï¼ˆå¯¹å½±å“å†…å­˜ä½¿ç”¨çš„å› ç´ è¿˜æ˜¯æ¯”è¾ƒå°çš„ï¼š$O(M\\times R)$å—çŠ¶æ€ï¼Œå¤§æ¦‚æ¯å¯¹ map ä»»åŠ¡/reduce ä»»åŠ¡ 1 ä¸ªå­—èŠ‚å°±å¯ä»¥äº†ï¼‰ã€‚ æ›´è¿›ä¸€æ­¥ï¼Œ$R$ å€¼é€šå¸¸æ˜¯ç”±ç”¨æˆ·æŒ‡å®šçš„ï¼Œå› ä¸ºæ¯ä¸ª reduce ä»»åŠ¡æœ€ç»ˆéƒ½ä¼šç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„è¾“å‡ºæ–‡ä»¶ã€‚å®é™…ä½¿ç”¨æ—¶æˆ‘ä»¬ä¹Ÿå€¾å‘äºé€‰æ‹©åˆé€‚çš„ $M$ å€¼ï¼Œä»¥ä½¿å¾—æ¯ä¸€ä¸ªç‹¬ç«‹ä»»åŠ¡éƒ½æ˜¯å¤„ç†å¤§çº¦ 16M åˆ° 64M çš„è¾“å…¥æ•°æ®ï¼ˆè¿™æ ·ï¼Œ ä¸Šé¢æå†™çš„è¾“å…¥æ•°æ®æœ¬åœ°å­˜å‚¨ä¼˜åŒ–ç­–ç•¥æ‰æœ€æœ‰æ•ˆï¼‰ï¼Œå¦å¤–ï¼Œæˆ‘ä»¬æŠŠ $R$ å€¼è®¾ç½®ä¸ºæˆ‘ä»¬æƒ³ä½¿ç”¨çš„ worker æœºå™¨æ•°é‡çš„å°çš„å€æ•°ã€‚ æ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¼šç”¨è¿™æ ·çš„æ¯”ä¾‹æ¥æ‰§è¡Œ MapReduceï¼š$M=200000$ï¼Œ$R=5000$ï¼Œä½¿ç”¨ $2000$ å° worker æœºå™¨ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:3:5","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.6 å¤‡ç”¨ä»»åŠ¡ å¦‚æœé›†ç¾¤ä¸­æœ‰æŸä¸ª worker èŠ±äº†ç‰¹åˆ«é•¿çš„æ—¶é—´æ¥å®Œæˆæœ€åçš„å‡ ä¸ª map æˆ– reduce ä»»åŠ¡ï¼Œæ•´ä¸ª MapReduce è®¡ç®—ä»»åŠ¡çš„è€—æ—¶å°±ä¼šå› æ­¤è¢«æ‹–é•¿ï¼Œè¿™æ ·çš„ worker ä¹Ÿå°±æˆäº†è½åè€…ï¼ˆStragglerï¼‰ã€‚ å› æ­¤ï¼Œè®ºæ–‡æå‡ºä¸€ä¸ªé€šç”¨çš„æœºåˆ¶æ¥å‡å°‘â€œè½ä¼è€…â€å‡ºç°çš„æƒ…å†µã€‚å½“ä¸€ä¸ª MapReduce æ“ä½œæ¥è¿‘å®Œæˆçš„æ—¶å€™ï¼Œmaster ä¼šè°ƒåº¦å¤‡ç”¨ï¼ˆbackupï¼‰ä»»åŠ¡è¿›ç¨‹æ¥æ‰§è¡Œå‰©ä¸‹çš„ã€å¤„äºå¤„ç†ä¸­çŠ¶æ€ï¼ˆin-progressï¼‰çš„ä»»åŠ¡ã€‚æ— è®ºæ˜¯æœ€åˆçš„æ‰§è¡Œã€è¿˜æ˜¯å¤‡ç”¨ï¼ˆbackupï¼‰ä»»åŠ¡è¿›ç¨‹å®Œæˆäº†ä»»åŠ¡ï¼Œæˆ‘ä»¬éƒ½æŠŠè¿™ä¸ªä»»åŠ¡æ ‡è®°æˆä¸ºå·²ç»å®Œæˆã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:3:6","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4 æ‰©å±•æŠ€å·§ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.1 åˆ†åŒºå‡½æ•° MapReduce çš„ä½¿ç”¨è€…é€šå¸¸ä¼šæŒ‡å®š reduce ä»»åŠ¡å’Œ reduce ä»»åŠ¡è¾“å‡ºæ–‡ä»¶çš„æ•°é‡ï¼ˆ$R$ï¼‰ã€‚æˆ‘ä»¬åœ¨ä¸­é—´ç»“æœkey ä¸Šä½¿ç”¨åˆ†åŒºå‡½æ•°æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºï¼Œä¹‹åå†è¾“å…¥åˆ°åç»­ä»»åŠ¡æ‰§è¡Œè¿›ç¨‹ã€‚ ä¸€ä¸ªç¼ºçœçš„åˆ†åŒºå‡½æ•°æ˜¯ä½¿ç”¨ hash æ–¹æ³•(æ¯”å¦‚ï¼Œ hash(key) mod R)è¿›è¡Œåˆ†åŒºã€‚hash æ–¹æ³•èƒ½äº§ç”Ÿéå¸¸å¹³è¡¡çš„åˆ†åŒºã€‚ç„¶è€Œï¼Œæœ‰çš„æ—¶å€™ï¼Œå…¶å®ƒçš„ä¸€äº›åˆ†åŒºå‡½æ•°å¯¹ key å€¼è¿›è¡Œçš„åˆ†åŒºå°†éå¸¸æœ‰ç”¨ã€‚ æ¯”å¦‚ï¼Œè¾“å‡ºçš„ key å€¼æ˜¯ URLsï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸ªä¸»æœºçš„æ‰€æœ‰æ¡ç›®ä¿æŒåœ¨åŒä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ä¸­ã€‚ä¸ºäº†æ”¯æŒç±»ä¼¼çš„æƒ…å†µï¼ŒMapReduceåº“çš„ç”¨æˆ·éœ€è¦æä¾›ä¸“é—¨çš„åˆ†åŒºå‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨hash(Hostname(urlkey)) mod Rä½œä¸ºåˆ†åŒºå‡½æ•°å°±å¯ä»¥æŠŠæ‰€æœ‰æ¥è‡ªåŒä¸€ä¸ªä¸»æœºçš„ URLs ä¿å­˜åœ¨åŒä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ä¸­ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.2 é¡ºåºä¿è¯ åœ¨ç»™å®šçš„åˆ†åŒº$R$ä¸­ï¼ŒMapReduceä¿è¯æ‰€æœ‰ä¸­é—´é”®å€¼å¯¹æ•°æ®çš„å¤„ç†é¡ºåºæ˜¯æŒ‰ç…§ key å€¼å¢é‡é¡ºåºå¤„ç†çš„ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.3 Combinerå‡½æ•° åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œmap å‡½æ•°äº§ç”Ÿçš„ä¸­é—´ key å€¼çš„é‡å¤æ•°æ®ä¼šå å¾ˆå¤§çš„æ¯”é‡ï¼Œå¹¶ä¸”ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„ reduce å‡½æ•°æ»¡è¶³ç»“åˆå¾‹å’Œäº¤æ¢å¾‹ã€‚è¯æ•°ç»Ÿè®¡ç¨‹åºæ˜¯ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ç”±äºè¯é¢‘ç‡å€¾å‘äºä¸€ä¸ª zipf åˆ†å¸ƒï¼Œæ¯ä¸ª map ä»»åŠ¡å°†äº§ç”Ÿæˆåƒä¸Šä¸‡ä¸ªè¿™æ ·çš„è®°å½•ã€‚æ‰€æœ‰çš„è¿™äº›è®°å½•å°†é€šè¿‡ç½‘ç»œè¢«å‘é€åˆ°ä¸€ä¸ªå•ç‹¬çš„ reduce ä»»åŠ¡ï¼Œç„¶åç”±è¿™ä¸ªreduce ä»»åŠ¡æŠŠæ‰€æœ‰è¿™äº›è®°å½•ç´¯åŠ èµ·æ¥äº§ç”Ÿä¸€ä¸ªæ•°å­—ã€‚ MapReduceå…è®¸ç”¨æˆ·æŒ‡å®šä¸€ä¸ªå¯é€‰çš„ combiner å‡½æ•°ï¼Œcombiner å‡½æ•°é¦–å…ˆåœ¨æœ¬åœ°å°†è¿™äº›è®°å½•è¿›è¡Œä¸€æ¬¡åˆå¹¶ï¼Œç„¶åå°†åˆå¹¶çš„ç»“æœå†é€šè¿‡ç½‘ç»œå‘é€å‡º å»ã€‚ combiner å‡½æ•°åœ¨æ¯å°æ‰§è¡Œ Map ä»»åŠ¡çš„æœºå™¨ä¸Šéƒ½ä¼šè¢«æ‰§è¡Œä¸€æ¬¡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œcombiner å’Œ reduce å‡½æ•°æ˜¯ ä¸€æ ·çš„ã€‚combiner å‡½æ•°å’Œ Reduce å‡½æ•°ä¹‹é—´å”¯ä¸€çš„åŒºåˆ«æ˜¯ MapReduce åº“æ€æ ·æ§åˆ¶å‡½æ•°çš„è¾“å‡ºã€‚ reduce å‡½æ•°çš„è¾“å‡ºè¢«ä¿å­˜åœ¨æœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶é‡Œï¼Œè€Œ combiner å‡½æ•°çš„è¾“å‡ºè¢«å†™åˆ°ä¸­é—´æ–‡ä»¶é‡Œï¼Œç„¶åè¢«å‘é€ç»™ reduce ä»»åŠ¡ã€‚ éƒ¨åˆ†çš„åˆå¹¶ä¸­é—´ç»“æœå¯ä»¥æ˜¾è‘—çš„æé«˜ä¸€äº› MapReduce æ“ä½œçš„é€Ÿåº¦ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.4 è¾“å…¥å’Œè¾“å‡ºçš„ç±»å‹ MapReduceåº“æ”¯æŒå‡ ç§ä¸åŒçš„æ ¼å¼çš„è¾“å…¥æ•°æ®ã€‚æ¯”å¦‚æ–‡æœ¬æ¨¡å¼ä¸­ï¼Œkeyæ˜¯æ–‡ä»¶çš„åç§»é‡ï¼Œvalueæ˜¯è¯¥è¡Œå†…å®¹ã€‚ ç¨‹åºå‘˜å¯ä»¥å®šä¹‰Readeræ¥å£æ¥é€‚åº”ä¸åŒçš„è¾“å…¥ç±»å‹ï¼Œç¨‹åºå‘˜éœ€è¦ä¿è¯å¿…é¡»èƒ½æŠŠè¾“å…¥æ•°æ®åˆ‡åˆ†æˆæ•°æ®ç‰‡æ®µï¼Œä¸”è¿™äº›æ•°æ®ç‰‡æ®µèƒ½å¤Ÿç”±å•ç‹¬çš„Mapä»»åŠ¡æ¥å¤„ç†å°±è¡Œäº†ã€‚Readerçš„æ•°æ®æºå¯èƒ½æ˜¯æ•°æ®åº“ï¼Œå¯èƒ½æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œç”šè‡³æ˜¯å†…å­˜ç­‰ã€‚ åŒæ ·ï¼Œç”¨æˆ·é‡‡ç”¨ç±»ä¼¼æ·»åŠ æ–°çš„è¾“å…¥æ•°æ®ç±»å‹çš„æ–¹å¼å¢åŠ æ–°çš„è¾“å‡ºç±»å‹ï¼ˆå®šä¹‰Writeræ¥å£ï¼‰ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.5 å‰¯ä½œç”¨ ç¨‹åºå‘˜åœ¨å†™mapå’Œ/æˆ–reduceæ“ä½œçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå› ä¸ºæ–¹ä¾¿ï¼Œå®šä¹‰å¾ˆå¤šé¢å¤–åŠŸèƒ½ï¼Œæ¯”å¦‚å¢åŠ è¾…åŠ©çš„è¾“å‡ºæ–‡ä»¶ç­‰ã€‚ä½†åº”å½“æ—¶åˆ»è®°ä½ï¼Œmapå’Œreduceæ“ä½œåº”å½“ä¿è¯åŸå­æ€§å’Œå¹‚ç­‰æ€§ã€‚ æ¯”å¦‚ï¼Œä¸€ä¸ªä»»åŠ¡ç”Ÿæˆäº†å¤šä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰åŸå­åŒ–å¤šæ®µcommitçš„æ“ä½œã€‚è¿™å°±éœ€è¦ç¨‹åºå‘˜è‡ªå·±ä¿è¯ç”Ÿæˆå¤šä¸ªè¾“å‡ºçš„ä»»åŠ¡æ˜¯ç¡®å®šæ€§ä»»åŠ¡ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:5","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.6 è·³è¿‡æŸåçš„è®°å½• æœ‰æ—¶å€™ï¼Œç”¨æˆ·ç¨‹åºä¸­çš„ bug å¯¼è‡´ map æˆ–è€… reduce å‡½æ•°åœ¨å¤„ç†æŸäº›è®°å½•çš„æ—¶å€™ crash æ‰ï¼ŒMapReduce æ“ä½œ æ— æ³•é¡ºåˆ©å®Œæˆã€‚ç›¸è¾ƒäºä¿®å¤æ— æ³•æ‰§è¡Œçš„ Bugï¼Œè·³è¿‡å¼•å‘ Bug çš„è®°å½•å¯èƒ½æ›´ä¸ºæ˜æ™ºã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ› MapReduce æ£€æµ‹å“ªäº›è®°å½•å¯¼è‡´ç¡®å®šæ€§çš„crashï¼Œ å¹¶ä¸”è·³è¿‡è¿™äº›è®°å½•ä¸å¤„ç†ã€‚ MapReduce å¦‚ä½•è‡ªåŠ¨æ£€æµ‹è¿™ç§æƒ…å†µå‘¢ï¼Ÿé¦–å…ˆï¼Œæ¯ä¸ªworkerè¿›ç¨‹éƒ½è®¾ç½®äº†ä¿¡å·å¤„ç†å‡½æ•°æ•è·å†…å­˜æ®µå¼‚å¸¸ï¼ˆsegmentation violationï¼‰å’Œæ€»çº¿é”™è¯¯ï¼ˆbus errorï¼‰ã€‚ åœ¨æ‰§è¡Œ map æˆ–è€… reduce æ“ä½œä¹‹å‰ï¼ŒMapReduce åº“é€šè¿‡å…¨å±€å˜é‡ä¿å­˜è®°å½•åºå·ã€‚å¦‚æœç”¨æˆ·ç¨‹åºè§¦å‘äº†ä¸€ä¸ªç³»ç»Ÿä¿¡å·ï¼Œä¿¡å·å¤„ç†å‡½æ•°å°†ç”¨â€œæœ€åä¸€å£æ°”â€é€šè¿‡ UDP åŒ…å‘ master å‘é€å¤„ç†çš„æœ€åä¸€æ¡è®°å½•çš„åºå·ã€‚å½“ master çœ‹åˆ°åœ¨å¤„ç†æŸæ¡ç‰¹å®šè®°å½•ä¸æ­¢å¤±è´¥ä¸€æ¬¡æ—¶ï¼Œmaster å°±æ ‡å¿—è¿™æ¡è®°å½•éœ€è¦è¢«è·³è¿‡ï¼Œå¹¶ä¸”åœ¨ä¸‹æ¬¡é‡æ–°æ‰§è¡Œç›¸å…³çš„map æˆ–è€… reduce ä»»åŠ¡çš„æ—¶å€™è·³è¿‡è¿™æ¡è®°å½•ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:6","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.7 æœ¬åœ°æ‰§è¡Œ è°ƒè¯• map å’Œ reduce å‡½æ•°çš„ bug éå¸¸å›°éš¾ï¼Œå› ä¸ºå®ƒä»¬åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ‰§è¡Œï¼Œå¹¶ä¸”é€šå¸¸è·¨å¤šå°è®¡ç®—æœºæ‰§è¡Œï¼Œç”± master åŠ¨æ€è°ƒåº¦ã€‚ä¸ºäº†ç®€åŒ–è°ƒè¯•ã€æ€§èƒ½åˆ†æå’Œå°è§„æ¨¡æµ‹è¯•ï¼ŒGoogleå¼€å‘äº†æœ¬åœ°ç‰ˆæœ¬çš„ MapReduce åº“ã€‚è¿™ä¸ªæœ¬åœ°ç‰ˆæœ¬å¯ä»¥è®© MapReduce æ“ä½œåœ¨å•å°è®¡ç®—æœºä¸Šé¡ºåºæ‰§è¡Œã€‚ç”¨æˆ·å¯ä»¥æ§åˆ¶æ“ä½œçš„æ‰§è¡Œï¼Œå¹¶ä¸”å¯ä»¥å°†å…¶é™åˆ¶åœ¨ç‰¹å®šçš„ map ä»»åŠ¡ä¸Šã€‚é€šè¿‡è®¾ç½®ç‰¹æ®Šæ ‡å¿—ï¼Œç”¨æˆ·å¯ä»¥åœ¨æœ¬åœ°æ‰§è¡Œä»–ä»¬çš„ç¨‹åºï¼Œå¹¶ä¸”è½»æ¾ä½¿ç”¨æœ¬åœ°è°ƒè¯•å’Œæµ‹è¯•å·¥å…·ï¼ˆå¦‚ gdbï¼‰ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:7","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.8 çŠ¶æ€ä¿¡æ¯ åœ¨ master å†…éƒ¨ï¼Œè®¾æœ‰ä¸€ä¸ªå†…ç½®çš„ HTTP æœåŠ¡å™¨ï¼Œç”¨äºå±•ç¤ºä¸€ç³»åˆ—çŠ¶æ€ä¿¡æ¯é¡µé¢ã€‚è¿™äº›é¡µé¢ä¼šæ˜¾ç¤ºè®¡ç®—è¿›åº¦ï¼Œä¾‹å¦‚å·²å®Œæˆçš„ä»»åŠ¡æ•°é‡ã€æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ•°é‡ã€è¾“å…¥ã€ä¸­é—´æ•°æ®å’Œè¾“å‡ºçš„å­—èŠ‚æ•°ï¼Œä»¥åŠå¤„ç†é€Ÿç‡ç­‰ã€‚ è¿™äº›é¡µé¢è¿˜åŒ…å«äº†æŒ‡å‘æ¯ä¸ªä»»åŠ¡çš„stderrå’Œstdoutæ–‡ä»¶çš„é“¾æ¥ã€‚ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¿™äº›æ•°æ®æ¥é¢„æµ‹è®¡ç®—å®Œæˆæ‰€éœ€çš„æ—¶é—´ï¼Œä»¥åŠæ˜¯å¦éœ€è¦å¢åŠ æ›´å¤šèµ„æºã€‚å½“è®¡ç®—èŠ±è´¹çš„æ—¶é—´è¶…è¿‡é¢„æœŸæ—¶ï¼Œè¿™äº›é¡µé¢è¿˜å¯ä»¥å¸®åŠ©ç”¨æˆ·æ‰¾å‡ºæ‰§è¡Œé€Ÿåº¦ç¼“æ…¢çš„åŸå› ã€‚ å¦å¤–ï¼Œé¡¶å±‚çŠ¶æ€é¡µé¢è¿˜ä¼šæ˜¾ç¤ºå‡ºç°æ•…éšœçš„workeråŠå…¶æ•…éšœæ—¶æ­£åœ¨æ‰§è¡Œçš„ map å’Œ reduce ä»»åŠ¡ã€‚è¿™äº›ä¿¡æ¯å¯¹äºè°ƒè¯•ç”¨æˆ·ä»£ç ä¸­çš„ bug éå¸¸æœ‰å¸®åŠ©ã€‚ å¾ˆå¤šåˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„éƒ½ä¼šæä¾›å¯è§†åŒ–ç›‘æ§ç•Œé¢ï¼Œè¿™æ˜¯æå‡åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§çš„é‡è¦æ‰‹æ®µã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:8","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.9 è®¡æ•°å™¨ MapReduce åº“æä¾›è®¡æ•°å™¨æœºåˆ¶ï¼Œç”¨æ¥ç»Ÿè®¡ä¸åŒæ“ä½œå‘ç”Ÿæ¬¡æ•°ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·å¯èƒ½æƒ³ç»Ÿè®¡å·²ç»å¤„ç†äº†å¤šå°‘ä¸ªå•è¯ã€å·²ç»ç´¢å¼•çš„å¤šå°‘ç¯‡ German æ–‡æ¡£ç­‰ç­‰ã€‚ è¦æƒ³ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œç”¨æˆ·éœ€è¦åˆ›å»ºCounterå¯¹è±¡ï¼Œç„¶ååœ¨mapå’Œreduceå‡½æ•°ä¸­ä»¥æ­£ç¡®çš„æ–¹å¼å¢åŠ counterã€‚è¿™äº›è®¡æ•°å™¨çš„å€¼å‘¨æœŸæ€§çš„ä»å„ä¸ªå•ç‹¬çš„workeræœºå™¨ä¸Šä¼ é€’ç»™masterï¼ˆé™„åŠ åœ¨pingçš„åº”ç­”åŒ…ä¸­ä¼ é€’ï¼‰ã€‚master æŠŠæ‰§è¡ŒæˆåŠŸçš„ map å’Œ reduce ä»»åŠ¡çš„è®¡æ•°å™¨å€¼è¿›è¡Œç´¯è®¡ï¼Œå½“ MapReduce æ“ä½œå®Œæˆä¹‹åï¼Œè¿”å›ç»™ç”¨æˆ·ä»£ç ã€‚ è®¡æ•°å™¨å½“å‰çš„å€¼ä¹Ÿä¼šæ˜¾ç¤ºåœ¨ master çš„çŠ¶æ€é¡µé¢ä¸Šï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥çœ‹åˆ°å½“å‰è®¡ç®—çš„è¿›åº¦ã€‚ å½“ç´¯åŠ è¿™äº›counterçš„å€¼æ—¶ï¼Œmasterä¼šå»æ‰é‚£äº›é‡å¤æ‰§è¡Œçš„ç›¸åŒmapæˆ–è€…reduceæ“ä½œçš„æ¬¡æ•°ï¼Œä»¥æ­¤é¿å…é‡å¤è®¡æ•°ï¼ˆä¹‹å‰æåˆ°çš„å¤‡ç”¨ä»»åŠ¡å’Œæ•…éšœåé‡æ–°æ‰§è¡Œä»»åŠ¡ï¼Œè¿™ä¸¤ç§æƒ…å†µä¼šå¯¼è‡´ç›¸åŒçš„ä»»åŠ¡è¢«å¤šæ¬¡æ‰§è¡Œï¼‰ã€‚ æœ‰äº›counterå€¼æ˜¯ç”±MapReduceåº“è‡ªåŠ¨ç»´æŠ¤çš„ï¼Œä¾‹å¦‚å·²ç»å¤„ç†è¿‡çš„è¾“å…¥é”®å€¼å¯¹çš„æ•°é‡ä»¥åŠç”Ÿæˆçš„è¾“å‡ºé”®å€¼å¯¹çš„æ•°é‡ç­‰ç­‰ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:4:9","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5 åº”ç”¨åœºæ™¯ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.1 è®ºæ–‡ä¸­æå‡ºçš„åº”ç”¨åœºæ™¯ åˆ†å¸ƒå¼çš„ Grepï¼šmap å‡½æ•°è¾“å‡ºåŒ¹é…æŸä¸ªæ¨¡å¼çš„ä¸€è¡Œï¼Œreduce å‡½æ•°æ˜¯ä¸€ä¸ªæ’ç­‰å‡½æ•°ï¼Œå³æŠŠä¸­é—´æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºã€‚ è®¡ç®— URL è®¿é—®é¢‘ç‡ï¼šmap å‡½æ•°å¤„ç†æ—¥å¿—ä¸­ web é¡µé¢è¯·æ±‚çš„è®°å½•ï¼Œç„¶åè¾“å‡º (URL,1)ã€‚reduce å‡½æ•°æŠŠç›¸åŒ URL çš„ value å€¼éƒ½ç´¯åŠ èµ·æ¥ï¼Œäº§ç”Ÿ (URL, è®°å½•æ€»æ•°ï¼‰ç»“æœã€‚ å€’è½¬ç½‘ç»œé“¾æ¥å›¾ï¼šmap å‡½æ•°åœ¨æºé¡µé¢ï¼ˆsourceï¼‰ä¸­æœç´¢æ‰€æœ‰çš„é“¾æ¥ç›®æ ‡ï¼ˆtargetï¼‰å¹¶è¾“å‡ºä¸º(target,source)ã€‚ reduce å‡½æ•°æŠŠç»™å®šé“¾æ¥ç›®æ ‡ï¼ˆtargetï¼‰çš„é“¾æ¥ç»„åˆæˆä¸€ä¸ªåˆ—è¡¨ï¼Œè¾“å‡º(target,list(source))ã€‚ æ¯ä¸ªä¸»æœºçš„æ£€ç´¢è¯å‘é‡ï¼šæ£€ç´¢è¯å‘é‡ç”¨ä¸€ä¸ª(è¯,é¢‘ç‡)åˆ—è¡¨æ¥æ¦‚è¿°å‡ºç°åœ¨æ–‡æ¡£æˆ–æ–‡æ¡£é›†ä¸­çš„æœ€é‡è¦çš„ä¸€äº›è¯ã€‚map å‡½æ•°ä¸ºæ¯ä¸€ä¸ªè¾“å…¥æ–‡æ¡£è¾“å‡º(ä¸»æœºå,æ£€ç´¢è¯å‘é‡)ï¼Œå…¶ä¸­ä¸»æœºåæ¥è‡ªæ–‡æ¡£çš„ URLã€‚reduce å‡½æ•°æ¥æ”¶ç»™å®šä¸»æœºçš„æ‰€æœ‰æ–‡æ¡£çš„æ£€ç´¢è¯å‘é‡ï¼Œå¹¶æŠŠè¿™äº›æ£€ç´¢è¯å‘é‡åŠ åœ¨ä¸€èµ·ï¼Œä¸¢å¼ƒæ‰ä½é¢‘çš„æ£€ç´¢è¯ï¼Œè¾“å‡ºä¸€ä¸ªæœ€ç»ˆçš„(ä¸»æœºå,æ£€ç´¢è¯å‘é‡)ã€‚ å€’æ’ç´¢å¼•ï¼šmap å‡½æ•°åˆ†ææ¯ä¸ªæ–‡æ¡£è¾“å‡ºä¸€ä¸ª(è¯,æ–‡æ¡£å·)çš„åˆ—è¡¨ï¼Œreduce å‡½æ•°çš„è¾“å…¥æ˜¯ä¸€ä¸ªç»™å®šè¯çš„æ‰€æœ‰ ï¼ˆè¯ï¼Œæ–‡æ¡£å·ï¼‰ï¼Œæ’åºæ‰€æœ‰çš„æ–‡æ¡£å·ï¼Œè¾“å‡º(è¯,list(æ–‡æ¡£å·))ã€‚æ‰€æœ‰çš„è¾“å‡ºé›†åˆå½¢æˆä¸€ä¸ªç®€å•çš„å€’æ’ç´¢å¼•ï¼Œå®ƒä»¥ä¸€ç§ç®€å•çš„ç®—æ³•è·Ÿè¸ªè¯åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®ã€‚ åˆ†å¸ƒå¼æ’åºï¼šmap å‡½æ•°ä»æ¯ä¸ªè®°å½•æå– keyï¼Œè¾“å‡º(key,record)ã€‚reduce å‡½æ•°ä¸æ”¹å˜ä»»ä½•çš„å€¼ã€‚è¿™ä¸ªè¿ç®—ä¾èµ–åˆ†åŒºæœºåˆ¶å’Œæ’åºå±æ€§ã€‚ é‡å»ºç´¢å¼•ç³»ç»Ÿï¼šé‡å†™äº† Google ç½‘ç»œæœç´¢æœåŠ¡æ‰€ä½¿ç”¨çš„ç´¢å¼•ç³»ç»Ÿã€‚è¿™ä¸ªç´¢å¼•ç³»ç»Ÿçš„è¾“å…¥æ•°æ®æ˜¯ç½‘ç»œçˆ¬è™«æŠ“å–å›æ¥çš„å¤§é‡æ–‡æ¡£ï¼Œè¿™äº›æ–‡æ¡£æ•°æ®ä¿å­˜åœ¨ GFS æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå…¶åŸå§‹å†…å®¹è¶…è¿‡äº† 20TBã€‚é€šè¿‡ä¸€ç³»åˆ—çš„ MapReduce æ“ä½œï¼ˆå¤§çº¦ 5 åˆ° 10 æ¬¡ï¼‰ï¼Œæ¥å»ºç«‹ç´¢å¼•ã€‚ä½¿ç”¨ MapReduceï¼ˆæ›¿æ¢ä¸Šä¸€ä¸ªç‰¹åˆ«è®¾è®¡çš„ã€åˆ†å¸ƒå¼å¤„ç†çš„ç´¢å¼•ç¨‹åºï¼‰å¸¦æ¥è¿™äº›å¥½å¤„ï¼š ç®€åŒ–çš„ä»£ç ï¼šç´¢å¼•éƒ¨åˆ†çš„ä»£ç å˜å¾—ç®€å•ã€å°å·§ã€æ˜“äºç†è§£ï¼› çµæ´»æ€§ï¼šMapReduce åº“çš„æ€§èƒ½å·²ç»è¶³å¤Ÿå¥½ï¼Œå› æ­¤å¯ä»¥å°†æ¦‚å¿µä¸Šä¸ç›¸å…³çš„è®¡ç®—æ­¥éª¤åˆ†å¼€å¤„ç†ï¼Œå‡å°‘æ•°æ®ä¼ é€’çš„é¢å¤–å¼€é”€ï¼› æ“ä½œç®¡ç†çš„ç®€åŒ–ï¼šå› ä¸ºç”±æœºå™¨å¤±æ•ˆã€æœºå™¨å¤„ç†é€Ÿåº¦ç¼“æ…¢ã€ä»¥åŠç½‘ç»œçš„ç¬é—´é˜»å¡ç­‰å¼•èµ·çš„ç»å¤§éƒ¨åˆ†é—®é¢˜éƒ½å·²ç»ç”± MapReduce åº“è§£å†³äº†ï¼Œä¸å†éœ€è¦æ“ä½œäººå‘˜çš„ä»‹å…¥äº†ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç´¢å¼•ç³»ç»Ÿé›†ç¾¤ä¸­å¢åŠ æœºå™¨çš„ç®€å•æ–¹æ³•æé«˜æ•´ä½“å¤„ç†æ€§èƒ½ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:5:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.2 å…¶ä»–åº”ç”¨åœºæ™¯ æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ï¼šMapReduce å¯ä»¥ç”¨äºå¤„ç†å¤§è§„æ¨¡æ•°æ®é›†çš„æ¸…æ´—å’Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬æ•°æ®å»é‡ã€æ•°æ®è¿‡æ»¤ã€æ•°æ®æ ¼å¼è½¬æ¢ç­‰æ“ä½œï¼› æ—¥å¿—åˆ†æå’Œå¼‚å¸¸æ£€æµ‹ï¼šMapReduce å¯ä»¥ç”¨äºåˆ†æå¤§è§„æ¨¡æ—¥å¿—æ•°æ®ï¼Œæ£€æµ‹å¼‚å¸¸è¡Œä¸ºã€æ•…éšœäº‹ä»¶å’Œç³»ç»Ÿæ€§èƒ½é—®é¢˜ï¼› å›¾ç®—æ³•å’Œç¤¾äº¤ç½‘ç»œåˆ†æï¼šMapReduce å¯ä»¥åº”ç”¨äºå›¾ç®—æ³•å’Œç¤¾äº¤ç½‘ç»œåˆ†æï¼ŒåŒ…æ‹¬å›¾çš„éå†ã€æœ€çŸ­è·¯å¾„è®¡ç®—ã€ç¤¾åŒºå‘ç°ç­‰æ“ä½œï¼› æ–‡æœ¬æŒ–æ˜å’Œä¿¡æ¯æŠ½å–ï¼šMapReduce å¯ä»¥ç”¨äºå¤„ç†æ–‡æœ¬æ•°æ®ï¼Œè¿›è¡Œä¿¡æ¯æŠ½å–ã€å®ä½“è¯†åˆ«ã€ä¸»é¢˜å»ºæ¨¡ç­‰è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:5:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"6 FAQ å½“ä½ è°ƒç”¨emitæ—¶ï¼Œæ•°æ®ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿemitå‡½æ•°åœ¨å“ªè¿è¡Œï¼Ÿ é¦–å…ˆçœ‹ï¼Œè¿™äº›å‡½æ•°åœ¨å“ªè¿è¡Œã€‚è¿™é‡Œå¯ä»¥çœ‹MapReduceè®ºæ–‡çš„å›¾1ã€‚ç°å®ä¸­ï¼ŒMapReduceè¿è¡Œåœ¨å¤§é‡çš„æœåŠ¡å™¨ä¹‹ä¸Šï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºworkeræœåŠ¡å™¨æˆ–è€…workerã€‚åŒæ—¶ï¼Œä¹Ÿä¼šæœ‰ä¸€ä¸ªMasterèŠ‚ç‚¹æ¥ç»„ç»‡æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ã€‚è¿™é‡Œå®é™…å‘ç”Ÿçš„æ˜¯ï¼ŒMasteræœåŠ¡å™¨çŸ¥é“æœ‰å¤šå°‘è¾“å…¥æ–‡ä»¶ï¼Œä¾‹å¦‚5000ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œä¹‹åå®ƒå°†Mapå‡½æ•°åˆ†å‘åˆ°ä¸åŒçš„workerã€‚æ‰€ä»¥ï¼Œå®ƒä¼šå‘workeræœåŠ¡å™¨å‘é€ä¸€æ¡æ¶ˆæ¯è¯´ï¼Œè¯·å¯¹è¿™ä¸ªè¾“å…¥æ–‡ä»¶æ‰§è¡ŒMapå‡½æ•°å§ã€‚ä¹‹åï¼ŒMapReduceæ¡†æ¶ä¸­çš„workerè¿›ç¨‹ä¼šè¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œè°ƒç”¨Mapå‡½æ•°å¹¶å°†æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹ä½œä¸ºå‚æ•°ä¼ ç»™Mapå‡½æ•°ã€‚workerè¿›ç¨‹è¿˜éœ€è¦å®ç°emitï¼Œè¿™æ ·ï¼Œæ¯æ¬¡Mapå‡½æ•°è°ƒç”¨emitï¼Œworkerè¿›ç¨‹å°±ä¼šå°†æ•°æ®å†™å…¥åˆ°æœ¬åœ°ç£ç›˜çš„æ–‡ä»¶ä¸­ã€‚æ‰€ä»¥ï¼ŒMapå‡½æ•°ä¸­è°ƒç”¨emitçš„æ•ˆæœæ˜¯åœ¨workerçš„æœ¬åœ°ç£ç›˜ä¸Šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åŒ…å«äº†å½“å‰workerçš„Mapå‡½æ•°ç”Ÿæˆçš„æ‰€æœ‰çš„keyå’Œvalueã€‚ æ‰€ä»¥ï¼ŒMapé˜¶æ®µç»“æŸæ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„å°±æ˜¯Mapå‡½æ•°åœ¨workerä¸Šç”Ÿæˆçš„ä¸€äº›æ–‡ä»¶ã€‚ä¹‹åï¼ŒMapReduceçš„workerä¼šå°†è¿™äº›æ•°æ®ç§»åŠ¨åˆ°Reduceæ‰€éœ€è¦çš„ä½ç½®ã€‚å¯¹äºä¸€ä¸ªå…¸å‹çš„å¤§å‹è¿ç®—ï¼ŒReduceçš„å…¥å‚åŒ…å«äº†æ‰€æœ‰Mapå‡½æ•°å¯¹äºç‰¹å®škeyçš„è¾“å‡ºã€‚é€šå¸¸æ¥è¯´ï¼Œæ¯ä¸ªMapå‡½æ•°éƒ½å¯èƒ½ç”Ÿæˆå¤§é‡keyã€‚æ‰€ä»¥é€šå¸¸æ¥è¯´ï¼Œåœ¨è¿è¡ŒReduceå‡½æ•°ä¹‹å‰ã€‚è¿è¡Œåœ¨MapReduceçš„workeræœåŠ¡å™¨ä¸Šçš„è¿›ç¨‹éœ€è¦ä¸é›†ç¾¤ä¸­æ¯ä¸€ä¸ªå…¶ä»–æœåŠ¡å™¨äº¤äº’æ¥è¯¢é—®è¯´ï¼Œçœ‹ï¼Œæˆ‘éœ€è¦å¯¹key=aè¿è¡ŒReduceï¼Œè¯·çœ‹ä¸€ä¸‹ä½ æœ¬åœ°ç£ç›˜ä¸­å­˜å‚¨çš„Mapå‡½æ•°çš„ä¸­é—´è¾“å‡ºï¼Œæ‰¾å‡ºæ‰€æœ‰key=aï¼Œå¹¶é€šè¿‡ç½‘ç»œå°†å®ƒä»¬å‘ç»™æˆ‘ã€‚æ‰€ä»¥ï¼ŒReduce workeréœ€è¦ä»æ¯ä¸€ä¸ªworkerè·å–ç‰¹å®škeyçš„å®ä¾‹ã€‚è¿™æ˜¯é€šè¿‡ç”±Masteré€šçŸ¥åˆ°Reduce workerçš„ä¸€æ¡æŒ‡ä»¤æ¥è§¦å‘ã€‚ä¸€æ—¦workeræ”¶é›†å®Œæ‰€æœ‰çš„æ•°æ®ï¼Œå®ƒä¼šè°ƒç”¨Reduceå‡½æ•°ï¼ŒReduceå‡½æ•°è¿ç®—å®Œäº†ä¼šè°ƒç”¨è‡ªå·±çš„emitï¼Œè¿™ä¸ªemitä¸Mapå‡½æ•°ä¸­çš„emitä¸ä¸€æ ·ï¼Œå®ƒä¼šå°†è¾“å‡ºå†™å…¥åˆ°ä¸€ä¸ªGoogleä½¿ç”¨çš„å…±äº«æ–‡ä»¶æœåŠ¡ä¸­ã€‚ æœ‰å…³è¾“å…¥å’Œè¾“å‡ºæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼Œè¿™æ˜¯æˆ‘ä¹‹å‰æ²¡æœ‰æåˆ°çš„ï¼Œå®ƒä»¬éƒ½å­˜æ”¾åœ¨æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦çµæ´»çš„åœ¨ä»»æ„çš„workerä¸Šè¯»å–ä»»æ„çš„æ•°æ®ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦æŸç§ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆnetwork file systemï¼‰æ¥å­˜æ”¾è¾“å…¥æ•°æ®ã€‚æ‰€ä»¥å®é™…ä¸Šï¼ŒMapReduceè®ºæ–‡è°ˆåˆ°äº†GFSï¼ˆGoogle File Systemï¼‰ã€‚GFSæ˜¯ä¸€ä¸ªå…±äº«æ–‡ä»¶æœåŠ¡ï¼Œå¹¶ä¸”å®ƒä¹Ÿè¿è¡Œåœ¨MapReduceçš„workeré›†ç¾¤çš„ç‰©ç†æœåŠ¡å™¨ä¸Šã€‚GFSä¼šè‡ªåŠ¨æ‹†åˆ†ä½ å­˜å‚¨çš„ä»»ä½•å¤§æ–‡ä»¶ï¼Œå¹¶ä¸”ä»¥64MBçš„å—å­˜å‚¨åœ¨å¤šä¸ªæœåŠ¡å™¨ä¹‹ä¸Šã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰äº†10TBçš„ç½‘é¡µæ•°æ®ï¼Œä½ åªéœ€è¦å°†å®ƒä»¬å†™å…¥åˆ°GFSï¼Œç”šè‡³ä½ å†™å…¥çš„æ—¶å€™æ˜¯ä½œä¸ºä¸€ä¸ªå¤§æ–‡ä»¶å†™å…¥çš„ï¼ŒGFSä¼šè‡ªåŠ¨å°†è¿™ä¸ªå¤§æ–‡ä»¶æ‹†åˆ†æˆ64MBçš„å—ï¼Œå¹¶å°†è¿™äº›å—å¹³å‡çš„åˆ†å¸ƒåœ¨æ‰€æœ‰çš„GFSæœåŠ¡å™¨ä¹‹ä¸Šï¼Œè€Œè¿™æ˜¯æå¥½çš„ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚å¦‚æœæˆ‘ä»¬æ¥ä¸‹æ¥æƒ³è¦å¯¹åˆšåˆšé‚£10TBçš„ç½‘é¡µæ•°æ®è¿è¡ŒMapReduce Jobï¼Œæ•°æ®å·²ç»å‡åŒ€çš„åˆ†å‰²å­˜å‚¨åœ¨æ‰€æœ‰çš„æœåŠ¡å™¨ä¸Šäº†ã€‚å¦‚æœæˆ‘ä»¬æœ‰1000å°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä¼šå¯åŠ¨1000ä¸ªMap workerï¼Œæ¯ä¸ªMap workerä¼šè¯»å–1/1000è¾“å…¥æ•°æ®ã€‚è¿™äº›Map workerå¯ä»¥å¹¶è¡Œçš„ä»1000ä¸ªGFSæ–‡ä»¶æœåŠ¡å™¨è¯»å–æ•°æ®ï¼Œå¹¶è·å–å·¨å¤§çš„è¯»å–ååé‡ï¼Œä¹Ÿå°±æ˜¯1000å°æœåŠ¡å™¨èƒ½æä¾›çš„ååé‡ã€‚ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:6:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"7 å‚è€ƒ paper:MapReduce MIT 6.824 çŸ¥ä¹ ã€åˆ†å¸ƒå¼ã€‘MapReduceè®ºæ–‡ç¬”è®° çŸ¥ä¹ Google MapReduce è®ºæ–‡è¯¦è§£ ","date":"2024-05-12","objectID":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/:7:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","MapReduce"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘MapReduce: Simplified Data Processing on Large Clusters","uri":"/posts/01.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0mapreduce/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"1 ç®€ä»‹ Google File System (GFS) æ˜¯ä¸€ä¸ªå¯æ‰©å±•çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œä¸“ä¸ºå¿«é€Ÿå¢é•¿çš„Googleæ•°æ®å¤„ç†éœ€æ±‚è€Œè®¾è®¡ã€‚è¿™ç¯‡è®ºæ–‡å‘è¡¨äº2003å¹´ï¼Œæ­¤å‰å·²åœ¨Googleå†…éƒ¨å¤§è§„æ¨¡åº”ç”¨ã€‚ GFSä¸ä»…è¿½æ±‚æ€§èƒ½ã€å¯ä¼¸ç¼©æ€§ã€å¯é æ€§å’Œå¯ç”¨æ€§ç­‰ä¼ ç»Ÿåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„è®¾è®¡ç›®æ ‡ï¼Œè¿˜åŸºäºå¯¹è‡ªèº«åº”ç”¨è´Ÿè½½æƒ…å†µå’ŒæŠ€æœ¯ç¯å¢ƒçš„æ·±å…¥è§‚å¯Ÿï¼Œæå‡ºäº†ç‹¬ç‰¹çš„è®¾è®¡æ€è·¯ï¼Œä¸æ—©æœŸæ–‡ä»¶ç³»ç»Ÿçš„å‡è®¾æ˜æ˜¾ä¸åŒã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:1:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2 è®¾è®¡æ¦‚è¿° ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.1 è®¾è®¡ç›®æ ‡ GFS åœ¨è®¾è®¡çš„æ—¶å€™æœ‰ä¸€äº›å‡æƒ³ï¼Œå³é¢„æœŸè¦å®ç°çš„ç›®æ ‡ã€‚ ç³»ç»Ÿç”±è®¸å¤šå»‰ä»·çš„æ™®é€šç»„ä»¶ç»„æˆï¼Œå› æ­¤ç»„ä»¶å¤±æ•ˆæ˜¯ä¸€ç§å¸¸æ€ã€‚GFSå¿…é¡»èƒ½å¤ŸæŒç»­ç›‘æ§è‡ªèº«çš„çŠ¶æ€ï¼Œå°†ç»„ä»¶å¤±æ•ˆä½œä¸ºä¸€ç§å¸¸æ€äº‹ä»¶ï¼Œå¹¶èƒ½å¤Ÿè¿…é€Ÿä¾¦æµ‹ã€å†—ä½™å’Œæ¢å¤å¤±æ•ˆçš„ç»„ä»¶ã€‚ ç³»ç»Ÿèƒ½å­˜å‚¨ä¸€å®šæ•°é‡çš„å¤§æ–‡ä»¶ã€‚Googleé¢„æœŸä¼šå­˜å‚¨å‡ ç™¾ä¸‡ä¸ªæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶é€šå¸¸å¤§å°åœ¨100MBä»¥ä¸Šï¼Œæ•°GBå¤§å°çš„æ–‡ä»¶ä¹Ÿæ˜¯æ™®éå­˜åœ¨çš„ã€‚ç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿé«˜æ•ˆç®¡ç†è¿™äº›å¤§æ–‡ä»¶ï¼ŒåŒæ—¶ï¼Œç³»ç»Ÿä¹Ÿå¿…é¡»æ”¯æŒå°æ–‡ä»¶ï¼Œä½†ä¸éœ€è¦é’ˆå¯¹å°æ–‡ä»¶è¿›è¡Œä¸“é—¨ä¼˜åŒ–ã€‚ å·¥ä½œè´Ÿè½½ä¸»è¦åŒ…æ‹¬ä¸¤ç±»è¯»æ“ä½œï¼š å¤§è§„æ¨¡æµå¼è¯»å–ï¼šå•ä¸ªè¯»æ“ä½œä¸€èˆ¬è¯»å‡ ç™¾ KBï¼Œæ›´å¸¸è§çš„æ˜¯è¯» 1MB ç”šè‡³æ›´å¤šã€‚æ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿ç»­æ“ä½œé€šå¸¸æ˜¯è¯»å–åŒä¸€ä¸ªæ–‡ä»¶ä¸­è¿ç»­çš„ä¸€ä¸ªåŒºåŸŸã€‚ å°è§„æ¨¡éšæœºè¯»å–ï¼šä¸€èˆ¬æ˜¯åœ¨æ–‡ä»¶çš„æŸä¸ªéšæœºä½ç½®è¯»å‡ ä¸ª KB æ•°æ®ã€‚æ³¨é‡æ€§èƒ½çš„åº”ç”¨ç¨‹åºé€šå¸¸ä¼šå°†å°è§„æ¨¡éšæœºè¯»å–æ“ä½œåˆå¹¶å¹¶æ’åºï¼Œä¹‹åæŒ‰é¡ºåºæ‰¹é‡è¯»å–ï¼Œé¿å…åœ¨æ–‡ä»¶ä¸­å‰åç§»åŠ¨è¯»å–ä½ç½®ã€‚ ç³»ç»Ÿçš„å·¥ä½œè´Ÿè½½ä¹Ÿä¼šæœ‰å¾ˆå¤šå¤§è§„æ¨¡çš„ã€é¡ºåºçš„ã€æ•°æ®è¿½åŠ æ–¹å¼çš„å†™æ“ä½œã€‚ä¸€èˆ¬è¿™ç§æ“ä½œçš„å¤§å°å’Œå¤§è§„æ¨¡è¯»ç±»ä¼¼ã€‚ä¸€æ—¦å†™å…¥æ“ä½œå®Œæˆï¼Œè¿™ä¸ªæ–‡ä»¶å¾ˆå°‘ä¼šè¢«ä¿®æ”¹ã€‚å°è§„æ¨¡çš„éšæœºå†™ä¹Ÿæ”¯æŒï¼Œä½†æ˜¯ä¸å¤ªé«˜æ•ˆã€‚ ç³»ç»Ÿå¿…é¡»é«˜æ•ˆçš„ã€è¡Œä¸ºå®šä¹‰æ˜ç¡®çš„å®ç°å¤šå®¢æˆ·ç«¯å¹¶è¡Œè¿½åŠ æ•°æ®åˆ°åŒä¸€ä¸ªæ–‡ä»¶é‡Œçš„è¯­æ„ã€‚GFS ä¸­çš„æ–‡ä»¶é€šå¸¸ç”¨ä½œâ€œç”Ÿäº§è€…â€”æ¶ˆè´¹è€…â€é˜Ÿåˆ—æˆ–å…¶ä»–å¤šè·¯æ–‡ä»¶åˆå¹¶æ“ä½œã€‚ç³»ç»Ÿä¸­é€šå¸¸æœ‰æ•°ç™¾ä¸ªç”Ÿäº§è€…ï¼Œæ¯ä¸ªæœºå™¨ä¸Šè¿è¡Œä¸€ä¸ªï¼Œè¿™äº›ç”Ÿäº§è€…å¹¶å‘åœ°è¿½åŠ ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ï¼Œå› æ­¤ä»¥æœ€å°çš„åŒæ­¥å¼€é”€æ¥å®ç°åŸå­æ€§æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è¿™äº›æ–‡ä»¶å¯èƒ½éšåè¢«è¯»å–ï¼Œä¹Ÿå¯èƒ½æ˜¯æ¶ˆè´¹è€…åœ¨è¿½åŠ çš„æ“ä½œçš„åŒæ—¶è¯»å–æ–‡ä»¶ã€‚ é«˜æ€§èƒ½çš„ç¨³å®šç½‘ç»œå¸¦å®½è¿œæ¯”ä½å»¶è¿Ÿé‡è¦ã€‚GFS çš„å¤§å¤šæ•°ç›®æ ‡åº”ç”¨ç¨‹åºéƒ½é‡è§†ä»¥é«˜é€Ÿç‡çš„ã€å¤§æ‰¹é‡çš„å¤„ç†æ•°æ®ï¼Œè€Œå¾ˆå°‘æœ‰åº”ç”¨ç¨‹åºå¯¹å•ä¸ªè¯»æˆ–å†™æœ‰ä¸¥æ ¼çš„å“åº”æ—¶é—´è¦æ±‚ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.2 æ¥å£ GFS æä¾›äº†ä¸€å¥—ç±»ä¼¼ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„ API æ¥å£å‡½æ•°ï¼Œè™½ç„¶å¹¶ä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§ POSIX ç­‰æ ‡å‡† API çš„å½¢å¼å®ç°çš„ã€‚æ–‡ä»¶ä»¥åˆ†å±‚ç›®å½•çš„å½¢å¼ç»„ç»‡ï¼Œç”¨è·¯å¾„åæ¥æ ‡è¯†ã€‚GFS æ”¯æŒå¸¸ç”¨æ“ä½œä»¥åˆ›å»º(create)ã€åˆ é™¤(delete)ã€æ‰“å¼€(open)ã€å…³é—­(close)ã€è¯»(read)å’Œå†™(write)æ–‡ä»¶ã€‚ å¦å¤–ï¼ŒGFS æä¾›äº†å¿«ç…§å’Œè®°å½•è¿½åŠ æ“ä½œã€‚ å¿«ç…§ä»¥å¾ˆä½çš„æˆæœ¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•æ ‘çš„æ‹·è´ã€‚ è®°å½•è¿½åŠ æ“ä½œå…è®¸å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ•°æ®è¿½åŠ æ“ä½œï¼ŒåŒæ—¶ä¿è¯æ¯ä¸ªå®¢æˆ·ç«¯çš„è¿½åŠ æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚è¿™å¯¹äºå®ç°å¤šè·¯ç»“æœåˆå¹¶ã€â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€é˜Ÿåˆ—éå¸¸æœ‰ç”¨ï¼Œå¤šä¸ªå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶è¿½åŠ å†™å…¥ï¼Œè€Œä¸éœ€è¦é¢å¤–çš„åŒæ­¥é”ã€‚Google å‘ç°åœ¨æ„å»ºå¤§å‹åˆ†å¸ƒå¼åº”ç”¨æ—¶ï¼Œè¿™äº›ç±»å‹çš„æ–‡ä»¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.3 æ¶æ„ ä¸€ä¸ª GFS é›†ç¾¤åŒ…å«ä¸€ä¸ªå•ç‹¬çš„masterèŠ‚ç‚¹å’Œå¤šä¸ªchunkæœåŠ¡å™¨ï¼Œå…è®¸å¤šä¸ªå®¢æˆ·ç«¯è®¿é—®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ‰€æœ‰è¿™äº›æœºå™¨é€šå¸¸æ˜¯æ™®é€šçš„ Linux æœºå™¨ï¼Œè¿è¡Œç”¨æˆ·çº§åˆ«çš„æœåŠ¡è¿›ç¨‹ã€‚å¯ä»¥å°† chunkserverå’Œå®¢æˆ·ç«¯éƒ¨ç½²åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå‰ææ˜¯æœºå™¨èµ„æºå…è®¸ï¼Œå¹¶èƒ½æ¥å—ç¨³å®šæ€§é™ä½çš„é£é™©ã€‚ å…¶ä¸­GFSå­˜å‚¨çš„æ–‡ä»¶éƒ½è¢«åˆ†å‰²æˆå›ºå®šå¤§å°çš„chunkã€‚åœ¨chunk åˆ›å»ºçš„æ—¶å€™ï¼Œmasterä¼šç»™æ¯ä¸ª chunk åˆ† é…ä¸€ä¸ªä¸å˜çš„ã€å…¨å±€å”¯ä¸€çš„ 64 ä½çš„ chunk å¥æŸ„æ¥æ ‡è¯†ã€‚chunkserveræŠŠ chunk ä»¥ Linux æ–‡ä»¶çš„å½¢å¼ä¿å­˜åœ¨æœ¬åœ°ç¡¬ç›˜ä¸Šï¼Œå¹¶ä¸”æ ¹æ®æŒ‡å®šçš„ chunk å¥æŸ„å’Œå­—èŠ‚èŒƒå›´æ¥è¯»å†™å—æ•°æ®ã€‚å‡ºäºå¯é æ€§çš„è€ƒè™‘ï¼Œæ¯ä¸ªchunkéƒ½ä¼šå¤åˆ¶åˆ°å¤šä¸ªchunkæœåŠ¡å™¨ä¸Šã€‚é»˜è®¤ä½¿ç”¨3 ä¸ªå­˜å‚¨å¤åˆ¶èŠ‚ç‚¹ï¼Œä¸è¿‡ç”¨æˆ·å¯ä»¥ä¸ºä¸åŒçš„æ–‡ä»¶å‘½åç©ºé—´è®¾å®šä¸åŒçš„å¤åˆ¶çº§åˆ«ã€‚ masterèŠ‚ç‚¹ç®¡ç†æ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®ã€‚è¿™äº›å…ƒæ•°æ®åŒ…æ‹¬å‘½åç©ºé—´ã€è®¿é—®æ§åˆ¶ä¿¡æ¯ã€æ–‡ä»¶å’Œchunk çš„æ˜ å°„ä¿¡æ¯ã€ä»¥åŠchunkå½“å‰çš„ä½ç½®ä¿¡æ¯ã€‚Master èŠ‚ç‚¹è¿˜ç®¡ç†ç€ç³»ç»ŸèŒƒå›´å†…çš„æ´»åŠ¨ï¼Œæ¯”å¦‚ï¼Œchunk ç§Ÿç”¨ç®¡ç†ã€å­¤å„¿ chunkçš„å›æ”¶ã€ä»¥åŠ chunk åœ¨ chunkserverä¹‹é—´çš„è¿ç§»ã€‚master èŠ‚ç‚¹ä½¿ç”¨å¿ƒè·³ä¿¡æ¯å‘¨æœŸåœ°å’Œæ¯ä¸ª chunkserveré€šè®¯ï¼Œå‘é€æŒ‡ä»¤åˆ°å„ä¸ª chunkserverå¹¶æ¥æ”¶ chunkserverçš„çŠ¶æ€ä¿¡æ¯ã€‚ é“¾æ¥åˆ°æ¯ä¸ªåº”ç”¨ç¨‹åºçš„ GFS å®¢æˆ·ç«¯ä»£ç ä¸­å®ç°äº†æ–‡ä»¶ç³»ç»Ÿ APIï¼Œè¿™ä¸ª GFS å®¢æˆ·ç«¯ä»£è¡¨åº”ç”¨ç¨‹åºä¸ master å’Œ chunkæœåŠ¡å™¨é€šä¿¡ä»¥è¯»å†™æ•°æ®ã€‚å®¢æˆ·ç«¯ä¸ master äº¤äº’åªè¿›è¡Œå…ƒæ•°æ®æ“ä½œï¼Œæ‰€æœ‰çš„æ•°æ®æ“ä½œéƒ½æ˜¯ç”±å®¢æˆ·ç«¯ç›´æ¥å’Œ chunkserverè¿›è¡Œäº¤äº’çš„ã€‚GFS æ²¡æœ‰æä¾› POSIXæ ‡å‡†çš„APIï¼Œå› æ­¤ä¸éœ€è¦æ·±å…¥åˆ° Linux çš„ vnode å±‚ã€‚ å®¢æˆ·ç«¯å’Œ chunkæœåŠ¡å™¨éƒ½ä¸ç¼“å­˜æ–‡ä»¶æ•°æ®ã€‚ å®¢æˆ·ç«¯ç¼“å­˜æ–‡ä»¶æ•°æ®å‡ ä¹æ²¡ä»€ä¹ˆå¥½å¤„ï¼Œå› ä¸ºå¤§å¤šæ•°åº”ç”¨ç¨‹åºé€šè¿‡å·¨å¤§çš„æ–‡ä»¶è¿›è¡Œæµå¼ä¼ è¾“ï¼Œæˆ–è€…å·¥ä½œé›†å¤ªå¤§è€Œæ— æ³•ç¼“å­˜ã€‚ä¸ç¼“å­˜æ–‡ä»¶æ•°æ®ä½¿å¾—å®¢æˆ·ç«¯ä»£ç å’Œæ€»ä½“ç³»ç»Ÿçš„ä»£ç å¾—ä»¥ç®€åŒ–ï¼Œå› ä¸ºæ— éœ€ç¼–å†™ä»£ç è§£å†³ç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ï¼ˆä¸è¿‡å®¢æˆ·ç«¯æ˜¯ç¼“å­˜å…ƒæ•°æ®çš„ï¼‰ã€‚ chunkæœåŠ¡å™¨ä¸éœ€è¦ç¼“å­˜æ–‡ä»¶æ•°æ®æ˜¯å› ä¸º chunk ä»¥æœ¬åœ°æ–‡ä»¶çš„æ–¹å¼ä¿å­˜ï¼ŒLinux æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¼šæŠŠç»å¸¸è®¿é—®çš„æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.4 å•ä¸ªMaster å•ä¸€çš„ Master èŠ‚ç‚¹ç­–ç•¥å¤§å¤§ç®€åŒ–äº†ç³»ç»Ÿè®¾è®¡ã€‚å•ä¸€çš„ Master èŠ‚ç‚¹èƒ½å¤Ÿé€šè¿‡å…¨å±€ä¿¡æ¯ç²¾ç¡®å®šä½ chunk çš„ä½ç½®ï¼Œå¹¶åšå‡ºå¤åˆ¶å†³ç­–ã€‚ä¸è¿‡å¿…é¡»æœ€å°åŒ–åœ¨è¯»å†™ä¸­ master çš„è°ƒç”¨æ¬¡æ•°ï¼Œé˜²æ­¢ master æˆä¸º GFS ç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆã€‚å®¢æˆ·ç«¯æ°¸è¿œä¸é€šè¿‡ Master èŠ‚ç‚¹ç›´æ¥è¯»å†™æ–‡ä»¶æ•°æ®ï¼Œè€Œæ˜¯å‘ master èŠ‚ç‚¹è¯·æ±‚åº”è”ç³»çš„ chunkserverï¼Œå¹¶å°†è¿™äº›å…ƒæ•°æ®ç¼“å­˜ä¸€æ®µæ—¶é—´ï¼Œåç»­æ“ä½œç›´æ¥ä¸ chunkserverè¿›è¡Œã€‚ ä»¥ä¸Šå›¾GFSæ¶æ„ä¸ºä¾‹ï¼Œåœ¨ä¸€æ¬¡ç®€å•è¯»å–æ“ä½œä¸­ï¼š å®¢æˆ·ç«¯å°†æ–‡ä»¶åå’Œå­—èŠ‚åç§»é‡è½¬æ¢æˆæ–‡ä»¶çš„ chunkç´¢å¼•ï¼ˆchunk_index = offset / chunk_sizeï¼‰ï¼Œå¹¶å°†æ–‡ä»¶åå’Œ chunk ç´¢å¼•å‘é€ç»™ master èŠ‚ç‚¹ã€‚ master èŠ‚ç‚¹è¿”å›ç›¸åº”çš„ chunk å¥æŸ„å’Œå‰¯æœ¬çš„ä½ç½®ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯å°†è¿™äº›ä¿¡æ¯ç¼“å­˜ã€‚ å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€ç»™ä¸€ä¸ªå‰¯æœ¬ï¼Œé€šå¸¸é€‰æ‹©æœ€è¿‘çš„å‰¯æœ¬ï¼Œè¯·æ±‚åŒ…å« chunk å¥æŸ„å’Œå­—èŠ‚èŒƒå›´ã€‚åœ¨åç»­å¯¹è¯¥ chunk çš„è¯»å–æ“ä½œä¸­ï¼Œå®¢æˆ·ç«¯æ— éœ€å†æ¬¡ä¸ master èŠ‚ç‚¹é€šè®¯ï¼Œé™¤éç¼“å­˜çš„å…ƒæ•°æ®ä¿¡æ¯è¿‡æœŸæˆ–æ–‡ä»¶è¢«é‡æ–°æ‰“å¼€ã€‚ å®¢æˆ·ç«¯é€šå¸¸ä¼šåœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æŸ¥è¯¢å¤šä¸ª chunk ä¿¡æ¯ï¼Œmaster èŠ‚ç‚¹çš„å›å¤å¯èƒ½åŒ…å«åç»­ chunk çš„ä¿¡æ¯ï¼Œè¿™äº›é¢å¤–ä¿¡æ¯åœ¨é¿å…æœªæ¥å¤šæ¬¡é€šè®¯çš„åŒæ—¶ï¼Œä¸å¢åŠ é¢å¤–ä»£ä»·ã€‚è¿™ç§è®¾è®¡ä¿è¯äº†ç³»ç»Ÿçš„é«˜æ•ˆæ€§ï¼Œå‡å°‘äº† master èŠ‚ç‚¹çš„è´Ÿæ‹…ï¼Œæé«˜äº†æ•´ä½“æ€§èƒ½ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.5 chunkå¤§å° chunk çš„å¤§å°æ˜¯ GFS çš„å…³é”®è®¾è®¡å‚æ•°ä¹‹ä¸€ï¼ŒGFS é€‰æ‹©äº† 64MB çš„ chunk å¤§å°ï¼Œè¿™è¿œå¤§äºä¸€èˆ¬æ–‡ä»¶ç³»ç»Ÿçš„ block å¤§å°ã€‚æ¯ä¸ª chunk çš„å‰¯æœ¬éƒ½ä»¥æ™®é€š Linux æ–‡ä»¶çš„å½¢å¼ä¿å­˜åœ¨ chunkserverä¸Šï¼Œå¹¶ä¸”åªæœ‰åœ¨éœ€è¦æ—¶æ‰æ‰©å¤§ï¼Œé‡‡ç”¨æƒ°æ€§ç©ºé—´åˆ†é…ç­–ç•¥é¿å…äº†å†…éƒ¨ç¢ç‰‡é€ æˆçš„ç©ºé—´æµªè´¹ã€‚ å°† chunk è®¾ç½®ä¸º 64MB è¿™ä¹ˆå¤§ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªæœ‰ç‚¹ï¼š å®ƒå‡å°‘äº†å®¢æˆ·ç«¯å’Œ master èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡éœ€æ±‚ã€‚å› ä¸ºä¸€æ¬¡ä¸ master èŠ‚ç‚¹é€šä¿¡å³å¯è·å– chunk çš„ä½ç½®ä¿¡æ¯ï¼Œä¹‹åå¯ä»¥å¯¹åŒä¸€ä¸ª chunk è¿›è¡Œå¤šæ¬¡è¯»å†™æ“ä½œã€‚ è¾ƒå¤§çš„ chunkå¤§å°ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿå¯¹åŒä¸€ä¸ª chunk è¿›è¡Œå¤šæ¬¡æ“ä½œï¼Œé€šè¿‡ä¸ chunkserverä¿æŒè¾ƒé•¿æ—¶é—´çš„ TCP è¿æ¥æ¥å‡å°‘ç½‘ç»œè´Ÿè½½ã€‚ è¾ƒå¤§çš„ chunkå¤§å°å‡å°‘äº† master èŠ‚ç‚¹éœ€è¦ä¿å­˜çš„å…ƒæ•°æ®æ•°é‡ï¼Œå…è®¸å°†æ‰€æœ‰å…ƒæ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œä»è€Œæé«˜è®¿é—®é€Ÿåº¦ã€‚ ç„¶è€Œï¼Œè¾ƒå¤§çš„ chunk å¤§å°ä¹Ÿæœ‰ç¼ºç‚¹ã€‚å°æ–‡ä»¶åŒ…å«çš„ chunk è¾ƒå°‘ï¼Œç”šè‡³åªæœ‰ä¸€ä¸ª chunkã€‚å½“å¤šä¸ªå®¢æˆ·ç«¯é¢‘ç¹è®¿é—®åŒä¸€ä¸ªå°æ–‡ä»¶æ—¶ï¼Œå­˜å‚¨è¿™äº› chunk çš„æœåŠ¡å™¨å®¹æ˜“æˆä¸ºçƒ­ç‚¹ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç§æƒ…å†µè¾ƒå°‘å‘ç”Ÿï¼Œå› ä¸ºç¨‹åºé€šå¸¸æ˜¯è¿ç»­è¯»å–åŒ…å«å¤šä¸ª chunk çš„å¤§æ–‡ä»¶ã€‚ ä½†å°†GFSåº”ç”¨äºæ‰¹å¤„ç†é˜Ÿåˆ—ç³»ç»Ÿä¸­ï¼Œçƒ­ç‚¹é—®é¢˜æ›¾ç»å‡ºç°è¿‡ï¼šä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¿å­˜åœ¨ä¸€ä¸ªå•ä¸€ chunk ä¸­ï¼Œå½“æ•°ç™¾å°æœºå™¨åŒæ—¶å¯åŠ¨è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œå­˜å‚¨è¿™ä¸ª chunk çš„æœåŠ¡å™¨å› å¹¶å‘è¯·æ±‚å¯¼è‡´ç³»ç»Ÿå±€éƒ¨è¿‡è½½ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒGFSé€šè¿‡å¢åŠ å¯æ‰§è¡Œæ–‡ä»¶çš„å¤åˆ¶å‚æ•°å’Œé”™å¼€ç¨‹åºå¯åŠ¨æ—¶é—´æ¥ç¼“è§£ã€‚æ­¤å¤–ï¼Œä¸€ä¸ªé•¿æ•ˆè§£å†³æ–¹æ¡ˆæ˜¯å…è®¸å®¢æˆ·ç«¯åœ¨è¿™ç§æƒ…å†µä¸‹ä»å…¶ä»–å®¢æˆ·ç«¯è¯»å–æ•°æ®ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:5","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.6 å…ƒæ•°æ® master ä¸­ä¸»è¦å­˜å‚¨ä¸‰ç§ç±»å‹çš„å…ƒæ•°æ®ï¼š æ–‡ä»¶å’Œ chunk çš„å‘½åç©ºé—´ï¼› æ–‡ä»¶å’Œ chunk çš„æ˜ å°„ï¼› æ¯ä¸ª chunk çš„å‰¯æœ¬çš„ä½ç½®ã€‚ æ‰€æœ‰çš„å…ƒæ•°æ®éƒ½å­˜å‚¨åœ¨ master çš„å†…å­˜é‡Œã€‚å‰ä¸¤ç§ç±»å‹ä¹Ÿä¼šé€šè¿‡åœ¨æ“ä½œæ—¥å¿—(operation log)ä¸Šè®°å½•ä¿®æ”¹æ¥æŒä¹…åŒ–ï¼Œæ“ä½œæ—¥å¿—æ–‡ä»¶å­˜å‚¨åœ¨ master çš„æœ¬åœ°ç£ç›˜ä¸Šï¼ŒåŒæ—¶æ—¥å¿—ä¼šè¢«å¤åˆ¶åˆ°å…¶å®ƒçš„è¿œç¨‹masteræœåŠ¡å™¨ä¸Šã€‚ä½¿ç”¨æ—¥å¿—ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿç®€å•å¯é çš„æ›´æ–° master çš„çŠ¶æ€ï¼Œï¼Œè€Œä¸ç”¨æ‹…å¿ƒ master å´©æºƒå¯¼è‡´çš„ä¸ä¸€è‡´æ€§çš„é£é™©ã€‚master ä¸ä¼šæŒä¹…çš„å­˜å‚¨ chunk ä½ç½®ä¿¡æ¯ï¼Œè€Œæ˜¯ä¼šåœ¨ master å¯åŠ¨æ—¶æˆ–ä¸€ä¸ª chunkserveråŠ å…¥é›†ç¾¤æ—¶å‘ chunkserverè½®è¯¢å…¶ chunk ä¿¡æ¯ã€‚ 2.6.1 å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ GFS çš„è®¾è®¡å°†æ‰€æœ‰å…ƒæ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä½¿ master çš„æ“ä½œé€Ÿåº¦éå¸¸å¿«ã€‚è¿™ç§è®¾è®¡å…è®¸ master åœ¨åå°ç®€å•è€Œé«˜æ•ˆåœ°å‘¨æœŸæ€§æ‰«ææ‰€æœ‰çŠ¶æ€ä¿¡æ¯ï¼Œå®ç°å¦‚ chunk åƒåœ¾æ”¶é›†ã€åœ¨ chunkserverå¤±æ•ˆçš„æ—¶é‡æ–°å¤åˆ¶æ•°æ®ã€é€šè¿‡ chunk çš„è¿ç§»å®ç°è·¨ chunkserverçš„è´Ÿè½½å‡è¡¡ä»¥åŠç£ç›˜ä½¿ç”¨çŠ¶å†µç»Ÿè®¡ç­‰åŠŸèƒ½ã€‚ è™½ç„¶å°†å…ƒæ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ä¼šä½¿ chunk çš„æ•°é‡å’Œç³»ç»Ÿçš„æ‰¿è½½èƒ½åŠ›å—é™äº master çš„å†…å­˜å¤§å°ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™å¹¶ä¸æ˜¯ä¸¥é‡é—®é¢˜ã€‚å…·ä½“è€Œè¨€ï¼Œmaster ç®¡ç†æ¯ä¸ª 64MB çš„ chunk åªéœ€ä¸åˆ° 64å­—èŠ‚çš„å…ƒæ•°æ®ã€‚ç”±äºå¤§å¤šæ•°æ–‡ä»¶åŒ…å«å¤šä¸ª chunkï¼Œç»å¤§å¤šæ•°chunk éƒ½æ˜¯æ»¡çš„ï¼Œåªæœ‰æœ€åä¸€ä¸ª chunk å¯èƒ½éƒ¨åˆ†å¡«å……ã€‚åŒæ ·ï¼Œæ¯ä¸ªæ–‡ä»¶åœ¨å‘½åç©ºé—´ä¸­çš„æ•°æ®å¤§å°é€šå¸¸åœ¨ 64 å­—èŠ‚ä»¥ä¸‹ï¼Œå› ä¸ºæ–‡ä»¶åç»è¿‡å‰ç¼€å‹ç¼©ã€‚ å³ä¾¿éœ€è¦æ”¯æŒæ›´å¤§çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¢åŠ  master çš„å†…å­˜æˆæœ¬ä¹Ÿç›¸å¯¹è¾ƒä½ã€‚é€šè¿‡å¢åŠ å°‘é‡å†…å­˜ï¼Œå¯ä»¥ä½¿å…ƒæ•°æ®å…¨éƒ¨ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä»è€Œå¢å¼ºç³»ç»Ÿçš„ç®€æ´æ€§ã€å¯é æ€§ã€é«˜æ€§èƒ½å’Œçµæ´»æ€§ã€‚ 2.6.2 chunkä½ç½®ä¿¡æ¯ master ä¸æŒä¹…åŒ–å­˜å‚¨å“ªä¸ª chunkserveråŒ…å«æŒ‡å®š chunk å‰¯æœ¬çš„ä¿¡æ¯ï¼Œmaster åªæ˜¯åœ¨å¯åŠ¨æ—¶ä¼šè½®è¯¢ chunkserverä»¥è·å–è¿™äº›ä¿¡æ¯ï¼Œå¹¶é€šè¿‡æ§åˆ¶ chunk ä½ç½®åˆ†é…å’Œå®šæœŸçš„å¿ƒè·³ä¿¡æ¯ç›‘æ§chunkæœåŠ¡å™¨çŠ¶æ€ä¿æŒæœ€æ–°ã€‚ Googleèµ·åˆå°è¯•å°† chunk ä½ç½®ä¿¡æ¯æŒä¹…åŒ–ä¿å­˜åœ¨ master ä¸Šï¼Œä½†å‘ç°å¯åŠ¨æ—¶è½®è¯¢ chunkserverå¹¶å®šæœŸæ›´æ–°æ›´ä¸ºç®€ä¾¿ã€‚è¿™ç§è®¾è®¡ç®€åŒ–äº†åœ¨ chunkserveråŠ å…¥ã€ç¦»å¼€ã€æ›´åã€æ•…éšœå’Œé‡å¯æ—¶çš„æ•°æ®åŒæ­¥é—®é¢˜ï¼Œé€‚åº”äº†å¤§è§„æ¨¡é›†ç¾¤ä¸­é¢‘ç¹å‘ç”Ÿçš„äº‹ä»¶ã€‚ è¿™ä¸ªè®¾è®¡çš„å¦ä¸€ä¸ªç†è§£æ€è·¯ï¼šåªæœ‰ chunkserveræ‰èƒ½æœ€ç»ˆç¡®å®šä¸€ä¸ª chunk æ˜¯å¦åœ¨å…¶ç¡¬ç›˜ä¸Šã€‚åœ¨ master ä¸Šç»´æŠ¤å…¨å±€è§†å›¾æ˜¯ä¸ç°å®çš„ï¼Œå› ä¸º chunkserverçš„é”™è¯¯å¯èƒ½å¯¼è‡´ chunk è‡ªåŠ¨æ¶ˆå¤±ï¼Œæˆ–è€…æ“ä½œäººå‘˜å¯èƒ½é‡å‘½å chunkserverã€‚è¿™ç§æ–¹æ³•ç¡®ä¿äº†ç³»ç»Ÿçš„ç®€æ´æ€§å’Œå¯é æ€§ã€‚ 2.6.3 æ“ä½œæ—¥å¿— æ“ä½œæ—¥å¿—åŒ…å«å…³é”®çš„å…ƒæ•°æ®å˜æ›´å†å²è®°å½•ï¼Œæ˜¯å…ƒæ•°æ®å”¯ä¸€çš„æŒä¹…åŒ–å­˜å‚¨å’Œåˆ¤æ–­åŒæ­¥æ“ä½œé¡ºåºçš„é€»è¾‘æ—¶é—´åŸºçº¿ã€‚æ¯ä¸ªæ–‡ä»¶å’Œ chunkï¼Œè¿˜æœ‰å®ƒä»¬çš„ç‰ˆæœ¬ï¼Œ éƒ½ç”±å®ƒä»¬åˆ›å»ºçš„é€»è¾‘æ—¶é—´å”¯ä¸€çš„ã€æ°¸ä¹…çš„æ ‡è¯†ã€‚ æ—¥å¿—æ–‡ä»¶å¿…é¡»ç¡®ä¿å®Œæ•´æ€§ã€‚åªæœ‰åœ¨å…ƒæ•°æ®å˜æ›´è¢«æŒä¹…åŒ–åï¼Œæ—¥å¿—æ‰å¯¹å®¢æˆ·ç«¯å¯è§ï¼Œä»¥é˜²æ­¢ä¸¢å¤±æ–‡ä»¶ç³»ç»Ÿæˆ–æœ€è¿‘çš„å®¢æˆ·ç«¯æ“ä½œã€‚ä¸ºæ­¤ï¼Œæ—¥å¿—ä¼šè¢«å¤åˆ¶åˆ°å¤šå°è¿œç¨‹æœºå™¨ï¼Œåªæœ‰åœ¨æœ¬åœ°å’Œè¿œç¨‹æœºå™¨éƒ½å†™å…¥æ—¥å¿—åï¼Œmaster æ‰å“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚master ä¼šæ”¶é›†å¤šä¸ªæ—¥å¿—è®°å½•åæ‰¹é‡å¤„ç†ï¼Œä»¥å‡å°‘å†™å…¥å’Œå¤åˆ¶å¯¹ç³»ç»Ÿæ€§èƒ½çš„å½±å“ã€‚ åœ¨ç¾éš¾æ¢å¤æ—¶ï¼Œmaster é€šè¿‡é‡æ¼”æ“ä½œæ—¥å¿—æ¢å¤æ–‡ä»¶ç³»ç»Ÿã€‚ä¸ºäº†ç¼©çŸ­å¯åŠ¨æ—¶é—´ï¼Œæ—¥å¿—å¿…é¡»è¶³å¤Ÿå°ã€‚å½“æ—¥å¿—å¢é•¿åˆ°ä¸€å®šé‡æ—¶ï¼Œmaster ä¼šè¿›è¡Œ checkpointï¼Œå°†æ‰€æœ‰çŠ¶æ€æ•°æ®å†™å…¥ checkpoint æ–‡ä»¶ã€‚æ¢å¤æ—¶ï¼Œmasterè¯»å– Checkpoint æ–‡ä»¶å¹¶é‡æ¼”ä¹‹åçš„æ—¥å¿—æ–‡ä»¶å³å¯ã€‚Checkpoint æ–‡ä»¶ä»¥å‹ç¼© B-æ ‘å½¢å¼å­˜å‚¨ï¼Œå¯ä»¥ç›´æ¥æ˜ å°„åˆ°å†…å­˜ï¼Œåœ¨ç”¨äºå‘½åç©ºé—´æŸ¥è¯¢æ—¶æ— éœ€é¢å¤–çš„è§£æï¼Œæé«˜äº†æ¢å¤é€Ÿåº¦å’Œç³»ç»Ÿå¯ç”¨æ€§ã€‚ åˆ›å»º Checkpoint æ–‡ä»¶æ—¶ï¼Œmaster ç¡®ä¿ä¸ä¼šé˜»å¡æ­£åœ¨è¿›è¡Œçš„æ“ä½œï¼Œé€šè¿‡ç‹¬ç«‹çº¿ç¨‹åˆ‡æ¢åˆ°æ–°çš„æ—¥å¿—æ–‡ä»¶å’Œåˆ›å»ºæ–°çš„ Checkpoint æ–‡ä»¶ã€‚ç”Ÿæˆä¸€ä¸ª Checkpoint æ–‡ä»¶å¤§çº¦éœ€è¦ä¸€åˆ†é’Ÿï¼Œå®ŒæˆåCheckpointä¼šè¢«å†™å…¥æœ¬åœ°å’Œè¿œç¨‹ç¡¬ç›˜ã€‚ master æ¢å¤ä»…éœ€æœ€æ–°çš„ Checkpoint æ–‡ä»¶å’Œåç»­æ—¥å¿—æ–‡ä»¶ã€‚è™½ç„¶æ—§çš„ Checkpoint æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶å¯ä»¥åˆ é™¤ï¼Œä½†é€šå¸¸ä¼šä¿ç•™ä¸€äº›å†å²æ–‡ä»¶ä»¥åº”å¯¹ç¾éš¾æ€§æ•…éšœã€‚Checkpoint å¤±è´¥ä¸ä¼šå¯¹æ­£ç¡®æ€§äº§ç”Ÿä»»ä½•å½±å“ï¼Œå› ä¸ºæ¢å¤åŠŸèƒ½çš„ä»£ç å¯ä»¥æ£€æµ‹å¹¶è·³è¿‡æ²¡æœ‰å®Œæˆçš„ Checkpoint æ–‡ä»¶ï¼ˆä½¿ç”¨å‰ä¸€ä¸ªå®Œæ•´çš„ Checkpoint æ–‡ä»¶å’Œä¹‹åçš„æ“ä½œæ—¥å¿—æ¥æ¢å¤ç³»ç»Ÿï¼‰ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:6","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"2.7 ä¸€è‡´æ€§æ¨¡å‹ GFS æœ‰ä¸€ä¸ªå®½æ¾çš„ä¸€è‡´æ€§æ¨¡å‹ï¼Œå¾ˆå¥½åœ°æ”¯æŒæˆ‘ä»¬çš„é«˜åº¦åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯å®ç°èµ·æ¥ä¾ç„¶ç®€å•ä¸”é«˜æ•ˆã€‚ æˆ‘ä»¬ç°åœ¨è®¨è®º GFS å¦‚ä½•ä¿è¯ä¸€è‡´æ€§ï¼Œä»¥åŠè¿™å¯¹åº”ç”¨ç¨‹åºæ¥è¯´æœ‰ä½•æ„ä¹‰ã€‚æˆ‘ä»¬ä¹Ÿä¼šå¼ºè°ƒ GFS å¦‚ä½•ç»´æŠ¤è¿™äº›ä¿è¯ï¼Œä½†æ˜¯æ›´è¯¦ç»†çš„å†…å®¹å°†åœ¨æœ¬æ–‡çš„å…¶ä»–éƒ¨åˆ†æ¥è¯´ã€‚ 2.7.1 GFSä¸€è‡´æ€§ä¿éšœæœºåˆ¶ æ–‡ä»¶å‘½åç©ºé—´çš„ä¿®æ”¹ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶åˆ›å»ºï¼‰æ˜¯åŸå­æ€§çš„ï¼Œä¸”ä»…ç”± master æ§åˆ¶ã€‚å‘½åç©ºé—´é”ä¿è¯äº†æ“ä½œçš„åŸå­æ€§å’Œæ­£ç¡®æ€§ï¼ˆè¯¦è§4.1ï¼‰ï¼Œè€Œæ“ä½œæ—¥å¿—å®šä¹‰äº†è¿™äº›æ“ä½œçš„å…¨å±€é¡ºåºï¼ˆè¯¦è§2.6.3ï¼‰ã€‚ æ•°æ®ä¿®æ”¹åçš„æ–‡ä»¶åŒºåŸŸçŠ¶æ€å–å†³äºæ“ä½œç±»å‹ã€æˆåŠŸä¸å¦ä»¥åŠæ˜¯å¦åŒæ­¥ä¿®æ”¹ã€‚ä¸‹è¡¨æ€»ç»“äº†å„ç§æ“ä½œçš„ç»“æœã€‚ å¦‚æœæ‰€æœ‰å®¢æˆ·ç«¯ï¼Œæ— è®ºä»å“ªä¸ªå‰¯æœ¬è¯»å–ï¼Œè¯»åˆ°çš„æ•°æ®éƒ½ä¸€æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºæ–‡ä»¶åŒºåŸŸæ˜¯consistentï¼› å¦‚æœå¯¹æ–‡ä»¶çš„æ•°æ®ä¿®æ”¹ä¹‹åï¼Œæ–‡ä»¶åŒºåŸŸæ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯èƒ½å¤Ÿçœ‹åˆ°å†™å…¥æ“ä½œå…¨éƒ¨çš„å†…å®¹ï¼Œé‚£ä¹ˆè¿™ä¸ª region æ˜¯definedã€‚ å…¶ä¸­ï¼Œå¯¹äºä¸€ä¸ªæ–‡ä»¶åŒºåŸŸï¼Œåªè¦æ‰€æœ‰å®¢æˆ·ç«¯çœ‹åˆ°çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£è¿™ä¸ªåŒºåŸŸå°±æ˜¯ consistent çš„ã€‚åœ¨ consistent çš„å‰æä¸‹ï¼Œå¦‚æœæ‰€æœ‰ä¿®æ”¹éƒ½å·²ç»è¢«å†™å…¥ï¼Œå°±æ˜¯ defined çš„ã€‚consistent æ˜¯ defined çš„å­é›†ã€‚å³ defined çš„ä¸€å®šæ˜¯ consistent çš„ï¼Œä½† consistent çš„ä¸ä¸€å®šæ˜¯ defined çš„ã€‚ å½“ä¸€ä¸ªæ•°æ®ä¿®æ”¹æ“ä½œæˆåŠŸæ‰§è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰å—åˆ°åŒæ—¶æ‰§è¡Œçš„å…¶å®ƒå†™å…¥æ“ä½œçš„å¹²æ‰°ï¼ˆå³ä¸²è¡Œä¿®æ”¹ï¼‰ï¼Œé‚£ä¹ˆå—å½±å“çš„åŒºåŸŸå°±æ˜¯ definedï¼ˆéšå«äº† consistent ï¼‰ï¼šæ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥çœ‹åˆ°å†™å…¥çš„å†…å®¹ã€‚ å½“å¤šä¸ªå¹¶è¡Œä¿®æ”¹æ“ä½œæˆåŠŸå®Œæˆåï¼Œæ–‡ä»¶åŒºåŸŸå¤„äºconsistentä½†undefinedçš„çŠ¶æ€ï¼šå³æ‰€æœ‰çš„å®¢æˆ·ç«¯çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€æ ·çš„ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€æ¯ä¸ªä¿®æ”¹éƒ½å·²ç»è¢«å†™å…¥ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå†™å…¥çš„å†…å®¹ç”±å¤šä¸ªä¿®æ”¹çš„æ··åˆç‰‡æ®µç»„æˆã€‚ å¤±è´¥çš„ä¿®æ”¹æ“ä½œå¯¼è‡´æ–‡ä»¶åŒºåŸŸinconsistent (å› æ­¤ä¹Ÿæ˜¯ undefined )ï¼šä¸åŒå®¢æˆ·ç«¯åœ¨ä¸åŒæ—¶é—´çœ‹åˆ°çš„æ•°æ®ä¸åŒã€‚åé¢æˆ‘ä»¬å°†æè¿°åº”ç”¨å¦‚ä½•åŒºåˆ† defined å’Œ undefined çš„åŒºåŸŸã€‚åº”ç”¨ç¨‹åºæ²¡æœ‰å¿…è¦å†å»ç»†åˆ† undefined åŒºåŸŸçš„ä¸åŒç±»å‹ã€‚ æ•°æ®ä¿®æ”¹æ“ä½œåˆ†ä¸ºå†™å…¥æˆ–è€…è®°å½•è¿½åŠ ä¸¤ç§ï¼š å†™å…¥æ“ä½œï¼šæ•°æ®å†™åœ¨åº”ç”¨ç¨‹åºæŒ‡å®šçš„æ–‡ä»¶åç§»ä½ç½®ä¸Šã€‚ è®°å½•è¿½åŠ æ“ä½œï¼šæ•°æ®ï¼ˆè®°å½•ï¼‰åŸå­æ€§è¿½åŠ åˆ°æ–‡ä»¶ä¸­è‡³å°‘ä¸€æ¬¡ï¼ˆå³ä½¿æ˜¯å¹¶å‘ä¿®æ”¹ï¼‰ï¼Œä½†åç§»ä½ç½®ç”± GFS é€‰æ‹©ï¼ˆ3.3ï¼‰ã€‚ ä½œä¸ºå¯¹æ¯”ï¼Œä¸€ä¸ªæ™®é€šçš„è¿½åŠ æ“ä½œä»…ä»…æ˜¯ä¸€ä¸ªåœ¨å®¢æˆ·ç«¯è®¤ä¸ºæ˜¯å½“å‰æ–‡ä»¶æœ«å°¾çš„åç§»å¤„çš„å†™å…¥æ“ä½œã€‚GFS è¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ªåç§»é‡ï¼Œè¡¨ç¤ºåŒ…å«å†™å…¥è®°å½•çš„ defined åŒºåŸŸçš„èµ·ç‚¹ã€‚å¦å¤–ï¼ŒGFS å¯èƒ½ä¼šåœ¨æ–‡ä»¶ä¸­é—´æ’å…¥å¡«å……æ•°æ®æˆ–è€…é‡å¤è®°å½•ã€‚è¿™äº›æ•°æ®å æ®çš„æ–‡ä»¶åŒºåŸŸè¢«è®¤å®šæ˜¯ inconsistentï¼ˆå³ä¸Šè¡¨ ä¸­çš„ defined interspersed with inconsistentï¼Œå³ defined åŒºåŸŸä¸­ç©¿æ’äº† inconsistent åŒºåŸŸï¼Œä½†è¿™äº›åŒºåŸŸä¸ä¼šå½±å“è¯»å–æ•°æ®çš„ç»“æœï¼Œå› ä¸ºä¼šè¢«è¿‡æ»¤æ‰ï¼‰ï¼Œ è¿™äº›æ•°æ®é€šå¸¸æ¯”ç”¨æˆ·æ•°æ®å°çš„å¤šã€‚ ç»è¿‡ä¸€ç³»åˆ—æˆåŠŸçš„ä¿®æ”¹æ“ä½œåï¼ŒGFS ç¡®ä¿è¢«ä¿®æ”¹çš„æ–‡ä»¶åŒºåŸŸæ˜¯definedçš„ï¼Œå¹¶åŒ…å«æœ€åä¸€æ¬¡ä¿®æ”¹æ“ä½œå†™å…¥çš„æ•°æ®ã€‚GFS é€šè¿‡ä»¥ä¸‹æªæ–½ç¡®ä¿è¿™ä¸€ç‚¹ï¼š å¯¹chunkçš„æ‰€æœ‰å‰¯æœ¬çš„ä¿®æ”¹æ“ä½œé¡ºåºä¸€è‡´ã€‚ ä½¿ç”¨ chunk ç‰ˆæœ¬å·æ£€æµ‹å‰¯æœ¬æ˜¯å¦å› å…¶æ‰€åœ¨çš„ chunkserverå®•æœºè€Œé”™è¿‡äº†ä¿®æ”¹æ“ä½œå¯¼è‡´å¤±æ•ˆã€‚å¤±æ•ˆçš„å‰¯æœ¬ä¸å†è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œmaster ä¹Ÿä¸ä¼šè¿”å›è¯¥å‰¯æœ¬çš„ä½ç½®ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œå¤±æ•ˆå‰¯æœ¬ä¼šè¢«åƒåœ¾æ”¶é›†ç³»ç»Ÿå°½å¿«å›æ”¶ã€‚ ç”±äº chunk ä½ç½®ä¿¡æ¯ä¼šè¢«å®¢æˆ·ç«¯ç¼“å­˜ï¼Œåœ¨ä¿¡æ¯åˆ·æ–°å‰ï¼Œå®¢æˆ·ç«¯å¯èƒ½ä»å¤±æ•ˆçš„å‰¯æœ¬è¯»å–æ•°æ®ã€‚åªæœ‰å½“ç¼“å­˜æ¡ç›®è¶…æ—¶ï¼Œæˆ–æ–‡ä»¶è¢«é‡æ–°æ‰“å¼€æ—¶ï¼Œè¿™ä¸ªé—®é¢˜æ‰èƒ½è§£å†³ï¼Œå› ä¸ºæ¡ç›®è¶…æ—¶æˆ–é‡æ–°æ‰“å¼€æ–‡ä»¶ä¼šæ¸…é™¤å®¢æˆ·ç«¯ç¼“å­˜ä¸­çš„æ‰€æœ‰è·Ÿè¿™ä¸ªæ–‡ä»¶æœ‰å…³çš„ chunk ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œå¤§å¤šæ•°æ–‡ä»¶åªè¿›è¡Œè¿½åŠ æ“ä½œï¼Œå› æ­¤å¤±æ•ˆå‰¯æœ¬é€šå¸¸è¿”å›ä¸€ä¸ªæå‰ç»“æŸçš„ chunk è€Œä¸æ˜¯è¿‡æœŸçš„æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ®è¿˜æ˜¯æœ‰æ•ˆçš„æ•°æ®ï¼Œåªæ˜¯è¿”å›çš„åç§»ä½ç½®ä¸å¯¹ï¼‰ã€‚å½“ Reader ç¨‹åº é‡æ–°å°è¯•è”ç»œ master æ—¶ï¼Œä¼šç«‹åˆ»å¾—åˆ°æœ€æ–°çš„ chunk ä½ç½®ä¿¡æ¯ã€‚ å³ä½¿ä¿®æ”¹æ“ä½œæˆåŠŸæ‰§è¡Œåå¾ˆé•¿æ—¶é—´ï¼Œç»„ä»¶æ•…éšœä»å¯èƒ½æŸåæˆ–åˆ é™¤æ•°æ®ã€‚GFS é€šè¿‡ master å’Œæ‰€æœ‰ chunkserverçš„å®šæœŸâ€œæ¡æ‰‹â€æ‰¾åˆ°å¤±æ•ˆçš„ chunkserverï¼Œå¹¶ä½¿ç”¨æ ¡éªŒå’Œæ£€æµ‹æ•°æ®æ˜¯å¦æŸåã€‚ä¸€æ—¦å‘ç°é—®é¢˜ï¼Œæ•°æ®å°†å°½å¿«åˆ©ç”¨æœ‰æ•ˆå‰¯æœ¬è¿›è¡Œæ¢å¤ã€‚åªæœ‰å½“ä¸€ä¸ª chunk çš„æ‰€æœ‰å‰¯æœ¬åœ¨ GFS æ£€æµ‹åˆ°é”™è¯¯å¹¶é‡‡å–åº”å¯¹æªæ–½ä¹‹å‰å…¨éƒ¨ä¸¢å¤±ï¼Œchunk æ‰ä¼šä¸å¯é€†è½¬åœ°ä¸¢å¤±ã€‚é€šå¸¸ï¼ŒGFS çš„ååº”æ—¶é—´ï¼ˆmaster èŠ‚ç‚¹æ£€æµ‹åˆ°é”™è¯¯å¹¶é‡‡å–åº”å¯¹æªæ–½ï¼‰ä¸ºå‡ åˆ†é’Ÿã€‚å³ä¾¿å¦‚æ­¤ï¼Œchunk ä¹Ÿåªæ˜¯ä¸å¯ç”¨è€ŒéæŸåï¼Œåº”ç”¨ç¨‹åºä¼šæ”¶åˆ°æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯è€ŒéæŸåçš„æ•°æ®ã€‚ 2.7.2 å¯¹åº”ç”¨ç¨‹åºçš„å½±å“ ä½¿ç”¨ GFS çš„åº”ç”¨ç¨‹åºå¯ä»¥åˆ©ç”¨ä¸€äº›ç®€å•çš„æŠ€æœ¯æ¥å®ç°å®½æ¾çš„ä¸€è‡´æ€§æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥å®ç°å…¶ä»–ç›®æ ‡åŠŸèƒ½ï¼ŒåŒ…æ‹¬å°½é‡é‡‡ç”¨è¿½åŠ å†™å…¥è€Œä¸æ˜¯è¦†ç›–ã€Checkpointã€å†™å…¥è‡ªéªŒè¯å’Œè‡ªè¯†åˆ«çš„è®°å½•ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„åº”ç”¨ç¨‹åºå¯¹æ–‡ä»¶çš„å†™å…¥æ“ä½œéƒ½å°½é‡é‡‡ç”¨è¿½åŠ æ–¹å¼è€Œä¸æ˜¯è¦†ç›–æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºä»å¤´åˆ°å°¾å†™å…¥æ•°æ®ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œå†™å…¥å®Œæˆåè‡ªåŠ¨å°†æ–‡ä»¶æ”¹åä¸ºä¸€ä¸ªæ°¸ä¹…æ–‡ä»¶åï¼Œæˆ–è€…å®šæœŸè¿›è¡Œ Checkpointï¼Œè®°å½•æˆåŠŸå†™å…¥çš„æ•°æ®é‡ã€‚Checkpoint æ–‡ä»¶å¯ä»¥åŒ…å«ç¨‹åºçº§åˆ«çš„æ ¡éªŒå’Œã€‚Readers ä»…æ ¡éªŒå¹¶å¤„ç†ä¸Šä¸ª Checkpoint ä¹‹åçš„æ–‡ä»¶åŒºåŸŸï¼Œè¿™äº›åŒºåŸŸçš„çŠ¶æ€æ˜¯definedçš„ã€‚è¿™ç§æ–¹æ³•æ»¡è¶³äº†æˆ‘ä»¬çš„ä¸€è‡´æ€§å’Œå¹¶å‘å¤„ç†éœ€æ±‚ã€‚è¿½åŠ å†™å…¥æ¯”éšæœºå†™å…¥æ›´åŠ é«˜æ•ˆï¼Œå¯¹åº”ç”¨ç¨‹åºçš„å¤±è´¥å¤„ç†æ›´å…·å¼¹æ€§ã€‚Checkpoint å…è®¸ Writer ä»¥æ¸è¿›æ–¹å¼é‡æ–°å¼€å§‹ï¼Œå¹¶é˜²æ­¢ Reader å¤„ç†å·²æˆåŠŸå†™å…¥ä½†ä»åº”ç”¨ç¨‹åºçš„è§’åº¦æ¥çœ‹æœªå®Œæˆçš„æ•°æ®ã€‚ å¦ä¸€ä¸ªå…¸å‹çš„åº”ç”¨åœºæ™¯æ˜¯ï¼Œè®¸å¤šåº”ç”¨ç¨‹åºå¹¶è¡Œè¿½åŠ æ•°æ®åˆ°åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚è¿›è¡Œç»“æœåˆå¹¶æˆ–è€…æ˜¯ä¸€ä¸ªç”Ÿäº§è€…-æ¶ˆè´¹è€…é˜Ÿåˆ—ã€‚è®°å½•è¿½åŠ æ–¹å¼çš„â€œè‡³å°‘ä¸€æ¬¡è¿½åŠ â€ç‰¹æ€§ä¿è¯äº† Writer çš„è¾“å‡ºã€‚Readers å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•å¤„ç†å¶ç„¶æ€§çš„å¡«å……æ•°æ®å’Œé‡å¤å†…å®¹ï¼šWriters åœ¨æ¯æ¡å†™å…¥è®°å½•ä¸­åŒ…å«é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚ Checksumï¼Œç”¨æ¥éªŒè¯æœ‰æ•ˆæ€§ã€‚Reader å¯ä»¥åˆ©ç”¨ Checksum è¯†åˆ«å¹¶ä¸¢å¼ƒé¢å¤–çš„å¡«å……æ•°æ®å’Œè®°å½•ç‰‡æ®µã€‚å¦‚æœåº”ç”¨ä¸èƒ½å®¹å¿å¶å°”çš„é‡å¤å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨è®°å½•çš„å”¯ä¸€æ ‡è¯†ç¬¦æ¥è¿‡æ»¤é‡å¤æ•°æ®ï¼Œè¿™äº›å”¯ä¸€æ ‡è¯†ç¬¦é€šå¸¸ç”¨äºå‘½åç¨‹åºä¸­å¤„ç†çš„å®ä½“å¯¹è±¡ï¼Œå¦‚ web æ–‡æ¡£ã€‚è¿™äº›è®°å½• I/O åŠŸèƒ½éƒ½åŒ…å«åœ¨æˆ‘ä»¬å…±äº«çš„ç¨‹åºåº“ä¸­ï¼Œå¹¶é€‚ç”¨äº Google å†…éƒ¨çš„å…¶ä»–æ–‡ä»¶æ¥å£å®ç°ã€‚è¿™æ ·ï¼Œç›¸åŒåºåˆ—çš„è®°å½•ï¼ŒåŠ ä¸Šå¶å°”å‡ºç°çš„é‡å¤æ•°æ®ï¼Œéƒ½èƒ½æ­£ç¡®åˆ†å‘ç»™ Readerã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:2:7","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3 ç³»ç»Ÿäº¤äº’ Google è®¾è®¡ GFS ç³»ç»Ÿä¸€ä¸ªé‡è¦çš„åŸåˆ™æ˜¯æœ€å°åŒ–æ‰€æœ‰æ“ä½œå’Œ master çš„äº¤äº’ï¼ˆå› ä¸º master åªæœ‰ä¸€ä¸ªï¼Œå¿…é¡»å‡è½» master çš„å‹åŠ›ï¼‰ã€‚åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬ç°åœ¨æ¥è¯´å®¢æˆ·ç«¯ã€master å’Œ chunkæœåŠ¡å™¨å¦‚ä½•äº’åŠ¨ä»¥å®ç°æ•°æ®ä¿®æ”¹ã€åŸå­è®°å½•è¿½åŠ (append)ï¼Œä»¥åŠå¿«ç…§(snapshot)ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:3:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.1 ç§Ÿçº¦ï¼ˆleaseï¼‰å’Œå˜æ›´é¡ºåº å˜æ›´æ˜¯ä¸€ä¸ªä¼šæ”¹å˜ chunk å†…å®¹æˆ–è€…å…ƒæ•°æ®çš„æ“ä½œï¼ˆå¦‚å†™å…¥æˆ–è®°å½•è¿½åŠ ï¼‰ï¼Œä¼šåœ¨ chunk çš„æ‰€æœ‰å‰¯æœ¬ä¸Šæ‰§è¡Œã€‚ä¸ºäº†ä¿æŒå¤šä¸ªå‰¯æœ¬é—´å˜æ›´é¡ºåºçš„ä¸€è‡´æ€§ï¼ŒGFS é‡‡ç”¨äº†ç§Ÿçº¦ï¼ˆleaseï¼‰æœºåˆ¶ã€‚master èŠ‚ç‚¹ä¸º chunk çš„ä¸€ä¸ªå‰¯æœ¬ï¼ˆä¸» chunkï¼‰å»ºç«‹ç§Ÿçº¦ï¼Œåˆå§‹ç§ŸæœŸä¸º 60 ç§’ã€‚ä¸» chunk å¯¹æ‰€æœ‰æ›´æ”¹æ“ä½œè¿›è¡Œåºåˆ—åŒ–ï¼Œæ‰€æœ‰å‰¯æœ¬éµä»è¿™ä¸ªåºåˆ—è¿›è¡Œä¿®æ”¹ã€‚å› æ­¤ï¼Œä¿®æ”¹æ“ä½œå…¨å±€çš„é¡ºåºé¦–å…ˆç”± master é€‰æ‹©çš„ç§Ÿçº¦çš„é¡ºåºå†³å®šï¼Œç„¶åç”±ç§Ÿçº¦ä¸­ä¸» chunk åˆ†é…çš„åºåˆ—å·å†³å®šã€‚ åªè¦ chunk è¢«ä¿®æ”¹äº†ï¼Œä¸» chunk å°±å¯ä»¥ç”³è¯·æ›´é•¿çš„ç§ŸæœŸï¼Œé€šå¸¸ä¼šå¾—åˆ° master çš„ç¡®è®¤å¹¶æ”¶åˆ°ç§Ÿçº¦å»¶é•¿çš„æ—¶é—´ã€‚ è¿™äº›ç§Ÿçº¦å»¶é•¿è¯·æ±‚å’Œæ‰¹å‡†çš„ä¿¡æ¯é€šå¸¸éƒ½æ˜¯é™„åŠ åœ¨ master å’Œ chunkserverä¹‹é—´çš„å¿ƒè·³æ¶ˆæ¯ä¸­æ¥ä¼ é€’ã€‚æœ‰æ—¶ master ä¼šè¯•å›¾æå‰å–æ¶ˆç§Ÿçº¦ï¼ˆä¾‹å¦‚ï¼Œmaster æƒ³å–æ¶ˆåœ¨ä¸€ä¸ªå·²ç»è¢«æ”¹åçš„æ–‡ä»¶ä¸Šçš„ä¿®æ”¹æ“ä½œï¼‰ã€‚å³ä½¿ master å’Œä¸»chunkå¤±å»è”ç³»ï¼Œå®ƒä»ç„¶å¯ä»¥å®‰å…¨åœ°åœ¨æ—§çš„ç§Ÿçº¦åˆ°æœŸåå’Œå¦å¤–ä¸€ä¸ªchunkå‰¯æœ¬ç­¾è®¢æ–°çš„ç§Ÿçº¦ã€‚ åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åˆ—å‡º å†™å…¥æ“ä½œçš„æ§åˆ¶æµæè¿°äº†è¿™ä¸ªè¿‡ç¨‹ï¼Œå¹¶ä¸”ç”¨æ•°å­—æ ‡è®°äº†æ­¥éª¤é¡ºåºã€‚ å®¢æˆ·ç«¯å‘masterè¯¢é—®å“ªä¸ªchunkæœåŠ¡å™¨æŒæœ‰å½“å‰çš„ç§Ÿçº¦ï¼Œä»¥åŠå…¶ä»–å‰¯æœ¬çš„ä½ç½®ã€‚å¦‚æœæ²¡æœ‰ä¸€ä¸ªchunkæœåŠ¡å™¨æŒæœ‰ç§Ÿçº¦ï¼Œmasteråˆ™ä¼šé€‰æ‹©å…¶ä¸­ä¸€ä¸ªå‰¯æœ¬å»ºç«‹ä¸€ä¸ªç§Ÿçº¦ï¼ˆå›¾ä¸­æ²¡æœ‰æ˜¾ç¤ºæ­¤æ­¥éª¤ï¼‰ï¼› masterå°†ä¸»chunkçš„æ ‡è¯†ç¬¦ä»¥åŠå…¶ä»–å‰¯æœ¬ï¼ˆåˆç§°äºŒçº§å‰¯æœ¬ï¼‰çš„ä½ç½®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ç¼“å­˜è¿™äº›æ•°æ®ä»¥ä¾¿åç»­çš„æ“ä½œã€‚åªæœ‰åœ¨ä¸» chunk ä¸å¯ç”¨ï¼Œæˆ–è€…ä¸» chunk å›å¤ä¿¡æ¯è¡¨æ˜å®ƒå·²ä¸å†æŒæœ‰ç§Ÿçº¦çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯æ‰éœ€è¦é‡æ–°è·Ÿ master è”ç³»ã€‚ å®¢æˆ·ç«¯æŠŠæ•°æ® push ç»™æ‰€æœ‰çš„å‰¯æœ¬ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä»¥ä»»æ„çš„é¡ºåº pushã€‚chunkserveræ¥æ”¶åˆ°æ•°æ®å¹¶ä¿å­˜åœ¨å®ƒçš„å†…éƒ¨ LRU ç¼“å­˜ä¸­ï¼Œä¸€ç›´åˆ°æ•°æ®è¢«ä½¿ç”¨æˆ–è€…è¿‡æœŸäº¤æ¢å‡ºå»ã€‚é€šè¿‡å°†æ•°æ®æµä¸æ§åˆ¶æµè§£è€¦ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºç½‘ç»œæ‹“æ‰‘æƒ…å†µè°ƒåº¦æ˜‚è´µçš„æ•°æ®æµæ¥æé«˜æ€§èƒ½ï¼Œè€Œä¸ç®¡å“ªä¸ª chunkæœåŠ¡å™¨æ˜¯ä¸» chunkã€‚ å½“æ‰€æœ‰çš„å‰¯æœ¬éƒ½ç¡®è®¤æ¥æ”¶åˆ°äº†æ•°æ®ï¼Œå®¢æˆ·ç«¯å‘é€å†™è¯·æ±‚åˆ°ä¸»chunkæœåŠ¡å™¨ã€‚è¿™ä¸ªè¯·æ±‚æ ‡è¯†äº†ä¹‹å‰æ¨é€åˆ°æ‰€æœ‰å‰¯æœ¬çš„æ•°æ®ã€‚ä¸» chunk ä¸ºæ¥æ”¶åˆ°çš„æ‰€æœ‰æ“ä½œåˆ†é…è¿ç»­çš„åºåˆ—å·ï¼Œè¿™äº›æ“ä½œå¯èƒ½æ¥è‡ªä¸åŒçš„å®¢æˆ·ç«¯ï¼Œåºåˆ—å·ä¿è¯äº†æ“ä½œé¡ºåºæ‰§è¡Œã€‚å®ƒä»¥åºåˆ—å·çš„é¡ºåºæŠŠæ“ä½œåº”ç”¨åˆ°å®ƒè‡ªå·±çš„æœ¬åœ°çŠ¶æ€ä¸­ã€‚ ä¸»chunkæŠŠå†™è¯·æ±‚ä¼ é€’åˆ°æ‰€æœ‰çš„äºŒçº§å‰¯æœ¬ã€‚æ¯ä¸ªäºŒçº§å‰¯æœ¬ä¾ç…§ä¸»chunkåˆ†é…çš„åºåˆ—å·ä»¥ç›¸åŒçš„é¡ºåºæ‰§è¡Œè¿™äº›æ“ä½œã€‚ æ‰€æœ‰å®Œæˆäº†æ“ä½œçš„äºŒçº§å‰¯æœ¬å‘ä¸»chunk å›å¤ï¼Œè¡¨æ˜å®ƒä»¬å·²ç»å®Œæˆäº†æ“ä½œã€‚ ä¸» chunk å›å¤å®¢æˆ·ç«¯ã€‚ä»»ä½•å‰¯æœ¬äº§ç”Ÿçš„ä»»ä½•é”™è¯¯éƒ½ä¼šè¿”å›ç»™å®¢æˆ·ç«¯ã€‚åœ¨å‡ºç°é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œå†™å…¥æ“ä½œå¯èƒ½åœ¨ä¸»chunkå’Œä¸€äº›äºŒçº§å‰¯æœ¬æ‰§è¡ŒæˆåŠŸï¼ˆå› ä¸ºæ˜¯ä¸»chunk å…ˆæˆåŠŸå®Œæˆä¿®æ”¹åï¼Œæ‰ä¼šè®©äºŒçº§å‰¯æœ¬å¼€å§‹åº”ç”¨ä¿®æ”¹ï¼Œå¦‚æœä¸» chunk å¤±è´¥äº†ï¼ŒäºŒçº§å‰¯æœ¬å°±ä¸ä¼šæ”¶åˆ°åºåˆ—å·ä»¥åŠåº”ç”¨æ›´æ”¹çš„å‘½ä»¤ï¼‰ã€‚å®¢æˆ·ç«¯çš„è¯·æ±‚è¢«ç¡®è®¤ä¸ºå¤±è´¥ï¼Œè¢«ä¿®æ”¹çš„åŒºåŸŸå¤„äºinconsistentçš„çŠ¶æ€ã€‚æˆ‘ä»¬çš„å®¢æˆ·ç«¯ä»£ç é€šè¿‡é‡å¤æ‰§è¡Œå¤±è´¥çš„æ“ä½œæ¥å¤„ç†è¿™æ ·çš„é”™è¯¯ã€‚åœ¨ä»å¤´å¼€å§‹é‡å¤æ‰§è¡Œä¹‹å‰ï¼Œå®¢æˆ·ç«¯ä¼šå…ˆä»æ­¥éª¤ï¼ˆ3ï¼‰åˆ°æ­¥éª¤ï¼ˆ7ï¼‰ åšå‡ æ¬¡å°è¯•ã€‚ï¼ˆQï¼šå·²ç»å®Œæˆæ“ä½œæˆ–éƒ¨åˆ†å®Œæˆæ“ä½œçš„å‰¯æœ¬ï¼Œæ¥æ”¶åˆ°é‡è¯•çš„æ•°æ®åï¼Œå¦‚ä½•å¤„ç†ï¼ŸAï¼šç›´æ¥åœ¨æ–‡ä»¶æœ«å°¾ï¼ˆæœ€åä¸€ä¸ª chunk æœ«å°¾ï¼‰ç»§ç»­å†™å…¥ï¼Œä¹‹å‰æˆåŠŸçš„äºŒçº§å‰¯æœ¬ä¼šé‡å¤å†™å…¥ï¼Œå»é‡ä»»åŠ¡ç”±è¯»å–æ•°æ®çš„å®¢æˆ·ç«¯æ¥å®Œæˆã€‚ï¼‰ å¦‚æœåº”ç”¨ç¨‹åºä¸€æ¬¡å†™å…¥çš„æ•°æ®é‡å¾ˆå¤§ï¼Œæˆ–è€…æ•°æ®è·¨è¶Šäº†å¤šä¸ª chunkï¼ŒGFS å®¢æˆ·ç«¯ä»£ç ä¼šæŠŠå®ƒä»¬åˆ†æˆå¤šä¸ªå†™æ“ä½œã€‚è¿™äº›æ“ä½œéƒ½éµå¾ªå‰é¢æè¿°çš„æ§åˆ¶æµç¨‹ï¼Œä½†æ˜¯å¯èƒ½ä¼šè¢«å…¶å®ƒå®¢æˆ·ç«¯ä¸ŠåŒæ—¶è¿›è¡Œçš„æ“ä½œæ‰“æ–­æˆ–è€…è¦†ç›–ã€‚ å› æ­¤ï¼Œå…±äº«çš„æ–‡ä»¶åŒºåŸŸçš„å°¾éƒ¨å¯èƒ½åŒ…å«æ¥è‡ªä¸åŒå®¢æˆ·ç«¯çš„æ•°æ®ç‰‡æ®µï¼Œå°½ç®¡å¦‚æ­¤ï¼Œç”±äºè¿™äº›åˆ†è§£åçš„å†™å…¥æ“ä½œåœ¨æ‰€æœ‰çš„å‰¯æœ¬ä¸Šéƒ½ä»¥ç›¸åŒçš„é¡ºåºæ‰§è¡Œå®Œæˆï¼Œchunk çš„æ‰€æœ‰å‰¯æœ¬éƒ½æ˜¯ä¸€è‡´çš„ã€‚è¿™ä½¿æ–‡ä»¶ region å¤„äº 2.7 èŠ‚æè¿° çš„consistentä½†æ˜¯undefinedçš„çŠ¶æ€ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:3:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.2 æ•°æ®æµ ä¸ºäº†æé«˜ç½‘ç»œæ•ˆç‡ï¼ŒGFSé‡‡å–äº†å°†æ•°æ®æµå’Œæ§åˆ¶æµåˆ†å¼€çš„æªæ–½ã€‚åœ¨æ§åˆ¶æµä»å®¢æˆ·ç«¯åˆ°ä¸» chunkå†åˆ°æ‰€æœ‰äºŒçº§å‰¯æœ¬çš„åŒæ—¶ï¼Œæ•°æ®ä»¥ç®¡é“æ–¹å¼é¡ºåºæ²¿ç€ç²¾å¿ƒé€‰æ‹©çš„ chunkserveré“¾æ¨é€ï¼Œå……åˆ†åˆ©ç”¨æ¯å°æœºå™¨çš„å¸¦å®½ï¼Œé¿å…ç½‘ç»œç“¶é¢ˆå’Œé«˜å»¶æ—¶è¿æ¥ï¼Œæœ€å°åŒ–æ•°æ®æ¨é€å»¶æ—¶ã€‚ æ•°æ®é¡ºåºæ²¿ç€ä¸€ä¸ª chunkserveré“¾æ¨é€ï¼Œè€Œä¸æ˜¯åˆ†æ•£æ¨é€ï¼ˆå¦‚æ ‘å‹æ‹“æ‰‘ç»“æ„ï¼‰ï¼Œä»¥å……åˆ†åˆ©ç”¨æ¯å°æœºå™¨çš„å‡ºå£å¸¦å®½ï¼Œå®ç°æœ€å¿«é€Ÿåº¦çš„ä¼ è¾“ï¼Œè€Œä¸åˆ†æ•£å¸¦å®½ã€‚ä¸ºé¿å…ç½‘ç»œç“¶é¢ˆå’Œé«˜å»¶è¿Ÿè¿æ¥ï¼Œæ¯å°æœºå™¨å°½é‡é€‰æ‹©ç½‘ç»œæ‹“æ‰‘ä¸­ç¦»è‡ªå·±æœ€è¿‘ä¸”å°šæœªæ¥æ”¶åˆ°æ•°æ®çš„æœºå™¨ä½œä¸ºç›®æ ‡æ¨é€æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯å°†æ•°æ®æ¨é€åˆ°æœ€è¿‘çš„ chunkserver S1ï¼ŒS1 æ¨é€åˆ° S2ï¼Œä»¥æ­¤ç±»æ¨ï¼ŒåŸºäº IP åœ°å€è®¡ç®—èŠ‚ç‚¹è·ç¦»ã€‚ åˆ©ç”¨åŸºäº TCP è¿æ¥çš„ç®¡é“å¼æ•°æ®æ¨é€æ–¹å¼æœ€å°åŒ–å»¶è¿Ÿã€‚chunkserveræ¥æ”¶åˆ°æ•°æ®åç«‹å³å‘å‰æ¨é€ï¼Œåˆ©ç”¨å…¨åŒå·¥äº¤æ¢ç½‘ç»œçš„ä¼˜åŠ¿ï¼Œä¼ è¾“ä¸ä¼šå‡æ…¢æ¥æ”¶é€Ÿåº¦ã€‚åœ¨æ— ç½‘ç»œæ‹¥å¡æƒ…å†µä¸‹ï¼Œä¼ é€ $B$ å­—èŠ‚çš„æ•°æ®åˆ° $R$ ä¸ªå‰¯æœ¬çš„ç†æƒ³æ—¶é—´ä¸º $\\frac{B}{T} + RL$ï¼ˆ$T$ æ˜¯ç½‘ç»œååé‡ï¼Œ$L$ æ˜¯ä¼ è¾“å»¶è¿Ÿï¼‰ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬çš„ç½‘ç»œè¿æ¥é€Ÿåº¦æ˜¯ 100Mbpsï¼Œä¼ è¾“ 1MB æ•°æ®çš„ç†æƒ³æ—¶é—´çº¦ä¸º 80msã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:3:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.3 åŸå­çš„è®°å½•è¿½åŠ  GFS æä¾›äº†ä¸€ç§åŸå­çš„è®°å½•è¿½åŠ æ“ä½œï¼Œå®¢æˆ·ç«¯åªéœ€æŒ‡å®šè¦å†™å…¥çš„æ•°æ®ï¼ŒGFS ä¿è¯è‡³å°‘ä¸€æ¬¡åŸå­å†™å…¥æˆåŠŸæ‰§è¡Œï¼ˆå³å†™å…¥ä¸€ä¸ªé¡ºåºçš„byteæµï¼‰ï¼Œå†™å…¥æ•°æ®è¿½åŠ åˆ° GFS æŒ‡å®šçš„åç§»ä½ç½®ï¼Œå¹¶è¿”å›è¯¥åç§»é‡ç»™å®¢æˆ·ç«¯ã€‚ç±»ä¼¼äº Unix çš„ O_APPEND æ¨¡å¼ï¼Œå¤šä¸ªå¹¶å‘å†™æ“ä½œæ— ç«æ€æ¡ä»¶ã€‚ è®°å½•è¿½åŠ åœ¨åˆ†å¸ƒå¼åº”ç”¨ä¸­é¢‘ç¹ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šä¸ªå®¢æˆ·ç«¯å¹¶è¡Œè¿½åŠ æ•°æ®çš„æƒ…å†µä¸‹ã€‚ä¼ ç»Ÿå†™å…¥éœ€è¦å¤æ‚çš„åŒæ­¥æœºåˆ¶ï¼Œå¦‚åˆ†å¸ƒå¼é”ç®¡ç†å™¨ï¼Œè€Œè®°å½•è¿½åŠ ç®€åŒ–äº†è¿™ç§éœ€æ±‚ï¼Œå¸¸ç”¨äºç”Ÿäº§è€…/æ¶ˆè´¹è€…é˜Ÿåˆ—ç³»ç»Ÿæˆ–æ•°æ®åˆå¹¶æ–‡ä»¶ã€‚ è®°å½•è¿½åŠ éµå¾ª 3.1 èŠ‚æè¿°çš„æ§åˆ¶æµç¨‹ï¼Œä¸» chunk æœ‰é¢å¤–æ§åˆ¶é€»è¾‘ã€‚å®¢æˆ·ç«¯å°†æ•°æ®æ¨é€åˆ°æœ€åä¸€ä¸ª chunk çš„æ‰€æœ‰å‰¯æœ¬ï¼Œç„¶åå‘é€è¯·æ±‚ç»™ä¸» chunkã€‚ä¸» chunk æ£€æŸ¥æ˜¯å¦è¶…å‡ºæœ€å¤§å¤§å°ï¼ˆ64MBï¼‰ï¼Œå¦‚æœè¶…å‡ºï¼Œåˆ™å¡«å……åˆ°æœ€å¤§å¤§å°å¹¶é€šçŸ¥äºŒçº§å‰¯æœ¬åšåŒæ ·çš„æ“ä½œï¼Œç„¶åå›å¤å®¢æˆ·ç«¯è¦æ±‚å…¶å¯¹ä¸‹ä¸€ä¸ªchunké‡æ–°è¿›è¡Œè®°å½•è¿½åŠ ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸» chunk è¿½åŠ æ•°æ®å¹¶é€šçŸ¥äºŒçº§å‰¯æœ¬å†™å…¥ç›¸åŒä½ç½®ï¼Œæœ€åå›å¤å®¢æˆ·ç«¯æ“ä½œæˆåŠŸã€‚ å¦‚æœè®°å½•è¿½åŠ åœ¨ä»»ä½•å‰¯æœ¬ä¸Šå¤±è´¥ï¼Œå®¢æˆ·ç«¯éœ€è¦é‡æ–°æ“ä½œï¼Œå¯èƒ½å¯¼è‡´åŒä¸€ä¸ªchunkçš„ä¸åŒå‰¯æœ¬åŒ…å«ä¸åŒæ•°æ®ã€‚GFS åªä¿è¯æ•°æ®æ•´ä½“åŸå­æ€§å†™å…¥è‡³å°‘ä¸€æ¬¡ï¼Œè€Œä¸ä¿è¯å­—èŠ‚çº§åˆ«ä¸€è‡´ã€‚æˆåŠŸæ‰§è¡Œæ“ä½œçš„æ•°æ®åŒºåŸŸæ˜¯definedçš„ï¼ˆä¸”consistentçš„ï¼‰ï¼Œå¦åˆ™æ˜¯inconsistentçš„ï¼ˆä¸”undefinedä¹‰çš„ï¼‰ã€‚ç¨‹åºå¯ä»¥å¤„ç†è¿™äº›inconsistentåŒºåŸŸã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:3:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"3.4 å¿«ç…§ å¿«ç…§æ“ä½œåœ¨ GFS ä¸­å‡ ä¹ç¬é—´å®Œæˆï¼Œä¸”ä¸å¹²æ‰°å…¶ä»–æ“ä½œã€‚ç”¨æˆ·å¯ä»¥ç”¨å¿«ç…§å¿«é€Ÿåˆ›å»ºæ•°æ®é›†çš„åˆ†æ”¯æ‹·è´æˆ–åœ¨å®éªŒå‰å¤‡ä»½å½“å‰çŠ¶æ€ï¼Œæ–¹ä¾¿ä¹‹åæäº¤æˆ–å›æ»šã€‚ å°±åƒAFSï¼ˆAndrew File Systemï¼Œä¸€ç§åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼ŒGFS ä½¿ç”¨æ ‡å‡†çš„â€œå†™æ—¶å¤åˆ¶â€ï¼ˆcopy-on-writeï¼‰æŠ€æœ¯å®ç°å¿«ç…§ã€‚å½“ master æ”¶åˆ°å¿«ç…§è¯·æ±‚æ—¶ï¼Œå®ƒä¼šå–æ¶ˆä½œå¿«ç…§çš„æ–‡ä»¶çš„æ‰€æœ‰ chunk çš„ç§Ÿçº¦ï¼Œç¡®ä¿åç»­å†™æ“ä½œå¿…é¡»ä¸ master äº¤äº’ï¼Œä½¿ master æœ‰æœºä¼šå…ˆåˆ›å»º chunk çš„æ–°æ‹·è´ã€‚ ç§Ÿçº¦å–æ¶ˆæˆ–è¿‡æœŸåï¼Œmaster å°†æ“ä½œè®°å½•åˆ°ç¡¬ç›˜æ—¥å¿—ï¼Œå¹¶é€šè¿‡å¤åˆ¶æºæ–‡ä»¶æˆ–ç›®å½•çš„å…ƒæ•°æ®å°†å˜åŒ–åæ˜ åˆ°å†…å­˜ä¸­ã€‚æ–°åˆ›å»ºçš„å¿«ç…§æ–‡ä»¶ä¸æºæ–‡ä»¶å…±äº«ç›¸åŒçš„ chunk åœ°å€ã€‚ å¿«ç…§æ“ä½œåï¼Œå½“å®¢æˆ·ç«¯é¦–æ¬¡å†™å…¥ chunk C æ—¶ï¼Œä¼šå…ˆè¯·æ±‚ master æŸ¥è¯¢å½“å‰ç§Ÿçº¦æŒæœ‰è€…ã€‚master å‘ç° chunk C çš„å¼•ç”¨è®¡æ•°è¶…è¿‡ 1ï¼ˆå†™æ—¶å¤åˆ¶æ–¹æ³•åˆ›å»ºå¿«ç…§æ—¶æ˜¯ç»™è¿™ä¸ªchunkåŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œæ²¡æœ‰ç«‹åˆ»çœŸçš„æ‹·è´ï¼Œä¸€ä¸ª chunk çš„å¼•ç”¨è®¡æ•°å¤§äº 1 çš„è¯å°±ä»£è¡¨è¿™ä¸ª chunk æ˜¯æŸä¸ªå¿«ç…§çš„ä¸€éƒ¨åˆ†ï¼Œè¦ä¿ç•™åŸæ ·æ•°æ®çš„ã€‚å½“è¿™ä¸ª chunk ä¸Šæœ‰æ–°çš„å†™å…¥çš„æ—¶å€™ï¼Œè¿™ä¸ª chunk æ‰ä¼šçœŸçš„è¢«å¤åˆ¶ï¼Œå®¢æˆ·ç«¯åœ¨æ–°å¤åˆ¶çš„ chunk ä¸Šå†™å…¥ï¼Œè€ŒåŸæ¥çš„æ—§ chunk è¢«å¿«ç…§ç»§ç»­å¼•ç”¨ï¼‰ï¼Œä¸ç«‹å³å›å¤å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯é€‰æ‹©æ–°çš„ chunk å¥æŸ„ C'ï¼Œå¹¶è¦æ±‚æ‰€æœ‰æŒæœ‰ chunk C å‰¯æœ¬çš„æœåŠ¡å™¨åˆ›å»º C'ã€‚é€šè¿‡åœ¨æœ¬åœ°åˆ›å»ºæ–°çš„ chunk é¿å…äº†ç½‘ç»œå¤åˆ¶ï¼Œæé«˜äº†æ•ˆç‡ã€‚master ç¡®ä¿æ–° chunk C'çš„ä¸€ä¸ªå‰¯æœ¬æ‹¥æœ‰ç§Ÿçº¦åå›å¤å®¢æˆ·æœºï¼Œå®¢æˆ·æœºå³å¯æ­£å¸¸å†™å…¥è¯¥ chunkã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:3:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4 Masteræ“ä½œ master æ‰§è¡Œæ‰€æœ‰çš„å‘½åç©ºé—´æ“ä½œã€‚æ­¤å¤–ï¼Œå®ƒè¿˜ç®¡ç†ç€æ•´ä¸ªç³»ç»Ÿé‡Œæ‰€æœ‰ Chunk çš„å‰¯æœ¬ï¼š master å†³å®š chunk å‰¯æœ¬çš„å­˜å‚¨ä½ç½®ï¼› åˆ›å»ºæ–°çš„ chunk å’Œå®ƒçš„å‰¯æœ¬ï¼› åè°ƒå„ç§å„æ ·çš„ç³»ç»ŸèŒƒå›´å†…çš„æ´»åŠ¨ä»¥ä¿è¯ chunk è¢«å®Œå…¨æ‹·è´ï¼› åœ¨æ‰€æœ‰çš„ chunkserverä¸Šåšè´Ÿè½½å‡è¡¡ï¼› å›æ”¶ä¸å†ä½¿ç”¨çš„å­˜å‚¨ç©ºé—´ã€‚ ä¸‹é¢æˆ‘ä»¬æ·±å…¥è®¨è®ºä¸‹ä¸Šè¿°çš„å‡ ç‚¹ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:4:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.1 å‘½åç©ºé—´ç®¡ç†å’Œé” åœ¨ GFS ä¸­ï¼Œmaster èŠ‚ç‚¹çš„æ“ä½œå¯èƒ½è€—æ—¶è¾ƒé•¿ï¼Œä¾‹å¦‚å¿«ç…§æ“ä½œéœ€å–æ¶ˆæ‰€æœ‰ç›¸å…³ chunk çš„ç§Ÿçº¦ã€‚ä¸ºé¿å…å»¶ç¼“å…¶ä»–æ“ä½œï¼ŒGFS å…è®¸å¤šä¸ªæ“ä½œåŒæ—¶è¿›è¡Œï¼Œå¹¶é€šè¿‡å‘½åç©ºé—´çš„åŒºåŸŸé”ä¿è¯é¡ºåºæ­£ç¡®ã€‚ GFS å‘½åç©ºé—´æ˜¯ä¸€ä¸ªå…¨è·¯å¾„ä¸å…ƒæ•°æ®æ˜ å°„çš„æŸ¥æ‰¾è¡¨ï¼Œé‡‡ç”¨å‰ç¼€å‹ç¼©é«˜æ•ˆå­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚ä¸åŒäºä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿï¼ŒGFS ä¸æ”¯æŒåˆ—å‡ºç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„ç»“æ„ï¼Œä¹Ÿä¸æ”¯æŒæ–‡ä»¶æˆ–ç›®å½•çš„é“¾æ¥ã€‚æ¯ä¸ªèŠ‚ç‚¹ï¼ˆç»å¯¹è·¯å¾„çš„æ–‡ä»¶åæˆ–ç›®å½•åï¼‰æœ‰ä¸€ä¸ªå…³è”çš„è¯»å†™é”ã€‚ æ¯ä¸ª master æ“ä½œå¼€å§‹å‰éƒ½è¦è·å¾—ç›¸å…³é”ã€‚é€šå¸¸ï¼Œæ¶‰åŠè·¯å¾„/d1/d2/.../dn/leaf çš„æ“ä½œéœ€è¦è·å¾—/d1ï¼Œ/d1/d2ï¼Œâ€¦ï¼Œ/d1/d2/.../dn çš„è¯»é”ï¼Œä»¥åŠ/d1/d2/.../dn/leaf çš„è¯»å†™é”ã€‚æ ¹æ®æ“ä½œä¸åŒï¼Œleaf å¯ä»¥æ˜¯æ–‡ä»¶æˆ–ç›®å½•ã€‚ä¾‹å¦‚ï¼Œåœ¨/home/user å¿«ç…§åˆ°/save/user æ—¶ï¼Œé”æœºåˆ¶é˜²æ­¢åˆ›å»ºæ–‡ä»¶/home/user/fooã€‚å¿«ç…§æ“ä½œè·å¾—/home å’Œ/save çš„è¯»é”åŠ/home/user å’Œ/save/user çš„å†™é”ï¼›æ–‡ä»¶åˆ›å»ºæ“ä½œè·å¾—/home å’Œ/home/user çš„è¯»é”åŠ/home/user/foo çš„å†™é”ã€‚ç”±äº/home/user é”å†²çªï¼Œè¿™ä¸¤ä¸ªæ“ä½œé¡ºåºæ‰§è¡Œã€‚æ–‡ä»¶åˆ›å»ºæ“ä½œä¸éœ€è¦è·å–çˆ¶ç›®å½•çš„å†™å…¥é”ï¼Œå› ä¸ºè¿™é‡Œæ²¡æœ‰â€œç›®å½•â€ï¼Œæˆ–è€…ç±»ä¼¼ inode ç­‰ç”¨æ¥ ç¦æ­¢ä¿®æ”¹çš„æ•°æ®ç»“æ„ã€‚æ–‡ä»¶åçš„è¯»å–é”è¶³ä»¥é˜²æ­¢çˆ¶ç›®å½•è¢«åˆ é™¤ã€‚ è¿™ç§é”æ–¹æ¡ˆæ”¯æŒå¯¹åŒä¸€ç›®å½•çš„å¹¶è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼Œå¯åœ¨åŒä¸€ç›®å½•ä¸‹åŒæ—¶åˆ›å»ºå¤šä¸ªæ–‡ä»¶ï¼šæ¯ä¸ªæ“ä½œè·å–ç›®å½•åçš„è¯»é”å’Œæ–‡ä»¶åçš„å†™é”ã€‚ç›®å½•åçš„è¯»é”é˜²æ­¢ç›®å½•è¢«åˆ é™¤ã€æ”¹åæˆ–å¿«ç…§ï¼›æ–‡ä»¶åçš„å†™é”åºåˆ—åŒ–æ–‡ä»¶åˆ›å»ºæ“ä½œï¼Œç¡®ä¿ä¸ä¼šå¤šæ¬¡åˆ›å»ºåŒåæ–‡ä»¶ã€‚ ç”±äºå‘½åç©ºé—´èŠ‚ç‚¹ä¼—å¤šï¼Œè¯»å†™é”é‡‡ç”¨æƒ°æ€§åˆ†é…ç­–ç•¥ï¼Œä¸å†ä½¿ç”¨æ—¶ç«‹åˆ»åˆ é™¤ã€‚é”çš„è·å–ä¾æ®å…¨å±€ä¸€è‡´çš„é¡ºåºé¿å…æ­»é”ï¼šé¦–å…ˆæŒ‰å‘½åç©ºé—´å±‚æ¬¡æ’åºï¼Œåœ¨åŒä¸€å±‚æ¬¡å†…æŒ‰å­—å…¸é¡ºåºæ’åºã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:4:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.2 å‰¯æœ¬æ”¾ç½® GFS é›†ç¾¤é‡‡ç”¨é«˜åº¦åˆ†å¸ƒçš„å¤šå±‚å¸ƒå±€ç»“æ„ï¼Œå…¸å‹æ‹“æ‰‘åŒ…æ‹¬æ•°ç™¾ä¸ª chunkserveråˆ†å¸ƒåœ¨å¤šä¸ªæœºæ¶ä¸Šï¼Œç”±æ¥è‡ªåŒä¸€æˆ–ä¸åŒæœºæ¶çš„æ•°ç™¾ä¸ªå®¢æˆ·æœºè®¿é—®ã€‚é€šä¿¡å¯èƒ½è·¨è¶Šä¸€ä¸ªæˆ–å¤šä¸ªç½‘ç»œäº¤æ¢æœºï¼Œä¸”æœºæ¶å‡ºå…¥å¸¦å®½å¯èƒ½è¾ƒå°ã€‚å¤šå±‚åˆ†å¸ƒæ¶æ„å¸¦æ¥æ•°æ®çµæ´»æ€§ã€å¯é æ€§å’Œå¯ç”¨æ€§æŒ‘æˆ˜ã€‚ chunk å‰¯æœ¬ä½ç½®é€‰æ‹©æ—¨åœ¨æœ€å¤§åŒ–æ•°æ®å¯é æ€§å’Œå¯ç”¨æ€§ï¼Œä»¥åŠç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡ã€‚ä»…åœ¨å¤šå°æœºå™¨ä¸Šå­˜å‚¨å‰¯æœ¬ä¸è¶³ä»¥è¾¾åˆ°ç›®æ ‡ï¼Œéœ€åœ¨å¤šä¸ªæœºæ¶é—´åˆ†å¸ƒå‚¨å­˜ chunk çš„å‰¯æœ¬ã€‚è¿™ä¿è¯å³ä½¿æ•´ä¸ªæœºæ¶æ•…éšœæˆ–æ‰çº¿ï¼ŒæŸäº›å‰¯æœ¬ä»å¯ç”¨ï¼Œä¸”ç½‘ç»œæµé‡å°¤å…¶è¯»æ“ä½œå¯åˆ©ç”¨å¤šä¸ªæœºæ¶çš„å¸¦å®½ã€‚å°½ç®¡å†™æ“ä½œéœ€ä¸å¤šä¸ªæœºæ¶è®¾å¤‡é€šä¿¡ï¼Œä½†è¿™æ˜¯å€¼å¾—çš„ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:4:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.3 åˆ›å»ºã€é‡æ–°å¤åˆ¶ã€é‡æ–°å¹³è¡¡ chunk å‰¯æœ¬åœ¨ GFS ä¸­æœ‰ä¸‰ä¸ªä¸»è¦ç”¨é€”ï¼šchunk åˆ›å»ºã€é‡æ–°å¤åˆ¶å’Œé‡æ–°å¹³è¡¡ã€‚ Master èŠ‚ç‚¹åœ¨åˆ›å»º chunk æ—¶é€‰æ‹©å­˜æ”¾åˆå§‹ç©ºå‰¯æœ¬çš„ä½ç½®ï¼Œè€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š ä¼˜å…ˆé€‰æ‹©ç¡¬ç›˜ä½¿ç”¨ç‡ä½äºå¹³å‡å€¼çš„ chunkserverï¼Œä»¥å¹³è¡¡ç¡¬ç›˜ä½¿ç”¨ç‡ã€‚ é™åˆ¶æ¯ä¸ª chunkserverä¸Šæœ€è¿‘ chunk åˆ›å»ºæ“ä½œçš„æ¬¡æ•°ï¼Œä»¥å‡å°‘å†™å…¥æ“ä½œçš„é›†ä¸­åº¦ã€‚ åˆ†å¸ƒåœ¨å¤šä¸ªæœºæ¶ä¹‹é—´ï¼Œä»¥æé«˜å¯é æ€§ã€‚ å½“æœ‰æ•ˆå‰¯æœ¬æ•°é‡ä½äºæŒ‡å®šå¤åˆ¶å› æ•°æ—¶ï¼Œmaster èŠ‚ç‚¹ä¼šé‡æ–°å¤åˆ¶ chunkï¼Œå¯èƒ½åŸå› åŒ…æ‹¬ï¼š chunkserverä¸å¯ç”¨æˆ–æŠ¥å‘Šå‰¯æœ¬æŸåã€‚ ç£ç›˜é”™è¯¯æˆ–å¤åˆ¶å› æ•°å¢åŠ ã€‚ é‡æ–°å¤åˆ¶ä¼˜å…ˆçº§åŸºäºç°æœ‰å‰¯æœ¬æ•°é‡ä¸å¤åˆ¶å› æ•°çš„å·®å¼‚ã€chunk æ´»è·ƒçŠ¶æ€åŠå…¶å¯¹å®¢æˆ·ç«¯çš„å½±å“ã€‚ master é€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„chunkï¼Œå‘½ä»¤ chunkserverå…‹éš†å‰¯æœ¬ï¼Œé€‰æ‹©æ–°å‰¯æœ¬çš„ä½ç½®çš„ç­–ç•¥ç±»ä¼¼äº chunk åˆ›å»ºã€‚ä¸ºé˜²æ­¢å…‹éš†æ“ä½œè¶…è½½ç½‘ç»œï¼Œmasterä¼šé™åˆ¶å…‹éš†æ“ä½œæ•°é‡åŠå…¶è¯»è¯·æ±‚é¢‘ç‡ã€‚ master å‘¨æœŸæ€§æ£€æŸ¥å‰¯æœ¬åˆ†å¸ƒï¼Œç§»åŠ¨å‰¯æœ¬ä»¥ä¼˜åŒ–ç¡¬ç›˜ç©ºé—´åˆ©ç”¨å’Œå¹³è¡¡ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œmaster æ¸è¿›å¼å¡«å……æ–° chunkserverï¼Œé¿å…çŸ­æœŸå†…å¡«å……è¿‡è½½ã€‚å‰¯æœ¬ä½ç½®é€‰æ‹©ç­–ç•¥åŒä¸Šï¼Œå¹¶ä¼˜å…ˆç§»èµ°å‰©ä½™ç©ºé—´ä½äºå¹³å‡å€¼çš„æœåŠ¡å™¨ä¸Šçš„å‰¯æœ¬ï¼Œä»¥å¹³è¡¡æ•´ä½“ç¡¬ç›˜ä½¿ç”¨ç‡ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:4:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.4 åƒåœ¾å›æ”¶ GFS åœ¨æ–‡ä»¶åˆ é™¤åä¸ä¼šç«‹å³å›æ”¶ç‰©ç†ç©ºé—´ï¼Œè€Œæ˜¯é‡‡ç”¨æƒ°æ€§åƒåœ¾å›æ”¶ç­–ç•¥ï¼Œä»…åœ¨æ–‡ä»¶å’Œ chunk çº§çš„å¸¸è§„åƒåœ¾æ”¶é›†ä¸­è¿›è¡Œã€‚è¿™æ ·ç®€åŒ–äº†ç³»ç»Ÿè®¾è®¡ï¼Œæé«˜äº†å¯é æ€§ã€‚ 4.4.1 æœºåˆ¶ å½“ä¸€ä¸ªæ–‡ä»¶è¢«åº”ç”¨ç¨‹åºåˆ é™¤æ—¶ï¼Œmasterç«‹åˆ»æŠŠåˆ é™¤æ“ä½œä»¥æ—¥å¿—çš„æ–¹å¼è®°å½•ä¸‹æ¥ã€‚ä½†æ˜¯ï¼Œmaster å¹¶ä¸é©¬ä¸Šå›æ”¶èµ„æºï¼Œè€Œæ˜¯æŠŠæ–‡ä»¶åæ”¹ä¸ºä¸€ä¸ªåŒ…å«åˆ é™¤æ—¶é—´æˆ³çš„ã€éšè—çš„åå­—ã€‚å½“ master å¯¹æ–‡ä»¶ç³»ç»Ÿå‘½åç©ºé—´åšå¸¸è§„æ‰«æçš„æ—¶å€™ï¼Œå®ƒä¼šåˆ é™¤æ‰€æœ‰ä¸‰å¤©å‰çš„éšè—æ–‡ä»¶ï¼ˆè¿™ä¸ªæ—¶é—´é—´éš”æ˜¯å¯ä»¥è®¾ç½®çš„ï¼‰ã€‚åœ¨æ–‡ä»¶è¢«çœŸæ­£åˆ é™¤ä¹‹å‰ï¼Œå®ƒä»¬ä»æ—§å¯ä»¥ç”¨æ–°çš„ç‰¹æ®Šçš„åå­—ï¼ˆå³è¢«é‡å‘½ååçš„å¸¦æœ‰åˆ é™¤æ—¶é—´æˆ³çš„åå­—ï¼‰è¯»å–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŠŠéšè—æ–‡ä»¶æ”¹åä¸ºæ­£å¸¸æ˜¾ç¤ºçš„æ–‡ä»¶åçš„æ–¹å¼â€œå–æ¶ˆåˆ é™¤â€ã€‚å½“éšè—æ–‡ä»¶è¢«ä»å‘½åç©ºé—´ä¸­åˆ é™¤ï¼Œmaster å†…å­˜ä¸­ä¿å­˜çš„è¿™ä¸ªæ–‡ä»¶çš„ç›¸å…³å…ƒæ•°æ®æ‰ä¼šè¢«åˆ é™¤ã€‚è¿™ä¹Ÿæœ‰æ•ˆçš„åˆ‡æ–­äº†æ–‡ä»¶å’Œå®ƒåŒ…å«çš„æ‰€æœ‰ chunk çš„è¿æ¥ã€‚ åœ¨å¯¹ chunk å‘½åç©ºé—´åšç±»ä¼¼çš„å¸¸è§„æ‰«ææ—¶ï¼Œmaster æ‰¾åˆ°å­¤å„¿ chunkï¼ˆä¸è¢«ä»»ä½•æ–‡ä»¶åŒ…å«çš„ Chunkï¼‰ å¹¶åˆ é™¤å®ƒä»¬çš„å…ƒæ•°æ®ã€‚chunkserveråœ¨å’Œ master äº¤äº’çš„å¿ƒè·³ä¿¡æ¯ä¸­ï¼ŒæŠ¥å‘Šå®ƒæ‹¥æœ‰çš„ chunk å­é›†çš„ä¿¡æ¯ï¼Œ master å›å¤ chunkserverå“ªäº› chunk åœ¨ master ä¿å­˜çš„å…ƒæ•°æ®ä¸­å·²ç»ä¸å­˜åœ¨äº†ã€‚chunkserverå¯ä»¥ä»»æ„åˆ é™¤è¿™äº› chunk çš„å‰¯æœ¬ã€‚ 4.4.2 è®¨è®º GFS çš„åƒåœ¾å›æ”¶æ–¹æ¡ˆç®€å•å¯é ã€‚å¯ä»¥è½»æ˜“å¾—åˆ°chunk çš„å¼•ç”¨ï¼šå­˜å‚¨åœ¨ master çš„æ–‡ä»¶åˆ°chunkçš„æ˜ å°„è¡¨ä¸­ï¼›ä¹Ÿå¯ä»¥è½»æ¾å¾—åˆ°chunkæ‰€æœ‰å‰¯æœ¬ï¼šä»¥Linuxæ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨ chunkserveræŒ‡å®šç›®å½•ä¸‹ã€‚æ‰€æœ‰master ä¸èƒ½è¯†åˆ«çš„å‰¯æœ¬å³ä¸ºâ€œåƒåœ¾â€ã€‚ åƒåœ¾å›æ”¶åœ¨ç©ºé—´å›æ”¶æ–¹é¢ç›¸æ¯”ç›´æ¥åˆ é™¤æœ‰å‡ ä¸ªä¼˜åŠ¿ã€‚ åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç»„ä»¶å¤±æ•ˆæ˜¯å¸¸æ€ã€‚chunk å¯èƒ½åœ¨æŸäº›æœåŠ¡å™¨ä¸Šåˆ›å»ºæˆåŠŸï¼Œä½†åœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šå¤±è´¥ï¼Œå¤±è´¥çš„å‰¯æœ¬å¤„äºæ— æ³•è¢« master è¯†åˆ«çš„çŠ¶æ€ã€‚å‰¯æœ¬åˆ é™¤æ¶ˆæ¯å¯èƒ½ä¸¢å¤±ï¼Œmaster å¿…é¡»é‡æ–°å‘é€å¤±è´¥çš„åˆ é™¤æ¶ˆæ¯ï¼Œ åŒ…æ‹¬è‡ªèº«çš„ï¼ˆå…ƒæ•°æ®ï¼‰å’Œ chunkserverçš„ã€‚åƒåœ¾å›æ”¶æä¾›äº†ä¸€è‡´çš„ã€å¯é çš„æ¸…é™¤æ— ç”¨å‰¯æœ¬çš„æ–¹æ³•ã€‚ åƒåœ¾å›æ”¶å°†å­˜å‚¨ç©ºé—´å›æ”¶æ“ä½œåˆå¹¶åˆ° master çš„è§„å¾‹æ€§åå°æ´»åŠ¨ä¸­ï¼Œå¦‚ä¾‹è¡Œæ‰«æå’Œä¸ chunkserverçš„æ¡æ‰‹ã€‚å› æ­¤æ“ä½œè¢«æ‰¹é‡æ‰§è¡Œï¼Œå‡å°‘å¼€é”€ã€‚å›æ”¶åœ¨ master ç›¸å¯¹ç©ºé—²æ—¶è¿›è¡Œï¼Œæé«˜äº†å“åº”é€Ÿåº¦ã€‚ å»¶è¿Ÿå›æ”¶ä¸ºæ„å¤–ã€ä¸å¯é€†è½¬çš„åˆ é™¤æ“ä½œæä¾›äº†å®‰å…¨ä¿éšœï¼Œé˜²æ­¢è¯¯åˆ ã€‚ è™½ç„¶å»¶è¿Ÿå›æ”¶å¯èƒ½é˜»ç¢å­˜å‚¨ä¼˜åŒ–ï¼Œå°¤å…¶åœ¨ç©ºé—´ç´§ç¼ºæ—¶ã€‚ä½†å¯ä»¥é€šè¿‡æ˜¾å¼å†æ¬¡åˆ é™¤æ–‡ä»¶å¯ä»¥åŠ é€Ÿå›æ”¶ã€‚ç”¨æˆ·å¯ä»¥ä¸ºä¸åŒå‘½åç©ºé—´è®¾ç½®ä¸åŒçš„å¤åˆ¶å’Œå›æ”¶ç­–ç•¥ï¼Œä»¥ä¼˜åŒ–å­˜å‚¨ä½¿ç”¨ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:4:4","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"4.5 è¿‡æœŸå‰¯æœ¬æ£€æµ‹ å½“ chunkserverå¤±æ•ˆæ—¶ï¼Œchunk çš„å‰¯æœ¬å¯èƒ½å› é”™å¤±ä¸€äº›ä¿®æ”¹æ“ä½œè€Œè¿‡æœŸã€‚master é€šè¿‡ä¿å­˜æ¯ä¸ª Chunk çš„ç‰ˆæœ¬å·æ¥åŒºåˆ†å½“å‰å‰¯æœ¬å’Œè¿‡æœŸå‰¯æœ¬ã€‚æ¯æ¬¡ä¸ chunk ç­¾è®¢æ–°ç§Ÿçº¦æ—¶ï¼Œmaster éƒ½ä¼šå¢åŠ  chunk çš„ç‰ˆæœ¬å·ï¼Œå¹¶é€šçŸ¥æœ€æ–°çš„å‰¯æœ¬ï¼Œä¸”è¿™äº›å‰¯æœ¬ä¼šå°†æ–°çš„ç‰ˆæœ¬å·è®°å½•åœ¨å…¶æŒä¹…åŒ–å­˜å‚¨ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨ä»»ä½•å®¢æˆ·ç«¯å¾—åˆ°é€šçŸ¥å‰å®Œæˆï¼Œå› æ­¤ä¹Ÿæ˜¯åœ¨å¯¹è¿™ä¸ª chunk å¼€å§‹å†™ä¹‹å‰å®Œæˆçš„ã€‚å¦‚æœæŸä¸ªå‰¯æœ¬æ‰€åœ¨çš„ chunkserveræ­£å¥½å¤±æ•ˆï¼Œé‚£ä¹ˆå…¶ç‰ˆæœ¬å·å°±ä¸ä¼šè¢«æ›´æ–°ã€‚å¾…è¯¥ chunkserveré‡æ–°å¯åŠ¨å¹¶å‘ master æŠ¥å‘Šå…¶æŒæœ‰çš„ chunk åŠç›¸åº”ç‰ˆæœ¬å·æ—¶ï¼Œmaster ä¼šæ£€æµ‹å‡ºå…¶åŒ…å«è¿‡æœŸçš„ chunkã€‚è‹¥ master å‘ç°ä¸€ä¸ªæ¯”å…¶è®°å½•çš„ç‰ˆæœ¬å·æ›´é«˜çš„ç‰ˆæœ¬å·ï¼Œä¼šè®¤ä¸ºä¹‹å‰ç­¾è®¢ç§Ÿçº¦çš„æ“ä½œå¤±è´¥ï¼Œå¹¶é€‰æ‹©æ›´é«˜çš„ç‰ˆæœ¬å·ä½œä¸ºå½“å‰ç‰ˆæœ¬å·ã€‚ master åœ¨ä¾‹è¡Œåƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­ç§»é™¤æ‰€æœ‰è¿‡æœŸå‰¯æœ¬ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œmaster åœ¨å›å¤å®¢æˆ·ç«¯çš„ chunk ä¿¡æ¯è¯·æ±‚æ—¶ï¼Œmaster å®é™…ä¸Šä¼šè®¤ä¸ºæ ¹æœ¬ä¸å­˜åœ¨ä¸€ä¸ªè¿‡æœŸçš„å‰¯æœ¬ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œç»™å®¢æˆ·ç«¯è¿”å›çš„ chunk åˆ—è¡¨ä¸­å¯èƒ½åŒ…å«è¿‡æœŸçš„ chunkï¼Œå®¢æˆ·ç«¯æœ‰å¯èƒ½å»è¯»è¿‡æœŸçš„ chunkã€‚GFS æ˜¯å¼±ä¸€è‡´æ€§çš„ï¼‰ã€‚å¦å¤–ä¸€é‡ä¿éšœæªæ–½æ˜¯ï¼Œmaster åœ¨é€šçŸ¥å®¢æˆ·ç«¯å“ªä¸ª chunkserveræŒæœ‰ç§Ÿçº¦æˆ–æŒ‡ç¤º chunkserverä»å“ªä¸ª chunkserverè¿›è¡Œå…‹éš†æ—¶ï¼Œæ¶ˆæ¯ä¸­éƒ½ä¼šé™„å¸¦ chunk çš„ç‰ˆæœ¬å·ã€‚å®¢æˆ·ç«¯æˆ– chunkserveråœ¨æ‰§è¡Œæ“ä½œæ—¶ä¼šéªŒè¯ç‰ˆæœ¬å·ï¼Œä»¥ç¡®ä¿æ€»æ˜¯è®¿é—®å½“å‰ç‰ˆæœ¬çš„æ•°æ®ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:4:5","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5 å®¹é”™å’Œè¯Šæ–­ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:5:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.1 é«˜å¯ç”¨æ€§ åœ¨ GFS é›†ç¾¤ä¸­ï¼Œé«˜å¯ç”¨æ€§çš„ç­–ç•¥ä¸»è¦åŒ…æ‹¬å¿«é€Ÿæ¢å¤å’Œå¤åˆ¶ã€‚ é¦–å…ˆï¼Œå¯¹äºå¿«é€Ÿæ¢å¤ï¼Œæ— è®ºæ˜¯ master è¿˜æ˜¯ chunkserverï¼Œå®ƒä»¬éƒ½èƒ½åœ¨æ•°ç§’å†…æ¢å¤çŠ¶æ€å¹¶é‡æ–°å¯åŠ¨ã€‚ç³»ç»Ÿä¸åŒºåˆ†æ­£å¸¸å…³é—­å’Œå¼‚å¸¸å…³é—­ï¼Œé€šå¸¸é€šè¿‡ç›´æ¥ç»ˆæ­¢è¿›ç¨‹æ¥å…³é—­æœåŠ¡å™¨ã€‚ å…¶æ¬¡ï¼Œå¯¹äº chunk å¤åˆ¶ï¼Œæ¯ä¸ª chunk éƒ½è¢«å¤åˆ¶åˆ°ä¸åŒæœºæ¶ä¸Šçš„ä¸åŒ chunkserverä¸Šï¼Œå¹¶å¯ä»¥æ ¹æ®éœ€è¦è®¾å®šä¸åŒçš„å¤åˆ¶çº§åˆ«ã€‚å½“æœ‰ chunkserver ç¦»çº¿æˆ–å‘ç°æ•°æ®æŸåæ—¶ï¼Œmaster é€šè¿‡å…‹éš†å·²æœ‰çš„å‰¯æœ¬æ¥ç¡®ä¿æ¯ä¸ª chunk éƒ½è¢«å®Œæ•´å¤åˆ¶ã€‚ æœ€åï¼Œmaster çš„çŠ¶æ€ä¹Ÿéœ€è¦å¤åˆ¶ä»¥ä¿è¯å…¶å¯é æ€§ã€‚master çš„æ‰€æœ‰æ“ä½œæ—¥å¿—å’Œ checkpoint æ–‡ä»¶éƒ½è¢«å¤åˆ¶åˆ°å¤šå°æœºå™¨ä¸Šï¼Œç¡®ä¿æ“ä½œæ—¥å¿—å†™å…¥å¤‡ç”¨èŠ‚ç‚¹å’Œæœ¬æœºç£ç›˜ï¼Œä»¥æ”¯æŒå¤±è´¥åçš„å¿«é€Ÿé‡æ–°å¯åŠ¨ã€‚æ­¤å¤–ï¼Œè¿˜å­˜åœ¨â€œå½±å­â€masterï¼Œç”¨äºæä¾›æ–‡ä»¶ç³»ç»Ÿçš„åªè¯»è®¿é—®ã€‚è¿™äº›â€œå½±å­â€æœåŠ¡å™¨èƒ½å¤Ÿä¿æŒçŠ¶æ€æœ€æ–°ï¼Œå¹¶é€šè¿‡ä¸ä¸» master ç›¸åŒçš„æ–¹å¼å¤„ç†æ•°æ®ç»“æ„çš„æ›´æ”¹ã€‚å®ƒä»¬å®šæœŸä» chunkserveræ‹‰å–æ•°æ®ï¼Œå¹¶ä¸å…¶æ¡æ‰‹ä»¥ç¡®å®šçŠ¶æ€ï¼Œä»è€Œç¡®ä¿ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:5:1","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.2 æ•°æ®å®Œæ•´æ€§ æ¯ä¸ª Chunkserverä½¿ç”¨ checksum æ¥æ£€æŸ¥ä¿å­˜çš„æ•°æ®æ˜¯å¦æŸåã€‚ç”±äº GFS é›†ç¾¤é€šå¸¸åŒ…å«æ•°ç™¾å°æœºå™¨å’Œæ•°åƒå—ç¡¬ç›˜ï¼Œç£ç›˜æŸåå¯¼è‡´çš„æ•°æ®ä¸¢å¤±æˆ–æŸååœ¨è¯»å†™è¿‡ç¨‹ä¸­æ˜¯å¸¸è§çš„ã€‚è™½ç„¶å¯ä»¥é€šè¿‡å…¶ä»–å‰¯æœ¬æ¢å¤æ•°æ®ï¼Œä½†è·¨æœåŠ¡å™¨æ¯”è¾ƒå‰¯æœ¬ä»¥æ£€æŸ¥æ•°æ®å®Œæ•´æ€§å¹¶ä¸å®é™…ã€‚æ­¤å¤–ï¼Œç”±äº GFS å…è®¸å­˜åœ¨æœ‰æ­§ä¹‰çš„å‰¯æœ¬ï¼Œç‰¹åˆ«æ˜¯åœ¨åŸå­è®°å½•è¿½åŠ æ“ä½œä¸­ï¼Œå‰¯æœ¬å¹¶ä¸æ€»æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼ˆå‰¯æœ¬ä¸æ˜¯ byte-wise å®Œå…¨ä¸€è‡´çš„ï¼‰ã€‚å› æ­¤ï¼Œæ¯ä¸ª chunkserverå¿…é¡»ç‹¬ç«‹ç»´æŠ¤ checksum æ¥æ ¡éªŒè‡ªå·±çš„å‰¯æœ¬å®Œæ•´æ€§ã€‚ æ¯ä¸ª chunk è¢«åˆ†ä¸º 64KB çš„å—ï¼Œæ¯ä¸ªå—å¯¹åº”ä¸€ä¸ª 32 ä½çš„ checksumï¼Œå­˜å‚¨åœ¨å†…å­˜å’Œç¡¬ç›˜ä¸Šï¼Œå¹¶è®°å½•åœ¨æ“ä½œæ—¥å¿—ä¸­ã€‚åœ¨è¯»å–æ•°æ®ä¹‹å‰ï¼Œchunkserverä¼šæ ¡éªŒä¸è¯»å–èŒƒå›´é‡å çš„æ•°æ®å—çš„checksumã€‚å¦‚æœ checksum ä¸åŒ¹é…ï¼ŒæœåŠ¡å™¨è¿”å›é”™è¯¯ä¿¡æ¯å¹¶é€šçŸ¥ masterï¼Œä¹‹åä»å…¶ä»–å‰¯æœ¬è¯»å–æ•°æ®å¹¶è¿›è¡Œå…‹éš†æ¢å¤ã€‚ä¸€æ—¦æ–°çš„å‰¯æœ¬å°±ç»ªï¼Œmaster é€šçŸ¥ chunkserveråˆ é™¤é”™è¯¯çš„å‰¯æœ¬ã€‚ checksum å¯¹è¯»æ“ä½œæ€§èƒ½å½±å“å¾ˆå°ï¼Œå› ä¸ºå¤§éƒ¨åˆ†è¯»æ“ä½œæ¶‰åŠå¤šä¸ªå—ï¼Œè€Œåªéœ€è¯»å–å°‘é‡é¢å¤–æ•°æ®è¿›è¡Œæ ¡éªŒã€‚é€šè¿‡å¯¹é½è¯»æ“ä½œåˆ° checksumå—çš„è¾¹ç•Œï¼Œå¯ä»¥è¿›ä¸€æ­¥å‡å°‘é¢å¤–è¯»å–æ“ä½œçš„å½±å“ã€‚æ­¤å¤–ï¼Œchecksum çš„æŸ¥æ‰¾å’Œæ¯”è¾ƒä¸éœ€è¦é¢å¤–çš„ I/O æ“ä½œï¼Œè®¡ç®—å¯ä»¥ä¸ I/O æ“ä½œå¹¶è¡Œè¿›è¡Œã€‚ é’ˆå¯¹è¿½åŠ å†™å…¥æ“ä½œï¼Œchecksum çš„è®¡ç®—è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå› ä¸ºè¿™ç§æ“ä½œåœ¨ GFS å·¥ä½œä¸­å å¾ˆå¤§æ¯”ä¾‹ã€‚åªéœ€å¢é‡æ›´æ–°æœ€åä¸€ä¸ªä¸å®Œæ•´å—çš„ checksumï¼Œå¹¶ä½¿ç”¨æ–°å†™å…¥çš„æ•°æ®è®¡ç®—æ–°çš„ checksumã€‚å¦‚æœæœ€åä¸€ä¸ªchecksumå—æŸåï¼Œé—®é¢˜ä¼šåœ¨ä¸‹æ¬¡è¯»å–æ—¶è¢«å‘ç°ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¦†ç›–å†™æ“ä½œéœ€è¦è¯»å–å’Œæ ¡éªŒè¢«è¦†ç›–èŒƒå›´å†…çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå—ï¼Œæ“ä½œå®Œæˆåé‡æ–°è®¡ç®—å’Œå†™å…¥æ–°çš„ checksumã€‚å¦‚æœä¸æ ¡éªŒç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªè¢«å†™çš„å—ï¼Œæ–°çš„ checksum å¯èƒ½ä¼šéšè—æœªè¦†ç›–åŒºåŸŸå†…çš„æ•°æ®é”™è¯¯ã€‚ å½“ chunkserverç©ºé—²æ—¶ï¼Œä¼šæ‰«æå’Œæ ¡éªŒæ¯ä¸ªä¸æ´»åŠ¨ chunk çš„å†…å®¹ï¼Œä»¥å‘ç°å¾ˆå°‘è¢«è¯»å–çš„ chunk æ˜¯å¦å®Œæ•´ã€‚ä¸€æ—¦å‘ç°æ•°æ®æŸåï¼Œmaster å¯ä»¥åˆ›å»ºæ–°çš„æ­£ç¡®å‰¯æœ¬å¹¶åˆ é™¤æŸåçš„å‰¯æœ¬ï¼Œé¿å…éæ´»åŠ¨çš„æŸå chunk è¯¯å¯¼ masterï¼Œä½¿å…¶è®¤ä¸ºå‰¯æœ¬æ•°é‡è¶³å¤Ÿã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:5:2","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"5.3 è¯Šæ–­å·¥å…· è¯¦å°½çš„ã€æ·±å…¥ç»†èŠ‚çš„è¯Šæ–­æ—¥å¿—åœ¨é—®é¢˜éš”ç¦»ã€è°ƒè¯•å’Œæ€§èƒ½åˆ†æç­‰æ–¹é¢æä¾›äº†æå¤§çš„å¸®åŠ©ï¼Œè€Œæ‰€éœ€å¼€é”€å´å¾ˆå°ã€‚æ²¡æœ‰æ—¥å¿—ï¼Œæˆ‘ä»¬å¾ˆéš¾ç†è§£çŸ­æš‚çš„ã€ä¸é‡å¤çš„æœºå™¨é—´æ¶ˆæ¯äº¤äº’ã€‚GFS æœåŠ¡å™¨ä¼šç”Ÿæˆå¤§é‡æ—¥å¿—ï¼Œè®°å½•å…³é”®äº‹ä»¶ï¼ˆå¦‚ chunkserver çš„å¯åŠ¨å’Œå…³é—­ï¼‰ä»¥åŠæ‰€æœ‰ RPC è¯·æ±‚å’Œå›å¤ã€‚è¿™äº›æ—¥å¿—å¯ä»¥éšæ—¶åˆ é™¤ï¼Œä¸å½±å“ç³»ç»Ÿçš„æ­£ç¡®è¿è¡Œï¼Œä½†æˆ‘ä»¬åœ¨å­˜å‚¨ç©ºé—´å…è®¸çš„æƒ…å†µä¸‹å°½é‡ä¿ç•™è¿™äº›æ—¥å¿—ã€‚ RPC æ—¥å¿—è¯¦ç»†è®°å½•äº†ç½‘ç»œä¸Šçš„æ‰€æœ‰è¯·æ±‚å’Œå“åº”ï¼Œä½†ä¸åŒ…æ‹¬è¯»å†™çš„æ–‡ä»¶æ•°æ®ã€‚é€šè¿‡åŒ¹é…è¯·æ±‚ä¸å›åº”ï¼Œå¹¶æ”¶é›†ä¸åŒæœºå™¨ä¸Šçš„ RPC æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥é‡ç°æ‰€æœ‰æ¶ˆæ¯äº¤äº’æ¥è¯Šæ–­é—®é¢˜ã€‚è¿™äº›æ—¥å¿—è¿˜ç”¨äºè·Ÿè¸ªè´Ÿè½½æµ‹è¯•å’Œè¿›è¡Œæ€§èƒ½åˆ†æã€‚ æ—¥å¿—å¯¹æ€§èƒ½çš„å½±å“å¾ˆå°ï¼Œå› ä¸ºæ—¥å¿—å†™å…¥æ˜¯é¡ºåºä¸”å¼‚æ­¥çš„ã€‚æœ€è¿‘çš„äº‹ä»¶æ—¥å¿—ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç”¨äºæŒç»­çš„åœ¨çº¿ç›‘æ§ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:5:3","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["ç³»ç»Ÿæ¶æ„","è®ºæ–‡é˜…è¯»"],"content":"6 ç»éªŒ åœ¨æ„å»ºå’Œéƒ¨ç½² GFS çš„è¿‡ç¨‹ä¸­ï¼ŒGoogle é‡åˆ°äº†è®¸å¤šé—®é¢˜ï¼ŒåŒ…æ‹¬æ“ä½œå’ŒæŠ€æœ¯æ–¹é¢çš„æŒ‘æˆ˜ã€‚æœ€åˆï¼ŒGFS ä¸»è¦ä½œä¸ºç”Ÿäº§ç³»ç»Ÿçš„åç«¯æ–‡ä»¶ç³»ç»Ÿï¼Œåæ¥é€æ¸æ”¯æŒç ”ç©¶å’Œå¼€å‘ä»»åŠ¡ï¼Œå¢åŠ äº†æƒé™å’Œé…é¢ç­‰åŠŸèƒ½ã€‚ æœ€å¤§çš„éš¾é¢˜æ˜¯ç£ç›˜å’Œ Linux ç›¸å…³é—®é¢˜ã€‚è®¸å¤šç£ç›˜å£°ç§°æ”¯æŒ Linux IDE é©±åŠ¨ï¼Œä½†å®é™…åº”ç”¨ä¸­æƒ…å†µä¸ä¸€ï¼Œå¯¼è‡´åè®®ä¸åŒ¹é…ï¼Œæ•°æ®å¯èƒ½å› å†…æ ¸é—®é¢˜è€Œè¢«ç ´åã€‚ä¸ºæ­¤ï¼ŒGoogle ä½¿ç”¨æ ¡éªŒå’Œæ¥éªŒè¯æ•°æ®ï¼Œå¹¶ä¿®æ”¹å†…æ ¸å¤„ç†è¿™äº›é—®é¢˜ã€‚ æ—©æœŸä½¿ç”¨ Linux 2.2 å†…æ ¸æ—¶ï¼Œfsync() æ•ˆç‡ä¸æ–‡ä»¶å¤§å°ç›¸å…³è€Œéä¿®æ”¹éƒ¨åˆ†å¤§å°ç›¸å…³ï¼Œå¯¼è‡´æ“ä½œæ—¥å¿—æ–‡ä»¶è¿‡å¤§æ—¶å‡ºç°é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨å°šæœªå®ç°checkpoint çš„æ—¶å€™ã€‚Googleè´¹äº†å¾ˆå¤§çš„åŠ›æ°”ç”¨åŒæ­¥å†™æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æœ€åè¿˜æ˜¯ç§»æ¤åˆ°äº† Linux2.4 å†…æ ¸ä¸Šã€‚ å¦ä¸€ä¸ªé—®é¢˜æ˜¯å•ä¸ªè¯»å†™é”ï¼Œå¯¼è‡´ç³»ç»Ÿå¶å°”è¶…æ—¶ã€‚Google é€šè¿‡ç”¨ pread() æ›¿ä»£ mmap() å¹¶å¢åŠ é¢å¤–å¤åˆ¶æ“ä½œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ åœ¨ä»»æ„åœ°å€ç©ºé—´çš„çº¿ç¨‹åœ¨ç£ç›˜è¯»å…¥ï¼ˆè¯»é”ï¼‰æ—¶æˆ– mmap() è°ƒç”¨ï¼ˆå†™é”ï¼‰æ—¶å¿…é¡»æŒæœ‰é”ã€‚å³ä½¿ç³»ç»Ÿè´Ÿè½½å¾ˆè½»ï¼Œä¹Ÿä¼šå¶å°”è¶…æ—¶ã€‚GoogleèŠ±è´¹å¤§é‡ç²¾åŠ›æŸ¥æ‰¾èµ„æºç“¶é¢ˆæˆ–ç¡¬ä»¶é—®é¢˜ï¼Œæœ€ç»ˆå‘ç°ç£ç›˜çº¿ç¨‹åœ¨äº¤æ¢æ•°æ®åˆ°ç£ç›˜æ—¶ï¼Œé”ä½äº†å½“å‰ç½‘ç»œçº¿ç¨‹ï¼Œé˜»æ­¢å…¶å°†æ–°æ•°æ®æ˜ å°„åˆ°å†…å­˜ã€‚ç”±äºæ€§èƒ½ä¸»è¦å—é™äºç½‘ç»œæ¥å£è€Œéå†…å­˜å¤åˆ¶å¸¦å®½ï¼ŒGoogleç”¨ pread() æ›¿ä»£ mmap()ï¼Œé€šè¿‡é¢å¤–å¤åˆ¶æ“ä½œè§£å†³äº†é—®é¢˜ã€‚ ","date":"2024-05-12","objectID":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/:6:0","tags":["åˆ†å¸ƒå¼ç³»ç»Ÿ","GFS","æ–‡ä»¶ç³»ç»Ÿ"],"title":"ã€è®ºæ–‡é˜…è¯»ç¬”è®°ã€‘The Google File System","uri":"/posts/02.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0gfs/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"ç¿»è¯‘åŸæ–‡åœ°å€ ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:0:0","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"1 CPUçŸ¥è¯†ä¸ºä½•ä¸å†è¶³å¤Ÿ åœ¨å½“ä»Šçš„äººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œå¤§å¤šæ•°å¼€å‘è€…éƒ½æ˜¯æŒ‰ç…§CPUçš„æ–¹å¼è¿›è¡Œè®­ç»ƒã€‚è¿™ç§è®¤çŸ¥ä¹Ÿå·²ç»æˆä¸ºæˆ‘ä»¬å­¦æœ¯ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å¾ˆè‡ªç„¶åœ°ä¼šä»¥CPUä¸ºå¯¼å‘æ¥æ€è€ƒå’Œè§£å†³é—®é¢˜ã€‚ ç„¶è€Œï¼ŒCPU çš„é—®é¢˜åœ¨äºå®ƒä»¬ä¾èµ–äºä¸²è¡Œæ¶æ„ã€‚åœ¨å½“ä»Šä¸–ç•Œä¸­ï¼Œæˆ‘ä»¬ä¾èµ–å¤§é‡å¹¶è¡Œä»»åŠ¡çš„æƒ…å†µä¸‹ï¼ŒCPU æ— æ³•å¾ˆå¥½åœ°å¤„ç†è¿™äº›åœºæ™¯ã€‚ å› æ­¤ï¼Œå¼€å‘è€…é¢ä¸´ç€å¦‚ä¸‹é—®é¢˜ã€‚ æ‰§è¡Œå¹¶è¡Œä»»åŠ¡ CPU ä¼ ç»Ÿä¸Šæ˜¯çº¿æ€§è¿è¡Œçš„ï¼Œä¸€æ¬¡æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ã€‚è¿™ç§é™åˆ¶æºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šCPU é€šå¸¸å…·æœ‰ä¸€äº›é’ˆå¯¹å•çº¿ç¨‹æ€§èƒ½è¿›è¡Œä¼˜åŒ–çš„å¼ºå¤§å†…æ ¸ã€‚å½“é¢ä¸´å¤šä¸ªä»»åŠ¡æ—¶ï¼ŒCPUä¼šåˆ†é…å…¶èµ„æºæ¥é€ä¸ªå¤„ç†æ¯ä¸ªä»»åŠ¡ï¼Œä»è€Œå¯¼è‡´æŒ‡ä»¤çš„é¡ºåºæ‰§è¡Œã€‚åœ¨éœ€è¦åŒæ—¶å…³æ³¨ä¼—å¤šä»»åŠ¡çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹æ³•å˜å¾—ä½æ•ˆã€‚ å°½ç®¡æˆ‘ä»¬é€šè¿‡è¯¸å¦‚å¤šçº¿ç¨‹ç­‰æŠ€æœ¯æ¥æé«˜CPUæ€§èƒ½ï¼Œä½†CPUçš„åŸºæœ¬è®¾è®¡ç†å¿µæ˜¯ä¼˜å…ˆè€ƒè™‘é¡ºåºæ‰§è¡Œã€‚ é«˜æ•ˆè¿è¡ŒAIæ¨¡å‹ AI æ¨¡å‹é‡‡ç”¨ Transformer ç­‰å…ˆè¿›æ¶æ„ï¼Œåˆ©ç”¨å¹¶è¡Œå¤„ç†æ¥å¢å¼ºæ€§èƒ½ã€‚ä¸é¡ºåºè¿è¡Œçš„æ—§é€’å½’ç¥ç»ç½‘ç»œ (RNN) ä¸åŒï¼ŒGPT ç­‰ç°ä»£ Transformer å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªå•è¯ï¼Œä»è€Œæé«˜è®­ç»ƒæ•ˆç‡å’Œèƒ½åŠ›ã€‚å› ä¸ºå½“æˆ‘ä»¬å¹¶è¡Œè®­ç»ƒæ—¶ï¼Œä¼šäº§ç”Ÿæ›´å¤§çš„æ¨¡å‹ï¼Œè€Œæ›´å¤§çš„æ¨¡å‹ä¼šäº§ç”Ÿæ›´å¥½çš„è¾“å‡ºã€‚ å¹¶è¡Œçš„æ¦‚å¿µå·²ä»è‡ªç„¶è¯­è¨€å¤„ç†æ‰©å±•åˆ°å›¾åƒè¯†åˆ«ç­‰å…¶ä»–é¢†åŸŸã€‚ä¾‹å¦‚ï¼Œå›¾åƒè¯†åˆ«æ¶æ„ AlexNet é€šè¿‡åŒæ—¶å¤„ç†å›¾åƒçš„ä¸åŒéƒ¨åˆ†ï¼Œå±•ç¤ºäº†å¹¶è¡Œå¤„ç†çš„å¨åŠ›ï¼Œä»è€Œå®ç°å‡†ç¡®çš„æ¨¡å¼è¯†åˆ«ã€‚ ç„¶è€Œï¼ŒCPU çš„è®¾è®¡ä¾§é‡äºå•çº¿ç¨‹æ€§èƒ½ï¼Œå¾ˆéš¾å……åˆ†æŒ–æ˜å¹¶è¡Œå¤„ç†çš„æ½œåŠ›ã€‚å®ƒä»¬éš¾ä»¥æœ‰æ•ˆåˆ†é…å’Œæ‰§è¡Œå¤æ‚AIæ¨¡å‹æ‰€éœ€çš„å¤§é‡å¹¶è¡Œè®¡ç®—ã€‚ ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:1:0","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"2 GPUé©±åŠ¨å¼€å‘å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ GPU æ ¸å¿ƒçš„å¤§è§„æ¨¡å¹¶è¡Œæ€§ ä¸ CPU ä¸­æ›´å¤§ã€æ›´å¼ºå¤§çš„å†…æ ¸ç›¸æ¯”ï¼Œå·¥ç¨‹å¸ˆè®¾è®¡çš„ GPU å…·æœ‰æ›´å°ã€é«˜åº¦ä¸“ä¸šåŒ–çš„å†…æ ¸ã€‚è¯¥æ¶æ„å…è®¸ GPU åŒæ—¶æ‰§è¡Œå¤šä¸ªå¹¶è¡Œä»»åŠ¡ã€‚ GPU ä¸­çš„å¤§é‡æ ¸å¿ƒéå¸¸é€‚åˆä¾èµ–äºå¹¶è¡Œæ€§çš„å·¥ä½œè´Ÿè½½ï¼Œä¾‹å¦‚å›¾å½¢æ¸²æŸ“å’Œå¤æ‚çš„æ•°å­¦è®¡ç®—ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ5.3.2ä½¿ç”¨ GPU å¹¶è¡Œæ€§æ¥å‡å°‘å¤æ‚ä»»åŠ¡æ‰€éœ€çš„æ—¶é—´ã€‚ AI æ¨¡å‹ä¸­ä½¿ç”¨çš„å¹¶è¡Œæ€§ äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯åŸºäº TensorFlow ç­‰æ·±åº¦å­¦ä¹ æ¡†æ¶æ„å»ºçš„æ¨¡å‹ï¼Œè¡¨ç°å‡ºé«˜åº¦çš„å¹¶è¡Œæ€§ã€‚ç¥ç»ç½‘ç»œè®­ç»ƒæ¶‰åŠå¤§é‡çŸ©é˜µè¿ç®—ï¼Œè€Œ GPU å‡­å€Ÿå…¶åºå¤§çš„æ ¸å¿ƒæ•°é‡ï¼Œæ“…é•¿å¹¶è¡ŒåŒ–è¿™äº›è¿ç®—ã€‚ TensorFlow ä¸å…¶ä»–æµè¡Œçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸€èµ·è¿›è¡Œä¼˜åŒ–ï¼Œä»¥åˆ©ç”¨ GPU çš„èƒ½åŠ›æ¥åŠ é€Ÿæ¨¡å‹è®­ç»ƒå’Œæ¨ç†ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ5.3.3ä½¿ç”¨ GPU çš„å¼ºå¤§åŠŸèƒ½æ¥è®­ç»ƒç¥ç»ç½‘ç»œã€‚ ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:2:0","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"3 GPUå’ŒCPUæœ‰ä»€ä¹ˆåŒºåˆ« CPU ä¸²è¡Œæ¶æ„ ä¸­å¤®å¤„ç†å•å…ƒ (CPU) çš„è®¾è®¡é‡ç‚¹æ˜¯é¡ºåºå¤„ç†ã€‚å®ƒä»¬æ“…é•¿çº¿æ€§æ‰§è¡Œä¸€ç»„æŒ‡ä»¤ã€‚CPU é’ˆå¯¹éœ€è¦é«˜å•çº¿ç¨‹æ€§èƒ½çš„ä»»åŠ¡è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼š é€šç”¨è®¡ç®— ç³»ç»Ÿæ“ä½œ å¤„ç†æ¶‰åŠæ¡ä»¶åˆ†æ”¯çš„å¤æ‚ç®—æ³• å¹¶è¡Œä»»åŠ¡çš„æ ¸å¿ƒæ•°é‡æœ‰é™ CPU çš„æ ¸å¿ƒæ•°é‡è¾ƒå°‘ï¼Œåœ¨æ¶ˆè´¹çº§å¤„ç†å™¨ä¸­é€šå¸¸ä¸º 2-16 ä¸ªæ ¸å¿ƒã€‚æ¯ä¸ªå†…æ ¸éƒ½èƒ½å¤Ÿç‹¬ç«‹å¤„ç†è‡ªå·±çš„æŒ‡ä»¤é›†ã€‚ GPU å¹¶è¡Œæ¶æ„ å›¾å½¢å¤„ç†å•å…ƒï¼ˆGPUï¼‰é‡‡ç”¨å¹¶è¡Œæ¶æ„è®¾è®¡ï¼Œä½¿å…¶èƒ½å¤Ÿé«˜æ•ˆåœ°æ‰§è¡Œå¹¶è¡Œå¤„ç†ä»»åŠ¡ã€‚è¿™æœ‰åˆ©äºï¼š æ¸²æŸ“å›¾å½¢ æ‰§è¡Œå¤æ‚çš„æ•°å­¦è®¡ç®— è¿è¡Œå¯å¹¶è¡Œç®—æ³• GPU é€šè¿‡å°†å¤šä¸ªä»»åŠ¡åˆ†è§£ä¸ºæ›´å°çš„å¹¶è¡Œå­ä»»åŠ¡æ¥åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ã€‚ æ•°åƒä¸ªå†…æ ¸ç”¨äºå¹¶è¡Œä»»åŠ¡ ä¸ CPU ä¸åŒï¼ŒGPU æ‹¥æœ‰æ›´å¤šçš„æ ¸å¿ƒï¼Œé€šå¸¸æœ‰æ•°åƒä¸ªã€‚è¿™äº›å†…æ ¸è¢«ç»„ç»‡æˆæµå¼å¤šå¤„ç†å™¨ (SM) æˆ–ç±»ä¼¼çš„ç»“æ„ã€‚ä¸°å¯Œçš„å†…æ ¸ä½¿ GPU èƒ½å¤ŸåŒæ—¶å¤„ç†å¤§é‡æ•°æ®ï¼Œéå¸¸é€‚åˆå¹¶è¡Œä»»åŠ¡ï¼Œä¾‹å¦‚å›¾åƒå’Œè§†é¢‘å¤„ç†ã€æ·±åº¦å­¦ä¹ å’Œç§‘å­¦æ¨¡æ‹Ÿã€‚ ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:3:0","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"4 GPUç±»å‹ é€šç”¨ Gpu é€šç”¨ GPU å®ä¾‹ï¼ˆP3 å’Œ P4 å®ä¾‹ï¼‰é€‚ç”¨äºå¹¿æ³›çš„å·¥ä½œè´Ÿè½½ï¼ŒåŒ…æ‹¬æœºå™¨å­¦ä¹ è®­ç»ƒå’Œæ¨ç†ã€å›¾åƒå¤„ç†å’Œè§†é¢‘ç¼–ç ã€‚å®ƒä»¬çš„å¹³è¡¡æ€§èƒ½ä½¿å®ƒä»¬æˆä¸ºå„ç§è®¡ç®—ä»»åŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚ æ¨ç†ä¼˜åŒ–çš„ GPU æ¨ç†æ˜¯è¿è¡Œå·²ç»è®­ç»ƒå¥½çš„ AI æ¨¡å‹å¹¶å¯¹å®æ—¶æ•°æ®è¿›è¡Œé¢„æµ‹æˆ–ä»»åŠ¡æ±‚è§£çš„è¿‡ç¨‹ã€‚æ¨ç†ä¼˜åŒ–çš„ GPU å®ä¾‹ï¼ˆP5 å’Œ Inf1 å®ä¾‹ï¼‰åœ¨ä½å»¶è¿Ÿå’Œæˆæœ¬æ•ˆç‡è‡³å…³é‡è¦çš„æƒ…å†µä¸‹è¡¨ç°å‡ºè‰²ï¼Œç‰¹åˆ«é€‚ç”¨äºæœºå™¨å­¦ä¹ æ¨ç†ä»»åŠ¡ã€‚ å›¾å½¢ä¼˜åŒ–çš„ GPU å›¾å½¢ä¼˜åŒ–çš„ GPU å®ä¾‹ï¼ˆG4 å®ä¾‹ï¼‰ä¸“é—¨è®¾è®¡ç”¨äºå¤„ç†å›¾å½¢å¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚è§†é¢‘æ¸¸æˆå¼€å‘ä¸­çš„ 3D å›¾å½¢æ¸²æŸ“ã€‚è¿™äº›å®ä¾‹éå¸¸é€‚åˆéœ€è¦å¤„ç†å¤§é‡å›¾å½¢æ•°æ®çš„åº”ç”¨ç¨‹åºã€‚ æ‰˜ç®¡ GPU Amazon SageMaker æ˜¯ä¸€ç§æ‰˜ç®¡æœåŠ¡ï¼Œä¸ºæœºå™¨å­¦ä¹ æä¾›äº†æ˜“äºä½¿ç”¨çš„ GPU å®ä¾‹ã€‚å®ƒæä¾›å¯¹å¤šç§ GPU å®ä¾‹ï¼ˆåŒ…æ‹¬ P3ã€P4 å’Œ P5 å®ä¾‹ï¼‰çš„è®¿é—®ï¼Œé€‚ç”¨äºæƒ³è¦è½»æ¾å¼€å§‹æœºå™¨å­¦ä¹ è€Œæ— éœ€ç®¡ç†åº•å±‚åŸºç¡€è®¾æ–½çš„ç»„ç»‡ã€‚ ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:4:0","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"5 ä½¿ç”¨ Nvidia çš„ CUDA è¿›è¡Œ GPU é©±åŠ¨å¼€å‘ CUDA æ˜¯ NVIDIA å¼€å‘çš„å¹¶è¡Œè®¡ç®—å¹³å°å’Œç¼–ç¨‹æ¨¡å‹ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåˆ©ç”¨ GPU åŠ é€Ÿå™¨çš„å¼ºå¤§åŠŸèƒ½æ¥åŠ é€Ÿå…¶åº”ç”¨ç¨‹åºã€‚ ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:5:0","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"5.1 Linuxå®‰è£…CUDA ä¸‹è½½CUDA ä»ä¸Šé¢çš„é“¾æ¥ä¸‹è½½åŸºæœ¬å®‰è£…ç¨‹åºä»¥åŠé©±åŠ¨ç¨‹åºå®‰è£…ç¨‹åº è½¬åˆ°ä¸»æ–‡ä»¶å¤¹ä¸­çš„ .bashrcï¼ˆå¦‚æœä½¿ç”¨å…¶ä»–shellåˆ™ä½¿ç”¨å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼‰ åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š export PATH=\"/usr/local/cuda-12.3/bin:$PATH\" export LD_LIBRARY_PATH=\"/usr/local/cuda-12.3/lib64:$LD_LIBRARY_PATH\" ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š sudo apt-get install cuda-toolkit sudo apt-get install nvidia-gds ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:5:1","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"5.2 åŸºæœ¬å‘½ä»¤ lspci | grep VGA è¯†åˆ«å¹¶åˆ—å‡ºç³»ç»Ÿä¸­çš„ GPUã€‚ nvidia-smi â€œNVIDIA ç³»ç»Ÿç®¡ç†ç•Œé¢â€ï¼Œå®ƒæä¾›æœ‰å…³ç³»ç»Ÿä¸­ NVIDIA GPU çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ©ç”¨ç‡ã€æ¸©åº¦ã€å†…å­˜ä½¿ç”¨æƒ…å†µç­‰ã€‚ sudo lshw -C display æä¾›æœ‰å…³ç³»ç»Ÿä¸­æ˜¾ç¤ºæ§åˆ¶å™¨ï¼ˆåŒ…æ‹¬æ˜¾å¡ï¼‰çš„è¯¦ç»†ä¿¡æ¯ã€‚ inxi -G æä¾›æœ‰å…³å›¾å½¢å­ç³»ç»Ÿçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœ‰å…³ GPU å’Œæ˜¾ç¤ºå™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚ sudo hwinfo --gfxcard ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:5:2","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"5.3 å¼€å§‹ä½¿ç”¨CUDAæ¡†æ¶ å½“æˆ‘ä»¬å®‰è£…äº† CUDA æ¡†æ¶åï¼Œè®©æˆ‘ä»¬å¼€å§‹æ‰§è¡Œå±•ç¤ºå…¶åŠŸèƒ½çš„æ“ä½œã€‚ 5.3.1 æ•°ç»„åŠ æ³•é—®é¢˜ æ•°ç»„åŠ æ³•é—®é¢˜æ˜¯æ¼”ç¤º GPU å¹¶è¡ŒåŒ–çš„ä¸€ä¸ªåˆé€‚é—®é¢˜ã€‚è€ƒè™‘ä»¥ä¸‹æ•°ç»„ï¼š æ•°ç»„ $A = [1,2,3,4,5,6]$ æ•°ç»„ $B = [7,8,9,10,11,12]$ æˆ‘ä»¬éœ€è¦å­˜å‚¨æ¯ä¸ªå…ƒç´ çš„å’Œå¹¶å°†å…¶å­˜å‚¨åœ¨æ•°ç»„$C$ä¸­ã€‚æˆ‘ä»¬éœ€è¦å­˜å‚¨æ¯ä¸ªå…ƒç´ çš„å’Œå¹¶å°†å…¶å­˜å‚¨åœ¨æ•°ç»„$C$ä¸­ã€‚ å°±åƒ $C = [1+7,2+8,3+9,4+10,5+11,6+12] = [8,10,12,14,16,18]$ å¦‚æœCPUè¦æ‰§è¡Œè¿™æ ·çš„æ“ä½œï¼Œå®ƒå°†æ‰§è¡Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºçš„æ“ä½œã€‚ #include \u003cstdio.h\u003e int a[] = {1,2,3,4,5,6}; int b[] = {7,8,9,10,11,12}; int c[6]; int main() { int N = 6; // Number of elements for (int i = 0; i \u003c N; i++) { c[i] = a[i] + b[i]; } for (int i = 0; i \u003c N; i++) { printf(\"c[%d] = %d\", i, c[i]); } return 0; } è¿™ç§æ–¹æ³•æ˜¯é€ä¸ªéå†æ•°ç»„å…ƒç´ å¹¶ä¾æ¬¡æ‰§è¡ŒåŠ æ³•ã€‚ç„¶è€Œï¼Œå½“å¤„ç†å¤§é‡æ•°å­—æ—¶ï¼Œè¿™ç§æ–¹æ³•ç”±äºå…¶é¡ºåºæ€§è´¨è€Œå˜å¾—ç¼“æ…¢ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé™åˆ¶ï¼ŒGPU é€šè¿‡å¹¶è¡ŒåŒ–åŠ æ³•è¿‡ç¨‹æä¾›äº†ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚ä¸ä¾æ¬¡æ‰§è¡Œè¿ç®—çš„ CPU ä¸åŒï¼ŒGPU å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šé¡¹åŠ æ³•ã€‚ä¾‹å¦‚ï¼Œè¿ç®—$1+7ã€2+8ã€3+9ã€4+10ã€5+11$å’Œ$6+12$å¯ä»¥å€ŸåŠ©GPUå¹¶è¡ŒåŒ–åŒæ—¶æ‰§è¡Œã€‚ åˆ©ç”¨CUDAï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å†…æ ¸æ–‡ä»¶ (.cu) è¿›è¡Œå±•ç¤ºã€‚å®ç°å¹¶è¡ŒåŠ æ³•çš„ä»£ç å¦‚ä¸‹ï¼š __global__ void vectorAdd(int* a, int* b, int* c) { int i = threadIdx.x; c[i] = a[i] + b[i]; return; } __global__ è¯´æ˜ç¬¦è¡¨æ˜è¯¥å‡½æ•°æ˜¯ä¸€ä¸ªå†…æ ¸å‡½æ•°ï¼Œå°†åœ¨ GPU ä¸Šè°ƒç”¨ã€‚ vectorAdd é‡‡ç”¨ä¸‰ä¸ªæ•´æ•°æŒ‡é’ˆï¼ˆ$a$ã€$b$ å’Œ $c$ï¼‰ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºè¦ç›¸åŠ çš„å‘é‡ã€‚ threadIdx.x æ£€ç´¢å½“å‰çº¿ç¨‹çš„ç´¢å¼•ï¼ˆåœ¨ä¸€ç»´ç½‘æ ¼ä¸­ï¼‰ã€‚ å‘é‡ $a$ å’Œ $b$ çš„ç›¸åº”å…ƒç´ ä¹‹å’Œå­˜å‚¨åœ¨å‘é‡ $c$ ä¸­ã€‚ ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ä¸»è¦åŠŸèƒ½ã€‚åˆ›å»ºæŒ‡é’ˆ cudaA ã€ cudaB å’Œ cudaC æ¥æŒ‡å‘ GPU ä¸Šçš„å†…å­˜ã€‚ // åˆ©ç”¨ CUDA ä½¿ç”¨å¹¶è¡Œè®¡ç®—åŠ æ³•çš„å‡½æ•° int main() { int a[] = {1,2,3}; int b[] = {4,5,6}; int c[sizeof(a) / sizeof(int)] = {0}; // åˆ›å»ºæŒ‡å‘ GPU çš„æŒ‡é’ˆ int* cudaA = 0; int* cudaB = 0; int* cudaC = 0; ä½¿ç”¨ cudaMalloc ï¼Œåœ¨ GPU ä¸Šä¸ºå‘é‡ cudaAã€cudaB å’Œ cudaC åˆ†é…å†…å­˜ã€‚ // åœ¨GPUä¸­åˆ†é…å†…å­˜ cudaMalloc(\u0026cudaA,sizeof(a)); cudaMalloc(\u0026cudaB,sizeof(b)); cudaMalloc(\u0026cudaC,sizeof(c)); å†…æ ¸å‡½æ•° vectorAdd ä½¿ç”¨ä¸€ä¸ªå—å’Œç­‰äºå‘é‡å¤§å°çš„å¤šä¸ªçº¿ç¨‹å¯åŠ¨ã€‚ // ç”¨ä¸€ä¸ªç¨‹åºå—å’Œä¸å‘é‡å¤§å°ç›¸ç­‰çš„çº¿ç¨‹æ•°å¯åŠ¨å†…æ ¸ vectorAdd \u003c\u003c\u003c1, sizeof(a) / sizeof(a[0])\u003e\u003e\u003e (cudaA, cudaB, cudaC); ç»“æœå‘é‡ cudaC ä»GPUå¤åˆ¶å›ä¸»æœºã€‚ // å°†ç»“æœå‘é‡å¤åˆ¶å›ä¸»æœº cudaMemcpy(c, cudaC, sizeof(c), cudaMemcpyDeviceToHost); ç„¶åæˆ‘ä»¬å¯ä»¥ç…§å¸¸æ‰“å°ç»“æœ // æ‰“å°ç»“æœ for (int i = 0; i \u003c sizeof(c) / sizeof(int); i++) { printf(\"c[%d] = %d\", i, c[i]); } return 0; } ä¸ºäº†æ‰§è¡Œæ­¤ä»£ç ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ nvcc å‘½ä»¤ã€‚æˆ‘ä»¬å°†å¾—åˆ°è¾“å‡ºä¸ºï¼š è¿™æ˜¯å®Œæ•´çš„ä»£ç ä¾›è¯»è€…å‚è€ƒã€‚ 5.3.2 ä½¿ç”¨ GPU åœ¨ Python ä¸­ä¼˜åŒ–å›¾åƒç”Ÿæˆ æœ¬èŠ‚æ¢è®¨ä½¿ç”¨ GPU å¤„ç†æ¥ä¼˜åŒ–æ€§èƒ½å¯†é›†å‹ä»»åŠ¡ï¼Œä¾‹å¦‚å›¾åƒç”Ÿæˆã€‚ Mandelbrot é›†æ˜¯ä¸€ç§æ•°å­¦æ„é€ ï¼Œå®ƒæ ¹æ®è§„å®šæ–¹ç¨‹ä¸­ç‰¹å®šæ•°å­—çš„è¡Œä¸ºå½¢æˆå¤æ‚çš„è§†è§‰æ¨¡å¼ã€‚ç”Ÿæˆä¸€ä¸ªè¿™æ ·çš„å›¾æ¡ˆéœ€è¦è€—è´¹å¤§é‡èµ„æºã€‚åœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæ‚¨å¯ä»¥è§‚å¯Ÿåˆ°ä½¿ç”¨ CPU å¤„ç†ç”Ÿæˆ Mandelbrot é›†çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œè¯¥æ–¹æ³•é€Ÿåº¦å¾ˆæ…¢ã€‚ # å¯¼å…¥å¿…è¦çš„åº“ from matplotlib import pyplot as plt import numpy as np from pylab import imshow, show from timeit import default_timer as timer # è®¡ç®—ç»™å®šç‚¹ (x, y) çš„ Mandelbrot é›†çš„å‡½æ•° def mandel(x, y, max_iters): c = complex(x, y) z = 0.0j # è¿­ä»£æ£€æŸ¥è¯¥ç‚¹æ˜¯å¦åœ¨ Mandelbrot é›†ä¸­ for i in range(max_iters): z = z*z + c if (z.real*z.real + z.imag*z.imag) \u003e= 4: return i # å¦‚æœåœ¨æœ€å¤§è¿­ä»£æ¬¡æ•°å†…ï¼Œåˆ™å°†å…¶è§†ä¸ºé›†åˆçš„ä¸€éƒ¨åˆ† return max_iters # åœ¨æŒ‡å®šåŒºåŸŸå†…åˆ›å»º Mandelbrot åˆ†å½¢çš„å‡½æ•° def create_fractal(min_x, max_x, min_y, max_y, image, iters): height = image.shape[0] width = image.shape[1] # æ ¹æ®æŒ‡å®šåŒºåŸŸè®¡ç®—åƒç´ å¤§å° pixel_size_x = (max_x - min_x) / width pixel_size_y = (max_y - min_y) / height # åœ¨å›¾åƒä¸­è¿­ä»£æ¯ä¸ªåƒç´ å¹¶è®¡ç®—Mandelbrotå€¼ for x in range(width): real = min_x + x * pixel_size_x for y in range(height): imag = min_y + y * pixel_size_y color = mandel(real, imag, iters) image[y, x] = color # ä¸º Mandelbrot é›†åˆ›å»ºä¸€ä¸ªç©ºç™½å›¾åƒæ•°ç»„ image = np.zeros((1024, 1536), dtype=np.uint8) # è®°å½•æ€§èƒ½æµ‹é‡çš„å¼€å§‹æ—¶é—´ start = timer() # åœ¨æŒ‡å®šçš„åŒºåŸŸå’Œè¿­ä»£æ¬¡æ•°å†…ç”ŸæˆMandelbroté›†åˆ create_fractal(-2.0, 1.0, -1.0, 1.0, image, 20) # è®¡ç®—åˆ›å»º Mandelbrot é›†æ‰€éœ€çš„æ—¶é—´ dt = timer() - start # æ‰“å°ç”Ÿæˆ Mandelbrot é›†æ‰€éœ€çš„æ—¶é—´ print(\"Mandelbrot created in %f s\" % dt) # ä½¿ç”¨ matplotlib æ˜¾ç¤º Mandelbrot é›† imshow(image) show() ä¸Šé¢çš„ä»£ç åœ¨ 4.07 ç§’å†…ç”Ÿæˆè¾“å‡ºã€‚ ä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Numba åº“å°†ä»£ç ä¸ GPU å¹¶è¡ŒåŒ–ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š æˆ‘ä»¬å°†ä» numba å¯¼å…¥å³æ—¶ç¼–è¯‘ã€ç”¨äº GPU åŠ é€Ÿçš„ CUDA ä»¥åŠå…¶ä»–å·¥å…·åº“ import numpy as np from numba import jit, cuda, uint32, f8, uint8 from pylab import imshow, show from timeit import default_timer as timer @jit è£…é¥°å™¨æŒ‡ç¤º Numba æ‰§è¡Œå³æ—¶ç¼–è¯‘ï¼Œå°† Python ä»£ç è½¬æ¢ä¸ºæœºå™¨ä»£ç ä»¥æé«˜æ‰§è¡Œé€Ÿåº¦ã€‚ @jit def mandel(x, y, max_iters): c = complex(x, y) z = 0.0j for i in range(max_iters): z = z*z + c if (z.real*z.real + z.imag*z.imag) \u003e= 4: return i return max_iters mandel_gpu æ˜¯ä½¿ç”¨ cuda.jit åˆ›å»ºçš„ mandel å‡½æ•°çš„ GPU å…¼å®¹ç‰ˆæœ¬ã€‚è¿™å…è®¸å°† mandel é€»è¾‘å¸è½½åˆ° GPUã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ @cuda.jit è£…é¥°å™¨å¹¶æŒ‡å®šå‡½æ•°å‚æ•°çš„æ•°æ®ç±»å‹ï¼ˆf8 è¡¨ç¤ºæµ®ç‚¹æ•°ï¼Œ``uint32 è¡¨ç¤ºæ— ç¬¦å·32ä½æ•´æ•°ï¼‰æ¥å®Œæˆçš„ã€‚device=True` å‚æ•°æŒ‡ç¤ºè¯¥å‡½æ•°å°†åœ¨ GPU ä¸Šè¿è¡Œã€‚ mandel_gpu = cuda.jit((f8, f8, uint32), device=True)(mandel) mandel_kernel å‡½æ•°è¢«å®šä¹‰ä¸ºåœ¨ CUDA GPU ä¸Šæ‰§è¡Œã€‚å®ƒè´Ÿè´£è·¨ GPU çº¿ç¨‹å¹¶è¡Œç”Ÿæˆ Mandelbrot é›†ã€‚ @cuda.jit((f8, f8, f8, f8, uint8[:,:], uint32)) def mandel_kernel(min_x, max_x, min_y, max_y, image, iters): height = image.shape[0] width = ima","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:5:3","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["çŸ¥è¯†ç§‘æ™®"],"content":"6 ç»“è®º åœ¨å³å°†åˆ°æ¥çš„AIæ—¶ä»£ï¼ŒGPUæ˜¯ä¸€ä¸ªä¸å®¹å¿½è§†çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬åº”è¯¥æ›´åŠ äº†è§£å®ƒçš„èƒ½åŠ›ã€‚éšç€æˆ‘ä»¬ä»ä¼ ç»Ÿçš„ä¸²è¡Œç®—æ³•è¿‡æ¸¡åˆ°æ—¥ç›Šæµè¡Œçš„å¹¶è¡Œç®—æ³•ï¼ŒGPU æˆä¸ºåŠ é€Ÿå¤æ‚è®¡ç®—ä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚ GPU çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›åœ¨å¤„ç†äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ ä»»åŠ¡å›ºæœ‰çš„æµ·é‡æ•°æ®é›†å’Œå¤æ‚çš„ç¥ç»ç½‘ç»œæ¶æ„æ–¹é¢ç‰¹åˆ«æœ‰ä¼˜åŠ¿ã€‚æ­¤å¤–ï¼ŒGPU çš„ä½œç”¨è¶…å‡ºäº†ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œåœ¨ç§‘å­¦ç ”ç©¶ã€æ¨¡æ‹Ÿå’Œæ•°æ®å¯†é›†å‹ä»»åŠ¡ä¸­æ‰¾åˆ°äº†åº”ç”¨ã€‚äº‹å®è¯æ˜ï¼ŒGPU çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›æœ‰åŠ©äºè§£å†³ä»è¯ç‰©å‘ç°ã€æ°”å€™å»ºæ¨¡åˆ°é‡‘èæ¨¡æ‹Ÿç­‰å„ä¸ªé¢†åŸŸçš„æŒ‘æˆ˜ã€‚ ","date":"2024-05-12","objectID":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/:6:0","tags":["GPU"],"title":"AIæ—¶ä»£ä¸‹çš„GPUç”Ÿå­˜å·¥å…·åŒ…ï¼šæ¯ä¸ªå¼€å‘äººå‘˜å¿…é¡»äº†è§£çš„æœ€åŸºæœ¬çŸ¥è¯†","uri":"/posts/ai%E6%97%B6%E4%BB%A3%E4%B8%8B%E7%9A%84gpu%E7%94%9F%E5%AD%98%E5%B7%A5%E5%85%B7%E5%8C%85%E6%AF%8F%E4%B8%AA%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%BF%85%E9%A1%BB%E4%BA%86%E8%A7%A3%E7%9A%84%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"},{"categories":["èµ„æºæ”¶è—"],"content":"1 æ“ä½œç³»ç»Ÿ ","date":"2024-05-11","objectID":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/:1:0","tags":["å­¦ä¹ "],"title":"ä¼˜ç§€çš„CSå­¦ä¹ ç½‘ç«™","uri":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/"},{"categories":["èµ„æºæ”¶è—"],"content":"1.1 NJUæ“ä½œç³»ç»Ÿï¼šè®¾è®¡ä¸å®ç° å…ˆä¿®è¦æ±‚ï¼š Cè¯­è¨€ ä¸€äº›æ±‡ç¼–è¯­è¨€åŸºç¡€ è®¡ç®—æœºåŸºç¡€ è¿™æ˜¯NJU jyyè€å¸ˆçš„æ“ä½œç³»ç»Ÿè¯¾ç¨‹ï¼Œæ¯å¹´éƒ½ä¼šåœ¨Bç«™æ›´æ–°æœ€æ–°çš„æ“ä½œç³»ç»Ÿè¯¾ç¨‹è§†é¢‘ï¼Œå½“ç„¶è¿‡å¾€è¯¾ç¨‹ä¹Ÿå¯ä»¥æ‰¾åˆ°ã€‚ 2022å¹´OS ç½‘ç«™ 2022å¹´OS è§†é¢‘ è¯¾ç¨‹æ•™ç¨‹OSTEP 2022å¹´OS Lab ","date":"2024-05-11","objectID":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/:1:1","tags":["å­¦ä¹ "],"title":"ä¼˜ç§€çš„CSå­¦ä¹ ç½‘ç«™","uri":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/"},{"categories":["èµ„æºæ”¶è—"],"content":"1.2 MIT6.S081: Operating System Engineering å…ˆä¿®è¦æ±‚ï¼š Cè¯­è¨€ ä¸€äº›æ±‡ç¼–è¯­è¨€åŸºç¡€ è®¡ç®—æœºåŸºç¡€ è¯¾ç¨‹ç½‘ç«™ è¯¾ç¨‹è§†é¢‘ è¯¾ç¨‹è§†é¢‘ç¿»è¯‘æ–‡æ¡£ è¯¾ç¨‹æ•™æ è¯¾ç¨‹ä½œä¸š ","date":"2024-05-11","objectID":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/:1:2","tags":["å­¦ä¹ "],"title":"ä¼˜ç§€çš„CSå­¦ä¹ ç½‘ç«™","uri":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/"},{"categories":["èµ„æºæ”¶è—"],"content":"2 åˆ†å¸ƒå¼ç³»ç»Ÿ ","date":"2024-05-11","objectID":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/:2:0","tags":["å­¦ä¹ "],"title":"ä¼˜ç§€çš„CSå­¦ä¹ ç½‘ç«™","uri":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/"},{"categories":["èµ„æºæ”¶è—"],"content":"2.1 MIT6.824(after 2022, 6.5840): Distributed System å…ˆä¿®è¦æ±‚ï¼š Goè¯­è¨€ æ“ä½œç³»ç»Ÿ å¹¶å‘ç¼–ç¨‹ è®¡ç®—æœºä½“ç³»ç»“æ„ è¯¾ç¨‹ç½‘ç«™ è¯¾ç¨‹è§†é¢‘-ä¸­æ–‡å­—å¹• è¯¾ç¨‹ä¸­æ–‡æ–‡æ¡£ è¯¾ç¨‹ä½œä¸š ","date":"2024-05-11","objectID":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/:2:1","tags":["å­¦ä¹ "],"title":"ä¼˜ç§€çš„CSå­¦ä¹ ç½‘ç«™","uri":"/posts/01.%E8%AF%BE%E7%A8%8B%E7%BD%91%E7%AB%99/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¼•è¨€ Andrew æ–‡ä»¶ç³»ç»Ÿæ˜¯å¡å†…åŸºæ¢…éš†å¤§å­¦ (CMU) äº 1980 å¹´ä»£å¼•å…¥çš„ã€‚è¯¥é¡¹ç›®ç”±CMUè‘—åæ•™æˆ M. Satyanarayananï¼ˆç®€ç§°â€œSatyaâ€ï¼‰é¢†å¯¼ï¼Œå…¶ä¸»è¦ç›®æ ‡å¾ˆç®€å•ï¼šæ‰©å±•æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚ä½•è®¾è®¡ä¸€ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œä½¿å¾—æœåŠ¡å™¨å¯ä»¥æ”¯æŒå°½å¯èƒ½å¤šçš„å®¢æˆ·ç«¯ï¼Ÿ æœ‰è¶£çš„æ˜¯ï¼Œè®¾è®¡å’Œå®ç°çš„è®¸å¤šæ–¹é¢éƒ½ä¼šå½±å“å¯æ‰©å±•æ€§ã€‚æœ€é‡è¦çš„æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„åè®®è®¾è®¡ã€‚ä¾‹å¦‚ï¼Œåœ¨ NFS ä¸­ï¼Œåè®®å¼ºåˆ¶å®¢æˆ·ç«¯å®šæœŸæ£€æŸ¥æœåŠ¡å™¨ä»¥ç¡®å®šç¼“å­˜çš„å†…å®¹æ˜¯å¦å·²æ›´æ”¹ï¼›ç”±äºæ¯æ¬¡æ£€æŸ¥éƒ½ä¼šå ç”¨æœåŠ¡å™¨èµ„æºï¼ˆåŒ…æ‹¬CPUå’Œç½‘ç»œå¸¦å®½ï¼‰ï¼Œå› æ­¤é¢‘ç¹è¿›è¡Œè¿™æ ·çš„æ£€æŸ¥å°†é™åˆ¶æœåŠ¡å™¨å¯ä»¥å“åº”çš„å®¢æˆ·ç«¯æ•°é‡ï¼Œä»è€Œé™åˆ¶å¯æ‰©å±•æ€§ã€‚ AFS ä¸ NFS çš„ä¸åŒä¹‹å¤„è¿˜åœ¨äºï¼Œä»ä¸€å¼€å§‹ï¼Œåˆç†çš„ç”¨æˆ·å¯è§è¡Œä¸ºå°±æ˜¯é¦–è¦å…³æ³¨çš„é—®é¢˜ã€‚åœ¨ NFS ä¸­ï¼Œç¼“å­˜ä¸€è‡´æ€§å¾ˆéš¾æè¿°ï¼Œå› ä¸ºå®ƒç›´æ¥å–å†³äºä½çº§å®ç°ç»†èŠ‚ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯ç¼“å­˜è¶…æ—¶é—´éš”ã€‚åœ¨AFSä¸­ï¼Œç¼“å­˜ä¸€è‡´æ€§å¾ˆç®€å•ä¸”æ˜“äºç†è§£ï¼šå½“æ–‡ä»¶è¢«æ‰“å¼€æ—¶ï¼Œå®¢æˆ·ç«¯é€šå¸¸ä¼šä»æœåŠ¡å™¨æ¥æ”¶åˆ°æœ€æ–°çš„ä¸€è‡´å‰¯æœ¬ã€‚ æˆ‘ä»¬å°†è®¨è®ºä¸¤ä¸ªç‰ˆæœ¬çš„ AFSã€‚ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º AFSv1ï¼Œä½†å®é™…ä¸Šæœ€åˆçš„ç³»ç»Ÿè¢«ç§°ä¸º ITC åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæœ‰ä¸€äº›åŸºæœ¬è®¾è®¡ï¼Œä½†æ‰©å±•æ€§ä¸å°½å¦‚äººæ„ï¼Œè¿™å¯¼è‡´äº†é‡æ–°è®¾è®¡å’Œæœ€ç»ˆåè®®ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º AFSv2ï¼Œæˆ–ç®€ç§° AFSï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:1:0","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 AFSv1 ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:0","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åŸºæœ¬ä»‹ç» AFS æ‰€æœ‰ç‰ˆæœ¬çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€æ˜¯åœ¨è®¿é—®æ–‡ä»¶çš„å®¢æˆ·ç«¯è®¡ç®—æœºçš„æœ¬åœ°ç£ç›˜ä¸Šç¼“å­˜æ•´ä¸ªæ–‡ä»¶ã€‚å½“æ‚¨ open() æ–‡ä»¶æ—¶ï¼Œå°†ä»æœåŠ¡å™¨è·å–æ•´ä¸ªæ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰å¹¶å°†å…¶å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„æ–‡ä»¶ä¸­ã€‚åç»­åº”ç”¨ç¨‹åºçš„read()å’Œwrite()æ“ä½œå°†è¢«é‡å®šå‘åˆ°å­˜å‚¨æ–‡ä»¶çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼›å› æ­¤ï¼Œè¿™äº›æ“ä½œä¸éœ€è¦ç½‘ç»œé€šä¿¡å¹¶ä¸”é€Ÿåº¦å¾ˆå¿«ã€‚æœ€åï¼Œåœ¨ close() æ—¶ï¼Œæ–‡ä»¶ï¼ˆå¦‚æœå·²è¢«ä¿®æ”¹ï¼‰è¢«åˆ·æ–°å›æœåŠ¡å™¨ã€‚è¯·æ³¨æ„ä¸ NFS çš„æ˜æ˜¾å¯¹æ¯”ï¼ŒNFS ç¼“å­˜å—ï¼ˆä¸æ˜¯æ•´ä¸ªæ–‡ä»¶ï¼Œå°½ç®¡ NFS å½“ç„¶å¯ä»¥ç¼“å­˜æ•´ä¸ªæ–‡ä»¶çš„æ¯ä¸ªå—ï¼‰å¹¶åœ¨å®¢æˆ·ç«¯å†…å­˜ï¼ˆè€Œä¸æ˜¯æœ¬åœ°ç£ç›˜ï¼‰ä¸­è¿›è¡Œç¼“å­˜ã€‚ è®©æˆ‘ä»¬è¿›ä¸€æ­¥äº†è§£ç»†èŠ‚ã€‚å½“å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºç¬¬ä¸€æ¬¡è°ƒç”¨ open() æ—¶ï¼ŒAFS å®¢æˆ·ç«¯ä»£ç ï¼ˆAFS è®¾è®¡è€…ç§°ä¹‹ä¸º Venusï¼‰å°†å‘æœåŠ¡å™¨å‘é€ä¸€æ¡ Fetch åè®®æ¶ˆæ¯ã€‚ Fetch åè®®æ¶ˆæ¯ä¼šå°†æ‰€éœ€æ–‡ä»¶çš„æ•´ä¸ªè·¯å¾„åï¼ˆä¾‹å¦‚ï¼Œ/home/zfhe/notes.txtï¼‰ä¼ é€’åˆ°æ–‡ä»¶æœåŠ¡å™¨ï¼ˆä»–ä»¬ç§°ä¹‹ä¸º Vice çš„ç»„ï¼‰ï¼Œç„¶åæ–‡ä»¶æœåŠ¡å™¨å°†éå†è·¯å¾„åï¼Œæ‰¾åˆ°æ‰€éœ€çš„æ–‡ä»¶ï¼Œå¹¶å°†æ•´ä¸ªæ–‡ä»¶å‘å›ç»™å®¢æˆ·ç«¯ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯ä»£ç ä¼šå°†æ–‡ä»¶ç¼“å­˜åœ¨å®¢æˆ·ç«¯çš„æœ¬åœ°ç£ç›˜ä¸Šï¼ˆé€šè¿‡å°†å…¶å†™å…¥æœ¬åœ°ç£ç›˜ï¼‰ã€‚æ­£å¦‚æˆ‘ä»¬ä¸Šé¢æ‰€è¯´ï¼Œåç»­çš„ read() å’Œ write() ç³»ç»Ÿè°ƒç”¨åœ¨ AFS ä¸­ä¸¥æ ¼æ˜¯æœ¬åœ°çš„ï¼ˆä¸å‘ç”Ÿä¸æœåŠ¡å™¨çš„é€šä¿¡ï¼‰ï¼›å®ƒä»¬åªæ˜¯é‡å®šå‘åˆ°æ–‡ä»¶çš„æœ¬åœ°å‰¯æœ¬ã€‚ç”±äº read() å’Œ write() è°ƒç”¨çš„è¡Œä¸ºå°±åƒå¯¹æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„è°ƒç”¨ä¸€æ ·ï¼Œå› æ­¤ä¸€æ—¦è®¿é—®äº†ä¸€ä¸ªå—ï¼Œå®ƒä¹Ÿå¯èƒ½ä¼šç¼“å­˜åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ã€‚å› æ­¤ï¼ŒAFS è¿˜ä½¿ç”¨å®¢æˆ·ç«¯å†…å­˜æ¥ç¼“å­˜å…¶æœ¬åœ°ç£ç›˜ä¸­çš„å—å‰¯æœ¬ã€‚æœ€åï¼Œå®Œæˆåï¼ŒAFS å®¢æˆ·ç«¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²è¢«ä¿®æ”¹ï¼ˆå³ï¼Œå®ƒå·²è¢«æ‰“å¼€ç”¨äºå†™å…¥ï¼‰ï¼›å¦‚æœæ˜¯ï¼Œå®ƒå°†ä½¿ç”¨å­˜å‚¨åè®®æ¶ˆæ¯å°†æ–°ç‰ˆæœ¬åˆ·æ–°å›æœåŠ¡å™¨ï¼Œå¹¶å°†æ•´ä¸ªæ–‡ä»¶å’Œè·¯å¾„åå‘é€åˆ°æœåŠ¡å™¨è¿›è¡ŒæŒä¹…å­˜å‚¨ã€‚ ä¸‹æ¬¡è®¿é—®æ–‡ä»¶æ—¶ï¼ŒAFSv1 çš„æ•ˆç‡ä¼šæ›´é«˜ã€‚å…·ä½“æ¥è¯´ï¼Œå®¢æˆ·ç«¯ä»£ç é¦–å…ˆè”ç³»æœåŠ¡å™¨ï¼ˆä½¿ç”¨ TestAuth åè®®æ¶ˆæ¯ï¼‰ä»¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å·²æ›´æ”¹ã€‚å¦‚æœæ²¡æœ‰ï¼Œå®¢æˆ·ç«¯å°†ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„å‰¯æœ¬ï¼Œä»è€Œé€šè¿‡é¿å…ç½‘ç»œä¼ è¾“æ¥æé«˜æ€§èƒ½ã€‚ä¸‹é¢å±•ç¤ºäº†AFSv1ä¸­çš„ä¸€äº›åè®®æ¶ˆæ¯ã€‚è¯·æ³¨æ„ï¼Œè¯¥åè®®çš„æ—©æœŸç‰ˆæœ¬ä»…ç¼“å­˜æ–‡ä»¶å†…å®¹ï¼›ä¾‹å¦‚ï¼Œç›®å½•ä»…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚ TestAuth Test whether a file has changed (used to validate cached entries) GetFileStat Get the stat info for a file Fetch Fetch the contents of file Store Store this file on the server SetFileStat Set the stat info for a file ListDir List the contents of a directory ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:1","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 å­˜åœ¨çš„é—®é¢˜ AFS ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ä¸€äº›å…³é”®é—®é¢˜ä¿ƒä½¿è®¾è®¡äººå‘˜é‡æ–°è€ƒè™‘ä»–ä»¬çš„æ–‡ä»¶ç³»ç»Ÿã€‚ä¸ºäº†è¯¦ç»†ç ”ç©¶è¿™äº›é—®é¢˜ï¼ŒAFS çš„è®¾è®¡è€…èŠ±è´¹äº†å¤§é‡æ—¶é—´æµ‹é‡ä»–ä»¬ç°æœ‰çš„åŸå‹ï¼Œä»¥æ‰¾å‡ºé—®é¢˜æ‰€åœ¨ã€‚è¿™æ ·çš„å®éªŒæ˜¯ä¸€ä»¶å¥½äº‹ï¼Œå› ä¸ºæµ‹é‡æ˜¯ç†è§£ç³»ç»Ÿå¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•æ”¹è¿›ç³»ç»Ÿçš„å…³é”®ï¼›å› æ­¤ï¼Œè·å¾—å…·ä½“ã€è‰¯å¥½çš„æ•°æ®æ˜¯ç³»ç»Ÿå»ºè®¾çš„å¿…è¦ç»„æˆéƒ¨åˆ†ã€‚åœ¨ä»–ä»¬çš„ç ”ç©¶ä¸­ï¼Œä½œè€…å‘ç° AFSv1 çš„ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š è·¯å¾„éå†æˆæœ¬å¤ªé«˜ï¼šå½“æ‰§è¡Œ Fetch æˆ– Store åè®®è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯å°†æ•´ä¸ªè·¯å¾„åï¼ˆä¾‹å¦‚ /home/zfhe/notes.txtï¼‰ä¼ é€’ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨ä¸ºäº†è®¿é—®è¯¥æ–‡ä»¶ï¼Œå¿…é¡»æ‰§è¡Œå®Œæ•´çš„è·¯å¾„åéå†ï¼Œé¦–å…ˆåœ¨æ ¹ç›®å½•ä¸­æŸ¥æ‰¾homeï¼Œç„¶ååœ¨homeä¸­æŸ¥æ‰¾zfheï¼Œä¾æ­¤ç±»æ¨ï¼Œä¸€ç›´æ²¿ç€è·¯å¾„éå†ï¼Œç›´åˆ°æœ€åæ‰¾åˆ°æ‰€éœ€çš„æ–‡ä»¶ã€‚ç”±äºè®¸å¤šå®¢æˆ·ç«¯åŒæ—¶è®¿é—®æœåŠ¡å™¨ï¼ŒAFS çš„è®¾è®¡è€…å‘ç°æœåŠ¡å™¨èŠ±è´¹äº†å¤§é‡çš„ CPU æ—¶é—´åªæ˜¯æ²¿ç€ç›®å½•è·¯å¾„æŸ¥æ‰¾ã€‚ å®¢æˆ·ç«¯å‘å‡ºè¿‡å¤šçš„TestAuth åè®®æ¶ˆæ¯ï¼šä¸NFS åŠå…¶è¿‡å¤šçš„GETATTR åè®®æ¶ˆæ¯éå¸¸ç›¸ä¼¼ï¼Œï¼ŒAFSv1 ä¹Ÿäº§ç”Ÿäº†å¤§é‡æµé‡ï¼Œç”¨äºé€šè¿‡ TestAuth åè®®ä¿¡æ¯æ£€æŸ¥æœ¬åœ°æ–‡ä»¶ï¼ˆæˆ–å…¶çŠ¶æ€ä¿¡æ¯ï¼‰æ˜¯å¦æœ‰æ•ˆã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨è¦èŠ±è´¹å¤§é‡æ—¶é—´å‘Šè¯‰å®¢æˆ·ç«¯æ˜¯å¦å¯ä»¥ä½¿ç”¨å…¶ç¼“å­˜çš„æ–‡ä»¶å‰¯æœ¬ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç­”æ¡ˆæ˜¯æ–‡ä»¶æ²¡æœ‰å˜åŒ–ã€‚ AFSv1 å®é™…ä¸Šè¿˜å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼šæœåŠ¡å™¨ä¹‹é—´çš„è´Ÿè½½ä¸å‡è¡¡ï¼Œå¹¶ä¸”æœåŠ¡å™¨å¯¹æ¯ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨å•ç‹¬çš„è¿›ç¨‹ï¼Œä»è€Œå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œå…¶ä»–å¼€é”€ã€‚é€šè¿‡å¼•å…¥å·è§£å†³äº†è´Ÿè½½ä¸å‡è¡¡é—®é¢˜ï¼Œç®¡ç†å‘˜å¯ä»¥è·¨æœåŠ¡å™¨ç§»åŠ¨å·ä»¥å‡è¡¡è´Ÿè½½ï¼› AFSv2 ä¸­é€šè¿‡ä½¿ç”¨çº¿ç¨‹è€Œä¸æ˜¯è¿›ç¨‹æ„å»ºæœåŠ¡å™¨æ¥è§£å†³ä¸Šä¸‹æ–‡åˆ‡æ¢é—®é¢˜ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé‡ç‚¹å…³æ³¨ä¸Šé¢é™åˆ¶ç³»ç»Ÿè§„æ¨¡çš„ä¸¤ä¸ªä¸»è¦åè®®é—®é¢˜ã€‚ ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜é™åˆ¶äº†AFSçš„å¯æ‰©å±•æ€§ï¼›æœåŠ¡å™¨CPUæˆä¸ºç³»ç»Ÿçš„ç“¶é¢ˆï¼Œæ¯å°æœåŠ¡å™¨åªèƒ½æœåŠ¡20ä¸ªå®¢æˆ·ç«¯è€Œä¸è‡³äºè¿‡è½½ã€‚æœåŠ¡å™¨æ¥æ”¶åˆ°å¤ªå¤š TestAuth æ¶ˆæ¯ï¼Œå¹¶ä¸”å½“å®ƒä»¬æ¥æ”¶åˆ° Fetch æˆ– Store æ¶ˆæ¯æ—¶ï¼Œä¼šèŠ±è´¹å¤ªå¤šæ—¶é—´éå†ç›®å½•å±‚æ¬¡ç»“æ„ã€‚å› æ­¤ï¼ŒAFS è®¾è®¡è€…é¢ä¸´ç€ä¸€ä¸ªé—®é¢˜ï¼š å¦‚ä½•è®¾è®¡å¯æ‰©å±•çš„æ–‡ä»¶åè®® åº”å¦‚ä½•é‡æ–°è®¾è®¡åè®®ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘æœåŠ¡å™¨äº¤äº’çš„æ•°é‡ï¼Œå³å¦‚ä½•å‡å°‘ TestAuth æ¶ˆæ¯çš„æ•°é‡ï¼Ÿæ­¤å¤–ï¼Œä»–ä»¬å¦‚ä½•è®¾è®¡åè®®ä»¥ä½¿è¿™äº›æœåŠ¡å™¨äº¤äº’é«˜æ•ˆï¼Ÿé€šè¿‡è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæ–°åè®®å°†äº§ç”Ÿæ›´å…·å¯æ‰©å±•æ€§çš„ AFS ç‰ˆæœ¬ã€‚ ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:2","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 AFSv2 ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:0","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 åŸºæœ¬ä»‹ç» AFSv2 å¼•å…¥äº†å›è°ƒçš„æ¦‚å¿µï¼Œä»¥å‡å°‘å®¢æˆ·ç«¯/æœåŠ¡å™¨äº¤äº’çš„æ¬¡æ•°ã€‚å›è°ƒåªæ˜¯æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„ä¸€ä¸ªæ‰¿è¯ºï¼Œå³å½“å®¢æˆ·ç«¯ç¼“å­˜çš„æ–‡ä»¶è¢«ä¿®æ”¹æ—¶ï¼ŒæœåŠ¡å™¨å°†é€šçŸ¥å®¢æˆ·ç«¯ã€‚åœ¨ç³»ç»Ÿä¸­æ·»åŠ è¿™ç§çŠ¶æ€åï¼Œå®¢æˆ·ç«¯å°±ä¸å†éœ€è¦è”ç³»æœåŠ¡å™¨æ¥äº†è§£ç¼“å­˜æ–‡ä»¶æ˜¯å¦ä»ç„¶æœ‰æ•ˆã€‚ç›¸åï¼Œå®ƒä¼šå‡å®šæ–‡ä»¶æ˜¯æœ‰æ•ˆçš„ï¼Œç›´åˆ°æœåŠ¡å™¨å‘Šè¯‰å®ƒå¦åˆ™ï¼›è¯·æ³¨æ„è½®è¯¢ä¸ä¸­æ–­ä¹‹é—´çš„ç±»æ¯”ã€‚ AFSv2 è¿˜å¼•å…¥äº†**æ–‡ä»¶æ ‡è¯†ç¬¦ï¼ˆFIDï¼‰**çš„æ¦‚å¿µï¼ˆç±»ä¼¼äº NFS æ–‡ä»¶å¥æŸ„ï¼‰ï¼Œè€Œä¸æ˜¯è·¯å¾„åæ¥æŒ‡å®šå®¢æˆ·ç«¯æ„Ÿå…´è¶£çš„æ–‡ä»¶ã€‚AFS ä¸­çš„ FID ç”±ä¸€ä¸ªå·æ ‡è¯†ç¬¦ã€ä¸€ä¸ªæ–‡ä»¶æ ‡è¯†ç¬¦å’Œä¸€ä¸ª â€œå”¯ä¸€æ ‡è¯†ç¬¦ â€œç»„æˆï¼ˆä»¥ä¾¿åœ¨åˆ é™¤æ–‡ä»¶æ—¶é‡å¤ä½¿ç”¨å·å’Œæ–‡ä»¶æ ‡è¯†ç¬¦ï¼‰ã€‚å› æ­¤ï¼Œå®¢æˆ·ç«¯ä¸å†å‘æœåŠ¡å™¨å‘é€æ•´ä¸ªè·¯å¾„åï¼Œå¹¶è®©æœåŠ¡å™¨éå†è·¯å¾„åä»¥æ‰¾åˆ°æ‰€éœ€çš„æ–‡ä»¶ï¼Œè€Œæ˜¯é€æ­¥éå†è·¯å¾„åï¼Œç¼“å­˜ç»“æœï¼Œå¹¶å¸Œæœ›å‡å°‘å¯¹æœåŠ¡å™¨çš„è´Ÿè½½ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯è®¿é—®æ–‡ä»¶/home/zfhe/notes.txtï¼Œè€Œ home æ˜¯æŒ‚è½½åœ¨ / ä¸Šçš„ AFS ç›®å½•ï¼ˆå³ / æ˜¯æœ¬åœ°æ ¹ç›®å½•ï¼Œä½† home åŠå…¶å­ç›®å½•åœ¨ AFS ä¸­ï¼‰ï¼Œå®¢æˆ·ç«¯å°†é¦–å…ˆè·å– home çš„ç›®å½•å†…å®¹ï¼Œå°†å…¶æ”¾å…¥æœ¬åœ°ç£ç›˜ç¼“å­˜ï¼Œå¹¶åœ¨ home ä¸Šè®¾ç½®å›è°ƒã€‚ç„¶åï¼Œå®¢æˆ·æœºå°†å–å› zfhe ç›®å½•ï¼Œå°†å…¶æ”¾å…¥æœ¬åœ°ç£ç›˜ç¼“å­˜ï¼Œå¹¶åœ¨ zfhe ä¸Šè®¾ç½®å›è°ƒã€‚æœ€åï¼Œå®¢æˆ·ç«¯ä¼šè·å–notes.txtï¼Œå°†è¿™ä¸ªå¸¸è§„æ–‡ä»¶ç¼“å­˜åˆ°æœ¬åœ°ç£ç›˜ï¼Œå¹¶è®¾ç½®å›è°ƒï¼Œæœ€åå‘è°ƒç”¨åº”ç”¨ç¨‹åºè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è¿™ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä¸è¿‡ï¼Œä¸ NFS çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œæ¯æ¬¡è·å–ç›®å½•æˆ–æ–‡ä»¶æ—¶ï¼ŒAFS å®¢æˆ·ç«¯éƒ½ä¼šä¸æœåŠ¡å™¨å»ºç«‹å›è°ƒï¼Œä»è€Œç¡®ä¿æœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å…¶ç¼“å­˜çŠ¶æ€çš„å˜åŒ–ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼šè™½ç„¶å¯¹/home/zfhe/notes.txt çš„é¦–æ¬¡è®¿é—®ä¼šäº§ç”Ÿè®¸å¤šå®¢æˆ·ç«¯-æœåŠ¡å™¨ä¿¡æ¯ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ï¼Œä½†åŒæ—¶ä¹Ÿä¼šä¸ºæ‰€æœ‰ç›®å½•ä»¥åŠnotes.txt æ–‡ä»¶å»ºç«‹å›è°ƒï¼Œå› æ­¤åç»­è®¿é—®å®Œå…¨æ˜¯æœ¬åœ°æ“ä½œï¼Œæ ¹æœ¬ä¸éœ€è¦ä¸æœåŠ¡å™¨äº¤äº’ã€‚å› æ­¤ï¼Œåœ¨å®¢æˆ·ç«¯ç¼“å­˜æ–‡ä»¶çš„å¸¸è§æƒ…å†µä¸‹ï¼ŒAFS çš„è¡Œä¸ºå‡ ä¹ä¸æœ¬åœ°ç£ç›˜æ–‡ä»¶ç³»ç»Ÿç›¸åŒã€‚å¦‚æœè®¿é—®ä¸€ä¸ªæ–‡ä»¶ä¸æ­¢ä¸€æ¬¡ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡è®¿é—®çš„é€Ÿåº¦åº”è¯¥ä¸æœ¬åœ°è®¿é—®æ–‡ä»¶çš„é€Ÿåº¦ä¸€æ ·å¿«ã€‚ ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:1","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 ç¼“å­˜ä¸€è‡´æ€§ ç¼“å­˜ä¸€è‡´æ€§ä¸æ˜¯ä¸‡èƒ½çš„ åœ¨è®¨è®ºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œå¾ˆå¤šäººéƒ½ä¼šæåˆ°æ–‡ä»¶ç³»ç»Ÿæä¾›çš„ç¼“å­˜ä¸€è‡´æ€§ã€‚ç„¶è€Œï¼Œè¿™ç§åŸºæœ¬ä¸€è‡´æ€§å¹¶ä¸èƒ½è§£å†³å¤šä¸ªå®¢æˆ·ç«¯è®¿é—®æ–‡ä»¶çš„æ‰€æœ‰é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨å»ºç«‹ä¸€ä¸ªä»£ç åº“ï¼Œæœ‰å¤šä¸ªå®¢æˆ·ç«¯æ‰§è¡Œä»£ç çš„æ£€å…¥å’Œæ£€å‡ºï¼Œä½ å°±ä¸èƒ½ç®€å•åœ°ä¾èµ–åº•å±‚æ–‡ä»¶ç³»ç»Ÿæ¥ä¸ºä½ å®Œæˆæ‰€æœ‰å·¥ä½œï¼›ç›¸åï¼Œä½ å¿…é¡»ä½¿ç”¨æ˜¾å¼æ–‡ä»¶çº§é”å®šï¼Œä»¥ç¡®ä¿åœ¨å‘ç”Ÿè¿™ç§å¹¶å‘è®¿é—®æ—¶å‘ç”Ÿ â€œæ­£ç¡® â€œçš„äº‹æƒ…ã€‚äº‹å®ä¸Šï¼Œä»»ä½•çœŸæ­£å…³å¿ƒå¹¶å‘æ›´æ–°çš„åº”ç”¨ç¨‹åºéƒ½ä¼šå¢åŠ é¢å¤–çš„æœºåˆ¶æ¥å¤„ç†å†²çªã€‚åŸºæœ¬ä¸€è‡´æ€§ä¸»è¦é€‚ç”¨äºä¸´æ—¶ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç”¨æˆ·ç™»å½•åˆ°ä¸åŒçš„å®¢æˆ·ç«¯æ—¶ï¼Œä»–ä»¬å¸Œæœ›åœ¨å®¢æˆ·ç«¯ä¸Šæ˜¾ç¤ºå…¶æ–‡ä»¶çš„åˆç†ç‰ˆæœ¬ã€‚å¦‚æœå¯¹è¿™äº›åè®®æŠ±æœ‰æ›´é«˜çš„æœŸæœ›ï¼Œå°±ä¼šè®©è‡ªå·±é™·å…¥å¤±è´¥ã€å¤±æœ›å’Œå……æ»¡æ³ªæ°´çš„æ²®ä¸§ä¹‹ä¸­ã€‚ å½“æˆ‘ä»¬è®¨è®º NFS æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ç¼“å­˜ä¸€è‡´æ€§çš„ä¸¤ä¸ªæ–¹é¢ï¼šæ›´æ–°å¯è§æ€§å’Œç¼“å­˜é™ˆæ—§æ€§ã€‚ å¯¹äºæ›´æ–°å¯è§æ€§ï¼Œé—®é¢˜æ˜¯ï¼šæœåŠ¡å™¨ä½•æ—¶ä¼šä½¿ç”¨æ–°ç‰ˆæœ¬çš„æ–‡ä»¶è¿›è¡Œæ›´æ–°ï¼Ÿ å¯¹äºç¼“å­˜é™ˆæ—§æ€§ï¼Œé—®é¢˜æ˜¯ï¼šä¸€æ—¦æœåŠ¡å™¨æœ‰äº†æ–°ç‰ˆæœ¬ï¼Œå®¢æˆ·ç«¯å¤šä¹…æ‰èƒ½çœ‹åˆ°æ–°ç‰ˆæœ¬è€Œä¸æ˜¯æ—§çš„ç¼“å­˜å‰¯æœ¬ï¼Ÿ ç”±äºå›è°ƒå’Œå…¨æ–‡ä»¶ç¼“å­˜ï¼ŒAFS æä¾›çš„ç¼“å­˜ä¸€è‡´æ€§å¾ˆå®¹æ˜“æè¿°å’Œç†è§£ã€‚æœ‰ä¸¤ä¸ªé‡è¦çš„æƒ…å†µéœ€è¦è€ƒè™‘ï¼šä¸åŒæœºå™¨ä¸Šçš„è¿›ç¨‹ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œä»¥åŠåŒä¸€æœºå™¨ä¸Šçš„è¿›ç¨‹ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚ åœ¨ä¸åŒçš„è®¡ç®—æœºä¹‹é—´ï¼ŒAFS ä½¿æ›´æ–°åœ¨æœåŠ¡å™¨ä¸Šå¯è§ï¼Œå¹¶åœ¨åŒä¸€æ—¶é—´ï¼ˆå³æ›´æ–°çš„æ–‡ä»¶å…³é—­æ—¶ï¼‰ä½¿ç¼“å­˜çš„å‰¯æœ¬å¤±æ•ˆã€‚å®¢æˆ·ç«¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå†™å…¥ï¼ˆå¯èƒ½é‡å¤ï¼‰ã€‚å½“å®ƒæœ€ç»ˆå…³é—­æ—¶ï¼Œæ–°æ–‡ä»¶å°†åˆ·æ–°åˆ°æœåŠ¡å™¨ï¼ˆå› æ­¤å¯è§ï¼‰ã€‚æ­¤æ—¶ï¼ŒæœåŠ¡å™¨ä¼šâ€œä¸­æ–­â€ä»»ä½•å…·æœ‰ç¼“å­˜å‰¯æœ¬çš„å®¢æˆ·ç«¯çš„å›è°ƒï¼›**ä¸­æ–­æ˜¯é€šè¿‡è”ç³»æ¯ä¸ªå®¢æˆ·ç«¯å¹¶é€šçŸ¥å®ƒå¯¹æ–‡ä»¶çš„å›è°ƒä¸å†æœ‰æ•ˆæ¥å®Œæˆçš„ã€‚**æ­¤æ­¥éª¤ç¡®ä¿å®¢æˆ·ç«¯å°†ä¸å†è¯»å–æ–‡ä»¶çš„è¿‡æ—¶å‰¯æœ¬ï¼›è¿™äº›å®¢æˆ·ç«¯ä¸Šçš„åç»­æ‰“å¼€å°†éœ€è¦ä»æœåŠ¡å™¨é‡æ–°è·å–æ–‡ä»¶çš„æ–°ç‰ˆæœ¬ï¼ˆå¹¶ä¸”è¿˜å°†ç”¨äºåœ¨æ–‡ä»¶çš„æ–°ç‰ˆæœ¬ä¸Šé‡æ–°å»ºç«‹å›è°ƒï¼‰ã€‚ AFS å¯¹åŒä¸€å°æœºå™¨ä¸Šçš„è¿›ç¨‹ä¹‹é—´çš„è¿™ç§ç®€å•æ¨¡å‹è¿›è¡Œäº†ä¾‹å¤–å¤„ç†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹æ–‡ä»¶çš„å†™å…¥å¯¹å…¶ä»–æœ¬åœ°è¿›ç¨‹ç«‹å³å¯è§ï¼ˆå³ï¼Œè¿›ç¨‹ä¸å¿…ç­‰åˆ°æ–‡ä»¶å…³é—­æ‰èƒ½æŸ¥çœ‹å…¶æœ€æ–°æ›´æ–°ï¼‰ã€‚è¿™ä½¿å¾—ä½¿ç”¨å•å°æœºå™¨çš„è¡Œä¸ºå®Œå…¨ç¬¦åˆæ‚¨çš„é¢„æœŸï¼Œå› ä¸ºæ­¤è¡Œä¸ºåŸºäºå…¸å‹çš„ UNIX è¯­ä¹‰ã€‚åªæœ‰å½“åˆ‡æ¢åˆ°ä¸åŒçš„æœºå™¨æ—¶ï¼Œä½ æ‰èƒ½æ£€æµ‹åˆ°æ›´é€šç”¨çš„AFSä¸€è‡´æ€§æœºåˆ¶ã€‚ æœ‰ä¸€ä¸ªæœ‰è¶£çš„è·¨æœºå™¨æ¡ˆä¾‹å€¼å¾—è¿›ä¸€æ­¥è®¨è®ºã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ä¸åŒæœºå™¨ä¸Šçš„è¿›ç¨‹åŒæ—¶ä¿®æ”¹æ–‡ä»¶çš„ç½•è§æƒ…å†µä¸‹ï¼ŒAFS è‡ªç„¶ä¼šé‡‡ç”¨æ‰€è°“çš„â€œæœ€åå†™å…¥è€…è·èƒœâ€æ–¹æ³•ï¼ˆä¹Ÿè®¸åº”è¯¥ç§°ä¸ºâ€œæœ€åå…³é—­è€…è·èƒœâ€ï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œæœ€åè°ƒç”¨ close() çš„å®¢æˆ·ç«¯å°†æœ€åæ›´æ–°æœåŠ¡å™¨ä¸Šçš„æ•´ä¸ªæ–‡ä»¶ï¼Œå› æ­¤å°†æˆä¸ºâ€œè·èƒœâ€æ–‡ä»¶ï¼Œå³ä¿ç•™åœ¨æœåŠ¡å™¨ä¸Šä¾›å…¶ä»–äººæŸ¥çœ‹çš„æ–‡ä»¶ã€‚ç»“æœæ˜¯ä¸€ä¸ªç”±ä¸€ä¸ªå®¢æˆ·ç«¯æˆ–å¦ä¸€ä¸ªå®¢æˆ·ç«¯å®Œæ•´ç”Ÿæˆçš„æ–‡ä»¶ã€‚è¯·æ³¨æ„ä¸ NFS ç­‰åŸºäºå—çš„åè®®çš„åŒºåˆ«ï¼šåœ¨ NFS ä¸­ï¼Œå½“æ¯ä¸ªå®¢æˆ·ç«¯æ›´æ–°æ–‡ä»¶æ—¶ï¼Œå„ä¸ªå—çš„å†™å…¥å¯èƒ½ä¼šè¢«åˆ·æ–°åˆ°æœåŠ¡å™¨ï¼Œå› æ­¤æœåŠ¡å™¨ä¸Šçš„æœ€ç»ˆæ–‡ä»¶å¯èƒ½æ˜¯ä¸¤ä¸ªå®¢æˆ·ç«¯æ›´æ–°çš„æ··åˆä½“ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™ç§æ··åˆæ–‡ä»¶è¾“å‡ºæ²¡æœ‰å¤šå¤§æ„ä¹‰ï¼Œå³æƒ³è±¡ä¸€ä¸‹ JPEG å›¾åƒè¢«ä¸¤ä¸ªå®¢æˆ·ç«¯åˆ†æ®µä¿®æ”¹ï¼›ç”±æ­¤äº§ç”Ÿçš„å†™å…¥ç»„åˆä¸å¤ªå¯èƒ½æ„æˆæœ‰æ•ˆçš„ JPEGã€‚ ä¸‹å›¾ä¸­æ˜¾ç¤ºäº†å…¶ä¸­ä¸€äº›ä¸åŒåœºæ™¯çš„æ—¶é—´çº¿ã€‚è¿™äº›åˆ—æ˜¾ç¤ºäº† $Client_1$ ä¸Šçš„ä¸¤ä¸ªè¿›ç¨‹ï¼ˆ$P_1$ å’Œ $P_2$ï¼‰åŠå…¶ç¼“å­˜çŠ¶æ€ã€$Client_2$ ä¸Šçš„ä¸€ä¸ªè¿›ç¨‹ ($P_3$) åŠå…¶ç¼“å­˜çŠ¶æ€ä»¥åŠæœåŠ¡å™¨ (Server) çš„è¡Œä¸ºï¼Œæ‰€æœ‰è¿™äº›éƒ½åœ¨ä¸€ä¸ªåä¸º $F$ çš„æ–‡ä»¶ä¸Šè¿›è¡Œæ“ä½œã€‚å¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œå›¾ä¸­åªæ˜¯æ˜¾ç¤ºäº†å·¦è¾¹æ“ä½œå®Œæˆåçš„æ–‡ä»¶å†…å®¹ã€‚ ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:2","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 å´©æºƒæ¢å¤ ä»ä¸Šé¢çš„æè¿°ä¸­ï¼Œä½ å¯èƒ½ä¼šæ„Ÿè§‰åˆ°å´©æºƒæ¢å¤æ¯” NFS æ›´å¤æ‚ã€‚ä½ æ˜¯å¯¹çš„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœåŠ¡å™¨ (S) åœ¨çŸ­æ—¶é—´å†…æ— æ³•ä¸å®¢æˆ·ç«¯(C1) å–å¾—è”ç³»ï¼Œæ¯”å¦‚å®¢æˆ·ç«¯ C1 æ­£åœ¨é‡å¯ã€‚å½“ C1 ä¸å¯ç”¨æ—¶ï¼ŒS å¯èƒ½å·²å°è¯•å‘å…¶å‘é€ä¸€æ¡æˆ–å¤šæ¡å›è°ƒå¬å›æ¶ˆæ¯ï¼›ä¾‹å¦‚ï¼Œå‡è®¾ C1 åœ¨æœ¬åœ°ç£ç›˜ä¸Šç¼“å­˜äº†æ–‡ä»¶ Fï¼Œç„¶å C2ï¼ˆå¦ä¸€ä¸ªå®¢æˆ·ç«¯ï¼‰æ›´æ–°äº† Fï¼Œä»è€Œå¯¼è‡´ S å‘æ‰€æœ‰ç¼“å­˜è¯¥æ–‡ä»¶çš„å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ï¼Œè¦æ±‚å®ƒä»¬ä»æœ¬åœ°ç¼“å­˜ä¸­åˆ é™¤è¯¥æ–‡ä»¶ã€‚ç”±äº C1 åœ¨é‡å¯æ—¶å¯èƒ½ä¼šé”™è¿‡è¿™äº›å…³é”®ä¿¡æ¯ï¼Œå› æ­¤åœ¨é‡æ–°åŠ å…¥ç³»ç»Ÿæ—¶ï¼ŒC1 åº”å°†å…¶æ‰€æœ‰ç¼“å­˜å†…å®¹è§†ä¸ºå¯ç–‘å†…å®¹ã€‚å› æ­¤ï¼Œåœ¨ä¸‹ä¸€æ¬¡è®¿é—®æ–‡ä»¶ F æ—¶ï¼ŒC1 åº”é¦–å…ˆè¯¢é—®æœåŠ¡å™¨ï¼ˆé€šè¿‡ TestAuth åè®®æ¶ˆæ¯ï¼‰å…¶ç¼“å­˜çš„æ–‡ä»¶ F å‰¯æœ¬æ˜¯å¦ä»ç„¶æœ‰æ•ˆï¼›å¦‚æœæœ‰æ•ˆï¼ŒC1 å¯ä»¥ä½¿ç”¨å®ƒï¼›å¦‚æœæ— æ•ˆï¼ŒC1 åº”ä»æœåŠ¡å™¨è·å–æ›´æ–°çš„ç‰ˆæœ¬ã€‚ æœåŠ¡å™¨å´©æºƒåçš„æ¢å¤ä¹Ÿæ¯”è¾ƒå¤æ‚ã€‚ç”±æ­¤äº§ç”Ÿçš„é—®é¢˜æ˜¯ï¼Œå›è°ƒæ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­çš„ï¼›å› æ­¤ï¼Œå½“æœåŠ¡å™¨é‡å¯æ—¶ï¼Œå®ƒä¸çŸ¥é“å“ªå°å®¢æˆ·æœºæ‹¥æœ‰å“ªäº›æ–‡ä»¶ã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨é‡å¯åï¼ŒæœåŠ¡å™¨çš„æ¯ä¸ªå®¢æˆ·ç«¯éƒ½å¿…é¡»æ„è¯†åˆ°æœåŠ¡å™¨å·²ç»å´©æºƒï¼Œå¹¶å°†å…¶æ‰€æœ‰ç¼“å­˜å†…å®¹è§†ä¸ºå¯ç–‘å†…å®¹ï¼Œå¹¶ä¸”ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰åœ¨ä½¿ç”¨æ–‡ä»¶ä¹‹å‰é‡æ–°ç¡®å®šå…¶æœ‰æ•ˆæ€§ã€‚ å› æ­¤ï¼ŒæœåŠ¡å™¨å´©æºƒæ˜¯ä¸€ä»¶å¤§äº‹ï¼Œå› ä¸ºå¿…é¡»ç¡®ä¿æ¯ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½åŠæ—¶æ„è¯†åˆ°æœåŠ¡å™¨å´©æºƒï¼Œå¦åˆ™å®¢æˆ·ç«¯å°±æœ‰å¯èƒ½è®¿é—®è¿‡æœŸæ–‡ä»¶ã€‚å®ç°è¿™ç§æ¢å¤çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ï¼Œå½“æœåŠ¡å™¨é‡æ–°å¯åŠ¨å¹¶è¿è¡Œæ—¶ï¼Œè®©æœåŠ¡å™¨å‘æ¯ä¸ªå®¢æˆ·ç«¯å‘é€ä¸€æ¡æ¶ˆæ¯ï¼ˆè¯´ â€œä¸è¦ç›¸ä¿¡ä½ çš„ç¼“å­˜å†…å®¹ï¼\"ï¼‰ï¼Œæˆ–è€…è®©å®¢æˆ·ç«¯å®šæœŸæ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿˜æ´»ç€ï¼ˆå³æ‰€è°“çš„ â€œå¿ƒè·³æ¶ˆæ¯â€ï¼‰ã€‚æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå»ºç«‹ä¸€ä¸ªå¯æ‰©å±•æ€§æ›´å¼ºã€æ›´åˆç†çš„ç¼“å­˜æ¨¡å‹æ˜¯æœ‰ä»£ä»·çš„ï¼›åœ¨ NFS ä¸­ï¼Œå®¢æˆ·ç«¯å‡ ä¹ä¸ä¼šæ³¨æ„åˆ°æœåŠ¡å™¨å´©æºƒã€‚ ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:3","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 å¯æ‰©å±•æ€§å’Œæ€§èƒ½ é‡‡ç”¨æ–°åè®®åï¼Œå¯¹ AFSv2 è¿›è¡Œäº†æµ‹é‡ï¼Œå‘ç°å…¶å¯æ‰©å±•æ€§è¿œè¿œè¶…è¿‡åŸå§‹ç‰ˆæœ¬ã€‚äº‹å®ä¸Šï¼Œæ¯å°æœåŠ¡å™¨å¯ä»¥æ”¯æŒå¤§çº¦ 50 ä¸ªå®¢æˆ·ç«¯ï¼ˆè€Œä¸æ˜¯ 20 ä¸ªï¼‰ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå®¢æˆ·ç«¯çš„æ€§èƒ½å¾€å¾€éå¸¸æ¥è¿‘æœ¬åœ°æ€§èƒ½ï¼Œå› ä¸ºåœ¨æ™®é€šæƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ–‡ä»¶è®¿é—®éƒ½æ˜¯æœ¬åœ°çš„ï¼›æ–‡ä»¶è¯»å–é€šå¸¸ä¼šè¿›å…¥æœ¬åœ°ç£ç›˜ç¼“å­˜ï¼ˆä¹Ÿå¯èƒ½è¿›å…¥æœ¬åœ°å†…å­˜ï¼‰ã€‚åªæœ‰åœ¨å®¢æˆ·ç«¯åˆ›å»ºæ–°æ–‡ä»¶æˆ–å†™å…¥ç°æœ‰æ–‡ä»¶æ—¶ï¼Œæ‰éœ€è¦å‘æœåŠ¡å™¨å‘é€å­˜å‚¨ä¿¡æ¯ï¼Œä»è€Œç”¨æ–°å†…å®¹æ›´æ–°æ–‡ä»¶ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æ¯”è¾ƒå¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒ…å†µå’Œ NFS æ¥äº†è§£ AFS çš„æ€§èƒ½ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†å®šæ€§æ¯”è¾ƒçš„ç»“æœã€‚ åœ¨å›¾ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†ä¸åŒå¤§å°æ–‡ä»¶çš„å…¸å‹è¯»å†™æ¨¡å¼ã€‚å°æ–‡ä»¶æœ‰ $N_s$ ä¸ªå—ï¼›ä¸­ç­‰æ–‡ä»¶æœ‰ $N_m$ ä¸ªå—ï¼›å¤§æ–‡ä»¶æœ‰ $N_L$ ä¸ªå—ã€‚æˆ‘ä»¬å‡å®šï¼Œå°å‹å’Œä¸­å‹æ–‡ä»¶é€‚åˆæ”¾åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼›å¤§å‹æ–‡ä»¶é€‚åˆæ”¾åœ¨æœ¬åœ°ç£ç›˜ä¸Šï¼Œä½†ä¸é€‚åˆæ”¾åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ã€‚ ä¸ºä¾¿äºåˆ†æï¼Œæˆ‘ä»¬è¿˜å‡è®¾ï¼Œé€šè¿‡ç½‘ç»œè®¿é—®è¿œç¨‹æœåŠ¡å™¨çš„æ–‡ä»¶å—éœ€è¦ $L_{net}$ æ—¶é—´å•ä½ã€‚è®¿é—®æœ¬åœ°å†…å­˜éœ€è¦ $L_{mem}$ï¼Œè®¿é—®æœ¬åœ°ç£ç›˜éœ€è¦ $L_{disk}$ã€‚ä¸€èˆ¬å‡è®¾æ˜¯$L_{net} \u003e L_{disk} \u003e L_{mem}$ã€‚ æœ€åï¼Œæˆ‘ä»¬å‡è®¾å¯¹æ–‡ä»¶çš„é¦–æ¬¡è®¿é—®ä¸åœ¨ä»»ä½•ç¼“å­˜ä¸­å‘ç”Ÿã€‚å¦‚æœç›¸å…³ç¼“å­˜æœ‰è¶³å¤Ÿçš„å®¹é‡å®¹çº³æ–‡ä»¶ï¼Œæˆ‘ä»¬å‡è®¾å¯¹æ–‡ä»¶çš„åç»­è®¿é—®ï¼ˆå³ â€œé‡è¯»â€ï¼‰ä¼šåœ¨ç¼“å­˜ä¸­å‘½ä¸­ã€‚ å›¾ä¸­å„åˆ—æ˜¾ç¤ºäº†ç‰¹å®šæ“ä½œï¼ˆå¦‚å°æ–‡ä»¶é¡ºåºè¯»å–ï¼‰åœ¨ NFS æˆ– AFS ä¸Šå¤§è‡´èŠ±è´¹çš„æ—¶é—´ã€‚æœ€å³è¾¹ä¸€åˆ—æ˜¾ç¤ºçš„æ˜¯ AFS ä¸ NFS çš„æ¯”ä¾‹ã€‚ æˆ‘ä»¬å¾—å‡ºä»¥ä¸‹ç»“è®ºã€‚é¦–å…ˆï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ¯ä¸ªç³»ç»Ÿçš„æ€§èƒ½å¤§è‡´ç›¸å½“ã€‚ä¾‹å¦‚ï¼Œåœ¨é¦–æ¬¡è¯»å–æ–‡ä»¶æ—¶ï¼ˆå¦‚å·¥ä½œè´Ÿè½½ 1ã€3ã€5ï¼‰ï¼Œä»è¿œç¨‹æœåŠ¡å™¨è·å–æ–‡ä»¶çš„æ—¶é—´å ä¸»å¯¼åœ°ä½ï¼Œè€Œä¸”åœ¨ä¸¤ä¸ªç³»ç»Ÿä¸Šçš„æ—¶é—´ç›¸ä¼¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½ä¼šè®¤ä¸º AFS çš„é€Ÿåº¦ä¼šæ…¢ä¸€äº›ï¼Œå› ä¸ºå®ƒå¿…é¡»å°†æ–‡ä»¶å†™å…¥æœ¬åœ°ç£ç›˜ï¼›ä½†æ˜¯ï¼Œæœ¬åœ°ï¼ˆå®¢æˆ·ç«¯ï¼‰æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¼šå¯¹è¿™äº›å†™å…¥è¿›è¡Œç¼“å†²ï¼Œå› æ­¤ä¸Šè¿°æˆæœ¬å¾ˆå¯èƒ½æ˜¯éšæ€§çš„ã€‚åŒæ ·ï¼Œä½ å¯èƒ½ä¼šè®¤ä¸º AFS ä»æœ¬åœ°ç¼“å­˜å‰¯æœ¬è¯»å–æ–‡ä»¶çš„é€Ÿåº¦ä¼šæ›´æ…¢ï¼Œè¿™ä¹Ÿæ˜¯å› ä¸º AFS å°†ç¼“å­˜å‰¯æœ¬å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚ç„¶è€Œï¼ŒAFS ä¹Ÿèƒ½ä»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¸­è·ç›Šï¼›AFS ä¸Šçš„è¯»å–å¯èƒ½ä¼šåœ¨å®¢æˆ·ç«¯å†…å­˜ç¼“å­˜ä¸­è¿›è¡Œï¼Œæ€§èƒ½ä¸ NFS ç±»ä¼¼ã€‚ å…¶æ¬¡ï¼Œåœ¨å¤§æ–‡ä»¶é¡ºåºé‡è¯»ï¼ˆå·¥ä½œè´Ÿè½½ 6ï¼‰è¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€ä¸ªæœ‰è¶£çš„å·®å¼‚ã€‚ç”±äº AFS æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æœ¬åœ°ç£ç›˜ç¼“å­˜ï¼Œå½“æ–‡ä»¶å†æ¬¡è¢«è®¿é—®æ—¶ï¼Œå®ƒä¼šä»æœ¬åœ°ç£ç›˜ç¼“å­˜ä¸­è®¿é—®æ–‡ä»¶ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒNFS åªèƒ½ç¼“å­˜å®¢æˆ·ç«¯å†…å­˜ä¸­çš„æ•°æ®å—ï¼›å› æ­¤ï¼Œå¦‚æœé‡æ–°è¯»å–å¤§æ–‡ä»¶ï¼ˆå³å¤§äºæœ¬åœ°å†…å­˜çš„æ–‡ä»¶ï¼‰ï¼ŒNFS å®¢æˆ·ç«¯å°†ä¸å¾—ä¸ä»è¿œç¨‹æœåŠ¡å™¨é‡æ–°è·å–æ•´ä¸ªæ–‡ä»¶ã€‚å› æ­¤ï¼Œå‡è®¾è¿œç¨‹è®¿é—®ç¡®å®æ¯”æœ¬åœ°ç£ç›˜æ…¢ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒAFS æ¯” NFS å¿« $\\frac{L_{net}}{L_{disk}}$ çš„ç³»æ•°ã€‚æˆ‘ä»¬è¿˜æ³¨æ„åˆ°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒNFS ä¼šå¢åŠ æœåŠ¡å™¨è´Ÿè½½ï¼Œè¿™ä¹Ÿä¼šå¯¹æ‰©å±•æ€§äº§ç”Ÿå½±å“ã€‚ ç¬¬ä¸‰ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œé¡ºåºå†™å…¥ï¼ˆæ–°æ–‡ä»¶ï¼‰åœ¨ä¸¤ä¸ªç³»ç»Ÿä¸Šçš„æ‰§è¡Œæƒ…å†µç±»ä¼¼ï¼ˆå·¥ä½œè´Ÿè½½ 8ã€9ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒAFS ä¼šå°†æ–‡ä»¶å†™å…¥æœ¬åœ°ç¼“å­˜å‰¯æœ¬ï¼›å½“æ–‡ä»¶å…³é—­æ—¶ï¼ŒAFS å®¢æˆ·ç«¯ä¼šæ ¹æ®åè®®å¼ºåˆ¶å°†æ–‡ä»¶å†™å…¥æœåŠ¡å™¨ã€‚NFS ä¼šåœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ç¼“å†²å†™å…¥ï¼Œä¹Ÿè®¸ä¼šå› ä¸ºå®¢æˆ·ç«¯å†…å­˜å‹åŠ›è€Œå¼ºåˆ¶å°†æŸäº›å—å†™å…¥æœåŠ¡å™¨ï¼Œä½†åœ¨æ–‡ä»¶å…³é—­æ—¶è‚¯å®šä¼šå°†å®ƒä»¬å†™å…¥æœåŠ¡å™¨ï¼Œä»¥ä¿æŒ NFS çš„å…³é—­æ—¶åˆ·æ–°ä¸€è‡´æ€§ã€‚ä½ å¯èƒ½ä¼šè®¤ä¸º AFS çš„é€Ÿåº¦ä¼šæ›´æ…¢ï¼Œå› ä¸ºå®ƒä¼šå°†æ‰€æœ‰æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜ã€‚ä½†æ˜¯ï¼Œä½ è¦çŸ¥é“ï¼Œå®ƒæ˜¯åœ¨å‘æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå†™å…¥æ•°æ®ï¼›è¿™äº›å†™å…¥çš„æ•°æ®é¦–å…ˆæäº¤åˆ°é¡µé¢ç¼“å­˜ï¼Œç„¶åæ‰ï¼ˆåœ¨åå°ï¼‰æäº¤åˆ°ç£ç›˜ï¼Œå› æ­¤ AFS å¯ä»¥åˆ©ç”¨å®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿå†…å­˜ç¼“å­˜åŸºç¡€æ¶æ„çš„ä¼˜åŠ¿æ¥æé«˜æ€§èƒ½ã€‚ ç¬¬å››ï¼Œæˆ‘ä»¬æ³¨æ„åˆ° AFS åœ¨é¡ºåºæ–‡ä»¶è¦†ç›–ï¼ˆå·¥ä½œè´Ÿè½½ 10ï¼‰ä¸Šçš„æ€§èƒ½æ›´å·®ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡å®šå†™å…¥çš„å·¥ä½œè´Ÿè½½ä¹Ÿåœ¨åˆ›å»ºæ–°æ–‡ä»¶ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–‡ä»¶å­˜åœ¨ï¼Œç„¶åè¢«è¦†ç›–å†™å…¥ã€‚å¯¹äº AFS æ¥è¯´ï¼Œé‡å†™å¯èƒ½æ˜¯ä¸€ç§ç‰¹åˆ«ç³Ÿç³•çš„æƒ…å†µï¼Œå› ä¸ºå®¢æˆ·ç«¯é¦–å…ˆä¼šå®Œæ•´åœ°è·å–æ—§æ–‡ä»¶ï¼Œç„¶åå†å°†å…¶é‡å†™ã€‚ä¸æ­¤ç›¸åï¼ŒNFS åªéœ€è¦†ç›–å—ï¼Œä»è€Œé¿å…äº†æœ€åˆçš„ï¼ˆæ— ç”¨çš„ï¼‰è¯»å–ã€‚ æœ€åï¼Œè®¿é—®å¤§æ–‡ä»¶ä¸­ä¸€å°éƒ¨åˆ†æ•°æ®çš„å·¥ä½œè´Ÿè½½åœ¨ NFS ä¸Šçš„è¡¨ç°è¦æ¯” AFS å¥½å¾—å¤šï¼ˆå·¥ä½œè´Ÿè½½ 7ã€11ï¼‰ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼ŒAFS åè®®ä¼šåœ¨æ‰“å¼€æ–‡ä»¶æ—¶è·å–æ•´ä¸ªæ–‡ä»¶ï¼›ä½†ä¸å¹¸çš„æ˜¯ï¼Œåªä¼šæ‰§è¡Œå°‘é‡çš„è¯»å–æˆ–å†™å…¥æ“ä½œã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œæ•´ä¸ªæ–‡ä»¶éƒ½ä¼šè¢«å†™å›æœåŠ¡å™¨ï¼Œå¯¹æ€§èƒ½çš„å½±å“ä¼šåŠ å€ã€‚NFS ä½œä¸ºåŸºäºå—çš„åè®®ï¼Œæ‰§è¡Œçš„ I/O ä¸è¯»å–æˆ–å†™å…¥çš„å¤§å°æˆæ­£æ¯”ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬çœ‹åˆ° NFS å’Œ AFS çš„å‡è®¾ä¸åŒï¼Œå› æ­¤å®ç°çš„æ€§èƒ½ç»“æœä¹Ÿä¸åŒï¼Œè¿™å¹¶ä¸å¥‡æ€ªã€‚è¿™äº›å·®å¼‚æ˜¯å¦é‡è¦ï¼Œå§‹ç»ˆæ˜¯ä¸€ä¸ªå·¥ä½œè´Ÿè½½é—®é¢˜ã€‚ å·¥ä½œè´Ÿè½½çš„é‡è¦æ€§ è¯„ä¼°ä»»ä½•ç³»ç»Ÿçš„ä¸€å¤§æŒ‘æˆ˜æ˜¯å·¥ä½œè´Ÿè½½çš„é€‰æ‹©ã€‚ç”±äºè®¡ç®—æœºç³»ç»Ÿçš„ä½¿ç”¨æ–¹å¼å¤šç§å¤šæ ·ï¼Œå› æ­¤æœ‰å¤šç§å·¥ä½œè´Ÿè½½å¯ä¾›é€‰æ‹©ã€‚å­˜å‚¨ç³»ç»Ÿè®¾è®¡äººå‘˜åº”å¦‚ä½•ç¡®å®šå“ªäº›å·¥ä½œè´Ÿè½½æ˜¯é‡è¦çš„ï¼Œä»¥ä¾¿åšå‡ºåˆç†çš„è®¾è®¡å†³ç­–ï¼Ÿ AFS çš„è®¾è®¡è€…æ ¹æ®è¡¡é‡æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨æ–¹å¼çš„ç»éªŒï¼Œåšå‡ºäº†æŸäº›å·¥ä½œè´Ÿè½½å‡è®¾ï¼›ç‰¹åˆ«æ˜¯ï¼Œä»–ä»¬å‡è®¾å¤§å¤šæ•°æ–‡ä»¶ä¸ç»å¸¸å…±äº«ï¼Œå¹¶ä¸”æ•´ä½“ä¸ŠæŒ‰é¡ºåºè®¿é—®ã€‚è€ƒè™‘åˆ°è¿™äº›å‡è®¾ï¼ŒAFS è®¾è®¡å°±éå¸¸æœ‰æ„ä¹‰äº†ã€‚ ç„¶è€Œï¼Œè¿™äº›å‡è®¾å¹¶ä¸æ€»æ˜¯æ­£ç¡®çš„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºå®šæœŸå°†ä¿¡æ¯é™„åŠ åˆ°æ—¥å¿—ä¸­ã€‚è¿™äº›å°æ—¥å¿—å†™å…¥ä¼šå°†å°‘é‡æ•°æ®æ·»åŠ åˆ°ç°æœ‰çš„å¤§æ–‡ä»¶ä¸­ï¼Œè¿™å¯¹äº AFS æ¥è¯´æ˜¯ç›¸å½“æœ‰é—®é¢˜çš„ã€‚è¿˜å­˜åœ¨è®¸å¤šå…¶ä»–å›°éš¾çš„å·¥ä½œè´Ÿè½½ï¼Œä¾‹å¦‚äº‹åŠ¡æ•°æ®åº“ä¸­çš„éšæœºæ›´æ–°ã€‚ ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:4","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 AFSï¼šå…¶ä»–æ”¹è¿› å°±åƒæˆ‘ä»¬åœ¨å¼•å…¥ Berkeley FFSï¼ˆæ·»åŠ äº†ç¬¦å·é“¾æ¥å’Œè®¸å¤šå…¶ä»–åŠŸèƒ½ï¼‰æ—¶çœ‹åˆ°çš„é‚£æ ·ï¼ŒAFS çš„è®¾è®¡è€…åœ¨æ„å»ºç³»ç»Ÿæ—¶æŠ“ä½äº†æœºä¼šæ·»åŠ äº†è®¸å¤šåŠŸèƒ½ï¼Œä½¿ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨å’Œç®¡ç†ã€‚ä¾‹å¦‚ï¼ŒAFS ä¸ºå®¢æˆ·ç«¯æä¾›äº†çœŸæ­£çš„å…¨å±€å‘½åç©ºé—´ï¼Œä»è€Œç¡®ä¿æ‰€æœ‰æ–‡ä»¶åœ¨æ‰€æœ‰å®¢æˆ·ç«¯è®¡ç®—æœºä¸Šéƒ½ä»¥ç›¸åŒçš„æ–¹å¼å‘½åã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒNFS å…è®¸æ¯ä¸ªå®¢æˆ·ç«¯ä»¥ä»–ä»¬å–œæ¬¢çš„ä»»ä½•æ–¹å¼å®‰è£… NFS æœåŠ¡å™¨ï¼Œå› æ­¤åªæœ‰æŒ‰ç…§çº¦å®šï¼ˆä»¥åŠå¤§é‡çš„ç®¡ç†å·¥ä½œï¼‰ï¼Œæ–‡ä»¶æ‰èƒ½åœ¨å®¢æˆ·ç«¯ä¹‹é—´ä»¥ç±»ä¼¼çš„æ–¹å¼å‘½åã€‚ AFS è¿˜éå¸¸é‡è§†å®‰å…¨æ€§ï¼Œå¹¶é‡‡ç”¨äº†å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯çš„æœºåˆ¶ï¼Œå¹¶ç¡®ä¿å¦‚æœç”¨æˆ·æ„¿æ„ï¼Œå¯ä»¥å°†ä¸€ç»„æ–‡ä»¶ä¿æŒç§æœ‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒNFS å¤šå¹´æ¥å¯¹å®‰å…¨æ€§çš„æ”¯æŒç›¸å½“åŸå§‹ã€‚ AFS è¿˜åŒ…æ‹¬ç”¨äºçµæ´»çš„ç”¨æˆ·ç®¡ç†è®¿é—®æ§åˆ¶çš„è®¾æ–½ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ AFS æ—¶ï¼Œç”¨æˆ·å¯ä»¥å¾ˆå¥½åœ°æ§åˆ¶è°å¯ä»¥è®¿é—®å“ªäº›æ–‡ä»¶ã€‚ NFS ä¸å¤§å¤šæ•° UNIX æ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼Œå¯¹æ­¤ç±»å…±äº«çš„æ”¯æŒè¦å°‘å¾—å¤šã€‚ æœ€åï¼Œå¦‚å‰æ‰€è¿°ï¼ŒAFS æ·»åŠ äº†ä¸€äº›å·¥å…·ï¼Œä½¿ç³»ç»Ÿç®¡ç†å‘˜èƒ½å¤Ÿæ›´ç®€å•åœ°ç®¡ç†æœåŠ¡å™¨ã€‚åœ¨ç³»ç»Ÿç®¡ç†æ–¹é¢ï¼ŒAFS é¥é¥é¢†å…ˆäºè¯¥é¢†åŸŸã€‚ ","date":"2024-05-11","objectID":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:4:0","tags":["OS"],"title":"Andrewæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 åŸºæœ¬çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ åˆ†å¸ƒå¼å®¢æˆ·ç«¯/æœåŠ¡å™¨è®¡ç®—æœ€æ—©åº”ç”¨äºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿé¢†åŸŸã€‚åœ¨è¿™ç§ç¯å¢ƒä¸­ï¼Œæœ‰å¤šå°å®¢æˆ·æœºå’Œä¸€å°ï¼ˆæˆ–å‡ å°ï¼‰æœåŠ¡å™¨ï¼›æœåŠ¡å™¨å°†æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå®¢æˆ·æœºé€šè¿‡æ ¼å¼è‰¯å¥½çš„åè®®ä¿¡æ¯è¯·æ±‚æ•°æ®ã€‚ä¸‹å›¾æè¿°äº†åŸºæœ¬è®¾ç½®ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒæœåŠ¡å™¨æ‹¥æœ‰ç£ç›˜ï¼Œå®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œå‘é€æ¶ˆæ¯æ¥è®¿é—®è¿™äº›ç£ç›˜ä¸Šçš„ç›®å½•å’Œæ–‡ä»¶ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è´¹å¿ƒè¿™æ ·çš„å®‰æ’å‘¢ï¼Ÿ ï¼ˆå³ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸è®©å®¢æˆ·ç«¯ä½¿ç”¨ä»–ä»¬çš„æœ¬åœ°ç£ç›˜ï¼Ÿï¼‰å—¯ï¼Œä¸»è¦æ˜¯è¿™ç§è®¾ç½®å…è®¸åœ¨å®¢æˆ·ç«¯ä¹‹é—´è½»æ¾å…±äº«æ•°æ®ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨è®¿é—®ä¸€å°è®¡ç®—æœºï¼ˆå®¢æˆ·ç«¯ 0ï¼‰ä¸Šçš„æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨å¦ä¸€å°è®¡ç®—æœºï¼ˆå®¢æˆ·ç«¯ 2ï¼‰ï¼Œæ‚¨å°†æ‹¥æœ‰ç›¸åŒçš„æ–‡ä»¶ç³»ç»Ÿè§†å›¾ã€‚æ‚¨çš„æ•°æ®è‡ªç„¶ä¼šåœ¨è¿™äº›ä¸åŒçš„æœºå™¨ä¹‹é—´å…±äº«ã€‚ç¬¬äºŒä¸ªå¥½å¤„æ˜¯é›†ä¸­ç®¡ç†ï¼›ä¾‹å¦‚ï¼Œå¤‡ä»½æ–‡ä»¶å¯ä»¥ä»å°‘æ•°æœåŠ¡å™¨è®¡ç®—æœºè€Œä¸æ˜¯å¤šä¸ªå®¢æˆ·ç«¯å®Œæˆã€‚å¦ä¸€ä¸ªä¼˜åŠ¿å¯èƒ½æ˜¯å®‰å…¨æ€§ã€‚å°†æ‰€æœ‰æœåŠ¡å™¨æ”¾åœ¨ä¸Šé”çš„æœºæˆ¿ä¸­å¯ä»¥é˜²æ­¢å‡ºç°æŸäº›ç±»å‹çš„é—®é¢˜ã€‚ å› æ­¤å…³é”®é—®é¢˜æ˜¯ï¼š å¦‚ä½•æ„å»ºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Ÿéœ€è¦è€ƒè™‘å“ªäº›å…³é”®æ–¹é¢ï¼Ÿä»€ä¹ˆå®¹æ˜“å‡ºé”™ï¼Ÿæˆ‘ä»¬å¯ä»¥ä»ç°æœ‰ç³»ç»Ÿä¸­å­¦åˆ°ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬ç°åœ¨å°†ç ”ç©¶ç®€åŒ–çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„æ¶æ„ã€‚ä¸€ä¸ªç®€å•çš„å®¢æˆ·ç«¯/æœåŠ¡å™¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæ¯”æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢ç ”ç©¶çš„æ–‡ä»¶ç³»ç»Ÿå…·æœ‰æ›´å¤šçš„ç»„ä»¶ã€‚åœ¨å®¢æˆ·ç«¯ï¼Œæœ‰ä¸€äº›å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºé€šè¿‡å®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿè®¿é—®æ–‡ä»¶å’Œç›®å½•ã€‚å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå‘å®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå‘å‡ºç³»ç»Ÿè°ƒç”¨ï¼ˆä¾‹å¦‚ open()ã€read()ã€write()ã€close()ã€mkdir() ç­‰ï¼‰ï¼Œä»¥ä¾¿è®¿é—®å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚å› æ­¤ï¼Œå¯¹äºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œé™¤äº†æ€§èƒ½ä¹‹å¤–ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼¼ä¹ä¸æœ¬åœ°ï¼ˆåŸºäºç£ç›˜çš„ï¼‰æ–‡ä»¶ç³»ç»Ÿæ²¡æœ‰ä»»ä½•ä¸åŒã€‚è¿™æ ·ï¼Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæä¾›äº†å¯¹æ–‡ä»¶çš„é€æ˜è®¿é—®ï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ç›®æ ‡ï¼›æ¯•ç«Ÿï¼Œè°ä¼šæ„¿æ„ä½¿ç”¨ä¸€ä¸ªéœ€è¦ä¸åŒçš„åº”ç”¨ç¨‹åºæ¥å£æˆ–è€…ä½¿ç”¨èµ·æ¥å¾ˆéº»çƒ¦çš„æ–‡ä»¶ç³»ç»Ÿå‘¢ï¼Ÿ å®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿçš„ä½œç”¨æ˜¯æ‰§è¡ŒæœåŠ¡è¿™äº›ç³»ç»Ÿè°ƒç”¨æ‰€éœ€çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœå®¢æˆ·ç«¯å‘å‡º read() è¯·æ±‚ï¼Œå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå¯èƒ½ä¼šå‘æœåŠ¡å™¨ç«¯æ–‡ä»¶ç³»ç»Ÿï¼ˆæˆ–è€…é€šå¸¸ç§°ä¸ºæ–‡ä»¶æœåŠ¡å™¨ï¼‰å‘é€æ¶ˆæ¯ä»¥è¯»å–ç‰¹å®šå—ï¼›ç„¶åï¼Œæ–‡ä»¶æœåŠ¡å™¨å°†ä»ç£ç›˜ï¼ˆæˆ–å…¶è‡ªå·±çš„å†…å­˜ç¼“å­˜ï¼‰è¯»å–è¯¥å—ï¼Œå¹¶å°†åŒ…å«è¯·æ±‚æ•°æ®çš„æ¶ˆæ¯å‘é€å›å®¢æˆ·ç«¯ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿä¼šå°†æ•°æ®å¤åˆ¶åˆ°æä¾›ç»™ read() ç³»ç»Ÿè°ƒç”¨çš„ç”¨æˆ·ç¼“å†²åŒºä¸­ï¼Œä»è€Œå®Œæˆè¯·æ±‚ã€‚è¯·æ³¨æ„ï¼Œå®¢æˆ·ç«¯ä¸ŠåŒä¸€å—çš„åç»­ read() å¯èƒ½ä¼šç¼“å­˜åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼Œç”šè‡³ç¼“å­˜åœ¨å®¢æˆ·ç«¯ç£ç›˜ä¸Šï¼›åœ¨æœ€å¥½çš„æƒ…å†µä¸‹ï¼Œä¸éœ€è¦äº§ç”Ÿç½‘ç»œæµé‡ã€‚ ä»è¿™ä¸ªç®€å•çš„æ¦‚è¿°ä¸­ï¼Œæ‚¨åº”è¯¥äº†è§£åˆ°å®¢æˆ·ç«¯/æœåŠ¡å™¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„è½¯ä»¶éƒ¨åˆ†ï¼šå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå’Œæ–‡ä»¶æœåŠ¡å™¨ã€‚å®ƒä»¬çš„è¡Œä¸ºå…±åŒå†³å®šäº†åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„è¡Œä¸ºã€‚ç°åœ¨æ˜¯æ—¶å€™ç ”ç©¶ä¸€ä¸ªç‰¹å®šçš„ç³»ç»Ÿäº†ï¼šSun çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ (NFS)ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:1:0","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNFSï¼‰ Sun Microsystems å…¬å¸å¼€å‘çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯æœ€æ—©ä¹Ÿæ˜¯ç›¸å½“æˆåŠŸçš„åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹ä¸€ï¼Œè¢«ç§°ä¸º Sun ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆæˆ– NFSï¼‰ã€‚åœ¨å®šä¹‰ NFS æ—¶ï¼ŒSun é‡‡ç”¨äº†ä¸€ç§ä¸åŒå¯»å¸¸çš„æ–¹æ³•ï¼šSun æ²¡æœ‰æ„å»ºä¸€ä¸ªä¸“æœ‰çš„å°é—­ç³»ç»Ÿï¼Œè€Œæ˜¯å¼€å‘äº†ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œç®€å•åœ°è§„å®šäº†å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ç”¨äºé€šä¿¡çš„ç¡®åˆ‡ä¿¡æ¯æ ¼å¼ã€‚ä¸åŒçš„å›¢ä½“å¯ä»¥å¼€å‘è‡ªå·±çš„ NFS æœåŠ¡å™¨ï¼Œä»è€Œåœ¨ NFS å¸‚åœºä¸Šç«äº‰ï¼ŒåŒæ—¶ä¿æŒäº’æ“ä½œæ€§ã€‚è¿™ç§åšæ³•å–å¾—äº†æˆåŠŸï¼šå¦‚ä»Šæœ‰è®¸å¤šå…¬å¸éƒ½åœ¨é”€å”® NFS æœåŠ¡å™¨ï¼ˆåŒ…æ‹¬ Oracle/Sunã€NetAppã€EMCã€IBM å’Œå…¶ä»–å…¬å¸ï¼‰ï¼ŒNFS çš„å¹¿æ³›æˆåŠŸå¾ˆå¯èƒ½å½’åŠŸäºè¿™ç§ â€œå¼€æ”¾å¸‚åœº â€œæ–¹æ³•ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:0","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 é‡ç‚¹ï¼šç®€å•å¿«é€Ÿçš„æœåŠ¡å™¨å´©æºƒæ¢å¤ åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºç»å…¸çš„ NFS åè®®ï¼ˆç‰ˆæœ¬ 2ï¼Œåˆç§° NFSv2ï¼‰ï¼Œè¯¥åè®®æ˜¯å¤šå¹´æ¥çš„æ ‡å‡†ï¼›åœ¨å‘ NFSv3 è¿ç§»æ—¶è¿›è¡Œäº†ä¸€äº›å°æ”¹åŠ¨ï¼Œåœ¨å‘ NFSv4 è¿ç§»æ—¶è¿›è¡Œäº†æ›´å¤§è§„æ¨¡çš„åè®®æ”¹åŠ¨ã€‚ç„¶è€Œï¼ŒNFSv2 æ—¢ç²¾å½©åˆä»¤äººæ²®ä¸§ï¼Œå› æ­¤æˆä¸ºæˆ‘ä»¬å…³æ³¨çš„ç„¦ç‚¹ã€‚åœ¨ NFSv2 ä¸­ï¼Œåè®®è®¾è®¡çš„ä¸»è¦ç›®æ ‡æ˜¯ç®€å•å¿«é€Ÿåœ°æ¢å¤æœåŠ¡å™¨å´©æºƒã€‚åœ¨å¤šå®¢æˆ·ç«¯ã€å•æœåŠ¡å™¨çš„ç¯å¢ƒä¸­ï¼Œè¿™ä¸€ç›®æ ‡æ˜¯éå¸¸åˆç†çš„ï¼›æœåŠ¡å™¨å®•æœºï¼ˆæˆ–ä¸å¯ç”¨ï¼‰çš„ä»»ä½•ä¸€åˆ†é’Ÿéƒ½ä¼šè®©æ‰€æœ‰å®¢æˆ·ç«¯æœºå™¨ï¼ˆåŠå…¶ç”¨æˆ·ï¼‰ä¸é«˜å…´ï¼Œå¹¶å½±å“å·¥ä½œæ•ˆç‡ã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨å®äº†ï¼Œæ•´ä¸ªç³»ç»Ÿä¹Ÿå°±å®äº†ã€‚ 2.1.1 å¿«é€Ÿå´©æºƒæ¢å¤çš„å…³é”®ï¼šæ— çŠ¶æ€ NFSv2 é€šè¿‡è®¾è®¡æ— çŠ¶æ€åè®®å®ç°äº†è¿™ä¸€ç®€å•ç›®æ ‡ã€‚æ ¹æ®è®¾è®¡ï¼ŒæœåŠ¡å™¨ä¸ä¼šè·Ÿè¸ªæ¯ä¸ªå®¢æˆ·ç«¯æ­£åœ¨å‘ç”Ÿçš„ä»»ä½•äº‹æƒ…ã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å“ªäº›å®¢æˆ·ç«¯æ­£åœ¨ç¼“å­˜å“ªäº›æ•°æ®å—ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªå®¢æˆ·ç«¯å½“å‰æ‰“å¼€äº†å“ªäº›æ–‡ä»¶ï¼Œæ›´ä¸çŸ¥é“æ–‡ä»¶çš„å½“å‰æ–‡ä»¶æŒ‡é’ˆä½ç½®ç­‰ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒæœåŠ¡å™¨ä¸ä¼šè·Ÿè¸ªå®¢æˆ·ç«¯æ­£åœ¨åšçš„ä»»ä½•äº‹æƒ…ï¼›ç›¸åï¼Œåè®®çš„è®¾è®¡ç›®çš„æ˜¯åœ¨æ¯ä¸ªåè®®è¯·æ±‚ä¸­æä¾›å®Œæˆè¯·æ±‚æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚ æœ‰çŠ¶æ€ï¼ˆéæ— çŠ¶æ€ï¼‰åè®®çš„ä¸€ä¸ªä¾‹å­æ˜¯ open() ç³»ç»Ÿè°ƒç”¨ã€‚ç»™å®šä¸€ä¸ªè·¯å¾„åï¼Œopen() è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆæ•´æ•°ï¼‰ã€‚è¯¥æè¿°ç¬¦å°†ç”¨äºåç»­çš„ read() æˆ– write() è¯·æ±‚ï¼Œä»¥è®¿é—®å„ç§æ–‡ä»¶å—ï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼š char buffer[MAX]; int fd = open(\"foo\", O_RDONLY); // get descriptor \"fd\" read(fd, buffer, MAX); // read MAX bytes from foo (via fd) read(fd, buffer, MAX); // read MAX bytes from foo ... read(fd, buffer, MAX); // read MAX bytes from foo close(fd); // close file ç°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼Œå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿé€šè¿‡å‘æœåŠ¡å™¨å‘é€ä¸€æ¡åè®®æ¶ˆæ¯â€œæ‰“å¼€æ–‡ä»¶â€˜fooâ€™å¹¶ç»™æˆ‘è¿”å›ä¸€ä¸ªæè¿°ç¬¦â€æ¥æ‰“å¼€æ–‡ä»¶ã€‚ç„¶åï¼Œæ–‡ä»¶æœåŠ¡å™¨åœ¨å…¶æœ¬åœ°æ‰“å¼€è¯¥æ–‡ä»¶å¹¶å°†æè¿°ç¬¦å‘é€å›å®¢æˆ·ç«¯ã€‚åœ¨åç»­è¯»å–ä¸­ï¼Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä½¿ç”¨è¯¥æè¿°ç¬¦æ¥è°ƒç”¨ read() ç³»ç»Ÿè°ƒç”¨ï¼›ç„¶åï¼Œå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå°†æ¶ˆæ¯ä¸­çš„æè¿°ç¬¦ä¼ é€’ç»™æ–‡ä»¶æœåŠ¡å™¨ï¼Œè¡¨ç¤ºâ€œä»æˆ‘ä¼ é€’ç»™æ‚¨çš„æè¿°ç¬¦æ‰€å¼•ç”¨çš„æ–‡ä»¶ä¸­è¯»å–ä¸€äº›å­—èŠ‚â€ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¸€æ®µå…±äº«çŠ¶æ€ï¼ˆOusterhout ç§°ä¹‹ä¸ºåˆ†å¸ƒå¼çŠ¶æ€ï¼‰ã€‚æ­£å¦‚æˆ‘ä»¬ä¸Šé¢æ‰€æš—ç¤ºçš„ï¼Œå…±äº«çŠ¶æ€ä½¿å´©æºƒæ¢å¤å˜å¾—å¤æ‚ã€‚æƒ³è±¡ä¸€ä¸‹ï¼ŒæœåŠ¡å™¨åœ¨ç¬¬ä¸€æ¬¡è¯»å–å®Œæˆåã€å®¢æˆ·ç«¯å‘å‡ºç¬¬äºŒæ¬¡è¯»å–ä¹‹å‰å´©æºƒäº†ã€‚æœåŠ¡å™¨é‡æ–°å¯åŠ¨å¹¶è¿è¡Œåï¼Œå®¢æˆ·ç«¯ä¼šå‘å‡ºç¬¬äºŒæ¬¡è¯»å–ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“ fd å¼•ç”¨çš„æ˜¯å“ªä¸ªæ–‡ä»¶ï¼›è¯¥ä¿¡æ¯æ˜¯çŸ­æš‚çš„ï¼ˆå³åœ¨å†…å­˜ä¸­ï¼‰ï¼Œå› æ­¤å½“æœåŠ¡å™¨å´©æºƒæ—¶å°±ä¼šä¸¢å¤±ã€‚ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¿…é¡»å‚ä¸æŸç§æ¢å¤åè®®ï¼Œå®¢æˆ·ç«¯å°†ç¡®ä¿åœ¨å…¶å†…å­˜ä¸­ä¿ç•™è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä»¥ä¾¿èƒ½å¤Ÿå‘Šè¯‰æœåŠ¡å™¨å®ƒéœ€è¦çŸ¥é“ä»€ä¹ˆï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ ï¼Œè¯¥æ–‡ä»¶æè¿°ç¬¦ fd å¼•ç”¨æ–‡ä»¶ foo) å½“æ‚¨è€ƒè™‘æœ‰çŠ¶æ€æœåŠ¡å™¨å¿…é¡»å¤„ç†å®¢æˆ·ç«¯å´©æºƒè¿™ä¸€äº‹å®æ—¶ï¼Œæƒ…å†µä¼šå˜å¾—æ›´ç³Ÿã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç„¶åå´©æºƒäº†ã€‚ open() ä½¿ç”¨äº†æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æè¿°ç¬¦ï¼›æœåŠ¡å™¨å¦‚ä½•çŸ¥é“å¯ä»¥å…³é—­ç»™å®šæ–‡ä»¶ï¼Ÿåœ¨æ­£å¸¸æ“ä½œä¸­ï¼Œå®¢æˆ·ç«¯æœ€ç»ˆä¼šè°ƒç”¨ close() ï¼Œä»è€Œé€šçŸ¥æœåŠ¡å™¨åº”è¯¥å…³é—­æ–‡ä»¶ã€‚ç„¶è€Œï¼Œå½“å®¢æˆ·ç«¯å´©æºƒæ—¶ï¼ŒæœåŠ¡å™¨æ°¸è¿œä¸ä¼šæ”¶åˆ° close()ï¼Œå› æ­¤å¿…é¡»æ³¨æ„åˆ°å®¢æˆ·ç«¯å·²å´©æºƒæ‰èƒ½å…³é—­æ–‡ä»¶ã€‚ å‡ºäºè¿™äº›åŸå› ï¼ŒNFS çš„è®¾è®¡è€…å†³å®šé‡‡ç”¨æ— çŠ¶æ€æ–¹æ³•ï¼šæ¯ä¸ªå®¢æˆ·ç«¯æ“ä½œéƒ½åŒ…å«å®Œæˆè¯·æ±‚æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚ä¸éœ€è¦èŠ±å“¨çš„å´©æºƒæ¢å¤ï¼›æœåŠ¡å™¨åˆšåˆšé‡æ–°å¼€å§‹è¿è¡Œï¼Œè€Œå®¢æˆ·ç«¯åœ¨æœ€åçš„æƒ…å†µä¸‹å¯èƒ½å¿…é¡»é‡è¯•è¯·æ±‚ã€‚ 2.1.2 NFSv2 åè®® ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—å‡ºäº† NFSv2 åè®®çš„å®šä¹‰ã€‚æˆ‘ä»¬çš„é—®é¢˜é™ˆè¿°å¾ˆç®€å•ï¼š å¦‚ä½•å®šä¹‰æ— çŠ¶æ€æ–‡ä»¶åè®® å¦‚ä½•å®šä¹‰ç½‘ç»œåè®®ä»¥å®ç°æ— çŠ¶æ€æ“ä½œï¼Ÿæ˜¾ç„¶ï¼Œåƒ open() è¿™æ ·çš„æœ‰çŠ¶æ€è°ƒç”¨ä¸èƒ½ä½œä¸ºè®¨è®ºçš„ä¸€éƒ¨åˆ†ï¼ˆå› ä¸ºè¿™éœ€è¦æœåŠ¡å™¨è·Ÿè¸ªæ‰“å¼€çš„æ–‡ä»¶ï¼‰ï¼›ä½†æ˜¯ï¼Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¼šå¸Œæœ›è°ƒç”¨ open()ã€read()ã€write()ã€close() å’Œå…¶ä»–æ ‡å‡† API è°ƒç”¨æ¥è®¿é—®æ–‡ä»¶å’Œç›®å½•ã€‚å› æ­¤ï¼Œä½œä¸ºä¸€ä¸ªç»†åŒ–çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å®šä¹‰åè®®æ‰èƒ½æ—¢æ— çŠ¶æ€åˆæ”¯æŒ POSIX æ–‡ä»¶ç³»ç»Ÿ API å‘¢ï¼Ÿ ç†è§£ NFS åè®®è®¾è®¡çš„å…³é”®ä¹‹ä¸€æ˜¯ç†è§£æ–‡ä»¶å¥æŸ„ã€‚æ–‡ä»¶å¥æŸ„ç”¨äºå”¯ä¸€æè¿°ç‰¹å®šæ“ä½œè¦æ“ä½œçš„æ–‡ä»¶æˆ–ç›®å½•ï¼›å› æ­¤ï¼Œè®¸å¤šåè®®è¯·æ±‚éƒ½åŒ…å«ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ã€‚ ä½ å¯ä»¥è®¤ä¸ºæ–‡ä»¶å¥æŸ„æœ‰ä¸‰ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼šå·æ ‡è¯†ç¬¦ã€inodeå·å’Œç”Ÿæˆå·ï¼›è¿™ä¸‰è€…å…±åŒæ„æˆäº†å®¢æˆ·ç«¯å¸Œæœ›è®¿é—®çš„æ–‡ä»¶æˆ–ç›®å½•çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ å·æ ‡è¯†ç¬¦å‘ŠçŸ¥æœåŠ¡å™¨è¯¥è¯·æ±‚æŒ‡å‘å“ªä¸ªæ–‡ä»¶ç³»ç»Ÿï¼ˆä¸€ä¸ª NFS æœåŠ¡å™¨å¯ä»¥å¯¼å‡ºå¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼› Inodeå·å‘Šè¯‰æœåŠ¡å™¨è¯¥è¯·æ±‚è®¿é—®çš„æ˜¯è¯¥åˆ†åŒºä¸­çš„å“ªä¸ªæ–‡ä»¶ã€‚ æœ€åï¼Œåœ¨é‡å¤ä½¿ç”¨inodeå·æ—¶éœ€è¦ä½¿ç”¨ç”Ÿæˆå·ï¼›æ¯å½“é‡å¤ä½¿ç”¨ä¸€ä¸ªinodeå·æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šé€’å¢ç”Ÿæˆå·ï¼Œä»¥ç¡®ä¿ä½¿ç”¨æ—§æ–‡ä»¶å¥æŸ„çš„å®¢æˆ·ç«¯ä¸ä¼šæ„å¤–è®¿é—®æ–°åˆ†é…çš„æ–‡ä»¶ã€‚ ä»¥ä¸‹æ˜¯åè®®ä¸­ä¸€äº›é‡è¦éƒ¨åˆ†çš„æ‘˜è¦ï¼›å®Œæ•´çš„åè®®å¯ä»å…¶ä»–åœ°æ–¹è·å¾—ã€‚ NFSPROC_GETATTR: # æœŸæœ›ï¼šæ–‡ä»¶å¥æŸ„ # è¿”å›ï¼šå±æ€§ expects: file handle returns: attributes NFSPROC_SETATTR: # æœŸæœ›ï¼šæ–‡ä»¶å¥æŸ„ï¼Œå±æ€§ # è¿”å›ï¼šæ—  expects: file handle, attributes returns: nothing NFSPROC_LOOKUP: # æœŸæœ›ï¼šç›®å½•æ–‡ä»¶å¥æŸ„ï¼Œè¦æŸ¥æ‰¾çš„æ–‡ä»¶/ç›®å½•çš„åç§° # è¿”å›ï¼šæ–‡ä»¶å¥æŸ„ expects: directory file handle, name of file/directory to look up returns: file handle NFSPROC_READ: # æœŸæœ›ï¼šæ–‡ä»¶å¥æŸ„ï¼Œåç§»é‡ï¼Œè®¡æ•° # è¿”å›ï¼šæ•°æ®ï¼Œå±æ€§ expects: file handle, offset, count returns: data, attributes NFSPROC_WRITE: # æœŸæœ›ï¼šæ–‡ä»¶å¥æŸ„ï¼Œåç§»é‡ï¼Œè®¡æ•°ï¼Œæ•°æ® # è¿”å›ï¼šå±æ€§ expects: file handle, offset, count, data returns: attributes NFSPROC_CREATE: # æœŸæœ›ï¼šç›®å½•æ–‡ä»¶å¥æŸ„ï¼Œæ–‡ä»¶åï¼Œå±æ€§ # è¿”å›ï¼šæ—  expects: directory file handle, name of file, attributes returns: nothing NFSPROC_REMOVE: # æœŸæœ›ï¼šç›®å½•æ–‡ä»¶å¥æŸ„ï¼Œè¦ç§»é™¤çš„æ–‡ä»¶å # è¿”å›ï¼šæ—  expects: directory file handle, name of file to be removed returns: nothing NFSPROC_MKDIR: # æœŸæœ›ï¼šç›®å½•æ–‡ä»¶å¥æŸ„ï¼Œç›®å½•åï¼Œå±æ€§ # è¿”å›ï¼šæ–‡ä»¶å¥æŸ„ expects: directory file handle, name of directory, attributes returns: file handle NFSPROC_RMDIR: # æœŸæœ›ï¼šç›®å½•æ–‡ä»¶å¥æŸ„ï¼Œè¦ç§»é™¤çš„ç›®å½•å # è¿”å›ï¼šæ—  expects: directory file handle, name of directory to be removed returns: nothing NFSPROC_READDIR: # æœŸæœ›ï¼šç›®å½•å¥æŸ„ï¼Œè¦è¯»å–çš„å­—èŠ‚æ•°ï¼Œæ ‡è¯†ç¬¦ # è¿”å›ï¼šç›®å½•æ¡ç›®ï¼Œæ ‡è¯†ç¬¦ï¼ˆä»¥è·å–æ›´å¤šæ¡ç›®ï¼‰ expects: directory handle, count of bytes to read, cookie returns: directory entries, cookie (to get more entries) æˆ‘ä»¬ç®€è¦ä»‹ç»ä¸€ä¸‹åè®®çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚é¦–å…ˆï¼ŒLOOKUP åè®®æŠ¥æ–‡ç”¨äºè·å–æ–‡ä»¶å¥æŸ„ï¼Œç„¶åä½¿ç”¨è¯¥å¥æŸ„è®¿é—®æ–‡ä»¶æ•°æ®ã€‚å®¢æˆ·ç«¯ä¼ é€’ä¸€ä¸ªç›®å½•æ–‡ä»¶å¥æŸ„å’Œè¦æŸ¥æ‰¾çš„æ–‡ä»¶åï¼ŒæœåŠ¡å™¨ä¼šå°†è¯¥æ–‡ä»¶ï¼ˆæˆ–ç›®å½•ï¼‰çš„å¥æŸ„åŠå…¶å±æ€§ä¼ å›å®¢æˆ·ç«¯ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾å®¢æˆ·ç«¯å·²ç»æ‹¥æœ‰æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½• (/) çš„ç›®å½•æ–‡ä»¶å¥æŸ„ï¼ˆå®é™…ä¸Šï¼Œè¿™å¯ä»¥é€šè¿‡ NFS æŒ‚è½½åè®®è·å¾—ï¼Œè¿™æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é¦–æ¬¡è¿æ¥çš„æ–¹å¼ï¼›ä¸ºç®€æ´èµ·è§ï¼Œæˆ‘ä»¬åœ¨æ­¤ä¸è®¨è®ºæŒ‚è½½åè®®ï¼‰ã€‚å¦‚æœåœ¨å®¢æˆ·ç«¯è¿è¡Œçš„åº”ç”¨ç¨‹åºæ‰“å¼€æ–‡ä»¶ /foo.txtï¼Œå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå°±ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªæŸ¥æ‰¾è¯·æ±‚ï¼Œå°†æ ¹æ–‡ä»¶å¥æŸ„å’Œæ–‡ä»¶å foo.txt ä¼ é€’ç»™æœåŠ¡å™¨ï¼›å¦‚æœè¯·æ±‚æˆåŠŸï¼Œå°±ä¼šè¿”å› foo.txt çš„æ–‡ä»¶å¥æŸ„ï¼ˆå’Œå±æ€§ï¼‰ã€‚ å¦‚æœä½ æƒ³çŸ¥é“ï¼Œå±æ€§åªæ˜¯æ–‡ä»¶ç³»ç»Ÿè·Ÿè¸ªæ¯ä¸ªæ–‡ä»¶çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬æ–‡ä»¶åˆ›å»ºæ—¶é—´ã€æœ€åä¿®æ”¹æ—¶é—´ã€å¤§å°ã€æ‰€æœ‰æƒå’Œæƒé™ä¿¡æ¯ç­‰å­—æ®µï¼Œä¹Ÿå°±æ˜¯åœ¨æ–‡ä»¶ä¸Šè°ƒç”¨ stat() æ—¶ä¼šè¿”å›çš„ä¿¡æ¯ã€‚ ä¸€æ—¦æœ‰äº†æ–‡ä»¶å¥æŸ„ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥å¯¹æ–‡ä»¶å‘å‡º READ å’Œ WRITE åè®®æ¶ˆæ¯ï¼Œåˆ†åˆ«è¯»å–æˆ–å†™å…¥æ–‡ä»¶ã€‚è¯»å–åè®®æ¶ˆæ¯è¦æ±‚ä¼ é€’æ–‡ä»¶å¥æŸ„ã€æ–‡ä»¶åç§»é‡å’Œè¦è¯»å–çš„å­—èŠ‚æ•°ã€‚ç„¶åï¼ŒæœåŠ¡å™¨å°±èƒ½å‘å‡ºè¯»å–å‘½ä»¤ï¼ˆæ¯•ç«Ÿï¼Œå¥æŸ„ä¼šå‘Šè¯‰æœåŠ¡å™¨è¦ä»å“ªä¸ªå·å’Œå“ªä¸ª inode è¯»å–ï¼Œåç§»é‡å’Œå­—èŠ‚æ•°ä¼šå‘Šè¯‰æœåŠ¡å™¨è¦è¯»å–æ–‡ä»¶çš„å“ªä¸ªå­—èŠ‚ï¼‰ï¼Œå¹¶å°†æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼ˆå¦‚æœè¯»å–å¤±è´¥ï¼Œåˆ™è¿”å›é”™è¯¯ä¿¡æ¯ï¼‰ã€‚å†™å…¥ï¼ˆWRITEï¼‰çš„å¤„ç†æ–¹å¼ä¸æ­¤ç±»ä¼¼ï¼Œåªæ˜¯æ•°æ®ä»å®¢æˆ·ç«¯ä¼ é€’åˆ°æœåŠ¡å™¨ï¼Œå¹¶åªè¿”å›ä¸€ä¸ªæˆåŠŸä»£ç ã€‚ æœ€åä¸€ä¸ªæœ‰è¶£çš„åè®®ä¿¡æ¯æ˜¯ GETATTR è¯·æ±‚ï¼›ç»™å®šä¸€ä¸ªæ–‡ä»¶å¥æŸ„åï¼Œå®ƒåªéœ€è·å–è¯¥æ–‡ä»¶çš„å±æ€§ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚åœ¨ä¸‹æ–‡è®¨è®ºç¼“å­˜æ—¶ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¯¥åè®®è¯·æ±‚åœ¨ NFSv2 ä¸­çš„é‡è¦æ€§ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:1","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 ä»åè®®åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ å¸Œæœ›æ‚¨ç°åœ¨å·²ç»äº†è§£å¦‚ä½•å°†è¯¥åè®®è½¬å˜ä¸ºè·¨å®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå’Œæ–‡ä»¶æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚å®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿè·Ÿè¸ªæ‰“å¼€çš„æ–‡ä»¶ï¼Œå¹¶ä¸”é€šå¸¸å°†åº”ç”¨ç¨‹åºè¯·æ±‚è½¬æ¢ä¸ºç›¸å…³çš„åè®®æ¶ˆæ¯é›†ã€‚æœåŠ¡å™¨åªæ˜¯å“åº”åè®®æ¶ˆæ¯ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½åŒ…å«å®Œæˆè¯·æ±‚æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„ç®€å•åº”ç”¨ç¨‹åºã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬æ˜¾ç¤ºäº†åº”ç”¨ç¨‹åºè¿›è¡Œäº†å“ªäº›ç³»ç»Ÿè°ƒç”¨ï¼Œä»¥åŠå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå’Œæ–‡ä»¶æœåŠ¡å™¨å“åº”æ­¤ç±»è°ƒç”¨æ—¶æ‰§è¡Œçš„æ“ä½œã€‚ é¦–å…ˆï¼Œæ³¨æ„å®¢æˆ·ç«¯å¦‚ä½•è·Ÿè¸ªæ–‡ä»¶è®¿é—®çš„æ‰€æœ‰ç›¸å…³çŠ¶æ€ï¼ŒåŒ…æ‹¬æ•´æ•°æ–‡ä»¶æè¿°ç¬¦åˆ° NFS æ–‡ä»¶å¥æŸ„çš„æ˜ å°„ä»¥åŠå½“å‰æ–‡ä»¶æŒ‡é’ˆã€‚è¿™ä½¿å¾—å®¢æˆ·ç«¯èƒ½å¤Ÿå°†æ¯ä¸ªè¯»å–è¯·æ±‚ï¼ˆæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæ²¡æœ‰æ˜ç¡®æŒ‡å®šè¦è¯»å–çš„åç§»é‡ï¼‰è½¬æ¢ä¸ºæ ¼å¼æ­£ç¡®çš„è¯»å–åè®®æ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯å‡†ç¡®åœ°å‘Šè¯‰æœåŠ¡å™¨è¦è¯»å–æ–‡ä»¶ä¸­çš„å“ªäº›å­—èŠ‚ã€‚æˆåŠŸè¯»å–åï¼Œå®¢æˆ·ç«¯æ›´æ–°å½“å‰æ–‡ä»¶ä½ç½®ï¼›åç»­è¯»å–å°†ä½¿ç”¨ç›¸åŒçš„æ–‡ä»¶å¥æŸ„ä½†åç§»é‡ä¸åŒã€‚ å…¶æ¬¡ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°æœåŠ¡å™¨äº¤äº’å‘ç”Ÿçš„ä½ç½®ã€‚å½“æ–‡ä»¶ç¬¬ä¸€æ¬¡æ‰“å¼€æ—¶ï¼Œå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿä¼šå‘é€ä¸€ä¸ªLOOKUPè¯·æ±‚æ¶ˆæ¯ã€‚äº‹å®ä¸Šï¼Œå¦‚æœå¿…é¡»éå†é•¿è·¯å¾„åï¼ˆä¾‹å¦‚ï¼Œ/home/zfhe/foo.txtï¼‰ï¼Œå®¢æˆ·ç«¯å°†å‘é€ä¸‰ä¸ª LOOKUPï¼šä¸€ä¸ªåœ¨ç›®å½• / ä¸­æŸ¥æ‰¾ homeï¼Œä¸€ä¸ªåœ¨ home ä¸­æŸ¥æ‰¾ zfheï¼Œæœ€åä¸€ä¸ªåœ¨ zfhe ä¸­æŸ¥æ‰¾ foo.txtã€‚ ç¬¬ä¸‰ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„æ¯ä¸ªæœåŠ¡å™¨è¯·æ±‚éƒ½åŒ…å«å®Œæˆè¯·æ±‚æ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ã€‚è¿™ä¸ªè®¾è®¡è¦ç‚¹å¯¹äºä»æœåŠ¡å™¨æ•…éšœä¸­ä»å®¹æ¢å¤è‡³å…³é‡è¦ï¼Œæˆ‘ä»¬ç°åœ¨å°†è¯¦ç»†è®¨è®ºï¼›å®ƒç¡®ä¿æœåŠ¡å™¨ä¸éœ€è¦çŠ¶æ€å°±èƒ½å“åº”è¯·æ±‚ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:2","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 ä½¿ç”¨å¹‚ç­‰æ“ä½œå¤„ç†æœåŠ¡å™¨æ•…éšœ å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯æ—¶ï¼Œæœ‰æ—¶ä¼šæ”¶ä¸åˆ°å›å¤ã€‚é€ æˆè¿™ç§æ— æ³•å›å¤çš„åŸå› æœ‰å¾ˆå¤šã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¿¡æ¯å¯èƒ½è¢«ç½‘ç»œä¸¢å¼ƒï¼›ç½‘ç»œç¡®å®ä¼šä¸¢å¤±ä¿¡æ¯ï¼Œå› æ­¤è¯·æ±‚æˆ–å›å¤éƒ½å¯èƒ½ä¸¢å¤±ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±æ°¸è¿œä¸ä¼šæ”¶åˆ°å›å¤ã€‚ ä¹Ÿæœ‰å¯èƒ½æ˜¯æœåŠ¡å™¨å´©æºƒäº†ï¼Œå› æ­¤ç›®å‰æ²¡æœ‰å“åº”ä¿¡æ¯ã€‚ä¸€æ®µæ—¶é—´åï¼ŒæœåŠ¡å™¨å°†é‡æ–°å¯åŠ¨å¹¶é‡æ–°å¼€å§‹è¿è¡Œï¼Œä½†åœ¨æ­¤æœŸé—´ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å·²ä¸¢å¤±ã€‚åœ¨æ‰€æœ‰è¿™äº›æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯éƒ½ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šå½“æœåŠ¡å™¨æœªèƒ½åŠæ—¶å›å¤æ—¶è¯¥æ€ä¹ˆåŠï¼Ÿ åœ¨ NFSv2 ä¸­ï¼Œå®¢æˆ·ç«¯ä»¥ä¸€ç§å•ä¸€ã€ç»Ÿä¸€å’Œä¼˜é›…çš„æ–¹å¼å¤„ç†æ‰€æœ‰è¿™äº›æ•…éšœï¼šåªéœ€é‡è¯•è¯·æ±‚å³å¯ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨å‘é€è¯·æ±‚åï¼Œå®¢æˆ·ç«¯ä¼šè®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œåœ¨æŒ‡å®šæ—¶é—´æ®µåå…³é—­ã€‚å¦‚æœåœ¨å®šæ—¶å™¨å…³é—­å‰æ”¶åˆ°äº†å›å¤ï¼Œå®šæ—¶å™¨å°±ä¼šè¢«å–æ¶ˆï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ä½†æ˜¯ï¼Œå¦‚æœåœ¨æ”¶åˆ°ä»»ä½•å›å¤ä¹‹å‰è®¡æ—¶å™¨å°±å…³é—­äº†ï¼Œå®¢æˆ·ç«¯å°±ä¼šè®¤ä¸ºè¯·æ±‚æ²¡æœ‰è¢«å¤„ç†ï¼Œå¹¶é‡æ–°å‘é€è¯·æ±‚ã€‚å¦‚æœæœåŠ¡å™¨å›å¤äº†ï¼Œåˆ™ä¸€åˆ‡æ­£å¸¸ï¼Œå®¢æˆ·ç«¯ä¹Ÿé¡ºåˆ©åœ°è§£å†³äº†é—®é¢˜ã€‚ å®¢æˆ·ç«¯ä¹‹æ‰€ä»¥èƒ½ç®€å•åœ°é‡è¯•è¯·æ±‚ï¼ˆä¸ç®¡å¤±è´¥çš„åŸå› æ˜¯ä»€ä¹ˆï¼‰ï¼Œæ˜¯å› ä¸ºå¤§å¤šæ•° NFS è¯·æ±‚éƒ½æœ‰ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼šå®ƒä»¬éƒ½æ˜¯å¹‚ç­‰çš„ã€‚å½“å¤šæ¬¡æ‰§è¡Œè¯¥æ“ä½œçš„æ•ˆæœç­‰åŒäºå•æ¬¡æ‰§è¡Œè¯¥æ“ä½œçš„æ•ˆæœæ—¶ï¼Œæˆ‘ä»¬å°±ç§°è¯¥æ“ä½œä¸ºå¹‚ç­‰æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœå°†ä¸€ä¸ªå€¼å­˜å‚¨åˆ°å†…å­˜ä½ç½®ä¸‰æ¬¡ï¼Œä¸å­˜å‚¨ä¸€æ¬¡çš„æ•ˆæœç›¸åŒï¼›å› æ­¤ï¼Œâ€œå°†å€¼å­˜å‚¨åˆ°å†…å­˜ â€œå°±æ˜¯ä¸€ä¸ªå¹‚ç­‰æ“ä½œã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†ä¸€ä¸ªè®¡æ•°å™¨é€’å¢ä¸‰æ¬¡ï¼Œå…¶ç»“æœä¸åªé€’å¢ä¸€æ¬¡çš„ç»“æœä¸åŒï¼Œå› æ­¤ â€œé€’å¢è®¡æ•°å™¨ â€œä¸æ˜¯å¹‚ç­‰æ“ä½œã€‚æ›´ä¸€èˆ¬åœ°è¯´ï¼Œä»»ä½•åªè¯»å–æ•°æ®çš„æ“ä½œæ˜¾ç„¶éƒ½æ˜¯å¹‚ç­‰çš„ï¼Œè€Œæ›´æ–°æ•°æ®çš„æ“ä½œåˆ™å¿…é¡»æ›´ä»”ç»†åœ°è€ƒè™‘ï¼Œä»¥ç¡®å®šå®ƒæ˜¯å¦å…·æœ‰è¿™ç§ç‰¹æ€§ã€‚ NFS å´©æºƒæ¢å¤è®¾è®¡çš„æ ¸å¿ƒæ˜¯å¤§å¤šæ•°å¸¸è§æ“ä½œçš„å¹‚ç­‰æ€§ã€‚LOOKUP å’Œ READ è¯·æ±‚å…·æœ‰å¾®ä¸è¶³é“çš„å¹‚ç­‰æ€§ï¼Œå› ä¸ºå®ƒä»¬åªä»æ–‡ä»¶æœåŠ¡å™¨è¯»å–ä¿¡æ¯ï¼Œè€Œä¸æ›´æ–°ä¿¡æ¯ã€‚æ›´æœ‰è¶£çš„æ˜¯ï¼ŒWRITE è¯·æ±‚ä¹Ÿæ˜¯å¹‚ç­‰çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ WRITE å¤±è´¥ï¼Œå®¢æˆ·ç«¯åªéœ€é‡è¯•å³å¯ã€‚WRITE æ¶ˆæ¯åŒ…å«æ•°æ®ã€è®¡æ•°å’Œï¼ˆé‡è¦çš„ï¼‰è¦å†™å…¥æ•°æ®çš„å‡†ç¡®åç§»é‡ã€‚å› æ­¤ï¼Œåªè¦çŸ¥é“å¤šæ¬¡å†™å…¥çš„ç»“æœä¸å•æ¬¡å†™å…¥çš„ç»“æœç›¸åŒï¼Œå°±å¯ä»¥é‡å¤å†™å…¥ã€‚ è¿™æ ·ï¼Œå®¢æˆ·ç«¯å°±èƒ½ä»¥ç»Ÿä¸€çš„æ–¹å¼å¤„ç†æ‰€æœ‰è¶…æ—¶ã€‚ å¦‚æœåªæ˜¯ä¸¢å¤±äº† WRITE è¯·æ±‚ï¼ˆä¸Šè¿°æƒ…å†µ 1ï¼‰ï¼Œå®¢æˆ·ç«¯å°†é‡è¯•ï¼ŒæœåŠ¡å™¨å°†æ‰§è¡Œå†™å…¥æ“ä½œï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ åŒæ ·çš„æƒ…å†µä¹Ÿä¼šå‘ç”Ÿï¼Œå¦‚æœåœ¨å‘é€è¯·æ±‚æ—¶æœåŠ¡å™¨ç¢°å·§å®•æœºï¼Œä½†åœ¨å‘é€ç¬¬äºŒä¸ªè¯·æ±‚æ—¶åˆæ¢å¤è¿è¡Œï¼Œé‚£ä¹ˆä¸€åˆ‡éƒ½ä¼šå¦‚æ„¿ä»¥å¿ï¼ˆæƒ…å†µ 2ï¼‰ã€‚ æœ€åï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šæ¥æ”¶åˆ°å†™å…¥è¯·æ±‚ï¼Œå‘ç£ç›˜å‘å‡ºå†™å…¥æ“ä½œï¼Œå¹¶å‘é€å›å¤ã€‚è¿™ä¸ªå›å¤å¯èƒ½ä¼šä¸¢å¤±ï¼ˆæƒ…å†µ 3ï¼‰ï¼Œå†æ¬¡å¯¼è‡´å®¢æˆ·æœºé‡æ–°å‘é€è¯·æ±‚ã€‚å½“æœåŠ¡å™¨å†æ¬¡æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œå®ƒåªä¼šåšå®Œå…¨ç›¸åŒçš„äº‹æƒ…ï¼šå°†æ•°æ®å†™å…¥ç£ç›˜å¹¶å›å¤è¯´å·²ç»å†™å…¥ã€‚å¦‚æœè¿™æ¬¡å®¢æˆ·ç«¯æ”¶åˆ°äº†å›å¤ï¼Œé‚£ä¹ˆä¸€åˆ‡åˆéƒ½æ­£å¸¸äº†ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±ä»¥ç»Ÿä¸€çš„æ–¹å¼å¤„ç†äº†ä¿¡æ¯ä¸¢å¤±å’ŒæœåŠ¡å™¨æ•…éšœã€‚ ä¸è¿‡æœ‰äº›æ“ä½œå¾ˆéš¾åšåˆ°å¹‚ç­‰ã€‚ä¾‹å¦‚ï¼Œå½“ä½ è¯•å›¾åˆ›å»ºä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•æ—¶ï¼Œä½ ä¼šè¢«å‘ŠçŸ¥ mkdir è¯·æ±‚å¤±è´¥ã€‚å› æ­¤ï¼Œåœ¨ NFS ä¸­ï¼Œå¦‚æœæ–‡ä»¶æœåŠ¡å™¨æ¥æ”¶åˆ° MKDIR åè®®ä¿¡æ¯å¹¶æˆåŠŸæ‰§è¡Œï¼Œä½†å´ä¸¢å¤±äº†å›å¤ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å¯èƒ½ä¼šé‡å¤è¯¥æ“ä½œå¹¶é­é‡å¤±è´¥ï¼Œè€Œå®é™…ä¸Šè¯¥æ“ä½œä¸€å¼€å§‹æ˜¯æˆåŠŸçš„ï¼Œåªæ˜¯åœ¨é‡è¯•æ—¶å¤±è´¥äº†ã€‚å› æ­¤ï¼Œç”Ÿæ´»å¹¶ä¸å®Œç¾ã€‚ TIPï¼šå¹‚ç­‰æ€§éå¸¸å¼ºå¤§ åœ¨æ„å»ºå¯é ç³»ç»Ÿæ—¶ï¼Œå¹‚ç­‰æ€§æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å±æ€§ã€‚å½“ä¸€ä¸ªæ“ä½œå¯ä»¥å¤šæ¬¡å‘å‡ºæ—¶ï¼Œå¤„ç†æ“ä½œå¤±è´¥å°±å®¹æ˜“å¾—å¤šï¼›ä½ å¯ä»¥é‡è¯•ã€‚å¦‚æœæ“ä½œä¸æ˜¯å¹‚ç­‰çš„ï¼Œç”Ÿæ´»å°±ä¼šå˜å¾—æ›´åŠ å›°éš¾ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:3","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 æé«˜æ€§èƒ½ï¼šå®¢æˆ·ç«¯ç¼“å­˜ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:0","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 åŸºæœ¬ä»‹ç» åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ä¼˜ç‚¹æœ‰å¾ˆå¤šï¼Œä½†é€šè¿‡ç½‘ç»œå‘é€æ‰€æœ‰è¯»å†™è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤§çš„æ€§èƒ½é—®é¢˜ï¼šç½‘ç»œé€šå¸¸é€Ÿåº¦ä¸å¿«ï¼Œå°¤å…¶æ˜¯ä¸æœ¬åœ°å†…å­˜æˆ–ç£ç›˜ç›¸æ¯”ã€‚é‚£ä¹ˆï¼Œåˆä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•æé«˜åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„æ€§èƒ½ï¼Ÿ ç­”æ¡ˆæ˜¯å®¢æˆ·ç«¯ç¼“å­˜ã€‚ NFS å®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå°†ä»æœåŠ¡å™¨è¯»å–çš„æ–‡ä»¶æ•°æ®ï¼ˆå’Œå…ƒæ•°æ®ï¼‰ç¼“å­˜åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ã€‚å› æ­¤ï¼Œè™½ç„¶ç¬¬ä¸€æ¬¡è®¿é—®çš„æˆæœ¬å¾ˆé«˜ï¼ˆå³ï¼Œå®ƒéœ€è¦ç½‘ç»œé€šä¿¡ï¼‰ï¼Œä½†åç»­è®¿é—®å¾ˆå¿«å°±ä¼šä»å®¢æˆ·ç«¯å†…å­˜ä¸­å¾—åˆ°æœåŠ¡ã€‚ é«˜é€Ÿç¼“å­˜è¿˜å……å½“å†™å…¥çš„ä¸´æ—¶ç¼“å†²åŒºã€‚å½“å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºé¦–æ¬¡å†™å…¥æ–‡ä»¶æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šå…ˆå°†æ•°æ®ç¼“å†²åœ¨å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼ˆä¸ä»æ–‡ä»¶æœåŠ¡å™¨è¯»å–çš„æ•°æ®ä½äºåŒä¸€ç¼“å­˜ä¸­ï¼‰ï¼Œç„¶åå†å°†æ•°æ®å†™å‡ºåˆ°æœåŠ¡å™¨ã€‚è¿™ç§å†™å…¥ç¼“å†²éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå°†åº”ç”¨ç¨‹åº write() å»¶è¿Ÿä¸å®é™…å†™å…¥æ€§èƒ½è§£è€¦ï¼Œå³åº”ç”¨ç¨‹åºå¯¹ write() çš„è°ƒç”¨ç«‹å³æˆåŠŸï¼ˆå¹¶ä¸”åªæ˜¯å°†æ•°æ®æ”¾å…¥å®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿçš„ç¼“å­˜ä¸­ï¼‰ï¼›åªæœ‰ç¨åæ•°æ®æ‰ä¼šè¢«å†™å‡ºåˆ°æ–‡ä»¶æœåŠ¡å™¨ã€‚ å› æ­¤ï¼ŒNFS å®¢æˆ·ç«¯ç¼“å­˜æ•°æ®å¹¶ä¸”æ€§èƒ½é€šå¸¸å¾ˆå¥½ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ï¼Œå¯¹å—ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œä¸å®Œå…¨æ˜¯ã€‚å°†ç¼“å­˜æ·»åŠ åˆ°å…·æœ‰å¤šä¸ªå®¢æˆ·ç«¯ç¼“å­˜çš„ä»»ä½•ç±»å‹çš„ç³»ç»Ÿä¸­éƒ½ä¼šå¸¦æ¥ä¸€ä¸ªå·¨å¤§ä¸”æœ‰è¶£çš„æŒ‘æˆ˜ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:1","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜æœ€å¥½ç”¨ä¸¤ä¸ªå®¢æˆ·ç«¯å’Œä¸€ä¸ªæœåŠ¡å™¨æ¥è¯´æ˜ã€‚å‡è®¾å®¢æˆ·ç«¯ C1 è¯»å–æ–‡ä»¶ Fï¼Œå¹¶åœ¨å…¶æœ¬åœ°ç¼“å­˜ä¸­ä¿ç•™è¯¥æ–‡ä»¶çš„å‰¯æœ¬ã€‚ç°åœ¨æƒ³è±¡ä¸€ä¸ªä¸åŒçš„å®¢æˆ·ç«¯ C2 è¦†ç›–æ–‡ä»¶ Fï¼Œä»è€Œæ›´æ”¹å…¶å†…å®¹ï¼›æˆ‘ä»¬å°†æ–‡ä»¶çš„æ–°ç‰ˆæœ¬ç§°ä¸º Fï¼ˆç‰ˆæœ¬ 2ï¼‰æˆ– F[v2]ï¼Œå°†æ—§ç‰ˆæœ¬ç§°ä¸º F[v1]ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¿æŒä¸¤è€…ä¸åŒï¼ˆå½“ç„¶ï¼Œæ–‡ä»¶å…·æœ‰ç›¸åŒçš„åç§°ï¼Œåªæ˜¯å†…å®¹ä¸åŒï¼‰ã€‚æœ€åï¼Œè¿˜æœ‰ç¬¬ä¸‰ä¸ªå®¢æˆ·ç«¯ C3ï¼Œå®ƒå°šæœªè®¿é—®æ–‡ä»¶ Fã€‚ æ‚¨å¯èƒ½ä¼šçœ‹åˆ°å³å°†å‡ºç°çš„é—®é¢˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ äº‹å®ä¸Šï¼Œæœ‰ä¸¤ä¸ªå­é—®é¢˜ã€‚ ç¬¬ä¸€ä¸ªå­é—®é¢˜æ˜¯å®¢æˆ·ç«¯ C2 åœ¨å°†å…¶å†™å…¥ä¼ æ’­åˆ°æœåŠ¡å™¨ä¹‹å‰å¯èƒ½ä¼šåœ¨å…¶ç¼“å­˜ä¸­ç¼“å†²ä¸€æ®µæ—¶é—´ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè™½ç„¶ F[v2] ä½äº C2 çš„å†…å­˜ä¸­ï¼Œä½†æ¥è‡ªå¦ä¸€ä¸ªå®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ C3ï¼‰å¯¹ F çš„ä»»ä½•è®¿é—®éƒ½å°†è·å–æ–‡ä»¶çš„æ—§ç‰ˆæœ¬ (F[v1])ã€‚å› æ­¤ï¼Œé€šè¿‡åœ¨å®¢æˆ·ç«¯ç¼“å†²å†™å…¥ï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯èƒ½ä¼šè·å¾—è¯¥æ–‡ä»¶çš„è¿‡æ—¶ç‰ˆæœ¬ï¼Œè¿™å¯èƒ½æ˜¯ä¸åˆéœ€è¦çš„ï¼›äº‹å®ä¸Šï¼Œæƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„æƒ…å†µï¼šæ‚¨ç™»å½•åˆ°æœºå™¨ C2ï¼Œæ›´æ–° Fï¼Œç„¶åç™»å½•åˆ° C3 å¹¶å°è¯•è¯»å–æ–‡ä»¶ï¼Œç»“æœå´å¾—åˆ°æ—§å‰¯æœ¬ï¼å½“ç„¶ï¼Œè¿™å¯èƒ½ä¼šä»¤äººæ²®ä¸§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†è¿™æ–¹é¢çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ç§°ä¸ºæ›´æ–°å¯è§æ€§ï¼›ä¸€ä¸ªå®¢æˆ·ç«¯çš„æ›´æ–°ä½•æ—¶å¯¹å…¶ä»–å®¢æˆ·ç«¯å¯è§ï¼Ÿ ç¼“å­˜ä¸€è‡´æ€§çš„ç¬¬äºŒä¸ªå­é—®é¢˜æ˜¯é™ˆæ—§çš„ç¼“å­˜ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒC2 æœ€ç»ˆå°†å…¶å†™å…¥åˆ·æ–°åˆ°æ–‡ä»¶æœåŠ¡å™¨ï¼Œå› æ­¤æœåŠ¡å™¨å…·æœ‰æœ€æ–°ç‰ˆæœ¬ï¼ˆF[v2]ï¼‰ã€‚ç„¶è€Œï¼ŒC1 çš„ç¼“å­˜ä¸­ä»ç„¶æœ‰ F[v1]ï¼›å¦‚æœåœ¨ C1 ä¸Šè¿è¡Œçš„ç¨‹åºè¯»å–æ–‡ä»¶ Fï¼Œå®ƒå°†è·å¾—é™ˆæ—§ç‰ˆæœ¬ (F[v1])ï¼Œè€Œä¸æ˜¯æœ€æ–°å‰¯æœ¬ (F[v2])ï¼Œè¿™ï¼ˆé€šå¸¸ï¼‰æ˜¯ä¸å¯å–çš„ã€‚ NFSv2 å®ç°é€šè¿‡ä¸¤ç§æ–¹å¼è§£å†³è¿™äº›ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚ é¦–å…ˆï¼Œä¸ºäº†è§£å†³æ›´æ–°å¯è§æ€§ï¼Œå®¢æˆ·ç«¯å®ç°æœ‰æ—¶ç§°ä¸ºâ€œå…³é—­æ—¶åˆ·æ–°â€ï¼ˆä¹Ÿç§°ä¸ºâ€œå…³é—­åˆ°æ‰“å¼€â€ï¼‰ä¸€è‡´æ€§è¯­ä¹‰ï¼›å…·ä½“æ¥è¯´ï¼Œå½“å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå†™å…¥æ–‡ä»¶å¹¶éšåå…³é—­æ–‡ä»¶æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šå°†æ‰€æœ‰æ›´æ–°ï¼ˆå³ç¼“å­˜ä¸­çš„è„é¡µï¼‰åˆ·æ–°åˆ°æœåŠ¡å™¨ã€‚é€šè¿‡å…³é—­æ—¶åˆ·æ–°ä¸€è‡´æ€§ï¼ŒNFS å¯ç¡®ä¿åç»­ä»å¦ä¸€ä¸ªèŠ‚ç‚¹æ‰“å¼€æ—¶å°†çœ‹åˆ°æœ€æ–°çš„æ–‡ä»¶ç‰ˆæœ¬ã€‚ å…¶æ¬¡ï¼Œä¸ºäº†è§£å†³é™ˆæ—§ç¼“å­˜é—®é¢˜ï¼ŒNFSv2 å®¢æˆ·ç«¯åœ¨ä½¿ç”¨å…¶ç¼“å­˜å†…å®¹ä¹‹å‰é¦–å…ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²æ›´æ”¹ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ä½¿ç”¨ç¼“å­˜å—ä¹‹å‰ï¼Œå®¢æˆ·ç«¯æ–‡ä»¶ç³»ç»Ÿå°†å‘æœåŠ¡å™¨å‘å‡º GETATTR è¯·æ±‚ä»¥è·å–æ–‡ä»¶çš„å±æ€§ã€‚é‡è¦çš„æ˜¯ï¼Œå±æ€§åŒ…æ‹¬æœ‰å…³æ–‡ä»¶æœ€åä¸€æ¬¡åœ¨æœåŠ¡å™¨ä¸Šä¿®æ”¹çš„æ—¶é—´çš„ä¿¡æ¯ï¼›å¦‚æœä¿®æ”¹æ—¶é—´æ¯”æ–‡ä»¶è¢«æå–åˆ°å®¢æˆ·ç«¯ç¼“å­˜çš„æ—¶é—´æ›´æ–°ï¼Œåˆ™å®¢æˆ·ç«¯ä¼šä½¿è¯¥æ–‡ä»¶æ— æ•ˆï¼Œä»è€Œå°†å…¶ä»å®¢æˆ·ç«¯ç¼“å­˜ä¸­åˆ é™¤ï¼Œå¹¶ç¡®ä¿åç»­è¯»å–å°†è½¬åˆ°æœåŠ¡å™¨å¹¶æ£€ç´¢æœ€æ–°çš„æ–‡ä»¶çš„ç‰ˆæœ¬ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå®¢æˆ·ç«¯å‘ç°å®ƒå…·æœ‰è¯¥æ–‡ä»¶çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå®ƒå°†ç»§ç»­ä½¿ç”¨ç¼“å­˜çš„å†…å®¹ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚ å½“ Sun çš„åŸå§‹å›¢é˜Ÿé’ˆå¯¹é™ˆæ—§ç¼“å­˜é—®é¢˜å®æ–½æ­¤è§£å†³æ–¹æ¡ˆæ—¶ï¼Œä»–ä»¬æ„è¯†åˆ°äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼šçªç„¶ï¼ŒNFS æœåŠ¡å™¨è¢« GETATTR è¯·æ±‚æ·¹æ²¡ã€‚éµå¾ªçš„ä¸€ä¸ªè‰¯å¥½çš„å·¥ç¨‹åŸåˆ™æ˜¯é’ˆå¯¹å¸¸è§æƒ…å†µè¿›è¡Œè®¾è®¡ï¼Œå¹¶ä½¿å…¶è¿è¡Œè‰¯å¥½ï¼›åœ¨è¿™é‡Œï¼Œå°½ç®¡å¸¸è§æƒ…å†µæ˜¯ä»…ä»å•ä¸ªå®¢æˆ·ç«¯è®¿é—®æ–‡ä»¶ï¼ˆå¯èƒ½é‡å¤ï¼‰ï¼Œ**ä½†å®¢æˆ·ç«¯å§‹ç»ˆå¿…é¡»å‘æœåŠ¡å™¨å‘é€ GETATTR è¯·æ±‚ä»¥ç¡®ä¿æ²¡æœ‰å…¶ä»–äººæ›´æ”¹è¯¥æ–‡ä»¶ã€‚**å› æ­¤ï¼Œå®¢æˆ·ç«¯è½°ç‚¸æœåŠ¡å™¨ï¼Œä¸æ–­è¯¢é—®â€œæœ‰äººæ›´æ”¹äº†è¿™ä¸ªæ–‡ä»¶å—ï¼Ÿâ€ï¼Œè€Œå¤§å¤šæ•°æ—¶å€™æ²¡æœ‰äººæ›´æ”¹è¿‡ã€‚ ä¸ºäº†ï¼ˆåœ¨æŸç§ç¨‹åº¦ä¸Šï¼‰è§£å†³è¿™ç§æƒ…å†µï¼Œæ¯ä¸ªå®¢æˆ·ç«¯éƒ½æ·»åŠ äº†å±æ€§ç¼“å­˜ã€‚å®¢æˆ·ç«¯åœ¨è®¿é—®æ–‡ä»¶ä¹‹å‰ä»ç„¶ä¼šéªŒè¯æ–‡ä»¶ï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹åªä¼šæŸ¥çœ‹å±æ€§ç¼“å­˜ä»¥è·å–å±æ€§ã€‚ç‰¹å®šæ–‡ä»¶çš„å±æ€§åœ¨ç¬¬ä¸€æ¬¡è®¿é—®è¯¥æ–‡ä»¶æ—¶è¢«æ”¾ç½®åœ¨ç¼“å­˜ä¸­ï¼Œç„¶ååœ¨ä¸€å®šæ—¶é—´ï¼ˆä¾‹å¦‚ 3 ç§’ï¼‰åè¶…æ—¶ã€‚å› æ­¤ï¼Œåœ¨è¿™ä¸‰ç§’é’Ÿå†…ï¼Œæ‰€æœ‰æ–‡ä»¶è®¿é—®éƒ½å°†ç¡®å®šå¯ä»¥ä½¿ç”¨ç¼“å­˜çš„æ–‡ä»¶ï¼Œä»è€Œåœ¨ä¸æœåŠ¡å™¨æ²¡æœ‰ç½‘ç»œé€šä¿¡çš„æƒ…å†µä¸‹æ‰§è¡Œæ­¤æ“ä½œã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:2","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 è¯„ä¼° NFS ç¼“å­˜ä¸€è‡´æ€§ å…³äº NFS ç¼“å­˜ä¸€è‡´æ€§çš„æœ€åå‡ å¥è¯ã€‚æ·»åŠ å…³é—­æ—¶åˆ·æ–°è¡Œä¸ºæ˜¯ä¸ºäº†â€œæœ‰æ„ä¹‰â€ï¼Œä½†å¼•å…¥äº†ä¸€å®šçš„æ€§èƒ½é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœåœ¨å®¢æˆ·ç«¯ä¸Šåˆ›å»ºäº†ä¸´æ—¶æˆ–çŸ­æš‚çš„æ–‡ä»¶ï¼Œç„¶åå¾ˆå¿«å°†å…¶åˆ é™¤ï¼Œå®ƒä»ç„¶ä¼šè¢«å¼ºåˆ¶å‘é€åˆ°æœåŠ¡å™¨ã€‚æ›´ç†æƒ³çš„å®ç°å¯èƒ½ä¼šå°†è¿™äº›çŸ­æš‚çš„æ–‡ä»¶ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°å®ƒä»¬è¢«åˆ é™¤ï¼Œä»è€Œå®Œå…¨æ¶ˆé™¤æœåŠ¡å™¨äº¤äº’ï¼Œä¹Ÿè®¸ä¼šæé«˜æ€§èƒ½ã€‚ æ›´é‡è¦çš„æ˜¯ï¼Œåœ¨ NFS ä¸­æ·»åŠ å±æ€§ç¼“å­˜ä½¿å¾—äººä»¬å¾ˆéš¾ç†è§£æˆ–æ¨æ–­åˆ°åº•è·å¾—çš„æ–‡ä»¶ç‰ˆæœ¬æ˜¯ä»€ä¹ˆã€‚æœ‰æ—¶ä½ ä¼šå¾—åˆ°æœ€æ–°ç‰ˆæœ¬ï¼›æœ‰æ—¶ï¼Œæ‚¨ä¼šå¾—åˆ°æ—§ç‰ˆæœ¬ï¼Œåªæ˜¯å› ä¸ºæ‚¨çš„å±æ€§ç¼“å­˜å°šæœªè¶…æ—¶ï¼Œå› æ­¤å®¢æˆ·ç«¯å¾ˆä¹æ„ä¸ºæ‚¨æä¾›å®¢æˆ·ç«¯å†…å­˜ä¸­çš„å†…å®¹ã€‚å°½ç®¡è¿™åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½å¾ˆå¥½ï¼Œä½†å®ƒå¶å°”ä¼šï¼ˆè€Œä¸”ä»ç„¶å¦‚æ­¤ï¼ï¼‰å¯¼è‡´å¥‡æ€ªçš„è¡Œä¸ºã€‚è¿™æ ·æˆ‘ä»¬å°±æè¿°äº† NFS å®¢æˆ·ç«¯ç¼“å­˜çš„å¥‡æ€ªä¹‹å¤„ã€‚å®ƒæ˜¯ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­ï¼Œå…¶ä¸­å®ç°çš„ç»†èŠ‚ç”¨äºå®šä¹‰ç”¨æˆ·å¯è§‚å¯Ÿçš„è¯­ä¹‰ï¼Œè€Œä¸æ˜¯ç›¸åã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:3","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å¯¹æœåŠ¡å™¨ç«¯å†™ç¼“å†²çš„å½±å“ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„é‡ç‚¹ä¸€ç›´æ”¾åœ¨å®¢æˆ·ç«¯ç¼“å­˜ä¸Šï¼Œè¿™ä¹Ÿæ˜¯æœ€æœ‰è¶£çš„é—®é¢˜æ‰€åœ¨ã€‚ä¸è¿‡ï¼ŒNFS æœåŠ¡å™¨å¾€å¾€ä¹Ÿæ˜¯æ‹¥æœ‰å¤§é‡å†…å­˜çš„è£…å¤‡ç²¾è‰¯çš„æœºå™¨ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿæœ‰ç¼“å­˜é—®é¢˜ã€‚å½“ä»ç£ç›˜è¯»å–æ•°æ®ï¼ˆå’Œå…ƒæ•°æ®ï¼‰æ—¶ï¼ŒNFS æœåŠ¡å™¨ä¼šå°†å…¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œéšåå¯¹æ•°æ®ï¼ˆå’Œå…ƒæ•°æ®ï¼‰çš„è¯»å–å°†ä¸ä¼šè½¬åˆ°ç£ç›˜ï¼Œè¿™æœ‰å¯èƒ½ï¼ˆå°å¹…ï¼‰æé«˜æ€§èƒ½ã€‚ æ›´æœ‰è¶£çš„æ˜¯å†™ç¼“å†²ã€‚NFS æœåŠ¡å™¨åœ¨å¼ºåˆ¶å†™å…¥ç¨³å®šå­˜å‚¨ï¼ˆå¦‚ç£ç›˜æˆ–å…¶ä»–æŒä¹…æ€§è®¾å¤‡ï¼‰ä¹‹å‰ï¼Œç»å¯¹ä¸ä¼šè¿”å›æˆåŠŸçš„ WRITE åè®®è¯·æ±‚ã€‚è™½ç„¶å®ƒä»¬å¯ä»¥åœ¨æœåŠ¡å™¨å†…å­˜ä¸­æ”¾ç½®æ•°æ®å‰¯æœ¬ï¼Œä½†å‘å®¢æˆ·ç«¯è¿”å› WRITE åè®®è¯·æ±‚æˆåŠŸå¯èƒ½ä¼šå¯¼è‡´ä¸æ­£ç¡®çš„è¡Œä¸ºã€‚ ç­”æ¡ˆå°±åœ¨äºæˆ‘ä»¬å¯¹å®¢æˆ·ç«¯å¦‚ä½•å¤„ç†æœåŠ¡å™¨æ•…éšœçš„å‡è®¾ã€‚æƒ³è±¡ä¸€ä¸‹å®¢æˆ·ç«¯å‘å‡ºçš„ä»¥ä¸‹å†™å…¥åºåˆ—ï¼š write(fd, a_buffer, size); // fill first block with aâ€™s write(fd, b_buffer, size); // fill second block with bâ€™s write(fd, c_buffer, size); // fill third block with câ€™s è¿™äº›å†™å…¥ä¼šå…ˆç”¨ a å—ã€b å—å’Œ c å—è¦†ç›–æ–‡ä»¶çš„ä¸‰ä¸ªå—ã€‚å› æ­¤ï¼Œå¦‚æœæ–‡ä»¶æœ€åˆçœ‹èµ·æ¥åƒè¿™æ ·ï¼š xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz æˆ‘ä»¬å¯èƒ½æœŸæœ›è¿™äº›å†™å…¥åçš„æœ€ç»ˆç»“æœæ˜¯è¿™æ ·çš„ï¼Œå…¶ä¸­ xã€y å’Œ z å°†åˆ†åˆ«è¢« aã€b å’Œ c è¦†ç›–ã€‚ aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc ç°åœ¨ï¼Œä¸ºäº†ä¸¾ä¾‹ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸‰ä¸ªå®¢æˆ·ç«¯å†™å…¥ä½œä¸ºä¸‰ä¸ªä¸åŒçš„ WRITE åè®®æ¶ˆæ¯å‘é€åˆ°æœåŠ¡å™¨ã€‚å‡è®¾æœåŠ¡å™¨æ”¶åˆ°ç¬¬ä¸€ä¸ª WRITE æ¶ˆæ¯å¹¶å°†å…¶å‘é€åˆ°ç£ç›˜ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯é€šçŸ¥å…¶æˆåŠŸã€‚ç°åœ¨å‡è®¾ç¬¬äºŒæ¬¡å†™å…¥åªæ˜¯ç¼“å†²åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”æœåŠ¡å™¨åœ¨å°†å…¶å¼ºåˆ¶å†™å…¥ç£ç›˜ä¹‹å‰ä¹Ÿä¼šå‘å®¢æˆ·ç«¯æŠ¥å‘Šå…¶æˆåŠŸï¼›ä¸å¹¸çš„æ˜¯ï¼ŒæœåŠ¡å™¨åœ¨å°†å…¶å†™å…¥ç£ç›˜ä¹‹å‰å´©æºƒäº†ã€‚æœåŠ¡å™¨å¾ˆå¿«é‡å¯ï¼Œæ”¶åˆ°ç¬¬ä¸‰ä¸ªå†™è¯·æ±‚ï¼Œä¹ŸæˆåŠŸäº†ã€‚ å› æ­¤ï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æˆåŠŸäº†ï¼Œä½†ä»¤æˆ‘ä»¬æƒŠè®¶çš„æ˜¯æ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy \u003c--- oops cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc å› ä¸ºæœåŠ¡å™¨åœ¨å°†ç¬¬äºŒæ¬¡å†™å…¥æäº¤åˆ°ç£ç›˜ä¹‹å‰å‘Šè¯‰å®¢æˆ·ç«¯ç¬¬äºŒæ¬¡å†™å…¥æˆåŠŸï¼Œæ‰€ä»¥æ–‡ä»¶ä¸­ä¼šç•™ä¸‹æ—§çš„å—ï¼Œè¿™å¯èƒ½æ˜¯ç¾éš¾æ€§çš„ï¼Œå…·ä½“å–å†³äºåº”ç”¨ç¨‹åºã€‚ ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼ŒNFS æœåŠ¡å™¨å¿…é¡»å°†æ¯æ¬¡å†™å…¥æäº¤åˆ°ç¨³å®šï¼ˆæŒä¹…ï¼‰å­˜å‚¨ï¼Œç„¶åå†é€šçŸ¥å®¢æˆ·ç«¯æˆåŠŸï¼›è¿™æ ·åšä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿåœ¨å†™å…¥æœŸé—´æ£€æµ‹åˆ°æœåŠ¡å™¨æ•…éšœï¼Œä»è€Œé‡è¯•ç›´åˆ°æœ€ç»ˆæˆåŠŸã€‚è¿™æ ·åšå¯ä»¥ç¡®ä¿æˆ‘ä»¬æ°¸è¿œä¸ä¼šåƒä¸Šé¢çš„ç¤ºä¾‹ä¸€æ ·æœ€ç»ˆå‡ºç°æ–‡ä»¶å†…å®¹æ··åˆçš„æƒ…å†µã€‚ è¿™ä¸€è¦æ±‚åœ¨ NFS æœåŠ¡å™¨å®ç°ä¸­å¼•èµ·çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœä¸å°å¿ƒçš„è¯ï¼Œå†™å…¥æ€§èƒ½å¯èƒ½ä¼šæˆä¸ºä¸»è¦çš„æ€§èƒ½ç“¶é¢ˆã€‚äº‹å®ä¸Šï¼Œä¸€äº›å…¬å¸ï¼ˆä¾‹å¦‚ Network Applianceï¼‰çš„æˆç«‹åªæ˜¯ä¸ºäº†æ„å»ºä¸€ä¸ªå¯ä»¥å¿«é€Ÿæ‰§è¡Œå†™å…¥çš„ NFS æœåŠ¡å™¨ï¼›ä»–ä»¬ä½¿ç”¨çš„ä¸€ä¸ªæŠ€å·§æ˜¯é¦–å…ˆå°†å†™å…¥æ“ä½œæ”¾å…¥ç”µæ± æ”¯æŒçš„å†…å­˜ä¸­ï¼Œä»è€Œèƒ½å¤Ÿå¿«é€Ÿå›å¤å†™å…¥è¯·æ±‚ï¼Œè€Œä¸å¿…æ‹…å¿ƒä¸¢å¤±æ•°æ®ï¼Œå¹¶ä¸”æ— éœ€ç«‹å³å†™å…¥ç£ç›˜ï¼›ç¬¬äºŒä¸ªæŠ€å·§æ˜¯ä½¿ç”¨ä¸“é—¨è®¾è®¡çš„æ–‡ä»¶ç³»ç»Ÿè®¾è®¡ï¼Œä»¥ä¾¿åœ¨æœ€ç»ˆéœ€è¦æ—¶å¿«é€Ÿå†™å…¥ç£ç›˜ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:4:0","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 æ€»ç»“ åœ¨ NFS ä¸­å®ç°å¿«é€Ÿã€ç®€å•çš„å´©æºƒæ¢å¤è¿™ä¸€ä¸»è¦ç›®æ ‡çš„å…³é”®åœ¨äºæ— çŠ¶æ€åè®®çš„è®¾è®¡ã€‚å´©æºƒåï¼ŒæœåŠ¡å™¨å¯ä»¥å¿«é€Ÿé‡æ–°å¯åŠ¨å¹¶å†æ¬¡å¼€å§‹æœåŠ¡è¯·æ±‚ï¼›å®¢æˆ·ç«¯åªéœ€é‡è¯•è¯·æ±‚ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚ ä½¿è¯·æ±‚å…·æœ‰å¹‚ç­‰æ€§æ˜¯NFS åè®®çš„ä¸€ä¸ªæ ¸å¿ƒæ–¹é¢ã€‚å½“å¤šæ¬¡æ‰§è¡ŒæŸä¸ªæ“ä½œçš„æ•ˆæœä¸æ‰§è¡Œä¸€æ¬¡ç›¸åŒæ—¶ï¼Œè¯¥æ“ä½œå°±æ˜¯å¹‚ç­‰çš„ã€‚åœ¨NFSä¸­ï¼Œå¹‚ç­‰æ€§ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿæ— å¿§é‡è¯•ï¼Œå¹¶ç»Ÿä¸€å®¢æˆ·ç«¯ä¸¢å¤±æ¶ˆæ¯é‡ä¼ ä»¥åŠå®¢æˆ·ç«¯å¤„ç†æœåŠ¡å™¨å´©æºƒçš„æ–¹å¼ã€‚ æ€§èƒ½é—®é¢˜å†³å®šäº†å¯¹å®¢æˆ·ç«¯ç¼“å­˜å’Œå†™ç¼“å†²çš„éœ€æ±‚ï¼Œä½†ä¼šå¸¦æ¥ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚ NFS å®ç°æä¾›äº†ä¸€ç§é€šè¿‡å¤šç§æ–¹å¼å®ç°ç¼“å­˜ä¸€è‡´æ€§çš„å·¥ç¨‹è§£å†³æ–¹æ¡ˆï¼š**å…³é—­æ—¶åˆ·æ–°ï¼ˆå…³é—­åˆ°æ‰“å¼€ï¼‰**æ–¹æ³•å¯ç¡®ä¿å½“æ–‡ä»¶å…³é—­æ—¶ï¼Œå…¶å†…å®¹è¢«å¼ºåˆ¶ä¼ è¾“åˆ°æœåŠ¡å™¨ï¼Œä»è€Œä½¿å…¶ä»–å®¢æˆ·ç«¯èƒ½å¤Ÿè§‚å¯Ÿåˆ°æ–‡ä»¶çš„æ›´æ–°ã€‚å±æ€§ç¼“å­˜å‡å°‘äº†å‘æœåŠ¡å™¨æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²æ›´æ”¹çš„é¢‘ç‡ï¼ˆé€šè¿‡ GETATTR è¯·æ±‚ï¼‰ã€‚ NFS æœåŠ¡å™¨å¿…é¡»åœ¨è¿”å›æˆåŠŸä¹‹å‰å‘æŒä¹…ä»‹è´¨æäº¤å†™å…¥ï¼›å¦åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ ä¸ºäº†æ”¯æŒNFS é›†æˆåˆ°æ“ä½œç³»ç»Ÿä¸­ï¼ŒSun å¼•å…¥äº†VFS/Vnode æ¥å£ï¼Œä½¿å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿå®ç°èƒ½å¤Ÿåœ¨åŒä¸€æ“ä½œç³»ç»Ÿä¸­å…±å­˜ã€‚ ","date":"2024-05-11","objectID":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:5:0","tags":["OS"],"title":"ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¼•è¨€ åˆ†å¸ƒå¼ç³»ç»Ÿæ”¹å˜äº†ä¸–ç•Œçš„é¢è²Œã€‚å½“æ‚¨çš„ç½‘ç»œæµè§ˆå™¨è¿æ¥åˆ°åœ°çƒä¸Šå…¶ä»–åœ°æ–¹çš„ç½‘ç»œæœåŠ¡å™¨æ—¶ï¼Œå®ƒæ­£åœ¨å‚ä¸çœ‹ä¼¼ç®€å•å½¢å¼çš„å®¢æˆ·ç«¯/æœåŠ¡å™¨ï¼ˆCSï¼‰åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ç„¶è€Œï¼Œå½“æ‚¨è”ç³» Google æˆ– Facebook ç­‰ç°ä»£ç½‘ç»œæœåŠ¡æ—¶ï¼Œæ‚¨ä¸ä»…ä»…æ˜¯åœ¨ä¸ä¸€å°æœºå™¨è¿›è¡Œäº¤äº’ã€‚åœ¨å¹•åï¼Œè¿™äº›å¤æ‚çš„æœåŠ¡æ˜¯ç”±å¤§é‡ï¼ˆå³æ•°åƒå°ï¼‰æœºå™¨æ„å»ºçš„ï¼Œæ¯å°æœºå™¨ç›¸äº’åä½œä»¥æä¾›ç«™ç‚¹çš„ç‰¹å®šæœåŠ¡ã€‚ æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ä¼šå‡ºç°è®¸å¤šæ–°çš„æŒ‘æˆ˜ã€‚æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯å¤±è´¥ï¼›æœºå™¨ã€ç£ç›˜ã€ç½‘ç»œå’Œè½¯ä»¶éƒ½ä¼šæ—¶ä¸æ—¶åœ°å‡ºç°æ•…éšœï¼Œå› ä¸ºæˆ‘ä»¬ä¸ï¼ˆå¹¶ä¸”å¯èƒ½æ°¸è¿œä¸ä¼šï¼‰çŸ¥é“å¦‚ä½•æ„å»ºâ€œå®Œç¾â€çš„ç»„ä»¶å’Œç³»ç»Ÿã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬æ„å»ºç°ä»£ Web æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå¯¹å®¢æˆ·æ¥è¯´ä¼¼ä¹æ°¸è¿œä¸ä¼šå¤±è´¥ï¼›æˆ‘ä»¬æ€æ ·æ‰èƒ½å®Œæˆè¿™ä¸ªä»»åŠ¡å‘¢ï¼Ÿ å…³é”®ï¼šå¦‚ä½•æ„å»ºåœ¨ç»„ä»¶å‡ºç°æ•…éšœæ—¶ä»èƒ½æ­£å¸¸å·¥ä½œçš„ç³»ç»Ÿï¼Ÿ æœ‰è¶£çš„æ˜¯ï¼Œè™½ç„¶å¤±è´¥æ˜¯æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸»è¦æŒ‘æˆ˜ï¼Œä½†å®ƒä¹Ÿä»£è¡¨ç€æœºé‡ã€‚æ˜¯çš„ï¼Œæœºå™¨ä¼šå‡ºæ•…éšœï¼›ä½†ä¸€å°æœºå™¨å‘ç”Ÿæ•…éšœå¹¶ä¸æ„å‘³ç€æ•´ä¸ªç³»ç»Ÿä¸€å®šä¼šå‘ç”Ÿæ•…éšœã€‚é€šè¿‡å°†ä¸€ç»„æœºå™¨é›†åˆåœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªä¼¼ä¹å¾ˆå°‘å‘ç”Ÿæ•…éšœçš„ç³»ç»Ÿï¼Œå°½ç®¡å®ƒçš„ç»„ä»¶ç»å¸¸å‘ç”Ÿæ•…éšœã€‚è¿™ä¸€äº‹å®æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒé­…åŠ›å’Œä»·å€¼ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬æˆä¸ºæ‚¨ä½¿ç”¨çš„å‡ ä¹æ‰€æœ‰ç°ä»£ç½‘ç»œæœåŠ¡ï¼ˆåŒ…æ‹¬ Googleã€Facebook ç­‰ï¼‰çš„åŸºç¡€ã€‚ TIPï¼šé€šä¿¡æœ¬è´¨ä¸Šæ˜¯ä¸å¯é çš„ åœ¨å‡ ä¹æ‰€æœ‰æƒ…å†µä¸‹ï¼Œæœ€å¥½å°†é€šä¿¡è§†ä¸ºä¸€ç§æœ¬è´¨ä¸Šä¸å¯é çš„æ´»åŠ¨ã€‚bitæŸåã€é“¾è·¯å’Œæœºå™¨ç˜«ç—ªæˆ–æ— æ³•å·¥ä½œï¼Œä»¥åŠä¼ å…¥æ•°æ®åŒ…ç¼ºä¹ç¼“å†²ç©ºé—´ï¼Œéƒ½ä¼šå¯¼è‡´åŒæ ·çš„ç»“æœï¼šæ•°æ®åŒ…æœ‰æ—¶æ— æ³•åˆ°è¾¾ç›®çš„åœ°ã€‚è¦åœ¨è¿™ç§ä¸å¯é çš„ç½‘ç»œä¹‹ä¸Šå»ºç«‹å¯é çš„æœåŠ¡ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘èƒ½å¤Ÿåº”å¯¹æ•°æ®åŒ…ä¸¢å¤±çš„æŠ€æœ¯ã€‚ è¿˜å­˜åœ¨å…¶ä»–é‡è¦é—®é¢˜ã€‚ç³»ç»Ÿæ€§èƒ½å¾€å¾€è‡³å…³é‡è¦ï¼›ç”±äºç½‘ç»œå°†æˆ‘ä»¬çš„åˆ†å¸ƒå¼ç³»ç»Ÿè¿æ¥åœ¨ä¸€èµ·ï¼Œç³»ç»Ÿè®¾è®¡è€…å¾€å¾€å¿…é¡»ä»”ç»†è€ƒè™‘å¦‚ä½•å®Œæˆæ—¢å®šä»»åŠ¡ï¼Œå°½é‡å‡å°‘å‘é€ä¿¡æ¯çš„æ•°é‡ï¼Œå¹¶è¿›ä¸€æ­¥æé«˜é€šä¿¡æ•ˆç‡ï¼ˆä½å»¶è¿Ÿã€é«˜å¸¦å®½ï¼‰ã€‚ æœ€åï¼Œå®‰å…¨ä¹Ÿæ˜¯ä¸€ä¸ªå¿…è¦çš„è€ƒè™‘å› ç´ ã€‚ç¡®ä¿è¿œç¨‹æ–¹çš„çœŸå®èº«ä»½æˆä¸ºä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ã€‚æ­¤å¤–ï¼Œç¡®ä¿ç¬¬ä¸‰æ–¹æ— æ³•ç›‘è§†æˆ–æ”¹å˜ä¸¤ä¸ªäººä¹‹é—´æ­£åœ¨è¿›è¡Œçš„é€šä¿¡ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚ åœ¨æœ¬ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­æœ€åŸºæœ¬çš„æ–°é—®é¢˜ï¼šé€šä¿¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æœºå™¨åº”è¯¥å¦‚ä½•ç›¸äº’é€šä¿¡ï¼Ÿï¼Ÿæˆ‘ä»¬å°†ä»æœ€åŸºæœ¬çš„å¯ç”¨åŸè¯­ï¼ˆæ¶ˆæ¯ï¼‰å¼€å§‹ï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹ä¸Šæ„å»ºä¸€äº›æ›´é«˜çº§åˆ«çš„åŸè¯­ã€‚æ­£å¦‚æˆ‘ä»¬ä¸Šé¢æ‰€è¯´ï¼Œæ•…éšœå°†æˆä¸ºç„¦ç‚¹ï¼šé€šä¿¡å±‚åº”å¦‚ä½•å¤„ç†æ•…éšœï¼Ÿ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:1:0","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 é€šä¿¡åŸºç¡€ ç°ä»£ç½‘ç»œçš„æ ¸å¿ƒåŸåˆ™æ˜¯é€šä¿¡ä»æ ¹æœ¬ä¸Šæ¥è¯´æ˜¯ä¸å¯é çš„ã€‚æ— è®ºæ˜¯åœ¨å¹¿åŸŸäº’è”ç½‘ä¸­ï¼Œè¿˜æ˜¯åœ¨ Infiniband ç­‰å±€åŸŸé«˜é€Ÿç½‘ç»œä¸­ï¼Œæ•°æ®åŒ…ç»å¸¸ä¼šä¸¢å¤±ã€æŸåæˆ–æ— æ³•åˆ°è¾¾ç›®çš„åœ°ã€‚ é€ æˆæ•°æ®åŒ…ä¸¢å¤±æˆ–æŸåçš„åŸå› æœ‰å¾ˆå¤šã€‚æœ‰æ—¶ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼ŒæŸäº›ä½ä¼šç”±äºç”µæ°”æˆ–å…¶ä»–ç±»ä¼¼é—®é¢˜è€Œç¿»è½¬ã€‚æœ‰æ—¶ï¼Œç³»ç»Ÿä¸­çš„æŸä¸ªå…ƒä»¶ï¼ˆä¾‹å¦‚ç½‘ç»œé“¾è·¯æˆ–æ•°æ®åŒ…è·¯ç”±å™¨ç”šè‡³è¿œç¨‹ä¸»æœºï¼‰ä¼šå› æŸç§åŸå› æŸåæˆ–æ— æ³•æ­£å¸¸å·¥ä½œï¼›ç½‘ç»œç”µç¼†ç¡®å®ä¼šè¢«æ„å¤–åˆ‡æ–­ï¼Œè‡³å°‘æœ‰æ—¶æ˜¯è¿™æ ·ã€‚ ç„¶è€Œï¼Œæ›´æ ¹æœ¬çš„æ˜¯ç”±äºç½‘ç»œäº¤æ¢æœºã€è·¯ç”±å™¨æˆ–ç«¯ç‚¹å†…ç¼ºä¹ç¼“å†²è€Œå¯¼è‡´çš„æ•°æ®åŒ…ä¸¢å¤±ã€‚å…·ä½“æ¥è¯´ï¼Œå³ä½¿æˆ‘ä»¬å¯ä»¥ä¿è¯æ‰€æœ‰é“¾è·¯æ­£å¸¸å·¥ä½œï¼Œå¹¶ä¸”ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç»„ä»¶ï¼ˆäº¤æ¢æœºã€è·¯ç”±å™¨ã€ç»ˆç«¯ä¸»æœºï¼‰éƒ½æŒ‰é¢„æœŸå¯åŠ¨å¹¶è¿è¡Œï¼Œä½†ç”±äºä»¥ä¸‹åŸå› ï¼Œä»ç„¶æœ‰å¯èƒ½å‘ç”Ÿä¸¢å¤±ã€‚ æƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªæ•°æ®åŒ…åˆ°è¾¾è·¯ç”±å™¨ï¼›è¦å¤„ç†æ•°æ®åŒ…ï¼Œå¿…é¡»å°†å…¶æ”¾ç½®åœ¨è·¯ç”±å™¨å†…å­˜ä¸­çš„æŸä¸ªä½ç½®ã€‚å¦‚æœè®¸å¤šæ­¤ç±»æ•°æ®åŒ…åŒæ—¶åˆ°è¾¾ï¼Œåˆ™è·¯ç”±å™¨å†…çš„å†…å­˜å¯èƒ½æ— æ³•å®¹çº³æ‰€æœ‰æ•°æ®åŒ…ã€‚æ­¤æ—¶è·¯ç”±å™¨å”¯ä¸€çš„é€‰æ‹©æ˜¯ä¸¢å¼ƒä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®åŒ…ã€‚åŒæ ·çš„è¡Œä¸ºä¹Ÿå‘ç”Ÿåœ¨ç»ˆç«¯ä¸»æœºä¸Šï¼›å½“ä½ å‘ä¸€å°æœºå™¨å‘é€å¤§é‡æ¶ˆæ¯æ—¶ï¼Œæœºå™¨çš„èµ„æºå¾ˆå®¹æ˜“è¢«æ·¹æ²¡ï¼Œä»è€Œå†æ¬¡å‡ºç°ä¸¢åŒ…ã€‚ å› æ­¤ï¼Œæ•°æ®åŒ…ä¸¢å¤±æ˜¯ç½‘ç»œä¸­çš„åŸºç¡€ã€‚é‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†ï¼šæˆ‘ä»¬è¯¥å¦‚ä½•åº”å¯¹ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:2:0","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ä¸å¯é é€šä¿¡å±‚ ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯ï¼šæˆ‘ä»¬ä¸å»å¤„ç†å®ƒã€‚å› ä¸ºæŸäº›åº”ç”¨ç¨‹åºçŸ¥é“å¦‚ä½•å¤„ç†æ•°æ®åŒ…ä¸¢å¤±ï¼Œæ‰€ä»¥æœ‰æ—¶è®©å®ƒä»¬ä¸åŸºæœ¬çš„ä¸å¯é æ¶ˆæ¯ä¼ é€’å±‚è¿›è¡Œé€šä¿¡æ˜¯æœ‰ç”¨çš„ï¼Œè¿™æ˜¯äººä»¬ç»å¸¸å¬åˆ°çš„ç«¯åˆ°ç«¯è®ºç‚¹çš„ä¸€ä¸ªä¾‹å­ã€‚UDP/IP ç½‘ç»œåè®®æ ˆå°±æ˜¯è¿™ç§ä¸å¯é å±‚çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œç›®å‰å‡ ä¹æ‰€æœ‰çš„ç°ä»£ç³»ç»Ÿéƒ½æœ‰è¿™ç§åè®®æ ˆã€‚ä½¿ç”¨ UDP æ—¶ï¼Œè¿›ç¨‹ä½¿ç”¨socket API åˆ›å»ºé€šä¿¡ç«¯ç‚¹ï¼›å…¶ä»–æœºå™¨ï¼ˆæˆ–åŒä¸€æœºå™¨ï¼‰ä¸Šçš„è¿›ç¨‹å‘åŸå§‹è¿›ç¨‹å‘é€ UDP æ•°æ®æŠ¥ï¼ˆæ•°æ®æŠ¥æ˜¯å›ºå®šå¤§å°çš„æŠ¥æ–‡ï¼Œæœ€å¤§ä¸è¶…è¿‡æŸä¸ªæœ€å¤§å€¼ï¼‰ã€‚ ç«¯åˆ°ç«¯è®ºç‚¹ ç«¯åˆ°ç«¯è®ºç‚¹è®¤ä¸ºï¼Œç³»ç»Ÿçš„æœ€é«˜å±‚ï¼Œå³é€šå¸¸ä½äº â€œç«¯ â€œçš„åº”ç”¨ç¨‹åºï¼Œæœ€ç»ˆæ˜¯åˆ†å±‚ç³»ç»Ÿä¸­å”¯ä¸€èƒ½çœŸæ­£å®ç°æŸäº›åŠŸèƒ½çš„åœ°æ–¹ã€‚åœ¨å…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰çš„è®ºæ–‡ä¸­ï¼ŒSaltzer ç­‰äººé€šè¿‡ä¸€ä¸ªæå¥½çš„ä¾‹å­è®ºè¯äº†è¿™ä¸€ç‚¹ï¼šä¸¤å°æœºå™¨ä¹‹é—´çš„å¯é æ–‡ä»¶ä¼ è¾“ã€‚å¦‚æœè¦å°†æ–‡ä»¶ä»æœºå™¨ A ä¼ è¾“åˆ°æœºå™¨ Bï¼Œå¹¶ç¡®ä¿æœ€ç»ˆåˆ°è¾¾æœºå™¨ B çš„å­—èŠ‚ä¸å¼€å§‹åˆ°è¾¾æœºå™¨ A çš„å­—èŠ‚å®Œå…¨ç›¸åŒï¼Œå°±å¿…é¡»è¿›è¡Œ â€œç«¯åˆ°ç«¯ â€œæ£€æŸ¥ï¼›è€Œç½‘ç»œæˆ–ç£ç›˜ç­‰è¾ƒä½çº§åˆ«çš„å¯é æœºåˆ¶åˆ™æ— æ³•æä¾›è¿™ç§ä¿è¯ã€‚ ä¸æ­¤å½¢æˆé²œæ˜å¯¹æ¯”çš„æ˜¯ä¸€ç§è¯•å›¾é€šè¿‡åœ¨ç³»ç»Ÿè¾ƒä½å±‚å¢åŠ å¯é æ€§æ¥è§£å†³å¯é æ–‡ä»¶ä¼ è¾“é—®é¢˜çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªå¯é çš„é€šä¿¡åè®®ï¼Œå¹¶ç”¨å®ƒæ¥å»ºç«‹å¯é çš„æ–‡ä»¶ä¼ è¾“ã€‚è¯¥é€šä¿¡åè®®ä¿è¯å‘é€æ–¹å‘é€çš„æ¯ä¸ªå­—èŠ‚éƒ½èƒ½è¢«æ¥æ”¶æ–¹æŒ‰é¡ºåºæ¥æ”¶ï¼Œä¾‹å¦‚ä½¿ç”¨è¶…æ—¶/é‡è¯•ã€ç¡®è®¤å’Œåºåˆ—å·ã€‚ä¸å¹¸çš„æ˜¯ï¼Œä½¿ç”¨è¿™æ ·çš„åè®®å¹¶ä¸èƒ½å®ç°å¯é çš„æ–‡ä»¶ä¼ è¾“ï¼›è¯•æƒ³ä¸€ä¸‹ï¼Œåœ¨é€šä¿¡å¼€å§‹ä¹‹å‰ï¼Œå‘é€æ–¹å†…å­˜ä¸­çš„å­—èŠ‚å°±å·²ç»æŸåï¼Œæˆ–è€…æ¥æ”¶æ–¹å°†æ•°æ®å†™å…¥ç£ç›˜æ—¶å‘ç”Ÿäº†ä»€ä¹ˆä¸å¥½çš„äº‹æƒ…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿å­—èŠ‚åœ¨ç½‘ç»œä¸Šå¯é åœ°ä¼ è¾“ï¼Œæˆ‘ä»¬çš„æ–‡ä»¶ä¼ è¾“æœ€ç»ˆä¹Ÿæ˜¯ä¸å¯é çš„ã€‚è¦å»ºç«‹å¯é çš„æ–‡ä»¶ä¼ è¾“ï¼Œå¿…é¡»åŒ…æ‹¬ç«¯åˆ°ç«¯çš„å¯é æ€§æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œåœ¨æ•´ä¸ªä¼ è¾“å®Œæˆåï¼Œè¯»å›æ¥æ”¶æ–¹ç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œè®¡ç®—æ ¡éªŒå’Œï¼Œå¹¶å°†æ ¡éªŒå’Œä¸å‘é€æ–¹çš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒã€‚ è¿™å¥æ ¼è¨€çš„æ¨è®ºæ˜¯ï¼Œæœ‰æ—¶è®©ä¸‹å±‚æä¾›é¢å¤–åŠŸèƒ½ç¡®å®å¯ä»¥æé«˜ç³»ç»Ÿæ€§èƒ½æˆ–ä¼˜åŒ–ç³»ç»Ÿã€‚å› æ­¤ï¼Œä½ ä¸åº”è¯¥æ’é™¤åœ¨ç³»ç»Ÿä¸­çš„è¾ƒä½å±‚æ¬¡ä½¿ç”¨è¿™ç§æœºåˆ¶ï¼›ç›¸åï¼Œä½ åº”è¯¥ä»”ç»†è€ƒè™‘è¿™ç§æœºåˆ¶çš„æ•ˆç”¨ï¼Œè€ƒè™‘åˆ°å®ƒåœ¨æ•´ä¸ªç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºä¸­çš„æœ€ç»ˆç”¨é€”ã€‚ ä¸‹é¢è¿™ä¸¤æ®µä»£ç æ˜¾ç¤ºäº†æ„å»ºåœ¨ UDP/IP ä¹‹ä¸Šçš„ç®€å•å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚å®¢æˆ·ç«¯å¯ä»¥å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼Œç„¶åæœåŠ¡å™¨åšå‡ºå“åº”ã€‚é€šè¿‡è¿™ä¹ˆå°‘é‡çš„ä»£ç ï¼Œæ‚¨å°±æ‹¥æœ‰äº†å¼€å§‹æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ‰€éœ€çš„ä¸€åˆ‡ï¼ // client.c #include \u003cstdio.h\u003e #include \"udp.h\" #define BUFFER_SIZE 1024 int main() { struct sockaddr_in addrSend, addrRecv; int fd = UDP_Open(CLIENT_PORT); int rc = UDP_FillSockAddr(\u0026addrSend, \"localhost\", SERVER_PORT); char message[BUFFER_SIZE]; sprintf(message, \"hello world\"); printf(\"client:: sending message [%s]\\n\", message); rc = UDP_Write(fd, \u0026addrSend, message, BUFFER_SIZE); if (rc \u003c 0) { fprintf(stderr, \"Client:: Failed to send message\\n\"); return -1; } printf(\"client:: waiting for reply...\\n\"); rc = UDP_Read(fd, \u0026addrRecv, message, BUFFER_SIZE); if (rc \u003c 0) { fprintf(stderr, \"Client:: Failed to read message\\n\"); return -1; } printf(\"client:: read %d bytes (message: %s)\\n\", rc, message); return 0; } //server.c #include \u003cstdio.h\u003e #include \"udp.h\" #define BUFFER_SIZE 1024 int main(int argc, char **argv) { int fd = UDP_Open(SERVER_PORT); if (fd \u003c 0) { fprintf(stderr, \"Failed to create socket\\n\"); return -1; } while (1) { struct sockaddr_in addr; char buffer[BUFFER_SIZE]; printf(\"server:: waiting for data...\\n\"); int rc = UDP_Read(fd, \u0026addr, buffer, 1024); printf(\"server:: read %d bytes (message: %s)\\n\", rc, buffer); if (rc \u003e 0) { char reply[BUFFER_SIZE]; sprintf(reply, \"goodbye world\"); rc = UDP_Write(fd, \u0026addr, reply, BUFFER_SIZE); printf(\"server:: reply\\n\"); } } return 0; } UDP æ˜¯ä¸å¯é é€šä¿¡å±‚çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚è€Œå‘é€æ–¹ä»ä¸ä¼šå› æ­¤è¢«å‘ŠçŸ¥æ•°æ®åŒ…ä¸¢å¤±ã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ UDP å®Œå…¨ä¸é˜²èŒƒä»»ä½•æ•…éšœã€‚ä¾‹å¦‚ï¼ŒUDP åŒ…å«ä¸€ä¸ªæ ¡éªŒå’Œæ¥æ£€æµ‹æŸäº›å½¢å¼çš„æ•°æ®åŒ…æŸåã€‚ ç„¶è€Œï¼Œç”±äºè®¸å¤šåº”ç”¨ç¨‹åºåªæ˜¯æƒ³å°†æ•°æ®å‘é€åˆ°ç›®çš„åœ°è€Œä¸æ‹…å¿ƒæ•°æ®åŒ…ä¸¢å¤±ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ›´å¤šã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸å¯é çš„ç½‘ç»œä¸Šè¿›è¡Œå¯é çš„é€šä¿¡ã€‚ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:3:0","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å¯é çš„é€šä¿¡å±‚ ä¸ºäº†æ„å»ºå¯é çš„é€šä¿¡å±‚ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æ–°çš„æœºåˆ¶å’ŒæŠ€æœ¯æ¥å¤„ç†ä¸¢åŒ…ã€‚è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå…¶ä¸­å®¢æˆ·ç«¯é€šè¿‡ä¸å¯é çš„è¿æ¥å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ã€‚æˆ‘ä»¬å¿…é¡»å›ç­”çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šå‘é€è€…å¦‚ä½•çŸ¥é“æ¥æ”¶è€…ç¡®å®æ”¶åˆ°äº†æ¶ˆæ¯ï¼Ÿ æˆ‘ä»¬å°†ä½¿ç”¨çš„æŠ€æœ¯ç§°ä¸ºç¡®è®¤ï¼Œç®€ç§° ackã€‚æƒ³æ³•å¾ˆç®€å•ï¼šå‘é€è€…å‘æ¥æ”¶è€…å‘é€æ¶ˆæ¯ï¼›ç„¶åæ¥æ”¶è€…å‘å›ä¸€æ¡çŸ­æ¶ˆæ¯ä»¥ç¡®è®¤å…¶æ”¶åˆ°ã€‚ä¸‹å›¾æè¿°äº†è¯¥è¿‡ç¨‹ã€‚ å½“å‘é€æ–¹æ”¶åˆ°æ¶ˆæ¯çš„ç¡®è®¤æ—¶ï¼Œå®ƒå°±å¯ä»¥æ”¾å¿ƒï¼Œæ¥æ”¶æ–¹ç¡®å®æ”¶åˆ°äº†åŸå§‹æ¶ˆæ¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœå‘é€æ–¹æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé¢å¤–çš„æœºåˆ¶ï¼Œç§°ä¸ºè¶…æ—¶ã€‚å½“å‘é€è€…å‘é€æ¶ˆæ¯æ—¶ï¼Œå‘é€è€…ç°åœ¨è®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨åœ¨ä¸€æ®µæ—¶é—´åå…³é—­ã€‚å¦‚æœæ­¤æ—¶æœªæ”¶åˆ°ç¡®è®¤ï¼Œåˆ™å‘é€æ–¹æ–­å®šæ¶ˆæ¯å·²ä¸¢å¤±ã€‚ç„¶åï¼Œå‘é€è€…åªéœ€é‡è¯•å‘é€ï¼Œå†æ¬¡å‘é€ç›¸åŒçš„æ¶ˆæ¯ï¼Œå¸Œæœ›è¿™æ¬¡èƒ½å¤ŸæˆåŠŸã€‚ä¸ºäº†ä½¿è¿™ç§æ–¹æ³•å‘æŒ¥ä½œç”¨ï¼Œå‘é€è€…å¿…é¡»ä¿ç•™æ¶ˆæ¯çš„å‰¯æœ¬ï¼Œä»¥å¤‡éœ€è¦å†æ¬¡å‘é€æ—¶ä½¿ç”¨ã€‚è¶…æ—¶å’Œé‡è¯•çš„ç»“åˆå¯¼è‡´ä¸€äº›äººå°†è¿™ç§æ–¹æ³•ç§°ä¸ºè¶…æ—¶/é‡è¯•ï¼Œä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªç¤ºä¾‹ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§å½¢å¼çš„è¶…æ—¶/é‡è¯•è¿˜ä¸å¤Ÿã€‚ä¸‹å›¾æ˜¾ç¤ºäº†å¯èƒ½å¯¼è‡´é—®é¢˜çš„æ•°æ®åŒ…ä¸¢å¤±ç¤ºä¾‹ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä¸¢å¤±çš„ä¸æ˜¯åŸå§‹æ¶ˆæ¯ï¼Œè€Œæ˜¯ç¡®è®¤æ¶ˆæ¯ã€‚ä»å‘é€æ–¹çš„è§’åº¦æ¥çœ‹ï¼Œæƒ…å†µä¼¼ä¹æ˜¯ä¸€æ ·çš„ï¼šæ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå› æ­¤éœ€è¦è¶…æ—¶å’Œé‡è¯•ã€‚ä½†ä»æ¥æ”¶è€…çš„è§’åº¦æ¥çœ‹ï¼Œæƒ…å†µå°±å¤§ä¸ä¸€æ ·äº†ï¼šç°åœ¨åŒä¸€æ¡æ¶ˆæ¯å·²ç»æ”¶åˆ°ä¸¤æ¬¡äº†ï¼è™½ç„¶åœ¨æŸäº›æƒ…å†µä¸‹è¿™å¯èƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†ä¸€èˆ¬æ¥è¯´æ˜¯ä¸è¡Œçš„ï¼›æƒ³è±¡ä¸€ä¸‹å½“æ‚¨ä¸‹è½½æ–‡ä»¶å¹¶ä¸”åœ¨ä¸‹è½½è¿‡ç¨‹ä¸­é‡å¤é¢å¤–çš„æ•°æ®åŒ…æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å»ºç«‹ä¸€ä¸ªå¯é çš„æ¶ˆæ¯å±‚æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸è¿˜å¸Œæœ›ä¿è¯æ¥æ”¶è€…åªæ¥æ”¶æ¯æ¡æ¶ˆæ¯ä¸€æ¬¡ã€‚ ä¸ºäº†ä½¿æ¥æ”¶æ–¹èƒ½å¤Ÿæ£€æµ‹åˆ°é‡å¤çš„æ¶ˆæ¯ä¼ è¾“ï¼Œå‘é€æ–¹å¿…é¡»ä»¥æŸç§ç‹¬ç‰¹çš„æ–¹å¼è¯†åˆ«æ¯æ¡æ¶ˆæ¯ï¼Œå¹¶ä¸”æ¥æ”¶æ–¹éœ€è¦æŸç§æ–¹å¼æ¥è·Ÿè¸ªå®ƒä¹‹å‰æ˜¯å¦å·²ç»çœ‹è¿‡æ¯æ¡æ¶ˆæ¯ã€‚å½“æ¥æ”¶æ–¹çœ‹åˆ°é‡å¤ä¼ è¾“æ—¶ï¼Œå®ƒåªæ˜¯ç¡®è®¤æ¶ˆæ¯ï¼Œä½†ï¼ˆå…³é”®ï¼‰ä¸ä¼šå°†æ¶ˆæ¯ä¼ é€’ç»™æ¥æ”¶æ•°æ®çš„åº”ç”¨ç¨‹åºã€‚å› æ­¤ï¼Œå‘é€æ–¹æ”¶åˆ° ackï¼Œä½†æ¶ˆæ¯ä¸ä¼šè¢«æ¥æ”¶ä¸¤æ¬¡ï¼Œä»è€Œä¿ç•™äº†ä¸Šè¿°çš„æ°å¥½ä¸€æ¬¡è¯­ä¹‰ã€‚æœ‰å¤šç§æ–¹æ³•å¯ä»¥æ£€æµ‹é‡å¤æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œå‘é€è€…å¯ä»¥ä¸ºæ¯æ¡æ¶ˆæ¯ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„IDï¼›æ¥æ”¶è€…å¯ä»¥è¿½è¸ªå®ƒæ‰€è§è¿‡çš„æ¯ä¸€ä¸ªIDã€‚è¿™ç§æ–¹æ³•å¯è¡Œï¼Œä½†æˆæœ¬é«˜æ˜‚ï¼Œéœ€è¦æ— é™çš„å†…å­˜æ¥è·Ÿè¸ªæ‰€æœ‰ IDã€‚ æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦å¾ˆå°‘çš„å†…å­˜ï¼Œè¿™ç§æœºåˆ¶è¢«ç§°ä¸ºåºåˆ—è®¡æ•°å™¨ã€‚ä½¿ç”¨åºåˆ—è®¡æ•°å™¨æ—¶ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹å•†å®šä¸€ä¸ªè®¡æ•°å™¨çš„èµ·å§‹å€¼ï¼ˆå¦‚ $1$ï¼‰ï¼Œç”±åŒæ–¹å…±åŒç»´æŠ¤ã€‚æ¯å½“å‘é€ä¸€æ¡ä¿¡æ¯æ—¶ï¼Œè®¡æ•°å™¨çš„å½“å‰å€¼å°±ä¼šéšä¿¡æ¯ä¸€èµ·å‘é€ï¼›è¿™ä¸ªè®¡æ•°å™¨å€¼ï¼ˆ$N$ï¼‰å°±æ˜¯ä¿¡æ¯çš„ IDã€‚ä¿¡æ¯å‘é€åï¼Œå‘é€æ–¹ä¼šé€’å¢è®¡æ•°å™¨å€¼ï¼ˆåˆ° $N + 1$ï¼‰ã€‚ æ¥æ”¶æ–¹ä½¿ç”¨å…¶è®¡æ•°å™¨å€¼ä½œä¸ºè¯¥å‘é€æ–¹å‘æ¥ä¿¡æ¯çš„ ID çš„é¢„æœŸå€¼ã€‚å¦‚æœæ¥æ”¶åˆ°çš„ä¿¡æ¯ IDï¼ˆNï¼‰ä¸æ¥æ”¶è€…çš„è®¡æ•°å™¨ï¼ˆä¹Ÿæ˜¯ Nï¼‰ç›¸åŒ¹é…ï¼Œæ¥æ”¶è€…å°±ä¼šæ¥æ”¶è¯¥ä¿¡æ¯å¹¶å°†å…¶ä¸Šä¼ ç»™åº”ç”¨ç¨‹åºï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¥æ”¶è€…å°±ä¼šæ–­å®šè¿™æ˜¯ç¬¬ä¸€æ¬¡æ”¶åˆ°è¯¥ä¿¡æ¯ã€‚ç„¶åï¼Œæ¥æ”¶æ–¹é€’å¢è®¡æ•°å™¨ï¼ˆåˆ° $N + 1$ï¼‰ï¼Œç­‰å¾…ä¸‹ä¸€æ¡ä¿¡æ¯ã€‚ å¦‚æœä¸¢å¤±äº†åº”ç­”ï¼Œå‘é€æ–¹å°†è¶…æ—¶å¹¶é‡æ–°å‘é€ä¿¡æ¯ $N$ã€‚è¿™ä¸€æ¬¡ï¼Œæ¥æ”¶æ–¹çš„è®¡æ•°å™¨æ›´é«˜ï¼ˆ$N + 1$ï¼‰ï¼Œå› æ­¤æ¥æ”¶æ–¹çŸ¥é“è‡ªå·±å·²ç»æ”¶åˆ°äº†è¿™æ¡ä¿¡æ¯ã€‚å› æ­¤ï¼Œå®ƒä¼šæ¥æ”¶ä¿¡æ¯ï¼Œä½†ä¸ä¼šå°†å…¶ä¸Šä¼ ç»™åº”ç”¨ç¨‹åºã€‚é€šè¿‡è¿™ç§ç®€å•çš„æ–¹å¼ï¼Œåºåˆ—è®¡æ•°å™¨å¯ç”¨äºé¿å…é‡å¤ã€‚ æœ€å¸¸ç”¨çš„å¯é é€šä¿¡å±‚è¢«ç§°ä¸º TCP/IPï¼Œç®€ç§° TCPã€‚TCP æ¯”æˆ‘ä»¬ä¸Šé¢æè¿°çš„è¦å¤æ‚å¾—å¤šï¼ŒåŒ…æ‹¬å¤„ç†ç½‘ç»œæ‹¥å¡ã€å¤šä¸ªæœªå¤„ç†è¯·æ±‚ä»¥åŠæ•°ç™¾ç§å…¶ä»–å°è°ƒæ•´å’Œä¼˜åŒ–çš„æœºåˆ¶ã€‚ TIPï¼šå°å¿ƒè®¾ç½®è¶…æ—¶å€¼ æ­£å¦‚æ‚¨å¯èƒ½ä»è®¨è®ºä¸­çŒœåˆ°çš„é‚£æ ·ï¼Œæ­£ç¡®è®¾ç½®è¶…æ—¶å€¼æ˜¯ä½¿ç”¨è¶…æ—¶é‡è¯•æ¶ˆæ¯å‘é€çš„ä¸€ä¸ªé‡è¦æ–¹é¢ã€‚ å¦‚æœè¶…æ—¶å¤ªå°ï¼Œå‘é€æ–¹å°†ä¸å¿…è¦åœ°é‡æ–°å‘é€æ¶ˆæ¯ï¼Œä»è€Œæµªè´¹å‘é€æ–¹çš„CPUæ—¶é—´å’Œç½‘ç»œèµ„æºã€‚ å¦‚æœè¶…æ—¶å¤ªå¤§ï¼Œåˆ™å‘é€æ–¹ç­‰å¾…å¤ªé•¿æ—¶é—´æ‰èƒ½é‡æ–°å‘é€ï¼Œä»è€Œé™ä½å‘é€æ–¹çš„æ„ŸçŸ¥æ€§èƒ½ã€‚ å› æ­¤ï¼Œä»å•ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„è§’åº¦æ¥çœ‹ï¼Œâ€œæ­£ç¡®â€å€¼æ˜¯ç­‰å¾…è¶³å¤Ÿé•¿çš„æ—¶é—´æ¥æ£€æµ‹æ•°æ®åŒ…ä¸¢å¤±ï¼Œä½†ä¸å†ç­‰å¾…ã€‚ ç„¶è€Œï¼Œæ­£å¦‚æˆ‘ä»¬å°†åœ¨ä»¥åçš„ç« èŠ‚ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­é€šå¸¸ä¸ä»…ä»…åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚åœ¨è®¸å¤šå®¢æˆ·ç«¯å‘å•ä¸ªæœåŠ¡å™¨å‘é€æ•°æ®çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¸Šçš„æ•°æ®åŒ…ä¸¢å¤±å¯èƒ½è¡¨æ˜æœåŠ¡å™¨è¿‡è½½ã€‚å¦‚æœä¸ºçœŸï¼Œå®¢æˆ·ç«¯å¯èƒ½ä¼šä»¥ä¸åŒçš„è‡ªé€‚åº”æ–¹å¼é‡è¯•ï¼›ä¾‹å¦‚ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¶…æ—¶åï¼Œå®¢æˆ·ç«¯å¯èƒ½ä¼šå°†å…¶è¶…æ—¶å€¼å¢åŠ åˆ°æ›´é«˜çš„å€¼ï¼Œå¯èƒ½æ˜¯åŸå§‹å€¼çš„ä¸¤å€ã€‚è¿™ç§æŒ‡æ•°é€€é¿æ–¹æ¡ˆåœ¨æ—©æœŸçš„ Aloha ç½‘ç»œä¸­é¦–åˆ›å¹¶åœ¨æ—©æœŸä»¥å¤ªç½‘ä¸­é‡‡ç”¨ï¼Œé¿å…äº†å› è¿‡åº¦é‡å‘è€Œå¯¼è‡´èµ„æºè¿‡è½½çš„æƒ…å†µã€‚ç¨³å¥çš„ç³»ç»ŸåŠªåŠ›é¿å…è¿™ç§æ€§è´¨çš„è¿‡è½½ã€‚ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:4:0","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 é€šä¿¡æŠ½è±¡ ç»™å®šäº†åŸºæœ¬çš„æ¶ˆæ¯ä¼ é€’å±‚ï¼Œæˆ‘ä»¬ç°åœ¨è®¨è®ºæœ¬ç« ä¸­çš„ä¸‹ä¸€ä¸ªé—®é¢˜ï¼šåœ¨æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä»€ä¹ˆé€šä¿¡æŠ½è±¡ï¼Ÿ å¤šå¹´æ¥ï¼Œç³»ç»Ÿç•Œå¼€å‘äº†è®¸å¤šæ–¹æ³•ã€‚å…¶ä¸­ä¸€é¡¹å·¥ä½œæ˜¯å°†æ“ä½œç³»ç»Ÿçš„æŠ½è±¡æ¦‚å¿µæ‰©å±•åˆ°åˆ†å¸ƒå¼ç¯å¢ƒä¸­è¿è¡Œã€‚ä¾‹å¦‚ï¼Œåˆ†å¸ƒå¼å…±äº«å†…å­˜ï¼ˆDSMï¼‰ç³»ç»Ÿèƒ½è®©ä¸åŒæœºå™¨ä¸Šçš„è¿›ç¨‹å…±äº«ä¸€ä¸ªå¤§å‹è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚è¿™ç§æŠ½è±¡å°†åˆ†å¸ƒå¼è®¡ç®—å˜æˆäº†ç±»ä¼¼äºå¤šçº¿ç¨‹åº”ç”¨ç¨‹åºçš„ä¸œè¥¿ï¼›å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œè¿™äº›çº¿ç¨‹è¿è¡Œåœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œè€Œä¸æ˜¯åŒä¸€æœºå™¨ä¸Šçš„ä¸åŒå¤„ç†å™¨ä¸Šã€‚ å¤§å¤šæ•° DSM ç³»ç»Ÿçš„å·¥ä½œæ–¹å¼æ˜¯é€šè¿‡æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜ç³»ç»Ÿã€‚åœ¨ä¸€å°æœºå™¨ä¸Šè®¿é—®ä¸€ä¸ªé¡µé¢æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸¤ç§æƒ…å†µã€‚ åœ¨ç¬¬ä¸€ç§ï¼ˆæœ€ä½³ï¼‰æƒ…å†µä¸‹ï¼Œé¡µé¢å·²ç»åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šï¼Œå› æ­¤å¯ä»¥å¿«é€Ÿè·å–æ•°æ®ã€‚ ç¬¬äºŒç§æƒ…å†µæ˜¯ï¼Œé¡µé¢å½“å‰åœ¨å…¶ä»–æœºå™¨ä¸Šã€‚é¡µé¢æ•…éšœå‘ç”Ÿåï¼Œé¡µé¢æ•…éšœå¤„ç†ç¨‹åºä¼šå‘å…¶ä»–æœºå™¨å‘é€ä¿¡æ¯ï¼Œä»¥è·å–é¡µé¢ï¼Œå¹¶å°†å…¶å®‰è£…åˆ°è¯·æ±‚è¿›ç¨‹çš„é¡µè¡¨ä¸­ï¼Œç„¶åç»§ç»­æ‰§è¡Œã€‚ ç”±äºå¤šç§åŸå› ï¼Œè¿™ç§æ–¹æ³•ç›®å‰å¹¶æœªå¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚DSM é¢ä¸´çš„æœ€å¤§é—®é¢˜æ˜¯å¦‚ä½•å¤„ç†æ•…éšœã€‚ä¾‹å¦‚ï¼Œè®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€å°æœºå™¨å‘ç”Ÿæ•…éšœï¼Œé‚£ä¹ˆè¿™å°æœºå™¨ä¸Šçš„é¡µé¢ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿå¦‚æœåˆ†å¸ƒå¼è®¡ç®—çš„æ•°æ®ç»“æ„éå¸ƒæ•´ä¸ªåœ°å€ç©ºé—´æ€ä¹ˆåŠï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™äº›æ•°æ®ç»“æ„çš„ä¸€éƒ¨åˆ†å°†çªç„¶ä¸å¯ç”¨ã€‚å½“éƒ¨åˆ†åœ°å€ç©ºé—´ä¸¢å¤±æ—¶ï¼Œå¤„ç†æ•…éšœæ˜¯éå¸¸å›°éš¾çš„ï¼›æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œâ€œä¸‹ä¸€ä¸ª â€œæŒ‡é’ˆæŒ‡å‘çš„åœ°å€ç©ºé—´éƒ¨åˆ†å·²ç»æ¶ˆå¤±ã€‚ å¦ä¸€ä¸ªé—®é¢˜æ˜¯æ€§èƒ½ã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå‡è®¾è®¿é—®å†…å­˜çš„æˆæœ¬å¾ˆä½ã€‚åœ¨ DSM ç³»ç»Ÿä¸­ï¼Œæœ‰äº›è®¿é—®æ˜¯å»‰ä»·çš„ï¼Œä½†æœ‰äº›è®¿é—®å´ä¼šå¯¼è‡´é¡µé¢æ•…éšœï¼Œå¹¶ä»è¿œç¨‹æœºå™¨ä¸Šè·å–æ˜‚è´µçš„æ•°æ®ã€‚å› æ­¤ï¼Œè¿™ç§ DSM ç³»ç»Ÿçš„ç¨‹åºå‘˜å¿…é¡»éå¸¸å°å¿ƒåœ°ç»„ç»‡è®¡ç®—ï¼Œä½¿å…¶å‡ ä¹ä¸å‘ç”Ÿä»»ä½•é€šä¿¡ï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¿èƒŒäº†è¿™ç§æ–¹æ³•çš„åˆè¡·ã€‚å°½ç®¡åœ¨è¿™ä¸€é¢†åŸŸè¿›è¡Œäº†å¤§é‡ç ”ç©¶ï¼Œä½†å‡ ä¹æ²¡æœ‰äº§ç”Ÿå®é™…å½±å“ï¼›å¦‚ä»Šï¼Œæ²¡æœ‰äººä½¿ç”¨ DSM æ„å»ºå¯é çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:5:0","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ (RPC) æ“ä½œç³»ç»ŸæŠ½è±¡å¯¹äºæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ¥è¯´æ˜¯ä¸€ä¸ªç³Ÿç³•çš„é€‰æ‹©ï¼Œè€Œç¼–ç¨‹è¯­è¨€ï¼ˆPLï¼‰æŠ½è±¡åˆ™æ›´æœ‰æ„ä¹‰ã€‚æœ€ä¸»è¦çš„æŠ½è±¡åŸºäº**è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆç®€ç§° RPCï¼‰**çš„æ€æƒ³ã€‚ è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åŒ…éƒ½æœ‰ä¸€ä¸ªç®€å•çš„ç›®æ ‡ï¼šä½¿åœ¨è¿œç¨‹æœºå™¨ä¸Šæ‰§è¡Œä»£ç çš„è¿‡ç¨‹åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ç®€å•æ˜äº†ã€‚å› æ­¤ï¼Œå¯¹å®¢æˆ·ç«¯æ¥è¯´ï¼Œåªéœ€è¿›è¡Œä¸€æ¬¡è¿‡ç¨‹è°ƒç”¨ï¼Œä¸€æ®µæ—¶é—´åå°±ä¼šè¿”å›ç»“æœã€‚æœåŠ¡å™¨åªéœ€å®šä¹‰ä¸€äº›å®ƒå¸Œæœ›å¯¼å‡ºçš„ä¾‹ç¨‹ã€‚RPC ç³»ç»Ÿä¸€èˆ¬ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå­˜æ ¹ç”Ÿæˆå™¨ï¼ˆæœ‰æ—¶ç§°ä¸ºåè®®ç¼–è¯‘å™¨ï¼‰å’Œè¿è¡Œæ—¶åº“ã€‚ä¸‹é¢æˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»å…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:6:0","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.1 å­˜æ ¹ç”Ÿæˆå™¨ å­˜æ ¹ç”Ÿæˆå™¨çš„å·¥ä½œå¾ˆç®€å•ï¼šé€šè¿‡è‡ªåŠ¨åŒ–æ¥æ¶ˆé™¤å°†å‡½æ•°å‚æ•°å’Œç»“æœæ‰“åŒ…åˆ°æ¶ˆæ¯ä¸­çš„ä¸€äº›ç—›è‹¦ã€‚è¿™æ ·åšä¼šå¸¦æ¥è®¸å¤šå¥½å¤„ï¼šé€šè¿‡è®¾è®¡å¯ä»¥é¿å…æ‰‹å·¥ç¼–å†™æ­¤ç±»ä»£ç æ—¶å‡ºç°çš„ç®€å•é”™è¯¯ï¼›æ­¤å¤–ï¼Œå­˜æ ¹ç¼–è¯‘å™¨ä¹Ÿè®¸å¯ä»¥ä¼˜åŒ–æ­¤ç±»ä»£ç ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚ è¿™ç§ç¼–è¯‘å™¨çš„è¾“å…¥åªæ˜¯æœåŠ¡å™¨å¸Œæœ›å¯¼å‡ºåˆ°å®¢æˆ·ç«¯çš„ä¸€ç»„è°ƒç”¨ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œå®ƒå¯èƒ½åƒè¿™æ ·ç®€å•ï¼š interface { int func1(int arg1); int func2(int arg1, int arg2); }; å­˜æ ¹ç”Ÿæˆå™¨é‡‡ç”¨è¿™æ ·çš„æ¥å£å¹¶ç”Ÿæˆä¸€äº›ä¸åŒçš„ä»£ç ç‰‡æ®µã€‚ å¯¹äºå®¢æˆ·ç«¯ï¼Œç”Ÿæˆä¸€ä¸ªå®¢æˆ·ç«¯å­˜æ ¹ï¼Œå…¶ä¸­åŒ…å«æ¥å£ä¸­æŒ‡å®šçš„å„ä¸ªåŠŸèƒ½ï¼›å¸Œæœ›ä½¿ç”¨æ­¤ RPC æœåŠ¡çš„å®¢æˆ·ç«¯ç¨‹åºå°†ä¸æ­¤å®¢æˆ·ç«¯å­˜æ ¹é“¾æ¥å¹¶è°ƒç”¨å®ƒä»¥è¿›è¡Œ RPCã€‚åœ¨å†…éƒ¨ï¼Œå®¢æˆ·ç«¯å­˜æ ¹ä¸­çš„æ¯ä¸ªå‡½æ•°éƒ½æ‰§è¡Œæ‰§è¡Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨æ‰€éœ€çš„æ‰€æœ‰å·¥ä½œã€‚å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œä»£ç åªæ˜¯æ˜¾ç¤ºä¸ºå‡½æ•°è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯è°ƒç”¨ func1(x)ï¼‰ï¼›åœ¨å†…éƒ¨ï¼Œfunc1() çš„å®¢æˆ·ç«¯å­˜æ ¹ä¸­çš„ä»£ç æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š **åˆ›å»ºæ¶ˆæ¯ç¼“å†²åŒºã€‚**æ¶ˆæ¯ç¼“å†²åŒºé€šå¸¸åªæ˜¯æŸä¸ªå¤§å°çš„è¿ç»­å­—èŠ‚æ•°ç»„ã€‚ å°†æ‰€éœ€ä¿¡æ¯æ‰“åŒ…åˆ°æ¶ˆæ¯ç¼“å†²åŒºä¸­ã€‚è¯¥ä¿¡æ¯åŒ…æ‹¬è¦è°ƒç”¨çš„å‡½æ•°çš„æŸç§æ ‡è¯†ç¬¦ï¼Œä»¥åŠå‡½æ•°éœ€è¦çš„æ‰€æœ‰å‚æ•°ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œfunc1 æ˜¯ä¸€ä¸ªæ•´æ•°ï¼‰ã€‚å°†æ‰€æœ‰è¿™äº›ä¿¡æ¯æ”¾å…¥å•ä¸ªè¿ç»­ç¼“å†²åŒºçš„è¿‡ç¨‹æœ‰æ—¶ç§°ä¸ºå‚æ•°çš„ç¼–ç»„æˆ–æ¶ˆæ¯çš„åºåˆ—åŒ–ã€‚ **å°†æ¶ˆæ¯å‘é€åˆ°ç›®æ ‡RPC æœåŠ¡å™¨ã€‚**ä¸ RPC æœåŠ¡å™¨çš„é€šä¿¡ä»¥åŠä½¿å…¶æ­£ç¡®è¿è¡Œæ‰€éœ€çš„æ‰€æœ‰ç»†èŠ‚å‡ç”± RPC è¿è¡Œæ—¶åº“å¤„ç†ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚ **ç­‰å¾…å›å¤ã€‚**ç”±äºå‡½æ•°è°ƒç”¨é€šå¸¸æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤è°ƒç”¨å°†ç­‰å¾…å…¶å®Œæˆã€‚ è§£å‹è¿”å›ä»£ç å’Œå…¶ä»–å‚æ•°ã€‚å¦‚æœå‡½æ•°ä»…è¿”å›å•ä¸ªè¿”å›ç ï¼Œåˆ™æ­¤è¿‡ç¨‹å¾ˆç®€å•ï¼›ç„¶è€Œï¼Œæ›´å¤æ‚çš„å‡½æ•°å¯èƒ½ä¼šè¿”å›æ›´å¤æ‚çš„ç»“æœï¼ˆä¾‹å¦‚ï¼Œåˆ—è¡¨ï¼‰ï¼Œå› æ­¤å­˜æ ¹å¯èƒ½ä¹Ÿéœ€è¦è§£å‹è¿™äº›ç»“æœã€‚æ­¤æ­¥éª¤ä¹Ÿç§°ä¸ºè§£ç»„æˆ–ååºåˆ—åŒ–ã€‚ è¿”å›è°ƒç”¨è€…ã€‚æœ€åï¼Œåªéœ€ä»å®¢æˆ·ç«¯å­˜æ ¹è¿”å›åˆ°å®¢æˆ·ç«¯ä»£ç å³å¯ã€‚ å¯¹äºæœåŠ¡å™¨ï¼Œä¹Ÿä¼šç”Ÿæˆä»£ç ã€‚åœ¨æœåŠ¡å™¨ä¸Šé‡‡å–çš„æ­¥éª¤å¦‚ä¸‹ï¼š è§£å‹æ¶ˆæ¯ã€‚æ­¤æ­¥éª¤ç§°ä¸ºè§£ç»„æˆ–ååºåˆ—åŒ–ï¼Œä»ä¼ å…¥æ¶ˆæ¯ä¸­å–å‡ºä¿¡æ¯ï¼Œæå–å‡½æ•°æ ‡è¯†ç¬¦å’Œå‚æ•°ã€‚ è°ƒç”¨å®é™…å‡½æ•°ã€‚æœ€åï¼æˆ‘ä»¬å·²ç»åˆ°è¾¾äº†å®é™…æ‰§è¡Œè¿œç¨‹å‡½æ•°çš„é˜¶æ®µã€‚ RPC è¿è¡Œæ—¶è°ƒç”¨ ID æŒ‡å®šçš„å‡½æ•°å¹¶ä¼ å…¥æ‰€éœ€çš„å‚æ•°ã€‚ **å°†ç»“æœæ‰“åŒ…ã€‚**è¿”å›å‚æ•°è¢«æ‰“åŒ…å›å•ä¸ªå›å¤ç¼“å†²åŒºã€‚ å‘é€å›å¤ã€‚å›å¤æœ€ç»ˆå‘é€ç»™è°ƒç”¨è€…ã€‚ å­˜æ ¹ç¼–è¯‘å™¨è¿˜éœ€è¦è€ƒè™‘å…¶ä»–ä¸€äº›é‡è¦é—®é¢˜ã€‚ é¦–å…ˆæ˜¯å¤æ‚å‚æ•°ï¼Œå³å¦‚ä½•æ‰“åŒ…å’Œå‘é€å¤æ‚çš„æ•°æ®ç»“æ„ï¼Ÿä¾‹å¦‚ï¼Œå½“è°ƒç”¨ write() ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œéœ€è¦ä¼ é€’ä¸‰ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ•´æ•°æ–‡ä»¶æè¿°ç¬¦ã€ä¸€ä¸ªæŒ‡å‘ç¼“å†²åŒºçš„æŒ‡é’ˆå’Œä¸€ä¸ªè¡¨ç¤ºè¦å†™å…¥å¤šå°‘å­—èŠ‚ï¼ˆä»æŒ‡é’ˆå¼€å§‹ï¼‰çš„å¤§å°ã€‚å¦‚æœä¸€ä¸ª RPC ç¨‹åºåŒ…ä¼ é€’äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒå°±éœ€è¦çŸ¥é“å¦‚ä½•è§£é‡Šè¯¥æŒ‡é’ˆï¼Œå¹¶æ‰§è¡Œæ­£ç¡®çš„æ“ä½œã€‚é€šå¸¸ï¼Œè¿™å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°ï¼šä¸€ç§æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œç”¨äºä¼ é€’ç»™å®šå¤§å°çš„æ•°æ®å—çš„buffer_tï¼ŒRPC ç¼–è¯‘å™¨å¯ä»¥ç†è§£ï¼‰ï¼Œå¦ä¸€ç§æ˜¯ä¸ºæ•°æ®ç»“æ„æ³¨é‡Šæ›´å¤šä¿¡æ¯ï¼Œä½¿ç¼–è¯‘å™¨çŸ¥é“å“ªäº›å­—èŠ‚éœ€è¦åºåˆ—åŒ–ã€‚ å¦ä¸€ä¸ªé‡è¦é—®é¢˜æ˜¯æœåŠ¡å™¨çš„å¹¶å‘ç»„ç»‡ã€‚ç®€å•çš„æœåŠ¡å™¨åªæ˜¯åœ¨ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¸­ç­‰å¾…è¯·æ±‚ï¼Œå¹¶ä¸€æ¬¡å¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚ä½ å¯èƒ½å·²ç»çŒœåˆ°çš„é‚£æ ·ï¼Œè¿™æ ·åšçš„æ•ˆç‡ä¼šéå¸¸ä½ï¼šå¦‚æœä¸€ä¸ª RPC è°ƒç”¨é˜»å¡ï¼ˆä¾‹å¦‚ï¼Œåœ¨ I/O ä¸Šï¼‰ï¼ŒæœåŠ¡å™¨èµ„æºå°±ä¼šè¢«æµªè´¹ã€‚ å› æ­¤ï¼Œå¤§å¤šæ•°æœåŠ¡å™¨éƒ½æ˜¯ä»¥æŸç§å¹¶å‘æ–¹å¼æ„å»ºçš„ã€‚ä¸€ç§å¸¸è§çš„ç»„ç»‡æ–¹å¼æ˜¯çº¿ç¨‹æ± ã€‚åœ¨è¿™ç§ç»„ç»‡ç»“æ„ä¸­ï¼ŒæœåŠ¡å™¨å¯åŠ¨æ—¶ä¼šåˆ›å»ºä¸€ç»„æœ‰é™çš„çº¿ç¨‹ï¼›å½“æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼Œå®ƒä¼šè¢«åˆ†æ´¾åˆ°è¿™äº›å·¥ä½œçº¿ç¨‹ä¸­çš„ä¸€ä¸ªï¼Œç„¶åå·¥ä½œçº¿ç¨‹ä¼šæ‰§è¡Œ RPC è°ƒç”¨çš„å·¥ä½œï¼Œå¹¶æœ€ç»ˆå›å¤ï¼›åœ¨æ­¤æœŸé—´ï¼Œä¸»çº¿ç¨‹ä¼šä¸æ–­æ¥æ”¶å…¶ä»–è¯·æ±‚ï¼Œå¹¶å¯èƒ½å°†å…¶åˆ†æ´¾ç»™å…¶ä»–å·¥ä½œçº¿ç¨‹ã€‚è¿™ç§ç»„ç»‡æ–¹å¼å¯ä»¥åœ¨æœåŠ¡å™¨å†…å®ç°å¹¶å‘æ‰§è¡Œï¼Œä»è€Œæé«˜æœåŠ¡å™¨çš„åˆ©ç”¨ç‡ï¼›åŒæ—¶ä¹Ÿä¼šäº§ç”Ÿæ ‡å‡†æˆæœ¬ï¼Œä¸»è¦æ˜¯ç¼–ç¨‹å¤æ‚åº¦ï¼Œå› ä¸º RPC è°ƒç”¨ç°åœ¨å¯èƒ½éœ€è¦ä½¿ç”¨é”å’Œå…¶ä»–åŒæ­¥åŸè¯­ï¼Œä»¥ç¡®ä¿å…¶æ­£ç¡®è¿è¡Œã€‚ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:6:1","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.2 è¿è¡Œæ—¶åº“ è¿è¡Œæ—¶åº“è´Ÿè´£å¤„ç† RPC ç³»ç»Ÿä¸­çš„å¤§éƒ¨åˆ†ç¹é‡å·¥ä½œï¼›å¤§éƒ¨åˆ†æ€§èƒ½å’Œå¯é æ€§é—®é¢˜éƒ½ç”±è¿è¡Œæ—¶åº“å¤„ç†ã€‚ä¸‹é¢æˆ‘ä»¬å°†è®¨è®ºæ„å»ºè¿™æ ·ä¸€ä¸ªè¿è¡Œæ—¶åº“æ‰€é¢ä¸´çš„ä¸€äº›ä¸»è¦æŒ‘æˆ˜ã€‚ æˆ‘ä»¬å¿…é¡»å…‹æœçš„é¦–è¦æŒ‘æˆ˜ä¹‹ä¸€æ˜¯å¦‚ä½•å®šä½è¿œç¨‹æœåŠ¡ã€‚è¿™ä¸ªå‘½åé—®é¢˜æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¸¸è§é—®é¢˜ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šè¶…å‡ºäº†æˆ‘ä»¬å½“å‰è®¨è®ºçš„èŒƒå›´ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯åˆ©ç”¨ç°æœ‰çš„å‘½åç³»ç»Ÿï¼Œä¾‹å¦‚å½“å‰äº’è”ç½‘åè®®æä¾›çš„ä¸»æœºåå’Œç«¯å£å·ã€‚åœ¨è¿™ç§ç³»ç»Ÿä¸­ï¼Œå®¢æˆ·ç«¯å¿…é¡»çŸ¥é“è¿è¡Œæ‰€éœ€çš„ RPC æœåŠ¡çš„æœºå™¨çš„ä¸»æœºåæˆ– IP åœ°å€ï¼Œä»¥åŠå®ƒæ­£åœ¨ä½¿ç”¨çš„ç«¯å£å·ï¼ˆç«¯å£å·åªæ˜¯ä¸€ç§è¯†åˆ«æœºå™¨ä¸Šæ­£åœ¨è¿›è¡Œçš„ç‰¹å®šé€šä¿¡æ´»åŠ¨çš„æ–¹æ³•ï¼Œå…è®¸åŒæ—¶ä½¿ç”¨å¤šä¸ªé€šä¿¡é€šé“ï¼‰ã€‚ç„¶åï¼Œåè®®å¥—ä»¶å¿…é¡»æä¾›ä¸€ç§æœºåˆ¶ï¼Œå°†æ•°æ®åŒ…ä»ç³»ç»Ÿä¸­çš„ä»»ä½•å…¶ä»–æœºå™¨è·¯ç”±åˆ°ç‰¹å®šåœ°å€ã€‚ ä¸€æ—¦å®¢æˆ·ç«¯çŸ¥é“åº”è¯¥ä¸å“ªå°æœåŠ¡å™¨é€šä¿¡ä»¥è·å–ç‰¹å®šçš„è¿œç¨‹æœåŠ¡ï¼Œä¸‹ä¸€ä¸ªé—®é¢˜å°±æ˜¯ RPC åº”è¯¥åŸºäºå“ªç§ä¼ è¾“çº§åè®®ã€‚å…·ä½“æ¥è¯´ï¼ŒRPC ç³»ç»Ÿåº”è¯¥ä½¿ç”¨ TCP/IP è¿™æ ·å¯é çš„åè®®ï¼Œè¿˜æ˜¯å»ºç«‹åœ¨ UDP/IP è¿™æ ·ä¸å¯é çš„é€šä¿¡å±‚ä¹‹ä¸Šï¼Ÿ å¤©çœŸåœ°è®¤ä¸ºï¼Œé€‰æ‹©ä¼¼ä¹å¾ˆå®¹æ˜“ï¼šæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¸Œæœ›è¯·æ±‚èƒ½å¯é åœ°ä¼ é€åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¯é åœ°æ”¶åˆ°å›å¤ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©å¯é çš„ä¼ è¾“åè®®ï¼Œå¦‚ TCPï¼Œå¯¹å—ï¼Ÿ ä¸å¹¸çš„æ˜¯ï¼Œåœ¨å¯é é€šä¿¡å±‚ä¹‹ä¸Šæ„å»º RPC ä¼šå¯¼è‡´æ€§èƒ½ä¸¥é‡ä½ä¸‹ã€‚å›æƒ³ä¸€ä¸‹ä¸Šæ–‡è®¨è®ºçš„å¯é é€šä¿¡å±‚çš„å·¥ä½œåŸç†ï¼šç¡®è®¤åŠ è¶…æ—¶/é‡è¯•ã€‚å› æ­¤ï¼Œå½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ RPC è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šä»¥ç¡®è®¤çš„æ–¹å¼ä½œå‡ºå“åº”ï¼Œä»¥ä¾¿è°ƒç”¨è€…çŸ¥é“è¯·æ±‚å·²æ”¶åˆ°ã€‚åŒæ ·ï¼Œå½“æœåŠ¡å™¨å‘é€å›å¤ç»™å®¢æˆ·ç«¯æ—¶ï¼Œå®¢æˆ·ç«¯ä¹Ÿä¼šå‘å‡ºç¡®è®¤å“åº”ï¼Œä»¥ä¾¿æœåŠ¡å™¨çŸ¥é“å®ƒå·²æ”¶åˆ°ã€‚åœ¨å¯é çš„é€šä¿¡å±‚ä¹‹ä¸Šå»ºç«‹è¯·æ±‚/å“åº”åè®®ï¼ˆå¦‚ RPCï¼‰ï¼Œéœ€è¦å‘é€ä¸¤æ¡ â€œé¢å¤– â€œä¿¡æ¯ã€‚ å› æ­¤ï¼Œè®¸å¤š RPC ç¨‹åºåŒ…éƒ½å»ºç«‹åœ¨ä¸å¯é çš„é€šä¿¡å±‚ï¼ˆå¦‚ UDPï¼‰ä¹‹ä¸Šã€‚è¿™æ ·åšå¯ä»¥æé«˜ RPC å±‚çš„æ•ˆç‡ï¼Œä½†å´å¢åŠ äº†ä¸º RPC ç³»ç»Ÿæä¾›å¯é æ€§çš„è´£ä»»ã€‚RPC å±‚é€šè¿‡ä½¿ç”¨è¶…æ—¶/é‡è¯•å’Œç¡®è®¤æ¥è¾¾åˆ°æ‰€éœ€çš„è´£ä»»æ°´å¹³ï¼Œè¿™ä¸€ç‚¹ä¸æˆ‘ä»¬ä¸Šé¢æ‰€æè¿°çš„éå¸¸ç›¸ä¼¼ã€‚é€šè¿‡ä½¿ç”¨æŸç§å½¢å¼çš„åºåˆ—å·ï¼Œé€šä¿¡å±‚å¯ä»¥ä¿è¯æ¯ä¸ª RPC æ°å¥½å‘ç”Ÿä¸€æ¬¡ï¼ˆåœ¨æ— æ•…éšœçš„æƒ…å†µä¸‹ï¼‰ï¼Œæˆ–æœ€å¤šå‘ç”Ÿä¸€æ¬¡ï¼ˆåœ¨å‡ºç°æ•…éšœçš„æƒ…å†µä¸‹ï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:6:2","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.3 å…¶ä»–é—®é¢˜ RPC è¿è¡Œæ—¶è¿˜å¿…é¡»å¤„ç†ä¸€äº›å…¶ä»–é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå½“è¿œç¨‹è°ƒç”¨éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè€ƒè™‘åˆ°æˆ‘ä»¬çš„è¶…æ—¶æœºåˆ¶ï¼Œé•¿æ—¶é—´è¿è¡Œçš„è¿œç¨‹è°ƒç”¨å¯èƒ½ä¼šå¯¹å®¢æˆ·ç«¯æ˜¾ç¤ºä¸ºå¤±è´¥ï¼Œä»è€Œè§¦å‘é‡è¯•ï¼Œå› æ­¤è¿™é‡Œéœ€è¦æ³¨æ„ã€‚ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯åœ¨æœªç«‹å³ç”Ÿæˆå›å¤æ—¶ä½¿ç”¨æ˜¾å¼ç¡®è®¤ï¼ˆä»æ¥æ”¶æ–¹åˆ°å‘é€æ–¹ï¼‰ï¼›è¿™è®©å®¢æˆ·ç«¯çŸ¥é“æœåŠ¡å™¨æ”¶åˆ°äº†è¯·æ±‚ã€‚ç„¶åï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œå®¢æˆ·ç«¯å¯ä»¥å®šæœŸè¯¢é—®æœåŠ¡å™¨æ˜¯å¦ä»åœ¨å¤„ç†è¯¥è¯·æ±‚ï¼›å¦‚æœæœåŠ¡å™¨ä¸€ç›´è¯´â€œæ˜¯â€ï¼Œå®¢æˆ·ç«¯åº”è¯¥å¾ˆé«˜å…´å¹¶ç»§ç»­ç­‰å¾…ï¼ˆæ¯•ç«Ÿï¼Œæœ‰æ—¶è¿‡ç¨‹è°ƒç”¨å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆæ‰§è¡Œï¼‰ã€‚ è¿è¡Œæ—¶è¿˜å¿…é¡»å¤„ç†å¸¦æœ‰å¤§å‚æ•°çš„è¿‡ç¨‹è°ƒç”¨ï¼Œè¿™äº›å‚æ•°å¤§äºå•ä¸ªæ•°æ®åŒ…æ‰€èƒ½å®¹çº³çš„å‚æ•°ã€‚ä¸€äº›è¾ƒä½çº§åˆ«çš„ç½‘ç»œåè®®æä¾›æ­¤ç±»å‘é€æ–¹åˆ†æ®µï¼ˆå°†è¾ƒå¤§çš„æ•°æ®åŒ…åˆ†è§£ä¸ºä¸€ç»„è¾ƒå°çš„æ•°æ®åŒ…ï¼‰å’Œæ¥æ”¶æ–¹é‡ç»„ï¼ˆå°†è¾ƒå°çš„éƒ¨åˆ†åˆ†è§£ä¸ºä¸€ä¸ªè¾ƒå¤§çš„é€»è¾‘æ•´ä½“ï¼‰ï¼›å¦‚æœæ²¡æœ‰ï¼ŒRPC è¿è¡Œæ—¶å¯èƒ½å¿…é¡»è‡ªå·±å®ç°æ­¤ç±»åŠŸèƒ½ã€‚ è®¸å¤šç³»ç»Ÿå¤„ç†çš„ä¸€ä¸ªé—®é¢˜æ˜¯å­—èŠ‚æ’åºé—®é¢˜ã€‚æ‚¨å¯èƒ½çŸ¥é“ï¼ŒæŸäº›æœºå™¨ä»¥æ‰€è°“çš„å¤§ç«¯é¡ºåºå­˜å‚¨å€¼ï¼Œè€Œå…¶ä»–æœºå™¨åˆ™ä½¿ç”¨å°ç«¯é¡ºåºã€‚å¤§ç«¯å­˜å‚¨ä»æœ€é«˜æœ‰æ•ˆä½åˆ°æœ€ä½æœ‰æ•ˆä½çš„å­—èŠ‚ï¼ˆä¾‹å¦‚ï¼Œæ•´æ•°ï¼‰ï¼Œå¾ˆåƒé˜¿æ‹‰ä¼¯æ•°å­—ï¼›å°ç«¯åˆ™ç›¸åã€‚ä¸¤è€…éƒ½æ˜¯å­˜å‚¨æ•°å­—ä¿¡æ¯çš„åŒç­‰æœ‰æ•ˆçš„æ–¹å¼ï¼›è¿™é‡Œçš„é—®é¢˜æ˜¯å¦‚ä½•åœ¨ä¸åŒå­—èŠ‚åºçš„æœºå™¨ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ RPC åŒ…é€šå¸¸é€šè¿‡åœ¨å…¶æ¶ˆæ¯æ ¼å¼ä¸­æä¾›æ˜ç¡®å®šä¹‰çš„å­—èŠ‚é¡ºåºæ¥å¤„ç†æ­¤é—®é¢˜ã€‚åœ¨Sunçš„RPCåŒ…ä¸­ï¼ŒXDRï¼ˆå¤–éƒ¨æ•°æ®è¡¨ç¤ºï¼‰å±‚æä¾›äº†æ­¤åŠŸèƒ½ã€‚å¦‚æœå‘é€æˆ–æ¥æ”¶æ¶ˆæ¯çš„æœºå™¨ä¸ XDR çš„å­—èŠ‚é¡ºåºåŒ¹é…ï¼Œåˆ™æ¶ˆæ¯å°†æŒ‰é¢„æœŸå‘é€å’Œæ¥æ”¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœé€šä¿¡çš„æœºå™¨å…·æœ‰ä¸åŒçš„å­—èŠ‚é¡ºåºï¼Œåˆ™å¿…é¡»è½¬æ¢æ¶ˆæ¯ä¸­çš„æ¯æ¡ä¿¡æ¯ã€‚å› æ­¤ï¼Œå­—èŠ‚é¡ºåºçš„å·®å¼‚å¯èƒ½ä¼šå¸¦æ¥å¾ˆå°çš„æ€§èƒ½æˆæœ¬ã€‚ æœ€åä¸€ä¸ªé—®é¢˜æ˜¯æ˜¯å¦å‘å®¢æˆ·ç«¯å…¬å¼€é€šä¿¡çš„å¼‚æ­¥ç‰¹æ€§ï¼Œä»è€Œå®ç°ä¸€äº›æ€§èƒ½ä¼˜åŒ–ã€‚å…·ä½“æ¥è¯´ï¼Œå…¸å‹çš„ RPC æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œå³å½“å®¢æˆ·ç«¯å‘å‡ºè¿‡ç¨‹è°ƒç”¨æ—¶ï¼Œå®ƒå¿…é¡»ç­‰å¾…è¿‡ç¨‹è°ƒç”¨è¿”å›æ‰èƒ½ç»§ç»­ã€‚ç”±äºç­‰å¾…æ—¶é—´å¯èƒ½å¾ˆé•¿ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å¯èƒ½è¿˜æœ‰å…¶ä»–å·¥ä½œè¦åšï¼Œå› æ­¤æŸäº› RPC åŒ…å…è®¸æ‚¨å¼‚æ­¥è°ƒç”¨ RPCã€‚å½“å‘å‡ºå¼‚æ­¥RPCæ—¶ï¼ŒRPCåŒ…å‘é€è¯·æ±‚å¹¶ç«‹å³è¿”å›ï¼›ç„¶åå®¢æˆ·ç«¯å¯ä»¥è‡ªç”±åœ°æ‰§è¡Œå…¶ä»–å·¥ä½œï¼Œä¾‹å¦‚è°ƒç”¨å…¶ä»– RPC æˆ–å…¶ä»–æœ‰ç”¨çš„è®¡ç®—ã€‚å®¢æˆ·ç«¯æœ‰æ—¶ä¼šå¸Œæœ›çœ‹åˆ°å¼‚æ­¥ RPC çš„ç»“æœï¼›å› æ­¤ï¼Œå®ƒå›è°ƒ RPC å±‚ï¼Œå‘Šè¯‰å®ƒç­‰å¾…æœªå®Œæˆçš„ RPC å®Œæˆï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®è¿”å›å‚æ•°ã€‚ ","date":"2024-05-11","objectID":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/:6:3","tags":["OS"],"title":"åˆ†å¸ƒå¼ç³»ç»Ÿ","uri":"/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ç£ç›˜æ•…éšœæ¨¡å¼ ç£ç›˜å¹¶ä¸å®Œç¾ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå‡ºç°æ•…éšœï¼ˆæœ‰æ—¶ï¼‰ã€‚åœ¨æ—©æœŸçš„ RAID ç³»ç»Ÿä¸­ï¼Œæ•…éšœæ¨¡å‹éå¸¸ç®€å•ï¼šè¦ä¹ˆæ•´ä¸ªç£ç›˜æ­£å¸¸å·¥ä½œï¼Œè¦ä¹ˆå®Œå…¨æ•…éšœï¼Œå¹¶ä¸”æ£€æµ‹æ­¤ç±»æ•…éšœéå¸¸ç®€å•ã€‚è¿™ç§ç£ç›˜æ•…éšœçš„æ•…éšœåœæ­¢æ¨¡å‹ä½¿å¾—æ„å»º RAID ç›¸å¯¹ç®€å•ã€‚ ä½†ç°ä»£ç£ç›˜æ‰€è¡¨ç°å‡ºçš„è¿˜æœ‰å…¶ä»–ç±»å‹çš„æ•…éšœæ¨¡å¼ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚ Bairavasundaram ç­‰äººç»è¿‡è¯¦ç»†ç ”ç©¶ ï¼Œç°ä»£ç£ç›˜æœ‰æ—¶çœ‹èµ·æ¥å¤§éƒ¨åˆ†å·¥ä½œæ­£å¸¸ï¼Œä½†åœ¨æˆåŠŸè®¿é—®ä¸€ä¸ªæˆ–å¤šä¸ªå—æ—¶é‡åˆ°é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œæœ‰ä¸¤ç§ç±»å‹çš„å•å—æ•…éšœå¾ˆå¸¸è§ä¸”å€¼å¾—è€ƒè™‘ï¼šé™é»˜æ‰‡åŒºé”™è¯¯ (LSE) å’Œå—æŸåã€‚æˆ‘ä»¬ç°åœ¨å°†æ›´è¯¦ç»†åœ°è®¨è®ºæ¯ä¸€ä¸ªã€‚ å½“ç£ç›˜æ‰‡åŒºï¼ˆæˆ–æ‰‡åŒºç»„ï¼‰å—åˆ°æŸç§æŸåæ—¶ï¼Œå°±ä¼šå‡ºç° LSEã€‚ä¾‹å¦‚ï¼Œå¦‚æœç£ç›˜ç£å¤´ç”±äºæŸç§åŸå› ï¼ˆç£å¤´æ’å‡»ï¼Œæ­£å¸¸è¿è¡Œä¸­ä¸åº”è¯¥å‘ç”Ÿçš„æƒ…å†µï¼‰æ¥è§¦åˆ°ç£ç›˜è¡¨é¢ï¼Œå¯èƒ½ä¼šæŸåç£ç›˜è¡¨é¢ï¼Œå¯¼è‡´ä½æ— æ³•è¯»å–ã€‚å®‡å®™å°„çº¿ä¹Ÿä¼šä½¿ä½ç¿»è½¬ï¼Œå¯¼è‡´å†…å®¹é”™è¯¯ã€‚å¹¸è¿çš„æ˜¯ï¼Œç¡¬ç›˜ä¼šä½¿ç”¨ç£ç›˜å†…çº é”™ç  (ECC) æ¥ç¡®å®šå—ä¸­çš„ç£ç›˜ä½æ˜¯å¦æ­£ç¡®ï¼Œå¹¶åœ¨æŸäº›æƒ…å†µä¸‹å¯¹å…¶è¿›è¡Œä¿®å¤ï¼›å¦‚æœä½ä¸æ­£ç¡®ï¼Œè€Œç¡¬ç›˜åˆæ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥ä¿®å¤é”™è¯¯ï¼Œåˆ™åœ¨è¯·æ±‚è¯»å–æ—¶ç£ç›˜ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ã€‚ è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œç£ç›˜å—æŸåçš„æ–¹å¼æ— æ³•è¢«ç£ç›˜æœ¬èº«æ£€æµ‹åˆ°ã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ¼æ´çš„ç£ç›˜å›ºä»¶å¯èƒ½ä¼šå°†å—å†™å…¥é”™è¯¯ä½ç½®ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç£ç›˜ ECC æ˜¾ç¤ºå—å†…å®¹æ­£å¸¸ï¼Œä½†ä»å®¢æˆ·ç«¯çš„è§’åº¦æ¥çœ‹ï¼Œéšåè®¿é—®æ—¶ä¼šè¿”å›é”™è¯¯çš„å—ã€‚åŒæ ·ï¼Œå½“æ•°æ®å—é€šè¿‡æ•…éšœæ€»çº¿ä»ä¸»æœºä¼ è¾“åˆ°ç£ç›˜æ—¶ï¼Œä¹Ÿå¯èƒ½ä¼šæŸåæ•°æ®å—ï¼›ç£ç›˜ä¼šå­˜å‚¨æŸåçš„æ•°æ®ï¼Œä½†è¿™äº›æ•°æ®å¹¶ä¸æ˜¯å®¢æˆ·æƒ³è¦çš„ã€‚è¿™ç±»æ•…éšœç‰¹åˆ«éšè”½ï¼Œå› ä¸ºå®ƒä»¬æ˜¯é™é»˜æ•…éšœï¼›ç£ç›˜åœ¨è¿”å›æ•…éšœæ•°æ®æ—¶ä¸ä¼šæ˜¾ç¤ºé—®é¢˜ã€‚ Prabhakaran ç­‰äººå°†è¿™ç§æ›´ç°ä»£çš„ç£ç›˜æ•…éšœè§‚ç‚¹ç§°ä¸ºéƒ¨åˆ†æ•…éšœç£ç›˜æ•…éšœæ¨¡å‹ã€‚åœ¨è¿™ç§è§‚ç‚¹ä¸­ï¼Œç£ç›˜ä»æœ‰å¯èƒ½å…¨éƒ¨å¤±æ•ˆï¼ˆå°±åƒä¼ ç»Ÿçš„æ•…éšœ-åœæ­¢æ¨¡å‹ä¸­çš„æƒ…å†µä¸€æ ·ï¼‰ï¼›ä½†æ˜¯ï¼Œç£ç›˜ä¹Ÿæœ‰å¯èƒ½çœ‹ä¼¼æ­£å¸¸å·¥ä½œï¼Œä½†æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªåŒºå—å˜å¾—ä¸å¯è®¿é—®ï¼ˆå³ LSEï¼‰æˆ–åŒ…å«é”™è¯¯çš„å†…å®¹ï¼ˆå³æŸåï¼‰ã€‚å› æ­¤ï¼Œåœ¨è®¿é—®çœ‹ä¼¼æ­£å¸¸å·¥ä½œçš„ç£ç›˜æ—¶ï¼Œå¶å°”ä¼šåœ¨å°è¯•è¯»å–æˆ–å†™å…¥ç»™å®šå—æ—¶è¿”å›é”™è¯¯ï¼ˆéé™é»˜éƒ¨åˆ†æ•…éšœï¼‰ï¼Œå¶å°”ä¹Ÿä¼šç®€å•åœ°è¿”å›é”™è¯¯æ•°æ®ï¼ˆé™é»˜éƒ¨åˆ†æ•…éšœï¼‰ã€‚ è¿™ä¸¤ç±»æ•…éšœéƒ½æ¯”è¾ƒç½•è§ï¼Œä½†ç©¶ç«Ÿæœ‰å¤šç½•è§å‘¢ï¼Ÿä¸‹å›¾æ€»ç»“äº†ä¸¤ä»½ Bairavasundaram ç ”ç©¶æŠ¥å‘Šçš„éƒ¨åˆ†ç»“è®ºã€‚ è¯¥å›¾æ˜¾ç¤ºäº†åœ¨ç ”ç©¶è¿‡ç¨‹ä¸­ï¼ˆçº¦ 3 å¹´ï¼Œè¶…è¿‡ 150 ä¸‡å°ç¡¬ç›˜ï¼‰è‡³å°‘å‡ºç°è¿‡ä¸€æ¬¡ LSE æˆ–å—æŸåçš„ç¡¬ç›˜ç™¾åˆ†æ¯”ã€‚è¯¥å›¾å°†ç»“æœè¿›ä¸€æ­¥ç»†åˆ†ä¸º â€œå»‰ä»· â€œç¡¬ç›˜ï¼ˆé€šå¸¸ä¸º SATA ç¡¬ç›˜ï¼‰å’Œ â€œæ˜‚è´µ â€œç¡¬ç›˜ï¼ˆé€šå¸¸ä¸º SCSI æˆ–å…‰çº¤é€šé“ç¡¬ç›˜ï¼‰ã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œè™½ç„¶è´­ä¹°æ›´å¥½çš„ç¡¬ç›˜é™ä½äº†è¿™ä¸¤ç±»é—®é¢˜çš„å‘ç”Ÿé¢‘ç‡ï¼ˆå¤§çº¦é™ä½äº†ä¸€ä¸ªæ•°é‡çº§ï¼‰ï¼Œä½†å®ƒä»¬ä»ç„¶ç»å¸¸å‘ç”Ÿï¼Œå› æ­¤æ‚¨éœ€è¦ä»”ç»†è€ƒè™‘å¦‚ä½•åœ¨å­˜å‚¨ç³»ç»Ÿä¸­å¤„ç†å®ƒä»¬ã€‚ å…³äº LSE çš„ä¸€äº›å…¶ä»–å‘ç°åŒ…æ‹¬ï¼š å…·æœ‰å¤šä¸ª LSE çš„æ˜‚è´µé©±åŠ¨å™¨ä¸è¾ƒä¾¿å®œçš„é©±åŠ¨å™¨ä¸€æ ·å¯èƒ½äº§ç”Ÿé¢å¤–é”™è¯¯ï¼› å¯¹äºå¤§å¤šæ•°é©±åŠ¨å™¨ï¼Œç¬¬äºŒå¹´çš„å¹´é”™è¯¯ç‡ä¼šå¢åŠ ï¼› LSE æ•°é‡éšç€ç£ç›˜å¤§å°çš„å¢åŠ è€Œå¢åŠ ï¼› å¤§å¤šæ•°ç£ç›˜å…·æœ‰LSE å°‘äº 50 ä¸ªï¼› å…·æœ‰ LSE çš„ç£ç›˜æ›´æœ‰å¯èƒ½äº§ç”Ÿé¢å¤–çš„ LSEï¼› å­˜åœ¨å¤§é‡çš„ç©ºé—´å’Œæ—¶é—´å±€éƒ¨æ€§ï¼› ç£ç›˜æ¸…ç†å¾ˆæœ‰ç”¨ï¼ˆå¤§å¤šæ•° LSE éƒ½æ˜¯é€šè¿‡è¿™ç§æ–¹å¼æ‰¾åˆ°çš„ï¼‰ ã€‚ å…³äºæŸåçš„ä¸€äº›å‘ç°ï¼š åŒä¸€é©±åŠ¨å™¨ç±»åˆ«ä¸­ä¸åŒé©±åŠ¨å™¨å‹å·çš„æŸåå‡ ç‡å·®å¼‚å¾ˆå¤§ï¼› å‹å·ä¹‹é—´çš„è€åŒ–å½±å“ä¸åŒï¼› å·¥ä½œè´Ÿè½½å’Œç£ç›˜å¤§å°å¯¹æŸåå½±å“å¾ˆå° å¤§å¤šæ•°æŸåçš„ç£ç›˜åªæœ‰å°‘æ•°æŸåï¼› æŸååœ¨ç£ç›˜å†…æˆ– RAID ä¸­çš„ç£ç›˜ä¹‹é—´ä¸æ˜¯ç‹¬ç«‹çš„ï¼› å­˜åœ¨ç©ºé—´å±€éƒ¨æ€§å’Œä¸€äº›æ—¶é—´å±€éƒ¨æ€§ ä¸LSE çš„ç›¸å…³æ€§å¾ˆå¼± ä¸€ä¸ªå¯é çš„å­˜å‚¨ç³»ç»Ÿï¼Œéœ€è¦æœ‰æ£€æµ‹å’Œæ¢å¤ LSE å’Œå—æŸåçš„æœºåˆ¶ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:1:0","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 å¤„ç†é™é»˜æ‰‡åŒºé”™è¯¯ï¼ˆLSEï¼‰ è€ƒè™‘åˆ°è¿™ä¸¤ç§æ–°çš„éƒ¨åˆ†ç£ç›˜æ•…éšœæ¨¡å¼ï¼Œæˆ‘ä»¬ç°åœ¨åº”è¯¥å°è¯•çœ‹çœ‹æˆ‘ä»¬å¯ä»¥å¯¹å®ƒä»¬åšäº›ä»€ä¹ˆã€‚è®©æˆ‘ä»¬é¦–å…ˆè§£å†³ä¸¤è€…ä¸­è¾ƒå®¹æ˜“çš„ä¸€ä¸ªï¼Œå³é™é»˜æ‰‡åŒºé”™è¯¯ã€‚ å…³é”®é—®é¢˜ï¼šå­˜å‚¨ç³»ç»Ÿåº”å¦‚ä½•å¤„ç†é™é»˜æ‰‡åŒºé”™è¯¯ï¼Ÿéœ€è¦å¤šå°‘é¢å¤–çš„æœºåˆ¶æ¥å¤„ç†è¿™ç§å½¢å¼çš„éƒ¨åˆ†æ•…éšœï¼Ÿ äº‹å®è¯æ˜ï¼Œé™é»˜æ‰‡åŒºé”™è¯¯çš„å¤„ç†ç›¸å½“ç®€å•ï¼Œå› ä¸ºå®ƒä»¬ï¼ˆæ ¹æ®å®šä¹‰ï¼‰å¾ˆå®¹æ˜“æ£€æµ‹åˆ°ã€‚å½“å­˜å‚¨ç³»ç»Ÿå°è¯•è®¿é—®å—å¹¶ä¸”ç£ç›˜è¿”å›é”™è¯¯æ—¶ï¼Œå­˜å‚¨ç³»ç»Ÿåº”è¯¥ç®€å•åœ°ä½¿ç”¨å®ƒæ‰€æ‹¥æœ‰çš„ä»»ä½•å†—ä½™æœºåˆ¶æ¥è¿”å›æ­£ç¡®çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œ åœ¨é•œåƒ RAID ä¸­ï¼Œç³»ç»Ÿåº”è¯¥è®¿é—®å¤‡ç”¨å‰¯æœ¬ï¼› åœ¨åŸºäºå¥‡å¶æ ¡éªŒçš„ RAID-4 æˆ– RAID-5 ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿåº”ä»å¥‡å¶æ ¡éªŒç»„ä¸­çš„å…¶ä»–å—é‡å»ºè¯¥å—ã€‚ å› æ­¤ï¼Œè¯¸å¦‚ LSE ç­‰å®¹æ˜“æ£€æµ‹åˆ°çš„é—®é¢˜å¯ä»¥é€šè¿‡æ ‡å‡†å†—ä½™æœºåˆ¶è½»æ¾æ¢å¤ã€‚ LSEçš„ä¸æ–­å¢å¤šå½±å“äº†å¤šå¹´æ¥RAIDè®¾è®¡ã€‚åœ¨RAID-4/5ç³»ç»Ÿä¸­ï¼Œå½“æ•´ä¸ªç£ç›˜æ•…éšœå’ŒLSEåŒæ—¶å‘ç”Ÿæ—¶ï¼Œä¼šå‡ºç°ä¸€ä¸ªç‰¹åˆ«æœ‰è¶£çš„é—®é¢˜ã€‚å…·ä½“è€Œè¨€ï¼Œåœ¨æ•´ä¸ªç£ç›˜å¤±è´¥æ—¶ï¼ŒRAIDå°è¯•é€šè¿‡è¯»å–å¥‡å¶æ ¡éªŒç»„ä¸­æ‰€æœ‰å…¶ä»–ç£ç›˜å¹¶é‡æ–°è®¡ç®—ç¼ºå¤±å€¼æ¥é‡å»ºè¯¥ç£ç›˜ï¼ˆæ¯”å¦‚è¯´ï¼Œåˆ°ä¸€ä¸ªçƒ­å¤‡ç”¨ä¸Šï¼‰ã€‚å¦‚æœåœ¨é‡å»ºè¿‡ç¨‹ä¸­ï¼Œåœ¨ä»»ä½•å…¶ä»–ä¸€å—ç£ç›˜ä¸Šé‡åˆ°LSEï¼Œåˆ™ä¼šå‡ºç°é—®é¢˜ï¼šæ— æ³•æˆåŠŸå®Œæˆé‡å»ºã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€äº›ç³»ç»Ÿå¢åŠ äº†é¢å¤–çš„å†—ä½™åº¦ã€‚ä¾‹å¦‚ï¼ŒNetAppçš„RAID-DPç›¸å½“äºä¸¤å—å¥‡å¶æ ¡éªŒç¡¬ç›˜è€Œä¸æ˜¯ä¸€å—ã€‚å½“åœ¨é‡å»ºè¿‡ç¨‹ä¸­å‘ç°LSEæ—¶ï¼Œé¢å¤–çš„å¥‡å¶æ ¡éªŒæœ‰åŠ©äºé‡æ„ä¸¢å¤±çš„æ•°æ®å—ã€‚æ­£å¦‚å§‹ç»ˆå¦‚æ­¤åœ°å­˜åœ¨æˆæœ¬é‚£æ ·ï¼Œåœ¨æ¯æ¡æ¡å¸¦ä¿æŒä¸¤å—å¥‡å¶æ ¡éªŒç¡¬ç›˜æ›´æ˜‚è´µï¼›ç„¶è€Œï¼ŒNetApp WAFLæ–‡ä»¶ç³»ç»Ÿçš„æ—¥å¿—ç»“æ„åŒ–æ€§è´¨åœ¨è®¸å¤šæƒ…å†µä¸‹å¯ä»¥å‡è½»è¿™ç§æˆæœ¬ã€‚å‰©ä¸‹çš„æˆæœ¬æ˜¯ç©ºé—´æ–¹é¢ï¼Œåœ¨ç¬¬äºŒä¸ªå¥‡å¶æ ¡éªŒåŒºå—å½¢å¼ä¸Šéœ€è¦é¢å¤–ä¸€å—ç¡¬ç›˜ã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:2:0","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 æ£€æµ‹æŸåï¼šæ ¡éªŒå’Œ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:3:0","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 åŸºæœ¬ä»‹ç» ç°åœ¨è®©æˆ‘ä»¬è§£å†³æ›´å…·æŒ‘æˆ˜æ€§çš„é—®é¢˜ï¼Œå³é€šè¿‡æ•°æ®æŸåå¯¼è‡´çš„é™é»˜æ•…éšœã€‚å½“æ•°æ®æŸåå¯¼è‡´ç£ç›˜è¿”å›åæ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•é˜²æ­¢ç”¨æˆ·è·å¾—åæ•°æ®ï¼Ÿ å…³é”®é—®é¢˜ï¼šé‰´äºæ­¤ç±»æ•…éšœçš„éšåŒ¿æ€§ï¼Œå­˜å‚¨ç³»ç»Ÿå¯ä»¥é‡‡å–å“ªäº›æªæ–½æ¥æ£€æµ‹ä½•æ—¶å‘ç”ŸæŸåï¼Ÿéœ€è¦ä»€ä¹ˆæŠ€æœ¯ï¼Ÿå¦‚ä½•æœ‰æ•ˆåœ°å®æ–½å®ƒä»¬ï¼Ÿ ä¸é™é»˜æ‰‡åŒºé”™è¯¯ä¸åŒï¼ŒæŸåæ£€æµ‹æ˜¯ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚å®¢æˆ·ç«¯å¦‚ä½•çŸ¥é“æŸä¸ªå—å·²ç»åäº†ï¼Ÿä¸€æ—¦çŸ¥é“æŸä¸ªç‰¹å®šå—æŸåï¼Œæ¢å¤å°±ä¸ä»¥å‰ç›¸åŒï¼šæ‚¨éœ€è¦è¯¥å—çš„å…¶ä»–å‰¯æœ¬ï¼ˆå¸Œæœ›æ˜¯ä¸€ä¸ªæœªæŸåçš„å‰¯æœ¬ï¼ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé‡ç‚¹å…³æ³¨æ£€æµ‹æŠ€æœ¯ã€‚ ç°ä»£å­˜å‚¨ç³»ç»Ÿç”¨äºä¿æŒæ•°æ®å®Œæ•´æ€§çš„ä¸»è¦æœºåˆ¶ç§°ä¸ºæ ¡éªŒå’Œã€‚æ ¡éªŒå’Œåªæ˜¯ä¸€ä¸ªå‡½æ•°çš„ç»“æœï¼Œè¯¥å‡½æ•°å°†ä¸€å—æ•°æ®ï¼ˆä¾‹å¦‚ 4KB å—ï¼‰ä½œä¸ºè¾“å…¥ï¼Œå¹¶æ ¹æ®æ‰€è¿°æ•°æ®è®¡ç®—å‡½æ•°ï¼Œç”Ÿæˆæ•°æ®å†…å®¹çš„å°æ‘˜è¦ï¼ˆä¾‹å¦‚ 4 æˆ– 8 å­—èŠ‚ï¼‰ï¼Œè¯¥æ‘˜è¦ç§°ä¸ºæ ¡éªŒå’Œã€‚è¿™ç§è®¡ç®—çš„ç›®æ ‡æ˜¯ä½¿ç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡å°†æ ¡éªŒå’Œä¸æ•°æ®ä¸€èµ·å­˜å‚¨æ¥æ£€æµ‹æ•°æ®æ˜¯å¦å·²è¢«æŸåæˆ–æ›´æ”¹ï¼Œç„¶ååœ¨ä»¥åè®¿é—®æ—¶ç¡®è®¤æ•°æ®çš„å½“å‰æ ¡éªŒå’Œä¸åŸå§‹å­˜å‚¨å€¼ç›¸åŒ¹é…ã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:3:1","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 å¸¸ç”¨æ ¡éªŒå’Œå‡½æ•° è®¸å¤šä¸åŒçš„å‡½æ•°ç”¨äºè®¡ç®—æ ¡éªŒå’Œï¼Œå®ƒä»¬çš„å¼ºåº¦ï¼ˆå³ï¼Œå®ƒä»¬åœ¨ä¿æŠ¤æ•°æ®å®Œæ•´æ€§æ–¹é¢çš„èƒ½åŠ›ï¼‰å’Œé€Ÿåº¦ï¼ˆå³ï¼Œå®ƒä»¬çš„è®¡ç®—é€Ÿåº¦ï¼‰å„ä¸ç›¸åŒã€‚è¿™é‡Œå‡ºç°äº†ç³»ç»Ÿä¸­å¸¸è§çš„æƒè¡¡ï¼šé€šå¸¸ï¼Œè·å¾—çš„ä¿æŠ¤è¶Šå¤šï¼Œæˆæœ¬å°±è¶Šé«˜ã€‚ æœ‰äº›äººä½¿ç”¨çš„ä¸€ç§ç®€å•çš„æ ¡éªŒå’Œå‡½æ•°æ˜¯åŸºäºå¼‚æˆ– (XOR) çš„ã€‚å¯¹äºåŸºäº XOR çš„æ ¡éªŒå’Œï¼Œæ ¡éªŒå’Œæ˜¯é€šè¿‡å¯¹æ­£åœ¨æ ¡éªŒå’Œçš„æ•°æ®å—çš„æ¯ä¸ªå—è¿›è¡Œå¼‚æˆ–æ¥è®¡ç®—çš„ï¼Œä»è€Œç”Ÿæˆè¡¨ç¤ºæ•´ä¸ªå—çš„ XOR çš„å•ä¸ªå€¼ã€‚ ä¸ºäº†æ›´å…·ä½“åœ°è¯´æ˜è¿™ä¸€ç‚¹ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨ 16 å­—èŠ‚çš„å—ä¸Šè®¡ç®— 4 å­—èŠ‚çš„æ ¡éªŒå’Œï¼ˆè¿™ä¸ªå—å½“ç„¶å¤ªå°ï¼Œä¸èƒ½çœŸæ­£æˆä¸ºç£ç›˜æ‰‡åŒºæˆ–å—ï¼Œä½†å®ƒå°†ç”¨äºç¤ºä¾‹ï¼‰ã€‚ 16 ä¸ªæ•°æ®å­—èŠ‚ï¼ˆåå…­è¿›åˆ¶ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼š 365e c4cd ba14 8a92 ecef 2c3a 40be f666 å¦‚æœç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š 0011 0110 0101 1110 1100 0100 1100 1101 1011 1010 0001 0100 1000 1010 1001 0010 1110 1100 1110 1111 0010 1100 0011 1010 0100 0000 1011 1110 1111 0110 0110 0110 ç”±äºæˆ‘ä»¬ä»¥æ¯è¡Œ 4 ä¸ªå­—èŠ‚ä¸ºä¸€ç»„æ’åˆ—æ•°æ®ï¼Œå› æ­¤å¾ˆå®¹æ˜“çœ‹å‡ºæ ¡éªŒå’Œçš„ç»“æœï¼šåœ¨æ¯åˆ—ä¸Šæ‰§è¡Œ XOR å³å¯å¾—åˆ°æœ€ç»ˆçš„æ ¡éªŒå’Œå€¼ï¼š 0010 0000 0001 1011 1001 0100 0000 0011 ç»“æœï¼ˆåå…­è¿›åˆ¶ï¼‰ä¸º0x201b9403ã€‚ XOR æ˜¯ä¸€ç§åˆç†çš„æ ¡éªŒå’Œæ–¹æ³•ï¼Œä½†æœ‰å…¶å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ¯ä¸ªæ ¡éªŒå’Œå•å…ƒä¸­åŒä¸€ä½ç½®çš„ä¸¤ä¸ªä½å‘ç”Ÿå˜åŒ–ï¼Œåˆ™æ ¡éªŒå’Œå°†æ— æ³•æ£€æµ‹åˆ°æŸåã€‚ä¸ºæ­¤ï¼Œäººä»¬ç ”ç©¶äº†å…¶ä»–æ ¡éªŒå’Œå‡½æ•°ã€‚ å¦ä¸€ç§åŸºæœ¬çš„æ ¡éªŒå‡½æ•°æ˜¯åŠ æ³•ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«ï¼›è®¡ç®—æ—¶åªéœ€å¯¹æ¯å—æ•°æ®æ‰§è¡Œ 2 çš„è¡¥ç åŠ æ³•ï¼Œå¿½ç•¥æº¢å‡ºã€‚å®ƒå¯ä»¥æ£€æµ‹åˆ°æ•°æ®çš„è®¸å¤šå˜åŒ–ï¼Œä½†å¦‚æœæ•°æ®å‘ç”Ÿç§»ä½ç­‰æƒ…å†µï¼Œåˆ™æ•ˆæœä¸ä½³ã€‚ Fletcheræ ¡éªŒå’Œæ˜¯ä¸€ç§ç•¥å¾®å¤æ‚çš„ç®—æ³•ï¼Œä»¥John G. Fletcherçš„åå­—å‘½åã€‚å®ƒçš„è®¡ç®—éå¸¸ç®€å•ï¼Œåªéœ€è®¡ç®—ä¸¤ä¸ªæ ¡éªŒå­—èŠ‚ $s_1$ å’Œ $s_2$ã€‚å…·ä½“æ¥è¯´ï¼Œå‡è®¾æ•°æ®å— $D$ ç”±å­—èŠ‚ $d_1 \\dots d_n$ ç»„æˆï¼›$s_1$ çš„å®šä¹‰å¦‚ä¸‹ï¼š$s_1 = (s_1 + d_i) \\mod 255$ï¼ˆå¯¹æ‰€æœ‰ $d_i$ è¿›è¡Œè®¡ç®—ï¼‰ï¼›$s_2$ çš„å®šä¹‰å¦‚ä¸‹ï¼š$s_2 = (s_2 + s_1) \\mod 255$ï¼ˆåŒæ ·å¯¹æ‰€æœ‰ $d_i$ è¿›è¡Œè®¡ç®—ï¼‰ã€‚Fletcher æ ¡éªŒå’Œä¸ CRC å‡ ä¹ä¸€æ ·å¼ºï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œèƒ½æ£€æµ‹å‡ºæ‰€æœ‰å•bitã€åŒbité”™è¯¯å’Œè®¸å¤šçªå‘é”™è¯¯ã€‚ æœ€åä¸€ç§å¸¸ç”¨çš„æ ¡éªŒå’Œç§°ä¸ºå¾ªç¯å†—ä½™æ ¡éªŒï¼ˆCRCï¼‰ã€‚å‡è®¾è¦è®¡ç®—æ•°æ®å— D çš„æ ¡éªŒå’Œï¼Œåªéœ€å°† D è§†ä¸ºä¸€ä¸ªå¤§çš„äºŒè¿›åˆ¶æ•°ï¼ˆæ¯•ç«Ÿåªæ˜¯ä¸€ä¸²bitï¼‰ï¼Œç„¶åé™¤ä»¥ä¸€ä¸ªçº¦å®šçš„å€¼ï¼ˆ$k$ï¼‰ã€‚é™¤æ•°çš„ä½™æ•°å°±æ˜¯ CRC çš„å€¼ã€‚äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›¸å½“é«˜æ•ˆåœ°å®ç°è¿™ç§äºŒè¿›åˆ¶æ¨¡è¿ç®—ï¼Œå› æ­¤ CRC åœ¨ç½‘ç»œä¸­ä¹Ÿå¾ˆæµè¡Œã€‚ æ— è®ºä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œæ˜¾è€Œæ˜“è§çš„æ˜¯ï¼Œæ²¡æœ‰å®Œç¾çš„æ ¡éªŒå’Œï¼šä¸¤ä¸ªå†…å®¹ä¸ç›¸åŒçš„æ•°æ®å—æœ‰å¯èƒ½å…·æœ‰å®Œå…¨ç›¸åŒçš„æ ¡éªŒå’Œï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å†²çªã€‚è¿™ä¸ªäº‹å®åº”è¯¥æ˜¯ç›´è§‚çš„ï¼šæ¯•ç«Ÿï¼Œè®¡ç®—æ ¡éªŒå’Œæ˜¯æŠŠä¸€ä¸ªå¤§çš„ä¸œè¥¿ï¼ˆå¦‚ 4KBï¼‰ï¼Œç”Ÿæˆä¸€ä¸ªå°å¾—å¤šçš„æ‘˜è¦ï¼ˆå¦‚ 4 æˆ– 8 å­—èŠ‚ï¼‰ã€‚å› æ­¤ï¼Œåœ¨é€‰æ‹©ä¸€ä¸ªå¥½çš„æ ¡éªŒå’Œå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬è¯•å›¾æ‰¾åˆ°ä¸€ä¸ªæ—¢èƒ½å°½é‡å‡å°‘å†²çªå‡ ç‡ï¼Œåˆèƒ½ä¿æŒè®¡ç®—ç®€ä¾¿çš„å‡½æ•°ã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:3:2","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 æ ¡éªŒå’Œå¸ƒå±€ ç°åœ¨æ‚¨å·²ç»äº†è§£äº†å¦‚ä½•è®¡ç®—æ ¡éªŒå’Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æå¦‚ä½•åœ¨å­˜å‚¨ç³»ç»Ÿä¸­ä½¿ç”¨æ ¡éªŒå’Œã€‚æˆ‘ä»¬å¿…é¡»è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯æ ¡éªŒå’Œçš„å¸ƒå±€ï¼Œå³æ ¡éªŒå’Œåº”è¯¥å¦‚ä½•å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Ÿ æœ€åŸºæœ¬çš„æ–¹æ³•åªæ˜¯å­˜å‚¨æ¯ä¸ªç£ç›˜æ‰‡åŒºï¼ˆæˆ–å—ï¼‰çš„æ ¡éªŒå’Œã€‚ç»™å®šä¸€ä¸ªæ•°æ®å— Dï¼Œè®©æˆ‘ä»¬è°ƒç”¨è¯¥æ•°æ®çš„æ ¡éªŒå’Œ C(D)ã€‚å› æ­¤ï¼Œå¦‚æœæ²¡æœ‰æ ¡éªŒå’Œï¼Œç£ç›˜å¸ƒå±€å¦‚ä¸‹æ‰€ç¤ºï¼š ä½¿ç”¨æ ¡éªŒå’Œæ—¶ï¼Œå¸ƒå±€ä¼šä¸ºæ¯ä¸ªå—æ·»åŠ ä¸€ä¸ªæ ¡éªŒå’Œï¼š ç”±äºæ ¡éªŒå’Œé€šå¸¸å¾ˆå°ï¼ˆå¦‚ 8 å­—èŠ‚ï¼‰ï¼Œè€Œç£ç›˜åªèƒ½ä»¥æ‰‡åŒºå¤§å°çš„å—ï¼ˆ512 å­—èŠ‚ï¼‰æˆ–å…¶å€æ•°å†™å…¥ï¼Œå› æ­¤å‡ºç°çš„ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚ä½•å®ç°ä¸Šè¿°å¸ƒå±€ã€‚ç¡¬ç›˜åˆ¶é€ å•†é‡‡ç”¨çš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ç”¨ 520 å­—èŠ‚æ‰‡åŒºæ ¼å¼åŒ–ç¡¬ç›˜ï¼›æ¯ä¸ªæ‰‡åŒºé¢å¤–çš„ 8 å­—èŠ‚å¯ç”¨äºå­˜å‚¨æ ¡éªŒå’Œã€‚ å¯¹äºä¸å…·å¤‡è¿™ç§åŠŸèƒ½çš„ç£ç›˜ï¼Œæ–‡ä»¶ç³»ç»Ÿå¿…é¡»æƒ³åŠæ³•å°†æ ¡éªŒå’Œå­˜å‚¨åˆ° 512 å­—èŠ‚çš„å—ä¸­ã€‚å…¶ä¸­ä¸€ç§æ–¹æ³•å¦‚ä¸‹ï¼š åœ¨æ­¤æ–¹æ¡ˆä¸­ï¼Œ$n$ ä¸ªæ ¡éªŒå’Œä¸€èµ·å­˜å‚¨åœ¨ä¸€ä¸ªæ‰‡åŒºä¸­ï¼Œåé¢æ˜¯ $n$ ä¸ªæ•°æ®å—ï¼Œç„¶åæ˜¯ä¸‹ä¸€ä¸ªçš„ $n$ ä¸ªå—çš„å¦ä¸€ä¸ªæ ¡éªŒå’Œæ‰‡åŒºï¼Œä¾æ­¤ç±»æ¨ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥åœ¨æ‰€æœ‰ç£ç›˜ä¸Šå·¥ä½œï¼Œä½†æ•ˆç‡å¯èƒ½è¾ƒä½ï¼›ä¾‹å¦‚ï¼Œå¦‚æœæ–‡ä»¶ç³»ç»Ÿæƒ³è¦è¦†ç›–å—D1ï¼Œåˆ™å¿…é¡»è¯»å…¥åŒ…å«C(D1)çš„æ ¡éªŒå’Œæ‰‡åŒºï¼Œæ›´æ–°å…¶ä¸­çš„C(D1)ï¼Œç„¶åå†™å‡ºæ ¡éªŒå’Œæ‰‡åŒºå’Œæ–°çš„æ•°æ®å—D1ï¼ˆå› æ­¤ï¼Œä¸€æ¬¡è¯»å–å’Œä¸¤æ¬¡å†™å…¥ï¼‰ã€‚æ—©æœŸçš„æ–¹æ³•ï¼ˆæ¯ä¸ªæ‰‡åŒºä¸€ä¸ªæ ¡éªŒå’Œï¼‰ä»…æ‰§è¡Œä¸€æ¬¡å†™å…¥ã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:3:3","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 ä½¿ç”¨æ ¡éªŒå’Œ åœ¨ç¡®å®šäº†æ ¡éªŒå’Œå¸ƒå±€ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹äº†è§£å¦‚ä½•ä½¿ç”¨æ ¡éªŒå’Œäº†ã€‚è¯»å–æ•°æ®å— D æ—¶ï¼Œå®¢æˆ·ç«¯ï¼ˆå³æ–‡ä»¶ç³»ç»Ÿæˆ–å­˜å‚¨æ§åˆ¶å™¨ï¼‰ä¹Ÿä¼šä»ç£ç›˜è¯»å–å…¶æ ¡éªŒå’Œ$C_s(D)$ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå­˜å‚¨æ ¡éªŒå’Œï¼ˆå› æ­¤ä½¿ç”¨äº†ä¸‹æ ‡ $C_s$ï¼‰ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯å¯¹æ£€ç´¢åˆ°çš„æ•°æ®å— D è®¡ç®—æ ¡éªŒå’Œï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè®¡ç®—æ ¡éªŒå’Œ $C_c(D)$ã€‚æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šæ¯”è¾ƒå­˜å‚¨çš„æ ¡éªŒå’Œä¸è®¡ç®—çš„æ ¡éªŒå’Œï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼ˆå³ $C_s(D) == C_c(D)$ï¼‰ï¼Œåˆ™æ•°æ®å¾ˆå¯èƒ½æ²¡æœ‰æŸåï¼Œå› æ­¤å¯ä»¥å®‰å…¨åœ°è¿”å›ç»™ç”¨æˆ·ã€‚å¦‚æœå®ƒä»¬ä¸åŒ¹é…ï¼ˆå³ $C_s(D) != C_c(D)$ï¼‰ï¼Œè¿™æ„å‘³ç€æ•°æ®åœ¨å­˜å‚¨åå‘ç”Ÿäº†å˜åŒ–ï¼ˆå› ä¸ºå­˜å‚¨çš„æ ¡éªŒå’Œåæ˜ çš„æ˜¯æ•°æ®å½“æ—¶çš„å€¼ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„æ ¡éªŒå’Œå¸®åŠ©æˆ‘ä»¬æ£€æµ‹åˆ°äº†æ•°æ®æŸåã€‚ æœ‰äº†æŸåï¼Œæˆ‘ä»¬è‡ªç„¶ä¼šé—®è¯¥å¦‚ä½•å¤„ç†ï¼Ÿå¦‚æœå­˜å‚¨ç³»ç»Ÿæœ‰å†—ä½™å‰¯æœ¬ï¼Œç­”æ¡ˆå¾ˆç®€å•ï¼šå°è¯•ä½¿ç”¨å®ƒã€‚å¦‚æœå­˜å‚¨ç³»ç»Ÿæ²¡æœ‰è¿™æ ·çš„å‰¯æœ¬ï¼Œç­”æ¡ˆå¾ˆå¯èƒ½æ˜¯è¿”å›é”™è¯¯ã€‚ä¸ç®¡æ˜¯å“ªç§æƒ…å†µï¼Œéƒ½è¦è®¤è¯†åˆ°æŸåæ£€æµ‹å¹¶ä¸æ˜¯çµä¸¹å¦™è¯ï¼›å¦‚æœæ²¡æœ‰å…¶ä»–åŠæ³•è·å–æœªæŸåçš„æ•°æ®ï¼Œé‚£å°±åªèƒ½èµ°éœ‰è¿äº†ã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:3:4","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 ä¸€ä¸ªæ–°é—®é¢˜ï¼šé”™è¯¯å†™å…¥ ä¸Šè¿°åŸºæœ¬æ–¹æ¡ˆåœ¨ä¸€èˆ¬çš„å—æŸåæƒ…å†µä¸‹æ•ˆæœå¾ˆå¥½ã€‚ç„¶è€Œï¼Œç°ä»£ç£ç›˜æœ‰å‡ ç§ä¸åŒå¯»å¸¸çš„æ•…éšœæ¨¡å¼ï¼Œéœ€è¦ä¸åŒçš„è§£å†³æ–¹æ¡ˆã€‚ ç¬¬ä¸€ç§æ•…éšœæ¨¡å¼ç§°ä¸ºè¯¯å†™ã€‚ç£ç›˜å’Œ RAID æ§åˆ¶å™¨ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå®ƒä»¬ä¼šå°†æ•°æ®æ­£ç¡®å†™å…¥ç£ç›˜ï¼Œåªæ˜¯å†™é”™äº†ä½ç½®ã€‚åœ¨å•ç£ç›˜ç³»ç»Ÿä¸­ï¼Œè¿™æ„å‘³ç€ç£ç›˜å°†æ•°æ®å— $D_x$ å†™å…¥çš„åœ°å€ä¸æ˜¯ $x$ï¼Œè€Œæ˜¯ $y$ï¼ˆä»è€Œ â€œç ´å â€œäº† $D_y$ï¼‰ï¼›æ­¤å¤–ï¼Œåœ¨å¤šç£ç›˜ç³»ç»Ÿä¸­ï¼Œæ§åˆ¶å™¨ä¹Ÿå¯èƒ½å°† $D_{i,x}$ å†™å…¥çš„åœ°å€ä¸æ˜¯ç£ç›˜ $i$ çš„ $x$ï¼Œè€Œæ˜¯å…¶ä»–ç£ç›˜ $j$ã€‚å› æ­¤å…³é”®é—®é¢˜æ˜¯ï¼š å­˜å‚¨ç³»ç»Ÿæˆ–ç£ç›˜æ§åˆ¶å™¨åº”å¦‚ä½•æ£€æµ‹é”™è¯¯å†™å…¥ï¼Ÿæ ¡éªŒå’Œéœ€è¦å“ªäº›é™„åŠ åŠŸèƒ½ï¼Ÿ ç­”æ¡ˆå¾ˆç®€å•ï¼šåœ¨æ¯ä¸ªæ ¡éªŒå’Œä¸­å¢åŠ ä¸€ç‚¹ä¿¡æ¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¢åŠ ä¸€ä¸ª**ç‰©ç†æ ‡è¯†ç¬¦ï¼ˆç‰©ç† IDï¼‰**æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç°åœ¨å­˜å‚¨çš„ä¿¡æ¯åŒ…å«æ ¡éªŒå’Œ $C(D)$ä»¥åŠå—çš„ç£ç›˜ç¼–å·å’Œæ‰‡åŒºç¼–å·ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±å¾ˆå®¹æ˜“ç¡®å®šæ­£ç¡®çš„ä¿¡æ¯æ˜¯å¦å­˜åœ¨äºç‰¹å®šä½ç½®ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯»å–çš„æ˜¯ç£ç›˜ $10$ ä¸Šçš„å— $4$ï¼ˆ$D_{10,4}$ï¼‰ï¼Œåˆ™å­˜å‚¨çš„ä¿¡æ¯åº”åŒ…æ‹¬è¯¥ç£ç›˜ç¼–å·å’Œæ‰‡åŒºåç§»é‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¦‚æœä¿¡æ¯ä¸åŒ¹é…ï¼Œå°±è¯´æ˜å‘ç”Ÿäº†é”™è¯¯å†™å…¥ï¼Œæ­¤æ—¶å°±ä¼šæ£€æµ‹åˆ°æŸåã€‚ä¸‹é¢æ˜¯åŒç£ç›˜ç³»ç»Ÿä¸­æ·»åŠ ä¿¡æ¯çš„ç¤ºä¾‹ã€‚è¯·æ³¨æ„ï¼Œè¯¥å›¾å’Œä¹‹å‰çš„å…¶ä»–å›¾ä¸€æ ·ï¼Œå¹¶ä¸æ˜¯æŒ‰æ¯”ä¾‹ç»˜åˆ¶çš„ï¼Œå› ä¸ºæ ¡éªŒå’Œé€šå¸¸å¾ˆå°ï¼ˆå¦‚ 8 å­—èŠ‚ï¼‰ï¼Œè€Œæ•°æ®å—å´å¤§å¾—å¤šï¼ˆå¦‚ 4 KB æˆ–æ›´å¤§ï¼‰ï¼š ä»ç£ç›˜ä¸Šçš„æ ¼å¼å¯ä»¥çœ‹å‡ºï¼Œç£ç›˜ä¸Šç°åœ¨æœ‰ç›¸å½“å¤šçš„å†—ä½™ä¿¡æ¯ï¼šå¯¹äºæ¯ä¸ªå—ï¼Œç£ç›˜ç¼–å·åœ¨æ¯ä¸ªæ•°æ®å—å†…é‡å¤å‡ºç°ï¼Œè€Œç›¸å…³å—çš„åç§»é‡ä¹Ÿä¿ç•™åœ¨æ•°æ®å—æœ¬èº«æ—è¾¹ã€‚å†—ä½™ä¿¡æ¯çš„å­˜åœ¨ä¸è¶³ä¸ºå¥‡ï¼Œå› ä¸ºå†—ä½™æ˜¯é”™è¯¯æ£€æµ‹ï¼ˆåœ¨æœ¬ä¾‹ä¸­ï¼‰å’Œæ¢å¤ï¼ˆåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼‰çš„å…³é”®ã€‚è™½ç„¶å®Œç¾çš„ç£ç›˜å¹¶ä¸ä¸¥æ ¼éœ€è¦ä¸€ç‚¹é¢å¤–çš„ä¿¡æ¯ï¼Œä½†å¦‚æœå‡ºç°é—®é¢˜ï¼Œè¿™äº›ä¿¡æ¯å´èƒ½å¸®åŠ©æ£€æµ‹å‡ºé—®é¢˜æ‰€åœ¨ã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:4:0","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 æœ€åä¸€ä¸ªé—®é¢˜ï¼šå†™å…¥ä¸¢å¤± ä¸å¹¸çš„æ˜¯ï¼Œé”™è¯¯å†™å…¥å¹¶ä¸æ˜¯æˆ‘ä»¬è¦è§£å†³çš„æœ€åä¸€ä¸ªé—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œä¸€äº›ç°ä»£å­˜å‚¨è®¾å¤‡è¿˜å­˜åœ¨ä¸€ä¸ªç§°ä¸ºå†™å…¥ä¸¢å¤±çš„é—®é¢˜ï¼Œå½“è®¾å¤‡é€šçŸ¥ä¸Šå±‚å†™å…¥å·²å®Œæˆä½†å®é™…ä¸Šä»æœªè¢«æŒä¹…åŒ–æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼›å› æ­¤ï¼Œå‰©ä¸‹çš„æ˜¯å—çš„æ—§å†…å®¹è€Œä¸æ˜¯æ›´æ–°çš„æ–°å†…å®¹ã€‚ è¿™é‡Œæ˜æ˜¾çš„é—®é¢˜æ˜¯ï¼šä¸Šé¢çš„ä»»ä½•æ ¡éªŒå’Œç­–ç•¥ï¼ˆä¾‹å¦‚åŸºæœ¬æ ¡éªŒå’Œæˆ–ç‰©ç†æ ‡è¯†ï¼‰æ˜¯å¦æœ‰åŠ©äºæ£€æµ‹ä¸¢å¤±çš„å†™å…¥ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œç­”æ¡ˆæ˜¯å¦å®šçš„ï¼šæ—§å—å¯èƒ½æœ‰åŒ¹é…çš„æ ¡éªŒå’Œï¼Œå¹¶ä¸”ä¸Šé¢ä½¿ç”¨çš„ç‰©ç† IDï¼ˆç£ç›˜å·å’Œå—åç§»é‡ï¼‰ä¹Ÿå°†æ˜¯æ­£ç¡®çš„ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬çš„æœ€åä¸€ä¸ªå…³é”®é—®é¢˜æ˜¯ï¼š å­˜å‚¨ç³»ç»Ÿæˆ–ç£ç›˜æ§åˆ¶å™¨åº”å¦‚ä½•æ£€æµ‹ä¸¢å¤±çš„å†™å…¥ï¼Ÿæ ¡éªŒå’Œè¿˜éœ€è¦å“ªäº›é™„åŠ åŠŸèƒ½ï¼Ÿ æœ‰è®¸å¤šå¯èƒ½çš„è§£å†³æ–¹æ¡ˆå¯ä»¥å¸®åŠ©ã€‚ä¸€ç§ç»å…¸æ–¹æ³•æ˜¯æ‰§è¡Œå†™å…¥éªŒè¯æˆ–å†™å…¥åè¯»å–ï¼›é€šè¿‡åœ¨å†™å…¥åç«‹å³è¯»å›æ•°æ®ï¼Œç³»ç»Ÿå¯ä»¥ç¡®ä¿æ•°æ®ç¡®å®åˆ°è¾¾ç£ç›˜è¡¨é¢ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•éå¸¸æ…¢ï¼Œå®Œæˆå†™å…¥æ‰€éœ€çš„ I/O æ•°é‡ä¼šå¢åŠ ä¸€å€ã€‚ æœ‰äº›ç³»ç»Ÿåœ¨ç³»ç»Ÿçš„å…¶ä»–åœ°æ–¹æ·»åŠ æ ¡éªŒå’Œæ¥æ£€æµ‹ä¸¢å¤±çš„å†™å…¥ã€‚ä¾‹å¦‚ï¼ŒSun çš„ Zettabyte æ–‡ä»¶ç³»ç»Ÿ (ZFS) åœ¨æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿinodeä¸­åŒ…å«ä¸€ä¸ªæ ¡éªŒå’Œï¼Œå¹¶ä¸ºæ–‡ä»¶ä¸­åŒ…å«çš„æ¯ä¸ªå—æä¾›é—´æ¥å—ã€‚å› æ­¤ï¼Œå³ä½¿å¯¹å—æœ¬èº«çš„å†™å…¥ä¸¢å¤±ï¼Œinode å†…çš„æ ¡éªŒå’Œä¹Ÿä¸ä¼šä¸æ—§æ•°æ®åŒ¹é…ã€‚åªæœ‰å½“å¯¹inodeå’Œæ•°æ®çš„å†™å…¥åŒæ—¶ä¸¢å¤±æ—¶ï¼Œè¿™ç§æ–¹æ¡ˆæ‰ä¼šå¤±è´¥ï¼Œè¿™æ˜¯ä¸€ç§ä¸å¤ªå¯èƒ½ï¼ˆä½†ä¸å¹¸çš„æ˜¯ï¼Œæœ‰å¯èƒ½ï¼ï¼‰çš„æƒ…å†µã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:5:0","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 æ‰«æ è¯´äº†è¿™ä¹ˆå¤šï¼Œä½ å¯èƒ½ä¼šé—®ï¼šè¿™äº›æ ¡éªŒå’Œä»€ä¹ˆæ—¶å€™ä¼šè¢«æ£€æŸ¥ï¼Ÿå½“ç„¶ï¼Œåœ¨åº”ç”¨ç¨‹åºè®¿é—®æ•°æ®æ—¶ä¼šè¿›è¡Œä¸€å®šé‡çš„æ ¡éªŒï¼Œä½†å¤§å¤šæ•°æ•°æ®å¾ˆå°‘è¢«è®¿é—®ï¼Œå› æ­¤ä¼šä¿æŒæœªæ ¡éªŒçŠ¶æ€ã€‚å¯¹äºå¯é çš„å­˜å‚¨ç³»ç»Ÿæ¥è¯´ï¼Œæœªæ ¡éªŒçš„æ•°æ®æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºbitæŸåæœ€ç»ˆä¼šå½±å“ç‰¹å®šæ•°æ®çš„æ‰€æœ‰å‰¯æœ¬ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®¸å¤šç³»ç»Ÿéƒ½é‡‡ç”¨äº†å„ç§å½¢å¼çš„ç£ç›˜æ‰«æã€‚é€šè¿‡å®šæœŸè¯»å–ç³»ç»Ÿä¸­çš„æ¯ä¸ªå—ï¼Œå¹¶æ£€æŸ¥æ ¡éªŒå’Œæ˜¯å¦ä»ç„¶æœ‰æ•ˆï¼Œç£ç›˜ç³»ç»Ÿå¯ä»¥é™ä½æŸä¸ªæ•°æ®é¡¹çš„æ‰€æœ‰å‰¯æœ¬æŸåçš„å‡ ç‡ã€‚å…¸å‹çš„ç³»ç»Ÿæ¯æ™šæˆ–æ¯å‘¨å®‰æ’ä¸€æ¬¡æ‰«æã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:6:0","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 æ ¡éªŒå’Œçš„å¼€é”€ åœ¨ç»“æŸä¹‹å‰ï¼Œæˆ‘ä»¬ç°åœ¨è®¨è®ºä½¿ç”¨æ ¡éªŒå’Œè¿›è¡Œæ•°æ®ä¿æŠ¤çš„ä¸€äº›å¼€é”€ã€‚æ­£å¦‚è®¡ç®—æœºç³»ç»Ÿä¸­å¸¸è§çš„é‚£æ ·ï¼Œæœ‰ä¸¤ç§ä¸åŒç±»å‹çš„å¼€é”€ï¼šç©ºé—´å’Œæ—¶é—´ã€‚ ç©ºé—´å¼€é”€æœ‰ä¸¤ç§å½¢å¼ã€‚ ç¬¬ä¸€ä¸ªæ˜¯åœ¨ç£ç›˜ï¼ˆæˆ–å…¶ä»–å­˜å‚¨ä»‹è´¨ï¼‰æœ¬èº«ä¸Šï¼›æ¯ä¸ªå­˜å‚¨çš„æ ¡éªŒå’Œéƒ½ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œæ— æ³•å†ç”¨äºå­˜å‚¨ç”¨æˆ·æ•°æ®ã€‚å…¸å‹çš„æ¯”ç‡å¯èƒ½æ˜¯æ¯ 4 KB æ•°æ®å— 8 å­—èŠ‚æ ¡éªŒå’Œï¼Œç£ç›˜ç©ºé—´å¼€é”€ä¸º 0.19%ã€‚ ç¬¬äºŒç§ç±»å‹çš„ç©ºé—´å¼€é”€æ¥è‡ªç³»ç»Ÿçš„å†…å­˜ã€‚è®¿é—®æ•°æ®æ—¶ï¼Œå†…å­˜ä¸­å¿…é¡»æœ‰ç©ºé—´ç”¨äºå­˜æ”¾æ ¡éªŒå’Œä»¥åŠæ•°æ®æœ¬èº«ã€‚ä½†æ˜¯ï¼Œå¦‚æœç³»ç»Ÿåªæ˜¯æ£€æŸ¥æ ¡éªŒå’Œï¼Œç„¶ååœ¨å®Œæˆåå°†å…¶ä¸¢å¼ƒï¼Œåˆ™è¿™ç§å¼€é”€æ˜¯çŸ­æš‚çš„ï¼Œä¸å¿…æ‹…å¿ƒã€‚åªæœ‰å½“æ ¡éªŒå’Œä¿å­˜åœ¨å†…å­˜ä¸­ï¼ˆä¸ºäº†é˜²æ­¢å†…å­˜æŸåçš„é¢å¤–ä¿æŠ¤çº§åˆ«ï¼‰ï¼Œè¿™ä¸ªå°å¼€é”€æ‰ä¼šè¢«è§‚å¯Ÿåˆ°ã€‚ è™½ç„¶ç©ºé—´å¼€é”€å¾ˆå°ï¼Œä½†æ ¡éªŒå’Œå¼•èµ·çš„æ—¶é—´å¼€é”€å¯èƒ½éå¸¸æ˜æ˜¾ã€‚è‡³å°‘ï¼ŒCPU å¿…é¡»è®¡ç®—æ¯ä¸ªå—çš„æ ¡éªŒå’Œï¼Œæ— è®ºæ˜¯åœ¨å­˜å‚¨æ•°æ®æ—¶ï¼ˆä»¥ç¡®å®šå­˜å‚¨çš„æ ¡éªŒå’Œçš„å€¼ï¼‰è¿˜æ˜¯åœ¨è®¿é—®æ•°æ®æ—¶ï¼ˆå†æ¬¡è®¡ç®—æ ¡éªŒå’Œå¹¶å°†å…¶ä¸å­˜å‚¨çš„æ ¡éªŒå’Œè¿›è¡Œæ¯”è¾ƒï¼‰ã€‚è®¸å¤šä½¿ç”¨æ ¡éªŒå’Œï¼ˆåŒ…æ‹¬ç½‘ç»œæ ˆï¼‰çš„ç³»ç»Ÿé‡‡ç”¨çš„ä¸€ç§å‡å°‘ CPU å¼€é”€çš„æ–¹æ³•æ˜¯å°†æ•°æ®å¤åˆ¶å’Œæ ¡éªŒå’Œåˆå¹¶ä¸ºä¸€é¡¹ç®€åŒ–çš„æ´»åŠ¨ï¼›å› ä¸ºæ— è®ºå¦‚ä½•éƒ½éœ€è¦å¤åˆ¶ï¼ˆä¾‹å¦‚ï¼Œå°†æ•°æ®ä»å†…æ ¸é¡µç¼“å­˜å¤åˆ¶åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼‰ï¼Œå› æ­¤ç»„åˆå¤åˆ¶/æ ¡éªŒå’Œå¯èƒ½éå¸¸æœ‰æ•ˆã€‚ é™¤äº† CPU å¼€é”€ä¹‹å¤–ï¼ŒæŸäº›æ ¡éªŒå’Œæ–¹æ¡ˆè¿˜ä¼šäº§ç”Ÿé¢å¤–çš„ I/O å¼€é”€ï¼Œç‰¹åˆ«æ˜¯å½“æ ¡éªŒå’Œä¸æ•°æ®åˆ†å¼€å­˜å‚¨æ—¶ï¼ˆå› æ­¤éœ€è¦é¢å¤–çš„ I/O æ¥è®¿é—®å®ƒä»¬ï¼‰ï¼Œä»¥åŠåå°æ‰«ææ‰€éœ€çš„ä»»ä½•é¢å¤– I/Oã€‚å‰è€…å¯ä»¥é€šè¿‡è®¾è®¡æ¥å‡å°‘ï¼›åè€…å¯ä»¥è¿›è¡Œè°ƒæ•´ï¼Œä»è€Œé™åˆ¶å…¶å½±å“ï¼Œæˆ–è®¸å¯ä»¥é€šè¿‡æ§åˆ¶æ­¤ç±»æ‰«ææ´»åŠ¨çš„å‘ç”Ÿæ—¶é—´æ¥å®ç°ï¼ˆå¦‚åŠå¤œï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/:7:0","tags":["OS"],"title":"æ•°æ®å®Œæ•´æ€§å’Œä¿æŠ¤","uri":"/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¼•è¨€ åœ¨ç¡¬ç›˜é©±åŠ¨å™¨å æ®ä¸»å¯¼åœ°ä½æ•°åå¹´åï¼Œä¸€ç§æ–°å‹çš„æŒä¹…å­˜å‚¨è®¾å¤‡æœ€è¿‘åœ¨ä¸–ç•Œä¸Šå æ®äº†é‡è¦åœ°ä½ã€‚è¿™ç§è®¾å¤‡ä¸€èˆ¬è¢«ç§°ä¸ºå›ºæ€å­˜å‚¨è®¾å¤‡ï¼Œå®ƒä¸åƒç¡¬ç›˜é©±åŠ¨å™¨é‚£æ ·æœ‰æœºæ¢°æˆ–ç§»åŠ¨éƒ¨ä»¶ï¼Œè€Œæ˜¯ç”±æ™¶ä½“ç®¡æ„æˆï¼Œå°±åƒå†…å­˜å’Œå¤„ç†å™¨ä¸€æ ·ã€‚ç„¶è€Œï¼Œä¸å…¸å‹çš„éšæœºå­˜å–å­˜å‚¨å™¨ï¼ˆå¦‚ DRAMï¼‰ä¸åŒï¼Œè¿™ç§å›ºæ€å­˜å‚¨è®¾å¤‡ï¼ˆåˆç§° SSDï¼‰åœ¨æ–­ç”µçš„æƒ…å†µä¸‹ä»èƒ½ä¿ç•™ä¿¡æ¯ï¼Œå› æ­¤æ˜¯æŒä¹…å­˜å‚¨æ•°æ®çš„ç†æƒ³é€‰æ‹©ã€‚ æˆ‘ä»¬å°†é‡ç‚¹è®¨è®ºçš„æŠ€æœ¯æ˜¯é—ªå­˜ï¼ˆæ›´å…·ä½“åœ°è¯´ï¼Œæ˜¯åŸºäº NAND çš„é—ªå­˜ï¼Œå®ƒå…·æœ‰æ›´å¥½çš„æˆæœ¬æ•ˆç›Šï¼Œå³æ¯å­˜å‚¨å®¹é‡å•ä½çš„æˆæœ¬è¾ƒä½ã€‚è¿™ä½¿å¾— NAND å‹é—ªå­˜åœ¨å¤§å®¹é‡å­˜å‚¨è®¾å¤‡ä¸­å¾—åˆ°å¹¿æ³›åº”ç”¨ï¼Œå¦‚å›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰å’Œé—ªå­˜å¡ç­‰ï¼‰ï¼Œå®ƒæ˜¯ç”± Fujio Masuoka åœ¨ 20 ä¸–çºª 80 å¹´ä»£å‘æ˜çš„ï¼Œã€‚æˆ‘ä»¬å°†çœ‹åˆ°ï¼Œé—ªå­˜å…·æœ‰ä¸€äº›ç‹¬ç‰¹çš„ç‰¹æ€§ã€‚ ä¾‹å¦‚ï¼Œè¦å†™å…¥é—ªå­˜çš„æŸä¸€å¤§å—ï¼ˆå³ä¸€ä¸ªé—ªå­˜é¡µï¼‰ï¼Œé¦–å…ˆå¿…é¡»æ“¦é™¤æ›´å¤§çš„ä¸€å—ï¼ˆå³ä¸€ä¸ªé—ªå­˜å—ï¼‰ï¼Œè€Œæ“¦é™¤çš„ä»£ä»·å¯èƒ½ç›¸å½“æ˜‚è´µã€‚ æ­¤å¤–ï¼Œè¿‡äºé¢‘ç¹åœ°å†™å…¥é¡µé¢ä¼šå¯¼è‡´é¡µé¢ç£¨æŸã€‚ è¿™ä¸¤ä¸ªç‰¹æ€§ä½¿å¾—æ„å»ºåŸºäºé—ªå­˜çš„å›ºæ€ç¡¬ç›˜æˆä¸ºä¸€é¡¹æœ‰è¶£çš„æŒ‘æˆ˜ï¼š å¦‚ä½•æ„å»ºåŸºäºé—ªå­˜çš„å›ºæ€ç¡¬ç›˜ å¦‚ä½•æ„å»ºåŸºäºé—ªå­˜çš„å›ºæ€ç¡¬ç›˜ï¼Ÿå¦‚ä½•å¤„ç†æ“¦é™¤çš„æ˜‚è´µç‰¹æ€§ï¼Ÿè€ƒè™‘åˆ°åå¤æ“¦å†™ä¼šæŸè€—è®¾å¤‡ï¼Œæˆ‘ä»¬å¦‚ä½•æ‰èƒ½åˆ¶é€ å‡ºä½¿ç”¨å¯¿å‘½é•¿çš„è®¾å¤‡ï¼ŸæŠ€æœ¯è¿›æ­¥çš„è„šæ­¥ä¼šåœæ­¢å—ï¼Ÿæˆ–è€…ä¸å†ä»¤äººæƒŠå¹ï¼Ÿ é—ªå­˜èŠ¯ç‰‡è®¾è®¡ç”¨äºåœ¨å•ä¸ªæ™¶ä½“ç®¡ä¸­å­˜å‚¨ä¸€ä¸ªæˆ–å¤šä¸ªbitï¼›æ™¶ä½“ç®¡å†…æ•è·çš„ç”µè·æ°´å¹³è¢«æ˜ å°„ä¸ºäºŒè¿›åˆ¶å€¼ã€‚åœ¨å•å±‚å•å…ƒ (SLC) é—ªå­˜ä¸­ï¼Œæ™¶ä½“ç®¡å†…ä»…å­˜å‚¨å•ä¸ªä½ï¼ˆå³ 1 æˆ– 0ï¼‰ï¼›å¯¹äºå¤šå±‚å•å…ƒ (MLC) é—ªå­˜ï¼Œä¸¤ä¸ªä½è¢«ç¼–ç ä¸ºä¸åŒçš„ç”µè·çº§åˆ«ï¼Œä¾‹å¦‚ï¼Œ00ã€01ã€10 å’Œ 11 åˆ†åˆ«ç”±ä½ã€ç¨ä½ã€ç¨é«˜å’Œé«˜ç”µå¹³è¡¨ç¤ºã€‚ç”šè‡³è¿˜æœ‰ä¸‰å±‚å•å…ƒ (TLC) é—ªå­˜ä»¥åŠå››å±‚å•å…ƒ(QLC)é—ªå­˜ï¼Œæ¯ä¸ªå•å…ƒç¼–ç  3 ä½ã€4ä½ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ€»ä½“è€Œè¨€ï¼ŒSLCèŠ¯ç‰‡æ€§èƒ½æ›´é«˜ï¼Œä½†ä»·æ ¼ä¹Ÿæ›´é«˜ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:1:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ä»bitåˆ°ç»„/å¹³é¢ æ­£å¦‚å¤å¸Œè…Šäººæ‰€è¯´ï¼Œå­˜å‚¨ä¸€ä¸ªbitï¼ˆæˆ–å‡ ä¸ªbitï¼‰å¹¶ä¸èƒ½æ„æˆä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿã€‚å› æ­¤ï¼Œé—ªå­˜èŠ¯ç‰‡è¢«ç»„ç»‡æˆç”±å¤§é‡å•å…ƒç»„æˆçš„ç»„æˆ–å¹³é¢ã€‚ ä¸€ä¸ªç»„ä»¥ä¸¤ç§ä¸åŒå¤§å°çš„å•ä½è¿›è¡Œè®¿é—®ï¼š å—ï¼ˆæœ‰æ—¶ç§°ä¸ºæ“¦é™¤å—ï¼‰ï¼Œé€šå¸¸å¤§å°ä¸º 128 KB æˆ– 256 KBï¼› é¡µï¼Œå¤§å°ä¸ºå‡  KBï¼ˆå¦‚ 4KBï¼‰ã€‚ æ¯ä¸ªå­˜å‚¨ç»„å†…æœ‰å¤§é‡çš„å—ï¼Œæ¯ä¸ªå—å†…åˆæœ‰å¤§é‡çš„é¡µã€‚åœ¨è€ƒè™‘é—ªå­˜æ—¶ï¼Œä½ å¿…é¡»è®°ä½è¿™ä¸ªæ–°æœ¯è¯­ï¼Œå®ƒä¸åŒäºæˆ‘ä»¬åœ¨ç£ç›˜å’Œ RAID ä¸­æåˆ°çš„å—ï¼Œä¹Ÿä¸åŒäºæˆ‘ä»¬åœ¨è™šæ‹Ÿå†…å­˜ä¸­æåˆ°çš„é¡µã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªé—ªå­˜å¹³é¢çš„å—å’Œé¡µçš„ç¤ºä¾‹ï¼›åœ¨è¿™ä¸ªç®€å•çš„ç¤ºä¾‹ä¸­ï¼Œæœ‰ä¸‰ä¸ªå—ï¼Œæ¯ä¸ªå—åŒ…å«å››ä¸ªé¡µã€‚æˆ‘ä»¬å°†åœ¨ä¸‹æ–‡ä¸­äº†è§£åŒºåˆ†å—å’Œé¡µçš„åŸå› ï¼›äº‹å®è¯æ˜ï¼Œè¿™ç§åŒºåˆ†å¯¹äºé—ªå­˜æ“ä½œï¼ˆå¦‚è¯»å†™ï¼‰è‡³å…³é‡è¦ï¼Œå¯¹äºè®¾å¤‡çš„æ•´ä½“æ€§èƒ½æ›´æ˜¯å¦‚æ­¤ã€‚ä½ å°†äº†è§£åˆ°çš„æœ€é‡è¦ï¼ˆä¹Ÿæ˜¯æœ€å¥‡æ€ªï¼‰çš„äº‹æƒ…æ˜¯ï¼Œè¦å†™å…¥å—ä¸­çš„é¡µé¢ï¼Œé¦–å…ˆå¿…é¡»æ“¦é™¤æ•´ä¸ªå—ï¼›è¿™ä¸€æ£˜æ‰‹çš„ç»†èŠ‚ä½¿å¾—æ„å»ºåŸºäºé—ªå­˜çš„å›ºæ€ç¡¬ç›˜æˆä¸ºä¸€é¡¹æœ‰è¶£ä¸”å€¼å¾—æŒ‘æˆ˜çš„ä»»åŠ¡ï¼Œä¹Ÿæ˜¯æœ¬ç« ååŠéƒ¨åˆ†çš„ä¸»é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:2:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 åŸºæœ¬é—ªå­˜æ“ä½œ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:3:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 è¯»å–ã€æ“¦é™¤å’Œç¼–ç¨‹ é‰´äºè¿™ç§é—ªå­˜ç»„ç»‡ç»“æ„ï¼Œé—ªå­˜èŠ¯ç‰‡å¯æ”¯æŒä¸‰ç§ä½çº§æ“ä½œã€‚è¯»å–å‘½ä»¤ç”¨äºä»é—ªå­˜ä¸­è¯»å–ä¸€ä¸ªé¡µé¢ï¼›æ“¦é™¤å’Œç¼–ç¨‹åŒæ—¶ç”¨äºå†™å…¥ã€‚è¯¦æƒ…å¦‚ä¸‹ï¼š è¯»å–ï¼ˆä¸€é¡µï¼‰ï¼šé—ªå­˜èŠ¯ç‰‡çš„å®¢æˆ·ç«¯åªéœ€å‘è®¾å¤‡æŒ‡å®šè¯»å–å‘½ä»¤å’Œç›¸åº”çš„é¡µç ï¼Œå³å¯è¯»å–ä»»ä½•é¡µé¢ï¼ˆå¦‚ 2KB æˆ– 4KBï¼‰ã€‚è¿™ç§æ“ä½œé€šå¸¸ç›¸å½“å¿«ï¼Œ10 å¾®ç§’å·¦å³ï¼Œä¸è®¾å¤‡ä¸Šçš„ä½ç½®æ— å…³ï¼Œï¼ˆæˆ–å¤šæˆ–å°‘ï¼‰ä¹Ÿä¸ä¸Šä¸€æ¬¡è¯·æ±‚çš„ä½ç½®æ— å…³ï¼ˆä¸ç£ç›˜å®Œå…¨ä¸åŒï¼‰ï¼Œèƒ½å¤Ÿå‡åŒ€å¿«é€Ÿåœ°è®¿é—®ä»»ä½•ä½ç½®æ„å‘³ç€è¯¥è®¾å¤‡æ˜¯éšæœºå­˜å–è®¾å¤‡ã€‚ æ“¦é™¤ï¼ˆä¸€ä¸ªå—ï¼‰ï¼šåœ¨å†™å…¥é—ªå­˜ä¸­çš„é¡µé¢ä¹‹å‰ï¼Œè®¾å¤‡çš„ç‰¹æ€§è¦æ±‚é¦–å…ˆæ“¦é™¤é¡µé¢æ‰€åœ¨çš„æ•´ä¸ªå—ã€‚é‡è¦çš„æ˜¯ï¼Œæ“¦é™¤ä¼šç ´åå—ä¸­çš„å†…å®¹ï¼ˆé€šè¿‡å°†æ¯ä¸ªä½è®¾ç½®ä¸º 1ï¼‰ï¼›å› æ­¤ï¼Œåœ¨æ‰§è¡Œæ“¦é™¤ä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿å—ä¸­ä»»ä½•æ‚¨éœ€è¦çš„æ•°æ®éƒ½å·²å¤åˆ¶åˆ°å…¶ä»–åœ°æ–¹ï¼ˆå†…å­˜æˆ–å…¶ä»–é—ªå­˜å—ï¼‰ã€‚æ“¦é™¤å‘½ä»¤è€—æ—¶è¾ƒé•¿ï¼Œéœ€è¦å‡ æ¯«ç§’æ‰èƒ½å®Œæˆã€‚å®Œæˆåï¼Œæ•´ä¸ªå—å°†è¢«é‡ç½®ï¼Œæ¯ä¸€é¡µéƒ½å¯ä»¥è¿›è¡Œç¼–ç¨‹ã€‚ ç¼–ç¨‹ï¼ˆä¸€é¡µï¼‰ï¼šæ“¦é™¤å—åï¼Œå¯ä½¿ç”¨ç¼–ç¨‹å‘½ä»¤å°†é¡µé¢ä¸­çš„éƒ¨åˆ† 1 å˜ä¸º 0ï¼Œå¹¶å°†é¡µé¢ä¸­çš„æ‰€éœ€å†…å®¹å†™å…¥é—ªå­˜ã€‚å¯¹é¡µé¢è¿›è¡Œç¼–ç¨‹çš„æˆæœ¬æ¯”æ“¦é™¤å—ä½ï¼Œä½†æ¯”è¯»å–é¡µé¢çš„æˆæœ¬é«˜ï¼Œåœ¨ç°ä»£é—ªå­˜èŠ¯ç‰‡ä¸Šé€šå¸¸éœ€è¦ 100 å¾®ç§’å·¦å³ã€‚ å¯¹é—ªå­˜èŠ¯ç‰‡çš„ä¸€ç§ç†è§£æ˜¯ï¼Œæ¯ä¸ªé¡µé¢éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³çš„çŠ¶æ€ã€‚é¡µé¢å¼€å§‹æ—¶å¤„äºINVALIDçŠ¶æ€ã€‚é€šè¿‡æ“¦é™¤é¡µé¢æ‰€åœ¨çš„å—ï¼Œå¯ä»¥å°†é¡µé¢ï¼ˆä»¥åŠè¯¥å—ä¸­çš„æ‰€æœ‰é¡µé¢ï¼‰çš„çŠ¶æ€è®¾ç½®ä¸ºERASEDçŠ¶æ€ï¼Œä»è€Œé‡ç½®å—ä¸­æ¯ä¸ªé¡µé¢çš„å†…å®¹ï¼Œè€Œä¸”ï¼ˆé‡è¦çš„æ˜¯ï¼‰è¿˜å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œç¼–ç¨‹ã€‚å½“ä½ å¯¹ä¸€ä¸ªé¡µé¢è¿›è¡Œç¼–ç¨‹æ—¶ï¼Œå®ƒçš„çŠ¶æ€å°†å˜ä¸º VALIDï¼Œè¿™æ„å‘³ç€å®ƒçš„å†…å®¹å·²è¢«è®¾ç½®å¹¶å¯è¢«è¯»å–ã€‚è¯»å–ä¸ä¼šå½±å“è¿™äº›çŠ¶æ€ï¼ˆå°½ç®¡ä½ åªèƒ½è¯»å–å·²ç¼–ç¨‹çš„é¡µé¢ï¼‰ã€‚ä¸€æ—¦é¡µé¢è¢«ç¼–ç¨‹ï¼Œæ›´æ”¹å…¶å†…å®¹çš„å”¯ä¸€æ–¹æ³•å°±æ˜¯æ“¦é™¤é¡µé¢æ‰€åœ¨çš„æ•´ä¸ªå—ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª 4é¡µå—ä¸­å„ç§æ“¦é™¤å’Œç¼–ç¨‹æ“ä½œåçŠ¶æ€è½¬æ¢çš„ç¤ºä¾‹ï¼š ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:3:1","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 è¯¦ç»†ç¤ºä¾‹ ç”±äºå†™å…¥è¿‡ç¨‹ï¼ˆå³æ“¦é™¤å’Œç¼–ç¨‹ï¼‰éå¸¸ä¸å¯»å¸¸ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªè¯¦ç»†çš„ç¤ºä¾‹æ¥ç¡®ä¿å…¶åˆç†æ€§ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡è®¾æˆ‘ä»¬åœ¨ä¸€ä¸ª 4 é¡µçš„å—ä¸­æœ‰ä»¥ä¸‹ 4 ä¸ª 8 ä½é¡µé¢ï¼ˆå°ºå¯¸éƒ½å¾ˆå°ï¼Œä½†åœ¨æœ¬ä¾‹ä¸­å¾ˆæœ‰ç”¨ï¼‰ï¼›æ¯ä¸ªé¡µé¢éƒ½æ˜¯VALIDï¼Œå› ä¸ºæ¯ä¸ªé¡µé¢ä¹‹å‰éƒ½è¢«ç¼–ç¨‹è¿‡ã€‚ ç°åœ¨å‡è®¾æˆ‘ä»¬å¸Œæœ›å†™å…¥ç¬¬ 0 é¡µï¼Œå¹¶ç”¨æ–°å†…å®¹å¡«å……å®ƒã€‚è¦å†™å…¥ä»»ä½•é¡µï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆæ“¦é™¤æ•´ä¸ªå—ã€‚å‡è®¾æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œä»è€Œä½¿å—å¤„äºè¿™ç§çŠ¶æ€ï¼š ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å¯¹é¡µé¢0è¿›è¡Œç¼–ç¨‹ï¼Œä¾‹å¦‚ï¼Œç”¨å†…å®¹ 00000011 æ¥è¦†ç›–æ—§çš„ç¬¬ 0 é¡µï¼ˆå†…å®¹ 00011000ï¼‰ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„ç¨‹åºå—çœ‹èµ·æ¥å°±åƒè¿™æ ·äº†ï¼š ç°åœ¨åæ¶ˆæ¯æ¥äº†ï¼šç¬¬ 1ã€2 å’Œ 3 é¡µçš„å†…å®¹å·²ç»å…¨éƒ¨ä¸¢å¤±ï¼å› æ­¤ï¼Œåœ¨è¦†ç›–å—å†…çš„ä»»ä½•é¡µé¢ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆå°†æˆ‘ä»¬å…³å¿ƒçš„ä»»ä½•æ•°æ®ç§»åŠ¨åˆ°å…¶ä»–ä½ç½®ï¼ˆå¦‚å†…å­˜æˆ–é—ªå­˜ä¸Šçš„å…¶ä»–ä½ç½®ï¼‰ã€‚æ“¦é™¤çš„æ€§è´¨å°†å¯¹æˆ‘ä»¬å¦‚ä½•è®¾è®¡åŸºäºé—ªå­˜çš„å›ºæ€ç¡¬ç›˜äº§ç”Ÿé‡å¤§å½±å“ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šäº†è§£åˆ°è¿™ä¸€ç‚¹ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:3:2","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 æ€»ç»“ è¯»å–é¡µé¢å¾ˆç®€å•ï¼šåªéœ€è¯»å–é¡µé¢å³å¯ã€‚é—ªå­˜èŠ¯ç‰‡åœ¨è¿™æ–¹é¢åšå¾—å¾ˆå¥½ï¼Œè€Œä¸”é€Ÿåº¦å¾ˆå¿«ï¼›å°±æ€§èƒ½è€Œè¨€ï¼Œå®ƒä»¬æœ‰å¯èƒ½å¤§å¤§è¶…è¿‡ç°ä»£ç£ç›˜é©±åŠ¨å™¨çš„éšæœºè¯»å–æ€§èƒ½ï¼Œè€Œç°ä»£ç£ç›˜é©±åŠ¨å™¨ç”±äºæœºæ¢°å¯»é“å’Œæ—‹è½¬æˆæœ¬è€Œé€Ÿåº¦è¾ƒæ…¢ã€‚ å†™å…¥é¡µé¢åˆ™æ¯”è¾ƒéº»çƒ¦ï¼›é¦–å…ˆå¿…é¡»æ“¦é™¤æ•´ä¸ªå—ï¼ˆæ³¨æ„å…ˆå°†æˆ‘ä»¬å…³å¿ƒçš„ä»»ä½•æ•°æ®è½¬ç§»åˆ°å¦ä¸€ä¸ªä½ç½®ï¼‰ï¼Œç„¶åå¯¹æ‰€éœ€é¡µé¢è¿›è¡Œç¼–ç¨‹ã€‚è¿™ä¸ä»…æˆæœ¬é«˜æ˜‚ï¼Œè€Œä¸”é¢‘ç¹é‡å¤è¿™ç§ç¼–ç¨‹/æ“¦é™¤å¾ªç¯ä¼šå¯¼è‡´é—ªå­˜èŠ¯ç‰‡æœ€å¤§çš„å¯é æ€§é—®é¢˜ï¼šç£¨æŸã€‚åœ¨è®¾è®¡ä½¿ç”¨é—ªå­˜çš„å­˜å‚¨ç³»ç»Ÿæ—¶ï¼Œå†™å…¥çš„æ€§èƒ½å’Œå¯é æ€§æ˜¯é‡ç‚¹ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šäº†è§£åˆ°ç°ä»£å›ºæ€ç¡¬ç›˜æ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ï¼Œå°½ç®¡å­˜åœ¨è¿™äº›é™åˆ¶ï¼Œä½†ä»èƒ½æä¾›å‡ºè‰²çš„æ€§èƒ½å’Œå¯é æ€§ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:3:3","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 é—ªå­˜æ€§èƒ½å’Œå¯é æ€§ å› ä¸ºæˆ‘ä»¬æœ‰å…´è¶£ç”¨åŸå§‹é—ªå­˜èŠ¯ç‰‡æ„å»ºå­˜å‚¨è®¾å¤‡ï¼Œæ‰€ä»¥æœ‰å¿…è¦äº†è§£å®ƒä»¬çš„åŸºæœ¬æ€§èƒ½ç‰¹å¾ã€‚ä¸‹å›¾ç²—ç•¥æ€»ç»“äº† SLCã€MLC å’Œ TLC é—ªå­˜ï¼ˆæ¯ä¸ªå•å…ƒåˆ†åˆ«å­˜å‚¨ 1ã€2 å’Œ 3 ä½ä¿¡æ¯ï¼‰çš„è¯»å–ã€ç¼–ç¨‹å’Œæ“¦é™¤çš„åŸºæœ¬æ“ä½œå»¶è¿Ÿã€‚ ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¯»å–å»¶è¿Ÿéå¸¸å¥½ï¼Œåªéœ€ 10 å¾®ç§’å³å¯å®Œæˆã€‚ç¼–ç¨‹å»¶è¿Ÿæ›´é«˜ä¸”å˜åŒ–æ›´å¤§ï¼ŒSLC ä½è‡³ 200 å¾®ç§’ï¼Œä½†å½“æ¯ä¸ªå•å…ƒä¸­è£…å…¥æ›´å¤šä½æ—¶ï¼Œç¨‹åºå»¶è¿Ÿä¼šæ›´é«˜ï¼›ä¸ºäº†è·å¾—è‰¯å¥½çš„å†™å…¥æ€§èƒ½ï¼Œæ‚¨å¿…é¡»å¹¶è¡Œä½¿ç”¨å¤šä¸ªé—ªå­˜èŠ¯ç‰‡ã€‚æœ€åï¼Œæ“¦é™¤éå¸¸æ˜‚è´µï¼Œé€šå¸¸éœ€è¦å‡ æ¯«ç§’ã€‚å¤„ç†è¿™ç§æˆæœ¬æ˜¯ç°ä»£é—ªå­˜è®¾è®¡çš„æ ¸å¿ƒã€‚ ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹é—ªå­˜èŠ¯ç‰‡çš„å¯é æ€§ã€‚ä¸æœºæ¢°ç£ç›˜ä¸åŒï¼Œæœºæ¢°ç£ç›˜å¯èƒ½ä¼šå› å¤šç§åŸå› è€Œå‘ç”Ÿæ•…éšœï¼ˆåŒ…æ‹¬å¯æ€•çš„ç‰©ç†ç£å¤´ç¢°æ’ï¼Œå³é©±åŠ¨å™¨ç£å¤´å®é™…ä¸Šä¸è®°å½•è¡¨é¢æ¥è§¦ï¼‰ï¼Œé—ªå­˜èŠ¯ç‰‡æ˜¯çº¯ç¡…ï¼Œä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼Œéœ€è¦æ‹…å¿ƒçš„å¯é æ€§é—®é¢˜è¾ƒå°‘ï¼Œä¸»è¦æ‹…å¿ƒçš„æ˜¯ç£¨æŸï¼šå½“é—ªå­˜å—è¢«æ“¦é™¤å’Œç¼–ç¨‹æ—¶ï¼Œå®ƒä¼šæ…¢æ…¢äº§ç”Ÿä¸€ç‚¹é¢å¤–çš„ç”µè·ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œéšç€é¢å¤–ç”µè·çš„ç§¯ç´¯ï¼ŒåŒºåˆ† 0 å’Œ 1 å˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚å½“å˜å¾—ä¸å¯èƒ½æ—¶ï¼Œè¯¥å—å°±å˜å¾—æ— æ³•ä½¿ç”¨ã€‚ ç›®å‰ï¼Œå—çš„å…¸å‹å¯¿å‘½å°šä¸æ¸…æ¥šã€‚åˆ¶é€ å•†å°†åŸºäº MLC çš„æ¨¡å—è¯„ä»·ä¸ºå…·æœ‰ 10,000 æ¬¡ P/Eï¼ˆç¼–ç¨‹/æ“¦é™¤ï¼‰å¾ªç¯å¯¿å‘½ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªå—åœ¨å¤±è´¥ä¹‹å‰å¯ä»¥è¢«æ“¦é™¤å’Œç¼–ç¨‹ 10,000 æ¬¡ã€‚åŸºäº SLC çš„èŠ¯ç‰‡ç”±äºæ¯ä¸ªæ™¶ä½“ç®¡ä»…å­˜å‚¨ä¸€ä½ï¼Œå› æ­¤å…·æœ‰è¾ƒé•¿çš„ä½¿ç”¨å¯¿å‘½ï¼Œé€šå¸¸ä¸º 100,000 ä¸ª P/E å‘¨æœŸã€‚ç„¶è€Œï¼Œæœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ï¼Œå¯¿å‘½æ¯”é¢„æœŸçš„è¦é•¿å¾—å¤šã€‚ é—ªå­˜èŠ¯ç‰‡å†…çš„å¦ä¸€ä¸ªå¯é æ€§é—®é¢˜è¢«ç§°ä¸ºå¹²æ‰°ã€‚å½“è®¿é—®é—ªå­˜ä¸­çš„ç‰¹å®šé¡µé¢æ—¶ï¼Œç›¸é‚»é¡µé¢ä¸­çš„æŸäº›ä½å¯èƒ½ä¼šè¢«ç¿»è½¬ï¼›è¿™ç§ä½ç¿»è½¬è¢«ç§°ä¸ºè¯»å–å¹²æ‰°æˆ–ç¼–ç¨‹å¹²æ‰°ï¼Œå…·ä½“å–å†³äºé¡µé¢æ˜¯è¢«è¯»å–è¿˜æ˜¯è¢«ç¼–ç¨‹ã€‚ å‘åå…¼å®¹æ€§çš„é‡è¦æ€§ å‘åå…¼å®¹æ€§å§‹ç»ˆæ˜¯åˆ†å±‚ç³»ç»Ÿä¸­éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚é€šè¿‡å®šä¹‰ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„ç¨³å®šæ¥å£ï¼Œå¯ä»¥åœ¨æ¥å£çš„æ¯ä¸€ä¾§å®ç°åˆ›æ–°ï¼ŒåŒæ—¶ç¡®ä¿æŒç»­çš„äº’æ“ä½œæ€§ã€‚è¿™ç§æ–¹æ³•åœ¨è®¸å¤šé¢†åŸŸéƒ½éå¸¸æˆåŠŸï¼šæ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºæä¾›ç›¸å¯¹ç¨³å®šçš„ APIï¼Œç£ç›˜ä¸ºæ–‡ä»¶ç³»ç»Ÿæä¾›ç›¸åŒçš„åŸºäºå—çš„æ¥å£ï¼ŒIP ç½‘ç»œå †æ ˆä¸­çš„æ¯ä¸€å±‚éƒ½ä¸ºä¸Šä¸€å±‚æä¾›å›ºå®šä¸å˜çš„æ¥å£ã€‚ æ¯«ä¸å¥‡æ€ªï¼Œè¿™ç§åˆšæ€§å¯èƒ½æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå› ä¸ºåœ¨ä¸€ä»£ä¸­å®šä¹‰çš„æ¥å£å¯èƒ½ä¸é€‚ç”¨äºä¸‹ä¸€ä»£ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè€ƒè™‘å®Œå…¨é‡æ–°è®¾è®¡æ•´ä¸ªç³»ç»Ÿå¯èƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚ Sun ZFS æ–‡ä»¶ç³»ç»Ÿ å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼›é€šè¿‡é‡æ–°è€ƒè™‘æ–‡ä»¶ç³»ç»Ÿå’Œ RAID çš„äº¤äº’ï¼ŒZFS çš„åˆ›å»ºè€…è®¾æƒ³ï¼ˆç„¶åå®ç°ï¼‰äº†ä¸€ä¸ªæ›´æœ‰æ•ˆçš„é›†æˆæ•´ä½“ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:4:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 ä»åŸå§‹é—ªå­˜åˆ°åŸºäºé—ªå­˜çš„ SSD é‰´äºæˆ‘ä»¬å¯¹é—ªå­˜èŠ¯ç‰‡çš„åŸºæœ¬äº†è§£ï¼Œæˆ‘ä»¬ç°åœ¨é¢ä¸´ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼šå¦‚ä½•å°†ä¸€ç»„åŸºæœ¬çš„é—ªå­˜èŠ¯ç‰‡å˜æˆçœ‹èµ·æ¥åƒå…¸å‹å­˜å‚¨è®¾å¤‡çš„ä¸œè¥¿ã€‚æ ‡å‡†å­˜å‚¨æ¥å£æ˜¯ä¸€ç§ç®€å•çš„åŸºäºå—çš„æ¥å£ï¼Œåœ¨ç»™å®šå—åœ°å€çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–æˆ–å†™å…¥å¤§å°ä¸º 512 å­—èŠ‚ï¼ˆæˆ–æ›´å¤§ï¼‰çš„å—ï¼ˆæ‰‡åŒºï¼‰ã€‚åŸºäºé—ªå­˜çš„ SSD çš„ä»»åŠ¡æ˜¯åœ¨å…¶å†…éƒ¨çš„åŸå§‹é—ªå­˜èŠ¯ç‰‡ä¹‹ä¸Šæä¾›æ ‡å‡†å—æ¥å£ã€‚ åœ¨å†…éƒ¨ï¼ŒSSD ç”±ä¸€å®šæ•°é‡çš„é—ªå­˜èŠ¯ç‰‡ï¼ˆç”¨äºæŒä¹…å­˜å‚¨ï¼‰ç»„æˆã€‚ SSD è¿˜åŒ…å«ä¸€å®šé‡çš„æ˜“å¤±æ€§ï¼ˆå³éæŒä¹…æ€§ï¼‰å†…å­˜ï¼ˆä¾‹å¦‚ SRAMï¼‰ï¼Œè¿™æ ·çš„å†…å­˜å¯¹äºæ•°æ®çš„ç¼“å­˜å’Œç¼“å†²ä»¥åŠæ˜ å°„è¡¨å¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢äº†è§£ã€‚æœ€åï¼ŒSSD åŒ…å«åè°ƒè®¾å¤‡æ“ä½œçš„æ§åˆ¶é€»è¾‘ã€‚ç®€åŒ–æ¡†å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è¯¥æ§åˆ¶é€»è¾‘çš„åŸºæœ¬åŠŸèƒ½ä¹‹ä¸€æ˜¯æ»¡è¶³å®¢æˆ·ç«¯çš„è¯»å†™ï¼Œæ ¹æ®éœ€è¦å°†å…¶è½¬åŒ–ä¸ºå†…éƒ¨é—ªå­˜æ“ä½œã€‚**é—ªå­˜è½¬æ¢å±‚ï¼ˆFTLï¼‰**æ­£æ˜¯æä¾›äº†è¿™ç§åŠŸèƒ½ã€‚ FTL æ¥å—é€»è¾‘å—ï¼ˆæ„æˆè®¾å¤‡æ¥å£ï¼‰ä¸Šçš„è¯»å†™è¯·æ±‚ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºåº•å±‚ç‰©ç†å—å’Œç‰©ç†é¡µï¼ˆæ„æˆå®é™…é—ªå­˜è®¾å¤‡ï¼‰ä¸Šçš„ä½çº§è¯»å–ã€æ“¦é™¤å’Œç¼–ç¨‹å‘½ä»¤ã€‚ FTL åº”è¯¥ä»¥æä¾›å“è¶Šçš„æ€§èƒ½å’Œé«˜å¯é æ€§ä¸ºç›®æ ‡æ¥å®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚ æ­£å¦‚æˆ‘ä»¬å°†çœ‹åˆ°çš„ï¼Œå“è¶Šçš„æ€§èƒ½å¯ä»¥é€šè¿‡æŠ€æœ¯çš„ç»„åˆæ¥å®ç°ã€‚ä¸€ä¸ªå…³é”®æ˜¯å¹¶è¡Œåˆ©ç”¨å¤šä¸ªé—ªå­˜èŠ¯ç‰‡ï¼›è™½ç„¶æˆ‘ä»¬ä¸ä¼šè¿›ä¸€æ­¥è®¨è®ºè¿™é¡¹æŠ€æœ¯ï¼Œä½†å¯ä»¥è¯´æ‰€æœ‰ç°ä»£ SSD éƒ½åœ¨å†…éƒ¨ä½¿ç”¨å¤šä¸ªèŠ¯ç‰‡æ¥è·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚å¦ä¸€ä¸ªæ€§èƒ½ç›®æ ‡æ˜¯å‡å°‘å†™å…¥æ”¾å¤§ï¼Œå†™å…¥æ”¾å¤§å®šä¹‰ä¸º FTL å‘é—ªå­˜èŠ¯ç‰‡å‘å‡ºçš„æ€»å†™å…¥æµé‡ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰é™¤ä»¥å®¢æˆ·ç«¯å‘ SSD å‘å‡ºçš„æ€»å†™å…¥æµé‡ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚æ­£å¦‚æˆ‘ä»¬å°†åœ¨ä¸‹é¢çœ‹åˆ°çš„ï¼Œç®€å•çš„ FTL æ„å»ºæ–¹æ³•å°†å¯¼è‡´é«˜å†™å…¥æ”¾å¤§å’Œä½æ€§èƒ½ã€‚é«˜å¯é æ€§å°†é€šè¿‡å‡ ç§ä¸åŒæ–¹æ³•çš„ç»„åˆæ¥å®ç°ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯ç£¨æŸã€‚å¦‚æœå•ä¸ªå—è¢«é¢‘ç¹åœ°æ“¦é™¤å’Œç¼–ç¨‹ï¼Œå®ƒå°†å˜å¾—ä¸å¯ç”¨ï¼›å› æ­¤ï¼ŒFTL åº”å°è¯•å°½å¯èƒ½å‡åŒ€åœ°è·¨é—ªå­˜å—åˆ†å¸ƒå†™å…¥ï¼Œç¡®ä¿è®¾å¤‡çš„æ‰€æœ‰å—å¤§è‡´åŒæ—¶ç£¨æŸï¼›è¿™æ ·åšç§°ä¸ºç£¨æŸå‡è¡¡ï¼Œæ˜¯ä»»ä½•ç°ä»£ FTL çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ å¦ä¸€ä¸ªå¯é æ€§é—®é¢˜æ˜¯ç¼–ç¨‹å¹²æ‰°ã€‚ä¸ºäº†æœ€å¤§é™åº¦åœ°å‡å°‘è¿™ç§å¹²æ‰°ï¼ŒFTL é€šå¸¸ä¼šæŒ‰ä»ä½é¡µåˆ°é«˜é¡µçš„é¡ºåºå¯¹æ“¦é™¤å—å†…çš„é¡µè¿›è¡Œç¼–ç¨‹ã€‚è¿™ç§é¡ºåºç¼–ç¨‹æ–¹æ³•æœ€å¤§é™åº¦åœ°å‡å°‘äº†å¹²æ‰°å¹¶è¢«å¹¿æ³›ä½¿ç”¨ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:5:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 FTL ç»„ç»‡ç»“æ„ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:6:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.1 ç›´æ¥æ˜ å°„ æœ€ç®€å•çš„ FTL ç»„ç»‡ç»“æ„æˆ‘ä»¬ç§°ä¹‹ä¸ºç›´æ¥æ˜ å°„ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œé€»è¾‘é¡µ $N$ çš„è¯»å–ç›´æ¥æ˜ å°„åˆ°ç‰©ç†é¡µ $N$ çš„è¯»å–ã€‚å¯¹é€»è¾‘é¡µ N çš„å†™å…¥åˆ™æ›´ä¸ºå¤æ‚ï¼›FTL é¦–å…ˆè¦è¯»å…¥é¡µé¢ $N$ æ‰€åœ¨çš„æ•´ä¸ªå—ï¼Œç„¶åæ“¦é™¤è¯¥å—ï¼Œæœ€åå¯¹æ—§é¡µé¢å’Œæ–°é¡µé¢è¿›è¡Œç¼–ç¨‹ã€‚ ä½ å¯èƒ½å·²ç»çŒœåˆ°ï¼Œç›´æ¥æ˜ å°„ FTL åœ¨æ€§èƒ½å’Œå¯é æ€§æ–¹é¢éƒ½å­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚æ€§èƒ½é—®é¢˜å‡ºç°åœ¨æ¯æ¬¡å†™å…¥æ—¶ï¼šè®¾å¤‡å¿…é¡»è¯»å…¥æ•´ä¸ªæ•°æ®å—ï¼ˆæˆæœ¬é«˜æ˜‚ï¼‰ï¼Œæ“¦é™¤ï¼ˆæˆæœ¬ç›¸å½“é«˜æ˜‚ï¼‰ï¼Œç„¶åç¼–ç¨‹ï¼ˆæˆæœ¬é«˜æ˜‚ï¼‰ã€‚æœ€ç»ˆç»“æœæ˜¯ä¸¥é‡çš„å†™å…¥æ”¾å¤§ï¼ˆä¸å—ä¸­çš„é¡µæ•°æˆæ­£æ¯”ï¼‰ï¼Œå› æ­¤å†™å…¥æ€§èƒ½å¾ˆå·®ï¼Œç”šè‡³æ¯”å…¸å‹ç¡¬ç›˜çš„æœºæ¢°å¯»é“å’Œæ—‹è½¬å»¶è¿Ÿè¿˜è¦æ…¢ã€‚ æ›´ç³Ÿç³•çš„æ˜¯è¿™ç§æ–¹æ³•çš„å¯é æ€§ã€‚å¦‚æœæ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®æˆ–ç”¨æˆ·æ–‡ä»¶æ•°æ®è¢«åå¤è¦†ç›–ï¼ŒåŒä¸€æ•°æ®å—å°±ä¼šè¢«ä¸€æ¬¡åˆä¸€æ¬¡åœ°æ“¦é™¤å’Œç¼–ç¨‹ï¼Œä½¿å…¶è¿…é€ŸæŸè€—ï¼Œå¹¶å¯èƒ½ä¸¢å¤±æ•°æ®ã€‚ç›´æ¥æ˜ å°„æ–¹æ³•åªæ˜¯å°†ç£¨æŸçš„æ§åˆ¶æƒè¿‡å¤šåœ°äº¤ç»™äº†å®¢æˆ·ç«¯å·¥ä½œè´Ÿè½½ï¼›å¦‚æœå·¥ä½œè´Ÿè½½ä¸èƒ½å°†å†™å…¥è´Ÿè½½å‡åŒ€åœ°åˆ†æ•£åˆ°é€»è¾‘å—ä¸­ï¼Œé‚£ä¹ˆåŒ…å«å¸¸ç”¨æ•°æ®çš„åº•å±‚ç‰©ç†å—å°±ä¼šå¾ˆå¿«ç£¨æŸã€‚å‡ºäºå¯é æ€§å’Œæ€§èƒ½æ–¹é¢çš„è€ƒè™‘ï¼Œç›´æ¥æ˜ å°„ FTL éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:6:1","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.2 æ—¥å¿—ç»“æ„çš„ FTL 6.2.1 åŸºæœ¬åŸç† ç”±äºè¿™äº›åŸå› ï¼Œå¦‚ä»Šå¤§å¤šæ•° FTL éƒ½æ˜¯æ—¥å¿—ç»“æ„çš„ï¼Œè¿™ä¸€ç†å¿µåœ¨å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚æˆ‘ä»¬ç°åœ¨çœ‹åˆ°çš„ï¼‰å’Œå…¶ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚æˆ‘ä»¬å°†åœ¨æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿä¸€ç« ä¸­çœ‹åˆ°çš„ï¼‰ä¸­éƒ½å¾ˆæœ‰ç”¨ã€‚åœ¨å†™å…¥é€»è¾‘å— $N$ æ—¶ï¼Œè®¾å¤‡ä¼šå°†å†™å…¥å†…å®¹é™„åŠ åˆ°å½“å‰æ­£åœ¨å†™å…¥çš„å—ä¸­çš„ä¸‹ä¸€ä¸ªç©ºé—²ä½ç½®ï¼›æˆ‘ä»¬ç§°è¿™ç§å†™å…¥æ–¹å¼ä¸ºæ—¥å¿—ã€‚ä¸ºæ–¹ä¾¿åç»­è¯»å–å— $N$ï¼Œè®¾å¤‡ä¼šä¿å­˜ä¸€ä¸ªæ˜ å°„è¡¨ï¼ˆåœ¨å†…å­˜ä¸­ï¼Œå¹¶ä»¥æŸç§å½¢å¼æŒä¹…å­˜åœ¨äºè®¾å¤‡ä¸Šï¼‰ï¼›è¯¥è¡¨å­˜å‚¨äº†ç³»ç»Ÿä¸­æ¯ä¸ªé€»è¾‘å—çš„ç‰©ç†åœ°å€ã€‚ è®©æˆ‘ä»¬ä¸¾ä¾‹è¯´æ˜åŸºäºæ—¥å¿—çš„åŸºæœ¬æ–¹æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œè®¾å¤‡çœ‹èµ·æ¥å°±åƒä¸€ä¸ªå…¸å‹çš„ç£ç›˜ï¼Œå¯ä»¥è¯»å†™ 512 å­—èŠ‚çš„æ‰‡åŒºï¼ˆæˆ–æ‰‡åŒºç»„ï¼‰ã€‚ä¸ºç®€å•èµ·è§ï¼Œå‡è®¾å®¢æˆ·ç«¯æ­£åœ¨è¯»å–æˆ–å†™å…¥ 4KB å¤§å°çš„å—ã€‚è®©æˆ‘ä»¬è¿›ä¸€æ­¥å‡è®¾SSDåŒ…å«å¤§é‡ 16KB å¤§å°çš„å—ï¼Œæ¯ä¸ªå—åˆ†ä¸º 4 ä¸ª 4KB é¡µé¢ï¼ˆä½†é—ªå­˜å—é€šå¸¸ç”±æ›´å¤šé¡µé¢ç»„æˆï¼‰ã€‚ å‡è®¾å®¢æˆ·ç«¯å‘å‡ºä»¥ä¸‹æ“ä½œåºåˆ—ï¼š Write(100) with contents a1 Write(101) with contents a2 Write(2000) with contents b1 Write(2001) with contents b2 SSD å®¢æˆ·ç«¯ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿï¼‰ä½¿ç”¨è¿™äº›é€»è¾‘å—åœ°å€ï¼ˆå¦‚ 100ï¼‰æ¥è®°å¿†ä¿¡æ¯çš„ä½ç½®ã€‚ åœ¨å†…éƒ¨ï¼Œè®¾å¤‡å¿…é¡»å°†è¿™äº›å—å†™å…¥è½¬åŒ–ä¸ºåŸå§‹ç¡¬ä»¶æ”¯æŒçš„æ“¦é™¤å’Œç¼–ç¨‹æ“ä½œï¼Œå¹¶ä»¥æŸç§æ–¹å¼è®°å½•æ¯ä¸ªé€»è¾‘å—åœ°å€åœ¨å›ºæ€ç¡¬ç›˜çš„å“ªä¸ªç‰©ç†é¡µé¢å­˜å‚¨æ•°æ®ã€‚å‡è®¾å›ºæ€ç¡¬ç›˜çš„æ‰€æœ‰å—ç›®å‰éƒ½æ— æ•ˆï¼Œå› æ­¤å¿…é¡»å…ˆæ“¦é™¤è¿™äº›å—ï¼Œç„¶åæ‰èƒ½å¯¹ä»»ä½•é¡µé¢è¿›è¡Œç¼–ç¨‹ã€‚è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯å›ºæ€ç¡¬ç›˜çš„åˆå§‹çŠ¶æ€ï¼Œæ‰€æœ‰é¡µé¢éƒ½æ ‡è®°ä¸ºINVALID(i)ï¼š å½“SSDæ”¶åˆ°ç¬¬ä¸€ä¸ªå†™å…¥ï¼ˆé€»è¾‘å—100ï¼‰æ—¶ï¼ŒFTLå†³å®šå°†å…¶å†™å…¥ç‰©ç†å—0ï¼Œå…¶ä¸­åŒ…å«å››ä¸ªç‰©ç†é¡µï¼š0ã€1ã€2å’Œ3ã€‚å› ä¸ºè¯¥å—æ²¡æœ‰è¢«æ“¦é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜ä¸èƒ½å†™å…¥ï¼›è®¾å¤‡å¿…é¡»é¦–å…ˆå‘å— 0 å‘å‡ºæ“¦é™¤å‘½ä»¤ã€‚è¿™æ ·åšä¼šå¯¼è‡´ä»¥ä¸‹çŠ¶æ€ï¼š ç°åœ¨å¯ä»¥å¯¹ 0 å—è¿›è¡Œç¼–ç¨‹äº†ã€‚å¤§å¤šæ•°å›ºæ€ç¡¬ç›˜ä¼šæŒ‰é¡ºåºï¼ˆå³ä»ä½åˆ°é«˜ï¼‰å†™å…¥é¡µé¢ï¼Œä»è€Œå‡å°‘ä¸ç¨‹åºå¹²æ‰°æœ‰å…³çš„å¯é æ€§é—®é¢˜ã€‚ç„¶åï¼Œå›ºæ€ç¡¬ç›˜å°†é€»è¾‘å— 100 å†™å…¥ç‰©ç†é¡µ 0ï¼š ä½†å¦‚æœå®¢æˆ·è¦è¯»å–é€»è¾‘å— 100 å‘¢ï¼Ÿå¦‚ä½•æ‰¾åˆ°å®ƒçš„ä½ç½®ï¼ŸSSDå¿…é¡»å°†å¯¹é€»è¾‘å— 100 çš„è¯»å–è½¬æ¢ä¸ºå¯¹ç‰©ç†é¡µ 0 çš„è¯»å–ã€‚ä¸ºäº†é€‚åº”è¿™ç§åŠŸèƒ½ï¼Œå½“ FTL å°†é€»è¾‘å— 100 å†™å…¥ç‰©ç†é¡µ 0 æ—¶ï¼Œå®ƒä¼šåœ¨å†…å­˜æ˜ å°„è¡¨ä¸­è®°å½•è¿™ä¸€äº‹å®ã€‚æˆ‘ä»¬è¿˜å°†åœ¨å›¾è¡¨ä¸­è·Ÿè¸ªè¯¥æ˜ å°„è¡¨çš„çŠ¶æ€ï¼š ç°åœ¨æ‚¨å¯ä»¥çœ‹åˆ°å½“å®¢æˆ·ç«¯å†™å…¥ SSD æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ SSDæ‰¾åˆ°å†™å…¥ä½ç½®ï¼Œé€šå¸¸åªæ˜¯é€‰æ‹©ä¸‹ä¸€ä¸ªç©ºé—²é¡µé¢ï¼›ç„¶åï¼Œå®ƒä½¿ç”¨å—çš„å†…å®¹å¯¹è¯¥é¡µè¿›è¡Œç¼–ç¨‹ï¼Œå¹¶å°†é€»è¾‘åˆ°ç‰©ç†çš„æ˜ å°„è®°å½•åœ¨å…¶æ˜ å°„è¡¨ä¸­ã€‚åç»­è¯»å–åªéœ€ä½¿ç”¨è¯¥è¡¨å°†å®¢æˆ·ç«¯æä¾›çš„é€»è¾‘å—åœ°å€è½¬æ¢ä¸ºè¯»å–æ•°æ®æ‰€éœ€çš„ç‰©ç†é¡µå·ã€‚ ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥ç¤ºä¾‹å†™å…¥æµä¸­çš„å…¶ä½™å†™å…¥ï¼š101ã€2000 å’Œ 2001ã€‚å†™å…¥è¿™äº›å—åï¼Œè®¾å¤‡çš„çŠ¶æ€ä¸ºï¼š åŸºäºæ—¥å¿—çš„æ–¹æ³•ä»æœ¬è´¨ä¸Šæé«˜äº†æ€§èƒ½ï¼ˆåªéœ€å¶å°”æ“¦é™¤ä¸€æ¬¡ï¼Œå®Œå…¨é¿å…äº†ç›´æ¥æ˜ å°„æ–¹æ³•ä¸­ä»£ä»·é«˜æ˜‚çš„è¯»å–-ä¿®æ”¹-å†™å…¥ï¼‰ï¼Œå¹¶å¤§å¤§æé«˜äº†å¯é æ€§ã€‚FTL ç°åœ¨å¯ä»¥åœ¨æ‰€æœ‰é¡µé¢ä¸Šåˆ†æ•£å†™å…¥ï¼Œæ‰§è¡Œæ‰€è°“çš„ç£¨æŸå‡è¡¡ï¼Œå»¶é•¿è®¾å¤‡çš„ä½¿ç”¨å¯¿å‘½ï¼›æˆ‘ä»¬å°†åœ¨ä¸‹æ–‡è¿›ä¸€æ­¥è®¨è®ºæŸè€—å‡è¡¡ã€‚ FTL æ˜ å°„ä¿¡æ¯æŒä¹…æ€§ æ‚¨å¯èƒ½æƒ³çŸ¥é“ï¼šå¦‚æœè®¾å¤‡æ–­ç”µä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå†…å­˜æ˜ å°„è¡¨æ¶ˆå¤±äº†å—ï¼Ÿæ˜¾ç„¶ï¼Œæ­¤ç±»ä¿¡æ¯ä¸ä¼šçœŸæ­£ä¸¢å¤±ï¼Œå¦åˆ™è¯¥è®¾å¤‡å°†æ— æ³•å……å½“æŒä¹…å­˜å‚¨è®¾å¤‡ã€‚ SSD å¿…é¡»å…·æœ‰æŸç§æ¢å¤æ˜ å°„ä¿¡æ¯çš„æ–¹æ³•ã€‚ æœ€ç®€å•çš„åšæ³•æ˜¯åœ¨æ¯ä¸ªé¡µé¢ä¸Šè®°å½•ä¸€äº›æ˜ å°„ä¿¡æ¯ï¼Œå³æ‰€è°“çš„å¸¦å¤– (OOB) åŒºåŸŸã€‚å½“è®¾å¤‡æ–­ç”µå¹¶é‡æ–°å¯åŠ¨æ—¶ï¼Œå®ƒå¿…é¡»é€šè¿‡æ‰«æ OOB åŒºåŸŸå¹¶é‡å»ºå†…å­˜ä¸­çš„æ˜ å°„è¡¨ã€‚è¿™ç§åŸºæœ¬æ–¹æ³•ä¹Ÿæœ‰å…¶é—®é¢˜ï¼›æ‰«æå¤§å‹ SSD æ¥æŸ¥æ‰¾æ‰€æœ‰å¿…è¦çš„æ˜ å°„ä¿¡æ¯çš„é€Ÿåº¦å¾ˆæ…¢ã€‚ä¸ºäº†å…‹æœè¿™ä¸ªé™åˆ¶ï¼Œä¸€äº›é«˜ç«¯è®¾å¤‡ä½¿ç”¨æ›´å¤æ‚çš„æ—¥å¿—è®°å½•å’Œæ£€æŸ¥ç‚¹æŠ€æœ¯æ¥åŠ é€Ÿæ¢å¤ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§åŸºæœ¬çš„æ—¥å¿—ç»“æ„æ–¹æ³•æœ‰ä¸€äº›ç¼ºç‚¹ã€‚ ç¬¬ä¸€ä¸ªæ˜¯é€»è¾‘å—çš„è¦†ç›–ä¼šå¯¼è‡´æˆ‘ä»¬ç§°ä¹‹ä¸ºåƒåœ¾çš„ä¸œè¥¿ï¼Œå³é©±åŠ¨å™¨å‘¨å›´çš„æ—§ç‰ˆæœ¬æ•°æ®å¹¶å ç”¨ç©ºé—´ã€‚è®¾å¤‡å¿…é¡»å®šæœŸæ‰§è¡Œ**åƒåœ¾å›æ”¶ï¼ˆGCï¼‰**ä»¥æ‰¾åˆ°æ‰€è¿°å—å’Œå¯ç”¨ç©ºé—´ä»¥ä¾›å°†æ¥å†™å…¥ï¼›è¿‡å¤šçš„åƒåœ¾å›æ”¶ä¼šå¢åŠ å†™å…¥æ”¾å¤§å¹¶é™ä½æ€§èƒ½ã€‚ äºŒæ˜¯å†…å­˜æ˜ å°„è¡¨æˆæœ¬é«˜ï¼›è®¾å¤‡è¶Šå¤§ï¼Œæ­¤ç±»è¡¨éœ€è¦çš„å†…å­˜å°±è¶Šå¤šã€‚æˆ‘ä»¬ç°åœ¨ä¾æ¬¡è®¨è®ºæ¯ä¸€ä¸ªã€‚ 6.2.2 åƒåœ¾å›æ”¶ ä»»ä½•æ—¥å¿—ç»“æ„æ–¹æ³•ï¼ˆä¾‹å¦‚æ­¤æ–¹æ³•ï¼‰çš„ç¬¬ä¸€ä¸ªæˆæœ¬æ˜¯åˆ›å»ºåƒåœ¾ï¼Œå› æ­¤å¿…é¡»æ‰§è¡Œåƒåœ¾å›æ”¶ï¼ˆå³æ­»å—å›æ”¶ï¼‰ã€‚è®©æˆ‘ä»¬ç”¨ä¹‹å‰ä¾‹å­æ¥ç†è§£è¿™ä¸€ç‚¹ã€‚å›æƒ³ä¸€ä¸‹ï¼Œé€»è¾‘å— 100ã€101ã€2000 å’Œ 2001 å·²å†™å…¥è®¾å¤‡ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å‡è®¾å†æ¬¡å†™å…¥å— 100 å’Œ 101ï¼Œå†…å®¹ä¸º c1 å’Œ c2ã€‚å†™å…¥æ“ä½œå°†å†™å…¥ä¸‹ä¸€ä¸ªç©ºé—²é¡µï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºç‰©ç†é¡µ 4 å’Œ 5ï¼‰ï¼Œå¹¶ä¸”æ˜ å°„è¡¨ä¹Ÿä¼šç›¸åº”æ›´æ–°ã€‚è¯·æ³¨æ„ï¼Œè®¾å¤‡å¿…é¡»é¦–å…ˆæ“¦é™¤å— 1 æ‰èƒ½è¿›è¡Œæ­¤ç±»ç¼–ç¨‹ï¼š æˆ‘ä»¬ç°åœ¨é‡åˆ°çš„é—®é¢˜åº”è¯¥å¾ˆæ˜æ˜¾ï¼šç‰©ç†é¡µ 0 å’Œ 1 è™½ç„¶æ ‡è®°ä¸º VALIDï¼Œä½†å…¶ä¸­æœ‰åƒåœ¾ï¼Œå³æ—§ç‰ˆæœ¬çš„å— 100 å’Œ 101ã€‚ç”±äºè®¾å¤‡çš„æ—¥å¿—ç»“æ„ç‰¹æ€§ï¼Œè¦†ç›–ä¼šäº§ç”Ÿåƒåœ¾å—ï¼Œè®¾å¤‡å¿…é¡»å›æ”¶è¿™äº›åƒåœ¾å—ï¼Œä»¥ä¾¿ä¸ºæ–°çš„å†™å…¥æä¾›å¯ç”¨ç©ºé—´ã€‚ æŸ¥æ‰¾åƒåœ¾å—ï¼ˆä¹Ÿç§°ä¸ºæ­»å—ï¼‰å¹¶å°†å…¶å›æ”¶ä»¥å¤‡å°†æ¥ä½¿ç”¨çš„è¿‡ç¨‹ç§°ä¸ºåƒåœ¾å›æ”¶ï¼Œå®ƒæ˜¯æ‰€æœ‰ç°ä»£å›ºæ€ç¡¬ç›˜çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚åŸºæœ¬è¿‡ç¨‹å¾ˆç®€å•ï¼šæ‰¾åˆ°åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåƒåœ¾é¡µçš„å—ï¼Œè¯»å…¥è¯¥å—ä¸­çš„æ´»ï¼ˆéåƒåœ¾ï¼‰é¡µï¼Œå°†è¿™äº›æ´»é¡µå†™å…¥æ—¥å¿—ï¼Œæœ€åå›æ”¶æ•´ä¸ªå—ç”¨äºå†™å…¥ã€‚ ä¸‹é¢æˆ‘ä»¬ä¸¾ä¾‹è¯´æ˜ã€‚è®¾å¤‡å†³å®šè¦å›æ”¶ä¸Šè¿° 0 å·å—ä¸­çš„æ‰€æœ‰æ­»é¡µã€‚å— 0 æœ‰ä¸¤ä¸ªæ­»å—ï¼ˆç¬¬ 0 é¡µå’Œç¬¬ 1 é¡µï¼‰å’Œä¸¤ä¸ªæ´»å—ï¼ˆç¬¬ 2 é¡µå’Œç¬¬ 3 é¡µï¼Œåˆ†åˆ«åŒ…å«å— 2000 å’Œ 2001ï¼‰ã€‚ä¸ºæ­¤ï¼Œè®¾å¤‡å°†ï¼š ä»å— 0 è¯»å–æœ‰æ•ˆæ•°æ®ï¼ˆç¬¬ 2 é¡µå’Œç¬¬ 3 é¡µï¼‰ å°†æœ‰æ•ˆæ•°æ®å†™å…¥æ—¥å¿—æœ«å°¾ æ“¦é™¤å— 0ï¼ˆå°†å…¶é‡Šæ”¾ä¾›ä»¥åä½¿ç”¨ï¼‰ ä¸ºäº†è®©åƒåœ¾å›æ”¶ç¨‹åºå‘æŒ¥ä½œç”¨ï¼Œæ¯ä¸ªå—å†…å¿…é¡»æœ‰è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä»¥ä¾¿å›ºæ€ç¡¬ç›˜ç¡®å®šæ¯ä¸ªé¡µé¢æ˜¯æœ‰æ•ˆè¿˜æ˜¯æ— æ•ˆã€‚å®ç°è¿™ä¸€ç›®çš„çš„ä¸€ç§è‡ªç„¶æ–¹æ³•æ˜¯åœ¨æ¯ä¸ªå—å†…çš„æŸä¸ªä½ç½®å­˜å‚¨æœ‰å…³æ¯ä¸ªé¡µé¢å†…å­˜å‚¨äº†å“ªäº›é€»è¾‘å—çš„ä¿¡æ¯ã€‚ç„¶åï¼Œè®¾å¤‡å°±å¯ä»¥ä½¿ç”¨æ˜ å°„è¡¨æ¥ç¡®å®šå—ä¸­çš„æ¯ä¸ªé¡µé¢æ˜¯å¦ä¿å­˜æœ‰æ•ˆæ•°æ®ã€‚ åœ¨æˆ‘ä»¬ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼ˆåƒåœ¾å›æ”¶ä¹‹å‰ï¼‰ï¼Œå— 0 åŒ…å«é€»è¾‘å— 100ã€101ã€2000 å’Œ 2001ã€‚é€šè¿‡æ£€æŸ¥æ˜ å°„è¡¨ï¼ˆåœ¨åƒåœ¾æ”¶é›†ä¹‹å‰ï¼Œæ˜ å°„è¡¨åŒ…å« 100-\u003e4ã€101-\u003e5ã€2000-\u003e2ã€2001-\u003e3ï¼‰ï¼Œè®¾å¤‡å¯ä»¥è½»æ¾ç¡®å®šå›ºæ€ç¡¬ç›˜å—å†…çš„æ¯ä¸ªé¡µé¢æ˜¯å¦åŒ…å«æœ‰æ•ˆä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œ2000 å’Œ 2001 æ˜¾ç„¶ä»ç”±æ˜ å°„æŒ‡å‘ï¼›è€Œ 100 å’Œ 101 åˆ™ä¸æ˜¯ï¼Œå› æ­¤æ˜¯åƒåœ¾å›æ”¶çš„å€™é€‰å¯¹è±¡ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå½“åƒåœ¾å›æ”¶è¿‡ç¨‹å®Œæˆåï¼Œè®¾å¤‡çš„çŠ¶æ€ä¸ºï¼š å¯ä»¥çœ‹å‡ºï¼Œåƒåœ¾å›æ”¶çš„æˆæœ¬å¾ˆé«˜ï¼Œéœ€è¦è¯»å–å’Œé‡å†™æœ‰æ•ˆæ•°æ®ã€‚æœ€ç†æƒ³çš„å›æ”¶å¯¹è±¡æ˜¯åªåŒ…å«æ­»é¡µçš„å—ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®å—å¯ä»¥ç«‹å³è¢«æ“¦é™¤å¹¶ç”¨äºæ–°æ•°æ®ï¼Œè€Œæ— éœ€è¿›è¡Œæ˜‚è´µçš„æ•°æ®è¿ç§»ã€‚ ä¸ºäº†é™ä½ GC æˆæœ¬ï¼Œä¸€äº›å›ºæ€ç¡¬ç›˜å¯¹è®¾å¤‡è¿›è¡Œäº†è¶…é¢é…ç½®ï¼›é€šè¿‡å¢åŠ é¢å¤–çš„é—ªå­˜å®¹é‡ï¼Œå¯ä»¥å»¶è¿Ÿæ¸…ç†å¹¶å°†å…¶æ¨è‡³åå°ï¼Œæˆ–è®¸å¯ä»¥åœ¨è®¾å¤‡ä¸å¤ªå¿™çš„æ—¶å€™è¿›è¡Œã€‚å¢åŠ å®¹é‡è¿˜èƒ½å¢åŠ å†…éƒ¨å¸¦å®½ï¼Œå¯ç”¨äºæ¸…ç†ï¼Œä»è€Œä¸å½±å“å®¢æˆ·ç«¯çš„æ„ŸçŸ¥å¸¦å®½ã€‚è®¸å¤šç°ä»£ç¡¬ç›˜éƒ½ä»¥è¿™ç§æ–¹å¼è¿›è¡Œè¶…é¢é…ç½®ï¼Œè¿™æ˜¯å®ç°å‡ºè‰²æ•´ä½“æ€§èƒ½çš„å…³é”®ä¹‹ä¸€ã€‚ ä¸€ç§ç§°ä¸º TRIM çš„æ–°å­˜å‚¨ API å½“æˆ‘ä»¬æƒ³åˆ°ç¡¬ç›˜é©±åŠ¨å™¨æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸åªæƒ³åˆ°æœ€åŸºæœ¬çš„è¯»å†™æ¥å£ï¼šè¯»å’Œå†™ï¼ˆé€šå¸¸è¿˜æœ‰æŸç§ç¼“å­˜åˆ·æ–°å‘½ä»¤ï¼Œç¡®ä¿å†™å…¥å®é™…ä¸Šå·²è¢«æŒä¹…åŒ–ï¼Œä½†ä¸ºäº†ç®€å•èµ·è§ï¼Œæœ‰æ—¶æˆ‘ä»¬ä¼šå¿½ç•¥è¿™ä¸€ç‚¹ï¼‰ã€‚å¯¹äºæ—¥å¿—ç»“æ„çš„ SSDï¼Œä»¥åŠä»»ä½•ä¿æŒé€»è¾‘åˆ°ç‰©ç†å—çš„çµæ´»ä¸”ä¸æ–­å˜åŒ–çš„æ˜ å°„çš„è®¾å¤‡ï¼Œä¸€ä¸ªæ–°çš„æ¥å£éå¸¸æœ‰ç”¨ï¼Œç§°ä¸ºä¿®å‰ªæ“ä½œã€‚ ä¿®å‰ªæ“ä½œé‡‡ç”¨ä¸€ä¸ªåœ°å€ï¼ˆå¯èƒ½è¿˜æœ‰ä¸€ä¸ªé•¿åº¦ï¼‰ï¼Œå¹¶ç®€å•åœ°é€šçŸ¥è®¾å¤‡è¯¥åœ°å€ï¼ˆå’Œé•¿åº¦ï¼‰æŒ‡å®šçš„å—å·²è¢«åˆ é™¤ï¼›å› æ­¤ï¼Œè®¾å¤‡ä¸å†éœ€è¦è·Ÿè¸ªæœ‰å…³ç»™å®šåœ°å€èŒƒå›´çš„ä»»ä½•ä¿¡æ¯ã€‚å¯¹äºæ ‡å‡†ç¡¬ç›˜é©±åŠ¨å™¨ï¼Œä¿®å‰ªå¹¶ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºé©±åŠ¨å™¨å…·æœ‰å—åœ°å€åˆ°ç‰¹å®šç›˜ç‰‡ã€ç£é“å’Œæ‰‡åŒºçš„é™æ€æ˜ å°„ã€‚ ç„¶è€Œï¼Œå¯¹äºæ—¥å¿—ç»“æ„çš„ SSDï¼ŒçŸ¥é“ä¸å†éœ€è¦æŸä¸ªå—éå¸¸æœ‰ç”¨ï¼Œå› ä¸º SSD å¯ä»¥ä» FTL ä¸­åˆ é™¤æ­¤ä¿¡æ¯ï¼Œå¹¶åœ¨åƒåœ¾å›æ”¶æœŸé—´å›æ”¶ç‰©ç†ç©ºé—´ã€‚ å°½ç®¡æˆ‘ä»¬æœ‰æ—¶å°†æ¥å£å’Œå®ç°è§†ä¸ºç‹¬ç«‹çš„å®ä½“ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çœ‹åˆ°å®ç°å¡‘é€ äº†æ¥å£ã€‚é€šè¿‡å¤æ‚çš„æ˜ å°„ï¼Œäº†è§£ä¸å†éœ€è¦å“ªäº›å—å¯ä»¥æ›´æœ‰æ•ˆçš„å®ç°ã€‚ 6.2.3 æ˜ å°„è¡¨å¤§å° æ—¥å¿—ç»“æ„çš„ç¬¬äºŒä¸ªæˆæœ¬æ˜¯å¯èƒ½ä¼šäº§ç”Ÿéå¸¸å¤§çš„æ˜ å°„è¡¨ï¼Œè®¾å¤‡çš„æ¯ä¸ª 4 KB é¡µéƒ½æœ‰ä¸€ä¸ªæ¡ç›®ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå¤§å‹ 1 TB SSDï¼Œæ¯ 4 KB é¡µä¸€ä¸ª 4 å­—èŠ‚æ¡ç›®ä¼šå¯¼è‡´è®¾å¤‡éœ€è¦ 1 GB å†…å­˜ï¼Œä»…ç”¨äºè¿™äº›æ˜ å°„ï¼å› æ­¤ï¼Œè¿™ç§é¡µçº§ FTL æ–¹æ¡ˆæ˜¯ä¸åˆ‡å®é™…çš„ã€‚ 6.2.3.1 åŸºäºå—çš„æ˜ å°„ é™ä½æ˜ å°„æˆæœ¬çš„ä¸€ç§æ–¹æ³•æ˜¯åªä¸ºè®¾å¤‡çš„æ¯ä¸ªå—è€Œä¸æ˜¯æ¯ä¸ªé¡µä¿ç•™ä¸€ä¸ªæŒ‡é’ˆï¼Œä»è€Œå°†æ˜ å°„ä¿¡æ¯é‡å‡å°‘ $\\frac{Size_{block}}{ Size_{page}}$ å€ã€‚è¿™ç§å—çº§ FTL ç±»ä¼¼äºåœ¨è™šæ‹Ÿå†…å­˜ç³»ç»Ÿä¸­å…·æœ‰æ›´å¤§çš„é¡µé¢å¤§å°ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä¸º VPN ä½¿ç”¨æ›´å°‘çš„ä½ï¼Œå¹¶åœ¨æ¯ä¸ªè™šæ‹Ÿåœ°å€ä¸­ä½¿ç”¨æ›´å¤§çš„åç§»é‡ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œç”±äºæ€§èƒ½åŸå› ï¼Œåœ¨åŸºäºæ—¥å¿—çš„ FTL ä¸­ä½¿ç”¨åŸºäºå—çš„æ˜ å°„æ•ˆæœä¸ä½³ã€‚å½“å‘ç”Ÿâ€œå°å†™å…¥â€ï¼ˆå³å°äºç‰©ç†å—å¤§å°çš„å†™å…¥ï¼‰æ—¶ï¼Œå°±ä¼šå‡ºç°æœ€å¤§çš„é—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒFTL å¿…é¡»ä»æ—§å—ä¸­è¯»å–å¤§é‡æœ‰æ•ˆæ•°æ®å¹¶å°†å…¶å¤åˆ¶åˆ°æ–°å—ä¸­ï¼ˆä»¥åŠæ¥è‡ªå°å†™å…¥çš„æ•°æ®ï¼‰ã€‚è¿™ç§æ•°æ®å¤åˆ¶æå¤§åœ°å¢åŠ äº†å†™æ”¾å¤§ï¼Œä»è€Œé™ä½äº†æ€§èƒ½ã€‚ ä¸ºäº†æ›´æ¸…æ¥šåœ°è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾å®¢æˆ·ç«¯ä¹‹å‰å†™å‡ºäº†é€»è¾‘å— 2000ã€2001ã€2002 å’Œ 2003ï¼ˆå†…å®¹ä¸º aã€bã€cã€dï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬ä½äºç‰©ç†å— 1 å†…çš„ç‰©ç†é¡µ 4ã€5ã€6 å’Œ 7ã€‚å¯¹äºæ¯é¡µæ˜ å°„ï¼Œè½¬æ¢è¡¨å¿…é¡»è®°å½•è¿™äº›é€»è¾‘å—çš„å››ä¸ªæ˜ å°„ï¼š2000â†’4ã€2001â†’5ã€2002â†’6ã€2003â†’7ã€‚ ç›¸åï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å—çº§æ˜ å°„ï¼ŒFTL åªéœ€è¦è®°å½•æ‰€æœ‰è¿™äº›æ•°æ®çš„å•ä¸ªåœ°å€è½¬æ¢ã€‚ç„¶è€Œï¼Œåœ°å€æ˜ å°„ä¸æˆ‘ä»¬ä¹‹å‰çš„ç¤ºä¾‹ç•¥æœ‰ä¸åŒã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬è®¤ä¸ºè®¾å¤‡çš„é€»è¾‘åœ°å€ç©ºé—´è¢«åˆ†å‰²æˆé—ªå­˜ä¸­ç‰©ç†å—å¤§å°çš„å—ã€‚å› æ­¤ï¼Œé€»è¾‘å—åœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå—å·å’Œåç§»é‡ã€‚å› ä¸ºæˆ‘ä»¬å‡è®¾æ¯ä¸ªç‰©ç†å—ä¸­æœ‰å››ä¸ªé€»è¾‘å—ï¼Œæ‰€ä»¥é€»è¾‘åœ°å€çš„åç§»éƒ¨åˆ†éœ€è¦ 2 ä½ï¼›å…¶ä½™ï¼ˆ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:6:2","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 ç£¨æŸå‡è¡¡ æœ€åï¼Œç°ä»£ FTL å¿…é¡»å®ç°çš„ä¸€é¡¹ç›¸å…³èƒŒæ™¯æ´»åŠ¨æ˜¯ç£¨æŸå‡è¡¡ï¼Œå¦‚ä¸Šæ‰€è¿°ã€‚åŸºæœ¬æ€æƒ³å¾ˆç®€å•ï¼šå› ä¸ºå¤šä¸ªæ“¦é™¤/ç¼–ç¨‹å‘¨æœŸä¼šç£¨æŸé—ªå­˜å—ï¼Œæ‰€ä»¥ FTL åº”å°½åŠ›å°†å·¥ä½œå‡åŒ€åœ°åˆ†å¸ƒåˆ°è®¾å¤‡çš„æ‰€æœ‰å—ä¸Šã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‰€æœ‰å—å°†å¤§è‡´åœ¨åŒä¸€æ—¶é—´ç£¨æŸï¼Œè€Œä¸æ˜¯ä¸€äº›â€œå¸¸ç”¨â€å—å¾ˆå¿«å˜å¾—æ— æ³•ä½¿ç”¨ã€‚ åŸºæœ¬çš„æ—¥å¿—ç»“æ„æ–¹æ³•åœ¨åˆ†æ•£å†™å…¥è´Ÿè½½æ–¹é¢åšå¾—å¾ˆå¥½ï¼Œåƒåœ¾å›æ”¶ä¹Ÿæœ‰å¸®åŠ©ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ä¸€ä¸ªå—ä¼šå¡«å……é•¿æœŸå­˜åœ¨çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¸ä¼šè¢«è¦†ç›–ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåƒåœ¾å›æ”¶æ°¸è¿œä¸ä¼šå›æ”¶è¯¥å—ï¼Œå› æ­¤å®ƒä¸ä¼šæ”¶åˆ°å…¶å…¬å¹³ä»½é¢çš„å†™å…¥è´Ÿè½½ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒFTL å¿…é¡»å®šæœŸä»è¿™äº›å—ä¸­è¯»å–æ‰€æœ‰æœ‰æ•ˆæ•°æ®ï¼Œå¹¶å°†å…¶é‡æ–°å†™å…¥å…¶ä»–åœ°æ–¹ï¼Œä»è€Œä½¿è¯¥å—å¯å†æ¬¡å†™å…¥ã€‚è¿™ç§ç£¨æŸå‡è¡¡è¿‡ç¨‹ä¼šå¢åŠ  SSD çš„å†™å…¥æ”¾å¤§ï¼Œä»è€Œé™ä½æ€§èƒ½ï¼Œå› ä¸ºéœ€è¦é¢å¤–çš„ I/O æ¥ç¡®ä¿æ‰€æœ‰å—ä»¥å¤§è‡´ç›¸åŒçš„é€Ÿç‡ç£¨æŸã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:7:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 SSDæ€§èƒ½ä¸æˆæœ¬ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:8:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8.1 æ€§èƒ½ ä¸ç¡¬ç›˜é©±åŠ¨å™¨ä¸åŒï¼ŒåŸºäºé—ªå­˜çš„ SSD æ²¡æœ‰æœºæ¢°ç»„ä»¶ï¼Œå®é™…ä¸Šåœ¨å¾ˆå¤šæ–¹é¢ä¸ DRAM æ›´ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬æ˜¯â€œéšæœºè®¿é—®â€è®¾å¤‡ã€‚ä¸ç£ç›˜é©±åŠ¨å™¨ç›¸æ¯”ï¼Œæœ€å¤§çš„æ€§èƒ½å·®å¼‚æ˜¯åœ¨æ‰§è¡Œéšæœºè¯»å–å’Œå†™å…¥æ—¶å®ç°çš„ï¼›è™½ç„¶å…¸å‹çš„ç£ç›˜é©±åŠ¨å™¨æ¯ç§’åªèƒ½æ‰§è¡Œå‡ ç™¾æ¬¡éšæœº I/Oï¼Œä½† SSD å¯ä»¥åšå¾—æ›´å¥½ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ç°ä»£ SSD çš„ä¸€äº›æ•°æ®æ¥çœ‹çœ‹ SSD çš„æ€§èƒ½åˆ°åº•æœ‰å¤šå¥½ï¼›æˆ‘ä»¬ç‰¹åˆ«æ„Ÿå…´è¶£çš„æ˜¯ FTL å¦‚ä½•å¾ˆå¥½åœ°éšè—åŸå§‹èŠ¯ç‰‡çš„æ€§èƒ½é—®é¢˜ã€‚ ä¸‹è¡¨æ˜¾ç¤ºäº†ä¸‰ç§ä¸åŒ SSD å’Œä¸€ç§é¡¶çº§ç¡¬ç›˜çš„ä¸€äº›æ€§èƒ½æ•°æ®ã€‚ å·¦è¾¹ä¸¤åˆ—æ˜¾ç¤ºéšæœº I/O æ€§èƒ½ï¼Œå³è¾¹ä¸¤åˆ—æ˜¾ç¤ºé¡ºåºI/Oæ€§èƒ½ï¼›å‰ä¸‰è¡Œæ˜¾ç¤ºä¸‰ç§ä¸åŒ SSDï¼ˆæ¥è‡ªSamsungã€Seagateå’ŒIntelï¼‰çš„æ•°æ®ï¼Œæœ€åä¸€è¡Œæ˜¾ç¤ºç¡¬ç›˜é©±åŠ¨å™¨ï¼ˆæˆ– HDDï¼‰çš„æ€§èƒ½ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºSeagateé«˜ç«¯é©±åŠ¨å™¨ã€‚ æˆ‘ä»¬å¯ä»¥ä»è¡¨ä¸­äº†è§£åˆ°ä¸€äº›æœ‰è¶£çš„äº‹å®ã€‚ é¦–å…ˆï¼Œä¹Ÿæ˜¯æœ€å¼•äººæ³¨ç›®çš„ï¼Œæ˜¯ SSD å’Œç‹¬ç«‹ç¡¬ç›˜ä¹‹é—´éšæœº I/O æ€§èƒ½çš„å·®å¼‚ã€‚è™½ç„¶ SSD åœ¨éšæœº I/O ä¸­è·å¾—æ•°åç”šè‡³æ•°ç™¾ MB/ç§’ï¼Œä½†è¿™ç§â€œé«˜æ€§èƒ½â€ç¡¬ç›˜çš„å³°å€¼ä»…ä¸ºå‡  MB/ç§’ï¼ˆäº‹å®ä¸Šï¼Œæˆ‘ä»¬å››èˆäº”å…¥ä¸º 2 MB/ç§’ï¼‰ ã€‚ å…¶æ¬¡ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ï¼Œå°±é¡ºåºI/Oæ€§èƒ½è€Œè¨€ï¼Œå·®å¼‚è¦å°å¾—å¤šï¼›è™½ç„¶ SSD çš„æ€§èƒ½æ›´å¥½ï¼Œä½†å¦‚æœæ‚¨åªéœ€è¦é¡ºåºI/Oæ€§èƒ½ï¼Œç¡¬ç›˜é©±åŠ¨å™¨ä»ç„¶æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ç¬¬ä¸‰ï¼Œå¯ä»¥çœ‹åˆ°SSDéšæœºè¯»æ€§èƒ½ä¸å¦‚SSDéšæœºå†™æ€§èƒ½ã€‚éšæœºå†™å…¥æ€§èƒ½å¦‚æ­¤å‡ºäººæ„æ–™çš„å¥½ï¼Œå¾—ç›Šäºå¾ˆå¤šSSDçš„æ—¥å¿—ç»“æ„è®¾è®¡ï¼Œå°†éšæœºå†™å…¥è½¬åŒ–ä¸ºé¡ºåºå†™å…¥ï¼Œæé«˜äº†æ€§èƒ½ã€‚ æœ€åï¼Œç”±äº SSD åœ¨é¡ºåº I/O å’Œéšæœº I/O ä¹‹é—´è¡¨ç°å‡ºä¸€äº›æ€§èƒ½å·®å¼‚ï¼Œå› æ­¤å¦‚ä½•ä¸ºç¡¬ç›˜é©±åŠ¨å™¨æ„å»ºæ–‡ä»¶ç³»ç»Ÿçš„è®¸å¤šæŠ€æœ¯ä»ç„¶é€‚ç”¨äº SSDï¼›å°½ç®¡é¡ºåº I/O å’Œéšæœº I/O ä¹‹é—´çš„å·®å¼‚å¹…åº¦è¾ƒå°ï¼Œä½†ä»æœ‰è¶³å¤Ÿçš„å·®è·éœ€è¦ä»”ç»†è€ƒè™‘å¦‚ä½•è®¾è®¡æ–‡ä»¶ç³»ç»Ÿä»¥å‡å°‘éšæœº I/Oã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:8:1","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8.2 æˆæœ¬ æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œå³ä½¿åœ¨æ‰§è¡Œé¡ºåº I/O æ—¶ï¼ŒSSD çš„æ€§èƒ½ä¹Ÿå¤§å¤§è¶…è¿‡äº†ç°ä»£ç¡¬ç›˜é©±åŠ¨å™¨ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆ SSD æ²¡æœ‰å®Œå…¨å–ä»£ç¡¬ç›˜ä½œä¸ºå­˜å‚¨ä»‹è´¨çš„é€‰æ‹©å‘¢ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼šæˆæœ¬ï¼Œæˆ–æ›´å…·ä½“åœ°è¯´ï¼Œæ˜¯æ¯å•ä½å®¹é‡çš„æˆæœ¬ã€‚ç›®å‰ï¼Œ250 GB é©±åŠ¨å™¨çš„ SSD æˆæœ¬çº¦ä¸º 150 ç¾å…ƒï¼›è¿™æ ·çš„ SSD æ¯ GB æˆæœ¬ä¸º 60 ç¾åˆ†ã€‚ä¼ ç»Ÿçš„ç¡¬ç›˜é©±åŠ¨å™¨å­˜å‚¨ 1 TB çš„æˆæœ¬çº¦ä¸º 50 ç¾å…ƒï¼Œè¿™æ„å‘³ç€æ¯ GB æˆæœ¬ä¸º 5 ç¾åˆ†ã€‚è¿™ä¸¤ç§å­˜å‚¨ä»‹è´¨çš„æˆæœ¬ä»ç„¶å­˜åœ¨10å€ä»¥ä¸Šçš„å·®å¼‚ã€‚ è¿™äº›æ€§èƒ½å’Œæˆæœ¬å·®å¼‚å†³å®šäº†å¦‚ä½•æ„å»ºå¤§è§„æ¨¡å­˜å‚¨ç³»ç»Ÿã€‚å¦‚æœæ€§èƒ½æ˜¯ä¸»è¦è€ƒè™‘å› ç´ ï¼Œé‚£ä¹ˆ SSD æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯åœ¨éšæœºè¯»å–æ€§èƒ½å¾ˆé‡è¦çš„æƒ…å†µä¸‹ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæ‚¨æ­£åœ¨ç»„è£…ä¸€ä¸ªå¤§å‹æ•°æ®ä¸­å¿ƒå¹¶å¸Œæœ›å­˜å‚¨å¤§é‡ä¿¡æ¯ï¼Œé‚£ä¹ˆå·¨å¤§çš„æˆæœ¬å·®å¼‚å°†ä¿ƒä½¿æ‚¨è½¬å‘HDDã€‚å½“ç„¶ï¼Œæ··åˆæ–¹æ³•æ˜¯æœ‰æ„ä¹‰çš„â€”â€”ä¸€äº›å­˜å‚¨ç³»ç»ŸåŒæ—¶é…å¤‡äº† SSD å’ŒHDDï¼Œä½¿ç”¨è¾ƒå°‘æ•°é‡çš„ SSD æ¥å­˜å‚¨æ›´å¸¸ç”¨çš„â€œçƒ­â€æ•°æ®å¹¶æä¾›é«˜æ€§èƒ½ï¼ŒåŒæ—¶å­˜å‚¨å…¶ä½™çš„â€œå†·â€æ•°æ®ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ç¡¬ç›˜ä¸Šçš„æ•°æ®ä»¥èŠ‚çœæˆæœ¬ã€‚åªè¦ä»·æ ¼å·®è·å­˜åœ¨ï¼Œç¡¬ç›˜å°±ä¼šä¸€ç›´å­˜åœ¨ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:8:2","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"9 æ€»ç»“ é—ªå­˜èŠ¯ç‰‡ç”±è®¸å¤šå­˜å‚¨ä½“ç»„æˆï¼Œæ¯ä¸ªå­˜å‚¨ä½“éƒ½ç»„ç»‡æˆæ“¦é™¤å—ï¼ˆæœ‰æ—¶ç®€ç§°ä¸ºå—ï¼‰ã€‚æ¯ä¸ªå—è¿›ä¸€æ­¥ç»†åˆ†ä¸ºä¸€å®šæ•°é‡çš„é¡µé¢ã€‚ å—å¾ˆå¤§ï¼ˆ128KBâ€“2MBï¼‰å¹¶åŒ…å«è®¸å¤šé¡µï¼Œè€Œé¡µç›¸å¯¹è¾ƒå°ï¼ˆ1KBâ€“8KBï¼‰ã€‚ è¦ä»é—ªå­˜è¯»å–ï¼Œè¯·å‘å‡ºå¸¦æœ‰åœ°å€å’Œé•¿åº¦çš„è¯»å–å‘½ä»¤ï¼›è¿™å…è®¸å®¢æˆ·è¯»å–ä¸€é¡µæˆ–å¤šé¡µã€‚ å†™å…¥é—ªå­˜æ›´ä¸ºå¤æ‚ã€‚é¦–å…ˆï¼Œå®¢æˆ·ç«¯å¿…é¡»æ“¦é™¤æ•´ä¸ªå—ï¼ˆè¿™ä¼šåˆ é™¤å—å†…çš„æ‰€æœ‰ä¿¡æ¯ï¼‰ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯å¯ä»¥å¯¹æ¯ä¸ªé¡µé¢ç²¾ç¡®åœ°ç¼–ç¨‹ä¸€æ¬¡ï¼Œä»è€Œå®Œæˆå†™å…¥ã€‚ æ–°çš„ä¿®å‰ªæ“ä½œå¯ç”¨äºå‘Šè¯‰è®¾å¤‡ä½•æ—¶ä¸å†éœ€è¦ç‰¹å®šå—ï¼ˆæˆ–å—èŒƒå›´ï¼‰ã€‚ é—ªå­˜å¯é æ€§ä¸»è¦ç”±ç£¨æŸå†³å®šï¼›å¦‚æœä¸€ä¸ªå—è¢«é¢‘ç¹åœ°æ“¦é™¤å’Œç¼–ç¨‹ï¼Œå®ƒå°†å˜å¾—ä¸å¯ç”¨ã€‚ åŸºäºé—ªå­˜çš„å›ºæ€å­˜å‚¨è®¾å¤‡ï¼ˆSSDï¼‰çš„è¡Œä¸ºå°±åƒæ™®é€šçš„åŸºäºå—çš„è¯»/å†™ç£ç›˜ä¸€æ ·ã€‚é€šè¿‡ä½¿ç”¨é—ªå­˜è½¬æ¢å±‚ (FTL)ï¼Œå®ƒå°†å®¢æˆ·ç«¯çš„è¯»å–å’Œå†™å…¥è½¬æ¢ä¸ºå¯¹åº•å±‚é—ªå­˜èŠ¯ç‰‡çš„è¯»å–ã€æ“¦é™¤å’Œç¼–ç¨‹ã€‚ å¤§å¤šæ•°FTL éƒ½æ˜¯æ—¥å¿—ç»“æ„çš„ï¼Œè¿™é€šè¿‡æœ€å°åŒ–æ“¦é™¤/ç¼–ç¨‹å‘¨æœŸæ¥é™ä½å†™å…¥æˆæœ¬ã€‚å†…å­˜ä¸­çš„è½¬æ¢å±‚è·Ÿè¸ªé€»è¾‘å†™å…¥åœ¨ç‰©ç†ä»‹è´¨ä¸­çš„ä½ç½®ã€‚ æ—¥å¿—ç»“æ„FTL çš„ä¸€ä¸ªå…³é”®é—®é¢˜æ˜¯åƒåœ¾å›æ”¶çš„æˆæœ¬ï¼Œè¿™ä¼šå¯¼è‡´å†™å…¥æ”¾å¤§ã€‚ å¦ä¸€ä¸ªé—®é¢˜æ˜¯æ˜ å°„è¡¨çš„å¤§å°ï¼Œå®ƒå¯èƒ½ä¼šå˜å¾—éå¸¸å¤§ã€‚ä½¿ç”¨æ··åˆæ˜ å°„æˆ–ä»…ç¼“å­˜ FTL çš„çƒ­é—¨éƒ¨åˆ†æ˜¯å¯èƒ½çš„è¡¥æ•‘æªæ–½ã€‚ æœ€åä¸€ä¸ªé—®é¢˜æ˜¯ç£¨æŸå‡è¡¡ã€‚ FTL å¿…é¡»å¶å°”ä»ä¸»è¦è¯»å–çš„å—ä¸­è¿ç§»æ•°æ®ï¼Œä»¥ç¡®ä¿æ‰€è¿°å—ä¹Ÿæ¥æ”¶å…¶æ“¦é™¤/ç¼–ç¨‹è´Ÿè½½ä»½é¢ã€‚ ","date":"2024-05-11","objectID":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/:9:0","tags":["OS"],"title":"åŸºäºé—ªå­˜çš„SSD","uri":"/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¼•è¨€ 20 ä¸–çºª 90 å¹´ä»£åˆï¼Œä¼¯å…‹åˆ©åˆ†æ ¡çš„ä¸€ä¸ªç”± John Ousterhout æ•™æˆå’Œç ”ç©¶ç”Ÿ Mendel Rosenblum é¢†å¯¼çš„å°ç»„å¼€å‘äº†ä¸€ç§æ–°çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç§°ä¸ºæ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿã€‚ä»–ä»¬è¿™æ ·åšçš„åŠ¨æœºåŸºäºä»¥ä¸‹è§‚å¯Ÿï¼š ç³»ç»Ÿå†…å­˜ä¸æ–­å¢é•¿ï¼šéšç€å†…å­˜å˜å¤§ï¼Œå†…å­˜ä¸­å¯ä»¥ç¼“å­˜æ›´å¤šæ•°æ®ã€‚éšç€è¶Šæ¥è¶Šå¤šçš„æ•°æ®è¢«ç¼“å­˜ï¼Œç£ç›˜æµé‡è¶Šæ¥è¶Šå¤šåœ°ç”±å†™å…¥ç»„æˆï¼Œå› ä¸ºè¯»å–ç”±ç¼“å­˜æä¾›æœåŠ¡ã€‚å› æ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„æ€§èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå…¶å†™å…¥æ€§èƒ½ã€‚ éšæœºI/O æ€§èƒ½å’Œé¡ºåºI/O æ€§èƒ½ä¹‹é—´å­˜åœ¨å¾ˆå¤§å·®è·ï¼šå¤šå¹´æ¥ç¡¬ç›˜ä¼ è¾“å¸¦å®½å¤§å¹…å¢åŠ ï¼›éšç€æ›´å¤šçš„ä½è¢«å°è£…åˆ°é©±åŠ¨å™¨çš„è¡¨é¢ï¼Œè®¿é—®æ‰€è¿°ä½æ—¶çš„å¸¦å®½å¢åŠ ã€‚ç„¶è€Œï¼Œå¯»é“å’Œæ—‹è½¬å»¶è¿Ÿæˆæœ¬å´ç¼“æ…¢ä¸‹é™ï¼›è®©å»‰ä»·çš„å°å‹ç”µæœºæ›´å¿«åœ°æ—‹è½¬ç›˜ç‰‡æˆ–æ›´å¿«åœ°ç§»åŠ¨ç£ç›˜è‡‚æ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨èƒ½å¤Ÿä»¥é¡ºåºæ–¹å¼ä½¿ç”¨ç£ç›˜ï¼Œé‚£ä¹ˆä¸å¯¼è‡´å¯»é“å’Œæ—‹è½¬çš„æ–¹æ³•ç›¸æ¯”ï¼Œæ‚¨å°†è·å¾—ç›¸å½“å¤§çš„æ€§èƒ½ä¼˜åŠ¿ã€‚ ç°æœ‰æ–‡ä»¶ç³»ç»Ÿåœ¨è®¸å¤šå¸¸è§å·¥ä½œè´Ÿè½½ä¸Šè¡¨ç°ä¸ä½³ï¼šä¾‹å¦‚ï¼ŒFFSå°†æ‰§è¡Œå¤§é‡å†™å…¥æ¥åˆ›å»ºä¸€ä¸ªå¤§å°ä¸ºä¸€ä¸ªå—çš„æ–°æ–‡ä»¶ï¼šä¸€ä¸ªç”¨äºæ–°çš„inodeï¼Œä¸€ä¸ªç”¨äºæ›´æ–°inodeä½å›¾ï¼Œä¸€ä¸ªç”¨äºåŒ…å«è¯¥æ–‡ä»¶çš„ç›®å½•æ•°æ®å—ï¼Œä¸€ä¸ªç”¨äºæ›´æ–°ç›®å½•inodeï¼Œä¸€ä¸ªç”¨äºä½œä¸ºæ–°æ–‡ä»¶ä¸€éƒ¨åˆ†çš„æ–°æ•°æ®å—ï¼Œå¹¶ä¸”è¿˜éœ€è¦å¯¹æ•°æ®ä½å›¾è¿›è¡Œä¸€æ¬¡å†™å…¥ä»¥æ ‡è®°æ•°æ®å—å·²è¢«åˆ†é…ã€‚å› æ­¤ï¼Œå°½ç®¡ FFS å°†æ‰€æœ‰è¿™äº›å—æ”¾ç½®åœ¨åŒä¸€å—ç»„å†…ï¼Œä½† FFS éœ€è¦è¿›è¡Œè®¸å¤šçŸ­å¯»é“å’Œéšåçš„æ—‹è½¬å»¶è¿Ÿï¼Œå› æ­¤æ€§èƒ½è¿œä½äºå³°å€¼é¡ºåºå¸¦å®½ã€‚ æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒRAIDï¼šä¾‹å¦‚ï¼ŒRAID-4 å’ŒRAID-5 éƒ½å­˜åœ¨å°å†™å…¥é—®é¢˜ï¼Œå³å¯¹å•ä¸ªå—çš„é€»è¾‘å†™å…¥ä¼šå¯¼è‡´å‘ç”Ÿ4 ä¸ªç‰©ç†I/Oã€‚ç°æœ‰æ–‡ä»¶ç³»ç»Ÿä¸ä¼šå°è¯•é¿å…è¿™ç§æœ€åæƒ…å†µçš„ RAID å†™å…¥è¡Œä¸ºã€‚ å› æ­¤ï¼Œç†æƒ³çš„æ–‡ä»¶ç³»ç»Ÿå°†å…³æ³¨å†™å…¥æ€§èƒ½ï¼Œå¹¶å°è¯•åˆ©ç”¨ç£ç›˜çš„é¡ºåºå¸¦å®½ã€‚æ­¤å¤–ï¼Œå®ƒåœ¨å¸¸è§å·¥ä½œè´Ÿè½½ä¸Šè¡¨ç°è‰¯å¥½ï¼Œè¿™äº›å·¥ä½œè´Ÿè½½ä¸ä»…å†™å‡ºæ•°æ®ï¼Œè€Œä¸”è¿˜ç»å¸¸æ›´æ–°ç£ç›˜ä¸Šçš„å…ƒæ•°æ®ç»“æ„ã€‚æœ€åï¼Œå®ƒåœ¨ RAID å’Œå•ä¸ªç£ç›˜ä¸Šéƒ½èƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚ Rosenblum å’Œ Ousterhout æ¨å‡ºçš„æ–°å‹æ–‡ä»¶ç³»ç»Ÿç§°ä¸º LFSï¼Œæ˜¯æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿçš„ç¼©å†™ã€‚å½“å†™å…¥ç£ç›˜æ—¶ï¼ŒLFS é¦–å…ˆå°†æ‰€æœ‰æ›´æ–°ï¼ˆåŒ…æ‹¬å…ƒæ•°æ®ï¼ï¼‰ç¼“å†²åœ¨å†…å­˜æ®µä¸­ï¼›å½“è¯¥æ®µå·²æ»¡æ—¶ï¼Œå®ƒä¼šé€šè¿‡ä¸€æ¬¡é•¿çš„ã€é¡ºåºçš„ä¼ è¾“å†™å…¥æœªä½¿ç”¨çš„ç£ç›˜éƒ¨åˆ†ã€‚ LFS æ°¸è¿œä¸ä¼šè¦†ç›–ç°æœ‰æ•°æ®ï¼Œè€Œæ˜¯å§‹ç»ˆå°†æ®µå†™å…¥ç©ºé—²ä½ç½®ã€‚ç”±äºæ®µå¾ˆå¤§ï¼Œå› æ­¤ç£ç›˜ï¼ˆæˆ– RAIDï¼‰å¯ä»¥å¾—åˆ°æœ‰æ•ˆåˆ©ç”¨ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„æ€§èƒ½ä¹Ÿæ¥è¿‘é¡¶å³°ã€‚ å…³é”®ï¼šå¦‚ä½•ä½¿æ‰€æœ‰å†™å…¥é¡ºåºå†™å…¥ï¼Ÿ æ–‡ä»¶ç³»ç»Ÿå¦‚ä½•å°†æ‰€æœ‰å†™å…¥è½¬æ¢ä¸ºé¡ºåºå†™å…¥ï¼Ÿå¯¹äºè¯»å–ï¼Œæ­¤ä»»åŠ¡æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºè¦è¯»å–çš„æ‰€éœ€å—å¯èƒ½ä½äºç£ç›˜ä¸Šçš„ä»»ä½•ä½ç½®ã€‚ç„¶è€Œï¼Œå¯¹äºå†™å…¥ï¼Œæ–‡ä»¶ç³»ç»Ÿæ€»æ˜¯æœ‰ä¸€ä¸ªé€‰æ‹©ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›åˆ©ç”¨çš„æ­£æ˜¯è¿™ä¸ªé€‰æ‹©ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:1:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æŒ‰é¡ºåºå†™å…¥ç£ç›˜ å› æ­¤ï¼Œæˆ‘ä»¬é¢ä¸´çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ï¼šå¦‚ä½•å°†æ–‡ä»¶ç³»ç»ŸçŠ¶æ€çš„æ‰€æœ‰æ›´æ–°è½¬åŒ–ä¸ºä¸€ç³»åˆ—å¯¹ç£ç›˜çš„é¡ºåºå†™å…¥ï¼Ÿä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æ­£åœ¨å‘æ–‡ä»¶å†™å…¥ä¸€ä¸ªæ•°æ®å— Dã€‚å°†æ•°æ®å—å†™å…¥ç£ç›˜å¯èƒ½ä¼šå¯¼è‡´ä»¥ä¸‹ç£ç›˜å¸ƒå±€ï¼ŒD è¢«å†™å…¥ç£ç›˜åœ°å€ A0ï¼š ç„¶è€Œï¼Œå½“ç”¨æˆ·å†™å…¥æ•°æ®å—æ—¶ï¼Œå†™å…¥ç£ç›˜çš„ä¸ä»…æ˜¯æ•°æ®ï¼Œè¿˜æœ‰å…¶ä»–éœ€è¦æ›´æ–°çš„å…ƒæ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹ŸæŠŠæ–‡ä»¶çš„ inode (I) å†™å…¥ç£ç›˜ï¼Œå¹¶è®©å®ƒæŒ‡å‘æ•°æ®å— Dã€‚å†™å…¥ç£ç›˜åï¼Œæ•°æ®å—å’Œ inode çš„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆæ³¨æ„ï¼Œinode çœ‹èµ·æ¥å’Œæ•°æ®å—ä¸€æ ·å¤§ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹å¹¶éå¦‚æ­¤ï¼›åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œæ•°æ®å—çš„å¤§å°ä¸º 4 KBï¼Œè€Œ inode åˆ™å°å¾—å¤šï¼Œçº¦ä¸º 128 å­—èŠ‚ï¼‰ï¼š è¿™ç§ç®€å•åœ°å°†æ‰€æœ‰æ›´æ–°ï¼ˆå¦‚æ•°æ®å—ã€inodes ç­‰ï¼‰æŒ‰é¡ºåºå†™å…¥ç£ç›˜çš„åŸºæœ¬æ€æƒ³æ˜¯ LFS çš„æ ¸å¿ƒã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œä½ å°±æŒæ¡äº†åŸºæœ¬æ€æƒ³ã€‚ä½†æ­£å¦‚æ‰€æœ‰å¤æ‚çš„ç³»ç»Ÿä¸€æ ·ï¼Œç»†èŠ‚å†³å®šæˆè´¥ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 é¡ºåºæœ‰æ•ˆåœ°å†™å…¥ ä¸å¹¸çš„æ˜¯ï¼Œé¡ºåºå†™å…¥ç£ç›˜ï¼ˆå•ç‹¬ï¼‰ä¸è¶³ä»¥ä¿è¯é«˜æ•ˆå†™å…¥ã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ—¶é—´ $T$ å‘åœ°å€ $A$ å†™å…¥ä¸€ä¸ªå—ã€‚ç„¶åæˆ‘ä»¬ç­‰å¾…ä¸€ä¼šå„¿ï¼Œå¹¶åœ¨æ—¶é—´ $T + \\delta$ çš„åœ°å€ $A + 1$ï¼ˆæŒ‰é¡ºåºæ’åˆ—çš„ä¸‹ä¸€ä¸ªå—åœ°å€ï¼‰å†™å…¥ç£ç›˜ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡å†™å…¥ä¹‹é—´ï¼Œç£ç›˜å‘ç”Ÿäº†æ—‹è½¬ï¼›å½“æ‚¨å‘å‡ºç¬¬äºŒæ¬¡å†™å…¥æ—¶ï¼Œå®ƒå°†åœ¨æäº¤ä¹‹å‰ç­‰å¾…å¤§éƒ¨åˆ†æ—‹è½¬ï¼ˆå…·ä½“æ¥è¯´ï¼Œå¦‚æœæ—‹è½¬éœ€è¦æ—¶é—´ $T_{rotation}$ï¼Œåˆ™ç£ç›˜å°†ç­‰å¾… $T_{rotation}-\\delta$ï¼Œç„¶åæ‰èƒ½å°†ç¬¬äºŒæ¬¡å†™å…¥æäº¤åˆ°ç£ç›˜è¡¨é¢ï¼‰ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ï¼Œä»…ä»…æŒ‰é¡ºåºå†™å…¥ç£ç›˜ä¸è¶³ä»¥å®ç°å³°å€¼æ€§èƒ½ï¼›ç›¸åï¼Œæ‚¨å¿…é¡»å‘é©±åŠ¨å™¨å‘å‡ºå¤§é‡è¿ç»­å†™å…¥ï¼ˆæˆ–ä¸€æ¬¡å¤§å‹å†™å…¥ï¼‰æ‰èƒ½è·å¾—è‰¯å¥½çš„å†™å…¥æ€§èƒ½ã€‚ ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼ŒLFS ä½¿ç”¨ä¸€ç§ç§°ä¸ºå†™å…¥ç¼“å†²çš„å¤è€æŠ€æœ¯ã€‚åœ¨å†™å…¥ç£ç›˜ä¹‹å‰ï¼ŒLFS ä¼šè·Ÿè¸ªå†…å­˜ä¸­çš„æ›´æ–°ï¼›å½“å®ƒæ”¶åˆ°è¶³å¤Ÿæ•°é‡çš„æ›´æ–°æ—¶ï¼Œå®ƒä¼šç«‹å³å°†å®ƒä»¬å…¨éƒ¨å†™å…¥ç£ç›˜ï¼Œä»è€Œç¡®ä¿ç£ç›˜çš„æœ‰æ•ˆä½¿ç”¨ã€‚ LFS ä¸€æ¬¡å†™å…¥çš„å¤§å—æ›´æ–°è¢«ç§°ä¸ºä¸€ä¸ªæ®µã€‚å°½ç®¡è¿™ä¸ªæœ¯è¯­åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­è¢«æ»¥ç”¨ï¼Œä½†åœ¨è¿™é‡Œå®ƒåªæ˜¯æŒ‡ LFS ç”¨æ¥åˆ†ç»„å†™å…¥çš„ä¸€ä¸ªç›¸å¯¹è¾ƒå¤§çš„å—ã€‚å› æ­¤ï¼Œå½“å†™å…¥ç£ç›˜æ—¶ï¼ŒLFS å°†æ›´æ–°ç¼“å†²åœ¨å†…å­˜ä¸­çš„æ®µä¸­ï¼Œç„¶åå°†è¯¥æ®µå…¨éƒ¨å†™å…¥ç£ç›˜ã€‚åªè¦æ®µè¶³å¤Ÿå¤§ï¼Œè¿™äº›å†™å…¥å°±ä¼šé«˜æ•ˆã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå…¶ä¸­ LFS å°†ä¸¤ç»„æ›´æ–°ç¼“å†²åˆ°ä¸€ä¸ªå°æ®µä¸­ï¼›å®é™…çš„æ®µæ›´å¤§ï¼ˆå‡ MBï¼‰ã€‚ç¬¬ä¸€ä¸ªæ›´æ–°æ˜¯å¯¹æ–‡ä»¶ j çš„å››ä¸ªå—å†™å…¥ï¼›ç¬¬äºŒä¸ªæ˜¯å‘æ–‡ä»¶ k æ·»åŠ ä¸€ä¸ªå—ã€‚ç„¶åï¼ŒLFS å°†ä¸ƒä¸ªå—çš„æ•´ä¸ªæ®µä¸€æ¬¡æ€§æäº¤åˆ°ç£ç›˜ã€‚è¿™äº›å—çš„æœ€ç»ˆç£ç›˜å¸ƒå±€å¦‚ä¸‹ï¼š ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 ç¼“å†²å¤šå¤§ è¿™å°±æå‡ºäº†ä»¥ä¸‹é—®é¢˜ï¼šåœ¨å†™å…¥ç£ç›˜ä¹‹å‰ï¼ŒLFS åº”è¯¥ç¼“å†²å¤šå°‘ä¸ªæ›´æ–°ï¼Ÿå½“ç„¶ï¼Œç­”æ¡ˆå–å†³äºç£ç›˜æœ¬èº«ï¼Œç‰¹åˆ«æ˜¯å®šä½å¼€é”€ä¸ä¼ è¾“é€Ÿç‡ç›¸æ¯”æœ‰å¤šé«˜ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æ¯æ¬¡å†™å…¥ä¹‹å‰çš„å®šä½ï¼ˆå³æ—‹è½¬å’Œå¯»é“å¼€é”€ï¼‰å¤§çº¦éœ€è¦ $T_{position}$ç§’ã€‚è¿›ä¸€æ­¥å‡è®¾ç£ç›˜ä¼ è¾“é€Ÿç‡ä¸º$R_{peak}\\text{ MB/s}$ã€‚åœ¨è¿™æ ·çš„ç£ç›˜ä¸Šè¿è¡Œæ—¶ï¼ŒLFS åœ¨å†™å…¥ä¹‹å‰åº”è¯¥ç¼“å†²å¤šå°‘ï¼Ÿ æ€è€ƒè¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯ï¼Œæ¯æ¬¡å†™å…¥æ—¶ï¼Œæ‚¨éƒ½ä¼šä»˜å‡ºå›ºå®šçš„å®šä½æˆæœ¬å¼€é”€ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦å†™å¤šå°‘æ‰èƒ½æ‘Šé”€è¯¥æˆæœ¬ï¼Ÿä½ å†™çš„è¶Šå¤šè¶Šå¥½ï¼ˆæ˜¾ç„¶ï¼‰ï¼Œå¹¶ä¸”ä½ è¶Šæ¥è¿‘è¾¾åˆ°å³°å€¼å¸¦å®½ã€‚ ä¸ºäº†è·å¾—å…·ä½“çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æ­£åœ¨å†™ $D\\text{ MB}$ã€‚å†™è¿™å—æ•°æ®çš„æ—¶é—´ï¼ˆ$T_{write}$ï¼‰æ˜¯å®šä½æ—¶é—´$T_{position}$åŠ ä¸Šä¼ è¾“æ—¶é—´$\\frac{D}{R_{peak}}$ï¼Œæˆ–è€…ï¼š $$ T_{write}=T_{position}+\\frac{D}{R_{peak}} $$ å› æ­¤ï¼Œæœ‰æ•ˆå†™å…¥ç‡ï¼ˆ$R_{effective}$ï¼‰å°±æ˜¯å†™å…¥çš„æ•°æ®é‡é™¤ä»¥å†™å…¥çš„æ€»æ—¶é—´ï¼š $$ R_{effective}=\\frac{D}{T_{write}}=\\frac{D}{T_{position}+\\frac{D}{R_{peak}}} $$ æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯è®©æœ‰æ•ˆç‡ ($R_{effective}$) æ¥è¿‘å³°å€¼ç‡ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰æ•ˆé€Ÿç‡æ˜¯å³°å€¼é€Ÿç‡çš„æŸä¸ªåˆ†æ•° $F$ï¼Œå…¶ä¸­ $0 \u003c F \u003c 1$ï¼ˆå…¸å‹çš„ F å¯èƒ½æ˜¯ $0.9$ï¼Œæˆ–å³°å€¼é€Ÿç‡çš„ $90%$ï¼‰ã€‚åœ¨æ•°å­¦å½¢å¼ä¸Šï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦$R_{effective}=F\\times R_{peak}$ ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚è§£$D$ï¼š $$ R_{effective}=\\frac{D}{T_{write}}=\\frac{D}{T_{position}+\\frac{D}{R_{peak}}} $$ $$ D=F\\times R_{peak}\\times(T_{position}+\\frac{D}{R_{peak}}) $$ $$ D=(F\\times R_{peak}\\times T_{position})+(F\\times R_{peak}\\times \\frac{D}{R_{peak}}) $$ $$ D=\\frac{F}{1-F}\\times R_{peak}\\times T_{position} $$ ä¸¾ä¸ªä¾‹å­ï¼Œç£ç›˜çš„å®šä½æ—¶é—´ä¸º$10\\text{ ms}$ï¼Œå³°å€¼ä¼ è¾“ç‡ä¸º$100\\text{ MB/s}$ï¼›å‡è®¾æˆ‘ä»¬æƒ³è¦å³°å€¼çš„ $90%$ çš„æœ‰æ•ˆå¸¦å®½ ($F = 0.9$)ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ$D = \\frac{0.9}{0.1}\\times 100\\text{ MB/s} \\times 0.01 \\text{ s} = 9\\text{ MB}$ã€‚å°è¯•ä¸€äº›ä¸åŒçš„å€¼ï¼Œçœ‹çœ‹æˆ‘ä»¬éœ€è¦ç¼“å†²å¤šå°‘æ‰èƒ½æ¥è¿‘å³°å€¼å¸¦å®½ã€‚éœ€è¦å¤šå°‘æ‰èƒ½è¾¾åˆ°å³°å€¼çš„ $95%$ï¼Ÿ $99%$ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:4:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 é—®é¢˜ï¼šæŸ¥æ‰¾ Inode ä¸ºäº†äº†è§£å¦‚ä½•åœ¨ LFS ä¸­æŸ¥æ‰¾ inodeï¼Œè®©æˆ‘ä»¬ç®€è¦å›é¡¾ä¸€ä¸‹å¦‚ä½•åœ¨å…¸å‹çš„ UNIX æ–‡ä»¶ç³»ç»Ÿä¸­æŸ¥æ‰¾ inodeã€‚åœ¨å…¸å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆä¾‹å¦‚ FFSï¼‰ç”šè‡³æ—§çš„ UNIX æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒæŸ¥æ‰¾ inode å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒä»¬è¢«ç»„ç»‡åœ¨æ•°ç»„ä¸­å¹¶æ”¾ç½®åœ¨ç£ç›˜ä¸Šçš„å›ºå®šä½ç½®ã€‚ ä¾‹å¦‚ï¼Œæ—§çš„ UNIX æ–‡ä»¶ç³»ç»Ÿå°†æ‰€æœ‰inodeä¿å­˜åœ¨ç£ç›˜çš„å›ºå®šéƒ¨åˆ†ã€‚å› æ­¤ï¼Œç»™å®š inode numberå’Œèµ·å§‹åœ°å€ï¼Œè¦æŸ¥æ‰¾ç‰¹å®š inodeï¼Œåªéœ€å°† inode numberä¹˜ä»¥ inode çš„å¤§å°ï¼Œç„¶åå°†å…¶æ·»åŠ åˆ°ç£ç›˜é˜µåˆ—çš„èµ·å§‹åœ°å€ï¼Œå³å¯è®¡ç®—å‡ºå…¶å‡†ç¡®çš„ç£ç›˜åœ°å€ã€‚ åŸºäºæ•°ç»„çš„ç´¢å¼•ï¼ˆç»™å®š inode numberï¼‰æ—¢å¿«é€Ÿåˆç®€å•ã€‚ åœ¨ FFS ä¸­æŸ¥æ‰¾ç»™å®š inode numberçš„ inode åªæ˜¯ç¨å¾®å¤æ‚ä¸€äº›ï¼Œå› ä¸º FFS å°† inode è¡¨åˆ†å‰²æˆå—ï¼Œå¹¶å°†ä¸€ç»„ inode æ”¾ç½®åœ¨æ¯ä¸ªæŸ±é¢ç»„ä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“æ¯ä¸ªinodeå—æœ‰å¤šå¤§ä»¥åŠæ¯ä¸ªinodeçš„èµ·å§‹åœ°å€ã€‚ä¹‹åçš„è®¡ç®—ç±»ä¼¼ï¼Œä¹Ÿå¾ˆå®¹æ˜“ã€‚ åœ¨LFSï¼Œç”Ÿæ´»æ›´åŠ å›°éš¾ã€‚ä¸ºä»€ä¹ˆï¼Ÿå¥½å§ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåœ°å°†inodeåˆ†æ•£åœ¨æ•´ä¸ªç£ç›˜ä¸Šï¼æ›´ç³Ÿç³•çš„æ˜¯ï¼Œæˆ‘ä»¬æ°¸è¿œä¸ä¼šå°±åœ°è¦†ç›–ï¼Œå› æ­¤æœ€æ–°ç‰ˆæœ¬çš„ç´¢å¼•èŠ‚ç‚¹ï¼ˆå³æˆ‘ä»¬æƒ³è¦çš„ï¼‰ä¸æ–­ç§»åŠ¨ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:5:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 é€šè¿‡é—´æ¥è§£å†³æ–¹æ¡ˆï¼šInode Map ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒLFS çš„è®¾è®¡è€…é€šè¿‡ä¸€ä¸ªåä¸º inode mapï¼ˆimapï¼‰çš„æ•°æ®ç»“æ„ï¼Œåœ¨ inode numberå’Œ inode ä¹‹é—´å¼•å…¥äº†ä¸€å±‚é—´æ¥å…³ç³»ã€‚imap æ˜¯ä¸€ç§å°† inode numberä½œä¸ºè¾“å…¥å¹¶ç”Ÿæˆè¯¥ inode æœ€æ–°ç‰ˆæœ¬ç£ç›˜åœ°å€çš„ç»“æ„ã€‚å› æ­¤ï¼Œå¯ä»¥æƒ³è±¡å®ƒé€šå¸¸æ˜¯ä½œä¸ºä¸€ä¸ªç®€å•çš„æ•°ç»„æ¥å®ç°çš„ï¼Œæ¯ä¸ªæ¡ç›®æœ‰ 4 ä¸ªå­—èŠ‚ï¼ˆç£ç›˜æŒ‡é’ˆï¼‰ã€‚å½“ inode è¢«å†™å…¥ç£ç›˜æ—¶ï¼Œimap å°±ä¼šæ ¹æ®æ–°çš„ä½ç½®è¿›è¡Œæ›´æ–°ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œimap éœ€è¦ä¿æŒæŒä¹…æ€§ï¼ˆå³å†™å…¥ç£ç›˜ï¼‰ï¼Œè¿™æ ·åšå¯ä»¥è®© LFS åœ¨å´©æºƒæ—¶è·Ÿè¸ª inode çš„ä½ç½®ï¼Œä»è€ŒæŒ‰é¢„æœŸè¿è¡Œã€‚å› æ­¤ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šimap åº”è¯¥æ”¾åœ¨ç£ç›˜çš„å“ªä¸ªä½ç½®ï¼Ÿ å½“ç„¶ï¼Œå®ƒå¯ä»¥ä½äºç£ç›˜çš„å›ºå®šä½ç½®ã€‚é—æ†¾çš„æ˜¯ï¼Œç”±äºå®ƒç»å¸¸æ›´æ–°ï¼Œè¿™å°±éœ€è¦åœ¨æ›´æ–°æ–‡ä»¶ç»“æ„åå†å†™å…¥ imapï¼Œå› æ­¤æ€§èƒ½ä¼šå—åˆ°å½±å“ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ¯æ¬¡æ›´æ–°å’Œ imap çš„å›ºå®šä½ç½®ä¹‹é—´ä¼šæœ‰æ›´å¤šçš„ç£ç›˜å¯»é“ï¼‰ã€‚ ç›¸åï¼ŒLFS ä¼šåœ¨å†™å…¥æ‰€æœ‰å…¶ä»–æ–°ä¿¡æ¯çš„ä½ç½®æ—è¾¹æ”¾ç½® inode æ˜ å°„å—ã€‚å› æ­¤ï¼Œåœ¨å‘æ–‡ä»¶ k æ·»åŠ æ•°æ®å—æ—¶ï¼ŒLFS å®é™…ä¸Šæ˜¯å°†æ–°æ•°æ®å—ã€å…¶ inode å’Œ inode æ˜ å°„çš„ä¸€éƒ¨åˆ†ä¸€èµ·å†™å…¥ç£ç›˜ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š åœ¨è¿™å¼ å›¾ä¸­ï¼Œå­˜å‚¨åœ¨æ ‡è®°ä¸º imap çš„å—ä¸­çš„ imap æ•°ç»„çš„ä¸€å—å‘Šè¯‰ LFS inode k ä½äºç£ç›˜åœ°å€ A1ï¼›è¿™ä¸ª inode åˆå‘Šè¯‰ LFS å®ƒçš„æ•°æ®å— D ä½äºåœ°å€ A0ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:6:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 å®Œæˆè§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ç‚¹åŒºåŸŸ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:7:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.1 å¦‚ä½•æ‰¾åˆ°inode map ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°è¿™é‡Œçš„é—®é¢˜äº†ã€‚æ—¢ç„¶inode mapçš„å„ä¸ªéƒ¨åˆ†ä¹Ÿåˆ†å¸ƒåœ¨ç£ç›˜ä¸Šï¼Œæˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°inode mapå‘¢ï¼Ÿå½’æ ¹ç»“åº•ï¼Œæ²¡æœ‰ä»€ä¹ˆç¥å¥‡çš„ï¼šæ–‡ä»¶ç³»ç»Ÿå¿…é¡»åœ¨ç£ç›˜ä¸Šæœ‰ä¸€äº›å›ºå®šä¸”å·²çŸ¥çš„ä½ç½®æ‰èƒ½å¼€å§‹æ–‡ä»¶æŸ¥æ‰¾ã€‚ LFS åœ¨ç£ç›˜ä¸Šä¸ºæ­¤æä¾›äº†ä¸€ä¸ªå›ºå®šä½ç½®ï¼Œç§°ä¸ºæ£€æŸ¥ç‚¹åŒºåŸŸ (CR)ã€‚æ£€æŸ¥ç‚¹åŒºåŸŸåŒ…å«æŒ‡å‘æœ€æ–°çš„ inode mapç‰‡æ®µçš„æŒ‡é’ˆï¼ˆå³åœ°å€ï¼‰ï¼Œå› æ­¤å¯ä»¥é€šè¿‡é¦–å…ˆè¯»å– CR æ¥æ‰¾åˆ° inode mapç‰‡æ®µã€‚è¯·æ³¨æ„ï¼Œæ£€æŸ¥ç‚¹åŒºåŸŸä»…å®šæœŸæ›´æ–°ï¼ˆä¾‹å¦‚æ¯ 30 ç§’å·¦å³ï¼‰ï¼Œå› æ­¤æ€§èƒ½ä¸ä¼šå—åˆ°ä¸è‰¯å½±å“ã€‚å› æ­¤ï¼Œç£ç›˜å¸ƒå±€çš„æ•´ä½“ç»“æ„åŒ…å«ä¸€ä¸ªæ£€æŸ¥ç‚¹åŒºåŸŸï¼ˆæŒ‡å‘ inode mapçš„æœ€æ–°éƒ¨åˆ†ï¼‰ï¼›æ¯ä¸ª inode æ˜ å°„ç‰‡æ®µéƒ½åŒ…å« inode çš„åœ°å€ï¼› inode æŒ‡å‘æ–‡ä»¶ï¼ˆå’Œç›®å½•ï¼‰ï¼Œå°±åƒå…¸å‹çš„ UNIX æ–‡ä»¶ç³»ç»Ÿä¸€æ ·ã€‚ ä¸‹é¢æ˜¯æ£€æŸ¥ç‚¹åŒºåŸŸï¼ˆæ³¨æ„å®ƒä½äºç£ç›˜çš„èµ·å§‹ä½ç½®ï¼Œåœ°å€ä¸º 0ï¼‰ä»¥åŠå•ä¸ª imap å—ã€inode å’Œæ•°æ®å—çš„ç¤ºä¾‹ã€‚ä¸€ä¸ªçœŸæ­£çš„æ–‡ä»¶ç³»ç»Ÿå½“ç„¶ä¼šæœ‰ä¸€ä¸ªå¤§å¾—å¤šçš„ CRï¼ˆäº‹å®ä¸Šï¼Œå®ƒä¼šæœ‰ä¸¤ä¸ªï¼Œæˆ‘ä»¬ç¨åä¼šäº†è§£åˆ°ï¼‰ã€è®¸å¤š imap å—ï¼Œå½“ç„¶è¿˜æœ‰æ›´å¤šçš„ inodeã€æ•°æ®å—ç­‰ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:7:1","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.2 ä»ç£ç›˜è¯»å–æ–‡ä»¶ ä¸ºäº†ç¡®ä¿ä½ ç†è§£ LFS çš„å·¥ä½œåŸç†ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä»ç£ç›˜è¯»å–æ–‡ä»¶çš„è¿‡ç¨‹ã€‚å‡è®¾å†…å­˜ä¸­ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚æˆ‘ä»¬å¿…é¡»è¯»å–çš„ç¬¬ä¸€ä¸ªç£ç›˜æ•°æ®ç»“æ„æ˜¯æ£€æŸ¥ç‚¹åŒºåŸŸã€‚æ£€æŸ¥ç‚¹åŒºåŸŸåŒ…å«æŒ‡å‘æ•´ä¸ª inode mapçš„æŒ‡é’ˆï¼ˆå³ç£ç›˜åœ°å€ï¼‰ï¼Œå› æ­¤ LFS ä¼šè¯»å…¥æ•´ä¸ª inode mapå¹¶ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚åœ¨æ­¤ä¹‹åï¼Œå½“å¾—åˆ°æ–‡ä»¶çš„ inode numberæ—¶ï¼ŒLFS åªéœ€åœ¨ imap ä¸­æŸ¥æ‰¾ inode numberåˆ° inodeç£ç›˜åœ°å€çš„æ˜ å°„ï¼Œç„¶åè¯»å…¥æœ€æ–°ç‰ˆæœ¬çš„ inodeã€‚ æ­¤æ—¶ï¼ŒLFS ä¼šæ ¹æ®éœ€è¦ä½¿ç”¨ç›´æ¥æŒ‡é’ˆã€é—´æ¥æŒ‡é’ˆæˆ–åŒå‘é—´æ¥æŒ‡é’ˆï¼Œå®Œå…¨æŒ‰ç…§å…¸å‹ UNIX æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼è¯»å–æ–‡ä»¶å—ã€‚åœ¨æ™®é€šæƒ…å†µä¸‹ï¼ŒLFS ä»ç£ç›˜è¯»å–æ–‡ä»¶æ—¶æ‰§è¡Œçš„ I/O æ¬¡æ•°åº”ä¸å…¸å‹æ–‡ä»¶ç³»ç»Ÿç›¸åŒï¼›æ•´ä¸ª imap å·²è¢«ç¼“å­˜ï¼Œå› æ­¤ LFS åœ¨è¯»å–è¿‡ç¨‹ä¸­æ‰€åšçš„é¢å¤–å·¥ä½œå°±æ˜¯åœ¨ imap ä¸­æŸ¥æ‰¾ inode çš„åœ°å€ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:7:2","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.3 å…³äºç›®å½• åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»é€šè¿‡ä»…è€ƒè™‘inodeå’Œæ•°æ®å—æ¥ç®€åŒ–äº†æˆ‘ä»¬çš„è®¨è®ºã€‚ä½†æ˜¯ï¼Œè¦è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚ /home/zfhe/fooï¼‰ï¼Œè¿˜å¿…é¡»è®¿é—®æŸäº›ç›®å½•ã€‚é‚£ä¹ˆLFSæ˜¯å¦‚ä½•å­˜å‚¨ç›®å½•æ•°æ®çš„å‘¢ï¼Ÿ å¹¸è¿çš„æ˜¯ï¼Œç›®å½•ç»“æ„ä¸ç»å…¸ UNIX æ–‡ä»¶ç³»ç»ŸåŸºæœ¬ç›¸åŒï¼Œå› ä¸ºç›®å½•åªæ˜¯ï¼ˆåç§°ã€inode numberï¼‰æ˜ å°„çš„é›†åˆã€‚ä¾‹å¦‚ï¼Œå½“åœ¨ç£ç›˜ä¸Šåˆ›å»ºæ–‡ä»¶æ—¶ï¼ŒLFS å¿…é¡»å†™å…¥æ–°çš„ inodeã€ä¸€äº›æ•°æ®ä»¥åŠå¼•ç”¨è¯¥æ–‡ä»¶çš„ç›®å½•æ•°æ®åŠå…¶ inodeã€‚è¯·è®°ä½ï¼ŒLFS å°†åœ¨ç£ç›˜ä¸ŠæŒ‰é¡ºåºæ‰§è¡Œæ­¤æ“ä½œï¼ˆåœ¨ç¼“å†²æ›´æ–°ä¸€æ®µæ—¶é—´åï¼‰ã€‚å› æ­¤ï¼Œåœ¨ç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶foo å°†å¯¼è‡´ç£ç›˜ä¸Šå‡ºç°ä»¥ä¸‹æ–°ç»“æ„ï¼š inode mapçš„ç‰‡æ®µåŒ…å«ç›®å½•æ–‡ä»¶ dir ä»¥åŠæ–°åˆ›å»ºçš„æ–‡ä»¶ f çš„ä½ç½®ä¿¡æ¯ã€‚å› æ­¤ï¼Œå½“è®¿é—®æ–‡ä»¶ foo ï¼ˆinode numberä¸º $k$ï¼‰æ—¶ï¼Œæ‚¨é¦–å…ˆä¼šåœ¨inode mapï¼ˆé€šå¸¸ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼‰ä¸­æŸ¥æ‰¾ç›®å½• dir ($A3$) çš„inodeçš„ä½ç½®ï¼›ç„¶åè¯»å–ç›®å½• inodeï¼Œå®ƒç»™å‡ºç›®å½•æ•°æ®çš„ä½ç½® ($A2$)ï¼›è¯»å–æ­¤æ•°æ®å—å³å¯è·å¾— (foo, k) çš„åç§°åˆ° inode numberçš„æ˜ å°„ã€‚ç„¶åå†æ¬¡æŸ¥é˜…inode mapï¼Œæ‰¾åˆ°inode number kï¼ˆ$A1$ï¼‰çš„ä½ç½®ï¼Œæœ€ååœ¨åœ°å€$A0$å¤„è¯»å–æ‰€éœ€çš„æ•°æ®å—ã€‚ LFS ä¸­ inode æ˜ å°„è¿˜è§£å†³äº†å¦ä¸€ä¸ªä¸¥é‡é—®é¢˜ï¼Œç§°ä¸ºé€’å½’æ›´æ–°é—®é¢˜ã€‚ä»»ä½•ä»ä¸å°±åœ°æ›´æ–°ï¼ˆä¾‹å¦‚ LFSï¼‰ï¼Œè€Œæ˜¯å°†æ›´æ–°ç§»åŠ¨åˆ°ç£ç›˜ä¸Šçš„æ–°ä½ç½®çš„æ–‡ä»¶ç³»ç»Ÿéƒ½ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚ å…·ä½“æ¥è¯´ï¼Œæ¯å½“æ›´æ–°inodeæ—¶ï¼Œå®ƒåœ¨ç£ç›˜ä¸Šçš„ä½ç½®å°±ä¼šå‘ç”Ÿå˜åŒ–ã€‚å¦‚æœæˆ‘ä»¬ä¸å°å¿ƒçš„è¯ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´æŒ‡å‘è¯¥æ–‡ä»¶çš„ç›®å½•çš„æ›´æ–°ï¼Œç„¶åä¼šå¼ºåˆ¶è¦æ±‚æ›´æ”¹è¯¥ç›®å½•çš„çˆ¶ç›®å½•ï¼Œä¾æ­¤ç±»æ¨ï¼Œä¸€ç›´æ²¿ç€æ–‡ä»¶ç³»ç»Ÿæ ‘å‘ä¸Šæ›´æ–°ã€‚ LFSé€šè¿‡inode mapå·§å¦™åœ°é¿å…äº†è¿™ä¸ªé—®é¢˜ã€‚å°½ç®¡inodeçš„ä½ç½®å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä½†è¿™ç§å˜åŒ–æ°¸è¿œä¸ä¼šåæ˜ åœ¨ç›®å½•æœ¬èº«ä¸­ï¼›ç›¸åï¼Œå½“ç›®å½•ä¿å­˜ç›¸åŒçš„åç§°åˆ°inode numberæ˜ å°„æ—¶ï¼Œimap ç»“æ„ä¼šè¢«æ›´æ–°ã€‚å› æ­¤ï¼Œé€šè¿‡é—´æ¥ï¼ŒLFS é¿å…äº†é€’å½’æ›´æ–°é—®é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:7:3","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 æ–°é—®é¢˜ï¼šåƒåœ¾å›æ”¶ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:8:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8.1 åŸºæœ¬ä»‹ç» æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ° LFS çš„å¦ä¸€ä¸ªé—®é¢˜ï¼›å®ƒå°†æ–‡ä»¶çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬å…¶inodeå’Œæ•°æ®ï¼‰é‡å¤å†™å…¥ç£ç›˜ä¸Šçš„æ–°ä½ç½®ã€‚æ­¤è¿‡ç¨‹åœ¨ä¿æŒå†™å…¥æ•ˆç‡çš„åŒæ—¶ï¼Œæ„å‘³ç€ LFS ä¼šå°†æ—§ç‰ˆæœ¬çš„æ–‡ä»¶ç»“æ„åˆ†æ•£åœ¨æ•´ä¸ªç£ç›˜ä¸Šã€‚æˆ‘ä»¬ç§°è¿™äº›æ—§ç‰ˆæœ¬ä¸ºåƒåœ¾ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”±inode number $k$ å¼•ç”¨çš„ç°æœ‰æ–‡ä»¶ï¼Œå®ƒæŒ‡å‘å•ä¸ªæ•°æ®å— $D0$ã€‚æˆ‘ä»¬ç°åœ¨æ›´æ–°è¯¥å—ï¼Œç”Ÿæˆæ–°çš„inodeå’Œæ–°çš„æ•°æ®å—ã€‚ LFS çš„æœ€ç»ˆç£ç›˜å¸ƒå±€çœ‹èµ·æ¥åƒè¿™æ ·ï¼ˆæ³¨æ„ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬çœç•¥äº† imap å’Œå…¶ä»–ç»“æ„ï¼›æ–°çš„ imap å—ä¹Ÿå¿…é¡»å†™å…¥ç£ç›˜ä»¥æŒ‡å‘æ–°çš„ inodeï¼‰ï¼š åœ¨å›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ç£ç›˜ä¸Šçš„inodeå’Œæ•°æ®å—éƒ½æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯æ—§ç‰ˆæœ¬ï¼ˆå·¦ä¾§ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯å½“å‰çš„ã€å³æ—¶çš„ç‰ˆæœ¬ï¼ˆå³ä¾§ï¼‰ã€‚é€šè¿‡ï¼ˆé€»è¾‘ä¸Šï¼‰æ›´æ–°æ•°æ®å—è¿™ä¸€ç®€å•è¡Œä¸ºï¼ŒLFS å¿…é¡»æŒä¹…åŒ–å¤§é‡æ–°ç»“æ„ï¼Œä»è€Œåœ¨ç£ç›˜ä¸Šç•™ä¸‹æ—§ç‰ˆæœ¬çš„æ•°æ®å—ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæƒ³è±¡æˆ‘ä»¬å°†ä¸€ä¸ªå—é™„åŠ åˆ°åŸå§‹æ–‡ä»¶ k ä¸Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šç”Ÿæˆæ–°ç‰ˆæœ¬çš„ inodeï¼Œä½†æ—§æ•°æ®å—ä»ç”± inode æŒ‡å‘ã€‚å› æ­¤å®ƒä»ç„¶æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å®Œå…¨å±äºå½“å‰æ–‡ä»¶ç³»ç»Ÿï¼š é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•å¤„ç†è¿™äº›æ—§ç‰ˆæœ¬çš„inodeã€æ•°æ®å—ç­‰å‘¢ï¼Ÿå¯ä»¥ä¿ç•™è¿™äº›æ—§ç‰ˆæœ¬å¹¶å…è®¸ç”¨æˆ·æ¢å¤æ—§æ–‡ä»¶ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ï¼Œå½“ä»–ä»¬ä¸å°å¿ƒè¦†ç›–æˆ–åˆ é™¤æ–‡ä»¶æ—¶ï¼Œè¿™æ ·åšå¯èƒ½éå¸¸æ–¹ä¾¿ï¼‰ï¼›è¿™ç§æ–‡ä»¶ç³»ç»Ÿç§°ä¸ºç‰ˆæœ¬æ§åˆ¶æ–‡ä»¶ç³»ç»Ÿï¼Œå› ä¸ºå®ƒè·Ÿè¸ªæ–‡ä»¶çš„ä¸åŒç‰ˆæœ¬ã€‚ ç„¶è€Œï¼ŒLFS ä»…ä¿ç•™æ–‡ä»¶çš„æœ€æ–°å®æ—¶ç‰ˆæœ¬ï¼›å› æ­¤ï¼ˆåœ¨åå°ï¼‰ï¼ŒLFS å¿…é¡»å®šæœŸæŸ¥æ‰¾æ–‡ä»¶æ•°æ®ã€inodeå’Œå…¶ä»–ç»“æ„çš„è¿™äº›æ—§çš„æ— æ•ˆç‰ˆæœ¬ï¼Œå¹¶æ¸…ç†å®ƒä»¬ï¼›å› æ­¤ï¼Œæ¸…ç†åº”è¯¥ä½¿ç£ç›˜ä¸Šçš„å—å†æ¬¡ç©ºé—²ä»¥ä¾›åç»­å†™å…¥ä½¿ç”¨ã€‚è¯·æ³¨æ„ï¼Œæ¸…ç†è¿‡ç¨‹æ˜¯åƒåœ¾å›æ”¶çš„ä¸€ç§å½¢å¼ï¼Œè¿™æ˜¯ç¼–ç¨‹è¯­è¨€ä¸­å‡ºç°çš„ä¸€ç§æŠ€æœ¯ï¼Œå¯ä»¥è‡ªåŠ¨é‡Šæ”¾ç¨‹åºæœªä½¿ç”¨çš„å†…å­˜ã€‚ å‰é¢æˆ‘ä»¬è®¨è®ºäº†æ®µçš„é‡è¦æ€§ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨ LFS ä¸­å®ç°å¯¹ç£ç›˜è¿›è¡Œå¤§é‡å†™å…¥çš„æœºåˆ¶ã€‚äº‹å®è¯æ˜ï¼Œå®ƒä»¬å¯¹äºæœ‰æ•ˆæ¸…ç†ä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœ LFS æ¸…ç†å™¨åœ¨æ¸…ç†è¿‡ç¨‹ä¸­ç®€å•åœ°éå†å¹¶é‡Šæ”¾å•ä¸ªæ•°æ®å—ã€inodeç­‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚ç»“æœï¼šæ–‡ä»¶ç³»ç»Ÿåœ¨ç£ç›˜ä¸Šåˆ†é…çš„ç©ºé—´ä¹‹é—´æ··åˆäº†ä¸€å®šæ•°é‡çš„ç©ºé—²å­”ã€‚å†™å…¥æ€§èƒ½å°†å¤§å¹…ä¸‹é™ï¼Œå› ä¸º LFS æ— æ³•æ‰¾åˆ°å¤§çš„è¿ç»­åŒºåŸŸæ¥é¡ºåºä¸”é«˜æ€§èƒ½åœ°å†™å…¥ç£ç›˜ã€‚ ç›¸åï¼ŒLFS æ¸…ç†å™¨é€æ®µå·¥ä½œï¼Œä»è€Œä¸ºåç»­å†™å…¥æ¸…ç†å¤§å—ç©ºé—´ã€‚åŸºæœ¬æ¸…ç†è¿‡ç¨‹å¦‚ä¸‹ã€‚ LFS æ¸…ç†å™¨å®šæœŸè¯»å–ä¸€äº›æ—§çš„ï¼ˆéƒ¨åˆ†ä½¿ç”¨çš„ï¼‰æ®µï¼Œç¡®å®šè¿™äº›æ®µä¸­å“ªäº›å—æ˜¯æœ‰æ•ˆçš„ï¼Œç„¶åå†™å‡ºä¸€ç»„æ–°çš„æ®µï¼Œå…¶ä¸­ä»…åŒ…å«æœ‰æ•ˆçš„å—ï¼Œä»è€Œé‡Šæ”¾æ—§çš„æ®µä»¥ä¾›å†™å…¥ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬æœŸæœ›æ¸…ç†ç¨‹åºè¯»å– $M$ ä¸ªç°æœ‰æ®µï¼Œå°†å…¶å†…å®¹å‹ç¼©ä¸º $N$ ä¸ªæ–°æ®µï¼ˆå…¶ä¸­ $N \u003c M$ ï¼‰ï¼Œç„¶åå°† $N$ ä¸ªæ®µå†™å…¥ç£ç›˜çš„æ–°ä½ç½®ã€‚ç„¶åï¼Œæ—§çš„ $M$ æ®µå°†è¢«é‡Šæ”¾ï¼Œå¯ä¾›æ–‡ä»¶ç³»ç»Ÿç”¨äºåç»­å†™å…¥ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬ç°åœ¨é¢ä¸´ä¸¤ä¸ªé—®é¢˜ã€‚ ç¬¬ä¸€ä¸ªæ˜¯æœºåˆ¶ï¼šLFS å¦‚ä½•åˆ¤æ–­æ®µå†…å“ªäº›å—æ˜¯æœ‰æ•ˆå—ï¼Œå“ªäº›å—æ˜¯æ— æ•ˆå—ï¼Ÿ ç¬¬äºŒä¸ªæ˜¯ç­–ç•¥ï¼šæ¸…ç†ç¨‹åºåº”è¯¥å¤šä¹…è¿è¡Œä¸€æ¬¡ï¼Œä»¥åŠåº”è¯¥é€‰æ‹©æ¸…ç†å“ªäº›éƒ¨åˆ†ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:8:1","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8.2 ç¡®å®šå—æœ‰æ•ˆæ€§ æˆ‘ä»¬é¦–å…ˆè§£å†³æœºåˆ¶é—®é¢˜ã€‚ç»™å®šç£ç›˜æ®µ $S$ å†…çš„æ•°æ®å— $D$ï¼ŒLFS å¿…é¡»èƒ½å¤Ÿç¡®å®š $D$ æ˜¯å¦å¤„äºæœ‰æ•ˆçŠ¶æ€ã€‚ä¸ºæ­¤ï¼ŒLFS å‘æè¿°æ¯ä¸ªå—çš„æ¯ä¸ªæ®µæ·»åŠ äº†ä¸€äº›é¢å¤–ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼ŒLFSåŒ…æ‹¬æ¯ä¸ªæ•°æ®å—$D$åŒ…æ‹¬å®ƒçš„inode numberï¼ˆå®ƒå±äºå“ªä¸ªæ–‡ä»¶ï¼‰å’Œå®ƒçš„åç§»é‡ï¼ˆå®ƒæ˜¯æ–‡ä»¶çš„å“ªä¸ªå—ï¼‰ã€‚è¯¥ä¿¡æ¯è®°å½•åœ¨æ®µå¤´éƒ¨çš„ç»“æ„ä¸­ï¼Œç§°ä¸ºæ®µæ‘˜è¦å—ã€‚ æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°ç¡®å®šä¸€ä¸ªå—æ˜¯æœ‰æ•ˆçš„è¿˜æ˜¯æ— æ•ˆçš„ã€‚å¯¹äºä½äºç£ç›˜ä¸Šåœ°å€ $A$ çš„å— $D$ï¼ŒæŸ¥çœ‹æ®µæ‘˜è¦å—å¹¶æ‰¾åˆ°å…¶inode number $N$ å’Œåç§»é‡ $T$ ã€‚æ¥ä¸‹æ¥ï¼Œåœ¨ imap ä¸­æŸ¥æ‰¾ $N$ æ‰€åœ¨çš„ä½ç½®å¹¶ä»ç£ç›˜è¯»å– $N$ï¼ˆä¹Ÿè®¸å®ƒå·²ç»åœ¨å†…å­˜ä¸­ï¼Œè¿™æ ·æ›´å¥½ï¼‰ã€‚æœ€åï¼Œä½¿ç”¨åç§»é‡ $T$ ï¼ŒæŸ¥çœ‹ inodeï¼ˆæˆ–æŸä¸ªé—´æ¥å—ï¼‰ä»¥æŸ¥çœ‹ inode è®¤ä¸ºè¯¥æ–‡ä»¶çš„ç¬¬ $T$ ä¸ªå—ä½äºç£ç›˜ä¸Šçš„ä½ç½®ã€‚å¦‚æœå®ƒå‡†ç¡®åœ°æŒ‡å‘ç£ç›˜åœ°å€Aï¼ŒLFSå¯ä»¥æ–­å®šå—Dæ˜¯æœ‰æ•ˆçš„ã€‚å¦‚æœå®ƒæŒ‡å‘å…¶ä»–åœ°æ–¹ï¼ŒLFS å¯ä»¥æ–­å®š D æ²¡æœ‰åœ¨ä½¿ç”¨ä¸­ï¼ˆå³å®ƒå·²å¤±æ•ˆï¼‰ï¼Œä»è€ŒçŸ¥é“ä¸å†éœ€è¦è¯¥ç‰ˆæœ¬ã€‚è¿™æ˜¯ä¼ªä»£ç æ‘˜è¦ï¼š (N, T) = SegmentSummary[A]; inode = Read(imap[N]); if (inode[T] == A) // block D is alive else // block D is garbage ä¸‹é¢æ˜¯æè¿°è¯¥æœºåˆ¶çš„å›¾ï¼Œå…¶ä¸­æ®µæ‘˜è¦å—ï¼ˆæ ‡è®°ä¸º $SS$ï¼‰è®°å½•äº†åœ°å€ $A0$ å¤„çš„æ•°æ®å—å®é™…ä¸Šæ˜¯æ–‡ä»¶ k åç§»é‡ 0 å¤„çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡æ£€æŸ¥ k çš„ imapï¼Œå¯ä»¥æ‰¾åˆ° inodeï¼Œå¹¶çœ‹åˆ°å®ƒç¡®å®æŒ‡å‘è¯¥ä½ç½®ã€‚ LFS ä¼šé‡‡å–ä¸€äº›å¿«æ·æ–¹å¼æ¥æé«˜ç¡®å®šæœ‰æ•ˆæ€§è¿‡ç¨‹çš„æ•ˆç‡ã€‚ä¾‹å¦‚ï¼Œå½“æ–‡ä»¶è¢«æˆªæ–­æˆ–åˆ é™¤æ—¶ï¼ŒLFS ä¼šå¢åŠ å…¶ç‰ˆæœ¬å·ï¼Œå¹¶åœ¨ imap ä¸­è®°å½•æ–°çš„ç‰ˆæœ¬å·ã€‚é€šè¿‡åœ¨ç£ç›˜æ®µä¸­è®°å½•ç‰ˆæœ¬å·ï¼ŒLFS åªéœ€å°†ç£ç›˜ä¸Šçš„ç‰ˆæœ¬å·ä¸ imap ä¸­çš„ç‰ˆæœ¬å·è¿›è¡Œæ¯”è¾ƒï¼Œå°±èƒ½ç¼©çŸ­ä¸Šè¿°è¾ƒé•¿æ—¶é—´çš„æ£€æŸ¥ï¼Œä»è€Œé¿å…é¢å¤–çš„è¯»å–ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:8:2","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8.3 ç­–ç•¥é—®é¢˜ï¼šæ¸…ç†å“ªäº›å—ä»¥åŠä½•æ—¶æ¸…ç† é™¤ä¸Šè¿°æœºåˆ¶å¤–ï¼ŒLFS è¿˜å¿…é¡»åŒ…å«ä¸€å¥—ç­–ç•¥ï¼Œä»¥ç¡®å®šä½•æ—¶æ¸…ç†ä»¥åŠå“ªäº›å—å€¼å¾—æ¸…ç†ï¼›ç¡®å®šä½•æ—¶æ¸…ç†æ¯”è¾ƒç®€å•ï¼šå®šæœŸã€ç©ºé—²æ—¶æˆ–ç£ç›˜å·²æ»¡è€Œä¸å¾—ä¸æ¸…ç†æ—¶ã€‚ è€Œç¡®å®šæ¸…ç†å“ªäº›å—åˆ™æ›´å…·æŒ‘æˆ˜æ€§ï¼Œè¿™ä¹Ÿæ˜¯è®¸å¤šç ”ç©¶è®ºæ–‡çš„ä¸»é¢˜ã€‚åœ¨æœ€åˆçš„ LFS è®ºæ–‡ä¸­ï¼Œä½œè€…æè¿°äº†ä¸€ç§è¯•å›¾åˆ†ç¦»çƒ­æ®µå’Œå†·æ®µçš„æ–¹æ³•ã€‚çƒ­æ®µæ˜¯æŒ‡å†…å®¹ç»å¸¸è¢«è¦†ç›–çš„æ®µï¼Œå› æ­¤ï¼Œå¯¹äºè¿™æ ·çš„æ®µï¼Œæœ€å¥½çš„ç­–ç•¥æ˜¯ç­‰å¾…å¾ˆé•¿æ—¶é—´å†è¿›è¡Œæ¸…ç†ï¼Œå› ä¸ºè¶Šæ¥è¶Šå¤šçš„æ•°æ®å—è¢«è¦†ç›–ï¼ˆåœ¨æ–°çš„æ®µä¸­ï¼‰ï¼Œä»è€Œè¢«é‡Šæ”¾å‡ºæ¥ä»¥ä¾›ä½¿ç”¨ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œå†·æ®µå¯èƒ½ä¼šæœ‰ä¸€äº›æ— æ•ˆå—ï¼Œä½†å…¶ä½™å†…å®¹ç›¸å¯¹ç¨³å®šã€‚å› æ­¤ï¼Œä½œè€…å¾—å‡ºç»“è®ºï¼Œåº”è¯¥å°½æ—©æ¸…ç†å†·æ®µï¼Œæ™šäº›æ¸…ç†çƒ­æ®µï¼Œå¹¶å¼€å‘äº†ä¸€ç§å¯å‘å¼æ–¹æ³•æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚ç„¶è€Œï¼Œä¸å¤§å¤šæ•°ç­–ç•¥ä¸€æ ·ï¼Œè¿™ç§ç­–ç•¥å¹¶ä¸å®Œç¾ï¼›åæ¥çš„æ–¹æ³•å±•ç¤ºäº†å¦‚ä½•åšå¾—æ›´å¥½ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:8:3","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"9 å´©æºƒæ¢å¤å’Œæ—¥å¿— æœ€åä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœ LFS å†™å…¥ç£ç›˜æ—¶ç³»ç»Ÿå´©æºƒï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ›´æ–°æœŸé—´çš„å´©æºƒå¯¹äºæ–‡ä»¶ç³»ç»Ÿæ¥è¯´æ˜¯å¾ˆæ£˜æ‰‹çš„ï¼Œå› æ­¤ LFS ä¹Ÿå¿…é¡»è€ƒè™‘è¿™ä¸€ç‚¹ã€‚ åœ¨æ­£å¸¸æ“ä½œæœŸé—´ï¼ŒLFS ç¼“å†²æ®µä¸­çš„å†™å…¥ï¼Œç„¶åï¼ˆå½“æ®µå·²æ»¡æˆ–ç»è¿‡ä¸€å®šæ—¶é—´æ—¶ï¼‰å°†è¯¥æ®µå†™å…¥ç£ç›˜ã€‚ LFS å°†è¿™äº›å†™å…¥ç»„ç»‡åœ¨æ—¥å¿—ä¸­ï¼Œå³æ£€æŸ¥ç‚¹åŒºåŸŸæŒ‡å‘å¤´æ®µå’Œå°¾æ®µï¼Œæ¯ä¸ªæ®µéƒ½æŒ‡å‘ä¸‹ä¸€ä¸ªè¦å†™å…¥çš„æ®µã€‚ LFS è¿˜å®šæœŸæ›´æ–°æ£€æŸ¥ç‚¹åŒºåŸŸã€‚åœ¨è¿™äº›æ“ä½œï¼ˆå†™å…¥æ®µã€å†™å…¥ CRï¼‰æœŸé—´æ˜¾ç„¶å¯èƒ½ä¼šå‘ç”Ÿå´©æºƒã€‚é‚£ä¹ˆ LFS å¦‚ä½•å¤„ç†å†™å…¥è¿™äº›ç»“æ„æœŸé—´çš„å´©æºƒå‘¢ï¼Ÿ æˆ‘ä»¬å…ˆæ¥è¯´ç¬¬äºŒç§æƒ…å†µã€‚ä¸ºäº†ç¡®ä¿ CR æ›´æ–°ä»¥åŸå­æ–¹å¼å‘ç”Ÿï¼ŒLFS å®é™…ä¸Šä¿ç•™äº†ä¸¤ä¸ª CRï¼Œåˆ†åˆ«ä½äºç£ç›˜çš„ä¸¤ç«¯ï¼Œå¹¶äº¤æ›¿å†™å…¥ã€‚ LFS åœ¨ä½¿ç”¨æŒ‡å‘ inode mapçš„æœ€æ–°æŒ‡é’ˆå’Œå…¶ä»–ä¿¡æ¯æ›´æ–° CR æ—¶è¿˜å®ç°äº†è°¨æ…çš„åè®®ï¼›å…·ä½“æ¥è¯´ï¼Œå®ƒé¦–å…ˆå†™å‡ºä¸€ä¸ªæ ‡å¤´ï¼ˆå¸¦æœ‰æ—¶é—´æˆ³ï¼‰ï¼Œç„¶åå†™å‡º CR çš„ä¸»é¢˜ï¼Œæœ€åå†™å‡ºæœ€åä¸€ä¸ªå—ï¼ˆä¹Ÿå¸¦æœ‰æ—¶é—´æˆ³ï¼‰ã€‚å¦‚æœç³»ç»Ÿåœ¨ CR æ›´æ–°æœŸé—´å´©æºƒï¼ŒLFS å¯ä»¥é€šè¿‡æŸ¥çœ‹ä¸€å¯¹ä¸ä¸€è‡´çš„æ—¶é—´æˆ³æ¥æ£€æµ‹åˆ°è¿™ä¸€æƒ…å†µã€‚ LFSæ€»æ˜¯ä¼šé€‰æ‹©ä½¿ç”¨æœ€æ–°çš„å…·æœ‰ä¸€è‡´æ—¶é—´æˆ³çš„CRï¼Œä»è€Œå®ç°CRçš„ä¸€è‡´æ›´æ–°ã€‚ ç°åœ¨æˆ‘ä»¬æ¥è§£å†³ç¬¬ä¸€ç§æƒ…å†µã€‚ç”±äº LFS å¤§çº¦æ¯ 30 ç§’å†™å…¥ä¸€æ¬¡ CRï¼Œå› æ­¤æ–‡ä»¶ç³»ç»Ÿçš„æœ€åä¸€ä¸ªä¸€è‡´å¿«ç…§å¯èƒ½ç›¸å½“æ—§ã€‚å› æ­¤ï¼Œé‡æ–°å¯åŠ¨åï¼ŒLFS å¯ä»¥é€šè¿‡ç®€å•åœ°è¯»å–æ£€æŸ¥ç‚¹åŒºåŸŸã€å®ƒæŒ‡å‘çš„ imap ç‰‡æ®µä»¥åŠåç»­æ–‡ä»¶å’Œç›®å½•æ¥è½»æ¾æ¢å¤ï¼›ä½†æ˜¯ï¼Œæœ€åå‡ ç§’çš„æ›´æ–°å°†ä¼šä¸¢å¤±ã€‚ ä¸ºäº†æ”¹è¿›è¿™ä¸€ç‚¹ï¼ŒLFS å°è¯•é€šè¿‡æ•°æ®åº“ç¤¾åŒºä¸­ç§°ä¸ºå‰æ»šçš„æŠ€æœ¯æ¥é‡å»ºè®¸å¤šè¿™äº›æ®µã€‚åŸºæœ¬æ€æƒ³æ˜¯ä»æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹åŒºåŸŸå¼€å§‹ï¼Œæ‰¾åˆ°æ—¥å¿—çš„æœ«å°¾ï¼ˆåŒ…å«åœ¨ CR ä¸­ï¼‰ï¼Œç„¶åä½¿ç”¨å®ƒæ¥è¯»å–æ¥ä¸‹æ¥çš„æ®µå¹¶æŸ¥çœ‹å…¶ä¸­æ˜¯å¦æœ‰ä»»ä½•æœ‰æ•ˆçš„æ›´æ–°ã€‚å¦‚æœæœ‰ï¼ŒLFS ä¼šç›¸åº”åœ°æ›´æ–°æ–‡ä»¶ç³»ç»Ÿï¼Œä»è€Œæ¢å¤è‡ªä¸Šä¸€ä¸ªæ£€æŸ¥ç‚¹ä»¥æ¥å†™å…¥çš„å¤§éƒ¨åˆ†æ•°æ®å’Œå…ƒæ•°æ®ã€‚ ","date":"2024-05-11","objectID":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:9:0","tags":["OS"],"title":"æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å´©æºƒä¸€è‡´æ€§ æ­£å¦‚æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€çœ‹åˆ°çš„ï¼Œæ–‡ä»¶ç³»ç»Ÿç®¡ç†ä¸€ç»„æ•°æ®ç»“æ„æ¥å®ç°é¢„æœŸçš„æŠ½è±¡ï¼šæ–‡ä»¶ã€ç›®å½•ä»¥åŠæ”¯æŒæˆ‘ä»¬æœŸæœ›ä»æ–‡ä»¶ç³»ç»Ÿè·å¾—çš„åŸºæœ¬æŠ½è±¡æ‰€éœ€çš„æ‰€æœ‰å…¶ä»–å…ƒæ•°æ®ã€‚ä¸å¤§å¤šæ•°æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å†…å­˜ä¸­æ‰¾åˆ°çš„æ•°æ®ç»“æ„ï¼‰ä¸åŒï¼Œæ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„å¿…é¡»æŒä¹…å­˜åœ¨ï¼Œå³å®ƒä»¬å¿…é¡»é•¿æœŸå­˜åœ¨ï¼Œå­˜å‚¨åœ¨å³ä½¿æ–­ç”µä¹Ÿèƒ½ä¿ç•™æ•°æ®çš„è®¾å¤‡ä¸Šï¼ˆä¾‹å¦‚ç¡¬ç›˜æˆ–åŸºäºé—ªå­˜çš„ SSDï¼‰ã€‚ æ–‡ä»¶ç³»ç»Ÿé¢ä¸´çš„ä¸€é¡¹ä¸»è¦æŒ‘æˆ˜æ˜¯å¦‚ä½•åœ¨æ–­ç”µæˆ–ç³»ç»Ÿå´©æºƒçš„æƒ…å†µä¸‹æ›´æ–°æŒä¹…æ•°æ®ç»“æ„ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœåœ¨æ›´æ–°ç£ç›˜ç»“æ„çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰äººè¢«ç”µæºçº¿ç»Šå€’å¹¶ä¸”æœºå™¨æ–­ç”µï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿæˆ–è€…æ“ä½œç³»ç»Ÿé‡åˆ°bugè€Œå´©æºƒï¼Ÿç”±äºæ–­ç”µå’Œå´©æºƒï¼Œæ›´æ–°æŒä¹…æ•°æ®ç»“æ„å¯èƒ½éå¸¸æ£˜æ‰‹ï¼Œå¹¶å¯¼è‡´æ–‡ä»¶ç³»ç»Ÿå®ç°ä¸­å‡ºç°ä¸€ä¸ªæ–°çš„æœ‰è¶£é—®é¢˜ï¼Œç§°ä¸ºå´©æºƒä¸€è‡´æ€§é—®é¢˜ã€‚ è¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“ç†è§£ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨å¿…é¡»æ›´æ–°ä¸¤ä¸ªç£ç›˜ä¸Šçš„ç»“æ„ A å’Œ Bï¼Œæ‰èƒ½å®Œæˆç‰¹å®šæ“ä½œã€‚ç”±äºç£ç›˜ä¸€æ¬¡ä»…æœåŠ¡ä¸€ä¸ªè¯·æ±‚ï¼Œå› æ­¤è¿™äº›è¯·æ±‚ä¹‹ä¸€å°†é¦–å…ˆåˆ°è¾¾ç£ç›˜ï¼ˆA æˆ– Bï¼‰ã€‚å¦‚æœç³»ç»Ÿåœ¨ä¸€æ¬¡å†™å…¥å®Œæˆåå´©æºƒæˆ–æ–­ç”µï¼Œç£ç›˜ä¸Šçš„ç»“æ„å°†å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿéƒ½éœ€è¦è§£å†³çš„å…³é”®é—®é¢˜ï¼š å¦‚ä½•åœ¨å´©æºƒçš„æƒ…å†µä¸‹æ›´æ–°ç£ç›˜ï¼Ÿç³»ç»Ÿå¯èƒ½ä¼šå´©æºƒæˆ–åœ¨ä»»æ„ä¸¤æ¬¡å†™å…¥ä¹‹é—´æ–­ç”µï¼Œå› æ­¤ç£ç›˜ä¸Šçš„çŠ¶æ€å¯èƒ½åªä¼šéƒ¨åˆ†æ›´æ–°ã€‚å´©æºƒåï¼Œç³»ç»Ÿå¯åŠ¨å¹¶å¸Œæœ›å†æ¬¡æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼ˆä»¥ä¾¿è®¿é—®æ–‡ä»¶ç­‰ï¼‰ã€‚é‰´äºå´©æºƒå¯èƒ½åœ¨ä»»æ„æ—¶é—´ç‚¹å‘ç”Ÿï¼Œæˆ‘ä»¬å¦‚ä½•ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿå°†ç£ç›˜æ˜ åƒä¿æŒåœ¨åˆç†çš„çŠ¶æ€ï¼Ÿ åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°æè¿°è¿™ä¸ªé—®é¢˜ï¼Œå¹¶äº†è§£æ–‡ä»¶ç³»ç»Ÿç”¨æ¥å…‹æœå®ƒçš„ä¸€äº›æ–¹æ³•ã€‚æˆ‘ä»¬å°†é¦–å…ˆæ£€æŸ¥æ—§æ–‡ä»¶ç³»ç»Ÿæ‰€é‡‡ç”¨çš„æ–¹æ³•ï¼Œç§°ä¸º fsck æˆ–æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å™¨ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ³¨æ„åŠ›è½¬å‘å¦ä¸€ç§æ–¹æ³•ï¼Œç§°ä¸ºæ—¥å¿—è®°å½•ï¼ˆä¹Ÿç§°ä¸ºé¢„å†™æ—¥å¿—è®°å½•ï¼‰ï¼Œè¿™ç§æŠ€æœ¯ä¼šä¸ºæ¯æ¬¡å†™å…¥å¢åŠ ä¸€ç‚¹å¼€é”€ï¼Œä½†å¯ä»¥æ›´å¿«åœ°ä»å´©æºƒæˆ–æ–­ç”µä¸­æ¢å¤ã€‚æˆ‘ä»¬å°†è®¨è®ºæ—¥å¿—è®°å½•çš„åŸºæœ¬æœºåˆ¶ï¼ŒåŒ…æ‹¬ Linux ext3ï¼ˆä¸€ç§ç›¸å¯¹ç°ä»£çš„æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼‰å®ç°çš„å‡ ç§ä¸åŒé£æ ¼çš„æ—¥å¿—è®°å½•ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:1:0","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 è¯¦ç»†ç¤ºä¾‹ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:2:0","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åŸºæœ¬ä»‹ç» ä¸ºäº†å¼€å§‹æˆ‘ä»¬å¯¹æ—¥å¿—çš„ç ”ç©¶ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»¥æŸç§æ–¹å¼æ›´æ–°ç£ç›˜ç»“æ„çš„å·¥ä½œè´Ÿè½½ã€‚å‡è®¾å·¥ä½œè´Ÿè½½å¾ˆç®€å•ï¼šå‘ç°æœ‰æ–‡ä»¶è¿½åŠ ä¸€ä¸ªæ•°æ®å—ã€‚è¿½åŠ çš„æ–¹æ³•æ˜¯æ‰“å¼€æ–‡ä»¶ï¼Œè°ƒç”¨ lseek() å°†æ–‡ä»¶åç§»é‡ç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾ï¼Œç„¶ååœ¨å…³é—­æ–‡ä»¶ä¹‹å‰å‘æ–‡ä»¶å†™å…¥ä¸€ä¸ª 4KB çš„æ•°æ®å—ã€‚ æˆ‘ä»¬è¿˜å‡è®¾ç£ç›˜ä¸Šä½¿ç”¨çš„æ˜¯æ ‡å‡†çš„ç®€å•æ–‡ä»¶ç³»ç»Ÿç»“æ„ï¼Œç±»ä¼¼äºæˆ‘ä»¬ä»¥å‰è§è¿‡çš„æ–‡ä»¶ç³»ç»Ÿã€‚è¿™ä¸ªå°ä¾‹å­åŒ…æ‹¬ä¸€ä¸ª inode ä½å›¾ï¼ˆåªæœ‰ 8 ä½ï¼Œæ¯ä¸ª inode ä¸€ä¸ªï¼‰ã€ä¸€ä¸ªæ•°æ®ä½å›¾ï¼ˆä¹Ÿæ˜¯ 8 ä½ï¼Œæ¯ä¸ªæ•°æ®å—ä¸€ä¸ªï¼‰ã€inodesï¼ˆå…± 8 ä¸ªï¼Œç¼–å· 0 è‡³ 7ï¼Œåˆ†å¸ƒåœ¨ 4 ä¸ªå—ä¸­ï¼‰å’Œæ•°æ®å—ï¼ˆå…± 8 ä¸ªï¼Œç¼–å· 0 è‡³ 7ï¼‰ã€‚ä¸‹é¢æ˜¯è¯¥æ–‡ä»¶ç³»ç»Ÿçš„ç¤ºæ„å›¾ï¼š è§‚å¯Ÿå›¾ç‰‡ä¸­çš„ç»“æ„ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªå·²åˆ†é…çš„ inodeï¼ˆinode number 2ï¼‰å’Œä¸€ä¸ªå·²åˆ†é…çš„æ•°æ®å—ï¼ˆæ•°æ®å— 4ï¼‰ï¼Œå‰è€…å·²åœ¨ inode ä½å›¾ä¸­æ ‡è®°ï¼Œåè€…ä¹Ÿåœ¨æ•°æ®ä½å›¾ä¸­æ ‡è®°ã€‚è¯¥ inode è¢«æ ‡è®°ä¸º I[v1]ï¼Œå› ä¸ºå®ƒæ˜¯è¯¥ inode çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼›å®ƒå°†å¾ˆå¿«è¢«æ›´æ–°ï¼ˆç”±äºä¸Šè¿°å·¥ä½œè´Ÿè½½ï¼‰ã€‚è®©æˆ‘ä»¬ä¹Ÿæ¥çœ‹çœ‹è¿™ä¸ªç®€åŒ–çš„ inode å†…éƒ¨ã€‚åœ¨ I[v1] ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š owner : remzi permissions : read-write size : 1 pointer : 4 pointer : null pointer : null pointer : null åœ¨è¿™ä¸ªç®€åŒ–çš„ inode ä¸­ï¼Œæ–‡ä»¶çš„sizeä¸º 1ï¼ˆåˆ†é…äº†ä¸€ä¸ªå—ï¼‰ï¼Œç¬¬ä¸€ä¸ªç›´æ¥æŒ‡é’ˆæŒ‡å‘å— 4ï¼ˆæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªæ•°æ®å— Daï¼‰ï¼Œæ‰€æœ‰å…¶ä»–ä¸‰ä¸ªç›´æ¥æŒ‡é’ˆéƒ½è®¾ç½®ä¸º null ï¼ˆè¡¨æ˜å®ƒä»¬æ²¡æœ‰è¢«ä½¿ç”¨ï¼‰ã€‚å½“ç„¶ï¼ŒçœŸæ­£çš„inodeè¿˜æœ‰æ›´å¤šçš„å­—æ®µã€‚ å½“æˆ‘ä»¬è¿½åŠ åˆ°æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å‘å…¶ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„æ•°æ®å—ï¼Œå› æ­¤å¿…é¡»æ›´æ–°ä¸‰ä¸ªç£ç›˜ç»“æ„ï¼šinodeï¼ˆå¿…é¡»æŒ‡å‘æ–°å—å¹¶è®°å½•ç”±äºè¿½åŠ è€Œäº§ç”Ÿçš„æ–°çš„è¾ƒå¤§å¤§å°ï¼‰ã€æ–°çš„æ•°æ®å—Dbï¼Œä»¥åŠæ–°ç‰ˆæœ¬çš„æ•°æ®ä½å›¾ï¼ˆç§°ä¸ºB[v2]ï¼‰æ¥æŒ‡ç¤ºæ–°çš„æ•°æ®å—å·²ç»è¢«åˆ†é…ã€‚ å› æ­¤ï¼Œåœ¨ç³»ç»Ÿå†…å­˜ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å°†ä¸‰ä¸ªå—å†™å…¥ç£ç›˜ã€‚æ›´æ–°åçš„ç´¢å¼•èŠ‚ç‚¹ï¼ˆinodeç‰ˆæœ¬ 2ï¼Œç®€ç§° I[v2]ï¼‰ç°åœ¨å¦‚ä¸‹æ‰€ç¤ºï¼š ä¸ºå®ç°è¿™ä¸€è½¬æ¢ï¼Œæ–‡ä»¶ç³»ç»Ÿå¿…é¡»å‘ç£ç›˜æ‰§è¡Œä¸‰æ¬¡å•ç‹¬çš„å†™å…¥æ“ä½œï¼Œåˆ†åˆ«å†™å…¥ inode (I[v2])ã€bitmap (B[v2]) å’Œæ•°æ®å— (Db)ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›å†™å…¥é€šå¸¸ä¸ä¼šåœ¨ç”¨æˆ·å‘å‡º write() ç³»ç»Ÿè°ƒç”¨æ—¶ç«‹å³å‘ç”Ÿï¼›ç›¸åï¼Œè„çš„ inodeã€ä½å›¾å’Œæ–°æ•°æ®ä¼šå…ˆåœ¨ä¸»å†…å­˜ï¼ˆé¡µé¢ç¼“å­˜æˆ–ç¼“å†²åŒºç¼“å­˜ï¼‰ä¸­åœç•™ä¸€æ®µæ—¶é—´ï¼›ç„¶åï¼Œå½“æ–‡ä»¶ç³»ç»Ÿæœ€ç»ˆå†³å®šå°†å®ƒä»¬å†™å…¥ç£ç›˜æ—¶ï¼ˆæ¯”å¦‚ 5 ç§’æˆ– 30 ç§’åï¼‰ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šå‘ç£ç›˜å‘å‡ºå¿…è¦çš„å†™å…¥è¯·æ±‚ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œå´©æºƒå¯èƒ½ä¼šå‘ç”Ÿï¼Œä»è€Œå¹²æ‰°å¯¹ç£ç›˜çš„æ›´æ–°ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœåœ¨å†™å…¥å…¶ä¸­ä¸€ä¸ªæˆ–ä¸¤ä¸ªè€Œä¸æ˜¯å…¨éƒ¨ä¸‰ä¸ªä¹‹åå‘ç”Ÿå´©æºƒï¼Œæ–‡ä»¶ç³»ç»Ÿå¯èƒ½ä¼šå¤„äºä¸€ç§å¥‡æ€ªçš„çŠ¶æ€ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:2:1","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 å´©æºƒåœºæ™¯ ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€äº›å´©æºƒåœºæ™¯çš„ä¾‹å­ã€‚æƒ³è±¡ä¸€ä¸‹åªæœ‰ä¸€æ¬¡å†™å…¥æˆåŠŸï¼›å› æ­¤å­˜åœ¨ä¸‰ç§å¯èƒ½çš„ç»“æœï¼Œæˆ‘ä»¬åœ¨æ­¤åˆ—å‡ºï¼š ä»…å°†æ•°æ®å— (Db) å†™å…¥ç£ç›˜ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®å°±åœ¨ç£ç›˜ä¸Šï¼Œä½†æ²¡æœ‰æŒ‡å‘å®ƒçš„ inodeï¼Œä¹Ÿæ²¡æœ‰ä½å›¾æ˜¾ç¤ºè¯¥æ•°æ®å—å·²åˆ†é…ã€‚å› æ­¤ï¼Œå†™å…¥å°±å¥½åƒä»æœªå‘ç”Ÿè¿‡ä¸€æ ·ã€‚ä»æ–‡ä»¶ç³»ç»Ÿå´©æºƒä¸€è‡´æ€§çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç§æƒ…å†µæ ¹æœ¬ä¸æ˜¯é—®é¢˜ã€‚ åªæœ‰æ›´æ–°çš„ inodeï¼ˆI[v2]ï¼‰è¢«å†™å…¥ç£ç›˜ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œinode æŒ‡å‘ Db å³å°†è¢«å†™å…¥çš„ç£ç›˜åœ°å€ (5)ï¼Œä½† Db å°šæœªè¢«å†™å…¥ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ç›¸ä¿¡è¯¥æŒ‡é’ˆï¼Œå°±ä¼šä»ç£ç›˜è¯»å–åƒåœ¾æ•°æ®ï¼ˆç£ç›˜åœ°å€ 5 çš„æ—§å†…å®¹ï¼‰ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜é‡åˆ°äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ–‡ä»¶ç³»ç»Ÿä¸ä¸€è‡´ã€‚ç£ç›˜ä½å›¾å‘Šè¯‰æˆ‘ä»¬ï¼Œæ•°æ®å— 5 å°šæœªåˆ†é…ï¼Œä½† inode å´è¯´å®ƒå·²ç»åˆ†é…ã€‚ä½å›¾å’Œ inode ä¹‹é—´çš„ä¸ä¸€è‡´æ˜¯æ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„çš„ä¸ä¸€è‡´ï¼›è¦ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ åªæœ‰æ›´æ–°åçš„ä½å›¾ï¼ˆB[v2]ï¼‰è¢«å†™å…¥ç£ç›˜ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½å›¾æ˜¾ç¤ºå— 5 å·²åˆ†é…ï¼Œä½†å´æ²¡æœ‰æŒ‡å‘å®ƒçš„ inodeã€‚å› æ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿå†æ¬¡å‡ºç°ä¸ä¸€è‡´ï¼›å¦‚æœä¸åŠ ä»¥è§£å†³ï¼Œè¿™æ¬¡å†™å…¥å°†å¯¼è‡´ç©ºé—´æ³„æ¼ï¼Œå› ä¸ºæ–‡ä»¶ç³»ç»Ÿæ°¸è¿œä¸ä¼šä½¿ç”¨å— 5ã€‚ åœ¨å°è¯•å‘ç£ç›˜å†™å…¥ä¸‰ä¸ªæ•°æ®å—çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜æœ‰ä¸‰ç§å´©æºƒæƒ…å†µã€‚åœ¨è¿™äº›æƒ…å†µä¸­ï¼Œä¸¤æ¬¡å†™å…¥æˆåŠŸï¼Œæœ€åä¸€æ¬¡å†™å…¥å¤±è´¥ï¼š inode (I[v2]) å’Œ bitmap (B[v2]) è¢«å†™å…¥ç£ç›˜ï¼Œä½†æ•°æ® (Db) æœªè¢«å†™å…¥ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼šinode æœ‰ä¸€ä¸ªæŒ‡å‘å— 5 çš„æŒ‡é’ˆï¼Œä½å›¾æ˜¾ç¤º 5 æ­£åœ¨ä½¿ç”¨ä¸­ï¼Œå› æ­¤ä»æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®çš„è§’åº¦çœ‹ä¸€åˆ‡æ­£å¸¸ã€‚ä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼š5 ä¸­åˆå‡ºç°äº†åƒåœ¾ã€‚ å†™å…¥äº† inode (I[v2]) å’Œæ•°æ®å— (Db)ï¼Œä½†æ²¡æœ‰å†™å…¥ä½å›¾ (B[v2])ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ inode æŒ‡å‘äº†ç£ç›˜ä¸Šçš„æ­£ç¡®æ•°æ®ï¼Œä½† inode å’Œæ—§ç‰ˆæœ¬çš„ä½å›¾ (B1) ä¹‹é—´å†æ¬¡å‡ºç°ä¸ä¸€è‡´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡éœ€è¦åœ¨ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿå‰è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä½å›¾ (B[v2]) å’Œæ•°æ®å— (Db) è¢«å†™å…¥ï¼Œä½† inode (I[v2]) å´æ²¡æœ‰è¢«å†™å…¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆé‡åˆ°äº† inode å’Œæ•°æ®ä½å›¾ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ç„¶è€Œï¼Œå°½ç®¡å—å·²è¢«å†™å…¥ï¼Œä½å›¾ä¹Ÿæ˜¾ç¤ºäº†å®ƒçš„ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬å´ä¸çŸ¥é“å®ƒå±äºå“ªä¸ªæ–‡ä»¶ï¼Œå› ä¸ºæ²¡æœ‰ inode æŒ‡å‘è¯¥æ–‡ä»¶ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:2:2","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 å´©æºƒä¸€è‡´æ€§é—®é¢˜ å¸Œæœ›ä»è¿™äº›å´©æºƒåœºæ™¯ä¸­ï¼Œä½ èƒ½çœ‹åˆ°ç£ç›˜ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿæ˜ åƒå› å´©æºƒè€Œå¯èƒ½å‡ºç°çš„è¯¸å¤šé—®é¢˜ï¼šæ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„ä¸ä¸€è‡´ï¼›ç©ºé—´æ³„æ¼ï¼›å‘ç”¨æˆ·è¿”å›åƒåœ¾æ•°æ®ç­‰ç­‰ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ–‡ä»¶ç³»ç»Ÿä»ä¸€ç§ä¸€è‡´çš„çŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ–‡ä»¶è¢«é™„åŠ ä¹‹å‰ï¼‰åŸå­åœ°ç§»åŠ¨åˆ°å¦ä¸€ç§ä¸€è‡´çš„çŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œåœ¨å°† inodeã€ä½å›¾å’Œæ–°æ•°æ®å—å†™å…¥ç£ç›˜ä¹‹åï¼‰ã€‚é—æ†¾çš„æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•è½»æ˜“åšåˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºç£ç›˜æ¯æ¬¡åªæäº¤ä¸€æ¬¡å†™å…¥ï¼Œè€Œåœ¨è¿™äº›æ›´æ–°ä¹‹é—´å¯èƒ½ä¼šå‘ç”Ÿå´©æºƒæˆ–æ–­ç”µã€‚æˆ‘ä»¬å°†è¿™ä¸€æ™®éé—®é¢˜ç§°ä¸ºå´©æºƒä¸€è‡´æ€§é—®é¢˜ï¼ˆä¹Ÿå¯ç§°ä¸ºä¸€è‡´æ€§æ›´æ–°é—®é¢˜ï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:2:3","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 è§£å†³æ–¹æ¡ˆ#1ï¼šæ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å™¨ æ—©æœŸçš„æ–‡ä»¶ç³»ç»Ÿé‡‡ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥è§£å†³å´©æºƒä¸€è‡´æ€§é—®é¢˜ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒä»¬å†³å®šä»»ç”±ä¸ä¸€è‡´æ€§å‘ç”Ÿï¼Œç„¶åç¨åï¼ˆé‡å¯æ—¶ï¼‰å†ä¿®å¤å®ƒä»¬ã€‚fsckå°±æ˜¯è¿™ç§æ‡’æƒ°æ–¹æ³•çš„å…¸å‹ä¾‹å­ï¼Œå®ƒæ˜¯ä¸€ç§ UNIX å·¥å…·ï¼Œç”¨äºæŸ¥æ‰¾å’Œä¿®å¤æ­¤ç±»ä¸ä¸€è‡´æ€§ï¼›ä¸åŒç³»ç»Ÿä¸Šä¹Ÿæœ‰ç±»ä¼¼çš„å·¥å…·ç”¨äºæ£€æŸ¥å’Œä¿®å¤ç£ç›˜åˆ†åŒºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰é—®é¢˜ï¼›ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸Šè¿°æ–‡ä»¶ç³»ç»Ÿçœ‹èµ·æ¥ä¸€è‡´ï¼Œä½† inode æŒ‡å‘åƒåœ¾æ•°æ®çš„æƒ…å†µã€‚å”¯ä¸€çœŸæ­£çš„ç›®æ ‡æ˜¯ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®çš„å†…éƒ¨ä¸€è‡´æ€§ã€‚ æ­£å¦‚ McKusick å’Œ Kowalski çš„è®ºæ–‡æ‰€æ€»ç»“çš„ï¼Œfsck å·¥å…·çš„è¿è¡Œåˆ†ä¸ºå‡ ä¸ªé˜¶æ®µã€‚å®ƒåœ¨æ–‡ä»¶ç³»ç»ŸæŒ‚è½½å’Œå¯ç”¨ä¹‹å‰è¿è¡Œï¼ˆfsck å‡è®¾è¿è¡Œæ—¶æ²¡æœ‰å…¶ä»–æ–‡ä»¶ç³»ç»Ÿæ´»åŠ¨ï¼‰ï¼›ä¸€æ—¦å®Œæˆï¼Œç£ç›˜ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿåº”è¯¥æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤å¯ä»¥è®©ç”¨æˆ·è®¿é—®ã€‚ä»¥ä¸‹æ˜¯ fsck å·¥ä½œçš„åŸºæœ¬æ¦‚è¦ï¼š è¶…çº§å—ï¼šfsck é¦–å…ˆæ£€æŸ¥è¶…çº§å—çœ‹èµ·æ¥æ˜¯å¦åˆç†ï¼Œä¸»è¦æ˜¯è¿›è¡Œå¥å…¨æ€§æ£€æŸ¥ï¼Œå¦‚ç¡®ä¿æ–‡ä»¶ç³»ç»Ÿå¤§å°å¤§äºå·²åˆ†é…çš„å—æ•°ã€‚è¿™äº›å¥å…¨æ€§æ£€æŸ¥çš„ç›®çš„é€šå¸¸æ˜¯å‘ç°å¯ç–‘ï¼ˆæŸåï¼‰çš„è¶…çº§å—ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿï¼ˆæˆ–ç®¡ç†å‘˜ï¼‰å¯èƒ½ä¼šå†³å®šä½¿ç”¨è¶…çº§å—çš„æ›¿ä»£å‰¯æœ¬ã€‚ ç©ºé—²å—ï¼šæ¥ä¸‹æ¥ï¼Œfsck ä¼šæ‰«æ inodesã€é—´æ¥å—ã€åŒé—´æ¥å—ç­‰ï¼Œä»¥äº†è§£æ–‡ä»¶ç³»ç»Ÿä¸­å½“å‰åˆ†é…çš„å—ã€‚å®ƒåˆ©ç”¨è¿™äº›çŸ¥è¯†ç”Ÿæˆæ­£ç¡®ç‰ˆæœ¬çš„åˆ†é…ä½å›¾ï¼›å› æ­¤ï¼Œå¦‚æœä½å›¾å’Œ inodes ä¹‹é—´æœ‰ä»»ä½•ä¸ä¸€è‡´ï¼Œå¯ä»¥é€šè¿‡ä¿¡ä»» inodes ä¸­çš„ä¿¡æ¯æ¥è§£å†³ã€‚å¯¹æ‰€æœ‰ inodes æ‰§è¡Œç›¸åŒç±»å‹çš„æ£€æŸ¥ï¼Œç¡®ä¿æ‰€æœ‰çœ‹èµ·æ¥æ­£åœ¨ä½¿ç”¨çš„ inodes éƒ½åœ¨ inode ä½å›¾ä¸­æ ‡è®°ä¸ºæ­£åœ¨ä½¿ç”¨ã€‚ InodeçŠ¶æ€ï¼šæ£€æŸ¥æ¯ä¸ª inode æ˜¯å¦æŸåæˆ–å­˜åœ¨å…¶ä»–é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œfsck ä¼šç¡®ä¿æ¯ä¸ªå·²åˆ†é…çš„ inode éƒ½æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ç±»å‹å­—æ®µï¼ˆå¦‚å¸¸è§„æ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥ç­‰ï¼‰ã€‚å¦‚æœ inode å­—æ®µå­˜åœ¨ä¸æ˜“ä¿®å¤çš„é—®é¢˜ï¼Œè¯¥ inode å°±ä¼šè¢«è§†ä¸ºå¯ç–‘ï¼Œå¹¶è¢« fsck æ¸…é™¤ï¼›inode ä½å›¾ä¹Ÿä¼šç›¸åº”æ›´æ–°ã€‚ Inode é“¾æ¥ï¼šfsck è¿˜ä¼šéªŒè¯æ¯ä¸ªå·²åˆ†é… inode çš„é“¾æ¥è®¡æ•°ã€‚é“¾æ¥è®¡æ•°è¡¨ç¤ºåŒ…å«å¯¹è¯¥ç‰¹å®šæ–‡ä»¶çš„å¼•ç”¨ï¼ˆå³é“¾æ¥ï¼‰çš„ä¸åŒç›®å½•çš„æ•°é‡ã€‚ä¸ºäº†éªŒè¯é“¾æ¥è®¡æ•°ï¼Œfsck ä¼šä»æ ¹ç›®å½•å¼€å§‹æ‰«ææ•´ä¸ªç›®å½•æ ‘ï¼Œå¹¶ä¸ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ¯ä¸ªæ–‡ä»¶å’Œç›®å½•å»ºç«‹è‡ªå·±çš„é“¾æ¥è®¡æ•°ã€‚å¦‚æœæ–°è®¡ç®—çš„é“¾æ¥æ•°ä¸æŸä¸ª inode ä¸­çš„é“¾æ¥æ•°ä¸åŒ¹é…ï¼Œå°±å¿…é¡»é‡‡å–çº æ­£æªæ–½ï¼Œé€šå¸¸æ˜¯ä¿®å¤ inode ä¸­çš„é“¾æ¥æ•°ã€‚å¦‚æœå‘ç°ä¸€ä¸ªå·²åˆ†é…çš„ inodeï¼Œä½†æ²¡æœ‰ç›®å½•æŒ‡å‘å®ƒï¼Œå®ƒå°±ä¼šè¢«ç§»åˆ°lost+foundç›®å½•\u003c/ã€‚ é‡å¤ï¼šfsck è¿˜ä¼šæ£€æŸ¥é‡å¤æŒ‡é’ˆï¼Œå³ä¸¤ä¸ªä¸åŒçš„ inode æŒ‡å‘åŒä¸€å—çš„æƒ…å†µã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ª inode æ˜æ˜¾æœ‰é—®é¢˜ï¼Œå¯èƒ½ä¼šè¢«æ¸…é™¤ã€‚æˆ–è€…ï¼Œå¯ä»¥å¤åˆ¶æŒ‡å‘çš„å—ï¼Œä»è€Œæ ¹æ®éœ€è¦ç»™æ¯ä¸ª inode æä¾›è‡ªå·±çš„å‰¯æœ¬ã€‚ åå—ï¼šåœ¨æ‰«ææ‰€æœ‰æŒ‡é’ˆåˆ—è¡¨æ—¶ï¼Œè¿˜ä¼šå¯¹åå—æŒ‡é’ˆè¿›è¡Œæ£€æŸ¥ã€‚å¦‚æœä¸€ä¸ªæŒ‡é’ˆæ˜æ˜¾æŒ‡å‘è¶…å‡ºå…¶æœ‰æ•ˆèŒƒå›´çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼Œå®ƒçš„åœ°å€æŒ‡å‘çš„å—å¤§äºåˆ†åŒºå¤§å°ï¼Œé‚£ä¹ˆè¿™ä¸ªæŒ‡é’ˆå°±è¢«è®¤ä¸ºæ˜¯ â€œåçš„â€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œfsck ä¸ä¼šåšä»»ä½•å¤ªèªæ˜çš„äº‹æƒ…ï¼›å®ƒåªæ˜¯ä» inode æˆ–é—´æ¥å—ä¸­åˆ é™¤ï¼ˆæ¸…é™¤ï¼‰æŒ‡é’ˆã€‚ ç›®å½•æ£€æŸ¥ï¼šfsck æ— æ³•ç†è§£ç”¨æˆ·æ–‡ä»¶çš„å†…å®¹ï¼›ä½†ç›®å½•ä¸­åŒ…å«æ–‡ä»¶ç³»ç»Ÿæœ¬èº«åˆ›å»ºçš„ç‰¹å®šæ ¼å¼åŒ–ä¿¡æ¯ã€‚å› æ­¤ï¼Œfsck ä¼šå¯¹æ¯ä¸ªç›®å½•çš„å†…å®¹æ‰§è¡Œé¢å¤–çš„å®Œæ•´æ€§æ£€æŸ¥ï¼Œç¡®ä¿\". â€œå’Œâ€.. â€œæ˜¯ç¬¬ä¸€ä¸ªæ¡ç›®ï¼Œç›®å½•æ¡ç›®ä¸­å¼•ç”¨çš„æ¯ä¸ª inode éƒ½å·²åˆ†é…ï¼Œå¹¶ç¡®ä¿åœ¨æ•´ä¸ªå±‚æ¬¡ç»“æ„ä¸­ï¼Œæ²¡æœ‰ä»»ä½•ç›®å½•è¢«é“¾æ¥è¶…è¿‡ä¸€æ¬¡ã€‚ å¦‚ä½ æ‰€è§ï¼Œæ„å»ºä¸€ä¸ªæœ‰æ•ˆçš„ fsck éœ€è¦å¤æ‚çš„æ–‡ä»¶ç³»ç»ŸçŸ¥è¯†ï¼›è¦ç¡®ä¿è¿™æ ·ä¸€æ®µä»£ç åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½èƒ½æ­£ç¡®è¿è¡Œï¼Œæ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚ç„¶è€Œï¼Œfsckï¼ˆä»¥åŠç±»ä¼¼æ–¹æ³•ï¼‰è¿˜æœ‰ä¸€ä¸ªæ›´å¤§ã€ä¹Ÿè®¸æ›´æ ¹æœ¬çš„é—®é¢˜ï¼šå®ƒä»¬å¤ªæ…¢äº†ã€‚åœ¨ç£ç›˜å®¹é‡éå¸¸å¤§çš„æƒ…å†µä¸‹ï¼Œæ‰«ææ•´ä¸ªç£ç›˜ä»¥æ‰¾åˆ°æ‰€æœ‰å·²åˆ†é…å—å¹¶è¯»å–æ•´ä¸ªç›®å½•æ ‘å¯èƒ½éœ€è¦æ•°åˆ†é’Ÿæˆ–æ•°å°æ—¶ã€‚éšç€ç£ç›˜å®¹é‡çš„å¢åŠ å’Œ RAID çš„æ™®åŠï¼Œfsck çš„æ€§èƒ½å˜å¾—ä»¤äººæœ›è€Œå´æ­¥ã€‚ ä»æ›´é«˜å±‚æ¬¡æ¥çœ‹ï¼Œfsck çš„åŸºæœ¬å‰æä¼¼ä¹æœ‰ç‚¹ä¸åˆç†ã€‚æƒ³æƒ³æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ï¼Œåªæœ‰ä¸‰ä¸ªæ•°æ®å—è¢«å†™å…¥ç£ç›˜ï¼›è¦æ‰«ææ•´ä¸ªç£ç›˜æ¥ä¿®å¤åœ¨æ›´æ–°ä¸‰ä¸ªæ•°æ®å—æ—¶å‡ºç°çš„é—®é¢˜ï¼Œæˆæœ¬é«˜å¾—æƒŠäººã€‚è¿™ç§æƒ…å†µå°±å¥½æ¯”ä½ æŠŠé’¥åŒ™æ‰åœ¨å§å®¤çš„åœ°æ¿ä¸Šï¼Œç„¶åå¼€å§‹æœç´¢æ•´ä¸ªæˆ¿å­çš„é’¥åŒ™æ¢å¤ç®—æ³•ï¼Œä»åœ°ä¸‹å®¤å¼€å§‹ï¼Œé€ä¸ªæˆ¿é—´æœç´¢ã€‚è¿™æ ·åšè™½ç„¶æœ‰æ•ˆï¼Œä½†ä¼šé€ æˆæµªè´¹ã€‚å› æ­¤ï¼Œéšç€ç£ç›˜ï¼ˆå’Œ RAIDï¼‰çš„å‘å±•ï¼Œç ”ç©¶äººå‘˜å’Œä»ä¸šäººå‘˜å¼€å§‹å¯»æ‰¾å…¶ä»–è§£å†³æ–¹æ¡ˆã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:3:0","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 è§£å†³æ–¹æ¡ˆ#2ï¼šæ—¥å¿—ï¼ˆæˆ–é¢„å†™æ—¥å¿—ï¼‰ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:0","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.1 åŸºæœ¬ä»‹ç» è§£å†³ä¸€è‡´æ€§æ›´æ–°é—®é¢˜çš„æœ€æµè¡Œçš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯ä»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿé¢†åŸŸçªƒå–çš„ä¸€ä¸ªæƒ³æ³•ã€‚è¿™ç§è¢«ç§°ä¸ºé¢„å†™æ—¥å¿—çš„æƒ³æ³•æ­£æ˜¯ä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜è€Œå‘æ˜çš„ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œç”±äºå†å²åŸå› ï¼Œæˆ‘ä»¬é€šå¸¸å°†å…¶ç§°ä¸ºé¢„å†™æ—¥å¿—è®°å½•ã€‚ç¬¬ä¸€ä¸ªåšåˆ°è¿™ä¸€ç‚¹çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ Cedarï¼Œå°½ç®¡è®¸å¤šç°ä»£æ–‡ä»¶ç³»ç»Ÿéƒ½ä½¿ç”¨è¿™ä¸ªæƒ³æ³•ï¼ŒåŒ…æ‹¬ Linux ext3 å’Œ ext4ã€reiserfsã€IBM çš„ JFSã€SGI çš„ XFS å’Œ Windows NTFSã€‚ åŸºæœ¬æ€è·¯å¦‚ä¸‹ï¼šæ›´æ–°ç£ç›˜æ—¶ï¼Œåœ¨è¦†ç›–ç°æœ‰çš„ç»“æ„ä¹‹å‰ï¼Œé¦–å…ˆå†™ä¸‹ä¸€ä¸ªå°æ³¨é‡Šï¼ˆç£ç›˜ä¸Šå…¶ä»–æŸä¸ªä¼—æ‰€å‘¨çŸ¥çš„ä½ç½®ï¼‰æè¿°æ‚¨å°†è¦æ‰§è¡Œçš„æ“ä½œã€‚å†™è¿™ä¸ªæ³¨é‡Šæ˜¯â€œé¢„å†™â€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å…¶å†™å…¥æˆ‘ä»¬ç»„ç»‡ä¸ºâ€œæ—¥å¿—â€çš„ç»“æ„ä¸­ï¼›å› æ­¤ï¼Œé¢„å†™æ—¥å¿—è®°å½•ã€‚ é€šè¿‡å°†æ³¨é‡Šå†™å…¥ç£ç›˜ï¼Œæ‚¨å¯ä»¥ä¿è¯å¦‚æœåœ¨æ›´æ–°ï¼ˆè¦†ç›–ï¼‰æ­£åœ¨æ›´æ–°çš„ç»“æ„æœŸé—´å‘ç”Ÿå´©æºƒï¼Œæ‚¨å¯ä»¥è¿”å›å¹¶æŸ¥çœ‹æ‚¨æ‰€åšçš„æ³¨é‡Šå¹¶é‡è¯•ï¼›å› æ­¤ï¼Œæ‚¨å°†ç¡®åˆ‡åœ°çŸ¥é“å´©æºƒåè¦ä¿®å¤ä»€ä¹ˆï¼ˆä»¥åŠå¦‚ä½•ä¿®å¤ï¼‰ï¼Œè€Œä¸å¿…æ‰«ææ•´ä¸ªç£ç›˜ã€‚æ ¹æ®è®¾è®¡ï¼Œæ—¥å¿—è®°å½•ä¼šåœ¨æ›´æ–°æœŸé—´å¢åŠ ä¸€äº›å·¥ä½œé‡ï¼Œä»è€Œå¤§å¤§å‡å°‘æ¢å¤æœŸé—´æ‰€éœ€çš„å·¥ä½œé‡ã€‚ ç°åœ¨æˆ‘ä»¬å°†æè¿° Linux ext3ï¼ˆä¸€ç§æµè¡Œçš„æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼‰å¦‚ä½•å°†æ—¥å¿—åˆå¹¶åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚å¤§å¤šæ•°ç£ç›˜ç»“æ„ä¸ Linux ext2 ç›¸åŒï¼Œä¾‹å¦‚ï¼Œç£ç›˜åˆ†ä¸ºå—ç»„ï¼Œæ¯ä¸ªå—ç»„åŒ…å« inode ä½å›¾ã€æ•°æ®ä½å›¾ã€inode å’Œæ•°æ®å—ã€‚æ–°çš„å…³é”®ç»“æ„æ˜¯æ—¥å¿—æœ¬èº«ï¼Œå®ƒå ç”¨åˆ†åŒºå†…æˆ–å…¶ä»–è®¾å¤‡ä¸Šçš„ä¸€äº›å°‘é‡ç©ºé—´ã€‚å› æ­¤ï¼Œext2 æ–‡ä»¶ç³»ç»Ÿï¼ˆæ²¡æœ‰æ—¥å¿—ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼š å‡è®¾æ—¥å¿—æ”¾ç½®åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæ˜ åƒä¸­ï¼ˆå°½ç®¡æœ‰æ—¶å®ƒæ”¾ç½®åœ¨å•ç‹¬çš„è®¾å¤‡ä¸Šï¼Œæˆ–è€…ä½œä¸ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ï¼‰ï¼Œå¸¦æœ‰æ—¥å¿—çš„ ext3 æ–‡ä»¶ç³»ç»Ÿå¦‚ä¸‹æ‰€ç¤ºï¼š çœŸæ­£çš„åŒºåˆ«åªæ˜¯æ—¥å¿—çš„å­˜åœ¨ï¼Œå½“ç„¶è¿˜æœ‰å®ƒçš„ä½¿ç”¨æ–¹å¼ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:1","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.2 æ•°æ®æ—¥å¿— è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥äº†è§£æ•°æ®æ—¥å¿—çš„å·¥ä½œåŸç†ã€‚æ•°æ®æ—¥å¿—æ˜¯ Linux ext3 æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ç§æ¨¡å¼ï¼Œæœ¬æ–‡çš„å¤§éƒ¨åˆ†è®¨è®ºéƒ½æ˜¯åŸºäºè¿™ç§æ¨¡å¼ã€‚ å‡è®¾æˆ‘ä»¬å†æ¬¡è¿›è¡Œå…¸å‹æ›´æ–°ï¼Œå¸Œæœ›å°† inode (I[v2])ã€ä½å›¾ (B[v2]) å’Œæ•°æ®å— (Db) å†æ¬¡å†™å…¥ç£ç›˜ã€‚åœ¨å°†å®ƒä»¬å†™å…¥æœ€ç»ˆç£ç›˜ä½ç½®ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å°†å®ƒä»¬å†™å…¥æ—¥å¿—ï¼ˆåˆç§°æ—¥è®°ï¼‰ã€‚è¿™å°±æ˜¯æ—¥å¿—ä¸­çš„å†…å®¹ï¼š å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå†™å…¥äº† 5 ä¸ªå—ã€‚äº‹åŠ¡å¼€å§‹ï¼ˆTxBï¼‰å‘Šè¯‰æˆ‘ä»¬è¿™æ¬¡æ›´æ–°çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿå¾…æ›´æ–°çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œå— I[v2]ã€B[v2]å’Œ Db çš„æœ€ç»ˆåœ°å€ï¼‰ï¼Œä»¥åŠæŸç§äº‹åŠ¡æ ‡è¯†ç¬¦ï¼ˆTIDï¼‰ã€‚ä¸­é—´ä¸‰ä¸ªå—åªåŒ…å«å—æœ¬èº«çš„ç¡®åˆ‡å†…å®¹ï¼›è¿™è¢«ç§°ä¸ºç‰©ç†æ—¥å¿—ï¼Œå› ä¸ºæˆ‘ä»¬å°†æ›´æ–°çš„ç¡®åˆ‡ç‰©ç†å†…å®¹å†™å…¥æ—¥å¿—ï¼ˆå¦ä¸€ç§æƒ³æ³•æ˜¯é€»è¾‘æ—¥å¿—ï¼Œå°†æ›´æ–°çš„é€»è¾‘è¡¨è¿°æ›´ç´§å‡‘åœ°å†™å…¥æ—¥å¿—ï¼Œä¾‹å¦‚ â€œæ­¤æ›´æ–°å¸Œæœ›å°†æ•°æ®å— Db é™„åŠ åˆ°æ–‡ä»¶ Xâ€ï¼Œè¿™æœ‰ç‚¹å¤æ‚ï¼Œä½†å¯ä»¥èŠ‚çœæ—¥å¿—ç©ºé—´ï¼Œä¹Ÿè®¸è¿˜èƒ½æé«˜æ€§èƒ½ï¼‰ã€‚æœ€åä¸€ä¸ªæ•°æ®å—ï¼ˆTxEï¼‰æ˜¯è¯¥äº‹åŠ¡ç»“æŸçš„æ ‡è®°ï¼Œä¹ŸåŒ…å« TIDã€‚ ä¸€æ—¦äº‹åŠ¡å®‰å…¨åœ°å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥è¦†ç›–æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ—§ç»“æ„ï¼›è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ£€æŸ¥ç‚¹ã€‚å› æ­¤ï¼Œä¸ºäº†å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ£€æŸ¥ç‚¹ï¼ˆå³ä½¿å…¶ä¸æ—¥å¿—ä¸­çš„å¾…å®šæ›´æ–°ä¿æŒåŒæ­¥ï¼‰ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸Šè¿°æ–¹å¼å°†I[v2]ã€B[v2] å’Œ Db å†™å…¥åˆ°å®ƒä»¬çš„ç£ç›˜ä½ç½®ï¼›å¦‚æœè¿™äº›å†™å…¥æˆåŠŸå®Œæˆï¼Œæˆ‘ä»¬å°±å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº†æ£€æŸ¥ç‚¹ï¼ŒåŸºæœ¬ä¸Šå°±å®Œæˆäº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„åˆå§‹æ“ä½œåºåˆ—ä¸ºï¼š å†™æ—¥å¿—ï¼šå°†äº‹åŠ¡å†™å…¥æ—¥å¿—ï¼ŒåŒ…æ‹¬äº‹åŠ¡å¼€å§‹å—ã€æ‰€æœ‰å¾…å¤„ç†çš„æ•°æ®å’Œå…ƒæ•°æ®æ›´æ–°ä»¥åŠäº‹åŠ¡ç»“æŸå—ï¼›ç­‰å¾…è¿™äº›å†™å…¥å®Œæˆã€‚ æ£€æŸ¥ç‚¹ï¼šå°†å¾…å¤„ç†çš„å…ƒæ•°æ®å’Œæ•°æ®æ›´æ–°å†™å…¥æ–‡ä»¶ç³»ç»Ÿä¸­çš„æœ€ç»ˆä½ç½®ã€‚ åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå°† TxBã€I[v2]ã€B[v2]ã€Db å’Œ TxE å†™å…¥æ—¥å¿—ã€‚å½“è¿™äº›å†™å…¥å®Œæˆåï¼Œæˆ‘ä»¬å°†é€šè¿‡æ£€æŸ¥ç‚¹ I[v2]ã€B[v2] å’Œ Db åˆ°å®ƒä»¬åœ¨ç£ç›˜ä¸Šçš„æœ€ç»ˆä½ç½®æ¥å®Œæˆæ›´æ–°ã€‚ å½“å†™å…¥æ—¥å¿—æœŸé—´å‘ç”Ÿå´©æºƒæ—¶ï¼Œäº‹æƒ…ä¼šå˜å¾—æœ‰ç‚¹æ£˜æ‰‹ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°è¯•å°†äº‹åŠ¡ä¸­çš„ä¸€ç»„å—ï¼ˆä¾‹å¦‚ï¼ŒTxBã€I[v2]ã€B[v2]ã€Dbã€TxEï¼‰å†™å…¥ç£ç›˜ã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯ä¸€æ¬¡å‘å‡ºæ¯ä¸€ä¸ªï¼Œç­‰å¾…æ¯ä¸€ä¸ªå®Œæˆï¼Œç„¶åå‘å‡ºä¸‹ä¸€ä¸ªã€‚ç„¶è€Œï¼Œè¿™å¾ˆæ…¢ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€æ¬¡å‘å‡ºæ‰€æœ‰äº”ä¸ªå—å†™å…¥ï¼Œå› ä¸ºè¿™ä¼šå°†äº”ä¸ªå†™å…¥è½¬æ¢ä¸ºå•ä¸ªé¡ºåºå†™å…¥ï¼Œä»è€Œé€Ÿåº¦æ›´å¿«ã€‚ç„¶è€Œï¼Œè¿™æ˜¯ä¸å®‰å…¨çš„ï¼ŒåŸå› å¦‚ä¸‹ï¼šç»™å®šå¦‚æ­¤å¤§çš„å†™å…¥ï¼Œç£ç›˜å†…éƒ¨å¯èƒ½ä¼šæ‰§è¡Œè°ƒåº¦å¹¶ä»¥ä»»ä½•é¡ºåºå®Œæˆå¤§å†™å…¥çš„å°ç‰‡æ®µã€‚å› æ­¤ï¼Œç£ç›˜å†…éƒ¨å¯ä»¥ (1) å†™å…¥ TxBã€I[v2]ã€B[v2] å’Œ TxEï¼Œå¹¶ä¸”ä»…åœ¨ç¨å (2) å†™å…¥ Dbã€‚ä¸å¹¸çš„æ˜¯ï¼Œå¦‚æœç£ç›˜åœ¨ (1) å’Œ (2) ä¹‹é—´æ–­ç”µï¼Œç£ç›˜ä¸Šçš„ç»“æœå¦‚ä¸‹ï¼š å¼ºåˆ¶å†™å…¥ç£ç›˜ ç°ä»£æ–‡ä»¶ç³»ç»Ÿåœ¨å¼ºåˆ¶ä¸¤æ¬¡ç£ç›˜å†™å…¥ä¹‹é—´ä¿æŒé¡ºåºæ—¶éœ€è¦é¢å¤–çš„é¢„é˜²æªæ–½ã€‚è¿‡å»ï¼Œç®€å•åœ°ç­‰å¾…ç¬¬ä¸€æ¬¡å†™å…¥å®Œæˆå†è¿›è¡Œç¬¬äºŒæ¬¡å†™å…¥å°±è¶³å¤Ÿäº†ã€‚ç„¶è€Œï¼Œç”±äºå†™å…¥ç¼“å­˜çš„ä½¿ç”¨å¢åŠ ï¼Œè¿™ç§æ–¹æ³•ä¸å†æœ‰æ•ˆã€‚å¯ç”¨å†™å…¥ç¼“å­˜åï¼Œç£ç›˜å¯èƒ½ä¼šåœ¨å°†æ•°æ®æ”¾ç½®åœ¨å†…å­˜ç¼“å­˜ä¸­åé€šçŸ¥æ“ä½œç³»ç»Ÿå†™å…¥å·²å®Œæˆï¼Œè€Œä¸æ˜¯ç«‹å³å°†æ•°æ®å†™å…¥ç£ç›˜ã€‚è¿™ä½¿å¾—æ— æ³•ä¿è¯å…ˆå‰çš„å†™å…¥åœ¨åç»­å†™å…¥ä¹‹å‰åˆ°è¾¾ç£ç›˜ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ç¦ç”¨å†™ç¼“å­˜ï¼Œä½†è¿™ä¼šå½±å“æ€§èƒ½ã€‚å¦ä¸€ç§ç°ä»£æ–¹æ³•æ˜¯æ˜ç¡®å‘å‡ºå†™å±éšœï¼Œç¡®ä¿åœ¨å±éšœä¹‹å‰å‘å‡ºçš„æ‰€æœ‰å†™å…¥åœ¨å±éšœä¹‹åå‘å‡ºçš„ä»»ä½•å†™å…¥ä¹‹å‰åˆ°è¾¾ç£ç›˜ã€‚ç„¶è€Œï¼Œæœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ï¼Œä¸€äº›ç£ç›˜åˆ¶é€ å•†ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¯èƒ½ä¼šå¿½ç•¥å†™å±éšœè¯·æ±‚ï¼Œè¿™å¯èƒ½å¯¼è‡´é”™è¯¯æ“ä½œã€‚ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Ÿè¿™ä¸ªäº‹åŠ¡çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„äº‹åŠ¡ï¼ˆå®ƒæœ‰ä¸€ä¸ªå¼€å§‹å’Œç»“æŸï¼Œåºåˆ—å·åŒ¹é…ï¼‰ã€‚æ­¤å¤–ï¼Œæ–‡ä»¶ç³»ç»Ÿæ— æ³•æŸ¥çœ‹ç¬¬å››ä¸ªæ•°æ®å—å¹¶çŸ¥é“å®ƒæ˜¯é”™è¯¯çš„ï¼›æ¯•ç«Ÿï¼Œå®ƒæ˜¯ä»»æ„çš„ç”¨æˆ·æ•°æ®ã€‚å› æ­¤ï¼Œå¦‚æœç³»ç»Ÿç°åœ¨é‡å¯å¹¶è¿è¡Œæ¢å¤ï¼Œå®ƒå°±ä¼šé‡æ”¾æ­¤äº‹åŠ¡ï¼Œå¹¶æ— çŸ¥åœ°å°†åƒåœ¾æ•°æ®å—â€?? â€œçš„å†…å®¹å¤åˆ¶åˆ° Db åº”è¯¥å­˜æ”¾çš„ä½ç½®ã€‚è¿™å¯¹æ–‡ä»¶ä¸­çš„ä»»æ„ç”¨æˆ·æ•°æ®æ¥è¯´æ˜¯å¾ˆç³Ÿç³•çš„ï¼›å¦‚æœå‘ç”Ÿåœ¨æ–‡ä»¶ç³»ç»Ÿçš„å…³é”®éƒ¨åˆ†ï¼Œå¦‚è¶…çº§å—ä¸Šï¼Œæƒ…å†µå°±æ›´ç³Ÿäº†ï¼Œå¯èƒ½å¯¼è‡´æ–‡ä»¶ç³»ç»Ÿæ— æ³•æŒ‚è½½ã€‚ ä¼˜åŒ–æ—¥å¿—å†™å…¥ æ–‡ä»¶ç³»ç»Ÿé¦–å…ˆè¦å†™å‡ºäº‹åŠ¡å¼€å§‹å—å’Œäº‹åŠ¡å†…å®¹ï¼›åªæœ‰åœ¨è¿™äº›å†™å…¥å®Œæˆåï¼Œæ–‡ä»¶ç³»ç»Ÿæ‰èƒ½å°†äº‹åŠ¡ç»“æŸå—å‘é€åˆ°ç£ç›˜ï¼Œè¿™æ ·å†™å…¥æ—¥å¿—çš„æ•ˆç‡ç‰¹åˆ«ä½ï¼Œé€šå¸¸ä¼šäº§ç”Ÿé¢å¤–çš„æ—‹è½¬ï¼ˆå› ä¸ºç£ç›˜é€šå¸¸éœ€è¦ç­‰å¾…æ­£ç¡®çš„æ‰‡åŒºæ—‹è½¬åˆ°ç£å¤´ä¸‹æ–¹æ‰èƒ½è¿›è¡Œå†™å…¥æ“ä½œï¼‰ã€‚ Linux ext4ä¸­åˆ™æä¾›äº†è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼šå°†äº‹åŠ¡å†™å…¥æ—¥å¿—æ—¶ï¼Œåœ¨å¼€å§‹å’Œç»“æŸå—ä¸­åŒ…å«æ—¥å¿—å†…å®¹çš„æ ¡éªŒå’Œã€‚è¿™æ ·åšä½¿æ–‡ä»¶ç³»ç»Ÿèƒ½å¤Ÿä¸€æ¬¡å†™å…¥æ•´ä¸ªäº‹åŠ¡ï¼Œè€Œä¸ä¼šäº§ç”Ÿç­‰å¾…ï¼›å¦‚æœåœ¨æ¢å¤æœŸé—´ï¼Œæ–‡ä»¶ç³»ç»Ÿå‘ç°äº‹åŠ¡ä¸­è®¡ç®—çš„æ ¡éªŒå’Œä¸å­˜å‚¨çš„æ ¡éªŒå’Œä¸åŒ¹é…ï¼Œåˆ™å¯ä»¥æ–­å®šäº‹åŠ¡å†™å…¥æœŸé—´å‘ç”Ÿäº†å´©æºƒï¼Œä»è€Œä¸¢å¼ƒæ–‡ä»¶ç³»ç»Ÿæ›´æ–°ã€‚å› æ­¤ï¼Œé€šè¿‡å¯¹å†™å…¥åè®®å’Œæ¢å¤ç³»ç»Ÿè¿›è¡Œå°çš„è°ƒæ•´ï¼Œæ–‡ä»¶ç³»ç»Ÿå¯ä»¥å®ç°æ›´å¿«çš„å¸¸è§æƒ…å†µæ€§èƒ½ï¼›æœ€é‡è¦çš„æ˜¯ï¼Œç³»ç»Ÿç¨å¾®æ›´å¯é ï¼Œå› ä¸ºä»æ—¥å¿—ä¸­è¯»å–çš„ä»»ä½•å†…å®¹ç°åœ¨éƒ½å—åˆ°æ ¡éªŒå’Œçš„ä¿æŠ¤ã€‚ ä¸ºé¿å…è¿™ä¸€é—®é¢˜ï¼Œæ–‡ä»¶ç³»ç»Ÿåˆ†ä¸¤æ­¥è¿›è¡Œäº‹åŠ¡å†™å…¥ã€‚é¦–å…ˆï¼Œæ–‡ä»¶ç³»ç»Ÿå°†é™¤ TxE å—å¤–çš„æ‰€æœ‰å—å†™å…¥æ—¥å¿—ï¼Œå¹¶ä¸€æ¬¡æ€§å®Œæˆè¿™äº›å†™å…¥æ“ä½œã€‚å½“è¿™äº›å†™å…¥å®Œæˆåï¼Œæ—¥å¿—å°†æ˜¾ç¤ºå¦‚ä¸‹å†…å®¹ï¼š è¿™äº›å†™å…¥å®Œæˆåï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šå‘å‡º TxE å—çš„å†™å…¥ï¼Œä»è€Œä½¿æ—¥å¿—å¤„äºæœ€ç»ˆå®‰å…¨çŠ¶æ€ï¼š è¿™ä¸ªè¿‡ç¨‹çš„ä¸€ä¸ªé‡è¦æ–¹é¢æ˜¯ç£ç›˜æä¾›çš„åŸå­æ€§ä¿è¯ã€‚äº‹å®è¯æ˜ï¼Œç£ç›˜ä¿è¯ä»»ä½• 512 å­—èŠ‚çš„å†™å…¥è¦ä¹ˆå‘ç”Ÿè¦ä¹ˆä¸å‘ç”Ÿï¼ˆç»ä¸ä¼šå†™ä¸€åŠï¼‰ï¼›å› æ­¤ï¼Œè¦ç¡®ä¿ TxE çš„å†™å…¥æ˜¯åŸå­æ€§çš„ï¼Œå°±åº”è¯¥æŠŠå®ƒå˜æˆä¸€ä¸ªå•ä¸€çš„ 512 å­—èŠ‚å—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç›®å‰æ›´æ–°æ–‡ä»¶ç³»ç»Ÿçš„åè®®åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š æ—¥å¿—å†™å…¥ï¼šå°†äº‹åŠ¡å†…å®¹ï¼ˆåŒ…æ‹¬ TxBã€å…ƒæ•°æ®å’Œæ•°æ®ï¼‰å†™å…¥æ—¥å¿—ï¼›ç­‰å¾…å†™å…¥å®Œæˆã€‚ æ—¥å¿—æäº¤ï¼šå°†äº‹åŠ¡æäº¤å—ï¼ˆåŒ…å« TxEï¼‰å†™å…¥æ—¥å¿—ï¼›ç­‰å¾…å†™å…¥å®Œæˆï¼›äº‹åŠ¡å³è¢«æäº¤ã€‚ æ£€æŸ¥ç‚¹ï¼šå°†æ›´æ–°å†…å®¹ï¼ˆå…ƒæ•°æ®å’Œæ•°æ®ï¼‰å†™å…¥ç£ç›˜ä¸Šçš„æœ€ç»ˆä½ç½®ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:2","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.3 æ¢å¤ ç°åœ¨è®©æˆ‘ä»¬äº†è§£æ–‡ä»¶ç³»ç»Ÿå¦‚ä½•ä½¿ç”¨æ—¥å¿—çš„å†…å®¹ä»å´©æºƒä¸­æ¢å¤ã€‚åœ¨æ­¤æ›´æ–°åºåˆ—æœŸé—´éšæ—¶å¯èƒ½å‘ç”Ÿå´©æºƒã€‚ å¦‚æœå´©æºƒå‘ç”Ÿåœ¨äº‹åŠ¡å®‰å…¨å†™å…¥æ—¥å¿—ä¹‹å‰ï¼ˆå³ï¼Œåœ¨ä¸Šé¢çš„æ­¥éª¤ 2 å®Œæˆä¹‹å‰ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å·¥ä½œå°±å¾ˆç®€å•ï¼šåªéœ€è·³è¿‡æŒ‚èµ·çš„æ›´æ–°ã€‚ å¦‚æœå´©æºƒå‘ç”Ÿåœ¨äº‹åŠ¡æäº¤åˆ°æ—¥å¿—ä¹‹åã€æ£€æŸ¥ç‚¹å®Œæˆä¹‹å‰ï¼Œæ–‡ä»¶ç³»ç»Ÿå¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼æ¢å¤æ›´æ–°ã€‚å½“ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿæ¢å¤è¿‡ç¨‹å°†æ‰«ææ—¥å¿—å¹¶æŸ¥æ‰¾å·²æäº¤åˆ°ç£ç›˜çš„äº‹åŠ¡ï¼›å› æ­¤ï¼Œè¿™äº›äº‹åŠ¡ä¼šè¢«é‡æ”¾ï¼ˆæŒ‰é¡ºåºï¼‰ï¼Œæ–‡ä»¶ç³»ç»Ÿå†æ¬¡å°è¯•å°†äº‹åŠ¡ä¸­çš„å—å†™å‡ºåˆ°å®ƒä»¬åœ¨ç£ç›˜ä¸Šçš„æœ€ç»ˆä½ç½®ã€‚è¿™ç§å½¢å¼çš„æ—¥å¿—è®°å½•æ˜¯æœ€ç®€å•çš„å½¢å¼ä¹‹ä¸€ï¼Œç§°ä¸ºé‡åšæ—¥å¿—ã€‚é€šè¿‡æ¢å¤æ—¥å¿—ä¸­å·²æäº¤çš„äº‹åŠ¡ï¼Œæ–‡ä»¶ç³»ç»Ÿç¡®ä¿ç£ç›˜ä¸Šçš„ç»“æ„æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿå¹¶ä¸ºæ–°è¯·æ±‚åšå¥½å‡†å¤‡æ¥ç»§ç»­è¿›è¡Œã€‚ è¯·æ³¨æ„ï¼Œåœ¨æ£€æŸ¥ç‚¹æœŸé—´çš„ä»»ä½•æ—¶å€™å‘ç”Ÿå´©æºƒéƒ½æ˜¯æ­£å¸¸çš„ï¼Œå³ä½¿åœ¨å¯¹å—çš„æœ€ç»ˆä½ç½®çš„ä¸€äº›æ›´æ–°å·²ç»å®Œæˆä¹‹åä¹Ÿæ˜¯å¦‚æ­¤ã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œå…¶ä¸­ä¸€äº›æ›´æ–°åªæ˜¯åœ¨æ¢å¤æœŸé—´å†æ¬¡æ‰§è¡Œã€‚ç”±äºæ¢å¤æ˜¯ä¸€ç§ç½•è§çš„æ“ä½œï¼ˆä»…åœ¨æ„å¤–ç³»ç»Ÿå´©æºƒåå‘ç”Ÿï¼‰ï¼Œå› æ­¤æ— éœ€æ‹…å¿ƒä¸€äº›å†—ä½™å†™å…¥ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:3","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.4 æ‰¹å¤„ç†æ—¥å¿—æ›´æ–° æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼ŒåŸºæœ¬åè®®å¯èƒ½ä¼šå¢åŠ å¤§é‡é¢å¤–çš„ç£ç›˜æµé‡ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬åœ¨åŒä¸€ç›®å½•ä¸­è¿ç»­åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«ç§°ä¸º file1 å’Œ file2ã€‚è¦åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¿…é¡»æ›´æ–°è®¸å¤šç£ç›˜ç»“æ„ï¼Œè‡³å°‘åŒ…æ‹¬ï¼šinode ä½å›¾ï¼ˆåˆ†é…æ–°çš„ inodeï¼‰ã€æ–‡ä»¶æ–°åˆ›å»ºçš„ inodeã€åŒ…å«æ–°ç›®å½•æ¡ç›®çš„çš„çˆ¶ç›®å½•çš„æ•°æ®å—å’Œçˆ¶ç›®å½• inodeï¼ˆç°åœ¨æœ‰æ–°çš„ä¿®æ”¹æ—¶é—´ï¼‰ã€‚é€šè¿‡æ—¥å¿—è®°å½•ï¼Œæˆ‘ä»¬åœ¨é€»è¾‘ä¸Šå°†æ‰€æœ‰è¿™äº›ä¿¡æ¯æäº¤åˆ°æˆ‘ä»¬åˆ›å»ºçš„ä¸¤ä¸ªæ–‡ä»¶çš„æ—¥å¿—ä¸­ï¼›å› ä¸ºè¿™äº›æ–‡ä»¶ä½äºåŒä¸€ç›®å½•ä¸­ï¼Œå¹¶ä¸”å‡è®¾å®ƒä»¬ç”šè‡³åœ¨åŒä¸€ inode å—ä¸­å…·æœ‰ inodeï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬ä¸å°å¿ƒï¼Œæˆ‘ä»¬æœ€ç»ˆå°†ä¸€éåˆä¸€éåœ°å†™å…¥è¿™äº›ç›¸åŒçš„å—ï¼Œå³ç›¸åŒçš„ç›®å½•æ•°æ®å—å’Œ inode å¯èƒ½ä¼šè¢«é‡å¤å†™å…¥ï¼Œé€ æˆäº†é¢å¤–çš„ç£ç›˜æµé‡å’Œæ€§èƒ½å¼€é”€ã€‚ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒæŸäº›æ–‡ä»¶ç³»ç»Ÿä¸ä¼šä¸€æ¬¡å°†æ¯ä¸ªæ›´æ–°æäº¤åˆ°ç£ç›˜ï¼ˆä¾‹å¦‚ï¼ŒLinux ext3ï¼‰ï¼›ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰æ›´æ–°ç¼“å†²åˆ°å…¨å±€äº‹åŠ¡ä¸­ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå½“åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿåªæ˜¯å°†å†…å­˜ä¸­çš„ inode ä½å›¾ã€æ–‡ä»¶çš„ inodeã€ç›®å½•æ•°æ®å’Œç›®å½• inode æ ‡è®°ä¸ºè„ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°å½¢æˆå½“å‰äº‹åŠ¡çš„å—åˆ—è¡¨ä¸­ã€‚å½“æœ€ç»ˆå°†è¿™äº›å—å†™å…¥ç£ç›˜æ—¶ï¼ˆä¾‹å¦‚ï¼Œ5 ç§’è¶…æ—¶åï¼‰ï¼Œå°†æäº¤åŒ…å«ä¸Šè¿°æ‰€æœ‰æ›´æ–°çš„å•ä¸ªå…¨å±€äº‹åŠ¡ã€‚å› æ­¤ï¼Œé€šè¿‡ç¼“å†²æ›´æ–°ï¼Œæ–‡ä»¶ç³»ç»Ÿåœ¨è®¸å¤šæƒ…å†µä¸‹å¯ä»¥é¿å…è¿‡å¤šçš„ç£ç›˜å†™å…¥æµé‡ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:4","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.5 é™åˆ¶æ—¥å¿—å¤§å° å› æ­¤ï¼Œæˆ‘ä»¬å·²ç»è¾¾æˆäº†æ›´æ–°ç£ç›˜ä¸Šæ–‡ä»¶ç³»ç»Ÿç»“æ„çš„åŸºæœ¬åè®®ã€‚æ–‡ä»¶ç³»ç»Ÿåœ¨å†…å­˜ä¸­ç¼“å†²æ›´æ–°ä¸€æ®µæ—¶é—´ï¼›å½“æœ€ç»ˆå†™å…¥ç£ç›˜æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿé¦–å…ˆä»”ç»†åœ°å°†äº‹åŠ¡çš„è¯¦ç»†ä¿¡æ¯å†™å…¥æ—¥å¿—ï¼ˆä¹Ÿç§°ä¸ºé¢„å†™æ—¥å¿—ï¼‰ï¼›äº‹åŠ¡å®Œæˆåï¼Œæ–‡ä»¶ç³»ç»Ÿå°†è¿™äº›å—æ£€æŸ¥ç‚¹åˆ°å®ƒä»¬åœ¨ç£ç›˜ä¸Šçš„æœ€ç»ˆä½ç½®ã€‚ ç„¶è€Œï¼Œæ—¥å¿—çš„å¤§å°æ˜¯æœ‰é™çš„ã€‚å¦‚æœæˆ‘ä»¬ç»§ç»­å‘å…¶ä¸­æ·»åŠ äº‹åŠ¡ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œå®ƒå¾ˆå¿«å°±ä¼šå¡«æ»¡ã€‚ä½ è®¤ä¸ºæ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ æ—¥å¿—æ»¡æ—¶ä¼šå‡ºç°ä¸¤ä¸ªé—®é¢˜ï¼š ç¬¬ä¸€ä¸ªé—®é¢˜æ¯”è¾ƒç®€å•ï¼Œä½†ä¸é‚£ä¹ˆå…³é”®ï¼šæ—¥å¿—è¶Šå¤§ï¼Œæ¢å¤æ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ï¼Œå› ä¸ºæ¢å¤è¿‡ç¨‹å¿…é¡»ï¼ˆæŒ‰é¡ºåºï¼‰é‡æ”¾æ—¥å¿—ä¸­çš„æ‰€æœ‰äº‹åŠ¡æ‰èƒ½æ¢å¤ã€‚ ç¬¬äºŒä¸ªé—®é¢˜æ›´ä¸ºä¸¥é‡ï¼šå½“æ—¥å¿—å·²æ»¡ï¼ˆæˆ–æ¥è¿‘æ»¡ï¼‰æ—¶ï¼Œå°±æ— æ³•å†å‘ç£ç›˜æäº¤ä»»ä½•äº‹åŠ¡ï¼Œä»è€Œä½¿æ–‡ä»¶ç³»ç»Ÿå˜å¾— â€œä¸é‚£ä¹ˆæœ‰ç”¨â€ï¼ˆå³æ— ç”¨ï¼‰ã€‚ ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæ—¥å¿—æ–‡ä»¶ç³»ç»Ÿå°†æ—¥å¿—è§†ä¸ºå¾ªç¯æ•°æ®ç»“æ„ï¼Œä¸æ–­é‡å¤ä½¿ç”¨ï¼›è¿™å°±æ˜¯æ—¥å¿—æœ‰æ—¶è¢«ç§°ä¸ºå¾ªç¯æ—¥å¿—çš„åŸå› ã€‚ä¸ºæ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿå¿…é¡»åœ¨æ£€æŸ¥ç‚¹ä¹‹åçš„ä¸€æ®µæ—¶é—´å†…é‡‡å–è¡ŒåŠ¨ã€‚å…·ä½“æ¥è¯´ï¼Œä¸€æ—¦äº‹åŠ¡è¢«æ£€æŸ¥ç‚¹åŒ–ï¼Œæ–‡ä»¶ç³»ç»Ÿå°±åº”é‡Šæ”¾æ—¥å¿—ä¸­å ç”¨çš„ç©ºé—´ï¼Œå…è®¸æ—¥å¿—ç©ºé—´è¢«é‡å¤ä½¿ç”¨ã€‚å®ç°è¿™ä¸€ç›®çš„çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ï¼Œä½ å¯ä»¥ç®€å•åœ°åœ¨æ—¥å¿—è¶…çº§å—ä¸­æ ‡è®°æ—¥å¿—ä¸­æœ€æ—§å’Œæœ€æ–°çš„éæ£€æŸ¥ç‚¹äº‹åŠ¡ï¼Œå…¶ä»–æ‰€æœ‰ç©ºé—´éƒ½æ˜¯ç©ºé—²çš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå›¾è¡¨è¯´æ˜ï¼š åœ¨æ—¥å¿—è¶…çº§å—ï¼ˆä¸è¦ä¸ä¸»æ–‡ä»¶ç³»ç»Ÿè¶…çº§å—æ··æ·†ï¼‰ä¸­ï¼Œæ—¥å¿—ç³»ç»Ÿè®°å½•è¶³å¤Ÿçš„ä¿¡æ¯ä»¥äº†è§£å“ªäº›äº‹åŠ¡å°šæœªè®¾ç½®æ£€æŸ¥ç‚¹ï¼Œä»è€Œå‡å°‘æ¢å¤æ—¶é—´å¹¶å…è®¸ä»¥å¾ªç¯æ–¹å¼é‡å¤ä½¿ç”¨æ—¥å¿—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åŸºæœ¬åè®®ä¸­æ·»åŠ äº†å¦ä¸€ä¸ªæ­¥éª¤ï¼š æ—¥å¿—å†™å…¥ï¼šå°†äº‹åŠ¡å†…å®¹ï¼ˆåŒ…å« TxB å’Œæ›´æ–°å†…å®¹ï¼‰å†™å…¥æ—¥å¿—ï¼Œç­‰å¾…è¿™äº›å†™å…¥å®Œæˆã€‚ æ—¥å¿—æäº¤ï¼šå°†äº‹åŠ¡æäº¤å—ï¼ˆåŒ…å«TxEï¼‰å†™å…¥æ—¥å¿—ï¼Œç­‰å¾…å†™å…¥å®Œæˆï¼Œäº‹åŠ¡ç°å·²æäº¤ã€‚ æ£€æŸ¥ç‚¹ï¼šå°†æ›´æ–°å†…å®¹å†™å…¥æ–‡ä»¶ç³»ç»Ÿä¸­çš„æœ€ç»ˆä½ç½®ã€‚ é‡Šæ”¾ï¼šä¸€æ®µæ—¶é—´åï¼Œé€šè¿‡æ›´æ–°æ—¥å¿—è¶…çº§å—åœ¨æ—¥å¿—ä¸­å°†äº‹åŠ¡æ ‡è®°ä¸ºå·²é‡Šæ”¾ã€‚ è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†æœ€ç»ˆçš„æ•°æ®æ—¥å¿—åè®®ã€‚ä½†ä»ç„¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬å°†æ¯ä¸ªæ•°æ®å—å†™å…¥ç£ç›˜ä¸¤æ¬¡ï¼Œè¿™æ˜¯ä¸€ä¸ªæ²‰é‡çš„æˆæœ¬ï¼Œç‰¹åˆ«æ˜¯å¯¹äºåƒç³»ç»Ÿå´©æºƒè¿™æ ·ç½•è§çš„æƒ…å†µã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:5","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.6 å…ƒæ•°æ®æ—¥å¿— å°½ç®¡ç°åœ¨æ¢å¤é€Ÿåº¦å¾ˆå¿«ï¼ˆæ‰«ææ—¥å¿—å¹¶é‡æ”¾ä¸€äº›äº‹åŠ¡ï¼Œè€Œä¸æ˜¯æ‰«ææ•´ä¸ªç£ç›˜ï¼‰ï¼Œä½†æ–‡ä»¶ç³»ç»Ÿçš„æ­£å¸¸æ“ä½œæ¯”æˆ‘ä»¬æœŸæœ›çš„è¦æ…¢ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¯¹äºæ¯æ¬¡å†™å…¥ç£ç›˜ï¼Œæˆ‘ä»¬ç°åœ¨ä¹Ÿé¦–å…ˆå†™å…¥æ—¥å¿—ï¼Œä»è€Œä½¿å†™å…¥æµé‡åŠ å€ï¼›åœ¨é¡ºåºå†™å…¥å·¥ä½œè´Ÿè½½æœŸé—´ï¼Œè¿™ç§åŠ å€å°¤å…¶ä»¤äººç—›è‹¦ï¼Œç°åœ¨è¯¥å·¥ä½œè´Ÿè½½å°†ä»¥é©±åŠ¨å™¨å³°å€¼å†™å…¥å¸¦å®½çš„ä¸€åŠè¿›è¡Œã€‚æ­¤å¤–ï¼Œåœ¨å†™å…¥æ—¥å¿—å’Œå†™å…¥ä¸»æ–‡ä»¶ç³»ç»Ÿä¹‹é—´ï¼Œå­˜åœ¨æˆæœ¬é«˜æ˜‚çš„æŸ¥æ‰¾ï¼Œè¿™æ˜¾ç€å¢åŠ äº†æŸäº›å·¥ä½œè´Ÿè½½çš„å¼€é”€ã€‚ ç”±äºå°†æ¯ä¸ªæ•°æ®å—å†™å…¥ç£ç›˜ä¸¤æ¬¡çš„æˆæœ¬å¾ˆé«˜ï¼Œå› æ­¤äººä»¬å°è¯•äº†ä¸€äº›ä¸åŒçš„æ–¹æ³•æ¥æé«˜æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¸Šé¢æè¿°çš„æ—¥å¿—æ¨¡å¼é€šå¸¸ç§°ä¸ºæ•°æ®æ—¥å¿—ï¼ˆå¦‚åœ¨ Linux ext3 ä¸­ï¼‰ï¼Œå› ä¸ºå®ƒè®°å½•æ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼ˆé™¤äº†æ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ï¼‰ã€‚ä¸€ç§æ›´ç®€å•ï¼ˆä¹Ÿæ›´å¸¸è§ï¼‰çš„æ—¥å¿—å½¢å¼æœ‰æ—¶ç§°ä¸ºæœ‰åºæ—¥å¿—ï¼ˆæˆ–åªæ˜¯å…ƒæ•°æ®æ—¥å¿—ï¼‰ï¼Œå®ƒå‡ ä¹ç›¸åŒï¼Œåªæ˜¯ç”¨æˆ·æ•°æ®ä¸å†™å…¥æ—¥å¿—ã€‚å› æ­¤ï¼Œå½“æ‰§è¡Œä¸ä¸Šè¿°ç›¸åŒçš„æ›´æ–°æ—¶ï¼Œä»¥ä¸‹ä¿¡æ¯å°†è¢«å†™å…¥æ—¥å¿—ï¼š ä¹‹å‰å†™å…¥æ—¥å¿—çš„æ•°æ®å— Db å°†è¢«å†™å…¥æ–‡ä»¶ç³»ç»Ÿæœ¬èº«ï¼Œé¿å…äº†é¢å¤–çš„å†™å…¥ï¼›è€ƒè™‘åˆ°ç£ç›˜çš„å¤§éƒ¨åˆ† I/O æµé‡éƒ½æ˜¯æ•°æ®ï¼Œä¸é‡å¤å†™å…¥æ•°æ®å¤§å¤§å‡å°‘äº†æ—¥å¿—çš„ I/O è´Ÿè½½ã€‚ä¸è¿‡ï¼Œè¿™ä¸€ä¿®æ”¹ç¡®å®æå‡ºäº†ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼šæˆ‘ä»¬åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™å°†æ•°æ®å—å†™å…¥ç£ç›˜ï¼Ÿ ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹è¿½åŠ æ–‡ä»¶çš„ä¾‹å­ã€‚æ›´æ–°ç”±ä¸‰ä¸ªæ•°æ®å—ç»„æˆï¼šI[v2]ã€B[v2] å’Œ Dbã€‚å‰ä¸¤ä¸ªå—éƒ½æ˜¯å…ƒæ•°æ®ï¼Œä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œç„¶åè¿›è¡Œæ£€æŸ¥ç‚¹å¤„ç†ï¼›åä¸€ä¸ªå—åªä¼šè¢«å†™å…¥æ–‡ä»¶ç³»ç»Ÿä¸€æ¬¡ã€‚æˆ‘ä»¬åº”è¯¥ä½•æ—¶å°† Db å†™å…¥ç£ç›˜ï¼Ÿè¿™é‡è¦å—ï¼Ÿ äº‹å®è¯æ˜ï¼Œå¯¹äºçº¯å…ƒæ•°æ®æ—¥å¿—ï¼Œæ•°æ®å†™å…¥çš„é¡ºåºç¡®å®å¾ˆé‡è¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨äº‹åŠ¡ï¼ˆåŒ…å« I[v2] å’Œ B[v2]ï¼‰å®Œæˆåå°† Db å†™å…¥ç£ç›˜ï¼Œä¼šæ€æ ·ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€è‡´çš„ï¼Œä½† I[v2] æœ€ç»ˆå¯èƒ½æŒ‡å‘åƒåœ¾æ•°æ®ã€‚å…·ä½“æ¥è¯´ï¼Œè€ƒè™‘ I[v2] å’Œ B[v2] å·²è¢«å†™å…¥ï¼Œä½† Db æœªè¢«å†™å…¥ç£ç›˜çš„æƒ…å†µã€‚è¿™æ—¶æ–‡ä»¶ç³»ç»Ÿä¼šå°è¯•æ¢å¤ã€‚ç”±äº Db ä¸åœ¨æ—¥å¿—ä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†é‡æ”¾å¯¹ I[v2] å’Œ B[v2] çš„å†™å…¥ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªä¸€è‡´çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆä»æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®çš„è§’åº¦æ¥çœ‹ï¼‰ã€‚ä½†æ˜¯ï¼ŒI[v2] å°†æŒ‡å‘åƒåœ¾æ•°æ®ï¼Œå³ Db æ‰€åœ¨æ§½ä¸­çš„ä»»ä½•æ•°æ®ã€‚ ä¸ºäº†ç¡®ä¿è¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿï¼Œä¸€äº›æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ Linux ext3ï¼‰ä¼šåœ¨å°†ç›¸å…³å…ƒæ•°æ®å†™å…¥ç£ç›˜ä¹‹å‰ï¼Œå…ˆå°†æ•°æ®å—ï¼ˆå¸¸è§„æ–‡ä»¶ï¼‰å†™å…¥ç£ç›˜ã€‚ å…·ä½“æ¥è¯´ï¼Œåè®®å¦‚ä¸‹ï¼š æ•°æ®å†™å…¥ï¼šå°†æ•°æ®å†™å…¥æœ€ç»ˆä½ç½®ï¼Œç­‰å¾…å®Œæˆï¼ˆç­‰å¾…æ˜¯å¯é€‰çš„ï¼Œè¯¦è§ä¸‹æ–‡ï¼‰ã€‚ æ—¥å¿—å…ƒæ•°æ®å†™å…¥ï¼šå°†èµ·å§‹å—å’Œå…ƒæ•°æ®å†™å…¥æ—¥å¿—ï¼Œç­‰å¾…å†™å…¥å®Œæˆã€‚ æ—¥å¿—æäº¤ï¼šå°†äº‹åŠ¡æäº¤å—ï¼ˆåŒ…å« TxEï¼‰å†™å…¥æ—¥å¿—ï¼Œç­‰å¾…å†™å…¥å®Œæˆï¼Œäº‹åŠ¡ï¼ˆåŒ…æ‹¬æ•°æ®ï¼‰ç°å·²æäº¤ã€‚ æ£€æŸ¥ç‚¹å…ƒæ•°æ®ï¼šå°†å…ƒæ•°æ®æ›´æ–°å†…å®¹å†™å…¥æ–‡ä»¶ç³»ç»Ÿä¸­çš„æœ€ç»ˆä½ç½®ã€‚ é‡Šæ”¾ï¼šä¹‹åï¼Œåœ¨æ—¥å¿—è¶…çº§å—ä¸­æ ‡è®°äº‹åŠ¡é‡Šæ”¾ã€‚ é€šè¿‡å¼ºåˆ¶å…ˆå†™å…¥æ•°æ®ï¼Œæ–‡ä»¶ç³»ç»Ÿå¯ä»¥ä¿è¯æŒ‡é’ˆæ°¸è¿œä¸ä¼šæŒ‡å‘åƒåœ¾æ–‡ä»¶ã€‚äº‹å®ä¸Šï¼Œ\"å…ˆå†™è¢«æŒ‡å‘å¯¹è±¡ï¼Œå†å†™æŒ‡å‘è¯¥å¯¹è±¡çš„å¯¹è±¡ â€œè¿™ä¸€è§„åˆ™æ˜¯å´©æºƒä¸€è‡´æ€§çš„æ ¸å¿ƒï¼Œå…¶ä»–å´©æºƒä¸€è‡´æ€§æ–¹æ¡ˆä¹Ÿè¿›ä¸€æ­¥åˆ©ç”¨äº†è¿™ä¸€è§„åˆ™ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ã€‚ åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå…ƒæ•°æ®æ—¥å¿—ï¼ˆç±»ä¼¼äº ext3 çš„æœ‰åºæ—¥å¿—ï¼‰æ¯”å®Œæ•´æ•°æ®æ—¥å¿—æ›´å—æ¬¢è¿ã€‚ä¾‹å¦‚ï¼ŒWindows NTFS å’Œ SGI çš„ XFS éƒ½ä½¿ç”¨æŸç§å½¢å¼çš„å…ƒæ•°æ®æ—¥å¿—ã€‚ Linux ext3 å…è®¸æ‚¨é€‰æ‹©æ•°æ®ã€æœ‰åºæˆ–æ— åºæ¨¡å¼ï¼ˆåœ¨æ— åºæ¨¡å¼ä¸‹ï¼Œå¯ä»¥éšæ—¶å†™å…¥æ•°æ®ï¼‰ã€‚æ‰€æœ‰è¿™äº›æ¨¡å¼éƒ½ä¿æŒå…ƒæ•°æ®ä¸€è‡´ï¼›å®ƒä»¬çš„æ•°æ®è¯­ä¹‰å„ä¸ç›¸åŒã€‚ æœ€åï¼Œè¯·æ³¨æ„ï¼Œå¦‚ä¸Šè¿°åè®®æ‰€ç¤ºï¼Œåœ¨å‘æ—¥å¿—å‘å‡ºå†™å…¥ï¼ˆæ­¥éª¤ 2ï¼‰ä¹‹å‰å¼ºåˆ¶å®Œæˆæ•°æ®å†™å…¥ï¼ˆæ­¥éª¤ 1ï¼‰å¹¶ä¸æ˜¯æ­£ç¡®æ€§æ‰€å¿…éœ€çš„ã€‚å…·ä½“æ¥è¯´ï¼Œæœ€å¥½åŒæ—¶å¯¹æ•°æ®ã€äº‹åŠ¡å¼€å§‹å—å’Œæ—¥å¿—å…ƒæ•°æ®è¿›è¡Œå†™å…¥ï¼›å”¯ä¸€çœŸæ­£çš„è¦æ±‚æ˜¯æ­¥éª¤ 1 å’Œ 2 åœ¨å‘å¸ƒæ—¥å¿—æäº¤å—ï¼ˆæ­¥éª¤ 3ï¼‰ä¹‹å‰å®Œæˆã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:6","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.7 æ£˜æ‰‹çš„æƒ…å†µï¼šå—é‡ç”¨ æœ‰ä¸€äº›æœ‰è¶£çš„æƒ…å†µä¼šè®©æ—¥å¿—è®°å½•å˜å¾—æ›´åŠ æ£˜æ‰‹ï¼Œå› æ­¤å€¼å¾—è®¨è®ºã€‚å…¶ä¸­è®¸å¤šæƒ…å†µéƒ½ä¸å—é‡ç”¨æœ‰å…³ï¼›æ­£å¦‚Stephen Tweedieï¼ˆext3 çš„ä¸»è¦å¹•åæ¨æ‰‹ä¹‹ä¸€ï¼‰æ‰€è¯´ï¼š â€œæ•´ä¸ªç³»ç»Ÿæœ€å¯æ€•çš„éƒ¨åˆ†æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯åˆ é™¤æ–‡ä»¶ã€‚ä¸åˆ é™¤æœ‰å…³çš„ä¸€åˆ‡éƒ½ä»¤äººæ¯›éª¨æ‚šç„¶ã€‚æ‰€æœ‰ä¸åˆ é™¤æœ‰å…³çš„äº‹æƒ…â€¦â€¦éƒ½ä¼šè®©ä½ åšå™©æ¢¦ï¼Œå› ä¸ºå¦‚æœå—è¢«åˆ é™¤ï¼Œç„¶åé‡æ–°åˆ†é…ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ Tweedieç»™å‡ºçš„å…·ä½“ä¾‹å­å¦‚ä¸‹ã€‚å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨æŸç§å½¢å¼çš„å…ƒæ•°æ®æ—¥å¿—ï¼ˆå› æ­¤æ–‡ä»¶çš„æ•°æ®å—æ²¡æœ‰æ—¥å¿—ï¼‰ã€‚å‡è®¾æœ‰ä¸€ä¸ªåä¸º foo çš„ç›®å½•ã€‚ç”¨æˆ·å‘ foo æ·»åŠ æ¡ç›®ï¼ˆæ¯”å¦‚åˆ›å»ºæ–‡ä»¶ï¼‰ï¼Œå› æ­¤ foo çš„å†…å®¹ï¼ˆå› ä¸ºç›®å½•è¢«è§†ä¸ºå…ƒæ•°æ®ï¼‰è¢«å†™å…¥æ—¥å¿—ï¼›å‡è®¾ foo ç›®å½•æ•°æ®çš„ä½ç½®æ˜¯å— 1000ã€‚æ—¥å¿—å†…å®¹å¦‚ä¸‹ æ­¤æ—¶ï¼Œç”¨æˆ·åˆ é™¤ç›®å½•ä¸­çš„æ‰€æœ‰å†…å®¹ä»¥åŠç›®å½•æœ¬èº«ï¼Œä»è€Œé‡Šæ”¾å— 1000 ä»¥ä¾›é‡å¤ä½¿ç”¨ã€‚æœ€åï¼Œç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼ˆä¾‹å¦‚ foobarï¼‰ï¼Œæœ€ç»ˆä¼šé‡ç”¨æ›¾ç»å±äº foo çš„ç›¸åŒå—ï¼ˆ1000ï¼‰ã€‚ foobar çš„ inode åŠå…¶æ•°æ®éƒ½æäº¤åˆ°ç£ç›˜ï¼›ä½†è¯·æ³¨æ„ï¼Œç”±äºæ­£åœ¨ä½¿ç”¨å…ƒæ•°æ®æ—¥å¿—ï¼Œå› æ­¤åªæœ‰ foobar çš„ inode ä¼šæäº¤åˆ°æ—¥å¿—ï¼›æ–‡ä»¶ foobar ä¸­å— 1000 ä¸­æ–°å†™å…¥çš„æ•°æ®æœªè®°å½•ã€‚ ç°åœ¨å‡è®¾å‘ç”Ÿäº†å´©æºƒï¼Œå¹¶ä¸”æ‰€æœ‰è¿™äº›ä¿¡æ¯ä»åœ¨æ—¥å¿—ä¸­ã€‚åœ¨é‡æ”¾æœŸé—´ï¼Œæ¢å¤è¿‡ç¨‹åªæ˜¯é‡æ”¾æ—¥å¿—ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å— 1000 ä¸­ç›®å½•æ•°æ®çš„å†™å…¥ï¼›å› æ­¤ï¼Œé‡è®¿ä¼šç”¨æ—§ç›®å½•å†…å®¹è¦†ç›–å½“å‰æ–‡ä»¶ foobar çš„ç”¨æˆ·æ•°æ®ï¼æ˜¾ç„¶è¿™ä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„æ¢å¤æ“ä½œï¼Œå¹¶ä¸”å½“ç”¨æˆ·è¯»å–æ–‡ä»¶ foobar æ—¶è‚¯å®šä¼šæ„Ÿåˆ°æƒŠè®¶ã€‚ å¯¹äºè¿™ä¸ªé—®é¢˜æœ‰å¤šç§è§£å†³æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼Œäººä»¬å¯ä»¥æ°¸è¿œä¸ä¼šé‡ç”¨å—ï¼Œç›´åˆ°ä»æ—¥å¿—ä¸­æ£€æŸ¥åˆ°åˆ é™¤æ‰€è¿°å—ä¸ºæ­¢ã€‚ Linux ext3 æ‰€åšçš„æ˜¯å‘æ—¥å¿—æ·»åŠ ä¸€ç§æ–°ç±»å‹çš„è®°å½•ï¼Œç§°ä¸ºæ’¤é”€è®°å½•ã€‚åœ¨ä¸Šè¿°æƒ…å†µä¸‹ï¼Œåˆ é™¤ç›®å½•å°†å¯¼è‡´æ’¤é”€è®°å½•å†™å…¥æ—¥å¿—ã€‚é‡æ”¾æ—¥å¿—æ—¶ï¼Œç³»ç»Ÿé¦–å…ˆæ‰«ææ­¤ç±»æ’¤é”€è®°å½•ï¼›ä»»ä½•æ­¤ç±»æ’¤é”€çš„æ•°æ®éƒ½ä¸ä¼šè¢«é‡æ”¾ï¼Œä»è€Œé¿å…äº†ä¸Šè¿°é—®é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:7","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.8 æ€»ç»“æ—¥è®°ï¼šæ—¶é—´è½´ åœ¨ç»“æŸå¯¹æ—¥å¿—çš„è®¨è®ºä¹‹å‰ï¼Œæˆ‘ä»¬ç”¨æ—¶é—´è½´æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬è®¨è®ºè¿‡çš„åè®®ã€‚ä¸Šå›¾æ˜¾ç¤ºäº†è®°å½•æ•°æ®å’Œå…ƒæ•°æ®æ—¶çš„åè®®ï¼Œè€Œä¸‹å›¾æ˜¾ç¤ºäº†åªè®°å½•å…ƒæ•°æ®æ—¶çš„åè®®ã€‚ åœ¨æ¯ä¸ªå›¾ä¸­ï¼Œæ—¶é—´éƒ½æ˜¯å‘ä¸‹é€’å¢çš„ï¼Œå›¾ä¸­çš„æ¯ä¸€è¡Œéƒ½æ˜¾ç¤ºäº†å¯ä»¥å‘å‡ºæˆ–å¯èƒ½å®Œæˆå†™å…¥çš„é€»è¾‘æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œåœ¨æ•°æ®æ—¥å¿—åè®®ï¼ˆç¬¬ä¸€å¼ å›¾ï¼‰ä¸­ï¼Œäº‹åŠ¡å¼€å§‹å—ï¼ˆTxBï¼‰çš„å†™å…¥å’Œäº‹åŠ¡å†…å®¹çš„å†™å…¥åœ¨é€»è¾‘ä¸Šå¯ä»¥åŒæ—¶å‘å‡ºï¼Œå› æ­¤å¯ä»¥æŒ‰ä»»æ„é¡ºåºå®Œæˆï¼›ä½†äº‹åŠ¡ç»“æŸå—ï¼ˆTxEï¼‰çš„å†™å…¥å¿…é¡»åœ¨å‰è¿°å†™å…¥å®Œæˆåæ‰èƒ½å‘å‡ºã€‚åŒæ ·ï¼Œåœ¨äº‹åŠ¡ç»“æŸå—æäº¤ä¹‹å‰ï¼Œä¹Ÿä¸èƒ½å¼€å§‹å¯¹æ•°æ®å’Œå…ƒæ•°æ®å—è¿›è¡Œæ£€æŸ¥ç‚¹å†™å…¥ã€‚æ°´å¹³è™šçº¿è¡¨ç¤ºå¿…é¡»éµå®ˆå†™å…¥æ’åºè¦æ±‚çš„ä½ç½®ã€‚ å…ƒæ•°æ®æ—¥å¿—åè®®ä¹Ÿæœ‰ç±»ä¼¼çš„æ—¶é—´è½´ã€‚è¯·æ³¨æ„ï¼Œæ•°æ®å†™å…¥åœ¨é€»è¾‘ä¸Šå¯ä»¥ä¸äº‹åŠ¡å¼€å§‹å’Œæ—¥å¿—å†…å®¹çš„å†™å…¥åŒæ—¶å‘å‡ºï¼Œä½†å¿…é¡»åœ¨äº‹åŠ¡ç»“æŸå‘å‡ºå‰å‘å‡ºå¹¶å®Œæˆã€‚ æœ€åè¦æ³¨æ„çš„æ˜¯ï¼Œæ—¶é—´è½´ä¸­æ ‡è®°çš„æ¯æ¬¡å†™å…¥çš„å®Œæˆæ—¶é—´æ˜¯ä»»æ„çš„ã€‚åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œå®Œæˆæ—¶é—´ç”± I/O å­ç³»ç»Ÿå†³å®šï¼Œå®ƒå¯èƒ½ä¼šé‡æ–°å®‰æ’å†™å…¥é¡ºåºä»¥æé«˜æ€§èƒ½ã€‚æˆ‘ä»¬å¯¹æ’åºçš„å”¯ä¸€ä¿è¯æ˜¯åè®®æ­£ç¡®æ€§æ‰€å¿…é¡»æ‰§è¡Œçš„ï¼ˆå¦‚å›¾ä¸­çš„æ°´å¹³è™šçº¿æ‰€ç¤ºï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:4:8","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 è§£å†³æ–¹æ¡ˆ#3ï¼šå…¶ä»–æ–¹æ³• åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æè¿°äº†ä¿æŒæ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®ä¸€è‡´æ€§çš„ä¸¤ç§æ–¹æ³•ï¼š åŸºäº fsck çš„æƒ°æ€§æ–¹æ³• æ—¥å¿—è®°å½•çš„æ›´ä¸»åŠ¨çš„æ–¹æ³•ã€‚ ç„¶è€Œï¼Œè¿™äº›å¹¶ä¸æ˜¯å”¯ä¸€çš„ä¸¤ç§æ–¹æ³•ã€‚ Ganger å’Œ Patt æå‡ºäº†ä¸€ç§è¿™æ ·çš„æ–¹æ³•ï¼Œç§°ä¸ºè½¯æ›´æ–°ã€‚è¿™ç§æ–¹æ³•ä»”ç»†åœ°å¯¹æ–‡ä»¶ç³»ç»Ÿçš„æ‰€æœ‰å†™å…¥è¿›è¡Œæ’åºï¼Œä»¥ç¡®ä¿ç£ç›˜ä¸Šçš„ç»“æ„æ°¸è¿œä¸ä¼šå¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åœ¨æŒ‡å‘å®ƒçš„inodeä¹‹å‰å°†ä¸€ä¸ªæŒ‡å‘çš„æ•°æ®å—å†™å…¥ç£ç›˜ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿è¯¥inodeæ°¸è¿œä¸ä¼šæŒ‡å‘åƒåœ¾ï¼›å¯¹äºæ–‡ä»¶ç³»ç»Ÿçš„æ‰€æœ‰ç»“æ„éƒ½å¯ä»¥å¯¼å‡ºç±»ä¼¼çš„è§„åˆ™ã€‚ç„¶è€Œï¼Œå®æ–½è½¯æ›´æ–°å¯èƒ½æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼›è™½ç„¶ä¸Šè¿°æ—¥å¿—å±‚å¯ä»¥åœ¨å¯¹ç¡®åˆ‡æ–‡ä»¶ç³»ç»Ÿç»“æ„ç›¸å¯¹è¾ƒå°‘çš„äº†è§£çš„æƒ…å†µä¸‹å®ç°ï¼Œä½†è½¯æ›´æ–°éœ€è¦å¯¹æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„çš„å¤æ‚äº†è§£ï¼Œä»è€Œç»™ç³»ç»Ÿå¢åŠ äº†ç›¸å½“å¤šçš„å¤æ‚æ€§ã€‚ å¦ä¸€ç§æ–¹æ³•ç§°ä¸ºå†™æ—¶å¤åˆ¶ï¼ˆCOWï¼‰ï¼Œå¹¶åœ¨è®¸å¤šæµè¡Œçš„æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨ï¼ŒåŒ…æ‹¬ Sun çš„ ZFSã€‚æ­¤æŠ€æœ¯æ°¸è¿œä¸ä¼šè¦†ç›–åŸä½çš„æ–‡ä»¶æˆ–ç›®å½•ï¼›ç›¸åï¼Œå®ƒå°†æ–°çš„æ›´æ–°æ”¾ç½®åˆ°ç£ç›˜ä¸Šä»¥å‰æœªä½¿ç”¨çš„ä½ç½®ã€‚å®Œæˆå¤šæ¬¡æ›´æ–°åï¼ŒCOW æ–‡ä»¶ç³»ç»Ÿä¼šç¿»è½¬æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç»“æ„ä»¥åŒ…å«æŒ‡å‘æ–°æ›´æ–°çš„ç»“æ„çš„æŒ‡é’ˆã€‚ COW æŠ€æœ¯çš„ä¸€ä¸ªé‡è¦ä¼˜ç‚¹æ˜¯å®ƒä½¿å¾—ä¿æŒæ–‡ä»¶ç³»ç»Ÿçš„ä¸€è‡´æ€§å˜å¾—æ›´åŠ ç®€å•ã€‚ç”±äºåŸå§‹æ•°æ®æ²¡æœ‰è¢«ç›´æ¥ä¿®æ”¹ï¼Œå› æ­¤ä¸éœ€è¦å¤æ‚çš„åŒæ­¥æˆ–å›æ»šæœºåˆ¶æ¥ç»´æŠ¤ä¸€è‡´æ€§ï¼Œè€Œæ˜¯é€šè¿‡ç®€å•åœ°ä¿®æ”¹æŒ‡å‘æ–°æ•°æ®çš„æŒ‡é’ˆæ¥å®ç°ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯åä¸ºåŸºäºåå‘æŒ‡é’ˆçš„ä¸€è‡´æ€§ï¼ˆbackpointer-based consistency, BBCï¼‰çš„æŠ€æœ¯ä¸­ï¼Œå†™å…¥ä¹‹é—´ä¸å¼ºåˆ¶æ‰§è¡Œä»»ä½•é¡ºåºã€‚ä¸ºäº†å®ç°ä¸€è‡´æ€§ï¼Œç³»ç»Ÿä¸­çš„æ¯ä¸ªå—éƒ½æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„åå‘æŒ‡é’ˆï¼›ä¾‹å¦‚ï¼Œæ¯ä¸ªæ•°æ®å—éƒ½æœ‰å¯¹å…¶æ‰€å±inodeçš„å¼•ç”¨ã€‚å½“è®¿é—®æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿå¯ä»¥é€šè¿‡æ£€æŸ¥å‰å‘æŒ‡é’ˆï¼ˆä¾‹å¦‚ï¼Œinode æˆ–ç›´æ¥å—ä¸­çš„åœ°å€ï¼‰æ˜¯å¦æŒ‡å‘å¼•ç”¨å®ƒçš„å—æ¥ç¡®å®šæ–‡ä»¶æ˜¯å¦ä¸€è‡´ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œåˆ™æ‰€æœ‰å†…å®¹éƒ½å¿…é¡»å·²å®‰å…¨åˆ°è¾¾ç£ç›˜ï¼Œå› æ­¤æ–‡ä»¶æ˜¯ä¸€è‡´çš„ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™æ–‡ä»¶ä¸ä¸€è‡´ï¼Œå¹¶è¿”å›é”™è¯¯ã€‚é€šè¿‡å‘æ–‡ä»¶ç³»ç»Ÿæ·»åŠ åå‘æŒ‡é’ˆï¼Œå¯ä»¥è·å¾—ä¸€ç§æ–°å½¢å¼çš„æƒ°æ€§å´©æºƒä¸€è‡´æ€§ã€‚ æœ€åï¼Œè¿˜æœ‰ä¸€ç§å‡å°‘æ—¥å¿—åè®®ç­‰å¾…ç£ç›˜å†™å…¥å®Œæˆçš„æ¬¡æ•°çš„æŠ€æœ¯ã€‚è¿™ç§æ–°æ–¹æ³•è¢«ç§°ä¸ºä¹è§‚å´©æºƒä¸€è‡´æ€§ï¼Œé€šè¿‡ä½¿ç”¨äº‹åŠ¡æ ¡éªŒå’Œçš„é€šç”¨å½¢å¼å‘ç£ç›˜å‘å‡ºå°½å¯èƒ½å¤šçš„å†™å…¥ï¼Œå¹¶åŒ…å«ä¸€äº›å…¶ä»–æŠ€æœ¯æ¥æ£€æµ‹å‡ºç°çš„ä¸ä¸€è‡´æƒ…å†µã€‚å¯¹äºæŸäº›å·¥ä½œè´Ÿè½½ï¼Œè¿™äº›ä¹è§‚æŠ€æœ¯å¯ä»¥å°†æ€§èƒ½æé«˜ä¸€ä¸ªæ•°é‡çº§ã€‚ç„¶è€Œï¼Œè¦çœŸæ­£æ­£å¸¸è¿è¡Œï¼Œéœ€è¦ç¨å¾®ä¸åŒçš„ç£ç›˜æ¥å£ã€‚ ","date":"2024-05-11","objectID":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/:5:0","tags":["OS"],"title":"FSCKå’Œæ—¥å¿—","uri":"/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 æ—§Unixæ“ä½œç³»ç»Ÿçš„é—®é¢˜ UNIX æ“ä½œç³»ç»Ÿé—®ä¸–ä¹‹åˆï¼ŒUNIXå¥‡æ‰Ken Thompsonè‡ªå·±ç¼–å†™äº†ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚æˆ‘ä»¬ç§°ä¹‹ä¸º â€œè€ UNIX æ–‡ä»¶ç³»ç»Ÿâ€ï¼Œå®ƒéå¸¸ç®€å•ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒçš„æ•°æ®ç»“æ„åœ¨ç£ç›˜ä¸Šçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š è¶…çº§å— (S) åŒ…å«æœ‰å…³æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼šå·æœ‰å¤šå¤§ã€æœ‰å¤šå°‘ inodeã€æŒ‡å‘ç©ºé—²å—åˆ—è¡¨å¤´éƒ¨çš„æŒ‡é’ˆç­‰ç­‰ã€‚ç£ç›˜çš„inodeåŒºåŸŸåŒ…å«æ–‡ä»¶ç³»ç»Ÿçš„æ‰€æœ‰inodesã€‚æœ€åï¼Œå¤§éƒ¨åˆ†ç£ç›˜éƒ½è¢«æ•°æ®å—å ç”¨äº†ã€‚ æ—§æ–‡ä»¶ç³»ç»Ÿçš„å¥½å¤„æ˜¯å®ƒå¾ˆç®€å•ï¼Œå¹¶ä¸”æ”¯æŒæ–‡ä»¶ç³»ç»Ÿè¯•å›¾æä¾›çš„åŸºæœ¬æŠ½è±¡ï¼šæ–‡ä»¶å’Œç›®å½•å±‚æ¬¡ç»“æ„ã€‚è¿™ä¸ªæ˜“äºä½¿ç”¨çš„ç³»ç»Ÿæ˜¯ä»è¿‡å»ç¬¨æ‹™çš„ã€åŸºäºè®°å½•çš„å­˜å‚¨ç³»ç»Ÿå‘å‰è¿ˆå‡ºçš„çœŸæ­£ä¸€æ­¥ï¼Œå¹¶ä¸”ç›®å½•å±‚æ¬¡ç»“æ„ç›¸å¯¹äºæ—©æœŸç³»ç»Ÿæä¾›çš„æ›´ç®€å•çš„å•çº§å±‚æ¬¡ç»“æ„æ¥è¯´æ˜¯çœŸæ­£çš„è¿›æ­¥ã€‚ é—®é¢˜æ˜¯ï¼šæ€§èƒ½éå¸¸ç³Ÿç³•ã€‚æ ¹æ® Kirk McKusick å’Œä»–åœ¨ä¼¯å…‹åˆ©çš„åŒäº‹çš„æµ‹é‡ï¼Œæ€§èƒ½ä»ä¸€å¼€å§‹å°±å¾ˆç³Ÿç³•ï¼Œè€Œä¸”éšç€æ—¶é—´çš„æ¨ç§»è¶Šæ¥è¶Šå·®ï¼Œåˆ°åæ¥æ–‡ä»¶ç³»ç»Ÿåªèƒ½æä¾›æ•´ä¸ªç£ç›˜å¸¦å®½çš„ 2%ï¼ ä¸»è¦é—®é¢˜åœ¨äºï¼Œæ—§çš„ UNIX æ–‡ä»¶ç³»ç»ŸæŠŠç£ç›˜å½“ä½œéšæœºå­˜å–å­˜å‚¨å™¨æ¥å¤„ç†ï¼›æ•°æ®è¢«åˆ†æ•£åˆ°å„ä¸ªåœ°æ–¹ï¼Œè€Œä¸è€ƒè™‘ä¿å­˜æ•°æ®çš„ä»‹è´¨æ˜¯ç£ç›˜è¿™ä¸€äº‹å®ï¼Œå› æ­¤æœ‰å®é™…è€Œæ˜‚è´µçš„å®šä½æˆæœ¬ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ–‡ä»¶çš„æ•°æ®å—å¾€å¾€ç¦»å…¶ inode å¾ˆè¿œï¼Œå› æ­¤æ¯å½“å…ˆè¯»å– inodeï¼Œç„¶åå†è¯»å–æ–‡ä»¶çš„æ•°æ®å—æ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿæ˜‚è´µçš„å¯»é“ï¼ˆè¿™æ˜¯ä¸€ä¸ªç›¸å½“å¸¸è§çš„æ“ä½œï¼‰ã€‚ æ›´ç³Ÿç³•çš„æ˜¯ï¼Œç”±äºæ²¡æœ‰å¯¹ç©ºé—²ç©ºé—´è¿›è¡Œä»”ç»†ç®¡ç†ï¼Œæ–‡ä»¶ç³»ç»Ÿæœ€ç»ˆä¼šå˜å¾—ç›¸å½“ç¢ç‰‡åŒ–ã€‚ç©ºé—²åˆ—è¡¨æœ€ç»ˆä¼šæŒ‡å‘æ•£å¸ƒåœ¨ç£ç›˜ä¸Šçš„å¤§é‡åŒºå—ï¼Œå½“æ–‡ä»¶è¢«åˆ†é…æ—¶ï¼Œå®ƒä»¬åªä¼šå ç”¨ä¸‹ä¸€ä¸ªç©ºé—²åŒºå—ã€‚å…¶ç»“æœæ˜¯ï¼Œé€»è¾‘ä¸Šè¿ç»­çš„æ–‡ä»¶ä¼šåœ¨ç£ç›˜ä¸Šæ¥å›è®¿é—®ï¼Œä»è€Œå¤§å¤§é™ä½äº†æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸‹é¢çš„æ•°æ®å—åŒºåŸŸåŒ…å«å››ä¸ªæ–‡ä»¶ï¼ˆAã€Bã€C å’Œ Dï¼‰ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°ä¸º 2 ä¸ªæ•°æ®å—ï¼š å¦‚æœåˆ é™¤ B å’Œ Dï¼Œåˆ™ç»“æœå¸ƒå±€ä¸ºï¼š æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œç©ºé—²ç©ºé—´è¢«åˆ†å‰²æˆä¸¤å—ï¼Œæ¯å—ä¸¤ä¸ªåŒºå—ï¼Œè€Œä¸æ˜¯ä¸€å—è¿ç»­çš„å››ä¸ªåŒºå—ã€‚å‡è®¾ä½ ç°åœ¨æƒ³åˆ†é…ä¸€ä¸ªå››å—å¤§å°çš„æ–‡ä»¶ Eï¼š ä½ å¯ä»¥çœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆï¼šE ä¼šè¢«åˆ†æ•£åˆ°æ•´ä¸ªç£ç›˜ï¼Œå› æ­¤åœ¨è®¿é—® E æ—¶ï¼Œç£ç›˜çš„æ€§èƒ½ä¸ä¼šè¾¾åˆ°å³°å€¼ï¼ˆé¡ºåºï¼‰ã€‚è€Œæ˜¯å…ˆè¯»å– E1 å’Œ E2ï¼Œç„¶åå¯»é“ï¼Œå†è¯»å– E3 å’Œ E4ã€‚è¿™ç§ç¢ç‰‡é—®é¢˜åœ¨æ—§çš„ UNIX æ–‡ä»¶ç³»ç»Ÿä¸­ç»å¸¸å‡ºç°ï¼Œè€Œä¸”ä¼šå½±å“æ€§èƒ½ã€‚é¡ºä¾¿æä¸€å¥ï¼šç£ç›˜ç¢ç‰‡æ•´ç†å·¥å…·æ­£æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼›å®ƒä»¬ä¼šé‡ç»„ç£ç›˜ä¸Šçš„æ•°æ®ï¼Œå°†æ–‡ä»¶è¿ç»­æ”¾ç½®ï¼Œå¹¶ä¸ºä¸€ä¸ªæˆ–å‡ ä¸ªè¿ç»­åŒºåŸŸè…¾å‡ºç©ºé—´ï¼Œç§»åŠ¨æ•°æ®ï¼Œç„¶åé‡å†™ inodes ç­‰ï¼Œä»¥åæ˜ å˜åŒ–ã€‚ è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼šåŸå§‹å—å¤§å°å¤ªå°ï¼ˆ512 å­—èŠ‚ï¼‰ã€‚å› æ­¤ï¼Œä»ç£ç›˜ä¼ è¾“æ•°æ®çš„æ•ˆç‡æœ¬æ¥å°±ä¸é«˜ã€‚å—è¶Šå°è¶Šå¥½ï¼Œå› ä¸ºå¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å†…éƒ¨ç¢ç‰‡ï¼ˆå—å†…çš„æµªè´¹ï¼‰ï¼Œä½†å¯¹ä¼ è¾“ä¸åˆ©ï¼Œå› ä¸ºæ¯ä¸ªå—éƒ½å¯èƒ½éœ€è¦å®šä½å¼€é”€æ‰èƒ½åˆ°è¾¾ã€‚è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼š å¦‚ä½•ç»„ç»‡æ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„ä»¥æé«˜æ€§èƒ½ï¼Ÿåœ¨è¿™äº›æ•°æ®ç»“æ„ä¹‹ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å“ªç§ç±»å‹çš„åˆ†é…ç­–ç•¥ï¼Ÿå¦‚ä½•è®©æ–‡ä»¶ç³»ç»Ÿ â€œæ„ŸçŸ¥ç£ç›˜â€ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:1:0","tags":["OS"],"title":"å¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 FFSï¼šç£ç›˜æ„ŸçŸ¥æ˜¯è§£å†³æ–¹æ¡ˆ ä¼¯å…‹åˆ©å¤§å­¦çš„ä¸€ä¸ªå°ç»„å†³å®šå»ºç«‹ä¸€ä¸ªæ›´å¥½ã€æ›´å¿«çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä»–ä»¬å·§å¦™åœ°å°†å…¶ç§°ä¸ºå¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆFFSï¼‰ã€‚ä»–ä»¬çš„æƒ³æ³•æ˜¯è®¾è®¡ â€œç£ç›˜æ„ŸçŸ¥ â€œçš„æ–‡ä»¶ç³»ç»Ÿç»“æ„å’Œåˆ†é…ç­–ç•¥ï¼Œä»è€Œæé«˜æ€§èƒ½ï¼Œä»–ä»¬æ­£æ˜¯è¿™æ ·åšçš„ã€‚å› æ­¤ï¼ŒFFS å¼€å¯äº†æ–‡ä»¶ç³»ç»Ÿç ”ç©¶çš„æ–°çºªå…ƒï¼›é€šè¿‡ä¿ç•™æ–‡ä»¶ç³»ç»Ÿçš„ç›¸åŒæ¥å£ï¼ˆç›¸åŒçš„ APIï¼ŒåŒ…æ‹¬ open()ã€read()ã€write()ã€close() å’Œå…¶ä»–æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œä½†æ”¹å˜å†…éƒ¨å®ç°ï¼Œä½œè€…ä¸ºæ–°æ–‡ä»¶ç³»ç»Ÿçš„æ„å»ºé“ºå¹³äº†é“è·¯ï¼Œè¿™é¡¹å·¥ä½œä¸€ç›´æŒç»­åˆ°ä»Šå¤©ã€‚å‡ ä¹æ‰€æœ‰ç°ä»£æ–‡ä»¶ç³»ç»Ÿéƒ½éµå¾ªç°æœ‰çš„æ¥å£ï¼ˆä»è€Œä¿æŒä¸åº”ç”¨ç¨‹åºçš„å…¼å®¹æ€§ï¼‰ï¼ŒåŒæ—¶å‡ºäºæ€§èƒ½ã€å¯é æ€§æˆ–å…¶ä»–åŸå› æ”¹å˜å…¶å†…éƒ¨ç»“æ„ã€‚ ","date":"2024-05-11","objectID":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:2:0","tags":["OS"],"title":"å¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ç»„ç»‡ç»“æ„ï¼šæŸ±é¢ç»„ ç¬¬ä¸€æ­¥æ˜¯æ›´æ”¹ç£ç›˜ç»“æ„ã€‚ FFS å°†ç£ç›˜åˆ’åˆ†ä¸ºå¤šä¸ªæŸ±é¢ç»„ã€‚å•æŸ±é¢æ˜¯ç¡¬ç›˜é©±åŠ¨å™¨ä¸åŒè¡¨é¢ä¸Šè·é©±åŠ¨å™¨ä¸­å¿ƒè·ç¦»ç›¸åŒçš„ä¸€ç»„ç£é“ï¼›å®ƒè¢«ç§°ä¸ºæŸ±é¢æ˜¯å› ä¸ºå®ƒä¸æ‰€è°“çš„å‡ ä½•å½¢çŠ¶æ˜æ˜¾ç›¸ä¼¼ã€‚ FFSå°†Nä¸ªè¿ç»­çš„æŸ±é¢èšåˆä¸ºä¸€ç»„ï¼Œå› æ­¤æ•´ä¸ªç£ç›˜å¯ä»¥è¢«è§†ä¸ºæŸ±é¢ç»„çš„é›†åˆã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ˜¾ç¤ºäº†å…·æœ‰å…­ä¸ªç›˜ç‰‡çš„é©±åŠ¨å™¨çš„å››ä¸ªæœ€å¤–å±‚ç£é“ï¼Œä»¥åŠç”±ä¸‰ä¸ªæŸ±é¢ç»„æˆçš„æŸ±é¢ç»„ï¼š è¯·æ³¨æ„ï¼Œç°ä»£é©±åŠ¨å™¨ä¸ä¼šå¯¼å‡ºè¶³å¤Ÿçš„ä¿¡æ¯ä¾›æ–‡ä»¶ç³»ç»ŸçœŸæ­£ç†è§£ç‰¹å®šæŸ±é¢æ˜¯å¦æ­£åœ¨ä½¿ç”¨ï¼›å¦‚å‰æ‰€è¿°ï¼Œç£ç›˜å¯¼å‡ºå—çš„é€»è¾‘åœ°å€ç©ºé—´ï¼Œå¹¶å°†å…¶å‡ ä½•ç»†èŠ‚éšè—åœ¨å®¢æˆ·ç«¯ä¹‹å¤–ã€‚å› æ­¤ï¼Œç°ä»£æ–‡ä»¶ç³»ç»Ÿï¼ˆä¾‹å¦‚Linux ext2ã€ext3å’Œext4ï¼‰å°†é©±åŠ¨å™¨ç»„ç»‡æˆå—ç»„ï¼Œæ¯ä¸ªå—ç»„åªæ˜¯ç£ç›˜åœ°å€ç©ºé—´çš„è¿ç»­éƒ¨åˆ†ã€‚ä¸‹é¢çš„å›¾ç‰‡è¯´æ˜äº†ä¸€ä¸ªç¤ºä¾‹ï¼Œåœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæ¯8ä¸ªå—è¢«ç»„ç»‡åˆ°ä¸åŒçš„å—ç»„ä¸­ï¼ˆè¯·æ³¨æ„å®é™…åˆ†ç»„å°†åŒ…å«æ›´å¤šå—ï¼‰ã€‚ æ— è®ºæ‚¨å°†å®ƒä»¬ç§°ä¸ºæŸ±é¢ç»„è¿˜æ˜¯å—ç»„ï¼Œè¿™äº›ç»„éƒ½æ˜¯ FFS ç”¨äºæé«˜æ€§èƒ½çš„æ ¸å¿ƒæœºåˆ¶ã€‚è‡³å…³é‡è¦çš„æ˜¯ï¼Œé€šè¿‡å°†ä¸¤ä¸ªæ–‡ä»¶æ”¾åœ¨åŒä¸€ç»„ä¸­ï¼ŒFFS å¯ä»¥ç¡®ä¿ä¾æ¬¡è®¿é—®ä¸ä¼šå¯¼è‡´ç£ç›˜ä¸Šçš„é•¿æ—¶é—´æŸ¥æ‰¾ã€‚ ä¸ºäº†ä½¿ç”¨è¿™äº›ç»„æ¥å­˜å‚¨æ–‡ä»¶å’Œç›®å½•ï¼ŒFFS éœ€è¦èƒ½å¤Ÿå°†æ–‡ä»¶å’Œç›®å½•æ”¾å…¥ä¸€ä¸ªç»„ä¸­ï¼Œå¹¶åœ¨å…¶ä¸­è·Ÿè¸ªæœ‰å…³å®ƒä»¬çš„æ‰€æœ‰å¿…è¦ä¿¡æ¯ã€‚ä¸ºæ­¤ï¼ŒFFS åŒ…å«æ‚¨å¯èƒ½æœŸæœ›æ–‡ä»¶ç³»ç»Ÿåœ¨æ¯ä¸ªç»„ä¸­å…·æœ‰çš„æ‰€æœ‰ç»“æ„ï¼Œä¾‹å¦‚ inode ç©ºé—´ã€æ•°æ®å—ä»¥åŠä¸€äº›ç”¨äºè·Ÿè¸ªè¿™äº›ç»“æ„æ˜¯å¦å·²åˆ†é…æˆ–ç©ºé—²çš„ç»“æ„ã€‚ä»¥ä¸‹æ˜¯ FFS åœ¨å•ä¸ªæŸ±é¢ç»„ä¸­ä¿ç•™çš„å†…å®¹çš„æè¿°ï¼š ç°åœ¨è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°æ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªå•ä¸ªæŸ±é¢ç»„çš„ç»„æˆéƒ¨åˆ†ã€‚å‡ºäºå¯é æ€§åŸå› ï¼ŒFFS ä¼šåœ¨æ¯ä¸ªç»„ä¸­ä¿ç•™ä¸€ä»½è¶…çº§å— (S) å‰¯æœ¬ã€‚æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿéœ€è¦è¶…çº§å—ï¼›é€šè¿‡ä¿ç•™å¤šä¸ªå‰¯æœ¬ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªå‰¯æœ¬æŸåï¼Œä½ ä»ç„¶å¯ä»¥é€šè¿‡å·¥ä½œå‰¯æœ¬æŒ‚è½½å’Œè®¿é—®æ–‡ä»¶ç³»ç»Ÿã€‚ åœ¨æ¯ä¸ªç»„å†…ï¼ŒFFS éœ€è¦è·Ÿè¸ªè¯¥ç»„çš„ inode å’Œæ•°æ®å—æ˜¯å¦å·²åˆ†é…ã€‚æ¯ä¸ªç»„çš„ inode ä½å›¾ (ib) å’Œæ•°æ®ä½å›¾ (db) å¯¹æ¯ä¸ªç»„ä¸­çš„ inode å’Œæ•°æ®å—èµ·ä½œç”¨ã€‚ä½å›¾æ˜¯ç®¡ç†æ–‡ä»¶ç³»ç»Ÿä¸­ç©ºé—²ç©ºé—´çš„ç»ä½³æ–¹æ³•ï¼Œå› ä¸ºå¾ˆå®¹æ˜“æ‰¾åˆ°ä¸€å¤§å—ç©ºé—²ç©ºé—´å¹¶å°†å…¶åˆ†é…ç»™æ–‡ä»¶ï¼Œæˆ–è®¸å¯ä»¥é¿å…æ—§æ–‡ä»¶ç³»ç»Ÿä¸­ç©ºé—²åˆ—è¡¨çš„ä¸€äº›ç¢ç‰‡é—®é¢˜ã€‚ æœ€åï¼Œinode å’Œæ•°æ®å—åŒºåŸŸä¸ä»¥å‰çš„ â€œéå¸¸ç®€å•æ–‡ä»¶ç³»ç»Ÿâ€ï¼ˆVSFSï¼‰ä¸€æ ·ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œæ¯ä¸ªæŸ±é¢ç»„çš„å¤§éƒ¨åˆ†ç”±æ•°æ®å—ç»„æˆã€‚ FFS æ–‡ä»¶åˆ›å»º ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œæƒ³ä¸€æƒ³åˆ›å»ºæ–‡ä»¶æ—¶å¿…é¡»æ›´æ–°å“ªäº›æ•°æ®ç»“æ„ï¼›åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡è®¾ç”¨æˆ·åˆ›å»ºäº†ä¸€ä¸ªæ–°æ–‡ä»¶ /foo/bar.txtï¼Œæ–‡ä»¶é•¿åº¦ä¸ºä¸€ä¸ªå—ï¼ˆ4KBï¼‰ã€‚è¯¥æ–‡ä»¶æ˜¯æ–°æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªæ–°çš„ inodeï¼›å› æ­¤ï¼Œinode ä½å›¾å’Œæ–°åˆ†é…çš„ inode éƒ½å°†è¢«å†™å…¥ç£ç›˜ã€‚ æ–‡ä»¶ä¸­è¿˜æœ‰æ•°æ®ï¼Œå› æ­¤ä¹Ÿå¿…é¡»åˆ†é…ï¼›æ•°æ®ä½å›¾å’Œæ•°æ®å—ï¼ˆæœ€ç»ˆï¼‰å°†è¢«å†™å…¥ç£ç›˜ã€‚å› æ­¤ï¼Œå¯¹å½“å‰åˆ†åŒºè‡³å°‘è¦è¿›è¡Œå››æ¬¡å†™å…¥ï¼ˆè¯·æ³¨æ„ï¼Œè¿™äº›å†™å…¥åœ¨è¿›è¡Œä¹‹å‰å¯èƒ½ä¼šåœ¨å†…å­˜ä¸­ç¼“å†²ä¸€æ®µæ—¶é—´ï¼‰ã€‚ä½†è¿™è¿˜ä¸æ˜¯å…¨éƒ¨ï¼å°¤å…¶æ˜¯ï¼Œåœ¨åˆ›å»ºæ–°æ–‡ä»¶æ—¶ï¼Œè¿˜å¿…é¡»å°†æ–‡ä»¶æ”¾åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„ä¸­ï¼Œå³å¿…é¡»æ›´æ–°ç›®å½•ã€‚å…·ä½“æ¥è¯´ï¼Œå¿…é¡»æ›´æ–°çˆ¶ç›®å½• fooï¼Œä»¥æ·»åŠ  bar.txt æ¡ç›®ï¼›è¿™ä¸€æ›´æ–°å¯èƒ½é€‚åˆ foo çš„ç°æœ‰æ•°æ®å—ï¼Œä¹Ÿå¯èƒ½éœ€è¦åˆ†é…ä¸€ä¸ªæ–°å—ï¼ˆä»¥åŠç›¸å…³çš„æ•°æ®ä½å›¾ï¼‰ã€‚foo çš„ inode ä¹Ÿå¿…é¡»æ›´æ–°ï¼Œä»¥åæ˜ ç›®å½•çš„æ–°é•¿åº¦å¹¶æ›´æ–°æ—¶é—´å­—æ®µï¼ˆå¦‚æœ€åä¿®æ”¹æ—¶é—´ï¼‰ã€‚ æ€»çš„æ¥è¯´ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶çš„å·¥ä½œé‡å¾ˆå¤§ï¼ä¹Ÿè®¸ä¸‹æ¬¡å†åˆ›å»ºæ–°æ–‡ä»¶æ—¶ï¼Œä½ åº”è¯¥æ›´åŠ æ„Ÿæ¿€ï¼Œæˆ–è€…è‡³å°‘å¯¹åˆ›å»ºå·¥ä½œå¦‚æ­¤é¡ºåˆ©æ„Ÿåˆ°æƒŠè®¶ã€‚ ","date":"2024-05-11","objectID":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:3:0","tags":["OS"],"title":"å¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 ç­–ç•¥ï¼šå¦‚ä½•åˆ†é…æ–‡ä»¶å’Œç›®å½• æœ‰äº†è¿™ä¸ªç»„ç»“æ„ï¼ŒFFS ç°åœ¨å¿…é¡»å†³å®šå¦‚ä½•å°†æ–‡ä»¶å’Œç›®å½•ä»¥åŠç›¸å…³å…ƒæ•°æ®æ”¾ç½®åœ¨ç£ç›˜ä¸Šä»¥æé«˜æ€§èƒ½ã€‚åŸºæœ¬åŸåˆ™å¾ˆç®€å•ï¼šå°†ç›¸å…³çš„ä¸œè¥¿æ”¾åœ¨ä¸€èµ·ï¼ˆå…¶æ¨è®ºå°±æ˜¯å°†ä¸ç›¸å…³çš„ä¸œè¥¿åˆ†å¼€ï¼‰ã€‚ å› æ­¤ï¼Œä¸ºäº†éµå®ˆè¿™ä¸€åŸåˆ™ï¼ŒFFS å¿…é¡»å†³å®šä»€ä¹ˆæ˜¯â€œç›¸å…³çš„â€å¹¶å°†å…¶æ”¾ç½®åœ¨åŒä¸€ä¸ªåŒºå—ç»„ä¸­ï¼›ç›¸åï¼Œä¸ç›¸å…³çš„é¡¹ç›®åº”æ”¾ç½®åœ¨ä¸åŒçš„å—ç»„ä¸­ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼ŒFFS ä½¿ç”¨äº†ä¸€äº›ç®€å•çš„æ”¾ç½®å¯å‘å¼æ³•ã€‚ é¦–å…ˆæ˜¯ç›®å½•çš„æ”¾ç½®ã€‚ FFS é‡‡ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼šæ‰¾åˆ°åˆ†é…ç›®å½•æ•°é‡è¾ƒå°‘ï¼ˆä»¥å¹³è¡¡ç»„ä¹‹é—´çš„ç›®å½•ï¼‰å’Œç©ºé—² inode æ•°é‡è¾ƒå¤šï¼ˆä»¥ä¾¿éšåèƒ½å¤Ÿåˆ†é…ä¸€å †æ–‡ä»¶ï¼‰çš„æŸ±é¢ç»„ï¼Œå¹¶å°†ç›®å½•æ•°æ®å’Œinodeæ”¾åœ¨è¯¥ç»„ä¸­ã€‚å½“ç„¶ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å…¶ä»–å¯å‘å¼æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œè€ƒè™‘ç©ºé—²æ•°æ®å—çš„æ•°é‡ï¼‰ã€‚ å¯¹äºæ–‡ä»¶ï¼ŒFFS åšäº†ä¸¤ä»¶äº‹ã€‚ é¦–å…ˆï¼Œå®ƒç¡®ä¿ï¼ˆåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼‰å°†æ–‡ä»¶çš„æ•°æ®å—åˆ†é…åœ¨ä¸å…¶ inode ç›¸åŒçš„ç»„ä¸­ï¼Œä»è€Œé˜²æ­¢ inode å’Œæ•°æ®ä¹‹é—´çš„é•¿æ—¶é—´æŸ¥æ‰¾ï¼ˆå¦‚åœ¨æ—§æ–‡ä»¶ç³»ç»Ÿä¸­ï¼‰ã€‚ å…¶æ¬¡ï¼Œå®ƒå°†åŒä¸€ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶æ”¾ç½®åœ¨å®ƒä»¬æ‰€åœ¨ç›®å½•çš„æŸ±é¢ç»„ä¸­ã€‚ å› æ­¤ï¼Œå¦‚æœç”¨æˆ·åˆ›å»ºå››ä¸ªæ–‡ä»¶ï¼š/a/bã€/a/cã€/a/d å’Œ b/ fï¼ŒFFS ä¼šå°è¯•å°†å‰ä¸‰ä¸ªæ”¾ç½®åœ¨å½¼æ­¤é™„è¿‘ï¼ˆåŒä¸€ç»„ï¼‰ï¼Œè€Œç¬¬å››ä¸ªæ”¾ç½®åœ¨è¿œå¤„ï¼ˆåœ¨å…¶ä»–ç»„ä¸­ï¼‰ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ­¤ç±»åˆ†é…çš„ç¤ºä¾‹ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œå‡è®¾æ¯ç»„åªæœ‰ 10 ä¸ª inode å’Œ 10 ä¸ªæ•°æ®å—ï¼ˆéƒ½å°å¾—ç¦»è°±ï¼‰ï¼Œå¹¶ä¸”ä¸‰ä¸ªç›®å½•ï¼ˆæ ¹ç›®å½• /ã€/aã€/bï¼‰å’Œ 4 ä¸ªæ–‡ä»¶ï¼ˆ/a/ cã€/a/dã€/a/eã€/b/f) æ ¹æ® FFS ç­–ç•¥æ”¾ç½®åœ¨å…¶ä¸­ã€‚å‡è®¾å¸¸è§„æ–‡ä»¶çš„å¤§å°å„ä¸ºä¸¤ä¸ªå—ï¼Œå¹¶ä¸”ç›®å½•åªæœ‰ä¸€ä¸ªæ•°æ®å—ã€‚å¯¹äºè¯¥å›¾ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•ä½¿ç”¨æ˜æ˜¾çš„ç¬¦å·ï¼ˆå³ / è¡¨ç¤ºæ ¹ç›®å½•ï¼Œa è¡¨ç¤º /aï¼Œf è¡¨ç¤º /b/fï¼Œç­‰ç­‰ï¼‰ã€‚ è¯·æ³¨æ„ï¼ŒFFS ç­–ç•¥åšäº†ä¸¤ä¸ªç§¯æçš„äº‹æƒ…ï¼šæ¯ä¸ªæ–‡ä»¶çš„æ•°æ®å—éƒ½é è¿‘æ¯ä¸ªæ–‡ä»¶çš„ inodeï¼ŒåŒä¸€ç›®å½•ä¸­çš„æ–‡ä»¶å½¼æ­¤é è¿‘ï¼ˆå³ /a/cã€/a/d å’Œ /a/eï¼‰éƒ½åœ¨ç»„ 1 ä¸­ï¼Œå¹¶ä¸”ç›®å½• /b åŠå…¶æ–‡ä»¶ /b/f åœ¨ç»„ 2 ä¸­å½¼æ­¤é è¿‘ï¼‰ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ inode åˆ†é…ç­–ç•¥ï¼Œå®ƒåªæ˜¯å°† inode åˆ†å¸ƒåœ¨ç»„ä¹‹é—´ï¼Œè¯•å›¾ç¡®ä¿æ²¡æœ‰ç»„çš„ inode è¡¨å¾ˆå¿«è¢«å¡«æ»¡ã€‚æœ€ç»ˆçš„åˆ†é…å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶æ­¤ç­–ç•¥ç¡®å®å°†æ–‡ä»¶ï¼ˆå’Œç›®å½•ï¼‰æ•°æ®ä¿ç•™åœ¨å…¶å„è‡ªçš„ inode é™„è¿‘ï¼Œä½†ç›®å½•ä¸­çš„æ–‡ä»¶åœ¨ç£ç›˜ä¸Šä»»æ„åˆ†å¸ƒï¼Œå› æ­¤ä¸ä¼šä¿ç•™åŸºäºåç§°çš„å±€éƒ¨æ€§ã€‚å¯¹æ–‡ä»¶ /a/cã€/a/d å’Œ /a/e çš„è®¿é—®ç°åœ¨è·¨è¶Šä¸‰ç»„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§ FFS æ–¹æ³•è·¨è¶Šä¸€ç»„ã€‚ FFS ç­–ç•¥å¯å‘å¼æ–¹æ³•å¹¶éåŸºäºå¯¹æ–‡ä»¶ç³»ç»Ÿæµé‡æˆ–ä»»ä½•ç‰¹åˆ«ç»†å¾®çš„å†…å®¹çš„å¹¿æ³›ç ”ç©¶ï¼›ç›¸åï¼Œå®ƒä»¬åŸºäºè‰¯å¥½çš„è€å¼å¸¸è¯†ã€‚ç›®å½•ä¸­çš„æ–‡ä»¶é€šå¸¸ä¸€èµ·è®¿é—®ï¼šæƒ³è±¡ä¸€ä¸‹ç¼–è¯‘ä¸€å †æ–‡ä»¶ï¼Œç„¶åå°†å®ƒä»¬é“¾æ¥åˆ°å•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚ç”±äºå­˜åœ¨è¿™ç§åŸºäºå‘½åç©ºé—´çš„å±€éƒ¨æ€§ï¼ŒFFS é€šå¸¸ä¼šæé«˜æ€§èƒ½ï¼Œç¡®ä¿ç›¸å…³æ–‡ä»¶ä¹‹é—´çš„æŸ¥æ‰¾è‰¯å¥½ä¸”ç®€çŸ­ã€‚ ","date":"2024-05-11","objectID":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:4:0","tags":["OS"],"title":"å¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 æ–‡ä»¶å±€éƒ¨æ€§æµ‹é‡ ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™äº›å¯å‘å¼æ–¹æ³•æ˜¯å¦æœ‰æ„ä¹‰ï¼Œè®©æˆ‘ä»¬åˆ†æä¸€äº›æ–‡ä»¶ç³»ç»Ÿè®¿é—®çš„ç—•è¿¹ï¼Œçœ‹çœ‹æ˜¯å¦ç¡®å®å­˜åœ¨å‘½åç©ºé—´å±€éƒ¨æ€§ã€‚ç”±äºæŸç§åŸå› ï¼Œæ–‡çŒ®ä¸­ä¼¼ä¹æ²¡æœ‰å¯¹è¿™ä¸ªä¸»é¢˜è¿›è¡Œå¾ˆå¥½çš„ç ”ç©¶ã€‚ å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ SEER è·Ÿè¸ªå¹¶åˆ†æç›®å½•æ ‘ä¸­æ–‡ä»¶è®¿é—®å½¼æ­¤ä¹‹é—´çš„â€œè·ç¦»â€æœ‰å¤šè¿œã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ–‡ä»¶ f è¢«æ‰“å¼€ï¼Œç„¶ååœ¨è·Ÿè¸ªä¸­ä¸‹ä¸€ä¸ªé‡æ–°æ‰“å¼€ï¼ˆåœ¨æ‰“å¼€ä»»ä½•å…¶ä»–æ–‡ä»¶ä¹‹å‰ï¼‰ï¼Œåˆ™ç›®å½•æ ‘ä¸­è¿™ä¸¤ä¸ªæ‰“å¼€ä¹‹é—´çš„è·ç¦»ä¸ºé›¶ï¼ˆå› ä¸ºå®ƒä»¬æ˜¯åŒä¸€æ–‡ä»¶ï¼‰ã€‚å¦‚æœæ‰“å¼€ç›®å½• dirä¸­çš„æ–‡ä»¶ fï¼ˆå³ dir/fï¼‰ï¼Œç„¶åæ‰“å¼€åŒä¸€ç›®å½•ä¸­çš„æ–‡ä»¶ gï¼ˆå³ dir/gï¼‰ï¼Œåˆ™ä¸¤ä¸ªæ–‡ä»¶è®¿é—®ä¹‹é—´çš„è·ç¦»ä¸º 1ï¼Œå› ä¸ºå®ƒä»¬å…±äº«åŒä¸€ç›®å½•ä½†ä¸æ˜¯åŒä¸€æ–‡ä»¶ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬çš„è·ç¦»åº¦é‡è¡¡é‡çš„æ˜¯æ‚¨å¿…é¡»åœ¨ç›®å½•æ ‘ä¸Šèµ°å¤šè¿œæ‰èƒ½æ‰¾åˆ°ä¸¤ä¸ªæ–‡ä»¶çš„å…±åŒç¥–å…ˆï¼›å®ƒä»¬åœ¨æ ‘ä¸­è¶Šè¿‘ï¼Œåº¦é‡è¶Šä½ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ SEER é›†ç¾¤ä¸­æ‰€æœ‰å·¥ä½œç«™çš„ SEER è·Ÿè¸ªä¸­åœ¨æ‰€æœ‰è·Ÿè¸ªçš„æ•´ä½“ä¸Šè§‚å¯Ÿåˆ°çš„å±€éƒ¨æ€§ã€‚è¯¥å›¾æ²¿ x è½´ç»˜åˆ¶å·®å¼‚æŒ‡æ ‡ï¼Œå¹¶æ²¿ y è½´æ˜¾ç¤ºå…·æœ‰è¯¥å·®å¼‚çš„æ–‡ä»¶æ‰“å¼€çš„ç´¯ç§¯ç™¾åˆ†æ¯”ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äº SEER è·Ÿè¸ªï¼ˆå›¾ä¸­æ ‡è®°ä¸ºâ€œTraceâ€ï¼‰ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¤§çº¦ 7% çš„æ–‡ä»¶è®¿é—®æ˜¯é’ˆå¯¹å…ˆå‰æ‰“å¼€çš„æ–‡ä»¶ï¼Œè€Œè¿‘ 40% çš„æ–‡ä»¶è®¿é—®æ˜¯é’ˆå¯¹åŒä¸€æ–‡ä»¶æˆ–åˆ°åŒä¸€ç›®å½•ä¸­çš„ä¸€ï¼ˆå³ç›¸å·®é›¶æˆ–ä¸€ï¼‰ã€‚å› æ­¤ï¼ŒFFS å±€éƒ¨æ€§å‡è®¾ä¼¼ä¹æ˜¯æœ‰æ„ä¹‰çš„ï¼ˆè‡³å°‘å¯¹äºè¿™äº›ç—•è¿¹è€Œè¨€ï¼‰ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œå¦å¤– 25% å·¦å³çš„æ–‡ä»¶è®¿é—®æ˜¯é’ˆå¯¹è·ç¦»ä¸º 2 çš„æ–‡ä»¶çš„ã€‚å½“ç”¨æˆ·ä»¥å¤šçº§æ–¹å¼æ„å»ºä¸€ç»„ç›¸å…³ç›®å½•å¹¶åœ¨å®ƒä»¬ä¹‹é—´æŒç»­è·³è½¬æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§ç±»å‹çš„å±€éƒ¨æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·æœ‰ä¸€ä¸ª src ç›®å½•å¹¶å°†ç›®æ ‡æ–‡ä»¶ï¼ˆ.o æ–‡ä»¶ï¼‰æ„å»ºåˆ° obj ç›®å½•ä¸­ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªç›®å½•éƒ½æ˜¯ä¸»ç›®å½• proj çš„å­ç›®å½•ï¼Œåˆ™å¸¸è§çš„è®¿é—®æ¨¡å¼å°†æ˜¯ proj/src/foo .c åè·Ÿ proj/obj/foo.oã€‚è¿™ä¸¤ä¸ªè®¿é—®ä¹‹é—´çš„è·ç¦»æ˜¯ 2ï¼Œå› ä¸º proj æ˜¯å…±åŒçš„ç¥–å…ˆã€‚ FFS ä¸ä¼šåœ¨å…¶ç­–ç•¥ä¸­æ•è·è¿™ç§ç±»å‹çš„å±€éƒ¨æ€§ï¼Œå› æ­¤åœ¨æ­¤ç±»è®¿é—®ä¹‹é—´ä¼šå‘ç”Ÿæ›´å¤šçš„æŸ¥æ‰¾ã€‚ ä¸ºäº†è¿›è¡Œæ¯”è¾ƒï¼Œè¯¥å›¾è¿˜æ˜¾ç¤ºäº†â€œéšæœºâ€è½¨è¿¹çš„å±€éƒ¨æ€§ã€‚éšæœºè·Ÿè¸ªæ˜¯é€šè¿‡ä»¥éšæœºé¡ºåºä»ç°æœ‰ SEER è·Ÿè¸ªä¸­é€‰æ‹©æ–‡ä»¶å¹¶è®¡ç®—è¿™äº›éšæœºæ’åºçš„è®¿é—®ä¹‹é—´çš„è·ç¦»åº¦é‡æ¥ç”Ÿæˆçš„ã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œéšæœºè·Ÿè¸ªä¸­çš„å‘½åç©ºé—´å±€éƒ¨æ€§è¾ƒå°‘ã€‚ç„¶è€Œï¼Œå› ä¸ºæœ€ç»ˆæ¯ä¸ªæ–‡ä»¶å…±äº«ä¸€ä¸ªå…±åŒçš„ç¥–å…ˆï¼ˆä¾‹å¦‚æ ¹ï¼‰ï¼Œæ‰€ä»¥å­˜åœ¨ä¸€äº›å±€éƒ¨æ€§ï¼Œå› æ­¤éšæœºä½œä¸ºæ¯”è¾ƒç‚¹æ˜¯æœ‰ç”¨çš„ã€‚ ","date":"2024-05-11","objectID":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:5:0","tags":["OS"],"title":"å¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 å¤§æ–‡ä»¶ä¾‹å¤– åœ¨ FFS ä¸­ï¼Œæ–‡ä»¶æ”¾ç½®çš„ä¸€èˆ¬ç­–ç•¥æœ‰ä¸€ä¸ªé‡è¦çš„ä¾‹å¤–ï¼Œé‚£å°±æ˜¯å¤§æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰ä¸åŒçš„è§„åˆ™ï¼Œä¸€ä¸ªå¤§æ–‡ä»¶å°±ä¼šå æ»¡å®ƒç¬¬ä¸€æ¬¡æ”¾ç½®çš„å—ç»„ï¼ˆä¹Ÿè®¸è¿˜æœ‰å…¶ä»–å—ç»„ï¼‰ã€‚ä»¥è¿™ç§æ–¹å¼å¡«æ»¡ä¸€ä¸ªå—ç»„æ˜¯ä¸å¯å–çš„ï¼Œå› ä¸ºè¿™ä¼šé˜»æ­¢åç»­çš„ â€œç›¸å…³ â€œæ–‡ä»¶è¢«æ”¾ç½®åœ¨è¿™ä¸ªå—ç»„ä¸­ï¼Œä»è€Œå¯èƒ½ä¼šæŸå®³æ–‡ä»¶è®¿é—®çš„æœ¬åœ°æ€§ã€‚ å› æ­¤ï¼Œå¯¹äºå¤§æ–‡ä»¶ï¼ŒFFS çš„åšæ³•å¦‚ä¸‹ã€‚åœ¨ç¬¬ä¸€ä¸ªå—ç»„ä¸­åˆ†é…äº†ä¸€å®šæ•°é‡çš„å—ä¹‹åï¼ˆä¾‹å¦‚ 12 ä¸ªå—ï¼Œæˆ–ä¸€ä¸ª inode ä¸­å¯ç”¨çš„ç›´æ¥æŒ‡é’ˆçš„æ•°é‡ï¼‰ï¼ŒFFS ä¼šå°†æ–‡ä»¶çš„ä¸‹ä¸€ä¸ª â€œå¤§ â€œå—ï¼ˆä¾‹å¦‚ç¬¬ä¸€ä¸ªé—´æ¥å—æŒ‡å‘çš„é‚£äº›å—ï¼‰æ”¾åˆ°å¦ä¸€ä¸ªå—ç»„ï¼ˆå¯èƒ½æ˜¯ä¸ºäº†é™ä½åˆ©ç”¨ç‡è€Œé€‰æ‹©çš„ï¼‰ä¸­ã€‚ç„¶åï¼Œæ–‡ä»¶çš„ä¸‹ä¸€ä¸ªå—è¢«æ”¾åˆ°å¦ä¸€ä¸ªä¸åŒçš„å—ç»„ä¸­ï¼Œä¾æ­¤ç±»æ¨ã€‚ è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›å›¾è¡¨æ¥æ›´å¥½åœ°ç†è§£è¿™ä¸€ç­–ç•¥ã€‚å¦‚æœæ²¡æœ‰å¤§æ–‡ä»¶ä¾‹å¤–æƒ…å†µï¼Œå•ä¸ªå¤§æ–‡ä»¶å°±ä¼šå°†å…¶æ‰€æœ‰å—æ”¾å…¥ç£ç›˜çš„ä¸€ä¸ªéƒ¨åˆ†ã€‚æˆ‘ä»¬ä»¥ä¸€ä¸ªæ–‡ä»¶ (/a) ä¸ºä¾‹è¿›è¡Œç ”ç©¶ï¼Œè¯¥æ–‡ä»¶æœ‰ 30 ä¸ªå—ï¼ŒFFS é…ç½®ä¸ºæ¯ä¸ªç»„ 10 ä¸ª inodes å’Œ 40 ä¸ªæ•°æ®å—ã€‚ä¸‹é¢æ˜¯æ²¡æœ‰å¤§æ–‡ä»¶ä¾‹å¤–æƒ…å†µçš„ FFS çš„æè¿°ï¼š å¦‚å›¾æ‰€ç¤ºï¼Œ/a å¡«æ»¡äº†group 0 ä¸­çš„å¤§éƒ¨åˆ†æ•°æ®å—ï¼Œè€Œå…¶ä»–ç»„ä»ç„¶æ˜¯ç©ºçš„ã€‚å¦‚æœç°åœ¨åœ¨æ ¹ç›®å½• (/) ä¸­åˆ›å»ºäº†å…¶ä»–æ–‡ä»¶ï¼Œé‚£ä¹ˆç»„ä¸­å°±æ²¡æœ‰å¤ªå¤šç©ºé—´æ¥å­˜æ”¾å®ƒä»¬çš„æ•°æ®äº†ã€‚ åœ¨å¤§æ–‡ä»¶ä¾‹å¤–æƒ…å†µä¸‹ï¼ˆæ­¤å¤„è®¾ç½®ä¸ºæ¯ä¸ªå—ä¸­åŒ…å«äº”ä¸ªå—ï¼‰ï¼ŒFFS ä¼šå°†æ–‡ä»¶åˆ†æ•£åˆ°å„ä¸ªç»„ä¸­ï¼Œå› æ­¤ä»»ä½•ä¸€ä¸ªç»„å†…çš„åˆ©ç”¨ç‡éƒ½ä¸ä¼šå¤ªé«˜ï¼š ä½ å¯èƒ½æ³¨æ„åˆ°ï¼Œå°†æ–‡ä»¶å—åˆ†æ•£åˆ°ç£ç›˜ä¸Šä¼šé™ä½æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ç›¸å¯¹å¸¸è§çš„é¡ºåºæ–‡ä»¶è®¿é—®æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºæŒ‰é¡ºåºè¯»å– 0 åˆ° 29 å—ï¼‰ã€‚ä½†æ‚¨å¯ä»¥é€šè¿‡è°¨æ…é€‰æ‹©å—å¤§å°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ å…·ä½“æ¥è¯´ï¼Œå¦‚æœå—çš„å¤§å°è¶³å¤Ÿå¤§ï¼Œæ–‡ä»¶ç³»ç»Ÿå°±ä¼šèŠ±å¤§éƒ¨åˆ†æ—¶é—´ä»ç£ç›˜ä¼ è¾“æ•°æ®ï¼Œè€ŒåªèŠ±ï¼ˆç›¸å¯¹è¾ƒå°‘çš„ï¼‰æ—¶é—´åœ¨å—çš„å„å—ä¹‹é—´æŸ¥æ‰¾ã€‚è¿™ç§é€šè¿‡å¢åŠ æ¯æ¬¡å¼€é”€çš„å·¥ä½œé‡æ¥å‡å°‘å¼€é”€çš„è¿‡ç¨‹ç§°ä¸ºæ‘Šé”€ï¼Œæ˜¯è®¡ç®—æœºç³»ç»Ÿä¸­çš„ä¸€ç§å¸¸ç”¨æŠ€æœ¯ã€‚ è®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾ç£ç›˜çš„å¹³å‡å®šä½æ—¶é—´ï¼ˆå³å¯»é“å’Œæ—‹è½¬ï¼‰ä¸º 10 æ¯«ç§’ã€‚å†å‡è®¾ç£ç›˜çš„æ•°æ®ä¼ è¾“é€Ÿåº¦ä¸º 40 MB/sã€‚å¦‚æœæ‚¨çš„ç›®æ ‡æ˜¯å°†ä¸€åŠæ—¶é—´ç”¨äºåœ¨æ•°æ®å—ä¹‹é—´å¯»é“ï¼Œä¸€åŠæ—¶é—´ç”¨äºä¼ è¾“æ•°æ®ï¼ˆä»è€Œè¾¾åˆ°ç£ç›˜å³°å€¼æ€§èƒ½çš„ 50%ï¼‰ï¼Œé‚£ä¹ˆæ¯ 10 æ¯«ç§’çš„å®šä½æ—¶é—´å°±éœ€è¦èŠ±è´¹ 10 æ¯«ç§’æ¥ä¼ è¾“æ•°æ®ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šä¸€ä¸ªæ•°æ®å—éœ€è¦å¤šå¤§æ‰èƒ½èŠ±è´¹ 10 æ¯«ç§’æ¥ä¼ è¾“æ•°æ®ï¼Ÿæˆ‘ä»¬æ¥è®¡ç®—ä¸€ä¸‹ï¼š $$ \\frac{40\\cancel{MB}}{\\cancel{sec}}\\cdot\\frac{1024KB}{1\\cancel{MB}}\\cdot\\frac{1\\cancel{sec}}{1000\\cancel{ms}}\\cdot10\\cancel{ms}=409.6KB $$ åŸºæœ¬ä¸Šï¼Œè¿™ä¸ªç­‰å¼è¡¨ç¤ºçš„æ˜¯ï¼šå¦‚æœæ‚¨ä»¥ 40 MB/s çš„é€Ÿåº¦ä¼ è¾“æ•°æ®ï¼Œåˆ™æ¯æ¬¡æŸ¥æ‰¾æ—¶åªéœ€ä¼ è¾“ 409.6KBï¼Œä»¥ä¾¿å°†ä¸€åŠçš„æ—¶é—´ç”¨äºæŸ¥æ‰¾ï¼Œä¸€åŠçš„æ—¶é—´ç”¨äºä¼ è¾“ã€‚åŒæ ·ï¼Œæ‚¨å¯ä»¥è®¡ç®—å®ç° 90% å³°å€¼å¸¦å®½ï¼ˆç»“æœçº¦ä¸º 3.69MBï¼‰ï¼Œç”šè‡³ 99% å³°å€¼å¸¦å®½ï¼ˆ40.6MBï¼ï¼‰æ‰€éœ€çš„å—å¤§å°ã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ‚¨è¶Šæ¥è¿‘å³°å€¼ï¼Œè¿™äº›å—å°±è¶Šå¤§ï¼ˆæœ‰å…³è¿™äº›å€¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ã€‚ ä¸è¿‡ï¼ŒFFS å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ç§è®¡ç®—æ–¹æ³•ï¼Œä»¥ä¾¿å°†å¤§æ–‡ä»¶åˆ†æ‘Šåˆ°å„ä¸ªç»„ã€‚ç›¸åï¼Œå®ƒæ ¹æ® inode æœ¬èº«çš„ç»“æ„é‡‡å–äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚å‰ 12 ä¸ªç›´æ¥å—ä¸ inode æ”¾åœ¨åŒä¸€ä¸ªç»„ä¸­ï¼›éšåçš„æ¯ä¸ªé—´æ¥å—åŠå…¶æŒ‡å‘çš„æ‰€æœ‰å—åˆ™æ”¾åœ¨ä¸åŒçš„ç»„ä¸­ã€‚å¯¹äº 4KB çš„å—å¤§å°å’Œ 32 ä½ç£ç›˜åœ°å€ï¼Œæ­¤ç­–ç•¥æ„å‘³ç€æ–‡ä»¶çš„æ¯ 1024 ä¸ªå— (4MB) è¢«æ”¾ç½®åœ¨å•ç‹¬çš„ç»„ä¸­ï¼Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯ç›´æ¥æŒ‡é’ˆæŒ‡å‘çš„æ–‡ä»¶çš„ç¬¬ä¸€ä¸ª 48KBã€‚ è¯·æ³¨æ„ï¼Œç£ç›˜é©±åŠ¨å™¨çš„å‘å±•è¶‹åŠ¿æ˜¯ï¼Œä¼ è¾“é€Ÿç‡çš„æé«˜ç›¸å½“å¿«ï¼Œå› ä¸ºç£ç›˜åˆ¶é€ å•†å–„äºå°†æ›´å¤šbitå‹ç¼©åˆ°ç›¸åŒçš„è¡¨é¢ï¼Œä½†ä¸å¯»é“æœ‰å…³çš„é©±åŠ¨å™¨æœºæ¢°æ–¹é¢ï¼ˆç£ç›˜è‡‚é€Ÿåº¦å’Œæ—‹è½¬é€Ÿåº¦ï¼‰çš„æé«˜å´ç›¸å½“ç¼“æ…¢ã€‚è¿™æ„å‘³ç€ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæœºæ¢°æˆæœ¬ä¼šå˜å¾—ç›¸å¯¹æ›´æ˜‚è´µï¼Œå› æ­¤ï¼Œä¸ºäº†æ‘Šé”€è¿™äº›æˆæœ¬ï¼Œä½ å¿…é¡»åœ¨ä¸¤æ¬¡å¯»é“ä¹‹é—´ä¼ è¾“æ›´å¤šçš„æ•°æ®ã€‚ ","date":"2024-05-11","objectID":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:6:0","tags":["OS"],"title":"å¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 å…³äº FFS çš„å…¶ä»–ä¸€äº›äº‹æƒ… FFS è¿˜å¼•å…¥äº†å…¶ä»–ä¸€äº›åˆ›æ–°ã€‚ç‰¹åˆ«æ˜¯ï¼Œè®¾è®¡è€…ä»¬éå¸¸æ‹…å¿ƒå°æ–‡ä»¶çš„å®¹çº³é—®é¢˜ï¼›äº‹å®è¯æ˜ï¼Œå½“æ—¶è®¸å¤šæ–‡ä»¶çš„å¤§å°éƒ½åœ¨ 2KB å·¦å³ï¼Œä½¿ç”¨ 4KB çš„å—è™½ç„¶æœ‰åˆ©äºä¼ è¾“æ•°æ®ï¼Œä½†ç©ºé—´æ•ˆç‡å´ä¸é«˜ã€‚å› æ­¤ï¼Œå¯¹äºä¸€ä¸ªå…¸å‹çš„æ–‡ä»¶ç³»ç»Ÿæ¥è¯´ï¼Œè¿™ç§å†…éƒ¨ç¢ç‰‡ä¼šå¯¼è‡´å¤§çº¦ä¸€åŠçš„ç£ç›˜ç©ºé—´è¢«æµªè´¹ã€‚ FFS è®¾è®¡è€…çš„è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼Œä¹Ÿå¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ä»–ä»¬å†³å®šå¼•å…¥å­å—ï¼Œå³æ–‡ä»¶ç³»ç»Ÿå¯ä»¥åˆ†é…ç»™æ–‡ä»¶çš„ 512 å­—èŠ‚çš„å°å—ã€‚è¿™æ ·ï¼Œå¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªå°æ–‡ä»¶ï¼ˆæ¯”å¦‚ 1KB å¤§å°ï¼‰ï¼Œå®ƒå°†å ç”¨ä¸¤ä¸ªå­å—ï¼Œä»è€Œä¸ä¼šæµªè´¹æ•´ä¸ª 4KB çš„å—ã€‚éšç€æ–‡ä»¶çš„å¢å¤§ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†ç»§ç»­ä¸ºå…¶åˆ†é… 512 å­—èŠ‚çš„å—ï¼Œç›´åˆ°è·å¾—å®Œæ•´çš„ 4KB æ•°æ®ã€‚è¿™æ—¶ï¼ŒFFS ä¼šæ‰¾åˆ°ä¸€ä¸ª 4KB çš„å—ï¼Œå°†å­å—å¤åˆ¶åˆ°å…¶ä¸­ï¼Œç„¶åé‡Šæ”¾å­å—ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚ ä½ å¯èƒ½ä¼šè®¤ä¸ºè¿™ä¸ªè¿‡ç¨‹æ•ˆç‡å¾ˆä½ï¼Œéœ€è¦æ–‡ä»¶ç³»ç»Ÿåšå¤§é‡é¢å¤–çš„å·¥ä½œï¼ˆå°¤å…¶æ˜¯æ‰§è¡Œå¤åˆ¶æ—¶éœ€è¦å¤§é‡é¢å¤–çš„ I/Oï¼‰ã€‚å› æ­¤ï¼ŒFFS é€šå¸¸é€šè¿‡ä¿®æ”¹ libc åº“æ¥é¿å…è¿™ç§ä½æ•ˆè¡Œä¸ºï¼›è¯¥åº“ä¼šå¯¹å†™å…¥å†…å®¹è¿›è¡Œç¼“å†²ï¼Œç„¶åä»¥ 4KB çš„åˆ†å—å½¢å¼å°†å…¶å‘é€åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œä»è€Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å®Œå…¨é¿å…äº†å­å—ç‰¹æ®ŠåŒ–ã€‚ FFS å¼•å…¥çš„ç¬¬äºŒé¡¹é‡è¦åŠŸèƒ½æ˜¯ä¼˜åŒ–ç£ç›˜å¸ƒå±€ä»¥æé«˜æ€§èƒ½ã€‚åœ¨é‚£ä¸ªæ—¶ä»£ï¼ˆSCSI å’Œå…¶ä»–æ›´ç°ä»£çš„è®¾å¤‡æ¥å£å‡ºç°ä¹‹å‰ï¼‰ï¼Œç£ç›˜çš„å¤æ‚ç¨‹åº¦è¦ä½å¾—å¤šï¼Œéœ€è¦ä¸»æœº CPU ä»¥æ›´å®é™…çš„æ–¹å¼æ§åˆ¶å…¶è¿è¡Œã€‚å½“æ–‡ä»¶è¢«æ”¾ç½®åœ¨ç£ç›˜çš„è¿ç»­æ‰‡åŒºä¸Šæ—¶ï¼ŒFFS å°±ä¼šå‡ºç°é—®é¢˜ï¼Œå¦‚ä¸‹å›¾å·¦ä¾§æ‰€ç¤ºã€‚ ç‰¹åˆ«æ˜¯åœ¨é¡ºåºè¯»å–æ—¶å‡ºç°é—®é¢˜ã€‚FFS ä¼šé¦–å…ˆå‘å‡ºå¯¹ 0 å·å—çš„è¯»å–ï¼›å½“è¯»å–å®Œæˆåï¼ŒFFS å†å‘å‡ºå¯¹ 1 å·å—çš„è¯»å–æ—¶ï¼Œä¸ºæ—¶å·²æ™šï¼š1 å·å—å·²ç»åœ¨ç£å¤´ä¸‹æ–¹æ—‹è½¬ï¼Œç°åœ¨è¯»å– 1 å·å—å°†ä¼šå¯¼è‡´å®Œå…¨æ—‹è½¬ã€‚ FFS é‡‡ç”¨ä¸åŒçš„å¸ƒå±€è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå¦‚ä¸Šå›¾å³ä¾§æ‰€ç¤ºã€‚é€šè¿‡è·³è¿‡æ¯ä¸€ä¸ªå…¶ä»–å—ï¼ˆåœ¨ç¤ºä¾‹ä¸­ï¼‰ï¼ŒFFS æœ‰è¶³å¤Ÿçš„æ—¶é—´åœ¨ä¸‹ä¸€ä¸ªå—ç»è¿‡ç£å¤´ä¹‹å‰è¯·æ±‚ä¸‹ä¸€ä¸ªå—ã€‚äº‹å®ä¸Šï¼ŒFFS å¾ˆèªæ˜ï¼Œå®ƒèƒ½è®¡ç®—å‡ºç‰¹å®šç£ç›˜åœ¨å¸ƒå±€æ—¶åº”è·³è¿‡å¤šå°‘å—ï¼Œä»¥é¿å…é¢å¤–çš„æ—‹è½¬ï¼›è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºå‚æ•°åŒ–ï¼Œå› ä¸º FFS ä¼šè®¡ç®—å‡ºç£ç›˜çš„ç‰¹å®šæ€§èƒ½å‚æ•°ï¼Œå¹¶åˆ©ç”¨è¿™äº›å‚æ•°æ¥å†³å®šå‡†ç¡®çš„äº¤é”™å¸ƒå±€æ–¹æ¡ˆã€‚ ä½ å¯èƒ½ä¼šæƒ³ï¼šè¿™ä¸ªæ–¹æ¡ˆæ¯•ç«Ÿæ²¡é‚£ä¹ˆå¥½ã€‚äº‹å®ä¸Šï¼Œä½¿ç”¨è¿™ç§å¸ƒå±€ï¼Œä½ åªèƒ½è·å¾—å³°å€¼å¸¦å®½çš„ 50%ï¼Œå› ä¸ºä½ å¿…é¡»ç»•æ¯ä¸ªç£é“ä¸¤æ¬¡ï¼Œæ‰èƒ½è¯»å–æ¯ä¸ªåŒºå—ä¸€æ¬¡ã€‚å¹¸è¿çš„æ˜¯ï¼Œç°ä»£ç£ç›˜è¦èªæ˜å¾—å¤šï¼šå®ƒä»¬ä¼šåœ¨å†…éƒ¨è¯»å…¥æ•´ä¸ªç£é“ï¼Œå¹¶å°†å…¶ç¼“å†²åˆ°å†…éƒ¨ç£ç›˜ç¼“å­˜ä¸­ï¼ˆå› æ­¤é€šå¸¸ç§°ä¸ºç£é“ç¼“å†²åŒºï¼‰ã€‚è¿™æ ·ï¼Œåœ¨åç»­è¯»å–ç£é“æ—¶ï¼Œç£ç›˜å°±ä¼šä»ç¼“å­˜ä¸­è¿”å›æ‰€éœ€çš„æ•°æ®ã€‚å› æ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸å†éœ€è¦æ‹…å¿ƒè¿™äº›ä»¤äººéš¾ä»¥ç½®ä¿¡çš„ä½çº§ç»†èŠ‚ã€‚å¦‚æœè®¾è®¡å¾—å½“ï¼ŒæŠ½è±¡å’Œæ›´é«˜çº§åˆ«çš„æ¥å£å¯èƒ½æ˜¯ä»¶å¥½äº‹ã€‚ æ­¤å¤–ï¼Œè¿˜å¢åŠ äº†å…¶ä»–ä¸€äº›å¯ç”¨æ€§æ”¹è¿›ã€‚FFS æ˜¯æœ€æ—©å…è®¸ä½¿ç”¨é•¿æ–‡ä»¶åçš„æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸€ï¼Œä»è€Œä½¿æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶åæ›´å…·è¡¨ç°åŠ›ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å›ºå®šå¤§å°æ–¹æ³•ï¼ˆå¦‚ 8 ä¸ªå­—ç¬¦ï¼‰ã€‚æ­¤å¤–ï¼Œæ–‡ä»¶ç³»ç»Ÿè¿˜å¼•å…¥äº†ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œå³ç¬¦å·é“¾æ¥ã€‚ç¡¬é“¾æ¥çš„å±€é™æ€§åœ¨äºå®ƒä»¬ä¸èƒ½æŒ‡å‘ç›®å½•ï¼ˆå› ä¸ºæ‹…å¿ƒä¼šåœ¨æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„ä¸­å¼•å…¥å¾ªç¯ï¼‰ï¼Œè€Œä¸”åªèƒ½æŒ‡å‘åŒä¸€å·å†…çš„æ–‡ä»¶ï¼ˆå³ inode numberå¿…é¡»ä»ç„¶æœ‰æ„ä¹‰ï¼‰ã€‚ç¬¦å·é“¾æ¥å…è®¸ç”¨æˆ·åˆ›å»ºæŒ‡å‘ç³»ç»Ÿä¸­ä»»ä½•å…¶ä»–æ–‡ä»¶æˆ–ç›®å½•çš„ â€œåˆ«åâ€ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚FFS è¿˜å¼•å…¥äº†ç”¨äºé‡å‘½åæ–‡ä»¶çš„åŸå­ rename() æ“ä½œã€‚é™¤åŸºæœ¬æŠ€æœ¯å¤–ï¼Œæ˜“ç”¨æ€§æ–¹é¢çš„æ”¹è¿›ä¹Ÿä¸º FFS èµ¢å¾—äº†æ›´å¤šç”¨æˆ·ã€‚ ","date":"2024-05-11","objectID":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/:7:0","tags":["OS"],"title":"å¿«é€Ÿæ–‡ä»¶ç³»ç»Ÿ","uri":"/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 æ€ç»´æ¨¡å‹ è¦è€ƒè™‘æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬é€šå¸¸å»ºè®®è€ƒè™‘å®ƒä»¬çš„ä¸¤ä¸ªä¸åŒæ–¹é¢ï¼›å¦‚æœæ‚¨äº†è§£è¿™ä¸¤ä¸ªæ–¹é¢ï¼Œæ‚¨å¯èƒ½å°±ä¼šäº†è§£æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬å·¥ä½œåŸç†ã€‚ é¦–å…ˆæ˜¯æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®ç»“æ„ã€‚æ¢å¥è¯è¯´ï¼Œæ–‡ä»¶ç³»ç»Ÿä½¿ç”¨ä»€ä¹ˆç±»å‹çš„ç£ç›˜ç»“æ„æ¥ç»„ç»‡å…¶æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿæˆ‘ä»¬å°†çœ‹åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼ˆåŒ…æ‹¬ä¸‹é¢çš„ vsfsï¼‰é‡‡ç”¨ç®€å•çš„ç»“æ„ï¼Œå¦‚å—æ•°ç»„æˆ–å…¶ä»–å¯¹è±¡ï¼Œè€Œæ›´å¤æ‚çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ SGI çš„ XFSï¼Œä½¿ç”¨æ›´å¤æ‚çš„åŸºäºæ ‘çš„ç»“æ„ã€‚ æ–‡ä»¶ç³»ç»Ÿçš„ç¬¬äºŒä¸ªæ–¹é¢æ˜¯å®ƒçš„è®¿é—®æ–¹æ³•ã€‚å®ƒå¦‚ä½•å°†è¿›ç¨‹å‘å‡ºçš„è°ƒç”¨ï¼ˆä¾‹å¦‚ open()ã€read()ã€write() ç­‰ï¼‰æ˜ å°„åˆ°å…¶ç»“æ„ä¸Šï¼Ÿåœ¨æ‰§è¡Œç‰¹å®šç³»ç»Ÿè°ƒç”¨æœŸé—´ä¼šè¯»å–å“ªäº›ç»“æ„ï¼Ÿå†™äº†å“ªäº›ï¼Ÿæ‰€æœ‰è¿™äº›æ­¥éª¤çš„æ‰§è¡Œæ•ˆç‡å¦‚ä½•ï¼Ÿ å¦‚æœæ‚¨äº†è§£æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®ç»“æ„å’Œè®¿é—®æ–¹æ³•ï¼Œæ‚¨å°±å·²ç»å¼€å‘äº†ä¸€ä¸ªå…³äºå®ƒå¦‚ä½•çœŸæ­£å·¥ä½œçš„è‰¯å¥½æ€ç»´æ¨¡å‹ï¼Œè¿™æ˜¯ç³»ç»Ÿæ€ç»´çš„å…³é”®éƒ¨åˆ†ã€‚ æ–‡ä»¶ç³»ç»Ÿæ€ç»´æ¨¡å‹ æ€ç»´æ¨¡å‹æ˜¯ä½ åœ¨å­¦ä¹ ç³»ç»Ÿæ—¶çœŸæ­£æƒ³è¦å¼€å‘çš„ä¸œè¥¿ã€‚å¯¹äºæ–‡ä»¶ç³»ç»Ÿï¼Œæ‚¨çš„æ€ç»´æ¨¡å‹æœ€ç»ˆåº”è¯¥åŒ…æ‹¬ä»¥ä¸‹é—®é¢˜çš„ç­”æ¡ˆï¼š å“ªäº›ç£ç›˜ç»“æ„å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Ÿ å½“è¿›ç¨‹æ‰“å¼€æ–‡ä»¶æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ åœ¨è¯»å–æˆ–å†™å…¥æœŸé—´è®¿é—®å“ªäº›ç£ç›˜ç»“æ„ï¼Ÿ é€šè¿‡ç ”ç©¶å’Œæ”¹è¿›æ‚¨çš„æ€ç»´æ¨¡å‹ï¼Œæ‚¨å¯ä»¥å¯¹æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…å½¢æˆæŠ½è±¡çš„ç†è§£ï¼Œè€Œä¸ä»…ä»…æ˜¯è¯•å›¾ç†è§£æŸäº›æ–‡ä»¶ç³»ç»Ÿä»£ç çš„ç»†èŠ‚ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:1:0","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 VSFSçš„æ•´ä½“ç»„ç»‡ æˆ‘ä»¬ç°åœ¨å¼€å‘ vsfs æ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„çš„æ•´ä½“ç£ç›˜ç»„ç»‡ã€‚æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å°†ç£ç›˜åˆ†ä¸ºå—ï¼›ç®€å•çš„æ–‡ä»¶ç³»ç»Ÿä»…ä½¿ç”¨ä¸€ç§å—å¤§å°ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œè¦åšçš„ã€‚æˆ‘ä»¬é€‰æ‹©å¸¸ç”¨çš„å¤§å° 4 KBã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯¹æ„å»ºæ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜åˆ†åŒºçš„çœ‹æ³•å¾ˆç®€å•ï¼šä¸€ç³»åˆ—å—ï¼Œæ¯ä¸ªå—å¤§å°ä¸º 4 KBã€‚åœ¨å¤§å°ä¸º $N$ ä¸ª 4 KB å—çš„åˆ†åŒºä¸­ï¼Œå—çš„å¯»å€èŒƒå›´ä¸º $0$ åˆ° $N âˆ’ 1$ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸å°çš„ç£ç›˜ï¼Œåªæœ‰ 64 ä¸ªå—ï¼š ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹éœ€è¦åœ¨è¿™äº›å—ä¸­å­˜å‚¨ä»€ä¹ˆæ¥æ„å»ºæ–‡ä»¶ç³»ç»Ÿã€‚å½“ç„¶ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯ç”¨æˆ·æ•°æ®ã€‚äº‹å®ä¸Šï¼Œä»»ä½•æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¤§éƒ¨åˆ†ç©ºé—´éƒ½æ˜¯ï¼ˆå¹¶ä¸”åº”è¯¥æ˜¯ï¼‰ç”¨æˆ·æ•°æ®ã€‚æˆ‘ä»¬å°†ç”¨äºç”¨æˆ·æ•°æ®çš„ç£ç›˜åŒºåŸŸç§°ä¸ºæ•°æ®åŒºåŸŸï¼Œå¹¶ä¸”ä¸ºäº†ç®€å•èµ·è§ï¼Œä¸ºè¿™äº›å—ä¿ç•™ç£ç›˜çš„å›ºå®šéƒ¨åˆ†ï¼Œä¾‹å¦‚ç£ç›˜ä¸Š 64 ä¸ªå—ä¸­çš„æœ€å 56 ä¸ªå—ï¼š æ–‡ä»¶ç³»ç»Ÿå¿…é¡»è·Ÿè¸ªæ¯ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æ˜¯å…ƒæ•°æ®çš„å…³é”®éƒ¨åˆ†ï¼Œè·Ÿè¸ªè¯¸å¦‚å“ªäº›æ•°æ®å—ï¼ˆåœ¨æ•°æ®åŒºåŸŸä¸­ï¼‰ç»„æˆæ–‡ä»¶ã€æ–‡ä»¶çš„å¤§å°ã€å…¶æ‰€æœ‰è€…å’Œè®¿é—®æƒé™ã€è®¿é—®å’Œä¿®æ”¹æ—¶é—´ä»¥åŠå…¶ä»–ç±»ä¼¼ä¿¡æ¯ç­‰ã€‚ä¸ºäº†å­˜å‚¨è¿™äº›ä¿¡æ¯ï¼Œæ–‡ä»¶ç³»ç»Ÿé€šå¸¸æœ‰ä¸€ä¸ªç§°ä¸ºinodeçš„ç»“æ„ã€‚ ä¸ºäº†å®¹çº³inodesï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ç£ç›˜ä¸Šä¸ºå®ƒä»¬ä¿ç•™ä¸€äº›ç©ºé—´ã€‚æˆ‘ä»¬å°†ç£ç›˜çš„è¿™ä¸€éƒ¨åˆ†ç§°ä¸ºinodeè¡¨ï¼Œå®ƒä»…ä¿å­˜ç£ç›˜ä¸Šinodesçš„æ•°ç»„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç£ç›˜æ˜ åƒç°åœ¨çœ‹èµ·æ¥åƒä¸‹å›¾ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨ 64 ä¸ªå—ä¸­çš„ 5 ä¸ªä½œä¸ºinodesï¼ˆåœ¨å›¾ä¸­ç”¨ I è¡¨ç¤ºï¼‰ï¼š è¿™é‡Œæˆ‘ä»¬åº”è¯¥æ³¨æ„ï¼Œinode é€šå¸¸ä¸ä¼šé‚£ä¹ˆå¤§ï¼Œä¾‹å¦‚ 128 æˆ– 256 å­—èŠ‚ã€‚å‡è®¾æ¯ä¸ª inode 256 å­—èŠ‚ï¼Œä¸€ä¸ª 4 KB çš„å—å¯ä»¥å®¹çº³ 16 ä¸ª inodesï¼Œè€Œæˆ‘ä»¬ä¸Šé¢çš„æ–‡ä»¶ç³»ç»Ÿæ€»å…±åŒ…å« 80 ä¸ª inodesã€‚åœ¨æˆ‘ä»¬çš„ç®€å•æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ„å»ºåœ¨ä¸€ä¸ªå¾®å°çš„ 64 å—åˆ†åŒºä¸Šï¼Œè¿™ä¸ªæ•°å­—ä»£è¡¨æˆ‘ä»¬çš„æ–‡ä»¶ç³»ç»Ÿä¸­å¯ä»¥æ‹¥æœ‰çš„æœ€å¤§æ–‡ä»¶æ•°ï¼›ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæ„å»ºåœ¨æ›´å¤§ç£ç›˜ä¸Šçš„ç›¸åŒæ–‡ä»¶ç³»ç»Ÿå¯ä»¥ç®€å•åœ°åˆ†é…æ›´å¤§çš„inodeè¡¨ï¼Œä»è€Œå®¹çº³æ›´å¤šæ–‡ä»¶ã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„æ–‡ä»¶ç³»ç»Ÿå·²ç»æœ‰äº†æ•°æ®å—ï¼ˆDï¼‰å’Œ inodesï¼ˆIï¼‰ï¼Œä½†ä»ç„¶ç¼ºå°‘ä¸€äº›ä¸œè¥¿ã€‚æ­£å¦‚æ‚¨å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œä»ç„¶éœ€è¦çš„ä¸€ä¸ªä¸»è¦ç»„ä»¶æ˜¯æŸç§è·Ÿè¸ªinodesæˆ–æ•°æ®å—æ˜¯å¦ç©ºé—²æˆ–å·²åˆ†é…çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œè¿™ç§åˆ†é…ç»“æ„æ˜¯ä»»ä½•æ–‡ä»¶ç³»ç»Ÿä¸­å¿…éœ€çš„å…ƒç´ ã€‚ å½“ç„¶ï¼Œæœ‰è®¸å¤šå¯è¡Œçš„åˆ†é…è·Ÿè¸ªæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæŒ‡å‘ç¬¬ä¸€ä¸ªç©ºé—²å—çš„ç©ºé—²åˆ—è¡¨ï¼Œè¯¥å—å†æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²å—ï¼Œä¾æ­¤ç±»æ¨ã€‚ç›¸åï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸€ç§ç®€å•ä¸”æµè¡Œçš„ç»“æ„ï¼Œç§°ä¸ºä½å›¾ï¼Œå…¶ä¸­åŒ…æ‹¬æ•°æ®åŒºåŸŸï¼ˆæ•°æ®ä½å›¾ï¼‰å’Œinodeè¡¨ï¼ˆinodeä½å›¾ï¼‰ã€‚ä½å›¾æ˜¯ä¸€ä¸ªç®€å•çš„ç»“æ„ï¼šæ¯ä¸ªä½ç”¨äºæŒ‡ç¤ºç›¸åº”çš„å¯¹è±¡/å—æ˜¯ç©ºé—²ï¼ˆ0ï¼‰è¿˜æ˜¯æ­£åœ¨ä½¿ç”¨ï¼ˆ1ï¼‰ã€‚å› æ­¤æˆ‘ä»¬æ–°çš„ç£ç›˜å¸ƒå±€ï¼Œå¸¦æœ‰inodeä½å›¾ (i) å’Œæ•°æ®ä½å›¾ (d)ï¼š æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œä¸ºè¿™äº›ä½å›¾ä½¿ç”¨æ•´ä¸ª 4 KB å—æœ‰ç‚¹è¿‡å¤§ï¼›è¿™æ ·çš„ä½å›¾å¯ä»¥è·Ÿè¸ªæ˜¯å¦åˆ†é…äº†32Kä¸ªå¯¹è±¡ï¼Œä½†æˆ‘ä»¬åªæœ‰80ä¸ªinodeå’Œ56ä¸ªæ•°æ®å—ã€‚ç„¶è€Œï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸ºæ¯ä¸ªä½å›¾ä½¿ç”¨æ•´ä¸ª 4 KB å—ã€‚ æˆ‘ä»¬éå¸¸ç®€å•çš„æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç»“æ„çš„è®¾è®¡ä¸­è¿˜å‰©ä¸‹ä¸€ä¸ªå—ã€‚æˆ‘ä»¬å°†å…¶ä¿ç•™ç»™è¶…çº§å—ï¼Œåœ¨ä¸‹å›¾ä¸­ç”¨ S è¡¨ç¤ºã€‚è¶…çº§å—åŒ…å«æœ‰å…³æ­¤ç‰¹å®šæ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰å¤šå°‘ä¸ª inodes å’Œæ•°æ®å—ï¼ˆåœ¨æœ¬ä¾‹ä¸­åˆ†åˆ«ä¸º 80 å’Œ 56ï¼‰ã€inode è¡¨å¼€å§‹çš„ä½ç½®ï¼ˆå— 3ï¼‰ç­‰ç­‰ã€‚å®ƒè¿˜å¯èƒ½åŒ…å«æŸç§å¹»æ•°æ¥æ ‡è¯†æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º vsfsï¼‰ã€‚ å› æ­¤ï¼Œåœ¨æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šé¦–å…ˆè¯»å–è¶…çº§å—ï¼Œåˆå§‹åŒ–å„ç§å‚æ•°ï¼Œç„¶åå°†å·é™„åŠ åˆ°æ–‡ä»¶ç³»ç»Ÿæ ‘ä¸Šã€‚è¿™æ ·ï¼Œå½“è®¿é—®å·å†…æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿå°±èƒ½å‡†ç¡®çŸ¥é“åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æ‰€éœ€çš„ç£ç›˜ç»“æ„ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:2:0","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 æ–‡ä»¶ç»„ç»‡ï¼šInode ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:3:0","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 åŸºæœ¬ä»‹ç» æ–‡ä»¶ç³»ç»Ÿæœ€é‡è¦çš„ç£ç›˜ç»“æ„ä¹‹ä¸€æ˜¯ inodeï¼›å‡ ä¹æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿéƒ½æœ‰ä¸æ­¤ç±»ä¼¼çš„ç»“æ„ã€‚åç§° inode æ˜¯index nodeçš„ç¼©å†™ï¼Œè¿™æ˜¯ UNIXå’Œå¯èƒ½æ›´æ—©çš„ç³»ç»Ÿä¸­èµ‹äºˆå®ƒçš„å†å²åç§°ï¼Œä½¿ç”¨å®ƒæ˜¯å› ä¸ºè¿™äº›èŠ‚ç‚¹æœ€åˆæ’åˆ—åœ¨æ•°ç»„ä¸­ï¼Œå¹¶ä¸”åœ¨è®¿é—®ç‰¹å®š inode æ—¶ç´¢å¼•åˆ°è¯¥æ•°ç»„ã€‚ æ•°æ®ç»“æ„ â€” INODE inode æ˜¯è®¸å¤šæ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨çš„é€šç”¨åç§°ï¼Œç”¨äºæè¿°ä¿å­˜ç»™å®šæ–‡ä»¶å…ƒæ•°æ®çš„ç»“æ„ï¼Œä¾‹å¦‚å…¶é•¿åº¦ã€æƒé™åŠå…¶ç»„æˆå—çš„ä½ç½®ã€‚è¿™ä¸ªåå­—è‡³å°‘å¯ä»¥è¿½æº¯åˆ° UNIXï¼ˆå¦‚æœä¸æ˜¯æ›´æ—©çš„ç³»ç»Ÿçš„è¯ï¼Œå¯èƒ½æ›´æ—©å¯ä»¥è¿½æº¯åˆ° Multicsï¼‰ï¼›å®ƒæ˜¯index nodeï¼ˆç´¢å¼•èŠ‚ç‚¹ï¼‰çš„ç¼©å†™ï¼Œå› ä¸ºinode numberç”¨äºç´¢å¼•ç£ç›˜ä¸Šinodesæ•°ç»„ï¼Œä»¥ä¾¿æ‰¾åˆ°è¯¥ç¼–å·çš„inodeã€‚æ­£å¦‚æˆ‘ä»¬å°†çœ‹åˆ°çš„ï¼Œinodeçš„è®¾è®¡æ˜¯æ–‡ä»¶ç³»ç»Ÿè®¾è®¡çš„å…³é”®éƒ¨åˆ†ä¹‹ä¸€ã€‚å¤§å¤šæ•°ç°ä»£ç³»ç»Ÿå¯¹äºå®ƒä»¬è·Ÿè¸ªçš„æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰æŸç§ç±»ä¼¼çš„ç»“æ„ï¼Œä½†å¯èƒ½å°†å®ƒä»¬ç§°ä¸ºä¸åŒçš„ä¸œè¥¿ï¼ˆä¾‹å¦‚ dnodesã€fnodes ç­‰ï¼‰ã€‚ æ¯ä¸ªinodeéƒ½éšå¼åœ°é€šè¿‡ä¸€ä¸ªæ•°å­—ï¼ˆç§°ä¸ºi-numberï¼‰å¼•ç”¨ï¼Œæˆ‘ä»¬ä¹‹å‰ç§°ä¹‹ä¸ºæ–‡ä»¶çš„åº•å±‚åç§°ã€‚åœ¨vsfsï¼ˆä»¥åŠå…¶ä»–ç®€å•çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼‰ï¼Œç»™å®šä¸€ä¸ªi-numberï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿç›´æ¥è®¡ç®—å‡ºå¯¹åº”inodeä½äºç£ç›˜ä¸Šçš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸Šè¿°çš„vsfs inodeè¡¨ä¸ºä¾‹ï¼šï¼šå¤§å°ä¸º20KBï¼ˆ5ä¸ª4KBå—ï¼‰ï¼Œå› æ­¤åŒ…å«80ä¸ªinodesï¼ˆå‡è®¾æ¯ä¸ªinodeä¸º256å­—èŠ‚ï¼‰ï¼›è¿›ä¸€æ­¥å‡è®¾inodeåŒºåŸŸä»12KBå¼€å§‹ï¼ˆå³è¶…çº§å—ä»0KBå¼€å§‹ï¼Œinodeä½å›¾åœ¨åœ°å€4KBå¤„ï¼Œæ•°æ®ä½å›¾åœ¨8KBå¤„ï¼Œå› æ­¤inodeè¡¨ç´§éšå…¶åï¼‰ã€‚åœ¨vsfsä¸­ï¼Œæˆ‘ä»¬å› æ­¤æœ‰ä»¥ä¸‹å¸ƒå±€æ¥è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿåˆ†åŒºå¼€å¤´éƒ¨åˆ†çš„æƒ…å†µï¼ˆç‰¹å†™è§†å›¾ï¼‰: è¦è¯»å–numberä¸º 32 çš„ inodeï¼Œæ–‡ä»¶ç³»ç»Ÿé¦–å…ˆè¦è®¡ç®— inode åŒºåŸŸçš„åç§»é‡ï¼ˆ$32 \\cdot sizeof (inode)$ æˆ– $8192$ï¼‰ï¼Œå°†å…¶ä¸ç£ç›˜ä¸Š inode è¡¨çš„èµ·å§‹åœ°å€ï¼ˆinodeStartAddr = 12KBï¼‰ç›¸åŠ ï¼Œä»è€Œå¾—å‡ºæ‰€éœ€ inode å—çš„æ­£ç¡®å­—èŠ‚åœ°å€ï¼š20KBã€‚å›æƒ³ä¸€ä¸‹ï¼Œç£ç›˜ä¸æ˜¯å­—èŠ‚å¯»å€çš„ï¼Œè€Œæ˜¯ç”±å¤§é‡å¯å¯»å€æ‰‡åŒºï¼ˆé€šå¸¸ä¸º 512 å­—èŠ‚ï¼‰ç»„æˆã€‚å› æ­¤ï¼Œè¦è·å–åŒ…å« inode 32 çš„ inode å—ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†å‘ $\\frac{20Ã—1024}{512}$ æ‰‡åŒºæˆ– 40 æ‰‡åŒºå‘å‡ºè¯»å–å‘½ä»¤ï¼Œä»¥è·å–æ‰€éœ€çš„ inode å—ã€‚æ›´ä¸€èˆ¬åœ°è¯´ï¼Œinode å—çš„æ‰‡åŒºåœ°å€sectorå¯æŒ‰å¦‚ä¸‹æ–¹å¼è®¡ç®—ï¼š blk = (inumber * sizeof(inode_t)) / blockSize; sector = ((blk * blockSize) + inodeStartAddr) / sectorSize; æ¯ä¸ª inode å†…éƒ¨å®é™…ä¸ŠåŒ…å«äº†æ–‡ä»¶æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼šæ–‡ä»¶ç±»å‹ï¼ˆä¾‹å¦‚å¸¸è§„æ–‡ä»¶ã€ç›®å½•ç­‰ï¼‰ã€å¤§å°ã€åˆ†é…ç»™å®ƒçš„å—æ•°ã€ä¿æŠ¤ä¿¡æ¯ï¼ˆä¾‹å¦‚è°æ‹¥æœ‰è¯¥æ–‡ä»¶ã€ä»¥åŠè°å¯ä»¥è®¿é—®å®ƒï¼‰ã€ä¸€äº›æ—¶é—´ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶åˆ›å»ºã€ä¿®æ”¹æˆ–ä¸Šæ¬¡è®¿é—®çš„æ—¶é—´ï¼Œä»¥åŠæœ‰å…³å…¶æ•°æ®å—é©»ç•™åœ¨ç£ç›˜ä¸Šçš„ä½ç½®çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚æŸç§æŒ‡é’ˆï¼‰ã€‚æˆ‘ä»¬å°†æœ‰å…³æ–‡ä»¶çš„æ‰€æœ‰æ­¤ç±»ä¿¡æ¯ç§°ä¸ºå…ƒæ•°æ®ï¼›äº‹å®ä¸Šï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­é™¤äº†çº¯ç”¨æˆ·æ•°æ®ä¹‹å¤–çš„ä»»ä½•ä¿¡æ¯é€šå¸¸è¢«ç§°ä¸ºå…ƒæ•°æ®ã€‚ ext2ä¸­çš„ä¸€ä¸ªinodeç¤ºä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ inode è®¾è®¡ä¸­æœ€é‡è¦çš„å†³ç­–ä¹‹ä¸€æ˜¯å®ƒå¦‚ä½•å¼•ç”¨æ•°æ®å—çš„ä½ç½®ã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯åœ¨ inode å†…æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç›´æ¥æŒ‡é’ˆï¼ˆç£ç›˜åœ°å€ï¼‰ï¼›æ¯ä¸ªæŒ‡é’ˆæŒ‡å‘å±äºè¯¥æ–‡ä»¶çš„ä¸€ä¸ªç£ç›˜å—ã€‚è¿™ç§æ–¹æ³•æ˜¯æœ‰é™çš„ï¼šä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œå¤§äºå—å¤§å°ä¹˜ä»¥ inode ä¸­çš„ç›´æ¥æŒ‡é’ˆæ•°é‡ï¼‰ï¼Œé‚£ä¹ˆæ‚¨å°±ä¸èµ°è¿äº†ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:3:1","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 å¤šçº§ç´¢å¼• ä¸ºäº†æ”¯æŒæ›´å¤§çš„æ–‡ä»¶ï¼Œæ–‡ä»¶ç³»ç»Ÿè®¾è®¡è€…ä¸å¾—ä¸åœ¨ inodes ä¸­å¼•å…¥ä¸åŒçš„ç»“æ„ã€‚ä¸€ç§å¸¸è§çš„æƒ³æ³•æ˜¯ä½¿ç”¨ä¸€ç§è¢«ç§°ä¸ºé—´æ¥æŒ‡é’ˆçš„ç‰¹æ®ŠæŒ‡é’ˆã€‚å®ƒä¸æŒ‡å‘åŒ…å«ç”¨æˆ·æ•°æ®çš„å—ï¼Œè€Œæ˜¯æŒ‡å‘åŒ…å«æ›´å¤šæŒ‡é’ˆçš„å—ï¼Œæ¯ä¸ªæŒ‡é’ˆéƒ½æŒ‡å‘ç”¨æˆ·æ•°æ®ã€‚å› æ­¤ï¼Œä¸€ä¸ª inode å¯èƒ½æœ‰ä¸€å®šæ•°é‡çš„ç›´æ¥æŒ‡é’ˆï¼ˆå¦‚ 12 ä¸ªï¼‰å’Œä¸€ä¸ªé—´æ¥æŒ‡é’ˆã€‚å¦‚æœæ–‡ä»¶é•¿å¾—è¶³å¤Ÿå¤§ï¼Œå°±ä¼šåˆ†é…ä¸€ä¸ªé—´æ¥å—ï¼ˆæ¥è‡ªç£ç›˜çš„æ•°æ®å—åŒºåŸŸï¼‰ï¼Œå¹¶å°†é—´æ¥æŒ‡é’ˆçš„ inode æ’æ§½è®¾ç½®ä¸ºæŒ‡å‘å®ƒã€‚å‡è®¾æœ‰ 4KB çš„æ•°æ®å—å’Œ 4 å­—èŠ‚çš„ç£ç›˜åœ°å€ï¼Œåˆ™åˆå¢åŠ äº† 1024 ä¸ªæŒ‡é’ˆï¼›æ–‡ä»¶å¯ä»¥å¢é•¿åˆ° $(12 + 1024) \\cdot 4K$ æˆ– 4144KBã€‚ æ¯«ä¸å¥‡æ€ªï¼Œåœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæ‚¨å¯èƒ½å¸Œæœ›æ”¯æŒæ›´å¤§çš„æ–‡ä»¶ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œåªéœ€å‘inodeæ·»åŠ å¦ä¸€ä¸ªæŒ‡é’ˆï¼šåŒé—´æ¥æŒ‡é’ˆã€‚è¯¥æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªåŒ…å«æŒ‡å‘é—´æ¥å—çš„æŒ‡é’ˆçš„å—ï¼Œæ¯ä¸ªé—´æ¥å—éƒ½åŒ…å«å¯¹æ•°æ®å—çš„æŒ‡é’ˆã€‚å› æ­¤ï¼ŒåŒé—´æ¥å—å¢åŠ äº†é€šè¿‡é¢å¤– $1024 Ã— 1024$ æˆ– 100 ä¸‡ä¸ª 4KB å—æ¥æ‰©å±•æ–‡ä»¶çš„å¯èƒ½æ€§ï¼Œæ¢å¥è¯è¯´æ”¯æŒè¶…è¿‡ 4GB å¤§å°çš„æ–‡ä»¶ã€‚ç„¶è€Œæ‚¨å¯èƒ½éœ€è¦æ›´å¤šï¼Œå¹¶ä¸”æˆ‘ä»¬æ‰“èµŒæ‚¨çŸ¥é“è¿™å°†å¯¼è‡´ä»€ä¹ˆï¼šä¸‰é‡é—´æ¥æŒ‡é’ˆã€‚ æ€»ä½“è€Œè¨€ï¼Œè¿™ç§ä¸å¹³è¡¡æ ‘è¢«ç§°ä¸ºå¤šçº§ç´¢å¼•æ–¹æ³•æ¥å®šä½æ–‡ä»¶å—ã€‚è®©æˆ‘ä»¬ä»¥åäºŒä¸ªç›´æ¥æŒ‡é’ˆä¸ºä¾‹è¿›è¡Œç ”ç©¶ï¼Œå¹¶ä¸”è¿˜æœ‰å•é—´æ¥å—å’ŒåŒé—´æ¥å—ã€‚å‡è®¾æ¯ä¸ªå—å¤§å°ä¸º 4 KBï¼Œå¹¶ä¸”æ¯ä¸ªæŒ‡é’ˆå ç”¨ 4 å­—èŠ‚ï¼Œåˆ™è¯¥ç»“æ„å¯ä»¥å®¹çº³ç•¥å¤§äº 4 GB å¤§å°çš„æ–‡ä»¶ï¼ˆå³ $(12 + 1024 + 1024^2) Ã— 4 KBï¼‰$ã€‚æ‚¨èƒ½è®¡ç®—å‡ºé€šè¿‡æ·»åŠ ä¸‰é‡é—´æ¥å—å¯ä»¥å¤„ç†å¤šå¤§å°ºå¯¸çš„æ–‡ä»¶å—ï¼Ÿï¼ˆ$1024^3$ï¼‰ è®¸å¤šæ–‡ä»¶ç³»ç»Ÿä½¿ç”¨å¤šçº§ç´¢å¼•ï¼Œå…¶ä¸­åŒ…æ‹¬å¸¸ç”¨æ–‡ä»¶ç³»ç»Ÿå¦‚ Linux ext2å’Œext3ã€NetApp çš„WAFL ï¼Œä»¥åŠåŸå§‹ UNIX æ–‡ä»¶ç³»ç»Ÿç­‰ç­‰ ã€‚å…¶ä»–ä¸€äº›æ–‡ä»¶ç³»ç»Ÿå¦‚ SGI XFS å’Œ Linux ext4 ä½¿ç”¨èŒƒå›´è€Œä¸æ˜¯ç®€å•æŒ‡é’ˆï¼ˆå®ƒä»¬ç±»ä¼¼äºè™šæ‹Ÿå†…å­˜è®¨è®ºä¸­æ®µï¼‰ã€‚ è€ƒè™‘åŸºäºèŒƒå›´çš„æ–¹æ³• å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨èŒƒå›´è€Œä¸æ˜¯æŒ‡é’ˆã€‚èŒƒå›´åªæ˜¯ä¸€ä¸ªç£ç›˜æŒ‡é’ˆåŠ ä¸Šä¸€ä¸ªé•¿åº¦ï¼ˆä»¥å—ä¸ºå•ä½ï¼‰ï¼›å› æ­¤ï¼Œä¸éœ€è¦ä¸ºæ–‡ä»¶çš„æ¯ä¸ªå—æä¾›ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œåªéœ€è¦ä¸€ä¸ªæŒ‡é’ˆå’Œä¸€ä¸ªé•¿åº¦æ¥æŒ‡å®šæ–‡ä»¶åœ¨ç£ç›˜ä¸Šçš„ä½ç½®ã€‚åªæœ‰å•ä¸ªèŒƒå›´æ˜¯æœ‰é™çš„ï¼Œå› ä¸ºåœ¨åˆ†é…æ–‡ä»¶æ—¶å¯èƒ½å¾ˆéš¾æ‰¾åˆ°ç£ç›˜ä¸Šè¿ç»­çš„å¯ç”¨ç©ºé—´å—ã€‚å› æ­¤ï¼ŒåŸºäºç›˜åŒºçš„æ–‡ä»¶ç³»ç»Ÿé€šå¸¸å…è®¸å¤šä¸ªç›˜åŒºï¼Œä»è€Œåœ¨æ–‡ä»¶åˆ†é…æœŸé—´ä¸ºæ–‡ä»¶ç³»ç»Ÿæä¾›äº†æ›´å¤šçš„è‡ªç”±åº¦ã€‚ æ¯”è¾ƒè¿™ä¸¤ç§æ–¹æ³•ï¼ŒåŸºäºæŒ‡é’ˆçš„æ–¹æ³•æœ€çµæ´»ï¼Œä½†æ¯ä¸ªæ–‡ä»¶ä½¿ç”¨å¤§é‡å…ƒæ•°æ®ï¼ˆç‰¹åˆ«æ˜¯å¯¹äºå¤§æ–‡ä»¶ï¼‰ã€‚åŸºäºèŒƒå›´çš„æ–¹æ³•ä¸å¤ªçµæ´»ï¼Œä½†æ›´ç´§å‡‘ï¼›ç‰¹åˆ«æ˜¯ï¼Œå½“ç£ç›˜ä¸Šæœ‰è¶³å¤Ÿçš„å¯ç”¨ç©ºé—´å¹¶ä¸”æ–‡ä»¶å¯ä»¥è¿ç»­å¸ƒç½®æ—¶ï¼ˆè¿™å®é™…ä¸Šæ˜¯ä»»ä½•æ–‡ä»¶åˆ†é…ç­–ç•¥çš„ç›®æ ‡ï¼‰ï¼Œå®ƒä»¬å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œã€‚ æ‚¨å¯èƒ½æƒ³çŸ¥é“ï¼šä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™æ ·çš„ä¸å¹³è¡¡æ ‘ï¼Ÿä¸ºä»€ä¹ˆä¸é‡‡ç”¨å…¶ä»–æ–¹æ³•å‘¢ï¼Ÿäº‹å®è¯æ˜ï¼Œè®¸å¤šç ”ç©¶äººå‘˜ç ”ç©¶äº†æ–‡ä»¶ç³»ç»ŸåŠå…¶ä½¿ç”¨æ–¹å¼ï¼Œå‡ ä¹æ¯æ¬¡ä»–ä»¬éƒ½ä¼šå‘ç°å‡ åå¹´æ¥ä¸€ç›´å­˜åœ¨çš„æŸäº›â€œçœŸç†â€ã€‚å…¶ä¸­ä¸€é¡¹å‘ç°æ˜¯å¤§å¤šæ•°æ–‡ä»¶éƒ½å¾ˆå°ã€‚è¿™ç§ä¸å¹³è¡¡çš„è®¾è®¡åæ˜ äº†è¿™æ ·çš„ç°å®ï¼›å¦‚æœå¤§å¤šæ•°æ–‡ä»¶ç¡®å®å¾ˆå°ï¼Œé‚£ä¹ˆé’ˆå¯¹è¿™ç§æƒ…å†µè¿›è¡Œä¼˜åŒ–æ˜¯æœ‰æ„ä¹‰çš„ã€‚å› æ­¤ï¼Œä½¿ç”¨å°‘é‡çš„ç›´æ¥æŒ‡é’ˆï¼ˆå…¸å‹æ•°å­—ä¸º 12ï¼‰ï¼Œä¸€ä¸ª inode å¯ä»¥ç›´æ¥æŒ‡å‘ 48 KB çš„æ•°æ®ï¼Œè€Œå¯¹äºè¾ƒå¤§çš„æ–‡ä»¶åˆ™éœ€è¦ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰é—´æ¥å—ã€‚Agrawalç­‰äºº æœ€è¿‘çš„ä¸€é¡¹ç ”ç©¶æ€»ç»“äº†è¿™äº›ç»“æœã€‚ å½“ç„¶ï¼Œåœ¨inodeè®¾è®¡çš„ç©ºé—´ä¸­ï¼Œè¿˜å­˜åœ¨è®¸å¤šå…¶ä»–çš„å¯èƒ½æ€§ï¼›æ¯•ç«Ÿï¼Œinode åªæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œä»»ä½•å­˜å‚¨ç›¸å…³ä¿¡æ¯å¹¶èƒ½å¤Ÿæœ‰æ•ˆæŸ¥è¯¢çš„æ•°æ®ç»“æ„å°±è¶³å¤Ÿäº†ã€‚ç”±äºæ–‡ä»¶ç³»ç»Ÿè½¯ä»¶å¾ˆå®¹æ˜“æ›´æ”¹ï¼Œå› æ­¤å¦‚æœå·¥ä½œè´Ÿè½½æˆ–æŠ€æœ¯å‘ç”Ÿå˜åŒ–ï¼Œæ‚¨åº”è¯¥æ„¿æ„æ¢ç´¢ä¸åŒçš„è®¾è®¡ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:3:2","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 ç›®å½•ç»„ç»‡ åœ¨ vsfs ä¸­ï¼ˆä¸è®¸å¤šæ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼‰ï¼Œç›®å½•çš„ç»„ç»‡å¾ˆç®€å•ï¼›ç›®å½•åŸºæœ¬ä¸ŠåªåŒ…å«ï¼ˆæ¡ç›®åç§°ï¼Œinode numberï¼‰å¯¹çš„åˆ—è¡¨ã€‚å¯¹äºç»™å®šç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œç›®å½•çš„æ•°æ®å—ä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ•°å­—ã€‚å¯¹äºæ¯ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½æœ‰ä¸€ä¸ªé•¿åº¦ï¼ˆå‡è®¾åç§°å¯å˜ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ç›®å½• dirï¼ˆinode numberä¸º 5ï¼‰ä¸­åŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼ˆfooã€bar å’Œ foobar_is_a_pretty_longname ï¼‰ï¼Œinode numberåˆ†åˆ«ä¸º 12ã€13 å’Œ 24ã€‚ dir çš„ç£ç›˜æ•°æ®å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ¯ä¸ªæ¡ç›®éƒ½æœ‰ä¸€ä¸ª inode numberã€è®°å½•é•¿åº¦ï¼ˆåç§°çš„æ€»å­—èŠ‚æ•°åŠ ä¸Šä»»ä½•å‰©ä½™ç©ºé—´ï¼‰ã€å­—ç¬¦ä¸²é•¿åº¦ï¼ˆåç§°çš„å®é™…é•¿åº¦ï¼‰ï¼Œæœ€åæ˜¯æ¡ç›®çš„åç§°ã€‚è¯·æ³¨æ„ï¼Œæ¯ä¸ªç›®å½•éƒ½æœ‰ä¸¤ä¸ªé¢å¤–çš„æ¡ç›®ï¼š.ç‚¹ â€œå’Œ... â€œç‚¹-ç‚¹â€ï¼›ç‚¹ç›®å½•åªæ˜¯å½“å‰ç›®å½•ï¼ˆæœ¬ä¾‹ä¸­ä¸º dirï¼‰ï¼Œè€Œç‚¹-ç‚¹æ˜¯çˆ¶ç›®å½•ï¼ˆæœ¬ä¾‹ä¸­ä¸ºæ ¹ç›®å½•ï¼‰ã€‚ åˆ é™¤æ–‡ä»¶ï¼ˆä¾‹å¦‚è°ƒç”¨ unlink()ï¼‰å¯èƒ½ä¼šåœ¨ç›®å½•ä¸­é—´ç•™ä¸‹ä¸€ä¸ªç©ºä½ï¼Œå› æ­¤ä¹Ÿåº”è¯¥æœ‰æŸç§æ–¹æ³•æ¥æ ‡è®°è¿™ä¸ªç©ºä½ï¼ˆä¾‹å¦‚ä½¿ç”¨ä¿ç•™çš„ inode numberï¼Œå¦‚ 0ï¼‰ã€‚è¿™ç§åˆ é™¤æ˜¯ä½¿ç”¨è®°å½•é•¿åº¦çš„åŸå› ä¹‹ä¸€ï¼šæ–°çš„æ¡ç›®å¯èƒ½ä¼šé‡å¤ä½¿ç”¨æ—§çš„ã€æ›´å¤§çš„æ¡ç›®ï¼Œå› æ­¤ä¼šæœ‰é¢å¤–çš„ç©ºé—´ã€‚ åŸºäºé“¾æ¥çš„æ–¹æ³• è®¾è®¡ inode çš„å¦ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨é“¾è¡¨ã€‚å› æ­¤ï¼Œåœ¨inodeå†…ï¼Œæ‚¨ä¸éœ€è¦å¤šä¸ªæŒ‡é’ˆï¼Œè€Œåªéœ€è¦ä¸€ä¸ªæŒ‡é’ˆæ¥æŒ‡å‘æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªå—ã€‚è¦å¤„ç†æ›´å¤§çš„æ–‡ä»¶ï¼Œè¯·åœ¨è¯¥æ•°æ®å—çš„æœ«å°¾æ·»åŠ å¦ä¸€ä¸ªæŒ‡é’ˆï¼Œä¾æ­¤ç±»æ¨ï¼Œè¿™æ ·å°±å¯ä»¥æ”¯æŒå¤§æ–‡ä»¶ã€‚ æ­£å¦‚æ‚¨å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œé“¾æ¥æ–‡ä»¶åˆ†é…å¯¹äºæŸäº›å·¥ä½œè´Ÿè½½æ¥è¯´è¡¨ç°ä¸ä½³ï¼›ä¾‹å¦‚ï¼Œè€ƒè™‘è¯»å–æ–‡ä»¶çš„æœ€åä¸€ä¸ªå—ï¼Œæˆ–è€…åªæ˜¯è¿›è¡Œéšæœºè®¿é—®ã€‚å› æ­¤ï¼Œä¸ºäº†ä½¿é“¾æ¥åˆ†é…æ›´å¥½åœ°å·¥ä½œï¼Œä¸€äº›ç³»ç»Ÿå°†åœ¨å†…å­˜ä¸­ä¿ç•™é“¾æ¥ä¿¡æ¯è¡¨ï¼Œè€Œä¸æ˜¯å°†ä¸‹ä¸€ä¸ªæŒ‡é’ˆä¸æ•°æ®å—æœ¬èº«ä¸€èµ·å­˜å‚¨ã€‚è¯¥è¡¨ç”±æ•°æ®å—Dçš„åœ°å€ç´¢å¼•ï¼›æ¡ç›®çš„å†…å®¹åªæ˜¯ D çš„ä¸‹ä¸€ä¸ªæŒ‡é’ˆï¼Œå³æ–‡ä»¶ä¸­ D åé¢çš„ä¸‹ä¸€ä¸ªå—çš„åœ°å€ã€‚ç©ºå€¼ä¹Ÿå¯èƒ½å­˜åœ¨ï¼ˆæŒ‡ç¤ºæ–‡ä»¶ç»“æŸï¼‰ï¼Œæˆ–è€…å…¶ä»–ä¸€äº›æ ‡è®°æ¥æŒ‡ç¤ºç‰¹å®šå—æ˜¯ç©ºé—²çš„ã€‚æ‹¥æœ‰è¿™æ ·çš„ä¸‹ä¸€ä¸ªæŒ‡é’ˆè¡¨ä½¿å¾—é“¾æ¥åˆ†é…æ–¹æ¡ˆå¯ä»¥æœ‰æ•ˆåœ°è¿›è¡Œéšæœºæ–‡ä»¶è®¿é—®ï¼Œåªéœ€é¦–å…ˆæ‰«æï¼ˆåœ¨å†…å­˜ä¸­ï¼‰è¡¨ä»¥æ‰¾åˆ°æ‰€éœ€çš„å—ï¼Œç„¶åç›´æ¥è®¿é—®ï¼ˆåœ¨ç£ç›˜ä¸Šï¼‰å®ƒã€‚ è¿™æ ·çš„è¡¨æ˜¯ä¸æ˜¯å¬èµ·æ¥å¾ˆç†Ÿæ‚‰ï¼Ÿæˆ‘ä»¬æ‰€æè¿°çš„æ˜¯æ–‡ä»¶åˆ†é…è¡¨æˆ– FAT æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬ç»“æ„ã€‚æ˜¯çš„ï¼Œè¿™ä¸ªç»å…¸çš„æ—§ Windows æ–‡ä»¶ç³»ç»Ÿï¼ˆåœ¨ NTFSä¹‹å‰ï¼‰åŸºäºç®€å•çš„åŸºäºé“¾æ¥çš„åˆ†é…æ–¹æ¡ˆã€‚ä¸æ ‡å‡† UNIX æ–‡ä»¶ç³»ç»Ÿè¿˜å­˜åœ¨å…¶ä»–å·®å¼‚ï¼›ä¾‹å¦‚ï¼Œæœ¬èº«æ²¡æœ‰inodesï¼Œè€Œæ˜¯å­˜å‚¨æœ‰å…³æ–‡ä»¶çš„å…ƒæ•°æ®å¹¶ç›´æ¥å¼•ç”¨è¯¥æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªå—çš„ç›®å½•æ¡ç›®ï¼Œè¿™ä½¿å¾—åˆ›å»ºç¡¬é“¾æ¥å˜å¾—ä¸å¯èƒ½ã€‚ æ‚¨å¯èƒ½æƒ³çŸ¥é“ç›®å½•åˆ°åº•å­˜å‚¨åœ¨å“ªé‡Œã€‚é€šå¸¸ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†ç›®å½•è§†ä¸ºä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ã€‚å› æ­¤ï¼Œç›®å½•åœ¨ inode è¡¨ä¸­çš„æŸä¸ªä½ç½®æœ‰ä¸€ä¸ª inodeï¼ˆinode çš„ type å­—æ®µæ ‡è®°ä¸ºâ€œç›®å½•â€è€Œä¸æ˜¯â€œå¸¸è§„æ–‡ä»¶â€ï¼‰ã€‚è¯¥ç›®å½•å…·æœ‰inodeæŒ‡å‘çš„æ•°æ®å—ï¼ˆä¹Ÿè®¸è¿˜æœ‰é—´æ¥å—ï¼‰ï¼›è¿™äº›æ•°æ®å—ä½äºæˆ‘ä»¬ç®€å•æ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®å—åŒºåŸŸä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç£ç›˜ç»“æ„ä¿æŒä¸å˜ã€‚ æˆ‘ä»¬è¿˜åº”è¯¥å†æ¬¡æ³¨æ„ï¼Œè¿™ä¸ªç®€å•çš„çº¿æ€§ç›®å½•æ¡ç›®åˆ—è¡¨å¹¶ä¸æ˜¯å­˜å‚¨æ­¤ç±»ä¿¡æ¯çš„å”¯ä¸€æ–¹æ³•ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œä»»ä½•æ•°æ®ç»“æ„éƒ½æ˜¯å¯èƒ½çš„ã€‚ä¾‹å¦‚ï¼ŒXFSä»¥ B æ ‘å½¢å¼å­˜å‚¨ç›®å½•ï¼Œä½¿æ–‡ä»¶åˆ›å»ºæ“ä½œï¼ˆå¿…é¡»ç¡®ä¿æ–‡ä»¶ååœ¨åˆ›å»ºä¹‹å‰æœªä½¿ç”¨è¿‡ï¼‰æ¯”å…·æœ‰å¿…é¡»åœ¨å…¶ç›®å½•ä¸­å®Œæ•´æ‰«æçš„ç®€å•åˆ—è¡¨çš„ç³»ç»Ÿæ›´å¿«ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:4:0","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 ç©ºé—²ç©ºé—´ç®¡ç† æ–‡ä»¶ç³»ç»Ÿå¿…é¡»è·Ÿè¸ªå“ªäº› inodes å’Œæ•°æ®å—æ˜¯ç©ºé—²çš„ï¼Œå“ªäº›ä¸æ˜¯ï¼Œä»¥ä¾¿åœ¨åˆ†é…æ–°æ–‡ä»¶æˆ–ç›®å½•æ—¶èƒ½ä¸ºå…¶æ‰¾åˆ°ç©ºé—´ã€‚å› æ­¤ï¼Œç©ºé—²ç©ºé—´ç®¡ç†å¯¹æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿéƒ½å¾ˆé‡è¦ã€‚åœ¨ vsfs ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªç®€å•çš„ä½å›¾å¯ä»¥å®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¿…é¡»ä¸ºè¯¥æ–‡ä»¶åˆ†é…ä¸€ä¸ª inodeã€‚å› æ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†åœ¨ä½å›¾ä¸­æœç´¢ç©ºé—²çš„ inodeï¼Œå¹¶å°†å…¶åˆ†é…ç»™æ–‡ä»¶ï¼›æ–‡ä»¶ç³»ç»Ÿå¿…é¡»å°† inode æ ‡è®°ä¸ºå·²ç”¨ï¼ˆç”¨ 1 è¡¨ç¤ºï¼‰ï¼Œå¹¶æœ€ç»ˆç”¨æ­£ç¡®çš„ä¿¡æ¯æ›´æ–°ç£ç›˜ä½å›¾ã€‚åœ¨åˆ†é…æ•°æ®å—æ—¶ï¼Œä¹Ÿä¼šè¿›è¡Œç±»ä¼¼çš„æ“ä½œã€‚ åœ¨ä¸ºæ–°æ–‡ä»¶åˆ†é…æ•°æ®å—æ—¶ï¼Œè¿˜å¯èƒ½éœ€è¦è€ƒè™‘ä¸€äº›å…¶ä»–å› ç´ ã€‚ä¾‹å¦‚ï¼Œä¸€äº› Linux æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ ext2 å’Œ ext3ï¼‰åœ¨åˆ›å»ºæ–°æ–‡ä»¶å¹¶éœ€è¦æ•°æ®å—æ—¶ï¼Œä¼šå¯»æ‰¾ä¸€è¿ä¸²ç©ºé—²çš„å—ï¼ˆå¦‚ 8 ä¸ªï¼‰ï¼›é€šè¿‡æ‰¾åˆ°è¿™æ ·ä¸€è¿ä¸²ç©ºé—²çš„å—ï¼Œç„¶åå°†å®ƒä»¬åˆ†é…ç»™æ–°åˆ›å»ºçš„æ–‡ä»¶ï¼Œæ–‡ä»¶ç³»ç»Ÿå¯ä»¥ä¿è¯æ–‡ä»¶çš„ä¸€éƒ¨åˆ†åœ¨ç£ç›˜ä¸Šæ˜¯è¿ç»­çš„ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚å› æ­¤ï¼Œè¿™ç§é¢„åˆ†é…ç­–ç•¥æ˜¯ä¸ºæ•°æ®å—åˆ†é…ç©ºé—´æ—¶å¸¸ç”¨çš„å¯å‘å¼æ–¹æ³•ã€‚ ç®¡ç†å¯ç”¨ç©ºé—´çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼›ä½å›¾åªæ˜¯ä¸€ç§æ–¹å¼ã€‚ä¸€äº›æ—©æœŸçš„æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨ç©ºé—²åˆ—è¡¨ï¼Œå…¶ä¸­è¶…çº§å—ä¸­çš„å•ä¸ªæŒ‡é’ˆè¢«ä¿ç•™æŒ‡å‘ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼›åœ¨è¯¥å—å†…ï¼Œä¿ç•™ä¸‹ä¸€ä¸ªç©ºé—²æŒ‡é’ˆï¼Œä»è€Œå½¢æˆç³»ç»Ÿç©ºé—²å—çš„åˆ—è¡¨ã€‚å½“éœ€è¦ä¸€ä¸ªå—æ—¶ï¼Œä½¿ç”¨å¤´å—å¹¶ç›¸åº”åœ°æ›´æ–°åˆ—è¡¨ã€‚ ç°ä»£æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨æ›´å¤æ‚çš„æ•°æ®ç»“æ„ã€‚ä¾‹å¦‚ï¼ŒSGI çš„ XFSä½¿ç”¨æŸç§å½¢å¼çš„ B æ ‘æ¥ç´§å‡‘åœ°è¡¨ç¤ºç£ç›˜çš„å“ªäº›å—æ˜¯ç©ºé—²çš„ã€‚ä¸ä»»ä½•æ•°æ®ç»“æ„ä¸€æ ·ï¼Œä¸åŒçš„æ—¶ç©ºæƒè¡¡éƒ½æ˜¯å¯èƒ½çš„ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:5:0","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 è®¿é—®è·¯å¾„ï¼šè¯»å†™ æ—¢ç„¶æˆ‘ä»¬å¯¹æ–‡ä»¶å’Œç›®å½•åœ¨ç£ç›˜ä¸Šçš„å­˜å‚¨æ–¹å¼æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œæˆ‘ä»¬å°±åº”è¯¥èƒ½å¤Ÿåœ¨è¯»å–æˆ–å†™å…¥æ–‡ä»¶çš„è¿‡ç¨‹ä¸­è·Ÿè¸ªæ“ä½œæµç¨‹ã€‚å› æ­¤ï¼Œäº†è§£è®¿é—®è·¯å¾„ä¸Šå‘ç”Ÿçš„äº‹æƒ…æ˜¯ç†è§£æ–‡ä»¶ç³»ç»Ÿå¦‚ä½•å·¥ä½œçš„ç¬¬äºŒä¸ªå…³é”®ï¼›è¯·æ³¨æ„ï¼ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å‡è®¾æ–‡ä»¶ç³»ç»Ÿå·²ç»åŠ è½½ï¼Œå› æ­¤è¶…çº§å—å·²ç»åœ¨å†…å­˜ä¸­ã€‚å…¶ä»–ä¸€åˆ‡ï¼ˆå³ inodesã€ç›®å½•ï¼‰ä»åœ¨ç£ç›˜ä¸Šã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:6:0","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.1 ä»ç£ç›˜è¯»å–æ–‡ä»¶ åœ¨è¿™ä¸ªç®€å•çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå‡è®¾æ‚¨åªæƒ³ç®€å•åœ°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼ˆä¾‹å¦‚ /foo/barï¼‰ï¼Œè¯»å–å®ƒï¼Œç„¶åå…³é—­å®ƒã€‚å¯¹äºè¿™ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å‡è®¾æ–‡ä»¶å¤§å°ä»…ä¸º 12KBï¼ˆå³ 3 ä¸ªå—ï¼‰ã€‚ å½“å‘å‡º open(\"/foo/bar\", O RDONLY) è°ƒç”¨æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿé¦–å…ˆéœ€è¦æ‰¾åˆ°æ–‡ä»¶ bar çš„ inodeï¼Œä»¥è·å–æœ‰å…³æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼ˆæƒé™ä¿¡æ¯ã€æ–‡ä»¶å¤§å°ç­‰ï¼‰ ã€‚ä¸ºæ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿæ‰¾åˆ°inodeï¼Œä½†å®ƒç°åœ¨æ‹¥æœ‰çš„åªæ˜¯å®Œæ•´è·¯å¾„åã€‚æ–‡ä»¶ç³»ç»Ÿå¿…é¡»éå†è·¯å¾„åï¼Œä»è€Œæ‰¾åˆ°æ‰€éœ€çš„inodeã€‚ æ‰€æœ‰éå†éƒ½ä»æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼ˆç®€ç§°ä¸º /ï¼‰å¼€å§‹ã€‚å› æ­¤ï¼ŒFSé¦–å…ˆä»ç£ç›˜è¯»å–çš„æ˜¯æ ¹ç›®å½•çš„inodeã€‚ä½†æ˜¯è¿™ä¸ªç´¢å¼•èŠ‚ç‚¹åœ¨å“ªé‡Œå‘¢ï¼Ÿè¦æ‰¾åˆ°ä¸€ä¸ª inodeï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“å®ƒçš„ i-numberã€‚é€šå¸¸ï¼Œæˆ‘ä»¬åœ¨å…¶çˆ¶ç›®å½•ä¸­æŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•çš„ i-numberï¼›æ ¹æ²¡æœ‰çˆ¶çˆ¶ç›®å½•ï¼ˆæ ¹æ®å®šä¹‰ï¼‰ã€‚å› æ­¤ï¼Œæ ¹ inode numberå¿…é¡»æ˜¯â€œä¼—æ‰€å‘¨çŸ¥çš„â€ï¼›å½“æ–‡ä»¶ç³»ç»Ÿè¢«æŒ‚è½½æ—¶ï¼ŒFSå¿…é¡»çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆã€‚åœ¨å¤§å¤šæ•° UNIX æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ ¹ inode numberä¸º 2ã€‚å› æ­¤ï¼Œä¸ºäº†å¼€å§‹è¯¥è¿‡ç¨‹ï¼ŒFS è¯»å–åŒ…å« inode numberä¸º2 çš„å—ï¼ˆç¬¬ä¸€ä¸ª inode å—ï¼‰ã€‚ ä¸€æ—¦è¯»å…¥ inodeï¼ŒFS å°±å¯ä»¥åœ¨å…¶ä¸­æŸ¥æ‰¾æŒ‡å‘æ•°æ®å—çš„æŒ‡é’ˆï¼Œå…¶ä¸­åŒ…å«æ ¹ç›®å½•çš„å†…å®¹ã€‚å› æ­¤ï¼ŒFS å°†ä½¿ç”¨è¿™äº›ç£ç›˜ä¸Šçš„æŒ‡é’ˆæ¥è¯»å–ç›®å½•ï¼Œåœ¨æœ¬ä¾‹ä¸­æŸ¥æ‰¾ foo çš„æ¡ç›®ã€‚é€šè¿‡è¯»å…¥ä¸€ä¸ªæˆ–å¤šä¸ªç›®å½•æ•°æ®å—ï¼Œå®ƒå°†æ‰¾åˆ° foo çš„æ¡ç›®ï¼›ä¸€æ—¦æ‰¾åˆ°ï¼ŒFS ä¹Ÿå°†æ‰¾åˆ°æ¥ä¸‹æ¥éœ€è¦çš„ foo çš„ inode numberï¼ˆå‡è®¾æ˜¯ 44ï¼‰ã€‚ ä¸‹ä¸€æ­¥æ˜¯é€’å½’éå†è·¯å¾„åï¼Œç›´åˆ°æ‰¾åˆ°æ‰€éœ€çš„ inodeã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒFSè¯»å–åŒ…å«fooçš„inodeçš„å—ï¼Œç„¶åè¯»å–å…¶ç›®å½•æ•°æ®ï¼Œæœ€åæ‰¾åˆ°barçš„inode numberã€‚ open() çš„æœ€åä¸€æ­¥æ˜¯å°† bar çš„ inode è¯»å…¥å†…å­˜ï¼›ç„¶åï¼ŒFS è¿›è¡Œæœ€ç»ˆçš„æƒé™æ£€æŸ¥ï¼Œåœ¨æ¯ä¸ªè¿›ç¨‹çš„æ‰“å¼€æ–‡ä»¶è¡¨ä¸­ä¸ºæ­¤è¿›ç¨‹åˆ†é…ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå¹¶å°†å…¶è¿”å›ç»™ç”¨æˆ·ã€‚ æ‰“å¼€åï¼Œç¨‹åºå¯ä»¥å‘å‡º read() ç³»ç»Ÿè°ƒç”¨æ¥è¯»å–æ–‡ä»¶ã€‚å› æ­¤ï¼Œç¬¬ä¸€æ¬¡è¯»å–ï¼ˆåœ¨åç§»é‡ 0 å¤„ï¼Œé™¤éå·²è°ƒç”¨ lseek()ï¼‰å°†è¯»å–æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªå—ï¼Œå¹¶æŸ¥è¯¢ inode ä»¥æŸ¥æ‰¾è¯¥å—çš„ä½ç½®ï¼›å®ƒè¿˜å¯èƒ½ç”¨æ–°çš„ä¸Šæ¬¡è®¿é—®æ—¶é—´æ›´æ–°inodeã€‚è¯»å–å°†è¿›ä¸€æ­¥æ›´æ–°è¯¥æ–‡ä»¶æè¿°ç¬¦çš„å†…å­˜ä¸­æ‰“å¼€æ–‡ä»¶è¡¨ï¼Œæ›´æ–°æ–‡ä»¶åç§»é‡ï¼Œä»¥ä¾¿ä¸‹ä¸€æ¬¡è¯»å–å°†è¯»å–ç¬¬äºŒä¸ªæ–‡ä»¶å—ç­‰ã€‚ åœ¨æŸä¸ªæ—¶åˆ»ï¼Œæ–‡ä»¶å°†è¢«å…³é—­ã€‚è¿™é‡Œè¦åšçš„å·¥ä½œè¦å°‘å¾—å¤šï¼›æ˜¾ç„¶ï¼Œæ–‡ä»¶æè¿°ç¬¦åº”è¯¥è¢«é‡Šæ”¾ï¼Œä½†ç°åœ¨ï¼Œè¿™å°±æ˜¯ FS çœŸæ­£éœ€è¦åšçš„ã€‚ä¸å‘ç”Ÿä»»ä½•ç£ç›˜ I/Oã€‚ ä¸‹å›¾æè¿°äº†æ•´ä¸ªè¿‡ç¨‹ï¼›æ—¶é—´åœ¨å›¾ä¸­å‘ä¸‹å¢åŠ ã€‚åœ¨å›¾ä¸­ï¼Œæ‰“å¼€æ–‡ä»¶ä¼šå¯¼è‡´å‘ç”Ÿå¤§é‡è¯»å–ï¼Œä»¥ä¾¿æœ€ç»ˆæ‰¾åˆ°æ–‡ä»¶çš„ inodeã€‚ä¹‹åï¼Œè¯»å–æ¯ä¸ªå—éœ€è¦æ–‡ä»¶ç³»ç»Ÿé¦–å…ˆæŸ¥çœ‹ inodeï¼Œç„¶åè¯»å–è¯¥å—ï¼Œç„¶åé€šè¿‡å†™å…¥æ›´æ–° inode çš„ä¸Šæ¬¡è®¿é—®æ—¶é—´å­—æ®µã€‚ å¦è¯·æ³¨æ„ï¼Œæ‰“å¼€æ“ä½œç”Ÿæˆçš„ I/O é‡ä¸è·¯å¾„åçš„é•¿åº¦æˆæ­£æ¯”ã€‚å¯¹äºè·¯å¾„ä¸­çš„æ¯ä¸ªé™„åŠ ç›®å½•ï¼Œæˆ‘ä»¬å¿…é¡»è¯»å–å…¶inodeåŠå…¶æ•°æ®ã€‚å¤§å‹ç›®å½•çš„å­˜åœ¨ä¼šä½¿æƒ…å†µå˜å¾—æ›´ç³Ÿï¼›åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦è¯»å–ä¸€ä¸ªæ•°æ®å—æ¥è·å–ç›®å½•çš„å†…å®¹ï¼Œè€Œå¯¹äºä¸€ä¸ªå¤§ç›®å½•ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¯»å–è®¸å¤šæ•°æ®å—æ‰èƒ½æ‰¾åˆ°æ‰€éœ€çš„æ¡ç›®ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:6:1","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.2 ä»ç£ç›˜å†™å…¥æ–‡ä»¶ å†™å…¥æ–‡ä»¶çš„è¿‡ç¨‹ä¸æ­¤ç±»ä¼¼ã€‚é¦–å…ˆï¼Œå¿…é¡»æ‰“å¼€æ–‡ä»¶ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ã€‚ç„¶åï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å‘å‡º write() è°ƒç”¨ï¼Œç”¨æ–°å†…å®¹æ›´æ–°æ–‡ä»¶ã€‚æœ€åï¼Œå…³é—­æ–‡ä»¶ã€‚ ä¸è¯»å–ä¸åŒçš„æ˜¯ï¼Œå‘æ–‡ä»¶å†™å…¥ä¹Ÿå¯èƒ½åˆ†é…ä¸€ä¸ªæ•°æ®å—ï¼ˆé™¤éè¯¥æ•°æ®å—è¢«è¦†ç›–ç­‰ï¼‰ã€‚åœ¨å†™å…¥ä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œæ¯æ¬¡å†™å…¥ä¸ä»…è¦å‘ç£ç›˜å†™å…¥æ•°æ®ï¼Œè¿˜è¦é¦–å…ˆå†³å®šå‘æ–‡ä»¶åˆ†é…å“ªä¸ªå—ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°ç£ç›˜çš„å…¶ä»–ç»“æ„ï¼ˆå¦‚æ•°æ®ä½å›¾å’Œ inodeï¼‰ã€‚å› æ­¤ï¼Œå¯¹æ–‡ä»¶çš„æ¯æ¬¡å†™å…¥åœ¨é€»è¾‘ä¸Šä¼šäº§ç”Ÿ 5 æ¬¡ I/Oï¼š ä¸€æ¬¡è¯»å–æ•°æ®ä½å›¾ï¼ˆç„¶åæ›´æ–°æ•°æ®ä½å›¾ï¼Œå°†æ–°åˆ†é…çš„å—æ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼‰ï¼› ä¸€æ¬¡å†™å…¥æ•°æ®ä½å›¾ï¼ˆå°†å…¶æ–°çŠ¶æ€åæ˜ åˆ°ç£ç›˜ä¸Šï¼‰ï¼› ä¸¤æ¬¡è¯»å–å¹¶å†™å…¥ inodeï¼ˆæ ¹æ®æ–°å—çš„ä½ç½®æ›´æ–° inodeï¼‰ï¼› æœ€åä¸€æ¬¡å†™å…¥å®é™…å—æœ¬èº«ã€‚ å¦‚æœè€ƒè™‘åˆ°åˆ›å»ºæ–‡ä»¶è¿™ç§ç®€å•è€Œå¸¸è§çš„æ“ä½œï¼Œå†™å…¥æµé‡ç”šè‡³ä¼šæ›´å¤§ã€‚è¦åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸ä»…è¦åˆ†é…ä¸€ä¸ª inodeï¼Œè¿˜è¦åœ¨åŒ…å«æ–°æ–‡ä»¶çš„ç›®å½•ä¸­åˆ†é…ç©ºé—´ã€‚è¿™æ ·åšçš„ I/O æ€»æµé‡ç›¸å½“å¤§ï¼š ä¸€æ¬¡è¯»å– inode ä½å›¾ï¼ˆæŸ¥æ‰¾ç©ºé—²çš„ inodeï¼‰ï¼› ä¸€æ¬¡å†™å…¥ inode ä½å›¾ï¼ˆæ ‡è®°å·²åˆ†é…ï¼‰ï¼› ä¸€æ¬¡å†™å…¥æ–° inode æœ¬èº«ï¼ˆåˆå§‹åŒ–ï¼‰ï¼› ä¸€æ¬¡å†™å…¥ç›®å½•æ•°æ®ï¼ˆå°†æ–‡ä»¶çš„é«˜çº§åç§°ä¸å…¶ inode numberè”ç³»èµ·æ¥ï¼‰ï¼› ä»¥åŠä¸€æ¬¡è¯»å–å’Œå†™å…¥ç›®å½• inode ä»¥æ›´æ–°å®ƒã€‚ å¦‚æœç›®å½•éœ€è¦å¢é•¿ä»¥å®¹çº³æ–°çš„æ¡ç›®ï¼Œè¿˜éœ€è¦é¢å¤–çš„ I/Oï¼ˆå³æ•°æ®ä½å›¾å’Œæ–°ç›®å½•å—ï¼‰ã€‚æ‰€æœ‰è¿™äº›éƒ½åªæ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå…·ä½“çš„ç¤ºä¾‹ï¼Œå…¶ä¸­åˆ›å»ºäº†æ–‡ä»¶ /foo/barï¼Œå¹¶å‘å…¶ä¸­å†™å…¥äº†ä¸‰ä¸ªå—ã€‚ä¸‹å›¾æ˜¾ç¤ºäº† open()ï¼ˆåˆ›å»ºæ–‡ä»¶ï¼‰æœŸé—´ä»¥åŠä¸‰ä¸ª 4KB å†™å…¥çš„æ¯ä¸€ä¸ªæœŸé—´å‘ç”Ÿçš„æƒ…å†µã€‚ åœ¨å›¾ä¸­ï¼Œå¯¹ç£ç›˜çš„è¯»å–å’Œå†™å…¥æŒ‰ç…§å¼•èµ·å®ƒä»¬å‘ç”Ÿçš„ç³»ç»Ÿè°ƒç”¨è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ä¸”å®ƒä»¬å¯èƒ½å‘ç”Ÿçš„ç²—ç•¥é¡ºåºä»å›¾çš„é¡¶éƒ¨åˆ°åº•éƒ¨ã€‚æ‚¨å¯ä»¥çœ‹åˆ°åˆ›å»ºæ–‡ä»¶çš„å·¥ä½œé‡ï¼šåœ¨æœ¬ä¾‹ä¸­éœ€è¦ 10 ä¸ª I/Oï¼Œéå†è·¯å¾„åï¼Œç„¶åæœ€ç»ˆåˆ›å»ºæ–‡ä»¶ã€‚æ‚¨è¿˜å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡åˆ†é…å†™å…¥éƒ½ä¼šèŠ±è´¹ 5 ä¸ª I/Oï¼šä¸€å¯¹è¯»å–å’Œæ›´æ–° inodeï¼Œå¦ä¸€å¯¹è¯»å–å’Œæ›´æ–°æ•°æ®ä½å›¾ï¼Œæœ€åå†™å…¥æ•°æ®æœ¬èº«ã€‚ æ–‡ä»¶ç³»ç»Ÿå¦‚ä½•ä»¥åˆç†çš„æ•ˆç‡å®Œæˆè¿™äº›ä»»åŠ¡ï¼Ÿå³ä½¿æ˜¯æœ€ç®€å•çš„æ“ä½œï¼Œå¦‚æ‰“å¼€ã€è¯»å–æˆ–å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿä¼šäº§ç”Ÿå¤§é‡åˆ†æ•£åœ¨ç£ç›˜ä¸Šçš„ I/O æ“ä½œã€‚æ–‡ä»¶ç³»ç»Ÿå¦‚ä½•æ‰èƒ½é™ä½è¿™ä¹ˆå¤š I/O æ“ä½œå¸¦æ¥çš„é«˜æ˜‚æˆæœ¬å‘¢ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:6:2","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 ç¼“å­˜å’Œç¼“å†² æ­£å¦‚ä¸Šé¢çš„ä¾‹å­æ‰€ç¤ºï¼Œè¯»å†™æ–‡ä»¶çš„æˆæœ¬å¾ˆé«˜ï¼Œéœ€è¦å¯¹ï¼ˆæ…¢é€Ÿï¼‰ç£ç›˜è¿›è¡Œå¤šæ¬¡ I/Oã€‚å¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿéƒ½ä¼šç§¯æä½¿ç”¨ç³»ç»Ÿå†…å­˜ï¼ˆDRAMï¼‰æ¥ç¼“å­˜é‡è¦çš„æ•°æ®å—ï¼Œä»¥è§£å†³æ˜æ˜¾å­˜åœ¨çš„å·¨å¤§æ€§èƒ½é—®é¢˜ã€‚ æƒ³è±¡ä¸€ä¸‹ä¸Šé¢çš„æ‰“å¼€ç¤ºä¾‹ï¼šå¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œæ¯æ¬¡æ‰“å¼€æ–‡ä»¶éƒ½éœ€è¦å¯¹ç›®å½•å±‚æ¬¡ç»“æ„ä¸­çš„æ¯ä¸€çº§è¿›è¡Œè‡³å°‘ä¸¤æ¬¡è¯»å–ï¼ˆä¸€æ¬¡è¯»å–ç›¸å…³ç›®å½•çš„ inodeï¼Œè‡³å°‘ä¸€æ¬¡è¯»å–å…¶æ•°æ®ï¼‰ã€‚å¯¹äºé•¿è·¯å¾„åï¼ˆä¾‹å¦‚ï¼Œ/1/2/3/.../100/file.txtï¼‰ï¼Œæ–‡ä»¶ç³»ç»Ÿå…‰æ˜¯æ‰“å¼€æ–‡ä»¶å°±éœ€è¦æ‰§è¡Œæ•°ç™¾æ¬¡è¯»å–ï¼ å› æ­¤ï¼Œæ—©æœŸçš„æ–‡ä»¶ç³»ç»Ÿå¼•å…¥äº†å›ºå®šå¤§å°çš„ç¼“å­˜æ¥ä¿å­˜å¸¸ç”¨æ•°æ®å—ã€‚å°±åƒæˆ‘ä»¬åœ¨è®¨è®ºè™šæ‹Ÿå†…å­˜æ—¶ä¸€æ ·ï¼ŒLRU ç­‰ç­–ç•¥å’Œä¸åŒçš„å˜ä½“å°†å†³å®šåœ¨ç¼“å­˜ä¸­ä¿ç•™å“ªäº›åŒºå—ã€‚è¿™ç§å›ºå®šå¤§å°çš„ç¼“å­˜é€šå¸¸åœ¨å¯åŠ¨æ—¶åˆ†é…ï¼Œå¤§çº¦å æ€»å†…å­˜çš„ 10%ã€‚ ç„¶è€Œï¼Œè¿™ç§é™æ€çš„å†…å­˜åˆ†åŒºå¯èƒ½ä¼šé€ æˆæµªè´¹ï¼›å¦‚æœæ–‡ä»¶ç³»ç»Ÿåœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸éœ€è¦ 10%çš„å†…å­˜æ€ä¹ˆåŠï¼Ÿå¦‚æœé‡‡ç”¨ä¸Šè¿°å›ºå®šå¤§å°çš„æ–¹æ³•ï¼Œæ–‡ä»¶ç¼“å­˜ä¸­æœªä½¿ç”¨çš„é¡µé¢å°±æ— æ³•é‡æ–°ç”¨äºå…¶ä»–ç”¨é€”ï¼Œä»è€Œé€ æˆæµªè´¹ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œç°ä»£ç³»ç»Ÿé‡‡ç”¨çš„æ˜¯åŠ¨æ€åˆ†åŒºæ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œè®¸å¤šç°ä»£æ“ä½œç³»ç»Ÿå°†è™šæ‹Ÿå†…å­˜é¡µå’Œæ–‡ä»¶ç³»ç»Ÿé¡µæ•´åˆåˆ°ç»Ÿä¸€çš„é¡µé¢ç¼“å­˜ä¸­ã€‚è¿™æ ·ï¼Œå†…å­˜å°±å¯ä»¥æ›´çµæ´»åœ°åˆ†é…ç»™è™šæ‹Ÿå†…å­˜å’Œæ–‡ä»¶ç³»ç»Ÿï¼Œå…·ä½“å–å†³äºå“ªä¸ªç³»ç»Ÿåœ¨ç‰¹å®šæ—¶é—´éœ€è¦æ›´å¤šå†…å­˜ã€‚ äº†è§£é™æ€ä¸é™æ€åŠ¨æ€åˆ†åŒº åœ¨ä¸åŒçš„å®¢æˆ·ç«¯/ç”¨æˆ·ä¹‹é—´åˆ’åˆ†èµ„æºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨é™æ€åˆ†åŒºæˆ–åŠ¨æ€åˆ†åŒºã€‚é™æ€æ–¹æ³•åªæ˜¯å°†èµ„æºä¸€æ¬¡åˆ’åˆ†ä¸ºå›ºå®šæ¯”ä¾‹ï¼›ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªå¯èƒ½çš„å†…å­˜ç”¨æˆ·ï¼Œæ‚¨å¯ä»¥å°†ä¸€äº›å›ºå®šéƒ¨åˆ†çš„å†…å­˜åˆ†é…ç»™ä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶å°†å…¶ä½™éƒ¨åˆ†åˆ†é…ç»™å¦ä¸€ä¸ªç”¨æˆ·ã€‚åŠ¨æ€æ–¹æ³•æ›´åŠ çµæ´»ï¼Œéšç€æ—¶é—´çš„æ¨ç§»æä¾›ä¸åŒæ•°é‡çš„èµ„æºï¼›ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·å¯èƒ½åœ¨ä¸€æ®µæ—¶é—´å†…è·å¾—è¾ƒé«˜ç™¾åˆ†æ¯”çš„ç£ç›˜å¸¦å®½ï¼Œä½†éšåï¼Œç³»ç»Ÿå¯èƒ½ä¼šåˆ‡æ¢å¹¶å†³å®šä¸ºä¸åŒçš„ç”¨æˆ·æä¾›æ›´å¤§æ¯”ä¾‹çš„å¯ç”¨ç£ç›˜å¸¦å®½ã€‚ æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹ã€‚é™æ€åˆ†åŒºå¯ç¡®ä¿æ¯ä¸ªç”¨æˆ·è·å¾—ä¸€å®šçš„èµ„æºä»½é¢ï¼Œé€šå¸¸å¯ä»¥æä¾›æ›´å¯é¢„æµ‹çš„æ€§èƒ½ï¼Œå¹¶ä¸”é€šå¸¸æ›´å®¹æ˜“å®ç°ã€‚åŠ¨æ€åˆ†åŒºå¯ä»¥å®ç°æ›´å¥½çš„åˆ©ç”¨ç‡ï¼ˆé€šè¿‡è®©èµ„æºåŒ®ä¹çš„ç”¨æˆ·æ¶ˆè€—åŸæœ¬ç©ºé—²çš„èµ„æºï¼‰ï¼Œä½†å®ç°èµ·æ¥å¯èƒ½æ›´å¤æ‚ï¼Œå¹¶ä¸”å¦‚æœç”¨æˆ·çš„é—²ç½®èµ„æºè¢«å…¶ä»–ç”¨æˆ·å ç”¨ï¼Œåœ¨éœ€è¦æ—¶éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½æ”¶å›ï¼Œåˆ™ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæ²¡æœ‰æœ€å¥½çš„æ–¹æ³•ï¼›ç›¸åï¼Œä½ åº”è¯¥æ€è€ƒæ‰‹å¤´çš„é—®é¢˜ï¼Œç„¶åå†³å®šå“ªç§æ–¹æ³•æœ€åˆé€‚ã€‚ ç°åœ¨æƒ³è±¡ä¸€ä¸‹å¸¦ç¼“å­˜çš„æ–‡ä»¶æ‰“å¼€ç¤ºä¾‹ã€‚ç¬¬ä¸€æ¬¡æ‰“å¼€å¯èƒ½ä¼šäº§ç”Ÿå¤§é‡çš„ I/O æµé‡æ¥è¯»å–ç›®å½• inode å’Œæ•°æ®ï¼Œä½†åŒä¸€æ–‡ä»¶ï¼ˆæˆ–åŒä¸€ç›®å½•ä¸­çš„æ–‡ä»¶ï¼‰çš„åç»­æ–‡ä»¶æ‰“å¼€å¤§éƒ¨åˆ†ä¼šåœ¨ç¼“å­˜ä¸­è¿›è¡Œï¼Œå› æ­¤ä¸éœ€è¦ I/Oã€‚ æˆ‘ä»¬è¿˜è¦è€ƒè™‘ç¼“å­˜å¯¹å†™å…¥çš„å½±å“ã€‚å¦‚æœç¼“å­˜è¶³å¤Ÿå¤§ï¼Œå°±å¯ä»¥å®Œå…¨é¿å…è¯»å– I/Oï¼Œè€Œå†™å…¥æµé‡å¿…é¡»è¿›å…¥ç£ç›˜æ‰èƒ½æŒä¹…åŒ–ã€‚å› æ­¤ï¼Œç¼“å­˜å¯¹å†™å…¥æµé‡çš„è¿‡æ»¤å™¨ä¸å¯¹è¯»å–æµé‡çš„è¿‡æ»¤å™¨ä¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå†™ç¼“å†²ç¡®å®å…·æœ‰è®¸å¤šæ€§èƒ½ä¼˜åŠ¿ã€‚ é¦–å…ˆï¼Œé€šè¿‡å»¶è¿Ÿå†™å…¥ï¼Œæ–‡ä»¶ç³»ç»Ÿå¯ä»¥å°†ä¸€äº›æ›´æ–°æ‰¹å¤„ç†åˆ°è¾ƒå°çš„ä¸€ç»„ I/O ä¸­ï¼›ä¾‹å¦‚ï¼Œå¦‚æœåœ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ—¶æ›´æ–°inodeä½å›¾ï¼Œç„¶ååœ¨åˆ›å»ºå¦ä¸€ä¸ªæ–‡ä»¶æ—¶æ›´æ–°inodeä½å›¾ï¼Œåˆ™æ–‡ä»¶ç³»ç»Ÿä¼šé€šè¿‡åœ¨ç¬¬ä¸€æ¬¡æ›´æ–°åå»¶è¿Ÿå†™å…¥æ¥èŠ‚çœ I/Oã€‚ å…¶æ¬¡ï¼Œé€šè¿‡åœ¨å†…å­˜ä¸­ç¼“å†²å¤§é‡å†™å…¥ï¼Œç³»ç»Ÿå¯ä»¥è°ƒåº¦åç»­ I/Oï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚ æœ€åï¼Œæœ‰äº›å†™å…¥å¯ä»¥é€šè¿‡å»¶è¿Ÿæ¥å®Œå…¨é¿å…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºåˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶ç„¶åå°†å…¶åˆ é™¤ï¼Œåˆ™å»¶è¿Ÿå†™å…¥ä»¥å°†æ–‡ä»¶åˆ›å»ºåæ˜ åˆ°ç£ç›˜å¯ä»¥å®Œå…¨é¿å…å®ƒä»¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‡’æƒ°ï¼ˆå°†å—å†™å…¥ç£ç›˜ï¼‰æ˜¯ä¸€ç§ç¾å¾·ã€‚ åŸºäºä¸Šè¿°åŸå› ï¼Œå¤§å¤šæ•°ç°ä»£æ–‡ä»¶ç³»ç»Ÿéƒ½ä¼šåœ¨å†…å­˜ä¸­ç¼“å†²å†™å…¥ 5 åˆ° 30 ç§’ï¼Œè¿™ä¹Ÿæ˜¯å¦ä¸€ç§æƒè¡¡ï¼šå¦‚æœç³»ç»Ÿåœ¨æ›´æ–°ä¼ æ’­åˆ°ç£ç›˜ä¹‹å‰å´©æºƒï¼Œæ›´æ–°å°±ä¼šä¸¢å¤±ï¼›ä½†æ˜¯ï¼Œå¦‚æœåœ¨å†…å­˜ä¸­ä¿ç•™æ›´é•¿æ—¶é—´ï¼Œå°±å¯ä»¥é€šè¿‡æ‰¹å¤„ç†ã€è°ƒåº¦ç”šè‡³é¿å…å†™å…¥æ¥æé«˜æ€§èƒ½ã€‚ äº†è§£æŒä¹…/æ€§èƒ½çš„æƒè¡¡ å­˜å‚¨ç³»ç»Ÿé€šå¸¸ä¼šå‘ç”¨æˆ·æä¾›æŒä¹…/æ€§èƒ½çš„æƒè¡¡ã€‚å¦‚æœç”¨æˆ·å¸Œæœ›å†™å…¥çš„æ•°æ®ç«‹å³æŒä¹…ï¼Œç³»ç»Ÿå¿…é¡»å…¨åŠ›å°†æ–°å†™å…¥çš„æ•°æ®æäº¤åˆ°ç£ç›˜ï¼Œå› æ­¤å†™å…¥é€Ÿåº¦å¾ˆæ…¢ï¼ˆä½†å®‰å…¨ï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœç”¨æˆ·å¯ä»¥å®¹å¿å°‘é‡æ•°æ®çš„ä¸¢å¤±ï¼Œç³»ç»Ÿå¯ä»¥åœ¨å†…å­˜ä¸­ç¼“å†²å†™å…¥ä¸€æ®µæ—¶é—´ï¼Œç„¶åå°†å…¶å†™å…¥ç£ç›˜ï¼ˆåœ¨åå°ï¼‰ã€‚è¿™æ ·åšä¼šä½¿å†™å…¥çœ‹èµ·æ¥å¾ˆå¿«å®Œæˆï¼Œä»è€Œæé«˜æ„ŸçŸ¥æ€§èƒ½ï¼›ä½†æ˜¯ï¼Œå¦‚æœå‘ç”Ÿå´©æºƒï¼Œå°šæœªæäº¤åˆ°ç£ç›˜çš„å†™å…¥å°†ä¼šä¸¢å¤±ï¼Œå› æ­¤éœ€è¦è¿›è¡Œæƒè¡¡ã€‚è¦äº†è§£å¦‚ä½•æ­£ç¡®è¿›è¡Œè¿™ç§æƒè¡¡ï¼Œæœ€å¥½äº†è§£ä½¿ç”¨å­˜å‚¨ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºéœ€è¦ä»€ä¹ˆï¼›ä¾‹å¦‚ï¼Œè™½ç„¶ä¸¢å¤±ç½‘ç»œæµè§ˆå™¨ä¸‹è½½çš„æœ€åå‡ å¼ å›¾åƒå¯èƒ½æ˜¯å¯ä»¥å®¹å¿çš„ï¼Œä½†ä¸¢å¤±å‘æ‚¨çš„é“¶è¡Œå¸æˆ·æ·»åŠ èµ„é‡‘çš„æ•°æ®åº“äº‹åŠ¡çš„ä¸€éƒ¨åˆ†å¯èƒ½ä¼šæ›´éš¾ä»¥å®¹å¿ã€‚ æœ‰äº›åº”ç”¨ç¨‹åºï¼ˆå¦‚æ•°æ®åº“ï¼‰å¹¶ä¸å–œæ¬¢è¿™ç§æƒè¡¡ã€‚å› æ­¤ï¼Œä¸ºäº†é¿å…å› å†™å…¥ç¼“å†²è€Œé€ æˆæ„å¤–æ•°æ®ä¸¢å¤±ï¼Œå®ƒä»¬åªéœ€é€šè¿‡è°ƒç”¨fsync()ã€ä½¿ç”¨ç»•è¿‡ç¼“å­˜çš„ç›´æ¥ I/O æ¥å£æˆ–ä½¿ç”¨åŸå§‹ç£ç›˜æ¥å£æ¥å¼ºåˆ¶å†™å…¥ç£ç›˜ï¼Œä»è€Œå®Œå…¨é¿å¼€æ–‡ä»¶ç³»ç»Ÿã€‚è™½ç„¶å¤§å¤šæ•°åº”ç”¨ç¨‹åºéƒ½èƒ½æ¥å—æ–‡ä»¶ç³»ç»Ÿçš„å–èˆï¼Œä½†å¦‚æœé»˜è®¤æƒ…å†µä¸èƒ½ä»¤äººæ»¡æ„ï¼Œä¹Ÿæœ‰è¶³å¤Ÿçš„æ§åˆ¶æªæ–½è®©ç³»ç»ŸæŒ‰ç…§ä½ çš„æ„æ„¿è¡Œäº‹ã€‚ ","date":"2024-05-11","objectID":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/:7:0","tags":["OS"],"title":"æ–‡ä»¶ç³»ç»Ÿå®ç°","uri":"/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 æ–‡ä»¶å’Œç›®å½• éšç€æ—¶é—´çš„æ¨ç§»ï¼Œåœ¨å­˜å‚¨è™šæ‹ŸåŒ–è¿‡ç¨‹ä¸­å½¢æˆäº†ä¸¤ä¸ªå…³é”®çš„æŠ½è±¡æ¦‚å¿µã€‚ç¬¬ä¸€ä¸ªæ˜¯æ–‡ä»¶ã€‚æ–‡ä»¶åªæ˜¯ä¸€ä¸ªç”±å­—èŠ‚ç»„æˆçš„çº¿æ€§æ•°ç»„ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½å¯ä»¥è¯»å†™ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰æŸç§åº•å±‚åç§°ï¼Œé€šå¸¸æ˜¯æŸä¸ªæ•°å­—ï¼›é€šå¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¹¶ä¸çŸ¥é“è¿™ä¸ªåç§°ï¼ˆæˆ‘ä»¬å°†çœ‹åˆ°ï¼‰ã€‚ç”±äºå†å²åŸå› ï¼Œæ–‡ä»¶çš„åº•å±‚åç§°é€šå¸¸è¢«ç§°ä¸ºå…¶inode numberï¼ˆç´¢å¼•èŠ‚ç‚¹å·ï¼‰ã€‚ åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸äº†è§£æ–‡ä»¶çš„ç»“æ„ï¼ˆä¾‹å¦‚ï¼Œå®ƒæ˜¯å›¾ç‰‡ã€æ–‡æœ¬æ–‡ä»¶è¿˜æ˜¯ C ä»£ç ï¼‰ï¼›ç›¸åï¼Œæ–‡ä»¶ç³»ç»Ÿçš„èŒè´£ä»…ä»…æ˜¯å°†è¿™äº›æ•°æ®æŒä¹…åœ°å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå¹¶ç¡®ä¿å½“ä½ å†æ¬¡è¯·æ±‚æ•°æ®æ—¶ï¼Œä½ èƒ½å¾—åˆ°å½“åˆæ”¾åœ¨é‚£é‡Œçš„æ•°æ®ã€‚åšåˆ°è¿™ä¸€ç‚¹å¹¶ä¸åƒçœ‹èµ·æ¥é‚£ä¹ˆç®€å•ï¼ ç¬¬äºŒä¸ªæŠ½è±¡æ¦‚å¿µæ˜¯ç›®å½•ã€‚ç›®å½•å’Œæ–‡ä»¶ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸€ä¸ªåº•å±‚åç§°ï¼ˆå³inode numberï¼‰ï¼Œä½†å…¶å†…å®¹å´éå¸¸å…·ä½“ï¼šå®ƒåŒ…å«ä¸€ä¸ªï¼ˆç”¨æˆ·å¯è¯»åç§°ã€åº•å±‚åç§°ï¼‰å¯¹åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåº•å±‚åç§°ä¸º â€œ10 â€œçš„æ–‡ä»¶ï¼Œç”¨æˆ·å¯è¯»æ–‡ä»¶åä¸º â€œfooâ€ã€‚å› æ­¤ï¼Œâ€œfoo â€œæ‰€åœ¨çš„ç›®å½•å°±ä¼šæœ‰ä¸€ä¸ªæ¡ç›®ï¼ˆâ€œfooâ€, â€œ10â€ï¼‰ï¼Œå°†ç”¨æˆ·å¯è¯»åç§°æ˜ å°„åˆ°åº•å±‚åç§°ã€‚ç›®å½•ä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½æŒ‡å‘æ–‡ä»¶æˆ–å…¶ä»–ç›®å½•ã€‚é€šè¿‡å°†ç›®å½•æ”¾ç½®åœ¨å…¶ä»–ç›®å½•ä¸­ï¼Œç”¨æˆ·å¯ä»¥å»ºç«‹ä¸€ä¸ªä»»æ„çš„ç›®å½•æ ‘ï¼ˆæˆ–ç›®å½•å±‚æ¬¡ç»“æ„ï¼‰ï¼Œæ‰€æœ‰æ–‡ä»¶å’Œç›®å½•éƒ½å­˜å‚¨åœ¨è¯¥ç›®å½•ä¸‹ã€‚ ç›®å½•å±‚æ¬¡ç»“æ„ä»æ ¹ç›®å½•å¼€å§‹ï¼ˆåœ¨åŸºäº UNIX çš„ç³»ç»Ÿä¸­ï¼Œæ ¹ç›®å½•ç®€ç§°ä¸º /ï¼‰ï¼Œå¹¶ä½¿ç”¨æŸç§åˆ†éš”ç¬¦æ¥å‘½åéšåçš„å­ç›®å½•ï¼Œç›´åˆ°æ‰€éœ€çš„æ–‡ä»¶æˆ–ç›®å½•è¢«å‘½åä¸ºæ­¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·åœ¨æ ¹ç›®å½•/ä¸­åˆ›å»ºäº†ä¸€ä¸ªç›®å½• fooï¼Œç„¶ååœ¨ç›®å½• foo ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶ bar.txtï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶ç»å¯¹è·¯å¾„åæ¥å¼•ç”¨è¯¥æ–‡ä»¶ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º /foo/bar.txt ã€‚æ›´å¤æ‚çš„ç›®å½•æ ‘å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ç¤ºä¾‹ä¸­çš„æœ‰æ•ˆç›®å½•ä¸º /ã€/fooã€/barã€/bar/barã€/bar/fooï¼Œæœ‰æ•ˆæ–‡ä»¶ä¸º /foo/bar.txt å’Œ /bar/foo/bar.txtã€‚ç›®å½•å’Œæ–‡ä»¶å¯ä»¥å…·æœ‰ç›¸åŒçš„åç§°ï¼Œåªè¦å®ƒä»¬ä½äºæ–‡ä»¶ç³»ç»Ÿæ ‘ä¸­çš„ä¸åŒä½ç½®å³å¯ï¼ˆä¾‹å¦‚ï¼Œå›¾ä¸­æœ‰ä¸¤ä¸ªåä¸º bar.txt çš„æ–‡ä»¶ï¼Œ/foo/bar.txt å’Œ /bar/foo/bar.txtï¼‰ã€‚ æ‚¨å¯èƒ½è¿˜æ³¨æ„åˆ°ï¼Œæ­¤ç¤ºä¾‹ä¸­çš„æ–‡ä»¶åé€šå¸¸ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šbar å’Œ txtï¼Œä»¥.åˆ†éš”ã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä»»æ„åç§°ï¼ˆæè¿°æ–‡ä»¶ï¼‰ï¼Œè€Œæ–‡ä»¶åçš„ç¬¬äºŒéƒ¨åˆ†é€šå¸¸ç”¨äºæŒ‡ç¤ºæ–‡ä»¶çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼Œå®ƒæ˜¯ C ä»£ç ï¼ˆä¾‹å¦‚.cï¼‰è¿˜æ˜¯å›¾åƒï¼ˆä¾‹å¦‚ .jpgï¼‰ ï¼Œæˆ–éŸ³ä¹æ–‡ä»¶ï¼ˆä¾‹å¦‚.mp3ï¼‰ã€‚ç„¶è€Œï¼Œè¿™é€šå¸¸åªæ˜¯ä¸€ä¸ªçº¦å®šï¼šé€šå¸¸æ²¡æœ‰å¼ºåˆ¶è§„å®šåä¸º main.c çš„æ–‡ä»¶ä¸­åŒ…å«çš„æ•°æ®ç¡®å®æ˜¯ C æºä»£ç ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–‡ä»¶ç³»ç»Ÿæä¾›çš„ä¸€ä»¶ä¼Ÿå¤§çš„äº‹æƒ…ï¼šä¸€ç§å‘½åæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ‰€æœ‰æ–‡ä»¶çš„ä¾¿æ·æ–¹æ³•ã€‚åç§°åœ¨ç³»ç»Ÿä¸­å¾ˆé‡è¦ï¼Œå› ä¸ºè®¿é—®ä»»ä½•èµ„æºçš„ç¬¬ä¸€æ­¥å°±æ˜¯èƒ½å¤Ÿå‘½åå®ƒã€‚å› æ­¤ï¼Œåœ¨ UNIX ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥è®¿é—®ç£ç›˜ã€Uç›˜ã€CD-ROMã€è®¸å¤šå…¶ä»–è®¾å¤‡ä»¥åŠäº‹å®ä¸Šè¿˜æœ‰è®¸å¤šå…¶ä»–ä¸œè¥¿ï¼Œå®ƒä»¬éƒ½ä½äºåŒä¸€ä¸ªç›®å½•æ ‘ä¸‹ã€‚ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:1:0","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æ–‡ä»¶ç³»ç»Ÿæ¥å£ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:2:0","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 æ–‡ä»¶æ“ä½œ 2.1.1 åˆ›å»ºæ–‡ä»¶ æˆ‘ä»¬å°†ä»æœ€åŸºæœ¬çš„æ“ä½œå¼€å§‹ï¼šåˆ›å»ºæ–‡ä»¶ã€‚è¿™å¯ä»¥é€šè¿‡ open ç³»ç»Ÿè°ƒç”¨æ¥å®ç°ï¼›è°ƒç”¨ open() å¹¶ä¼ é€’ O_CREAT æ ‡å¿—ï¼Œç¨‹åºå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚ä¸‹é¢æ˜¯ä¸€äº›ç¤ºä¾‹ä»£ç ï¼Œç”¨äºåœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º â€œfoo â€œçš„æ–‡ä»¶ã€‚ int fd = open(\"foo\", O_CREAT|O_WRONLY|O_TRUNC, S_IRUSR|S_IWUSR); ä¾‹ç¨‹open() ä½¿ç”¨å¤šä¸ªä¸åŒçš„æ ‡å¿—ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼šåˆ›å»ºæ–‡ä»¶ï¼ˆO_CREATï¼‰ï¼Œç¡®ä¿è¯¥æ–‡ä»¶åªèƒ½è¢«å†™å…¥ï¼ˆO_WRONLYï¼‰ï¼Œå¹¶ä¸”å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™å°†å…¶æˆªæ–­ä¸º 0 å­—èŠ‚å¤§å°ï¼Œä»è€Œåˆ é™¤ä»»ä½•ç°æœ‰å†…å®¹ï¼ˆO_TRUNCï¼‰ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šæƒé™ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–‡ä»¶æ‰€æœ‰è€…å¯ä»¥è¯»å†™æ–‡ä»¶ã€‚ open() çš„ä¸€ä¸ªé‡è¦æ–¹é¢æ˜¯å®ƒçš„è¿”å›å€¼ï¼šæ–‡ä»¶æè¿°ç¬¦ã€‚æ–‡ä»¶æè¿°ç¬¦åªæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æ˜¯ç§æœ‰çš„ï¼Œåœ¨ UNIX ç³»ç»Ÿä¸­ç”¨äºè®¿é—®æ–‡ä»¶ï¼›å› æ­¤ï¼Œä¸€æ—¦æ–‡ä»¶è¢«æ‰“å¼€ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥è¯»å–æˆ–å†™å…¥æ–‡ä»¶ï¼Œå‰ææ˜¯ä½ æœ‰è¿™æ ·åšçš„æƒé™ã€‚å› æ­¤ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ç§èƒ½åŠ›ï¼Œå³ä¸€ä¸ªä¸é€æ˜çš„å¥æŸ„ï¼Œå®ƒèµ‹äºˆä½ æ‰§è¡ŒæŸäº›æ“ä½œçš„æƒåŠ›ã€‚å¦ä¸€ç§å°†æ–‡ä»¶æè¿°ç¬¦è§†ä¸ºæŒ‡å‘æ–‡ä»¶ç±»å‹å¯¹è±¡çš„æŒ‡é’ˆçš„æ–¹æ³•æ˜¯ï¼šä¸€æ—¦ä½ æœ‰äº†è¿™æ ·ä¸€ä¸ªå¯¹è±¡ï¼Œä½ å°±å¯ä»¥è°ƒç”¨å…¶ä»– â€œæ–¹æ³• â€œæ¥è®¿é—®æ–‡ä»¶ï¼Œå¦‚read()å’Œ write()ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œæ–‡ä»¶æè¿°ç¬¦ç”±æ“ä½œç³»ç»ŸæŒ‰è¿›ç¨‹è¿›è¡Œç®¡ç†ã€‚è¿™æ„å‘³ç€åœ¨ UNIX ç³»ç»Ÿçš„ proc ç»“æ„ä¸­ä¿å­˜äº†æŸç§ç®€å•çš„ç»“æ„ï¼ˆå¦‚æ•°ç»„ï¼‰ã€‚ä¸‹é¢æ˜¯ xv6 å†…æ ¸ä¸­çš„ç›¸å…³å†…å®¹ï¼š struct proc { ... struct file *ofile[NOFILE]; // Open files ... }; ä¸€ä¸ªç®€å•æ•°ç»„ï¼ˆæœ€å¤šåŒ…å« NOFILE æ‰“å¼€çš„æ–‡ä»¶ï¼‰å¯ä»¥è·Ÿè¸ªæ¯ä¸ªè¿›ç¨‹æ‰“å¼€äº†å“ªäº›æ–‡ä»¶ã€‚æ•°ç»„çš„æ¯ä¸ªæ¡ç›®å®é™…ä¸Šåªæ˜¯ä¸€ä¸ªæŒ‡å‘struct fileçš„æŒ‡é’ˆï¼Œå®ƒå°†ç”¨äºè·Ÿè¸ªæ­£åœ¨è¯»å–æˆ–å†™å…¥çš„æ–‡ä»¶ä¿¡æ¯ã€‚ 2.1.2 è¯»å†™æ–‡ä»¶ 2.1.2.1 é¡ºåºè¯»å†™ æœ‰äº†ä¸€äº›æ–‡ä»¶åï¼Œæˆ‘ä»¬å½“ç„¶ä¼šæƒ³è¯»å–æˆ–å†™å…¥å®ƒä»¬ï¼Œè®©æˆ‘ä»¬ä»è¯»å–ä¸€ä¸ªç°æœ‰æ–‡ä»¶å¼€å§‹ã€‚å¦‚æœæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼Œæˆ‘ä»¬å¯èƒ½åªä½¿ç”¨ç¨‹åº cat å°†æ–‡ä»¶çš„å†…å®¹è½¬å‚¨åˆ°å±å¹•ä¸Šã€‚ \u003e echo 'Hello, World' \u003e foo \u003e cat foo Hello, World åœ¨æ­¤ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬å°†ç¨‹åº echo çš„è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ fooï¼Œç„¶åè¯¥æ–‡ä»¶ä¸­åŒ…å«å†…å®¹â€œHello, Worldâ€ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ cat æ¥æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ã€‚ä½†æ˜¯catç¨‹åºå¦‚ä½•è®¿é—®æ–‡ä»¶fooå‘¢ï¼Ÿ ä¸ºäº†æ‰¾åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·æ¥è·Ÿè¸ªç¨‹åºè¿›è¡Œçš„ç³»ç»Ÿè°ƒç”¨ã€‚åœ¨ Linux ä¸Šï¼Œè¯¥å·¥å…·ç§°ä¸º straceï¼›å…¶ä»–ç³»ç»Ÿä¹Ÿæœ‰ç±»ä¼¼çš„å·¥å…·ï¼ˆè¯·å‚é˜… Mac ä¸Šçš„ dtrussï¼Œæˆ–æŸäº›è¾ƒæ—§çš„ UNIX å˜ä½“ä¸Šçš„ trussï¼‰ã€‚ strace çš„ä½œç”¨æ˜¯è·Ÿè¸ªç¨‹åºè¿è¡Œæ—¶æ‰€åšçš„æ¯ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶å°†è·Ÿè¸ªè½¬å‚¨åˆ°å±å¹•ä¸Šä¾›æ‚¨æŸ¥çœ‹ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ strace æ¥ç¡®å®š cat æ­£åœ¨åšä»€ä¹ˆçš„ç¤ºä¾‹ï¼ˆä¸ºäº†ä¾¿äºé˜…è¯»ï¼Œåˆ é™¤äº†ä¸€äº›è°ƒç”¨ï¼‰ï¼š \u003e strace cat foo ... openat(AT_FDCWD, \"foo\", O_RDONLY|O_LARGEFILE) = 3 ... read(3, \"Hello, World\\n\", 131072) = 13 write(1, \"Hello, World\\n\", 13) = 13 Hello, World read(3, \"\", 131072) = 0 close(3) = 0 ... +++ exited with 0 +++ cat åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¯»å–ã€‚æˆ‘ä»¬åº”è¯¥æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š é¦–å…ˆï¼Œè¯¥æ–‡ä»¶ä»…æ‰“å¼€ç”¨äºè¯»å–ï¼ˆè€Œä¸æ˜¯å†™å…¥ï¼‰ï¼Œå¦‚ O_RDONLY æ ‡å¿—æ‰€ç¤ºï¼› å…¶æ¬¡ï¼Œä½¿ç”¨ 64 ä½åç§»é‡ (O_LARGEFILE)ï¼› ç¬¬ä¸‰ï¼Œå¯¹ openat()ï¼ˆå’Œoepn()ä¸€æ ·ï¼‰çš„è°ƒç”¨æˆåŠŸå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå…¶å€¼ä¸º 3ã€‚ ä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡è°ƒç”¨ openat() è¿”å› 3ï¼Œè€Œä¸æ˜¯æ‚¨å¯èƒ½æœŸæœ›çš„ 0 æˆ– 1ï¼Ÿäº‹å®è¯æ˜ï¼Œæ¯ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å·²ç»æ‰“å¼€äº†ä¸‰ä¸ªæ–‡ä»¶ï¼šæ ‡å‡†è¾“å…¥ï¼ˆè¿›ç¨‹å¯ä»¥è¯»å–ä»¥æ¥æ”¶è¾“å…¥ï¼‰ã€æ ‡å‡†è¾“å‡ºï¼ˆè¿›ç¨‹å¯ä»¥å†™å…¥ä»¥å°†ä¿¡æ¯è½¬å‚¨åˆ°å±å¹•ï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆè¿›ç¨‹å¯ä»¥å‘å…¶å†™å…¥é”™è¯¯æ¶ˆæ¯ï¼‰ã€‚å®ƒä»¬åˆ†åˆ«ç”±æ–‡ä»¶æè¿°ç¬¦ 0ã€1 å’Œ 2 è¡¨ç¤ºã€‚å› æ­¤ï¼Œå½“æ‚¨ç¬¬ä¸€æ¬¡æ‰“å¼€å¦ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ˆå¦‚ä¸Šé¢çš„ cat æ‰€åšçš„é‚£æ ·ï¼‰ï¼Œå®ƒå‡ ä¹è‚¯å®šæ˜¯æ–‡ä»¶æè¿°ç¬¦ 3ã€‚ æ‰“å¼€æˆåŠŸåï¼Œcat ä¼šä½¿ç”¨ read() ç³»ç»Ÿè°ƒç”¨ä»æ–‡ä»¶ä¸­é‡å¤è¯»å–ä¸€äº›å­—èŠ‚ã€‚ read() çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒå‘Šè¯‰æ–‡ä»¶ç³»ç»Ÿè¦è¯»å–å“ªä¸ªæ–‡ä»¶ï¼›å½“ç„¶ï¼Œä¸€ä¸ªè¿›ç¨‹å¯èƒ½åŒæ—¶æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œå› æ­¤æè¿°ç¬¦èƒ½è®©æ“ä½œç³»ç»ŸçŸ¥é“æŸä¸ªç‰¹å®šè¯»å–æŒ‡å‘å“ªä¸ªæ–‡ä»¶ã€‚ ç¬¬äºŒä¸ªå‚æ•°æŒ‡å‘ä¸€ä¸ªç¼“å†²åŒºï¼Œread()çš„ç»“æœå°†æ”¾ç½®åœ¨è¿™ä¸ªç¼“å†²åŒºä¸­ï¼›åœ¨ä¸Šé¢çš„ç³»ç»Ÿè°ƒç”¨è·Ÿè¸ªä¸­ï¼Œstrace åœ¨è¿™ä¸ªä½ç½®ï¼ˆâ€œHello, Worldâ€ï¼‰æ˜¾ç¤ºäº†è¯»å–çš„ç»“æœã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç¼“å†²åŒºçš„å¤§å°ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º 131072 Bã€‚å¯¹ read() çš„è°ƒç”¨ä¹ŸæˆåŠŸè¿”å›ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯è¯»å–çš„å­—èŠ‚æ•°ï¼ˆ13ï¼Œå…¶ä¸­ 12 ä¸ªå­—èŠ‚è¡¨ç¤º â€œHello, World\"ä¸­çš„å­—ç¬¦ï¼Œ1 ä¸ªå­—èŠ‚è¡¨ç¤ºè¡Œç»“æŸæ ‡è®°ï¼‰ã€‚ æ­¤æ—¶ï¼Œä½ ä¼šçœ‹åˆ° strace çš„å¦ä¸€ä¸ªæœ‰è¶£ç»“æœï¼šå¯¹ write() ç³»ç»Ÿè°ƒç”¨çš„ä¸€æ¬¡è°ƒç”¨ï¼Œè°ƒç”¨çš„æ˜¯æ–‡ä»¶æè¿°ç¬¦ 1ã€‚å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œè¿™ä¸ªæè¿°ç¬¦è¢«ç§°ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå› æ­¤å®ƒè¢«ç”¨æ¥å°† â€œHello, World\"è¿™ä¸ªå­—ç¬¦ä¸²å†™åˆ°å±å¹•ä¸Šï¼Œå°±åƒ cat ç¨‹åºè¦åšçš„é‚£æ ·ã€‚ä½†å®ƒä¼šç›´æ¥è°ƒç”¨ write() å—ï¼Ÿä¹Ÿè®¸ä¼šï¼ˆå¦‚æœé«˜åº¦ä¼˜åŒ–çš„è¯ï¼‰ã€‚ä½†å¦‚æœæ²¡æœ‰ï¼Œcatç¨‹åºå¯èƒ½ä¼šè°ƒç”¨åº“ä¾‹ç¨‹ printf()ï¼›printf() ä¼šåœ¨å†…éƒ¨è®¡ç®—å‡ºä¼ ç»™å®ƒçš„æ‰€æœ‰æ ¼å¼ç»†èŠ‚ï¼Œå¹¶æœ€ç»ˆå†™å…¥æ ‡å‡†è¾“å‡ºï¼Œå°†ç»“æœæ‰“å°åˆ°å±å¹•ä¸Šã€‚ ç„¶åï¼Œcat ç¨‹åºå°è¯•ä»æ–‡ä»¶ä¸­è¯»å–æ›´å¤šä¿¡æ¯ï¼Œä½†ç”±äºæ–‡ä»¶ä¸­å·²ç»æ²¡æœ‰å­—èŠ‚äº†ï¼Œread() è¿”å› 0ï¼Œç¨‹åºçŸ¥é“è¿™æ„å‘³ç€å®ƒå·²ç»è¯»å®Œäº†æ•´ä¸ªæ–‡ä»¶ã€‚å› æ­¤ï¼Œç¨‹åºä¼šè°ƒç”¨ close() æ¥è¡¨ç¤ºå®ƒå·²ç»è¯»å®Œäº†æ–‡ä»¶ â€œfooâ€ï¼Œå¹¶ä¼ å…¥ç›¸åº”çš„æ–‡ä»¶æè¿°ç¬¦ã€‚æ–‡ä»¶å°±è¿™æ ·å…³é—­äº†ï¼Œæ–‡ä»¶çš„è¯»å–ä¹Ÿå°±å®Œæˆäº†ã€‚ å†™æ–‡ä»¶çš„æ­¥éª¤ä¸æ­¤ç±»ä¼¼ã€‚é¦–å…ˆï¼Œæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå†™å…¥ï¼Œç„¶åè°ƒç”¨ write() ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹äºè¾ƒå¤§çš„æ–‡ä»¶ï¼Œå¯èƒ½ä¼šé‡å¤è°ƒç”¨ï¼Œæœ€åå…³é—­ write()ã€‚ä½¿ç”¨ strace æ¥è·Ÿè¸ªå¯¹æ–‡ä»¶çš„å†™å…¥ï¼Œæˆ–è®¸æ˜¯è·Ÿè¸ªä½ è‡ªå·±ç¼–å†™çš„ç¨‹åºï¼Œæˆ–è®¸æ˜¯è·Ÿè¸ª dd å·¥å…·ï¼Œä¾‹å¦‚ dd if=foo of=barï¼ˆä»æ–‡ä»¶fooä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶å†™å…¥åˆ°æ–‡ä»¶barä¸­ï¼‰ã€‚ 2.1.2.2 éé¡ºåºè¯»å†™ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†å¦‚ä½•è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œä½†æ‰€æœ‰è®¿é—®éƒ½æ˜¯é¡ºåºçš„ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä¹ˆä»å¤´åˆ°å°¾è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œè¦ä¹ˆä»å¤´åˆ°å°¾å†™å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚ ç„¶è€Œï¼Œæœ‰æ—¶èƒ½å¤Ÿè¯»å–æˆ–å†™å…¥æ–‡ä»¶ä¸­çš„ç‰¹å®šåç§»é‡æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åœ¨æ–‡æœ¬æ–‡æ¡£ä¸Šæ„å»ºç´¢å¼•ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥æŸ¥æ‰¾ç‰¹å®šå•è¯ï¼Œæ‚¨æœ€ç»ˆå¯èƒ½ä¼šä»æ–‡æ¡£ä¸­çš„ä¸€äº›éšæœºåç§»é‡ä¸­è¯»å–ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ lseek() ç³»ç»Ÿè°ƒç”¨ã€‚è¿™æ˜¯å‡½æ•°åŸå‹ï¼š off_t lseek(int fildes, off_t offset, int whence); ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯filedesçš„ï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯offsetï¼Œå®ƒå°†æ–‡ä»¶åç§»é‡å®šä½åˆ°æ–‡ä»¶ä¸­çš„ç‰¹å®šä½ç½®ã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°ç”±äºå†å²åŸå› è¢«ç§°ä¸º whenceï¼Œå®ƒå†³å®šäº†å¯»æ‰¾çš„å…·ä½“æ‰§è¡Œæ–¹å¼ã€‚æ‘˜è‡ªman page: man lseekï¼š å¦‚æœwhenceæ˜¯SEEK_SETï¼Œåˆ™åç§»é‡è®¾ç½®ä¸ºåç§»å­—èŠ‚ã€‚ å¦‚æœwhenceæ˜¯SEEK_CURï¼Œåˆ™åç§»é‡è®¾ç½®ä¸ºå…¶å½“å‰ä½ç½®åŠ ä¸Šåç§»å­—èŠ‚ã€‚ å¦‚æœwhenceæ˜¯SEEK_ENDï¼Œåˆ™åç§»é‡è®¾ç½®ä¸ºæ–‡ä»¶çš„å¤§å°åŠ ä¸Šåç§»é‡å­—èŠ‚ã€‚ æ•°æ®ç»“æ„â€”â€”æ‰“å¼€æ–‡ä»¶è¡¨ æ¯ä¸ªè¿›ç¨‹éƒ½ç»´æŠ¤ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æ•°ç»„ï¼Œæ¯ä¸ªæ–‡ä»¶æè¿°ç¬¦éƒ½å¼•ç”¨ç³»ç»ŸèŒƒå›´çš„æ‰“å¼€æ–‡ä»¶è¡¨ä¸­çš„ä¸€ä¸ªæ¡ç›®ã€‚è¯¥è¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½ä¼šè·Ÿè¸ªæè¿°ç¬¦å¼•ç”¨çš„åº•å±‚æ–‡ä»¶ã€å½“å‰åç§»é‡ä»¥åŠå…¶ä»–ç›¸å…³è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚æ–‡ä»¶æ˜¯å¦å¯è¯»æˆ–å¯å†™ã€‚ ä»ä¸Šè¿°æè¿°ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºè¿›ç¨‹æ‰“å¼€çš„æ¯ä¸ªæ–‡ä»¶ï¼Œæ“ä½œç³»ç»Ÿéƒ½ä¼šè·Ÿè¸ªä¸€ä¸ª â€œå½“å‰ â€œåç§»é‡ï¼Œè¯¥åç§»é‡å†³å®šäº†ä¸‹ä¸€æ¬¡è¯»å–æˆ–å†™å…¥å°†ä»æ–‡ä»¶çš„å“ªä¸ªä½ç½®å¼€å§‹ã€‚å› æ­¤ï¼Œæ‰“å¼€æ–‡ä»¶çš„æŠ½è±¡æ¦‚å¿µä¹‹ä¸€å°±æ˜¯å®ƒæœ‰ä¸€ä¸ªå½“å‰åç§»é‡ï¼Œè¯¥åç§»é‡é€šè¿‡ä¸¤ç§æ–¹å¼ä¹‹ä¸€è¿›è¡Œæ›´æ–°ã€‚ ç¬¬ä¸€ç§æ–¹å¼æ˜¯ï¼Œå½“è¯»å–æˆ–å†™å…¥ $N$ ä¸ªå­—èŠ‚æ—¶ï¼Œ$N$ ä¼šæ·»åŠ åˆ°å½“å‰åç§»é‡ä¸­ï¼›å› æ­¤æ¯æ¬¡è¯»å–æˆ–å†™å…¥éƒ½ä¼šéšå¼æ›´æ–°åç§»é‡ã€‚ ç¬¬äºŒç§æ–¹å¼æ˜¯é€šè¿‡ lseek æ¥æ˜¾å¼æ›´æ–°åç§»é‡ï¼Œå¦‚ä¸Šæ–‡æ‰€è¿°ã€‚ æ­£å¦‚ä½ å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œåç§»é‡ä¿å­˜åœ¨æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„struct fileä¸­ï¼Œç”± struct proc å¼•ç”¨ã€‚ä¸‹é¢æ˜¯è¯¥ç»“æ„çš„ xv6ï¼ˆç®€åŒ–ï¼‰å®šä¹‰ï¼š struct file { int ref; char readable; char writable; struct inode *ip; uint off; }; æ­£å¦‚æ‚¨åœ¨è¯¥ç»“æ„ä¸­æ‰€çœ‹åˆ°çš„ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥ç¡®å®šæ‰“å¼€çš„æ–‡ä»¶æ˜¯å¦å¯è¯»æˆ–å¯å†™ï¼ˆæˆ–ä¸¤è€…ï¼‰ã€å®ƒå¼•ç”¨çš„åº•å±‚æ–‡ä»¶ï¼ˆç”± struct inode æŒ‡é’ˆ ip æŒ‡å‘ï¼‰ä»¥åŠå½“å‰åç§»é‡ï¼ˆoffï¼‰ã€‚è¿˜æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼ˆrefï¼‰ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢è¿›ä¸€æ­¥è®¨è®ºã€‚ è¿™äº›æ–‡ä»¶ç»“æ„ä»£è¡¨äº†ç³»ç»Ÿä¸­å½“å‰æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶ï¼›å®ƒä»¬æœ‰æ—¶ä¸€èµ·ç§°ä¸ºæ‰“å¼€æ–‡ä»¶è¡¨ã€‚ xv6 å†…æ ¸ä¹Ÿå°†å®ƒä»¬ä¿ç•™ä¸ºæ•°ç»„ï¼Œæ¯ä¸ªæ¡ç›®æœ‰ä¸€ä¸ªé”ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š struct { struct spinlock lock; struct file file[NFILE]; } ftable; è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥æ›´æ¸…æ¥šåœ°è¯´æ˜è¿™ä¸€ç‚¹ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬è·Ÿè¸ªä¸€ä¸ªæ‰“å¼€æ–‡ä»¶ï¼ˆå¤§å°ä¸º 300 å­—èŠ‚ï¼‰å¹¶é€šè¿‡é‡å¤è°ƒç”¨ read() ç³»ç»Ÿè°ƒç”¨æ¥è¯»å–è¯¥æ–‡ä»¶çš„è¿›ç¨‹ï¼Œæ¯æ¬¡è¯»å– 100 å­—èŠ‚ã€‚ä»¥ä¸‹æ˜¯ç›¸å…³ç³»ç»Ÿè°ƒç”¨çš„è·Ÿè¸ªï¼Œä»¥åŠæ¯ä¸ªç³»ç»Ÿè°ƒç”¨è¿”å›çš„å€¼ï¼Œä»¥åŠæ­¤æ–‡ä»¶è®¿é—®çš„æ‰“å¼€æ–‡ä»¶è¡¨ä¸­çš„å½“å‰åç§»é‡çš„å€¼ï¼š è·Ÿè¸ªä¸­æœ‰å‡ é¡¹å€¼å¾—æ³¨æ„ã€‚ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:2:1","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 ç›®å½•æ“ä½œ é™¤äº†æ–‡ä»¶ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸€ç»„ä¸ç›®å½•ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨æ¥åˆ›å»ºã€è¯»å–å’Œåˆ é™¤ç›®å½•ã€‚è¯·æ³¨æ„ï¼Œæ‚¨æ°¸è¿œä¸èƒ½ç›´æ¥å†™å…¥ç›®å½•ï¼›ç”±äºç›®å½•çš„æ ¼å¼è¢«è§†ä¸ºæ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®ï¼Œå› æ­¤æ‚¨åªèƒ½é€šè¿‡åœ¨å…¶ä¸­åˆ›å»ºæ–‡ä»¶ã€ç›®å½•æˆ–å…¶ä»–å¯¹è±¡ç±»å‹ç­‰æ–¹å¼é—´æ¥æ›´æ–°ç›®å½•ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ–‡ä»¶ç³»ç»Ÿå¯ä»¥ç¡®ä¿ç›®å½•çš„å†…å®¹å§‹ç»ˆç¬¦åˆé¢„æœŸã€‚ 2.2.1 åˆ›å»ºç›®å½• è¦åˆ›å»ºç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨å•ä¸ªç³»ç»Ÿè°ƒç”¨ mkdir()ã€‚åŒåçš„ mkdir ç¨‹åºå¯ç”¨äºåˆ›å»ºè¿™æ ·çš„ç›®å½•ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å½“æˆ‘ä»¬è¿è¡Œ mkdir ç¨‹åºæ¥åˆ›å»ºä¸€ä¸ªåä¸º foo çš„ç®€å•ç›®å½•æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼š \u003e strace mkdir foo ... mkdir(\"foo\", 0777) = 0 ... å½“åˆ›å»ºè¿™æ ·çš„ç›®å½•æ—¶ï¼Œå®ƒè¢«è§†ä¸ºâ€œemptyâ€ï¼Œå°½ç®¡å®ƒç¡®å®å…·æœ‰æœ€å°‘çš„å†…å®¹ã€‚å…·ä½“æ¥è¯´ï¼Œä¸€ä¸ªç©ºç›®å½•æœ‰ä¸¤ä¸ªæ¡ç›®ï¼šä¸€ä¸ªæ¡ç›®å¼•ç”¨å…¶è‡ªèº«ï¼Œå¦ä¸€ä¸ªæ¡ç›®å¼•ç”¨å…¶çˆ¶ç›®å½•ã€‚å‰è€…è¢«ç§°ä¸ºâ€œ.â€ ï¼ˆç‚¹ï¼‰ç›®å½•ï¼Œåè€…ä¸ºâ€œ..â€ï¼ˆç‚¹-ç‚¹ï¼‰ã€‚å…¶ä¸­æ ¹ç›®å½•æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„é¡¶å±‚ç›®å½•ï¼Œå› æ­¤å®ƒæ²¡æœ‰çˆ¶ç›®å½•ï¼Œåœ¨ UNIX æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ ¹ç›®å½•çš„çˆ¶ç›®å½•é€šå¸¸è¢«è¡¨ç¤ºä¸ºè‡ªèº«ï¼Œå³æŒ‡å‘è‡ªå·±ã€‚ æ‚¨å¯ä»¥é€šè¿‡å°†æ ‡å¿— (-a) ä¼ é€’ç»™ç¨‹åº ls æ¥æŸ¥çœ‹è¿™äº›ç›®å½•ï¼š \u003e ls -al foo total 8 drwxrwxr-x 2 zfhe zfhe 4096 Apr 16 19:48 . drwxrwxr-x 3 zfhe zfhe 4096 Apr 16 19:48 .. 2.2.2 è¯»å–ç›®å½• ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªç›®å½•ï¼Œæˆ‘ä»¬å¯èƒ½ä¹Ÿå¸Œæœ›è¯»å–ä¸€ä¸ªç›®å½•ã€‚äº‹å®ä¸Šï¼Œè¿™æ­£æ˜¯ç¨‹åº ls æ‰€åšçš„ã€‚è®©æˆ‘ä»¬ç¼–å†™è‡ªå·±çš„å°å·¥å…·ï¼ˆä¾‹å¦‚ lsï¼‰ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®Œæˆçš„ã€‚ æˆ‘ä»¬ä¸åªæ˜¯åƒæ‰“å¼€æ–‡ä»¶ä¸€æ ·æ‰“å¼€ç›®å½•ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ç»„æ–°çš„è°ƒç”¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ‰“å°ç›®å½•å†…å®¹çš„ç¤ºä¾‹ç¨‹åºã€‚ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cdirent.h\u003e #include \u003cassert.h\u003e int main(int argc, char *argv[]) { DIR *dp = opendir(\".\"); // Open current directory assert(dp != NULL); struct dirent *d; while ((d = readdir(dp)) != NULL) { // Read one directory entry // Print the inode number and name printf(\"%lu %s\\n\", (unsigned long) d-\u003ed_ino, d-\u003ed_name); } closedir(dp); // Close the directory return 0; } è¯¥ç¨‹åºä½¿ç”¨äº†ä¸‰ä¸ªè°ƒç”¨ï¼šopendir()ã€readdir() å’Œ closedir() æ¥å®Œæˆå·¥ä½œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ¥å£æ˜¯å¤šä¹ˆç®€å•ï¼›æˆ‘ä»¬åªæ˜¯ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¸€æ¬¡è¯»å–ä¸€ä¸ªç›®å½•æ¡ç›®ï¼Œå¹¶æ‰“å°å‡ºç›®å½•ä¸­æ¯ä¸ªæ–‡ä»¶çš„åç§°å’Œinode numberã€‚ â¯ make read_dir gcc -c read_dir.c gcc read_dir.o -o read_dir â¯ ./read_dir 26212234 . 22996964 .. 26257183 file.txt 26257285 fork-seek 26256904 Makefile 26261892 fsync.c 26257284 fork-seek.o 26258349 dup 26261922 fsync 26258348 dup.o 26405969 read_dir.o 26212238 README.md 26261927 foo 26405970 read_dir 26405873 read_dir.c 26258222 dup.c 26256864 fork-seek.c 26261921 fsync.o ä¸‹é¢çš„å£°æ˜æ˜¾ç¤ºäº† struct dirent æ•°æ®ç»“æ„ä¸­æ¯ä¸ªç›®å½•æ¡ç›®ä¸­çš„å¯ç”¨ä¿¡æ¯ï¼š struct dirent { char d_name[256]; /* filename */ ino_t d_ino; /* inode number */ off_t d_off; /* offset to the next dirent */ unsigned short d_reclen; /* length of this record */ unsigned char d_type; /* type of file */ }; ç”±äºç›®å½•ä¸­çš„ä¿¡æ¯å¾ˆå°‘ï¼ˆåŸºæœ¬ä¸Šåªæ˜¯å°†åç§°æ˜ å°„åˆ° inode numberï¼Œä»¥åŠå…¶ä»–ä¸€äº›ç»†èŠ‚ï¼‰ï¼Œç¨‹åºå¯èƒ½å¸Œæœ›åœ¨æ¯ä¸ªæ–‡ä»¶ä¸Šè°ƒç”¨ stat() æ¥è·å–æ¯ä¸ªæ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼Œå¦‚é•¿åº¦æˆ–å…¶ä»–è¯¦ç»†ä¿¡æ¯ã€‚äº‹å®ä¸Šï¼Œå½“ä½ ç»™ ls ä¼ é€’ -l æ ‡å¿—æ—¶ï¼Œå®ƒå°±ä¼šè¿™ä¹ˆåšã€‚ 2.2.3 åˆ é™¤ç›®å½• æœ€åï¼Œä½ å¯ä»¥è°ƒç”¨ rmdir()ï¼ˆç”±åŒåç¨‹åº rmdir ä½¿ç”¨ï¼‰åˆ é™¤ç›®å½•ã€‚ä¸è¿‡ï¼Œä¸åˆ é™¤æ–‡ä»¶ä¸åŒï¼Œåˆ é™¤ç›®å½•æ›´åŠ å±é™©ï¼Œå› ä¸ºä¸€æ¡å‘½ä»¤å°±å¯èƒ½åˆ é™¤å¤§é‡æ•°æ®ã€‚å› æ­¤ï¼Œrmdir() è¦æ±‚åœ¨åˆ é™¤ä¹‹å‰ç›®å½•å¿…é¡»ä¸ºç©ºï¼ˆå³åªæœ‰â€. â€œå’Œâ€.. â€œæ¡ç›®ï¼‰ã€‚å¦‚æœè¯•å›¾åˆ é™¤éç©ºç›®å½•ï¼Œrmdir() å‡½æ•°çš„è°ƒç”¨å°±ä¼šå¤±è´¥ã€‚ \u003e echo \"Hello, World\" \u003e foo/foo.txt \u003e rmdir foo rmdir: failed to remove 'foo': Directory not empty \u003e rm foo/foo.txt \u003e rmdir foo ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:2:2","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 é“¾æ¥ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:3:0","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 ç¡¬é“¾æ¥ ç°åœ¨ï¼Œæˆ‘ä»¬é€šè¿‡äº†è§£ä¸€ç§åœ¨æ–‡ä»¶ç³»ç»Ÿæ ‘ä¸­åˆ›å»ºæ¡ç›®çš„æ–°æ–¹æ³•ï¼Œå³ link() ç³»ç»Ÿè°ƒç”¨ï¼Œå›åˆ°ä¸ºä»€ä¹ˆè¦é€šè¿‡ unlink() æ¥åˆ é™¤æ–‡ä»¶çš„è°œé¢˜ä¸Šæ¥ã€‚link() ç³»ç»Ÿè°ƒç”¨éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ—§è·¯å¾„åå’Œä¸€ä¸ªæ–°è·¯å¾„åï¼›å½“ä½ æŠŠä¸€ä¸ªæ–°æ–‡ä»¶å â€œé“¾æ¥ â€œåˆ°ä¸€ä¸ªæ—§æ–‡ä»¶åæ—¶ï¼Œä½ åŸºæœ¬ä¸Šå°±åˆ›é€ äº†å¦ä¸€ç§æ–¹å¼æ¥å¼•ç”¨åŒä¸€ä¸ªæ–‡ä»¶ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå‘½ä»¤è¡Œç¨‹åº ln å°±æ˜¯ç”¨æ¥å®ç°è¿™ä¸€åŠŸèƒ½çš„ï¼š \u003e echo \"Hello, World\" \u003e foo \u003e cat foo Hello, World \u003e ln foo foo2 \u003e cat foo2 Hello, World è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«å•è¯â€œHello, Worldâ€çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶å‘½åä¸ºfooã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ ln ç¨‹åºåˆ›å»ºåˆ°è¯¥æ–‡ä»¶çš„ç¡¬é“¾æ¥ã€‚ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰“å¼€ foo æˆ– foo2 æ¥æ£€æŸ¥è¯¥æ–‡ä»¶ã€‚ é“¾æ¥çš„å·¥ä½œåŸç†æ˜¯ï¼Œå®ƒåªæ˜¯åœ¨åˆ›å»ºé“¾æ¥çš„ç›®å½•ä¸­åˆ›å»ºå¦ä¸€ä¸ªåç§°ï¼Œå¹¶å°†å…¶æŒ‡å‘ä¸åŸå§‹æ–‡ä»¶ç›¸åŒçš„ inode numberï¼ˆå³åº•å±‚åç§°ï¼‰ã€‚æ–‡ä»¶å¹¶æ²¡æœ‰ä»¥ä»»ä½•æ–¹å¼å¤åˆ¶ï¼›ç›¸åï¼Œä½ ç°åœ¨åªæœ‰ä¸¤ä¸ªåç§°ï¼ˆfooå’Œ foo2ï¼‰ï¼Œå®ƒä»¬éƒ½æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨ç›®å½•æœ¬èº«ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œæ‰“å°å‡ºæ¯ä¸ªæ–‡ä»¶çš„ inode numberï¼š \u003e ls -i foo foo2 1339196 foo 1339196 foo2 é€šè¿‡å‘ ls ä¼ é€’ -i æ ‡å¿—ï¼Œå®ƒä¼šæ‰“å°å‡ºæ¯ä¸ªæ–‡ä»¶çš„ inode numberï¼ˆä»¥åŠæ–‡ä»¶åï¼‰ã€‚è¿™æ ·ï¼Œä½ å°±èƒ½çœ‹åˆ° link åˆ°åº•åšäº†ä»€ä¹ˆï¼šå®ƒåªæ˜¯å¯¹ç›¸åŒçš„ inode numberï¼ˆæœ¬ä¾‹ä¸­ä¸º 1339196ï¼‰è¿›è¡Œäº†æ–°çš„å¼•ç”¨ã€‚ ç°åœ¨ï¼Œä½ å¯èƒ½å¼€å§‹æ˜ç™½ä¸ºä»€ä¹ˆ unlink() è¦å« unlink()äº†ã€‚å½“ä½ åˆ›å»ºæ–‡ä»¶æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨åšä¸¤ä»¶äº‹ã€‚ é¦–å…ˆï¼Œä½ æ­£åœ¨åˆ›å»ºä¸€ä¸ªç»“æ„ï¼ˆinodeï¼‰ï¼Œå®ƒå°†è·Ÿè¸ªæ–‡ä»¶çš„å‡ ä¹æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¤§å°ã€å—åœ¨ç£ç›˜ä¸Šçš„ä½ç½®ç­‰ç­‰ã€‚ å…¶æ¬¡ï¼Œå°†ä¸€ä¸ªäººç±»å¯è¯»çš„åç§°é“¾æ¥åˆ°è¯¥æ–‡ä»¶ï¼Œå¹¶å°†è¯¥é“¾æ¥æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸­ã€‚ åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºäº†æ–‡ä»¶çš„ç¡¬é“¾æ¥åï¼ŒåŸå§‹æ–‡ä»¶åï¼ˆfooï¼‰å’Œæ–°åˆ›å»ºçš„æ–‡ä»¶åï¼ˆfoo2ï¼‰å°±æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«äº†ï¼›äº‹å®ä¸Šï¼Œå®ƒä»¬éƒ½åªæ˜¯æŒ‡å‘æ–‡ä»¶åº•å±‚å…ƒæ•°æ®çš„é“¾æ¥ï¼Œè€Œæ–‡ä»¶åº•å±‚å…ƒæ•°æ®å°±åœ¨ inode number1339196ä¸­ã€‚ å› æ­¤ï¼Œè¦ä»æ–‡ä»¶ç³»ç»Ÿä¸­åˆ é™¤æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ unlink()ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤åä¸º file çš„æ–‡ä»¶ï¼Œå¹¶ä¸”ä»ç„¶å¯ä»¥é¡ºåˆ©è®¿é—®è¯¥æ–‡ä»¶ï¼š \u003e ls foo foo2 \u003e rm foo \u003e cat foo2 Hello, World è¿™æ ·åšçš„åŸå› æ˜¯ï¼Œå½“æ–‡ä»¶ç³»ç»Ÿå–æ¶ˆé“¾æ¥æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ inode numberå†…çš„å¼•ç”¨è®¡æ•°ã€‚è¯¥å¼•ç”¨è®¡æ•°ï¼ˆæœ‰æ—¶ç§°ä¸ºé“¾æ¥è®¡æ•°ï¼‰å…è®¸æ–‡ä»¶ç³»ç»Ÿè·Ÿè¸ªæœ‰å¤šå°‘ä¸åŒçš„æ–‡ä»¶åå·²é“¾æ¥åˆ°è¯¥ç‰¹å®š inodeã€‚å½“è°ƒç”¨ unlink() æ—¶ï¼Œå®ƒä¼šåˆ é™¤æ–‡ä»¶åï¼ˆæ­£åœ¨åˆ é™¤çš„æ–‡ä»¶ï¼‰ä¸ç»™å®š inode numberä¹‹é—´çš„â€œé“¾æ¥â€ï¼Œå¹¶å‡å°‘å¼•ç”¨è®¡æ•°ï¼›åªæœ‰å½“å¼•ç”¨è®¡æ•°ä¸ºé›¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿæ‰ä¼šåŒæ—¶é‡Šæ”¾inodeå’Œç›¸å…³æ•°æ®å—ï¼Œä»è€ŒçœŸæ­£â€œåˆ é™¤â€æ–‡ä»¶ã€‚ å½“ç„¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ stat() æŸ¥çœ‹æ–‡ä»¶çš„å¼•ç”¨è®¡æ•°ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬åˆ›å»ºå’Œåˆ é™¤æ–‡ä»¶çš„ç¡¬é“¾æ¥æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæŒ‡å‘åŒä¸€æ–‡ä»¶çš„ä¸‰ä¸ªé“¾æ¥ï¼Œç„¶åå°†å…¶åˆ é™¤ã€‚è§‚å¯Ÿé“¾æ¥è®¡æ•°ï¼ \u003e echo \"Hello, World\" \u003e foo \u003e stat foo | grep Inode Device: fc03h/64515d Inode: 1338857 Links: 1 \u003e ln foo foo2 \u003e stat foo | grep Inode Device: fc03h/64515d Inode: 1338857 Links: 2 \u003e ln foo2 foo3 \u003e stat foo | grep Inode Device: fc03h/64515d Inode: 1338857 Links: 3 \u003e rm foo \u003e stat foo2 | grep Inode Device: fc03h/64515d Inode: 1338857 Links: 2 \u003e rm foo2 \u003e stat foo3 | grep Inode Device: fc03h/64515d Inode: 1338857 Links: 1 ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:3:1","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 ç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰ è¿˜æœ‰å¦ä¸€ç§éå¸¸æœ‰ç”¨çš„é“¾æ¥ç±»å‹ï¼Œå®ƒç§°ä¸ºç¬¦å·é“¾æ¥ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºè½¯é“¾æ¥ã€‚äº‹å®è¯æ˜ï¼Œç¡¬é“¾æ¥æœ‰ä¸€å®šçš„å±€é™æ€§ï¼š æ‚¨ä¸èƒ½ä¸ºç›®å½•åˆ›å»ºç¡¬é“¾æ¥ï¼Œå› ä¸ºæ‹…å¿ƒä¼šåœ¨ç›®å½•æ ‘ä¸­åˆ›å»ºå¾ªç¯ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªç›®å½•Aå’ŒBï¼Œå®ƒä»¬éƒ½åŒ…å«ä¸€ä¸ªç¡¬é“¾æ¥åˆ°å¯¹æ–¹çš„ç¡¬é“¾æ¥ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ— è®ºä½ ä»Aå¼€å§‹è¿˜æ˜¯ä»Bå¼€å§‹ï¼Œéƒ½ä¼šå¯¼è‡´æ— é™çš„å¾ªç¯ï¼Œå› ä¸ºé€šè¿‡ä»»ä¸€è·¯å¾„è¿›å…¥å…¶ä¸­ä¸€ä¸ªç›®å½•åï¼Œä½ å¯ä»¥é€šè¿‡ç¡¬é“¾æ¥è¿”å›åˆ°å¦ä¸€ä¸ªç›®å½•ï¼Œåå¤æ— ç©·åœ°è¿›è¡Œã€‚ æ‚¨ä¸èƒ½ç¡¬é“¾æ¥åˆ°å…¶ä»–ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ï¼ˆå› ä¸º inode numberä»…åœ¨ç‰¹å®šæ–‡ä»¶ç³»ç»Ÿå†…å”¯ä¸€ï¼Œè€Œä¸æ˜¯è·¨æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼› å› æ­¤ï¼Œåˆ›å»ºäº†ä¸€ç§ç§°ä¸ºç¬¦å·é“¾æ¥çš„æ–°å‹é“¾æ¥ã€‚è¦åˆ›å»ºè¿™æ ·çš„é“¾æ¥ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ç¨‹åº lnï¼Œä½†å¸¦æœ‰ -s æ ‡å¿—ã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š \u003e echo \"Hello, World\" \u003e foo \u003e ln -s foo foo2 \u003e cat foo2 Hello, World æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œåˆ›å»ºè½¯é“¾æ¥çœ‹èµ·æ¥éå¸¸ç›¸ä¼¼ï¼Œç°åœ¨å¯ä»¥é€šè¿‡æ–‡ä»¶å foo ä»¥åŠç¬¦å·é“¾æ¥å foo2 æ¥è®¿é—®åŸå§‹æ–‡ä»¶ã€‚ ç„¶è€Œï¼Œé™¤äº†è¡¨é¢ä¸Šçš„ç›¸ä¼¼æ€§ä¹‹å¤–ï¼Œç¬¦å·é“¾æ¥å®é™…ä¸Šä¸ç¡¬é“¾æ¥æœ‰å¾ˆå¤§ä¸åŒã€‚ç¬¦å·é“¾æ¥å®é™…ä¸Šæœ¬èº«å°±æ˜¯ä¸€ä¸ªä¸åŒç±»å‹çš„æ–‡ä»¶ã€‚æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡å¸¸è§„æ–‡ä»¶å’Œç›®å½•ï¼›ç¬¦å·é“¾æ¥æ˜¯æ–‡ä»¶ç³»ç»Ÿæ‰€çŸ¥çš„ç¬¬ä¸‰ç§ç±»å‹ã€‚ç¬¦å·é“¾æ¥ä¸Šçš„ç»Ÿè®¡æ•°æ®æ­ç¤ºäº†ä¸€åˆ‡ï¼š \u003e stat foo | grep regular Size: 13 Blocks: 8 IO Block: 4096 regular file \u003e stat foo2 | grep symbolic Size: 3 Blocks: 0 IO Block: 4096 symbolic link è¿è¡Œ ls ä¹Ÿæ­ç¤ºäº†è¿™ä¸ªäº‹å®ã€‚å¦‚æœä»”ç»†è§‚å¯Ÿ ls è¾“å‡ºçš„é•¿æ ¼å¼çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œæ‚¨ä¼šå‘ç°æœ€å·¦ä¾§åˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ - è¡¨ç¤ºå¸¸è§„æ–‡ä»¶ï¼Œd è¡¨ç¤ºç›®å½•ï¼Œl è¡¨ç¤ºè½¯é“¾æ¥ã€‚æ‚¨è¿˜å¯ä»¥æŸ¥çœ‹ç¬¦å·é“¾æ¥çš„å¤§å°ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º 3 ä¸ªå­—èŠ‚ï¼‰ï¼Œä»¥åŠé“¾æ¥æŒ‡å‘çš„å†…å®¹ï¼ˆåä¸º foo çš„æ–‡ä»¶ï¼‰ã€‚ \u003e ls -al total 12 drwxrwxr-x 2 zfhe zfhe 4096 Apr 16 21:02 . drwxr-x--- 22 zfhe zfhe 4096 Apr 16 21:03 .. -rw-rw-r-- 1 zfhe zfhe 13 Apr 16 20:56 foo lrwxrwxrwx 1 zfhe zfhe 3 Apr 16 20:56 foo2 -\u003e foo foo2 æ˜¯ 3 ä¸ªå­—èŠ‚çš„åŸå› æ˜¯å› ä¸ºç¬¦å·é“¾æ¥çš„å½¢æˆæ–¹å¼æ˜¯å°†é“¾æ¥åˆ°çš„æ–‡ä»¶çš„è·¯å¾„åä½œä¸ºé“¾æ¥æ–‡ä»¶çš„æ•°æ®ã€‚å› ä¸ºæˆ‘ä»¬é“¾æ¥åˆ°äº†ä¸€ä¸ªåä¸º foo çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„é“¾æ¥æ–‡ä»¶ foo2 å¾ˆå°ï¼ˆ3 ä¸ªå­—èŠ‚ï¼‰ã€‚å¦‚æœæˆ‘ä»¬é“¾æ¥åˆ°æ›´é•¿çš„è·¯å¾„åï¼Œæˆ‘ä»¬çš„é“¾æ¥æ–‡ä»¶ä¼šæ›´å¤§ï¼š \u003e echo \"Hello, World\" \u003e a_longer_filename \u003e ln -s a_longer_filename file \u003e ls -al a_longer_filename file -rw-rw-r-- 1 zfhe zfhe 13 Apr 16 21:04 a_longer_filename lrwxrwxrwx 1 zfhe zfhe 17 Apr 16 21:05 file -\u003e a_longer_filename æœ€åï¼Œç”±äºç¬¦å·é“¾æ¥çš„åˆ›å»ºæ–¹å¼ï¼Œå®ƒä»¬ç•™ä¸‹äº†æ‰€è°“çš„æ‚¬ç©ºå¼•ç”¨çš„å¯èƒ½æ€§ï¼Œæ‚¬ç©ºå¼•ç”¨å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºé”™è¯¯ï¼Œå› ä¸ºå®ƒä»¬è¯•å›¾è®¿é—®ä¸å†æœ‰æ•ˆçš„å†…å­˜ä½ç½®æˆ–èµ„æºã€‚ \u003e echo \"Hello, World\" \u003e foo \u003e ln -s foo foo2 \u003e cat foo2 Hello, World \u003e rm foo \u003e cat foo2 cat: foo2: No such file or directory æ­£å¦‚æ‚¨åœ¨æ­¤ç¤ºä¾‹ä¸­æ‰€çœ‹åˆ°çš„ï¼Œä¸ç¡¬é“¾æ¥å®Œå…¨ä¸åŒï¼Œåˆ é™¤åä¸º foo çš„åŸå§‹æ–‡ä»¶ä¼šå¯¼è‡´é“¾æ¥æŒ‡å‘ä¸å†å­˜åœ¨çš„è·¯å¾„åã€‚ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:3:2","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 æƒé™ä½å’Œè®¿é—®æ§åˆ¶åˆ—è¡¨ è¿›ç¨‹çš„æŠ½è±¡æä¾›äº†ä¸¤ä¸ªä¸­å¿ƒè™šæ‹ŸåŒ–ï¼šCPUå’Œå†…å­˜ã€‚æ¯ä¸€ç§è™šæ‹ŸåŒ–éƒ½ä¼šç»™è¿›ç¨‹é€ æˆä¸€ç§é”™è§‰ï¼Œä»¥ä¸ºå®ƒæ‹¥æœ‰è‡ªå·±çš„ä¸“ç”¨ CPU å’Œä¸“ç”¨å†…å­˜ï¼›å®é™…ä¸Šï¼Œæ“ä½œç³»ç»Ÿä½¿ç”¨äº†å„ç§æŠ€æœ¯ï¼Œä»¥å®‰å…¨å¯é çš„æ–¹å¼åœ¨ç›¸äº’ç«äº‰çš„å®ä½“ä¹‹é—´å…±äº«æœ‰é™çš„ç‰©ç†èµ„æºã€‚ æ­£å¦‚æœ¬ç« æ‰€è¿°ï¼Œæ–‡ä»¶ç³»ç»Ÿä¹Ÿæä¾›äº†ç£ç›˜çš„è™šæ‹Ÿè§†å›¾ï¼Œå°†ç£ç›˜ä»ä¸€å †åŸå§‹å—è½¬åŒ–ä¸ºæ›´æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨çš„æ–‡ä»¶å’Œç›®å½•ã€‚ç„¶è€Œï¼Œæ–‡ä»¶ç³»ç»Ÿçš„æŠ½è±¡ä¸ CPU å’Œå†…å­˜çš„æŠ½è±¡æ˜æ˜¾ä¸åŒï¼Œå› ä¸ºæ–‡ä»¶é€šå¸¸ç”±ä¸åŒç”¨æˆ·å’Œè¿›ç¨‹å…±äº«ï¼Œå¹¶ä¸æ€»æ˜¯ç§æœ‰çš„ã€‚å› æ­¤ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­é€šå¸¸æœ‰ä¸€å¥—æ›´å…¨é¢çš„æœºåˆ¶æ¥å®ç°ä¸åŒç¨‹åº¦çš„å…±äº«ã€‚ æ­¤ç±»æœºåˆ¶çš„ç¬¬ä¸€ç§å½¢å¼æ˜¯ç»å…¸çš„ UNIX æƒé™ä½ã€‚è¦æŸ¥çœ‹æ–‡ä»¶ foo.txt çš„æƒé™ï¼Œåªéœ€è¾“å…¥ï¼š \u003e ls -l foo.txt -rw-rw-r-- 1 zfhe zfhe 0 Apr 16 21:12 foo.txt æˆ‘ä»¬åªå…³æ³¨è¯¥è¾“å‡ºçš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå³ -rw-r--r--ã€‚è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä»…æ˜¾ç¤ºæ–‡ä»¶çš„ç±»å‹ï¼š - è¡¨ç¤ºå¸¸è§„æ–‡ä»¶ï¼ˆå³ foo.txtï¼‰ï¼Œd è¡¨ç¤ºç›®å½•ï¼Œl è¡¨ç¤ºç¬¦å·é“¾æ¥ï¼Œä¾æ­¤ç±»æ¨ï¼›è¿™ï¼ˆå¤§éƒ¨åˆ†ï¼‰ä¸æƒé™æ— å…³ï¼Œæ‰€ä»¥æˆ‘ä»¬æš‚æ—¶å¿½ç•¥å®ƒã€‚ æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯æƒé™ä½ï¼Œå®ƒä»¬ç”±æ¥ä¸‹æ¥çš„ä¹ä¸ªå­—ç¬¦ï¼ˆrw-r--r--ï¼‰è¡¨ç¤ºã€‚å¯¹äºæ¯ä¸ªå¸¸è§„æ–‡ä»¶ã€ç›®å½•å’Œå…¶ä»–å®ä½“ï¼Œè¿™äº›ä½ç¡®å®šè°å¯ä»¥è®¿é—®å®ƒä»¥åŠå¦‚ä½•è®¿é—®å®ƒã€‚ æƒé™ç”±ä¸‰ç»„ç»„æˆï¼š æ–‡ä»¶æ‰€æœ‰è€…å¯ä»¥å¯¹æ–‡ä»¶æ‰§è¡Œå“ªäº›æ“ä½œï¼› ç»„ä¸­çš„æŸä¸ªäººå¯ä»¥å¯¹æ–‡ä»¶æ‰§è¡Œå“ªäº›æ“ä½œï¼› æœ€åæ˜¯ä»»ä½•äººï¼ˆæœ‰æ—¶ç§°ä¸ºå…¶ä»–äººï¼‰éƒ½å¯ä»¥æ‰§è¡Œå“ªäº›æ“ä½œã€‚ æ‰€æœ‰è€…ã€ç»„æˆå‘˜æˆ–å…¶ä»–äººå¯ä»¥æ‹¥æœ‰çš„èƒ½åŠ›åŒ…æ‹¬è¯»å–æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶æˆ–æ‰§è¡Œæ–‡ä»¶çš„èƒ½åŠ›ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œls è¾“å‡ºçš„å‰ä¸‰ä¸ªå­—ç¬¦è¡¨æ˜è¯¥æ–‡ä»¶å¯ç”±æ‰€æœ‰è€… (rw-) è¯»å–å’Œå†™å…¥ï¼Œå¹¶ä¸”åªèƒ½ç”±ç»„zfheæˆå‘˜ä»¥åŠç³»ç»Ÿä¸­çš„å…¶ä»–ä»»ä½•äººè¯»å– (r -- åé¢è·Ÿç€ r--)ã€‚ æ–‡ä»¶çš„æ‰€æœ‰è€…å¯ä»¥è½»æ¾æ›´æ”¹è¿™äº›æƒé™ï¼Œä¾‹å¦‚é€šè¿‡ä½¿ç”¨ chmodå‘½ä»¤ï¼ˆæ›´æ”¹æ–‡ä»¶æ¨¡å¼ï¼‰ï¼ˆè¿˜æœ‰chownï¼šæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…ï¼›chgrpï¼šæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç»„ï¼‰ã€‚è¦åˆ é™¤é™¤æ‰€æœ‰è€…ä¹‹å¤–çš„ä»»ä½•äººè®¿é—®è¯¥æ–‡ä»¶çš„èƒ½åŠ›ï¼Œæ‚¨å¯ä»¥è¾“å…¥ï¼š \u003e chmod 600 foo.txt \u003e ls -l foo.txt -rw------- 1 zfhe zfhe 0 Apr 16 21:12 foo.txt è¿™æ¡å‘½ä»¤å¯ç”¨äº†æ‰€æœ‰è€…çš„å¯è¯»ä½ï¼ˆ4ï¼‰å’Œå¯å†™ä½ï¼ˆ2ï¼‰ï¼ˆå°†å®ƒä»¬ OR åœ¨ä¸€èµ·ä¼šäº§ç”Ÿä¸Šé¢çš„ 6ï¼‰ï¼Œä½†å°†ç»„å’Œå…¶ä»–äººçš„æƒé™ä½åˆ†åˆ«è®¾ç½®ä¸º 0 å’Œ 0ï¼Œä»è€Œå°†æƒé™è®¾ç½®ä¸º rw-------ã€‚ æ‰§è¡Œä½å°¤å…¶æœ‰è¶£ã€‚å¯¹äºæ™®é€šæ–‡ä»¶ï¼Œå®ƒçš„å­˜åœ¨å†³å®šäº†ç¨‹åºæ˜¯å¦å¯ä»¥è¿è¡Œã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º hello.csh çš„ç®€å• shell è„šæœ¬ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›é€šè¿‡è¾“å…¥ä»¥ä¸‹å†…å®¹æ¥è¿è¡Œå®ƒï¼š \u003e ./hello.csh hello, from shell world. ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æ­£ç¡®è®¾ç½®è¯¥æ–‡ä»¶çš„æ‰§è¡Œä½ï¼Œå°±ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š \u003e chmod 600 hello.csh \u003e ./hello.csh zsh: permission denied: ./hello.csh æ–‡ä»¶ç³»ç»Ÿçš„è¶…çº§ç”¨æˆ· å…è®¸å“ªä¸ªç”¨æˆ·æ‰§è¡Œç‰¹æƒæ“ä½œä»¥å¸®åŠ©ç®¡ç†æ–‡ä»¶ç³»ç»Ÿï¼Ÿä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦åˆ é™¤ä¸€ä¸ªä¸æ´»åŠ¨ç”¨æˆ·çš„æ–‡ä»¶ä»¥èŠ‚çœç©ºé—´ï¼Œè°æœ‰æƒè¿™æ ·åšï¼Ÿ åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¸¸è§çš„é»˜è®¤è®¾ç½®æ˜¯å­˜åœ¨æŸç§è¶…çº§ç”¨æˆ·ï¼ˆå³ rootï¼‰ï¼Œå®ƒå¯ä»¥è®¿é—®æ‰€æœ‰æ–‡ä»¶ï¼Œè€Œä¸å—æƒé™é™åˆ¶ã€‚åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ AFSï¼Œå®ƒæœ‰è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼‰ä¸­ï¼Œä¸€ä¸ªåä¸º system:administrators çš„ç»„åŒ…å«å—ä¿¡ä»»çš„ç”¨æˆ·ã€‚ åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œè¿™äº›å—ä¿¡ä»»çš„ç”¨æˆ·éƒ½ä»£è¡¨ç€å›ºæœ‰çš„å®‰å…¨é£é™©ï¼›å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä»¥æŸç§æ–¹å¼å†’å……æ­¤ç±»ç”¨æˆ·ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®ç³»ç»Ÿä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä»è€Œè¿åé¢„æœŸçš„éšç§å’Œä¿æŠ¤ä¿è¯ã€‚ å¯¹äºç›®å½•ï¼Œæ‰§è¡Œä½çš„è¡Œä¸ºç•¥æœ‰ä¸åŒã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒä½¿ç”¨æˆ·ï¼ˆæˆ–ç»„æˆ–æ¯ä¸ªäººï¼‰èƒ½å¤Ÿæ‰§è¡Œè¯¸å¦‚å°†ç›®å½•ï¼ˆå³ cdï¼‰æ›´æ”¹ä¸ºç»™å®šç›®å½•ä¹‹ç±»çš„æ“ä½œï¼Œå¹¶ç»“åˆå¯å†™ä½åœ¨å…¶ä¸­åˆ›å»ºæ–‡ä»¶ã€‚åœ¨ UNIX æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå…·ä½“å¦‚ä¸‹ï¼š è¯»æƒé™ï¼ˆrï¼‰ï¼šå…è®¸æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆå³åˆ—å‡ºç›®å½•ä¸­çš„å†…å®¹ï¼‰ã€‚ å†™æƒé™ï¼ˆwï¼‰ï¼šå…è®¸åœ¨ç›®å½•ä¸­åˆ›å»ºã€åˆ é™¤å’Œé‡å‘½åæ–‡ä»¶ã€‚ æ‰§è¡Œæƒé™ï¼ˆxï¼‰ï¼šå…è®¸è¿›å…¥ç›®å½•ã€‚è¦è¿›å…¥ç›®å½•ï¼Œç”¨æˆ·å¿…é¡»æ‹¥æœ‰ç›®å½•çš„æ‰§è¡Œæƒé™ã€‚ é™¤äº†æƒé™ä½ä¹‹å¤–ï¼Œä¸€äº›æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç§°ä¸º AFS çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œè¿˜åŒ…æ‹¬æ›´å¤æ‚çš„æ§åˆ¶ã€‚ä¾‹å¦‚ï¼ŒAFS ä»¥æ¯ä¸ªç›®å½•çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ (ACL) çš„å½¢å¼æ‰§è¡Œæ­¤æ“ä½œã€‚è®¿é—®æ§åˆ¶åˆ—è¡¨æ˜¯ä¸€ç§æ›´é€šç”¨ã€æ›´å¼ºå¤§çš„æ–¹å¼æ¥å‡†ç¡®è¡¨ç¤ºè°å¯ä»¥è®¿é—®ç»™å®šèµ„æºã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè¿™ä½¿ç”¨æˆ·èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªéå¸¸å…·ä½“çš„åˆ—è¡¨ï¼Œå…¶ä¸­åˆ—å‡ºè°å¯ä»¥è¯»å–ä¸€ç»„æ–‡ä»¶ï¼Œè°ä¸èƒ½è¯»å–ä¸€ç»„æ–‡ä»¶ï¼Œè¿™ä¸ä¸Šè¿°æƒé™ä½çš„æ‰€æœ‰è€…/ç»„/æ‰€æœ‰äººæ¨¡å‹ä¸åŒã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸€ä½ç”¨æˆ·çš„ AFS å¸æˆ·ä¸­çš„ç§æœ‰ç›®å½•çš„è®¿é—®æ§åˆ¶ï¼Œå¦‚ fs listacl å‘½ä»¤æ‰€ç¤ºï¼š \u003e fs listacl private Access list for private is Normal rights: system:administrators rlidwka remzi rlidwka è¯¥åˆ—è¡¨æ˜¾ç¤ºç³»ç»Ÿç®¡ç†å‘˜å’Œç”¨æˆ· remzi éƒ½å¯ä»¥æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤å’Œç®¡ç†æ­¤ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œä»¥åŠè¯»å–ã€å†™å…¥å’Œé”å®šè¿™äº›æ–‡ä»¶ï¼Œå…·ä½“æ ‡è¯†ç¬¦è§£é‡Šå¦‚ä¸‹ã€‚ r: è¯»å–æƒé™ (Read) l: åˆ—å‡ºç›®å½•æƒé™ (List) i: æ’å…¥æƒé™ (Insert) d: åˆ é™¤æƒé™ (Delete) w: å†™å…¥æƒé™ (Write) k: é”å®šæƒé™ (Lock) a: ç®¡ç†æƒé™ (Administer) è¦å…è®¸æŸäººï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºå…¶ä»–ç”¨æˆ·ï¼‰è®¿é—®æ­¤ç›®å½•ï¼Œç”¨æˆ· remzi åªéœ€è¾“å…¥ä»¥ä¸‹å‘½ä»¤å³å¯ã€‚ \u003e fs setacl private/ andrea rl \u003e fs listacl private Access list for private is Normal rights: system:administrators rlidwka remzi rlidwka andrea rl è­¦æƒ•TOCTTOC TOCTTOU æ˜¯ â€œTime of Check to Time of Useâ€ çš„ç¼©å†™ï¼ŒæŒ‡çš„æ˜¯åœ¨æ£€æŸ¥æŸä¸ªæ¡ä»¶å’Œä½¿ç”¨è¯¥æ¡ä»¶ä¹‹é—´å¯èƒ½å­˜åœ¨çš„æ—¶é—´é—´éš”ã€‚è¿™ä¸ªæœ¯è¯­é€šå¸¸ç”¨äºæè¿°å®‰å…¨æ¼æ´ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šçº¿ç¨‹æˆ–å¹¶å‘ç¯å¢ƒä¸­ï¼Œç”±äºæ—¶é—´é—´éš”å¯¼è‡´çš„æ¡ä»¶ç«äº‰é—®é¢˜ã€‚ 1974 å¹´ï¼ŒMcPheeæ³¨æ„åˆ°è®¡ç®—æœºç³»ç»Ÿå­˜åœ¨é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼ŒMcPhee æŒ‡å‡ºâ€œâ€¦å¦‚æœæœ‰æ•ˆæ€§æ£€æŸ¥å’Œä¸è¯¥æœ‰æ•ˆæ€§æ£€æŸ¥ç›¸å…³çš„æ“ä½œä¹‹é—´å­˜åœ¨æ—¶é—´é—´éš”ï¼Œå¹¶ä¸”é€šè¿‡å¤šä»»åŠ¡å¤„ç†ï¼Œå¯ä»¥åœ¨è¯¥æ—¶é—´é—´éš”æœŸé—´æ•…æ„æ›´æ”¹æœ‰æ•ˆæ€§æ£€æŸ¥å˜é‡ï¼Œå¯¼è‡´æ§åˆ¶ç¨‹åºæ‰§è¡Œæ— æ•ˆæ“ä½œã€‚â€ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ­¤ç§°ä¸ºâ€œTime of Check to Time of Use â€(TOCTTOU) é—®é¢˜ï¼Œå¯æƒœï¼Œè¿™ç§æƒ…å†µä»ç„¶å¯èƒ½å‘ç”Ÿã€‚ Bishop å’Œ Dilgeræè¿°çš„ä¸€ä¸ªç®€å•ç¤ºä¾‹å±•ç¤ºäº†ç”¨æˆ·å¦‚ä½•æ¬ºéª—æ›´å€¼å¾—ä¿¡èµ–çš„æœåŠ¡ï¼Œä»è€Œé€ æˆéº»çƒ¦ã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œé‚®ä»¶æœåŠ¡ä»¥ root èº«ä»½è¿è¡Œï¼ˆå› æ­¤æœ‰æƒè®¿é—®ç³»ç»Ÿä¸Šçš„æ‰€æœ‰æ–‡ä»¶ï¼‰ã€‚è¯¥æœåŠ¡å°†ä¼ å…¥æ¶ˆæ¯é™„åŠ åˆ°ç”¨æˆ·çš„æ”¶ä»¶ç®±æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚é¦–å…ˆï¼Œå®ƒè°ƒç”¨ lstat() æ¥è·å–æœ‰å…³è¯¥æ–‡ä»¶çš„ä¿¡æ¯ï¼Œç‰¹åˆ«æ˜¯ç¡®ä¿å®ƒå®é™…ä¸Šåªæ˜¯ç›®æ ‡ç”¨æˆ·æ‹¥æœ‰çš„å¸¸è§„æ–‡ä»¶ï¼Œè€Œä¸æ˜¯æŒ‡å‘é‚®ä»¶æœåŠ¡å™¨ä¸åº”æ›´æ–°çš„å¦ä¸€ä¸ªæ–‡ä»¶çš„é“¾æ¥ã€‚ç„¶åï¼Œæ£€æŸ¥æˆåŠŸåï¼ŒæœåŠ¡å™¨ç”¨æ–°æ¶ˆæ¯æ›´æ–°æ–‡ä»¶ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œæ£€æŸ¥å’Œæ›´æ–°ä¹‹é—´çš„å·®è·å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼šæ”»å‡»è€…ï¼ˆåœ¨æœ¬ä¾‹ä¸­ï¼Œæ˜¯æ¥æ”¶é‚®ä»¶çš„ç”¨æˆ·ï¼Œå› æ­¤æœ‰æƒè®¿é—®æ”¶ä»¶ç®±ï¼‰åˆ‡æ¢æ”¶ä»¶ç®±æ–‡ä»¶ï¼ˆé€šè¿‡è°ƒç”¨ rename()) æŒ‡å‘æ•æ„Ÿæ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/passwdï¼ˆå…¶ä¸­ä¿å­˜æœ‰å…³ç”¨æˆ·åŠå…¶å¯†ç çš„ä¿¡æ¯ï¼‰ã€‚å¦‚æœè¿™ç§åˆ‡æ¢å‘ç”Ÿåœ¨æ­£ç¡®çš„æ—¶é—´ï¼ˆåœ¨æ£€æŸ¥å’Œè®¿é—®ä¹‹é—´ï¼‰ï¼ŒæœåŠ¡å™¨å°†ç”¨é‚®ä»¶çš„å†…å®¹æ›´æ–°æ•æ„Ÿæ–‡ä»¶ã€‚æ”»å‡»è€…ç°åœ¨å¯ä»¥é€šè¿‡å‘é€ç”µå­é‚®ä»¶å†™å…¥æ•æ„Ÿæ–‡ä»¶ï¼Œä»è€Œæå‡æƒé™ï¼›é€šè¿‡æ›´æ–°/etc/passwdï¼Œæ”»å‡»è€…å¯ä»¥æ·»åŠ å…·æœ‰rootæƒé™çš„å¸æˆ·ï¼Œä»è€Œè·å¾—ç³»ç»Ÿçš„æ§åˆ¶æƒã€‚ TOCTTOU é—®é¢˜æ²¡æœ‰ä»»ä½•ç®€å•è€Œå‡ºè‰²çš„è§£å†³æ–¹æ¡ˆã€‚ä¸€ç§æ–¹æ³•æ˜¯å‡å°‘éœ€è¦ root æƒé™æ‰èƒ½è¿è¡Œçš„æœåŠ¡æ•°é‡ï¼Œè¿™ä¼šæœ‰æ‰€å¸®åŠ©ã€‚ O_NOFOLLOW æ ‡å¿—ä½¿å¾—å¦‚æœç›®æ ‡æ˜¯ç¬¦å·é“¾æ¥ï¼Œopen() å°†å¤±è´¥ï¼Œä»è€Œé¿å…éœ€è¦æ‰€è¿°é“¾æ¥çš„æ”»å‡»ã€‚æ›´æ¿€è¿›çš„æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨äº‹åŠ¡æ€§æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†å¹¿æ³›éƒ¨ç½²çš„äº‹åŠ¡æ€§æ–‡ä»¶ç³»ç»Ÿå¹¶ä¸å¤šã€‚å› æ­¤ï¼Œé€šå¸¸çš„å»ºè®®ï¼šç¼–å†™ä»¥é«˜æƒé™è¿è¡Œçš„ä»£ç æ—¶è¦å°å¿ƒï¼ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:4:0","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 åˆ¶ä½œå’ŒæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ æˆ‘ä»¬ç°åœ¨å·²ç»äº†è§£äº†è®¿é—®æ–‡ä»¶ã€ç›®å½•å’ŒæŸäº›ç‰¹æ®Šç±»å‹é“¾æ¥çš„åŸºæœ¬æ¥å£ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜åº”è¯¥è®¨è®ºä¸€ä¸ªè¯é¢˜ï¼šå¦‚ä½•ä»è®¸å¤šåº•å±‚æ–‡ä»¶ç³»ç»Ÿä¸­ç”Ÿæˆå®Œæ•´çš„ç›®å½•æ ‘ã€‚è¦å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼Œé¦–å…ˆè¦åˆ¶ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œç„¶åæŒ‚è½½è¿™äº›æ–‡ä»¶ç³»ç»Ÿï¼Œä»¥ä¾¿è®¿é—®å…¶ä¸­çš„å†…å®¹ã€‚ ä¸ºäº†åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿï¼Œå¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿéƒ½æä¾›äº†ä¸€ä¸ªå·¥å…·ï¼Œé€šå¸¸è¢«ç§°ä¸º mkfsï¼ˆè¯»ä½œ â€œmake fsâ€ï¼‰ï¼Œå®ƒå¯ä»¥å®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚å…¶åŸç†å¦‚ä¸‹ï¼šè¾“å…¥ä¸€ä¸ªè®¾å¤‡ï¼ˆå¦‚ç£ç›˜åˆ†åŒºï¼Œå¦‚ /dev/sda1ï¼‰å’Œä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼ˆå¦‚ ext3ï¼‰ç»™è¯¥å·¥å…·ï¼Œå®ƒå°±ä¼šåœ¨è¯¥ç£ç›˜åˆ†åŒºä¸­å†™å…¥ä¸€ä¸ªä»¥æ ¹ç›®å½•ä¸ºèµ·ç‚¹çš„ç©ºæ–‡ä»¶ç³»ç»Ÿã€‚mkfs è¯´ï¼šâ€œé‚£å°±æœ‰ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå§ï¼â€ ä¸è¿‡ï¼Œä¸€æ—¦åˆ›å»ºäº†è¿™æ ·ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå°±éœ€è¦åœ¨ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿæ ‘ä¸­å¯¹å…¶è¿›è¡Œè®¿é—®ã€‚è¿™é¡¹ä»»åŠ¡éœ€è¦é€šè¿‡ mount ç¨‹åºæ¥å®Œæˆï¼ˆå®ƒä¼šè®©åº•å±‚ç³»ç»Ÿè°ƒç”¨ mount() æ¥å®ŒæˆçœŸæ­£çš„å·¥ä½œï¼‰ã€‚mount ç¨‹åºçš„ä½œç”¨éå¸¸ç®€å•ï¼Œå°±æ˜¯å°†ä¸€ä¸ªç°æœ‰ç›®å½•ä½œä¸ºç›®æ ‡æŒ‚è½½ç‚¹ï¼Œç„¶ååœ¨ç›®å½•æ ‘ä¸Šç²˜è´´ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿã€‚ è¿™é‡Œçš„ä¸€ä¸ªä¾‹å­å¯èƒ½å¾ˆæœ‰ç”¨ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæœªæŒ‚è½½çš„ ext3 æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨åœ¨è®¾å¤‡åˆ†åŒº /dev/sda1ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼šä¸€ä¸ªæ ¹ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå­ç›®å½• a å’Œ bï¼Œæ¯ä¸ªå­ç›®å½•åˆåŒ…å«ä¸€ä¸ªåä¸º foo çš„æ–‡ä»¶ã€‚å‡è®¾æˆ‘ä»¬å¸Œæœ›å°†è¯¥æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°æŒ‚è½½ç‚¹ /home/usersã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·è¾“å…¥ï¼š \u003e mount -t ext3 /dev/sda1 /home/users å¦‚æœæŒ‚è½½æˆåŠŸï¼Œè¿™ä¸ªæ–°æ–‡ä»¶ç³»ç»Ÿå°±å¯ç”¨äº†ã€‚ä¸è¿‡ï¼Œè¯·æ³¨æ„ç°åœ¨è®¿é—®æ–°æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼ã€‚è¦æŸ¥çœ‹æ ¹ç›®å½•çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨ lsï¼š \u003e ls /home/users/ a b å¯ä»¥çœ‹åˆ°ï¼Œè·¯å¾„å /home/users/ ç°åœ¨æŒ‡çš„æ˜¯æ–°æŒ‚è½½ç›®å½•çš„æ ¹ç›®å½•ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ /home/users/a å’Œ /home/users/b è¿™ä¸¤ä¸ªè·¯å¾„åè®¿é—®ç›®å½• a å’Œ bã€‚æœ€åï¼Œå¯ä»¥é€šè¿‡ /home/users/a/foo å’Œ /home/users/b/foo è®¿é—®åä¸º foo çš„æ–‡ä»¶ã€‚è¿™å°±æ˜¯æŒ‚è½½çš„é­…åŠ›æ‰€åœ¨ï¼šæŒ‚è½½å°†æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿç»Ÿä¸€ä¸ºä¸€æ£µæ ‘ï¼Œä½¿å‘½åç»Ÿä¸€ã€æ–¹ä¾¿ï¼Œè€Œä¸æ˜¯æ‹¥æœ‰å¤šä¸ªç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚è¦æŸ¥çœ‹ç³»ç»Ÿä¸ŠæŒ‚è½½äº†å“ªäº›æ–‡ä»¶ï¼Œä»¥åŠæŒ‚è½½åœ¨å“ªäº›ä½ç½®ï¼Œåªéœ€è¿è¡Œmountç¨‹åºå³å¯ã€‚ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š \u003e mount /dev/sda1 on / type ext3 (rw) proc on /proc type proc (rw) sysfs on /sys type sysfs (rw) /dev/sda5 on /tmp type ext3 (rw) /dev/sda7 on /var/vice/cache type ext3 (rw) tmpfs on /dev/shm type tmpfs (rw) AFS on /afs type afs (rw) è¿™ç§ç–¯ç‹‚çš„ç»„åˆè¡¨æ˜æœ‰å¤§é‡ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬ ext3ï¼ˆåŸºäºç£ç›˜çš„æ ‡å‡†æ–‡ä»¶ç³»ç»Ÿï¼‰ã€proc æ–‡ä»¶ç³»ç»Ÿï¼ˆç”¨äºè®¿é—®å½“å‰è¿›ç¨‹ä¿¡æ¯çš„æ–‡ä»¶ç³»ç»Ÿï¼‰ã€tmpfsï¼ˆä»…ç”¨äºä¸´æ—¶æ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿï¼‰ ï¼‰å’Œ AFSï¼ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰éƒ½ç²˜åˆåˆ°è¿™å°æœºå™¨çš„æ–‡ä»¶ç³»ç»Ÿæ ‘ä¸Šã€‚ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:5:0","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 æ€»ç»“ æ–‡ä»¶æ˜¯å¯ä»¥åˆ›å»ºã€è¯»å–ã€å†™å…¥å’Œåˆ é™¤çš„å­—èŠ‚æ•°ç»„ã€‚å®ƒæœ‰ä¸€ä¸ªå”¯ä¸€å¼•ç”¨å®ƒçš„åº•å±‚åç§°ï¼ˆå³numberï¼‰ã€‚æ­¤å±‚åç§°é€šå¸¸ç§°ä¸ºinode numberã€‚ ç›®å½•æ˜¯å…ƒç»„çš„é›†åˆï¼Œæ¯ä¸ªå…ƒç»„éƒ½åŒ…å«ä¸€ä¸ªäººç±»å¯è¯»çš„åç§°åŠå…¶æ˜ å°„åˆ°çš„åº•å±‚åç§°ã€‚æ¯ä¸ªæ¡ç›®è¦ä¹ˆå¼•ç”¨å¦ä¸€ä¸ªç›®å½•ï¼Œè¦ä¹ˆå¼•ç”¨ä¸€ä¸ªæ–‡ä»¶ã€‚æ¯ä¸ªç›®å½•æœ¬èº«ä¹Ÿæœ‰ä¸€ä¸ªåº•å±‚åç§°ï¼ˆinode numberï¼‰ã€‚ç›®å½•æ€»æ˜¯æœ‰ä¸¤ä¸ªç‰¹æ®Šæ¡ç›®ï¼š.æ¡ç›®ï¼ˆå¼•ç”¨è‡ªèº«ï¼‰å’Œ .. æ¡ç›®ï¼ˆå¼•ç”¨å…¶çˆ¶æ¡ç›®ï¼‰ã€‚ ç›®å½•æ ‘æˆ–ç›®å½•å±‚æ¬¡ç»“æ„å°†æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ç»„ç»‡æˆä¸€æ£µå¤§æ ‘ï¼Œä»æ ¹å¼€å§‹ã€‚ è¦è®¿é—®æ–‡ä»¶ï¼Œè¿›ç¨‹å¿…é¡»ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ï¼ˆé€šå¸¸ä¸º open()ï¼‰æ¥è¯·æ±‚æ“ä½œç³»ç»Ÿçš„è®¸å¯ã€‚å¦‚æœæˆäºˆæƒé™ï¼Œæ“ä½œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œç„¶ååœ¨æƒé™å’Œæ„å›¾å…è®¸çš„æƒ…å†µä¸‹ï¼Œè¯¥æ–‡ä»¶æè¿°ç¬¦å¯ç”¨äºè¯»æˆ–å†™è®¿é—®ã€‚ æ¯ä¸ªæ–‡ä»¶æè¿°ç¬¦éƒ½æ˜¯ä¸€ä¸ªç§æœ‰çš„ã€æ¯ä¸ªè¿›ç¨‹çš„å®ä½“ï¼Œå®ƒå¼•ç”¨æ‰“å¼€æ–‡ä»¶è¡¨ä¸­çš„ä¸€ä¸ªæ¡ç›®ã€‚å…¶ä¸­çš„æ¡ç›®è·Ÿè¸ªè¿™æ¬¡è®¿é—®å¼•ç”¨äº†å“ªä¸ªæ–‡ä»¶ã€æ–‡ä»¶çš„å½“å‰åç§»é‡ï¼ˆå³ä¸‹ä¸€æ¬¡è¯»å–æˆ–å†™å…¥å°†è®¿é—®æ–‡ä»¶çš„å“ªä¸€éƒ¨åˆ†ï¼‰ä»¥åŠå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚ è°ƒç”¨read() å’Œwrite() è‡ªç„¶ä¼šæ›´æ–°å½“å‰åç§»é‡ï¼›å¦åˆ™ï¼Œè¿›ç¨‹å¯ä»¥ä½¿ç”¨ lseek() æ¥æ›´æ”¹å…¶å€¼ï¼Œä»è€Œèƒ½å¤Ÿéšæœºè®¿é—®æ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†ã€‚ è¦å¼ºåˆ¶æ›´æ–°æŒä¹…æ€§å­˜å‚¨ï¼Œè¿›ç¨‹å¿…é¡»ä½¿ç”¨fsync() æˆ–ç›¸å…³è°ƒç”¨ã€‚ç„¶è€Œï¼Œåœ¨ä¿æŒé«˜æ€§èƒ½çš„åŒæ—¶æ­£ç¡®æ‰§è¡Œæ­¤æ“ä½œå…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› æ­¤åœ¨æ‰§è¡Œæ­¤æ“ä½œæ—¶è¯·ä»”ç»†è€ƒè™‘ã€‚ è¦ä½¿æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¤šä¸ªäººç±»å¯è¯»åç§°å¼•ç”¨åŒä¸€åŸºç¡€æ–‡ä»¶ï¼Œè¯·ä½¿ç”¨ç¡¬é“¾æ¥æˆ–ç¬¦å·é“¾æ¥ã€‚æ¯ç§æ–¹æ³•åœ¨ä¸åŒçš„æƒ…å†µä¸‹éƒ½æœ‰ç”¨ï¼Œå› æ­¤åœ¨ä½¿ç”¨ä¹‹å‰è¯·è€ƒè™‘å®ƒä»¬çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚è¯·è®°ä½ï¼Œåˆ é™¤æ–‡ä»¶åªæ˜¯ä»ç›®å½•å±‚æ¬¡ç»“æ„ä¸­æ‰§è¡Œæœ€åä¸€æ¬¡unlink() æ“ä½œã€‚ å¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿéƒ½æœ‰å¯ç”¨å’Œç¦ç”¨å…±äº«çš„æœºåˆ¶ã€‚æ­¤ç±»æ§åˆ¶çš„åŸºæœ¬å½¢å¼æ˜¯ç”±æƒé™ä½æä¾›çš„ï¼›æ›´å¤æ‚çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰å¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶è°å¯ä»¥è®¿é—®å’Œæ“ä½œä¿¡æ¯ã€‚ ","date":"2024-05-11","objectID":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/:6:0","tags":["OS"],"title":"æ–‡ä»¶å’Œç›®å½•","uri":"/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¼•è¨€ å½“æˆ‘ä»¬ä½¿ç”¨ç£ç›˜æ—¶ï¼Œ æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›å®ƒæ›´å¿«ï¼› I/O æ“ä½œé€Ÿåº¦å¾ˆæ…¢ï¼Œå› æ­¤å¯èƒ½æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆã€‚ æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›å®ƒæ›´å¤§ï¼›è¶Šæ¥è¶Šå¤šçš„æ•°æ®è¢«æ”¾åˆ°ç½‘ä¸Šï¼Œå› æ­¤æˆ‘ä»¬çš„ç£ç›˜å˜å¾—è¶Šæ¥è¶Šæ»¡ã€‚ æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›å®ƒæ›´åŠ å¯é ï¼›å½“ç£ç›˜å‘ç”Ÿæ•…éšœæ—¶ï¼Œå¦‚æœæˆ‘ä»¬çš„æ•°æ®æ²¡æœ‰å¤‡ä»½ï¼Œæ‰€æœ‰æœ‰ä»·å€¼çš„æ•°æ®éƒ½ä¼šæ¶ˆå¤±ã€‚ æ‰€ä»¥å…³é”®é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬æ€æ ·æ‰èƒ½åˆ¶ä½œå¤§å‹ã€å¿«é€Ÿã€å¯é çš„å­˜å‚¨ç³»ç»Ÿï¼Ÿæœ‰å“ªäº›å…³é”®æŠ€æœ¯ï¼Ÿä¸åŒæ–¹æ³•ä¹‹é—´çš„æƒè¡¡æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—ï¼Œå³ RAIDsï¼Œè¿™æ˜¯ä¸€ç§ååŒä½¿ç”¨å¤šä¸ªç£ç›˜æ¥æ„å»ºæ›´å¿«ã€æ›´å¤§ã€æ›´å¯é çš„ç£ç›˜ç³»ç»Ÿçš„æŠ€æœ¯ã€‚è¯¥æœ¯è¯­æ˜¯ç”±åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„ä¸€ç»„ç ”ç©¶äººå‘˜ï¼ˆç”± David Patterson å’Œ Randy Katz æ•™æˆä»¥åŠå½“æ—¶çš„å­¦ç”Ÿ Garth Gibson é¢†å¯¼ï¼‰äº 20 ä¸–çºª 80 å¹´ä»£æœ«æå‡ºçš„ã€‚å¤§çº¦åœ¨è¿™ä¸ªæ—¶å€™ï¼Œè®¸å¤šä¸åŒçš„ç ”ç©¶äººå‘˜åŒæ—¶å¾—å‡ºäº†ä½¿ç”¨å¤šä¸ªç£ç›˜æ¥æ„å»ºæ›´å¥½çš„å­˜å‚¨ç³»ç»Ÿçš„åŸºæœ¬æ€æƒ³ã€‚ ä»å¤–éƒ¨æ¥çœ‹ï¼ŒRAIDs çœ‹èµ·æ¥åƒä¸€ä¸ªç£ç›˜ï¼šä¸€ç»„å¯ä»¥è¯»å–æˆ–å†™å…¥çš„å—ã€‚åœ¨å†…éƒ¨ï¼ŒRAID æ˜¯ä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿï¼Œç”±å¤šä¸ªç£ç›˜ã€å†…å­˜ï¼ˆæ˜“å¤±æ€§å’Œéæ˜“å¤±æ€§ï¼‰ä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ªç”¨äºç®¡ç†ç³»ç»Ÿçš„å¤„ç†å™¨ç»„æˆã€‚ç¡¬ä»¶ RAID éå¸¸ç±»ä¼¼äºè®¡ç®—æœºç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºç®¡ç†ä¸€ç»„ç£ç›˜çš„ä»»åŠ¡ã€‚ ä¸å•ä¸ªç£ç›˜ç›¸æ¯”ï¼ŒRAID å…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹ã€‚ æ€§èƒ½ã€‚å¹¶è¡Œä½¿ç”¨å¤šä¸ªç£ç›˜å¯ä»¥å¤§å¤§åŠ å¿« I/O æ—¶é—´ã€‚ å®¹é‡ã€‚å¤§æ•°æ®é›†éœ€è¦å¤§ç£ç›˜ã€‚ å¯é æ€§ï¼›å°†æ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªç£ç›˜ä¸Šï¼ˆæ²¡æœ‰ RAID æŠ€æœ¯ï¼‰ä½¿å¾—æ•°æ®å®¹æ˜“å—åˆ°å•ä¸ªç£ç›˜ä¸¢å¤±çš„å½±å“ï¼›é€šè¿‡æŸç§å½¢å¼çš„å†—ä½™ï¼ŒRAID å¯ä»¥å®¹å¿ç£ç›˜ä¸¢å¤±å¹¶ç»§ç»­è¿è¡Œï¼Œå°±åƒæ²¡æœ‰å‘ç”Ÿä»»ä½•é—®é¢˜ä¸€æ ·ã€‚ æç¤ºï¼šé€æ˜æ€§æœ‰åŠ©äºéƒ¨ç½² åœ¨è€ƒè™‘å¦‚ä½•ä¸ºç³»ç»Ÿæ·»åŠ æ–°åŠŸèƒ½æ—¶ï¼Œåº”å§‹ç»ˆè€ƒè™‘èƒ½å¦ä»¥é€æ˜çš„æ–¹å¼æ·»åŠ è¿™äº›åŠŸèƒ½ï¼Œå³ä¸è¦æ±‚æ›´æ”¹ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ã€‚è¦æ±‚å®Œå…¨é‡å†™ç°æœ‰è½¯ä»¶ï¼ˆæˆ–å½»åº•æ”¹å˜ç¡¬ä»¶ï¼‰ä¼šé™ä½æƒ³æ³•äº§ç”Ÿå½±å“çš„å‡ ç‡ã€‚RAID å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå½“ç„¶ï¼Œå®ƒçš„é€æ˜æ€§ä¹Ÿæ˜¯å…¶æˆåŠŸçš„åŸå› ä¹‹ä¸€ï¼›ç®¡ç†å‘˜å¯ä»¥å®‰è£…ä¸€ä¸ªåŸºäº SCSI çš„ RAID å­˜å‚¨é˜µåˆ—ï¼Œè€Œä¸æ˜¯ SCSI ç£ç›˜ï¼Œç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ï¼ˆä¸»æœºã€æ“ä½œç³»ç»Ÿç­‰ï¼‰æ— éœ€åšä»»ä½•æ”¹åŠ¨å³å¯å¼€å§‹ä½¿ç”¨ã€‚é€šè¿‡è§£å†³éƒ¨ç½²é—®é¢˜ï¼ŒRAID ä»ä¸€å¼€å§‹å°±å–å¾—äº†å·¨å¤§æˆåŠŸã€‚ ä»¤äººæƒŠå¥‡çš„æ˜¯ï¼ŒRAID ä¸ºä½¿ç”¨ RAID çš„ç³»ç»Ÿæä¾›äº†é€æ˜çš„ä¼˜åŠ¿ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸»æœºç³»ç»Ÿè€Œè¨€ï¼ŒRAID å°±åƒä¸€ä¸ªå¤§ç£ç›˜ã€‚å½“ç„¶ï¼Œé€æ˜æ€§çš„å¥½å¤„åœ¨äºï¼Œå®ƒä½¿äººä»¬èƒ½å¤Ÿç®€å•åœ°ç”¨ RAID æ›´æ¢ç£ç›˜ï¼Œè€Œæ— éœ€æ›´æ”¹ä»»ä½•è½¯ä»¶ï¼›æ“ä½œç³»ç»Ÿå’Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ— éœ€ä¿®æ”¹å³å¯ç»§ç»­è¿è¡Œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œé€æ˜æ€§å¤§å¤§æé«˜äº† RAID çš„å¯éƒ¨ç½²æ€§ï¼Œä½¿ç”¨æˆ·å’Œç®¡ç†å‘˜åœ¨ä½¿ç”¨ RAID æ—¶ä¸å¿…æ‹…å¿ƒè½¯ä»¶å…¼å®¹æ€§é—®é¢˜ã€‚ æˆ‘ä»¬ç°åœ¨è®¨è®º RAID çš„ä¸€äº›é‡è¦æ–¹é¢ã€‚æˆ‘ä»¬é¦–å…ˆè®¨è®ºæ¥å£å’Œæ•…éšœæ¨¡å‹ï¼Œç„¶åè®¨è®ºå¦‚ä½•ä»å®¹é‡ã€å¯é æ€§å’Œæ€§èƒ½è¿™ä¸‰ä¸ªé‡è¦æ–¹é¢è¯„ä¼° RAID è®¾è®¡ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è®¨è®ºå¯¹ RAID è®¾è®¡å’Œå®æ–½å¾ˆé‡è¦çš„å…¶ä»–ä¸€äº›é—®é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:1:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æ¥å£å’Œ RAID å†…éƒ¨ç»“æ„ å¯¹äºä¸Šé¢çš„æ–‡ä»¶ç³»ç»Ÿæ¥è¯´ï¼ŒRAID çœ‹èµ·æ¥å°±åƒä¸€ä¸ªå¤§çš„ã€ï¼ˆå¸Œæœ›ï¼‰å¿«é€Ÿä¸”ï¼ˆå¸Œæœ›ï¼‰å¯é çš„ç£ç›˜ã€‚å°±åƒå•ä¸ªç£ç›˜ä¸€æ ·ï¼Œå®ƒè¡¨ç°ä¸ºå—çš„çº¿æ€§é˜µåˆ—ï¼Œæ¯ä¸ªå—éƒ½å¯ä»¥ç”±æ–‡ä»¶ç³»ç»Ÿï¼ˆæˆ–å…¶ä»–å®¢æˆ·ç«¯ï¼‰è¯»å–æˆ–å†™å…¥ã€‚ å½“æ–‡ä»¶ç³»ç»Ÿå‘ RAID å‘å‡ºé€»è¾‘ I/O è¯·æ±‚æ—¶ï¼ŒRAID å†…éƒ¨å¿…é¡»è®¡ç®—è¦è®¿é—®å“ªä¸ªç£ç›˜ï¼ˆæˆ–å¤šä¸ªç£ç›˜ï¼‰æ‰èƒ½å®Œæˆè¯·æ±‚ï¼Œç„¶åå‘å‡ºä¸€ä¸ªæˆ–å¤šä¸ªç‰©ç† I/O æ¥å®Œæˆè¯¥è¯·æ±‚ã€‚è¿™äº›ç‰©ç† I/O çš„ç¡®åˆ‡æ€§è´¨å–å†³äº RAID çº§åˆ«ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢è¯¦ç»†è®¨è®ºã€‚ç„¶è€Œï¼Œä½œä¸ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè€ƒè™‘ä¸€ä¸ª RAIDï¼Œå®ƒä¿ç•™æ¯ä¸ªå—çš„ä¸¤ä¸ªå‰¯æœ¬ï¼ˆæ¯ä¸ªå‰¯æœ¬ä½äºä¸€ä¸ªå•ç‹¬çš„ç£ç›˜ä¸Šï¼‰ï¼›å½“å†™å…¥æ­¤ç±»é•œåƒ RAID ç³»ç»Ÿæ—¶ï¼ŒRAID å¿…é¡»ä¸ºå…¶å‘å‡ºçš„æ¯ä¸€ä¸ªé€»è¾‘ I/O æ‰§è¡Œä¸¤æ¬¡ç‰©ç† I/Oã€‚ RAID ç³»ç»Ÿé€šå¸¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¡¬ä»¶ç›’ï¼Œé€šè¿‡æ ‡å‡†è¿æ¥ï¼ˆå¦‚ SCSI æˆ– SATAï¼‰ä¸ä¸»æœºç›¸è¿ã€‚ä¸è¿‡ï¼ŒRAID çš„å†…éƒ¨ç»“æ„ç›¸å½“å¤æ‚ï¼ŒåŒ…æ‹¬ä¸€ä¸ªè¿è¡Œå›ºä»¶çš„å¾®æ§åˆ¶å™¨ï¼Œç”¨äºæŒ‡å¯¼ RAID çš„è¿è¡Œï¼›DRAM ç­‰æ˜“å¤±æ€§å†…å­˜ï¼Œç”¨äºåœ¨æ•°æ®å—è¯»å†™æ—¶å¯¹å…¶è¿›è¡Œç¼“å†²ï¼›åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œéæ˜“å¤±æ€§å†…å­˜ç”¨äºå¯¹å†™å…¥è¿›è¡Œå®‰å…¨ç¼“å†²ï¼›ç”šè‡³å¯èƒ½è¿˜åŒ…æ‹¬ç”¨äºæ‰§è¡Œå¥‡å¶æ ¡éªŒè®¡ç®—çš„ä¸“ç”¨é€»è¾‘ï¼ˆåœ¨æŸäº› RAID çº§åˆ«ä¸­éå¸¸æœ‰ç”¨ï¼Œä¸‹æ–‡å°†è¯¦ç»†ä»‹ç»ï¼‰ã€‚ä»é«˜å±‚æ¬¡æ¥çœ‹ï¼ŒRAID åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ä¸€ç§ä¸“ç”¨è®¡ç®—æœºç³»ç»Ÿï¼šå®ƒæœ‰å¤„ç†å™¨ã€å†…å­˜å’Œç£ç›˜ï¼›ä½†å®ƒè¿è¡Œçš„ä¸æ˜¯åº”ç”¨ç¨‹åºï¼Œè€Œæ˜¯ä¸“é—¨ç”¨äºæ“ä½œ RAID çš„è½¯ä»¶ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:2:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 æ•…éšœæ¨¡å‹ ä¸ºäº†ç†è§£ RAID å¹¶æ¯”è¾ƒä¸åŒçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¿…é¡»æœ‰ä¸€ä¸ªæ•…éšœæ¨¡å‹ã€‚ RAID æ—¨åœ¨æ£€æµ‹æŸäº›ç±»å‹çš„ç£ç›˜æ•…éšœå¹¶ä»ä¸­æ¢å¤ï¼›å› æ­¤ï¼Œå‡†ç¡®åœ°äº†è§£ä¼šå‡ºç°å“ªäº›æ•…éšœå¯¹äºå®ç°å¯è¡Œçš„è®¾è®¡è‡³å…³é‡è¦ã€‚ æˆ‘ä»¬å‡è®¾çš„ç¬¬ä¸€ä¸ªæ•…éšœæ¨¡å‹éå¸¸ç®€å•ï¼Œè¢«ç§°ä¸ºæ•…éšœåœæ­¢æ•…éšœæ¨¡å‹ã€‚åœ¨æ­¤æ¨¡å‹ä¸­ï¼Œç£ç›˜å¯ä»¥æ°å¥½å¤„äºä¸¤ç§çŠ¶æ€ä¹‹ä¸€ï¼šå·¥ä½œæˆ–æ•…éšœã€‚ä½¿ç”¨å·¥ä½œç£ç›˜ï¼Œæ‰€æœ‰å—éƒ½å¯ä»¥è¯»å–æˆ–å†™å…¥ã€‚ç›¸åï¼Œå½“ç£ç›˜å‘ç”Ÿæ•…éšœæ—¶ï¼Œæˆ‘ä»¬å‡è®¾å®ƒæ°¸ä¹…ä¸¢å¤±ã€‚ æ•…éšœåœæ­¢æ¨¡å‹çš„ä¸€ä¸ªå…³é”®æ–¹é¢æ˜¯å®ƒå¯¹æ•…éšœæ£€æµ‹çš„å‡è®¾ã€‚å…·ä½“æ¥è¯´ï¼Œå½“ç£ç›˜å‡ºç°æ•…éšœæ—¶ï¼Œæˆ‘ä»¬å‡è®¾å¾ˆå®¹æ˜“æ£€æµ‹åˆ°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨ RAID é˜µåˆ—ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ RAID æ§åˆ¶å™¨ç¡¬ä»¶ï¼ˆæˆ–è½¯ä»¶ï¼‰å¯ä»¥ç«‹å³è§‚å¯Ÿåˆ°ç£ç›˜å‘ç”Ÿæ•…éšœã€‚ å› æ­¤ï¼Œç›®å‰æˆ‘ä»¬ä¸å¿…æ‹…å¿ƒæ›´å¤æ‚çš„â€œé™é»˜â€æ•…éšœï¼Œä¾‹å¦‚ç£ç›˜æŸåã€‚æˆ‘ä»¬ä¹Ÿä¸å¿…æ‹…å¿ƒå•ä¸ªå—åœ¨å…¶ä»–å·¥ä½œç£ç›˜ä¸Šå˜å¾—æ— æ³•è®¿é—®ï¼ˆæœ‰æ—¶ç§°ä¸ºæ½œåœ¨æ‰‡åŒºé”™è¯¯ï¼‰ã€‚ç¨åæˆ‘ä»¬å°†è€ƒè™‘è¿™äº›æ›´å¤æ‚ï¼ˆä¸å¹¸çš„æ˜¯ï¼Œæ›´ç°å®ï¼‰çš„ç£ç›˜æ•…éšœã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:3:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å¦‚ä½•è¯„ä¼° RAID æ„å»º RAID æœ‰å¤šç§ä¸åŒçš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¸­çš„æ¯ä¸€ç§éƒ½æœ‰ä¸åŒçš„ç‰¹å¾ï¼Œå€¼å¾—è¯„ä¼°ï¼Œä»¥ä¾¿äº†è§£å®ƒä»¬çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚ å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†ä¾æ®ä¸‰ä¸ªæŒ‡æ ‡è¯„ä¼°æ¯ä¸ª RAID è®¾è®¡ã€‚ ç¬¬ä¸€ä¸ªæŒ‡æ ‡æ˜¯å®¹é‡ï¼›ç»™å®šä¸€ç»„ N ä¸ªç£ç›˜ï¼Œæ¯ä¸ªç£ç›˜æœ‰ B ä¸ªå—ï¼ŒRAID å®¢æˆ·ç«¯æœ‰å¤šå°‘å¯ç”¨å®¹é‡ï¼Ÿå¦‚æœæ²¡æœ‰å†—ä½™ï¼Œç­”æ¡ˆæ˜¯$N\\cdot B$ï¼›ç›¸åï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªç³»ç»Ÿä¿ç•™æ¯ä¸ªå—çš„ä¸¤ä¸ªå‰¯æœ¬ï¼ˆç§°ä¸ºé•œåƒï¼‰ï¼Œåˆ™æˆ‘ä»¬è·å¾—çš„æœ‰ç”¨å®¹é‡ä¸º$\\frac{N\\cdot B}{2}$ã€‚ä¸åŒçš„æ–¹æ¡ˆï¼ˆä¾‹å¦‚åŸºäºå¥‡å¶æ ¡éªŒçš„æ–¹æ¡ˆï¼‰å¾€å¾€ä»‹äºä¸¤è€…ä¹‹é—´ã€‚ ç¬¬äºŒä¸ªæŒ‡æ ‡æ˜¯å¯é æ€§ã€‚ç»™å®šçš„è®¾è®¡å¯ä»¥å®¹å¿å¤šå°‘ä¸ªç£ç›˜æ•…éšœï¼Ÿæ ¹æ®æˆ‘ä»¬çš„æ•…éšœæ¨¡å‹ï¼Œæˆ‘ä»¬å‡è®¾åªæœ‰æ•´ä¸ªç£ç›˜å¯èƒ½å‘ç”Ÿæ•…éšœï¼›åœ¨ä¹‹åï¼ˆå³æ•°æ®å®Œæ•´æ€§ï¼‰ï¼Œæˆ‘ä»¬å°†è€ƒè™‘å¦‚ä½•å¤„ç†æ›´å¤æ‚çš„æ•…éšœæ¨¡å¼ã€‚ æœ€åä¸€ä¸ªæŒ‡æ ‡æ˜¯æ€§èƒ½ã€‚è¯„ä¼°æ€§èƒ½æœ‰äº›å›°éš¾ï¼Œå› ä¸ºå®ƒå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç£ç›˜é˜µåˆ—çš„å·¥ä½œè´Ÿè½½ã€‚å› æ­¤ï¼Œåœ¨è¯„ä¼°æ€§èƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å°†é¦–å…ˆä»‹ç»ä¸€ç»„åº”è¯¥è€ƒè™‘çš„å…¸å‹å·¥ä½œè´Ÿè½½ã€‚ æˆ‘ä»¬ç°åœ¨è€ƒè™‘ä¸‰ç§é‡è¦çš„ RAID è®¾è®¡ï¼šRAID Level 0ï¼ˆæ¡å¸¦åŒ–ï¼‰ã€RAID Level 1ï¼ˆé•œåƒï¼‰å’Œ RAID Levels 4/5ï¼ˆåŸºäºå¥‡å¶æ ¡éªŒçš„å†—ä½™ï¼‰ã€‚å°†è¿™äº›è®¾è®¡ä¸­çš„æ¯ä¸€ä¸ªå‘½åä¸ºâ€œlevelâ€æºäºattersonï¼ŒGibsonå’ŒKatzåœ¨ä¼¯å…‹åˆ©çš„å¼€åˆ›æ€§å·¥ä½œã€‚ åœ¨åˆ†æ RAID æ€§èƒ½æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä¸¤ç§ä¸åŒçš„æ€§èƒ½æŒ‡æ ‡ã€‚é¦–å…ˆæ˜¯å•è¯·æ±‚å»¶è¿Ÿã€‚äº†è§£ RAID çš„å•ä¸ª I/O è¯·æ±‚çš„å»¶è¿Ÿéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒæ­ç¤ºäº†å•ä¸ªé€»è¾‘ I/O æ“ä½œæœŸé—´å¯ä»¥å­˜åœ¨å¤šå°‘å¹¶è¡Œæ€§ã€‚ç¬¬äºŒä¸ªæ˜¯ RAID çš„ç¨³æ€ååé‡ï¼Œå³è®¸å¤šå¹¶å‘è¯·æ±‚çš„æ€»å¸¦å®½ã€‚ç”±äº RAID é€šå¸¸ç”¨äºé«˜æ€§èƒ½ç¯å¢ƒï¼Œå› æ­¤ç¨³æ€å¸¦å®½è‡³å…³é‡è¦ï¼Œå› æ­¤å°†æˆä¸ºæˆ‘ä»¬åˆ†æçš„ä¸»è¦ç„¦ç‚¹ã€‚ ä¸ºäº†æ›´è¯¦ç»†åœ°äº†è§£ååé‡ï¼Œæˆ‘ä»¬éœ€è¦æå‡ºä¸€äº›æ„Ÿå…´è¶£çš„å·¥ä½œè´Ÿè½½ã€‚åœ¨æœ¬æ¬¡è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å‡è®¾æœ‰ä¸¤ç§ç±»å‹çš„å·¥ä½œè´Ÿè½½ï¼šé¡ºåºå·¥ä½œè´Ÿè½½å’Œéšæœºå·¥ä½œè´Ÿè½½ã€‚å¯¹äºé¡ºåºå·¥ä½œè´Ÿè½½ï¼Œæˆ‘ä»¬å‡è®¾å¯¹æ•°ç»„çš„è¯·æ±‚æ¥è‡ªå¤§çš„è¿ç»­å—ï¼›ä¾‹å¦‚ï¼Œè®¿é—® 1 MB æ•°æ®çš„è¯·æ±‚ï¼ˆæˆ–ä¸€ç³»åˆ—è¯·æ±‚ï¼‰ï¼Œä»å— $x$ å¼€å§‹åˆ°å— ($x+1$ MB) ç»“æŸï¼Œå°†è¢«è§†ä¸ºè¿ç»­çš„ã€‚é¡ºåºå·¥ä½œè´Ÿè½½åœ¨è®¸å¤šç¯å¢ƒä¸­éƒ½å¾ˆå¸¸è§ï¼ˆæƒ³è±¡ä¸€ä¸‹åœ¨å¤§æ–‡ä»¶ä¸­æœç´¢å…³é”®å­—ï¼‰ï¼Œå› æ­¤è¢«è®¤ä¸ºå¾ˆé‡è¦ã€‚ å¯¹äºéšæœºå·¥ä½œè´Ÿè½½ï¼Œæˆ‘ä»¬å‡è®¾æ¯ä¸ªè¯·æ±‚éƒ½ç›¸å½“å°ï¼Œå¹¶ä¸”æ¯ä¸ªè¯·æ±‚éƒ½å‘é€åˆ°ç£ç›˜ä¸Šä¸åŒçš„éšæœºä½ç½®ã€‚ä¾‹å¦‚ï¼Œéšæœºè¯·æ±‚æµå¯èƒ½é¦–å…ˆè®¿é—®é€»è¾‘åœ°å€ 10 å¤„çš„ 4KBï¼Œç„¶åè®¿é—®é€»è¾‘åœ°å€ 550,000ï¼Œç„¶åè®¿é—® 20,100ï¼Œç­‰ç­‰ã€‚ä¸€äº›é‡è¦çš„å·¥ä½œè´Ÿè½½ï¼Œä¾‹å¦‚æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ (DBMS) ä¸Šçš„äº‹åŠ¡å·¥ä½œè´Ÿè½½ï¼Œè¡¨ç°å‡ºè¿™ç§ç±»å‹çš„è®¿é—®æ¨¡å¼ï¼Œå› æ­¤å®ƒè¢«è®¤ä¸ºæ˜¯é‡è¦çš„å·¥ä½œè´Ÿè½½ã€‚ å½“ç„¶ï¼ŒçœŸæ­£çš„å·¥ä½œè´Ÿè½½å¹¶ä¸é‚£ä¹ˆç®€å•ï¼Œå¹¶ä¸”é€šå¸¸æ··åˆäº†é¡ºåºå’Œçœ‹ä¼¼éšæœºçš„ç»„ä»¶ä»¥åŠä¸¤è€…ä¹‹é—´çš„è¡Œä¸ºã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬åªè€ƒè™‘è¿™ä¸¤ç§å¯èƒ½æ€§ã€‚ æ­£å¦‚æ‚¨æ‰€çŸ¥ï¼Œé¡ºåºå’Œéšæœºå·¥ä½œè´Ÿè½½å°†å¯¼è‡´ç£ç›˜çš„æ€§èƒ½ç‰¹å¾å­˜åœ¨å¾ˆå¤§å·®å¼‚ã€‚é€šè¿‡é¡ºåºè®¿é—®ï¼Œç£ç›˜ä»¥å…¶æœ€æœ‰æ•ˆçš„æ¨¡å¼è¿è¡Œï¼ŒèŠ±è´¹å¾ˆå°‘çš„æ—¶é—´å¯»é“å’Œç­‰å¾…æ—‹è½¬ï¼Œè€Œå¤§éƒ¨åˆ†æ—¶é—´ç”¨äºä¼ è¾“æ•°æ®ã€‚å¯¹äºéšæœºè®¿é—®ï¼Œæƒ…å†µæ°æ°ç›¸åï¼šå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨å¯»é“å’Œç­‰å¾…æ—‹è½¬ä¸Šï¼Œè€ŒèŠ±åœ¨ä¼ è¾“æ•°æ®ä¸Šçš„æ—¶é—´ç›¸å¯¹è¾ƒå°‘ã€‚ä¸ºäº†åœ¨æˆ‘ä»¬çš„åˆ†æä¸­æ•æ‰åˆ°è¿™ç§å·®å¼‚ï¼Œæˆ‘ä»¬å‡è®¾ç£ç›˜åœ¨é¡ºåºå·¥ä½œè´Ÿè½½ä¸‹å¯ä»¥ä»¥ $S\\text{ MB/s}$ çš„é€Ÿåº¦ä¼ è¾“æ•°æ®ï¼Œåœ¨éšæœºå·¥ä½œè´Ÿè½½ä¸‹å¯ä»¥ä»¥$R\\text{ MB/s}$çš„é€Ÿåº¦ä¼ è¾“æ•°æ®ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒS è¿œå¤§äº Rï¼ˆå³ S â‰« Rï¼‰ã€‚ ä¸ºäº†ç¡®ä¿æˆ‘ä»¬ç†è§£è¿™ç§å·®å¼‚ï¼Œè®©æˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„ç»ƒä¹ ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬æ ¹æ®ä»¥ä¸‹ç£ç›˜ç‰¹æ€§æ¥è®¡ç®— S å’Œ Rã€‚å‡è®¾é¡ºåºä¼ è¾“å¹³å‡å¤§å°ä¸º 10 MBï¼Œéšæœºä¼ è¾“å¹³å‡å¤§å°ä¸º 10 KBã€‚ å¦å¤–ï¼Œå‡è®¾ä»¥ä¸‹ç£ç›˜ç‰¹æ€§ï¼š å¹³å‡å¯»é“æ—¶é—´ 7 ms å¹³å‡æ—‹è½¬å»¶è¿Ÿ 3 ms ç£ç›˜ä¼ è¾“é€Ÿç‡ 50 MB/s ä¸ºäº†è®¡ç®— Sï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆè®¡ç®—å‡ºå…¸å‹çš„ 10 MB ä¼ è¾“æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬èŠ±è´¹ 7 æ¯«ç§’è¿›è¡Œå¯»é“ï¼Œç„¶åèŠ±è´¹ 3 æ¯«ç§’è¿›è¡Œæ—‹è½¬ã€‚æœ€åï¼Œä¼ è¾“å¼€å§‹ï¼›$\\frac{10\\text{ MB}}{50\\text{ MB/s}}$ å¯¼è‡´ä¼ è¾“æ—¶é—´ä¸º $\\frac{1}{5}s$ï¼Œå³ 200 æ¯«ç§’ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ª 10 MB è¯·æ±‚ï¼Œæˆ‘ä»¬èŠ±è´¹ 210 æ¯«ç§’å®Œæˆè¯·æ±‚ã€‚è¦è®¡ç®— Sï¼Œæˆ‘ä»¬åªéœ€ï¼š $$ S=\\frac{\\text{Amount of Data}}{\\text{Time to access}}=\\frac{10\\text{ MB}}{210ms}=47.62\\text{ MB/s} $$ æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œç”±äºä¼ è¾“æ•°æ®èŠ±è´¹å¤§é‡æ—¶é—´ï¼ŒS éå¸¸æ¥è¿‘ç£ç›˜çš„å³°å€¼å¸¦å®½ï¼ˆå¯»é“å’Œæ—‹è½¬æˆæœ¬å·²æ‘Šé”€ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥ç±»ä¼¼åœ°è®¡ç®— Rã€‚å¯»é“å’Œæ—‹è½¬æ˜¯ä¸€æ ·çš„ï¼›ç„¶åæˆ‘ä»¬è®¡ç®—ä¼ è¾“æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå³$\\frac{10\\text{ KB}}{50\\text{ MB/s}}$ ï¼Œå³ 0.195 æ¯«ç§’ã€‚ $$ R=\\frac{\\text{Amount of Data}}{\\text{Time to access}}=\\frac{10\\text{ KB}}{10ms+0.195ms}=0.981\\text{ MB/s} $$ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒR å°äº 1 MB/sï¼ŒS/R æ¥è¿‘ 50 MB/s ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:4:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 RAID Level 0ï¼šæ¡å¸¦åŒ– ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:5:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.1 åŸºæœ¬ä»‹ç» ç¬¬ä¸€ä¸ª RAID Levelå®é™…ä¸Šæ ¹æœ¬ä¸æ˜¯ RAID Levelï¼Œå› ä¸ºæ²¡æœ‰å†—ä½™ã€‚ä¸è¿‡ï¼ŒRAID Levelï¼ˆæˆ–ç§°æ¡å¸¦åŒ–ï¼‰æ˜¯æ€§èƒ½å’Œå®¹é‡çš„ç»ä½³ä¸Šé™ï¼Œå› æ­¤å€¼å¾—äº†è§£ã€‚ æœ€ç®€å•çš„æ¡å¸¦åŒ–å½¢å¼æ˜¯åœ¨ç³»ç»Ÿç£ç›˜ä¸Šå¯¹æ•°æ®å—è¿›è¡Œæ¡å¸¦åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆè¿™é‡Œå‡è®¾æœ‰ 4 ä¸ªç£ç›˜é˜µåˆ—ï¼‰ï¼š ä»ä¸Šè¡¨ä¸­ï¼Œä½ å¯ä»¥äº†è§£åˆ°åŸºæœ¬æ¦‚å¿µï¼šå°†ç£ç›˜é˜µåˆ—çš„æ•°æ®å—ä»¥å¾ªç¯æ–¹å¼åˆ†å¸ƒåœ¨ç£ç›˜ä¸Šã€‚è¿™ç§æ–¹æ³•çš„è®¾è®¡ç›®çš„æ˜¯åœ¨è¯·æ±‚è¿ç»­çš„ç£ç›˜é˜µåˆ—å—æ—¶ï¼Œä»ç£ç›˜é˜µåˆ—ä¸­æå–æœ€å¤§çš„å¹¶è¡Œæ€§ï¼ˆä¾‹å¦‚ï¼Œåœ¨å¤§çš„é¡ºåºè¯»å–ä¸­ï¼‰ã€‚æˆ‘ä»¬å°†åŒä¸€è¡Œä¸­çš„å—ç§°ä¸ºä¸€ä¸ªæ¡å¸¦ï¼›å› æ­¤ï¼Œå— 0ã€1ã€2 å’Œ 3 ä½äºä¸Šè¿°åŒä¸€æ¡å¸¦ä¸­ã€‚ åœ¨ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åšäº†ä¸€ä¸ªç®€åŒ–å‡è®¾ï¼Œå³åœ¨ç§»åŠ¨ä¸‹ä¸€ä¸ªç£ç›˜ä¹‹å‰ï¼Œæ¯ä¸ªç£ç›˜ä¸Šåªæ”¾ç½®ä¸€ä¸ªå—ï¼ˆæ¯ä¸ªå—çš„å¤§å°ä¸º 4KBï¼‰ã€‚ç„¶è€Œï¼Œè¿™ç§å®‰æ’å¹¶ä¸ä¸€å®šæ˜¯å¿…é¡»çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å—è·¨è¶Šå¤šä¸ªç£ç›˜è¿›è¡Œæ’åˆ—ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªç£ç›˜ä¸Šæ”¾ç½®ä¸¤ä¸ª 4KB çš„æ•°æ®å—ï¼Œç„¶åå†ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç£ç›˜ã€‚å› æ­¤ï¼Œè¯¥ RAID é˜µåˆ—çš„æ•°æ®å—å¤§å°ä¸º 8KBï¼Œä¸€ä¸ªç£æ¡ç”± 4 ä¸ªæ•°æ®å—æˆ– 32KB çš„æ•°æ®ç»„æˆã€‚ RAID æ˜ å°„é—®é¢˜ åœ¨ç ”ç©¶ RAID çš„å®¹é‡ã€å¯é æ€§å’Œæ€§èƒ½ç‰¹å¾ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€ä¸‹æ‰€è°“çš„æ˜ å°„é—®é¢˜ã€‚æ‰€æœ‰RAIDé˜µåˆ—éƒ½ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼›ç®€è€Œè¨€ä¹‹ï¼Œç»™å®šä¸€ä¸ªè¦è¯»å–æˆ–å†™å…¥çš„é€»è¾‘å—ï¼ŒRAID å¦‚ä½•å‡†ç¡®åœ°çŸ¥é“è¦è®¿é—®å“ªä¸ªç‰©ç†ç£ç›˜å’Œåç§»é‡ï¼Ÿ å¯¹äºè¿™äº›ç®€å•çš„ RAID levelsï¼Œæˆ‘ä»¬ä¸éœ€è¦å¤ªå¤æ‚å°±èƒ½å°†é€»è¾‘å—æ­£ç¡®æ˜ å°„åˆ°å…¶ç‰©ç†ä½ç½®ã€‚ä»¥ä¸Šé¢çš„ç¬¬ä¸€ä¸ªæ¡å¸¦åŒ–ç¤ºä¾‹ä¸ºä¾‹ï¼ˆå—å¤§å°=1ï¼Œæ•°æ®å— = 4KBï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç»™å®šé€»è¾‘å—åœ°å€ Aï¼ŒRAID å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªç®€å•çš„æ–¹ç¨‹è½»æ¾è®¡ç®—æ‰€éœ€çš„ç£ç›˜å’Œåç§»é‡ï¼š Disk = A % number_of_disks Offset = A / number_of_disks è¯·æ³¨æ„ï¼Œè¿™äº›éƒ½æ˜¯æ•´æ•°è¿ç®—ï¼ˆä¾‹å¦‚ï¼Œ4 / 3 = 1 è€Œä¸æ˜¯ 1.33333â€¦ï¼‰ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹è¿™äº›æ–¹ç¨‹æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸Šé¢çš„ç¬¬ä¸€ä¸ª RAID ä¸­ï¼Œå— 14 çš„è¯·æ±‚åˆ°è¾¾ã€‚å‡è®¾æœ‰ 4 ä¸ªç£ç›˜ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç£ç›˜æ˜¯ (14 % 4 = 2)ï¼šç£ç›˜ 2ã€‚ç¡®åˆ‡çš„å—è®¡ç®—å…¬å¼ä¸ºï¼š ï¼ˆ14 / 4 = 3)ï¼šå—3ã€‚å› æ­¤ï¼Œå—14åº”è¯¥åœ¨ç¬¬ä¸‰ä¸ªç£ç›˜ï¼ˆç£ç›˜2ï¼Œä»0å¼€å§‹ï¼‰çš„ç¬¬å››ä¸ªå—ï¼ˆå—3ï¼Œä»0å¼€å§‹ï¼‰ä¸Šæ‰¾åˆ°ï¼Œè¿™æ­£æ˜¯å®ƒæ‰€åœ¨çš„ä½ç½®ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:5:1","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.2 å—å¤§å° å—å¤§å°ä¸»è¦å½±å“é˜µåˆ—çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œè¾ƒå°çš„å—å¤§å°æ„å‘³ç€è®¸å¤šæ–‡ä»¶å°†åœ¨è®¸å¤šç£ç›˜ä¸Šè¿›è¡Œæ¡å¸¦åŒ–ï¼Œä»è€Œæé«˜å•ä¸ªæ–‡ä»¶è¯»å†™çš„å¹¶è¡Œæ€§ï¼›ç„¶è€Œï¼Œè·¨å¤šä¸ªç£ç›˜è®¿é—®å—çš„å®šä½æ—¶é—´ä¼šå¢åŠ ï¼Œå› ä¸ºæ•´ä¸ªè¯·æ±‚çš„å®šä½æ—¶é—´ç”±è·¨æ‰€æœ‰é©±åŠ¨å™¨çš„è¯·æ±‚å®šä½æ—¶é—´çš„æœ€å¤§å€¼å†³å®šã€‚ å¦ä¸€æ–¹é¢ï¼Œå¤§çš„å—å¤§å°ä¼šé™ä½è¿™ç§æ–‡ä»¶å†…å¹¶è¡Œæ€§ï¼Œä»è€Œä¾èµ–å¤šä¸ªå¹¶å‘è¯·æ±‚æ¥å®ç°é«˜ååé‡ã€‚ç„¶è€Œï¼Œå¤§çš„å—å¤§å°ä¼šå‡å°‘å®šä½æ—¶é—´ï¼›ä¾‹å¦‚ï¼Œå¦‚æœå•ä¸ªæ–‡ä»¶é€‚åˆä¸€ä¸ªå—å¹¶å› æ­¤è¢«æ”¾ç½®åœ¨å•ä¸ªç£ç›˜ä¸Šï¼Œåˆ™è®¿é—®å®ƒæ—¶äº§ç”Ÿçš„å®šä½æ—¶é—´å°†åªæ˜¯å•ä¸ªç£ç›˜çš„å®šä½æ—¶é—´ã€‚ å› æ­¤ï¼Œç¡®å®šâ€œæœ€ä½³â€å—å¤§å°å¾ˆéš¾ï¼Œå› ä¸ºå®ƒéœ€è¦å¤§é‡æœ‰å…³ç£ç›˜ç³»ç»Ÿçš„å·¥ä½œè´Ÿè½½çš„çŸ¥è¯†ã€‚å¯¹äºæœ¬æ¬¡è®¨è®ºçš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å‡è®¾æ•°ç»„ä½¿ç”¨å•ä¸ªå— (4KB) çš„å—å¤§å°ã€‚å¤§å¤šæ•°æ•°ç»„ä½¿ç”¨è¾ƒå¤§çš„å—å¤§å°ï¼ˆä¾‹å¦‚ 64 KBï¼‰ï¼Œä½†å¯¹äºæˆ‘ä»¬ä¸‹é¢è®¨è®ºçš„é—®é¢˜ï¼Œç¡®åˆ‡çš„å—å¤§å°å¹¶ä¸é‡è¦ï¼›å› æ­¤ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨å•ä¸ªå—ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:5:2","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.3 è¯„ä¼° æ¡å¸¦åŒ– ç°åœ¨è®©æˆ‘ä»¬æ¥è¯„ä¼°æ¡å¸¦åŒ–çš„å®¹é‡ã€å¯é æ€§å’Œæ€§èƒ½ã€‚ä»å®¹é‡çš„è§’åº¦æ¥çœ‹ï¼Œæ¡å¸¦åŒ–æ˜¯å®Œç¾çš„ï¼šç»™å®š N å—ç£ç›˜ï¼Œæ¯å—ç£ç›˜çš„å¤§å°ä¸º B å—ï¼Œæ¡å¸¦åŒ–å°±èƒ½æä¾›$N\\cdot B$ ä¸ªæœ‰ç”¨å®¹é‡å®¹é‡å—ã€‚ä»å¯é æ€§çš„è§’åº¦æ¥çœ‹ï¼Œæ¡å¸¦åŒ–ä¹Ÿæ˜¯å®Œç¾çš„ï¼Œä½†ä¹Ÿæ˜¯ç³Ÿç³•çš„ï¼šä»»ä½•ç£ç›˜æ•…éšœéƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ æœ€åï¼Œæ€§èƒ½ä¹Ÿéå¸¸å‡ºè‰²ï¼šæ‰€æœ‰ç£ç›˜éƒ½èƒ½åˆ©ç”¨ï¼Œè€Œä¸”å¾€å¾€æ˜¯å¹¶è¡Œåˆ©ç”¨ï¼Œä¸ºç”¨æˆ·çš„ I/O è¯·æ±‚æä¾›æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œä»å»¶è¿Ÿçš„è§’åº¦æ¥çœ‹ï¼Œå•å—è¯·æ±‚çš„å»¶è¿Ÿåº”ä¸å•ä¸ªç£ç›˜çš„å»¶è¿ŸåŸºæœ¬ç›¸åŒï¼›æ¯•ç«Ÿ RAID-0 åªéœ€å°†è¯¥è¯·æ±‚é‡å®šå‘åˆ°å…¶ä¸­ä¸€ä¸ªç£ç›˜å³å¯ã€‚ä»ç¨³æ€ååé‡çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å¸Œæœ›è·å¾—ç³»ç»Ÿçš„å…¨éƒ¨å¸¦å®½ã€‚å› æ­¤ï¼Œååé‡ç­‰äº Nï¼ˆç£ç›˜æ•°é‡ï¼‰ä¹˜ä»¥ Sï¼ˆå•ä¸ªç£ç›˜çš„è¿ç»­å¸¦å®½ï¼‰ã€‚å¯¹äºå¤§é‡éšæœº I/Oï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡ä½¿ç”¨æ‰€æœ‰ç£ç›˜ï¼Œä»è€Œè·å¾— $N\\cdot R$MB/sã€‚æˆ‘ä»¬å°†åœ¨ä¸‹æ–‡ä¸­çœ‹åˆ°ï¼Œè¿™äº›å€¼æ—¢æ˜¯æœ€ç®€å•çš„è®¡ç®—å€¼ï¼Œä¹Ÿæ˜¯ä¸å…¶ä»– RAID levelsç›¸æ¯”çš„ä¸Šé™ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:5:3","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 RAID Level 1ï¼šé•œåƒ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:6:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.1 åŸºæœ¬ä»‹ç» é™¤æ¡å¸¦åŒ–ä¹‹å¤–ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª RAID Levelç§°ä¸º RAID Level 1ï¼Œæˆ–é•œåƒã€‚åœ¨é•œåƒç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬åªéœ€ä¸ºç³»ç»Ÿä¸­çš„æ¯ä¸ªæ•°æ®å—åˆ¶ä½œä¸€ä¸ªä»¥ä¸Šçš„å‰¯æœ¬ï¼›å½“ç„¶ï¼Œæ¯ä¸ªå‰¯æœ¬éƒ½åº”æ”¾ç½®åœ¨å•ç‹¬çš„ç£ç›˜ä¸Šã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿ç£ç›˜æ•…éšœã€‚ åœ¨å…¸å‹çš„é•œåƒç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å‡è®¾ RAID ä¼šä¸ºæ¯ä¸ªé€»è¾‘å—ä¿ç•™ä¸¤ä¸ªç‰©ç†å‰¯æœ¬ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š åœ¨ç¤ºä¾‹ä¸­ï¼Œç£ç›˜ 0 å’Œç£ç›˜ 1 çš„å†…å®¹å®Œå…¨ç›¸åŒï¼Œç£ç›˜ 2 å’Œç£ç›˜ 3 çš„å†…å®¹ä¹Ÿå®Œå…¨ç›¸åŒï¼›æ•°æ®åœ¨è¿™äº›é•œåƒå¯¹ä¸­è¿›è¡Œæ¡å¸¦åŒ–å¤„ç†ã€‚äº‹å®ä¸Šï¼Œä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œåœ¨ç£ç›˜ä¸Šæ”¾ç½®å—æ‹·è´æœ‰å¤šç§ä¸åŒçš„æ–¹æ³•ã€‚ä¸Šé¢çš„æ’åˆ—æ–¹å¼å¾ˆå¸¸è§ï¼Œæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º RAID-10 æˆ–ï¼ˆRAID 1+0ï¼‰ï¼Œå› ä¸ºå®ƒä½¿ç”¨é•œåƒå¯¹ï¼ˆRAID-1ï¼‰ï¼Œç„¶ååœ¨å…¶ä¸Šä½¿ç”¨æ¡å¸¦ï¼ˆRAID-0ï¼‰ï¼›å¦ä¸€ç§å¸¸è§çš„æ’åˆ—æ–¹å¼æ˜¯ RAID-01ï¼ˆæˆ– RAID 0+1ï¼‰ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªå¤§å‹æ¡å¸¦ï¼ˆRAID-0ï¼‰é˜µåˆ—ï¼Œç„¶ååœ¨å…¶ä¸Šä½¿ç”¨é•œåƒï¼ˆRAID-1ï¼‰ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬åªè®¨è®ºå‡è®¾ä¸Šè¿°å¸ƒå±€çš„é•œåƒã€‚ ä»é•œåƒé˜µåˆ—è¯»å–æ•°æ®å—æ—¶ï¼ŒRAID æœ‰ä¸€ä¸ªé€‰æ‹©ï¼šå¯ä»¥è¯»å–ä»»ä¸€å‰¯æœ¬ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå‘ RAID å‘å‡ºè¯»å–é€»è¾‘å— 5 çš„å‘½ä»¤ï¼ŒRAID å¯ä»¥è‡ªç”±é€‰æ‹©ä»ç£ç›˜ 2 æˆ–ç£ç›˜ 3 è¯»å–ã€‚ä½†åœ¨å†™å…¥é€»è¾‘å—æ—¶ï¼Œå°±æ²¡æœ‰è¿™æ ·çš„é€‰æ‹©äº†ï¼šRAID å¿…é¡»æ›´æ–°æ•°æ®çš„ä¸¤ä¸ªå‰¯æœ¬ï¼Œä»¥ä¿æŒå¯é æ€§ã€‚ä½†è¯·æ³¨æ„ï¼Œè¿™äº›å†™å…¥å¯ä»¥å¹¶è¡Œè¿›è¡Œï¼›ä¾‹å¦‚ï¼Œå¯¹é€»è¾‘å— 5 çš„å†™å…¥å¯ä»¥åŒæ—¶å†™å…¥ç£ç›˜ 2 å’Œç£ç›˜ 3ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:6:1","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.2 RAID-1åˆ†æ è®©æˆ‘ä»¬è¯„ä¼°ä¸€ä¸‹ RAID-1ã€‚ ä»å®¹é‡çš„è§’åº¦æ¥çœ‹ï¼ŒRAID-1 æ˜¯æ˜‚è´µçš„ï¼›é•œåƒçº§åˆ« = 2 æ—¶ï¼Œæˆ‘ä»¬åªèƒ½è·å¾—å³°å€¼æœ‰ç”¨å®¹é‡çš„ä¸€åŠã€‚åœ¨ N å—ç£ç›˜ä¸Šæœ‰ B ä¸ªæ•°æ®å—æ—¶ï¼ŒRAID-1 çš„æœ‰ç”¨å®¹é‡ä¸º $\\frac{N\\cdot B}{2}$ã€‚ ä»å¯é æ€§çš„è§’åº¦æ¥çœ‹ï¼ŒRAID-1 è¡¨ç°å‡ºè‰²ã€‚å®ƒå¯ä»¥æ‰¿å—ä»»ä½•ä¸€å—ç£ç›˜çš„æ•…éšœã€‚å¦‚æœè¿æ°”å¥½çš„è¯ï¼ŒRAID-1 è¿˜èƒ½åšå¾—æ›´å¥½ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸Šå›¾ä¸­ï¼Œç£ç›˜ 0 å’Œç£ç›˜ 2 åŒæ—¶å‘ç”Ÿæ•…éšœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±ï¼ä¸€èˆ¬æ¥è¯´ï¼Œé•œåƒç³»ç»Ÿï¼ˆé•œåƒçº§åˆ«ä¸º 2ï¼‰å¯ä»¥æ‰¿å— 1 ä¸ªç£ç›˜çš„æ•…éšœï¼Œæœ€å¤šå¯ä»¥æ‰¿å— $\\frac{N}{2}$ ä¸ªç£ç›˜çš„æ•…éšœï¼Œå…·ä½“å–å†³äºå“ªäº›ç£ç›˜å‘ç”Ÿæ•…éšœã€‚åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸å–œæ¬¢å¬å¤©ç”±å‘½ï¼Œå› æ­¤å¤§å¤šæ•°äººè®¤ä¸ºé•œåƒå¯ä»¥å¾ˆå¥½åœ°å¤„ç†å•ä¸ªæ•…éšœã€‚ æœ€åï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹æ€§èƒ½ã€‚ä»å•ä¸ªè¯»å–è¯·æ±‚çš„å»¶è¿Ÿè§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä¸å•ä¸ªç£ç›˜çš„å»¶è¿Ÿç›¸åŒï¼›RAID-1 æ‰€åšçš„åªæ˜¯å°†è¯»å–æŒ‡å‘å…¶ä¸­ä¸€ä¸ªå‰¯æœ¬ã€‚å†™å…¥åˆ™ç•¥æœ‰ä¸åŒï¼šå®ƒéœ€è¦ä¸¤æ¬¡ç‰©ç†å†™å…¥æ‰èƒ½å®Œæˆã€‚è¿™ä¸¤æ¬¡å†™å…¥æ˜¯å¹¶è¡Œè¿›è¡Œçš„ï¼Œå› æ­¤æ—¶é—´ä¸å•ä¸ªå†™å…¥çš„æ—¶é—´å¤§è‡´ç›¸åŒï¼›ä½†æ˜¯ï¼Œç”±äºé€»è¾‘å†™å…¥å¿…é¡»ç­‰å¾…ä¸¤æ¬¡ç‰©ç†å†™å…¥å®Œæˆï¼Œå› æ­¤ä¼šå—åˆ°ä¸¤ä¸ªè¯·æ±‚ä¸­æœ€åæƒ…å†µä¸‹çš„å¯»é“å’Œæ—‹è½¬å»¶è¿Ÿï¼Œå› æ­¤ï¼ˆå¹³å‡è€Œè¨€ï¼‰ä¼šç•¥é«˜äºå†™å…¥å•ä¸ªç£ç›˜çš„æ—¶é—´ã€‚ RAID ä¸€è‡´æ€§æ›´æ–°é—®é¢˜ åœ¨åˆ†æ RAID-1 ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆè®¨è®ºä»»ä½•å¤šç£ç›˜ RAID ç³»ç»Ÿä¸­éƒ½ä¼šå‡ºç°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå³ä¸€è‡´æ€§æ›´æ–°é—®é¢˜ ã€‚å†™å…¥ä»»ä½•å¿…é¡»åœ¨å•ä¸ªé€»è¾‘æ“ä½œæœŸé—´æ›´æ–°å¤šä¸ªç£ç›˜çš„ RAID æ—¶éƒ½ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨è€ƒè™‘é•œåƒç£ç›˜é˜µåˆ—ã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œå‘ RAID å‘å‡ºå†™æ“ä½œï¼Œç„¶å RAID å†³å®šå¿…é¡»å°†å…¶å†™å…¥ä¸¤ä¸ªç£ç›˜ï¼Œå³ç£ç›˜ 0 å’Œç£ç›˜ 1ã€‚ç„¶åï¼ŒRAID å‘ç£ç›˜ 0 å‘å‡ºå†™æ“ä½œï¼Œä½†å°±åœ¨ RAID å¯ä»¥å‘ç£ç›˜å‘å‡ºè¯·æ±‚ä¹‹å‰1ã€å‘ç”Ÿæ–­ç”µï¼ˆæˆ–ç³»ç»Ÿå´©æºƒï¼‰ã€‚åœ¨è¿™ç§ä¸å¹¸çš„æƒ…å†µä¸‹ï¼Œè®©æˆ‘ä»¬å‡è®¾å¯¹ç£ç›˜ 0 çš„è¯·æ±‚å·²å®Œæˆï¼ˆä½†æ˜¾ç„¶å¯¹ç£ç›˜ 1 çš„è¯·æ±‚æ²¡æœ‰å®Œæˆï¼Œå› ä¸ºå®ƒä»æœªå‘å‡ºï¼‰ã€‚ è¿™ç§è¿‡æ—©æ–­ç”µçš„ç»“æœæ˜¯è¯¥å—çš„ä¸¤ä¸ªå‰¯æœ¬ç°åœ¨ä¸ä¸€è‡´ï¼›ç£ç›˜ 0 ä¸Šçš„å‰¯æœ¬æ˜¯æ–°ç‰ˆæœ¬ï¼Œç£ç›˜ 1 ä¸Šçš„å‰¯æœ¬æ˜¯æ—§ç‰ˆæœ¬ã€‚æˆ‘ä»¬å¸Œæœ›å‘ç”Ÿçš„æ˜¯ä¸¤ä¸ªç£ç›˜çš„çŠ¶æ€éƒ½ä»¥åŸå­æ–¹å¼æ”¹å˜ï¼Œå³ï¼Œè¦ä¹ˆä¸¤ä¸ªç£ç›˜æœ€ç»ˆéƒ½æˆä¸ºæ–°ç‰ˆæœ¬ï¼Œè¦ä¹ˆéƒ½ä¸æˆä¸ºæ–°ç‰ˆæœ¬ã€‚ è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€èˆ¬æ–¹æ³•æ˜¯åœ¨æ‰§è¡Œä¹‹å‰ä½¿ç”¨æŸç§é¢„å†™æ—¥å¿—é¦–å…ˆè®°å½• RAID å°†è¦æ‰§è¡Œçš„æ“ä½œï¼ˆå³ç”¨æŸæ¡æ•°æ®æ›´æ–°ä¸¤ä¸ªç£ç›˜ï¼‰ã€‚é€šè¿‡é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿åœ¨å‘ç”Ÿå´©æºƒæ—¶ï¼Œä¼šå‘ç”Ÿæ­£ç¡®çš„äº‹æƒ…ï¼›é€šè¿‡è¿è¡Œå°†æ‰€æœ‰å¾…å¤„ç†äº‹åŠ¡é‡æ’­åˆ° RAID çš„æ¢å¤è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿æ²¡æœ‰ä¸¤ä¸ªé•œåƒå‰¯æœ¬ï¼ˆåœ¨ RAID-1 æƒ…å†µä¸‹ï¼‰ä¸åŒæ­¥ã€‚ æœ€åä¸€ç‚¹ï¼šç”±äºæ¯æ¬¡å†™å…¥æ—¶è®°å½•åˆ°ç£ç›˜çš„æˆæœ¬éå¸¸æ˜‚è´µï¼Œå› æ­¤å¤§å¤šæ•° RAID ç¡¬ä»¶éƒ½åŒ…å«å°‘é‡éæ˜“å¤±æ€§ RAMï¼ˆä¾‹å¦‚ï¼Œç”µæ± ä¾›ç”µçš„ RAMï¼‰ï¼Œç”¨äºæ‰§è¡Œæ­¤ç±»è®°å½•ã€‚å› æ­¤ï¼Œæ— éœ€èŠ±è´¹é«˜æ˜‚çš„æ—¥å¿—è®°å½•åˆ°ç£ç›˜çš„æˆæœ¬å³å¯æä¾›ä¸€è‡´çš„æ›´æ–°ã€‚ ä¸ºäº†åˆ†æç¨³æ€ååé‡ï¼Œæˆ‘ä»¬ä»é¡ºåºå·¥ä½œè´Ÿè½½å¼€å§‹ã€‚å½“é¡ºåºå†™å…¥ç£ç›˜æ—¶ï¼Œæ¯æ¬¡é€»è¾‘å†™å…¥å¿…é¡»å¯¼è‡´ä¸¤æ¬¡ç‰©ç†å†™å…¥ï¼›ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬å†™å…¥é€»è¾‘å—0ï¼ˆä¸Šå›¾ï¼‰æ—¶ï¼ŒRAIDå†…éƒ¨ä¼šå°†å…¶åŒæ—¶å†™å…¥ç£ç›˜0å’Œç£ç›˜1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºé•œåƒé˜µåˆ—é¡ºåºå†™å…¥æ—¶è·å¾—çš„æœ€å¤§å¸¦å®½ä¸ºï¼ˆ$\\frac{N}{2}\\cdot S$)ï¼Œæˆ–å³°å€¼å¸¦å®½çš„ä¸€åŠã€‚ ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨é¡ºåºè¯»å–æœŸé—´è·å¾—äº†å®Œå…¨ç›¸åŒçš„æ€§èƒ½ã€‚äººä»¬å¯èƒ½è®¤ä¸ºé¡ºåºè¯»å–å¯ä»¥åšå¾—æ›´å¥½ï¼Œå› ä¸ºå®ƒåªéœ€è¦è¯»å–æ•°æ®çš„ä¸€ä»½å‰¯æœ¬ï¼Œè€Œä¸æ˜¯ä¸¤è€…éƒ½è¯»å–ã€‚ç„¶è€Œï¼Œè®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¿™æ²¡æœ‰å¤šå¤§å¸®åŠ©ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦è¯»å–å— 0ã€1ã€2ã€3ã€4ã€5ã€6 å’Œ 7ã€‚å‡è®¾æˆ‘ä»¬å°† 0 çš„è¯»å–å‘é€åˆ°ç£ç›˜ 0ï¼Œå°† 1 çš„è¯»å–å‘é€åˆ°ç£ç›˜ 2ï¼Œå°† 2 çš„è¯»å–å‘é€åˆ°ç£ç›˜ 1 ï¼Œä»¥åŠå°† 3 è¯»å–åˆ°ç£ç›˜ 3ã€‚æˆ‘ä»¬ç»§ç»­åˆ†åˆ«å‘ç£ç›˜ 0ã€2ã€1 å’Œ 3 å‘å‡ºå¯¹ 4ã€5ã€6 å’Œ 7 çš„è¯»å–ã€‚äººä»¬å¯èƒ½å¤©çœŸåœ°è®¤ä¸ºï¼Œç”±äºæˆ‘ä»¬åˆ©ç”¨äº†æ‰€æœ‰ç£ç›˜ï¼Œå› æ­¤æˆ‘ä»¬å®ç°äº†é˜µåˆ—çš„å…¨éƒ¨å¸¦å®½ã€‚ ç„¶è€Œï¼Œè¦çŸ¥é“æƒ…å†µå¹¶éï¼ˆå¿…ç„¶ï¼‰å¦‚æ­¤ï¼Œè¯·è€ƒè™‘å•ä¸ªç£ç›˜ï¼ˆä¾‹å¦‚ç£ç›˜ 0ï¼‰æ”¶åˆ°çš„è¯·æ±‚ã€‚é¦–å…ˆï¼Œå®ƒæ”¶åˆ°å¯¹å—0çš„è¯·æ±‚ï¼›ç„¶åï¼Œå®ƒæ”¶åˆ°å¯¹å— 4 çš„è¯·æ±‚ï¼ˆè·³è¿‡å— 2ï¼‰ã€‚äº‹å®ä¸Šï¼Œæ¯ä¸ªç£ç›˜éƒ½ä¼šæ”¶åˆ°å¯¹æ¯ä¸ªå…¶ä»–å—çš„è¯·æ±‚ã€‚å½“å®ƒåœ¨è·³è¿‡çš„å—ä¸Šæ—‹è½¬æ—¶ï¼Œå®ƒä¸ä¼šå‘å®¢æˆ·ç«¯æä¾›æœ‰ç”¨çš„å¸¦å®½ã€‚å› æ­¤ï¼Œæ¯ä¸ªç£ç›˜åªèƒ½æä¾›å…¶å³°å€¼å¸¦å®½çš„ä¸€åŠã€‚å› æ­¤ï¼Œé¡ºåºè¯»å–åªèƒ½è·å¾—($\\frac{N}{2}\\cdot S$)MB/sçš„å¸¦å®½ã€‚ éšæœºè¯»å–æ˜¯é•œåƒ RAID çš„æœ€ä½³æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯»å–åˆ†å¸ƒåœ¨æ‰€æœ‰ç£ç›˜ä¸Šï¼Œä»è€Œè·å¾—å…¨éƒ¨å¯èƒ½çš„å¸¦å®½ã€‚å› æ­¤ï¼Œå¯¹äºéšæœºè¯»å–ï¼ŒRAID-1 æä¾› $N\\cdot R$ MB/sã€‚ æœ€åï¼Œéšæœºå†™å…¥çš„æ€§èƒ½å¦‚æ‚¨æ‰€æ–™ï¼š$\\frac{N}{2}\\cdot R$ MB/sã€‚æ¯ä¸ªé€»è¾‘å†™å…¥å¿…é¡»è½¬åŒ–ä¸ºä¸¤ä¸ªç‰©ç†å†™å…¥ï¼Œå› æ­¤å½“æ‰€æœ‰ç£ç›˜éƒ½åœ¨ä½¿ç”¨æ—¶ï¼Œå®¢æˆ·ç«¯åªä¼šå°†å…¶è§†ä¸ºå¯ç”¨å¸¦å®½çš„ä¸€åŠã€‚å°½ç®¡å¯¹é€»è¾‘å— $x$ çš„å†™å…¥å˜æˆäº†å¯¹ä¸¤ä¸ªä¸åŒç‰©ç†ç£ç›˜çš„ä¸¤æ¬¡å¹¶è¡Œå†™å…¥ï¼Œä½†è®¸å¤šå°è¯·æ±‚çš„å¸¦å®½ä»…è¾¾åˆ°æˆ‘ä»¬åœ¨æ¡å¸¦åŒ–ä¸­çœ‹åˆ°çš„ä¸€åŠã€‚æ­£å¦‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šçœ‹åˆ°çš„ï¼Œè·å¾—ä¸€åŠçš„å¯ç”¨å¸¦å®½å®é™…ä¸Šéå¸¸å¥½ï¼ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:6:2","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 RAID Level 4ï¼šä½¿ç”¨å¥‡å¶æ ¡éªŒèŠ‚çœç©ºé—´ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:7:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.1 åŸºæœ¬ä»‹ç» æˆ‘ä»¬ç°åœ¨ä»‹ç»ä¸€ç§ä¸åŒçš„å‘ç£ç›˜é˜µåˆ—æ·»åŠ å†—ä½™çš„æ–¹æ³•ï¼Œç§°ä¸ºå¥‡å¶æ ¡éªŒã€‚åŸºäºå¥‡å¶æ ¡éªŒçš„æ–¹æ³•è¯•å›¾ä½¿ç”¨æ›´å°‘çš„å®¹é‡ï¼Œä»è€Œå…‹æœé•œåƒç³»ç»Ÿæ‰€ä»˜å‡ºçš„å·¨å¤§ç©ºé—´ä»£ä»·ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•ä»¥æ€§èƒ½ä¸ºä»£ä»·ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªäº”ç£ç›˜ RAID-4 ç³»ç»Ÿç¤ºä¾‹ã€‚ æˆ‘ä»¬ä¸ºæ¯ä¸ªæ•°æ®æ¡å¸¦æ·»åŠ äº†ä¸€ä¸ªå¥‡å¶æ ¡éªŒå—ï¼Œç”¨äºå­˜å‚¨è¯¥æ•°æ®å—æ¡å¸¦çš„å†—ä½™ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¥‡å¶æ ¡éªŒå— P1 å…·æœ‰ä»å— 4ã€5ã€6 å’Œ 7 è®¡ç®—å‡ºçš„å†—ä½™ä¿¡æ¯ã€‚ è¦è®¡ç®—å¥‡å¶æ ¡éªŒï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ•°å­¦å‡½æ•°ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ‰¿å—æ¡å¸¦ä¸­ä»»ä½•ä¸€ä¸ªå—çš„ä¸¢å¤±ã€‚äº‹å®è¯æ˜ï¼Œç®€å•çš„å‡½æ•° XOR å°±èƒ½å¾ˆå¥½åœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚å¯¹äºä¸€ç»„ç»™å®šçš„bitï¼Œå¦‚æœbitä¸­ 1 çš„ä¸ªæ•°ä¸ºå¶æ•°ï¼Œåˆ™æ‰€æœ‰è¿™äº›bitçš„ XOR è¿”å› 0ï¼›å¦‚æœ 1 çš„ä¸ªæ•°ä¸ºå¥‡æ•°ï¼Œåˆ™è¿”å› 1ã€‚ä¾‹å¦‚ï¼š åœ¨ç¬¬ä¸€è¡Œï¼ˆ0,0,1,1ï¼‰ä¸­ï¼Œæœ‰ä¸¤ä¸ª 1ï¼ˆC2ã€C3ï¼‰ï¼Œå› æ­¤æ‰€æœ‰è¿™äº›å€¼çš„ XOR å°†æ˜¯ 0 (P)ï¼›åŒæ ·ï¼Œåœ¨ç¬¬äºŒè¡Œä¸­åªæœ‰ä¸€ä¸ª 1ï¼ˆC1ï¼‰ï¼Œå› æ­¤ XOR å¿…é¡»æ˜¯ 1 (P)ã€‚æ‚¨å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•è®°ä½è¿™ä¸€ç‚¹ï¼šä»»ä½•ä¸€è¡Œä¸­ 1 çš„ä¸ªæ•°å¿…é¡»æ˜¯å¶æ•°ï¼ˆè€Œä¸æ˜¯å¥‡æ•°ï¼‰ï¼›è¿™å°±æ˜¯ RAID å¿…é¡»ä¿æŒçš„ä¸å˜æ€§ï¼Œè¿™æ ·å¥‡å¶æ ¡éªŒæ‰ä¼šæ­£ç¡®ã€‚ ä»ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ‚¨æˆ–è®¸è¿˜èƒ½çŒœåˆ°å¦‚ä½•ä½¿ç”¨å¥‡å¶æ ¡éªŒä¿¡æ¯æ¥ä»æ•…éšœä¸­æ¢å¤ã€‚å‡è®¾æ ‡æœ‰ C2 çš„åˆ—ä¸¢å¤±äº†ã€‚è¦æƒ³çŸ¥é“è¯¥åˆ—ä¸­åº”è¯¥æœ‰å“ªäº›å€¼ï¼Œæˆ‘ä»¬åªéœ€è¯»å…¥è¯¥è¡Œä¸­çš„æ‰€æœ‰å…¶ä»–å€¼ï¼ˆåŒ…æ‹¬ XOR çš„å¥‡å¶æ ¡éªŒä½ï¼‰ï¼Œç„¶åé‡å»ºæ­£ç¡®çš„ç­”æ¡ˆã€‚å…·ä½“æ¥è¯´ï¼Œå‡è®¾ç¬¬ä¸€è¡Œ C2 åˆ—çš„å€¼ä¸¢å¤±äº†ï¼ˆå®ƒæ˜¯ä¸€ä¸ª 1ï¼‰ï¼›é€šè¿‡è¯»å–è¯¥è¡Œä¸­çš„å…¶ä»–å€¼ï¼ˆC0 ä¸­çš„ 0ã€C1 ä¸­çš„ 0ã€C3 ä¸­çš„ 1 å’Œå¥‡å¶æ ¡éªŒåˆ— P ä¸­çš„ 0ï¼‰ï¼Œæˆ‘ä»¬å¾—åˆ°äº† 0ã€0ã€1 å’Œ 0ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“ XOR åœ¨æ¯ä¸€è¡Œä¸­ä¿æŒå¶æ•°ä¸ª 1ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“ä¸¢å¤±çš„æ•°æ®ä¸€å®šæ˜¯ï¼šä¸€ä¸ª ã€‚è¯·æ³¨æ„æˆ‘ä»¬æ˜¯å¦‚ä½•è®¡ç®—é‡æ„å€¼çš„ï¼šæˆ‘ä»¬åªéœ€å°†æ•°æ®ä½å’Œå¥‡å¶æ ¡éªŒä½ä¸€èµ· XOR å³å¯ï¼Œä¸æœ€åˆè®¡ç®—å¥‡å¶æ ¡éªŒçš„æ–¹æ³•ç›¸åŒã€‚ ç°åœ¨ä½ å¯èƒ½æƒ³çŸ¥é“ï¼šæˆ‘ä»¬è¯´çš„æ˜¯å°†æ‰€æœ‰è¿™äº›bitè¿›è¡Œ XORï¼Œä½†ä»ä¸Šé¢æˆ‘ä»¬çŸ¥é“ RAID åœ¨æ¯ä¸ªç£ç›˜ä¸Šæ”¾ç½®äº† 4KB ï¼ˆæˆ–æ›´å¤§ï¼‰çš„æ•°æ®å—ï¼›æˆ‘ä»¬å¦‚ä½•å¯¹ä¸€å †æ•°æ®å—åº”ç”¨ XOR æ¥è®¡ç®—å¥‡å¶æ ¡éªŒå‘¢ï¼Ÿäº‹å®è¯æ˜è¿™ä¹Ÿå¾ˆç®€å•ã€‚åªéœ€å¯¹æ•°æ®å—çš„æ¯ä¸ªä½æ‰§è¡Œé€ä½ XOR å³å¯ï¼›å°†æ¯ä¸ªé€ä½ XOR çš„ç»“æœæ”¾å…¥å¥‡å¶æ ¡éªŒå—çš„ç›¸åº”ä½æ§½ä¸­å³å¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤§å°ä¸º 4 ä½çš„æ•°æ®å—ï¼Œå®ƒä»¬å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªæ•°æ®å—çš„æ¯ä¸ªbitéƒ½è¦è®¡ç®—å¥‡å¶æ ¡éªŒï¼Œå¹¶å°†è®¡ç®—ç»“æœæ”¾å…¥å¥‡å¶æ ¡éªŒæ•°æ®å—ä¸­ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:7:1","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.2 RAID-4 åˆ†æ ç°åœ¨è®©æˆ‘ä»¬åˆ†æä¸€ä¸‹RAID-4ã€‚ä»å®¹é‡çš„è§’åº¦æ¥çœ‹ï¼ŒRAID-4 ä½¿ç”¨ 1 ä¸ªç£ç›˜æ¥ä¸ºå…¶ä¿æŠ¤çš„æ¯ç»„ç£ç›˜æä¾›å¥‡å¶æ ¡éªŒä¿¡æ¯ã€‚å› æ­¤ï¼ŒRAID ç»„çš„æœ‰ç”¨å®¹é‡ä¸º $(N âˆ’ 1) Â· B$ã€‚ å¯é æ€§ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼šRAID-4 åªèƒ½å®¹å¿ 1 ä¸ªç£ç›˜æ•…éšœï¼Œä¸èƒ½å†å‡ºç°æ›´å¤šæ•…éšœã€‚å¦‚æœå¤šä¸ªç£ç›˜ä¸¢å¤±ï¼Œåˆ™æ ¹æœ¬æ— æ³•é‡å»ºä¸¢å¤±çš„æ•°æ®ã€‚ æœ€åï¼Œè¿˜æœ‰æ€§èƒ½ã€‚è¿™æ¬¡ï¼Œè®©æˆ‘ä»¬ä»åˆ†æç¨³æ€ååé‡å¼€å§‹ã€‚é¡ºåºè¯»å–æ€§èƒ½å¯ä»¥åˆ©ç”¨é™¤å¥‡å¶æ ¡éªŒç£ç›˜ä¹‹å¤–çš„æ‰€æœ‰ç£ç›˜ï¼Œä»è€Œæä¾› $(N âˆ’ 1) Â· S\\text{ MB/s}$ çš„å³°å€¼æœ‰æ•ˆå¸¦å®½ï¼ˆä¸€ä¸ªç®€å•çš„æƒ…å†µï¼‰ã€‚ è¦äº†è§£é¡ºåºå†™å…¥çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆäº†è§£å®ƒä»¬æ˜¯å¦‚ä½•å®Œæˆçš„ã€‚å°†å¤§å—æ•°æ®å†™å…¥ç£ç›˜æ—¶ï¼ŒRAID-4 å¯ä»¥æ‰§è¡Œç§°ä¸ºå…¨æ¡å¸¦å†™å…¥çš„ç®€å•ä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹å— 0ã€1ã€2 å’Œ 3 å·²ä½œä¸ºå†™å…¥è¯·æ±‚çš„ä¸€éƒ¨åˆ†å‘é€åˆ° RAID çš„æƒ…å†µï¼ˆå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒRAIDå¯ä»¥ç®€å•åœ°è®¡ç®—P0çš„æ–°å€¼ï¼ˆé€šè¿‡å¯¹å—0ã€1ã€2å’Œ3æ‰§è¡Œå¼‚æˆ–ï¼‰ï¼Œç„¶åå°†æ‰€æœ‰å—ï¼ˆåŒ…æ‹¬å¥‡å¶æ ¡éªŒå—ï¼‰å¹¶è¡Œå†™å…¥ä¸Šé¢çš„äº”ä¸ªç£ç›˜ä¸­ï¼ˆè¡¨ä¸­ä»¥ç°è‰²çªå‡ºæ˜¾ç¤ºï¼‰ã€‚å› æ­¤ï¼Œå…¨æ¡å¸¦å†™å…¥æ˜¯ RAID-4 å†™å…¥ç£ç›˜çš„æœ€æœ‰æ•ˆæ–¹å¼ã€‚ ä¸€æ—¦æˆ‘ä»¬äº†è§£äº†å…¨æ¡å¸¦å†™å…¥ï¼Œè®¡ç®— RAID-4 ä¸Šé¡ºåºå†™å…¥çš„æ€§èƒ½å°±å¾ˆå®¹æ˜“äº†ï¼›æœ‰æ•ˆå¸¦å®½ä¹Ÿæ˜¯$(N âˆ’ 1) Â· S\\text{ MB/s}$ã€‚å³ä½¿åœ¨æ“ä½œè¿‡ç¨‹ä¸­ä¸æ–­ä½¿ç”¨å¥‡å¶æ ¡éªŒç£ç›˜ï¼Œå®¢æˆ·ç«¯ä¹Ÿæ— æ³•ä»ä¸­è·å¾—æ€§èƒ½ä¼˜åŠ¿ã€‚ ç°åœ¨æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹éšæœºè¯»å–çš„æ€§èƒ½ã€‚ä»ä¸Šè¡¨ä¸­è¿˜å¯ä»¥çœ‹åˆ°ï¼Œä¸€ç»„ 1-block éšæœºè¯»å–å°†åˆ†å¸ƒåœ¨ç³»ç»Ÿçš„æ•°æ®ç£ç›˜ä¸Šï¼Œä½†ä¸ä¼šåˆ†å¸ƒåœ¨å¥‡å¶æ ¡éªŒç£ç›˜ä¸Šã€‚å› æ­¤ï¼Œæœ‰æ•ˆæ€§èƒ½ä¸ºï¼š$(N âˆ’ 1) Â· R\\text{ MB/s}$ã€‚ æˆ‘ä»¬æœ€åä¿å­˜çš„éšæœºå†™å…¥å‘ˆç°äº† RAID-4 æœ€æœ‰è¶£çš„æƒ…å†µã€‚å‡è®¾æˆ‘ä»¬å¸Œæœ›è¦†ç›–ä¸Šé¢ç¤ºä¾‹ä¸­çš„å— 1ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥è¦†ç›–å®ƒï¼Œä½†è¿™ä¼šç»™æˆ‘ä»¬å¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šå¥‡å¶æ ¡éªŒå— P0 å°†ä¸å†å‡†ç¡®åœ°åæ˜ æ¡å¸¦çš„æ­£ç¡®å¥‡å¶æ ¡éªŒå€¼ï¼›åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒP0 ä¹Ÿå¿…é¡»æ›´æ–°ã€‚å¦‚ä½•æ‰èƒ½æ—¢æ­£ç¡®åˆé«˜æ•ˆåœ°æ›´æ–°å‘¢ï¼Ÿ äº‹å®è¯æ˜æœ‰ä¸¤ç§æ–¹æ³•ã€‚ç¬¬ä¸€ä¸ªç§°ä¸ºåŠ æ³•å¥‡å¶æ ¡éªŒï¼Œè¦æ±‚æˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚è¦è®¡ç®—æ–°å¥‡å¶æ ¡éªŒå—çš„å€¼ï¼Œè¯·å¹¶è¡Œè¯»å…¥æ¡å¸¦ä¸­çš„æ‰€æœ‰å…¶ä»–æ•°æ®å—ï¼ˆåœ¨ç¤ºä¾‹ä¸­ä¸ºå— 0ã€2 å’Œ 3ï¼‰ï¼Œå¹¶å°†è¿™äº›æ•°æ®å—ä¸æ–°å— (1) è¿›è¡Œå¼‚æˆ–ã€‚ç»“æœå°±æ˜¯æ–°çš„å¥‡å¶æ ¡éªŒå—ã€‚ä¸ºäº†å®Œæˆå†™å…¥ï¼Œæ‚¨å¯ä»¥å°†æ–°æ•°æ®å’Œæ–°å¥‡å¶æ ¡éªŒå†™å…¥å„è‡ªçš„ç£ç›˜ï¼ŒåŒæ ·æ˜¯å¹¶è¡Œçš„ã€‚ è¯¥æŠ€æœ¯çš„é—®é¢˜åœ¨äºå®ƒä¼šéšç€ç£ç›˜æ•°é‡çš„å¢åŠ è€Œæ‰©å±•ï¼Œå› æ­¤åœ¨è¾ƒå¤§çš„ RAID ä¸­éœ€è¦å¤§é‡è¯»å–æ¥è®¡ç®—å¥‡å¶æ ¡éªŒã€‚å› æ­¤ï¼Œé‡‡ç”¨å‡æ³•å¥‡å¶æ ¡éªŒæ³•ã€‚ ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹è¿™ä¸€ä¸²ä½ï¼ˆ4 ä¸ªæ•°æ®ä½ï¼Œä¸€ä¸ªå¥‡å¶æ ¡éªŒï¼‰ï¼š å‡è®¾æˆ‘ä»¬å¸Œæœ›ç”¨ä¸€ä¸ªæ–°å€¼è¦†ç›–ä½ C2ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸º$C2_{new}$ ã€‚å‡æ³•åˆ†ä¸‰ä¸ªæ­¥éª¤è¿›è¡Œã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è¯»å…¥C2å¤„çš„æ—§æ•°æ®ï¼ˆ$C2_{old}=1$ï¼‰å’Œæ—§å¥‡å¶æ ¡éªŒï¼ˆ$P_{old}=0$ï¼‰ã€‚ ç„¶åï¼Œæˆ‘ä»¬æ¯”è¾ƒæ—§æ•°æ®å’Œæ–°æ•°æ®ï¼› å¦‚æœå®ƒä»¬ç›¸åŒï¼ˆä¾‹å¦‚ï¼Œ$C2_{new}=C2_{old}$ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“å¥‡å¶æ ¡éªŒä½ä¹Ÿå°†ä¿æŒç›¸åŒï¼ˆå³ï¼Œ$P_{new}=P_{old}$ï¼‰ã€‚ ç„¶è€Œï¼Œå¦‚æœå®ƒä»¬ä¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»å°†æ—§å¥‡å¶æ ¡éªŒä½ç¿»è½¬åˆ°å…¶å½“å‰çŠ¶æ€çš„ç›¸åçŠ¶æ€ï¼Œå³ï¼Œå¦‚æœ($P_{old}==1$)ï¼Œ$P_{new}$å°†è¢«è®¾ç½®ä¸º0ï¼›å¦‚æœ ($P_{old}==0$)ï¼Œ$P_{new}$å°†è¢«è®¾ç½®ä¸º 1ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ XOR å·§å¦™åœ°è¡¨è¾¾æ•´ä¸ªè¿‡ç¨‹ï¼ˆå…¶ä¸­ $\\oplus$ æ˜¯ XOR è¿ç®—ç¬¦ï¼‰ï¼š $$ P_{new}=(C_{old}\\oplus C_{new})\\oplus P_{old} $$ ç”±äºæˆ‘ä»¬å¤„ç†çš„æ˜¯æ•°æ®å—è€Œä¸æ˜¯bitï¼Œå› æ­¤æˆ‘ä»¬å¯¹æ•°æ®å—ä¸­çš„æ‰€æœ‰bitè¿›è¡Œè®¡ç®—ï¼ˆä¾‹å¦‚ï¼Œæ¯ä¸ªæ•°æ®å—ä¸­çš„ 4096 ä¸ªå­—èŠ‚ä¹˜ä»¥æ¯ä¸ªå­—èŠ‚çš„ 8 ä¸ªbitï¼‰ã€‚å› æ­¤ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–°çš„æ•°æ®å—ä¼šä¸æ—§çš„æ•°æ®å—ä¸åŒï¼Œå› æ­¤æ–°çš„å¥‡å¶æ ¡éªŒæ•°æ®å—ä¹Ÿä¼šä¸åŒã€‚ç°åœ¨ï¼Œä½ åº”è¯¥èƒ½ç®—å‡ºä½•æ—¶ä½¿ç”¨åŠ æ³•å¥‡å¶æ ¡éªŒè®¡ç®—ï¼Œä½•æ—¶ä½¿ç”¨å‡æ³•å¥‡å¶æ ¡éªŒè®¡ç®—ã€‚æƒ³ä¸€æƒ³ï¼Œç³»ç»Ÿä¸­éœ€è¦æœ‰å¤šå°‘ç£ç›˜æ‰èƒ½ä½¿åŠ æ³•è®¡ç®—æ³•çš„ I/O æ¬¡æ•°å°‘äºå‡æ³•è®¡ç®—æ³•ï¼›äº¤å‰ç‚¹æ˜¯å¤šå°‘ï¼Ÿ åœ¨è¿›è¡Œæ€§èƒ½åˆ†ææ—¶ï¼Œæˆ‘ä»¬å‡è®¾ä½¿ç”¨çš„æ˜¯å‡æ³•ã€‚å› æ­¤ï¼Œæ¯å†™ä¸€æ¬¡ï¼ŒRAID å¿…é¡»æ‰§è¡Œ 4 æ¬¡ç‰©ç† I/Oï¼ˆä¸¤æ¬¡è¯»å’Œä¸¤æ¬¡å†™ï¼‰ã€‚ç°åœ¨å‡è®¾æœ‰å¤§é‡çš„å†™æ“ä½œæäº¤ç»™ RAIDï¼Œé‚£ä¹ˆ RAID-4 å¯ä»¥å¹¶è¡Œæ‰§è¡Œå¤šå°‘æ¬¡å†™æ“ä½œå‘¢ï¼Ÿè¦ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬å†çœ‹çœ‹ RAID-4 å¸ƒå±€ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ ç°åœ¨å‡è®¾å¤§çº¦åœ¨åŒä¸€æ—¶é—´æœ‰ 2 ä¸ªå°å†™å…¥æäº¤åˆ° RAID-4ï¼Œå³å— 4 å’Œ 13ï¼ˆè¡¨ä¸­ç”¨ * æ ‡è®°ï¼‰ã€‚è¿™äº›ç£ç›˜çš„æ•°æ®ä½äºç£ç›˜ 0 å’Œ 1 ä¸Šï¼Œå› æ­¤æ•°æ®çš„è¯»å–å’Œå†™å…¥å¯ä»¥å¹¶è¡Œå‘ç”Ÿï¼Œè¿™å¾ˆå¥½ã€‚å‡ºç°çš„é—®é¢˜æ˜¯å¥‡å¶æ ¡éªŒç£ç›˜ï¼›ä¸¤ä¸ªè¯·æ±‚éƒ½å¿…é¡»è¯»å– 4 å’Œ 13 çš„ç›¸å…³å¥‡å¶æ ¡éªŒå—ã€å¥‡å¶æ ¡éªŒå— P1 å’Œ P3ï¼ˆç”¨ + æ ‡è®°ï¼‰ã€‚å¸Œæœ›é—®é¢˜ç°åœ¨å·²ç»æ¸…æ¥šäº†ï¼šå¥‡å¶æ ¡éªŒç£ç›˜æ˜¯æ­¤ç±»å·¥ä½œè´Ÿè½½ä¸‹çš„ç“¶é¢ˆï¼›å› æ­¤ï¼Œæˆ‘ä»¬æœ‰æ—¶å°†å…¶ç§°ä¸ºåŸºäºå¥‡å¶æ ¡éªŒçš„ RAID çš„å°å†™å…¥é—®é¢˜ã€‚å› æ­¤ï¼Œå³ä½¿æ•°æ®ç£ç›˜å¯ä»¥å¹¶è¡Œè®¿é—®ï¼Œå¥‡å¶æ ¡éªŒç£ç›˜ä¹Ÿä¼šé˜»æ­¢ä»»ä½•å¹¶è¡Œæ€§çš„å®ç°ï¼›ç”±äºå¥‡å¶æ ¡éªŒç£ç›˜çš„å­˜åœ¨ï¼Œå¯¹ç³»ç»Ÿçš„æ‰€æœ‰å†™å…¥éƒ½å°†è¢«åºåˆ—åŒ–ã€‚ç”±äºå¥‡å¶æ ¡éªŒç£ç›˜æ¯ä¸ªé€»è¾‘ I/O å¿…é¡»æ‰§è¡Œä¸¤æ¬¡ I/Oï¼ˆä¸€æ¬¡è¯»ï¼Œä¸€æ¬¡å†™ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—å¥‡å¶æ ¡éªŒç£ç›˜åœ¨è¿™ä¸¤ä¸ª I/O ä¸Šçš„æ€§èƒ½æ¥è®¡ç®— RAID-4 ä¸­å°å‹éšæœºå†™å…¥çš„æ€§èƒ½ï¼Œå› æ­¤æˆ‘ä»¬è¾¾åˆ°äº† $\\frac{R}{2}$ MB/sã€‚éšæœºå°å†™å…¥ä¸‹çš„ RAID-4 ååé‡å¾ˆç³Ÿç³•ï¼›å½“æ‚¨å‘ç³»ç»Ÿæ·»åŠ ç£ç›˜æ—¶ï¼Œå®ƒä¸ä¼šå¾—åˆ°æ”¹å–„ã€‚ æœ€åï¼Œæˆ‘ä»¬å°†åˆ†æ RAID-4 ä¸­çš„ I/O å»¶è¿Ÿã€‚å¤§å®¶ç°åœ¨éƒ½çŸ¥é“ï¼Œå•æ¬¡è¯»å–ï¼ˆå‡è®¾æ²¡æœ‰æ•…éšœï¼‰åªæ˜¯æ˜ å°„åˆ°å•ä¸ªç£ç›˜ï¼Œå› æ­¤å…¶å»¶è¿Ÿç›¸å½“äºå•ä¸ªç£ç›˜è¯·æ±‚çš„å»¶è¿Ÿã€‚å•æ¬¡å†™å…¥çš„å»¶è¿Ÿéœ€è¦ä¸¤æ¬¡è¯»å–ï¼Œç„¶åä¸¤æ¬¡å†™å…¥ï¼›è¯»å–å’Œå†™å…¥å¯ä»¥å¹¶è¡Œè¿›è¡Œï¼Œå› æ­¤æ€»å»¶è¿Ÿå¤§çº¦æ˜¯å•ä¸ªç£ç›˜çš„ä¸¤å€ï¼ˆå­˜åœ¨ä¸€äº›å·®å¼‚ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»ç­‰å¾…ä¸¤æ¬¡è¯»å–å®Œæˆï¼Œä»è€Œè·å¾—æœ€åæƒ…å†µä¸‹çš„å®šä½æ—¶é—´ï¼Œä½†æ›´æ–°ä¸ä¼šäº§ç”Ÿå¯»é“æˆæœ¬ï¼Œå› æ­¤å¯èƒ½æ˜¯æ¯”å¹³å‡å®šä½æˆæœ¬æ›´å¥½çš„å®šä½æ—¶é—´ï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:7:2","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 RAID Level 5ï¼šæ—‹è½¬å¥‡å¶æ ¡éªŒ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:8:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8.1 åŸºæœ¬ä»‹ç» ä¸ºäº†è§£å†³ï¼ˆè‡³å°‘éƒ¨åˆ†åœ°ï¼‰å°å†™å…¥é—®é¢˜ï¼ŒPattersonã€Gibson å’Œ Katz å¼•å…¥äº† RAID-5ã€‚ RAID-5 çš„å·¥ä½œæ–¹å¼å‡ ä¹ä¸ RAID-4 ç›¸åŒï¼Œåªæ˜¯å®ƒåœ¨é©±åŠ¨å™¨ä¹‹é—´æ—‹è½¬å¥‡å¶æ ¡éªŒå—ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ¯ä¸ªæ¡å¸¦çš„å¥‡å¶æ ¡éªŒå—ç°åœ¨åœ¨ç£ç›˜ä¸Šæ—‹è½¬ï¼Œä»¥æ¶ˆé™¤ RAID-4 çš„å¥‡å¶æ ¡éªŒç£ç›˜ç“¶é¢ˆã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:8:1","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8.2 RAID 5 åˆ†æ RAID-5 çš„å¤§éƒ¨åˆ†åˆ†æä¸ RAID-4 ç›¸åŒã€‚ä¾‹å¦‚ï¼Œä¸¤ä¸ªçº§åˆ«çš„æœ‰æ•ˆå®¹é‡å’Œå®¹é”™èƒ½åŠ›æ˜¯ç›¸åŒçš„ã€‚é¡ºåºè¯»å†™æ€§èƒ½ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å•ä¸ªè¯·æ±‚ï¼ˆæ— è®ºæ˜¯è¯»è¿˜æ˜¯å†™ï¼‰çš„å»¶è¿Ÿä¹Ÿä¸ RAID-4 ç›¸åŒã€‚ éšæœºè¯»å–æ€§èƒ½å¥½ä¸€ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ©ç”¨æ‰€æœ‰ç£ç›˜ã€‚æœ€åï¼Œéšæœºå†™å…¥æ€§èƒ½æ¯” RAID-4 æ˜¾ç€æé«˜ï¼Œå› ä¸ºå®ƒå…è®¸è·¨è¯·æ±‚å¹¶è¡Œã€‚æƒ³è±¡ä¸€ä¸‹å¯¹å— 1 çš„å†™å…¥å’Œå¯¹å— 10 çš„å†™å…¥ï¼›è¿™å°†å˜æˆå¯¹ç£ç›˜ 1 å’Œç£ç›˜ 4 çš„è¯·æ±‚ï¼ˆé’ˆå¯¹å— 1 åŠå…¶å¥‡å¶æ ¡éªŒP0ï¼‰ä»¥åŠå¯¹ç£ç›˜ 0 å’Œç£ç›˜ 2 çš„è¯·æ±‚ï¼ˆé’ˆå¯¹å— 10 åŠå…¶å¥‡å¶æ ¡éªŒP2ï¼‰ã€‚å› æ­¤ï¼Œå®ƒä»¬å¯ä»¥å¹¶è¡Œè¿›è¡Œã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥å‡è®¾ï¼Œç»™å®šå¤§é‡éšæœºè¯·æ±‚ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿä¿æŒæ‰€æœ‰ç£ç›˜å‡åŒ€å¿™ç¢Œã€‚å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°å†™çš„æ€»å¸¦å®½å°†æ˜¯ $\\frac{N}{4}\\cdot R$ MB/sã€‚ 4 ä¸ªä¸¢å¤±çš„å› ç´ æ˜¯ç”±äºæ¯æ¬¡ RAID-5 å†™å…¥ä»ç„¶ç”Ÿæˆ 4 æ¬¡æ€» I/O æ“ä½œï¼Œè¿™åªæ˜¯ä½¿ç”¨åŸºäºå¥‡å¶æ ¡éªŒçš„ RAID çš„æˆæœ¬ã€‚ å› ä¸º RAID-5 åŸºæœ¬ä¸Šä¸ RAID-4 ç›¸åŒï¼Œé™¤äº†åœ¨å°‘æ•°æƒ…å†µä¸‹æ›´å¥½ä¹‹å¤–ï¼Œåœ¨å¸‚åœºä¸Šå‡ ä¹å®Œå…¨å–ä»£äº† RAID-4ã€‚å”¯ä¸€æ²¡æœ‰è¢«å–ä»£çš„åœ°æ–¹æ˜¯é‚£äº›çŸ¥é“è‡ªå·±æ°¸è¿œä¸ä¼šæ‰§è¡Œå¤§å†™æ“ä½œçš„ç³»ç»Ÿï¼Œä»è€Œå®Œå…¨é¿å…å°å†™é—®é¢˜ï¼›åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæœ‰æ—¶ä¼šä½¿ç”¨ RAID-4ï¼Œå› ä¸ºå®ƒæ„å»ºèµ·æ¥ç¨å¾®ç®€å•ä¸€äº›ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:8:2","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"9 RAID æ¯”è¾ƒ ç°åœ¨ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œæˆ‘ä»¬æ€»ç»“äº† RAID Levelsçš„ç®€åŒ–æ¯”è¾ƒã€‚ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çœç•¥äº†è®¸å¤šç»†èŠ‚ä»¥ç®€åŒ–æˆ‘ä»¬çš„åˆ†æã€‚ä¾‹å¦‚ï¼Œåœ¨é•œåƒç³»ç»Ÿä¸­å†™å…¥æ—¶ï¼Œå¹³å‡å¯»é“æ—¶é—´æ¯”ä»…å†™å…¥å•ä¸ªç£ç›˜æ—¶ç¨é•¿ï¼Œå› ä¸ºå¯»é“æ—¶é—´æ˜¯ä¸¤æ¬¡å¯»é“ï¼ˆæ¯ä¸ªç£ç›˜ä¸Šä¸€æ¬¡ï¼‰çš„æœ€å¤§å€¼ã€‚å› æ­¤ï¼Œä¸¤ä¸ªç£ç›˜çš„éšæœºå†™å…¥æ€§èƒ½é€šå¸¸ä¼šç•¥ä½äºå•ä¸ªç£ç›˜çš„éšæœºå†™å…¥æ€§èƒ½ã€‚æ­¤å¤–ï¼Œåœ¨æ›´æ–° RAID-4/5 ä¸­çš„å¥‡å¶æ ¡éªŒç£ç›˜æ—¶ï¼Œç¬¬ä¸€æ¬¡è¯»å–æ—§å¥‡å¶æ ¡éªŒå¯èƒ½ä¼šå¯¼è‡´å®Œå…¨å¯»é“å’Œæ—‹è½¬ï¼Œä½†ç¬¬äºŒæ¬¡å†™å…¥å¥‡å¶æ ¡éªŒåªä¼šå¯¼è‡´æ—‹è½¬ã€‚ ç„¶è€Œï¼Œè¡¨ä¸­çš„æ¯”è¾ƒç¡®å®æ•æ‰åˆ°äº†æœ¬è´¨å·®å¼‚ï¼Œå¹¶ä¸”å¯¹äºç†è§£è·¨ RAID Levelsçš„æƒè¡¡å¾ˆæœ‰ç”¨ã€‚å¯¹äºå»¶è¿Ÿåˆ†æï¼Œæˆ‘ä»¬ç®€å•åœ°ä½¿ç”¨ T æ¥è¡¨ç¤ºå¯¹å•ä¸ªç£ç›˜çš„è¯·æ±‚æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚ æ€»è€Œè¨€ä¹‹ï¼š å¦‚æœæ‚¨ä¸¥æ ¼è¦æ±‚æ€§èƒ½è€Œä¸å…³å¿ƒå¯é æ€§ï¼Œé‚£ä¹ˆæ¡å¸¦åŒ–æ˜¾ç„¶æ˜¯æœ€å¥½çš„ã€‚ ç„¶è€Œï¼Œå¦‚æœæ‚¨æƒ³è¦éšæœº I/O æ€§èƒ½å’Œå¯é æ€§ï¼Œé•œåƒæ˜¯æœ€å¥½çš„ï¼›æ‚¨æ‰€ä»˜å‡ºçš„æˆæœ¬æ˜¯æŸå¤±å®¹é‡ã€‚ å¦‚æœå®¹é‡å’Œå¯é æ€§æ˜¯æ‚¨çš„ä¸»è¦ç›®æ ‡ï¼Œé‚£ä¹ˆ RAID-5 å°±æ˜¯é¦–é€‰ï¼›æ‚¨ä»˜å‡ºçš„ä»£ä»·æ˜¯å°å†™æ€§èƒ½ã€‚æœ€åï¼Œå¦‚æœæ‚¨å§‹ç»ˆæ‰§è¡Œé¡ºåº I/O å¹¶å¸Œæœ›æœ€å¤§åŒ–å®¹é‡ï¼Œé‚£ä¹ˆ RAID-5 ä¹Ÿæ˜¯æœ€æœ‰æ„ä¹‰çš„ã€‚ ","date":"2024-05-11","objectID":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/:9:0","tags":["OS"],"title":"å»‰ä»·ç£ç›˜å†—ä½™é˜µåˆ—","uri":"/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"å‡ åå¹´æ¥ï¼Œç¡¬ç›˜é©±åŠ¨å™¨ä¸€ç›´æ˜¯è®¡ç®—æœºç³»ç»Ÿä¸­æŒä¹…æ•°æ®å­˜å‚¨çš„ä¸»è¦å½¢å¼ï¼Œæ–‡ä»¶ç³»ç»ŸæŠ€æœ¯çš„å¤§éƒ¨åˆ†å‘å±•éƒ½æ˜¯åŸºäºå®ƒä»¬çš„è¡Œä¸ºã€‚å› æ­¤ï¼Œåœ¨æ„å»ºç®¡ç†ç£ç›˜çš„æ–‡ä»¶ç³»ç»Ÿè½¯ä»¶ä¹‹å‰ï¼Œæœ‰å¿…è¦äº†è§£ç£ç›˜æ“ä½œçš„ç»†èŠ‚ã€‚ å…³é”®é—®é¢˜ ç°ä»£ç¡¬ç›˜é©±åŠ¨å™¨å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿæ¥å£æ˜¯ä»€ä¹ˆï¼Ÿæ•°æ®å®é™…ä¸Šæ˜¯å¦‚ä½•å¸ƒå±€å’Œè®¿é—®çš„ï¼Ÿç£ç›˜è°ƒåº¦å¦‚ä½•æé«˜æ€§èƒ½ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:0:0","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 æ¥å£ è®©æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ç°ä»£ç£ç›˜é©±åŠ¨å™¨çš„æ¥å£ã€‚æ‰€æœ‰ç°ä»£ç¡¬ç›˜çš„åŸºæœ¬æ¥å£éƒ½å¾ˆç®€å•ã€‚ç¡¬ç›˜ç”±å¤§é‡æ‰‡åŒºï¼ˆ512 å­—èŠ‚å—ï¼‰ç»„æˆï¼Œæ¯ä¸ªæ‰‡åŒºéƒ½å¯è¯»å†™ã€‚åœ¨æœ‰ n ä¸ªæ‰‡åŒºçš„ç£ç›˜ä¸Šï¼Œæ‰‡åŒºçš„ç¼–å·ä» 0 åˆ° n - 1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç£ç›˜è§†ä¸ºä¸€ä¸ªæ‰‡åŒºæ•°ç»„ï¼›0 è‡³ n - 1 å°±æ˜¯ç¡¬ç›˜çš„åœ°å€ç©ºé—´ã€‚ å¤šæ‰‡åŒºæ“ä½œæ˜¯å¯èƒ½çš„ï¼›äº‹å®ä¸Šï¼Œè®¸å¤šæ–‡ä»¶ç³»ç»Ÿä¸€æ¬¡å¯ä»¥è¯»å†™ 4KB ï¼ˆæˆ–æ›´å¤šï¼‰ã€‚ä¸è¿‡ï¼Œåœ¨æ›´æ–°ç£ç›˜æ—¶ï¼Œç¡¬ç›˜åˆ¶é€ å•†å”¯ä¸€èƒ½ä¿è¯çš„æ˜¯å•æ¬¡ 512 å­—èŠ‚çš„å†™å…¥æ˜¯åŸå­æ€§çš„ï¼ˆå³è¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆæ ¹æœ¬ä¸å®Œæˆï¼‰ï¼›å› æ­¤ï¼Œå¦‚æœå‘ç”Ÿæ„å¤–æ–­ç”µï¼Œå¯èƒ½åªä¼šå®Œæˆè¾ƒå¤§å†™å…¥çš„ä¸€éƒ¨åˆ†ï¼ˆæœ‰æ—¶ç§°ä¸ºæ’•è£‚å†™å…¥ï¼‰ã€‚ å¤§å¤šæ•°ç£ç›˜é©±åŠ¨å™¨å®¢æˆ·ç«¯éƒ½ä¼šåšå‡ºä¸€äº›å‡è®¾ï¼Œä½†è¿™äº›å‡è®¾å¹¶æ²¡æœ‰åœ¨æ¥å£ä¸­ç›´æ¥æŒ‡å®šï¼›Schlosser å’Œ Ganger å°†æ­¤ç§°ä¸ºç£ç›˜é©±åŠ¨å™¨çš„ â€œä¸æˆæ–‡å¥‘çº¦â€ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥å‡å®šï¼Œè®¿é—®ç¡¬ç›˜åœ°å€ç©ºé—´å†…ç›¸é‚»çš„ä¸¤ä¸ªåŒºå—ä¼šæ¯”è®¿é—®ç›¸è·è¾ƒè¿œçš„ä¸¤ä¸ªåŒºå—æ›´å¿«ã€‚æˆ‘ä»¬é€šå¸¸è¿˜å¯ä»¥å‡è®¾ï¼Œä»¥è¿ç»­å—ï¼ˆå³é¡ºåºè¯»å–æˆ–å†™å…¥ï¼‰æ–¹å¼è®¿é—®å—æ˜¯æœ€å¿«çš„è®¿é—®æ¨¡å¼ï¼Œé€šå¸¸æ¯”ä»»ä½•éšæœºè®¿é—®æ¨¡å¼éƒ½è¦å¿«å¾—å¤šã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:1:0","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 åŸºæœ¬å‡ ä½• è®©æˆ‘ä»¬å¼€å§‹äº†è§£ç°ä»£ç£ç›˜çš„ä¸€äº›ç»„æˆéƒ¨åˆ†ã€‚æˆ‘ä»¬å…ˆä»ç›˜ç‰‡å¼€å§‹ï¼Œç›˜ç‰‡æ˜¯ä¸€ä¸ªåœ†å½¢ç¡¬è¡¨é¢ï¼Œé€šè¿‡ç£æ€§å˜åŒ–å°†æ•°æ®æŒä¹…åœ°å­˜å‚¨åœ¨ä¸Šé¢ã€‚ç£ç›˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç›˜ç‰‡ï¼›æ¯ä¸ªç›˜ç‰‡æœ‰ä¸¤ä¸ªé¢ï¼Œæ¯ä¸ªé¢ç§°ä¸ºä¸€ä¸ªè¡¨é¢ã€‚è¿™äº›ç›˜ç‰‡é€šå¸¸ç”±æŸç§ç¡¬è´¨ææ–™ï¼ˆå¦‚é“ï¼‰åˆ¶æˆï¼Œç„¶åæ¶‚ä¸Šä¸€å±‚è–„è–„çš„ç£å±‚ï¼Œä½¿ç¡¬ç›˜å³ä½¿åœ¨å…³æœºæ—¶ä¹Ÿèƒ½æŒä¹…å­˜å‚¨æ¯”ç‰¹æ•°æ®ã€‚ ç›˜ç‰‡éƒ½å›´ç»•ä¸»è½´ç»“åˆåœ¨ä¸€èµ·ï¼Œä¸»è½´ä¸ç”µæœºç›¸è¿ï¼Œç”µæœºä»¥æ’å®šï¼ˆå›ºå®šï¼‰çš„é€Ÿåº¦å¸¦åŠ¨ç›˜ç‰‡æ—‹è½¬ï¼ˆå½“ç¡¬ç›˜æ¥é€šç”µæºæ—¶ï¼‰ã€‚è½¬é€Ÿé€šå¸¸ä»¥æ¯åˆ†é’Ÿè½¬æ•°ï¼ˆRPMï¼‰ä¸ºå•ä½ï¼Œç°ä»£çš„å…¸å‹å€¼åœ¨ 7,200 RPM åˆ° 15,000 RPM ä¹‹é—´ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¯¹å•æ¬¡æ—‹è½¬çš„æ—¶é—´æ„Ÿå…´è¶£ï¼Œä¾‹å¦‚ï¼Œè½¬é€Ÿä¸º 10,000 RPM çš„ç¡¬ç›˜æ„å‘³ç€å•æ¬¡æ—‹è½¬å¤§çº¦éœ€è¦ 6 æ¯«ç§’ï¼ˆ6 æ¯«ç§’ï¼‰ã€‚ æ•°æ®ä»¥åŒå¿ƒåœ†æ‰‡å½¢ç¼–ç åœ¨æ¯ä¸ªè¡¨é¢ä¸Šï¼›æˆ‘ä»¬ç§°è¿™æ ·çš„åŒå¿ƒåœ†ä¸ºä¸€ä¸ªç£é“ã€‚å•ä¸ªè¡¨é¢åŒ…å«æˆåƒä¸Šä¸‡æ¡è½¨é“ï¼Œå®ƒä»¬ç´§å¯†åœ°æ’åˆ—åœ¨ä¸€èµ·ï¼Œæ•°ç™¾æ¡è½¨é“çš„å®½åº¦ä»…ç›¸å½“äºäººçš„å¤´å‘ä¸ã€‚ è¦ä»ç£ç›˜è¡¨é¢è¯»å†™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿæ„ŸçŸ¥ï¼ˆå³è¯»å–ï¼‰ç£ç›˜ä¸Šçš„ç£æ€§å›¾æ¡ˆï¼Œæˆ–å¼•èµ·ç£æ€§å›¾æ¡ˆçš„å˜åŒ–ï¼ˆå³å†™å…¥ï¼‰ã€‚è¯»å†™è¿‡ç¨‹ç”±ç£å¤´å®Œæˆï¼›é©±åŠ¨å™¨çš„æ¯ä¸ªè¡¨é¢éƒ½æœ‰ä¸€ä¸ªç£å¤´ã€‚ç£å¤´è¿æ¥åœ¨å•ä¸ªç£ç›˜è‡‚ä¸Šï¼Œç£ç›˜è‡‚åœ¨ç£ç›˜è¡¨é¢ç§»åŠ¨ï¼Œå°†ç£å¤´å®šä½åœ¨æ‰€éœ€ç£é“ä¸Šã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:2:0","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ç®€å•çš„ç£ç›˜é©±åŠ¨å™¨ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:3:0","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 å·¥ä½œåŸç† ç£ç›˜ç»“æ„å¦‚ä¸‹ï¼š è®©æˆ‘ä»¬é€šè¿‡ä¸€æ¬¡ä¸€ä¸ªç£é“æ„å»ºæ¨¡å‹æ¥äº†è§£ç£ç›˜çš„å·¥ä½œåŸç†ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå•ç£é“çš„ç®€å•ç£ç›˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è¯¥ç£é“åªæœ‰ 12 ä¸ªæ‰‡åŒºï¼Œæ¯ä¸ªæ‰‡åŒºå¤§å°ä¸º 512 å­—èŠ‚ï¼ˆæˆ‘ä»¬å…¸å‹çš„æ‰‡åŒºå¤§å°ï¼‰ï¼Œå› æ­¤é€šè¿‡æ•°å­— 0 åˆ° 11 è¿›è¡Œå¯»å€ã€‚æˆ‘ä»¬è¿™é‡Œçš„å•ç›˜ç‰‡å›´ç»•ä¸»è½´æ—‹è½¬ï¼Œç”µæœºè¿æ¥åˆ°ä¸»è½´ä¸Šã€‚å½“ç„¶ç£é“æœ¬èº«å¹¶ä¸é‡è¦ï¼›æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè¯»å–æˆ–å†™å…¥è¿™äº›æ‰‡åŒºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç£å¤´ï¼Œè¿æ¥åˆ°ç£ç›˜è‡‚ä¸Šï¼Œå°±åƒä¸‹å›¾æ‰€ç¤ºã€‚åœ¨å›¾ä¸­ï¼Œè¿æ¥åˆ°è‡‚æœ«ç«¯çš„ç£ç›˜å¤´ä½äºæ‰‡åŒº 6 ä¸Šæ–¹ï¼Œå¹¶ä¸”è¡¨é¢é€†æ—¶é’ˆæ—‹è½¬ã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:3:1","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 å•ç£é“å»¶è¿Ÿï¼šæ—‹è½¬å»¶è¿Ÿ ä¸ºäº†äº†è§£ç®€å•çš„å•ç£é“ç£ç›˜å¦‚ä½•å¤„ç†è¯·æ±‚ï¼Œè®¾æƒ³æˆ‘ä»¬ç°åœ¨æ”¶åˆ°ä¸€ä¸ªè¯»å– 0 å·æ•°æ®å—çš„è¯·æ±‚ã€‚ç£ç›˜åº”å¦‚ä½•å¤„ç†è¯¥è¯·æ±‚ï¼Ÿ åœ¨æˆ‘ä»¬çš„ç®€å•ç£ç›˜ä¸­ï¼Œç£ç›˜æ— éœ€åšå¤ªå¤šå·¥ä½œã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒå¿…é¡»ç­‰å¾…æ‰€éœ€çš„æ‰‡åŒºåœ¨ç£å¤´ä¸‹æ—‹è½¬ã€‚è¿™ç§ç­‰å¾…åœ¨ç°ä»£ç¡¬ç›˜ä¸­ç»å¸¸å‘ç”Ÿï¼Œæ˜¯ I/O æœåŠ¡æ—¶é—´çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå› æ­¤æœ‰ä¸€ä¸ªä¸“é—¨çš„åç§°ï¼šæ—‹è½¬å»¶è¿Ÿã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œå¦‚æœå…¨éƒ¨æ—‹è½¬å»¶è¿Ÿä¸º$R$ï¼Œé‚£ä¹ˆç£ç›˜åœ¨ç­‰å¾… 0 è¿›å…¥è¯»/å†™ç£å¤´ï¼ˆå¦‚æœæˆ‘ä»¬ä» 6 å¼€å§‹ï¼‰æ—¶ï¼Œéœ€è¦å¤§çº¦ $\\frac{R}{2}$ çš„æ—‹è½¬å»¶è¿Ÿã€‚åœ¨æ­¤å•ç£é“ä¸Šï¼Œæœ€åçš„æƒ…å†µæ˜¯å‘æ‰‡åŒº 5 æå‡ºè¯·æ±‚ï¼Œä¸ºäº†æ»¡è¶³è¿™æ ·çš„è¯·æ±‚ï¼Œç£ç›˜å‡ ä¹è¦äº§ç”Ÿä¸€ä¸ªå®Œæ•´çš„æ—‹è½¬å»¶è¿Ÿã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:3:2","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 å¤šç£é“ï¼šå¯»é“æ—¶é—´ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„ç£ç›˜åªæœ‰ä¸€æ¡ç£é“ï¼Œè¿™ä¸å¤ªç°å®ï¼›ç°ä»£ç£ç›˜å½“ç„¶æœ‰æ•°ç™¾ä¸‡æ¡ç£é“ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ›´åŠ é€¼çœŸçš„ç£ç›˜è¡¨é¢ï¼Œè¿™ä¸ªç£ç›˜æœ‰ä¸‰ä¸ªç£é“å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ åœ¨å›¾ä¸­ï¼Œç£å¤´å½“å‰ä½äºæœ€å†…ä¾§çš„ç£é“ä¸Šï¼ˆåŒ…å« 24 åˆ° 35 ä¸ªæ‰‡åŒºï¼‰ï¼›ä¸‹ä¸€ä¸ªç£é“åŒ…å«ä¸‹ä¸€ç»„æ‰‡åŒºï¼ˆ12 åˆ° 23ï¼‰ï¼Œæœ€å¤–ä¾§çš„ç£é“åŒ…å«ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼ˆ0 åˆ° 11ï¼‰ã€‚ ä¸ºäº†äº†è§£é©±åŠ¨å™¨å¦‚ä½•è®¿é—®ç»™å®šæ‰‡åŒºï¼Œæˆ‘ä»¬ç°åœ¨è·Ÿè¸ªå¯¹è¿œç¨‹æ‰‡åŒºçš„è¯·æ±‚ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œä¾‹å¦‚ï¼Œå¯¹æ‰‡åŒº 11 çš„è¯»å–ã€‚ä¸ºäº†æœåŠ¡æ­¤è¯»å–ï¼Œé©±åŠ¨å™¨å¿…é¡»é¦–å…ˆå°†ç£ç›˜è‡‚ç§»åŠ¨åˆ°æ­£ç¡®çš„ç£é“ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºæœ€å¤–å±‚ï¼‰ï¼Œè¿™ä¸€è¿‡ç¨‹ç§°ä¸ºå¯»é“ã€‚æŸ¥æ‰¾å’Œæ—‹è½¬æ˜¯æˆæœ¬æœ€é«˜çš„ç£ç›˜æ“ä½œä¹‹ä¸€ã€‚ åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œå¯»é“æœ‰å¤šä¸ªé˜¶æ®µï¼šé¦–å…ˆæ˜¯ç£ç›˜è‡‚ç§»åŠ¨çš„åŠ é€Ÿé˜¶æ®µï¼›ç„¶åå½“ç£ç›˜è‡‚å…¨é€Ÿç§»åŠ¨æ—¶æ»‘è¡Œï¼Œç„¶åå½“ç£ç›˜è‡‚å‡æ…¢æ—¶å‡é€Ÿï¼›å½“ç£å¤´å°å¿ƒåœ°å®šä½åœ¨æ­£ç¡®çš„ç£é“ä¸Šæ—¶ï¼Œæœ€ç»ˆç¨³å®šä¸‹æ¥ã€‚ç¨³å®šæ—¶é—´é€šå¸¸éå¸¸é‡è¦ï¼Œä¾‹å¦‚ 0.5 åˆ° 2 æ¯«ç§’ï¼Œå› ä¸ºé©±åŠ¨å™¨å¿…é¡»ç¡®ä¿æ‰¾åˆ°æ­£ç¡®çš„ç£é“ã€‚ å¯»é“åï¼Œç£ç›˜è‡‚å°†ç£å¤´å®šä½åœ¨æ­£ç¡®çš„ç£é“ä¸Šã€‚ä¸‹å›¾æè¿°äº†å¯»é“ã€‚ æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œåœ¨å¯»é“è¿‡ç¨‹ä¸­ï¼Œç£ç›˜è‡‚å·²ç§»åŠ¨åˆ°æ‰€éœ€çš„ç£é“ï¼Œå¹¶ä¸”ç›˜ç‰‡å½“ç„¶ä¹Ÿæ—‹è½¬äº†ï¼Œåœ¨æœ¬ä¾‹ä¸­å¤§çº¦æ—‹è½¬äº† 3 ä¸ªæ‰‡åŒºã€‚è¿™æ ·ï¼Œæ‰‡åŒº9å³å°†ä»ç£å¤´ä¸‹æ–¹ç»è¿‡ï¼Œæˆ‘ä»¬åªéœ€å¿å—çŸ­æš‚çš„æ—‹è½¬å»¶è¿Ÿå³å¯å®Œæˆä¼ è¾“ã€‚ å½“æ‰‡åŒº 11 ç»è¿‡ç£ç›˜å¤´ä¸‹æ–¹æ—¶ï¼Œå°†å‘ç”Ÿ I/O çš„æœ€åé˜¶æ®µï¼Œç§°ä¸ºä¼ è¾“ï¼Œå…¶ä¸­æ•°æ®ä»è¡¨é¢è¯»å–æˆ–å†™å…¥è¡¨é¢ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº† I/O æ—¶é—´çš„å®Œæ•´æƒ…å†µï¼šé¦–å…ˆæ˜¯å¯»é“ï¼Œç„¶åç­‰å¾…æ—‹è½¬å»¶è¿Ÿï¼Œæœ€åæ˜¯ä¼ è¾“ã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:3:3","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 å…¶ä»–ä¸€äº›ç»†èŠ‚ å…³äºç¡¬ç›˜é©±åŠ¨å™¨çš„è¿è¡Œæ–¹å¼è¿˜æœ‰ä¸€äº›å…¶ä»–æœ‰è¶£çš„ç»†èŠ‚ã€‚è®¸å¤šé©±åŠ¨å™¨é‡‡ç”¨æŸç§ç£é“å€¾æ–œæ¥ç¡®ä¿å³ä½¿åœ¨è·¨è¶Šç£é“è¾¹ç•Œæ—¶ä¹Ÿå¯ä»¥æ­£ç¡®æœåŠ¡é¡ºåºè¯»å–ã€‚åœ¨æˆ‘ä»¬çš„ç®€å•ç¤ºä¾‹ç£ç›˜ä¸­ï¼Œè¿™å¯èƒ½å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ‰‡åŒºé€šå¸¸ä¼šå‡ºç°è¿™æ ·çš„å€¾æ–œï¼Œå› ä¸ºä»ä¸€ä¸ªç£é“åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç£é“æ—¶ï¼Œç£ç›˜éœ€è¦æ—¶é—´æ¥é‡æ–°å®šä½ç£å¤´ï¼ˆç”šè‡³æ˜¯ç›¸é‚»çš„ç£é“ï¼‰ã€‚å¦‚æœæ²¡æœ‰è¿™ç§åæ–œï¼Œç£å¤´ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç£é“ï¼Œä½†æ‰€éœ€çš„ä¸‹ä¸€ä¸ªåŒºå—å·²ç»åœ¨ç£å¤´ä¸‹æ–¹æ—‹è½¬ï¼Œå› æ­¤ç¡¬ç›˜éœ€è¦ç­‰å¾…å‡ ä¹æ•´ä¸ªæ—‹è½¬å»¶è¿Ÿæ‰èƒ½è®¿é—®ä¸‹ä¸€ä¸ªåŒºå—ã€‚ å¦ä¸€ä¸ªå®é™…æƒ…å†µæ˜¯ï¼Œå¤–ç£é“å¾€å¾€æ¯”å†…ç£é“æœ‰æ›´å¤šçš„æ‰‡åŒºï¼Œè¿™æ˜¯å‡ ä½•å­¦çš„ç»“æœï¼›å› ä¸ºå¤–ç£é“æœ‰æ›´å¤šçš„ç©ºé—´ã€‚è¿™äº›ç£é“é€šå¸¸è¢«ç§°ä¸ºå¤šåˆ†åŒºç£ç›˜é©±åŠ¨å™¨ï¼Œå³ç£ç›˜è¢«ç»„ç»‡æˆå¤šä¸ªåŒºï¼Œä¸€ä¸ªåŒºæ˜¯è¡¨é¢ä¸Šè¿ç»­çš„ä¸€ç»„ç£é“ã€‚æ¯ä¸ªåŒºçš„æ¯ä¸ªç£é“éƒ½æœ‰ç›¸åŒæ•°é‡çš„æ‰‡åŒºï¼Œå¤–åŒºçš„æ‰‡åŒºæ•°é‡å¤šäºå†…åŒºã€‚ æœ€åï¼Œç°ä»£ç£ç›˜é©±åŠ¨å™¨çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†æ˜¯ç¼“å­˜ï¼Œç”±äºå†å²åŸå› ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºç£é“ç¼“å†²åŒºã€‚è¿™ç§ç¼“å­˜åªæ˜¯ä¸€å°éƒ¨åˆ†å†…å­˜ï¼ˆé€šå¸¸çº¦ä¸º 8 æˆ– 16 MBï¼‰ï¼Œç£ç›˜é©±åŠ¨å™¨å¯ä»¥ç”¨å®ƒæ¥ä¿å­˜ä»ç£ç›˜è¯»å–æˆ–å†™å…¥ç£ç›˜çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œä»ç£ç›˜è¯»å–æ‰‡åŒºæ—¶ï¼Œç£ç›˜é©±åŠ¨å™¨å¯èƒ½ä¼šå†³å®šè¯»å…¥è¯¥ç£é“ä¸Šçš„æ‰€æœ‰æ‰‡åŒºï¼Œå¹¶å°†å…¶ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼›è¿™æ ·åšå¯è®©ç£ç›˜é©±åŠ¨å™¨å¿«é€Ÿå“åº”å¯¹åŒä¸€ç£é“çš„ä»»ä½•åç»­è¯·æ±‚ã€‚ åœ¨å†™å…¥æ—¶ï¼Œç£ç›˜é©±åŠ¨å™¨å¯ä»¥é€‰æ‹©ï¼šæ˜¯åœ¨å°†æ•°æ®å­˜å…¥å†…å­˜æ—¶ç¡®è®¤å†™å…¥å·²å®Œæˆï¼Œè¿˜æ˜¯åœ¨æ•°æ®å®é™…å†™å…¥ç£ç›˜åç¡®è®¤ï¼Ÿå‰è€…ç§°ä¸ºå›å†™ç¼“å­˜ï¼ˆæœ‰æ—¶ä¹Ÿç§°ä¸ºå³æ—¶æŠ¥å‘Šï¼‰ï¼Œåè€…ç§°ä¸ºç›´å†™ç¼“å­˜ã€‚å›å†™ç¼“å­˜æœ‰æ—¶ä¼šè®©ç£ç›˜é©±åŠ¨å™¨çœ‹èµ·æ¥ â€œæ›´å¿«â€ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯å±é™©çš„ï¼›å¦‚æœæ–‡ä»¶ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºè¦æ±‚æŒ‰ä¸€å®šé¡ºåºå°†æ•°æ®å†™å…¥ç£ç›˜ä»¥ä¿è¯æ­£ç¡®æ€§ï¼Œå›å†™ç¼“å­˜å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:3:4","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 I/Oæ—¶é—´ ç°åœ¨æˆ‘ä»¬æœ‰äº†ç£ç›˜çš„æŠ½è±¡æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡ä¸€äº›åˆ†ææ¥æ›´å¥½åœ°äº†è§£ç£ç›˜æ€§èƒ½ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å°† I/O æ—¶é—´è¡¨ç¤ºä¸ºä¸‰ä¸ªä¸»è¦éƒ¨åˆ†çš„æ€»å’Œï¼š $$ T_{I/O}=T_{seek}+T_{rotation}+T_{transfer} $$ è¯·æ³¨æ„ï¼ŒI/O é€Ÿç‡ ($R_{I/O}$) é€šå¸¸æ›´å®¹æ˜“ç”¨äºé©±åŠ¨å™¨ä¹‹é—´çš„æ¯”è¾ƒï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œå¯ä»¥è½»æ¾åœ°æ ¹æ®æ—¶é—´è®¡ç®—å‡ºæ¥ã€‚åªéœ€å°†ä¼ è¾“å¤§å°é™¤ä»¥æ‰€èŠ±è´¹çš„æ—¶é—´å³å¯ï¼š $$ R_{I/O}=\\frac{Size_{Transfer}}{T_{I/O}} $$ ä¸ºäº†æ›´å¥½åœ°äº†è§£ I/O æ—¶é—´ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹è®¡ç®—ã€‚å‡è®¾æœ‰ä¸¤ä¸ªæˆ‘ä»¬æ„Ÿå…´è¶£çš„å·¥ä½œè´Ÿè½½ã€‚ç¬¬ä¸€ä¸ªç§°ä¸ºéšæœºå·¥ä½œè´Ÿè½½ï¼Œå‘ç£ç›˜ä¸Šçš„éšæœºä½ç½®å‘å‡ºå°ï¼ˆä¾‹å¦‚ 4KBï¼‰è¯»å–ã€‚éšæœºå·¥ä½œè´Ÿè½½åœ¨è®¸å¤šé‡è¦åº”ç”¨ç¨‹åºä¸­å¾ˆå¸¸è§ï¼ŒåŒ…æ‹¬æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚ç¬¬äºŒç§ç§°ä¸ºé¡ºåºå·¥ä½œè´Ÿè½½\u003c/ï¼Œå®ƒåªæ˜¯ä»ç£ç›˜è¿ç»­è¯»å–å¤§é‡æ‰‡åŒºï¼Œè€Œä¸ä¼šè·³è½¬ã€‚é¡ºåºè®¿é—®æ¨¡å¼éå¸¸å¸¸è§ï¼Œå› æ­¤ä¹Ÿå¾ˆé‡è¦ã€‚ ä¸ºäº†äº†è§£éšæœºå·¥ä½œè´Ÿè½½å’Œé¡ºåºå·¥ä½œè´Ÿè½½ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆå¯¹ç£ç›˜é©±åŠ¨å™¨åšå‡ºä¸€äº›å‡è®¾ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Seagateçš„å‡ æ¬¾ç°ä»£ç£ç›˜ã€‚ç¬¬ä¸€ä¸ªç§°ä¸º Cheetah 15K.5ï¼Œæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ SCSI é©±åŠ¨å™¨ã€‚ç¬¬äºŒä¸ªæ˜¯ Barracudaï¼Œæ˜¯ä¸€æ¬¾ä¸“ä¸ºå®¹é‡è€Œè®¾è®¡çš„ç¡¬ç›˜ã€‚ä¸¤è€…çš„è¯¦ç»†ä¿¡æ¯å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œè¿™äº›é©±åŠ¨å™¨å…·æœ‰æˆªç„¶ä¸åŒçš„ç‰¹å¾ï¼Œå¹¶ä¸”åœ¨è®¸å¤šæ–¹é¢å¾ˆå¥½åœ°æ¦‚æ‹¬äº†ç£ç›˜é©±åŠ¨å™¨å¸‚åœºçš„ä¸¤ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç¬¬ä¸€ä¸ªæ˜¯**â€œé«˜æ€§èƒ½â€é©±åŠ¨å™¨å¸‚åœºï¼Œè¯¥å¸‚åœºçš„é©±åŠ¨å™¨è®¾è®¡ä¸ºå°½å¯èƒ½å¿«åœ°æ—‹è½¬ã€æä¾›è¾ƒçŸ­çš„å¯»é“æ—¶é—´å¹¶å¿«é€Ÿä¼ è¾“æ•°æ®ã€‚ç¬¬äºŒä¸ªæ˜¯â€œå®¹é‡â€**å¸‚åœºï¼Œå…¶ä¸­æ¯å­—èŠ‚æˆæœ¬æ˜¯æœ€é‡è¦çš„æ–¹é¢ï¼›å› æ­¤ï¼Œé©±åŠ¨å™¨é€Ÿåº¦è¾ƒæ…¢ï¼Œä½†å¯ä»¥å°†å°½å¯èƒ½å¤šçš„ä½è£…å…¥å¯ç”¨ç©ºé—´ã€‚ æ ¹æ®è¿™äº›æ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹è®¡ç®—é©±åŠ¨å™¨åœ¨ä¸Šè¿°ä¸¤ç§å·¥ä½œè´Ÿè½½ä¸‹çš„è¡¨ç°å¦‚ä½•ã€‚è®©æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹éšæœºå·¥ä½œè´Ÿè½½ã€‚å‡è®¾æ¯æ¬¡ 4 KB è¯»å–å‘ç”Ÿåœ¨ç£ç›˜ä¸Šçš„éšæœºä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯æ¬¡æ­¤ç±»è¯»å–éœ€è¦å¤šé•¿æ—¶é—´ã€‚å…³äºCheetahï¼š $$ T_{seek}=4ms,T_{rotation}=2ms,T_{transfer}=30\\mu s $$ å¹³å‡å¯»é“æ—¶é—´ï¼ˆ4 æ¯«ç§’ï¼‰æ˜¯æ ¹æ®åˆ¶é€ å•†æŠ¥å‘Šçš„å¹³å‡æ—¶é—´å¾—å‡ºçš„ï¼›è¯·æ³¨æ„ï¼Œå®Œå…¨å¯»é“ï¼ˆä»è¡¨é¢çš„ä¸€ç«¯åˆ°å¦ä¸€ç«¯ï¼‰å¯èƒ½éœ€è¦ä¸‰å€çš„æ—¶é—´ã€‚ æ‰€æœ‰å¯»é“è·ç¦»çš„å¹³å‡å€¼ï¼ˆå¯¹äºå…·æœ‰Nä¸ªç£é“çš„ç£ç›˜ï¼‰ï¼Œåœ¨ä¸¤ä¸ªç£é“xå’Œyä¹‹é—´ã€‚ $\\frac{1}{N^2}\\sum\\limits_{x=0}^N\\sum\\limits_{y=0}^N|x-y|\\approx \\frac{1}{N^2}\\int_{x=0}^N\\int_{y=0}^N|x-y|dxdy=\\frac{1}{N^2}(\\frac{1}{3}x^3-\\frac{N}{2}x^2+\\frac{N^2}{2}x)|_0^N=\\frac{N}{3}$ å¹³å‡æ—‹è½¬å»¶è¿Ÿæ˜¯ç›´æ¥æ ¹æ®è½¬é€Ÿè®¡ç®—å‡ºæ¥çš„ã€‚15000 RPM ç­‰äº 250 RPSï¼ˆæ¯ç§’æ—‹è½¬æ¬¡æ•°ï¼‰ï¼›å› æ­¤ï¼Œæ¯æ¬¡æ—‹è½¬éœ€è¦ 4 æ¯«ç§’ã€‚ç£ç›˜å¹³å‡æ—‹è½¬åŠåœˆï¼Œå› æ­¤å¹³å‡æ—¶é—´ä¸º 2 æ¯«ç§’ã€‚æœ€åï¼Œä¼ è¾“æ—¶é—´åªæ˜¯å³°å€¼ä¼ è¾“é€Ÿç‡çš„ä¼ è¾“å¤§å°ï¼›åœ¨è¿™é‡Œï¼Œå®ƒéå¸¸å°ï¼Œåªéœ€30 å¾®ç§’ã€‚ å› æ­¤ï¼Œæ ¹æ®ä¸Šè¿°å…¬å¼ï¼ŒCheetahçš„ $T_{I/O}$å¤§æ¦‚ç­‰äº 6 æ¯«ç§’ã€‚è¦è®¡ç®— I/O é€Ÿç‡ï¼Œæˆ‘ä»¬åªéœ€ç”¨ä¼ è¾“å¤§å°é™¤ä»¥å¹³å‡æ—¶é—´ï¼Œå³å¯å¾—å‡º Cheetah åœ¨éšæœºå·¥ä½œè´Ÿè½½ä¸‹çš„ RI/O é€Ÿç‡çº¦ä¸º 0.66 MB/sã€‚å¯¹ Barracuda è¿›è¡ŒåŒæ ·çš„è®¡ç®—åï¼Œ$T_{I/O}$ çº¦ä¸º 13.2 æ¯«ç§’ï¼Œé€Ÿåº¦æ…¢äº†ä¸€å€å¤šï¼Œå› æ­¤ä¼ è¾“é€Ÿç‡çº¦ä¸º 0.31 MB/sã€‚ ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹é¡ºåºå·¥ä½œè´Ÿè½½ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾åœ¨è¿›è¡Œä¸€æ¬¡å¾ˆé•¿çš„ä¼ è¾“ä¹‹å‰ï¼Œæœ‰ä¸€æ¬¡å¯»é“å’Œæ—‹è½¬ã€‚ä¸ºç®€å•èµ·è§ï¼Œå‡è®¾ä¼ è¾“å¤§å°ä¸º 100 MBã€‚å› æ­¤ï¼ŒCheetah å’Œ Barracuda çš„ $T_{I/O}$åˆ†åˆ«çº¦ä¸º 800 æ¯«ç§’å’Œ 950 æ¯«ç§’ã€‚å› æ­¤ï¼ŒI/O é€Ÿç‡éå¸¸æ¥è¿‘ 125 MB/s å’Œ 105 MB/s çš„å³°å€¼ä¼ è¾“é€Ÿç‡ã€‚ä¸‹å›¾æ€»ç»“äº†è¿™äº›è®¡ç®—ã€‚ è¯¥å›¾å‘æˆ‘ä»¬å±•ç¤ºäº†ä¸€äº›é‡è¦ä¿¡æ¯ã€‚é¦–å…ˆï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œéšæœºå’Œé¡ºåºå·¥ä½œè´Ÿè½½ä¹‹é—´çš„ç¡¬ç›˜æ€§èƒ½å·®è·å¾ˆå¤§ï¼ŒCheetah å‡ ä¹ç›¸å·® 200 å€å·¦å³ï¼Œè€Œ Barracuda åˆ™ç›¸å·® 300 å€ä»¥ä¸Šã€‚è¿™å°±æ˜¯è®¡ç®—å²ä¸Šæœ€æ˜æ˜¾çš„è®¾è®¡æç¤ºã€‚ ç¬¬äºŒç‚¹æ›´ä¸ºå¾®å¦™ï¼šé«˜ç«¯ â€œæ€§èƒ½ â€œç¡¬ç›˜ä¸ä½ç«¯ â€œå®¹é‡ â€œç¡¬ç›˜ä¹‹é—´çš„æ€§èƒ½å·®å¼‚å¾ˆå¤§ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼ˆè¿˜æœ‰å…¶ä»–åŸå› ï¼‰ï¼Œäººä»¬å¾€å¾€æ„¿æ„èŠ±é«˜ä»·è´­ä¹°å‰è€…ï¼Œè€Œå°½å¯èƒ½ä¾¿å®œåœ°è´­ä¹°åè€…ã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:4:0","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 ç£ç›˜è°ƒåº¦ ç”±äº I/O çš„æˆæœ¬å¾ˆé«˜ï¼Œæ“ä½œç³»ç»Ÿåœ¨å†³å®šå‘ç£ç›˜å‘å‡º I/O çš„é¡ºåºæ–¹é¢ä¸€ç›´æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œç»™å®šä¸€ç»„ I/O è¯·æ±‚åï¼Œç£ç›˜è°ƒåº¦ç¨‹åºä¼šæ£€æŸ¥è¿™äº›è¯·æ±‚ï¼Œå¹¶å†³å®šä¸‹ä¸€æ­¥è°ƒåº¦å“ªä¸ªè¯·æ±‚ã€‚åœ¨ä½œä¸šè°ƒåº¦ä¸­ï¼Œæ¯ä¸ªä½œä¸šçš„é•¿åº¦é€šå¸¸æ˜¯æœªçŸ¥çš„ï¼Œè€Œç£ç›˜è°ƒåº¦åˆ™ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¥½åœ°çŒœæµ‹ä¸€ä¸ª â€œä½œä¸šâ€ï¼ˆå³ç£ç›˜è¯·æ±‚ï¼‰éœ€è¦å¤šé•¿æ—¶é—´ã€‚é€šè¿‡ä¼°ç®—è¯·æ±‚çš„å¯»é“æ—¶é—´å’Œå¯èƒ½çš„æ—‹è½¬å»¶è¿Ÿï¼Œç£ç›˜è°ƒåº¦ç¨‹åºå¯ä»¥çŸ¥é“æ¯ä¸ªè¯·æ±‚éœ€è¦å¤šé•¿æ—¶é—´ï¼Œä»è€Œï¼ˆè´ªå©ªåœ°ï¼‰æŒ‘é€‰å‡ºæœåŠ¡æ—¶é—´æœ€çŸ­çš„è¯·æ±‚ã€‚å› æ­¤ï¼Œç£ç›˜è°ƒåº¦ç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šå°½é‡éµå¾ª SJFï¼ˆæœ€çŸ­ä½œä¸šä¼˜å…ˆï¼‰åŸåˆ™ã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:5:0","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.1 SSTFï¼šæœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ ä¸€ç§æ—©æœŸçš„ç£ç›˜è°ƒåº¦æ–¹æ³•ç§°ä¸ºæœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ (SSTF)ï¼ˆä¹Ÿç§°ä¸ºæœ€çŸ­å¯»é“ä¼˜å…ˆæˆ– SSFï¼‰ã€‚ SSTF æŒ‰ç£é“å¯¹ I/O è¯·æ±‚é˜Ÿåˆ—è¿›è¡Œæ’åºï¼Œé€‰æ‹©æœ€è¿‘ç£é“ä¸Šçš„è¯·æ±‚é¦–å…ˆå®Œæˆã€‚ä¾‹å¦‚ï¼Œå‡è®¾ç£å¤´å½“å‰ä½ç½®åœ¨å†…ç£é“ä¸Šæ–¹ï¼Œå¹¶ä¸”æˆ‘ä»¬æœ‰å¯¹æ‰‡åŒº21ï¼ˆä¸­ç£é“ï¼‰å’Œ2ï¼ˆå¤–ç£é“ï¼‰çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå‘21å‘å‡ºè¯·æ±‚ï¼Œç­‰å¾…å…¶å®Œæˆï¼Œç„¶åå‘ 2 å‘å‡ºè¯·æ±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ SSTF åœ¨æ­¤ç¤ºä¾‹ä¸­æ•ˆæœå¾ˆå¥½ï¼Œé¦–å…ˆæœç´¢ä¸­ç£é“ï¼Œç„¶åæœç´¢å¤–ç£é“ã€‚ç„¶è€Œï¼ŒSSTF å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼ŒåŸå› å¦‚ä¸‹ã€‚é¦–å…ˆï¼Œé©±åŠ¨å™¨å‡ ä½•ç»“æ„å¯¹äºä¸»æœºæ“ä½œç³»ç»Ÿä¸å¯ç”¨ï¼›ç›¸åï¼Œå®ƒçœ‹åˆ°çš„æ˜¯ä¸€ä¸ªå—æ•°ç»„ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“è§£å†³ã€‚æ“ä½œç³»ç»Ÿå¯ä»¥ç®€å•åœ°å®ç°æœ€è¿‘å—ä¼˜å…ˆï¼ˆNBFï¼‰ï¼Œè€Œä¸æ˜¯ SSTFï¼Œå®ƒæ¥ä¸‹æ¥ä½¿ç”¨æœ€è¿‘çš„å—åœ°å€æ¥è°ƒåº¦è¯·æ±‚ã€‚ ç¬¬äºŒä¸ªé—®é¢˜æ›´ä¸ºæ ¹æœ¬ï¼šé¥¥é¥¿ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœç£å¤´å½“å‰æ‰€åœ¨çš„å†…éƒ¨è½¨é“æœ‰ç¨³å®šçš„è¯·æ±‚æµã€‚ç„¶åï¼Œçº¯ SSTF æ–¹æ³•å°†å®Œå…¨å¿½ç•¥å¯¹ä»»ä½•å…¶ä»–è½¨é“çš„è¯·æ±‚ã€‚å› æ­¤é—®é¢˜çš„å…³é”®æ˜¯ï¼šå¦‚ä½•å¤„ç†ç£ç›˜é¥¥é¥¿ï¼Ÿæˆ‘ä»¬å¦‚ä½•å®ç°ç±»ä¼¼ SSTF çš„è°ƒåº¦ä½†é¿å…é¥¥é¥¿ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:5:1","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.2 ç”µæ¢¯è°ƒåº¦ï¼ˆåˆç§° SCAN æˆ– C-SCANï¼‰ è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ—©åœ¨å‡ å¹´å‰å°±å·²æå‡ºï¼Œè€Œä¸”ç›¸å¯¹ç®€å•æ˜äº†ã€‚è¯¥ç®—æ³•æœ€åˆè¢«ç§°ä¸º SCANï¼Œå®ƒåªæ˜¯åœ¨ç£ç›˜ä¸Šæ¥å›ç§»åŠ¨ï¼ŒæŒ‰é¡ºåºåœ¨ç£é“ä¸Šå¤„ç†è¯·æ±‚ã€‚æˆ‘ä»¬æŠŠåœ¨ç£ç›˜ä¸Šçš„å•æ¬¡ç§»åŠ¨ï¼ˆä»å¤–ç£é“åˆ°å†…ç£é“ï¼Œæˆ–ä»å†…ç£é“åˆ°å¤–ç£é“ï¼‰ç§°ä¸ºä¸€æ¬¡æ‰«æã€‚å› æ­¤ï¼Œå¦‚æœç£é“ä¸Šçš„æŸä¸ªå—çš„è¯·æ±‚å·²ç»åœ¨è¿™æ¬¡ç£ç›˜æ‰«æä¸­å¾—åˆ°è¿‡å¤„ç†ï¼Œé‚£ä¹ˆè¯¥è¯·æ±‚ä¸ä¼šç«‹å³å¾—åˆ°å¤„ç†ï¼Œè€Œæ˜¯ä¼šæ’é˜Ÿç­‰å¾…ä¸‹ä¸€æ¬¡æ‰«æï¼ˆå¦ä¸€ä¸ªæ–¹å‘ï¼‰ã€‚ SCAN æœ‰è®¸å¤šå˜ä½“ï¼Œå…¶ä½œç”¨éƒ½å·®ä¸å¤šã€‚ä¾‹å¦‚ï¼ŒCoffman ç­‰äººæå‡ºäº† F-SCANï¼Œåœ¨è¿›è¡Œæ‰«ææ—¶å†»ç»“å¾…å¤„ç†é˜Ÿåˆ—ï¼›è¿™ä¸€æ“ä½œå°†æ‰«æè¿‡ç¨‹ä¸­æ”¶åˆ°çš„è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ï¼Œç¨åå†å¤„ç†ã€‚è¿™æ ·åšå¯ä»¥é€šè¿‡å»¶è¿ŸæœåŠ¡æ™šåˆ°ï¼ˆä½†è·ç¦»è¾ƒè¿‘ï¼‰çš„è¯·æ±‚æ¥é¿å…è¿œç«¯è¯·æ±‚çš„é¥¥é¥¿ã€‚ C-SCAN æ˜¯å¦ä¸€ç§å¸¸è§çš„å˜ä½“ï¼Œæ˜¯ Circular SCAN çš„ç¼©å†™ã€‚è¯¥ç®—æ³•ä¸æ˜¯åŒå‘æ‰«æç£ç›˜ï¼Œè€Œæ˜¯åªä»å¤–å‘å†…æ‰«æï¼Œç„¶ååœ¨å¤–å±‚ç£é“é‡ç½®ï¼Œé‡æ–°å¼€å§‹ã€‚è¿™æ ·åšå¯¹å†…ç£é“å’Œå¤–ç£é“éƒ½æ¯”è¾ƒå…¬å¹³ï¼Œå› ä¸ºçº¯ç²¹çš„æ¥å› SCAN ä¼šåå‘äºä¸­é—´ç£é“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰«æå®Œå¤–ç£é“åï¼ŒSCAN ä¼šç»è¿‡ä¸­é—´ç£é“ä¸¤æ¬¡ï¼Œç„¶åå†å›åˆ°å¤–ç£é“ã€‚ ç°åœ¨åº”è¯¥å¾ˆæ¸…æ¥šSCAN ç®—æ³•ï¼ˆåŠå…¶åŒç±»ç®—æ³•ï¼‰æœ‰æ—¶è¢«ç§°ä¸ºç”µæ¢¯ç®—æ³•çš„åŸå› ï¼Œå› ä¸ºå®ƒçš„è¡Œä¸ºå°±åƒä¸€éƒ¨ç”µæ¢¯ï¼Œè¦ä¹ˆä¸Šè¡Œï¼Œè¦ä¹ˆä¸‹è¡Œï¼Œè€Œä¸ä»…ä»…æ˜¯æ ¹æ®å“ªä¸ªæ¥¼å±‚æ›´è¿‘æ¥å¤„ç†å¯¹å“ªä¸ªæ¥¼å±‚çš„è¯·æ±‚ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä½ ä» 10 æ¥¼ä¸‹åˆ° 1 æ¥¼ï¼Œæœ‰äººåœ¨ 3 æ¥¼ä¸Šäº†ç”µæ¢¯å¹¶æŒ‰äº† 4 æ¥¼ï¼Œè€Œç”µæ¢¯å´å› ä¸º 4 æ¥¼æ¯” 1 æ¥¼ â€œè¿‘ â€œè€Œä¸Šäº† 4 æ¥¼ï¼Œé‚£è¯¥æœ‰å¤šçƒ¦äººï¼æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œç”µæ¢¯ç®—æ³•åœ¨ç°å®ç”Ÿæ´»ä¸­çš„ä½¿ç”¨ï¼Œå¯ä»¥é˜²æ­¢åœ¨ç”µæ¢¯ä¸Šå‘ç”Ÿæ‰“æ–—ã€‚åœ¨ç£ç›˜ä¸­ï¼Œå®ƒåªæ˜¯é˜²æ­¢é¥¥é¥¿ã€‚ é—æ†¾çš„æ˜¯ï¼ŒSCAN åŠå…¶ç±»ä¼¼æŠ€æœ¯å¹¶ä¸ä»£è¡¨æœ€å¥½çš„è°ƒåº¦æŠ€æœ¯ã€‚ç‰¹åˆ«æ˜¯ï¼ŒSCANï¼ˆç”šè‡³æ˜¯ SSTFï¼‰å®é™…ä¸Šå¹¶æ²¡æœ‰å°½å¯èƒ½åœ°éµå¾ª SJF åŸåˆ™ã€‚å°¤å…¶æ˜¯ï¼Œå®ƒä»¬å¿½ç•¥äº†æ—‹è½¬ã€‚å› æ­¤ï¼Œè¿™ä¹Ÿæ˜¯å¦ä¸€ä¸ªå…³é”®ç—‡ç»“æ‰€åœ¨ï¼šæˆ‘ä»¬å¦‚ä½•å®ç°ä¸€ä¸ªç®—æ³•ï¼Œæ›´åŠ æ¥è¿‘SJFï¼Œå¹¶è€ƒè™‘å¯»é“å’Œæ—‹è½¬ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:5:2","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.3 SPTFï¼š æœ€çŸ­å®šä½æ—¶é—´ä¼˜å…ˆ åœ¨è®¨è®ºæœ€çŸ­å®šä½æ—¶é—´ä¼˜å…ˆæˆ– SPTF è°ƒåº¦ï¼ˆæœ‰æ—¶ä¹Ÿç§°ä¸ºæœ€çŸ­è®¿é—®æ—¶é—´ä¼˜å…ˆæˆ– SATFï¼‰ï¼ˆè¿™æ˜¯æˆ‘ä»¬é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼‰ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç¡®ä¿æ›´è¯¦ç»†åœ°ç†è§£è¿™ä¸ªé—®é¢˜ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªä¾‹å­ã€‚ åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œç£å¤´å½“å‰ä½äºå†…è½¨é“çš„ç¬¬ 30 ä¸ªæ‰‡åŒºä¸Šæ–¹ã€‚å› æ­¤ï¼Œè°ƒåº¦ç¨‹åºå¿…é¡»å†³å®šï¼šä¸‹ä¸€ä¸ªè¯·æ±‚åº”è¯¥è°ƒåº¦ 16 å·æ‰‡åŒºï¼ˆä½äºä¸­é—´ç£é“ï¼‰è¿˜æ˜¯ 8 å·æ‰‡åŒºï¼ˆä½äºå¤–ç£é“ï¼‰ã€‚é‚£ä¹ˆï¼Œä¸‹ä¸€æ¬¡åº”è¯¥ä¸ºå“ªä¸ªæ‰‡åŒºæä¾›æœåŠ¡å‘¢ï¼Ÿ ç­”æ¡ˆå½“ç„¶æ˜¯ â€œè§†æƒ…å†µè€Œå®šâ€ã€‚è¿™é‡Œæ‰€è¯´çš„å–å†³äºå¯»é“æ—¶é—´ä¸æ—‹è½¬æ—¶é—´çš„ç›¸å¯¹æ¯”ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå¦‚æœå¯»é“æ—¶é—´è¿œé«˜äºæ—‹è½¬å»¶è¿Ÿï¼Œé‚£ä¹ˆ SSTFï¼ˆåŠå…¶å˜ä½“ï¼‰å°±æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ï¼Œè®¾æƒ³ä¸€ä¸‹ï¼š å¦‚æœå¯»é“æ—¶é—´æ¯”æ—‹è½¬æ—¶é—´å¿«å¾ˆå¤šã€‚é‚£ä¹ˆï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œåœ¨å¤–ç£é“ä¸Šè¿›ä¸€æ­¥å¯»é“ä»¥æœåŠ¡è¯·æ±‚ 8 å°†æ¯”åœ¨ä¸­é—´ç£é“ä¸Šæ‰§è¡Œè¾ƒçŸ­çš„å¯»é“ä»¥æœåŠ¡è¯·æ±‚ 16 æ›´æœ‰æ„ä¹‰ï¼Œå› ä¸ºè¯·æ±‚ 16 åœ¨ç»è¿‡ç£ç›˜å¤´ä¹‹å‰å¿…é¡»æ—‹è½¬ä¸€åœˆã€‚ å¦‚æœæ—‹è½¬æ—¶é—´æ¯”å¯»é“æ—¶é—´å¿«å¾ˆå¤šã€‚é‚£ä¹ˆï¼ŒæœåŠ¡è¯·æ±‚16åˆ™æ¯”æœåŠ¡è¯·æ±‚8æ›´å¥½ã€‚ å¦‚ä¸Šæ‰€è¿°ï¼Œåœ¨ç°ä»£ç¡¬ç›˜ä¸Šï¼Œå¯»é“å’Œæ—‹è½¬å¤§è‡´ç›¸åŒï¼ˆå½“ç„¶ï¼Œè¿™å–å†³äºå…·ä½“çš„è¯·æ±‚ï¼‰ï¼Œå› æ­¤ SPTF éå¸¸æœ‰ç”¨å¹¶èƒ½æé«˜æ€§èƒ½ã€‚ç„¶è€Œï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­å®ç° SPTF å°±æ›´åŠ å›°éš¾äº†ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿé€šå¸¸å¹¶ä¸æ¸…æ¥šç£é“è¾¹ç•Œçš„ä½ç½®æˆ–ç£å¤´å½“å‰çš„ä½ç½®ï¼ˆæ—‹è½¬æ„ä¹‰ä¸Šï¼‰ã€‚å› æ­¤ï¼ŒSPTF é€šå¸¸åœ¨ç¡¬ç›˜å†…éƒ¨æ‰§è¡Œã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:5:3","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.4 å…¶ä»–è°ƒåº¦é—®é¢˜ åœ¨ç®€è¦ä»‹ç»åŸºæœ¬ç£ç›˜æ“ä½œã€è°ƒåº¦å’Œç›¸å…³ä¸»é¢˜æ—¶ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è®¨è®ºå…¶ä»–è®¸å¤šé—®é¢˜ã€‚å…¶ä¸­ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šåœ¨ç°ä»£ç³»ç»Ÿä¸­ï¼Œç£ç›˜è°ƒåº¦æ˜¯åœ¨å“ªé‡Œæ‰§è¡Œçš„ï¼Ÿåœ¨æ—§ç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰çš„è°ƒåº¦å·¥ä½œéƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿå®Œæˆçš„ï¼›åœ¨æŸ¥çœ‹äº†ä¸€ç³»åˆ—å¾…å¤„ç†è¯·æ±‚åï¼Œæ“ä½œç³»ç»Ÿä¼šæŒ‘é€‰å‡ºæœ€ä½³è¯·æ±‚å¹¶å°†å…¶å‘é€ç»™ç£ç›˜ã€‚è¯¥è¯·æ±‚å®Œæˆåï¼Œå†é€‰æ‹©ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œä»¥æ­¤ç±»æ¨ã€‚é‚£æ—¶çš„ç£ç›˜æ¯”è¾ƒç®€å•ã€‚ åœ¨ç°ä»£ç³»ç»Ÿä¸­ï¼Œç£ç›˜å¯ä»¥å®¹çº³å¤šä¸ªæœªå¤„ç†è¯·æ±‚ï¼Œè€Œä¸”æœ¬èº«å°±æœ‰å¤æ‚çš„å†…éƒ¨è°ƒåº¦å™¨ï¼ˆå¯ä»¥å‡†ç¡®æ‰§è¡Œ SPTFï¼›åœ¨ç£ç›˜æ§åˆ¶å™¨å†…éƒ¨ï¼Œæ‰€æœ‰ç›¸å…³ç»†èŠ‚éƒ½æ˜¯å¯ç”¨çš„ï¼ŒåŒ…æ‹¬ç£å¤´çš„å‡†ç¡®ä½ç½®ï¼‰ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿè°ƒåº¦ç¨‹åºé€šå¸¸ä¼šé€‰æ‹©å®ƒè®¤ä¸ºæœ€å¥½çš„å‡ ä¸ªè¯·æ±‚ï¼ˆæ¯”å¦‚ 16 ä¸ªï¼‰ï¼Œå¹¶å°†å®ƒä»¬å…¨éƒ¨å‘é€ç»™ç£ç›˜ï¼›ç„¶åï¼Œç£ç›˜ä¼šåˆ©ç”¨å…¶å†…éƒ¨çš„ç£å¤´ä½ç½®çŸ¥è¯†å’Œè¯¦ç»†çš„ç£é“å¸ƒå±€ä¿¡æ¯ï¼Œä»¥æœ€ä½³çš„ï¼ˆSPTFï¼‰é¡ºåºä¸ºä¸Šè¿°è¯·æ±‚æä¾›æœåŠ¡ã€‚ ç£ç›˜è°ƒåº¦ç¨‹åºæ‰§è¡Œçš„å¦ä¸€é¡¹é‡è¦ç›¸å…³ä»»åŠ¡æ˜¯ I/O åˆå¹¶ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ç³»åˆ—è¯»å–åŒºå— 33ã€8ã€34 çš„è¯·æ±‚ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒåº¦ç¨‹åºåº”å°†å¯¹ç¬¬ 33 å’Œç¬¬ 34 å—çš„è¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ªå•ä¸€çš„åŒå—è¯·æ±‚ï¼›è°ƒåº¦ç¨‹åºæ‰€åšçš„ä»»ä½•é‡æ–°æ’åºéƒ½æ˜¯æ ¹æ®åˆå¹¶åçš„è¯·æ±‚æ‰§è¡Œçš„ã€‚åˆå¹¶åœ¨æ“ä½œç³»ç»Ÿå±‚é¢å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥å‡å°‘å‘é€åˆ°ç£ç›˜çš„è¯·æ±‚æ•°é‡ï¼Œä»è€Œé™ä½å¼€é”€ã€‚ ç°ä»£è°ƒåº¦ç¨‹åºè¦è§£å†³çš„æœ€åä¸€ä¸ªé—®é¢˜æ˜¯ï¼šåœ¨å‘ç£ç›˜å‘å‡º I/O ä¹‹å‰ï¼Œç³»ç»Ÿåº”è¯¥ç­‰å¾…å¤šé•¿æ—¶é—´ï¼Ÿäººä»¬å¯èƒ½ä¼šå¤©çœŸåœ°è®¤ä¸ºï¼Œç£ç›˜ä¸€æ—¦æœ‰äº†å“ªæ€•ä¸€ä¸ª I/Oï¼Œå°±åº”è¯¥ç«‹å³å‘é©±åŠ¨å™¨å‘å‡ºè¯·æ±‚ï¼›è¿™ç§æ–¹æ³•è¢«ç§°ä¸ºå·¥ä½œä¿æŠ¤ï¼Œå› ä¸ºå¦‚æœæœ‰è¯·æ±‚éœ€è¦æœåŠ¡ï¼Œç£ç›˜å°±æ°¸è¿œä¸ä¼šé—²ç½®ã€‚ç„¶è€Œï¼Œå¯¹é¢„æœŸç£ç›˜è°ƒåº¦çš„ç ”ç©¶è¡¨æ˜ï¼Œæœ‰æ—¶ç­‰å¾…ä¸€ä¸‹ä¼šæ›´å¥½ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„éå·¥ä½œä¿æŠ¤æ–¹æ³•ã€‚é€šè¿‡ç­‰å¾…ï¼Œæ–°çš„ã€â€œæ›´å¥½çš„ â€œè¯·æ±‚å¯èƒ½ä¼šåˆ°è¾¾ç£ç›˜ï¼Œä»è€Œæé«˜æ•´ä½“æ•ˆç‡ã€‚å½“ç„¶ï¼Œå†³å®šä½•æ—¶ç­‰å¾…ã€ç­‰å¾…å¤šé•¿æ—¶é—´å¯èƒ½å¾ˆæ£˜æ‰‹ã€‚ ","date":"2024-05-11","objectID":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/:5:4","tags":["OS"],"title":"ç¡¬ç›˜é©±åŠ¨å™¨","uri":"/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ç³»ç»Ÿæ¶æ„ ä¸ºäº†å¼€å§‹æˆ‘ä»¬çš„è®¨è®ºï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å…¸å‹ç³»ç»Ÿçš„â€œç»å…¸â€å›¾ã€‚ è¯¥å›¾æ˜¾ç¤ºäº†é€šè¿‡æŸç§å†…å­˜æ€»çº¿æˆ–äº’è¿è¿æ¥åˆ°ç³»ç»Ÿä¸»å†…å­˜çš„å•ä¸ª CPUã€‚ä¸€äº›è®¾å¤‡é€šè¿‡é€šç”¨ I/O æ€»çº¿è¿æ¥åˆ°ç³»ç»Ÿï¼Œåœ¨è®¸å¤šç°ä»£ç³»ç»Ÿä¸­ï¼Œè¯¥æ€»çº¿æ˜¯ PCIï¼ˆæˆ–å…¶ä¼—å¤šè¡ç”Ÿäº§å“ä¹‹ä¸€ï¼‰ï¼›æ˜¾å¡å’Œå…¶ä»–ä¸€äº›æ›´é«˜æ€§èƒ½çš„ I/O è®¾å¤‡å¯èƒ½ä¼šåœ¨è¿™é‡Œæ‰¾åˆ°ã€‚æœ€åï¼Œæ›´åº•å±‚çš„æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ä¸€ç§æˆ–å¤šç§å¤–å›´æ€»çº¿ï¼Œä¾‹å¦‚ SCSIã€SATA æˆ– USBã€‚å®ƒä»¬å°†æ…¢é€Ÿè®¾å¤‡è¿æ¥åˆ°ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç£ç›˜ã€é¼ æ ‡å’Œé”®ç›˜ã€‚ æ‚¨å¯èƒ½ä¼šé—®çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦è¿™æ ·çš„å±‚æ¬¡ç»“æ„ï¼Ÿç®€è€Œè¨€ä¹‹ï¼šç‰©ç†å’Œæˆæœ¬ã€‚å…¬å…±æ±½è½¦é€Ÿåº¦è¶Šå¿«ï¼Œå…¶é•¿åº¦å°±å¿…é¡»è¶ŠçŸ­ï¼›å› æ­¤ï¼Œé«˜æ€§èƒ½å†…å­˜æ€»çº¿æ²¡æœ‰å¤ªå¤šç©ºé—´æ¥æ’å…¥è®¾å¤‡ç­‰ã€‚æ­¤å¤–ï¼Œè®¾è®¡é«˜æ€§èƒ½æ€»çº¿çš„æˆæœ¬ç›¸å½“é«˜ã€‚å› æ­¤ï¼Œç³»ç»Ÿè®¾è®¡äººå‘˜é‡‡ç”¨äº†è¿™ç§åˆ†å±‚æ–¹æ³•ï¼Œå…¶ä¸­éœ€è¦é«˜æ€§èƒ½çš„ç»„ä»¶ï¼ˆä¾‹å¦‚æ˜¾å¡ï¼‰é è¿‘ CPUã€‚æ€§èƒ½è¾ƒä½çš„ç»„ä»¶è·ç¦»è¾ƒè¿œã€‚å°†ç£ç›˜å’Œå…¶ä»–æ…¢é€Ÿè®¾å¤‡æ”¾ç½®åœ¨å¤–å›´æ€»çº¿ä¸Šçš„å¥½å¤„æ˜¯å¤šæ–¹é¢çš„ã€‚ç‰¹åˆ«æ˜¯ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸Šæ”¾ç½®å¤§é‡è®¾å¤‡ã€‚ å½“ç„¶ï¼Œç°ä»£ç³»ç»Ÿè¶Šæ¥è¶Šå¤šåœ°ä½¿ç”¨ä¸“ç”¨èŠ¯ç‰‡ç»„å’Œæ›´å¿«çš„ç‚¹å¯¹ç‚¹äº’è¿æ¥æé«˜æ€§èƒ½ã€‚ä¸‹å›¾ä¸ºIntel Z270 èŠ¯ç‰‡ç»„çš„ç¤ºæ„å›¾ã€‚ åœ¨é¡¶éƒ¨ï¼ŒCPU ä¸å†…å­˜ç³»ç»Ÿçš„è¿æ¥æœ€ç´§å¯†ï¼Œä½†ä¹Ÿä¸æ˜¾å¡ï¼ˆä»¥åŠæ˜¾ç¤ºå™¨ï¼‰æœ‰é«˜æ€§èƒ½è¿æ¥ï¼Œä»¥æ”¯æŒæ¸¸æˆå’Œå…¶ä»–å›¾å½¢å¯†é›†å‹åº”ç”¨ç¨‹åºã€‚ CPU é€šè¿‡è‹±ç‰¹å°”ä¸“æœ‰çš„ DMIï¼ˆDirect Media Interface, ç›´æ¥åª’ä½“æ¥å£ï¼‰è¿æ¥åˆ° I/O èŠ¯ç‰‡ï¼Œå…¶ä½™è®¾å¤‡é€šè¿‡è®¸å¤šä¸åŒçš„äº’è¿è¿æ¥åˆ°è¯¥èŠ¯ç‰‡ã€‚å³ä¾§ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªç¡¬ç›˜é€šè¿‡eSATAæ¥å£è¿æ¥åˆ°ç³»ç»Ÿï¼› ATAï¼ˆAT é™„ä»¶ï¼ŒæŒ‡æä¾›ä¸ IBM PC AT çš„è¿æ¥ï¼‰ã€SATAï¼ˆä¸²è¡Œ ATAï¼‰å’Œç°åœ¨çš„ eSATAï¼ˆå¤–éƒ¨ SATAï¼‰ä»£è¡¨äº†è¿‡å»å‡ åå¹´æ¥å­˜å‚¨æ¥å£çš„æ¼”å˜ï¼Œæ¯å‘å‰ä¸€æ­¥éƒ½åœ¨å¢åŠ æ€§èƒ½ä¸ç°ä»£å­˜å‚¨è®¾å¤‡ä¿æŒåŒæ­¥ã€‚ I/O èŠ¯ç‰‡ä¸‹æ–¹æ˜¯è®¸å¤š USBï¼ˆUniversal Serial Bus, é€šç”¨ä¸²è¡Œæ€»çº¿ï¼‰è¿æ¥ï¼Œåœ¨æ­¤æè¿°ä¸­ï¼Œè¿™äº›è¿æ¥ä½¿é”®ç›˜å’Œé¼ æ ‡èƒ½å¤Ÿè¿æ¥åˆ°è®¡ç®—æœºã€‚åœ¨è®¸å¤šç°ä»£ç³»ç»Ÿä¸­ï¼ŒUSB ç”¨äºæ­¤ç±»ä½æ€§èƒ½è®¾å¤‡ã€‚ æœ€åï¼Œåœ¨å·¦ä¾§ï¼Œå…¶ä»–æ›´é«˜æ€§èƒ½çš„è®¾å¤‡å¯ä»¥é€šè¿‡ PCIeï¼ˆPeripheral Component Interconnect Expressï¼Œå¤–å›´ç»„ä»¶äº’è¿æ‰©å±•ï¼‰è¿æ¥åˆ°ç³»ç»Ÿã€‚åœ¨æ­¤å›¾ä¸­ï¼Œç½‘ç»œæ¥å£è¿æ¥åˆ°ç³»ç»Ÿï¼›æ›´é«˜æ€§èƒ½çš„å­˜å‚¨è®¾å¤‡ï¼ˆä¾‹å¦‚NVMeæŒä¹…å­˜å‚¨è®¾å¤‡ï¼‰é€šå¸¸è¿æ¥åœ¨è¿™é‡Œã€‚ ä¸‹å›¾æ˜¯ä¸€ä¸ªçœŸå®çš„é…å¤‡ Xeon E5-2600 v4 çš„åŒæ’æ§½æœåŠ¡å™¨ï¼Œå±•ç¤ºäº†ä¸¤ä¸ªCPUï¼ˆä¸­å¤®å¤„ç†å™¨ï¼‰åŠå…¶ç›¸å…³ç»„ä»¶çš„è¿æ¥æ–¹å¼ã€‚æ¯ä¸ªCPUéƒ½å…·æœ‰å¤šè¾¾22ä¸ªæ ¸å¿ƒï¼Œè¿™ä¸¤ä¸ªCPUé€šè¿‡QPIé“¾æ¥è¿æ¥ï¼Œç„¶åé€šè¿‡å†…å­˜æ§åˆ¶å™¨ä¸DRAMè¿æ¥ï¼ˆDDR4ï¼ˆDouble Data Rate 4ï¼‰æ˜¯ä¸€ç§å†…å­˜æ ‡å‡†ï¼Œå®ƒæä¾›äº†æ›´é«˜çš„æ•°æ®ä¼ è¾“é€Ÿç‡å’Œæ›´ä½çš„åŠŸè€—ï¼Œæ˜¯å½“å‰å¸¸è§çš„å†…å­˜ç±»å‹ï¼‰ã€‚æ­¤å¤–ï¼Œå®ƒä»¬è¿˜ä¸PCIeæ€»çº¿ç›¸è¿ï¼Œå¹¶åˆ†åˆ«æœ‰40æ¡PCIeçº¿è·¯åˆ°CPU1å’ŒCPU2ã€‚ CPUä¸ä¼—å¤šå¤–è®¾çš„è¿æ¥é€šå¸¸æ˜¯é€šè¿‡ä¸»æ¿ä¸Šçš„I/OèŠ¯ç‰‡ç»„å®ç°çš„ï¼Œè¿™ä¸ªèŠ¯ç‰‡ç»„åŒ…æ‹¬åŒ—æ¡¥ï¼ˆPCHï¼ŒPlatform Controller Hubï¼‰å’Œå—æ¡¥ï¼ˆICHï¼ŒI/O Controller Hubï¼‰ã€‚åœ¨è¾ƒæ–°çš„ç³»ç»Ÿä¸­ï¼Œè¿™äº›åŠŸèƒ½å¯èƒ½è¢«é›†æˆåˆ°ä¸€ä¸ªå•ä¸€çš„PCHèŠ¯ç‰‡ä¸­ã€‚DMIï¼ˆDirect Media Interfaceï¼‰æ˜¯CPUä¸PCHä¹‹é—´çš„ä¸€ç§é«˜é€Ÿè¿æ¥æ¥å£ï¼Œå®ƒå…è®¸CPUé€šè¿‡PCHä¸å„ç§å¤–è®¾è¿›è¡Œé€šä¿¡ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿçš„PCIeè¿æ¥å¸ƒå±€ã€‚ä»CPU Packageå¼€å§‹ï¼Œå®ƒé€šè¿‡Host Bridgeä¸Root Complex(RC)ç›¸è¿ã€‚åœ¨RCä¸­ï¼Œæœ‰å¤šä¸ªCoreä¸Memory Controllerç›¸è¿ã€‚PCIe Switchä½äºRCå’Œå¤–è®¾ä¹‹é—´ï¼Œç®¡ç†ç€æ•°æ®ä¼ è¾“ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰å¤šä¸ªPCIe Busã€PCIe Bridgeå’ŒPCIe Endpointã€‚æ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰å…¶å¯¹åº”çš„busã€devã€funã€priã€secå’Œsubçš„æ ‡è¯†ã€‚ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:1:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 è§„èŒƒè®¾å¤‡ ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªè§„èŒƒè®¾å¤‡ï¼ˆä¸æ˜¯çœŸå®çš„è®¾å¤‡ï¼‰ï¼Œå¹¶ä½¿ç”¨è¯¥è®¾å¤‡æ¥åŠ æ·±æˆ‘ä»¬å¯¹æé«˜è®¾å¤‡äº¤äº’æ•ˆç‡æ‰€éœ€çš„ä¸€äº›æœºåˆ¶çš„ç†è§£ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¾å¤‡æœ‰ä¸¤ä¸ªé‡è¦çš„ç»„ä»¶ã€‚ç¬¬ä¸€ä¸ªæ˜¯å®ƒå‘ç³»ç»Ÿå…¶ä½™éƒ¨åˆ†æä¾›çš„ç¡¬ä»¶æ¥å£ã€‚å°±åƒè½¯ä»¶ä¸€æ ·ï¼Œç¡¬ä»¶ä¹Ÿå¿…é¡»æä¾›æŸç§æ¥å£ï¼Œå…è®¸ç³»ç»Ÿè½¯ä»¶æ§åˆ¶å…¶æ“ä½œã€‚å› æ­¤ï¼Œæ‰€æœ‰è®¾å¤‡éƒ½æœ‰ä¸€äº›ç‰¹å®šçš„æ¥å£å’Œåè®®ç”¨äºå…¸å‹çš„äº¤äº’ã€‚ ä»»ä½•è®¾å¤‡çš„ç¬¬äºŒéƒ¨åˆ†æ˜¯å…¶å†…éƒ¨ç»“æ„ã€‚è®¾å¤‡çš„è¿™ä¸€éƒ¨åˆ†æ˜¯ç‰¹å®šäºå®ç°çš„ï¼Œè´Ÿè´£å®ç°è®¾å¤‡å‘ç³»ç»Ÿå‘ˆç°çš„æŠ½è±¡ã€‚éå¸¸ç®€å•çš„è®¾å¤‡å°†æœ‰ä¸€ä¸ªæˆ–å‡ ä¸ªç¡¬ä»¶èŠ¯ç‰‡æ¥å®ç°å…¶åŠŸèƒ½ï¼›æ›´å¤æ‚çš„è®¾å¤‡å°†åŒ…æ‹¬ä¸€ä¸ªç®€å•çš„ CPUã€ä¸€äº›é€šç”¨å†…å­˜å’Œå…¶ä»–ç‰¹å®šäºè®¾å¤‡çš„èŠ¯ç‰‡æ¥å®Œæˆå…¶å·¥ä½œã€‚ä¾‹å¦‚ï¼Œç°ä»£ RAID æ§åˆ¶å™¨å¯èƒ½åŒ…å«æ•°åä¸‡è¡Œå›ºä»¶ï¼ˆå³ç¡¬ä»¶è®¾å¤‡å†…çš„è½¯ä»¶ï¼‰æ¥å®ç°å…¶åŠŸèƒ½ã€‚ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:2:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 è§„èŒƒåè®® åœ¨ä¸Šå›¾ä¸­ï¼Œï¼ˆç®€åŒ–çš„ï¼‰è®¾å¤‡æ¥å£ç”±ä¸‰ä¸ªå¯„å­˜å™¨ç»„æˆï¼š çŠ¶æ€å¯„å­˜å™¨ï¼Œå¯é€šè¿‡è¯»å–çŠ¶æ€å¯„å­˜å™¨æ¥æŸ¥çœ‹è®¾å¤‡çš„å½“å‰çŠ¶æ€ï¼› å‘½ä»¤å¯„å­˜å™¨ï¼Œç”¨äºé€šçŸ¥è®¾å¤‡æ‰§è¡ŒæŸé¡¹ä»»åŠ¡ï¼› æ•°æ®å¯„å­˜å™¨ï¼Œç”¨äºå‘è®¾å¤‡ä¼ é€’æ•°æ®æˆ–ä»è®¾å¤‡è·å–æ•°æ®ã€‚ é€šè¿‡è¯»å†™è¿™äº›å¯„å­˜å™¨ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥æ§åˆ¶è®¾å¤‡çš„è¡Œä¸ºã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥æè¿°ä¸€ä¸‹æ“ä½œç³»ç»Ÿä¸è®¾å¤‡ä¹‹é—´å¯èƒ½è¿›è¡Œçš„å…¸å‹äº¤äº’ï¼Œä»¥ä¾¿è®©è®¾å¤‡ä»£è¡¨è‡ªå·±åšä¸€äº›äº‹æƒ…ã€‚åè®®å¦‚ä¸‹ï¼š While (STATUS == BUSY) ; // wait until device is not busy Write data to DATA register Write command to COMMAND register (Doing so starts the device and executes the command) While (STATUS == BUSY) ; // wait until device is done with your request è¯¥åè®®æœ‰å››ä¸ªæ­¥éª¤ã€‚ é¦–å…ˆï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡é‡å¤è¯»å–çŠ¶æ€å¯„å­˜å™¨æ¥ç­‰å¾…è®¾å¤‡å‡†å¤‡å¥½æ¥æ”¶å‘½ä»¤ï¼›æˆ‘ä»¬ç§°ä¹‹ä¸ºè½®è¯¢è®¾å¤‡ï¼ˆåŸºæœ¬ä¸Šï¼Œåªæ˜¯è¯¢é—®å‘ç”Ÿäº†ä»€ä¹ˆï¼‰ã€‚ å…¶æ¬¡ï¼Œæ“ä½œç³»ç»Ÿå°†ä¸€äº›æ•°æ®å‘é€åˆ°æ•°æ®å¯„å­˜å™¨ï¼›ä¾‹å¦‚ï¼Œå¯ä»¥æƒ³è±¡ï¼Œå¦‚æœè¿™æ˜¯ä¸€ä¸ªç£ç›˜ï¼Œåˆ™éœ€è¦è¿›è¡Œå¤šæ¬¡å†™å…¥æ‰èƒ½å°†ç£ç›˜å—ï¼ˆä¾‹å¦‚ 4KBï¼‰ä¼ è¾“åˆ°è®¾å¤‡ã€‚å½“ä¸» CPU å‚ä¸æ•°æ®ç§»åŠ¨æ—¶ï¼ˆå¦‚æœ¬ç¤ºä¾‹åè®®æ‰€ç¤ºï¼‰ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºç¼–ç¨‹ I/O (PIO)ã€‚ ç„¶åï¼Œæ“ä½œç³»ç»Ÿå‘å‘½ä»¤å¯„å­˜å™¨å†™å…¥å‘½ä»¤ï¼›è¿™æ ·åšä¼šéšå¼åœ°è®©è®¾å¤‡çŸ¥é“æ•°æ®å­˜åœ¨å¹¶ä¸”å®ƒåº”è¯¥å¼€å§‹å¤„ç†å‘½ä»¤ã€‚ æœ€åï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡å†æ¬¡å¾ªç¯è½®è¯¢è®¾å¤‡æ¥ç­‰å¾…è®¾å¤‡å®Œæˆï¼Œç­‰å¾…æŸ¥çœ‹å®ƒæ˜¯å¦å®Œæˆï¼ˆç„¶åå¯èƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯ä»£ç æ¥æŒ‡ç¤ºæˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚ è¿™ä¸ªåŸºæœ¬åè®®çš„ä¼˜ç‚¹æ˜¯ç®€å•ä¸”æœ‰æ•ˆã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿå­˜åœ¨ä¸€äº›ä½æ•ˆç‡å’Œä¸ä¾¿ä¹‹å¤„ã€‚æ‚¨å¯èƒ½åœ¨åè®®ä¸­æ³¨æ„åˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯è½®è¯¢ä¼¼ä¹æ•ˆç‡ä½ä¸‹ï¼›å…·ä½“æ¥è¯´ï¼Œå®ƒæµªè´¹äº†å¤§é‡çš„ CPU æ—¶é—´æ¥ç­‰å¾…ï¼ˆå¯èƒ½å¾ˆæ…¢çš„ï¼‰è®¾å¤‡å®Œæˆå…¶æ´»åŠ¨ï¼Œè€Œä¸æ˜¯åˆ‡æ¢åˆ°å¦ä¸€ä¸ªå°±ç»ªè¿›ç¨‹ï¼Œä»è€Œæ›´å¥½åœ°åˆ©ç”¨ CPUã€‚ æ‰€ä»¥é—®é¢˜å…³é”®æ˜¯æ“ä½œç³»ç»Ÿå¦‚ä½•åœ¨ä¸é¢‘ç¹è½®è¯¢çš„æƒ…å†µä¸‹æ£€æŸ¥è®¾å¤‡çŠ¶æ€ï¼Œä»è€Œé™ä½ç®¡ç†è®¾å¤‡æ‰€éœ€çš„ CPU å¼€é”€ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:3:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 é€šè¿‡ä¸­æ–­é™ä½ CPU å¼€é”€ å¤šå¹´å‰ï¼Œè®¸å¤šå·¥ç¨‹å¸ˆä¸ºäº†æ”¹å–„è¿™ç§äº¤äº’æ–¹å¼ï¼Œå‘æ˜äº†æˆ‘ä»¬å·²ç»è§è¿‡çš„ï¼šä¸­æ–­ã€‚æ“ä½œç³»ç»Ÿå¯ä»¥å‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œè®©è°ƒç”¨è¿›ç¨‹è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œç„¶ååˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ï¼Œè€Œä¸æ˜¯åå¤è½®è¯¢è®¾å¤‡ã€‚å½“è®¾å¤‡æœ€ç»ˆå®Œæˆæ“ä½œæ—¶ï¼Œå®ƒä¼šå¼•å‘ç¡¬ä»¶ä¸­æ–­ï¼Œå¯¼è‡´ CPU åœ¨é¢„å®šçš„ä¸­æ–­æœåŠ¡ä¾‹ç¨‹ï¼ˆISRï¼‰æˆ–æ›´ç®€å•çš„ä¸­æ–­å¤„ç†ç¨‹åºå¤„è·³è½¬åˆ°æ“ä½œç³»ç»Ÿã€‚å¤„ç†ç¨‹åºåªæ˜¯ä¸€æ®µæ“ä½œç³»ç»Ÿä»£ç ï¼Œå®ƒå°†å®Œæˆè¯·æ±‚ï¼ˆä¾‹å¦‚ï¼Œä»è®¾å¤‡è¯»å–æ•°æ®å’Œé”™è¯¯ä»£ç ï¼‰ï¼Œå¹¶å”¤é†’ç­‰å¾… I/O çš„è¿›ç¨‹ï¼Œç„¶åè¯¥è¿›ç¨‹å¯æŒ‰éœ€è¦ç»§ç»­è¿è¡Œã€‚ å› æ­¤ï¼Œä¸­æ–­å…è®¸è®¡ç®—å’Œ I/O é‡å ï¼Œè¿™æ˜¯æé«˜åˆ©ç”¨ç‡çš„å…³é”®ã€‚è¿™æ¡æ—¶é—´çº¿æ˜¾ç¤ºäº†é—®é¢˜æ‰€åœ¨ï¼š åœ¨å›¾ä¸­ï¼Œè¿›ç¨‹ 1 åœ¨ CPU ä¸Šè¿è¡Œä¸€æ®µæ—¶é—´ï¼ˆç”± CPU çº¿ä¸Šé‡å¤çš„ 1 è¡¨ç¤ºï¼‰ï¼Œç„¶åå‘ç£ç›˜å‘å‡º I/O è¯·æ±‚ä»¥è¯»å–ä¸€äº›æ•°æ®ã€‚åœ¨æ²¡æœ‰ä¸­æ–­çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿåªæ˜¯ç®€å•åœ°è‡ªæ—‹ï¼Œé‡å¤è½®è¯¢è®¾å¤‡çš„çŠ¶æ€ï¼Œç›´åˆ° I/O å®Œæˆï¼ˆç”± p è¡¨ç¤ºï¼‰ã€‚ç£ç›˜æœåŠ¡è¯¥è¯·æ±‚ï¼Œæœ€åè¿›ç¨‹ 1 å¯ä»¥å†æ¬¡è¿è¡Œã€‚ ç›¸åï¼Œå¦‚æœæˆ‘ä»¬åˆ©ç”¨ä¸­æ–­å¹¶å…è®¸é‡å ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥åœ¨ç­‰å¾…ç£ç›˜æ—¶æ‰§è¡Œå…¶ä»–æ“ä½œï¼š åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ“ä½œç³»ç»Ÿåœ¨ CPU ä¸Šè¿è¡Œè¿›ç¨‹ 2ï¼ŒåŒæ—¶ç£ç›˜æœåŠ¡è¿›ç¨‹ 1 çš„è¯·æ±‚ã€‚å½“ç£ç›˜è¯·æ±‚å®Œæˆæ—¶ï¼Œä¼šå‘ç”Ÿä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿå”¤é†’è¿›ç¨‹1å¹¶å†æ¬¡è¿è¡Œå®ƒã€‚è¿™æ ·ï¼ŒCPUå’Œç£ç›˜åœ¨ä¸­é—´çš„ä¸€æ®µæ—¶é—´å†…éƒ½å¾—åˆ°äº†é€‚å½“çš„åˆ©ç”¨ã€‚ è¯·æ³¨æ„ï¼Œä½¿ç”¨ä¸­æ–­å¹¶ä¸æ€»æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªè®¾å¤‡æ‰§è¡Œä»»åŠ¡çš„é€Ÿåº¦éå¸¸å¿«ï¼šç¬¬ä¸€æ¬¡è½®è¯¢é€šå¸¸ä¼šå‘ç°è¯¥è®¾å¤‡å·²å®Œæˆä»»åŠ¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ä¸­æ–­å®é™…ä¸Šä¼šå‡æ…¢ç³»ç»Ÿé€Ÿåº¦ï¼šåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ã€å¤„ç†ä¸­æ–­ä»¥åŠåˆ‡æ¢å›å‘å‡ºè¿›ç¨‹çš„æˆæœ¬å¾ˆé«˜ã€‚å› æ­¤ï¼Œå¦‚æœè®¾å¤‡é€Ÿåº¦å¾ˆå¿«ï¼Œæœ€å¥½è¿›è¡Œè½®è¯¢ï¼›å¦‚æœé€Ÿåº¦å¾ˆæ…¢ï¼Œé‚£ä¹ˆå…è®¸é‡å çš„ä¸­æ–­æ˜¯æœ€å¥½çš„ã€‚å¦‚æœè®¾å¤‡çš„é€Ÿåº¦æœªçŸ¥ï¼Œæˆ–è€…æœ‰æ—¶å¿«æœ‰æ—¶æ…¢ï¼Œæœ€å¥½ä½¿ç”¨æ··åˆè½®è¯¢ä¸€æ®µæ—¶é—´ï¼Œç„¶åå¦‚æœè®¾å¤‡å°šæœªå®Œæˆï¼Œåˆ™ä½¿ç”¨ä¸­æ–­ã€‚è¿™ç§åˆ†ä¸¤é˜¶æ®µçš„æ–¹æ³•å¯èƒ½ä¼šè¾¾åˆ°ä¸¤å…¨å…¶ç¾çš„æ•ˆæœã€‚ ä¸ä½¿ç”¨ä¸­æ–­çš„å¦ä¸€ä¸ªåŸå› å‡ºç°åœ¨ç½‘ç»œä¸­ã€‚å½“å¤§é‡ä¼ å…¥æ•°æ®åŒ…å‡äº§ç”Ÿä¸­æ–­æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šå‘ç”Ÿæ´»é”ï¼Œå³å‘ç°è‡ªå·±åªå¤„ç†ä¸­æ–­ï¼Œè€Œä¸å…è®¸ç”¨æˆ·çº§è¿›ç¨‹è¿è¡Œå¹¶å®é™…æœåŠ¡è¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ª Web æœåŠ¡å™¨ç”±äºæˆä¸ºé»‘å®¢æ–°é—»ä¸Šæ’åæœ€é«˜çš„æ¡ç›®è€Œç»å†äº†è´Ÿè½½çˆ†å‘ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½å¶å°”ä½¿ç”¨è½®è¯¢æ¥æ›´å¥½åœ°æ§åˆ¶ç³»ç»Ÿä¸­å‘ç”Ÿçš„æƒ…å†µï¼Œå¹¶å…è®¸ Web æœåŠ¡å™¨åœ¨è¿”å›è®¾å¤‡æ£€æŸ¥æ›´å¤šæ•°æ®åŒ…åˆ°è¾¾ä¹‹å‰ä¸ºæŸäº›è¯·æ±‚æä¾›æœåŠ¡ã€‚ å¦ä¸€ç§åŸºäºä¸­æ–­çš„ä¼˜åŒ–æ˜¯åˆå¹¶ã€‚åœ¨è¿™æ ·çš„è®¾ç½®ä¸­ï¼Œéœ€è¦å¼•å‘ä¸­æ–­çš„è®¾å¤‡é¦–å…ˆç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç„¶åå†å°†ä¸­æ–­ä¼ é€’ç»™ CPUã€‚åœ¨ç­‰å¾…æœŸé—´ï¼Œå…¶ä»–è¯·æ±‚å¯èƒ½å¾ˆå¿«å®Œæˆï¼Œå› æ­¤å¯ä»¥å°†å¤šä¸ªä¸­æ–­åˆå¹¶ä¸ºå•ä¸ªä¸­æ–­ä¼ é€’ï¼Œä»è€Œé™ä½ä¸­æ–­å¤„ç†çš„å¼€é”€ã€‚å½“ç„¶ï¼Œç­‰å¾…å¤ªä¹…ä¼šå¢åŠ è¯·æ±‚çš„å»¶è¿Ÿï¼Œè¿™æ˜¯ç³»ç»Ÿä¸­å¸¸è§çš„æƒè¡¡ã€‚ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:4:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 é€šè¿‡ DMA å®ç°æ›´é«˜æ•ˆçš„æ•°æ®ç§»åŠ¨ ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬çš„è§„èŒƒåè®®è¿˜æœ‰å¦ä¸€ä¸ªæ–¹é¢éœ€è¦æˆ‘ä»¬æ³¨æ„ã€‚ç‰¹åˆ«æ˜¯ï¼Œå½“ä½¿ç”¨ç¼–ç¨‹ I/O (PIO) å°†å¤§é‡æ•°æ®ä¼ è¾“åˆ°è®¾å¤‡æ—¶ï¼ŒCPU å†æ¬¡å› ä¸€é¡¹ç›¸å½“çç¢çš„ä»»åŠ¡è€Œè´Ÿæ‹…è¿‡é‡ï¼Œä»è€Œæµªè´¹äº†å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ï¼Œè€Œè¿™äº›æ—¶é—´å’Œç²¾åŠ›æœ¬æ¥å¯ä»¥æ›´å¥½åœ°èŠ±åœ¨è¿è¡Œä¸Šå…¶ä»–æµç¨‹ã€‚è¿™ä¸ªæ—¶é—´çº¿è¯´æ˜äº†è¿™ä¸ªé—®é¢˜ï¼š åœ¨æ—¶é—´çº¿ä¸­ï¼Œè¿›ç¨‹ 1 æ­£åœ¨è¿è¡Œï¼Œç„¶åå¸Œæœ›å°†ä¸€äº›æ•°æ®å†™å…¥ç£ç›˜ã€‚ç„¶åå®ƒå¯åŠ¨ I/Oï¼Œè¯¥ I/O å¿…é¡»å°†æ•°æ®ä»å†…å­˜æ˜¾å¼å¤åˆ¶åˆ°è®¾å¤‡ï¼Œä¸€æ¬¡ä¸€ä¸ªå­—ï¼ˆå›¾ä¸­æ ‡è®°ä¸º cï¼‰ã€‚å¤åˆ¶å®Œæˆåï¼ŒI/O å¼€å§‹åœ¨ç£ç›˜ä¸Šè¿›è¡Œï¼ŒCPU æœ€ç»ˆå¯ä»¥ç”¨äºå…¶ä»–ç”¨é€”ã€‚ å…³é”®ï¼šå¦‚ä½•é™ä½ PIO å¼€é”€ ä½¿ç”¨ PIOï¼ŒCPU ä¼šèŠ±è´¹å¤ªå¤šæ—¶é—´æ‰‹åŠ¨å°†æ•°æ®ç§»å…¥å’Œç§»å‡ºè®¾å¤‡ã€‚æˆ‘ä»¬å¦‚ä½•æ‰èƒ½å¸è½½è¿™é¡¹å·¥ä½œï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°åˆ©ç”¨ CPUï¼Ÿ è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ç›´æ¥å†…å­˜è®¿é—®ï¼ˆDMAï¼‰ã€‚DMA å¼•æ“æœ¬è´¨ä¸Šæ˜¯ç³»ç»Ÿä¸­ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„è®¾å¤‡ï¼Œå®ƒå¯ä»¥åœ¨è®¾å¤‡å’Œä¸»å†…å­˜ä¹‹é—´åè°ƒä¼ è¾“ï¼Œè€Œæ— éœ€ CPU çš„è¿‡å¤šå¹²é¢„ã€‚DMA çš„å·¥ä½œåŸç†å¦‚ä¸‹ã€‚ä»¥å‘è®¾å¤‡ä¼ è¾“æ•°æ®ä¸ºä¾‹ï¼Œæ“ä½œç³»ç»Ÿå°†å¯¹ DMA å¼•æ“è¿›è¡Œç¼–ç¨‹ï¼Œå‘Šè¯‰å®ƒæ•°æ®åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€éœ€è¦å¤åˆ¶å¤šå°‘æ•°æ®ä»¥åŠå‘é€åˆ°å“ªä¸ªè®¾å¤‡ã€‚ void setup_dma_transfer(void *source_address, void *destination_address, size_t data_size); æ­¤æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°±å®Œæˆäº†ä¼ è¾“ï¼Œå¯ä»¥ç»§ç»­å…¶ä»–å·¥ä½œã€‚å½“ DMA å®Œæˆæ—¶ï¼ŒDMA æ§åˆ¶å™¨ä¼šå‘å‡ºä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿå› æ­¤çŸ¥é“ä¼ è¾“å·²ç»å®Œæˆã€‚ä¿®æ”¹åçš„æ—¶é—´çº¿å¦‚ä¸‹ï¼š ä»æ—¶é—´è½´ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œå¤åˆ¶æ•°æ®çš„å·¥ä½œç°åœ¨ç”± DMA æ§åˆ¶å™¨è´Ÿè´£ã€‚å› ä¸ºåœ¨è¿™æ®µæ—¶é—´å†… CPU æ˜¯ç©ºé—²çš„ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥åšå…¶ä»–äº‹æƒ…ï¼Œè¿™é‡Œé€‰æ‹©è¿è¡Œè¿›ç¨‹ 2ã€‚è¿™æ ·ï¼Œåœ¨è¿›ç¨‹ 1 å†æ¬¡è¿è¡Œä¹‹å‰ï¼Œè¿›ç¨‹ 2 å¯ä»¥ä½¿ç”¨æ›´å¤šçš„ CPUã€‚ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:5:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 è®¾å¤‡äº¤äº’ ç°åœ¨æˆ‘ä»¬å¯¹æ‰§è¡Œ I/O æ‰€æ¶‰åŠçš„æ•ˆç‡é—®é¢˜æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œä¸ºäº†å°†è®¾å¤‡åˆå¹¶åˆ°ç°ä»£ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¤„ç†ä¸€äº›å…¶ä»–é—®é¢˜ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬è¿˜æ²¡æœ‰çœŸæ­£è°ˆè®ºæ“ä½œç³»ç»Ÿå¦‚ä½•ä¸è®¾å¤‡å®é™…é€šä¿¡ï¼å› æ­¤ï¼Œå…³é”®é—®é¢˜æ˜¯ï¼š ç¡¬ä»¶åº”è¯¥å¦‚ä½•ä¸è®¾å¤‡é€šä¿¡ï¼Ÿæ˜¯å¦åº”è¯¥æœ‰æ˜ç¡®çš„æŒ‡ç¤ºï¼Ÿæˆ–è€…è¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥åšåˆ°å—ï¼Ÿ éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå·²ç»å¼€å‘å‡ºä¸¤ç§ä¸»è¦çš„è®¾å¤‡é€šä¿¡æ–¹æ³•ã€‚ç¬¬ä¸€ç§ä¹Ÿæ˜¯æœ€å¤è€çš„æ–¹æ³•ï¼ˆIBM å¤§å‹æœºä½¿ç”¨äº†å¾ˆå¤šå¹´ï¼‰æ˜¯ä½¿ç”¨æ˜¾å¼ I/O æŒ‡ä»¤ã€‚è¿™äº›æŒ‡ä»¤æŒ‡å®šæ“ä½œç³»ç»Ÿå°†æ•°æ®å‘é€åˆ°ç‰¹å®šè®¾å¤‡å¯„å­˜å™¨çš„æ–¹å¼ï¼Œä»è€Œå…è®¸æ„å»ºä¸Šè¿°åè®®ã€‚ ä¾‹å¦‚ï¼Œåœ¨ x86 ç³»ç»Ÿä¸­ï¼Œin å’Œ out æŒ‡ä»¤å¯ç”¨äºä¸è®¾å¤‡é€šä¿¡ã€‚ä¾‹å¦‚ï¼Œè¦å‘è®¾å¤‡å‘é€æ•°æ®ï¼Œè°ƒç”¨è€…éœ€è¦æŒ‡å®šä¸€ä¸ªåŒ…å«æ•°æ®çš„å¯„å­˜å™¨å’Œä¸€ä¸ªå‘½åè®¾å¤‡çš„ç‰¹å®šç«¯å£ã€‚æ‰§è¡Œè¯¥æŒ‡ä»¤åï¼Œå°±ä¼šäº§ç”Ÿæ‰€éœ€çš„è¡Œä¸ºã€‚ æ­¤ç±»æŒ‡ä»¤é€šå¸¸å…·æœ‰ç‰¹æƒã€‚æ“ä½œç³»ç»Ÿæ§åˆ¶ç€è®¾å¤‡ï¼Œå› æ­¤æ“ä½œç³»ç»Ÿæ˜¯å”¯ä¸€å…è®¸ä¸è®¾å¤‡ç›´æ¥é€šä¿¡çš„å®ä½“ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä»»ä½•ç¨‹åºéƒ½èƒ½è¯»å†™ç£ç›˜ï¼Œé‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿéƒ½ä¼šé™·å…¥æ··ä¹±ï¼ˆä¸€å¦‚æ—¢å¾€ï¼‰ï¼Œå› ä¸ºä»»ä½•ç”¨æˆ·ç¨‹åºéƒ½å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´å®Œå…¨æ§åˆ¶æœºå™¨ã€‚ ä¸è®¾å¤‡äº¤äº’çš„ç¬¬äºŒç§æ–¹æ³•ç§°ä¸ºå†…å­˜æ˜ å°„ I/Oã€‚é‡‡ç”¨è¿™ç§æ–¹æ³•æ—¶ï¼Œç¡¬ä»¶ä¼šå°†è®¾å¤‡å¯„å­˜å™¨å½“ä½œå†…å­˜ä½ç½®æ¥ä½¿ç”¨ã€‚è¦è®¿é—®ç‰¹å®šå¯„å­˜å™¨ï¼Œæ“ä½œç³»ç»Ÿä¼šå‘å‡ºåŠ è½½ï¼ˆè¯»å–ï¼‰æˆ–å­˜å‚¨ï¼ˆå†™å…¥ï¼‰åœ°å€ï¼›ç„¶åç¡¬ä»¶ä¼šå°†åŠ è½½/å­˜å‚¨è·¯ç”±åˆ°è®¾å¤‡ï¼Œè€Œä¸æ˜¯ä¸»å†…å­˜ã€‚ è¿™ä¸¤ç§æ–¹æ³•å¹¶æ²¡æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚å†…å­˜æ˜ å°„æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ä¸éœ€è¦æ–°æŒ‡ä»¤æ¥æ”¯æŒï¼Œä½†è¿™ä¸¤ç§æ–¹æ³•ç›®å‰ä»åœ¨ä½¿ç”¨ã€‚ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:6:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 é€‚é…æ“ä½œç³»ç»Ÿï¼šè®¾å¤‡é©±åŠ¨ç¨‹åº æˆ‘ä»¬è¦è®¨è®ºçš„æœ€åä¸€ä¸ªé—®é¢˜æ˜¯ï¼šæˆ‘ä»¬å°†è®¨è®ºçš„æœ€åä¸€ä¸ªé—®é¢˜æ˜¯ï¼šå¦‚ä½•å°†å…·æœ‰éå¸¸ç‰¹å®šæ¥å£çš„è®¾å¤‡æ•´åˆåˆ°æ“ä½œç³»ç»Ÿä¸­ï¼Œè€Œä¸”æˆ‘ä»¬å¸Œæœ›ä¿æŒå°½å¯èƒ½é€šç”¨ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚æˆ‘ä»¬å¸Œæœ›æ„å»ºä¸€ä¸ªå¯ä»¥åœ¨SCSIç£ç›˜ã€IDEç£ç›˜ã€USBé—ªå­˜é©±åŠ¨å™¨ç­‰è®¾å¤‡ä¸Šè¿è¡Œçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬å¸Œæœ›æ–‡ä»¶ç³»ç»Ÿèƒ½ç›¸å¯¹å¿½ç•¥å¦‚ä½•å‘è¿™äº›ä¸åŒç±»å‹çš„é©±åŠ¨å™¨å‘å‡ºè¯»å–æˆ–å†™å…¥è¯·æ±‚çš„æ‰€æœ‰ç»†èŠ‚ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬é¢ä¸´çš„å…³é”®é—®é¢˜æ˜¯ï¼šå¦‚ä½•è®©æ“ä½œç³»ç»Ÿçš„å¤§éƒ¨åˆ†åŠŸèƒ½ä¿æŒè®¾å¤‡ä¸­ç«‹ï¼Œä»è€Œå°†è®¾å¤‡äº¤äº’çš„ç»†èŠ‚ä»ä¸»è¦çš„æ“ä½œç³»ç»Ÿå­ç³»ç»Ÿä¸­éšè—èµ·æ¥ï¼Ÿ è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡å¤è€çš„æŠ½è±¡æŠ€æœ¯æ¥è§£å†³ã€‚åœ¨æœ€åº•å±‚ï¼Œæ“ä½œç³»ç»Ÿä¸­çš„ä¸€ä¸ªè½¯ä»¶å¿…é¡»è¯¦ç»†äº†è§£è®¾å¤‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬ç§°è¿™ä¸€è½¯ä»¶ä¸ºè®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œè®¾å¤‡äº¤äº’çš„ä»»ä½•ç»†èŠ‚éƒ½å°è£…åœ¨å…¶ä¸­ã€‚ è®©æˆ‘ä»¬é€šè¿‡ç ”ç©¶ Linux æ–‡ä»¶ç³»ç»Ÿè½¯ä»¶æ ˆï¼Œçœ‹çœ‹è¿™ç§æŠ½è±¡å¦‚ä½•å¸®åŠ©æ“ä½œç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°ã€‚ä¸‹å›¾ç²—ç•¥æç»˜äº† Linux è½¯ä»¶çš„ç»„ç»‡ç»“æ„ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ–‡ä»¶ç³»ç»Ÿï¼ˆå½“ç„¶ä¹ŸåŒ…æ‹¬ä¸Šé¢çš„åº”ç”¨ç¨‹åºï¼‰å®Œå…¨ä¸å…³å¿ƒå®ƒæ‰€ä½¿ç”¨çš„ç£ç›˜ç±»çš„å…·ä½“æƒ…å†µï¼›å®ƒåªéœ€å‘é€šç”¨å—å±‚å‘å‡ºå—è¯»å†™è¯·æ±‚ï¼Œé€šç”¨å—å±‚ä¼šå°†è¿™äº›è¯·æ±‚è·¯ç”±åˆ°ç›¸åº”çš„è®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œè®¾å¤‡é©±åŠ¨ç¨‹åºä¼šå¤„ç†å‘å‡ºå…·ä½“è¯·æ±‚çš„ç»†èŠ‚ã€‚è™½ç„¶ç»è¿‡ç®€åŒ–ï¼Œä½†è¯¥å›¾æ˜¾ç¤ºäº†è¿™äº›ç»†èŠ‚æ˜¯å¦‚ä½•ä»æ“ä½œç³»ç»Ÿçš„å¤§éƒ¨åˆ†åŠŸèƒ½ä¸­éšè—èµ·æ¥çš„ã€‚ è¯¥å›¾è¿˜æ˜¾ç¤ºäº†è®¾å¤‡çš„åŸå§‹æ¥å£ï¼Œå®ƒä½¿ç‰¹æ®Šåº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å™¨æˆ–ç£ç›˜ç¢ç‰‡æ•´ç†å·¥å…·ï¼‰èƒ½å¤Ÿç›´æ¥è¯»å–å’Œå†™å…¥å—ï¼Œè€Œä¸ä½¿ç”¨æ–‡ä»¶æŠ½è±¡ã€‚å¤§å¤šæ•°ç³»ç»Ÿæä¾›è¿™ç§ç±»å‹çš„æ¥å£æ¥æ”¯æŒè¿™äº›ä½çº§å­˜å‚¨ç®¡ç†åº”ç”¨ç¨‹åºã€‚ è¯·æ³¨æ„ï¼Œä¸Šé¢çœ‹åˆ°çš„å°è£…ä¹Ÿæœ‰å…¶ç¼ºç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸€ä¸ªè®¾å¤‡å…·æœ‰è®¸å¤šç‰¹æ®ŠåŠŸèƒ½ï¼Œä½†å¿…é¡»å‘å†…æ ¸çš„å…¶ä½™éƒ¨åˆ†æä¾›é€šç”¨æ¥å£ï¼Œé‚£ä¹ˆè¿™äº›ç‰¹æ®ŠåŠŸèƒ½å°†ä¸ä¼šè¢«ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨å…·æœ‰ SCSI è®¾å¤‡çš„ Linux ä¸­å°±ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œè¿™äº›è®¾å¤‡å…·æœ‰éå¸¸ä¸°å¯Œçš„é”™è¯¯æŠ¥å‘Šï¼›å› ä¸ºå…¶ä»–å—è®¾å¤‡ï¼ˆä¾‹å¦‚ ATA/IDEï¼‰çš„é”™è¯¯å¤„ç†è¦ç®€å•å¾—å¤šï¼Œæ‰€ä»¥æ›´é«˜çº§åˆ«çš„è½¯ä»¶æ”¶åˆ°çš„åªæ˜¯é€šç”¨ EIOï¼ˆé€šç”¨ IO é”™è¯¯ï¼‰é”™è¯¯ä»£ç ï¼›å› æ­¤ï¼ŒSCSI å¯èƒ½æä¾›çš„ä»»ä½•é¢å¤–ç»†èŠ‚éƒ½ä¼šåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ä¸¢å¤±ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œç”±äºæ‚¨å¯èƒ½æ’å…¥ç³»ç»Ÿçš„ä»»ä½•è®¾å¤‡éƒ½éœ€è¦è®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œå› æ­¤éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå®ƒä»¬å·²ç»å æ®äº†å†…æ ¸ä»£ç çš„å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚å¯¹ Linux å†…æ ¸çš„ç ”ç©¶è¡¨æ˜ï¼Œè¶…è¿‡ 70% çš„æ“ä½œç³»ç»Ÿä»£ç éƒ½å­˜åœ¨äºè®¾å¤‡é©±åŠ¨ç¨‹åºä¸­ ï¼›å¯¹äºåŸºäº Windows çš„ç³»ç»Ÿï¼Œè¯¥å€¼å¯èƒ½ä¹Ÿç›¸å½“é«˜ã€‚å› æ­¤ï¼Œå½“äººä»¬å‘Šè¯‰æ‚¨æ“ä½œç³»ç»Ÿæœ‰æ•°ç™¾ä¸‡è¡Œä»£ç æ—¶ï¼Œä»–ä»¬çœŸæ­£è¯´çš„æ˜¯æ“ä½œç³»ç»Ÿæœ‰æ•°ç™¾ä¸‡è¡Œè®¾å¤‡é©±åŠ¨ç¨‹åºä»£ç ã€‚å½“ç„¶ï¼Œå¯¹äºä»»ä½•ç»™å®šçš„å®‰è£…ï¼Œå¤§éƒ¨åˆ†ä»£ç å¯èƒ½å¹¶ä¸æ´»è·ƒï¼ˆå³ï¼Œä¸€æ¬¡åªæœ‰å°‘æ•°è®¾å¤‡è¿æ¥åˆ°ç³»ç»Ÿï¼‰ã€‚ä¹Ÿè®¸æ›´ä»¤äººæ²®ä¸§çš„æ˜¯ï¼Œç”±äºé©±åŠ¨ç¨‹åºé€šå¸¸æ˜¯ç”±â€œä¸šä½™çˆ±å¥½è€…â€ï¼ˆè€Œä¸æ˜¯å…¨èŒå†…æ ¸å¼€å‘äººå‘˜ï¼‰ç¼–å†™çš„ï¼Œå› æ­¤å®ƒä»¬å¾€å¾€ä¼šå­˜åœ¨æ›´å¤šé”™è¯¯ï¼Œå› æ­¤æ˜¯å¯¼è‡´å†…æ ¸å´©æºƒçš„ä¸»è¦å› ç´ ã€‚ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:7:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 æ¡ˆä¾‹ç ”ç©¶ï¼šç®€å•çš„ IDE ç£ç›˜é©±åŠ¨ç¨‹åºï¼ˆxv6 ä½¿ç”¨ QEMU IDEï¼‰ ä¸ºäº†æ›´æ·±å…¥åœ°ç ”ç©¶ï¼Œè®©æˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸‹å®é™…çš„è®¾å¤‡ï¼šIDE ç£ç›˜é©±åŠ¨å™¨ã€‚æˆ‘ä»¬å°†æŸ¥çœ‹ xv6 æºä»£ç ï¼Œä»¥è·å–å·¥ä½œ IDE é©±åŠ¨ç¨‹åºçš„ç®€å•ç¤ºä¾‹ã€‚ IDE ç£ç›˜ä¸ºç³»ç»Ÿæä¾›äº†ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œç”±å››ç§ç±»å‹çš„å¯„å­˜å™¨ç»„æˆï¼š æ§åˆ¶å¯„å­˜å™¨ Address 0x3F6 = 0x80 (0000 1RE0): R=reset, E=0 means â€œenable interruptâ€ å‘½ä»¤å—å¯„å­˜å™¨ Address 0x1F0 = Data Port Address 0x1F1 = Error Address 0x1F2 = Sector Count Address 0x1F3 = LBA low byte (Logical Block Address) Address 0x1F4 = LBA mid byte Address 0x1F5 = LBA hi byte Address 0x1F6 = 1B1D TOP4LBA: B=LBA, D=drive Address 0x1F7 = Command/status çŠ¶æ€å¯„å­˜å™¨ Address 0x1F7 7 6 5 4 3 2 1 0 USY | EADY | AULT | EEK | RQ | ORR | DX/EX | RROR | é”™è¯¯å¯„å­˜å™¨ Address 0x1F1 7 6 5 4 3 2 1 0 BK | NC | C | DNF | CR | BRT | 0NF | MNF | BBK: Bad Block UNC: Uncorrectable data error MC: Media Changed IDNF: ID mark Not Found MCR: Media Change Requested ABRT: Command aborted T0NF: Track 0 Not Found AMNF: Address Mark Not Found æ§åˆ¶ã€å‘½ä»¤å—ã€çŠ¶æ€å’Œé”™è¯¯ã€‚é€šè¿‡ä½¿ç”¨ï¼ˆåœ¨ x86 ä¸Šï¼‰inå’Œout I/O æŒ‡ä»¤è¯»å–æˆ–å†™å…¥ç‰¹å®šçš„â€œI/O åœ°å€â€ï¼ˆä¾‹å¦‚ä¸‹é¢çš„ 0x3F6ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›å¯„å­˜å™¨ã€‚ ä¸è®¾å¤‡äº¤äº’çš„åŸºæœ¬åè®®å¦‚ä¸‹ï¼Œå‡è®¾è®¾å¤‡å·²ç»åˆå§‹åŒ–ã€‚ **ç­‰å¾…é©±åŠ¨å™¨å‡†å¤‡å°±ç»ªã€‚**è¯»å–çŠ¶æ€å¯„å­˜å™¨ (0x1F7)ï¼Œç›´åˆ°é©±åŠ¨å™¨å°±ç»ªä¸”ä¸ç¹å¿™ã€‚ **å°†å‚æ•°å†™å…¥å‘½ä»¤å¯„å­˜å™¨ã€‚**å°†æ‰‡åŒºè®¡æ•°ã€è¦è®¿é—®çš„æ‰‡åŒºçš„é€»è¾‘å—åœ°å€ (LBA) å’Œé©±åŠ¨å™¨ç¼–å·ï¼ˆä¸»é©±åŠ¨å™¨ = 0x00 æˆ–ä»é©±åŠ¨å™¨ = 0x10ï¼Œå› ä¸º IDE åªå…è®¸ä¸¤ä¸ªé©±åŠ¨å™¨ï¼‰å†™å…¥å‘½ä»¤å¯„å­˜å™¨ (0x1F2-0x1F6)ã€‚ **å¯åŠ¨I/Oã€‚**é€šè¿‡å‘å‘½ä»¤å¯„å­˜å™¨å‘å‡ºè¯»/å†™å‘½ä»¤ã€‚å°† READâ€”WRITE å‘½ä»¤å†™å…¥å‘½ä»¤å¯„å­˜å™¨ (0x1F7)ã€‚ æ•°æ®ä¼ è¾“ï¼ˆç”¨äºå†™å…¥ï¼‰ï¼šç­‰å¾…é©±åŠ¨å™¨çŠ¶æ€ä¸ºREADY å’ŒDRQï¼ˆé©±åŠ¨å™¨æ•°æ®è¯·æ±‚ï¼‰ï¼›å°†æ•°æ®å†™å…¥æ•°æ®ç«¯å£ã€‚ **å¤„ç†ä¸­æ–­ã€‚**åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œä¸ºæ¯ä¸ªä¼ è¾“çš„æ‰‡åŒºå¤„ç†ä¸€ä¸ªä¸­æ–­ï¼›æ›´å¤æ‚çš„æ–¹æ³•å…è®¸æ‰¹å¤„ç†ï¼Œä»è€Œåœ¨æ•´ä¸ªä¼ è¾“å®Œæˆæ—¶è¿›è¡Œæœ€åä¸€æ¬¡ä¸­æ–­ã€‚ **é”™è¯¯å¤„ç†ã€‚**æ¯æ¬¡æ“ä½œåï¼Œè¯»å–çŠ¶æ€å¯„å­˜å™¨ã€‚å¦‚æœ ERROR ä½æ‰“å¼€ï¼Œè¯»å–é”™è¯¯å¯„å­˜å™¨ä»¥äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚ è¯¥åè®®çš„å¤§éƒ¨åˆ†å†…å®¹å¯ä»¥åœ¨ xv6 IDE é©±åŠ¨ç¨‹åºä¸­æ‰¾åˆ°ï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼š struct buf { //chunk of 512B to read/write int flags; uint dev; uint sector; struct buf *prev; // LRU cache list struct buf *next; struct buf *qnext; // disk queue uchar data[512]; }; #define B_BUSY 0x1 // buffer is locked by some process #define B_VALID 0x2 // buffer has been read from disk #define B_DIRTY 0x4 // buffer needs to be written to disk static int ide_wait_ready() { while (((int r = inb(0x1f7)) \u0026 IDE_BSY) || !(r \u0026 IDE_DRDY)) ; // loop until drive isnâ€™t busy } static void ide_start_request(struct buf *b) { ide_wait_ready(); outb(0x3f6, 0); // generate interrupt outb(0x1f2, 1); // how many sectors? one // write LBA to command register outb(0x1f3, b-\u003esector \u0026 0xff); // LBA goes here ... LBA 0-7 outb(0x1f4, (b-\u003esector \u003e\u003e 8) \u0026 0xff); // ... and here LBA 8-15 outb(0x1f5, (b-\u003esector \u003e\u003e 16) \u0026 0xff); // ... and here! LBA 16-23 // 0x30 set LBA mode, ((b-\u003edev\u00261)\u003c\u003c4) æ ¹æ®è®¾å¤‡å·ï¼ˆb-\u003edevï¼‰æ¥è®¾ç½®ä¸»/ä»è®¾å¤‡ä½ã€‚è®¾å¤‡å·ä¸º 0 æˆ– 1ï¼Œå·¦ç§» 4 ä½åä¼šè®¾ç½®åˆ°æ§åˆ¶å¯„å­˜å™¨ä¸­ç›¸åº”çš„ä½ç½®ã€‚((b-\u003esector\u003e\u003e24)\u00260x0f) ç”¨äºæå– LBA çš„ç¬¬24åˆ°ç¬¬27ä½ï¼Œè¿™äº›ä½è¡¨ç¤ºæ‰‡åŒºåœ°å€çš„é«˜å››ä½ï¼Œç„¶åé€šè¿‡ä¸ 0x0f ä½æ©ç è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—æ¥è·å–è¿™äº›ä½ã€‚ outb(0x1f6, 0xe0 | ((b-\u003edev\u00261)\u003c\u003c4) | ((b-\u003esector\u003e\u003e24)\u00260x0f)); // B_DIRTYï¼šç¼“å†²åŒºæ•°æ®è¢«ä¿®æ”¹è¿‡ï¼›B_VALIDï¼šç¼“å†²åŒºæ•°æ®æœ‰æ•ˆ if(b-\u003eflags \u0026 B_DIRTY){ outb(0x1f7, IDE_CMD_WRITE); // this is a WRITEï¼Œå‘Šè¯‰ç£ç›˜æ§åˆ¶å™¨æ‰§è¡Œå†™å…¥æ“ä½œ outsl(0x1f0, b-\u003edata, 512/4); // transfer data too!å†™å…¥æ•°æ®å¯„å­˜å™¨ï¼Œoutslå‡½æ•°ä»¥32ä½ï¼ˆ4å­—èŠ‚ï¼‰ä¸ºå•ä½ä¼ è¾“æ•°æ®ã€‚ } else { outb(0x1f7, IDE_CMD_READ); // this is a READ (no data) å‘Šè¯‰ç£ç›˜æ§åˆ¶å™¨æ‰§è¡Œè¯»å–æ“ä½œã€‚ } } void ide_rw(struct buf *b) { acquire(\u0026ide_lock); // è·å–é”ï¼Œç¡®ä¿å¯¹é˜Ÿåˆ—çš„è®¿é—®æ˜¯å®‰å…¨çš„ for (struct buf **pp = \u0026ide_queue; *pp; pp=\u0026(*pp)-\u003eqnext) ; // éå†ç£ç›˜I/O è¯·æ±‚é˜Ÿåˆ—ï¼Œç§»åŠ¨åˆ°é˜Ÿå°¾ *pp = b; // add request to end if (ide_queue == b) // if q is emptyï¼Œåˆ™ç«‹å³å‘é€è¯·æ±‚ ide_start_request(b); // send req to disk while ((b-\u003eflags \u0026 (B_VALID|B_DIRTY)) != B_VALID) // ç›´åˆ°è¯·æ±‚çš„æ•°æ®çŠ¶æ€å˜ä¸ºæœ‰æ•ˆä¸ºæ­¢ sleep(b, \u0026ide_lock); // wait for completion release(\u0026ide_lock); } void ide_intr() { struct buf *b; acquire(\u0026ide_lock); // æ£€æŸ¥å½“å‰è¯·æ±‚æ˜¯å¦æ˜¯è¯»å–æ“ä½œå¹¶ä¸”ç£ç›˜å¤„äºå°±ç»ªçŠ¶æ€ if (!(b-\u003eflags \u0026 B_DIRTY) \u0026\u0026 ide_wait_ready() \u003e= 0) insl(0x1f0, b-\u003edata, 512/4); // if READ: get data b-\u003eflags |= B_VALID; // set flag to VALIDï¼Œè¡¨ç¤ºæ•°æ®å·²ç»è¢«è¯»å–æˆ–å†™å…¥ b-\u003eflags \u0026= ~B_DIRTY; // æ¸…é™¤DIRTY flag wakeup(b); // wake waiting process if ((ide_queue = b-\u003eqnext) != 0) // start next request ide_start_request(ide_queue); // (if one exists) release(\u0026ide_lock); } è¯¥é©±åŠ¨ç¨‹åºï¼ˆåˆå§‹åŒ–åï¼‰é€šè¿‡å››ä¸ªä¸»è¦å‡½æ•°å·¥ä½œã€‚ ç¬¬ä¸€ä¸ªæ˜¯ ide_rw()ï¼Œå®ƒå°†è¯·æ±‚æ’é˜Ÿï¼ˆå¦‚æœè¿˜æœ‰å…¶ä»–å¾…å¤„ç†çš„è¯·æ±‚ï¼‰ï¼Œæˆ–è€…ç›´æ¥å°†å…¶å‘é€åˆ°ç£ç›˜ï¼ˆé€šè¿‡ ide_start_request()ï¼‰ï¼›æ— è®ºå“ªç§æƒ…å†µï¼Œä¾‹ç¨‹éƒ½ä¼šç­‰å¾…è¯·æ±‚å®Œæˆå¹¶å°†è°ƒç”¨è¿›ç¨‹ç½®äºç¡çœ çŠ¶æ€ã€‚ ç¬¬äºŒä¸ªæ˜¯ ide_start_request()ï¼Œç”¨äºå‘ç£ç›˜å‘é€è¯·æ±‚ï¼ˆåœ¨å†™å…¥çš„æƒ…å†µä¸‹å¯èƒ½è¿˜æœ‰æ•°æ®ï¼‰ï¼› in å’Œ out x86 æŒ‡ä»¤åˆ†åˆ«è¢«è°ƒç”¨æ¥è¯»å–å’Œå†™å…¥è®¾å¤‡å¯„å­˜å™¨ã€‚ å¯åŠ¨è¯·æ±‚ä¾‹ç¨‹ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‡½æ•° ide_wait_read()ï¼Œä»¥ç¡®ä¿é©±åŠ¨å™¨åœ¨å‘å…¶å‘å‡ºè¯·æ±‚ä¹‹å‰å·²å‡†å¤‡å°±ç»ªã€‚ æœ€åï¼Œå½“å‘ç”Ÿä¸­æ–­æ—¶ï¼Œä¼šè°ƒç”¨ ide_intr()ï¼›å®ƒä»è®¾å¤‡è¯»å–æ•°æ®ï¼ˆå¦‚æœè¯·æ±‚æ˜¯è¯»ï¼Œè€Œä¸æ˜¯å†™ï¼‰ï¼Œå”¤é†’ç­‰å¾… I/O å®Œæˆçš„è¿›ç¨‹ï¼Œå¹¶ä¸”ï¼ˆå¦‚æœ I/O é˜Ÿåˆ—ä¸­æœ‰æ›´å¤šè¯·æ±‚ï¼‰ï¼Œé€šè¿‡ ide_start_request()å¯åŠ¨ä¸‹ä¸€ä¸ª I/Oã€‚ ","date":"2024-05-11","objectID":"/posts/27.io%E8%AE%BE%E5%A4%87/:8:0","tags":["OS"],"title":"IOè®¾å¤‡","uri":"/posts/27.io%E8%AE%BE%E5%A4%87/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åœ¨å†™å¹¶å‘æ€§çš„æ—¶å€™ï¼Œå¥½åƒæ„å»ºå¹¶å‘åº”ç”¨ç¨‹åºçš„å”¯ä¸€æ–¹æ³•å°±æ˜¯ä½¿ç”¨çº¿ç¨‹ã€‚å°±åƒç”Ÿæ´»ä¸­çš„è®¸å¤šäº‹æƒ…ä¸€æ ·ï¼Œè¿™å¹¶ä¸å®Œå…¨æ­£ç¡®ã€‚å…·ä½“æ¥è¯´ï¼ŒåŸºäºå›¾å½¢ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç¨‹åºå’ŒæŸäº›ç±»å‹çš„äº’è”ç½‘æœåŠ¡å™¨ç»å¸¸ä½¿ç”¨ä¸åŒé£æ ¼çš„å¹¶å‘ç¼–ç¨‹ã€‚è¿™ç§é£æ ¼è¢«ç§°ä¸ºåŸºäºäº‹ä»¶çš„å¹¶å‘ï¼Œå·²åœ¨ä¸€äº›ç°ä»£ç³»ç»Ÿä¸­æµè¡Œèµ·æ¥ï¼ŒåŒ…æ‹¬ node.js ç­‰æœåŠ¡å™¨ç«¯æ¡†æ¶ï¼Œä½†å…¶æ ¹æºåœ¨äº C/UNIX ç³»ç»Ÿï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹æ–‡è®¨è®ºã€‚ åŸºäºäº‹ä»¶çš„å¹¶å‘è§£å†³äº†ä¸¤ä¸ªæ–¹é¢çš„é—®é¢˜ã€‚é¦–å…ˆï¼Œåœ¨å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºä¸­æ­£ç¡®ç®¡ç†å¹¶å‘æ€§æ˜¯ä¸€é¡¹æŒ‘æˆ˜ï¼›æ­£å¦‚æˆ‘ä»¬æ‰€è®¨è®ºçš„ï¼Œå¯èƒ½ä¼šå‡ºç°é”ä¸¢å¤±ã€æ­»é”å’Œå…¶ä»–ä»¤äººè®¨åŒçš„é—®é¢˜ã€‚å…¶æ¬¡ï¼Œåœ¨å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºä¸­ï¼Œå¼€å‘äººå‘˜å‡ ä¹æ— æ³•æ§åˆ¶ç‰¹å®šæ—¶åˆ»çš„è°ƒåº¦ï¼›ç›¸åï¼Œç¨‹åºå‘˜åªéœ€åˆ›å»ºçº¿ç¨‹ï¼Œç„¶åå¯„å¸Œæœ›äºåº•å±‚æ“ä½œç³»ç»Ÿä»¥åˆç†çš„æ–¹å¼åœ¨å¯ç”¨ CPU ä¸Šè°ƒåº¦è¿™äº›çº¿ç¨‹ã€‚ç”±äºå¾ˆéš¾æ„å»ºä¸€ä¸ªé€šç”¨çš„è°ƒåº¦ç¨‹åºï¼Œåœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½èƒ½å¾ˆå¥½åœ°å¤„ç†æ‰€æœ‰å·¥ä½œè´Ÿè½½ï¼Œæ“ä½œç³»ç»Ÿæœ‰æ—¶ä¼šä»¥éæœ€ä½³çš„æ–¹å¼è°ƒåº¦å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„å…³é”®æ˜¯ï¼š æˆ‘ä»¬å¦‚ä½•åœ¨ä¸ä½¿ç”¨çº¿ç¨‹çš„æƒ…å†µä¸‹æ„å»ºå¹¶å‘æœåŠ¡å™¨ï¼Œä»è€Œä¿ç•™å¯¹å¹¶å‘çš„æ§åˆ¶å¹¶é¿å…ä¸€äº›ä¼¼ä¹å›°æ‰°å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºçš„é—®é¢˜ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:0:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 åŸºæœ¬æ€æƒ³ï¼šäº‹ä»¶å¾ªç¯ å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨çš„åŸºæœ¬æ–¹æ³•ç§°ä¸ºåŸºäºäº‹ä»¶çš„å¹¶å‘ã€‚è¿™ç§æ–¹æ³•éå¸¸ç®€å•ï¼šåªéœ€ç­‰å¾…æŸä»¶äº‹æƒ…ï¼ˆå³ â€œäº‹ä»¶â€ï¼‰å‘ç”Ÿï¼›å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæ£€æŸ¥äº‹ä»¶çš„ç±»å‹ï¼Œå¹¶å®Œæˆæ‰€éœ€çš„å°‘é‡å·¥ä½œï¼ˆå¯èƒ½åŒ…æ‹¬å‘å‡º I/O è¯·æ±‚ï¼Œæˆ–å®‰æ’å…¶ä»–äº‹ä»¶çš„æœªæ¥å¤„ç†ç­‰ï¼‰ã€‚å°±æ˜¯è¿™æ ·ï¼ åœ¨äº†è§£ç»†èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å…¸å‹çš„åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨æ˜¯ä»€ä¹ˆæ ·çš„ã€‚æ­¤ç±»åº”ç”¨ç¨‹åºåŸºäºä¸€ä¸ªç®€å•çš„ç»“æ„ï¼Œå³äº‹ä»¶å¾ªç¯ã€‚äº‹ä»¶å¾ªç¯çš„ä¼ªä»£ç æ˜¯è¿™æ ·çš„ï¼š while (1) { events = getEvents(); for (e in events) processEvent(e); } å…¶å®å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚ä¸»å¾ªç¯åªéœ€ç­‰å¾…äº‹ä»¶å‘ç”Ÿï¼ˆåœ¨ä¸Šé¢çš„ä»£ç ä¸­è°ƒç”¨ getEvents()ï¼‰ï¼Œç„¶åå¯¹è¿”å›çš„æ¯ä¸ªäº‹ä»¶é€ä¸ªè¿›è¡Œå¤„ç†ï¼›å¤„ç†æ¯ä¸ªäº‹ä»¶çš„ä»£ç ç§°ä¸ºäº‹ä»¶å¤„ç†ç¨‹åºã€‚é‡è¦çš„æ˜¯ï¼Œå½“å¤„ç†ç¨‹åºå¤„ç†äº‹ä»¶æ—¶ï¼Œå®ƒæ˜¯ç³»ç»Ÿä¸­å‘ç”Ÿçš„å”¯ä¸€æ´»åŠ¨ï¼›å› æ­¤ï¼Œå†³å®šä¸‹ä¸€æ­¥å¤„ç†å“ªä¸ªäº‹ä»¶å°±ç›¸å½“äºè°ƒåº¦ã€‚è¿™ç§å¯¹è°ƒåº¦çš„æ˜¾å¼æ§åˆ¶æ˜¯åŸºäºäº‹ä»¶çš„æ–¹æ³•çš„åŸºæœ¬ä¼˜åŠ¿ä¹‹ä¸€ã€‚ ä½†æ˜¯ï¼Œä¸Šè¿°è®¨è®ºç»™æˆ‘ä»¬ç•™ä¸‹äº†ä¸€ä¸ªæ›´å¤§çš„é—®é¢˜ï¼šåŸºäºäº‹ä»¶çš„æœåŠ¡å™¨ç©¶ç«Ÿå¦‚ä½•ç¡®å®šå“ªäº›äº‹ä»¶æ­£åœ¨å‘ç”Ÿï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œå’Œç£ç›˜ I/O æ–¹é¢ï¼Ÿå…·ä½“æ¥è¯´ï¼Œäº‹ä»¶æœåŠ¡å™¨å¦‚ä½•åˆ¤æ–­ä¿¡æ¯æ˜¯å¦å·²ç»åˆ°è¾¾ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:1:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ä¸€ä¸ªé‡è¦çš„APIï¼šselect()ï¼ˆæˆ–è€…poll()ï¼‰ è€ƒè™‘åˆ°è¿™ä¸ªåŸºæœ¬äº‹ä»¶å¾ªç¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¿…é¡»è§£å†³å¦‚ä½•æ¥æ”¶äº‹ä»¶çš„é—®é¢˜ã€‚åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡ select() æˆ– poll() ç³»ç»Ÿè°ƒç”¨ä½¿ç”¨ä¸€ä¸ªåŸºæœ¬ APIã€‚ è¿™äº›æ¥å£ä½¿ç¨‹åºèƒ½å¤Ÿç®€å•åœ°æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•éœ€è¦å¤„ç†çš„ä¼ å…¥ I/Oã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªç½‘ç»œåº”ç”¨ï¼ˆæ¯”å¦‚ä¸€ä¸ª Web æœåŠ¡å™¨ï¼‰å¸Œæœ›æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•ç½‘ç»œæ•°æ®åŒ…å·²ç»åˆ°è¾¾ä»¥ä¾¿å¯¹å…¶è¿›è¡ŒæœåŠ¡ã€‚è¿™äº›ç³»ç»Ÿè°ƒç”¨è®©ä½ æ­£å¥½åšåˆ°äº†è¿™ä¸€ç‚¹ã€‚ä»¥ select() ä¸ºä¾‹ã€‚æ‰‹å†Œé¡µï¼ˆåœ¨ Mac ä¸Šï¼‰æè¿°äº†è¯¥ API çš„æ–¹å¼ï¼š int select(int nfds, fd_set *restrict readfds, fd_set *restrict writefds, fd_set *restrict errorfds, struct timeval *restrict timeout); æ‰‹å†Œé¡µä¸­çš„å®é™…æè¿°ï¼š select() æ£€æŸ¥å…¶åœ°å€åœ¨ readfdsã€writefds å’Œ errorfdsä¸­ä¼ é€’çš„ I/O æè¿°ç¬¦é›†ï¼Œä»¥æŸ¥çœ‹å…¶ä¸­çš„æŸäº›æè¿°ç¬¦æ˜¯å¦å·²å‡†å¤‡å¥½è¯»å–ã€å‡†å¤‡å¥½å†™å…¥æˆ–æœ‰å¼‚å¸¸æ¡ä»¶å¾…å®šã€‚æ£€æŸ¥æ¯ä¸ªé›†åˆä¸­çš„ç¬¬ä¸€ä¸ª nfds æè¿°ç¬¦ï¼Œå³æ£€æŸ¥æè¿°ç¬¦é›†åˆä¸­ä» 0 åˆ° nfds-1 çš„æè¿°ç¬¦ã€‚è¿”å›æ—¶ï¼Œselect() å°†ç»™å®šçš„æè¿°ç¬¦é›†æ›¿æ¢ä¸ºç”±å·²å‡†å¤‡å¥½æ‰§è¡Œè¯·æ±‚çš„æ“ä½œçš„æè¿°ç¬¦ç»„æˆçš„å­é›†ã€‚ select() è¿”å›æ‰€æœ‰é›†åˆä¸­å°±ç»ªæè¿°ç¬¦çš„æ€»æ•°ã€‚ å…³äº select() çš„å‡ ç‚¹ã€‚é¦–å…ˆï¼Œè¯·æ³¨æ„ï¼Œå®ƒå¯ä»¥è®©æ‚¨æ£€æŸ¥æè¿°ç¬¦æ˜¯å¦å¯ä»¥è¯»å–å’Œå†™å…¥ï¼›å‰è€…è®©æœåŠ¡å™¨ç¡®å®šæ–°æ•°æ®åŒ…å·²åˆ°è¾¾å¹¶éœ€è¦å¤„ç†ï¼Œè€Œåè€…è®©æœåŠ¡çŸ¥é“ä½•æ—¶å¯ä»¥å›å¤ï¼ˆå³å‡ºç«™é˜Ÿåˆ—æœªæ»¡ï¼‰ã€‚ å…¶æ¬¡ï¼Œæ³¨æ„è¶…æ—¶å‚æ•°ã€‚è¿™é‡Œçš„ä¸€ç§å¸¸è§ç”¨æ³•æ˜¯å°†è¶…æ—¶è®¾ç½®ä¸º NULLï¼Œè¿™ä¼šå¯¼è‡´ select() æ— é™æœŸåœ°é˜»å¡ï¼Œç›´åˆ°æŸä¸ªæè¿°ç¬¦å‡†å¤‡å°±ç»ªã€‚ç„¶è€Œï¼Œæ›´å¼ºå¤§çš„æœåŠ¡å™¨é€šå¸¸ä¼šæŒ‡å®šæŸç§è¶…æ—¶ï¼›ä¸€ç§å¸¸è§çš„æŠ€æœ¯æ˜¯å°†è¶…æ—¶è®¾ç½®ä¸ºé›¶ï¼Œä»è€Œä½¿ç”¨å¯¹ select() çš„è°ƒç”¨æ¥ç«‹å³è¿”å›ã€‚ poll() ç³»ç»Ÿè°ƒç”¨éå¸¸ç›¸ä¼¼ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…å…¶æ‰‹å†Œé¡µã€‚ä¸ç®¡æ€æ ·ï¼Œè¿™äº›åŸºæœ¬åŸè¯­ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ„å»ºéé˜»å¡äº‹ä»¶å¾ªç¯çš„æ–¹æ³•ï¼Œå®ƒåªéœ€æ£€æŸ¥ä¼ å…¥çš„æ•°æ®åŒ…ï¼Œä»å¥—æ¥å­—ä¸­è¯»å–æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œå›å¤ã€‚ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:2:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ä½¿ç”¨select() ä¸ºäº†æ›´å…·ä½“åœ°è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ select() æŸ¥çœ‹å“ªäº›ç½‘ç»œæè¿°ç¬¦ä¸Šæœ‰ä¼ å…¥çš„æŠ¥æ–‡ã€‚ä¸‹é¢è¿™æ®µä»£ç æ˜¾ç¤ºäº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ã€‚ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003csys/time.h\u003e #include \u003csys/types.h\u003e #include \u003cunistd.h\u003e int main(void) { // open and set up a bunch of sockets (not shown) // main loop while (1) { // initialize the fd_set to all zero fd_set readFDs; FD_ZERO(\u0026readFDs); // now set the bits for the descriptors // this server is interested in // (for simplicity, all of them from min to max) int fd; for (fd = minFD; fd \u003c maxFD; fd++) FD_SET(fd, \u0026readFDs); // do the select int rc = select(maxFD+1, \u0026readFDs, NULL, NULL, NULL); // check which actually have data using FD_ISSET() for (fd = minFD; fd \u003c maxFD; fd++) if (FD_ISSET(fd, \u0026readFDs)) processFD(fd); } } è¿™æ®µä»£ç å…¶å®ç›¸å½“ç®€å•æ˜“æ‡‚ã€‚åœ¨åˆå§‹åŒ–ä¹‹åï¼ŒæœåŠ¡å™¨è¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯ã€‚åœ¨å¾ªç¯å†…éƒ¨ï¼Œå®ƒé¦–å…ˆä½¿ç”¨ FD_ZERO() å®æ¸…é™¤æ–‡ä»¶æè¿°ç¬¦é›†ï¼Œç„¶åä½¿ç”¨ FD_SET() å°† minFD åˆ° maxFD çš„æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦éƒ½åŒ…å«åœ¨æ–‡ä»¶æè¿°ç¬¦é›†ä¸­ã€‚ä¾‹å¦‚ï¼Œè¿™ç»„æè¿°ç¬¦å¯èƒ½ä»£è¡¨æœåŠ¡å™¨æ­£åœ¨å…³æ³¨çš„æ‰€æœ‰ç½‘ç»œå¥—æ¥å­—ã€‚æœ€åï¼ŒæœåŠ¡å™¨è°ƒç”¨ select() æŸ¥çœ‹å“ªäº›è¿æ¥ä¸Šæœ‰å¯ç”¨æ•°æ®ã€‚ç„¶åï¼Œåœ¨ä¸€ä¸ªå¾ªç¯ä¸­ä½¿ç”¨ FD_ISSET()ï¼Œäº‹ä»¶æœåŠ¡å™¨å°±èƒ½çœ‹åˆ°å“ªäº›æè¿°ç¬¦å·²å‡†å¤‡å¥½æ•°æ®ï¼Œå¹¶å¤„ç†ä¼ å…¥çš„æ•°æ®ã€‚ å½“ç„¶ï¼ŒçœŸæ­£çš„æœåŠ¡å™¨è¦æ¯”è¿™å¤æ‚å¾—å¤šï¼Œéœ€è¦åœ¨å‘é€æ¶ˆæ¯ã€å‘å‡ºç£ç›˜ I/O å’Œè®¸å¤šå…¶ä»–ç»†èŠ‚æ—¶ä½¿ç”¨é€»è¾‘ã€‚ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:3:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 ä¸ºä»€ä¹ˆæ›´ç®€å•ï¼Ÿä¸éœ€è¦é” æœ‰äº†å• CPU å’ŒåŸºäºäº‹ä»¶çš„åº”ç”¨ç¨‹åºï¼Œå¹¶å‘ç¨‹åºä¸­çš„é—®é¢˜å°±ä¸å¤å­˜åœ¨äº†ã€‚å…·ä½“æ¥è¯´ï¼Œç”±äºä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªäº‹ä»¶ï¼Œå› æ­¤æ— éœ€è·å–æˆ–é‡Šæ”¾é”ï¼›åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ï¼Œå› ä¸ºå®ƒæ˜¯ç»å¯¹çš„å•çº¿ç¨‹ã€‚å› æ­¤ï¼Œçº¿ç¨‹ç¨‹åºä¸­å¸¸è§çš„å¹¶å‘é—®é¢˜åœ¨åŸºäºäº‹ä»¶çš„åŸºæœ¬æ–¹æ³•ä¸­å¹¶ä¸å­˜åœ¨ã€‚ TIPï¼šä¸è¦é˜»å¡åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨ åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨å¯ä»¥å¯¹ä»»åŠ¡è°ƒåº¦è¿›è¡Œç»†ç²’åº¦çš„æ§åˆ¶ã€‚ç„¶è€Œï¼Œä¸ºäº†ç»´æŒè¿™ç§æ§åˆ¶ï¼Œä¸èƒ½è¿›è¡Œä»»ä½•é˜»æ­¢è°ƒç”¨è€…æ‰§è¡Œçš„è°ƒç”¨ï¼›ä¸éµå®ˆæ­¤è®¾è®¡æŠ€å·§å°†å¯¼è‡´åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨è¢«é˜»å¡ï¼Œä¼šå‘ç”Ÿä¸€ç³»åˆ—çš„ä¸¥é‡é—®é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:4:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 é—®é¢˜ï¼šé˜»å¡ç³»ç»Ÿè°ƒç”¨ åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒåŸºäºäº‹ä»¶çš„ç¼–ç¨‹å¬èµ·æ¥ä¸é”™ï¼Œå¯¹å—ï¼Ÿä½ åªéœ€ç¼–å†™ä¸€ä¸ªç®€å•çš„å¾ªç¯ï¼Œç„¶ååœ¨äº‹ä»¶å‘ç”Ÿæ—¶è¿›è¡Œå¤„ç†ã€‚ä½ ç”šè‡³ä¸éœ€è¦è€ƒè™‘é”å®šé—®é¢˜ï¼ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœä¸€ä¸ªäº‹ä»¶è¦æ±‚ä½ å‘å‡ºä¸€ä¸ªå¯èƒ½ä¼šé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨æ€ä¹ˆåŠï¼Ÿ ä¾‹å¦‚ï¼Œå‡è®¾å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè¦æ±‚ä»ç£ç›˜è¯»å–æ–‡ä»¶ï¼Œå¹¶å°†æ–‡ä»¶å†…å®¹è¿”å›ç»™è¯·æ±‚å®¢æˆ·ç«¯ï¼ˆå°±åƒç®€å•çš„ HTTP è¯·æ±‚ä¸€æ ·ï¼‰ã€‚è¦å¤„ç†è¿™æ ·çš„è¯·æ±‚ï¼ŒæŸä¸ªäº‹ä»¶å¤„ç†ç¨‹åºæœ€ç»ˆå¿…é¡»å‘å‡º open() ç³»ç»Ÿè°ƒç”¨æ¥æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åå†å‘å‡ºä¸€ç³»åˆ— read() è°ƒç”¨æ¥è¯»å–æ–‡ä»¶ã€‚å½“æ–‡ä»¶è¢«è¯»å…¥å†…å­˜åï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šå¼€å§‹å‘å®¢æˆ·ç«¯å‘é€ç»“æœã€‚ open() å’Œ read() è°ƒç”¨éƒ½å¯èƒ½å‘å­˜å‚¨ç³»ç»Ÿå‘å‡º I/O è¯·æ±‚ï¼ˆå½“æ‰€éœ€çš„å…ƒæ•°æ®æˆ–æ•°æ®ä¸åœ¨å†…å­˜ä¸­æ—¶ï¼‰ï¼Œå› æ­¤å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½æä¾›æœåŠ¡ã€‚å¯¹äºåŸºäºçº¿ç¨‹çš„æœåŠ¡å™¨æ¥è¯´ï¼Œè¿™ä¸æ˜¯é—®é¢˜ï¼šå½“å‘å‡º I/O è¯·æ±‚çš„çº¿ç¨‹æš‚åœï¼ˆç­‰å¾… I/O å®Œæˆï¼‰æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥è¿è¡Œï¼Œä»è€Œä½¿æœåŠ¡å™¨å–å¾—è¿›å±•ã€‚äº‹å®ä¸Šï¼ŒI/O å’Œå…¶ä»–è®¡ç®—çš„è¿™ç§è‡ªç„¶é‡å æ­£æ˜¯åŸºäºçº¿ç¨‹çš„ç¼–ç¨‹éå¸¸è‡ªç„¶å’Œç®€å•çš„åŸå› ã€‚ ç„¶è€Œï¼Œåœ¨åŸºäºäº‹ä»¶çš„æ–¹æ³•ä¸­ï¼Œæ²¡æœ‰å…¶ä»–çº¿ç¨‹å¯ä»¥è¿è¡Œï¼šåªæœ‰ä¸»äº‹ä»¶å¾ªç¯ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœäº‹ä»¶å¤„ç†ç¨‹åºå‘å‡ºçš„è°ƒç”¨é˜»å¡ï¼Œæ•´ä¸ªæœåŠ¡å™¨å°±ä¼šè¿™æ ·åšï¼šé˜»å¡ï¼Œç›´åˆ°è°ƒç”¨å®Œæˆã€‚å½“äº‹ä»¶å¾ªç¯é˜»å¡æ—¶ï¼Œç³»ç»Ÿå°±ä¼šå¤„äºé—²ç½®çŠ¶æ€ï¼Œä»è€Œé€ æˆå·¨å¤§çš„æ½œåœ¨èµ„æºæµªè´¹ã€‚å› æ­¤ï¼Œåœ¨åŸºäºäº‹ä»¶çš„ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€æ¡å¿…é¡»éµå®ˆçš„è§„åˆ™ï¼šä¸å…è®¸é˜»å¡è°ƒç”¨ã€‚ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:5:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 è§£å†³æ–¹æ¡ˆï¼šå¼‚æ­¥ I/O ä¸ºäº†å…‹æœè¿™ä¸€é™åˆ¶ï¼Œè®¸å¤šç°ä»£æ“ä½œç³»ç»Ÿå¼•å…¥äº†å‘ç£ç›˜ç³»ç»Ÿå‘å‡º I/O è¯·æ±‚çš„æ–°æ–¹æ³•ï¼Œä¸€èˆ¬ç§°ä¸ºå¼‚æ­¥ I/Oã€‚è¿™äº›æ¥å£ä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿå‘å‡º I/O è¯·æ±‚ï¼Œå¹¶åœ¨ I/O å®Œæˆä¹‹å‰ç«‹å³å°†æ§åˆ¶æƒè¿”å›ç»™è°ƒç”¨è€…ï¼›å…¶ä»–æ¥å£ä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿç¡®å®šå„ç§ I/O æ˜¯å¦å·²å®Œæˆã€‚ ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ Mac æä¾›çš„æ¥å£ï¼ˆå…¶ä»–ç³»ç»Ÿä¹Ÿæœ‰ç±»ä¼¼çš„ APIï¼‰ã€‚åº”ç”¨ç¨‹åºæ¥å£å›´ç»•ç€ä¸€ä¸ªåŸºæœ¬ç»“æ„ï¼Œå³struct aiocb æˆ– AIO æ§åˆ¶å—ï¼ˆå¸¸ç”¨æœ¯è¯­ï¼‰ã€‚è¯¥ç»“æ„çš„ç®€åŒ–ç‰ˆæœ¬å¦‚ä¸‹ï¼ˆæ›´å¤šä¿¡æ¯è¯·å‚é˜…æ‰‹å†Œï¼‰ï¼š struct aiocb { int aio_fildes; /* File descriptor */ off_t aio_offset; /* File offset */ volatile void *aio_buf; /* Location of buffer */ size_t aio_nbytes; /* Length of transfer */ }; è¦å¯¹æ–‡ä»¶è¿›è¡Œå¼‚æ­¥è¯»å–ï¼Œåº”ç”¨ç¨‹åºåº”é¦–å…ˆåœ¨æ­¤ç»“æ„ä¸­å¡«å…¥ç›¸å…³ä¿¡æ¯ï¼šè¦è¯»å–æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆaio_fildesï¼‰ã€æ–‡ä»¶ä¸­çš„åç§»é‡ï¼ˆaio_offsetï¼‰ä»¥åŠè¯·æ±‚çš„é•¿åº¦ï¼ˆaio_nbytesï¼‰ï¼Œæœ€åæ˜¯è¯»å–ç»“æœåº”å¤åˆ¶åˆ°çš„ç›®æ ‡å†…å­˜ä½ç½®ï¼ˆaio_bufï¼‰ã€‚ å¡«å…¥æ­¤ç»“æ„åï¼Œåº”ç”¨ç¨‹åºå¿…é¡»å‘å‡ºå¼‚æ­¥è°ƒç”¨æ¥è¯»å–æ–‡ä»¶ï¼›åœ¨ Mac ä¸Šï¼Œæ­¤ API åªæ˜¯å¼‚æ­¥è¯»å– APIï¼š int aio_read(struct aiocb *aiocbp); è¯¥è°ƒç”¨ä¼šå°è¯•å‘å‡º I/Oï¼›å¦‚æœæˆåŠŸï¼Œå®ƒå°±ä¼šç«‹å³è¿”å›ï¼Œåº”ç”¨ç¨‹åºï¼ˆå³åŸºäºäº‹ä»¶çš„æœåŠ¡å™¨ï¼‰å¯ä»¥ç»§ç»­å·¥ä½œã€‚ ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»è§£å†³æœ€åä¸€ä¸ªéš¾é¢˜ã€‚æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ I/O æ˜¯å¦å·²å®Œæˆï¼Œä»è€Œç¡®å®šç¼“å†²åŒºï¼ˆaio_buf æŒ‡å‘çš„ç¼“å†²åŒºï¼‰ä¸­å·²åŒ…å«æ‰€è¯·æ±‚çš„æ•°æ®ï¼Ÿè¿™å°±éœ€è¦æœ€åä¸€ä¸ª APIã€‚åœ¨ Mac ä¸Šï¼Œå®ƒè¢«ç§°ä¸º aio_error()ã€‚è¯¥ API å¦‚ä¸‹æ‰€ç¤ºï¼š int aio_error(const struct aiocb *aiocbp); è¯¥ç³»ç»Ÿè°ƒç”¨æ£€æŸ¥ aiocbp å¼•ç”¨çš„è¯·æ±‚æ˜¯å¦å·²å®Œæˆã€‚å¦‚æœæ˜¯ï¼Œåˆ™ä¾‹ç¨‹è¿”å›æˆåŠŸï¼ˆç”¨é›¶è¡¨ç¤ºï¼‰ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™è¿”å› EINPROGRESSã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ªæœªå®Œæˆçš„å¼‚æ­¥ I/Oï¼Œåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡è°ƒç”¨ aio_error() å®šæœŸè½®è¯¢ç³»ç»Ÿï¼Œä»¥ç¡®å®šæ‰€è¿° I/O æ˜¯å¦å°šæœªå®Œæˆã€‚ æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°çš„ä¸€ä»¶äº‹æ˜¯æ£€æŸ¥ I/O æ˜¯å¦å·²å®Œæˆæ˜¯ä¸€ä»¶å¾ˆç—›è‹¦çš„äº‹æƒ…ï¼›å¦‚æœä¸€ä¸ªç¨‹åºåœ¨ç»™å®šæ—¶é—´ç‚¹å‘å‡ºäº†æ•°åæˆ–æ•°ç™¾ä¸ª I/Oï¼Œå®ƒæ˜¯å¦åº”è¯¥ç®€å•åœ°é‡å¤æ£€æŸ¥æ¯ä¸ª I/Oï¼Œæˆ–è€…å…ˆç­‰å¾…ä¸€ä¼šå„¿ï¼Œæˆ–è€…â€¦â€¦ï¼Ÿ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€äº›ç³»ç»Ÿæä¾›äº†ä¸€ç§åŸºäºä¸­æ–­çš„æ–¹æ³•ã€‚æ­¤æ–¹æ³•ä½¿ç”¨ UNIX ä¿¡å·æ¥é€šçŸ¥åº”ç”¨ç¨‹åºå¼‚æ­¥ I/O ä½•æ—¶å®Œæˆï¼Œä»è€Œæ— éœ€é‡å¤è¯¢é—®ç³»ç»Ÿã€‚ åœ¨æ²¡æœ‰å¼‚æ­¥ I/O çš„ç³»ç»Ÿä¸­ï¼Œçº¯ç²¹åŸºäºäº‹ä»¶çš„æ–¹æ³•æ— æ³•å®ç°ã€‚ä¸è¿‡ï¼Œèªæ˜çš„ç ”ç©¶äººå‘˜å·²ç»æ¨å¯¼å‡ºäº†èƒ½å¾ˆå¥½ä»£æ›¿å®ƒä»¬çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼ŒPai ç­‰äºº æè¿°äº†ä¸€ç§æ··åˆæ–¹æ³•ï¼Œå…¶ä¸­äº‹ä»¶ç”¨äºå¤„ç†ç½‘ç»œæ•°æ®åŒ…ï¼Œçº¿ç¨‹æ± ç”¨äºç®¡ç†æœªå®Œæˆçš„ I/Oã€‚è¯¦æƒ…è¯·é˜…è¯»ä»–ä»¬çš„è®ºæ–‡ã€‚ UNIX ä¿¡å· åœ¨æ‰€æœ‰ç°ä»£ UNIX å˜ä½“ä¸­ï¼Œéƒ½æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºä¿¡å·çš„åºå¤§è€Œè¿·äººçš„åŸºç¡€æ¶æ„ã€‚æœ€ç®€å•æ¥è¯´ï¼Œä¿¡å·æä¾›äº†ä¸€ç§ä¸è¿›ç¨‹é€šä¿¡çš„æ–¹å¼ã€‚å…·ä½“æ¥è¯´ï¼Œä¿¡å·å¯ä»¥ä¼ é€’ç»™åº”ç”¨ç¨‹åºï¼›ä¼ é€’ä¿¡å·æ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šåœæ­¢æ­£åœ¨è¿›è¡Œçš„ä»»ä½•æ“ä½œï¼Œä»¥è¿è¡Œä¿¡å·å¤„ç†ç¨‹åºï¼ˆå³åº”ç”¨ç¨‹åºä¸­å¤„ç†è¯¥ä¿¡å·çš„ä»£ç ï¼‰ã€‚å¤„ç†å®Œæˆåï¼Œè¿›ç¨‹å°†æ¢å¤ä¹‹å‰çš„è¡Œä¸ºã€‚ æ¯ä¸ªä¿¡å·éƒ½æœ‰ä¸€ä¸ªåç§°ï¼Œå¦‚ HUPï¼ˆæŒ‚èµ·ï¼‰ã€INTï¼ˆä¸­æ–­ï¼‰ã€SEGVï¼ˆåˆ†æ®µè¿è§„ï¼‰ç­‰ï¼›è¯¦æƒ…è¯·æŸ¥çœ‹æ‰‹å†Œé¡µé¢ï¼šman signalã€‚æœ‰è¶£çš„æ˜¯ï¼Œæœ‰æ—¶å†…æ ¸æœ¬èº«ä¹Ÿä¼šå‘å‡ºä¿¡å·ã€‚ä¾‹å¦‚ï¼Œå½“ä½ çš„ç¨‹åºé‡åˆ°åˆ†æ®µè¿è§„æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå‘å…¶å‘é€ SIGSEGVï¼ˆåœ¨ä¿¡å·åç§°å‰åŠ ä¸Š SIG æ˜¯å¾ˆå¸¸è§çš„ï¼‰ï¼›å¦‚æœä½ çš„ç¨‹åºè¢«é…ç½®ä¸ºæ•è·è¯¥ä¿¡å·ï¼Œä½ å®é™…ä¸Šå¯ä»¥è¿è¡Œä¸€äº›ä»£ç æ¥å“åº”è¿™ç§é”™è¯¯çš„ç¨‹åºè¡Œä¸ºï¼ˆè¿™å¯¹è°ƒè¯•å¾ˆæœ‰ç”¨ï¼‰ã€‚å½“ä¸€ä¸ªä¿¡å·è¢«å‘é€åˆ°ä¸€ä¸ªæœªé…ç½®ä¸ºå¤„ç†è¯¥ä¿¡å·çš„è¿›ç¨‹æ—¶ï¼Œä¸€äº›é»˜è®¤è¡Œä¸ºå°†è¢«æ‰§è¡Œï¼›å¯¹äº SEGVï¼Œè¯¥è¿›ç¨‹å°†è¢«æ€æ­»ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªè¿›å…¥æ— é™å¾ªç¯çš„ç®€å•ç¨‹åºï¼Œä½†å®ƒé¦–å…ˆè®¾ç½®äº†ä¸€ä¸ªä¿¡å·å¤„ç†ç¨‹åºæ¥æ•è· SIGHUPï¼š #include \u003cstdio.h\u003e #include \u003csignal.h\u003e void handle(int arg) { printf(\"stop wakinâ€™ me up...\\n\"); } int main(int argc, char *argv[]) { signal(SIGHUP, handle); while (1) ; // doinâ€™ nothinâ€™ except catchinâ€™ some sigs return 0; } ä½ å¯ä»¥ä½¿ç”¨ kill å‘½ä»¤è¡Œå·¥å…·å‘å®ƒå‘é€ä¿¡å·ã€‚è¿™æ ·åšä¼šä¸­æ–­ç¨‹åºä¸­çš„ä¸» while å¾ªç¯ï¼Œå¹¶è¿è¡Œå¤„ç†ç¨‹åºä»£ç  handle()ï¼š â¯ ./loop_signal\u0026 [1] 66420 â¯ kill -HUP 66420 stop wakinâ€™ me up... ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:6:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 å¦ä¸€ä¸ªé—®é¢˜ï¼šçŠ¶æ€ç®¡ç† åŸºäºäº‹ä»¶çš„æ–¹æ³•çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè¿™ç±»ä»£ç çš„ç¼–å†™é€šå¸¸æ¯”ä¼ ç»Ÿçš„åŸºäºçº¿ç¨‹çš„ä»£ç å¤æ‚ã€‚åŸå› å¦‚ä¸‹ï¼šå½“ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå‘å‡ºå¼‚æ­¥ I/O æ—¶ï¼Œå®ƒå¿…é¡»æ‰“åŒ…ä¸€äº›ç¨‹åºçŠ¶æ€ï¼Œä¾›ä¸‹ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºåœ¨ I/O æœ€ç»ˆå®Œæˆæ—¶ä½¿ç”¨ï¼›è€Œåœ¨åŸºäºçº¿ç¨‹çš„ç¨‹åºä¸­ä¸éœ€è¦è¿™é¡¹é¢å¤–å·¥ä½œï¼Œå› ä¸ºç¨‹åºæ‰€éœ€çš„çŠ¶æ€åœ¨çº¿ç¨‹çš„æ ˆä¸­ã€‚Adya ç­‰äººå°†è¿™é¡¹å·¥ä½œç§°ä¸ºäººå·¥æ ˆç®¡ç†ï¼Œå®ƒæ˜¯åŸºäºäº‹ä»¶çš„ç¼–ç¨‹çš„åŸºç¡€ã€‚ ä¸ºäº†æ›´å…·ä½“åœ°è¯´æ˜è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šåŸºäºçº¿ç¨‹çš„æœåŠ¡å™¨éœ€è¦ä»æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰ä¸­è¯»å–æ•°æ®ï¼Œå¹¶åœ¨å®Œæˆåå°†ä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®å†™å…¥ç½‘ç»œå¥—æ¥å­—æè¿°ç¬¦ï¼ˆsdï¼‰ã€‚ä»£ç ï¼ˆå¿½ç•¥é”™è¯¯æ£€æŸ¥ï¼‰å¦‚ä¸‹ï¼š int rc = read(fd, buffer, size); rc = write(sd, buffer, size); æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œåšè¿™æ ·çš„å·¥ä½œæ˜¯è½»è€Œæ˜“ä¸¾çš„ï¼›å½“ read() æœ€ç»ˆè¿”å›æ—¶ï¼Œä»£ç ä¼šç«‹å³çŸ¥é“è¦å†™å…¥å“ªä¸ªå¥—æ¥å­—ï¼Œå› ä¸ºè¯¥ä¿¡æ¯å°±åœ¨çº¿ç¨‹çš„å †æ ˆä¸­ï¼ˆåœ¨å˜é‡ sd ä¸­ï¼‰ã€‚ è€Œåœ¨åŸºäºäº‹ä»¶çš„ç³»ç»Ÿä¸­ï¼Œæƒ…å†µå°±æ²¡é‚£ä¹ˆç®€å•äº†ã€‚è¦æ‰§è¡ŒåŒæ ·çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ä½¿ç”¨ä¸Šè¿° AIO è°ƒç”¨å¼‚æ­¥å‘å‡ºè¯»å–æŒ‡ä»¤ã€‚å‡è®¾æˆ‘ä»¬ä½¿ç”¨ aio_error() è°ƒç”¨å®šæœŸæ£€æŸ¥è¯»å–æ˜¯å¦å®Œæˆï¼›å½“è¯¥è°ƒç”¨é€šçŸ¥æˆ‘ä»¬è¯»å–å®Œæˆæ—¶ï¼ŒåŸºäºäº‹ä»¶çš„æœåŠ¡å™¨å¦‚ä½•çŸ¥é“è¯¥åšä»€ä¹ˆï¼Ÿ æ­£å¦‚ Adya ç­‰äººæ‰€æè¿°çš„é‚£æ ·ï¼Œè§£å†³åŠæ³•æ˜¯ä½¿ç”¨ä¸€ç§å¤è€çš„ç¼–ç¨‹è¯­è¨€ç»“æ„ï¼Œå³ continuationã€‚è™½ç„¶å¬èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†å…¶å®æƒ³æ³•å¾ˆç®€å•ï¼šåŸºæœ¬ä¸Šï¼Œåœ¨æŸä¸ªæ•°æ®ç»“æ„ä¸­è®°å½•å®Œæˆå¤„ç†è¯¥äº‹ä»¶æ‰€éœ€çš„ä¿¡æ¯ï¼›å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆå³ç£ç›˜ I/O å®Œæˆæ—¶ï¼‰ï¼ŒæŸ¥æ‰¾æ‰€éœ€çš„ä¿¡æ¯å¹¶å¤„ç†è¯¥äº‹ä»¶ã€‚ åœ¨è¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åœ¨æŸç§æ•°æ®ç»“æ„ï¼ˆå¦‚å“ˆå¸Œè¡¨ï¼‰ä¸­è®°å½•å¥—æ¥å­—æè¿°ç¬¦ (sd)ï¼Œå¹¶ä»¥æ–‡ä»¶æè¿°ç¬¦ (fd) ä¸ºç´¢å¼•ã€‚ç£ç›˜ I/O å®Œæˆåï¼Œäº‹ä»¶å¤„ç†ç¨‹åºå°†ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æŸ¥æ‰¾continuationï¼Œå¹¶å°†å¥—æ¥å­—æè¿°ç¬¦çš„å€¼è¿”å›ç»™è°ƒç”¨è€…ã€‚æ­¤æ—¶ï¼ˆæœ€åï¼‰ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥è¿›è¡Œæœ€åçš„å·¥ä½œï¼Œå°†æ•°æ®å†™å…¥å¥—æ¥å­—ã€‚ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:7:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 äº‹ä»¶ä»æœ‰å“ªäº›å›°éš¾ï¼Ÿ åŸºäºäº‹ä»¶çš„æ–¹æ³•è¿˜æœ‰ä¸€äº›å…¶ä»–å›°éš¾éœ€è¦æåŠã€‚ä¾‹å¦‚ï¼Œå½“ç³»ç»Ÿä»å•æ ¸ CPU è½¬å‘å¤šæ ¸ CPU æ—¶ï¼ŒåŸºäºäº‹ä»¶çš„æ–¹æ³•çš„ä¸€äº›ç®€ä¾¿æ€§å°±æ¶ˆå¤±äº†ã€‚å…·ä½“æ¥è¯´ï¼Œä¸ºäº†åˆ©ç”¨ä¸€ä¸ªä»¥ä¸Šçš„ CPUï¼Œäº‹ä»¶æœåŠ¡å™¨å¿…é¡»å¹¶è¡Œè¿è¡Œå¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼›è¿™æ ·åšæ—¶ï¼Œé€šå¸¸çš„åŒæ­¥é—®é¢˜ï¼ˆå¦‚ä¸´ç•ŒåŒºï¼‰å°±ä¼šå‡ºç°ï¼Œå¿…é¡»é‡‡ç”¨é€šå¸¸çš„è§£å†³æ–¹æ¡ˆï¼ˆå¦‚é”ï¼‰ã€‚å› æ­¤ï¼Œåœ¨ç°ä»£å¤šæ ¸ç³»ç»Ÿä¸Šï¼Œä¸åŠ é”çš„ç®€å•äº‹ä»¶å¤„ç†å·²ä¸å†å¯èƒ½ã€‚ åŸºäºäº‹ä»¶çš„æ–¹æ³•çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå®ƒä¸èƒ½å¾ˆå¥½åœ°ä¸åˆ†é¡µç­‰æŸäº›ç±»å‹çš„ç³»ç»Ÿæ´»åŠ¨é›†æˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœäº‹ä»¶å¤„ç†ç¨‹åºå‘ç”Ÿé¡µé¢æ•…éšœï¼Œå®ƒå°±ä¼šé˜»å¡ï¼Œå› æ­¤æœåŠ¡å™¨åœ¨é¡µé¢æ•…éšœå®Œæˆä¹‹å‰ä¸ä¼šå–å¾—è¿›å±•ã€‚å°½ç®¡æœåŠ¡å™¨åœ¨ç»“æ„ä¸Šå·²ç»é¿å…äº†æ˜¾å¼é˜»å¡ï¼Œä½†é¡µé¢æ•…éšœå¯¼è‡´çš„è¿™ç§éšå¼é˜»å¡æ˜¯éš¾ä»¥é¿å…çš„ï¼Œå› æ­¤åœ¨æ™®éå­˜åœ¨æ—¶ä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚ ç¬¬ä¸‰ä¸ªé—®é¢˜æ˜¯ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼ŒåŸºäºäº‹ä»¶çš„ä»£ç å¯èƒ½éš¾ä»¥ç®¡ç†ï¼Œå› ä¸ºå„ç§ä¾‹ç¨‹çš„ç¡®åˆ‡è¯­ä¹‰ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªä¾‹ç¨‹ä»éé˜»å¡å˜ä¸ºé˜»å¡ï¼Œé‚£ä¹ˆè°ƒç”¨è¯¥ä¾‹ç¨‹çš„äº‹ä»¶å¤„ç†ç¨‹åºä¹Ÿå¿…é¡»éšä¹‹æ”¹å˜ï¼Œä»¥é€‚åº”å…¶æ–°çš„æ€§è´¨ï¼Œå³æŠŠè‡ªå·±æ’•æˆä¸¤åŠã€‚ç”±äºé˜»å¡å¯¹äºåŸºäºäº‹ä»¶çš„æœåŠ¡å™¨æ¥è¯´æ˜¯ç¾éš¾æ€§çš„ï¼Œå› æ­¤ç¨‹åºå‘˜å¿…é¡»æ—¶åˆ»æ³¨æ„æ¯ä¸ªäº‹ä»¶æ‰€ä½¿ç”¨çš„åº”ç”¨ç¨‹åºæ¥å£åœ¨è¯­ä¹‰ä¸Šçš„å˜åŒ–ã€‚ æœ€åï¼Œè™½ç„¶å¼‚æ­¥ç£ç›˜ I/O ç°åœ¨å·²ç»å¯ä»¥åœ¨å¤§å¤šæ•°å¹³å°ä¸Šå®ç°ï¼Œä½†å®ƒéœ€è¦å¾ˆé•¿çš„æ—¶é—´æ‰èƒ½å®ç°ï¼Œè€Œä¸”å®ƒä¸å¼‚æ­¥ç½‘ç»œ I/O çš„é›†æˆæ–¹å¼ä¹Ÿä¸åƒä½ æƒ³è±¡çš„é‚£ä¹ˆç®€å•å’Œç»Ÿä¸€ã€‚ä¾‹å¦‚ï¼Œè™½ç„¶æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨ select() æ¥å£æ¥ç®¡ç†æ‰€æœ‰æœªå®Œæˆçš„ I/Oï¼Œä½†é€šå¸¸éœ€è¦å°†ç”¨äºç½‘ç»œçš„ select() å’Œç”¨äºç£ç›˜ I/O çš„ AIO è°ƒç”¨ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ ","date":"2024-05-11","objectID":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/:8:0","tags":["OS"],"title":"åŸºäºäº‹ä»¶çš„å¹¶å‘","uri":"/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å­˜åœ¨å“ªäº›ç±»å‹çš„å¹¶å‘bugï¼Ÿ ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€æ˜æ˜¾çš„é—®é¢˜æ˜¯ï¼šå¤æ‚çš„å¹¶å‘ç¨‹åºä¸­ä¼šå‡ºç°å“ªäº›ç±»å‹çš„å¹¶å‘bugï¼Ÿè¿™ä¸ªé—®é¢˜ä¸€èˆ¬æ¥è¯´å¾ˆéš¾å›ç­”ï¼Œä½†å¹¸è¿çš„æ˜¯ï¼Œå…¶ä»–ä¸€äº›äººå·²ç»ä¸ºæˆ‘ä»¬å®Œæˆäº†è¿™é¡¹å·¥ä½œã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ä¾èµ–äº Lu ç­‰äººçš„ä¸€é¡¹ç ”ç©¶ã€‚å®ƒè¯¦ç»†åˆ†æäº†è®¸å¤šæµè¡Œçš„å¹¶å‘åº”ç”¨ç¨‹åºï¼Œä»¥äº†è§£å®è·µä¸­å‡ºç°çš„bugç±»å‹ã€‚ è¯¥ç ”ç©¶é‡ç‚¹å…³æ³¨å››ä¸ªä¸»è¦ä¸”é‡è¦çš„å¼€æºåº”ç”¨ç¨‹åºï¼šMySQLï¼ˆæµè¡Œçš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰ã€Apacheï¼ˆè‘—åçš„ Web æœåŠ¡å™¨ï¼‰ã€Mozillaï¼ˆè‘—åçš„ Web æµè§ˆå™¨ï¼‰å’Œ OpenOfficeï¼ˆMS Office å¥—ä»¶çš„å…è´¹ç‰ˆæœ¬ï¼Œæœ‰äº›äººå®é™…ä½¿ç”¨ï¼‰ã€‚åœ¨è¿™é¡¹ç ”ç©¶ä¸­ï¼Œä½œè€…ç ”ç©¶äº†åœ¨æ¯ä¸ªä»£ç åº“ä¸­å‘ç°å¹¶ä¿®å¤çš„å¹¶å‘æ€§bugï¼Œå°†å¼€å‘äººå‘˜çš„å·¥ä½œè½¬åŒ–ä¸ºå®šé‡bugåˆ†æï¼›äº†è§£è¿™äº›ç»“æœå¯ä»¥å¸®åŠ©æ‚¨äº†è§£æˆç†Ÿä»£ç åº“ä¸­å®é™…å‘ç”Ÿçš„é—®é¢˜ç±»å‹ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº† Lu åŠå…¶åŒäº‹ç ”ç©¶çš„bugæ±‡æ€»ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ€»å…±æœ‰ 105 ä¸ªbugï¼Œå…¶ä¸­å¤§éƒ¨åˆ†ä¸æ˜¯æ­»é”ï¼ˆ74 ä¸ªï¼‰ï¼›å…¶ä½™ 31 ä¸ªæ˜¯æ­»é”bugã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥çœ‹åˆ°æ¯ä¸ªåº”ç”¨ç¨‹åºçš„bugæ•°é‡ï¼›OpenOffice çš„å¹¶å‘bugæ€»æ•°åªæœ‰ 8 ä¸ªï¼Œè€Œ Mozilla åˆ™æœ‰è¿‘ 60 ä¸ªã€‚ æˆ‘ä»¬ç°åœ¨å¯¹è¿™äº›ä¸åŒç±»åˆ«çš„bugï¼ˆéæ­»é”ã€æ­»é”ï¼‰è¿›è¡Œæ›´æ·±å…¥çš„ç ”ç©¶ã€‚å¯¹äºç¬¬ä¸€ç±»éæ­»é”bugï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç ”ç©¶ä¸­çš„ç¤ºä¾‹è¿›è¡Œè®¨è®ºã€‚å¯¹äºç¬¬äºŒç±»æ­»é”bugï¼Œæˆ‘ä»¬å°†è®¨è®ºåœ¨é¢„é˜²ã€é¿å…æˆ–å¤„ç†æ­»é”æ–¹é¢æ‰€åšçš„å¤§é‡å·¥ä½œã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:1:0","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 éæ­»é”bug æ ¹æ® Lu çš„ç ”ç©¶ï¼Œéæ­»é”bugå å¹¶å‘bugçš„å¤§å¤šæ•°ã€‚ä½†è¿™äº›bugå±äºå“ªç§ç±»å‹ï¼Ÿå®ƒä»¬æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿæˆ‘ä»¬è¯¥å¦‚ä½•ä¿®å¤å®ƒä»¬ï¼Ÿæˆ‘ä»¬ç°åœ¨è®¨è®º Lu ç­‰äººå‘ç°çš„ä¸¤å¤§ç±»éæ­»é”bugï¼šåŸå­æ€§è¿è§„bugå’Œé¡ºåºè¿è§„bugã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:2:0","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åŸå­æ€§è¿è§„bug é‡åˆ°çš„ç¬¬ä¸€ç±»é—®é¢˜è¢«ç§°ä¸ºåŸå­æ€§è¿è§„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨ MySQL ä¸­å‘ç°çš„ç®€å•ç¤ºä¾‹ã€‚ Thread 1:: if (thd-\u003eproc_info) { ... fputs(thd-\u003eproc_info, ...); ... } Thread 2:: thd-\u003eproc_info = NULL; åœ¨ç¤ºä¾‹ä¸­ï¼Œä¸¤ä¸ªä¸åŒçš„çº¿ç¨‹è®¿é—®äº†ç»“æ„ä½“ thd ä¸­çš„å­—æ®µ proc_infoã€‚ç¬¬ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥å€¼æ˜¯å¦ä¸ºéç©ºå€¼ï¼Œç„¶åæ‰“å°å…¶å€¼ï¼›ç¬¬äºŒä¸ªçº¿ç¨‹å°†å…¶è®¾ç½®ä¸ºç©ºå€¼ã€‚æ˜¾ç„¶ï¼Œå¦‚æœç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†æ£€æŸ¥ï¼Œä½†åœ¨è°ƒç”¨ fputs ä¹‹å‰è¢«ä¸­æ–­ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªçº¿ç¨‹å¯èƒ½ä¼šåœ¨ä¸­é—´è¿è¡Œï¼Œä»è€Œå°†æŒ‡é’ˆè®¾ç½®ä¸º NULLï¼›å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹æ¢å¤è¿è¡Œæ—¶ï¼Œå®ƒå°†å´©æºƒï¼Œå› ä¸º NULL æŒ‡é’ˆå°†è¢« fputs è§£é™¤å¼•ç”¨ã€‚ æ ¹æ® Lu ç­‰äººçš„è¯´æ³•ï¼ŒåŸå­æ€§è¿è§„çš„æ›´æ­£å¼å®šä¹‰æ˜¯ï¼šâ€œè¿åäº†å¤šä¸ªå†…å­˜è®¿é—®ä¹‹é—´æ‰€éœ€çš„å¯ä¸²è¡Œæ€§ï¼ˆå³ä»£ç åŒºåŸŸåº”è¯¥æ˜¯åŸå­æ€§çš„ï¼Œä½†åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¹¶æœªå¼ºåˆ¶æ‰§è¡ŒåŸå­æ€§ï¼‰ã€‚â€åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä»£ç å¯¹ proc_info çš„é NULL æ£€æŸ¥ä»¥åŠ fputs() è°ƒç”¨ä¸­ proc_info çš„ä½¿ç”¨æœ‰ä¸€ä¸ªåŸå­æ€§å‡è®¾ï¼ˆç”¨ Lu çš„è¯è¯´ï¼‰ï¼›å½“å‡è®¾ä¸æ­£ç¡®æ—¶ï¼Œä»£ç å°†æ— æ³•æŒ‰é¢„æœŸå·¥ä½œã€‚ æ‰¾åˆ°æ­¤ç±»é—®é¢˜çš„è§£å†³æ–¹æ¡ˆé€šå¸¸ï¼ˆä½†å¹¶éæ€»æ˜¯ï¼‰å¾ˆç®€å•ã€‚åœ¨æ­¤è§£å†³æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬åªéœ€åœ¨å…±äº«å˜é‡å¼•ç”¨å‘¨å›´æ·»åŠ é”ï¼Œç¡®ä¿å½“ä»»ä¸€çº¿ç¨‹è®¿é—® proc_info å­—æ®µæ—¶ï¼Œå®ƒéƒ½æŒæœ‰é”ï¼ˆproc_info_lockï¼‰ã€‚å½“ç„¶ï¼Œè®¿é—®è¯¥ç»“æ„çš„ä»»ä½•å…¶ä»–ä»£ç ä¹Ÿåº”è¯¥åœ¨æ‰§è¡Œæ­¤æ“ä½œä¹‹å‰è·å–æ­¤é”ã€‚ pthread_mutex_t proc_info_lock = PTHREAD_MUTEX_INITIALIZER; Thread 1:: pthread_mutex_lock(\u0026proc_info_lock); if (thd-\u003eproc_info) { ... fputs(thd-\u003eproc_info, ...); ... } pthread_mutex_unlock(\u0026proc_info_lock); Thread 2:: pthread_mutex_lock(\u0026proc_info_lock); thd-\u003eproc_info = NULL; pthread_mutex_unlock(\u0026proc_info_lock); ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:2:1","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 é¡ºåºè¿è§„bug Lu ç­‰äººå‘ç°çš„å¦ä¸€ç§å¸¸è§çš„éæ­»é”bugè¢«ç§°ä¸º â€œé¡ºåºè¿è§„â€ã€‚ä¸‹é¢æ˜¯å¦ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚ Thread 1:: void init() { ... mThread = PR_CreateThread(mMain, ...); ... } Thread 2:: void mMain(...) { ... mState = mThread-\u003eState; ... } çº¿ç¨‹ 2 ä¸­çš„ä»£ç ä¼¼ä¹å‡å®šå˜é‡ mThread å·²è¢«åˆå§‹åŒ–ï¼ˆå¹¶ä¸”ä¸æ˜¯ NULLï¼‰ï¼›ä½†æ˜¯ï¼Œå¦‚æœçº¿ç¨‹ 2 åˆ›å»ºåç«‹å³è¿è¡Œï¼Œé‚£ä¹ˆåœ¨çº¿ç¨‹ 2 çš„ mMain() ä¸­è®¿é—® mThread æ—¶ï¼Œå®ƒçš„å€¼å°†ä¸ä¼šè¢«è®¾ç½®ï¼Œå¹¶ä¸”å¾ˆå¯èƒ½ä¼šå› è§£å¼•ç”¨ NULL æŒ‡é’ˆè€Œå´©æºƒã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å‡è®¾ mThread çš„å€¼æœ€åˆä¸º NULLï¼›å¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆåœ¨çº¿ç¨‹ 2 ä¸­é€šè¿‡è§£å¼•ç”¨è®¿é—®ä»»æ„å†…å­˜ä½ç½®æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿæ›´å¥‡æ€ªçš„äº‹æƒ…ã€‚ è¿åé¡ºåºçš„æ›´æ­£å¼å®šä¹‰æ˜¯è¿™æ ·çš„ï¼šâ€œä¸¤ä¸ªï¼ˆç»„ï¼‰å†…å­˜è®¿é—®ä¹‹é—´çš„ç†æƒ³é¡ºåºè¢«é¢ å€’ï¼ˆå³ A åº”æ€»æ˜¯åœ¨ B ä¹‹å‰æ‰§è¡Œï¼Œä½†åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é¡ºåºå¹¶æ²¡æœ‰è¢«å¼ºåˆ¶æ‰§è¡Œï¼‰\"ã€‚ è§£å†³è¿™ç±»bugçš„æ–¹æ³•ä¸€èˆ¬æ˜¯å¼ºåˆ¶æ‰§è¡Œæ’åºã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰è¯¦ç»†è®¨è®ºè¿‡çš„ï¼Œä½¿ç”¨æ¡ä»¶å˜é‡æ˜¯å°†è¿™ç§åŒæ­¥æ–¹å¼æ·»åŠ åˆ°ç°ä»£ä»£ç åº“ä¸­çš„ä¸€ç§ç®€å•è€Œç¨³å¥çš„æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç é‡å†™å¦‚ä¸‹ï¼š pthread_mutex_t mtLock = PTHREAD_MUTEX_INITIALIZER; pthread_cond_t mtCond = PTHREAD_COND_INITIALIZER; int mtInit = 0; Thread 1:: void init() { ... mThread = PR_CreateThread(mMain, ...); // signal that the thread has been created... pthread_mutex_lock(\u0026mtLock); mtInit = 1; pthread_cond_signal(\u0026mtCond); pthread_mutex_unlock(\u0026mtLock); ... } Thread 2:: void mMain(...) { ... // wait for the thread to be initialized... pthread_mutex_lock(\u0026mtLock); while (mtInit == 0) pthread_cond_wait(\u0026mtCond, \u0026mtLock); pthread_mutex_unlock(\u0026mtLock); mState = mThread-\u003eState; ... } åœ¨è¿™ä¸ªå›ºå®šçš„ä»£ç åºåˆ—ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªé”ï¼ˆmtLockï¼‰å’Œç›¸åº”çš„æ¡ä»¶å˜é‡ï¼ˆmtCondï¼‰ï¼Œä»¥åŠä¸€ä¸ªçŠ¶æ€å˜é‡ï¼ˆmtInitï¼‰ã€‚åˆå§‹åŒ–ä»£ç è¿è¡Œæ—¶ï¼Œå®ƒä¼šå°† mtInit çš„çŠ¶æ€è®¾ç½®ä¸º 1ï¼Œå¹¶å‘å‡ºä¿¡å·è¡¨ç¤ºå·²å®Œæˆè®¾ç½®ã€‚å¦‚æœçº¿ç¨‹ 2 åœ¨è¿™ä¹‹å‰è¿è¡Œï¼Œå®ƒå°†ç­‰å¾…è¿™ä¸ªä¿¡å·å’Œç›¸åº”çš„çŠ¶æ€å˜åŒ–ï¼›å¦‚æœçº¿ç¨‹ 2 åœ¨ä¹‹åè¿è¡Œï¼Œå®ƒå°†æ£€æŸ¥çŠ¶æ€ï¼Œå‘ç°åˆå§‹åŒ–å·²ç»å‘ç”Ÿï¼ˆå³ mtInit è¢«è®¾ç½®ä¸º 1ï¼‰ï¼Œä»è€Œç»§ç»­æ­£å¸¸è¿è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ mThread ä½œä¸ºçŠ¶æ€å˜é‡æœ¬èº«ï¼Œä½†ä¸ºäº†ç®€å•èµ·è§ï¼Œè¿™é‡Œä¸è¿™æ ·åšã€‚å½“çº¿ç¨‹ä¹‹é—´éœ€è¦æ’åºæ—¶ï¼Œæ¡ä»¶å˜é‡ï¼ˆæˆ– ä¿¡å·é‡ï¼‰å°±èƒ½æ´¾ä¸Šç”¨åœºã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:2:2","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 æ­»é”bug ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:3:0","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 åŸºæœ¬ä»‹ç» é™¤äº†ä¸Šé¢æåˆ°çš„å¹¶å‘bugï¼Œåœ¨è®¸å¤šå…·æœ‰å¤æ‚é”å®šåè®®çš„å¹¶å‘ç³»ç»Ÿä¸­è¿˜ä¼šå‡ºç°ä¸€ä¸ªå…¸å‹çš„é—®é¢˜ï¼Œå³æ­»é”ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¾‹å¦‚çº¿ç¨‹ 1ï¼‰æŒæœ‰ä¸€ä¸ªé”ï¼ˆL1ï¼‰å¹¶ç­‰å¾…å¦ä¸€ä¸ªé”ï¼ˆL2ï¼‰æ—¶ï¼Œå°±ä¼šå‡ºç°æ­»é”ï¼›ä¸å¹¸çš„æ˜¯ï¼ŒæŒæœ‰é” L2 çš„çº¿ç¨‹ï¼ˆçº¿ç¨‹ 2ï¼‰æ­£åœ¨ç­‰å¾… L1 è¢«é‡Šæ”¾ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ¼”ç¤ºäº†è¿™ç§æ½œåœ¨çš„æ­»é”ï¼š Thread 1: Thread 2: pthread_mutex_lock(L1); pthread_mutex_lock(L2); pthread_mutex_lock(L2); pthread_mutex_lock(L1); æ³¨æ„ï¼Œå¦‚æœè¿™æ®µä»£ç è¿è¡Œï¼Œå¹¶ä¸ä¸€å®šä¼šå‘ç”Ÿæ­»é”ï¼›ç›¸åï¼Œå¦‚æœçº¿ç¨‹ 1 è·å–é” L1ï¼Œç„¶åçº¿ç¨‹ 2 å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåˆ™å¯èƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚æ­¤æ—¶ï¼Œçº¿ç¨‹ 2 è·å– L2ï¼Œå¹¶å°è¯•è·å– L1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é‡åˆ°äº†æ­»é”ï¼Œå› ä¸ºæ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œä¸¤ä¸ªçº¿ç¨‹éƒ½æ— æ³•è¿è¡Œã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå›¾ä¸­å‡ºç°å¾ªç¯å°±è¡¨æ˜å‡ºç°äº†æ­»é”ã€‚è¿™å¼ å›¾åº”è¯¥èƒ½è¯´æ˜é—®é¢˜ã€‚ç¨‹åºå‘˜åº”è¯¥å¦‚ä½•ç¼–å†™ä»£ç ä»¥ä¾¿ä»¥æŸç§æ–¹å¼å¤„ç†æ­»é”ï¼Ÿæˆ‘ä»¬é—®é¢˜çš„å…³é”®æ˜¯æˆ‘ä»¬åº”è¯¥å¦‚ä½•æ„å»ºç³»ç»Ÿæ¥é¢„é˜²ã€é¿å…æˆ–è‡³å°‘æ£€æµ‹æ­»é”å¹¶ä»ä¸­æ¢å¤ï¼Ÿè¿™æ˜¯å½“ä»Šç³»ç»Ÿä¸­çœŸæ­£çš„é—®é¢˜å—ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:3:1","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 ä¸ºä»€ä¹ˆä¼šå‡ºç°æ­»é” ä½ å¯èƒ½ä¼šæƒ³ï¼Œåƒä¸Šé¢è¿™æ ·çš„ç®€å•æ­»é”ä¼¼ä¹å¾ˆå®¹æ˜“é¿å…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœçº¿ç¨‹ 1 å’Œçº¿ç¨‹ 2 éƒ½ç¡®ä¿ä»¥ç›¸åŒçš„é¡ºåºæŠ“å–é”ï¼Œæ­»é”å°±æ°¸è¿œä¸ä¼šå‡ºç°ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°æ­»é”å‘¢ï¼Ÿ å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯ï¼Œåœ¨å¤§å‹ä»£ç åº“ä¸­ï¼Œç»„ä»¶ä¹‹é—´ä¼šäº§ç”Ÿå¤æ‚çš„ä¾èµ–å…³ç³»ã€‚ä»¥æ“ä½œç³»ç»Ÿä¸ºä¾‹ã€‚è™šæ‹Ÿå†…å­˜ç³»ç»Ÿå¯èƒ½éœ€è¦è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œä»¥ä¾¿ä»ç£ç›˜åˆ†é¡µè¯»å…¥ä¸€ä¸ªæ•°æ®å—ï¼›æ–‡ä»¶ç³»ç»Ÿéšåå¯èƒ½éœ€è¦ä¸€ä¸ªå†…å­˜é¡µæ¥è¯»å…¥è¯¥æ•°æ®å—ï¼Œä»è€Œä¸è™šæ‹Ÿå†…å­˜ç³»ç»Ÿå‘ç”Ÿå…³è”ã€‚å› æ­¤ï¼Œåœ¨å¤§å‹ç³»ç»Ÿä¸­è®¾è®¡é”å®šç­–ç•¥æ—¶å¿…é¡»å°å¿ƒè°¨æ…ï¼Œä»¥é¿å…ä»£ç ä¸­å¯èƒ½è‡ªç„¶å‡ºç°çš„å¾ªç¯ä¾èµ–å…³ç³»é€ æˆæ­»é”ã€‚ å¦ä¸€ä¸ªåŸå› æ˜¯å°è£…çš„æœ¬è´¨ã€‚ä½œä¸ºè½¯ä»¶å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬è¢«æ•™å¯¼è¦éšè—å®ç°çš„ç»†èŠ‚ï¼Œä»è€Œä½¿è½¯ä»¶æ›´å®¹æ˜“ä»¥æ¨¡å—åŒ–çš„æ–¹å¼æ„å»ºã€‚é—æ†¾çš„æ˜¯ï¼Œè¿™ç§æ¨¡å—åŒ–ä¸é”å®šå¹¶ä¸åŒ¹é…ã€‚æ­£å¦‚ Jula ç­‰äººæ‰€æŒ‡å‡ºçš„ï¼Œä¸€äº›çœ‹ä¼¼æ— å®³çš„æ¥å£å‡ ä¹ä¼šè®©ä½ é™·å…¥æ­»é”ã€‚ä¾‹å¦‚ï¼Œä»¥ Java å‘é‡ç±»å’Œ AddAll() æ–¹æ³•ä¸ºä¾‹ã€‚è¿™ä¸ªä¾‹ç¨‹çš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ Vector v1, v2; v1.AddAll(v2); åœ¨å†…éƒ¨ï¼Œç”±äºè¯¥æ–¹æ³•éœ€è¦æ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤éœ€è¦è·å–æ·»åŠ åˆ° (v1) çš„å‘é‡å’Œå‚æ•° (v2) çš„é”ã€‚è¯¥ä¾‹ç¨‹ä»¥æŸç§ä»»æ„é¡ºåºè·å–æ‰€è¿°é”ï¼ˆå…ˆæ˜¯ v1ï¼Œç„¶åæ˜¯ v2ï¼‰ï¼Œä»¥ä¾¿å°† v2 çš„å†…å®¹æ·»åŠ åˆ° v1ã€‚å¦‚æœå…¶ä»–çº¿ç¨‹å‡ ä¹åŒæ—¶è°ƒç”¨ v2.AddAll(v1)ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°æ­»é”ï¼Œè€Œæ‰€æœ‰è¿™äº›éƒ½å¯¹è°ƒç”¨åº”ç”¨ç¨‹åºæ¥è¯´æ˜¯éšè—çš„ã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:3:2","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 æ­»é”åŸå›  å‘ç”Ÿæ­»é”éœ€è¦æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼š äº’æ–¥ï¼šçº¿ç¨‹å£°æ˜å¯¹å…¶æ‰€éœ€èµ„æºçš„ç‹¬å æ§åˆ¶ï¼ˆä¾‹å¦‚ï¼Œçº¿ç¨‹è·å–é”ï¼‰ã€‚ æŒæœ‰å¹¶ç­‰å¾…ï¼šçº¿ç¨‹æŒæœ‰åˆ†é…ç»™å®ƒä»¬çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œå®ƒä»¬å·²ç»è·å–çš„é”ï¼‰ï¼ŒåŒæ—¶ç­‰å¾…å…¶ä»–èµ„æºï¼ˆä¾‹å¦‚ï¼Œå®ƒä»¬å¸Œæœ›è·å–çš„é”ï¼‰ã€‚ ä¸å¯æŠ¢å ï¼šæ— æ³•ä»æŒæœ‰èµ„æºçš„çº¿ç¨‹ä¸­å¼ºåˆ¶åˆ é™¤èµ„æºï¼ˆä¾‹å¦‚é”ï¼‰ã€‚ å¾ªç¯ç­‰å¾…ï¼šå­˜åœ¨å¾ªç¯çº¿ç¨‹é“¾ï¼Œä½¿å¾—æ¯ä¸ªçº¿ç¨‹æŒæœ‰é“¾ä¸­ä¸‹ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è¯·æ±‚çš„ä¸€ä¸ªæˆ–å¤šä¸ªèµ„æºï¼ˆä¾‹å¦‚ï¼Œé”ï¼‰ã€‚ å¦‚æœè¿™å››ä¸ªæ¡ä»¶ä¸­ä»»ä½•ä¸€ä¸ªä¸æ»¡è¶³ï¼Œå°±ä¸ä¼šå‘ç”Ÿæ­»é”ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆæ¢ç´¢é˜²æ­¢æ­»é”çš„æŠ€æœ¯ï¼›è¿™äº›ç­–ç•¥ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ—¨åœ¨é˜²æ­¢å‡ºç°ä¸Šè¿°æƒ…å†µä¹‹ä¸€ï¼Œå› æ­¤æ˜¯å¤„ç†æ­»é”é—®é¢˜çš„ä¸€ç§æ–¹æ³•ã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:3:3","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 é¢„é˜²æ­»é” 3.4.1 å¾ªç¯ç­‰å¾… æœ€å®ç”¨çš„é¢„é˜²æ–¹æ³•ï¼ˆå½“ç„¶ä¹Ÿæ˜¯ç»å¸¸ä½¿ç”¨çš„æ–¹æ³•ï¼‰å¯èƒ½æ˜¯ç¼–å†™é”å®šä»£ç ï¼Œä½¿å…¶æ°¸è¿œä¸ä¼šå¼•èµ·å¾ªç¯ç­‰å¾…æ¡ä»¶ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯ä¸ºé”çš„è·å–æä¾›ä¸€ä¸ªæ€»æ’åºã€‚ä¾‹å¦‚ï¼Œå¦‚æœç³»ç»Ÿä¸­åªæœ‰ä¸¤ä¸ªé”ï¼ˆL1 å’ŒL2ï¼‰ï¼Œåˆ™å¯ä»¥é€šè¿‡å§‹ç»ˆåœ¨ L2 ä¹‹å‰è·å– L1 æ¥é˜²æ­¢æ­»é”ã€‚è¿™ç§ä¸¥æ ¼çš„æ’åºå¯ä»¥ç¡®ä¿ä¸ä¼šå‡ºç°å¾ªç¯ç­‰å¾…ï¼Œä»è€Œé¿å…æ­»é”ã€‚ å½“ç„¶ï¼Œåœ¨æ›´å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œä¼šå­˜åœ¨ä¸¤ä¸ªä»¥ä¸Šçš„é”ï¼Œå› æ­¤å¾ˆéš¾å®ç°å®Œå…¨çš„é”æ’åºï¼ˆä¹Ÿè®¸æ ¹æœ¬æ²¡æœ‰å¿…è¦ï¼‰ã€‚å› æ­¤ï¼Œéƒ¨åˆ†æ’åºå¯ä»¥æœ‰æ•ˆåœ°æ„å»ºé”è·å–ç»“æ„ï¼Œä»è€Œé¿å…æ­»é”ã€‚Linux ä¸­çš„å†…å­˜æ˜ å°„ä»£ç å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„éƒ¨åˆ†é”æ’åºçš„çœŸå®ä¾‹å­ï¼›æºä»£ç é¡¶éƒ¨çš„æ³¨é‡Šæ­ç¤ºäº†åç»„ä¸åŒçš„é”è·å–é¡ºåºï¼ŒåŒ…æ‹¬ç®€å•çš„å¦‚ â€œi_mutex before i_mmap_mutex â€œå’Œæ›´å¤æ‚çš„å¦‚ â€œi_mmap_mutex before private_lock before swap_lock before mapping-\u003etree_lock\"ã€‚ å¯ä»¥æƒ³è±¡ï¼Œæ— è®ºæ˜¯å…¨éƒ¨æ’åºè¿˜æ˜¯éƒ¨åˆ†æ’åºï¼Œéƒ½éœ€è¦ç²¾å¿ƒè®¾è®¡é”å®šç­–ç•¥ï¼Œè€Œä¸”å¿…é¡»éå¸¸è°¨æ…ã€‚æ­¤å¤–ï¼Œæ’åºåªæ˜¯ä¸€ç§æƒ¯ä¾‹ï¼Œé©¬è™çš„ç¨‹åºå‘˜å¾ˆå®¹æ˜“å¿½ç•¥é”å®šåè®®ï¼Œå¹¶å¯èƒ½å¯¼è‡´æ­»é”ã€‚æœ€åï¼Œé”æ’åºè¦æ±‚å¯¹ä»£ç åº“ä»¥åŠå„ç§ä¾‹ç¨‹çš„è°ƒç”¨æ–¹å¼æœ‰æ·±å…¥çš„äº†è§£ï¼›åªè¦æœ‰ä¸€ä¸ªbugï¼Œå°±å¯èƒ½å¯¼è‡´æ­»é”ã€‚ TIPï¼šé€šè¿‡é”åœ°å€å¼ºåˆ¶æ‰§è¡Œé”æ’åº åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå‡½æ•°å¿…é¡»è·å–ä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰é”ï¼›å› æ­¤ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬å¿…é¡»å°å¿ƒï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°æ­»é”ã€‚æƒ³è±¡ä¸€ä¸ªæŒ‰å¦‚ä¸‹æ–¹å¼è°ƒç”¨çš„å‡½æ•°ï¼šdo_something(mutex_t *m1, mutex_t *m2)ã€‚å¦‚æœä»£ç æ€»æ˜¯åœ¨ m2 ä¹‹å‰è·å– m1ï¼ˆæˆ–è€…æ€»æ˜¯åœ¨ m1 ä¹‹å‰è·å– m2ï¼‰ï¼Œåˆ™å¯èƒ½ä¼šæ­»é”ï¼Œå› ä¸ºä¸€ä¸ªçº¿ç¨‹å¯ä»¥è°ƒç”¨ do_something(L1, L2)ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è°ƒç”¨ do_something(L2, L1)ã€‚ ä¸ºäº†é¿å…è¿™ä¸ªç‰¹æ®Šé—®é¢˜ï¼Œèªæ˜çš„ç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨æ¯ä¸ªé”çš„åœ°å€ä½œä¸ºè·å–é”çš„é¡ºåºã€‚é€šè¿‡ä»¥ä»é«˜åˆ°ä½æˆ–ä»ä½åˆ°é«˜çš„åœ°å€é¡ºåºè·å–é”ï¼Œdo_something() å¯ä»¥ä¿è¯å®ƒå§‹ç»ˆä»¥ç›¸åŒçš„é¡ºåºè·å–é”ï¼Œæ— è®ºå®ƒä»¬ä¼ å…¥çš„é¡ºåºå¦‚ä½•ã€‚ä»£ç çœ‹èµ·æ¥åƒè¿™æ ·è¿™ï¼š if (m1 \u003e m2) { // grab locks in high-to-low address order pthread_mutex_lock(m1); pthread_mutex_lock(m2); } else { pthread_mutex_lock(m2); pthread_mutex_lock(m1); } // Code assumes that m1 != m2 (it is not the same lock) é€šè¿‡ä½¿ç”¨è¿™ç§ç®€å•çš„æŠ€æœ¯ï¼Œç¨‹åºå‘˜å¯ä»¥ç¡®ä¿ç®€å•é«˜æ•ˆåœ°å®ç°æ— æ­»é”çš„å¤šé”è·å–ã€‚ 3.4.2 æŒæœ‰å¹¶ç­‰å¾… é€šè¿‡åŸå­æ–¹å¼ä¸€æ¬¡æ€§è·å–æ‰€æœ‰é”ï¼Œå¯ä»¥é¿å…æ­»é”çš„ä¿æŒå’Œç­‰å¾…è¦æ±‚ã€‚åœ¨å®é™…æ“ä½œä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š pthread_mutex_lock(prevention); // begin lock acquisition pthread_mutex_lock(L1); pthread_mutex_lock(L2); ... pthread_mutex_unlock(prevention); // end é€šè¿‡é¦–å…ˆè·å–é”preventionï¼Œæ­¤ä»£ç ç¡®ä¿åœ¨è·å–é”æ—¶ä¸ä¼šå‘ç”Ÿä»»ä½•ä¸åŠæ—¶çš„çº¿ç¨‹åˆ‡æ¢ï¼Œä»è€Œå†æ¬¡é¿å…æ­»é”ã€‚å½“ç„¶ï¼Œè¿™è¦æ±‚ä»»ä½•æ—¶å€™ä»»ä½•çº¿ç¨‹æŠ“å–ä¸€ä¸ªé”æ—¶ï¼Œå®ƒé¦–å…ˆè·å–å…¨å±€é¢„é˜²é”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹å°è¯•ä»¥ä¸åŒé¡ºåºæŠ“å–é”L1å’ŒL2ï¼Œåˆ™æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºåœ¨è¿™æ ·åšæ—¶å®ƒå°†æŒæœ‰preventioné”ã€‚ è¯·æ³¨æ„ï¼Œç”±äºå¤šç§åŸå› ï¼Œè¯¥è§£å†³æ–¹æ¡ˆå­˜åœ¨é—®é¢˜ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œå°è£…å¯¹æˆ‘ä»¬ä¸åˆ©ï¼šå½“è°ƒç”¨ä¾‹ç¨‹æ—¶ï¼Œè¿™ç§æ–¹æ³•è¦æ±‚æˆ‘ä»¬å‡†ç¡®åœ°çŸ¥é“å¿…é¡»æŒæœ‰å“ªäº›é”å¹¶æå‰è·å–å®ƒä»¬ã€‚è¿™ç§æŠ€æœ¯è¿˜å¯èƒ½ä¼šé™ä½å¹¶å‘æ€§ï¼Œå› ä¸ºæ‰€æœ‰é”éƒ½å¿…é¡»å°½æ—©ï¼ˆç«‹å³ï¼‰è·å–ï¼Œè€Œä¸æ˜¯åœ¨çœŸæ­£éœ€è¦æ—¶è·å–ã€‚ 3.4.3 ä¸å¯æŠ¢å  å› ä¸ºæˆ‘ä»¬é€šå¸¸å°†é”è§†ä¸ºä¸€ç›´ä¿æŒåˆ°è°ƒç”¨è§£é”ä¸ºæ­¢ï¼Œæ‰€ä»¥å¤šæ¬¡è·å–é”å¸¸å¸¸ä¼šç»™æˆ‘ä»¬å¸¦æ¥éº»çƒ¦ï¼Œå› ä¸ºåœ¨ç­‰å¾…ä¸€ä¸ªé”æ—¶ï¼Œæˆ‘ä»¬æ­£åœ¨æŒæœ‰å¦ä¸€ä¸ªé”ã€‚è®¸å¤šçº¿ç¨‹åº“æä¾›äº†ä¸€ç»„æ›´çµæ´»çš„æ¥å£æ¥å¸®åŠ©é¿å…è¿™ç§æƒ…å†µã€‚å…·ä½“æ¥è¯´ï¼Œä¾‹ç¨‹ pthread_mutex_trylock() è¦ä¹ˆè·å–é”ï¼ˆå¦‚æœå¯ç”¨ï¼‰å¹¶è¿”å›æˆåŠŸï¼Œè¦ä¹ˆè¿”å›æŒ‡ç¤ºé”å·²è¢«æŒæœ‰çš„bugä»£ç ï¼›åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ‚¨æƒ³æŠ“ä½è¯¥é”ï¼Œå¯ä»¥ç¨åé‡è¯•ã€‚ è¿™æ ·çš„æ¥å£å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ä½¿ç”¨æ¥æ„å»ºæ— æ­»é”ã€æœ‰åºé²æ£’çš„é”è·å–åè®®ï¼š top: pthread_mutex_lock(L1); if (pthread_mutex_trylock(L2) != 0) { pthread_mutex_unlock(L1); goto top; } éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥éµå¾ªç›¸åŒçš„åè®®ï¼Œä½†ä»¥å¦ä¸€ç§é¡ºåºï¼ˆå…ˆ L2 å L1ï¼‰è·å–é”ï¼Œè¿™æ ·ç¨‹åºä»ç„¶ä¸ä¼šå‡ºç°æ­»é”ã€‚ç„¶è€Œï¼Œä¸€ä¸ªæ–°çš„é—®é¢˜å‡ºç°äº†ï¼šæ´»é”ã€‚ä¸¤ä¸ªçº¿ç¨‹æœ‰å¯èƒ½ï¼ˆè™½ç„¶å¯èƒ½æ€§ä¸å¤§ï¼‰éƒ½åœ¨é‡å¤å°è¯•è¿™ç§é¡ºåºï¼Œä½†å¤šæ¬¡éƒ½æ— æ³•è·å¾—ä¸¤ä¸ªé”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªç³»ç»Ÿéƒ½åœ¨é‡å¤è¿è¡Œè¿™ä¸ªä»£ç åºåˆ—ï¼ˆå› æ­¤ä¸æ˜¯æ­»é”ï¼‰ï¼Œä½†å´æ²¡æœ‰å–å¾—è¿›å±•ï¼Œå› æ­¤è¢«ç§°ä¸ºæ´»é”ã€‚æ´»é”é—®é¢˜ä¹Ÿæœ‰è§£å†³æ–¹æ³•ï¼šä¾‹å¦‚ï¼Œå¯ä»¥åœ¨å¾ªç¯ä¹‹å‰æ·»åŠ ä¸€ä¸ªéšæœºå»¶è¿Ÿï¼Œç„¶åé‡æ–°å°è¯•æ•´ä¸ªè¿‡ç¨‹ï¼Œä»è€Œé™ä½ç«äº‰çº¿ç¨‹ä¹‹é—´é‡å¤å¹²æ‰°çš„å‡ ç‡ã€‚ å…³äºè¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„ä¸€ç‚¹æ˜¯ï¼šå®ƒç»•è¿‡äº†ä½¿ç”¨ trylock æ–¹æ³•çš„éš¾ç‚¹ã€‚ç¬¬ä¸€ä¸ªå¯èƒ½å†æ¬¡å‡ºç°çš„é—®é¢˜æ˜¯å°è£…ï¼šå¦‚æœè¿™äº›é”ä¸­çš„ä¸€ä¸ªè¢«åŸ‹åœ¨æŸä¸ªè¢«è°ƒç”¨çš„ä¾‹ç¨‹ä¸­ï¼Œé‚£ä¹ˆè·³å›èµ·ç‚¹çš„å®ç°å°±ä¼šå˜å¾—æ›´åŠ å¤æ‚ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨è·å– L1 åï¼Œä»£ç åˆ†é…äº†ä¸€äº›å†…å­˜ï¼Œé‚£ä¹ˆåœ¨è·å– L2 å¤±è´¥åï¼Œå°±å¿…é¡»é‡Šæ”¾è¿™äº›å†…å­˜ï¼Œç„¶åå†è·³å›åˆ°é¡¶å±‚ï¼Œé‡æ–°å°è¯•æ•´ä¸ªåºåˆ—ã€‚ä¸è¿‡ï¼Œåœ¨æœ‰é™çš„æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚å‰é¢æåˆ°çš„ Java å‘é‡æ–¹æ³•ï¼‰ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½ä¼šå¾ˆæœ‰æ•ˆã€‚ ä½ å¯èƒ½è¿˜ä¼šæ³¨æ„åˆ°ï¼Œè¿™ç§æ–¹æ³•å¹¶æ²¡æœ‰çœŸæ­£åŠ å…¥æŠ¢å ï¼ˆä»æ‹¥æœ‰é”çš„çº¿ç¨‹ä¸­å¼ºè¡Œå¤ºèµ°é”çš„æ“ä½œï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨ trylock æ–¹æ³•å…è®¸å¼€å‘è€…ä»¥ä¸€ç§ä¼˜é›…çš„æ–¹å¼é€€å‡ºé”çš„æ‰€æœ‰æƒï¼ˆå³æŠ¢å è‡ªå·±çš„æ‰€æœ‰æƒï¼‰ã€‚ä¸è¿‡ï¼Œè¿™æ˜¯ä¸€ç§å®ç”¨çš„æ–¹æ³•ï¼Œå› æ­¤å°½ç®¡åœ¨è¿™æ–¹é¢å¹¶ä¸å®Œç¾ï¼Œæˆ‘ä»¬è¿˜æ˜¯å°†å…¶åŒ…å«åœ¨è¿™é‡Œã€‚ 3.4.4 äº’æ–¥ æœ€åä¸€ç§é˜²èŒƒæŠ€æœ¯æ˜¯å®Œå…¨é¿å…äº’æ–¥ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬çŸ¥é“è¿™å¾ˆå›°éš¾ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›è¿è¡Œçš„ä»£ç ç¡®å®å­˜åœ¨ä¸´ç•ŒåŒºã€‚é‚£ä¹ˆæˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆå‘¢ï¼Ÿ Herlihy æå‡ºäº†ä¸€ä¸ªæƒ³æ³•ï¼šæˆ‘ä»¬å¯ä»¥è®¾è®¡å„ç§å®Œå…¨ä¸éœ€è¦é”çš„æ•°æ®ç»“æ„ã€‚è¿™äº›æ— é”ï¼ˆä»¥åŠç›¸å…³çš„æ— ç­‰å¾…ï¼‰æ–¹æ³•èƒŒåçš„ç†å¿µå¾ˆç®€å•ï¼šåˆ©ç”¨å¼ºå¤§çš„ç¡¬ä»¶æŒ‡ä»¤ï¼Œå¯ä»¥ä»¥ä¸éœ€è¦æ˜¾å¼é”å®šçš„æ–¹å¼æ„å»ºæ•°æ®ç»“æ„ã€‚ ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€æ¡æ¯”è¾ƒå’Œäº¤æ¢æŒ‡ä»¤ï¼Œä½ å¯èƒ½è¿˜è®°å¾—è¿™æ˜¯ä¸€æ¡ç”±ç¡¬ä»¶æä¾›çš„åŸå­æŒ‡ä»¤ï¼Œå®ƒçš„ä½œç”¨å¦‚ä¸‹ï¼š int CompareAndSwap(int *address, int expected, int new) { if (*address == expected) { *address = new; return 1; // success } return 0; // failure } æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç°åœ¨æƒ³ä»¥åŸå­æ–¹å¼å°†ä¸€ä¸ªå€¼é€’å¢ä¸€å®šé‡ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š void AtomicIncrement(int *value, int amount) { do { int old = *value; } while (CompareAndSwap(value, old, old + amount) == 0); } æˆ‘ä»¬æ²¡æœ‰è·å–é”ï¼Œè¿›è¡Œæ›´æ–°ï¼Œç„¶åé‡Šæ”¾å®ƒï¼Œè€Œæ˜¯æ„å»ºäº†ä¸€ç§æ–¹æ³•ï¼Œåå¤å°è¯•å°†å€¼æ›´æ–°ä¸ºå¿ƒæ™ºå¹¶ä½¿ç”¨CompareAndSwapæ¥æ‰§è¡Œæ­¤æ“ä½œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸ä¼šè·å–é”ï¼Œå¹¶ä¸”ä¸ä¼šå‡ºç°æ­»é”ï¼ˆå°½ç®¡æ´»é”ä»ç„¶æ˜¯å¯èƒ½çš„ï¼‰ã€‚ è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­ï¼šåˆ—è¡¨æ’å…¥ã€‚ä»¥ä¸‹æ˜¯åœ¨åˆ—è¡¨å¤´éƒ¨æ’å…¥çš„ä»£ç ï¼š void insert(int value) { node_t *n = malloc(sizeof(node_t)); assert(n != NULL); n-\u003evalue = value; n-\u003enext = head; head = n; } è¿™æ®µä»£ç æ‰§è¡Œç®€å•çš„æ’å…¥æ“ä½œï¼Œä½†å¦‚æœå¤šä¸ªçº¿ç¨‹ â€œåŒæ—¶ â€œè°ƒç”¨ï¼Œå°±ä¼šå‡ºç°ç«äº‰æ¡ä»¶ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è·å–å’Œé‡Šæ”¾é”æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š void insert(int value) { node_t *n = malloc(sizeof(node_t)); assert(n != NULL); n-\u003evalue = value; pthread_mutex_lock(listlock); // begin critical section n-\u003enext = head; head = n; pthread_mutex_unlock(listlock); // end critical section } åœ¨è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¼ ç»Ÿçš„é”ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨CompareAndSwapæŒ‡ä»¤ï¼Œä»¥æ— é”å®šæ–¹å¼æ‰§è¡Œæ’å…¥æ“ä½œã€‚ä¸‹é¢æ˜¯ä¸€ç§å¯è¡Œçš„æ–¹æ³•ï¼š void insert(int value) { node_t *n = malloc(sizeof(node_t)); assert(n != NULL); n-\u003evalue = value; do { n-\u003enext = head; } while (CompareAndSwap(\u0026head, n-\u003enext, n) == 0); } è¿™é‡Œçš„ä»£ç ä¼šæ›´æ–°ä¸‹ä¸€ä¸ªæŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘å½“å‰å¤´éƒ¨ï¼Œç„¶åå°è¯•å°†æ–°åˆ›å»ºçš„èŠ‚ç‚¹äº¤æ¢åˆ°åˆ—è¡¨çš„æ–°å¤´éƒ¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹åœ¨æ­¤æœŸé—´æˆåŠŸåœ°äº¤æ¢äº†ä¸€ä¸ªæ–°çš„å¤´ï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œå°±ä¼šå¤±è´¥ï¼Œä»è€Œå¯¼è‡´è¿™ä¸ªçº¿ç¨‹ç”¨æ–°çš„å¤´å†æ¬¡é‡è¯•ã€‚ å½“ç„¶ï¼Œå»ºç«‹ä¸€ä¸ªæœ‰ç”¨çš„åˆ—è¡¨éœ€è¦çš„ä¸ä»…ä»…æ˜¯åˆ—è¡¨æ’å…¥ï¼Œæ¯«ä¸å¥‡æ€ªï¼Œå»ºç«‹ä¸€ä¸ªèƒ½ä»¥æ— é”æ–¹å¼æ’å…¥ã€åˆ é™¤å’Œæ‰§è¡ŒæŸ¥æ‰¾çš„åˆ—è¡¨å¹¶éæ˜“äº‹ã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:3:4","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.5 é€šè¿‡è°ƒåº¦é¿å…æ­»é” åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé¿å…æ­»é”æ¯”é¢„é˜²æ­»é”æ›´å¯å–ã€‚é¿å…æ­»é”éœ€è¦ä¸€äº›å…¨å±€çŸ¥è¯†ï¼Œäº†è§£å„ä¸ªçº¿ç¨‹åœ¨æ‰§è¡ŒæœŸé—´å¯èƒ½ä¼šè·å–å“ªäº›é”ï¼Œå¹¶éšåä»¥ä¿è¯ä¸ä¼šå‘ç”Ÿæ­»é”çš„æ–¹å¼è°ƒåº¦æ‰€è¿°çº¿ç¨‹ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå¤„ç†å™¨å’Œå››ä¸ªçº¿ç¨‹ï¼Œå¿…é¡»åœ¨å®ƒä»¬ä¸Šè¿›è¡Œè°ƒåº¦ã€‚è¿›ä¸€æ­¥å‡è®¾æˆ‘ä»¬çŸ¥é“çº¿ç¨‹ 1 (T1) è·å–é” L1 å’Œ L2ï¼ˆä»¥æŸç§é¡ºåºï¼Œåœ¨æ‰§è¡ŒæœŸé—´çš„æŸä¸ªæ—¶åˆ»ï¼‰ï¼ŒT2 ä¹Ÿè·å– L1 å’Œ L2ï¼ŒT3 ä»…è·å– L2ï¼Œè€Œ T4 æ ¹æœ¬ä¸è·å–é”ã€‚æˆ‘ä»¬å¯ä»¥ä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºçº¿ç¨‹çš„è¿™äº›é”è·å–éœ€æ±‚ï¼š T1 T2 T3 T4 L1 yes yes no no L2 yes yes yes no å› æ­¤ï¼Œæ™ºèƒ½è°ƒåº¦ç¨‹åºå¯ä»¥è®¡ç®—å‡ºï¼Œåªè¦ T1 å’Œ T2 ä¸åŒæ—¶è¿è¡Œï¼Œå°±ä¸ä¼šå‡ºç°æ­»é”ã€‚ä¸‹é¢å°±æ˜¯è¿™æ ·ä¸€ä¸ªè°ƒåº¦ç¨‹åºï¼š è¯·æ³¨æ„ï¼Œï¼ˆT3 å’Œ T1ï¼‰æˆ–ï¼ˆT3 å’Œ T2ï¼‰æ˜¯å¯ä»¥é‡å çš„ã€‚å³ä½¿ T3 æŠ“ä½äº†é” L2ï¼Œå®ƒä¹Ÿä¸ä¼šå› ä¸ºä¸å…¶ä»–çº¿ç¨‹åŒæ—¶è¿è¡Œè€Œå¯¼è‡´æ­»é”ï¼Œå› ä¸ºå®ƒåªæŠ“ä½äº†ä¸€ä¸ªé”ã€‚è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯¹ç›¸åŒèµ„æºï¼ˆåŒæ ·æ˜¯é” L1 å’Œ L2ï¼‰çš„äº‰ç”¨æ›´å¤šï¼Œå¦‚ä¸‹é¢çš„äº‰ç”¨è¡¨æ‰€ç¤ºï¼š T1 T2 T3 T4 L1 yes yes Yes no L2 yes yes yes no å…¶ä¸­ï¼Œçº¿ç¨‹ T1ã€T2 å’Œ T3 éƒ½éœ€è¦åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸ªæ—¶åˆ»åŒæ—¶æŠ“ä½é” L1 å’Œ L2ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯ä»¥ä¿è¯ä¸å‘ç”Ÿæ­»é”çš„è°ƒåº¦è¡¨ï¼š æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œé™æ€è°ƒåº¦å¯¼è‡´äº†ä¸€ç§ä¿å®ˆçš„æ–¹æ³•ï¼Œå³ T1ã€T2 å’Œ T3 éƒ½åœ¨åŒä¸€ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œï¼Œå› æ­¤å®Œæˆä½œä¸šçš„æ€»æ—¶é—´å¤§å¤§å»¶é•¿ã€‚è™½ç„¶è¿™äº›ä»»åŠ¡æœ‰å¯èƒ½åŒæ—¶è¿è¡Œï¼Œä½†ç”±äºæ‹…å¿ƒæ­»é”ï¼Œæˆ‘ä»¬æ— æ³•è¿™æ ·åšï¼Œè€Œä»£ä»·å°±æ˜¯æ€§èƒ½ã€‚ Dijkstra çš„é“¶è¡Œå®¶ç®—æ³•å°±æ˜¯è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªè‘—åä¾‹å­ã€‚é—æ†¾çš„æ˜¯ï¼Œè¿™äº›æ–¹æ³•åªåœ¨éå¸¸æœ‰é™çš„ç¯å¢ƒä¸­æœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œåœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œäººä»¬å®Œå…¨äº†è§£å¿…é¡»è¿è¡Œçš„å…¨éƒ¨ä»»åŠ¡é›†åŠå…¶æ‰€éœ€çš„é”ã€‚æ­¤å¤–ï¼Œè¿™ç§æ–¹æ³•è¿˜ä¼šé™åˆ¶å¹¶å‘æ€§ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šæ–‡ç¬¬äºŒä¸ªä¾‹å­ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚å› æ­¤ï¼Œé€šè¿‡è°ƒåº¦é¿å…æ­»é”å¹¶ä¸æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„é€šç”¨è§£å†³æ–¹æ¡ˆã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:3:5","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.6 æ£€æµ‹å’Œæ¢å¤ æœ€åä¸€ä¸ªé€šç”¨ç­–ç•¥æ˜¯å…è®¸æ­»é”å¶å°”å‘ç”Ÿï¼Œç„¶ååœ¨æ£€æµ‹åˆ°æ­»é”åé‡‡å–ä¸€äº›æªæ–½ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿæ¯å¹´éƒ½ä¼šå‡ºç°ä¸€æ¬¡æ­»é”ï¼Œé‚£ä¹ˆä½ åªéœ€é‡å¯æ“ä½œç³»ç»Ÿï¼Œç„¶åç»§ç»­æ„‰å¿«åœ°ï¼ˆæˆ–æš´èºåœ°ï¼‰å·¥ä½œã€‚å¦‚æœæ­»é”å¾ˆå°‘å‘ç”Ÿï¼Œé‚£ä¹ˆè¿™ç§ä¸è§£å†³é—®é¢˜çš„æ–¹æ³•ç¡®å®éå¸¸å®ç”¨ã€‚ è®¸å¤šæ•°æ®åº“ç³»ç»Ÿéƒ½é‡‡ç”¨äº†æ­»é”æ£€æµ‹å’Œæ¢å¤æŠ€æœ¯ã€‚æ­»é”æ£€æµ‹å™¨å®šæœŸè¿è¡Œï¼Œæ„å»ºèµ„æºå›¾å¹¶æ£€æŸ¥å…¶æ˜¯å¦å­˜åœ¨å¾ªç¯ã€‚ä¸€æ—¦å‡ºç°å¾ªç¯ï¼ˆæ­»é”ï¼‰ï¼Œç³»ç»Ÿå°±éœ€è¦é‡æ–°å¯åŠ¨ã€‚å¦‚æœé¦–å…ˆéœ€è¦å¯¹æ•°æ®ç»“æ„è¿›è¡Œæ›´å¤æ‚çš„ä¿®å¤ï¼Œåˆ™å¯èƒ½éœ€è¦äººå·¥å‚ä¸ï¼Œä»¥ç®€åŒ–ä¿®å¤è¿‡ç¨‹ã€‚ ","date":"2024-05-11","objectID":"/posts/25.%E5%B9%B6%E5%8F%91bug/:3:6","tags":["OS"],"title":"å¹¶å‘bug","uri":"/posts/25.%E5%B9%B6%E5%8F%91bug/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ä¿¡å·é‡ï¼šå®šä¹‰ ä¿¡å·é‡æ˜¯ä¸€ä¸ªå…·æœ‰æ•´æ•°å€¼çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªä¾‹ç¨‹å¯¹å…¶è¿›è¡Œæ“ä½œï¼›åœ¨ POSIX æ ‡å‡†ä¸­ï¼Œè¿™äº›ä¾‹ç¨‹æ˜¯ sem_wait() å’Œ sem_post()ã€‚å› ä¸ºä¿¡å·é‡çš„åˆå§‹å€¼å†³å®šäº†å®ƒçš„è¡Œä¸ºï¼Œæ‰€ä»¥åœ¨è°ƒç”¨ä»»ä½•å…¶ä»–ä¾‹ç¨‹ä¸ä¿¡å·é‡äº¤äº’ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆå°†å…¶åˆå§‹åŒ–ä¸ºæŸä¸ªå€¼ï¼Œä»£ç æ‰€ä¸‹ç¤ºã€‚ #include \u003csemaphore.h\u003e sem_t s; sem_init(\u0026s, 0, 1); åœ¨ä»£ç ï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªä¿¡å·é‡ s å¹¶é€šè¿‡å°† 1 ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’æ¥å°†å…¶åˆå§‹åŒ–å€¼ä¸º 1ã€‚åœ¨æˆ‘ä»¬å°†çœ‹åˆ°çš„æ‰€æœ‰ç¤ºä¾‹ä¸­ï¼Œsem_init() çš„ç¬¬äºŒä¸ªå‚æ•°éƒ½å°†è®¾ç½®ä¸º 0ï¼›**è¿™è¡¨æ˜ä¿¡å·é‡åœ¨åŒä¸€è¿›ç¨‹ä¸­çš„çº¿ç¨‹ä¹‹é—´å…±äº«ã€‚**æœ‰å…³ä¿¡å·é‡å…¶ä»–ç”¨æ³•çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå³å¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥åŒæ­¥ä¸åŒè¿›ç¨‹ä¹‹é—´çš„è®¿é—®ï¼‰ï¼Œè¯·å‚é˜…æ‰‹å†Œé¡µï¼šman sem_initï¼Œè¿™éœ€è¦ç¬¬äºŒä¸ªå‚æ•°çš„ä¸åŒå€¼ã€‚ ä¿¡å·é‡åˆå§‹åŒ–åï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ä¸¤ä¸ªå‡½æ•°ä¹‹ä¸€ä¸ä¹‹äº¤äº’ï¼šsem_wait() æˆ– sem_post()ã€‚è¿™ä¸¤ä¸ªå‡½æ•°çš„è¡Œä¸ºå¦‚ä¸‹æ‰€ç¤ºã€‚ int sem_wait(sem_t *s) { // Decrement the value of semaphore s by one // If the value becomes negative, the calling thread will block until it becomes positive // Once the value becomes positive, the thread will continue } int sem_post(sem_t *s) { // Increment the value of semaphore s by one // If there are one or more threads waiting (i.e., the semaphore was previously negative), // wake one of the waiting threads } ç›®å‰ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒè¿™äº›ä¾‹ç¨‹çš„å®æ–½ï¼Œè¿™æ˜¾ç„¶éœ€è¦ä¸€äº›å°å¿ƒï¼›å½“å¤šä¸ªçº¿ç¨‹è°ƒç”¨ sem_wait() å’Œ sem_post() æ—¶ï¼Œæ˜¾ç„¶éœ€è¦ç®¡ç†è¿™äº›ä¸´ç•ŒåŒºã€‚æˆ‘ä»¬ç°åœ¨å°†é‡ç‚¹è®¨è®ºå¦‚ä½•ä½¿ç”¨è¿™äº›åŸè¯­ï¼›ç¨åæˆ‘ä»¬å¯èƒ½ä¼šè®¨è®ºå®ƒä»¬æ˜¯å¦‚ä½•æ„å»ºçš„ã€‚ æˆ‘ä»¬åº”è¯¥åœ¨è¿™é‡Œè®¨è®ºæ¥å£çš„å‡ ä¸ªé‡è¦æ–¹é¢ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° sem_wait() è¦ä¹ˆç«‹å³è¿”å›ï¼ˆå› ä¸ºå½“æˆ‘ä»¬è°ƒç”¨ sem_wait() æ—¶ä¿¡å·é‡çš„å€¼ä¸º 1 æˆ–æ›´é«˜ï¼‰ï¼Œè¦ä¹ˆå¯¼è‡´è°ƒç”¨è€…æš‚åœæ‰§è¡Œä»¥ç­‰å¾…åç»­çš„æ“ä½œã€‚å½“ç„¶ï¼Œå¤šä¸ªè°ƒç”¨çº¿ç¨‹å¯èƒ½ä¼šè°ƒç”¨ sem_wait()ï¼Œå› æ­¤æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šæ’é˜Ÿç­‰å¾…è¢«å”¤é†’ã€‚ å…¶æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° sem_post() ä¸ä¼šåƒ sem_wait() é‚£æ ·ç­‰å¾…æŸäº›ç‰¹å®šæ¡ä»¶æˆç«‹ã€‚ç›¸åï¼Œå®ƒåªæ˜¯å¢åŠ ä¿¡å·é‡çš„å€¼ï¼Œç„¶åï¼Œå¦‚æœæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…è¢«å”¤é†’ï¼Œåˆ™å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ã€‚ ç¬¬ä¸‰ï¼Œä¿¡å·é‡çš„å€¼ï¼Œå½“ä¸ºè´Ÿæ—¶ï¼Œç­‰äºç­‰å¾…çº¿ç¨‹çš„æ•°é‡ã€‚è™½ç„¶ä¿¡å·é‡çš„ç”¨æˆ·ä¸€èˆ¬çœ‹ä¸åˆ°è¿™ä¸ªå€¼ï¼Œä½†è¿™ä¸ªä¸å˜é‡è¿˜æ˜¯å€¼å¾—äº†è§£çš„ï¼Œä¹Ÿè®¸å®ƒèƒ½å¸®åŠ©ä½ è®°ä½ä¿¡å·é‡çš„åŠŸèƒ½ã€‚ ï¼ˆæš‚æ—¶ï¼‰ä¸ç”¨æ‹…å¿ƒä¿¡å·é‡å†…å¯èƒ½å‡ºç°çš„ç«äº‰æ¡ä»¶ï¼›å‡è®¾å®ƒä»¬æ‰€åšçš„æ“ä½œæ˜¯åŸå­æ‰§è¡Œçš„ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šä½¿ç”¨é”å’Œæ¡ä»¶å˜é‡æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:1:0","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 äºŒè¿›åˆ¶ä¿¡å·é‡ï¼ˆé”ï¼‰ æˆ‘ä»¬ç°åœ¨å‡†å¤‡ä½¿ç”¨ä¿¡å·é‡ã€‚æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç”¨é€”å°†æ˜¯æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰çš„ï¼šä½¿ç”¨ä¿¡å·é‡ä½œä¸ºé”ã€‚ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼›å…¶ä¸­ï¼Œæ‚¨ä¼šçœ‹åˆ°æˆ‘ä»¬åªæ˜¯ç”¨ sem_wait()/sem post() åŒ…å›´æ„Ÿå…´è¶£çš„ä¸´ç•ŒåŒºã€‚ç„¶è€Œï¼Œä½¿è¿™é¡¹å·¥ä½œæˆåŠŸçš„å…³é”®æ˜¯ä¿¡å·é‡ m çš„åˆå§‹å€¼ï¼ˆä»£ç ä¸­åˆå§‹åŒ–ä¸º Xï¼‰ã€‚ X åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿ sem_t m; sem_init(\u0026m, 0, X); // Initialize semaphore to X; what should X be? sem_wait(\u0026m); // Critical section here sem_post(\u0026m); å›é¡¾ä¸Šé¢ sem_wait() å’Œ sem_post() ä¾‹ç¨‹çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆå§‹å€¼åº”è¯¥æ˜¯ 1ã€‚ ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œè®©æˆ‘ä»¬æƒ³è±¡æœ‰ä¸¤ä¸ªçº¿ç¨‹çš„åœºæ™¯ã€‚ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹0ï¼‰è°ƒç”¨sem_wait()ï¼›å®ƒé¦–å…ˆä¼šé€’å‡ä¿¡å·é‡çš„å€¼ï¼Œå°†å…¶æ›´æ”¹ä¸º 0ã€‚ç„¶åï¼Œä»…å½“è¯¥å€¼ä¸å¤§äºæˆ–ç­‰äº 0 æ—¶æ‰ä¼šç­‰å¾…ã€‚å› ä¸ºè¯¥å€¼ä¸º 0ï¼Œæ‰€ä»¥ sem_wait() å°†ç®€å•åœ°è¿”å›ï¼Œå¹¶ä¸”è°ƒç”¨çº¿ç¨‹å°†ç»§ç»­ï¼Œçº¿ç¨‹ 0 ç°åœ¨å¯ä»¥è‡ªç”±è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœå½“çº¿ç¨‹ 0 åœ¨ä¸´ç•ŒåŒºå†…æ—¶æ²¡æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è·å–é”ï¼Œåˆ™å½“å®ƒè°ƒç”¨ sem_post() æ—¶ï¼Œå®ƒåªä¼šå°†ä¿¡å·é‡çš„å€¼æ¢å¤ä¸º 1ï¼ˆå¹¶ä¸”ä¸ä¼šå”¤é†’æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ï¼Œå› ä¸ºæ²¡æœ‰ï¼‰ ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†è¯¥åœºæ™¯çš„è¸ªè¿¹ã€‚ å½“çº¿ç¨‹ 0 â€œæŒæœ‰é”â€ï¼ˆå³ï¼Œå®ƒå·²è°ƒç”¨ sem_wait() ä½†å°šæœªè°ƒç”¨ sem_post()ï¼‰ï¼Œå¹¶ä¸”å¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹ 1ï¼‰å°è¯•é€šè¿‡è°ƒç”¨ sem_wait è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œä¼šå‡ºç°æ›´æœ‰è¶£çš„æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ 1 ä¼šå°†ä¿¡å·é‡çš„å€¼é€’å‡è‡³ $-1$ï¼Œä»è€Œç­‰å¾…ï¼ˆä½¿å…¶è‡ªèº«è¿›å…¥ç¡çœ çŠ¶æ€å¹¶æ”¾å¼ƒå¤„ç†å™¨ï¼‰ã€‚å½“çº¿ç¨‹ 0 å†æ¬¡è¿è¡Œæ—¶ï¼Œå®ƒæœ€ç»ˆä¼šè°ƒç”¨ sem_post()ï¼Œå°†ä¿¡å·é‡çš„å€¼é€’å¢å›é›¶ï¼Œç„¶åå”¤é†’ç­‰å¾…çº¿ç¨‹ï¼ˆçº¿ç¨‹ 1ï¼‰ï¼Œçº¿ç¨‹ 1 å°±èƒ½å¤Ÿä¸ºè‡ªå·±è·å–é”ã€‚å½“çº¿ç¨‹ 1 å®Œæˆæ—¶ï¼Œå®ƒå°†å†æ¬¡å¢åŠ ä¿¡å·é‡çš„å€¼ï¼Œå†æ¬¡å°†å…¶æ¢å¤ä¸º 1ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†æ­¤ç¤ºä¾‹çš„è¸ªè¿¹ã€‚é™¤äº†çº¿ç¨‹æ“ä½œå¤–ï¼Œå›¾ä¸­è¿˜æ˜¾ç¤ºäº†æ¯ä¸ªçº¿ç¨‹çš„è°ƒåº¦å™¨çŠ¶æ€ï¼šè¿è¡Œã€å°±ç»ªï¼ˆå³å¯è¿è¡Œä½†æœªè¿è¡Œï¼‰å’Œä¼‘çœ ã€‚è¯·ç‰¹åˆ«æ³¨æ„ï¼Œçº¿ç¨‹ 1 åœ¨è¯•å›¾è·å–å·²æŒæœ‰çš„é”æ—¶è¿›å…¥äº†ç¡çœ çŠ¶æ€ï¼›åªæœ‰å½“çº¿ç¨‹ 0 å†æ¬¡è¿è¡Œæ—¶ï¼Œçº¿ç¨‹ 1 æ‰èƒ½è¢«å”¤é†’å¹¶å†æ¬¡è¿è¡Œã€‚ å¦‚æœä½ æƒ³é€šè¿‡è‡ªå·±çš„ç¤ºä¾‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°è¯•å¤šä¸ªçº¿ç¨‹æ’é˜Ÿç­‰å¾…é”çš„åœºæ™¯ã€‚åœ¨è¿™ç§è·Ÿè¸ªè¿‡ç¨‹ä¸­ï¼Œsemaphore çš„å€¼ä¼šæ˜¯å¤šå°‘ï¼Ÿ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°† semaphores ç”¨ä½œé”ã€‚ç”±äºé”åªæœ‰ä¸¤ç§çŠ¶æ€ï¼ˆæŒæœ‰å’ŒæœªæŒæœ‰ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬æœ‰æ—¶å°†ç”¨ä½œé”çš„ä¿¡å·é‡ç§°ä¸ºäºŒè¿›åˆ¶ä¿¡å·é‡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ åªæ˜¯ä»¥è¿™ç§äºŒè¿›åˆ¶æ–¹å¼ä½¿ç”¨ä¸€ä¸ªä¿¡å·é‡ï¼Œé‚£ä¹ˆå®ƒçš„å®ç°æ–¹å¼å¯èƒ½æ¯”æˆ‘ä»¬åœ¨è¿™é‡Œä»‹ç»çš„é€šç”¨ä¿¡å·é‡æ›´ç®€å•ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:2:0","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ç”¨äºæ’åºçš„ä¿¡å·é‡ ä¿¡å·é‡å¯¹äºå¯¹å¹¶å‘ç¨‹åºä¸­çš„äº‹ä»¶è¿›è¡Œæ’åºä¹Ÿå¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹å¯èƒ½å¸Œæœ›ç­‰å¾…åˆ—è¡¨å˜ä¸ºéç©ºï¼Œä»¥ä¾¿å¯ä»¥ä»ä¸­åˆ é™¤å…ƒç´ ã€‚åœ¨è¿™ç§ä½¿ç”¨æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸å‘ç°ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…æŸä»¶äº‹å‘ç”Ÿï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹ä½¿æŸä»¶äº‹å‘ç”Ÿï¼Œç„¶åå‘å‡ºä¿¡å·è¡¨æ˜å®ƒå·²ç»å‘ç”Ÿï¼Œä»è€Œå”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¿¡å·é‡ä½œä¸ºæ’åºåŸè¯­ï¼ˆç±»ä¼¼äºæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨æ¡ä»¶å˜é‡ï¼‰ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚è®¾æƒ³ä¸€ä¸ªçº¿ç¨‹åˆ›å»ºäº†å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åæƒ³ç­‰å¾…å®ƒå®Œæˆæ‰§è¡Œã€‚ sem_t s; void *child(void *arg) { printf(\"child\\n\"); sem_post(\u0026s); // Signal here: child is done return NULL; } int main(int argc, char *argv[]) { sem_init(\u0026s, 0, X); // What should X be? printf(\"parent: begin\\n\"); pthread_t c; Pthread_create(\u0026c, NULL, child, NULL); sem_wait(\u0026s); // Wait here for child printf(\"parent: end\\n\"); return 0; } å½“è¿™ä¸ªç¨‹åºè¿è¡Œæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š parent: begin child parent: end é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•ä½¿ç”¨ä¿¡å·é‡æ¥è¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼Ÿäº‹å®è¯æ˜ï¼Œç­”æ¡ˆç›¸å¯¹å®¹æ˜“ç†è§£ã€‚æ­£å¦‚æ‚¨åœ¨ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œçˆ¶çº¿ç¨‹åªéœ€è°ƒç”¨ sem_wait() ï¼Œåˆ™å­çº¿ç¨‹ è°ƒç”¨sem_post() ï¼Œç­‰å¾…å­çº¿ç¨‹å®Œæˆæ‰§è¡Œçš„æ¡ä»¶å˜ä¸º trueã€‚ç„¶è€Œï¼Œè¿™å°±æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šè¿™ä¸ªä¿¡å·é‡çš„åˆå§‹å€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ ç­”æ¡ˆå½“ç„¶æ˜¯ä¿¡å·é‡çš„å€¼åº”è¯¥è®¾ç½®ä¸º0ã€‚æœ‰ä¸¤ç§æƒ…å†µéœ€è¦è€ƒè™‘ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å‡è®¾çˆ¶çº¿ç¨‹åˆ›å»ºäº†å­çº¿ç¨‹ï¼Œä½†å­çº¿ç¨‹å°šæœªè¿è¡Œï¼ˆå³ï¼Œå®ƒä½äºå°±ç»ªé˜Ÿåˆ—ä¸­ä½†æœªè¿è¡Œï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œçˆ¶çº¿ç¨‹å°†å­çº¿ç¨‹è°ƒç”¨ sem_post() ä¹‹å‰è°ƒç”¨ sem_wait()ï¼›æˆ‘ä»¬å¸Œæœ›çˆ¶çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹è¿è¡Œèµ·æ¥ã€‚ å‘ç”Ÿè¿™ç§æƒ…å†µçš„å”¯ä¸€æ–¹æ³•æ˜¯ä¿¡å·é‡çš„å€¼ä¸å¤§äº 0ï¼›å› æ­¤ï¼Œ0 æ˜¯åˆå§‹å€¼ã€‚çˆ¶è¿›ç¨‹è¿è¡Œï¼Œå°†ä¿¡å·é‡é€’å‡ï¼ˆè‡³ -1ï¼‰ï¼Œç„¶åç­‰å¾…ï¼ˆç¡çœ ï¼‰ã€‚å½“å­è¿›ç¨‹æœ€ç»ˆè¿è¡Œæ—¶ï¼Œå®ƒå°†è°ƒç”¨ sem_post()ï¼Œå°†ä¿¡å·é‡çš„å€¼å¢åŠ åˆ° 0ï¼Œå¹¶å”¤é†’çˆ¶è¿›ç¨‹ï¼Œç„¶åçˆ¶è¿›ç¨‹å°†ä» sem_wait() è¿”å›å¹¶å®Œæˆç¨‹åºã€‚ ç¬¬äºŒç§æƒ…å†µå‘ç”Ÿåœ¨å­çº¿ç¨‹åœ¨çˆ¶çº¿ç¨‹æœ‰æœºä¼šè°ƒç”¨sem_wait() ä¹‹å‰è¿è¡Œå®Œæˆæ—¶ï¼Œè¿è¡Œè·Ÿè¸ªå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­çº¿ç¨‹å°†é¦–å…ˆè°ƒç”¨ sem_post()ï¼Œä»è€Œå°†ä¿¡å·é‡çš„å€¼ä» 0 å¢åŠ åˆ° 1ã€‚å½“çˆ¶çº¿ç¨‹æœ‰æœºä¼šè¿è¡Œæ—¶ï¼Œå®ƒå°†è°ƒç”¨ sem_wait() å¹¶å‘ç°ä¿¡å·é‡çš„å€¼ä¸º 1ï¼›å› æ­¤ï¼Œçˆ¶çº¿ç¨‹å°†é€’å‡è¯¥å€¼ï¼ˆåˆ° 0ï¼‰å¹¶ä» sem_wait() è¿”å›ï¼Œæ— éœ€ç­‰å¾…ï¼Œä¹Ÿè¾¾åˆ°äº†é¢„æœŸçš„æ•ˆæœã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:3:0","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 ç”Ÿäº§è€…/æ¶ˆè´¹è€…ï¼ˆæœ‰ç•Œç¼“å†²åŒºï¼‰é—®é¢˜ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:4:0","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.1 é¦–æ¬¡å°è¯• æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜çš„é¦–æ¬¡å°è¯•å¼•å…¥äº†ä¸¤ä¸ªä¿¡å·é‡ï¼šempty å’Œ fullï¼Œçº¿ç¨‹å°†åˆ†åˆ«ä½¿ç”¨å®ƒä»¬æ¥æŒ‡ç¤ºç¼“å†²åŒºæ¡ç›®ä½•æ—¶è¢«æ¸…ç©ºæˆ–å¡«æ»¡ã€‚ä¸‹é¢æ˜¯è§£å†³ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜çš„é¦–æ¬¡å°è¯•ä»£ç ã€‚ int buffer[MAX]; int fill = 0; int use = 0; void put(int value) { buffer[fill] = value; // Line F1: Place value in the buffer at the current fill index fill = (fill + 1) % MAX; // Line F2: Move the fill index to the next position in a circular buffer } int get() { int tmp = buffer[use]; // Line G1: Retrieve the value from the buffer at the current use index use = (use + 1) % MAX; // Line G2: Move the use index to the next position in a circular buffer return tmp; // Return the retrieved value } sem_t empty; sem_t full; void *producer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { sem_wait(\u0026empty); // Line P1: Wait for at least one empty buffer slot put(i); // Line P2: Produce an item and place it in the buffer sem_post(\u0026full); // Line P3: Signal that a buffer slot has been filled } } void *consumer(void *arg) { int i, tmp = 0; while (tmp != -1) { sem_wait(\u0026full); // Line C1: Wait for at least one filled buffer slot tmp = get(); // Line C2: Consume an item from the buffer sem_post(\u0026empty); // Line C3: Signal that a buffer slot has been emptied printf(\"%d\\n\", tmp); } } int main(int argc, char *argv[]) { // ... sem_init(\u0026empty, 0, MAX); // MAX buffers are empty to begin with... sem_init(\u0026full, 0, 0); // ... and 0 are full // ... } åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œç”Ÿäº§è€…é¦–å…ˆç­‰å¾…ç¼“å†²åŒºå˜ç©ºï¼Œç„¶åå°†æ•°æ®æ”¾å…¥ç¼“å†²åŒºï¼Œè€Œæ¶ˆè´¹è€…åŒæ ·ç­‰å¾…ç¼“å†²åŒºè¢«å¡«æ»¡ï¼Œç„¶åæ‰ä½¿ç”¨ç¼“å†²åŒºã€‚è®©æˆ‘ä»¬å…ˆå‡è®¾ MAX=1ï¼ˆæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªç¼“å†²åŒºï¼‰ï¼Œçœ‹çœ‹è¿™æ ·æ˜¯å¦å¯è¡Œã€‚ å†å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…ã€‚è®©æˆ‘ä»¬çœ‹çœ‹åœ¨å• CPU ä¸Šçš„å…·ä½“æƒ…å†µã€‚å‡è®¾æ¶ˆè´¹è€…å…ˆè¿è¡Œã€‚å› æ­¤ï¼Œæ¶ˆè´¹è€…å°†è¿è¡Œä»£ç ä¸­çš„ C1 è¡Œï¼Œè°ƒç”¨ sem_wait(\u0026full)ã€‚ç”±äº full çš„åˆå§‹åŒ–å€¼ä¸º 0ï¼Œå› æ­¤è°ƒç”¨å°†é€’å‡ fullï¼ˆè‡³ -1ï¼‰ï¼Œé˜»å¡æ¶ˆè´¹è€…ï¼Œå¹¶ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æŒ‰é¢„æœŸåœ¨ full ä¸Šè°ƒç”¨ sem_post()ã€‚ å‡è®¾ç”Ÿäº§è€…éšåè¿è¡Œã€‚å®ƒå°†è¿è¡Œåˆ° P1 è¡Œï¼Œä»è€Œè°ƒç”¨ sem_wait(\u0026empty) ä¾‹ç¨‹ã€‚ä¸æ¶ˆè´¹è€…ä¸åŒï¼Œç”Ÿäº§è€…å°†ç»§ç»­è¿è¡Œè¿™ä¸€è¡Œï¼Œå› ä¸º empty å·²è¢«åˆå§‹åŒ–ä¸º MAX å€¼ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º 1ï¼‰ã€‚å› æ­¤ï¼Œempty å°†è¢«é€’å‡ä¸º 0ï¼Œç”Ÿäº§è€…å°†æŠŠä¸€ä¸ªæ•°æ®å€¼æ”¾å…¥ç¼“å†²åŒºçš„ç¬¬ä¸€ä¸ªå…¥å£ï¼ˆP2 è¡Œï¼‰ã€‚ç„¶åï¼Œç”Ÿäº§è€…å°†ç»§ç»­è¿è¡Œåˆ° P3 è¡Œï¼Œå¹¶è°ƒç”¨ sem_post(\u0026full)ï¼Œå°† full ä¿¡å·é‡çš„å€¼ä» -1 æ”¹ä¸º 0ï¼Œå¹¶å”¤é†’æ¶ˆè´¹è€…ï¼ˆä¾‹å¦‚ï¼Œå°†å…¶ä»é˜»å¡çŠ¶æ€è½¬ä¸ºå°±ç»ªçŠ¶æ€ï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸¤ç§æƒ…å†µã€‚å¦‚æœç”Ÿäº§è€…ç»§ç»­è¿è¡Œï¼Œå®ƒå°†å¾ªç¯å¹¶å†æ¬¡è¿è¡Œ P1 è¡Œã€‚å¦‚æœç”Ÿäº§è€…è¢«ä¸­æ–­ï¼Œæ¶ˆè´¹è€…å¼€å§‹è¿è¡Œï¼Œå®ƒå°†è°ƒç”¨ sem_wait(\u0026full)ï¼ˆC1 è¡Œï¼‰ï¼Œå‘ç°ç¼“å†²åŒºç¡®å®å·²æ»¡ï¼Œä»è€Œæ¶ˆè€—æ‰ç¼“å†²åŒºã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œæˆ‘ä»¬éƒ½å®ç°äº†æ‰€éœ€çš„è¡Œä¸ºã€‚ ä½ å¯ä»¥ç”¨æ›´å¤šçº¿ç¨‹ï¼ˆä¾‹å¦‚å¤šä¸ªç”Ÿäº§è€…å’Œå¤šä¸ªæ¶ˆè´¹è€…ï¼‰æ¥å°è¯•è¿™ä¸ªä¾‹å­ã€‚å®ƒåº”è¯¥ä»ç„¶æœ‰æ•ˆã€‚ ç°åœ¨è®©æˆ‘ä»¬å‡è®¾ MAX å¤§äº 1ï¼ˆæ¯”å¦‚ MAX = 10ï¼‰ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‡è®¾æœ‰å¤šä¸ªç”Ÿäº§è€…å’Œå¤šä¸ªæ¶ˆè´¹è€…ã€‚ç°åœ¨æˆ‘ä»¬é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šç«äº‰æ¡ä»¶ã€‚ä»”ç»†çœ‹çœ‹ put() å’Œget() ä»£ç ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸¤ä¸ªç”Ÿäº§è€…ï¼ˆ$P_a$ å’Œ $P_b$ï¼‰åŒæ—¶è°ƒç”¨ put()ã€‚å‡è®¾ç”Ÿäº§è€… $P_a$ é¦–å…ˆè¿è¡Œï¼Œå¹¶å¼€å§‹å¡«å……ç¬¬ä¸€ä¸ªç¼“å†²åŒºæ¡ç›®ï¼ˆF1 è¡Œçš„ fill = 0ï¼‰ã€‚$P_a$ è¿˜æ²¡æ¥å¾—åŠå°†fillè®¡æ•°å™¨é€’å¢åˆ° 1ï¼Œå°±è¢«ä¸­æ–­äº†ã€‚ç”Ÿäº§è€… $P_b$ å¼€å§‹è¿è¡Œï¼Œå¹¶åœ¨ç¬¬ F1 è¡Œå°†å…¶æ•°æ®æ”¾å…¥ç¼“å†²åŒºçš„ç¬¬ 0 ä¸ªå…ƒç´ ï¼Œè¿™æ„å‘³ç€é‚£é‡Œçš„æ—§æ•°æ®è¢«è¦†ç›–ï¼è¿™æ˜¯ä¸å…è®¸çš„ï¼›æˆ‘ä»¬ä¸å¸Œæœ›ç”Ÿäº§è€…çš„ä»»ä½•æ•°æ®ä¸¢å¤±ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:4:1","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.2 ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šæ·»åŠ äº’æ–¥ æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå¿˜è®°äº†äº’æ–¥ã€‚ç¼“å†²åŒºçš„å¡«å……å’Œç¼“å†²åŒºç´¢å¼•çš„é€’å¢æ˜¯ä¸€ä¸ªä¸´ç•ŒåŒºï¼Œå› æ­¤å¿…é¡»å°å¿ƒä¿æŠ¤ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„äºŒè¿›åˆ¶ä¿¡å·é‡å¹¶æ·»åŠ ä¸€äº›é”ï¼Œä»£ç å¦‚ä¸‹ã€‚ sem_t empty; sem_t full; sem_t mutex; void *producer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { sem_wait(\u0026mutex); // Line P0 (NEW LINE) sem_wait(\u0026empty); // Line P1 put(i); // Line P2 sem_post(\u0026full); // Line P3 sem_post(\u0026mutex); // Line P4 (NEW LINE) } } void *consumer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { sem_wait(\u0026mutex); // Line C0 (NEW LINE) sem_wait(\u0026full); // Line C1 int tmp = get(); // Line C2 sem_post(\u0026empty); // Line C3 sem_post(\u0026mutex); // Line C4 (NEW LINE) printf(\"%d\\n\", tmp); } } int main(int argc, char *argv[]) { // ... sem_init(\u0026empty, 0, MAX); // MAX buffers are empty to begin with... sem_init(\u0026full, 0, 0); // ... and 0 are full sem_init(\u0026mutex, 0, 1); // mutex=1 because it is a lock (NEW LINE) // ... } ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:4:2","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.3 é¿å…æ­»é” ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ä»£ç çš„æ•´ä¸ª put()/get() éƒ¨åˆ†æ·»åŠ äº†ä¸€äº›é”ï¼Œå¦‚ NEW LINE æ³¨é‡Šæ‰€ç¤ºã€‚è¿™ä¼¼ä¹æ˜¯ä¸ªæ­£ç¡®çš„æƒ³æ³•ï¼Œä½†å´è¡Œä¸é€šã€‚ä¸ºä»€ä¹ˆï¼Ÿæ­»é”ã€‚ä¸ºä»€ä¹ˆä¼šå‡ºç°æ­»é”ï¼Ÿæƒ³è±¡ä¸€ä¸‹ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…ã€‚æ¶ˆè´¹è€…å…ˆè¿è¡Œã€‚å®ƒè·å–äº†mutexï¼ˆC0 è¡Œï¼‰ï¼Œç„¶ååœ¨fullä¿¡å·é‡ä¸Šè°ƒç”¨ sem_wait()ï¼ˆC1 è¡Œï¼‰ï¼›ç”±äºè¿˜æ²¡æœ‰æ•°æ®ï¼Œè¿™ä¸ªè°ƒç”¨ä¼šå¯¼è‡´æ¶ˆè´¹è€…é˜»å¡ï¼Œä»è€Œå ç”¨ CPUï¼›ä½†é‡è¦çš„æ˜¯ï¼Œæ¶ˆè´¹è€…ä»ç„¶æŒæœ‰é”ã€‚ ç„¶åç”Ÿäº§è€…è¿è¡Œã€‚å¦‚æœå®ƒèƒ½è¿è¡Œï¼Œå°±èƒ½å”¤é†’æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒåšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è°ƒç”¨äºŒè¿›åˆ¶ mutexä¿¡å·é‡ï¼ˆP0 è¡Œï¼‰ä¸Šçš„ sem_wait()ã€‚è¯¥é”å·²è¢«é”å®šã€‚å› æ­¤ï¼Œç”Ÿäº§è€…ç°åœ¨ä¹Ÿåªèƒ½ç­‰å¾…ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„å¾ªç¯ã€‚æ¶ˆè´¹è€…æŒæœ‰mutexï¼Œæ­£åœ¨ç­‰å¾…æŸäººå‘å‡ºfullçš„ä¿¡å·ã€‚ç”Ÿäº§è€…å¯ä»¥å‘å‡ºfullçš„ä¿¡å·ï¼Œä½†ä¹Ÿåœ¨ç­‰å¾…mutexã€‚å› æ­¤ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½åœ¨äº’ç›¸ç­‰å¾…ï¼šè¿™å°±æ˜¯å…¸å‹çš„æ­»é”ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:4:3","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.4 å¯è¡Œçš„è§£å†³æ–¹æ¡ˆ è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€ç¼©å°é”çš„èŒƒå›´ã€‚ä¸‹é¢ä»£ç æ˜¾ç¤ºäº†æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚ sem_t empty; sem_t full; sem_t mutex; void *producer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { sem_wait(\u0026empty); // Line P1 sem_wait(\u0026mutex); // Line P1.5 (MOVED MUTEX HERE...) put(i); // Line P2 sem_post(\u0026mutex); // Line P2.5 (... AND HERE) sem_post(\u0026full); // Line P3 } } void *consumer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { sem_wait(\u0026full); // Line C1 sem_wait(\u0026mutex); // Line C1.5 (MOVED MUTEX HERE...) int tmp = get(); // Line C2 sem_post(\u0026mutex); // Line C2.5 (... AND HERE) sem_post(\u0026empty); // Line C3 printf(\"%d\\n\", tmp); } } int main(int argc, char *argv[]) { // ... sem_init(\u0026empty, 0, MAX); // MAX buffers are empty to begin with... sem_init(\u0026full, 0, 0); // ... and 0 are full sem_init(\u0026mutex, 0, 1); // mutex=1 because it is a lock // ... } æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åªéœ€å°†mutexè·å–å’Œé‡Šæ”¾ç§»åˆ°ä¸´ç•ŒåŒºé™„è¿‘ï¼›è€Œfullç­‰å¾…emptyç©ºç­‰å¾…ä»¥åŠä¿¡å·ä»£ç åˆ™ç•™åœ¨å¤–éƒ¨ã€‚è¿™å°±æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„æœ‰ç•Œç¼“å†²åŒºï¼Œæ˜¯å¤šçº¿ç¨‹ç¨‹åºä¸­å¸¸ç”¨çš„æ¨¡å¼ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:4:4","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 è¯»è€…â€”å†™è€…é” å¦ä¸€ä¸ªç»å…¸é—®é¢˜æºäºäººä»¬å¯¹æ›´çµæ´»çš„é”å®šåŸè¯­çš„æ¸´æœ›ï¼Œå³ä¸åŒçš„æ•°æ®ç»“æ„è®¿é—®å¯èƒ½éœ€è¦ä¸åŒç±»å‹çš„é”å®šã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æœ‰è®¸å¤šå¹¶å‘çš„åˆ—è¡¨æ“ä½œï¼ŒåŒ…æ‹¬æ’å…¥å’Œç®€å•çš„æŸ¥æ‰¾ã€‚æ’å…¥æ“ä½œä¼šæ”¹å˜ list çš„çŠ¶æ€ï¼ˆå› æ­¤ä¼ ç»Ÿçš„ä¸´ç•ŒåŒºæ˜¯åˆç†çš„ï¼‰ï¼Œè€ŒæŸ¥æ‰¾æ“ä½œåªæ˜¯è¯»å–æ•°æ®ç»“æ„ï¼›åªè¦æˆ‘ä»¬èƒ½ä¿è¯æ²¡æœ‰æ’å…¥æ“ä½œæ­£åœ¨è¿›è¡Œï¼Œæˆ‘ä»¬å°±èƒ½å…è®¸è®¸å¤šæŸ¥æ‰¾æ“ä½œå¹¶å‘è¿›è¡Œã€‚æˆ‘ä»¬ç°åœ¨è¦å¼€å‘çš„æ”¯æŒè¿™ç§æ“ä½œçš„ç‰¹æ®Šç±»å‹é”è¢«ç§°ä¸ºè¯»å†™é”ã€‚è¿™ç§é”çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š typedef struct _rwlock_t { sem_t lock; // binary semaphore (basic lock) sem_t writelock; // used to allow ONE writer or MANY readers int readers; // count of readers reading in critical section } rwlock_t; void rwlock_init(rwlock_t *rw) { rw-\u003ereaders = 0; sem_init(\u0026rw-\u003elock, 0, 1); // Initialize lock semaphore with value 1 sem_init(\u0026rw-\u003ewritelock, 0, 1); // Initialize writelock semaphore with value 1 } void rwlock_acquire_readlock(rwlock_t *rw) { sem_wait(\u0026rw-\u003elock); // Lock the critical section rw-\u003ereaders++; // Increment the number of readers if (rw-\u003ereaders == 1) sem_wait(\u0026rw-\u003ewritelock); // First reader acquires writelock, preventing writers sem_post(\u0026rw-\u003elock); // Unlock the critical section } void rwlock_release_readlock(rwlock_t *rw) { sem_wait(\u0026rw-\u003elock); // Lock the critical section rw-\u003ereaders--; // Decrement the number of readers if (rw-\u003ereaders == 0) sem_post(\u0026rw-\u003ewritelock); // Last reader releases writelock, allowing writers sem_post(\u0026rw-\u003elock); // Unlock the critical section } void rwlock_acquire_writelock(rwlock_t *rw) { sem_wait(\u0026rw-\u003ewritelock); // Acquire writelock, preventing other readers and writers } void rwlock_release_writelock(rwlock_t *rw) { sem_post(\u0026rw-\u003ewritelock); // Release writelock, allowing other readers and writers } ä»£ç éå¸¸ç®€å•ã€‚å¦‚æœæŸä¸ªçº¿ç¨‹æƒ³è¦æ›´æ–°ç›¸å…³æ•°æ®ç»“æ„ï¼Œå®ƒåº”è¯¥è°ƒç”¨ä¸€å¯¹æ–°çš„åŒæ­¥æ“ä½œï¼šrwlock_acquire_writelock()ï¼ˆè·å–å†™é”ï¼‰å’Œ rwlock_release_ writelock()ï¼ˆé‡Šæ”¾å†™é”ï¼‰ã€‚åœ¨å†…éƒ¨ï¼Œè¿™äº›æ“ä½œåªæ˜¯ä½¿ç”¨writelockä¿¡å·é‡æ¥ç¡®ä¿åªæœ‰å•ä¸ªå†™è€…å¯ä»¥è·å–é”ï¼Œä»è€Œè¿›å…¥ä¸´ç•ŒåŒºæ›´æ–°ç›¸å…³æ•°æ®ç»“æ„ã€‚ æ›´æœ‰è¶£çš„æ˜¯ä¸€å¯¹è·å–å’Œé‡Šæ”¾è¯»é”çš„ä¾‹ç¨‹ã€‚åœ¨è·å–è¯»å–é”æ—¶ï¼Œè¯»è€…é¦–å…ˆè·å–é”ï¼Œç„¶åé€’å¢ readers å˜é‡ï¼Œä»¥è·Ÿè¸ªå½“å‰æ•°æ®ç»“æ„ä¸­æœ‰å¤šå°‘ä¸ªè¯»è€…ã€‚å½“ç¬¬ä¸€ä¸ªè¯»è€…è·å¾—é”æ—¶ï¼Œrwlock_acquire_readlock() ä¸­çš„é‡è¦æ­¥éª¤å°±å¼€å§‹äº†ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯»è€…ä¹Ÿä¼šé€šè¿‡è°ƒç”¨writelockä¿¡å·é‡ä¸Šçš„ sem_wait() æ¥è·å¾—å†™é”ï¼Œç„¶åé€šè¿‡è°ƒç”¨ sem_post() æ¥é‡Šæ”¾é”ã€‚ å› æ­¤ï¼Œä¸€æ—¦ä¸€ä¸ªè¯»è€…è·å¾—äº†è¯»é”ï¼Œå°±ä¼šå…è®¸æ›´å¤šè¯»è€…ä¹Ÿè·å¾—è¯»é”ï¼›ä½†æ˜¯ï¼Œä»»ä½•å¸Œæœ›è·å¾—å†™é”çš„çº¿ç¨‹éƒ½å¿…é¡»ç­‰åˆ°æ‰€æœ‰è¯»è€…éƒ½è¯»å®Œï¼›æœ€åä¸€ä¸ªé€€å‡ºä¸´ç•ŒåŒºçš„çº¿ç¨‹ä¼šè°ƒç”¨ writelock ä¿¡å·é‡ä¸Šçš„sem_post()ï¼Œä»è€Œè®©ç­‰å¾…çš„å†™è€…è·å¾—å†™é”ã€‚ è¿™ç§æ–¹æ³•æœ‰æ•ˆï¼ˆå¦‚é¢„æœŸï¼‰ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›è´Ÿé¢å½±å“ï¼Œç‰¹åˆ«æ˜¯åœ¨å…¬å¹³æ€§æ–¹é¢ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¯»è€…é¥¿æ­»å†™è€…æ˜¯ç›¸å¯¹å®¹æ˜“çš„ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜å­˜åœ¨æ›´å¤æ‚çš„è§£å†³æ–¹æ¡ˆï¼›ä¹Ÿè®¸ä½ èƒ½æƒ³åˆ°æ›´å¥½çš„å®ç°ï¼Ÿæç¤ºï¼šè€ƒè™‘ä¸€ä¸‹ä¸€æ—¦å†™è€…æ­£åœ¨ç­‰å¾…ï¼Œæ‚¨éœ€è¦åšä»€ä¹ˆæ¥é˜²æ­¢æ›´å¤šçš„è¯»å–è€…è¿›å…¥é”ã€‚ è¯»è€…é¥¿æ­»å†™è€…çš„é—®é¢˜å¯ä»¥é€šè¿‡ä¿®æ”¹è¯»è€…å’Œå†™è€…çš„ä¼˜å…ˆçº§ç­–ç•¥æ¥è§£å†³ã€‚å…·ä½“æ€è·¯å¦‚ä¸‹ï¼š å¢åŠ å†™è€…ä¼˜å…ˆç­–ç•¥ï¼šè®©å†™è€…ä¼˜å…ˆäºè¯»è€…è·å–é”ï¼Œè¿™æ ·å½“æœ‰å†™è€…ç­‰å¾…æ—¶ï¼Œæ–°åˆ°æ¥çš„è¯»è€…éœ€è¦ç­‰å¾…å†™è€…å®Œæˆåæ‰èƒ½è¿›å…¥ä¸´ç•ŒåŒºã€‚ å†™è€…ä¼˜å…ˆé”è®¾è®¡ï¼šå¼•å…¥ä¸€ä¸ªé¢å¤–çš„å˜é‡æˆ–ä¿¡å·é‡æ¥è¡¨ç¤ºå†™è€…æ˜¯å¦åœ¨ç­‰å¾…ï¼Œå¦‚æœæœ‰å†™è€…ç­‰å¾…ï¼Œè¯»è€…éœ€è¦ç­‰å¾…å†™è€…å®Œæˆåæ‰èƒ½è·å–é”ã€‚ æœ€åï¼Œåº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œåº”è¯¥è°¨æ…ä½¿ç”¨è¯»å†™é”ã€‚å®ƒä»¬é€šå¸¸ä¼šå¢åŠ æ›´å¤šçš„å¼€é”€ï¼ˆç‰¹åˆ«æ˜¯å¯¹äºæ›´å¤æ‚çš„å®ç°ï¼‰ï¼Œå› æ­¤ä¸ä»…ä½¿ç”¨ç®€å•ä¸”å¿«é€Ÿçš„é”å®šåŸè¯­ç›¸æ¯”ï¼Œæœ€ç»ˆä¸ä¼šæé«˜æ€§èƒ½ã€‚ä¸ç®¡æ€æ ·ï¼Œå®ƒä»¬å†æ¬¡å±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•ä»¥æœ‰è¶£ä¸”æœ‰ç”¨çš„æ–¹å¼ä½¿ç”¨ä¿¡å·é‡ã€‚ TIPï¼šç®€å•è€Œæ„šè ¢çš„æ–¹æ³•å¯èƒ½æ›´å¥½ï¼ˆå¸Œå°”å®šå¾‹ï¼‰ ä½ æ°¸è¿œä¸åº”è¯¥ä½ä¼°è¿™æ ·ä¸€ç§è§‚å¿µï¼šç®€å•è€Œæ„šè ¢çš„æ–¹æ³•å¯èƒ½æ˜¯æœ€å¥½çš„æ–¹æ³•ã€‚å¯¹äºé”å®šï¼Œæœ‰æ—¶ç®€å•çš„è‡ªæ—‹é”æ•ˆæœæœ€å¥½ï¼Œå› ä¸ºå®ƒæ˜“äºå®ç°ä¸”é€Ÿåº¦å¿«ã€‚è™½ç„¶è¯»/å†™é”ä¹‹ç±»çš„ä¸œè¥¿å¬èµ·æ¥å¾ˆé…·ï¼Œä½†å®ƒä»¬å¾ˆå¤æ‚ï¼Œè€Œå¤æ‚å¯èƒ½æ„å‘³ç€ç¼“æ…¢ã€‚å› æ­¤ï¼Œæ€»æ˜¯å…ˆå°è¯•ç®€å•è€Œæ„šè ¢çš„æ–¹æ³•ã€‚è¿™ç§è¿½æ±‚ç®€å•çš„æƒ³æ³•åœ¨å¾ˆå¤šåœ°æ–¹éƒ½å¯ä»¥æ‰¾åˆ°ã€‚æ—©æœŸçš„ä¸€ä¸ªæ¥æºæ˜¯ Mark Hill çš„è®ºæ–‡ï¼Œè¯¥è®ºæ–‡ç ”ç©¶äº†å¦‚ä½•ä¸º CPU è®¾è®¡ç¼“å­˜ã€‚ Hill å‘ç°ç®€å•çš„ç›´æ¥æ˜ å°„ç¼“å­˜æ¯”èŠ±å“¨çš„é›†åˆå…³è”è®¾è®¡æ•ˆæœæ›´å¥½ï¼ˆåŸå› ä¹‹ä¸€æ˜¯åœ¨ç¼“å­˜ä¸­ï¼Œæ›´ç®€å•çš„è®¾è®¡å¯ä»¥å®ç°æ›´å¿«çš„æŸ¥æ‰¾ï¼‰ã€‚æ­£å¦‚å¸Œå°”ç®€æ´åœ°æ€»ç»“ä»–çš„å·¥ä½œï¼šâ€œå¤§è€Œç¬¨æ›´å¥½ã€‚â€å› æ­¤ï¼Œæˆ‘ä»¬å°†ç±»ä¼¼çš„å»ºè®®ç§°ä¸ºå¸Œå°”å®šå¾‹ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:5:0","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 å“²å­¦å®¶å°±é¤é—®é¢˜ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:6:0","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.1 åŸºæœ¬ä»‹ç» Dijkstra æå‡ºå¹¶è§£å†³çš„ä¸€ä¸ªæœ€è‘—åçš„å¹¶å‘é—®é¢˜è¢«ç§°ä¸º â€œå“²å­¦å®¶å°±é¤é—®é¢˜â€ã€‚è¿™ä¸ªé—®é¢˜ä¹‹æ‰€ä»¥æœ‰åï¼Œæ˜¯å› ä¸ºå®ƒå¾ˆæœ‰è¶£ï¼Œåœ¨æ™ºåŠ›ä¸Šä¹Ÿæœ‰ç‚¹æ„æ€ï¼›ç„¶è€Œï¼Œå®ƒçš„å®é™…æ•ˆç”¨å´å¾ˆä½ã€‚ é—®é¢˜çš„åŸºæœ¬è®¾ç½®æ˜¯è¿™æ ·çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‡è®¾æœ‰äº”ä½ â€œå“²å­¦å®¶ â€œå›´ååœ¨ä¸€å¼ æ¡Œå­æ—ã€‚æ¯å¯¹ â€œå“²å­¦å®¶ â€œä¹‹é—´æœ‰ä¸€æŠŠå‰å­ï¼ˆå› æ­¤ä¸€å…±æœ‰äº”æŠŠå‰å­ï¼‰ã€‚å“²å­¦å®¶ä»¬æœ‰æ€è€ƒçš„æ—¶å€™ï¼Œä¸éœ€è¦å‰å­ï¼Œä¹Ÿæœ‰åƒé¥­çš„æ—¶å€™ã€‚ä¸ºäº†åƒé¥­ï¼Œå“²å­¦å®¶éœ€è¦ä¸¤æŠŠå‰å­ï¼Œå·¦è¾¹çš„å’Œå³è¾¹çš„ã€‚å¯¹è¿™äº›å‰å­çš„äº‰å¤ºä»¥åŠéšä¹‹è€Œæ¥çš„åŒæ­¥é—®é¢˜ï¼Œæ­£æ˜¯æˆ‘ä»¬åœ¨å¹¶å‘ç¼–ç¨‹ä¸­è¦ç ”ç©¶çš„é—®é¢˜ã€‚ è¿™æ˜¯æ¯ä¸ªå“²å­¦å®¶çš„åŸºæœ¬å¾ªç¯ï¼š while (1) { think(); getforks(); eat(); putforks(); } é‚£ä¹ˆï¼Œå…³é”®çš„æŒ‘æˆ˜æ˜¯ç¼–å†™ä¾‹ç¨‹ getforks() å’Œ putforks()ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°æ­»é”ï¼Œä¸ä¼šæœ‰å“²å­¦å®¶æŒ¨é¥¿è€Œæ°¸è¿œåƒä¸åˆ°ä¸œè¥¿ï¼Œå¹¶ä¸”å¹¶å‘æ€§å¾ˆé«˜ï¼ˆå³ï¼Œè®¸å¤šå“²å­¦å®¶å¯ä»¥åŒæ—¶åƒé¥­ï¼‰å°½å¯èƒ½ï¼‰ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨ä¸€äº›è¾…åŠ©å‡½æ•°æ¥æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹ï¼š int left(int p) { return p; } int right(int p) { return (p + 1) % 5; } å½“å“²å­¦å®¶ $p$ å¸Œæœ›å¼•ç”¨ä»–ä»¬å·¦è¾¹çš„å‰å­æ—¶ï¼Œä»–ä»¬åªéœ€è°ƒç”¨ left(p)ã€‚ç±»ä¼¼åœ°ï¼Œé€šè¿‡è°ƒç”¨ right(p) æ¥å¼•ç”¨å“²å­¦å®¶ $p$ å³è¾¹çš„å‰å­ï¼›å…¶ä¸­çš„æ¨¡è¿ç®—ç¬¦å¤„ç†æœ€åä¸€ä¸ªå“²å­¦å®¶ ($p=4$) è¯•å›¾æŠ“ä½ä»–ä»¬å³è¾¹çš„å‰å­ï¼ˆå‰å­ 0ï¼‰çš„æƒ…å†µã€‚ æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›ä¿¡å·é‡æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å‡è®¾æˆ‘ä»¬æœ‰äº”ä¸ªï¼Œæ¯ä¸ªå‰å­ä¸€ä¸ªï¼šsem_t forks[5]ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:6:1","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.2 æ®‹ç¼ºçš„è§£å†³æ–¹æ¡ˆ æˆ‘ä»¬å°è¯•ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚å‡è®¾æˆ‘ä»¬å°†æ¯ä¸ªä¿¡å·é‡ï¼ˆåœ¨ forks æ•°ç»„ä¸­ï¼‰åˆå§‹åŒ–ä¸ºå€¼ 1ã€‚è¿˜å‡è®¾æ¯ä¸ªå“²å­¦å®¶éƒ½çŸ¥é“è‡ªå·±çš„æ•°å­— (p)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ getforks() å’Œ putforks() ä¾‹ç¨‹ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ void getforks() { sem_wait(forks[left(p)]); sem_wait(forks[right(p)]); } void putforks() { sem_post(forks[left(p)]); sem_post(forks[right(p)]); } è¿™ä¸ªï¼ˆæ®‹ç¼ºçš„ï¼‰è§£å†³æ–¹æ¡ˆèƒŒåçš„ç›´è§‰å¦‚ä¸‹ã€‚ä¸ºäº†è·å¾—å‰å­ï¼Œæˆ‘ä»¬åªéœ€æŠ“ä½æ¯ä¸ªå‰å­ä¸Šçš„â€œé”â€ï¼šé¦–å…ˆæ˜¯å·¦è¾¹çš„ï¼Œç„¶åæ˜¯å³è¾¹çš„ã€‚å½“æˆ‘ä»¬åƒå®Œåï¼Œæˆ‘ä»¬å°±é‡Šæ”¾å®ƒä»¬ã€‚å¾ˆç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç®€å•å°±æ„å‘³ç€ç ´ç¢ã€‚ å¦‚æœæ¯ä¸ªå“²å­¦å®¶ç¢°å·§åœ¨ä»»ä½•å“²å­¦å®¶æŠ“ä½å³è¾¹çš„å‰å­ä¹‹å‰æŠ“ä½äº†ä»–ä»¬å·¦è¾¹çš„å‰å­ï¼Œé‚£ä¹ˆæ¯ä¸ªå“²å­¦å®¶éƒ½ä¼šæ°¸è¿œæ‹¿ç€ä¸€æŠŠå‰å­å¹¶ç­‰å¾…å¦ä¸€æŠŠå‰å­ã€‚å…·ä½“æ¥è¯´ï¼Œå“²å­¦å®¶0æŠ“å‰å­0ï¼Œå“²å­¦å®¶1æŠ“å‰å­1ï¼Œå“²å­¦å®¶2æŠ“å‰å­2ï¼Œå“²å­¦å®¶3æŠ“å‰å­3ï¼Œå“²å­¦å®¶4æŠ“å‰å­4ï¼›æ‰€æœ‰çš„å‰å­éƒ½å·²è·å¾—ï¼Œæ‰€æœ‰çš„å“²å­¦å®¶éƒ½åœ¨ç­‰å¾…å¦ä¸€ä½å“²å­¦å®¶æ‹¥æœ‰çš„å‰å­ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šæ›´è¯¦ç»†åœ°ç ”ç©¶æ­»é”ï¼›ç›®å‰ï¼Œå¯ä»¥è‚¯å®šåœ°è¯´è¿™ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:6:2","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6.3 è§£å†³æ–¹æ¡ˆï¼šæ‰“ç ´ä¾èµ– è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æ”¹å˜è‡³å°‘ä¸€ä½å“²å­¦å®¶è·å–åˆ†å‰çš„æ–¹å¼ï¼›äº‹å®ä¸Šï¼ŒDijkstra æœ¬äººå°±æ˜¯è¿™æ ·è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚å…·ä½“æ¥è¯´ï¼Œå‡è®¾å“²å­¦å®¶ 4ï¼ˆç¼–å·æœ€é«˜è€…ï¼‰ä»¥ä¸åŒçš„é¡ºåºè·å–åˆ†å‰ã€‚ä»£ç å¦‚ä¸‹ï¼š void getforks() { if (p == 4) { sem_wait(forks[right(p)]); sem_wait(forks[left(p)]); } else { sem_wait(forks[left(p)]); sem_wait(forks[right(p)]); } } ç”±äºæœ€åä¸€ä½å“²å­¦å®¶ä¼šå…ˆæŠ“å³è¾¹ï¼Œç„¶åå†æŠ“å·¦è¾¹ï¼Œå› æ­¤ä¸ä¼šå‡ºç°æ¯ä½å“²å­¦å®¶éƒ½æŠ“åˆ°ä¸€ä¸ªå‰å­ï¼Œå´åªèƒ½ç­‰å¾…å¦ä¸€ä¸ªå‰å­çš„æƒ…å†µï¼›ç­‰å¾…çš„å¾ªç¯è¢«æ‰“ç ´äº†ã€‚ åƒè¿™æ ·çš„ â€œè‘—å â€œé—®é¢˜è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚æŠ½çƒŸè€…é—®é¢˜æˆ–ç¡è§‰çš„ç†å‘å¸ˆé—®é¢˜ã€‚å®ƒä»¬ä¸­çš„å¤§å¤šæ•°åªæ˜¯æ€è€ƒå¹¶å‘é—®é¢˜çš„å€Ÿå£ï¼›å…¶ä¸­æœ‰äº›é—®é¢˜çš„åå­—å¾ˆå¸å¼•äººã€‚å¦‚æœä½ æœ‰å…´è¶£äº†è§£æ›´å¤šï¼Œæˆ–è€…åªæ˜¯æƒ³å¤šç»ƒä¹ å¹¶å‘æ€ç»´ï¼Œå¯ä»¥å»æŸ¥æŸ¥è¿™äº›é—®é¢˜ã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:6:3","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 å¦‚ä½•å®ç°ä¿¡å·é‡ æœ€åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä½çº§åŒæ­¥åŸè¯­ã€é”å’Œæ¡ä»¶å˜é‡æ¥æ„å»ºæˆ‘ä»¬è‡ªå·±çš„ä¿¡å·é‡ç‰ˆæœ¬ï¼Œç§°ä¸ºZemaphoresã€‚è¿™ä¸ªä»»åŠ¡ç›¸å½“ç®€å•ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ typedef struct __Zem_t { int value; // Value of the semaphore pthread_cond_t cond; // Condition variable for signaling pthread_mutex_t lock; // Mutex for protecting shared data } Zem_t; // Initializes the semaphore with the specified initial value void Zem_init(Zem_t *s, int value) { s-\u003evalue = value; // Set initial value Cond_init(\u0026s-\u003econd); // Initialize condition variable Mutex_init(\u0026s-\u003elock); // Initialize mutex } // Decrements the value of the semaphore (waits if the value is zero) void Zem_wait(Zem_t *s) { Mutex_lock(\u0026s-\u003elock); // Lock the mutex while (s-\u003evalue \u003c= 0) { // Wait while value is less than or equal to 0 Cond_wait(\u0026s-\u003econd, \u0026s-\u003elock); // Wait on the condition variable } s-\u003evalue--; // Decrement the value Mutex_unlock(\u0026s-\u003elock); // Unlock the mutex } // Increments the value of the semaphore and signals waiting threads void Zem_post(Zem_t *s) { Mutex_lock(\u0026s-\u003elock); // Lock the mutex s-\u003evalue++; // Increment the value Cond_signal(\u0026s-\u003econd); // Signal waiting threads Mutex_unlock(\u0026s-\u003elock); // Unlock the mutex } ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬åªä½¿ç”¨äº†ä¸€æŠŠé”å’Œä¸€ä¸ªæ¡ä»¶å˜é‡ï¼Œå†åŠ ä¸Šä¸€ä¸ªçŠ¶æ€å˜é‡æ¥è·Ÿè¸ªä¿¡å·é‡çš„å€¼ã€‚ Zem_tç»“æ„ä½“å®šä¹‰äº†ä¸€ä¸ªä¿¡å·é‡ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ªæ•´æ•°å€¼ value ç”¨äºè¡¨ç¤ºä¿¡å·é‡çš„çŠ¶æ€ï¼Œä¸€ä¸ªæ¡ä»¶å˜é‡ cond ç”¨äºçº¿ç¨‹é—´çš„åŒæ­¥é€šä¿¡ï¼Œä»¥åŠä¸€ä¸ªäº’æ–¥é” lock ç”¨äºä¿æŠ¤å…±äº«æ•°æ®ã€‚ Zem_init å‡½æ•°ç”¨äºåˆå§‹åŒ–ä¿¡å·é‡ï¼Œå°†åˆå§‹å€¼èµ‹ç»™ valueï¼Œå¹¶åˆ†åˆ«åˆå§‹åŒ–æ¡ä»¶å˜é‡å’Œäº’æ–¥é”ã€‚ Zem_wait å‡½æ•°ç”¨äºç­‰å¾…ä¿¡å·é‡ï¼Œé¦–å…ˆè·å–äº’æ–¥é”ï¼Œç„¶ååœ¨ä¸€ä¸ªå¾ªç¯ä¸­æ£€æŸ¥ value æ˜¯å¦å°äºç­‰äº 0ï¼Œå¦‚æœæ˜¯åˆ™ç­‰å¾…æ¡ä»¶å˜é‡ï¼Œç›´åˆ°è¢«å”¤é†’åå†æ¬¡æ£€æŸ¥ã€‚ä¸€æ—¦ value å¤§äº 0ï¼Œå°±å°†å…¶å‡ä¸€å¹¶é‡Šæ”¾äº’æ–¥é”ã€‚ Zem_post å‡½æ•°ç”¨äºé‡Šæ”¾ä¿¡å·é‡ï¼Œé¦–å…ˆè·å–äº’æ–¥é”ï¼Œç„¶åå°† value åŠ ä¸€ï¼Œä»¥åŠå”¤é†’ç­‰å¾…åœ¨æ¡ä»¶å˜é‡ä¸Šçš„çº¿ç¨‹ï¼Œæœ€åé‡Šæ”¾äº’æ–¥é”ã€‚ æˆ‘ä»¬çš„ Zemaphore å’Œ Dijkstra å®šä¹‰çš„çº¯ä¿¡å·é‡ä¹‹é—´çš„ä¸€ä¸ªç»†å¾®å·®åˆ«æ˜¯ï¼Œæˆ‘ä»¬ä¸ä¿æŒä¿¡å·é‡çš„å€¼ï¼ˆå½“ä¸ºè´Ÿæ—¶ï¼‰åæ˜ ç­‰å¾…çº¿ç¨‹çš„æ•°é‡è¿™ä¸€ä¸å˜å¼ï¼›äº‹å®ä¸Šï¼Œè¯¥å€¼æ°¸è¿œä¸ä¼šä½äºé›¶ã€‚æ­¤è¡Œä¸ºæ›´å®¹æ˜“å®ç°å¹¶ä¸”ä¸å½“å‰çš„ Linux å®ç°ç›¸åŒ¹é…ã€‚ TIPï¼šå°å¿ƒæ³›åŒ– å› æ­¤ï¼Œæ³›åŒ–çš„æŠ½è±¡æŠ€æœ¯åœ¨ç³»ç»Ÿè®¾è®¡ä¸­éå¸¸æœ‰ç”¨ï¼Œå…¶ä¸­ä¸€ä¸ªå¥½çš„æƒ³æ³•å¯ä»¥å˜å¾—ç¨å¾®æ›´å¹¿æ³›ï¼Œä»è€Œè§£å†³æ›´å¤§ç±»åˆ«çš„é—®é¢˜ã€‚ç„¶è€Œï¼Œæ³›åŒ–æ—¶è¦å°å¿ƒï¼›æ­£å¦‚Lampsonè­¦å‘Šæˆ‘ä»¬çš„é‚£æ ·ï¼Œâ€œä¸è¦æ³›åŒ–ï¼›æ³›åŒ–é€šå¸¸æ˜¯é”™è¯¯çš„â€ã€‚ äººä»¬å¯ä»¥å°†ä¿¡å·é‡è§†ä¸ºé”å’Œæ¡ä»¶å˜é‡çš„æ³›åŒ–ï¼›ç„¶è€Œï¼Œæ˜¯å¦éœ€è¦è¿™æ ·çš„æ³›åŒ–ï¼Ÿè€Œä¸”ï¼Œè€ƒè™‘åˆ°åœ¨ä¿¡å·é‡ä¹‹ä¸Šå®ç°æ¡ä»¶å˜é‡çš„å›°éš¾ï¼Œä¹Ÿè®¸è¿™ç§æ³›åŒ–å¹¶ä¸åƒæ‚¨æƒ³è±¡çš„é‚£ä¹ˆæ™®éã€‚ ","date":"2024-05-11","objectID":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/:7:0","tags":["OS"],"title":"ä¿¡å·é‡","uri":"/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å¼€å‘äº†é”çš„æ¦‚å¿µï¼Œå¹¶äº†è§£äº†å¦‚ä½•é€šè¿‡æ­£ç¡®çš„ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿæ”¯æŒç»„åˆæ¥æ­£ç¡®æ„å»ºé”ã€‚ä¸å¹¸çš„æ˜¯ï¼Œé”å¹¶ä¸æ˜¯æ„å»ºå¹¶å‘ç¨‹åºæ‰€éœ€çš„å”¯ä¸€åŸè¯­ã€‚ ç‰¹åˆ«æ˜¯ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œçº¿ç¨‹å¸Œæœ›åœ¨ç»§ç»­æ‰§è¡Œä¹‹å‰æ£€æŸ¥æ¡ä»¶æ˜¯å¦ä¸ºçœŸã€‚ä¾‹å¦‚ï¼Œçˆ¶çº¿ç¨‹å¯èƒ½å¸Œæœ›åœ¨ç»§ç»­ä¹‹å‰æ£€æŸ¥å­çº¿ç¨‹æ˜¯å¦å·²å®Œæˆï¼ˆè¿™é€šå¸¸ç§°ä¸º join()ï¼‰ï¼›è¿™æ ·çš„ç­‰å¾…åº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ã€‚ #include \u003cstdio.h\u003e #include \"common_threads.h\" void *child(void *arg) { printf(\"child\\n\"); // XXX how to indicate we are done? return NULL; } int main(int argc, char *argv[]) { printf(\"parent: begin\\n\"); pthread_t c; Pthread_create(\u0026c, NULL, child, NULL); // create child // XXX how to wait for child? printf(\"parent: end\\n\"); return 0; } æˆ‘ä»¬å¸Œæœ›åœ¨è¿™é‡Œçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š parent: begin child parent: end æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨å…±äº«å˜é‡ï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºã€‚æ­¤è§£å†³æ–¹æ¡ˆé€šå¸¸å¯ä»¥å·¥ä½œï¼Œä½†æ•ˆç‡éå¸¸ä½ï¼Œå› ä¸ºçˆ¶è¿›ç¨‹ä¼šè‡ªæ—‹å¹¶æµªè´¹ CPU æ—¶é—´ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œæƒ³è¦çš„æ˜¯æŸç§æ–¹æ³•è®©çˆ¶è¿›ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œç›´åˆ°æˆ‘ä»¬ç­‰å¾…çš„æ¡ä»¶ï¼ˆä¾‹å¦‚ï¼Œå­è¿›ç¨‹å®Œæˆæ‰§è¡Œï¼‰å®ç°ä¸ºæ­¢ã€‚ #include \u003cstdio.h\u003e #include \"common_threads.h\" volatile int done = 0; void *child(void *arg) { printf(\"child\\n\"); done = 1; return NULL; } int main(int argc, char *argv[]) { printf(\"parent: begin\\n\"); pthread_t c; Pthread_create(\u0026c, NULL, child, NULL); // create child while (done == 0) // spin ; printf(\"parent: end\\n\"); return 0; } å…³é”®ï¼šå¦‚ä½•ç­‰å¾…æ¡ä»¶ï¼Ÿ åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œçº¿ç¨‹åœ¨ç»§ç»­æ“ä½œä¹‹å‰ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸé€šå¸¸å¾ˆæœ‰ç”¨ã€‚è¿™ç§ç®€å•çš„æ–¹æ³•ï¼Œå³åªæ˜¯è‡ªæ—‹ç›´åˆ°æ¡ä»¶æˆç«‹ï¼Œæ•ˆç‡éå¸¸ä½å¹¶ä¸”æµªè´¹ CPU å‘¨æœŸï¼Œå¹¶ä¸”åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ã€‚é‚£ä¹ˆï¼Œçº¿ç¨‹åº”è¯¥å¦‚ä½•ç­‰å¾…æ¡ä»¶å‘¢ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:0:0","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å®šä¹‰å’Œä¾‹ç¨‹ ä¸ºäº†ç­‰å¾…æ¡ä»¶æˆçœŸï¼Œçº¿ç¨‹å¯ä»¥ä½¿ç”¨æ‰€è°“çš„æ¡ä»¶å˜é‡ã€‚æ¡ä»¶å˜é‡æ˜¯ä¸€ä¸ªæ˜¾å¼é˜Ÿåˆ—ï¼Œå½“æŸäº›æ‰§è¡ŒçŠ¶æ€ï¼ˆå³æŸäº›æ¡ä»¶ï¼‰ä¸ç¬¦åˆé¢„æœŸæ—¶ï¼ˆé€šè¿‡ç­‰å¾…æ¡ä»¶ï¼‰ï¼Œçº¿ç¨‹å¯ä»¥å°†è‡ªå·±ç½®äºè¯¥é˜Ÿåˆ—ä¸­ï¼›å½“å…¶ä»–çº¿ç¨‹æ”¹å˜ä¸Šè¿°çŠ¶æ€æ—¶ï¼Œå¯ä»¥å”¤é†’ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œä»è€Œå…è®¸å®ƒä»¬ç»§ç»­æ‰§è¡Œï¼ˆé€šè¿‡å‘æ¡ä»¶å‘å‡ºä¿¡å·ï¼‰ã€‚è¿™ä¸ªæƒ³æ³•å¯ä»¥è¿½æº¯åˆ° Dijkstra ä½¿ç”¨çš„ â€œç§æœ‰ä¿¡å·â€ï¼›åæ¥ï¼ŒHoare åœ¨ä»–å…³äºç›‘æ§å™¨çš„å·¥ä½œä¸­å°†ç±»ä¼¼çš„æƒ³æ³•å‘½åä¸º â€œæ¡ä»¶å˜é‡â€ã€‚ è¦å£°æ˜è¿™æ ·ä¸€ä¸ªæ¡ä»¶å˜é‡ï¼Œåªéœ€è¿™æ ·å†™ï¼špthread_cond_t c;ï¼Œå°† c å£°æ˜ä¸ºæ¡ä»¶å˜é‡ï¼ˆæ³¨æ„ï¼šè¿˜éœ€è¦é€‚å½“çš„åˆå§‹åŒ–ï¼‰ã€‚æ¡ä»¶å˜é‡æœ‰ä¸¤ä¸ªç›¸å…³æ“ä½œï¼šwait() å’Œ signal()ã€‚wait()è°ƒç”¨åœ¨çº¿ç¨‹å¸Œæœ›è¿›å…¥ä¼‘çœ çŠ¶æ€æ—¶æ‰§è¡Œï¼›signal()è°ƒç”¨åœ¨çº¿ç¨‹æ”¹å˜äº†ç¨‹åºä¸­çš„æŸäº›å†…å®¹ï¼Œä»è€Œå¸Œæœ›å”¤é†’åœ¨æ­¤æ¡ä»¶ä¸‹ç­‰å¾…çš„ä¼‘çœ çº¿ç¨‹æ—¶æ‰§è¡Œã€‚å…·ä½“æ¥è¯´ï¼ŒPOSIX è°ƒç”¨æ˜¯è¿™æ ·çš„ï¼š pthread_cond_wait(pthread_cond_t *c, pthread_mutex_t *m); pthread_cond_signal(pthread_cond_t *c); ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬é€šå¸¸å°†å…¶ç§°ä¸º wait() å’Œ signal()ã€‚å…³äº wait()è°ƒç”¨ï¼Œæœ‰ä¸€ç‚¹ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œå®ƒä¹Ÿå°†ä¸€ä¸ªmutexä½œä¸ºå‚æ•°ï¼›å®ƒå‡å®šåœ¨è°ƒç”¨ wait() æ—¶è¿™ä¸ªmutexå·²è¢«é”å®šã€‚wait()çš„èŒè´£æ˜¯é‡Šæ”¾é”å¹¶è®©è°ƒç”¨çº¿ç¨‹ä¼‘çœ ï¼ˆåŸå­å¼ï¼‰ï¼›å½“çº¿ç¨‹é†’æ¥æ—¶ï¼ˆåœ¨å…¶ä»–çº¿ç¨‹å‘å‡ºä¿¡å·åï¼‰ï¼Œå®ƒå¿…é¡»åœ¨è¿”å›è°ƒç”¨è€…ä¹‹å‰é‡æ–°è·å–é”ã€‚ä¹‹æ‰€ä»¥å¦‚æ­¤å¤æ‚ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¸Œæœ›åœ¨çº¿ç¨‹è¯•å›¾è®©è‡ªå·±è¿›å…¥ä¼‘çœ çŠ¶æ€æ—¶ï¼Œé˜²æ­¢å‡ºç°æŸäº›ç«äº‰æ¡ä»¶ã€‚ è®©æˆ‘ä»¬æ¥çœ‹çœ‹joiné—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ #include \u003cstdio.h\u003e #include \u003cpthread.h\u003e #include \"common_threads.h\" int done = 0; pthread_mutex_t m = PTHREAD_MUTEX_INITIALIZER; pthread_cond_t c = PTHREAD_COND_INITIALIZER; void thr_exit() { Pthread_mutex_lock(\u0026m); done = 1; Pthread_cond_signal(\u0026c); // wake up waiting thread Pthread_mutex_unlock(\u0026m); } void *child(void *arg) { printf(\"child\\n\"); thr_exit(); return NULL; } void thr_join() { Pthread_mutex_lock(\u0026m); while (done == 0) Pthread_cond_wait(\u0026c, \u0026m); // unlock m and wait for signal Pthread_mutex_unlock(\u0026m); } int main(int argc, char *argv[]) { printf(\"parent: begin\\n\"); pthread_t p; Pthread_create(\u0026p, NULL, child, NULL); thr_join(); printf(\"parent: end\\n\"); return 0; } æœ‰ä¸¤ç§æƒ…å†µéœ€è¦è€ƒè™‘ã€‚ç¬¬ä¸€ç§æƒ…å†µæ˜¯çˆ¶çº¿ç¨‹åˆ›å»ºäº†å­çº¿ç¨‹ï¼Œä½†è‡ªå·±ç»§ç»­è¿è¡Œï¼ˆå‡è®¾æˆ‘ä»¬åªæœ‰ä¸€ä¸ªå¤„ç†å™¨ï¼‰ï¼Œå› æ­¤ç«‹å³è°ƒç”¨ thr_join() ç­‰å¾…å­çº¿ç¨‹å®Œæˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçˆ¶çº¿ç¨‹ä¼šè·å–é”ï¼Œæ£€æŸ¥å­çº¿ç¨‹æ˜¯å¦å®Œæˆï¼ˆæœªå®Œæˆï¼‰ï¼Œç„¶åè°ƒç”¨ wait() ä½¿è‡ªå·±è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼ˆä»è€Œé‡Šæ”¾é”ï¼‰ã€‚å­çº¿ç¨‹æœ€ç»ˆå°†è¿è¡Œï¼Œæ‰“å°ä¿¡æ¯ â€œchildâ€ï¼Œå¹¶è°ƒç”¨ thr_exit() æ¥å”¤é†’çˆ¶çº¿ç¨‹ï¼›è¯¥ä»£ç åªæ˜¯è·å–é”ã€è®¾ç½®çŠ¶æ€å˜é‡ doneï¼Œå¹¶å‘çˆ¶çº¿ç¨‹å‘å‡ºä¿¡å·ï¼Œä»è€Œå”¤é†’çˆ¶çº¿ç¨‹ã€‚æœ€åï¼Œçˆ¶çº¿ç¨‹å°†è¿è¡Œï¼ˆä» wait()è¿”å›æ—¶é”å·²è¢«é”å®šï¼‰ã€è§£é”å¹¶æ‰“å°æœ€ç»ˆä¿¡æ¯ â€œparent:endï¼šç»“æŸâ€ã€‚ åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œå­è¿›ç¨‹åœ¨åˆ›å»ºåç«‹å³è¿è¡Œï¼Œå°† done è®¾ä¸º 1ï¼Œè°ƒç”¨ä¿¡å·å”¤é†’ç¡çœ çº¿ç¨‹ï¼ˆä½†æ²¡æœ‰ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›ï¼‰ï¼Œç„¶åå®Œæˆã€‚ç„¶åçˆ¶çº¿ç¨‹è¿è¡Œï¼Œè°ƒç”¨ thr_join()ï¼Œå‘ç° done ä¸º 1ï¼Œäºæ˜¯ä¸å†ç­‰å¾…ï¼Œç›´æ¥è¿”å›ã€‚ æœ€åä¸€ç‚¹ï¼šä½ å¯èƒ½ä¼šå‘ç°çˆ¶è¿›ç¨‹åœ¨å†³å®šæ˜¯å¦ç­‰å¾…æ¡ä»¶æ—¶ä½¿ç”¨äº† while å¾ªç¯è€Œä¸æ˜¯ if è¯­å¥ã€‚è™½ç„¶ä»ç¨‹åºé€»è¾‘ä¸Šçœ‹ï¼Œè¿™å¹¶éç»å¯¹å¿…è¦ï¼Œä½†è¿™å§‹ç»ˆæ˜¯ä¸ªå¥½ä¸»æ„ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹æ–‡ä¸­çœ‹åˆ°ã€‚ ä¸ºäº†ç¡®ä¿ä½ ç†è§£ thr_exit() å’Œ thr_join() ä»£ç ä¸­æ¯ä¸€æ®µä»£ç çš„é‡è¦æ€§ï¼Œè®©æˆ‘ä»¬å°è¯•å‡ ç§ä¸åŒçš„å®ç°æ–¹æ³•ã€‚é¦–å…ˆï¼Œä½ å¯èƒ½æƒ³çŸ¥é“æˆ‘ä»¬æ˜¯å¦éœ€è¦å®ŒæˆçŠ¶æ€å˜é‡ã€‚å¦‚æœä»£ç çœ‹èµ·æ¥åƒä¸‹é¢çš„ç¤ºä¾‹å‘¢ï¼Ÿè¿™æ ·è¡Œå¾—é€šå—ï¼Ÿ void thr_exit() { Pthread_mutex_lock(\u0026m); Pthread_cond_signal(\u0026c); Pthread_mutex_unlock(\u0026m); } void thr_join() { Pthread_mutex_lock(\u0026m); Pthread_cond_wait(\u0026c, \u0026m); Pthread_mutex_unlock(\u0026m); } ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•æ˜¯æœ‰é—®é¢˜çš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœå­è¿›ç¨‹ç«‹å³è¿è¡Œå¹¶ç«‹å³è°ƒç”¨thr_exit()ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­è¿›ç¨‹ä¼šå‘å‡ºä¿¡å·ï¼Œä½†æ¡ä»¶ä¸Šæ²¡æœ‰ä»»ä½•çº¿ç¨‹å¤„äºä¼‘çœ çŠ¶æ€ã€‚å½“çˆ¶è¿›ç¨‹è¿è¡Œæ—¶ï¼Œå®ƒå°†ç®€å•åœ°è°ƒç”¨waitå¹¶è¢«å¡ä½ï¼›æ²¡æœ‰ä»»ä½•çº¿ç¨‹ä¼šå”¤é†’å®ƒã€‚ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ åº”è¯¥æ„è¯†åˆ°çŠ¶æ€å˜é‡doneçš„é‡è¦æ€§ï¼›å®ƒè®°å½•äº†çº¿ç¨‹æ„Ÿå…´è¶£çš„å€¼ã€‚ç¡çœ ã€å”¤é†’å’Œé”å®šéƒ½å›´ç»•ç€å®ƒæ„å»ºã€‚ ä»¥ä¸‹æ˜¯å¦ä¸€ä¸ªç³Ÿç³•çš„å®ç°æ–¹å¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ä¸éœ€è¦æŒæœ‰é”æ¥å‘å‡ºä¿¡å·å’Œç­‰å¾…ã€‚å¯èƒ½ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿæ€è€ƒä¸€ä¸‹ï¼ void thr_exit() { done = 1; Pthread_cond_signal(\u0026c); } void thr_join() { if (done == 0) { Pthread_cond_wait(\u0026c); } } è¿™é‡Œçš„é—®é¢˜æ˜¯ä¸€ä¸ªå¾®å¦™çš„ç«äº‰æ¡ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœçˆ¶çº¿ç¨‹è°ƒç”¨thr_join()ï¼Œç„¶åæ£€æŸ¥doneçš„å€¼ï¼Œå®ƒä¼šå‘ç°å®ƒæ˜¯0ï¼Œä»è€Œå°è¯•è¿›å…¥ç¡çœ çŠ¶æ€ã€‚ä½†å°±åœ¨å®ƒè°ƒç”¨ wait è¿›å…¥ç¡çœ çŠ¶æ€ä¹‹å‰ï¼Œçˆ¶çº¿ç¨‹è¢«ä¸­æ–­ï¼Œå­çº¿ç¨‹å¼€å§‹è¿è¡Œã€‚å­çº¿ç¨‹å°†çŠ¶æ€å˜é‡ done æ›´æ”¹ä¸º 1 å¹¶å‘å‡ºä¿¡å·ï¼Œä½†æ²¡æœ‰çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œå› æ­¤æ²¡æœ‰çº¿ç¨‹è¢«å”¤é†’ã€‚å½“çˆ¶çº¿ç¨‹å†æ¬¡è¿è¡Œæ—¶ï¼Œå®ƒå°±æ°¸è¿œæ²‰ç¡äº†ï¼Œè¿™æ˜¯å¯æ‚²çš„ã€‚ TIPï¼šåœ¨å‘å‡ºä¿¡å·æ—¶å§‹ç»ˆä¿æŒé”å®š è™½ç„¶å¹¶éåœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¸¥æ ¼è¦æ±‚ä¿æŒé”å®šï¼Œä½†åœ¨ä½¿ç”¨æ¡ä»¶å˜é‡æ—¶ï¼Œåœ¨å‘å‡ºä¿¡å·æ—¶ä¿æŒé”å®šå¯èƒ½æ˜¯æœ€ç®€å•ä¸”æœ€å¥½çš„æ–¹æ³•ã€‚ä¸Šé¢çš„ç¤ºä¾‹æ˜¾ç¤ºäº†å¿…é¡»æŒæœ‰é”æ‰èƒ½æ­£ç¡®çš„æƒ…å†µï¼›ç„¶è€Œï¼Œåœ¨å…¶ä»–ä¸€äº›æƒ…å†µä¸‹ï¼Œä¸è¿™æ ·åšä¹Ÿå¯ä»¥ï¼Œä½†å¯èƒ½æ˜¯æ‚¨åº”è¯¥é¿å…çš„äº‹æƒ…ã€‚å› æ­¤ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œåœ¨è°ƒç”¨ä¿¡å·æ—¶ä¿æŒé”å®šã€‚ æœ¬æŠ€å·§çš„åé¢ï¼Œå³åœ¨è°ƒç”¨ wait æ—¶ä¿æŒé”å®šï¼Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªæŠ€å·§ï¼Œè€Œæ˜¯ wait è¯­ä¹‰æ‰€å¼ºåˆ¶çš„ï¼Œå› ä¸º wait æ€»æ˜¯ å‡è®¾åœ¨è°ƒç”¨å®ƒæ—¶é”å®šå·²è¢«æŒæœ‰ï¼Œ é‡Šæ”¾å½“è®©è°ƒç”¨è€…è¿›å…¥ç¡çœ çŠ¶æ€æ—¶æ‰€è¯´çš„é” åœ¨è¿”å›ä¹‹å‰é‡æ–°è·å–é”ã€‚ å› æ­¤ï¼Œè¿™ä¸ªæŠ€å·§çš„æ¦‚æ‹¬æ˜¯æ­£ç¡®çš„ï¼šåœ¨è°ƒç”¨ signal æˆ– wait æ—¶ä¿æŒé”å®šï¼Œä½ å°†æ°¸è¿œå¤„äºè‰¯å¥½çŠ¶æ€ã€‚ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:1:0","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ç”Ÿäº§è€…â€”æ¶ˆè´¹è€…ï¼ˆæœ‰ç•Œç¼“å†²åŒºï¼‰é—®é¢˜ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:2:0","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åŸºæœ¬æ¦‚å¿µ åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é¢å¯¹çš„ä¸‹ä¸€ä¸ªåŒæ­¥é—®é¢˜è¢«ç§°ä¸ºç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜ï¼Œæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºæœ‰ç•Œç¼“å†²åŒºé—®é¢˜ï¼Œå®ƒæ˜¯ç”± Dijkstra é¦–æ¬¡æå‡ºçš„ã€‚äº‹å®ä¸Šï¼Œæ­£æ˜¯è¿™ä¸ªç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜ä¿ƒä½¿ Dijkstra å’Œä»–çš„åŒäº‹ä»¬å‘æ˜äº†å¹¿ä¹‰çš„ semaphoreï¼ˆå¯ç”¨ä½œé”æˆ–æ¡ä»¶å˜é‡ï¼‰ã€‚ è®¾æƒ³ä¸€ä¸ªæˆ–å¤šä¸ªç”Ÿäº§è€…çº¿ç¨‹å’Œä¸€ä¸ªæˆ–å¤šä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ã€‚ç”Ÿäº§è€…ç”Ÿæˆæ•°æ®é¡¹å¹¶å°†å…¶æ”¾å…¥ç¼“å†²åŒºï¼›æ¶ˆè´¹è€…ä»ç¼“å†²åŒºä¸­æŠ“å–ä¸Šè¿°æ•°æ®é¡¹ï¼Œå¹¶ä»¥æŸç§æ–¹å¼æ¶ˆè´¹å®ƒä»¬ã€‚ è¿™ç§å®‰æ’åœ¨è®¸å¤šå®é™…ç³»ç»Ÿä¸­éƒ½ä¼šå‡ºç°ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤šçº¿ç¨‹ç½‘ç»œæœåŠ¡å™¨ä¸­ï¼Œç”Ÿäº§è€…å°† HTTP è¯·æ±‚æ”¾å…¥å·¥ä½œé˜Ÿåˆ—ï¼ˆå³æœ‰ç•Œç¼“å†²åŒºï¼‰ï¼›æ¶ˆè´¹è€…çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–å‡ºè¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ã€‚ æœ‰ç•Œç¼“å†²åŒºä¹Ÿç”¨äºå°†ä¸€ä¸ªç¨‹åºçš„è¾“å‡ºå¯¼å…¥å¦ä¸€ä¸ªç¨‹åºï¼Œä¾‹å¦‚ï¼Œgrep foo file.txt | wc -lã€‚æ­¤ç¤ºä¾‹åŒæ—¶è¿è¡Œä¸¤ä¸ªè¿›ç¨‹ï¼šgrep å°† file.txt ä¸­å«æœ‰ foo å­—ç¬¦ä¸²çš„è¡Œå†™å…¥å®ƒè®¤ä¸ºçš„æ ‡å‡†è¾“å‡ºï¼›UNIX shell å°†è¾“å‡ºé‡å®šå‘åˆ°æ‰€è°“çš„ UNIX ç®¡é“ï¼ˆé€šè¿‡pipeç³»ç»Ÿè°ƒç”¨åˆ›å»ºï¼‰ã€‚ç®¡é“çš„å¦ä¸€ç«¯è¿æ¥åˆ° wc è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ï¼Œè¯¥è¿›ç¨‹åªéœ€è®¡ç®—è¾“å…¥æµçš„è¡Œæ•°å¹¶æ‰“å°å‡ºç»“æœã€‚å› æ­¤ï¼Œgrep è¿›ç¨‹æ˜¯ç”Ÿäº§è€…ï¼Œwc è¿›ç¨‹æ˜¯æ¶ˆè´¹è€…ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯ä¸€ä¸ªå†…æ ¸æœ‰ç•Œç¼“å†²åŒºã€‚ ç”±äºæœ‰ç•Œç¼“å†²åŒºæ˜¯å…±äº«èµ„æºï¼Œæˆ‘ä»¬å½“ç„¶å¿…é¡»è¦æ±‚åŒæ­¥è®¿é—®å®ƒï¼Œä»¥å…å‡ºç°ç«äº‰æ¡ä»¶ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›å®é™…çš„ä»£ç ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ªå…±äº«ç¼“å†²åŒºï¼Œç”Ÿäº§è€…å°†æ•°æ®æ”¾å…¥ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬åªä½¿ç”¨ä¸€ä¸ªæ•´æ•°ï¼ˆå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æƒ³è±¡æŠŠä¸€ä¸ªæ•°æ®ç»“æ„çš„æŒ‡é’ˆæ”¾åˆ°è¿™ä¸ªæ§½ä¸­ï¼‰ï¼Œä»¥åŠä¸¤ä¸ªå†…éƒ¨ä¾‹ç¨‹ï¼Œåˆ†åˆ«ç”¨äºå‘å…±äº«ç¼“å†²åŒºä¸­æ”¾å…¥ä¸€ä¸ªå€¼ï¼Œä»¥åŠä»ç¼“å†²åŒºä¸­å–å‡ºä¸€ä¸ªå€¼ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š int buffer; int count = 0; // initially, empty void put(int value) { assert(count == 0); count = 1; buffer = value; } int get() { assert(count == 1); count = 0; return buffer; } put() ä¾‹ç¨‹å‡å®šç¼“å†²åŒºä¸ºç©ºï¼ˆå¹¶é€šè¿‡assertè¿›è¡Œæ£€æŸ¥ï¼‰ï¼Œç„¶åç®€å•åœ°å°†ä¸€ä¸ªå€¼æ”¾å…¥å…±äº«ç¼“å†²åŒºï¼Œå¹¶é€šè¿‡å°†counterè®¾ä¸º 1 æ¥æ ‡è®°ç¼“å†²åŒºå·²æ»¡ã€‚ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªå…±äº«ç¼“å†²åŒºåªæœ‰ä¸€ä¸ªå…¥å£ï¼›ç¨åï¼Œæˆ‘ä»¬å°†æŠŠå®ƒæ¨å¹¿åˆ°å¯ä»¥å®¹çº³å¤šä¸ªå…¥å£çš„é˜Ÿåˆ—ï¼Œè¿™å°†æ¯”å¬èµ·æ¥æ›´æœ‰è¶£ã€‚ ç°åœ¨æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€äº›ä¾‹ç¨‹æ¥çŸ¥é“ä½•æ—¶å¯ä»¥è®¿é—®ç¼“å†²åŒºä»¥å°†æ•°æ®æ”¾å…¥å…¶ä¸­æˆ–ä»å…¶ä¸­å–å‡ºæ•°æ®ã€‚å…¶æ¡ä»¶åº”è¯¥æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šä»…å½“ count ä¸ºé›¶æ—¶ï¼ˆå³ç¼“å†²åŒºä¸ºç©ºæ—¶ï¼‰æ‰å°†æ•°æ®æ”¾å…¥ç¼“å†²åŒºï¼Œå¹¶ä¸”ä»…å½“ count ä¸º 1 æ—¶ï¼ˆå³ç¼“å†²åŒºå·²æ»¡æ—¶ï¼‰ä»ç¼“å†²åŒºä¸­è·å–æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬ç¼–å†™åŒæ­¥ä»£ç ï¼Œä½¿å¾—ç”Ÿäº§è€…å°†æ•°æ®æ”¾å…¥å·²æ»¡çš„ç¼“å†²åŒºä¸­ï¼Œæˆ–è€…æ¶ˆè´¹è€…ä»ç©ºç¼“å†²åŒºä¸­è·å–æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åšé”™äº†ï¼ˆåœ¨è¿™æ®µä»£ç ä¸­ï¼Œå°†è§¦å‘assertï¼‰ã€‚ è¿™é¡¹å·¥ä½œå°†ç”±ä¸¤ç§ç±»å‹çš„çº¿ç¨‹å®Œæˆï¼Œå…¶ä¸­ä¸€ç»„æˆ‘ä»¬ç§°ä¸ºç”Ÿäº§è€…çº¿ç¨‹ï¼Œå¦ä¸€ç»„æˆ‘ä»¬ç§°ä¸ºæ¶ˆè´¹è€…çº¿ç¨‹ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œ æ˜¾ç¤ºäº†ç”Ÿäº§è€…å°†æ•´æ•°æ”¾å…¥å…±äº«ç¼“å†²åŒºå¾ªç¯æ¬¡æ•°çš„ä»£ç ï¼Œä»¥åŠæ¶ˆè´¹è€…ä»å…±äº«ç¼“å†²åŒºä¸­è·å–æ•°æ®ï¼ˆæ°¸è¿œï¼‰çš„ä»£ç ï¼Œæ¯æ¬¡æ‰“å°ä»å…±äº«ç¼“å†²åŒºä¸­æ‹‰å‡ºçš„æ•°æ®é¡¹ã€‚ void *producer(void *arg) { int i; int loops = (int)arg; for (i = 0; i \u003c loops; i++) { put(i); } } void *consumer(void *arg) { int i; while (1) { int tmp = get(); printf(\"%d\\n\", tmp); } } ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:2:1","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 ä¸€ä¸ªæ®‹ç¼ºçš„è§£å†³æ–¹æ¡ˆ ç°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªç”Ÿäº§è€…å’Œä¸€ä¸ªæ¶ˆè´¹è€…ã€‚æ˜¾ç„¶ï¼Œput() å’Œ get() ä¾‹ç¨‹éƒ½æœ‰ä¸´ç•ŒåŒºï¼Œå› ä¸º put() ä¼šæ›´æ–°ç¼“å†²åŒºï¼Œè€Œ get() ä¼šä»ç¼“å†²åŒºè¯»å–æ•°æ®ã€‚ç„¶è€Œï¼Œåœ¨ä»£ç å‘¨å›´åŠ é”æ˜¯è¡Œä¸é€šçš„ï¼›æˆ‘ä»¬éœ€è¦æ›´å¤šçš„ä¸œè¥¿ã€‚æ¯«ä¸å¥‡æ€ªï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€äº›æ¡ä»¶å˜é‡ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼šåœ¨è¿™ä¸ªï¼ˆæ®‹ç¼ºçš„ï¼‰é¦–æ¬¡å°è¯•ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªæ¡ä»¶å˜é‡ cond å’Œç›¸å…³çš„é”mutexã€‚ int loops; // must initialize somewhere... cond_t cond; mutex_t mutex; void *producer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); // p1 if (count == 1) // p2 Pthread_cond_wait(\u0026cond, \u0026mutex); // p3 put(i); // p4 Pthread_cond_signal(\u0026cond); // p5 Pthread_mutex_unlock(\u0026mutex); // p6 } } void *consumer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); // c1 if (count == 0) // c2 Pthread_cond_wait(\u0026cond, \u0026mutex); // c3 int tmp = get(); // c4 Pthread_cond_signal(\u0026cond); // c5 Pthread_mutex_unlock(\u0026mutex); // c6 printf(\"%d\\n\", tmp); } } è®©æˆ‘ä»¬æ¥çœ‹çœ‹ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„ä¿¡å·é€»è¾‘ã€‚å½“ç”Ÿäº§è€…æƒ³è¦å¡«æ»¡ç¼“å†²åŒºæ—¶ï¼Œå®ƒä¼šç­‰å¾…ç¼“å†²åŒºä¸ºç©ºï¼ˆp1-p3ï¼‰ã€‚æ¶ˆè´¹è€…çš„é€»è¾‘å®Œå…¨ç›¸åŒï¼Œä½†ç­‰å¾…çš„æ¡ä»¶ä¸åŒï¼šç¼“å†²åŒºæ»¡ï¼ˆc1-c3ï¼‰ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªç”Ÿäº§è€…å’Œä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œä¸Šé¢ä»£ç å°±èƒ½æ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ªçº¿ç¨‹ï¼ˆä¾‹å¦‚ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼‰ï¼Œè§£å†³æ–¹æ¡ˆå°±ä¼šå‡ºç°ä¸¤ä¸ªå…³é”®é—®é¢˜ã€‚å®ƒä»¬æ˜¯ä»€ä¹ˆï¼Ÿ è®©æˆ‘ä»¬æ¥äº†è§£ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒä¸ç­‰å¾…ä¹‹å‰çš„ if è¯­å¥æœ‰å…³ã€‚å‡è®¾æœ‰ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼ˆ$T_{c_1}$ å’Œ $T_{c_2}$ï¼‰å’Œä¸€ä¸ªç”Ÿäº§è€…ï¼ˆ$T_p$ï¼‰ã€‚é¦–å…ˆï¼Œè¿è¡Œæ¶ˆè´¹è€… ($T_{c_1}$)ï¼›å®ƒè·å–é” (c1)ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ç¼“å†²åŒºå¯ä¾›ä½¿ç”¨ (c2)ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ç­‰å¾… (c3)ï¼ˆé‡Šæ”¾é”ï¼‰ã€‚ ç„¶åè¿è¡Œç”Ÿäº§è€… ($T_p$)ã€‚å®ƒè·å–é” (p1)ï¼Œæ£€æŸ¥æ‰€æœ‰ç¼“å†²åŒºæ˜¯å¦å·²æ»¡ (p2)ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ç»§ç»­å¡«å……ç¼“å†²åŒº (p4)ã€‚ç„¶åï¼Œç”Ÿäº§è€…å‘å‡ºç¼“å†²åŒºå·²å¡«æ»¡çš„ä¿¡å·ï¼ˆp5ï¼‰ã€‚é‡è¦çš„æ˜¯ï¼Œè¿™å°†ç¬¬ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆ$T_{c_1}$ ï¼‰ä»æ¡ä»¶å˜é‡çš„ä¼‘çœ çŠ¶æ€ç§»åˆ°å°±ç»ªé˜Ÿåˆ—ï¼›$T_{c_1}$ ç°åœ¨å¯ä»¥è¿è¡Œï¼ˆä½†å°šæœªè¿è¡Œï¼‰ã€‚ç„¶åï¼Œç”Ÿäº§è€…ç»§ç»­è¿è¡Œï¼Œç›´åˆ°å‘ç°ç¼“å†²åŒºå·²æ»¡ï¼Œè¿™æ—¶å®ƒæ‰è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼ˆp6, p1-p3ï¼‰ã€‚ é—®é¢˜å°±å‡ºç°åœ¨è¿™é‡Œï¼šå¦ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆ$T_{c_2}$ ï¼‰æ‚„æ‚„è¿›å…¥å¹¶æ¶ˆè€—äº†ç¼“å†²åŒºä¸­çš„ä¸€ä¸ªç°æœ‰å€¼ï¼ˆc1ã€c2ã€c4ã€c5ã€c6ï¼Œç”±äºç¼“å†²åŒºå·²æ»¡ï¼Œè·³è¿‡äº† c3 å¤„çš„waitï¼‰ã€‚ç°åœ¨å‡è®¾ $T_{c_1}$è¿è¡Œï¼Œåœ¨ä»ç­‰å¾…è¿”å›ä¹‹å‰ï¼Œå®ƒä¼šé‡æ–°è·å–é”ï¼Œç„¶åè¿”å›ã€‚ç„¶åå®ƒè°ƒç”¨ get() (c4)ï¼Œä½†æ²¡æœ‰ç¼“å†²åŒºè¦ä½¿ç”¨ï¼æ–­è¨€è§¦å‘äº†ï¼Œä»£ç æ²¡æœ‰æŒ‰é¢„æœŸè¿è¡Œã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬åº”è¯¥ä»¥æŸç§æ–¹å¼é˜»æ­¢ $T_{c_1}$ å°è¯•æ¶ˆè€—ï¼Œå› ä¸º$T_{c_2}$ å·å·åœ°è¿›å…¥å¹¶æ¶ˆè€—äº†ç¼“å†²åŒºä¸­äº§ç”Ÿçš„ä¸€ä¸ªå€¼ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ“ä½œåŠå…¶éšæ—¶é—´å˜åŒ–çš„è°ƒåº¦å™¨çŠ¶æ€ï¼ˆå°±ç»ªã€è¿è¡Œæˆ–ä¼‘çœ ï¼‰ã€‚ å‡ºç°é—®é¢˜çš„åŸå› å¾ˆç®€å•ï¼šåœ¨ç”Ÿäº§è€…å”¤é†’ $T_{c_1}$ ä¹‹åï¼Œä½†åœ¨ $T_{c_1}$ è¿è¡Œä¹‹å‰ï¼Œæœ‰ç•Œç¼“å†²åŒºçš„çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ï¼ˆè¿™è¦å½’åŠŸäº $T_{c_2}$ï¼‰ã€‚å‘çº¿ç¨‹å‘å‡ºä¿¡å·åªèƒ½å”¤é†’å®ƒä»¬ï¼Œå› æ­¤å®ƒåªæ˜¯æç¤ºä¸–ç•Œçš„çŠ¶æ€å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼ˆåœ¨æœ¬ä¾‹ä¸­ï¼Œç¼“å†²åŒºä¸­å·²ç»æ”¾å…¥äº†ä¸€ä¸ªå€¼ï¼‰ï¼Œä½†å¹¶ä¸èƒ½ä¿è¯å½“è¢«å”¤é†’çš„çº¿ç¨‹è¿è¡Œæ—¶ï¼ŒçŠ¶æ€ä»ç„¶å¦‚æ„¿ä»¥å¿ã€‚å¯¹ä¿¡å·å«ä¹‰çš„è¿™ç§è§£é‡Šé€šå¸¸è¢«ç§°ä¸º Mesa è¯­ä¹‰ï¼Œè¿™æ˜¯ä»¥é¦–æ¬¡ä»¥è¿™ç§æ–¹å¼æ„å»ºæ¡ä»¶å˜é‡çš„ç ”ç©¶å‘½åçš„ï¼›ä¸ä¹‹ç›¸å¯¹çš„æ˜¯ Hoare è¯­ä¹‰ï¼Œå®ƒæ›´éš¾æ„å»ºï¼Œä½†èƒ½æ›´æœ‰åŠ›åœ°ä¿è¯è¢«å”¤é†’çš„çº¿ç¨‹åœ¨è¢«å”¤é†’åç«‹å³è¿è¡Œã€‚å‡ ä¹æ‰€æœ‰å·²æ„å»ºçš„ç³»ç»Ÿéƒ½é‡‡ç”¨äº† Mesa è¯­ä¹‰ã€‚ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:2:2","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 æ›´å¥½ï¼Œä½†ä»ç„¶æ®‹ç¼ºï¼šwhileï¼Œè€Œä¸æ˜¯if å¹¸è¿çš„æ˜¯ï¼Œè§£å†³æ–¹æ³•å¾ˆç®€å•ï¼šå°† if æ”¹ä¸º whileã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š int loops; cond_t cond; mutex_t mutex; void *producer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); // p1 while (count == 1) // p2 Pthread_cond_wait(\u0026cond, \u0026mutex); // p3 put(i); // p4 Pthread_cond_signal(\u0026cond); // p5 Pthread_mutex_unlock(\u0026mutex); // p6 } } void *consumer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); // c1 while (count == 0) // c2 Pthread_cond_wait(\u0026cond, \u0026mutex); // c3 int tmp = get(); // c4 Pthread_cond_signal(\u0026cond); // c5 Pthread_mutex_unlock(\u0026mutex); // c6 printf(\"%d\\n\", tmp); } } æƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼šç°åœ¨æ¶ˆè´¹è€… $T_{c_1}$ ä¼šé†’æ¥ï¼Œå¹¶ï¼ˆåœ¨é”å®šçš„æƒ…å†µä¸‹ï¼‰ç«‹å³é‡æ–°æ£€æŸ¥å…±äº«å˜é‡ (c2) çš„çŠ¶æ€ã€‚å¦‚æœæ­¤æ—¶ç¼“å†²åŒºæ˜¯ç©ºçš„ï¼Œæ¶ˆè´¹è€…å°±ä¼šç»§ç»­ä¼‘çœ  (c3)ã€‚åœ¨ç”Ÿäº§è€…ä¸­ï¼Œif çš„æ¨è®ºä¹Ÿè¢«æ”¹ä¸º while (p2)ã€‚ å¾—ç›Šäº Mesa è¯­ä¹‰ï¼Œä½¿ç”¨æ¡ä»¶å˜é‡æ—¶è¦è®°ä½ä¸€æ¡ç®€å•çš„è§„åˆ™ï¼Œé‚£å°±æ˜¯å§‹ç»ˆä½¿ç”¨ while å¾ªç¯ã€‚æœ‰æ—¶ä¸å¿…é‡æ–°æ£€æŸ¥æ¡ä»¶ï¼Œä½†è¿™æ ·åšæ€»æ˜¯å®‰å…¨çš„ã€‚ ç„¶è€Œï¼Œè¿™æ®µä»£ç ä»ç„¶æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„ä¸¤ä¸ªé—®é¢˜ä¸­çš„ç¬¬äºŒä¸ªã€‚ä½ èƒ½å‘ç°å—ï¼Ÿå®ƒä¸åªæœ‰ä¸€ä¸ªæ¡ä»¶å˜é‡æœ‰å…³ã€‚ å½“ä¸¤ä¸ªæ¶ˆè´¹è€…é¦–å…ˆè¿è¡Œï¼ˆ$T_{c_1}$ å’Œ $T_{c_2}$ ï¼‰å¹¶éƒ½è¿›å…¥ç¡çœ çŠ¶æ€ï¼ˆc3ï¼‰æ—¶ï¼Œé—®é¢˜å°±å‡ºç°äº†ã€‚ç„¶åï¼Œç”Ÿäº§è€…è¿è¡Œï¼Œå°†ä¸€ä¸ªå€¼æ”¾å…¥ç¼“å†²åŒºï¼Œå¹¶å”¤é†’å…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆä¾‹å¦‚ $T_{c_1}$ ï¼‰ã€‚ç„¶åï¼Œç”Ÿäº§è€…è¿”å›å¾ªç¯ï¼ˆæ²¿é€”é‡Šæ”¾å¹¶é‡æ–°è·å–é”ï¼‰ï¼Œå¹¶å°è¯•å°†æ›´å¤šæ•°æ®æ”¾å…¥ç¼“å†²åŒºï¼›ç”±äºç¼“å†²åŒºå·²æ»¡ï¼Œç”Ÿäº§è€…è½¬è€Œç­‰å¾…æ¡ä»¶ï¼ˆå› æ­¤è¿›å…¥ç¡çœ ï¼‰ã€‚ç°åœ¨ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…å·²å‡†å¤‡å¥½è¿è¡Œï¼ˆ$T_{c_1}$ ï¼‰ï¼Œä¸¤ä¸ªçº¿ç¨‹æ­£åœ¨ç­‰å¾…ä¸€ä¸ªæ¡ä»¶ï¼ˆ$T_{c_2}$ å’Œ $T_{p}$ ï¼‰ã€‚ å…³é”®é—®é¢˜æ¥äº†ã€‚ç„¶åï¼Œæ¶ˆè´¹è€… $T_{c_1}$ ä» wait() è¿”å› (c3) å”¤é†’ï¼Œé‡æ–°æ£€æŸ¥æ¡ä»¶ (c2)ï¼Œå‘ç°ç¼“å†²åŒºå·²æ»¡ï¼Œäºæ˜¯æ¶ˆè€—å€¼ (c4)ã€‚é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ªæ¶ˆè´¹è€…ä¼šæ ¹æ®æ¡ä»¶ï¼ˆc5ï¼‰å‘å‡ºä¿¡å·ï¼Œåªå”¤é†’ä¸€ä¸ªå¤„äºç¡çœ çŠ¶æ€çš„çº¿ç¨‹ã€‚ç„¶è€Œï¼Œå®ƒåº”è¯¥å”¤é†’å“ªä¸ªçº¿ç¨‹å‘¢ï¼Ÿ å› ä¸ºæ¶ˆè´¹è€…æ¸…ç©ºäº†ç¼“å†²åŒºï¼Œæ˜¾ç„¶åº”è¯¥å”¤é†’ç”Ÿäº§è€…ã€‚ä½†æ˜¯ï¼Œå¦‚æœå”¤é†’æ¶ˆè´¹è€… $T_{c_2}$ï¼ˆè¿™æ˜¯ç»å¯¹å¯èƒ½çš„ï¼Œå–å†³äºç­‰å¾…é˜Ÿåˆ—çš„ç®¡ç†æ–¹å¼ï¼‰ï¼Œæˆ‘ä»¬å°±ä¼šé‡åˆ°é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œæ¶ˆè´¹è€… $T_{c_2}$ ä¼šåœ¨é†’æ¥æ—¶å‘ç°ç¼“å†²åŒºæ˜¯ç©ºçš„ï¼ˆc2ï¼‰ï¼Œç„¶åç»§ç»­ä¼‘çœ ï¼ˆc3ï¼‰ã€‚ç”Ÿäº§è€…$T_{p}$ æœ‰ä¸€ä¸ªå€¼è¦æ”¾å…¥ç¼“å†²åŒºï¼Œä½†å´å¤„äºä¼‘çœ çŠ¶æ€ã€‚å¦ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ $T_{c_1}$ ä¹Ÿç»§ç»­ä¼‘çœ ã€‚æ‰€æœ‰ä¸‰ä¸ªçº¿ç¨‹éƒ½å¤„äºä¼‘çœ çŠ¶æ€ï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„bugï¼›å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºäº†æœ‰å…³è¿™ä¸€å¯æ€•ç¾éš¾çš„æ®‹é…·æ­¥éª¤ã€‚ ä¿¡å·æ˜¾ç„¶æ˜¯éœ€è¦çš„ï¼Œä½†å¿…é¡»æ›´æœ‰é’ˆå¯¹æ€§ã€‚æ¶ˆè´¹è€…ä¸åº”å”¤é†’å…¶ä»–æ¶ˆè´¹è€…ï¼Œåªèƒ½å”¤é†’ç”Ÿäº§è€…ï¼Œåä¹‹äº¦ç„¶ã€‚ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:2:3","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.4 å•ä¸€ç¼“å†²åŒºç”Ÿäº§è€…/æ¶ˆè´¹è€…è§£å†³æ–¹æ¡ˆ è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆåˆæ˜¯ä¸€ä¸ªå°è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ä¸¤ä¸ªæ¡ä»¶å˜é‡è€Œä¸æ˜¯ä¸€ä¸ªï¼Œä»¥ä¾¿åœ¨ç³»ç»ŸçŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶æ­£ç¡®åœ°å‘å‡ºåº”è¯¥å”¤é†’å“ªç§ç±»å‹çš„çº¿ç¨‹çš„ä¿¡å·ã€‚æ”¹è¿›çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ cond_t empty, fill; mutex_t mutex; void *producer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); while (count == 1) Pthread_cond_wait(\u0026empty, \u0026mutex); put(i); Pthread_cond_signal(\u0026fill); Pthread_mutex_unlock(\u0026mutex); } } void *consumer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); while (count == 0) Pthread_cond_wait(\u0026fill, \u0026mutex); int tmp = get(); Pthread_cond_signal(\u0026empty); Pthread_mutex_unlock(\u0026mutex); printf(\"%d\\n\", tmp); } } åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œç”Ÿäº§è€…çº¿ç¨‹ç­‰å¾…æ¡ä»¶ä¸ºemptyï¼Œå¹¶å‘å‡ºfillä¿¡å·ã€‚ç›¸åï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ç­‰å¾…fillå¹¶å‘å‡ºemptyä¿¡å·ã€‚é€šè¿‡è¿™æ ·åšï¼Œä¸Šé¢çš„ç¬¬äºŒä¸ªé—®é¢˜åœ¨è®¾è®¡ä¸Šå°±å¾—åˆ°äº†é¿å…ï¼šæ¶ˆè´¹è€…æ°¸è¿œä¸ä¼šæ„å¤–å”¤é†’æ¶ˆè´¹è€…ï¼Œç”Ÿäº§è€…ä¹Ÿæ°¸è¿œä¸ä¼šæ„å¤–å”¤é†’ç”Ÿäº§è€…ã€‚ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:2:4","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.5 æœ€ç»ˆçš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…è§£å†³æ–¹æ¡ˆ æˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªæœ‰æ•ˆçš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…è§£å†³æ–¹æ¡ˆï¼Œå°½ç®¡ä¸æ˜¯ä¸€ä¸ªå®Œå…¨é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬æ‰€åšçš„æœ€åä¸€ä¸ªæ”¹å˜æ˜¯å®ç°æ›´é«˜çš„å¹¶å‘æ€§å’Œæ•ˆç‡ï¼›å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬æ·»åŠ æ›´å¤šçš„ç¼“å†²åŒºæ§½ï¼Œä»¥ä¾¿åœ¨ç¡çœ å‰å¯ä»¥ç”Ÿæˆå¤šä¸ªå€¼ï¼ŒåŒæ ·å¯ä»¥åœ¨ç¡çœ å‰æ¶ˆè€—å¤šä¸ªå€¼ã€‚ç”±äºåªæœ‰ä¸€ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œè¿™ç§æ–¹æ³•æ›´åŠ é«˜æ•ˆï¼Œå› ä¸ºå®ƒå‡å°‘äº†ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼›å¯¹äºå¤šä¸ªç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…ï¼ˆæˆ–ä¸¤è€…ï¼‰ï¼Œå®ƒç”šè‡³å…è®¸å¹¶å‘ç”Ÿäº§æˆ–æ¶ˆè´¹ï¼Œä»è€Œå¢åŠ å¹¶å‘æ€§ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¸æˆ‘ä»¬å½“å‰çš„è§£å†³æ–¹æ¡ˆç›¸æ¯”åªæ˜¯ä¸€ä¸ªå°å°çš„æ”¹å˜ã€‚ è¦å®ç°è¿™ä¸€æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆï¼Œé¦–å…ˆè¦æ”¹å˜çš„æ˜¯ç¼“å†²åŒºç»“æ„æœ¬èº«ä»¥åŠç›¸åº”çš„ put() å’Œ get()ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ #define MAX 10 int buffer[MAX]; int fill_ptr = 0; int use_ptr = 0; int count = 0; mutex_t mutex; cond_t empty, fill; void put(int value) { Pthread_mutex_lock(\u0026mutex); while (count == MAX) Pthread_cond_wait(\u0026empty, \u0026mutex); buffer[fill_ptr] = value; fill_ptr = (fill_ptr + 1) % MAX; count++; Pthread_cond_signal(\u0026fill); Pthread_mutex_unlock(\u0026mutex); } int get() { int tmp; Pthread_mutex_lock(\u0026mutex); while (count == 0) Pthread_cond_wait(\u0026fill, \u0026mutex); tmp = buffer[use_ptr]; use_ptr = (use_ptr + 1) % MAX; count--; Pthread_cond_signal(\u0026empty); Pthread_mutex_unlock(\u0026mutex); return tmp; } æˆ‘ä»¬è¿˜ç¨å¾®ä¿®æ”¹äº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸ºç¡®å®šæ˜¯å¦ä¼‘çœ è€Œæ£€æŸ¥çš„æ¡ä»¶ã€‚ä¸‹é¢ä»£ç æ˜¾ç¤ºäº†æ­£ç¡®çš„ç­‰å¾…å’Œä¿¡å·é€»è¾‘ã€‚ cond_t empty, fill; mutex_t mutex; void *producer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); // p1 while (count == MAX) // p2 Pthread_cond_wait(\u0026empty, \u0026mutex); // p3 put(i); // p4 Pthread_cond_signal(\u0026fill); // p5 Pthread_mutex_unlock(\u0026mutex); // p6 } } void *consumer(void *arg) { int i; for (i = 0; i \u003c loops; i++) { Pthread_mutex_lock(\u0026mutex); // c1 while (count == 0) // c2 Pthread_cond_wait(\u0026fill, \u0026mutex); // c3 int tmp = get(); // c4 Pthread_cond_signal(\u0026empty); // c5 Pthread_mutex_unlock(\u0026mutex); // c6 printf(\"%d\\n\", tmp); } } ç”Ÿäº§è€…åªæœ‰åœ¨æ‰€æœ‰ç¼“å†²åŒºéƒ½è¢«å¡«æ»¡çš„æƒ…å†µä¸‹æ‰ä¼šä¼‘çœ ï¼ˆp2ï¼‰ï¼›åŒæ ·ï¼Œæ¶ˆè´¹è€…åªæœ‰åœ¨æ‰€æœ‰ç¼“å†²åŒºéƒ½è¢«æ¸…ç©ºçš„æƒ…å†µä¸‹æ‰ä¼šä¼‘çœ ï¼ˆc2ï¼‰ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±è§£å†³äº†ç”Ÿäº§è€…/æ¶ˆè´¹è€…çš„é—®é¢˜ã€‚ TIPï¼šå¯¹æ¡ä»¶ä½¿ç”¨ WHILEï¼ˆè€Œé IFï¼‰ åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­æ£€æŸ¥æ¡ä»¶æ—¶ï¼Œä½¿ç”¨ while å¾ªç¯å§‹ç»ˆæ˜¯æ­£ç¡®çš„ï¼›è€Œä»…ä½¿ç”¨ if è¯­å¥å¯èƒ½æ˜¯é”™è¯¯çš„ï¼Œè¿™å–å†³äºä¿¡å·çš„è¯­ä¹‰ã€‚å› æ­¤ï¼Œå§‹ç»ˆä½¿ç”¨ while è¯­å¥ï¼Œä½ çš„ä»£ç å°±ä¼šæŒ‰ç…§é¢„æœŸè¿è¡Œã€‚ åœ¨æ¡ä»¶æ£€æŸ¥å‘¨å›´ä½¿ç”¨ while å¾ªç¯è¿˜èƒ½å¤„ç†å‘ç”Ÿè™šå‡å”¤é†’çš„æƒ…å†µã€‚åœ¨æŸäº›çº¿ç¨‹åŒ…ä¸­ï¼Œç”±äºå®ç°çš„ç»†èŠ‚é—®é¢˜ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸¤ä¸ªçº¿ç¨‹è¢«å”¤é†’çš„æƒ…å†µï¼Œå°½ç®¡åªå‘ç”Ÿäº†ä¸€ä¸ªä¿¡å·ã€‚è™šå‡å”¤é†’æ˜¯é‡æ–°æ£€æŸ¥çº¿ç¨‹æ­£åœ¨ç­‰å¾…çš„æ¡ä»¶çš„è¿›ä¸€æ­¥ç†ç”±ã€‚ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:2:5","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 è¦†ç›–æ¡ä»¶ ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨æ¡ä»¶å˜é‡çš„ä¾‹å­ã€‚æœ¬ä»£ç ç ”ç©¶æ‘˜è‡ª Lampson å’Œ Redell å…³äº Pilot çš„è®ºæ–‡ ï¼Œæ­£æ˜¯ä»–ä»¬é¦–æ¬¡å®ç°äº†ä¸Šæ–‡æ‰€è¿°çš„ Mesa è¯­ä¹‰ï¼ˆä»–ä»¬ä½¿ç”¨çš„è¯­è¨€æ˜¯ Mesaï¼Œå› æ­¤å¾—åï¼‰ã€‚ ä»–ä»¬é‡åˆ°çš„é—®é¢˜æœ€å¥½é€šè¿‡ç®€å•çš„ç¤ºä¾‹æ¥è¯´æ˜ï¼Œè¿™é‡Œçš„ç¤ºä¾‹æ˜¯ä¸€ä¸ªç®€å•çš„å¤šçº¿ç¨‹å†…å­˜åˆ†é…åº“ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ // how many bytes of the heap are free? int bytesLeft = MAX_HEAP_SIZE; // need lock and condition too cond_t c; mutex_t m; void * allocate(int size) { Pthread_mutex_lock(\u0026m); while (bytesLeft \u003c size) Pthread_cond_wait(\u0026c, \u0026m); void *ptr = ...; // get mem from heap bytesLeft -= size; Pthread_mutex_unlock(\u0026m); return ptr; } void free(void *ptr, int size) { Pthread_mutex_lock(\u0026m); bytesLeft += size; Pthread_cond_signal(\u0026c); // Signal waiting threads Pthread_mutex_unlock(\u0026m); } æ­£å¦‚ä½ åœ¨ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œå½“çº¿ç¨‹è°ƒç”¨å†…å­˜åˆ†é…ä»£ç æ—¶ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…æ›´å¤šå†…å­˜è¢«é‡Šæ”¾ã€‚åä¹‹ï¼Œå½“çº¿ç¨‹é‡Šæ”¾å†…å­˜æ—¶ï¼Œå°±ä¼šå‘å‡ºæ›´å¤šå†…å­˜å¯ç”¨çš„ä¿¡å·ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä»£ç æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå“ªä¸ªç­‰å¾…çš„çº¿ç¨‹ï¼ˆå¯èƒ½ä¸æ­¢ä¸€ä¸ªï¼‰åº”è¯¥è¢«å”¤é†’ï¼Ÿ è¯·è€ƒè™‘ä»¥ä¸‹æƒ…å†µã€‚å‡è®¾ç©ºé—²å­—èŠ‚æ•°ä¸ºé›¶ï¼›çº¿ç¨‹ $T_a$ è°ƒç”¨ allocate(100)ï¼Œç´§éšå…¶åçš„çº¿ç¨‹ $T_b$ è°ƒç”¨ allocate(10)ï¼Œè¦æ±‚è·å¾—æ›´å°‘çš„å†…å­˜ã€‚å› æ­¤ï¼Œ $T_a$å’Œ $T_b$ éƒ½ç­‰å¾…æ¡ä»¶å¹¶è¿›å…¥ä¼‘çœ ï¼›æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—²å­—èŠ‚æ¥æ»¡è¶³è¿™ä¸¤ä¸ªè¯·æ±‚ã€‚ è¿™æ—¶ï¼Œå‡è®¾ç¬¬ä¸‰ä¸ªçº¿ç¨‹ $T_c$è°ƒç”¨ free(50)ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå½“å®ƒè°ƒç”¨ signal æ¥å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹æ—¶ï¼Œå¯èƒ½æ²¡æœ‰å”¤é†’æ­£ç¡®çš„ç­‰å¾…çº¿ç¨‹ $T_b$ï¼Œå› ä¸º $T_b$ åªç­‰å¾…é‡Šæ”¾ 10 ä¸ªå­—èŠ‚ï¼›$T_a$ åº”è¯¥ç»§ç»­ç­‰å¾…ï¼Œå› ä¸ºè¿˜æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—²å†…å­˜ã€‚å› æ­¤ï¼Œä¸Šé¢çš„ä»£ç ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå”¤é†’å…¶ä»–çº¿ç¨‹çš„çº¿ç¨‹ä¸çŸ¥é“è¯¥å”¤é†’å“ªä¸ªï¼ˆæˆ–å“ªäº›ï¼‰çº¿ç¨‹ã€‚ Lampson å’Œ Redell æå‡ºçš„è§£å†³æ–¹æ¡ˆéå¸¸ç®€å•ï¼šç”¨è°ƒç”¨ pthread_cond_broadcast() ä»£æ›¿ä¸Šé¢ä»£ç ä¸­çš„ pthread_cond_signal()ï¼Œå”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½ä¿è¯æ‰€æœ‰åº”è¯¥è¢«å”¤é†’çš„çº¿ç¨‹éƒ½è¢«å”¤é†’äº†ã€‚å½“ç„¶ï¼Œè¿™æ ·åšçš„ç¼ºç‚¹æ˜¯å¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½ä¼šä¸å¿…è¦åœ°å”¤é†’è®¸å¤šå…¶ä»–ä¸åº”è¯¥ï¼ˆå°šæœªï¼‰è¢«å”¤é†’çš„ç­‰å¾…çº¿ç¨‹ã€‚è¿™äº›çº¿ç¨‹ä¼šç®€å•åœ°å”¤é†’ï¼Œé‡æ–°æ£€æŸ¥æ¡ä»¶ï¼Œç„¶åç«‹å³å›åˆ°ç¡çœ çŠ¶æ€ã€‚ Lampson å’Œ Redell å°†è¿™ç§æ¡ä»¶ç§°ä¸ºè¦†ç›–æ¡ä»¶ï¼Œå› ä¸ºå®ƒæ¶µç›–äº†ï¼ˆä¿å®ˆåœ°ï¼‰éœ€è¦å”¤é†’çº¿ç¨‹çš„æ‰€æœ‰æƒ…å†µï¼›æ­£å¦‚æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡çš„ï¼Œä»£ä»·æ˜¯å¯èƒ½ä¼šå”¤é†’è¿‡å¤šçš„çº¿ç¨‹ã€‚ç²¾æ˜çš„è¯»è€…å¯èƒ½ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬æœ¬å¯ä»¥åœ¨æ›´æ—©çš„æ—¶å€™ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼ˆå‚è§åªæœ‰ä¸€ä¸ªæ¡ä»¶å˜é‡çš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜ï¼‰ã€‚ä¸è¿‡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨äº†å®ƒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ å‘ç°åªæœ‰å½“ä½ å°†ä¿¡å·æ”¹ä¸ºå¹¿æ’­æ—¶ï¼Œä½ çš„ç¨‹åºæ‰èƒ½è¿è¡Œï¼ˆä½†ä½ è®¤ä¸ºå®ƒä¸éœ€è¦è¿™æ ·ï¼‰ï¼Œé‚£ä¹ˆä½ å¯èƒ½é‡åˆ°äº†ä¸€ä¸ªé”™è¯¯ï¼›è¯·ä¿®å¤å®ƒï¼ä½†åœ¨ç±»ä¼¼ä¸Šè¿°å†…å­˜åˆ†é…å™¨çš„æƒ…å†µä¸‹ï¼Œå¹¿æ’­å¯èƒ½æ˜¯æœ€ç›´æ¥çš„è§£å†³æ–¹æ¡ˆã€‚ ","date":"2024-05-11","objectID":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/:3:0","tags":["OS"],"title":"æ¡ä»¶å˜é‡","uri":"/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åœ¨è®¨è®ºé”ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæè¿°å¦‚ä½•åœ¨ä¸€äº›å¸¸è§çš„æ•°æ®ç»“æ„ä¸­ä½¿ç”¨é”ã€‚å‘æ•°æ®ç»“æ„æ·»åŠ é”ä»¥ä½¿å…¶å¯ç”±çº¿ç¨‹ä½¿ç”¨ï¼Œä»è€Œä½¿è¯¥ç»“æ„æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚ä½•åŠ é”å†³å®šäº†æ•°æ®ç»“æ„çš„æ­£ç¡®æ€§å’Œæ€§èƒ½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¢ä¸´ç€å…³é”®æŒ‘æˆ˜ï¼šå½“ç»™å®šä¸€ä¸ªç‰¹å®šçš„æ•°æ®ç»“æ„æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å‘å®ƒæ·»åŠ é”ï¼Œä»¥ä½¿å…¶æ­£å¸¸å·¥ä½œï¼Ÿæ­¤å¤–ï¼Œæˆ‘ä»¬å¦‚ä½•æ·»åŠ é”ä»¥ä½¿æ•°æ®ç»“æ„äº§ç”Ÿé«˜æ€§èƒ½ï¼Œä½¿è®¸å¤šçº¿ç¨‹èƒ½å¤ŸåŒæ—¶ï¼ˆå³å¹¶å‘ï¼‰è®¿é—®è¯¥ç»“æ„ï¼Ÿ ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:0:0","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¹¶å‘è®¡æ•°å™¨ è®¡æ•°å™¨æ˜¯æœ€ç®€å•çš„æ•°æ®ç»“æ„ä¹‹ä¸€ã€‚å®ƒæ˜¯ä¸€ç§å¸¸ç”¨çš„ç»“æ„ï¼Œå…·æœ‰ç®€å•çš„æ¥å£ã€‚ä¸‹é¢ä»£ç ä¸­ä¸­å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„éå¹¶å‘è®¡æ•°å™¨ã€‚ typedef struct __counter_t { int value; } counter_t; void init(counter_t *c) { c-\u003evalue = 0; } void increment(counter_t *c) { c-\u003evalue++; } void decrement(counter_t *c) { c-\u003evalue--; } int get(counter_t *c) { return c-\u003evalue; } ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:1:0","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.1 ç®€å•ä½†ä¸å¯æ‰©å±• æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œéå¹¶å‘è®¡æ•°å™¨æ˜¯ä¸€ä¸ªç®€å•çš„æ•°æ®ç»“æ„ï¼Œéœ€è¦å°‘é‡çš„ä»£ç æ¥å®ç°ã€‚ç°åœ¨æˆ‘ä»¬é¢ä¸´ä¸‹ä¸€ä¸ªæŒ‘æˆ˜ï¼šå¦‚ä½•ä½¿è¿™æ®µä»£ç çº¿ç¨‹å®‰å…¨ï¼Ÿä¸‹é¢è¿™æ®µä»£ç æ˜¾ç¤ºäº†æˆ‘ä»¬å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚ typedef struct __counter_t { int value; pthread_mutex_t lock; } counter_t; void init(counter_t *c) { c-\u003evalue = 0; pthread_mutex_init(\u0026c-\u003elock, NULL); } void increment(counter_t *c) { pthread_mutex_lock(\u0026c-\u003elock); c-\u003evalue++; pthread_mutex_unlock(\u0026c-\u003elock); } void decrement(counter_t *c) { pthread_mutex_lock(\u0026c-\u003elock); c-\u003evalue--; pthread_mutex_unlock(\u0026c-\u003elock); } int get(counter_t *c) { pthread_mutex_lock(\u0026c-\u003elock); int rc = c-\u003evalue; pthread_mutex_unlock(\u0026c-\u003elock); return rc; } è¿™ä¸ªå¹¶å‘è®¡æ•°å™¨å¾ˆç®€å•å¹¶ä¸”å·¥ä½œæ­£å¸¸ã€‚äº‹å®ä¸Šï¼Œå®ƒéµå¾ªæœ€ç®€å•å’Œæœ€åŸºæœ¬çš„å¹¶å‘æ•°æ®ç»“æ„å¸¸è§çš„è®¾è®¡æ¨¡å¼ï¼šå®ƒåªæ˜¯æ·»åŠ ä¸€ä¸ªé”ï¼Œè¯¥é”åœ¨è°ƒç”¨æ“ä½œæ•°æ®ç»“æ„çš„ä¾‹ç¨‹æ—¶è·å–ï¼Œå¹¶åœ¨ä»è°ƒç”¨è¿”å›æ—¶é‡Šæ”¾ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®ƒç±»ä¼¼äºä½¿ç”¨ç›‘è§†å™¨æ„å»ºçš„æ•°æ®ç»“æ„ï¼Œå½“æ‚¨è°ƒç”¨å¯¹è±¡æ–¹æ³•å¹¶ä»å¯¹è±¡æ–¹æ³•è¿”å›æ—¶ï¼Œä¼šè‡ªåŠ¨è·å–å’Œé‡Šæ”¾é”ã€‚ è‡³æ­¤ï¼Œä½ å·²ç»æœ‰äº†ä¸€ä¸ªå¯ä»¥è¿è¡Œçš„å¹¶å‘æ•°æ®ç»“æ„ã€‚ä½ å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜æ˜¯æ€§èƒ½ã€‚å¦‚æœä½ çš„æ•°æ®ç»“æ„é€Ÿåº¦å¤ªæ…¢ï¼Œä½ éœ€è¦åšçš„å°±ä¸ä»…ä»…æ˜¯æ·»åŠ ä¸€ä¸ªé”äº†ï¼›å› æ­¤ï¼Œå¦‚æœéœ€è¦è¿›è¡Œæ­¤ç±»ä¼˜åŒ–ï¼Œè¿™å°†æ˜¯æœ¬ç« å…¶ä½™éƒ¨åˆ†çš„ä¸»é¢˜ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ•°æ®ç»“æ„çš„è¿è¡Œé€Ÿåº¦ä¸æ˜¯å¤ªæ…¢ï¼Œé‚£ä¹ˆä½ å°±å¤§åŠŸå‘Šæˆäº†ï¼å¦‚æœç®€å•çš„æ•°æ®ç»“æ„ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦åšä»€ä¹ˆèŠ±å“¨çš„äº‹æƒ…äº†ã€‚ ä¸ºäº†äº†è§£ç®€å•æ–¹æ³•çš„æ€§èƒ½ä»£ä»·ï¼Œæˆ‘ä»¬è¿è¡Œäº†ä¸€ä¸ªåŸºå‡†ï¼Œå…¶ä¸­æ¯ä¸ªçº¿ç¨‹æ›´æ–°å•ä¸ªå…±äº«è®¡æ•°å™¨çš„æ¬¡æ•°æ˜¯å›ºå®šçš„ï¼›ç„¶åæˆ‘ä»¬æ”¹å˜çº¿ç¨‹çš„æ•°é‡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºäº†åœ¨ä¸€åˆ°å››ä¸ªçº¿ç¨‹æ´»åŠ¨çš„æƒ…å†µä¸‹æ‰€èŠ±è´¹çš„æ€»æ—¶é—´ï¼›æ¯ä¸ªçº¿ç¨‹æ›´æ–°è®¡æ•°å™¨ 100 ä¸‡æ¬¡ã€‚æœ¬å®éªŒåœ¨é…å¤‡å››é¢—è‹±ç‰¹å°” 2.7 GHz i5 CPU çš„ iMac ä¸Šè¿è¡Œï¼›å¦‚æœæ¿€æ´»çš„ CPU è¶Šå¤šï¼Œæˆ‘ä»¬å¸Œæœ›å•ä½æ—¶é—´å†…å®Œæˆçš„æ€»å·¥ä½œé‡å°±è¶Šå¤§ã€‚ ä»å›¾ä¸­æœ€ä¸Šé¢ä¸€è¡Œï¼ˆæ ‡æ³¨ä¸º â€œPreciseâ€ï¼‰å¯ä»¥çœ‹å‡ºï¼Œå¹¶å‘è®¡æ•°å™¨çš„æ€§èƒ½æ‰©å±•æ€§å¾ˆå·®ã€‚å•ä¸ªçº¿ç¨‹å¯ä»¥åœ¨æçŸ­çš„æ—¶é—´å†…ï¼ˆå¤§çº¦ 0.03 ç§’ï¼‰å®Œæˆç™¾ä¸‡æ¬¡è®¡æ•°å™¨æ›´æ–°ï¼Œè€Œè®©ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ›´æ–°è®¡æ•°å™¨ 100 ä¸‡æ¬¡åˆ™ä¼šå¯¼è‡´é€Ÿåº¦å¤§å¹…ä¸‹é™ï¼ˆè¶…è¿‡ 5 ç§’ï¼ï¼‰ã€‚çº¿ç¨‹è¶Šå¤šï¼Œæƒ…å†µè¶Šç³Ÿç³•ã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼Œçº¿ç¨‹åœ¨å¤šå¤„ç†å™¨ä¸Šå®Œæˆçš„é€Ÿåº¦è¦å’Œå•çº¿ç¨‹åœ¨å•å¤„ç†å™¨ä¸Šå®Œæˆçš„é€Ÿåº¦ä¸€æ ·å¿«ã€‚å®ç°è¿™ä¸€ç›®æ ‡è¢«ç§°ä¸ºå®Œç¾æ‰©å±•ï¼›å³ä½¿è¦å®Œæˆæ›´å¤šå·¥ä½œï¼Œä¹Ÿæ˜¯å¹¶è¡Œå®Œæˆçš„ï¼Œå› æ­¤å®Œæˆä»»åŠ¡æ‰€éœ€çš„æ—¶é—´ä¸ä¼šå¢åŠ ã€‚ ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:1:1","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.2 å¯æ‰©å±•è®¡æ•°å™¨ ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œç ”ç©¶äººå‘˜å¤šå¹´æ¥ä¸€ç›´åœ¨ç ”ç©¶å¦‚ä½•æ„å»ºæ›´å…·å¯æ‰©å±•æ€§çš„è®¡æ•°å™¨ã€‚æ›´ä»¤äººæƒŠå¹çš„æ˜¯ï¼Œå¯æ‰©å±•è®¡æ•°å™¨çš„é‡è¦æ€§ï¼Œæ­£å¦‚æœ€è¿‘åœ¨æ“ä½œç³»ç»Ÿæ€§èƒ½åˆ†ææ–¹é¢çš„å·¥ä½œæ‰€æ˜¾ç¤ºçš„é‚£æ ·ï¼›å¦‚æœæ²¡æœ‰å¯æ‰©å±•è®¡æ•°ï¼Œåœ¨ Linux ä¸Šè¿è¡Œçš„ä¸€äº›å·¥ä½œè´Ÿè½½åœ¨å¤šæ ¸æœºå™¨ä¸Šå°±ä¼šå‡ºç°ä¸¥é‡çš„å¯æ‰©å±•æ€§é—®é¢˜ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäººä»¬å¼€å‘äº†è®¸å¤šæŠ€æœ¯ã€‚æˆ‘ä»¬å°†ä»‹ç»ä¸€ç§ç§°ä¸ºè¿‘ä¼¼è®¡æ•°å™¨çš„æ–¹æ³• [C06]ã€‚ è¿‘ä¼¼è®¡æ•°å™¨çš„å·¥ä½œåŸç†æ˜¯é€šè¿‡ä¼—å¤šæœ¬åœ°ç‰©ç†è®¡æ•°å™¨ï¼ˆæ¯ä¸ª CPU å†…æ ¸ä¸€ä¸ªï¼‰å’Œä¸€ä¸ªå…¨å±€è®¡æ•°å™¨æ¥è¡¨ç¤ºä¸€ä¸ªé€»è¾‘è®¡æ•°å™¨ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ä¸€å°æœ‰å››ä¸ª CPU çš„æœºå™¨ä¸Šï¼Œæœ‰å››ä¸ªæœ¬åœ°è®¡æ•°å™¨å’Œä¸€ä¸ªå…¨å±€è®¡æ•°å™¨ã€‚é™¤äº†è¿™äº›è®¡æ•°å™¨å¤–ï¼Œè¿˜æœ‰é”ï¼šæ¯ä¸ªæœ¬åœ°è®¡æ•°å™¨å’Œå…¨å±€è®¡æ•°å™¨å„æœ‰ä¸€ä¸ªé”ã€‚ è¿‘ä¼¼è®¡æ•°å™¨çš„åŸºæœ¬æ€æƒ³å¦‚ä¸‹ã€‚å½“è¿è¡Œåœ¨ç»™å®šå†…æ ¸ä¸Šçš„çº¿ç¨‹å¸Œæœ›é€’å¢è®¡æ•°å™¨æ—¶ï¼Œå®ƒä¼šé€’å¢å…¶æœ¬åœ°è®¡æ•°å™¨ï¼›é€šè¿‡ç›¸åº”çš„æœ¬åœ°é”åŒæ­¥è®¿é—®è¯¥æœ¬åœ°è®¡æ•°å™¨ã€‚ç”±äºæ¯ä¸ª CPU éƒ½æœ‰è‡ªå·±çš„æœ¬åœ°è®¡æ•°å™¨ï¼Œå› æ­¤è·¨ CPU çš„çº¿ç¨‹å¯ä»¥æ— ç«äº‰åœ°æ›´æ–°æœ¬åœ°è®¡æ•°å™¨ï¼Œå› æ­¤è®¡æ•°å™¨çš„æ›´æ–°æ˜¯å¯æ‰©å±•çš„ã€‚ ä¸è¿‡ï¼Œä¸ºäº†ä¿æŒå…¨å±€è®¡æ•°å™¨çš„æœ€æ–°çŠ¶æ€ï¼ˆä»¥é˜²çº¿ç¨‹å¸Œæœ›è¯»å–å…¶å€¼ï¼‰ï¼Œæœ¬åœ°è®¡æ•°å™¨çš„å€¼ä¼šå®šæœŸè½¬ç§»åˆ°å…¨å±€è®¡æ•°å™¨ä¸Šï¼Œæ–¹æ³•æ˜¯è·å–å…¨å±€é”ï¼Œå¹¶æ ¹æ®æœ¬åœ°è®¡æ•°å™¨çš„å€¼é€’å¢ï¼›ç„¶åå°†æœ¬åœ°è®¡æ•°å™¨é‡ç½®ä¸ºé›¶ã€‚ è¿™ç§ä»æœ¬åœ°åˆ°å…¨å±€çš„è½¬ç§»å‘ç”Ÿé¢‘ç‡ç”±é˜ˆå€¼ S ç¡®å®šã€‚S è¶Šå°ï¼Œè®¡æ•°å™¨çš„è¡Œä¸ºå°±è¶Šåƒä¸Šè¿°ä¸å¯æ‰©å±•çš„è®¡æ•°å™¨ï¼›S è¶Šå¤§ï¼Œè®¡æ•°å™¨çš„å¯æ‰©å±•æ€§å°±è¶Šå¼ºï¼Œä½†å…¨å±€å€¼å¯èƒ½ä¼šåç¦»å®é™…è®¡æ•°ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°è·å–æ‰€æœ‰æœ¬åœ°é”å’Œå…¨å±€é”ï¼ˆæŒ‰æŒ‡å®šé¡ºåºï¼Œä»¥é¿å…æ­»é”ï¼‰æ¥è·å¾—ç²¾ç¡®å€¼ï¼Œä½†è¿™æ˜¯ä¸å¯æ‰©å±•çš„ã€‚ ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé˜ˆå€¼ S è®¾ç½®ä¸º 5ï¼Œå››ä¸ª CPU ä¸Šéƒ½æœ‰çº¿ç¨‹åœ¨æ›´æ–°æœ¬åœ°è®¡æ•°å™¨ L1 â€¦ L4ã€‚å…¨å±€è®¡æ•°å™¨å€¼ (G) ä¹Ÿæ˜¾ç¤ºåœ¨è·Ÿè¸ªä¸­ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ä¸æ–­å‘ä¸‹å¢åŠ ã€‚åœ¨æ¯ä¸ªæ—¶é—´æ­¥é•¿ï¼Œæœ¬åœ°è®¡æ•°å™¨éƒ½å¯èƒ½é€’å¢ï¼›å¦‚æœæœ¬åœ°å€¼è¾¾åˆ°é˜ˆå€¼ Sï¼Œæœ¬åœ°å€¼å°±ä¼šè½¬ç§»åˆ°å…¨å±€è®¡æ•°å™¨ï¼Œç„¶åæœ¬åœ°è®¡æ•°å™¨è¢«é‡ç½®ã€‚ åœ¨ä¸Šå›¾ä¸­ï¼ˆæ ‡æ³¨ä¸º â€œApproximateâ€ï¼‰çš„ä¸‹çº¿æ˜¾ç¤ºäº†é˜ˆå€¼ S ä¸º 1024 çš„è¿‘ä¼¼è®¡æ•°å™¨çš„æ€§èƒ½ã€‚è¯¥è®¡æ•°å™¨çš„æ€§èƒ½éå¸¸å‡ºè‰²ï¼›åœ¨å››ä¸ªå¤„ç†å™¨ä¸Šæ›´æ–°è®¡æ•°å™¨ 400 ä¸‡æ¬¡æ‰€éœ€çš„æ—¶é—´å‡ ä¹ä¸è¶…è¿‡åœ¨ä¸€ä¸ªå¤„ç†å™¨ä¸Šæ›´æ–°è®¡æ•°å™¨ 100 ä¸‡æ¬¡æ‰€éœ€çš„æ—¶é—´ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†é˜ˆå€¼ S çš„é‡è¦æ€§ï¼Œå››ä¸ªçº¿ç¨‹åœ¨å››ä¸ª CPU ä¸Šå„é€’å¢è®¡æ•°å™¨ 100 ä¸‡æ¬¡ã€‚å¦‚æœ S å€¼è¾ƒä½ï¼Œåˆ™æ€§èƒ½è¾ƒå·®ï¼ˆä½†å…¨å±€è®¡æ•°æ€»æ˜¯ç›¸å½“å‡†ç¡®ï¼‰ï¼›å¦‚æœ S å€¼è¾ƒé«˜ï¼Œåˆ™æ€§èƒ½å‡ºè‰²ï¼Œä½†å…¨å±€è®¡æ•°æ»åï¼ˆæœ€å¤šæ»å CPU æ•°é‡ä¹˜ä»¥ Sï¼‰ã€‚è¿‘ä¼¼è®¡æ•°å™¨æ­£æ˜¯é€šè¿‡è¿™ç§ç²¾åº¦/æ€§èƒ½æƒè¡¡å®ç°çš„ã€‚ è¿‘ä¼¼è®¡æ•°å™¨çš„ç²—ç•¥ç‰ˆæœ¬å¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºã€‚ typedef struct __counter_t { int global; // global count pthread_mutex_t glock; // global lock int local[NUMCPUS]; // local count (per cpu) pthread_mutex_t llock[NUMCPUS]; // ... and locks int threshold; // update frequency } counter_t; // init: record threshold, init locks, init values // of all local counts and global count void init(counter_t *c, int threshold) { c-\u003ethreshold = threshold; c-\u003eglobal = 0; pthread_mutex_init(\u0026c-\u003eglock, NULL); int i; for (i = 0; i \u003c NUMCPUS; i++) { c-\u003elocal[i] = 0; pthread_mutex_init(\u0026c-\u003ellock[i], NULL); } } // update: usually, just grab local lock and update local amount // once local count has risen by â€™thresholdâ€™, grab global // lock and transfer local values to it void update(counter_t *c, int threadID, int amt) { int cpu = threadID % NUMCPUS; pthread_mutex_lock(\u0026c-\u003ellock[cpu]); c-\u003elocal[cpu] += amt; // assumes amt \u003e 0 if (c-\u003elocal[cpu] \u003e= c-\u003ethreshold) { // transfer to global pthread_mutex_lock(\u0026c-\u003eglock); c-\u003eglobal += c-\u003elocal[cpu]; pthread_mutex_unlock(\u0026c-\u003eglock); c-\u003elocal[cpu] = 0; } pthread_mutex_unlock(\u0026c-\u003ellock[cpu]); } // get: just return global amount (which may not be perfect) int get(counter_t *c) { pthread_mutex_lock(\u0026c-\u003eglock); int val = c-\u003eglobal; pthread_mutex_unlock(\u0026c-\u003eglock); return val; // only approximate! } ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:1:2","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 å¹¶å‘é“¾è¡¨ ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:2:0","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åŸºæœ¬å®ç° æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦ç ”ç©¶ä¸€ç§æ›´å¤æ‚çš„ç»“æ„â€”é“¾è¡¨ã€‚è®©æˆ‘ä»¬å†æ¬¡ä»åŸºæœ¬æ–¹æ³•å¼€å§‹ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†çœç•¥è¿™ç§åˆ—è¡¨ä¸­çš„ä¸€äº›æ˜¾è€Œæ˜“è§çš„ä¾‹ç¨‹ï¼Œè€Œåªå…³æ³¨å¹¶å‘æ’å…¥ï¼›è‡³äºæŸ¥æ‰¾ã€åˆ é™¤ç­‰ï¼Œæˆ‘ä»¬å°†ç•™ç»™è¯»è€…è‡ªå·±å»æ€è€ƒæˆ–è€…å¯ä»¥åœ¨ä»“åº“ä¸­æ‰¾åˆ°æ›´è¯¦ç»†çš„ç‰ˆæœ¬ã€‚ä¸‹é¢æ˜¾ç¤ºäº†è¿™ç§åˆçº§æ•°æ®ç»“æ„çš„ä»£ç ã€‚ // basic node structure typedef struct __node_t { int key; struct __node_t *next; } node_t; // basic list structure (one used per list) typedef struct __list_t { node_t *head; pthread_mutex_t lock; } list_t; void List_Init(list_t *L) { L-\u003ehead = NULL; pthread_mutex_init(\u0026L-\u003elock, NULL); } int List_Insert(list_t *L, int key, int thread_id) { pthread_mutex_lock(\u0026L-\u003elock); printf(\"Thread %d: Inserting %d\\n\", thread_id, key); node_t *new = malloc(sizeof(node_t)); if (new == NULL) { perror(\"malloc\"); pthread_mutex_unlock(\u0026L-\u003elock); return -1; // fail } new-\u003ekey = key; new-\u003enext = L-\u003ehead; L-\u003ehead = new; pthread_mutex_unlock(\u0026L-\u003elock); return 0; // success } ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œä»£ç åªæ˜¯åœ¨è¿›å…¥æ’å…¥ä¾‹ç¨‹æ—¶è·å–ä¸€ä¸ªé”ï¼Œå¹¶åœ¨é€€å‡ºæ—¶é‡Šæ”¾å®ƒã€‚å¦‚æœ malloc() æ°å¥½å¤±è´¥ï¼ˆè¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼‰ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªæ£˜æ‰‹çš„å°é—®é¢˜ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç è¿˜å¿…é¡»åœ¨æ’å…¥å¤±è´¥å‰é‡Šæ”¾é”ã€‚ äº‹å®è¯æ˜ï¼Œè¿™ç§ç‰¹æ®Šçš„æ§åˆ¶æµéå¸¸å®¹æ˜“å‡ºé”™ï¼›æœ€è¿‘å¯¹ Linux å†…æ ¸è¡¥ä¸çš„ä¸€é¡¹ç ”ç©¶å‘ç°ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†é”™è¯¯ï¼ˆè¿‘ 40%ï¼‰éƒ½æ˜¯åœ¨è¿™ç§å¾ˆå°‘ä½¿ç”¨çš„ä»£ç è·¯å¾„ä¸Šå‘ç°çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¢ä¸´ç€ä¸€ä¸ªæŒ‘æˆ˜ï¼šæˆ‘ä»¬èƒ½å¦é‡å†™æ’å…¥å’ŒæŸ¥æ‰¾ä¾‹ç¨‹ï¼Œä½¿å…¶åœ¨å¹¶å‘æ’å…¥æ—¶ä¿æŒæ­£ç¡®ï¼Œä½†é¿å…å¤±è´¥è·¯å¾„ä¹Ÿéœ€è¦æˆ‘ä»¬æ·»åŠ unlockè°ƒç”¨çš„æƒ…å†µï¼Ÿ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ„ä¸€ä¸‹List_Insertä»£ç ï¼Œä½¿é”å®šå’Œé‡Šæ”¾åªå›´ç»•æ’å…¥ä»£ç ä¸­çš„å®é™…ä¸´ç•ŒåŒºï¼Œå¹¶åœ¨åˆ é™¤ä»£ç ä¸­ä½¿ç”¨å…±åŒçš„é€€å‡ºè·¯å¾„ã€‚å‰è€…ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºéƒ¨åˆ†æŸ¥æ‰¾ä»£ç å®é™…ä¸Šæ— éœ€é”å®šï¼›å‡è®¾ malloc() å’Œprintfæœ¬èº«æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œé‚£ä¹ˆæ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è°ƒç”¨å®ƒï¼Œè€Œä¸å¿…æ‹…å¿ƒå‡ºç°ç«äº‰æ¡ä»¶æˆ–å…¶ä»–å¹¶å‘é”™è¯¯ã€‚åªæœ‰åœ¨æ›´æ–°å…±äº«åˆ—è¡¨æ—¶æ‰éœ€è¦åŠ é”ã€‚æœ‰å…³è¿™äº›ä¿®æ”¹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è§ä¸‹é¢è¿™æ®µä»£ç ã€‚ // basic node structure typedef struct __node_t { int key; struct __node_t *next; } node_t; // basic list structure (one used per list) typedef struct __list_t { node_t *head; pthread_mutex_t lock; } list_t; void List_Init(list_t *L) { L-\u003ehead = NULL; pthread_mutex_init(\u0026L-\u003elock, NULL); } int List_Insert(list_t *L, int key, int thread_id) { printf(\"Thread %d: Inserting %d\\n\", thread_id, key); node_t *new = malloc(sizeof(node_t)); if (new == NULL) { perror(\"malloc\"); pthread_mutex_unlock(\u0026L-\u003elock); return -1; // fail } new-\u003ekey = key; pthread_mutex_lock(\u0026L-\u003elock); new-\u003enext = L-\u003ehead; L-\u003ehead = new; pthread_mutex_unlock(\u0026L-\u003elock); return 0; // success } ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:2:1","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 æ‰©å±•é“¾è¡¨ è™½ç„¶æˆ‘ä»¬åˆæœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„å¹¶å‘é“¾è¡¨ï¼Œä½†æˆ‘ä»¬åˆä¸€æ¬¡é‡åˆ°äº†å®ƒä¸èƒ½å¾ˆå¥½æ‰©å±•çš„æƒ…å†µã€‚ä¸ºäº†åœ¨é“¾è¡¨ä¸­å®ç°æ›´å¤šå¹¶å‘æ€§ï¼Œç ”ç©¶äººå‘˜æ¢ç´¢äº†ä¸€ç§æŠ€æœ¯ï¼Œå³æ‰€è°“çš„ â€œæ‰‹æ‹‰æ‰‹é”å®šâ€ï¼ˆåˆç§° â€œé”è€¦åˆâ€ï¼‰ã€‚ è¿™ä¸ªæƒ³æ³•éå¸¸ç®€å•ã€‚ä½ å¯ä»¥ä¸ºé“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹æ·»åŠ ä¸€ä¸ªé”ï¼Œè€Œä¸æ˜¯ä¸ºæ•´ä¸ªé“¾è¡¨æ·»åŠ ä¸€ä¸ªé”ã€‚å½“éå†åˆ—è¡¨æ—¶ï¼Œä»£ç ä¼šå…ˆæŠ“å–ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„é”ï¼Œç„¶åé‡Šæ”¾å½“å‰èŠ‚ç‚¹çš„é”ï¼ˆè¿™å°±æ˜¯ hand-over-hand åç§°çš„ç”±æ¥ï¼‰ã€‚ ä»æ¦‚å¿µä¸Šè®²ï¼Œâ€œäº¤æ‰‹ â€œé“¾è¡¨æ˜¯æœ‰ä¸€å®šé“ç†çš„ï¼›å®ƒå¯ä»¥å®ç°é«˜åº¦å¹¶å‘çš„æ“ä½œã€‚ç„¶è€Œï¼Œåœ¨å®è·µä¸­ï¼Œè¿™ç§ç»“æ„å¾ˆéš¾æ¯”ç®€å•çš„å•é”æ–¹æ³•æ›´å¿«ï¼Œå› ä¸ºä¸ºéå†é“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹è·å–å’Œé‡Šæ”¾é”çš„å¼€é”€å¤ªå¤§ã€‚å³ä½¿æ˜¯éå¸¸å¤§çš„é“¾è¡¨å’Œå¤§é‡çš„çº¿ç¨‹ï¼Œå…è®¸å¤šä¸ªæ­£åœ¨è¿›è¡Œçš„éå†æ‰€å¸¦æ¥çš„å¹¶å‘æ€§ä¹Ÿä¸å¯èƒ½æ¯”ç®€å•åœ°è·å–å•é”ã€æ‰§è¡Œæ“ä½œå’Œé‡Šæ”¾é”æ›´å¿«ã€‚ä¹Ÿè®¸æŸç§æ··åˆæ–¹å¼ï¼ˆæ¯éš”å‡ ä¸ªèŠ‚ç‚¹å°±æŠ“å–ä¸€ä¸ªæ–°é”ï¼‰å€¼å¾—ç ”ç©¶ã€‚ TIPï¼šå¹¶å‘è¶Šå¤šä¸ä¸€å®šè¶Šå¿« å¦‚æœæ‚¨è®¾è®¡çš„æ–¹æ¡ˆå¢åŠ äº†å¾ˆå¤šå¼€é”€ï¼ˆä¾‹å¦‚ï¼Œé¢‘ç¹è·å–å’Œé‡Šæ”¾é”ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§ï¼‰ï¼Œé‚£ä¹ˆå®ƒæ›´å…·å¹¶å‘æ€§å¯èƒ½å°±ä¸é‡è¦äº†ã€‚ç®€å•çš„æ–¹æ¡ˆå¾€å¾€æ•ˆæœè‰¯å¥½ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå®ƒä»¬å¾ˆå°‘ä½¿ç”¨æ˜‚è´µçš„ä¾‹ç¨‹ã€‚å¢åŠ æ›´å¤šé”å’Œå¤æ‚æ€§å¯èƒ½ä¼šå¯¼è‡´å¤±è´¥ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæœ‰ä¸€ç§çœŸæ­£éœ€è¦äº†è§£çš„æ–¹æ³•ï¼šæ„å»ºä¸¤ç§æ›¿ä»£æ–¹æ¡ˆï¼ˆç®€å•ä½†å¹¶å‘æ€§è¾ƒä½ã€å¤æ‚ä½†å¹¶å‘æ€§è¾ƒé«˜ï¼‰å¹¶æµ‹é‡å®ƒä»¬çš„è¡¨ç°ã€‚æœ€ç»ˆï¼Œæ‚¨æ— æ³•åœ¨æ€§èƒ½ä¸Šä½œå¼Šï¼›æ‚¨çš„æƒ³æ³•è¦ä¹ˆæ›´å¿«ï¼Œè¦ä¹ˆä¸æ˜¯ã€‚ è­¦æƒ•é”å’Œæ§åˆ¶æµ ä¸€ä¸ªé€šç”¨çš„è®¾è®¡æç¤ºï¼Œåœ¨å¹¶å‘ä»£ç ä»¥åŠå…¶ä»–åœ°æ–¹éƒ½å¾ˆæœ‰ç”¨ï¼Œå°±æ˜¯è¦è­¦æƒ•å¯¼è‡´å‡½æ•°è¿”å›ã€é€€å‡ºæˆ–å…¶ä»–ç±»ä¼¼é”™è¯¯æ¡ä»¶ä»è€Œåœæ­¢å‡½æ•°æ‰§è¡Œçš„æ§åˆ¶æµå˜åŒ–ã€‚å› ä¸ºè®¸å¤šå‡½æ•°ä¼šé¦–å…ˆè·å–é”ã€åˆ†é…ä¸€äº›å†…å­˜æˆ–è¿›è¡Œå…¶ä»–ç±»ä¼¼çš„æœ‰çŠ¶æ€æ“ä½œï¼Œå½“å‡ºç°é”™è¯¯æ—¶ï¼Œä»£ç å¿…é¡»åœ¨è¿”å›ä¹‹å‰æ’¤é”€æ‰€æœ‰çŠ¶æ€ï¼Œè¿™æ ·å®¹æ˜“å‡ºé”™ã€‚å› æ­¤ï¼Œæœ€å¥½ç»“æ„åŒ–ä»£ç ä»¥æœ€å°åŒ–è¿™ç§æ¨¡å¼ã€‚ ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:2:2","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 å¹¶å‘é˜Ÿåˆ— æ­£å¦‚æ‚¨ç°åœ¨æ‰€çŸ¥ï¼Œåˆ¶ä½œå¹¶å‘æ•°æ®ç»“æ„æ€»æ˜¯æœ‰ä¸€ä¸ªæ ‡å‡†æ–¹æ³•ï¼šæ·»åŠ ä¸€ä¸ªå¤§é”ã€‚å¯¹äºé˜Ÿåˆ—ï¼Œæˆ‘ä»¬å°†è·³è¿‡è¯¥æ–¹æ³•ï¼Œå‡è®¾æ‚¨å¯ä»¥å¼„æ¸…æ¥šã€‚ ç›¸åï¼Œæˆ‘ä»¬å°†çœ‹ä¸€ä¸‹ç”± Michael å’Œ Scott è®¾è®¡çš„å¹¶å‘ç¨‹åº¦ç¨é«˜çš„é˜Ÿåˆ—ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ typedef struct __node_t { int value; struct __node_t *next; } node_t; typedef struct __queue_t { node_t *head; node_t *tail; pthread_mutex_t headLock; // Mutex for head pointer pthread_mutex_t tailLock; // Mutex for tail pointer } queue_t; // Initialize the queue void Queue_Init(queue_t *q) { // Allocate memory for a dummy node to represent the head of the queue node_t *tmp = malloc(sizeof(node_t)); tmp-\u003enext = NULL; // Initialize the head and tail pointers to the dummy node q-\u003ehead = q-\u003etail = tmp; // Initialize mutexes for head and tail pointers pthread_mutex_init(\u0026q-\u003eheadLock, NULL); pthread_mutex_init(\u0026q-\u003etailLock, NULL); } // Enqueue an element into the queue void Queue_Enqueue(queue_t *q, int value) { // Allocate memory for the new node node_t *tmp = malloc(sizeof(node_t)); assert(tmp != NULL); tmp-\u003evalue = value; tmp-\u003enext = NULL; // Acquire the tailLock mutex pthread_mutex_lock(\u0026q-\u003etailLock); // Insert the new node after the current tail node q-\u003etail-\u003enext = tmp; // Update the tail pointer to point to the new node q-\u003etail = tmp; // Release the tailLock mutex pthread_mutex_unlock(\u0026q-\u003etailLock); } // Dequeue an element from the queue int Queue_Dequeue(queue_t *q, int *value) { // Acquire the headLock mutex pthread_mutex_lock(\u0026q-\u003eheadLock); // Get the current head node node_t *tmp = q-\u003ehead; // Get the next node after the head node_t *newHead = tmp-\u003enext; // If the queue is empty (newHead is NULL), release the headLock mutex and return -1 if (newHead == NULL) { pthread_mutex_unlock(\u0026q-\u003eheadLock); return -1; // queue was empty } // Extract the value from the node to be dequeued *value = newHead-\u003evalue; // Update the head pointer to point to the next node q-\u003ehead = newHead; // Release the headLock mutex pthread_mutex_unlock(\u0026q-\u003eheadLock); // Free the memory of the dequeued node free(tmp); // Return 0 indicating successful dequeue operation return 0; } å¦‚æœä½ ä»”ç»†ç ”ç©¶è¿™æ®µä»£ç ï¼Œä½ ä¼šå‘ç°æœ‰ä¸¤ä¸ªé”ï¼Œä¸€ä¸ªç”¨äºé˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œä¸€ä¸ªç”¨äºé˜Ÿåˆ—çš„å°¾éƒ¨ã€‚è¿™ä¸¤ä¸ªé”çš„ç›®æ ‡æ˜¯å®ç°å…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œçš„å¹¶å‘ã€‚åœ¨å¸¸è§æƒ…å†µä¸‹ï¼Œå…¥é˜Ÿä¾‹ç¨‹å°†ä»…è®¿é—®å°¾éƒ¨é”ï¼Œè€Œå‡ºé˜Ÿåªä¼šè®¿é—®å¤´éƒ¨é”ã€‚ Michael å’Œ Scott ä½¿ç”¨çš„ä¸€ä¸ªæŠ€å·§æ˜¯æ·»åŠ ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼ˆåœ¨é˜Ÿåˆ—åˆå§‹åŒ–ä»£ç ä¸­åˆ†é…ï¼‰ï¼›è¿™ä¸ªè™šæ‹ŸèŠ‚ç‚¹å¯ä»¥å®ç°å¤´å°¾æ“ä½œçš„åˆ†ç¦»ã€‚ é˜Ÿåˆ—é€šå¸¸ç”¨åœ¨å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºä¸­ã€‚ç„¶è€Œï¼Œè¿™é‡Œä½¿ç”¨çš„é˜Ÿåˆ—ç±»å‹ï¼ˆä»…å¸¦æœ‰é”ï¼‰é€šå¸¸ä¸èƒ½å®Œå…¨æ»¡è¶³æ­¤ç±»ç¨‹åºçš„éœ€æ±‚ã€‚ä¸€ä¸ªæ›´å……åˆ†å¼€å‘çš„æœ‰ç•Œé˜Ÿåˆ—ï¼Œä½¿çº¿ç¨‹èƒ½å¤Ÿåœ¨é˜Ÿåˆ—ä¸ºç©ºæˆ–è¿‡æ»¡æ—¶ç­‰å¾…ï¼Œè¿™æ˜¯æ¡ä»¶å˜é‡å¯ä»¥åšåˆ°çš„äº‹æƒ…ã€‚ ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:3:0","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å¹¶å‘å“ˆå¸Œè¡¨ æœ€åï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸€ç§ç®€å•è€Œåˆå¹¿æ³›é€‚ç”¨çš„å¹¶å‘æ•°æ®ç»“æ„â€”å“ˆå¸Œè¡¨ã€‚æˆ‘ä»¬å°†é‡ç‚¹è®¨è®ºä¸€ä¸ªä¸è°ƒæ•´å¤§å°çš„ç®€å•å“ˆå¸Œè¡¨ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼›å¤„ç†è°ƒæ•´å¤§å°éœ€è¦åšæ›´å¤šçš„å·¥ä½œï¼Œæˆ‘ä»¬å°†å…¶ä½œä¸ºä¸€ä¸ªç»ƒä¹ ç•™ç»™è¯»è€…ï¼ˆæŠ±æ­‰ï¼ï¼‰ã€‚ #define BUCKETS (101) typedef struct __hash_t { list_t lists[BUCKETS]; } hash_t; void Hash_Init(hash_t *H) { int i; for (i = 0; i \u003c BUCKETS; i++) { List_Init(\u0026H-\u003elists[i]); } } int Hash_Insert(hash_t *H, int key, int thread_id) { int bucket = key % BUCKETS; return List_Insert(\u0026H-\u003elists[bucket], key, thread_id); } int Hash_Remove(hash_t *H, int key, int thread_id) { int bucket = key % BUCKETS; return List_Remove(\u0026H-\u003elists[bucket], key, thread_id); } è¿™ä¸ªå¹¶å‘å“ˆå¸Œè¡¨éå¸¸ç®€å•ï¼Œä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å¼€å‘çš„å¹¶å‘é“¾è¡¨æ„å»ºï¼Œè€Œä¸”è¿è¡Œå¾—éå¸¸å¥½ã€‚å®ƒä¹‹æ‰€ä»¥æ€§èƒ½å‡ºè‰²ï¼Œæ˜¯å› ä¸ºå®ƒæ²¡æœ‰ä¸ºæ•´ä¸ªç»“æ„è®¾ç½®ä¸€ä¸ªé”ï¼Œè€Œæ˜¯ä¸ºæ¯ä¸ªå“ˆå¸Œæ¡¶ï¼ˆæ¯ä¸ªå“ˆå¸Œæ¡¶ç”±ä¸€ä¸ªé“¾è¡¨è¡¨ç¤ºï¼‰è®¾ç½®äº†ä¸€ä¸ªé”ã€‚è¿™æ ·å°±å¯ä»¥è¿›è¡Œè®¸å¤šå¹¶å‘æ“ä½œã€‚ ä¸‹å›¾ æ˜¾ç¤ºäº†å“ˆå¸Œè¡¨åœ¨å¹¶å‘æ›´æ–°ä¸‹çš„æ€§èƒ½ï¼ˆåœ¨åŒä¸€å°é…å¤‡å››ä¸ª CPU çš„ iMac ç”µè„‘ä¸Šï¼Œå››ä¸ªçº¿ç¨‹çš„å¹¶å‘æ›´æ–°æ¬¡æ•°ä» 10,000 æ¬¡åˆ° 50,000 æ¬¡ä¸ç­‰ï¼‰ã€‚ä¸ºä¾¿äºæ¯”è¾ƒï¼Œå›¾ä¸­è¿˜æ˜¾ç¤ºäº†é“¾è¡¨çš„æ€§èƒ½ï¼ˆä½¿ç”¨å•é”ï¼‰ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªç®€å•çš„å¹¶å‘å“ˆå¸Œè¡¨çš„æ‰©å±•èƒ½åŠ›å¾ˆå¼ºï¼Œè€Œé“¾è¡¨åˆ™ä¸ç„¶ã€‚ é¿å…è¿‡æ—©ä¼˜åŒ–ï¼ˆKNUTHå®šå¾‹ï¼‰ åœ¨æ„å»ºå¹¶å‘æ•°æ®ç»“æ„æ—¶ï¼Œåº”ä»æœ€åŸºæœ¬çš„æ–¹æ³•å¼€å§‹ï¼Œå³æ·»åŠ ä¸€ä¸ªå¤§é”ä»¥æä¾›åŒæ­¥è®¿é—®ã€‚è¿™æ ·åšï¼Œä½ å°±æœ‰å¯èƒ½æ„å»ºä¸€ä¸ªæ­£ç¡®çš„é”ï¼›å¦‚æœä½ å‘ç°å®ƒå­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œä½ å¯ä»¥å¯¹å®ƒè¿›è¡Œæ”¹è¿›ï¼Œä»è€Œåœ¨å¿…è¦æ—¶ä½¿å®ƒå˜å¾—æ›´å¿«ã€‚æ­£å¦‚ Knuth çš„åè¨€ï¼šâ€œè¿‡æ—©ä¼˜åŒ–æ˜¯ä¸‡æ¶ä¹‹æºâ€ã€‚ åœ¨å‘å¤šå¤„ç†å™¨è¿‡æ¸¡ä¹‹åˆï¼Œè®¸å¤šæ“ä½œç³»ç»Ÿéƒ½ä½¿ç”¨å•é”ï¼ŒåŒ…æ‹¬ Sun OS å’Œ Linuxã€‚åœ¨åè€…ä¸­ï¼Œè¿™ç§é”ç”šè‡³æœ‰ä¸€ä¸ªåå­—ï¼Œå³å¤§å†…æ ¸é”ï¼ˆBKLï¼‰ã€‚å¤šå¹´æ¥ï¼Œè¿™ç§ç®€å•çš„æ–¹æ³•ä¸€ç›´å¾ˆå¥½ï¼Œä½†å½“å¤š CPU ç³»ç»Ÿæˆä¸ºå¸¸æ€æ—¶ï¼Œå†…æ ¸ä¸­æ¯æ¬¡åªå…è®¸ä¸€ä¸ªæ´»åŠ¨çº¿ç¨‹å°±æˆäº†æ€§èƒ½ç“¶é¢ˆã€‚å› æ­¤ï¼Œç»ˆäºåˆ°äº†ä¸ºè¿™äº›ç³»ç»Ÿæ·»åŠ æ”¹è¿›å¹¶å‘æ€§ä¼˜åŒ–çš„æ—¶å€™äº†ã€‚åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œé‡‡ç”¨äº†æ›´ç›´æ¥çš„æ–¹æ³•ï¼šç”¨å¤šä¸ªé”ä»£æ›¿ä¸€ä¸ªé”ã€‚è€Œåœ¨ Sun å†…éƒ¨ï¼Œåˆ™åšå‡ºäº†ä¸€ä¸ªæ›´æ¿€è¿›çš„å†³å®šï¼šå»ºç«‹ä¸€ä¸ªå…¨æ–°çš„æ“ä½œç³»ç»Ÿï¼Œå³ Solarisï¼Œä»ä¸€å¼€å§‹å°±ä»æ ¹æœ¬ä¸Šèå…¥å¹¶å‘æ€§ã€‚ ","date":"2024-05-11","objectID":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/:4:0","tags":["OS"],"title":"é”å®šæ•°æ®ç»“æ„","uri":"/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 é”ï¼šåŸºæœ¬æ€æƒ³ ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬çš„ä¸´ç•ŒåŒºå¦‚ä¸‹æ‰€ç¤ºï¼Œå…±äº«å˜é‡çš„è§„èŒƒæ›´æ–°ï¼š balance = balance + 1; å½“ç„¶ï¼Œå…¶ä»–ä¸´ç•ŒåŒºä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œä¾‹å¦‚å‘é“¾è¡¨æ·»åŠ å…ƒç´ æˆ–å¯¹å…±äº«ç»“æ„è¿›è¡Œå…¶ä»–æ›´å¤æ‚çš„æ›´æ–°ï¼Œä½†æˆ‘ä»¬ç°åœ¨åªä¿ç•™è¿™ä¸ªç®€å•çš„ç¤ºä¾‹ã€‚è¦ä½¿ç”¨é”ï¼Œæˆ‘ä»¬åœ¨ä¸´ç•ŒåŒºå‘¨å›´æ·»åŠ ä¸€äº›ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š lock_t mutex; // some globally-allocated lock â€™mutexâ€™ ... lock(\u0026mutex); balance = balance + 1; unlock(\u0026mutex); é”åªæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå› æ­¤è¦ä½¿ç”¨å®ƒï¼Œæ‚¨å¿…é¡»å£°æ˜æŸç§ç±»å‹çš„é”å˜é‡ï¼ˆä¾‹å¦‚ä¸Šé¢çš„mutexï¼‰ã€‚è¯¥é”å˜é‡ï¼ˆæˆ–ç®€ç§°â€œé”â€ï¼‰ä¿å­˜ä»»æ„æ—¶åˆ»é”çš„çŠ¶æ€ã€‚å®ƒè¦ä¹ˆå¯ç”¨ï¼ˆæˆ–æœªé”å®šæˆ–ç©ºé—²ï¼‰ï¼Œå› æ­¤æ²¡æœ‰çº¿ç¨‹æŒæœ‰è¯¥é”ï¼Œè¦ä¹ˆå·²è·å–ï¼ˆæˆ–é”å®šæˆ–æŒæœ‰ï¼‰ï¼Œå› æ­¤æ°å¥½æœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰è¯¥é”ï¼Œå¹¶ä¸”å¯èƒ½ä½äºä¸´ç•ŒåŒºä¸­ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨æ•°æ®ç±»å‹ä¸­å­˜å‚¨å…¶ä»–ä¿¡æ¯ï¼Œä¾‹å¦‚å“ªä¸ªçº¿ç¨‹æŒæœ‰é”ï¼Œæˆ–è€…ç”¨äºè·å–é”çš„é¡ºåºé˜Ÿåˆ—ï¼Œä½†æ­¤ç±»ä¿¡æ¯å¯¹é”çš„ç”¨æˆ·æ˜¯éšè—çš„ã€‚ lock() å’Œunlock() ä¾‹ç¨‹çš„è¯­ä¹‰å¾ˆç®€å•ã€‚è°ƒç”¨ä¾‹ç¨‹ lock() å°è¯•è·å–é”ï¼›å¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹æŒæœ‰è¯¥é”ï¼ˆå³å®ƒæ˜¯ç©ºé—²çš„ï¼‰ï¼Œåˆ™è¯¥çº¿ç¨‹å°†è·å–è¯¥é”å¹¶è¿›å…¥ä¸´ç•ŒåŒºï¼›è¯¥çº¿ç¨‹æœ‰æ—¶è¢«ç§°ä¸ºé”çš„æ‰€æœ‰è€…ã€‚å¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹éšåå¯¹åŒä¸€ä¸ªé”å˜é‡ï¼ˆæœ¬ä¾‹ä¸­ä¸ºmutexï¼‰è°ƒç”¨ lock()ï¼Œåˆ™å½“é”è¢«å¦ä¸€ä¸ªçº¿ç¨‹æŒæœ‰æ—¶ï¼Œå®ƒä¸ä¼šè¿”å›ï¼›è¿™æ ·ï¼Œå½“ç¬¬ä¸€ä¸ªæŒæœ‰é”çš„çº¿ç¨‹ä½äºä¸´ç•ŒåŒºæ—¶ï¼Œå…¶ä»–çº¿ç¨‹å°±æ— æ³•è¿›å…¥ä¸´ç•ŒåŒºã€‚ ä¸€æ—¦é”çš„æ‰€æœ‰è€…è°ƒç”¨unlock()ï¼Œé”å°±å†æ¬¡å¯ç”¨ï¼ˆç©ºé—²ï¼‰ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹æ­£åœ¨ç­‰å¾…é”ï¼ˆå³æ²¡æœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨lock() å¹¶è¢«å¡åœ¨å…¶ä¸­ï¼‰ï¼Œåˆ™é”çš„çŠ¶æ€å°†ç®€å•åœ°æ›´æ”¹ä¸ºç©ºé—²ã€‚å¦‚æœæœ‰ç­‰å¾…çº¿ç¨‹ï¼ˆå¡åœ¨ lock() ä¸­ï¼‰ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹å°†ï¼ˆæœ€ç»ˆï¼‰æ³¨æ„åˆ°ï¼ˆæˆ–è¢«å‘ŠçŸ¥ï¼‰é”çŠ¶æ€çš„è¿™ä¸€å˜åŒ–ï¼Œè·å–é”ï¼Œå¹¶è¿›å…¥ä¸´ç•ŒåŒºã€‚ é”ä¸ºç¨‹åºå‘˜æä¾›äº†å¯¹è°ƒåº¦çš„æœ€å°ç¨‹åº¦çš„æ§åˆ¶ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å°†çº¿ç¨‹è§†ä¸ºç”±ç¨‹åºå‘˜åˆ›å»ºä½†ç”±æ“ä½œç³»ç»Ÿä»¥æ“ä½œç³»ç»Ÿé€‰æ‹©çš„ä»»ä½•æ–¹å¼è°ƒåº¦çš„å®ä½“ã€‚é”å°†éƒ¨åˆ†æ§åˆ¶æƒäº¤è¿˜ç»™ç¨‹åºå‘˜ï¼›é€šè¿‡åœ¨ä¸€æ®µä»£ç å‘¨å›´æ”¾ç½®ä¸€ä¸ªé”ï¼Œç¨‹åºå‘˜å¯ä»¥ä¿è¯è¯¥ä»£ç ä¸­æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚å› æ­¤ï¼Œé”æœ‰åŠ©äºå°†ä¼ ç»Ÿæ“ä½œç³»ç»Ÿè°ƒåº¦çš„æ··ä¹±è½¬å˜ä¸ºæ›´å—æ§åˆ¶çš„æ´»åŠ¨ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:1:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 Pthread é” POSIX åº“ä¸ºé”ä½¿ç”¨çš„åç§°æ˜¯ mutexï¼Œå› ä¸ºå®ƒç”¨äºæä¾›çº¿ç¨‹ä¹‹é—´çš„äº’æ–¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹å¤„äºä¸´ç•ŒåŒºï¼Œå®ƒå°†ç¦æ­¢å…¶ä»–çº¿ç¨‹è¿›å…¥ï¼Œç›´åˆ°å®ƒå®Œæˆè¯¥ä¸´ç•ŒåŒºã€‚å› æ­¤ï¼Œå½“ä½ çœ‹åˆ°ä¸‹é¢çš„ POSIX çº¿ç¨‹ä»£ç æ—¶ï¼Œä½ åº”è¯¥æ˜ç™½å®ƒåœ¨åšä¸ä¸Šé¢ç›¸åŒçš„äº‹æƒ…ï¼ˆæˆ‘ä»¬å†æ¬¡ä½¿ç”¨æˆ‘ä»¬çš„å°è£…å™¨ï¼Œåœ¨é”å®šå’Œè§£é”æ—¶æ£€æŸ¥é”™è¯¯ï¼‰ï¼š pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER; Pthread_mutex_lock(\u0026lock); // wrapper; exits on failure balance = balance + 1; Pthread_mutex_unlock(\u0026lock); ä½ å¯èƒ½è¿˜ä¼šæ³¨æ„åˆ°ï¼ŒPOSIX ç‰ˆæœ¬ä¼šé€šè¿‡ä¼ é€’ä¸€ä¸ªå˜é‡æ¥åŠ é”å’Œè§£é”ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨ä¸åŒçš„é”æ¥ä¿æŠ¤ä¸åŒçš„å˜é‡ã€‚è¿™æ ·åšå¯ä»¥æé«˜å¹¶å‘æ€§ï¼šæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ä¸åŒçš„é”æ¥ä¿æŠ¤ä¸åŒçš„æ•°æ®å’Œæ•°æ®ç»“æ„ï¼Œè€Œä¸æ˜¯åœ¨è®¿é—®ä»»ä½•ä¸´ç•ŒåŒºæ—¶ä½¿ç”¨ä¸€ä¸ªå¤§é”ï¼ˆç²—ç²’åº¦é”å®šç­–ç•¥ï¼‰ï¼Œä»è€Œå…è®¸æ›´å¤šçº¿ç¨‹åŒæ—¶è¿›å…¥é”å®šä»£ç ï¼ˆæ›´ç»†ç²’åº¦çš„æ–¹æ³•ï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:2:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 è¯„ä¼°é”â€”åŸºæœ¬æ ‡å‡† åœ¨æ„å»ºä»»ä½•é”ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥äº†è§£æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Œå› æ­¤æˆ‘ä»¬ä¼šé—®å¦‚ä½•è¯„ä¼°ç‰¹å®šé”å®ç°çš„æœ‰æ•ˆæ€§ã€‚è¦è¯„ä¼°ä¸€ä¸ªé”æ˜¯å¦æœ‰æ•ˆï¼ˆè€Œä¸”æ•ˆæœå¾ˆå¥½ï¼‰ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥å»ºç«‹ä¸€äº›å¦‚ä¸‹çš„åŸºæœ¬æ ‡å‡†ã€‚ é¦–å…ˆæ˜¯é”æ˜¯å¦å®Œæˆäº†å®ƒçš„åŸºæœ¬ä»»åŠ¡ï¼Œå³æä¾›äº’æ–¥ã€‚åŸºæœ¬ä¸Šï¼Œé”æ˜¯å¦èƒ½é˜»æ­¢å¤šä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼Ÿ å…¶æ¬¡æ˜¯å…¬å¹³æ€§ã€‚ä¸€æ—¦é”è¢«é‡Šæ”¾ï¼Œæ¯ä¸ªäº‰å¤ºé”çš„çº¿ç¨‹æ˜¯å¦éƒ½èƒ½å…¬å¹³åœ°è·å¾—é”ï¼Ÿå¦ä¸€ç§æ–¹æ³•æ˜¯è€ƒå¯Ÿæ›´æç«¯çš„æƒ…å†µï¼šæ˜¯å¦æœ‰ä»»ä½•çº¿ç¨‹åœ¨äº‰å¤ºé”çš„è¿‡ç¨‹ä¸­é™·å…¥é¥¥é¥¿ï¼Œä»è€Œæ°¸è¿œæ— æ³•è·å¾—é”ï¼Ÿ æœ€åä¸€ä¸ªæ ‡å‡†æ˜¯æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨é”æ‰€å¢åŠ çš„æ—¶é—´å¼€é”€ã€‚è¿™é‡Œæœ‰å‡ ç§ä¸åŒçš„æƒ…å†µå€¼å¾—è€ƒè™‘ã€‚ ä¸€ç§æ˜¯æ— ç«äº‰çš„æƒ…å†µï¼›å½“å•çº¿ç¨‹è¿è¡Œå¹¶æŠ“å–å’Œé‡Šæ”¾é”æ—¶ï¼Œè¿™æ ·åšçš„å¼€é”€æ˜¯å¤šå°‘ï¼Ÿ å¦ä¸€ç§æƒ…å†µæ˜¯å¤šä¸ªçº¿ç¨‹åœ¨å•ä¸ª CPU ä¸Šäº‰å¤ºé”ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯å¦å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Ÿ æœ€åï¼Œå½“æ¶‰åŠå¤šä¸ª CPU ä¸”æ¯ä¸ª CPU ä¸Šçš„çº¿ç¨‹éƒ½åœ¨äº‰å¤ºé”æ—¶ï¼Œé”çš„æ€§èƒ½å¦‚ä½•ï¼Ÿ é€šè¿‡æ¯”è¾ƒè¿™äº›ä¸åŒçš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°äº†è§£ä½¿ç”¨å„ç§é”æŠ€æœ¯å¯¹æ€§èƒ½çš„å½±å“ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:3:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 æ§åˆ¶ä¸­æ–­ æœ€æ—©ç”¨äºæä¾›äº’æ–¥çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€æ˜¯ç¦ç”¨ä¸´ç•ŒåŒºçš„ä¸­æ–­ï¼›è¿™ç§è§£å†³æ–¹æ¡ˆæ˜¯ä¸ºå•å¤„ç†å™¨ç³»ç»Ÿå‘æ˜çš„ã€‚ä»£ç å¦‚ä¸‹ void lock() { DisableInterrupts(); } void unlock() { EnableInterrupts(); } å‡è®¾æˆ‘ä»¬æ­£åœ¨è¿™æ ·çš„å•å¤„ç†å™¨ç³»ç»Ÿä¸Šè¿è¡Œã€‚é€šè¿‡åœ¨è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰å…³é—­ä¸­æ–­ï¼ˆä½¿ç”¨æŸç§ç‰¹æ®Šçš„ç¡¬ä»¶æŒ‡ä»¤ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿ä¸´ç•ŒåŒºå†…çš„ä»£ç ä¸ä¼šè¢«ä¸­æ–­ï¼Œä»è€ŒåƒåŸå­ä¸€æ ·æ‰§è¡Œã€‚å½“æˆ‘ä»¬å®Œæˆåï¼Œæˆ‘ä»¬é‡æ–°å¯ç”¨ä¸­æ–­ï¼ˆå†æ¬¡é€šè¿‡ç¡¬ä»¶æŒ‡ä»¤ï¼‰ï¼Œå› æ­¤ç¨‹åºç…§å¸¸è¿›è¡Œã€‚ è¿™ç§æ–¹æ³•çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å®ƒçš„ç®€å•æ€§ã€‚å½“ç„¶ï¼Œæ‚¨ä¸å¿…ç»å°½è„‘æ±å°±èƒ½å¼„æ¸…æ¥šä¸ºä»€ä¹ˆä¼šè¿™æ ·ã€‚åœ¨æ²¡æœ‰ä¸­æ–­çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹å¯ä»¥ç¡®ä¿å®ƒæ‰§è¡Œçš„ä»£ç å°†ä¼šæ‰§è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–çº¿ç¨‹ä¼šå¹²æ‰°å®ƒã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè´Ÿé¢å› ç´ æœ‰å¾ˆå¤šã€‚é¦–å…ˆï¼Œè¿™ç§æ–¹æ³•è¦æ±‚æˆ‘ä»¬å…è®¸ä»»ä½•è°ƒç”¨çº¿ç¨‹æ‰§è¡Œç‰¹æƒæ“ä½œï¼ˆæ‰“å¼€å’Œå…³é—­ä¸­æ–­ï¼‰ï¼Œå› æ­¤ç›¸ä¿¡è¯¥è®¾æ–½ä¸ä¼šè¢«æ»¥ç”¨ã€‚æ­£å¦‚æ‚¨æ‰€çŸ¥ï¼Œæ¯å½“æˆ‘ä»¬éœ€è¦ä¿¡ä»»ä»»æ„ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬éƒ½å¯èƒ½é‡åˆ°éº»çƒ¦ã€‚åœ¨è¿™é‡Œï¼Œé—®é¢˜ä»¥å¤šç§æ–¹å¼è¡¨ç°å‡ºæ¥ï¼šè´ªå©ªçš„ç¨‹åºå¯ä»¥åœ¨æ‰§è¡Œå¼€å§‹æ—¶è°ƒç”¨lock()ï¼Œä»è€Œç‹¬å å¤„ç†å™¨ï¼›æ›´ç³Ÿç³•çš„æ˜¯ï¼Œé”™è¯¯æˆ–æ¶æ„ç¨‹åºå¯èƒ½è°ƒç”¨ lock() å¹¶è¿›å…¥æ— é™å¾ªç¯ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿæ°¸è¿œä¸ä¼šé‡æ–°è·å¾—å¯¹ç³»ç»Ÿçš„æ§åˆ¶ï¼Œåªæœ‰ä¸€ä¸ªåŠæ³•ï¼šé‡æ–°å¯åŠ¨ç³»ç»Ÿã€‚ä½¿ç”¨ä¸­æ–­ç¦ç”¨ä½œä¸ºé€šç”¨åŒæ­¥è§£å†³æ–¹æ¡ˆéœ€è¦å¯¹åº”ç”¨ç¨‹åºè¿‡å¤šçš„ä¿¡ä»»ã€‚ å…¶æ¬¡ï¼Œè¯¥æ–¹æ³•ä¸é€‚ç”¨äºå¤šå¤„ç†å™¨ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹è¿è¡Œåœ¨ä¸åŒçš„CPUä¸Šï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½å°è¯•è¿›å…¥åŒä¸€ä¸ªä¸´ç•ŒåŒºï¼Œé‚£ä¹ˆæ˜¯å¦ç¦ç”¨ä¸­æ–­å¹¶ä¸é‡è¦ï¼›çº¿ç¨‹å°†èƒ½å¤Ÿåœ¨å…¶ä»–å¤„ç†å™¨ä¸Šè¿è¡Œï¼Œå› æ­¤å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºã€‚ç”±äºå¤šå¤„ç†å™¨ç°åœ¨å¾ˆå¸¸è§ï¼Œæˆ‘ä»¬çš„é€šç”¨è§£å†³æ–¹æ¡ˆå¿…é¡»æ¯”è¿™åšå¾—æ›´å¥½ã€‚ ç¬¬ä¸‰ï¼Œé•¿æ—¶é—´å…³é—­ä¸­æ–­å¯èƒ½ä¼šå¯¼è‡´ä¸­æ–­ä¸¢å¤±ï¼Œä»è€Œå¯¼è‡´ä¸¥é‡çš„ç³»ç»Ÿé—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœ CPU é”™è¿‡äº†ç£ç›˜è®¾å¤‡å·²å®Œæˆè¯»å–è¯·æ±‚çš„äº‹å®ã€‚æ“ä½œç³»ç»Ÿå¦‚ä½•çŸ¥é“å”¤é†’ç­‰å¾…æ‰€è¿°è¯»å–çš„è¿›ç¨‹ï¼Ÿ æœ€åï¼Œä¹Ÿè®¸ä¹Ÿæ˜¯æœ€ä¸é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½æ•ˆç‡ä½ä¸‹ã€‚ä¸æ­£å¸¸æŒ‡ä»¤æ‰§è¡Œç›¸æ¯”ï¼Œç°ä»£ CPU æ‰§è¡Œå±è”½æˆ–å–æ¶ˆå±è”½ä¸­æ–­çš„ä»£ç å¾€å¾€æ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢ã€‚ ç”±äºè¿™äº›åŸå› ï¼Œå…³é—­ä¸­æ–­ä»…åœ¨æœ‰é™çš„ä¸Šä¸‹æ–‡ä¸­ç”¨ä½œäº’æ–¥åŸè¯­ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿæœ¬èº«å°†ä½¿ç”¨ä¸­æ–­å±è”½æ¥ä¿è¯è®¿é—®å…¶è‡ªå·±çš„æ•°æ®ç»“æ„æ—¶çš„åŸå­æ€§ï¼Œæˆ–è€…è‡³å°‘é˜²æ­¢å‡ºç°æŸäº›æ··ä¹±çš„ä¸­æ–­å¤„ç†æƒ…å†µã€‚è¿™ç§ç”¨æ³•æ˜¯æœ‰é“ç†çš„ï¼Œå› ä¸ºä¿¡ä»»é—®é¢˜åœ¨æ“ä½œç³»ç»Ÿå†…éƒ¨æ¶ˆå¤±äº†ï¼Œæ“ä½œç³»ç»Ÿå§‹ç»ˆç›¸ä¿¡è‡ªå·±èƒ½å¤Ÿæ‰§è¡Œç‰¹æƒæ“ä½œã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:4:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 å¤±è´¥çš„å°è¯•ï¼šä»…ä½¿ç”¨åŠ è½½/å­˜å‚¨ è¦æƒ³è¶…è¶ŠåŸºäºä¸­æ–­çš„æŠ€æœ¯ï¼Œæˆ‘ä»¬å°±å¿…é¡»ä¾é  CPU ç¡¬ä»¶åŠå…¶æä¾›çš„æŒ‡ä»¤æ¥æ„å»ºé€‚å½“çš„é”ã€‚è®©æˆ‘ä»¬é¦–å…ˆå°è¯•ä½¿ç”¨ä¸€ä¸ªæ ‡å¿—å˜é‡æ¥æ„å»ºä¸€ä¸ªç®€å•çš„é”ã€‚åœ¨è¿™æ¬¡å¤±è´¥çš„å°è¯•ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ„å»ºé”æ‰€éœ€çš„ä¸€äº›åŸºæœ¬æ€æƒ³ï¼Œå¹¶æ˜ç™½ä¸ºä»€ä¹ˆä»…ä»…ä½¿ç”¨å•ä¸ªå˜é‡å¹¶é€šè¿‡æ­£å¸¸çš„åŠ è½½å’Œå­˜å‚¨æ¥è®¿é—®å®ƒæ˜¯ä¸å¤Ÿçš„ã€‚ ç¬¬ä¸€æ¬¡å°è¯•çš„ä»£ç å¦‚ä¸‹ï¼š typedef struct __lock_t { int flag; } lock_t; void init(lock_t *mutex) { // 0 -\u003e lock is available, 1 -\u003e held mutex-\u003eflag = 0; } void lock(lock_t *mutex) { while (mutex-\u003eflag == 1) // TEST the flag ; // spin-wait (do nothing) mutex-\u003eflag = 1; // now SET it! } void unlock(lock_t *mutex) { mutex-\u003eflag = 0; } åœ¨ç¬¬ä¸€æ¬¡å°è¯•ä¸­ï¼Œæˆ‘ä»¬çš„æƒ³æ³•éå¸¸ç®€å•ï¼šä½¿ç”¨ä¸€ä¸ªç®€å•çš„å˜é‡ï¼ˆflagï¼‰æ¥æŒ‡ç¤ºæŸä¸ªçº¿ç¨‹æ˜¯å¦æ‹¥æœ‰é”ã€‚è¿›å…¥ä¸´ç•ŒåŒºçš„ç¬¬ä¸€ä¸ªçº¿ç¨‹å°†è°ƒç”¨ lock()ï¼Œå®ƒå°†æµ‹è¯•flagæ˜¯å¦ç­‰äº 1ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ç­‰äº 1ï¼‰ï¼Œç„¶åå°†flagè®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºè¯¥çº¿ç¨‹ç°åœ¨æŒæœ‰é”ã€‚å®Œæˆä¸´ç•ŒåŒºåï¼Œçº¿ç¨‹ä¼šè°ƒç”¨ unlock() å¹¶æ¸…é™¤flagï¼Œä»è€Œè¡¨æ˜ä¸å†æŒæœ‰é”ã€‚ å¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹åœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹å¤„äºä¸´ç•ŒåŒºæ—¶è°ƒç”¨äº† lock()ï¼Œé‚£ä¹ˆå®ƒåªéœ€åœ¨ while å¾ªç¯ä¸­è‡ªæ—‹ç­‰å¾…è¯¥çº¿ç¨‹è°ƒç”¨ unlock()å¹¶æ¸…é™¤flagã€‚ä¸€æ—¦ç¬¬ä¸€ä¸ªçº¿ç¨‹è¿™æ ·åšäº†ï¼Œç­‰å¾…çš„çº¿ç¨‹å°±ä¼šé€€å‡º while å¾ªç¯ï¼Œå°†è‡ªå·±çš„flagè®¾ç½®ä¸º 1ï¼Œç„¶åè¿›å…¥ä¸´ç•ŒåŒºã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè¯¥ä»£ç æœ‰ä¸¤ä¸ªé—®é¢˜ï¼šä¸€ä¸ªæ˜¯æ­£ç¡®æ€§ï¼Œå¦ä¸€ä¸ªæ˜¯æ€§èƒ½ã€‚ä¸€æ—¦æ‚¨ä¹ æƒ¯äºæ€è€ƒå¹¶å‘ç¼–ç¨‹ï¼Œæ­£ç¡®æ€§é—®é¢˜å°±å¾ˆå®¹æ˜“çœ‹å‡ºã€‚æƒ³è±¡ä¸€ä¸‹ä¸‹é¢çš„çš„ä»£ç äº¤é”™ï¼›å‡è®¾ flag=0 å¼€å§‹ã€‚ æ­£å¦‚æ‚¨ä»è¿™ç§äº¤é”™ä¸­çœ‹åˆ°çš„ï¼Œé€šè¿‡åŠæ—¶ï¼ˆä¸åŠæ—¶ï¼Ÿï¼‰ä¸­æ–­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°äº§ç”Ÿè¿™æ ·ä¸€ç§æƒ…å†µï¼šä¸¤ä¸ªçº¿ç¨‹éƒ½å°†flagè®¾ç½®ä¸º 1ï¼Œå› æ­¤ä¸¤ä¸ªçº¿ç¨‹éƒ½èƒ½è¿›å…¥ä¸´ç•ŒåŒºã€‚æˆ‘ä»¬æ˜¾ç„¶æ²¡æœ‰æ»¡è¶³æœ€åŸºæœ¬çš„è¦æ±‚**ï¼šæä¾›äº’æ–¥**ã€‚ æˆ‘ä»¬ç¨åå°†è¯¦ç»†è®¨è®ºçš„æ€§èƒ½é—®é¢˜æ˜¯çº¿ç¨‹ç­‰å¾…è·å–å·²æŒæœ‰çš„é”çš„æ–¹å¼ï¼šå®ƒæ— ä¼‘æ­¢åœ°æ£€æŸ¥flagçš„å€¼ï¼Œè¿™æ˜¯ä¸€ç§ç§°ä¸ºè‡ªæ—‹ç­‰å¾…çš„æŠ€æœ¯ã€‚è‡ªæ—‹ç­‰å¾…ä¼šæµªè´¹æ—¶é—´ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”ã€‚åœ¨å•å¤„ç†å™¨ä¸Šæµªè´¹éå¸¸é«˜ï¼Œå…¶ä¸­ç­‰å¾…è€…æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ç”šè‡³æ— æ³•è¿è¡Œï¼ˆè‡³å°‘åœ¨å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ä¹‹å‰ï¼‰ï¼ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:5:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 ç”¨Test-And-Setæ„å»ºå·¥ä½œè‡ªæ—‹é” ç”±äºç¦ç”¨ä¸­æ–­åœ¨å¤šå¤„ç†å™¨ä¸Šä¸èµ·ä½œç”¨ï¼Œè€Œä¸”ä½¿ç”¨åŠ è½½å’Œå­˜å‚¨ï¼ˆå¦‚ä¸Šæ‰€ç¤ºï¼‰çš„ç®€å•æ–¹æ³•ä¹Ÿä¸èµ·ä½œç”¨ï¼Œç³»ç»Ÿè®¾è®¡äººå‘˜å¼€å§‹å‘æ˜ç¡¬ä»¶æ”¯æŒé”å®šã€‚æœ€æ—©çš„å¤šå¤„ç†å™¨ç³»ç»Ÿï¼Œå¦‚ 20 ä¸–çºª 60 å¹´ä»£åˆçš„ Burroughs B5000ï¼Œå°±æä¾›äº†è¿™ç§æ”¯æŒï¼›å¦‚ä»Šï¼Œæ‰€æœ‰ç³»ç»Ÿéƒ½æä¾›äº†è¿™ç§æ”¯æŒï¼Œå³ä½¿æ˜¯å• CPU ç³»ç»Ÿä¹Ÿä¸ä¾‹å¤–ã€‚ æœ€ç®€å•æ˜“æ‡‚çš„ç¡¬ä»¶æ”¯æŒè¢«ç§°ä¸ºtest-and-setï¼ˆæˆ–åŸå­äº¤æ¢ï¼‰æŒ‡ä»¤ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ C ä»£ç ç‰‡æ®µæ¥å®šä¹‰ test-and-set æŒ‡ä»¤çš„ä½œç”¨ï¼š int TestAndSet(int *old_ptr, int new) { int old = *old_ptr; // fetch old value at old_ptr *old_ptr = new; // store â€™newâ€™ into old_ptr return old; // return the old value } test-and-setæŒ‡ä»¤çš„ä½œç”¨å¦‚ä¸‹ã€‚å®ƒè¿”å› ptr æŒ‡å‘çš„oldï¼ŒåŒæ—¶å°†æ‰€è¿°å€¼æ›´æ–°ä¸ºnewã€‚å½“ç„¶ï¼Œå…³é”®åœ¨äºè¿™ä¸€ç³»åˆ—æ“ä½œéƒ½æ˜¯ä»¥åŸå­æ–¹å¼æ‰§è¡Œçš„ã€‚ä¹‹æ‰€ä»¥ç§°ä¸º â€œtest-and-setâ€ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥ â€œtest â€œæ—§å€¼ï¼ˆå³è¿”å›å€¼ï¼‰ï¼ŒåŒæ—¶å°†å†…å­˜ä½ç½® â€œè®¾ç½® â€œä¸ºæ–°å€¼ï¼›äº‹å®è¯æ˜ï¼Œè¿™æ¡åŠŸèƒ½ç¨å¼ºçš„æŒ‡ä»¤è¶³ä»¥æ„å»ºä¸€ä¸ªç®€å•çš„è‡ªæ—‹é”ï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºã€‚ typedef struct __lock_t { int flag; } lock_t; void init(lock_t *lock) { // 0: lock is available, 1: lock is held lock-\u003eflag = 0; } void lock(lock_t *lock) { while (TestAndSet(\u0026lock-\u003eflag, 1) == 1) ; // spin-wait (do nothing) } void unlock(lock_t *lock) { lock-\u003eflag = 0; } è®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹è¿™ç§é”çš„å·¥ä½œåŸç†ã€‚é¦–å…ˆè®¾æƒ³è¿™æ ·ä¸€ç§æƒ…å†µï¼šçº¿ç¨‹è°ƒç”¨ lock() è€Œå½“å‰æ²¡æœ‰å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼›å› æ­¤ï¼Œflag åº”ä¸º 0ã€‚å½“çº¿ç¨‹è°ƒç”¨ TestAndSet(flag, 1) æ—¶ï¼Œä¾‹ç¨‹å°†è¿”å› flag çš„æ—§å€¼ï¼Œå³ 0ï¼›å› æ­¤ï¼Œæ­£åœ¨æµ‹è¯• flag å€¼çš„è°ƒç”¨çº¿ç¨‹ä¸ä¼šé™·å…¥ while å¾ªç¯çš„è‡ªæ—‹ï¼Œå¹¶å°†è·å¾—é”ã€‚çº¿ç¨‹ä¹Ÿä¼šåŸå­åœ°å°†è¯¥å€¼è®¾ç½®ä¸º 1ï¼Œä»è€Œè¡¨æ˜é”å·²è¢«é”å®šã€‚å½“çº¿ç¨‹å®Œæˆå…¶ä¸´ç•ŒåŒºåï¼Œä¼šè°ƒç”¨ unlock() å°†flagç½®å› 0ã€‚ æˆ‘ä»¬å¯ä»¥æƒ³è±¡çš„ç¬¬äºŒç§æƒ…å†µæ˜¯ï¼Œä¸€ä¸ªçº¿ç¨‹å·²ç»æŒæœ‰é”ï¼ˆå³flagä¸º 1ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥çº¿ç¨‹å°†è°ƒç”¨ lock() å¹¶è°ƒç”¨ TestAndSet(flag,1)ã€‚è¿™ä¸€æ¬¡ï¼ŒTestAndSet() å°†è¿”å› flag çš„æ—§å€¼ï¼Œå³ 1ï¼ˆå› ä¸ºé”å·²è¢«æŒæœ‰ï¼‰ï¼ŒåŒæ—¶å†æ¬¡å°†å…¶è®¾ç½®ä¸º 1ã€‚åªè¦é”è¢«å¦ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼ŒTestAndSet() å°±ä¼šåå¤è¿”å› 1ï¼Œå› æ­¤è¿™ä¸ªçº¿ç¨‹ä¼šè‡ªæ—‹ï¼Œç›´åˆ°é”æœ€ç»ˆè¢«é‡Šæ”¾ã€‚å½“flagæœ€ç»ˆè¢«å…¶ä»–çº¿ç¨‹è®¾ç½®ä¸º 0 æ—¶ï¼Œè¯¥çº¿ç¨‹å°†å†æ¬¡è°ƒç”¨ TestAndSet()ï¼Œæ­¤æ—¶å®ƒå°†è¿”å› 0ï¼ŒåŒæ—¶åŸå­åœ°å°†è¯¥å€¼è®¾ç½®ä¸º 1ï¼Œä»è€Œè·å¾—é”å¹¶è¿›å…¥ä¸´ç•ŒåŒºã€‚ é€šè¿‡å°†testï¼ˆæ—§é”å€¼ï¼‰å’Œ setï¼ˆæ–°é”å€¼ï¼‰ä½œä¸ºå•ä¸ªåŸå­æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—é”ã€‚è¿™å°±æ˜¯æ„å»ºäº’æ–¥åŸè¯­çš„æ–¹æ³•ï¼ ç°åœ¨ä½ å¯èƒ½ä¹Ÿæ˜ç™½ä¸ºä»€ä¹ˆè¿™ç§é”é€šå¸¸è¢«ç§°ä¸ºè‡ªæ—‹é”äº†ã€‚å®ƒæ˜¯æœ€ç®€å•çš„ä¸€ç§é”ï¼Œåªéœ€ä½¿ç”¨ CPU å‘¨æœŸæ—‹ è½¬ï¼Œç›´åˆ°é”å¯ç”¨ä¸ºæ­¢ã€‚è¦åœ¨å•å¤„ç†å™¨ä¸Šæ­£å¸¸å·¥ä½œï¼Œå®ƒéœ€è¦ä¸€ä¸ªæŠ¢å å¼è°ƒåº¦ç¨‹åºï¼ˆå³é€šè¿‡å®šæ—¶å™¨ä¸­æ–­çº¿ç¨‹ï¼Œä»¥ä¾¿ä¸æ—¶è¿è¡Œä¸åŒçš„çº¿ç¨‹ï¼‰ã€‚å¦‚æœæ²¡æœ‰æŠ¢å å¼è°ƒåº¦ï¼Œè‡ªæ—‹é”åœ¨å• CPU ä¸Šçš„æ„ä¹‰å°±ä¸å¤§ï¼Œå› ä¸ºåœ¨ CPU ä¸Šæ—‹è½¬çš„çº¿ç¨‹æ°¸è¿œä¸ä¼šæ”¾å¼ƒè‡ªæ—‹é”ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:6:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 è¯„ä¼°è‡ªæ—‹é” æœ‰äº†åŸºæœ¬çš„è‡ªæ—‹é”ï¼Œæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥æ ¹æ®ä¹‹å‰æè¿°çš„æ ‡å‡†æ¥è¯„ä¼°å®ƒçš„æœ‰æ•ˆæ€§ã€‚é”æœ€é‡è¦çš„æ–¹é¢æ˜¯æ­£ç¡®æ€§ï¼šå®ƒèƒ½æä¾›äº’æ–¥å—ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼šè‡ªæ—‹é”æ¯æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ‹¥æœ‰ä¸€ä¸ªæ­£ç¡®çš„é”ã€‚ ä¸‹ä¸€ä¸ªæ ‡å‡†æ˜¯å…¬å¹³æ€§ã€‚è‡ªæ—‹é”å¯¹ç­‰å¾…çº¿ç¨‹çš„å…¬å¹³æ€§å¦‚ä½•ï¼Ÿä½ èƒ½ä¿è¯ç­‰å¾…çº¿ç¨‹æ°¸è¿œä¸ä¼šè¿›å…¥ä¸´ç•ŒåŒºå—ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œè‡ªæ—‹é”ä¸æä¾›ä»»ä½•å…¬å¹³æ€§ä¿è¯ã€‚äº‹å®ä¸Šï¼Œä¸€ä¸ªæ­£åœ¨è‡ªæ—‹çš„çº¿ç¨‹å¯èƒ½ä¼šåœ¨ç«äº‰ä¸­æ°¸è¿œè‡ªæ—‹ä¸‹å»ã€‚ç®€å•çš„è‡ªæ—‹é”ï¼ˆå¦‚å‰é¢æ‰€è®¨è®ºçš„ï¼‰æ˜¯ä¸å…¬å¹³çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´é¥¥é¥¿ã€‚ æœ€åä¸€ä¸ªæ ‡å‡†æ˜¯æ€§èƒ½ã€‚ä½¿ç”¨è‡ªæ—‹é”çš„ä»£ä»·æ˜¯ä»€ä¹ˆï¼Ÿä¸ºäº†æ›´ä»”ç»†åœ°åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å»ºè®®è€ƒè™‘å‡ ç§ä¸åŒçš„æƒ…å†µã€‚ ç¬¬ä¸€ç§æƒ…å†µæ˜¯çº¿ç¨‹åœ¨å•ä¸ªå¤„ç†å™¨ä¸Šç«äº‰é”ï¼› å¯¹äºè‡ªæ—‹é”ï¼Œåœ¨å• CPU çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½å¼€é”€å¯èƒ½ä¼šç›¸å½“å¤§ï¼›æƒ³è±¡ä¸€ä¸‹æŒæœ‰é”çš„çº¿ç¨‹åœ¨ä¸´ç•ŒåŒºè¢«æŠ¢å çš„æƒ…å†µã€‚ç„¶åï¼Œè°ƒåº¦ç¨‹åºå¯èƒ½ä¼šè¿è¡Œæ¯ä¸ªå…¶ä»–çº¿ç¨‹ï¼ˆå‡è®¾æœ‰ N - 1 ä¸ªå…¶ä»–çº¿ç¨‹ï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½è¯•å›¾è·å–é”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æ”¾å¼ƒ CPU ä¹‹å‰éƒ½ä¼šæŒç»­è¿è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œæµªè´¹äº† CPU å‘¨æœŸã€‚ ç¬¬äºŒç§æƒ…å†µæ˜¯çº¿ç¨‹åˆ†å¸ƒåœ¨å¤šä¸ª CPU ä¸Šã€‚ ç„¶è€Œï¼Œåœ¨å¤šä¸ª CPU ä¸Šï¼Œè‡ªæ—‹é”å·¥ä½œå¾—ç›¸å½“å¥½ï¼ˆå¦‚æœçº¿ç¨‹æ•°å¤§è‡´ç­‰äº CPU æ•°ï¼‰ã€‚æ€è·¯å¦‚ä¸‹ï¼šæƒ³è±¡ CPU 1 ä¸Šçš„çº¿ç¨‹ A å’Œ CPU 2 ä¸Šçš„çº¿ç¨‹ Bï¼Œä¸¤è€…éƒ½ç«äº‰é”ã€‚å¦‚æœçº¿ç¨‹ A (CPU 1) è·å–é”ï¼Œç„¶åçº¿ç¨‹ B å°è¯•è·å–é”ï¼Œåˆ™ B å°†è‡ªæ—‹ï¼ˆåœ¨ CPU 2 ä¸Šï¼‰ã€‚ç„¶è€Œï¼Œå¤§æ¦‚ä¸´ç•ŒåŒºå¾ˆçŸ­ï¼Œå› æ­¤é”å¾ˆå¿«å°±å˜å¾—å¯ç”¨ï¼Œå¹¶è¢«çº¿ç¨‹ B è·å–ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡ªæ—‹ç­‰å¾…å¦ä¸€ä¸ªå¤„ç†å™¨ä¸ŠæŒæœ‰çš„é”ä¸ä¼šæµªè´¹å¾ˆå¤šå‘¨æœŸï¼Œå› æ­¤å¯èƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:7:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 Compare-And-Swap æŸäº›ç³»ç»Ÿæä¾›çš„å¦ä¸€ç§ç¡¬ä»¶åŸè¯­è¢«ç§°ä¸º **â€œcompare-and-swap â€œ**æŒ‡ä»¤ï¼ˆä¾‹å¦‚ SPARC ä¸Šçš„åç§°ï¼‰æˆ– **â€œcompare-and-exchange â€œ**æŒ‡ä»¤ï¼ˆx86 ä¸Šçš„åç§°ï¼‰ã€‚ä¸‹é¢æ˜¯è¿™æ¡æŒ‡ä»¤çš„ C è¯­è¨€ä¼ªä»£ç ã€‚ int CompareAndSwap(int *ptr, int expected, int new) { int actual = *ptr; if (actual == expected) *ptr = new; return actual; } å…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼Œcompare-and-swapæŒ‡ä»¤æµ‹è¯• ptr æŒ‡å®šåœ°å€ä¸Šçš„å€¼æ˜¯å¦ç­‰äºé¢„æœŸå€¼ï¼›å¦‚æœæ˜¯ï¼Œåˆ™ç”¨æ–°å€¼æ›´æ–° ptr æŒ‡å‘çš„å†…å­˜ä½ç½®ã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œéƒ½ä¼šè¿”å›è¯¥å†…å­˜ä½ç½®çš„å®é™…å€¼ï¼Œä»è€Œè®©è°ƒç”¨compare-and-swapæŒ‡ä»¤çš„ä»£ç çŸ¥é“å®ƒæ˜¯å¦æˆåŠŸã€‚ æœ‰äº†compare-and-swapæŒ‡ä»¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸test-and-setæŒ‡ä»¤ç±»ä¼¼çš„æ–¹å¼å»ºç«‹é”ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„ lock() ä¾‹ç¨‹æ›¿æ¢ä¸ºä¸‹é¢çš„ä¾‹ç¨‹ï¼š void lock(lock_t *lock) { while (CompareAndSwap(\u0026lock-\u003eflag, 0, 1) == 1) ; // spin } ä»£ç çš„å…¶ä½™éƒ¨åˆ†ä¸ä¸Šé¢çš„test-and-setç¤ºä¾‹ç›¸åŒã€‚è¿™æ®µä»£ç çš„å·¥ä½œåŸç†éå¸¸ç›¸ä¼¼ï¼›å®ƒåªéœ€æ£€æŸ¥flagæ˜¯å¦ä¸º 0ï¼Œå¦‚æœä¸º 0ï¼Œåˆ™åŸå­äº¤æ¢ 1ï¼Œä»è€Œè·å–é”ã€‚å¦‚æœçº¿ç¨‹è¯•å›¾åœ¨é”è¢«é”å®šæ—¶è·å–é”ï¼Œå°±ä¼šè¢«å¡ä½ï¼Œç›´åˆ°é”æœ€ç»ˆè¢«é‡Šæ”¾ã€‚ ä¸‹é¢æ˜¯å®é™… C ä»£ç ï¼ˆè°ƒç”¨æ±‡ç¼–ï¼‰x86ç‰ˆæœ¬ä¸­æ˜¾ç¤ºçš„compare-and-swapçš„ç®€å•ç¤ºä¾‹ã€‚ #include \u003cstdio.h\u003e int global = 0; // Function to perform a compare and swap operation // Parameters: // ptr: pointer to the memory location where the operation will be performed // old: expected value to compare against // new: new value to store if the comparison succeeds // Returns: // 1 if the comparison succeeded and the value was updated, 0 otherwise char compare_and_swap(int *ptr, int old, int new) { unsigned char ret; // Assembly code to perform the compare and swap operation // Note: sete sets a byte not the word __asm__ __volatile__ ( \" lock\\n\" \" cmpxchgl %2,%1\\n\" \" sete %0\\n\" : \"=q\" (ret), \"=m\" (*ptr) : \"r\" (new), \"m\" (*ptr), \"a\" (old) : \"memory\"); return ret; } int main(int argc, char *argv[]) { // Before successful compare and swap printf(\"before successful cas: %d\\n\", global); // Perform successful compare and swap operation int success = compare_and_swap(\u0026global, 0, 100); // Print result after successful compare and swap printf(\"after successful cas: %d (success: %d)\\n\", global, success); // Before failing compare and swap printf(\"before failing cas: %d\\n\", global); // Perform failing compare and swap operation success = compare_and_swap(\u0026global, 0, 200); // Print result after failing compare and swap printf(\"after failing cas: %d (old: %d)\\n\", global, success); return 0; } æœ€åï¼Œæ­£å¦‚ä½ å¯èƒ½å·²ç»æ„Ÿè§‰åˆ°çš„ï¼Œcompare-and-swapæ˜¯ä¸€æ¡æ¯”test-and-setåŠŸèƒ½æ›´å¼ºå¤§çš„æŒ‡ä»¤ã€‚ä»Šåï¼Œå½“æˆ‘ä»¬æ·±å…¥æ¢è®¨æ— é”åŒæ­¥ç­‰ä¸»é¢˜æ—¶ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨è¿™ä¸€åŠŸèƒ½ã€‚ä¸è¿‡ï¼Œå¦‚æœæˆ‘ä»¬åªæ˜¯ç”¨å®ƒæ„å»ºä¸€ä¸ªç®€å•çš„è‡ªæ—‹é”ï¼Œå…¶è¡Œä¸ºä¸æˆ‘ä»¬ä¸Šé¢åˆ†æçš„è‡ªæ—‹é”å®Œå…¨ç›¸åŒã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:8:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"9 Load-Linked and Store-Conditional ä¸€äº›å¹³å°æä¾›äº†ä¸€å¯¹ååŒå·¥ä½œçš„æŒ‡ä»¤æ¥å¸®åŠ©æ„å»ºä¸´ç•ŒåŒºã€‚ä¾‹å¦‚ï¼Œåœ¨ MIPS æ¶æ„ä¸Šï¼ŒåŠ è½½é“¾æ¥æŒ‡ä»¤å’Œå­˜å‚¨æ¡ä»¶æŒ‡ä»¤å¯ä»¥ä¸²è”ä½¿ç”¨æ¥æ„å»ºé”å’Œå…¶ä»–å¹¶å‘ç»“æ„ã€‚è¿™äº›æŒ‡ä»¤çš„ C ä¼ªä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ Alphaã€PowerPC å’Œ ARM æä¾›ç±»ä¼¼çš„æŒ‡ä»¤ã€‚ int LoadLinked(int *ptr) { return *ptr; } int StoreConditional(int *ptr, int value) { if (no update to *ptr since LoadLinked to this address) { *ptr = value; return 1; // success! } else { return 0; // failed to update } } åŠ è½½é“¾æ¥çš„æ“ä½œä¸å…¸å‹çš„åŠ è½½æŒ‡ä»¤éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯ä»å†…å­˜ä¸­è·å–ä¸€ä¸ªå€¼å¹¶å°†å…¶æ”¾å…¥å¯„å­˜å™¨ä¸­ã€‚å…³é”®çš„åŒºåˆ«åœ¨äºæ¡ä»¶å­˜å‚¨ï¼Œåªæœ‰åœ¨æ²¡æœ‰å¯¹åœ°å€è¿›è¡Œå¹²é¢„å­˜å‚¨çš„æƒ…å†µä¸‹ï¼Œæ¡ä»¶å­˜å‚¨æ‰ä¼šæˆåŠŸï¼ˆå¹¶æ›´æ–°å­˜å‚¨åœ¨åˆšåˆšåŠ è½½é“¾æ¥çš„åœ°å€å¤„çš„å€¼ï¼‰ã€‚å¦‚æœæˆåŠŸï¼Œstore-conditional è¿”å› 1 å¹¶å°† ptr å¤„çš„å€¼æ›´æ–°ä¸º valueï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™ ptr å¤„çš„å€¼ä¸ä¼šæ›´æ–°å¹¶è¿”å› 0ã€‚ ä¸‹é¢è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨åŠ è½½é“¾æ¥å’Œå­˜å‚¨æ¡ä»¶æ¥æ„å»ºè‡ªæ—‹é”ã€‚ void lock(lock_t *lock) { while (1) { while (LoadLinked(\u0026lock-\u003eflag) == 1) ; // spin until itâ€™s zero if (StoreConditional(\u0026lock-\u003eflag, 1) == 1) return; // if set-it-to-1 was a success: all done // otherwise: try it all over again } } void unlock(lock_t *lock) { lock-\u003eflag = 0; } lock() ä»£ç æ˜¯å”¯ä¸€æœ‰è¶£çš„éƒ¨åˆ†ã€‚é¦–å…ˆï¼Œçº¿ç¨‹è‡ªæ—‹ï¼Œç­‰å¾…flagè®¾ç½®ä¸º 0ï¼ˆä»è€ŒæŒ‡ç¤ºæœªæŒæœ‰é”ï¼‰ã€‚ä¸€æ—¦è¿™æ ·ï¼Œçº¿ç¨‹å°è¯•é€šè¿‡store-conditionalè·å–é”ï¼›å¦‚æœæˆåŠŸï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨å°†flagçš„å€¼æ›´æ”¹ä¸º 1ï¼Œä»è€Œå¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºã€‚ æ³¨æ„å­˜å‚¨æ¡ä»¶å¤±è´¥å¯èƒ½å‡ºç°çš„æƒ…å†µã€‚ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨lock()å¹¶æ‰§è¡Œload-linkedï¼Œè¿”å›0è¡¨ç¤ºé”æœªè¢«æŒæœ‰ã€‚åœ¨å®ƒå°è¯•store-conditionalä¹‹å‰ï¼Œå®ƒè¢«ä¸­æ–­ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è¿›å…¥é”ä»£ç ï¼ŒåŒæ ·æ‰§è¡Œload-linkedæŒ‡ä»¤ï¼Œå¹¶å¾—åˆ°0ç»§ç»­æ‰§è¡Œã€‚æ­¤æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹å„è‡ªæ‰§è¡Œäº†load-linkedï¼Œå¹¶ä¸”å³å°†å°è¯•store-conditionalã€‚è¿™äº›æŒ‡ä»¤çš„å…³é”®ç‰¹ç‚¹æ˜¯è¿™ä¸¤ä¸ªçº¿ç¨‹ä¸­åªæœ‰ä¸€ä¸ªä¼šæˆåŠŸåœ°å°†flagæ›´æ–°ä¸º1ä»è€Œè·å–é”ï¼›ç¬¬äºŒä¸ªå°è¯•store-conditionalçš„çº¿ç¨‹ä¼šå¤±è´¥ï¼ˆå› ä¸ºå¦ä¸€ä¸ªçº¿ç¨‹åœ¨å…¶load-linkedå’Œstore-conditionalä¹‹é—´æ›´æ–°äº†flagå€¼ï¼‰ï¼Œå› æ­¤å¿…é¡»å†æ¬¡å°è¯•è·å–é”ã€‚ ä¸€ç§æ›´ç®€æ´çš„lock()å†™æ³•å¦‚ä¸‹ï¼š void lock(lock_t *lock) { while (1) { while (LoadLinked(\u0026lock-\u003eflag) == 1 || !StoreConditional(\u0026lock-\u003eflag, 1)) ; // spin until the condition does not hold } } ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:9:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"10 Fetch-And-Add æœ€åä¸€ä¸ªç¡¬ä»¶åŸè¯­æ˜¯fetch-and-addæŒ‡ä»¤ï¼Œå®ƒä»¥åŸå­æ–¹å¼é€’å¢ä¸€ä¸ªå€¼ï¼ŒåŒæ—¶è¿”å›ç‰¹å®šåœ°å€ä¸Šçš„æ—§å€¼ã€‚fetch-and-addæŒ‡ä»¤çš„ C è¯­è¨€ä¼ªä»£ç å¦‚ä¸‹ï¼š int FetchAndAdd(int *ptr) { int old = *ptr; *ptr = old + 1; return old; } lockå’Œunlockä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨fetch-and-addæ¥æ„å»ºä¸€ä¸ªæ›´æœ‰è¶£çš„ç¥¨æ®é”ï¼Œç”±Mellor-Crummeyå’ŒScottå¼•å…¥ã€‚ typedef struct __lock_t { int ticket; int turn; } lock_t; void lock_init(lock_t *lock) { lock-\u003eticket = 0; lock-\u003eturn = 0; } void lock(lock_t *lock) { int myturn = FetchAndAdd(\u0026lock-\u003eticket); while (lock-\u003eturn != myturn) ; // spin } void unlock(lock_t *lock) { lock-\u003eturn = lock-\u003eturn + 1; } è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸æ˜¯ä½¿ç”¨å•ä¸€å€¼ï¼Œè€Œæ˜¯ç»“åˆä½¿ç”¨ticketå’Œturnå˜é‡æ¥æ„å»ºä¸€ä¸ªè‡ªæ—‹é”ã€‚ åŸºæœ¬æ“ä½œéå¸¸ç®€å•ï¼šå½“çº¿ç¨‹å¸Œæœ›è·å–é”æ—¶ï¼Œé¦–å…ˆå¯¹ticketè¿›è¡ŒåŸå­fetch-and-addæ“ä½œï¼›è¯¥å€¼ç°åœ¨è¢«è§†ä¸ºæ­¤çº¿ç¨‹çš„â€œè½®æ¬¡â€ï¼ˆmyturnï¼‰ã€‚ ç„¶åå…¨å±€å…±äº«çš„lock-\u003eturnç”¨äºç¡®å®šå“ªä¸ªçº¿ç¨‹çš„è½®æ¬¡ï¼›å½“ç»™å®šçº¿ç¨‹çš„(myturn == turn)æ—¶ï¼Œå°±æ˜¯è¯¥çº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºçš„æœºä¼šã€‚ unlockåªéœ€é€šè¿‡å¢åŠ turnå³å¯å®Œæˆï¼Œä»¥ä¾¿ä¸‹ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹ï¼ˆå¦‚æœæœ‰ï¼‰ç°åœ¨å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºã€‚ è¯·æ³¨æ„è¿™ç§è§£å†³æ–¹æ¡ˆä¸æˆ‘ä»¬ä¹‹å‰å°è¯•è¿‡çš„æ–¹æ³•ä¹‹é—´å­˜åœ¨ä¸€ä¸ªé‡è¦å·®å¼‚ï¼šå®ƒç¡®ä¿æ‰€æœ‰çº¿ç¨‹éƒ½èƒ½å–å¾—è¿›å±•ã€‚ ä¸€æ—¦åˆ†é…äº†æŸä¸ªçº¿ç¨‹è‡ªå·±çš„ticketï¼Œå®ƒå°†åœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹è¢«è°ƒåº¦æ‰§è¡Œï¼ˆä¸€æ—¦æ’é˜Ÿç­‰å€™å…¶å‰é¢å·²ç»é€šè¿‡ä¸´ç•ŒåŒºå¹¶é‡Šæ”¾äº†é”ï¼‰ã€‚ åœ¨æˆ‘ä»¬ä¹‹å‰å°è¯•è¿‡çš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸å­˜åœ¨è¿™æ ·ä¿è¯ï¼›ä¾‹å¦‚ï¼Œåœ¨test-and-setä¸Šè‡ªæ—‹ç€ç­‰å¾…ï¼Œå³ä½¿å…¶ä»–çº¿ç¨‹è·å–å¹¶é‡Šæ”¾äº†é”ä¹Ÿå¯èƒ½æ°¸è¿œè‡ªæ—‹ä¸‹å»ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:10:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"11 å¤ªå¤šè‡ªæ—‹ï¼šç°åœ¨æ€ä¹ˆåŠï¼Ÿ æˆ‘ä»¬åŸºäºç¡¬ä»¶çš„ç®€å•é”éå¸¸ç®€å•ï¼ˆåªæœ‰å‡ è¡Œä»£ç ï¼‰ï¼Œè€Œä¸”èƒ½æ­£å¸¸å·¥ä½œï¼Œè¿™æ˜¯ä»»ä½•ç³»ç»Ÿæˆ–ä»£ç çš„ä¸¤ä¸ªä¼˜ç§€ç‰¹æ€§ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™äº›è§£å†³æ–¹æ¡ˆçš„æ•ˆç‡å¯èƒ½å¾ˆä½ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨å•ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œä¸¤ä¸ªçº¿ç¨‹ã€‚ç°åœ¨å‡è®¾ä¸€ä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹ 0ï¼‰æ­£å¤„äºä¸´ç•ŒåŒºï¼Œå› æ­¤è¢«é”å®šï¼Œå¹¶ä¸å¹¸è¢«ä¸­æ–­ã€‚ç¬¬äºŒä¸ªçº¿ç¨‹ï¼ˆçº¿ç¨‹ 1ï¼‰ç°åœ¨è¯•å›¾è·å–é”ï¼Œä½†å‘ç°é”å·²è¢«é”å®šã€‚äºæ˜¯ï¼Œå®ƒå¼€å§‹ä¸åœåœ°è‡ªæ—‹ã€‚ç„¶ååˆè‡ªæ—‹äº†å‡ åœˆã€‚æœ€åï¼Œå®šæ—¶å™¨ä¸­æ–­ï¼Œçº¿ç¨‹ 0 å†æ¬¡è¿è¡Œï¼Œé‡Šæ”¾äº†é”ï¼Œæœ€åï¼ˆæ¯”å¦‚è¯´ä¸‹æ¬¡è¿è¡Œæ—¶ï¼‰ï¼Œçº¿ç¨‹ 1 å°±ä¸ç”¨è‡ªæ—‹é‚£ä¹ˆå¤šåœˆäº†ï¼Œå°±èƒ½è·å¾—é”ã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¸€æ—¦é™·å…¥è‡ªæ—‹ï¼Œå°±ä¼šæµªè´¹ä¸€æ•´ä¸ªæ—¶é—´ç‰‡ï¼Œè€Œåªæ˜¯æ£€æŸ¥ä¸€ä¸ªä¸ä¼šæ”¹å˜çš„å€¼å¤–ï¼Œä»€ä¹ˆä¹Ÿä¸åšï¼å¦‚æœæœ‰ N ä¸ªçº¿ç¨‹åœ¨äº‰å¤ºä¸€ä¸ªé”ï¼Œé—®é¢˜å°±æ›´ä¸¥é‡äº†ï¼›N - 1 ä¸ªæ—¶é—´ç‰‡å¯èƒ½ä¼šä»¥ç±»ä¼¼çš„æ–¹å¼è¢«æµªè´¹æ‰ï¼Œä»…ä»…æ˜¯åœ¨è‡ªæ—‹å¹¶ç­‰å¾…ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•é¿å…è‡ªæ—‹ï¼Ÿæˆ‘ä»¬æ€æ ·æ‰èƒ½å¼€å‘å‡ºä¸€ç§ä¸ä¼šæ— è°“åœ°æµªè´¹æ—¶é—´åœ¨ CPU ä¸Šè‡ªæ—‹çš„é”ï¼Ÿä»…é ç¡¬ä»¶æ”¯æŒæ— æ³•è§£å†³é—®é¢˜ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ“ä½œç³»ç»Ÿçš„æ”¯æŒï¼ç°åœ¨å°±è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°è¿™ä¸€ç‚¹ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:11:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"12 ä¸€ä¸ªç®€å•çš„æ–¹æ³•ï¼šåªéœ€yield ç¡¬ä»¶æ”¯æŒè®©æˆ‘ä»¬å–å¾—äº†ç›¸å½“å¤§çš„è¿›å±•ï¼šå·¥ä½œé”ï¼Œç”šè‡³ï¼ˆå¦‚ç¥¨æ®é”ï¼‰é”è·å–çš„å…¬å¹³æ€§ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä»ç„¶é¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šå½“ä¸Šä¸‹æ–‡åˆ‡æ¢å‘ç”Ÿåœ¨ä¸´ç•ŒåŒºæ—¶ï¼Œçº¿ç¨‹å¼€å§‹æ— ä¼‘æ­¢åœ°è‡ªæ—‹ï¼Œç­‰å¾…è¢«ä¸­æ–­çš„ï¼ˆæŒæœ‰é”çš„ï¼‰çº¿ç¨‹å†æ¬¡è¿è¡Œï¼Œè¿™æ—¶è¯¥æ€ä¹ˆåŠï¼Ÿ æˆ‘ä»¬é¦–å…ˆå°è¯•çš„æ˜¯ä¸€ç§ç®€å•è€Œå‹å¥½çš„æ–¹æ³•ï¼šå½“ä½ è¦è‡ªæ—‹æ—¶ï¼ŒæŠŠ CPU è®©ç»™å¦ä¸€ä¸ªçº¿ç¨‹ã€‚æˆ–è€…ï¼Œå°±åƒAl Davisè¯´çš„é‚£æ ·ï¼Œâ€œè®©ä¸€è®©ï¼Œå®è´ï¼\"ã€‚ä¸‹é¢è¿™æ®µä»£ç å±•ç¤ºäº†è¿™ç§æ–¹æ³•ã€‚ void init() { flag = 0; } void lock() { while (TestAndSet(\u0026flag, 1) == 1) yield(); // æ”¾å¼ƒ CPU æ§åˆ¶æƒ } void unlock() { flag = 0; } åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å‡å®šä¸€ä¸ªçº¿ç¨‹åœ¨æƒ³è¦æ”¾å¼ƒ CPU å¹¶è®©å¦ä¸€ä¸ªçº¿ç¨‹è¿è¡Œæ—¶ï¼Œå¯ä»¥è°ƒç”¨æ“ä½œç³»ç»ŸåŸè¯­ yield()ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤„äºä¸‰ç§çŠ¶æ€ï¼ˆè¿è¡Œã€å°±ç»ªæˆ–é˜»å¡ï¼‰ä¹‹ä¸€ï¼›yield åªæ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå®ƒå°†è°ƒç”¨è€…ä»è¿è¡ŒçŠ¶æ€ç§»åˆ°å°±ç»ªçŠ¶æ€ï¼Œä»è€Œå°†å¦ä¸€ä¸ªçº¿ç¨‹æå‡åˆ°è¿è¡ŒçŠ¶æ€ã€‚å› æ­¤ï¼Œyieldè¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯è‡ªæˆ‘å–æ¶ˆè°ƒåº¦çš„ã€‚ å›æƒ³ä¸€ä¸‹ä¸€ä¸ª CPU ä¸Šæœ‰ä¸¤ä¸ªçº¿ç¨‹çš„ä¾‹å­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åŸºäº yield çš„æ–¹æ³•å°±èƒ½å¾ˆå¥½åœ°å‘æŒ¥ä½œç”¨ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹ç¢°å·§è°ƒç”¨äº† lock() å¹¶å‘ç°é”è¢«é”å®šï¼Œå®ƒå°±ä¼šç®€å•åœ°è®©å‡º CPUï¼Œè¿™æ ·å¦ä¸€ä¸ªçº¿ç¨‹å°±ä¼šè¿è¡Œå¹¶å®Œæˆå…¶ä¸´ç•ŒåŒºã€‚åœ¨è¿™ç§ç®€å•çš„æƒ…å†µä¸‹ï¼Œyieldæ–¹æ³•è¿è¡Œè‰¯å¥½ã€‚ ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æœ‰å¤šä¸ªçº¿ç¨‹ï¼ˆæ¯”å¦‚ 100 ä¸ªï¼‰é‡å¤äº‰å¤ºä¸€ä¸ªé”çš„æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ï¼Œå¹¶åœ¨é‡Šæ”¾é”ä¹‹å‰è¢«æŠ¢å ï¼Œé‚£ä¹ˆå…¶ä»– 99 ä¸ªçº¿ç¨‹å°†åˆ†åˆ«è°ƒç”¨ lock()ï¼Œå‘ç°é”è¢«æŒæœ‰ï¼Œå¹¶è®©å‡º CPUã€‚å‡è®¾æœ‰æŸç§å¾ªç¯è°ƒåº¦ç¨‹åºï¼Œé‚£ä¹ˆ 99 ä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸€ä¸ªéƒ½ä¼šåœ¨æŒæœ‰é”çš„çº¿ç¨‹å†æ¬¡è¿è¡Œä¹‹å‰æ‰§è¡Œè¿™ç§run-and-yieldæ¨¡å¼ã€‚è™½ç„¶è¿™ç§æ–¹æ³•æ¯”æˆ‘ä»¬çš„ â€œè‡ªæ—‹\"æ–¹æ³•è¦å¥½ï¼ˆâ€œè‡ªæ—‹ â€œä¼šæµªè´¹ 99 ä¸ªæ—¶é—´ç‰‡ï¼‰ï¼Œä½†ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬å¯èƒ½å¾ˆé«˜ï¼Œå› æ­¤ä¼šé€ æˆå¤§é‡æµªè´¹ã€‚ æ›´ç³Ÿç³•çš„æ˜¯ï¼Œæˆ‘ä»¬æ ¹æœ¬æ²¡æœ‰è§£å†³é¥¥é¥¿é—®é¢˜ã€‚å½“å…¶ä»–çº¿ç¨‹åå¤è¿›å…¥å’Œé€€å‡ºä¸´ç•ŒåŒºæ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹å¯èƒ½ä¼šé™·å…¥æ— ä¼‘æ­¢çš„yieldå¾ªç¯ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§èƒ½ç›´æ¥è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:12:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"13 ä½¿ç”¨é˜Ÿåˆ—ï¼šç¡çœ è€Œä¸æ˜¯è‡ªæ—‹ æˆ‘ä»¬ä¹‹å‰çš„æ–¹æ³•çš„çœŸæ­£é—®é¢˜åœ¨äºï¼Œå®ƒä»¬ç•™ä¸‹äº†å¤ªå¤šçš„å¶ç„¶æ€§ã€‚è°ƒåº¦å™¨å†³å®šä¸‹ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹ï¼›å¦‚æœè°ƒåº¦å™¨åšå‡ºäº†é”™è¯¯çš„é€‰æ‹©ï¼Œè¿è¡Œçš„çº¿ç¨‹è¦ä¹ˆå¿…é¡»è‡ªæ—‹ç­‰å¾…é”ï¼ˆæˆ‘ä»¬çš„ç¬¬ä¸€ç§æ–¹æ³•ï¼‰ï¼Œè¦ä¹ˆç«‹å³è®©å‡º CPUï¼ˆæˆ‘ä»¬çš„ç¬¬äºŒç§æ–¹æ³•ï¼‰ã€‚æ— è®ºå“ªç§æ–¹æ³•ï¼Œéƒ½æœ‰å¯èƒ½é€ æˆæµªè´¹ï¼Œè€Œä¸”æ— æ³•é¿å…é¥¥é¥¿ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æ˜ç¡®æ§åˆ¶åœ¨å½“å‰æŒæœ‰è€…é‡Šæ”¾é”åï¼Œä¸‹ä¸€ä¸ªè·å¾—é”çš„çº¿ç¨‹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¤šçš„æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œä»¥åŠä¸€ä¸ªé˜Ÿåˆ—æ¥è·Ÿè¸ªå“ªäº›çº¿ç¨‹æ­£åœ¨ç­‰å¾…è·å–é”ã€‚ ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Solaris æä¾›çš„æ”¯æŒï¼Œå³ä¸¤ä¸ªè°ƒç”¨ï¼špark() ç”¨äºä½¿è°ƒç”¨çº¿ç¨‹ä¼‘çœ ï¼Œunpark(threadID) ç”¨äºå”¤é†’threadID æŒ‡å®šçš„ç‰¹å®šçº¿ç¨‹ã€‚è¿™ä¸¤ä¸ªä¾‹ç¨‹å¯ä»¥é…åˆä½¿ç”¨ï¼Œæ„å»ºä¸€ä¸ªé”ï¼Œå½“è°ƒç”¨è€…è¯•å›¾è·å–ä¸€ä¸ªè¢«é”å®šçš„é”æ—¶ï¼Œè¯¥é”ä¼šä½¿è°ƒç”¨è€…ä¼‘çœ ï¼Œè€Œå½“é”è¢«é‡Šæ”¾æ—¶ï¼Œè°ƒç”¨è€…ä¼šè¢«å”¤é†’ã€‚ ä¸‹é¢è¿™æ®µä»£ç å®ç°äº†ç®€å•çš„é”ã€‚ typedef struct __lock_t { int flag; int guard; queue_t *q; } lock_t; void lock_init(lock_t *m) { m-\u003eflag = 0; m-\u003eguard = 0; queue_init(m-\u003eq); } void lock(lock_t *m) { while (TestAndSet(\u0026m-\u003eguard, 1) == 1) ; // é€šè¿‡è‡ªæ—‹è·å– guard é” if (m-\u003eflag == 0) { m-\u003eflag = 1; // è·å–é” m-\u003eguard = 0; } else { queue_add(m-\u003eq, gettid()); m-\u003eguard = 0; park(); } } void unlock(lock_t *m) { while (TestAndSet(\u0026m-\u003eguard, 1) == 1) ; // é€šè¿‡è‡ªæ—‹è·å– guard é” if (queue_empty(m-\u003eq)) m-\u003eflag = 0; // é‡Šæ”¾é”ï¼›æ²¡æœ‰çº¿ç¨‹è¦è·å–å®ƒ else unpark(queue_remove(m-\u003eq)); // ä¿æŒé”ï¼ˆç»™ä¸‹ä¸€ä¸ªçº¿ç¨‹ï¼ï¼‰ m-\u003eguard = 0; } åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åšäº†å‡ ä»¶æœ‰è¶£çš„äº‹æƒ…ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†è€å¼çš„test-and-setæ€æƒ³ä¸æ˜¾å¼çš„é”ç­‰å¾…è€…é˜Ÿåˆ—ç›¸ç»“åˆï¼Œä»¥å®ç°æ›´é«˜æ•ˆçš„é”ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬ä½¿ç”¨é˜Ÿåˆ—æ¥å¸®åŠ©æ§åˆ¶ä¸‹ä¸€ä¸ªè·å¾—é”çš„äººï¼Œä»è€Œé¿å…é¥¥é¥¿ã€‚ ä½ å¯èƒ½ä¼šæ³¨æ„åˆ° guard æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Œå®ƒåŸºæœ¬ä¸Šæ˜¯å›´ç»•é”ä½¿ç”¨çš„æ ‡å¿—å’Œé˜Ÿåˆ—æ“ä½œçš„è‡ªæ—‹é”ã€‚å› æ­¤ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸èƒ½å®Œå…¨é¿å…è‡ªæ—‹ç­‰å¾…ï¼›çº¿ç¨‹åœ¨è·å–æˆ–é‡Šæ”¾é”æ—¶å¯èƒ½ä¼šè¢«ä¸­æ–­ï¼Œä»è€Œå¯¼è‡´å…¶ä»–çº¿ç¨‹è‡ªæ—‹ç­‰å¾…è¯¥çº¿ç¨‹å†æ¬¡è¿è¡Œã€‚ä¸è¿‡ï¼Œè‡ªæ—‹æ‰€èŠ±è´¹çš„æ—¶é—´éå¸¸æœ‰é™ï¼ˆåªæ˜¯lock()å’Œunlock()ä»£ç ä¸­çš„å‡ æ¡æŒ‡ä»¤ï¼Œè€Œä¸æ˜¯ç”¨æˆ·å®šä¹‰çš„ä¸´ç•ŒåŒºï¼‰ï¼Œå› æ­¤è¿™ç§æ–¹æ³•å¯èƒ½æ˜¯åˆç†çš„ã€‚ å…¶æ¬¡ï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œåœ¨ lock() ä¸­ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ— æ³•è·å–é”ï¼ˆå®ƒå·²è¢«æŒæœ‰ï¼‰æ—¶ï¼Œæˆ‘ä»¬ä¼šå°å¿ƒåœ°å°†è¯¥çº¿ç¨‹åŠ å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼ˆé€šè¿‡è°ƒç”¨ gettid() å‡½æ•°è·å–å½“å‰çº¿ç¨‹çš„threadIDï¼‰ï¼Œå°† guard è®¾ä¸º 0ï¼Œå¹¶è®©å‡º CPUã€‚ä½†å¦‚æœåœ¨ park() ä¹‹åè€Œä¸æ˜¯ä¹‹å‰é‡Šæ”¾guardé”ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿè¿™ä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹æš‚æ—¶æ— æ³•å†è·å¾— guard é”ï¼Œå› ä¸ºè¯¥é”ä»ç„¶ç”±å…ˆå‰çš„çº¿ç¨‹æŒæœ‰ã€‚å¦‚æœå…¶ä»–çº¿ç¨‹è¯•å›¾è·å–é”ï¼Œåˆ™ä¼šä¸€ç›´è‡ªæ—‹ç­‰å¾… guard é”è¢«é‡Šæ”¾ã€‚è€Œç”±äºæ— æ³•è·å–guardé”ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•æ‰§è¡Œ unlock() å‡½æ•°ï¼Œæ‰€ä»¥å³ä½¿æŸä¸ªçº¿ç¨‹è¢«å”¤é†’ï¼Œä¹Ÿæ— æ³•ç»§ç»­æ‰§è¡Œunlockæ“ä½œã€‚è¿™å°±å¯¼è‡´äº†æ­»é”çŠ¶æ€ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½è¢«é˜»å¡ï¼Œæ— æ³•æ­£å¸¸è¿è¡Œã€‚ ä½ å¯èƒ½è¿˜ä¼šæ³¨æ„åˆ°ä¸€ä¸ªæœ‰è¶£çš„äº‹å®ï¼Œé‚£å°±æ˜¯å½“å¦ä¸€ä¸ªçº¿ç¨‹è¢«å”¤é†’æ—¶ï¼Œflagä¸ä¼šè¢«è®¾ç½®å› 0ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œè€Œæ˜¯ä¸€ç§å¿…ç„¶ï¼å½“ä¸€ä¸ªçº¿ç¨‹è¢«å”¤é†’æ—¶ï¼Œå®ƒå°±åƒä» park() è¿”å›ä¸€æ ·ï¼›ç„¶è€Œï¼Œå®ƒåœ¨ä»£ç ä¸­çš„è¿™ä¸€ç‚¹ä¸Šå¹¶ä¸æŒæœ‰guardï¼Œå› æ­¤ç”šè‡³æ— æ³•å°è¯•å°†flagè®¾ç½®ä¸º 1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªæ˜¯å°†é”ä»é‡Šæ”¾é”çš„çº¿ç¨‹ç›´æ¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè·å–é”çš„çº¿ç¨‹ï¼›åœ¨è¿™ä¸­é—´ï¼Œflagä¸ä¼šè¢«è®¾ç½®ä¸º 0ã€‚ æœ€åï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°åœ¨è§£å†³æ–¹æ¡ˆä¸­ï¼Œå°±åœ¨è°ƒç”¨ park() ä¹‹å‰å‡ºç°äº†ç«äº‰æ¡ä»¶ã€‚ä¾‹å¦‚çº¿ç¨‹Båœ¨è°ƒç”¨park()ä¹‹å‰çº¿ç¨‹Aé‡Šæ”¾äº†é”ï¼Œé‚£ä¹ˆçº¿ç¨‹Bå¯èƒ½ä¼šæ°¸è¿œä¼‘çœ ï¼Œå› ä¸ºåœ¨è°ƒç”¨ park() ä¹‹å‰å®ƒå·²ç»é”™è¿‡äº†å”¤é†’çš„æ—¶æœºã€‚è¿™ä¸ªé—®é¢˜æœ‰æ—¶è¢«ç§°ä¸ºå”¤é†’/ç­‰å¾…ç«äº‰ã€‚ Solaris é€šè¿‡æ·»åŠ ç¬¬ä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨ setpark() æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é€šè¿‡è°ƒç”¨è¯¥ä¾‹ç¨‹ï¼Œçº¿ç¨‹å¯ä»¥è¡¨æ˜å®ƒå³å°†parkã€‚å¦‚æœçº¿ç¨‹åœ¨è°ƒç”¨ park() ä¹‹å‰è¢«ä¸­æ–­ï¼ˆä¾‹å¦‚æ”¶åˆ°äº†ä¸€ä¸ªä¿¡å·ï¼‰ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åœ¨è¿™ä¸ªæ—¶å€™è°ƒç”¨äº† unpark() æ¥å”¤é†’å½“å‰çº¿ç¨‹ï¼Œåˆ™å½“å‰çº¿ç¨‹ä¸‹ä¸€æ¬¡è°ƒç”¨ park() ä¸ä¼šçœŸæ­£è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œè€Œæ˜¯ç«‹å³è¿”å›ï¼Œç»§ç»­æ‰§è¡Œåç»­çš„ä»£ç ã€‚lock()å†…éƒ¨çš„ä»£ç ä¿®æ”¹å¾ˆå°ï¼š queue_add(m-\u003eq, gettid()); setpark(); // new code , (before open guard) m-\u003eguard = 0; å¦ä¸€ç§ä¸åŒçš„è§£å†³æ–¹æ¡ˆæ˜¯å°†guardä¼ é€’ç»™å†…æ ¸ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†…æ ¸å¯ä»¥é‡‡å–é¢„é˜²æªæ–½ï¼Œä»¥åŸå­æ–¹å¼é‡Šæ”¾é”ï¼Œå¹¶å°†è¿è¡Œä¸­çš„çº¿ç¨‹å‡ºåˆ—ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:13:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"14 ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œä¸åŒçš„æ”¯æŒ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†æ“ä½œç³»ç»Ÿä¸ºåœ¨çº¿ç¨‹åº“ä¸­å»ºç«‹æ›´é«˜æ•ˆçš„é”è€Œæä¾›çš„ä¸€ç§æ”¯æŒã€‚å…¶ä»–æ“ä½œç³»ç»Ÿä¹Ÿæä¾›ç±»ä¼¼çš„æ”¯æŒï¼Œä½†ç»†èŠ‚å„æœ‰ä¸åŒã€‚ ä¾‹å¦‚ï¼ŒLinux æä¾›çš„ futex ä¸ Solaris æ¥å£ç±»ä¼¼ï¼Œä½†æä¾›äº†æ›´å¤šå†…æ ¸åŠŸèƒ½ã€‚å…·ä½“æ¥è¯´ï¼Œæ¯ä¸ª futex éƒ½å…³è”äº†ä¸€ä¸ªç‰¹å®šçš„ç‰©ç†å†…å­˜ä½ç½®ï¼Œä»¥åŠæ¯ä¸ª futex çš„å†…æ ¸é˜Ÿåˆ—ã€‚è°ƒç”¨è€…å¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨ futex è°ƒç”¨æ¥ä¼‘çœ å’Œå”¤é†’ã€‚å…·ä½“æ¥è¯´ï¼Œ æœ‰ä¸¤ç§è°ƒç”¨æ–¹å¼å¯ç”¨ã€‚è°ƒç”¨ futex_wait(address,expected)åï¼Œè°ƒç”¨çº¿ç¨‹å°†è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œå‰ææ˜¯åœ°å€ä¸­çš„å€¼ç­‰äºé¢„æœŸå€¼ã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œè°ƒç”¨å°†ç«‹å³è¿”å›ã€‚è°ƒç”¨ä¾‹ç¨‹ futex_wake(address) ä¼šå”¤é†’ä¸€ä¸ªæ­£åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…çš„çº¿ç¨‹ã€‚è¿™äº›è°ƒç”¨åœ¨ Linux mutexä¸­çš„ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ void mutex_lock(int *mutex) { int v; /* Bit 31 was clear, we got the mutex (the fastpath) */ if (atomic_bit_test_set(mutex, 31) == 0) return; // Atomic operations increase the number of waiters on the lock atomic_increment(mutex); while (1) { // Spin waits for other threads to release the lock if (atomic_bit_test_set(mutex, 31) == 0) { // The current thread holds the lock and the number of waiters is reduced by 1 atomic_decrement(mutex); return; } /* We have to wait. First make sure the futex value we are monitoring is truly negative (locked). */ v = *mutex; if (v \u003e= 0) continue; futex_wait(mutex, v); } } void mutex_unlock(int *mutex) { /* Adding 0x80000000 to counter results in 0 if and only if there are not other interested threads */ if (atomic_add_zero(mutex, 0x80000000)) return; /* There are other threads waiting for this mutex, wake one of them up. */ futex_wake(mutex); } nptl åº“ï¼ˆgnu libc åº“çš„ä¸€éƒ¨åˆ†ï¼‰ ä¸­ lowlevellock.hçš„è¿™æ®µ ä»£ç ç‰‡æ®µä¹‹æ‰€ä»¥æœ‰è¶£ï¼Œæœ‰å‡ ä¸ªåŸå› ã€‚é¦–å…ˆï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªæ•´æ•°æ¥è·Ÿè¸ªé”æ˜¯å¦è¢«æŒæœ‰ï¼ˆæ•´æ•°çš„é«˜ä½ï¼‰ä»¥åŠé”ä¸Šç­‰å¾…è€…çš„æ•°é‡ï¼ˆæ‰€æœ‰å…¶ä»–ä½ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœé”æ˜¯è´Ÿæ•°ï¼Œå®ƒå°±æ˜¯è¢«æŒæœ‰çš„ï¼ˆå› ä¸ºé«˜ä½è¢«è®¾ç½®ï¼Œè€Œè¯¥ä½å†³å®šäº†æ•´æ•°çš„ç¬¦å·ï¼‰ã€‚ å…¶æ¬¡ï¼Œä»£ç ç‰‡æ®µå±•ç¤ºäº†å¦‚ä½•é’ˆå¯¹å¸¸è§æƒ…å†µè¿›è¡Œä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯åœ¨æ²¡æœ‰é”ç«äº‰çš„æƒ…å†µä¸‹ï¼›åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å–å’Œé‡Šæ”¾é”ï¼Œåªéœ€å®Œæˆå¾ˆå°‘çš„å·¥ä½œï¼ˆåŸå­ä½test-and-seté”å®šä»¥åŠåŸå­ä½æ·»åŠ é‡Šæ”¾é”ï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:14:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"15 ä¸¤é˜¶æ®µé” æœ€åä¸€ç‚¹ï¼šLinux æ–¹æ³•æœ‰ä¸€ç§æ—§æ–¹æ³•çš„å‘³é“ï¼Œè¿™ç§æ–¹æ³•å·²ç»æ–­æ–­ç»­ç»­åœ°ä½¿ç”¨äº†å¾ˆå¤šå¹´ï¼Œè‡³å°‘å¯ä»¥è¿½æº¯åˆ° 1960 å¹´ä»£åˆçš„ Dahm Locks ï¼Œç°åœ¨è¢«ç§°ä¸ºä¸¤é˜¶æ®µé”ã€‚ä¸¤é˜¶æ®µé”æ„è¯†åˆ°è‡ªæ—‹å¯èƒ½å¾ˆæœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨é”å³å°†è¢«é‡Šæ”¾çš„æƒ…å†µä¸‹ã€‚æ‰€ä»¥åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œé”ä¼šè‡ªæ—‹ä¸€æ®µæ—¶é—´ï¼Œå¸Œæœ›èƒ½å¤Ÿè·å–åˆ°é”ã€‚ ä½†æ˜¯ï¼Œå¦‚æœåœ¨ç¬¬ä¸€ä¸ªè‡ªæ—‹é˜¶æ®µæ²¡æœ‰è·å–é”ï¼Œåˆ™ä¼šè¿›å…¥ç¬¬äºŒä¸ªé˜¶æ®µï¼Œè°ƒç”¨è€…å°†è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œåªæœ‰åœ¨é”ç¨åé‡Šæ”¾æ—¶æ‰ä¼šè¢«å”¤é†’ã€‚ä¸Šé¢çš„ Linux é”å°±æ˜¯è¿™ç§é”çš„ä¸€ç§å½¢å¼ï¼Œä½†å®ƒåªè‡ªæ—‹ä¸€æ¬¡ï¼›å¯¹æ­¤çš„æ¦‚æ‹¬å¯ä»¥æ˜¯åœ¨ä½¿ç”¨ futex æ”¯æŒè¿›å…¥ç¡çœ ä¹‹å‰å¾ªç¯è‡ªæ—‹å›ºå®šçš„æ—¶é—´ã€‚ä¸¤é˜¶æ®µé”æ˜¯æ··åˆæ–¹æ³•çš„å¦ä¸€ä¸ªå®ä¾‹ï¼Œå…¶ä¸­ç»“åˆä¸¤ä¸ªå¥½çš„æƒ³æ³•ç¡®å®å¯èƒ½ä¼šäº§ç”Ÿæ›´å¥½çš„æƒ³æ³•ã€‚å½“ç„¶ï¼Œå®ƒæ˜¯å¦ç¡®å®åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå¾ˆå¤šå› ç´ ï¼ŒåŒ…æ‹¬ç¡¬ä»¶ç¯å¢ƒã€çº¿ç¨‹æ•°é‡å’Œå…¶ä»–å·¥ä½œè´Ÿè½½ç»†èŠ‚ã€‚ä¸å¾€å¸¸ä¸€æ ·ï¼Œåˆ¶ä½œä¸€ä¸ªé€‚åˆæ‰€æœ‰å¯èƒ½ç”¨ä¾‹çš„é€šç”¨é”æ˜¯ä¸€ä¸ªç›¸å½“å¤§çš„æŒ‘æˆ˜ã€‚ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:15:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"16 Dekkerç®—æ³•å’ŒPetersonç®—æ³• 20 ä¸–çºª 60 å¹´ä»£ï¼ŒDijkstra å‘ä»–çš„æœ‹å‹ä»¬æå‡ºäº†å¹¶å‘é—®é¢˜ï¼Œå…¶ä¸­ä¸€ä½åå« Theodorus Jozef Dekker çš„æ•°å­¦å®¶æå‡ºäº†è§£å†³æ–¹æ¡ˆã€‚ä¸æˆ‘ä»¬åœ¨æ­¤è®¨è®ºçš„ä½¿ç”¨ç‰¹æ®Šç¡¬ä»¶æŒ‡ä»¤ç”šè‡³æ“ä½œç³»ç»Ÿæ”¯æŒçš„è§£å†³æ–¹æ¡ˆä¸åŒï¼ŒDekker çš„ç®—æ³•ä»…ä½¿ç”¨åŠ è½½å’Œå­˜å‚¨ï¼ˆå‡å®šå®ƒä»¬ä¹‹é—´æ˜¯åŸå­å…³ç³»ï¼Œè¿™åœ¨æ—©æœŸçš„ç¡¬ä»¶ä¸Šæ˜¯æ­£ç¡®çš„ï¼‰ã€‚ä¸‹é¢æ˜¯Dekkerç®—æ³•çš„ä»£ç ï¼š int flag[2]; int turn; void init() { flag[0] = flag[1] = 0; turn = 0; } void lock() { flag[self] = 1; while (flag[1 - self] == 1) { if (turn != self) { flag[self] = 0; while (turn != self) ; flag[self] = 1; } } } void unlock() { flag[self] = 0; turn = 1 - self; } Dekkerçš„æ–¹æ³•åæ¥è¢«Petersonæ”¹è¿›ã€‚åŒæ ·ï¼Œè¯¥ç®—æ³•åªä½¿ç”¨åŠ è½½å’Œå­˜å‚¨ï¼Œå…¶ç›®çš„æ˜¯ç¡®ä¿ä¸¤ä¸ªçº¿ç¨‹ä¸ä¼šåŒæ—¶è¿›å…¥ä¸´ç•ŒåŒºã€‚ä¸‹é¢æ˜¯ Peterson çš„ç®—æ³•ï¼ˆä¸¤ä¸ªçº¿ç¨‹ï¼‰ï¼š int flag[2]; int turn; void init() { // indicate you intend to hold the lock w/ â€™flagâ€™ flag[0] = flag[1] = 0; // whose turn is it? (thread 0 or 1) turn = 0; } void lock() { // â€™selfâ€™ is the thread ID of caller flag[self] = 1; // make it other threadâ€™s turn turn = 1 - self; while ((flag[1 - self] == 1) \u0026\u0026 (turn == 1 - self)) ; // spin-wait while itâ€™s not your turn } void unlock() { // simply undo your intent flag[self] = 0; } å‡ºäºæŸç§åŸå› ï¼Œå¼€å‘æ— éœ€ç‰¹æ®Šç¡¬ä»¶æ”¯æŒå°±èƒ½å·¥ä½œçš„é”æ›¾é£é¡ä¸€æ—¶ï¼Œç»™ç†è®ºå®¶ä»¬å¸¦æ¥äº†è®¸å¤šéš¾é¢˜ã€‚å½“ç„¶ï¼Œå½“äººä»¬æ„è¯†åˆ°å‡å®šæœ‰ä¸€ç‚¹ç¡¬ä»¶æ”¯æŒä¼šå®¹æ˜“å¾—å¤šæ—¶ï¼Œè¿™ä¸€è¡Œå°±å˜å¾—æ¯«æ— ç”¨å¤„äº†ï¼ˆäº‹å®ä¸Šï¼Œè¿™ç§æ”¯æŒåœ¨å¤šè¿›ç¨‹çš„æ—©æœŸå°±å·²ç»å­˜åœ¨äº†ï¼‰ã€‚æ­¤å¤–ï¼Œç±»ä¼¼ä¸Šè¿°çš„ç®—æ³•åœ¨ç°ä»£ç¡¬ä»¶ä¸Šä¹Ÿè¡Œä¸é€šï¼ˆå› ä¸ºå†…å­˜ä¸€è‡´æ€§æ¨¡å‹è¢«æ”¾å®½äº†ï¼‰ï¼Œå› æ­¤å®ƒä»¬çš„ç”¨å¤„æ¯”ä»¥å‰æ›´å°äº†ã€‚ç„¶è€Œï¼Œæ›´å¤šçš„ç ”ç©¶å·²è¢«å†å²å°˜å°â€¦â€¦ ","date":"2024-05-11","objectID":"/posts/21.%E9%94%81/:16:0","tags":["OS"],"title":"é”","uri":"/posts/21.%E9%94%81/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 çº¿ç¨‹åˆ›å»º ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯åˆ›å»ºæ–°çº¿ç¨‹ï¼Œå› æ­¤å¿…é¡»æœ‰æŸç§çº¿ç¨‹åˆ›å»ºæ¥å£ã€‚åœ¨ POSIX ä¸­ï¼Œè¿™å¾ˆå®¹æ˜“ï¼š #include \u003cpthread.h\u003e int pthread_create( pthread_t* thread, const pthread_attr_t* attr, void* (*start_routine)(void*), void* arg); è¿™ä¸ªå‡½æ•°å£°æ˜æœ‰å››ä¸ªå‚æ•°ï¼šthreadã€attrã€start_routine å’Œ argã€‚ç¬¬ä¸€ä¸ªå‚æ•° thread æ˜¯æŒ‡å‘ pthread_t ç±»å‹ç»“æ„çš„æŒ‡é’ˆï¼›æˆ‘ä»¬å°†ä½¿ç”¨è¯¥ç»“æ„ä¸çº¿ç¨‹äº¤äº’ï¼Œå› æ­¤éœ€è¦å°†å…¶ä¼ é€’ç»™ pthread_create() ä»¥å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚ ç¬¬äºŒä¸ªå‚æ•° attr ç”¨äºæŒ‡å®šè¯¥çº¿ç¨‹å¯èƒ½å…·æœ‰çš„ä»»ä½•å±æ€§ã€‚ä¾‹å¦‚åŒ…æ‹¬è®¾ç½®æ ˆå¤§å°æˆ–å¯èƒ½æœ‰å…³çº¿ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§çš„ä¿¡æ¯ã€‚é€šè¿‡å•ç‹¬è°ƒç”¨ pthread_attr_init() æ¥åˆå§‹åŒ–å±æ€§ï¼›æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ‰‹å†Œé¡µï¼šman pthread_createã€‚ç„¶è€Œï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé»˜è®¤å€¼å°±å¯ä»¥äº†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ç®€å•åœ°ä¼ é€’ NULL å€¼ã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æœ€å¤æ‚çš„ï¼Œä½†å®é™…ä¸Šåªæ˜¯è¯¢é—®ï¼šè¿™ä¸ªçº¿ç¨‹åº”è¯¥å¼€å§‹åœ¨å“ªä¸ªå‡½æ•°ä¸­è¿è¡Œï¼Ÿåœ¨ C ä¸­ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºå‡½æ•°æŒ‡é’ˆï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬é¢„æœŸçš„å†…å®¹ï¼šå‡½æ•°åç§°ï¼ˆstart_routineï¼‰ï¼Œå®ƒä¼ é€’ä¸€ä¸ªç±»å‹ä¸º void * çš„å•ä¸ªå‚æ•°ï¼ˆå¦‚start_routineåé¢çš„æ‹¬å·ä¸­æ‰€ç¤ºï¼‰ï¼Œä»¥åŠå®ƒè¿”å›ä¸€ä¸ª void * ç±»å‹çš„å€¼ï¼ˆå³ï¼Œä¸€ä¸ª void æŒ‡é’ˆï¼‰ã€‚å¦‚æœæ­¤ä¾‹ç¨‹éœ€è¦æ•´æ•°å‚æ•°è€Œä¸æ˜¯ void æŒ‡é’ˆï¼Œåˆ™å£°æ˜å°†å¦‚ä¸‹æ‰€ç¤ºï¼š int pthread_create(..., // first two args are the same void * (*start_routine)(int), int arg); å¦‚æœä¾‹ç¨‹çš„å‚æ•°æ˜¯ä¸€ä¸ª void æŒ‡é’ˆï¼Œä½†è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé‚£ä¹ˆå°±ä¼šæ˜¯è¿™æ ·ï¼š int pthread_create(..., // first two args are the same int (*start_routine)(void *), void * arg); æœ€åï¼Œç¬¬å››ä¸ªå‚æ•° arg æ­£æ˜¯è¦ä¼ é€’ç»™çº¿ç¨‹å¼€å§‹æ‰§è¡Œçš„å‡½æ•°çš„å‚æ•°ã€‚ä½ å¯èƒ½ä¼šé—®ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦è¿™äº› void æŒ‡é’ˆï¼Ÿç­”æ¡ˆå…¶å®å¾ˆç®€å•ï¼šå°† void æŒ‡é’ˆä½œä¸ºå‡½æ•°start_routineçš„å‚æ•°ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä¼ é€’ä»»ä½•ç±»å‹çš„å‚æ•°ï¼›å°†å®ƒä½œä¸ºè¿”å›å€¼ï¼Œå¯ä»¥è®©çº¿ç¨‹è¿”å›ä»»ä½•ç±»å‹çš„ç»“æœã€‚ è¿˜æœ‰å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœè¿è¡Œæ­£å¸¸ï¼Œåˆ™è¿”å› 0ï¼ˆå¦åˆ™ä¸ºé”™è¯¯ä»£ç ï¼šEAGAINã€EINVALã€EPERMï¼‰ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢è¿™æ®µä»£ç ã€‚ #include \u003cassert.h\u003e #include \u003cstdio.h\u003e #include \"common.h\" #include \"common_threads.h\" typedef struct { int a; int b; } myarg_t; void *mythread(void *arg) { myarg_t *args = (myarg_t *) arg; printf(\"%d %d\\n\", args-\u003ea, args-\u003eb); return NULL; } int main(int argc, char *argv[]) { pthread_t p; myarg_t args = { 10, 20 }; int rc = pthread_create(\u0026p, NULL, mythread, \u0026args); assert(rc == 0); (void) pthread_join(p, NULL); printf(\"done\\n\"); return 0; } åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä¼ é€’äº†ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶æ‰“åŒ…æˆæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å•ä¸€ç±»å‹ï¼ˆmyarg tï¼‰ã€‚çº¿ç¨‹åˆ›å»ºåï¼Œå¯ä»¥ç®€å•åœ°å°†å…¶å‚æ•°è½¬æ¢ä¸ºå®ƒæ‰€æœŸæœ›çš„ç±»å‹ï¼Œä»è€Œæ ¹æ®éœ€è¦è§£åŒ…å‚æ•°ã€‚å°±æ˜¯è¿™æ ·ï¼ä¸€æ—¦åˆ›å»ºäº†çº¿ç¨‹ï¼Œä½ å°±çœŸæ­£æ‹¥æœ‰äº†å¦ä¸€ä¸ªæ´»ç”Ÿç”Ÿçš„æ‰§è¡Œå®ä½“ï¼Œå®ƒæ‹¥æœ‰è‡ªå·±çš„è°ƒç”¨æ ˆï¼Œä¸ç¨‹åºä¸­å½“å‰å­˜åœ¨çš„æ‰€æœ‰çº¿ç¨‹è¿è¡Œåœ¨åŒä¸€åœ°å€ç©ºé—´ã€‚ç¨‹åºçš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š â¯ make thread_create gcc -o thread_create thread_create.c -Wall -Werror -I../include -pthread â¯ ./thread_create 10 20 done ","date":"2024-05-11","objectID":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/:1:0","tags":["OS"],"title":"çº¿ç¨‹API","uri":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ç­‰å¾…çº¿ç¨‹å®Œæˆ ä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³ç­‰å¾…çº¿ç¨‹å®Œæˆï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿä½ éœ€è¦åšä¸€äº›ç‰¹åˆ«çš„äº‹æƒ…æ‰èƒ½ç­‰å¾…å®Œæˆï¼›ç‰¹åˆ«æ˜¯ï¼Œæ‚¨å¿…é¡»è°ƒç”¨ä¾‹ç¨‹ pthread_join()ã€‚ int pthread_join(pthread_t thread, void **value_ptr); æ­¤ä¾‹ç¨‹éœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹æ˜¯ pthread_tï¼Œç”¨äºæŒ‡å®šç­‰å¾…å“ªä¸ªçº¿ç¨‹ã€‚è¯¥å˜é‡ç”±çº¿ç¨‹åˆ›å»ºä¾‹ç¨‹åˆå§‹åŒ–ï¼ˆå°†æŒ‡é’ˆä½œä¸ºå‚æ•°ä¼ é€’ç»™ pthread create()ï¼‰ï¼›å¦‚æœä¿ç•™è¯¥å˜é‡ï¼Œå°±å¯ä»¥ç”¨å®ƒæ¥ç­‰å¾…è¯¥çº¿ç¨‹ç»ˆæ­¢ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å‘ä½ æœŸæœ›è¿”å›å€¼çš„æŒ‡é’ˆã€‚ç”±äºè¯¥ä¾‹ç¨‹å¯ä»¥è¿”å›ä»»ä½•å€¼ï¼Œå› æ­¤å®ƒè¢«å®šä¹‰ä¸ºè¿”å› void çš„æŒ‡é’ˆï¼›ç”±äº pthread_join() ä¾‹ç¨‹ä¼šæ”¹å˜ä¼ å…¥å‚æ•°çš„å€¼ï¼Œå› æ­¤ä½ éœ€è¦ä¼ å…¥æŒ‡å‘è¯¥å€¼çš„æŒ‡é’ˆï¼Œè€Œä¸ä»…ä»…æ˜¯è¯¥å€¼æœ¬èº«ã€‚ è®©æˆ‘ä»¬çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼Œåœ¨ä»£ç ä¸­ï¼Œå†æ¬¡åˆ›å»ºäº†ä¸€ä¸ªå•çº¿ç¨‹ï¼Œå¹¶é€šè¿‡ myarg_t ç»“æ„ä¼ é€’äº†å‡ ä¸ªå‚æ•°ã€‚è¿”å›å€¼ä½¿ç”¨ myret_t ç±»å‹ã€‚ä¸€æ—¦çº¿ç¨‹è¿è¡Œå®Œæ¯•ï¼Œä¸€ç›´åœ¨ pthread_join() ä¾‹ç¨‹ ä¸­ç­‰å¾…çš„ä¸»çº¿ç¨‹å°±ä¼šè¿”å›ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®ä»çº¿ç¨‹è¿”å›çš„å€¼ï¼Œå³ myret_t ä¸­çš„å€¼ã€‚ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \"common.h\" #include \"common_threads.h\" typedef struct { int a; int b; } myarg_t; typedef struct { int x; int y; } myret_t; void *mythread(void *arg) { myarg_t *args = (myarg_t *) arg; printf(\"args %d %d\\n\", args-\u003ea, args-\u003eb); myret_t *rvals = malloc(sizeof(myret_t)); assert(rvals != NULL); rvals-\u003ex = 1; rvals-\u003ey = 2; return (void *) rvals; } int main(int argc, char *argv[]) { pthread_t p; myret_t *rvals; myarg_t args = { 10, 20 }; Pthread_create(\u0026p, NULL, mythread, \u0026args); Pthread_join(p, (void **) \u0026rvals); printf(\"returned %d %d\\n\", rvals-\u003ex, rvals-\u003ey); free(rvals); return 0; } å…³äºè¿™ä¸ªä¾‹å­ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚é¦–å…ˆï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¸å¿…å¯¹å‚æ•°è¿›è¡Œè¿™äº›ç—›è‹¦çš„æ‰“åŒ…å’Œæ‹†åŒ…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åªæ˜¯åˆ›å»ºä¸€ä¸ªä¸å¸¦å‚æ•°çš„çº¿ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºçº¿ç¨‹æ—¶å°† NULL ä½œä¸ºå‚æ•°ä¼ é€’è¿›å»ã€‚åŒæ ·ï¼Œå¦‚æœæˆ‘ä»¬ä¸å…³å¿ƒè¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥å°† NULL ä¼ é€’ç»™ pthread_join()ã€‚ å…¶æ¬¡ï¼Œå¦‚æœæˆ‘ä»¬åªä¼ é€’ä¸€ä¸ªå€¼ï¼ˆå¦‚ intï¼‰ï¼Œå°±ä¸å¿…å°†å…¶æ‰“åŒ…ä¸ºå‚æ•°ã€‚ å¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¿…å°†å‚æ•°å’Œè¿”å›å€¼æ‰“åŒ…åˆ°ç»“æ„å†…éƒ¨ã€‚ #include \u003cstdio.h\u003e #include \"common.h\" #include \"common_threads.h\" void *mythread(void *arg) { long long int value = (long long int) arg; printf(\"%lld\\n\", value); return (void *) (value + 1); } int main(int argc, char *argv[]) { pthread_t p; long long int rvalue; Pthread_create(\u0026p, NULL, mythread, (void *) 100); Pthread_join(p, (void **) \u0026rvalue); printf(\"returned %lld\\n\", rvalue); return 0; } ç¬¬ä¸‰ï¼Œæˆ‘ä»¬åº”è¯¥æ³¨æ„ï¼Œä»çº¿ç¨‹è¿”å›å€¼çš„æ–¹å¼å¿…é¡»éå¸¸è°¨æ…ã€‚å°¤å…¶æ˜¯ï¼Œåƒä¸‡ä¸è¦è¿”å›æŒ‡å‘çº¿ç¨‹è°ƒç”¨æ ˆä¸­åˆ†é…çš„æŒ‡é’ˆã€‚å¦‚æœè¿™æ ·åšï¼Œä½ è§‰å¾—ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ(æƒ³æƒ³å§ï¼ï¼‰ä¸‹é¢æ˜¯ä¸€æ®µå±é™©ä»£ç çš„ç¤ºä¾‹ï¼Œå®ƒæ˜¯æ ¹æ®ä¸Šé¢çš„ç¤ºä¾‹ä¿®æ”¹çš„ã€‚ void *mythread(void *arg) { myarg_t *m = (myarg_t *)arg; printf(\"%d %d\\n\", m-\u003ea, m-\u003eb); myret_t r; // ALLOCATED ON STACK: BAD! r.x = 1; r.y = 2; return (void *)\u0026r; } åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå˜é‡ r è¢«åˆ†é…åˆ° mythread çš„æ ˆä¸­ã€‚ç„¶è€Œï¼Œå½“å®ƒè¿”å›æ—¶ï¼Œè¯¥å€¼ä¼šè¢«è‡ªåŠ¨è§£é™¤åˆ†é…ï¼ˆæ¯•ç«Ÿè¿™å°±æ˜¯æ ˆå¦‚æ­¤æ˜“äºä½¿ç”¨çš„åŸå› ï¼ï¼‰ï¼Œå› æ­¤ï¼Œå°†æŒ‡å‘å·²è§£é™¤åˆ†é…çš„å˜é‡çš„æŒ‡é’ˆä¼ å›ä¼šå¯¼è‡´å„ç§ç³Ÿç³•çš„ç»“æœã€‚ æœ€åï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œä½¿ç”¨ pthread_create() åˆ›å»ºçº¿ç¨‹ï¼Œç„¶åç«‹å³è°ƒç”¨ pthread_join() æ˜¯ä¸€ç§éå¸¸å¥‡æ€ªçš„åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œæœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•å¯ä»¥å®Œæˆè¿™ä¸€ä»»åŠ¡ï¼Œé‚£å°±æ˜¯è¿‡ç¨‹è°ƒç”¨ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬é€šå¸¸è¦åˆ›å»ºä¸æ­¢ä¸€ä¸ªçº¿ç¨‹å¹¶ç­‰å¾…å®ƒå®Œæˆï¼Œå¦åˆ™ä½¿ç”¨çº¿ç¨‹å°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ã€‚ æˆ‘ä»¬åº”è¯¥æ³¨æ„ï¼Œå¹¶éæ‰€æœ‰å¤šçº¿ç¨‹ä»£ç éƒ½ä½¿ç”¨joinä¾‹ç¨‹ã€‚ä¾‹å¦‚ï¼Œå¤šçº¿ç¨‹ç½‘ç»œæœåŠ¡å™¨å¯èƒ½ä¼šåˆ›å»ºè®¸å¤šå·¥ä½œçº¿ç¨‹ï¼Œç„¶åä½¿ç”¨ä¸»çº¿ç¨‹æ¥å—è¯·æ±‚å¹¶å°†è¯·æ±‚æ— é™æœŸåœ°ä¼ é€’ç»™å·¥ä½œçº¿ç¨‹ã€‚å› æ­¤ï¼Œè¿™ç§é•¿å¯¿å‘½ç¨‹åºå¯èƒ½ä¸éœ€è¦joinã€‚ç„¶è€Œï¼Œåˆ›å»ºçº¿ç¨‹æ‰§è¡Œç‰¹å®šä»»åŠ¡ï¼ˆå¹¶è¡Œï¼‰çš„å¹¶è¡Œç¨‹åºå¯èƒ½ä¼šä½¿ç”¨ join æ¥ç¡®ä¿åœ¨é€€å‡ºæˆ–è¿›å…¥ä¸‹ä¸€é˜¶æ®µè®¡ç®—ä¹‹å‰ï¼Œæ‰€æœ‰è¿™äº›å·¥ä½œéƒ½å·²å®Œæˆã€‚ ","date":"2024-05-11","objectID":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/:2:0","tags":["OS"],"title":"çº¿ç¨‹API","uri":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 é” é™¤äº†çº¿ç¨‹åˆ›å»ºå’Œç­‰å¾…çº¿ç¨‹å®Œæˆä¹‹å¤–ï¼ŒPOSIX çº¿ç¨‹åº“æä¾›çš„ä¸‹ä¸€ç»„æœ€æœ‰ç”¨çš„å‡½æ•°å¯èƒ½å°±æ˜¯é‚£äº›é€šè¿‡é”ä¸ºä¸´ç•ŒåŒºæä¾›äº’æ–¥çš„å‡½æ•°äº†ã€‚ä¸ºæ­¤ç›®çš„ä½¿ç”¨çš„æœ€åŸºæœ¬çš„ä¸€å¯¹ä¾‹ç¨‹å¦‚ä¸‹ï¼š int pthread_mutex_lock(pthread_mutex_t *mutex); int pthread_mutex_unlock(pthread_mutex_t *mutex); ä¾‹ç¨‹åº”è¯¥æ˜“äºç†è§£å’Œä½¿ç”¨ã€‚å½“æ‚¨çš„ä»£ç åŒºåŸŸæ˜¯ä¸´ç•ŒåŒºï¼Œå› æ­¤éœ€è¦å—åˆ°ä¿æŠ¤ä»¥ç¡®ä¿æ­£ç¡®æ“ä½œæ—¶ï¼Œé”éå¸¸æœ‰ç”¨ã€‚ä½ å¤§æ¦‚å¯ä»¥æƒ³è±¡ä»£ç çš„æ ·å­ï¼š pthread_mutex_t lock; pthread_mutex_lock(\u0026lock); x = x + 1; // æˆ–è€…ä¸ç®¡ä½ çš„ä¸´ç•ŒåŒºæ˜¯ä»€ä¹ˆ pthread_mutex_unlock(\u0026lock); ä»£ç çš„æ„å›¾å¦‚ä¸‹ï¼šå¦‚æœè°ƒç”¨ pthread_mutex_lock() æ—¶æ²¡æœ‰å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼Œåˆ™è¯¥çº¿ç¨‹å°†è·å–é”å¹¶è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹ç¡®å®æŒæœ‰é”ï¼Œåˆ™å°è¯•è·å–é”çš„çº¿ç¨‹å°†ä¸ä¼šä»è°ƒç”¨ä¸­è¿”å›ï¼Œç›´åˆ°å®ƒè·å¾—é”ï¼ˆè¿™æ„å‘³ç€æŒæœ‰é”çš„çº¿ç¨‹å·²é€šè¿‡unlockè°ƒç”¨é‡Šæ”¾äº†é”ï¼‰ã€‚å½“ç„¶ï¼Œåœ¨ç»™å®šæ—¶é—´ï¼Œè®¸å¤šçº¿ç¨‹å¯èƒ½ä¼šå¡åœ¨é”è·å–å‡½æ•°å†…ç­‰å¾…ï¼›ç„¶è€Œï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰åº”è¯¥è°ƒç”¨unlockã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ®µä»£ç åœ¨ä¸¤ä¸ªé‡è¦æ–¹é¢è¢«ç ´åäº†ã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ç¼ºä¹æ­£ç¡®çš„åˆå§‹åŒ–ã€‚æ‰€æœ‰é”éƒ½å¿…é¡»æ­£ç¡®åˆå§‹åŒ–ï¼Œä»¥ä¿è¯å®ƒä»¬å…·æœ‰æ­£ç¡®çš„å€¼ï¼Œä»è€Œåœ¨è°ƒç”¨lockå’Œunlockæ—¶æŒ‰éœ€è¦å·¥ä½œã€‚ å¯¹äº POSIX çº¿ç¨‹ï¼Œæœ‰ä¸¤ç§åˆå§‹åŒ–é”çš„æ–¹æ³•ã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ PTHREAD_MUTEX_INITIALIZERï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER; è¿™æ ·åšä¼šå°†é”è®¾ç½®ä¸ºé»˜è®¤å€¼ï¼Œä»è€Œä½¿é”å¯ç”¨ã€‚åŠ¨æ€æ–¹æ³•ï¼ˆå³åœ¨è¿è¡Œæ—¶ï¼‰æ˜¯è°ƒç”¨ pthread_mutex_init()ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š int rc = pthread_mutex_init(\u0026lock, NULL); assert(rc == 0 \u0026\u0026 â€œError in mutex initâ€); è¯¥ä¾‹ç¨‹çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”æœ¬èº«çš„åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ç»„å¯é€‰å±æ€§ã€‚ä¼ é€’ NULL å³åªéœ€ä½¿ç”¨é»˜è®¤å€¼å³å¯ã€‚ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ï¼Œä½†æˆ‘ä»¬é€šå¸¸ä½¿ç”¨åŠ¨æ€ï¼ˆåä¸€ç§ï¼‰æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨å®Œé”åï¼Œè¿˜éœ€è¦è°ƒç”¨ pthread_mutex_destroy()ã€‚ ä¸Šè¿°ä»£ç çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œå®ƒåœ¨è°ƒç”¨lockå’Œunlockæ—¶æ²¡æœ‰æ£€æŸ¥é”™è¯¯ä»£ç ã€‚å°±åƒä½ åœ¨ UNIX ç³»ç»Ÿä¸­è°ƒç”¨çš„å‡ ä¹æ‰€æœ‰åº“ä¾‹ç¨‹ä¸€æ ·ï¼Œè¿™äº›ä¾‹ç¨‹ä¹Ÿå¯èƒ½å¤±è´¥ï¼å¦‚æœä½ çš„ä»£ç æ²¡æœ‰æ­£ç¡®æ£€æŸ¥é”™è¯¯ä»£ç ï¼Œå¤±è´¥å°±ä¼šæ— å£°æ— æ¯åœ°å‘ç”Ÿï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå…è®¸å¤šä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºæ®µã€‚åœ¨æœ€ä½é™åº¦ä¸Šï¼Œåº”ä½¿ç”¨åŒ…è£…å™¨æ¥æ–­è¨€ä¾‹ç¨‹æˆåŠŸï¼ˆå¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼‰ï¼›æ›´å¤æ‚çš„ï¼ˆéç©å…·ï¼‰ç¨‹åºåœ¨å‡ºé”™æ—¶ä¸èƒ½ç®€å•åœ°é€€å‡ºï¼Œè€Œåº”æ£€æŸ¥å¤±è´¥ï¼Œå¹¶åœ¨lockæˆ–unlockä¸æˆåŠŸæ—¶é‡‡å–é€‚å½“çš„æªæ–½ã€‚ // Use this to keep your code clean but check for failures // Only use if exiting program is OK upon failure void Pthread_mutex_lock(pthread_mutex_t *mutex) { int rc = pthread_mutex_lock(mutex); assert(rc == 0 \u0026\u0026 â€œError in acquireâ€); } lockå’Œunlockä¾‹ç¨‹å¹¶ä¸æ˜¯ pthreads åº“ä¸­ä¸é”äº¤äº’çš„å”¯ä¸€ä¾‹ç¨‹ã€‚è¿™é‡Œè¿˜æœ‰ä¸¤ä¸ªä¾‹ç¨‹å¯èƒ½å€¼å¾—å…³æ³¨ï¼š int pthread_mutex_trylock(pthread_mutex_t *mutex); int pthread_mutex_timedlock(pthread_mutex_t *mutex, struct timespec *abs_timeout); è¿™ä¸¤ä¸ªè°ƒç”¨ç”¨äºè·å–é”ã€‚å¦‚æœé”å·²è¢«æŒæœ‰ï¼Œtrylock ç‰ˆæœ¬ä¼šè¿”å›å¤±è´¥ï¼›è·å–é”çš„ timedlock ç‰ˆæœ¬ä¼šåœ¨è¶…æ—¶æˆ–è·å–é”åè¿”å›ï¼Œä»¥å…ˆå‘ç”Ÿè€…ä¸ºå‡†ã€‚å› æ­¤ï¼Œè¶…æ—¶åçš„ timedlock ä¼šé€€åŒ–ä¸º trylockã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½åº”è¯¥é¿å…ï¼›ä¸è¿‡ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé¿å…å¡åœ¨ï¼ˆä¹Ÿè®¸æ˜¯æ— é™æœŸåœ°ï¼‰é”è·å–ä¾‹ç¨‹ä¸­æ˜¯æœ‰ç”¨çš„ã€‚ ","date":"2024-05-11","objectID":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/:3:0","tags":["OS"],"title":"çº¿ç¨‹API","uri":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 æ¡ä»¶å˜é‡ ä»»ä½•çº¿ç¨‹åº“çš„å¦ä¸€ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬ POSIX çº¿ç¨‹ï¼Œå°±æ˜¯æ¡ä»¶å˜é‡çš„å­˜åœ¨ã€‚å½“çº¿ç¨‹ä¹‹é—´å¿…é¡»è¿›è¡ŒæŸç§ä¿¡å·ä¼ é€’æ—¶ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹åšæŸäº‹ï¼Œç„¶åæ‰èƒ½ç»§ç»­ï¼Œé‚£ä¹ˆæ¡ä»¶å˜é‡å°±éå¸¸æœ‰ç”¨ã€‚å¸Œæœ›ä»¥è¿™ç§æ–¹å¼è¿›è¡Œäº¤äº’çš„ç¨‹åºä¸»è¦ä½¿ç”¨ä¸¤ä¸ªä¾‹ç¨‹ï¼š int pthread_cond_wait(pthread_cond_t *cond, pthread_mutex_t *mutex); int pthread_cond_signal(pthread_cond_t *cond); è¦ä½¿ç”¨æ¡ä»¶å˜é‡ï¼Œè¿˜å¿…é¡»æ‹¥æœ‰ä¸è¯¥æ¡ä»¶å…³è”çš„é”ã€‚å½“è°ƒç”¨ä¸Šè¿°ä»»ä¸€ä¾‹ç¨‹æ—¶ï¼Œåº”ä¿æŒæ­¤é”ã€‚ ç¬¬ä¸€ä¸ªä¾‹ç¨‹ pthread_cond_wait() ä½¿è°ƒç”¨çº¿ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œä»è€Œç­‰å¾…å…¶ä»–çº¿ç¨‹å‘å…¶å‘å‡ºä¿¡å·ï¼Œé€šå¸¸æ˜¯åœ¨ç¨‹åºä¸­çš„æŸäº›å†…å®¹å‘ç”Ÿæ›´æ”¹è€Œç°åœ¨æ­£åœ¨ç¡çœ çš„çº¿ç¨‹å¯èƒ½å…³å¿ƒçš„æƒ…å†µä¸‹ã€‚å…¸å‹çš„ç”¨æ³•å¦‚ä¸‹ï¼š pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER; pthread_cond_t cond = PTHREAD_COND_INITIALIZER; Pthread_mutex_lock(\u0026lock); while (ready == 0) Pthread_cond_wait(\u0026cond, \u0026lock); Pthread_mutex_unlock(\u0026lock); åœ¨æ­¤ä»£ç ä¸­ï¼Œåœ¨åˆå§‹åŒ–ç›¸å…³é”å’Œæ¡ä»¶ä¹‹åï¼Œçº¿ç¨‹æ£€æŸ¥å˜é‡readyæ˜¯å¦å·²è®¾ç½®ä¸ºéé›¶çš„å€¼ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯¥çº¿ç¨‹åªéœ€è°ƒç”¨ç­‰å¾…ä¾‹ç¨‹å³å¯ä¼‘çœ ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹å°†å…¶å”¤é†’ã€‚å”¤é†’ä¸€ä¸ªçº¿ç¨‹çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œè¯¥ä»£ç å°†åœ¨å…¶ä»–çº¿ç¨‹ä¸­è¿è¡Œï¼š Pthread_mutex_lock(\u0026lock); ready = 1; Pthread_cond_signal(\u0026cond); Pthread_mutex_unlock(\u0026lock); å…³äºè¿™ä¸ªä»£ç åºåˆ—ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚é¦–å…ˆï¼Œåœ¨å‘é€ä¿¡å·æ—¶ï¼ˆä»¥åŠä¿®æ”¹å…¨å±€å˜é‡ ready æ—¶ï¼‰ï¼Œæˆ‘ä»¬å§‹ç»ˆè¦ç¡®ä¿lockã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æˆ‘ä»¬çš„ä»£ç ä¸ä¼šæ„å¤–å¼•å…¥ç«äº‰æ¡ä»¶ã€‚ å…¶æ¬¡ï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œwait è°ƒç”¨çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯é”ï¼Œè€Œ signal è°ƒç”¨åªéœ€è¦ä¸€ä¸ªæ¡ä»¶ã€‚é€ æˆè¿™ç§å·®å¼‚çš„åŸå› æ˜¯ï¼Œwait è°ƒç”¨é™¤äº†è®©è°ƒç”¨çº¿ç¨‹ä¼‘çœ å¤–ï¼Œè¿˜ä¼šåœ¨è®©è°ƒç”¨è€…ä¼‘çœ æ—¶é‡Šæ”¾é”ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸è¿™æ ·åšï¼Œå…¶ä»–çº¿ç¨‹æ€ä¹ˆå¯èƒ½è·å¾—é”å¹¶å‘å‡ºä¿¡å·å”¤é†’å®ƒå‘¢ï¼Ÿä¸è¿‡ï¼Œåœ¨è¢«å”¤é†’åè¿”å›ä¹‹å‰ï¼Œpthread_cond_wait() ä¼šé‡æ–°è·å–é”ï¼Œä»è€Œç¡®ä¿åœ¨ç­‰å¾…åºåˆ—å¼€å§‹æ—¶è·å–é”å’Œç»“æŸæ—¶é‡Šæ”¾é”ä¹‹é—´çš„ä»»ä½•æ—¶é—´ï¼Œç­‰å¾…çº¿ç¨‹éƒ½æŒæœ‰é”ã€‚ æœ€åä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼šç­‰å¾…çº¿ç¨‹åœ¨ while å¾ªç¯ä¸­é‡æ–°æ£€æŸ¥æ¡ä»¶ï¼Œè€Œä¸æ˜¯ç®€å•çš„ if è¯­å¥ã€‚å› ä¸ºä½¿ç”¨ while å¾ªç¯æ˜¯ç®€å•å®‰å…¨çš„åšæ³•ã€‚è™½ç„¶å®ƒä¼šé‡æ–°æ£€æŸ¥æ¡ä»¶ï¼ˆå¯èƒ½ä¼šå¢åŠ ä¸€ç‚¹å¼€é”€ï¼‰ï¼Œä½†æœ‰äº› pthread å®ç°å¯èƒ½ä¼šé”™è¯¯åœ°å”¤é†’ç­‰å¾…çº¿ç¨‹ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸é‡æ–°æ£€æŸ¥ï¼Œç­‰å¾…çº¿ç¨‹å°±ä¼šç»§ç»­è®¤ä¸ºæ¡ä»¶æ”¹å˜ï¼Œå³ä½¿å®ƒå¹¶æ²¡æœ‰æ”¹å˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ï¼Œè€Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹åº”è¯¥æŠ“å–æ•°æ®ï¼ˆç”Ÿäº§è€…-æ¶ˆè´¹è€…ï¼‰ã€‚å› æ­¤ï¼Œæ›´å®‰å…¨çš„åšæ³•æ˜¯å°†å”¤é†’è§†ä¸ºå¯èƒ½å·²å‘ç”Ÿå˜åŒ–çš„æç¤ºï¼Œè€Œä¸æ˜¯ç»å¯¹çš„äº‹å®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰æ—¶åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ ‡å¿—æ¥å‘å‡ºä¿¡å·ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ¡ä»¶å˜é‡å’Œç›¸å…³çš„é”ï¼Œè¿™å¾ˆæœ‰è¯±æƒ‘åŠ›ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™ä¸Šé¢çš„ç­‰å¾…ä»£ç ï¼Œåœ¨ç­‰å¾…ä»£ç ä¸­çœ‹èµ·æ¥æ›´åƒè¿™æ ·ï¼š while (ready == 0) ; // spin ç›¸å…³çš„ä¿¡å·ä»£ç å¦‚ä¸‹ï¼š ready = 1; æ°¸è¿œä¸è¦è¿™æ ·åšï¼ŒåŸå› å¦‚ä¸‹ã€‚é¦–å…ˆï¼Œå®ƒåœ¨å¾ˆå¤šæƒ…å†µä¸‹è¡¨ç°ä¸ä½³ï¼ˆé•¿æ—¶é—´è‡ªæ—‹ï¼Œå³æŒç»­æ£€æŸ¥æŸä¸ªæ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œè¿™åªä¼šæµªè´¹ CPU å‘¨æœŸï¼‰ã€‚å…¶æ¬¡ï¼Œå®¹æ˜“å‡ºé”™ã€‚ä½¿ç”¨æ ‡å¿—ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰åœ¨çº¿ç¨‹ä¹‹é—´è¿›è¡ŒåŒæ­¥æ—¶éå¸¸å®¹æ˜“å‡ºé”™ã€‚ ","date":"2024-05-11","objectID":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/:4:0","tags":["OS"],"title":"çº¿ç¨‹API","uri":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 çº¿ç¨‹APIæŒ‡å— å½“ä½ ä½¿ç”¨POSIXçº¿ç¨‹åº“ï¼ˆæˆ–è€…å®é™…ä¸Šï¼Œä»»ä½•çº¿ç¨‹åº“ï¼‰æ„å»ºä¸€ä¸ªå¤šçº¿ç¨‹ç¨‹åºæ—¶ï¼Œæœ‰ä¸€äº›å°ä½†é‡è¦çš„äº‹æƒ…éœ€è¦è®°ä½ã€‚å®ƒä»¬åŒ…æ‹¬ï¼š **ä¿æŒç®€å•ã€‚**æœ€é‡è¦çš„æ˜¯ï¼Œä»»ä½•æ¶‰åŠçº¿ç¨‹ä¹‹é—´çš„é”å®šæˆ–ä¿¡å·çš„ä»£ç éƒ½åº”å°½å¯èƒ½ç®€å•ã€‚å¤æ‚çš„çº¿ç¨‹äº¤äº’ä¼šå¯¼è‡´é”™è¯¯ã€‚ **æœ€å°åŒ–çº¿ç¨‹äº¤äº’ã€‚**å°½é‡å‡å°‘çº¿ç¨‹ä¹‹é—´äº¤äº’çš„æ–¹å¼ã€‚æ¯ä¸ªäº¤äº’éƒ½åº”è¯¥ç»è¿‡æ·±æ€ç†Ÿè™‘ï¼Œå¹¶ç”¨ç»è¿‡éªŒè¯çš„æ–¹æ³•æ„å»ºã€‚ **åˆå§‹åŒ–é”å’Œæ¡ä»¶å˜é‡ã€‚**æœªåˆå§‹åŒ–å°†å¯¼è‡´ä»£ç æœ‰æ—¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œæœ‰æ—¶ä¼šä»¥éå¸¸å¥‡æ€ªçš„æ–¹å¼å¤±è´¥ã€‚ **æ£€æŸ¥è¿”å›ç ã€‚**å½“ç„¶ï¼Œåœ¨ä½ æ‰€åšçš„ä»»ä½•Cå’ŒUNIXç¼–ç¨‹ä¸­ï¼Œä½ éƒ½åº”è¯¥æ£€æŸ¥æ¯ä¸€ä¸ªè¿”å›ç ï¼Œè¿™åœ¨è¿™é‡Œä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ä¸è¿™æ ·åšå°†å¯¼è‡´å¥‡æ€ªä¸”éš¾ä»¥ç†è§£çš„è¡Œä¸ºã€‚ **åœ¨ä¼ é€’å‚æ•°ç»™çº¿ç¨‹å’Œä»çº¿ç¨‹è¿”å›å€¼æ—¶è¦å°å¿ƒã€‚**ç‰¹åˆ«æ˜¯ï¼Œä»»ä½•æ—¶å€™ä½ ä¼ é€’æŒ‡å‘æ ˆä¸Šåˆ†é…çš„å˜é‡çš„å¼•ç”¨æ—¶ï¼Œä½ å¯èƒ½åœ¨åšä¸€äº›é”™è¯¯çš„äº‹æƒ…ã€‚ **æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆã€‚**ä¸ä¸Šé¢çš„è§‚ç‚¹ç›¸å…³ï¼Œè¯·è®°ä½æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆã€‚å› æ­¤ï¼Œå¦‚æœä½ åœ¨æŸä¸ªçº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°ä¸­æœ‰ä¸€ä¸ªåœ¨æœ¬åœ°åˆ†é…çš„å˜é‡ï¼Œå®ƒåŸºæœ¬ä¸Šæ˜¯ç§æœ‰çš„ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•ï¼ˆè½»æ˜“ï¼‰è®¿é—®å®ƒã€‚è¦åœ¨çº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®ï¼Œè¿™äº›å€¼å¿…é¡»åœ¨å †ä¸Šæˆ–è€…ä»¥å…¶ä»–å…¨å±€å¯è®¿é—®çš„ä½ç½®ã€‚ **æ€»æ˜¯ä½¿ç”¨æ¡ä»¶å˜é‡æ¥åœ¨çº¿ç¨‹ä¹‹é—´è¿›è¡Œä¿¡å·ä¼ é€’ã€‚**è™½ç„¶ä½¿ç”¨ç®€å•çš„æ ‡å¿—å¾€å¾€å¾ˆè¯±äººï¼Œä½†ä¸è¦è¿™æ ·åšã€‚ **ä½¿ç”¨æ‰‹å†Œé¡µé¢ã€‚**ç‰¹åˆ«æ˜¯åœ¨Linuxä¸Šï¼Œpthreadæ‰‹å†Œé¡µé¢éå¸¸æœ‰ä¿¡æ¯é‡ã€‚ ","date":"2024-05-11","objectID":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/:5:0","tags":["OS"],"title":"çº¿ç¨‹API","uri":"/posts/20.%E7%BA%BF%E7%A8%8Bapi/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†æ“ä½œç³»ç»Ÿæ‰§è¡Œçš„åŸºæœ¬æŠ½è±¡çš„å‘å±•ã€‚æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•å°†å•ä¸ªç‰©ç† CPU è½¬å˜ä¸ºå¤šä¸ªè™šæ‹Ÿ CPUï¼Œä»è€Œå®ç°å¤šä¸ªç¨‹åºåŒæ—¶è¿è¡Œçš„é”™è§‰ã€‚æˆ‘ä»¬è¿˜äº†è§£äº†å¦‚ä½•ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ›å»ºä¸€ä¸ªå¤§çš„ã€ç§æœ‰çš„è™šæ‹Ÿå†…å­˜ï¼›å½“æ“ä½œç³»ç»Ÿç¡®å®åœ¨ç‰©ç†å†…å­˜ï¼ˆæœ‰æ—¶æ˜¯ç£ç›˜ï¼‰ä¸Šç§˜å¯†å¤ç”¨åœ°å€ç©ºé—´æ—¶ï¼Œåœ°å€ç©ºé—´çš„è¿™ç§æŠ½è±¡ä½¿æ¯ä¸ªç¨‹åºçš„è¡Œä¸ºå°±å¥½åƒå®ƒæ‹¥æœ‰è‡ªå·±çš„å†…å­˜ä¸€æ ·ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸ºå•ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å¼•å…¥äº†ä¸€ç§æ–°çš„æŠ½è±¡ï¼šçº¿ç¨‹ã€‚æˆ‘ä»¬é€šå¸¸è®¤ä¸ºç¨‹åºä¸­åªæœ‰ä¸€ä¸ªæ‰§è¡Œç‚¹ï¼ˆå³ä»ä¸€å° PC è·å–æŒ‡ä»¤å¹¶æ‰§è¡Œï¼‰ï¼Œè€Œå¤šçº¿ç¨‹ç¨‹åºåˆ™æœ‰å¤šä¸ªæ‰§è¡Œç‚¹ï¼ˆå³å¤šå° PCï¼Œæ¯å° PC è·å–æŒ‡ä»¤å¹¶æ‰§è¡Œï¼‰ã€‚ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥æ¢ä¸ªè§’åº¦æ¥ç†è§£ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å¾ˆåƒä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½†æœ‰ä¸€ç‚¹ä¸åŒï¼šå®ƒä»¬å…±äº«ç›¸åŒçš„åœ°å€ç©ºé—´ï¼Œå› æ­¤å¯ä»¥è®¿é—®ç›¸åŒçš„æ•°æ®ã€‚ å› æ­¤ï¼Œå•ä¸ªçº¿ç¨‹çš„çŠ¶æ€ä¸è¿›ç¨‹çš„çŠ¶æ€éå¸¸ç›¸ä¼¼ã€‚å®ƒæœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ (PC)ï¼Œç”¨äºè·Ÿè¸ªç¨‹åºä»ä½•å¤„è·å–æŒ‡ä»¤ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ä¸€ç»„ç”¨äºè®¡ç®—çš„ç§æœ‰å¯„å­˜å™¨ï¼›å› æ­¤ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹åœ¨å•ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œï¼Œåˆ™å½“ä»è¿è¡Œä¸€ä¸ªçº¿ç¨‹ (T1) åˆ‡æ¢åˆ°è¿è¡Œå¦ä¸€ä¸ªçº¿ç¨‹ (T2) æ—¶ï¼Œå¿…é¡»è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚çº¿ç¨‹ä¹‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸è¿›ç¨‹ä¹‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢éå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºåœ¨è¿è¡ŒT2ä¹‹å‰å¿…é¡»ä¿å­˜T1çš„å¯„å­˜å™¨çŠ¶æ€å¹¶æ¢å¤T2çš„å¯„å­˜å™¨çŠ¶æ€ã€‚å¯¹äºè¿›ç¨‹ï¼Œæˆ‘ä»¬å°†çŠ¶æ€ä¿å­˜åˆ°è¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰ï¼›ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹æ§åˆ¶å—ï¼ˆTCBï¼‰æ¥å­˜å‚¨è¿›ç¨‹çš„æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€ã€‚ä¸è¿‡ï¼Œä¸è¿›ç¨‹ç›¸æ¯”ï¼Œæˆ‘ä»¬åœ¨çº¿ç¨‹ä¹‹é—´æ‰§è¡Œçš„ä¸Šä¸‹æ–‡åˆ‡æ¢æœ‰ä¸€ä¸ªä¸»è¦åŒºåˆ«ï¼šåœ°å€ç©ºé—´ä¿æŒä¸å˜ï¼ˆå³æ— éœ€åˆ‡æ¢æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„é¡µè¡¨ï¼‰ã€‚ çº¿ç¨‹ä¸è¿›ç¨‹çš„å¦ä¸€ä¸ªä¸»è¦åŒºåˆ«ä¸æ ˆæœ‰å…³ã€‚åœ¨æˆ‘ä»¬å¯¹ä¼ ç»Ÿè¿›ç¨‹ï¼ˆæˆ‘ä»¬ç°åœ¨å¯ä»¥ç§°ä¹‹ä¸ºå•çº¿ç¨‹è¿›ç¨‹ï¼‰åœ°å€ç©ºé—´çš„ç®€å•æ¨¡å‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæ ˆï¼Œé€šå¸¸ä½äºåœ°å€ç©ºé—´çš„åº•éƒ¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå·¦ï¼‰ã€‚ ä½†æ˜¯ï¼Œåœ¨å¤šçº¿ç¨‹è¿›ç¨‹ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯ç‹¬ç«‹è¿è¡Œçš„ï¼Œå½“ç„¶ä¹Ÿä¼šè°ƒç”¨å„ç§ä¾‹ç¨‹æ¥å®Œæˆè‡ªå·±çš„å·¥ä½œã€‚åœ°å€ç©ºé—´ä¸­çš„å †æ ˆä¸æ˜¯å•ä¸€çš„ï¼Œè€Œæ˜¯æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤šçº¿ç¨‹è¿›ç¨‹ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆäº§ç”Ÿçš„åœ°å€ç©ºé—´çœ‹èµ·æ¥å°±ä¸ä¸€æ ·äº†ï¼ˆä¸Šå›¾å³ï¼‰ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ•´ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åˆ†å¸ƒç€ä¸¤ä¸ªæ ˆã€‚å› æ­¤ï¼Œä»»ä½•æ ˆåˆ†é…çš„å˜é‡ã€å‚æ•°ã€è¿”å›å€¼ä»¥åŠå…¶ä»–æˆ‘ä»¬æ”¾åœ¨æ ˆä¸Šçš„ä¸œè¥¿éƒ½å°†è¢«æ”¾åœ¨æœ‰æ—¶è¢«ç§°ä¸ºçº¿ç¨‹æœ¬åœ°å­˜å‚¨çš„åœ°æ–¹ï¼Œå³ç›¸å…³çº¿ç¨‹çš„æ ˆä¸­ã€‚ ä½ å¯èƒ½è¿˜ä¼šæ³¨æ„åˆ°ï¼Œè¿™ç ´åäº†æˆ‘ä»¬ç¾ä¸½çš„åœ°å€ç©ºé—´å¸ƒå±€ã€‚ä»¥å‰ï¼Œæ ˆå’Œå †å¯ä»¥ç‹¬ç«‹å¢é•¿ï¼Œåªæœ‰å½“åœ°å€ç©ºé—´ç©ºé—´ä¸è¶³æ—¶æ‰ä¼šå‡ºç°é—®é¢˜ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å†æœ‰è¿™æ ·å¥½çš„æƒ…å†µäº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™é€šå¸¸æ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºæ ˆä¸€èˆ¬ä¸éœ€è¦å¾ˆå¤§ï¼ˆå¤§é‡ä½¿ç”¨é€’å½’çš„ç¨‹åºé™¤å¤–ï¼‰ã€‚ ","date":"2024-05-11","objectID":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/:0:0","tags":["OS"],"title":"å¹¶å‘å’Œçº¿ç¨‹","uri":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹ åœ¨äº†è§£çº¿ç¨‹çš„ç»†èŠ‚å’Œç¼–å†™å¤šçº¿ç¨‹ç¨‹åºæ—¶å¯èƒ½é‡åˆ°çš„ä¸€äº›é—®é¢˜ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå›ç­”ä¸€ä¸ªæ›´ç®€å•çš„é—®é¢˜ã€‚ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹ï¼Ÿ äº‹å®è¯æ˜ï¼Œä½¿ç”¨çº¿ç¨‹è‡³å°‘æœ‰ä¸¤ä¸ªä¸»è¦åŸå› ã€‚ç¬¬ä¸€ä¸ªåŸå› å¾ˆç®€å•ï¼šå¹¶è¡Œæ€§ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªå¯¹å¤§å‹æ•°ç»„æ‰§è¡Œæ“ä½œçš„ç¨‹åºï¼Œä¾‹å¦‚ï¼Œå°†ä¸¤ä¸ªå¤§å‹æ•°ç»„ç›¸åŠ ï¼Œæˆ–å°†æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„å€¼é€’å¢ä¸€å®šé‡ã€‚å¦‚æœåªåœ¨å•ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œï¼Œä»»åŠ¡å°±å¾ˆç®€å•ï¼šåªéœ€æ‰§è¡Œæ¯ä¸ªæ“ä½œå³å¯å®Œæˆã€‚ä½†æ˜¯ï¼Œå¦‚æœåœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸Šæ‰§è¡Œç¨‹åºï¼Œåˆ™å¯ä»¥é€šè¿‡ä½¿ç”¨å¤„ç†å™¨åˆ†åˆ«æ‰§è¡Œéƒ¨åˆ†æ“ä½œæ¥å¤§å¤§åŠ å¿«è¿™ä¸€è¿‡ç¨‹ã€‚å°†æ ‡å‡†çš„å•çº¿ç¨‹ç¨‹åºè½¬æ¢ä¸ºèƒ½åœ¨å¤šä¸ª CPU ä¸Šå®Œæˆæ­¤ç±»å·¥ä½œçš„ç¨‹åºçš„ä»»åŠ¡ç§°ä¸ºå¹¶è¡ŒåŒ–ï¼Œè€Œåœ¨æ¯ä¸ª CPU ä¸Šä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ¥å®Œæˆè¿™é¡¹å·¥ä½œæ˜¯ä½¿ç¨‹åºåœ¨ç°ä»£ç¡¬ä»¶ä¸Šè¿è¡Œå¾—æ›´å¿«çš„ä¸€ç§è‡ªç„¶è€Œå…¸å‹çš„æ–¹æ³•ã€‚ ç¬¬äºŒä¸ªåŸå› æ¯”è¾ƒå¾®å¦™ï¼šé¿å…å›  I/O é€Ÿåº¦æ…¢è€Œå¯¼è‡´ç¨‹åºè¿›ç¨‹å—é˜»ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªæ‰§è¡Œä¸åŒç±»å‹ I/O çš„ç¨‹åºï¼šç­‰å¾…å‘é€æˆ–æ¥æ”¶æ¶ˆæ¯ï¼Œç­‰å¾…æ˜¾å¼ç£ç›˜ I/O å®Œæˆï¼Œç”šè‡³ï¼ˆéšå¼ï¼‰ç­‰å¾…é¡µé¢æ•…éšœå®Œæˆã€‚ä¸å…¶ç­‰å¾…ï¼Œä½ çš„ç¨‹åºå¯èƒ½å¸Œæœ›åšå…¶ä»–äº‹æƒ…ï¼ŒåŒ…æ‹¬åˆ©ç”¨ CPU è¿›è¡Œè®¡ç®—ï¼Œç”šè‡³å‘å‡ºæ›´å¤š I/O è¯·æ±‚ã€‚ä½¿ç”¨çº¿ç¨‹æ˜¯é¿å…å¡æ­»çš„ä¸€ç§è‡ªç„¶æ–¹æ³•ï¼›å½“ç¨‹åºä¸­çš„ä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ï¼ˆå³ç­‰å¾… I/O æ—¶è¢«é˜»å¡ï¼‰æ—¶ï¼ŒCPU è°ƒåº¦å™¨å¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–çº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹å·²ç»å‡†å¤‡å¥½è¿è¡Œå¹¶åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ã€‚çº¿ç¨‹å¯ä»¥ä½¿ I/O ä¸å•ä¸ªç¨‹åºä¸­çš„å…¶ä»–æ´»åŠ¨é‡å ï¼Œå°±åƒè·¨ç¨‹åºè¿›ç¨‹çš„å¤šç¼–ç¨‹ä¸€æ ·ï¼›å› æ­¤ï¼Œè®¸å¤šåŸºäºæœåŠ¡å™¨çš„ç°ä»£åº”ç”¨ç¨‹åºï¼ˆç½‘ç»œæœåŠ¡å™¨ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç­‰ï¼‰åœ¨å…¶å®ç°ä¸­éƒ½ä½¿ç”¨äº†çº¿ç¨‹ã€‚ å½“ç„¶ï¼Œåœ¨ä¸Šè¿°ä»»ä½•ä¸€ç§æƒ…å†µä¸‹ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨å¤šè¿›ç¨‹æ¥ä»£æ›¿çº¿ç¨‹ã€‚ä¸è¿‡ï¼Œçº¿ç¨‹å…±äº«åœ°å€ç©ºé—´ï¼Œå› æ­¤å¾ˆå®¹æ˜“å…±äº«æ•°æ®ï¼Œå› æ­¤æ˜¯æ„å»ºè¿™ç±»ç¨‹åºæ—¶çš„è‡ªç„¶é€‰æ‹©ã€‚è€Œå¯¹äºé€»è¾‘ä¸Šç‹¬ç«‹çš„ä»»åŠ¡ï¼Œå‡ ä¹ä¸éœ€è¦å…±äº«å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼Œè¿›ç¨‹åˆ™æ˜¯æ›´åˆç†çš„é€‰æ‹©ã€‚ ","date":"2024-05-11","objectID":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/:1:0","tags":["OS"],"title":"å¹¶å‘å’Œçº¿ç¨‹","uri":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ç¤ºä¾‹ï¼šçº¿ç¨‹åˆ›å»º è®©æˆ‘ä»¬æ¥äº†è§£ä¸€äº›ç»†èŠ‚ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œåˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åšä¸€äº›ç‹¬ç«‹çš„å·¥ä½œï¼Œåœ¨æœ¬ä¾‹ä¸­å°±æ˜¯æ‰“å° â€œA â€œæˆ– â€œBâ€ï¼Œä»£ç å¦‚ä¸‹ã€‚ #include \u003cstdio.h\u003e #include \u003cassert.h\u003e #include \u003cpthread.h\u003e #include \"common.h\" #include \"common_threads.h\" void *mythread(void *arg) { printf(\"%s\\n\", (char *) arg); return NULL; } int main(int argc, char *argv[]) { pthread_t p1, p2; printf(\"main: begin\\n\"); Pthread_create(\u0026p1, NULL, mythread, \"A\"); Pthread_create(\u0026p2, NULL, mythread, \"B\"); Pthread_join(p1, NULL); Pthread_join(p2, NULL); printf(\"main: end\\n\"); return 0; } ä¸»ç¨‹åºåˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å°†è¿è¡Œå‡½æ•° mythread()ï¼Œä½†ä½¿ç”¨ä¸åŒçš„å‚æ•°ï¼ˆå­—ç¬¦ä¸² A æˆ– Bï¼‰ã€‚çº¿ç¨‹åˆ›å»ºåï¼Œå¯èƒ½ä¼šç«‹å³å¼€å§‹è¿è¡Œï¼ˆå–å†³äºè°ƒåº¦ç¨‹åºçš„å¥‡æ€å¦™æƒ³ï¼‰ï¼›ä¹Ÿå¯èƒ½å¤„äº â€œå°±ç»ª â€œçŠ¶æ€ï¼Œä½†ä¸æ˜¯ â€œè¿è¡Œ â€œçŠ¶æ€ï¼Œå› æ­¤å°šæœªè¿è¡Œã€‚å½“ç„¶ï¼Œåœ¨å¤šå¤„ç†å™¨ä¸Šï¼Œçº¿ç¨‹ç”šè‡³å¯ä»¥åŒæ—¶è¿è¡Œï¼Œä½†æˆ‘ä»¬å…ˆä¸è¦æ‹…å¿ƒè¿™ç§å¯èƒ½æ€§ã€‚ åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼ˆæˆ‘ä»¬æš‚ä¸”ç§°å…¶ä¸º T1 å’Œ T2ï¼‰åï¼Œä¸»çº¿ç¨‹è°ƒç”¨ pthread_join()ï¼Œç­‰å¾…ç‰¹å®šçº¿ç¨‹å®Œæˆã€‚å®ƒä¼šè¿™æ ·åšä¸¤æ¬¡ï¼Œä»è€Œç¡®ä¿ T1 å’Œ T2 è¿è¡Œå¹¶å®Œæˆï¼Œæœ€åæ‰å…è®¸ä¸»çº¿ç¨‹å†æ¬¡è¿è¡Œï¼›å½“ä¸»çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå®ƒä¼šæ‰“å° \"main: end\"å¹¶é€€å‡ºã€‚æ€»çš„æ¥è¯´ï¼Œè¿™æ¬¡è¿è¡Œå…±ä½¿ç”¨äº†ä¸‰ä¸ªçº¿ç¨‹ï¼šä¸»çº¿ç¨‹ã€T1 å’Œ T2ã€‚ è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªå°ç¨‹åºå¯èƒ½çš„æ‰§è¡Œé¡ºåºã€‚ åœ¨æ‰§è¡Œå›¾ä¸­ï¼Œæ—¶é—´å‘ä¸‹é€’å¢ï¼Œæ¯ä¸€åˆ—è¡¨ç¤ºä¸åŒçº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ã€çº¿ç¨‹ 1 æˆ–çº¿ç¨‹ 2ï¼‰è¿è¡Œçš„æ—¶é—´ã€‚ æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œä¸€ç§ç†è§£çº¿ç¨‹åˆ›å»ºçš„æ–¹æ³•æ˜¯ï¼Œå®ƒæœ‰ç‚¹åƒå‡½æ•°è°ƒç”¨ï¼›ä¸è¿‡ï¼Œç³»ç»Ÿå¹¶ä¸æ˜¯é¦–å…ˆæ‰§è¡Œå‡½æ•°ï¼Œç„¶åè¿”å›ç»™è°ƒç”¨è€…ï¼Œè€Œæ˜¯ä¸ºè¢«è°ƒç”¨çš„ä¾‹ç¨‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œçº¿ç¨‹ï¼Œå®ƒç‹¬ç«‹äºè°ƒç”¨è€…è¿è¡Œï¼Œå¯èƒ½åœ¨ä»åˆ›å»ºè¿”å›ä¹‹å‰è¿è¡Œï¼Œä½†ä¹Ÿå¯èƒ½æ›´æ™šã€‚ä¸‹ä¸€æ­¥è¿è¡Œä»€ä¹ˆç”±æ“ä½œç³»ç»Ÿè°ƒåº¦ç¨‹åºå†³å®šï¼Œè™½ç„¶è°ƒåº¦ç¨‹åºå¾ˆå¯èƒ½å®ç°äº†æŸç§åˆç†çš„ç®—æ³•ï¼Œä½†å¾ˆéš¾çŸ¥é“åœ¨ä»»ä½•ç»™å®šæ—¶é—´å†…ä¼šè¿è¡Œä»€ä¹ˆã€‚ ","date":"2024-05-11","objectID":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/:2:0","tags":["OS"],"title":"å¹¶å‘å’Œçº¿ç¨‹","uri":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ä¸ºä»€ä¹ˆæƒ…å†µä¼šå˜å¾—æ›´ç³Ÿï¼šå…±äº«æ•°æ® æˆ‘ä»¬ä¸Šé¢å±•ç¤ºçš„ç®€å•çº¿ç¨‹ç¤ºä¾‹å¾ˆæœ‰ç”¨ï¼Œå®ƒå±•ç¤ºäº†çº¿ç¨‹æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•æ ¹æ®è°ƒåº¦ç¨‹åºçš„å†³å®šä»¥ä¸åŒé¡ºåºè¿è¡Œçš„ã€‚ä½†å®ƒæ²¡æœ‰å‘ä½ å±•ç¤ºçº¿ç¨‹åœ¨è®¿é—®å…±äº«æ•°æ®æ—¶æ˜¯å¦‚ä½•äº¤äº’çš„ã€‚ è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šä¸¤ä¸ªçº¿ç¨‹å¸Œæœ›æ›´æ–°ä¸€ä¸ªå…¨å±€å…±äº«å˜é‡ï¼Œä»£ç å¦‚ä¸‹ã€‚ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cpthread.h\u003e #include \"common.h\" #include \"common_threads.h\" int max; volatile int counter = 0; // shared global variable void *mythread(void *arg) { char *letter = arg; int i; // stack (private per thread) printf(\"%s: begin [addr of i: %p]\\n\", letter, \u0026i); for (i = 0; i \u003c max; i++) { counter = counter + 1; // shared: only one } printf(\"%s: done\\n\", letter); return NULL; } int main(int argc, char *argv[]) { if (argc != 2) { fprintf(stderr, \"usage: main-first \u003cloopcount\u003e\\n\"); exit(1); } max = atoi(argv[1]); pthread_t p1, p2; printf(\"main: begin [counter = %d] [%x]\\n\", counter, (unsigned int) \u0026counter); Pthread_create(\u0026p1, NULL, mythread, \"A\"); Pthread_create(\u0026p2, NULL, mythread, \"B\"); // join waits for the threads to finish Pthread_join(p1, NULL); Pthread_join(p2, NULL); printf(\"main: done\\n [counter: %d]\\n [should: %d]\\n\", counter, max*2); return 0; } é¦–å…ˆï¼ŒPthread create() åªéœ€è°ƒç”¨ pthread create()ï¼Œå¹¶ç¡®ä¿è¿”å›ä»£ç ä¸º 0ï¼›å¦‚æœä¸æ˜¯ï¼ŒPthread create() åªéœ€æ‰“å°ä¸€æ¡ä¿¡æ¯å¹¶é€€å‡ºã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¸å†ä¸ºå·¥ä½œçº¿ç¨‹ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„å‡½æ•°ä½“ï¼Œè€Œæ˜¯åªä½¿ç”¨ä¸€æ®µä»£ç ï¼Œå¹¶å‘çº¿ç¨‹ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼ˆåœ¨æœ¬ä¾‹ä¸­æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®©æ¯ä¸ªçº¿ç¨‹åœ¨å…¶æ¶ˆæ¯å‰æ‰“å°ä¸åŒçš„å­—æ¯ã€‚ æœ€åï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥çœ‹çœ‹æ¯ä¸ªå·¥ä½œçº¿ç¨‹è¦åšä»€ä¹ˆï¼šåœ¨å…±äº«å˜é‡è®¡æ•°å™¨ä¸­æ·»åŠ ä¸€ä¸ªæ•°å­—ï¼Œå¹¶åœ¨ä¸€ä¸ªå¾ªç¯ä¸­æ‰§è¡Œ 1000 ä¸‡æ¬¡ï¼ˆ1e7ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æƒ³è¦çš„æœ€ç»ˆç»“æœæ˜¯ï¼š20,000,000ã€‚ ç°åœ¨æˆ‘ä»¬ç¼–è¯‘å¹¶è¿è¡Œç¨‹åºï¼Œçœ‹çœ‹å®ƒçš„è¿è¡Œæƒ…å†µã€‚ä¸å¹¸çš„æ˜¯ï¼Œå½“æˆ‘ä»¬è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå³ä½¿åœ¨å•ä¸ªå¤„ç†å™¨ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¸€å®šèƒ½å¾—åˆ°æœŸæœ›çš„ç»“æœã€‚ â¯ make shared_data gcc -o shared_data shared_data.c -Wall â¯ ./shared_data 10000000 main: begin [counter = 0] [2b2c000] A: begin [addr of i: 0x16d362fac] B: begin [addr of i: 0x16d3eefac] A: done B: done main: done [counter: 10306439] [should: 20000000] æˆ‘ä»¬å¯ä»¥å¤šè¿è¡Œå‡ æ¬¡ï¼Œå¯ä»¥å‘ç°ä¸ä»…æ¯æ¬¡è¿è¡Œéƒ½æ˜¯é”™è¯¯çš„ï¼Œè€Œä¸”å¾—å‡ºçš„ç»“æœä¹Ÿä¸ä¸€æ ·ï¼è¿˜æœ‰ä¸€ä¸ªå¤§é—®é¢˜ï¼šä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿ ","date":"2024-05-11","objectID":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/:3:0","tags":["OS"],"title":"å¹¶å‘å’Œçº¿ç¨‹","uri":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 é—®é¢˜çš„æ ¸å¿ƒï¼šä¸å—æ§åˆ¶çš„è°ƒåº¦ è¦ç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¿…é¡»äº†è§£ç¼–è¯‘å™¨ä¸ºæ›´æ–°counterè€Œç”Ÿæˆçš„ä»£ç åºåˆ—ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›ç®€å•åœ°å‘counteræ·»åŠ ä¸€ä¸ªæ•°å­— (1)ã€‚å› æ­¤ï¼Œè¿™æ ·åšçš„ä»£ç åºåˆ—å¯èƒ½æ˜¯è¿™æ ·çš„ï¼ˆåœ¨ x86 ä¸­ï¼‰ï¼› mov 0x8049a1c, %eax add $0x1, %eax mov %eax, 0x8049a1c æœ¬ä¾‹å‡è®¾å˜é‡è®¡æ•°å™¨ä½äºåœ°å€ 0x8049a1cã€‚åœ¨è¿™ä¸ªä¸‰æ¡æŒ‡ä»¤åºåˆ—ä¸­ï¼Œé¦–å…ˆä½¿ç”¨ x86 mov æŒ‡ä»¤è·å–åœ°å€å¤„çš„å†…å­˜å€¼ï¼Œå¹¶å°†å…¶æ”¾å…¥å¯„å­˜å™¨ eaxã€‚ç„¶åæ‰§è¡Œ add æŒ‡ä»¤ï¼Œå°† eax å¯„å­˜å™¨çš„å†…å®¹åŠ ä¸Š 1 (0x1)ï¼Œæœ€åå°† eax çš„å†…å®¹å­˜å‚¨å›ç›¸åŒåœ°å€çš„å†…å­˜ä¸­ã€‚ å‡è®¾ä¸¤ä¸ªçº¿ç¨‹ä¸­çš„ä¸€ä¸ªï¼ˆçº¿ç¨‹ 1ï¼‰è¿›å…¥äº†ä»£ç çš„è¿™ä¸€åŒºåŸŸï¼Œå¹¶å‡†å¤‡å°†counteré€’å¢ 1ã€‚å®ƒå°†counterçš„å€¼ï¼ˆå‡è®¾ä¸€å¼€å§‹æ˜¯ 50ï¼‰åŠ è½½åˆ°å¯„å­˜å™¨ eax ä¸­ã€‚å› æ­¤ï¼Œçº¿ç¨‹ 1 çš„å¯„å­˜å™¨ eax=50ã€‚ç„¶ååœ¨å¯„å­˜å™¨ä¸­åŠ ä¸€ï¼Œå› æ­¤ eax=51 ã€‚ ç°åœ¨ï¼Œä¸å¹¸çš„äº‹æƒ…å‘ç”Ÿäº†ï¼šå®šæ—¶å™¨ä¸­æ–­è§¦å‘ï¼Œæ“ä½œç³»ç»Ÿå°†å½“å‰è¿è¡Œçº¿ç¨‹çš„çŠ¶æ€ï¼ˆPCã€åŒ…æ‹¬ eax åœ¨å†…çš„å¯„å­˜å™¨ç­‰ï¼‰ä¿å­˜åˆ°çº¿ç¨‹çš„ TCB ä¸­ã€‚ç°åœ¨æ›´ç³Ÿçš„äº‹æƒ…å‘ç”Ÿäº†ï¼šçº¿ç¨‹ 2 è¢«é€‰ä¸­è¿è¡Œï¼Œå®ƒä¹Ÿè¿›å…¥äº†è¿™æ®µä»£ç ã€‚å®ƒä¹Ÿæ‰§è¡Œäº†ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œè·å–äº†counterçš„å€¼å¹¶å°†å…¶æ”¾å…¥ eaxï¼ˆè®°ä½ï¼šæ¯ä¸ªçº¿ç¨‹åœ¨è¿è¡Œæ—¶éƒ½æœ‰è‡ªå·±çš„ä¸“ç”¨å¯„å­˜å™¨ï¼›å¯„å­˜å™¨ç”±ä¸Šä¸‹æ–‡åˆ‡æ¢ä»£ç è™šæ‹ŸåŒ–ï¼Œç”¨äºä¿å­˜å’Œæ¢å¤å¯„å­˜å™¨ï¼‰ã€‚æ­¤æ—¶è®¡æ•°å™¨çš„å€¼ä»ç„¶æ˜¯ 50ï¼Œå› æ­¤çº¿ç¨‹ 2 çš„ eax=50ã€‚å‡è®¾çº¿ç¨‹ 2 æ‰§è¡Œäº†æ¥ä¸‹æ¥çš„ä¸¤æ¡æŒ‡ä»¤ï¼Œå°† eax é€’å¢ 1ï¼ˆå› æ­¤ eax=51ï¼‰ï¼Œç„¶åå°† eax çš„å†…å®¹ä¿å­˜åˆ°counterï¼ˆåœ°å€ 0x8049a1cï¼‰ä¸­ã€‚è¿™æ ·ï¼Œå…¨å±€å˜é‡è®¡æ•°å™¨ç°åœ¨çš„å€¼æ˜¯ 51ã€‚ æœ€åï¼Œè¿›è¡Œå¦ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œçº¿ç¨‹ 1 æ¢å¤è¿è¡Œã€‚å›æƒ³ä¸€ä¸‹ï¼Œçº¿ç¨‹ 1 åˆšåˆšæ‰§è¡Œäº† mov å’Œ add æŒ‡ä»¤ï¼Œç°åœ¨å³å°†æ‰§è¡Œæœ€åä¸€æ¡ mov æŒ‡ä»¤ã€‚è¿˜è®°å¾— eax=51ã€‚å› æ­¤ï¼Œæ‰§è¡Œäº†æœ€åä¸€æ¡ mov æŒ‡ä»¤ï¼Œå¹¶å°†å€¼ä¿å­˜åˆ°å†…å­˜ä¸­ï¼›è®¡æ•°å™¨å†æ¬¡è¢«è®¾ç½®ä¸º 51ã€‚ ç®€å•åœ°è¯´ï¼Œå‘ç”Ÿçš„æƒ…å†µæ˜¯è¿™æ ·çš„ï¼šcounteré€’å¢çš„ä»£ç è¿è¡Œäº†ä¸¤æ¬¡ï¼Œä½†counterä» 50 å¼€å§‹ï¼Œç°åœ¨åªç­‰äº 51ã€‚è¿™ä¸ªç¨‹åºçš„ â€œæ­£ç¡® â€œç‰ˆæœ¬åº”è¯¥æ˜¯å˜é‡counterç­‰äº 52ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¯¦ç»†çš„æ‰§è¡Œè·Ÿè¸ªï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è¿™ä¸ªé—®é¢˜ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå‡è®¾ä¸Šè¿°ä»£ç åŠ è½½åˆ°å†…å­˜åœ°å€ 100ï¼Œå°±åƒä¸‹é¢çš„åºåˆ—ä¸€æ ·ï¼ˆæ³¨æ„ï¼šx86 æœ‰å¯å˜é•¿åº¦æŒ‡ä»¤ï¼›mov æŒ‡ä»¤å ç”¨ 5 å­—èŠ‚å†…å­˜ï¼Œè€Œ add æŒ‡ä»¤åªå ç”¨ 3 å­—èŠ‚å†…å­˜ï¼‰ï¼š 100 mov 0x8049a1c, %eax 105 add $0x1, %eax 108 mov %eax, 0x8049a1c å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾è®¡æ•°å™¨çš„èµ·å§‹å€¼ä¸º 50ï¼Œå¹¶è·Ÿè¸ªæ­¤ç¤ºä¾‹ä»¥ç¡®ä¿äº†è§£å‘ç”Ÿäº†ä»€ä¹ˆã€‚ æˆ‘ä»¬åœ¨è¿™é‡Œæ¼”ç¤ºçš„ç§°ä¸ºç«äº‰æ¡ä»¶ï¼ˆæˆ–æ›´å…·ä½“åœ°è¯´ï¼Œæ•°æ®ç«äº‰ï¼‰ï¼šç»“æœå–å†³äºä»£ç çš„æ‰§è¡Œæ—¶æœºã€‚å¦‚æœè¿æ°”ä¸å¥½ï¼ˆå³ä¸Šä¸‹æ–‡åˆ‡æ¢å‘ç”Ÿåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸é€‚æ—¶ç‚¹ï¼‰ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½å¯èƒ½å¾—åˆ°ä¸åŒçš„ç»“æœï¼›å› æ­¤ï¼Œæˆ‘ä»¬å°†è¿™ç§ç»“æœç§°ä¸ºä¸ç¡®å®šç»“æœï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ä¹ æƒ¯äºè®¡ç®—æœºä¸­çš„è‰¯å¥½ç¡®å®šæ€§è®¡ç®—ï¼Œå³ä¸çŸ¥é“è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”åœ¨ä¸åŒçš„è¿è¡Œä¸­å®ƒç¡®å®å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ ç”±äºæ‰§è¡Œæ­¤ä»£ç çš„å¤šä¸ªçº¿ç¨‹å¯èƒ½ä¼šå¯¼è‡´ç«äº‰æ¡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å°†æ­¤ä»£ç ç§°ä¸ºä¸´ç•ŒåŒºã€‚ä¸´ç•ŒåŒºæ˜¯è®¿é—®å…±äº«å˜é‡ï¼ˆæˆ–æ›´ä¸€èˆ¬åœ°è¯´ï¼Œå…±äº«èµ„æºï¼‰çš„ä¸€æ®µä»£ç ï¼Œå¹¶ä¸”ä¸èƒ½ç”±å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚ å¯¹äºè¿™æ®µä»£ç ï¼Œæˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯æˆ‘ä»¬æ‰€è¯´çš„äº’æ–¥ã€‚è¿™ä¸€å±æ€§ä¿è¯å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨ä¸´ç•ŒåŒºå†…æ‰§è¡Œï¼Œå…¶ä»–çº¿ç¨‹å°†è¢«é˜»æ­¢è¿™æ ·åšã€‚ ","date":"2024-05-11","objectID":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/:4:0","tags":["OS"],"title":"å¹¶å‘å’Œçº¿ç¨‹","uri":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 å¯¹åŸå­æ€§çš„æ¸´æœ› è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨åŠŸèƒ½æ›´å¼ºå¤§çš„æŒ‡ä»¤ï¼Œåªéœ€ä¸€æ­¥å°±èƒ½å®Œæˆæˆ‘ä»¬éœ€è¦å®Œæˆçš„ä»»ä½•å·¥ä½œï¼Œä»è€Œæ¶ˆé™¤ä¸é€‚æ—¶ä¸­æ–­çš„å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰è¿™æ ·ä¸€æ¡è¶…çº§æŒ‡ä»¤ï¼š memory-add 0x8049a1c, $0x1 å‡è®¾è¯¥æŒ‡ä»¤å‘å†…å­˜ä½ç½®æ·»åŠ ä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”ç¡¬ä»¶ä¿è¯å®ƒä»¥åŸå­æ–¹å¼æ‰§è¡Œï¼›å½“æŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œå®ƒå°†æ ¹æ®éœ€è¦æ‰§è¡Œæ›´æ–°ã€‚å®ƒä¸èƒ½åœ¨æŒ‡ä»¤ä¸­é—´è¢«ä¸­æ–­ï¼Œå› ä¸ºè¿™æ­£æ˜¯æˆ‘ä»¬ä»ç¡¬ä»¶å¾—åˆ°çš„ä¿è¯ï¼šå½“ä¸­æ–­å‘ç”Ÿæ—¶ï¼Œè¦ä¹ˆæŒ‡ä»¤æ ¹æœ¬æ²¡æœ‰è¿è¡Œï¼Œè¦ä¹ˆå·²ç»è¿è¡Œå®Œæˆï¼›æ²¡æœ‰ä¸­é—´çŠ¶æ€ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œâ€œåŸå­â€æ„å‘³ç€â€œä½œä¸ºä¸€ä¸ªå•å…ƒâ€ï¼Œæœ‰æ—¶æˆ‘ä»¬å°†å…¶è§†ä¸ºâ€œå…¨éƒ¨æˆ–æ— â€ã€‚æˆ‘ä»¬æƒ³è¦çš„æ˜¯åŸå­åœ°æ‰§è¡Œä¸‰ä¸ªæŒ‡ä»¤åºåˆ—ï¼š mov 0x8049a1c, %eax add $0x1, %eax mov %eax, 0x8049a1c æ­£å¦‚æˆ‘ä»¬æ‰€è¯´ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€æ¡æŒ‡ä»¤æ¥æ‰§è¡Œæ­¤æ“ä½œï¼Œæˆ‘ä»¬åªéœ€å‘å‡ºè¯¥æŒ‡ä»¤å³å¯å®Œæˆã€‚ä½†ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä¼šæœ‰è¿™æ ·çš„æŒ‡ä»¤ã€‚æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªå¹¶å‘ B æ ‘ï¼Œå¹¶å¸Œæœ›æ›´æ–°å®ƒï¼›æˆ‘ä»¬çœŸçš„å¸Œæœ›ç¡¬ä»¶æ”¯æŒâ€œB æ ‘åŸå­æ›´æ–°â€æŒ‡ä»¤å—ï¼Ÿå¯èƒ½ä¸æ˜¯ï¼Œè‡³å°‘åœ¨å¥å…¨çš„æŒ‡ä»¤é›†ä¸­æ˜¯è¿™æ ·ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯å‘ç¡¬ä»¶è¯·æ±‚ä¸€äº›æœ‰ç”¨çš„æŒ‡ä»¤ï¼Œæ ¹æ®è¿™äº›æŒ‡ä»¤æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ç»„æˆ‘ä»¬ç§°ä¹‹ä¸ºåŒæ­¥åŸè¯­çš„é€šç”¨æŒ‡ä»¤ã€‚é€šè¿‡ä½¿ç”¨è¿™ç§ç¡¬ä»¶æ”¯æŒï¼Œå¹¶ç»“åˆæ“ä½œç³»ç»Ÿçš„ä¸€äº›å¸®åŠ©ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿæ„å»ºä»¥åŒæ­¥å’Œå—æ§æ–¹å¼è®¿é—®ä¸´ç•ŒåŒºçš„å¤šçº¿ç¨‹ä»£ç ï¼Œä»è€Œå¯é åœ°äº§ç”Ÿæ­£ç¡®çš„ç»“æœï¼Œå°½ç®¡å¹¶å‘æ‰§è¡Œå…·æœ‰æŒ‘æˆ˜æ€§ã€‚ ","date":"2024-05-11","objectID":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/:5:0","tags":["OS"],"title":"å¹¶å‘å’Œçº¿ç¨‹","uri":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 å¦ä¸€ä¸ªé—®é¢˜ï¼šç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹ æœ¬ç« åœ¨è®¨è®ºå¹¶å‘é—®é¢˜æ—¶ï¼Œå°†çº¿ç¨‹é—´çš„äº¤äº’è®¾å®šä¸ºåªæœ‰ä¸€ç§ç±»å‹ï¼Œå³è®¿é—®å…±äº«å˜é‡å’Œéœ€è¦æ”¯æŒä¸´ç•ŒåŒºçš„åŸå­æ€§ã€‚äº‹å®è¯æ˜ï¼Œè¿˜æœ‰å¦ä¸€ç§å¸¸è§çš„äº¤äº’ï¼Œå³ä¸€ä¸ªçº¿ç¨‹å¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹å®ŒæˆæŸäº›æ“ä½œåæ‰èƒ½ç»§ç»­ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç£ç›˜ I/O å¹¶è¿›å…¥ä¼‘çœ çŠ¶æ€æ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§äº¤äº’ï¼›å½“ I/O å®Œæˆåï¼Œè¯¥çº¿ç¨‹éœ€è¦ä»æ²‰ç¡ä¸­è¢«å”¤é†’ï¼Œä»¥ä¾¿ç»§ç»­è¿è¡Œã€‚æœ‰æ—¶ï¼Œå¤šä¸ªçº¿ç¨‹çš„æ“ä½œåº”è¯¥æ˜¯åŒæ­¥çš„ã€‚è®¸å¤šçº¿ç¨‹åœ¨æ•°å€¼é—®é¢˜ä¸­å¹¶è¡Œæ‰§è¡Œè¿­ä»£ï¼Œ æ‰€æœ‰çº¿ç¨‹åº”ç«‹å³å¼€å§‹ä¸‹ä¸€æ¬¡è¿­ä»£ï¼ˆå±éšœï¼‰ ï¼Œæ­¤ç¡çœ /å”¤é†’å‘¨æœŸå°†ç”±æ¡ä»¶å˜é‡æ§åˆ¶ã€‚ å…³é”®å¹¶å‘æœ¯è¯­ï¼šä¸´ç•ŒåŒºã€ç«äº‰æ¡ä»¶ã€ä¸ç¡®å®šæ€§ã€äº’æ–¥ è¿™å››ä¸ªæœ¯è¯­å¯¹äºå¹¶å‘ä»£ç éå¸¸é‡è¦ ä¸´ç•ŒåŒºæ˜¯è®¿é—®å…±äº«èµ„æºï¼ˆé€šå¸¸æ˜¯å˜é‡æˆ–æ•°æ®ç»“æ„ï¼‰çš„ä¸€æ®µä»£ç ã€‚ å¦‚æœå¤šä¸ªæ‰§è¡Œçº¿ç¨‹å¤§è‡´åŒæ—¶è¿›å…¥ä¸´ç•ŒåŒºï¼Œåˆ™ä¼šå‡ºç°ç«äº‰æ¡ä»¶ï¼ˆæˆ–æ•°æ®ç«äº‰ï¼‰ã€‚ä¸¤è€…éƒ½å°è¯•æ›´æ–°å…±äº«æ•°æ®ç»“æ„ï¼Œå¯¼è‡´ä¸ç¬¦åˆæœŸæœ›çš„ç»“æœã€‚ ä¸ç¡®å®šç¨‹åºç”±ä¸€ä¸ªæˆ–å¤šä¸ªç«äº‰æ¡ä»¶ç»„æˆï¼›ç¨‹åºçš„è¾“å‡ºæ¯æ¬¡è¿è¡Œéƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå…·ä½“å–å†³äºè¿è¡Œçš„çº¿ç¨‹ã€‚å› æ­¤ï¼Œç»“æœæ˜¯ä¸ç¡®å®šæ€§çš„ï¼Œè¿™ä¸æˆ‘ä»¬é€šå¸¸ä»è®¡ç®—æœºç³»ç»Ÿä¸­æœŸæœ›çš„æƒ…å†µä¸åŒã€‚ ä¸ºäº†é¿å…è¿™äº›é—®é¢˜ï¼Œçº¿ç¨‹åº”è¯¥ä½¿ç”¨æŸç§äº’æ–¥åŸè¯­ï¼›è¿™æ ·åšå¯ä»¥ä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼Œä»è€Œé¿å…ç«äº‰ï¼Œå¹¶äº§ç”Ÿç¡®å®šæ€§çš„ç¨‹åºè¾“å‡ºã€‚ ","date":"2024-05-11","objectID":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/:6:0","tags":["OS"],"title":"å¹¶å‘å’Œçº¿ç¨‹","uri":"/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åœ¨ç»“æŸå¯¹è™šæ‹Ÿå†…å­˜çš„ç ”ç©¶ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹æ•´ä¸ªè™šæ‹Ÿå†…å­˜ç³»ç»Ÿæ˜¯å¦‚ä½•ç»„åˆèµ·æ¥çš„ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†æ­¤ç±»ç³»ç»Ÿçš„å…³é”®è¦ç´ ï¼ŒåŒ…æ‹¬å¤§é‡é¡µè¡¨è®¾è®¡ã€ä¸ TLB çš„äº¤äº’ï¼ˆæœ‰æ—¶ç”šè‡³ç”±æ“ä½œç³»ç»Ÿæœ¬èº«å¤„ç†ï¼‰ï¼Œä»¥åŠå†³å®šå°†å“ªäº›é¡µä¿ç•™åœ¨å†…å­˜ä¸­ã€å°†å“ªäº›é¡µè¸¢å‡ºå†…å­˜çš„ç­–ç•¥ã€‚ç„¶è€Œï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–ç‰¹æ€§æ„æˆäº†ä¸€ä¸ªå®Œæ•´çš„è™šæ‹Ÿå†…å­˜ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…æ‹¬è®¸å¤šæ€§èƒ½ã€åŠŸèƒ½å’Œå®‰å…¨ç‰¹æ€§ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„å…³é”®æ‰€åœ¨ï¼šå¦‚ä½•æ„å»ºå®Œæ•´çš„è™šæ‹Ÿå†…å­˜ç³»ç»Ÿï¼Ÿå®ç°å®Œæ•´çš„è™šæ‹Ÿå†…å­˜ç³»ç»Ÿéœ€è¦å“ªäº›åŠŸèƒ½ï¼Ÿå®ƒä»¬å¦‚ä½•æé«˜æ€§èƒ½ã€å¢å¼ºå®‰å…¨æ€§æˆ–æ”¹è¿›ç³»ç»Ÿï¼Ÿ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸¤ä¸ªç³»ç»Ÿã€‚ç¬¬ä¸€ä¸ªç³»ç»Ÿæ˜¯ â€œç°ä»£ â€œè™šæ‹Ÿå†…å­˜ç®¡ç†å™¨çš„æœ€æ—©èŒƒä¾‹ä¹‹ä¸€ï¼Œå³ 20 ä¸–çºª 70 å¹´ä»£å’Œ 80 å¹´ä»£åˆå¼€å‘çš„ VAX/VMS æ“ä½œç³»ç»Ÿ ã€‚æœ‰äº›æƒ³æ³•ï¼Œå³ä½¿æ˜¯ 50 å¹´å‰çš„æƒ³æ³•ï¼Œä»ç„¶å€¼å¾—äº†è§£ï¼Œè¿™ç§æƒ³æ³•å¯¹äºå¤§å¤šæ•°å…¶ä»–é¢†åŸŸï¼ˆå¦‚ç‰©ç†å­¦ï¼‰çš„äººæ¥è¯´æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ï¼Œä½†åœ¨æŠ€æœ¯é©±åŠ¨å‹å­¦ç§‘ï¼ˆå¦‚è®¡ç®—æœºç§‘å­¦ï¼‰ä¸­å´ä¸å¾—ä¸è¯´ã€‚ å…¶æ¬¡æ˜¯ Linuxï¼ŒåŸå› æ˜¾è€Œæ˜“è§ã€‚Linux æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç³»ç»Ÿï¼Œå¯ä»¥åœ¨å°åˆ°åŠŸç‡ä¸è¶³çš„æ‰‹æœºç³»ç»Ÿï¼Œå¤§åˆ°ç°ä»£æ•°æ®ä¸­å¿ƒä¸­æœ€å…·æ‰©å±•æ€§çš„å¤šæ ¸ç³»ç»Ÿä¸Šæœ‰æ•ˆè¿è¡Œã€‚å› æ­¤ï¼Œå…¶è™šæ‹Ÿæœºç³»ç»Ÿå¿…é¡»è¶³å¤Ÿçµæ´»ï¼Œä»¥ä¾¿åœ¨æ‰€æœ‰è¿™äº›åœºæ™¯ä¸­æˆåŠŸè¿è¡Œã€‚æˆ‘ä»¬å°†å¯¹æ¯ä¸ªç³»ç»Ÿè¿›è¡Œè®¨è®ºï¼Œä»¥è¯´æ˜å¦‚ä½•å°†å‰é¢ç« èŠ‚ä¸­æå‡ºçš„æ¦‚å¿µæ•´åˆåˆ°ä¸€ä¸ªå®Œæ•´çš„å†…å­˜ç®¡ç†å™¨ä¸­ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:0:0","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 VAX/VMS è™šæ‹Ÿå†…å­˜ VAX-11 å¾®å‹è®¡ç®—æœºä½“ç³»ç»“æ„ç”±Digital Equipment Corporation (DEC) äº 20 ä¸–çºª 70 å¹´ä»£æœ«æ¨å‡ºã€‚åœ¨å¾®å‹è®¡ç®—æœºæ—¶ä»£ï¼ŒDEC æ˜¯è®¡ç®—æœºè¡Œä¸šçš„å·¨å¤´ï¼›ä¸å¹¸çš„æ˜¯ï¼Œä¸€ç³»åˆ—é”™è¯¯çš„å†³ç­–å’Œ PC çš„å‡ºç°æ…¢æ…¢åœ°ï¼ˆä½†è‚¯å®šåœ°ï¼‰å¯¼è‡´äº†å®ƒä»¬çš„æ¶ˆäº¡ï¼Œã€‚è¯¥æ¶æ„æœ‰å¤šç§å®ç°å½¢å¼ï¼ŒåŒ…æ‹¬ VAX-11/780 å’ŒåŠŸèƒ½è¾ƒå¼±çš„ VAX-11/750ã€‚ è¯¥ç³»ç»Ÿçš„æ“ä½œç³»ç»Ÿè¢«ç§°ä¸º VAX/VMSï¼ˆæˆ–ç®€ç§° VMSï¼‰ï¼Œå…¶ä¸»è¦è®¾è®¡è€…ä¹‹ä¸€æ˜¯ Dave Cutlerï¼Œä»–åæ¥é¢†å¯¼å¼€å‘äº†å¾®è½¯çš„ Windows NT [C93]ã€‚VMS å­˜åœ¨ä¸€ä¸ªæ™®éçš„é—®é¢˜ï¼Œå³å®ƒå¯ä»¥åœ¨å„ç§æœºå™¨ä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬éå¸¸ä¾¿å®œçš„ VAXenï¼ˆæ˜¯çš„ï¼Œè¿™æ˜¯æ­£ç¡®çš„å¤æ•°ï¼‰åˆ°åŒä¸€æ¶æ„ç³»åˆ—ä¸­çš„æå…¶é«˜ç«¯å’Œå¼ºå¤§çš„æœºå™¨ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»æ‹¥æœ‰èƒ½å¤Ÿåœ¨å¦‚æ­¤å¹¿æ³›çš„ç³»ç»Ÿä¸­å‘æŒ¥ä½œç”¨ï¼ˆå¹¶ä¸”è¿ä½œè‰¯å¥½ï¼‰çš„æœºåˆ¶å’Œç­–ç•¥ã€‚ å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼ŒVMS æ˜¯åˆ©ç”¨è½¯ä»¶åˆ›æ–°æ¥æ©ç›–ä½“ç³»ç»“æ„å›ºæœ‰ç¼ºé™·çš„ä¸€ä¸ªæå¥½ä¾‹å­ã€‚å°½ç®¡æ“ä½œç³»ç»Ÿç»å¸¸ä¾èµ–ç¡¬ä»¶æ¥æ„å»ºæœ‰æ•ˆçš„æŠ½è±¡å’Œå¹»è±¡ï¼Œä½†æœ‰æ—¶ç¡¬ä»¶è®¾è®¡è€…å¹¶ä¸èƒ½å®Œå…¨åšåˆ°ä¸‡æ— ä¸€å¤±ï¼›åœ¨ VAX ç¡¬ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€äº›è¿™æ ·çš„ä¾‹å­ï¼Œä»¥åŠ VMS æ“ä½œç³»ç»Ÿæ˜¯å¦‚ä½•å…‹æœè¿™äº›ç¡¬ä»¶ç¼ºé™·æ¥æ„å»ºä¸€ä¸ªæœ‰æ•ˆçš„ã€å¯è¿è¡Œçš„ç³»ç»Ÿçš„ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:1:0","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.1 å†…å­˜ç®¡ç†ç¡¬ä»¶ VAX-11 ä¸ºæ¯ä¸ªè¿›ç¨‹æä¾› 32 ä½è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œåˆ†ä¸º 512 å­—èŠ‚é¡µã€‚å› æ­¤ï¼Œè™šæ‹Ÿåœ°å€ç”± 23 ä½ VPN å’Œ 9 ä½åç§»é‡ç»„æˆã€‚æ­¤å¤–ï¼ŒVPN çš„ä¸Šä¸¤ä½ç”¨äºåŒºåˆ†é¡µé¢æ‰€åœ¨çš„åˆ†æ®µï¼›å› æ­¤ï¼Œå¦‚å‰æ‰€è¿°ï¼Œè¯¥ç³»ç»Ÿæ˜¯åˆ†é¡µå’Œåˆ†æ®µçš„æ··åˆä½“ã€‚ åœ°å€ç©ºé—´çš„ä¸‹åŠéƒ¨åˆ†è¢«ç§°ä¸º â€œè¿›ç¨‹ç©ºé—´â€ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æ˜¯å”¯ä¸€çš„ã€‚åœ¨è¿›ç¨‹ç©ºé—´çš„å‰åŠéƒ¨åˆ†ï¼ˆç§°ä¸º P0ï¼‰ï¼Œå¯ä»¥æ‰¾åˆ°ç”¨æˆ·ç¨‹åºä»¥åŠå‘ä¸‹å¢é•¿çš„å †ã€‚åœ¨è¿›ç¨‹ç©ºé—´çš„ååŠéƒ¨ï¼ˆP1ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å‘ä¸Šç”Ÿé•¿çš„æ ˆã€‚åœ°å€ç©ºé—´çš„ä¸ŠåŠéƒ¨åˆ†ç§°ä¸ºç³»ç»Ÿç©ºé—´ï¼ˆSï¼‰ï¼Œä½†åªæœ‰ä¸€åŠè¢«ä½¿ç”¨ã€‚å—ä¿æŠ¤çš„æ“ä½œç³»ç»Ÿä»£ç å’Œæ•°æ®å­˜æ”¾åœ¨è¿™é‡Œï¼Œæ“ä½œç³»ç»Ÿä»¥è¿™ç§æ–¹å¼åœ¨å„è¿›ç¨‹é—´å…±äº«ã€‚ VMS è®¾è®¡äººå‘˜çš„ä¸€ä¸ªä¸»è¦é¡¾è™‘æ˜¯ï¼ŒVAX ç¡¬ä»¶ä¸­çš„é¡µé¢å¤§å°ï¼ˆ512 å­—èŠ‚ï¼‰å°å¾—ä»¤äººéš¾ä»¥ç½®ä¿¡ã€‚ç”±äºå†å²åŸå› è€Œé€‰æ‹©çš„è¿™ç§å¤§å°å­˜åœ¨ä¸€ä¸ªåŸºæœ¬é—®é¢˜ï¼Œå³ç®€å•çš„çº¿æ€§é¡µè¡¨è¿‡äºåºå¤§ã€‚å› æ­¤ï¼ŒVMS è®¾è®¡äººå‘˜çš„é¦–è¦ç›®æ ‡ä¹‹ä¸€å°±æ˜¯ç¡®ä¿ VMS ä¸ä¼šå› ä¸ºé¡µè¡¨è€Œä½¿å†…å­˜ä¸å ªé‡è´Ÿã€‚ç³»ç»Ÿé€šè¿‡ä¸¤ç§æ–¹å¼å‡è½»äº†é¡µè¡¨å¯¹å†…å­˜çš„å‹åŠ›ã€‚é¦–å…ˆï¼ŒVAX-11 å°†ç”¨æˆ·åœ°å€ç©ºé—´åˆ’åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼ŒVAX-11ä¸ºæ¯ä¸ªè¿›ç¨‹çš„æ¯ä¸ªåŒºåŸŸï¼ˆP0 å’Œ P1ï¼‰æä¾›ä¸€ä¸ªé¡µè¡¨ï¼›å› æ­¤ï¼Œæ ˆå’Œå †ä¹‹é—´æœªä½¿ç”¨çš„åœ°å€ç©ºé—´éƒ¨åˆ†ä¸éœ€è¦é¡µè¡¨ç©ºé—´ã€‚åŸºå€å¯„å­˜å™¨å’Œè¾¹ç•Œå¯„å­˜å™¨çš„ä½¿ç”¨æ­£å¦‚ä½ æ‰€æœŸæœ›çš„é‚£æ ·ï¼›åŸºå€å¯„å­˜å™¨ä¿å­˜è¯¥æ®µçš„é¡µè¡¨åœ°å€ï¼Œè¾¹ç•Œå¯„å­˜å™¨ä¿å­˜å…¶å¤§å°ï¼ˆå³é¡µè¡¨æ¡ç›®æ•°ï¼‰ã€‚ å…¶æ¬¡ï¼Œæ“ä½œç³»ç»Ÿå°†ç”¨æˆ·é¡µè¡¨ï¼ˆP0 å’Œ P1ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸¤ä¸ªï¼‰ç½®äºå†…æ ¸è™šæ‹Ÿå†…å­˜ä¸­ï¼Œä»è€Œè¿›ä¸€æ­¥é™ä½äº†å†…å­˜å‹åŠ›ã€‚å› æ­¤ï¼Œåœ¨åˆ†é…æˆ–å¢é•¿é¡µè¡¨æ—¶ï¼Œå†…æ ¸ä¼šä»è‡ªå·±çš„è™šæ‹Ÿå†…å­˜ S æ®µä¸­åˆ†é…ç©ºé—´ã€‚å¦‚æœå†…å­˜å‹åŠ›è¿‡å¤§ï¼Œå†…æ ¸å¯ä»¥å°†è¿™äº›é¡µè¡¨çš„é¡µäº¤æ¢åˆ°ç£ç›˜ï¼Œä»è€Œå°†ç‰©ç†å†…å­˜ç”¨äºå…¶ä»–ç”¨é€”ã€‚ å°†é¡µè¡¨æ”¾åœ¨å†…æ ¸è™šæ‹Ÿå†…å­˜ä¸­æ„å‘³ç€åœ°å€è½¬æ¢å˜å¾—æ›´åŠ å¤æ‚ã€‚ä¾‹å¦‚ï¼Œè¦è½¬æ¢ P0 æˆ– P1 ä¸­çš„è™šæ‹Ÿåœ°å€ï¼Œç¡¬ä»¶å¿…é¡»é¦–å…ˆå°è¯•åœ¨å…¶é¡µè¡¨ï¼ˆè¯¥è¿›ç¨‹çš„ P0 æˆ– P1 é¡µè¡¨ï¼‰ä¸­æŸ¥æ‰¾è¯¥é¡µçš„é¡µè¡¨æ¡ç›®ï¼›ä½†åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç¡¬ä»¶å¯èƒ½å¿…é¡»é¦–å…ˆæŸ¥é˜…ç³»ç»Ÿé¡µè¡¨ï¼ˆä½äºç‰©ç†å†…å­˜ä¸­ï¼‰ï¼›å®Œæˆè½¬æ¢åï¼Œç¡¬ä»¶æ‰èƒ½äº†è§£é¡µè¡¨ä¸­çš„é¡µé¢åœ°å€ï¼Œç„¶åæœ€ç»ˆäº†è§£æ‰€éœ€å†…å­˜è®¿é—®çš„åœ°å€ã€‚å¹¸è¿çš„æ˜¯ï¼ŒVAX ç¡¬ä»¶ç®¡ç†çš„ TLB ä½¿æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½å˜å¾—æ›´å¿«ï¼Œé€šå¸¸ï¼ˆå¸Œæœ›ï¼‰å¯ä»¥é¿å…è¿™ç§è´¹åŠ›çš„æŸ¥æ‰¾ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:1:1","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 çœŸå®çš„åœ°å€ç©ºé—´ ç ”ç©¶ VMS çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çœŸå®åœ°å€ç©ºé—´æ˜¯å¦‚ä½•æ„å»ºçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡è®¾çš„åœ°å€ç©ºé—´å¾ˆç®€å•ï¼Œåªæœ‰ç”¨æˆ·ä»£ç ã€ç”¨æˆ·æ•°æ®å’Œç”¨æˆ·å †ï¼Œä½†æ­£å¦‚ä¸Šæ–‡æ‰€è¿°ï¼ŒçœŸå®çš„åœ°å€ç©ºé—´è¦å¤æ‚å¾—å¤šã€‚ä¾‹å¦‚ï¼Œä»£ç æ®µæ°¸è¿œä¸ä¼šä»ç¬¬ 0 é¡µå¼€å§‹ï¼Œè€Œæ˜¯æ ‡è®°ä¸ºä¸å¯è®¿é—®ï¼Œä»¥ä¾¿ä¸ºæ£€æµ‹ç©ºæŒ‡é’ˆè®¿é—®æä¾›ä¸€äº›æ”¯æŒã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡åœ°å€ç©ºé—´æ—¶ï¼Œéœ€è¦è€ƒè™‘çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¯¹è°ƒè¯•çš„æ”¯æŒï¼Œè€Œä¸å¯è®¿é—®çš„ 0 é¡µåœ¨æŸç§ç¨‹åº¦ä¸Šæä¾›äº†è¿™ç§æ”¯æŒã€‚ ä¸ºä»€ä¹ˆç©ºæŒ‡é’ˆè®¿é—®ä¼šå¯¼è‡´ SEG é”™è¯¯ï¼Ÿ ä½ ç°åœ¨åº”è¯¥å¯¹è§£å¼•ç”¨ç©ºæŒ‡é’ˆæ—¶å‘ç”Ÿçš„æƒ…å†µæœ‰äº†å¾ˆå¥½çš„äº†è§£ã€‚ä¸€ä¸ªè¿›ç¨‹ç”Ÿæˆäº†ä¸€ä¸ªè™šæ‹Ÿåœ°å€ 0ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š int *p = NULL; // set p = 0 *p = 10; // try to store 10 to virtual addr 0 ç¡¬ä»¶å°è¯•åœ¨ TLB ä¸­æŸ¥æ‰¾ VPNï¼ˆæ­¤å¤„ä¹Ÿæ˜¯ 0ï¼‰ï¼Œç»“æœå¯¼è‡´ TLB æœªå‘½ä¸­ã€‚æŸ¥é˜…é¡µè¡¨åå‘ç°ï¼ŒVPN 0 çš„æ¡ç›®è¢«æ ‡è®°ä¸ºæ— æ•ˆã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæ— æ•ˆè®¿é—®ï¼Œå®ƒå°†æ§åˆ¶æƒè½¬ç§»åˆ°æ“ä½œç³»ç»Ÿï¼Œè€Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šç»ˆæ­¢è¿›ç¨‹ï¼ˆåœ¨ UNIX ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹ä¼šæ”¶åˆ°ä¸€ä¸ªä¿¡å·ï¼Œå…è®¸å®ƒä»¬å¯¹æ­¤ç±»æ•…éšœåšå‡ºååº”ï¼›ä½†å¦‚æœæœªè¢«æ•è·ï¼Œè¿›ç¨‹å°±ä¼šè¢«æ€æ­»ï¼‰ã€‚ ä¹Ÿè®¸æ›´é‡è¦çš„æ˜¯ï¼Œå†…æ ¸è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ˆå³å…¶æ•°æ®ç»“æ„å’Œä»£ç ï¼‰æ˜¯æ¯ä¸ªç”¨æˆ·åœ°å€ç©ºé—´çš„ä¸€éƒ¨åˆ†ã€‚åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ›´æ”¹ P0 å’Œ P1 å¯„å­˜å™¨ï¼Œä½¿å…¶æŒ‡å‘å³å°†è¿è¡Œçš„è¿›ç¨‹çš„ç›¸åº”é¡µè¡¨ï¼›ä½†ä¸ä¼šæ›´æ”¹ S åŸºå¯„å­˜å™¨å’Œè¾¹ç•Œå¯„å­˜å™¨ï¼Œå› æ­¤ â€œç›¸åŒçš„ â€œå†…æ ¸ç»“æ„ä¼šæ˜ å°„åˆ°æ¯ä¸ªç”¨æˆ·åœ°å€ç©ºé—´ã€‚ å†…æ ¸è¢«æ˜ å°„åˆ°æ¯ä¸ªåœ°å€ç©ºé—´çš„åŸå› æœ‰å¾ˆå¤šã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå½“æ“ä½œç³»ç»Ÿä»ç”¨æˆ·ç¨‹åºï¼ˆä¾‹å¦‚åœ¨ write() ç³»ç»Ÿè°ƒç”¨ä¸­ï¼‰å¾—åˆ°ä¸€ä¸ªæŒ‡é’ˆæ—¶ï¼Œå¾ˆå®¹æ˜“å°†æŒ‡é’ˆä¸­çš„æ•°æ®å¤åˆ¶åˆ°è‡ªå·±çš„ç»“æ„ä¸­ã€‚æ“ä½œç³»ç»Ÿæ˜¯è‡ªç„¶ç¼–å†™å’Œç¼–è¯‘çš„ï¼Œæ— éœ€æ‹…å¿ƒè®¿é—®çš„æ•°æ®æ¥è‡ªä½•å¤„ã€‚ç›¸åï¼Œå¦‚æœå†…æ ¸å®Œå…¨ä½äºç‰©ç†å†…å­˜ä¸­ï¼Œå°±å¾ˆéš¾åšåˆ°å°†é¡µè¡¨ä¸­çš„é¡µé¢äº¤æ¢åˆ°ç£ç›˜è¿™æ ·çš„äº‹æƒ…ï¼›å¦‚æœå†…æ ¸æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œåœ¨ç”¨æˆ·åº”ç”¨ç¨‹åºå’Œå†…æ ¸ä¹‹é—´ç§»åŠ¨æ•°æ®åˆä¼šå˜å¾—å¤æ‚è€Œç—›è‹¦ã€‚æœ‰äº†è¿™ç§ç»“æ„ï¼ˆç°åœ¨è¢«å¹¿æ³›ä½¿ç”¨ï¼‰ï¼Œå†…æ ¸å‡ ä¹å°±æˆäº†åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªåº“ï¼Œå°½ç®¡æ˜¯å—ä¿æŠ¤çš„åº“ã€‚ å…³äºè¿™ä¸ªåœ°å€ç©ºé—´çš„æœ€åä¸€ç‚¹ä¸ä¿æŠ¤æœ‰å…³ã€‚æ˜¾ç„¶ï¼Œæ“ä½œç³»ç»Ÿä¸å¸Œæœ›ç”¨æˆ·åº”ç”¨ç¨‹åºè¯»å†™æ“ä½œç³»ç»Ÿçš„æ•°æ®æˆ–ä»£ç ã€‚å› æ­¤ï¼Œç¡¬ä»¶å¿…é¡»ä¸ºé¡µé¢æä¾›ä¸åŒçš„ä¿æŠ¤çº§åˆ«ã€‚VAX å°±æ˜¯è¿™æ ·åšçš„ï¼Œå®ƒåœ¨é¡µè¡¨çš„ä¿æŠ¤ä½ä¸­è§„å®šäº† CPU è®¿é—®ç‰¹å®šé¡µé¢å¿…é¡»è¾¾åˆ°çš„æƒé™çº§åˆ«ã€‚å› æ­¤ï¼Œç³»ç»Ÿæ•°æ®å’Œä»£ç çš„ä¿æŠ¤çº§åˆ«è¦é«˜äºç”¨æˆ·æ•°æ®å’Œä»£ç ï¼›å¦‚æœè¯•å›¾ä»ç”¨æˆ·ä»£ç è®¿é—®æ­¤ç±»ä¿¡æ¯ï¼Œå°±ä¼šå‘æ“ä½œç³»ç»Ÿå‘å‡ºä¸­æ–­ï¼Œè¿è§„è¿›ç¨‹å¾ˆå¯èƒ½ä¼šè¢«ç»ˆæ­¢ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:2:0","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 é¡µé¢æ›¿æ¢ VAX ä¸­çš„é¡µè¡¨é¡¹ (PTE) åŒ…å«ä»¥ä¸‹ä½ï¼šä¸€ä¸ªæœ‰æ•ˆä½ã€ä¸€ä¸ªä¿æŠ¤å­—æ®µï¼ˆ4 ä½ï¼‰ã€ä¸€ä¸ªä¿®æ”¹ï¼ˆæˆ–è„ï¼‰ä½ã€ä¸€ä¸ªä¿ç•™ç»™æ“ä½œç³»ç»Ÿä½¿ç”¨çš„å­—æ®µï¼ˆ5 ä½ï¼‰ï¼Œæœ€åæ˜¯ä¸€ä¸ªç‰©ç†é¡µå·ï¼ˆPFNï¼‰ï¼Œç”¨äºå­˜å‚¨é¡µåœ¨ç‰©ç†å†…å­˜ä¸­çš„ä½ç½®ã€‚ç²¾æ˜çš„è¯»è€…å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼šæ²¡æœ‰å¼•ç”¨ä½ï¼å› æ­¤ï¼ŒVMS æ›¿æ¢ç®—æ³•å¿…é¡»åœ¨æ²¡æœ‰ç¡¬ä»¶æ”¯æŒçš„æƒ…å†µä¸‹ç¡®å®šå“ªäº›é¡µé¢å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚ æ¨¡æ‹Ÿå‚è€ƒä½ äº‹å®è¯æ˜ï¼Œä½ å¹¶ä¸éœ€è¦ç¡¬ä»¶å¼•ç”¨ä½æ¥è·å¾—ç³»ç»Ÿä¸­æ­£åœ¨ä½¿ç”¨çš„é¡µé¢çš„æ¦‚å¿µã€‚äº‹å®ä¸Šï¼Œæ—©åœ¨ 20 ä¸–çºª 80 å¹´ä»£åˆï¼ŒBabaoglu å’Œ Joy å°±è¯æ˜ VAX çš„ä¿æŠ¤ä½å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿå‚è€ƒä½ã€‚åŸºæœ¬åŸç†ï¼šå¦‚æœæƒ³äº†è§£ç³»ç»Ÿä¸­å“ªäº›é¡µé¢æ­£åœ¨è¢«æ´»è·ƒä½¿ç”¨ï¼Œå¯å°†é¡µè¡¨ä¸­çš„æ‰€æœ‰é¡µé¢æ ‡è®°ä¸ºä¸å¯è®¿é—®ï¼ˆä½†ä¿ç•™è¿›ç¨‹çœŸæ­£å¯è®¿é—®çš„é¡µé¢ä¿¡æ¯ï¼Œå¯èƒ½åœ¨é¡µè¡¨æ¡ç›®çš„ â€œä¿ç•™æ“ä½œç³»ç»Ÿå­—æ®µ â€œéƒ¨åˆ†ï¼‰ã€‚å½“è¿›ç¨‹è®¿é—®é¡µé¢æ—¶ï¼Œå®ƒå°†å‘æ“ä½œç³»ç»Ÿå‘å‡ºä¸€ä¸ªä¸­æ–­ï¼›ç„¶åæ“ä½œç³»ç»Ÿå°†æ£€æŸ¥è¯¥é¡µé¢æ˜¯å¦çœŸçš„åº”è¯¥è¢«è®¿é—®ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†è¯¥é¡µé¢æ¢å¤åˆ°æ­£å¸¸çš„ä¿æŠ¤çŠ¶æ€ï¼ˆå¦‚åªè¯»æˆ–è¯»å†™ï¼‰ã€‚åœ¨æ›¿æ¢æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥æ£€æŸ¥å“ªäº›é¡µé¢ä»ç„¶æ ‡è®°ä¸ºä¸å¯è®¿é—®ï¼Œä»è€Œäº†è§£å“ªäº›é¡µé¢æœ€è¿‘æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ã€‚è¿™ç§å¼•ç”¨ä½ â€œä»¿çœŸ â€œçš„å…³é”®åœ¨äºå‡å°‘å¼€é”€ï¼ŒåŒæ—¶è¿˜èƒ½å¾ˆå¥½åœ°äº†è§£é¡µé¢çš„ä½¿ç”¨æƒ…å†µã€‚æ“ä½œç³»ç»Ÿåœ¨æ ‡è®°é¡µé¢ä¸å¯è®¿é—®æ—¶ä¸èƒ½è¿‡äºæ¿€è¿›ï¼Œå¦åˆ™å¼€é”€ä¼šè¿‡é«˜ã€‚æ“ä½œç³»ç»Ÿåœ¨æ ‡è®°é¡µé¢æ—¶ä¹Ÿä¸èƒ½å¤ªè¢«åŠ¨ï¼Œå¦åˆ™æ‰€æœ‰é¡µé¢æœ€ç»ˆéƒ½ä¼šè¢«å¼•ç”¨ï¼›æ“ä½œç³»ç»Ÿä¹Ÿæ— æ³•å¾ˆå¥½åœ°çŸ¥é“åº”è¯¥é©±é€å“ªä¸ªé¡µé¢ã€‚ å¼€å‘äººå‘˜è¿˜æ‹…å¿ƒå†…å­˜å ç”¨è€…ï¼Œå³å ç”¨å¤§é‡å†…å­˜å¹¶å¯¼è‡´å…¶ä»–ç¨‹åºéš¾ä»¥è¿è¡Œçš„ç¨‹åºã€‚è¿„ä»Šä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ç ”ç©¶è¿‡çš„å¤§å¤šæ•°ç­–ç•¥éƒ½å¾ˆå®¹æ˜“å‡ºç°è¿™ç§å ç”¨å†…å­˜çš„æƒ…å†µï¼›ä¾‹å¦‚ï¼ŒLRU æ˜¯ä¸€ç§å…¨å±€ç­–ç•¥ï¼Œä¸èƒ½åœ¨è¿›ç¨‹ä¹‹é—´å…¬å¹³åœ°å…±äº«å†…å­˜ã€‚ ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œå¼€å‘äººå‘˜æå‡ºäº†åˆ†æ®µ FIFO æ›¿æ¢ç­–ç•¥ã€‚è¿™ç§ç­–ç•¥çš„æ€è·¯å¾ˆç®€å•ï¼šæ¯ä¸ªè¿›ç¨‹åœ¨å†…å­˜ä¸­å¯ä¿ç•™çš„æœ€å¤§é¡µæ•°ï¼Œå³å¸¸é©»é›†å¤§å°ï¼ˆRSSï¼‰ã€‚æ¯ä¸ªé¡µé¢éƒ½ä¿å­˜åœ¨ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºåˆ—è¡¨ä¸­ï¼›å½“ä¸€ä¸ªè¿›ç¨‹è¶…è¿‡å…¶ RSS æ—¶ï¼Œâ€œå…ˆè¿› â€œçš„é¡µé¢å°±ä¼šè¢«é©±é€ã€‚FIFO æ˜¾ç„¶ä¸éœ€è¦ä»»ä½•ç¡¬ä»¶æ”¯æŒï¼Œå› æ­¤å¾ˆå®¹æ˜“å®ç°ã€‚ å½“ç„¶ï¼Œæ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€çœ‹åˆ°çš„ï¼Œçº¯ç²¹çš„ FIFO æ€§èƒ½å¹¶ä¸æ˜¯ç‰¹åˆ«å¥½ã€‚ä¸ºäº†æé«˜ FIFO çš„æ€§èƒ½ï¼ŒVMS å¼•å…¥äº†ä¸¤ä¸ªäºŒæ¬¡æœºä¼šåˆ—è¡¨ï¼Œå³å…¨å±€çš„å¹²å‡€é¡µé¢åˆ—è¡¨å’Œ è„é¡µé¢ åˆ—è¡¨ï¼Œç”¨äºæ”¾ç½®ä»å†…å­˜ä¸­é©±é€å‰çš„é¡µé¢ã€‚å½“è¿›ç¨‹ P è¶…è¿‡å…¶ RSS æ—¶ï¼Œä¼šä»å…¶æ¯ä¸ªè¿›ç¨‹çš„ FIFO ä¸­ç§»é™¤ä¸€ä¸ªé¡µé¢ï¼›å¦‚æœæ˜¯å¹²å‡€é¡µé¢ï¼ˆæœªä¿®æ”¹ï¼‰ï¼Œåˆ™å°†å…¶æ”¾åœ¨å¹²å‡€é¡µé¢åˆ—è¡¨çš„æœ«å°¾ï¼›å¦‚æœæ˜¯è„é¡µé¢ï¼ˆå·²ä¿®æ”¹ï¼‰ï¼Œåˆ™å°†å…¶æ”¾åœ¨è„é¡µé¢åˆ—è¡¨çš„æœ«å°¾ã€‚ å¦‚æœå¦ä¸€ä¸ªè¿›ç¨‹ Q éœ€è¦ä¸€ä¸ªç©ºé—²é¡µé¢ï¼Œå®ƒä¼šä»å…¨å±€å¹²å‡€é¡µé¢åˆ—è¡¨ä¸­è·å–ç¬¬ä¸€ä¸ªç©ºé—²é¡µé¢ã€‚ä½†æ˜¯ï¼Œå¦‚æœåŸè¿›ç¨‹ P åœ¨è¯¥é¡µè¢«å›æ”¶å‰å‘ç”Ÿé”™è¯¯ï¼ŒP ä¼šä»ç©ºé—²ï¼ˆæˆ–è„é¡µï¼‰åˆ—è¡¨ä¸­å›æ”¶è¯¥é¡µï¼Œä»è€Œé¿å…äº†ä»£ä»·é«˜æ˜‚çš„ç£ç›˜è®¿é—®ã€‚è¿™äº›å…¨å±€äºŒæ¬¡æœºä¼šåˆ—è¡¨è¶Šå¤§ï¼Œåˆ†æ®µ FIFO ç®—æ³•çš„æ€§èƒ½å°±è¶Šæ¥è¿‘ LRUã€‚ VMS ä¸­ä½¿ç”¨çš„å¦ä¸€ç§ä¼˜åŒ–æ–¹æ³•ä¹Ÿæœ‰åŠ©äºå…‹æœ VMS ä¸­çš„å°é¡µé¢é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œç”±äºé¡µé¢å¤ªå°ï¼Œç£ç›˜åœ¨äº¤æ¢è¿‡ç¨‹ä¸­çš„ I/O æ•ˆç‡ä¼šéå¸¸ä½ï¼Œå› ä¸ºç£ç›˜åœ¨è¿›è¡Œå¤§å®¹é‡ä¼ è¾“æ—¶æ•ˆç‡æ›´é«˜ã€‚ä¸ºäº†æé«˜äº¤æ¢ I/O çš„æ•ˆç‡ï¼ŒVMS å¢åŠ äº†è®¸å¤šä¼˜åŒ–åŠŸèƒ½ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯é›†ç¾¤åŠŸèƒ½ã€‚é€šè¿‡é›†ç¾¤ï¼ŒVMS å°†å…¨å±€è„é¡µé¢åˆ—è¡¨ä¸­çš„å¤§æ‰¹é‡é¡µé¢é›†ä¸­åœ¨ä¸€èµ·ï¼Œç„¶åä¸€æ¬¡æ€§å°†å®ƒä»¬å†™å…¥ç£ç›˜ï¼ˆä»è€Œä½¿å®ƒä»¬å˜å¾—å¹²å‡€ï¼‰ã€‚é›†ç¾¤æŠ€æœ¯åœ¨å¤§å¤šæ•°ç°ä»£ç³»ç»Ÿä¸­éƒ½å¾—åˆ°äº†åº”ç”¨ï¼Œå› ä¸ºå¯ä»¥è‡ªç”±åœ°å°†é¡µé¢æ”¾ç½®åœ¨äº¤æ¢ç©ºé—´çš„ä»»ä½•ä½ç½®ï¼Œè¿™ä½¿å¾—æ“ä½œç³»ç»Ÿå¯ä»¥å¯¹é¡µé¢è¿›è¡Œåˆ†ç»„ï¼Œæ‰§è¡Œæ›´å°‘ã€æ›´å¤§çš„å†™å…¥æ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:2:1","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 å…¶ä»–å¦™æ‹› VMS è¿˜æœ‰ä¸¤ä¸ªç°åœ¨å·²æˆä¸ºæ ‡å‡†çš„æŠ€å·§ï¼šéœ€æ±‚æ¸…é›¶å’Œå†™æ—¶å¤åˆ¶ã€‚ç°åœ¨æˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ä¸‹è¿™äº›æ‡’æƒ°ä¼˜åŒ–ã€‚VMSï¼ˆä»¥åŠå¤§å¤šæ•°ç°ä»£ç³»ç»Ÿï¼‰ä¸­çš„ä¸€ç§æ‡’æƒ°å½¢å¼æ˜¯é¡µé¢çš„éœ€æ±‚æ¸…é›¶ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬ä»¥åœ¨åœ°å€ç©ºé—´ï¼ˆæ¯”å¦‚åœ¨å †ä¸­ï¼‰ä¸­æ·»åŠ ä¸€ä¸ªé¡µé¢ä¸ºä¾‹ã€‚åœ¨æœ€ç®€å•çš„å®ç°ä¸­ï¼Œæ“ä½œç³»ç»Ÿä¼šåœ¨ç‰©ç†å†…å­˜ä¸­æ‰¾åˆ°ä¸€ä¸ªé¡µé¢ï¼Œå°†å…¶æ¸…é›¶ï¼ˆè¿™æ˜¯ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå¦åˆ™ä½ å°±èƒ½çœ‹åˆ°å…¶ä»–è¿›ç¨‹ä½¿ç”¨è¯¥é¡µé¢æ—¶é¡µé¢ä¸Šçš„å†…å®¹äº†ï¼ï¼‰ï¼Œç„¶åå°†å…¶æ˜ å°„åˆ°åœ°å€ç©ºé—´ï¼ˆå³è®¾ç½®é¡µè¡¨ï¼Œä»¥ä¾¿æ ¹æ®éœ€è¦å¼•ç”¨è¯¥ç‰©ç†é¡µé¢ï¼‰ï¼Œä»¥æ­¤æ¥å“åº”å‘å †ä¸­æ·»åŠ é¡µé¢çš„è¯·æ±‚ã€‚ä½†è¿™ç§å¤©çœŸçš„å®ç°æ–¹å¼ä»£ä»·é«˜æ˜‚ï¼Œå°¤å…¶æ˜¯å½“è¯¥é¡µé¢æœªè¢«è¿›ç¨‹ä½¿ç”¨æ—¶ã€‚ é€šè¿‡éœ€æ±‚æ¸…é›¶ï¼Œå½“é¡µé¢è¢«æ·»åŠ åˆ°åœ°å€ç©ºé—´æ—¶ï¼Œæ“ä½œç³»ç»Ÿåªéœ€åšå¾ˆå°‘çš„å·¥ä½œï¼›å®ƒä¼šåœ¨é¡µè¡¨ä¸­æ·»åŠ ä¸€ä¸ªæ¡ç›®ï¼Œæ ‡è®°è¯¥é¡µé¢ä¸å¯è®¿é—®ã€‚å¦‚æœè¿›ç¨‹è¯»å–æˆ–å†™å…¥è¯¥é¡µé¢ï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šæ”¶åˆ°ä¸€ä¸ªä¸­æ–­ã€‚åœ¨å¤„ç†ä¸­æ–­æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ³¨æ„åˆ°ï¼ˆé€šå¸¸æ˜¯é€šè¿‡åœ¨é¡µè¡¨é¡¹çš„ â€œä¸ºæ“ä½œç³»ç»Ÿä¿ç•™ â€œéƒ¨åˆ†æ ‡è®°çš„æŸäº›ä½ï¼‰è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªéœ€è¦æ¸…é›¶çš„é¡µé¢ï¼›æ­¤æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šè¿›è¡Œå¿…è¦çš„å·¥ä½œï¼Œæ‰¾åˆ°ä¸€ä¸ªç‰©ç†é¡µï¼Œå°†å…¶æ¸…é›¶ï¼Œå¹¶æ˜ å°„åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ã€‚å¦‚æœè¿›ç¨‹ä»ä¸è®¿é—®è¯¥é¡µï¼Œæ‰€æœ‰è¿™äº›å·¥ä½œéƒ½å¯ä»¥é¿å…ï¼Œè¿™å°±æ˜¯éœ€æ±‚æ¸…é›¶çš„ä¼˜ç‚¹ã€‚ VMS ä¸­å¦ä¸€ä¸ªå¾ˆé…·çš„ä¼˜åŒ–ï¼ˆåŒæ ·ï¼Œå‡ ä¹æ‰€æœ‰ç°ä»£æ“ä½œç³»ç»Ÿä¸­éƒ½æœ‰è¿™ç§ä¼˜åŒ–ï¼‰æ˜¯å†™æ—¶å¤åˆ¶ï¼ˆç®€ç§° COWï¼‰ã€‚è¿™ä¸ªæ¦‚å¿µè‡³å°‘å¯ä»¥è¿½æº¯åˆ° TENEX æ“ä½œç³»ç»Ÿï¼Œå®ƒçš„åŸç†å¾ˆç®€å•ï¼šå½“æ“ä½œç³»ç»Ÿéœ€è¦å°†ä¸€ä¸ªé¡µé¢ä»ä¸€ä¸ªåœ°å€ç©ºé—´å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°å€ç©ºé—´æ—¶ï¼Œå®ƒå¯ä»¥ä¸å¤åˆ¶è¯¥é¡µé¢ï¼Œè€Œæ˜¯å°†å…¶æ˜ å°„åˆ°ç›®æ ‡åœ°å€ç©ºé—´ï¼Œå¹¶åœ¨ä¸¤ä¸ªåœ°å€ç©ºé—´ä¸­éƒ½æ ‡è®°ä¸ºåªè¯»ã€‚å¦‚æœä¸¤ä¸ªåœ°å€ç©ºé—´éƒ½åªè¯»å–è¯¥é¡µé¢ï¼Œåˆ™ä¸ä¼šé‡‡å–è¿›ä¸€æ­¥çš„æ“ä½œï¼Œè¿™æ ·æ“ä½œç³»ç»Ÿå°±å®ç°äº†å¿«é€Ÿå¤åˆ¶ï¼Œè€Œå®é™…ä¸Šæ²¡æœ‰ç§»åŠ¨ä»»ä½•æ•°æ®ã€‚ ä½†æ˜¯ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªåœ°å€ç©ºé—´ç¡®å®å°è¯•å‘è¯¥é¡µé¢å†™å…¥æ•°æ®ï¼Œåˆ™ä¼šå‘æ“ä½œç³»ç»Ÿå‘å‡ºä¸­æ–­ã€‚æ“ä½œç³»ç»Ÿä¼šæ³¨æ„åˆ°è¯¥é¡µæ˜¯ COW é¡µï¼Œä»è€Œï¼ˆæ‡’æ•£åœ°ï¼‰åˆ†é…ä¸€ä¸ªæ–°é¡µï¼Œå°†æ•°æ®å¡«å…¥å…¶ä¸­ï¼Œå¹¶å°†è¿™ä¸ªæ–°é¡µæ˜ å°„åˆ°æ•…éšœè¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚ç„¶åè¯¥è¿›ç¨‹ç»§ç»­è¿è¡Œï¼Œç°åœ¨å®ƒæ‹¥æœ‰è‡ªå·±çš„é¡µé¢ç§æœ‰å‰¯æœ¬ã€‚ ç”±äºå¤šç§åŸå› ï¼ŒCOW éå¸¸æœ‰ç”¨ã€‚å½“ç„¶ï¼Œä»»ä½•ç±»å‹çš„å…±äº«åº“éƒ½å¯ä»¥é€šè¿‡å†™æ—¶å¤åˆ¶æ˜ å°„åˆ°è®¸å¤šè¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œä»è€ŒèŠ‚çœå®è´µçš„å†…å­˜ç©ºé—´ã€‚åœ¨ UNIX ç³»ç»Ÿä¸­ï¼Œç”±äº fork() å’Œ exec() çš„è¯­ä¹‰ï¼ŒCOW ç”šè‡³æ›´ä¸ºé‡è¦ã€‚ä½ å¯èƒ½è¿˜è®°å¾—ï¼Œfork() ä¼šåˆ›å»ºä¸€ä¸ªè°ƒç”¨è€…åœ°å€ç©ºé—´çš„ç²¾ç¡®å‰¯æœ¬ï¼›å¦‚æœåœ°å€ç©ºé—´å¾ˆå¤§ï¼Œåˆ›å»ºè¿™æ ·çš„å‰¯æœ¬æ—¢æ…¢åˆè€—è´¹æ•°æ®ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¤§éƒ¨åˆ†åœ°å€ç©ºé—´ä¼šç«‹å³è¢«åç»­çš„ exec() è°ƒç”¨æ‰€è¦†ç›–ï¼Œè¿™å°†ä½¿è°ƒç”¨è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸å³å°†æ‰§è¡Œçš„ç¨‹åºçš„åœ°å€ç©ºé—´é‡å ã€‚é€šè¿‡æ‰§è¡Œå†™å…¥æ—¶å¤åˆ¶ fork()ï¼Œæ“ä½œç³»ç»Ÿé¿å…äº†å¤§éƒ¨åˆ†ä¸å¿…è¦çš„å¤åˆ¶ï¼Œä»è€Œåœ¨æé«˜æ€§èƒ½çš„åŒæ—¶ä¿ç•™äº†æ­£ç¡®çš„è¯­ä¹‰ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:2:2","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 Lnux è™šæ‹Ÿå†…å­˜ç³»ç»Ÿ ç°åœ¨æˆ‘ä»¬å°†è®¨è®º Linux VM ç³»ç»Ÿçš„ä¸€äº›æ›´æœ‰è¶£çš„æ–¹é¢ã€‚ Linux çš„å‘å±•æ˜¯ç”±çœŸæ­£çš„å·¥ç¨‹å¸ˆè§£å†³ç”Ÿäº§ä¸­é‡åˆ°çš„å®é™…é—®é¢˜æ¨åŠ¨çš„ï¼Œå› æ­¤å¤§é‡çš„åŠŸèƒ½å·²ç»æ…¢æ…¢åœ°èå…¥åˆ°ç°åœ¨åŠŸèƒ½é½å…¨ã€åŠŸèƒ½é½å…¨çš„è™šæ‹Ÿå†…å­˜ç³»ç»Ÿä¸­ã€‚ è™½ç„¶æˆ‘ä»¬æ— æ³•è®¨è®º Linux VM çš„å„ä¸ªæ–¹é¢ï¼Œä½†æˆ‘ä»¬å°†è®¨è®ºæœ€é‡è¦çš„æ–¹é¢ï¼Œç‰¹åˆ«æ˜¯å®ƒè¶…å‡ºäº† VAX/VMS ç­‰ç»å…¸ VM ç³»ç»Ÿä¸­çš„èŒƒå›´ã€‚æˆ‘ä»¬è¿˜å°†å°è¯•å¼ºè°ƒ Linux å’Œæ—§ç³»ç»Ÿä¹‹é—´çš„å…±æ€§ã€‚ åœ¨æœ¬æ¬¡è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨é€‚ç”¨äº Intel x86 çš„ Linuxã€‚è™½ç„¶ Linux å¯ä»¥è€Œä¸”ç¡®å®åœ¨è®¸å¤šä¸åŒçš„å¤„ç†å™¨æ¶æ„ä¸Šè¿è¡Œï¼Œä½† x86 ä¸Šçš„ Linux æ˜¯å…¶æœ€ä¸»è¦å’Œæœ€é‡è¦çš„éƒ¨ç½²ï¼Œå› æ­¤ä¹Ÿæ˜¯æˆ‘ä»¬å…³æ³¨çš„ç„¦ç‚¹ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:3:0","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 Linux åœ°å€ç©ºé—´ ä¸å…¶ä»–ç°ä»£æ“ä½œç³»ç»Ÿå’Œ VAX/VMS ä¸€æ ·ï¼ŒLinux è™šæ‹Ÿåœ°å€ç©ºé—´ç”±ç”¨æˆ·éƒ¨åˆ†ï¼ˆç”¨æˆ·ç¨‹åºä»£ç ã€æ ˆã€å †å’Œå…¶ä»–éƒ¨åˆ†æ‰€åœ¨ï¼‰å’Œå†…æ ¸éƒ¨åˆ†ï¼ˆå†…æ ¸ä»£ç ã€æ ˆã€å †å’Œå…¶ä»–éƒ¨åˆ†æ‰€åœ¨ï¼‰ç»„æˆã€‚ä¸å…¶ä»–ç³»ç»Ÿä¸€æ ·ï¼Œåœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œå½“å‰è¿è¡Œçš„åœ°å€ç©ºé—´çš„ç”¨æˆ·éƒ¨åˆ†ä¼šå‘ç”Ÿå˜åŒ–ï¼›è€Œå†…æ ¸éƒ¨åˆ†åˆ™åœ¨ä¸åŒè¿›ç¨‹ä¸­ä¿æŒä¸å˜ã€‚ä¸å…¶ä»–ç³»ç»Ÿä¸€æ ·ï¼Œåœ¨ç”¨æˆ·æ¨¡å¼ä¸‹è¿è¡Œçš„ç¨‹åºä¹Ÿæ— æ³•è®¿é—®å†…æ ¸è™šæ‹Ÿé¡µï¼›åªæœ‰è¿›å…¥å†…æ ¸å¹¶è½¬æ¢åˆ°ç‰¹æƒæ¨¡å¼ï¼Œæ‰èƒ½è®¿é—®è¿™äº›å†…å­˜ã€‚ åœ¨ç»å…¸çš„ 32 ä½ Linuxï¼ˆå³å…·æœ‰ 32 ä½è™šæ‹Ÿåœ°å€ç©ºé—´çš„ Linuxï¼‰ä¸­ï¼Œç”¨æˆ·å’Œå†…æ ¸åœ°å€ç©ºé—´çš„åˆ†å‰²å‘ç”Ÿåœ¨åœ°å€ 0xC0000000ï¼Œå³åœ°å€ç©ºé—´çš„å››åˆ†ä¹‹ä¸‰å¤„ã€‚å› æ­¤ï¼Œè™šæ‹Ÿåœ°å€ 0 åˆ° 0xBFFFFFFF æ˜¯ç”¨æˆ·è™šæ‹Ÿåœ°å€ï¼›å…¶ä½™çš„è™šæ‹Ÿåœ°å€ï¼ˆ0xC0000000 åˆ° 0xFFFFFFFFï¼‰å±äºå†…æ ¸è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚64 ä½ Linux ä¹Ÿæœ‰ç±»ä¼¼çš„åˆ†å‰²ï¼Œä½†åˆ†å‰²ç‚¹ç•¥æœ‰ä¸åŒã€‚ ä¸‹å›¾ æ˜¾ç¤ºäº†å…¸å‹ï¼ˆç®€åŒ–ï¼‰åœ°å€ç©ºé—´çš„æè¿°ã€‚ Linux çš„ä¸€ä¸ªæœ‰è¶£ä¹‹å¤„åœ¨äºå®ƒåŒ…å«ä¸¤ç§å†…æ ¸è™šæ‹Ÿåœ°å€ã€‚ç¬¬ä¸€ç§ç§°ä¸ºå†…æ ¸é€»è¾‘åœ°å€ ã€‚å†…æ ¸ä»£ç åªéœ€è°ƒç”¨ kmalloc å³å¯è·å¾—æ›´å¤šæ­¤ç±»å†…å­˜ã€‚å¤§å¤šæ•°å†…æ ¸æ•°æ®ç»“æ„éƒ½åœ¨è¿™é‡Œï¼Œå¦‚é¡µè¡¨ã€æ¯ä¸ªè¿›ç¨‹çš„å†…æ ¸æ ˆç­‰ã€‚ä¸ç³»ç»Ÿä¸­çš„å¤§å¤šæ•°å…¶ä»–å†…å­˜ä¸åŒï¼Œå†…æ ¸é€»è¾‘å†…å­˜ä¸èƒ½äº¤æ¢åˆ°ç£ç›˜ã€‚ å†…æ ¸é€»è¾‘åœ°å€æœ€æœ‰è¶£çš„åœ°æ–¹åœ¨äºå®ƒä»¬ä¸ç‰©ç†å†…å­˜çš„è”ç³»ã€‚å…·ä½“æ¥è¯´ï¼Œå†…æ ¸é€»è¾‘åœ°å€ä¸ç‰©ç†å†…å­˜çš„ç¬¬ä¸€éƒ¨åˆ†ä¹‹é—´å­˜åœ¨ç›´æ¥æ˜ å°„å…³ç³»ã€‚å› æ­¤ï¼Œå†…æ ¸é€»è¾‘åœ°å€ 0xC0000000 ç›¸å½“äºç‰©ç†åœ°å€ 0x00000000ï¼Œ0xC0000FFF ç›¸å½“äº 0x00000FFFï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™ç§ç›´æ¥æ˜ å°„æœ‰ä¸¤ä¸ªæ„ä¹‰ã€‚é¦–å…ˆï¼Œåœ¨å†…æ ¸é€»è¾‘åœ°å€å’Œç‰©ç†åœ°å€ä¹‹é—´æ¥å›è½¬æ¢éå¸¸ç®€å•ï¼›å› æ­¤ï¼Œè¿™äº›åœ°å€é€šå¸¸è¢«å½“ä½œç‰©ç†åœ°å€æ¥å¤„ç†ã€‚å…¶æ¬¡ï¼Œå¦‚æœä¸€å—å†…å­˜åœ¨å†…æ ¸é€»è¾‘åœ°å€ç©ºé—´ä¸­æ˜¯è¿ç»­çš„ï¼Œé‚£ä¹ˆå®ƒåœ¨ç‰©ç†å†…å­˜ä¸­ä¹Ÿæ˜¯è¿ç»­çš„ã€‚è¿™ä½¿å¾—åœ¨å†…æ ¸åœ°å€ç©ºé—´çš„è¿™ä¸€éƒ¨åˆ†åˆ†é…çš„å†…å­˜é€‚ç”¨äºéœ€è¦è¿ç»­ç‰©ç†å†…å­˜æ‰èƒ½æ­£å¸¸å·¥ä½œçš„æ“ä½œï¼Œä¾‹å¦‚é€šè¿‡ç›®å½•å†…å­˜è®¿é—® (DMA) è¿›è¡Œè®¾å¤‡é—´çš„ I/O ä¼ è¾“ã€‚ å¦ä¸€ç§å†…æ ¸åœ°å€æ˜¯å†…æ ¸è™šæ‹Ÿåœ°å€ã€‚è¦è·å–è¿™ç§ç±»å‹çš„å†…å­˜ï¼Œå†…æ ¸ä»£ç ä¼šè°ƒç”¨ä¸åŒçš„åˆ†é…å™¨ vmallocï¼Œè¯¥åˆ†é…å™¨ä¼šè¿”å›ä¸€ä¸ªæŒ‡å‘æ‰€éœ€å¤§å°çš„è™šæ‹Ÿè¿ç»­åŒºåŸŸçš„æŒ‡é’ˆã€‚ä¸å†…æ ¸é€»è¾‘å†…å­˜ä¸åŒï¼Œå†…æ ¸è™šæ‹Ÿå†…å­˜é€šå¸¸ä¸æ˜¯è¿ç»­çš„ï¼›æ¯ä¸ªå†…æ ¸è™šæ‹Ÿé¡µéƒ½å¯èƒ½æ˜ å°„åˆ°éè¿ç»­çš„ç‰©ç†é¡µï¼ˆå› æ­¤ä¸é€‚åˆ DMAï¼‰ã€‚ä¸è¿‡ï¼Œè¿™æ ·çš„å†…å­˜æ›´å®¹æ˜“åˆ†é…ï¼Œå› æ­¤å¯ç”¨äºå¤§å‹ç¼“å†²åŒºï¼Œè€Œè¦åœ¨è¿™äº›ç¼“å†²åŒºä¸­æ‰¾åˆ°è¿ç»­çš„å¤§å—ç‰©ç†å†…å­˜åˆ™éå¸¸å›°éš¾ã€‚ åœ¨ 32 ä½ Linux ä¸­ï¼Œå†…æ ¸è™šæ‹Ÿåœ°å€å­˜åœ¨çš„å¦ä¸€ä¸ªåŸå› æ˜¯ï¼Œå®ƒä»¬èƒ½è®©å†…æ ¸å¯»å€è¶…è¿‡ï¼ˆå¤§çº¦ï¼‰1 GB çš„å†…å­˜ã€‚å¤šå¹´å‰ï¼Œæœºå™¨çš„å†…å­˜æ¯”ç°åœ¨å°‘å¾—å¤šï¼Œå› æ­¤è®¿é—®è¶…è¿‡ 1 GB çš„å†…å­˜ä¸æ˜¯é—®é¢˜ã€‚ç„¶è€Œï¼Œéšç€æŠ€æœ¯çš„è¿›æ­¥ï¼Œå¾ˆå¿«å°±éœ€è¦è®©å†…æ ¸ä½¿ç”¨æ›´å¤§çš„å†…å­˜ã€‚å†…æ ¸è™šæ‹Ÿåœ°å€å’Œå®ƒä»¬ä¸ç‰©ç†å†…å­˜ä¸€å¯¹ä¸€çš„ä¸¥æ ¼æ˜ å°„å…³ç³»ä½¿è¿™æˆä¸ºå¯èƒ½ã€‚ä¸è¿‡ï¼Œéšç€å‘ 64 ä½ Linux è¿ç§»ï¼Œè¿™ç§éœ€æ±‚å°±ä¸é‚£ä¹ˆè¿«åˆ‡äº†ï¼Œå› ä¸ºå†…æ ¸ä¸å†å±€é™äºæœ€å 1 GB çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:3:1","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 é¡µè¡¨ç»“æ„ ç”±äºæˆ‘ä»¬å…³æ³¨çš„æ˜¯ x86 çš„ Linuxï¼Œå› æ­¤æˆ‘ä»¬çš„è®¨è®ºå°†å›´ç»• x86 æä¾›çš„é¡µè¡¨ç»“æ„ç±»å‹å±•å¼€ï¼Œå› ä¸ºå®ƒå†³å®šäº† Linux èƒ½åšä»€ä¹ˆã€ä¸èƒ½åšä»€ä¹ˆã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œx86 æä¾›äº†ä¸€ç§ç¡¬ä»¶ç®¡ç†çš„å¤šçº§é¡µè¡¨ç»“æ„ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªé¡µè¡¨ï¼›æ“ä½œç³»ç»Ÿåªéœ€åœ¨å†…å­˜ä¸­è®¾ç½®æ˜ å°„ï¼Œå°†ç‰¹æƒå¯„å­˜å™¨æŒ‡å‘é¡µç›®å½•çš„èµ·å§‹ä½ç½®ï¼Œå‰©ä¸‹çš„å°±äº¤ç»™ç¡¬ä»¶å¤„ç†äº†ã€‚æ“ä½œç³»ç»Ÿä¼šåœ¨è¿›ç¨‹åˆ›å»ºã€åˆ é™¤å’Œä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶å‚ä¸å…¶ä¸­ï¼Œç¡®ä¿ç¡¬ä»¶ MMU åœ¨æ¯ç§æƒ…å†µä¸‹éƒ½ä½¿ç”¨æ­£ç¡®çš„é¡µè¡¨è¿›è¡Œè½¬æ¢ã€‚ è¿‘å¹´æ¥æœ€å¤§çš„å˜åŒ–å¯èƒ½å°±æ˜¯ä» 32 ä½ x86 è¿ç§»åˆ° 64 ä½ x86ï¼ˆå¦‚ä¸Šæ–‡æ‰€è¿°ï¼‰ã€‚æ­£å¦‚åœ¨ VAX/VMS ç³»ç»Ÿä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œ32 ä½åœ°å€ç©ºé—´å·²ç»å­˜åœ¨äº†å¾ˆé•¿æ—¶é—´ï¼Œéšç€æŠ€æœ¯çš„å˜åŒ–ï¼Œå®ƒä»¬ç»ˆäºå¼€å§‹æˆä¸ºç¨‹åºçš„çœŸæ­£é™åˆ¶ã€‚è™šæ‹Ÿå†…å­˜ä½¿ç³»ç»Ÿç¼–ç¨‹å˜å¾—å®¹æ˜“ï¼Œä½†ç”±äºç°ä»£ç³»ç»ŸåŒ…å«è®¸å¤š GB å†…å­˜ï¼Œ32 ä½å·²ä¸è¶³ä»¥å¼•ç”¨æ¯ä¸ªå†…å­˜ã€‚å› æ­¤ï¼Œä¸‹ä¸€æ¬¡é£è·ƒæˆä¸ºå¿…è¦ã€‚ è¿ç§»åˆ° 64 ä½åœ°å€ä¼šä»¥é¢„æœŸçš„æ–¹å¼å½±å“ x86 ä¸­çš„é¡µè¡¨ç»“æ„ã€‚å› ä¸º x86 ä½¿ç”¨çš„æ˜¯å¤šçº§é¡µè¡¨ï¼Œè€Œå½“å‰çš„ 64 ä½ç³»ç»Ÿä½¿ç”¨çš„æ˜¯å››çº§é¡µè¡¨ã€‚ä¸è¿‡ï¼Œè™šæ‹Ÿåœ°å€ç©ºé—´çš„å…¨éƒ¨ 64 ä½å°šæœªä½¿ç”¨ï¼Œè€Œä»…ä½¿ç”¨äº†æœ€ä¸‹é¢çš„ 48 ä½ã€‚å› æ­¤ï¼Œè™šæ‹Ÿåœ°å€å¯ä»¥è¿™æ ·ç†è§£ï¼š å¦‚å›¾æ‰€ç¤ºï¼Œè™šæ‹Ÿåœ°å€çš„å‰ 16 ä½æœªä½¿ç”¨ï¼ˆå› æ­¤åœ¨è½¬æ¢ä¸­ä¸èµ·ä½œç”¨ï¼‰ï¼Œå 12 ä½ï¼ˆç”±äº 4 KB é¡µé¢å¤§å°ï¼‰ç”¨ä½œåç§»é‡ï¼ˆå› æ­¤ç›´æ¥ä½¿ç”¨ï¼Œæ²¡æœ‰è½¬æ¢ï¼‰ï¼Œç•™ä¸‹è™šæ‹Ÿåœ°å€çš„ä¸­é—´36ä½å‚ä¸è½¬æ¢ã€‚åœ°å€çš„ P1 éƒ¨åˆ†ç”¨äºç´¢å¼•æœ€é¡¶å±‚çš„é¡µç›®å½•ï¼Œå¹¶ä¸”ä»é‚£é‡Œå¼€å§‹è¿›è¡Œè½¬æ¢ï¼Œä¸€æ¬¡ä¸€å±‚ï¼Œç›´åˆ°é¡µè¡¨çš„å®é™…é¡µè¢« P4 ç´¢å¼•ï¼Œäº§ç”Ÿæ‰€éœ€çš„é¡µè¡¨æ¡ç›®ã€‚ éšç€ç³»ç»Ÿå†…å­˜å˜å¾—æ›´å¤§ï¼Œè¿™ä¸ªåºå¤§çš„åœ°å€ç©ºé—´çš„æ›´å¤šéƒ¨åˆ†å°†è¢«å¯ç”¨ï¼Œä»è€Œå¯¼è‡´äº”çº§å’Œæœ€ç»ˆå…­çº§é¡µè¡¨æ ‘ç»“æ„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼šä¸€ä¸ªç®€å•çš„é¡µè¡¨æŸ¥æ‰¾éœ€è¦å…­çº§è½¬æ¢ï¼Œåªæ˜¯ä¸ºäº†æ‰¾å‡ºæŸä¸ªæ•°æ®åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:3:2","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 å¤§é¡µé¢æ”¯æŒ Intel x86 å…è®¸ä½¿ç”¨å¤šç§é¡µé¢å¤§å°ï¼Œè€Œä¸ä»…ä»…æ˜¯æ ‡å‡†çš„ 4 KB é¡µé¢ã€‚å…·ä½“æ¥è¯´ï¼Œæœ€è¿‘çš„è®¾è®¡åœ¨ç¡¬ä»¶ä¸­æ”¯æŒ 2 MB ç”šè‡³ 1 GB é¡µé¢ã€‚å› æ­¤ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼ŒLinux å·²ç»å‘å±•åˆ°å…è®¸åº”ç”¨ç¨‹åºåˆ©ç”¨è¿™äº›å¤§é¡µé¢ã€‚æ­£å¦‚å‰é¢æ‰€æš—ç¤ºçš„ï¼Œä½¿ç”¨å¤§é¡µé¢ä¼šå¸¦æ¥å¾ˆå¤šå¥½å¤„ã€‚æ­£å¦‚ VAX/VMS ä¸­æ‰€è§ï¼Œè¿™æ ·åšå¯ä»¥å‡å°‘é¡µè¡¨ä¸­æ‰€éœ€çš„æ˜ å°„æ•°é‡ï¼›é¡µé¢è¶Šå¤§ï¼Œæ˜ å°„è¶Šå°‘ã€‚ç„¶è€Œï¼Œè¾ƒå°‘çš„é¡µè¡¨æ¡ç›®å¹¶ä¸æ˜¯å¤§é¡µé¢èƒŒåçš„é©±åŠ¨åŠ›ï¼›ç›¸åï¼Œå®ƒæ˜¯æ›´å¥½çš„ TLB è¡Œä¸ºå’Œç›¸å…³çš„æ€§èƒ½æå‡ã€‚ å½“è¿›ç¨‹ä¸»åŠ¨ä½¿ç”¨å¤§é‡å†…å­˜æ—¶ï¼Œå®ƒä¼šå¾ˆå¿«ç”¨è½¬æ¢å¡«æ»¡ TLBã€‚å¦‚æœè¿™äº›è½¬æ¢é’ˆå¯¹ 4 KB é¡µé¢ï¼Œåˆ™åªèƒ½è®¿é—®å°‘é‡çš„æ€»å†…å­˜ï¼Œè€Œä¸ä¼šå¯¼è‡´ TLB æœªå‘½ä¸­ã€‚å…¶ç»“æœæ˜¯ï¼Œå¯¹äºåœ¨å…·æœ‰è®¸å¤šGBå†…å­˜çš„æœºå™¨ä¸Šè¿è¡Œçš„ç°ä»£â€œå¤§å†…å­˜â€å·¥ä½œè´Ÿè½½æ¥è¯´ï¼Œä¼šå¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æˆæœ¬ï¼›æœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ï¼Œä¸€äº›åº”ç”¨ç¨‹åºå°†å…¶å‘¨æœŸçš„10%ç”¨äºæœåŠ¡TLBæœªå‘½ä¸­ã€‚ å¤§é¡µé¢å…è®¸è¿›ç¨‹é€šè¿‡ä½¿ç”¨ TLB ä¸­è¾ƒå°‘çš„æ§½æ¥è®¿é—®å¤§ç‰‡å†…å­˜è€Œä¸ä¼šå‘ç”Ÿ TLB æœªå‘½ä¸­ï¼Œå› æ­¤è¿™æ˜¯ä¸»è¦ä¼˜ç‚¹ã€‚ç„¶è€Œï¼Œå¤§é¡µé¢è¿˜æœ‰å…¶ä»–å¥½å¤„ï¼šTLB æœªå‘½ä¸­è·¯å¾„è¾ƒçŸ­ï¼Œè¿™æ„å‘³ç€å½“å‘ç”Ÿ TLB æœªå‘½ä¸­æ—¶ï¼Œå¯ä»¥æ›´å¿«åœ°å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚æ­¤å¤–ï¼Œåˆ†é…å¯ä»¥éå¸¸å¿«ï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå°ä½†æœ‰æ—¶å¾ˆé‡è¦çš„å¥½å¤„ã€‚ Linux å¯¹å¤§é¡µé¢çš„æ”¯æŒçš„ä¸€ä¸ªæœ‰è¶£çš„æ–¹é¢æ˜¯å®ƒæ˜¯å¦‚ä½•é€æ­¥å®ç°çš„ã€‚èµ·åˆï¼ŒLinux å¼€å‘äººå‘˜çŸ¥é“è¿™ç§æ”¯æŒä»…å¯¹å°‘æ•°åº”ç”¨ç¨‹åºå¾ˆé‡è¦ï¼Œä¾‹å¦‚å…·æœ‰ä¸¥æ ¼æ€§èƒ½è¦æ±‚çš„å¤§å‹æ•°æ®åº“ã€‚å› æ­¤ï¼Œå†³å®šå…è®¸åº”ç”¨ç¨‹åºæ˜¾å¼è¯·æ±‚å¤§é¡µé¢å†…å­˜åˆ†é…ï¼ˆé€šè¿‡ mmap() æˆ– shmget() è°ƒç”¨ï¼‰ã€‚è¿™æ ·ï¼Œå¤§å¤šæ•°åº”ç”¨ç¨‹åºå°†ä¸å—å½±å“ï¼ˆå¹¶ä¸”ç»§ç»­ä»…ä½¿ç”¨ 4 KB é¡µé¢ï¼›ä¸€äº›è¦æ±‚è¾ƒé«˜çš„åº”ç”¨ç¨‹åºå°†ä¸å¾—ä¸æ›´æ”¹ä¸ºä½¿ç”¨è¿™äº›æ¥å£ï¼Œä½†å¯¹å®ƒä»¬æ¥è¯´è¿™æ˜¯å€¼å¾—çš„ã€‚ æœ€è¿‘ï¼Œç”±äºè®¸å¤šåº”ç”¨ç¨‹åºå¯¹æ›´å¥½çš„ TLB è¡Œä¸ºçš„éœ€æ±‚æ›´åŠ æ™®éï¼ŒLinux å¼€å‘äººå‘˜æ·»åŠ äº†é€æ˜å¤§é¡µé¢æ”¯æŒã€‚å¯ç”¨æ­¤åŠŸèƒ½åï¼Œæ“ä½œç³»ç»Ÿä¼šè‡ªåŠ¨å¯»æ‰¾æœºä¼šåˆ†é…å¤§é¡µé¢ï¼ˆé€šå¸¸ä¸º 2 MBï¼Œä½†åœ¨æŸäº›ç³»ç»Ÿä¸Šä¸º 1 GBï¼‰ï¼Œè€Œæ— éœ€ä¿®æ”¹åº”ç”¨ç¨‹åºã€‚ å¤§é¡µé¢å¹¶éæ²¡æœ‰ä»£ä»·ã€‚æœ€å¤§çš„æ½œåœ¨æˆæœ¬æ˜¯å†…éƒ¨ç¢ç‰‡ï¼Œå³é¡µé¢å¾ˆå¤§ä½†å¾ˆå°‘ä½¿ç”¨ã€‚è¿™ç§å½¢å¼çš„æµªè´¹å¯èƒ½ä¼šç”¨å¤§é‡ä½†å¾ˆå°‘ä½¿ç”¨çš„é¡µé¢å¡«å……å†…å­˜ã€‚äº¤æ¢ï¼ˆå¦‚æœå¯ç”¨ï¼‰ä¹Ÿä¸èƒ½å¾ˆå¥½åœ°å¤„ç†å¤§é¡µé¢ï¼Œæœ‰æ—¶ä¼šå¤§å¤§å¢åŠ ç³»ç»Ÿçš„ I/O é‡ã€‚åˆ†é…çš„å¼€é”€ä¹Ÿå¯èƒ½å¾ˆç³Ÿç³•ï¼ˆåœ¨æŸäº›å…¶ä»–æƒ…å†µä¸‹ï¼‰ã€‚æ€»çš„æ¥è¯´ï¼Œæœ‰ä¸€ä»¶äº‹æ˜¯æ˜ç¡®çš„ï¼šå¤šå¹´æ¥ä¸ºç³»ç»Ÿæä¾›è‰¯å¥½æœåŠ¡çš„ 4 KB é¡µé¢å¤§å°ä¸å†åƒä»¥å‰é‚£æ ·æ˜¯é€šç”¨è§£å†³æ–¹æ¡ˆï¼›ä¸æ–­å¢é•¿çš„å†…å­˜å¤§å°è¦æ±‚æˆ‘ä»¬å°†å¤§é¡µé¢å’Œå…¶ä»–è§£å†³æ–¹æ¡ˆè§†ä¸ºè™šæ‹Ÿå†…å­˜ç³»ç»Ÿå¿…è¦å‘å±•çš„ä¸€éƒ¨åˆ†ã€‚ Linux å¯¹è¿™ç§åŸºäºç¡¬ä»¶çš„æŠ€æœ¯çš„ç¼“æ…¢é‡‡ç”¨è¯æ˜äº†å³å°†å‘ç”Ÿçš„å˜åŒ–ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:3:3","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 é¡µé¢ç¼“å­˜ ä¸ºäº†é™ä½è®¿é—®æŒä¹…å­˜å‚¨çš„æˆæœ¬ï¼Œå¤§å¤šæ•°ç³»ç»Ÿä½¿ç”¨ç§¯æçš„ç¼“å­˜å­ç³»ç»Ÿå°†å¸¸ç”¨çš„æ•°æ®é¡¹ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚åœ¨è¿™æ–¹é¢ï¼ŒLinux ä¸ä¼ ç»Ÿæ“ä½œç³»ç»Ÿæ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚ Linux é¡µé¢ç¼“å­˜æ˜¯ç»Ÿä¸€çš„ï¼Œå°†æ¥è‡ªä¸‰ä¸ªä¸»è¦æ¥æºçš„é¡µé¢ä¿ç•™åœ¨å†…å­˜ä¸­ï¼šå†…å­˜æ˜ å°„æ–‡ä»¶ã€æ¥è‡ªè®¾å¤‡çš„æ–‡ä»¶æ•°æ®å’Œå…ƒæ•°æ®ï¼ˆé€šå¸¸é€šè¿‡ç›´æ¥å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œ read() å’Œ write() è°ƒç”¨æ¥è®¿é—®ï¼‰ä»¥åŠå †å’Œæ ˆç»„æˆæ¯ä¸ªè¿›ç¨‹çš„é¡µé¢ï¼ˆæœ‰æ—¶ç§°ä¸ºåŒ¿åå†…å­˜ï¼Œå› ä¸ºå®ƒä¸‹é¢æ²¡æœ‰å‘½åæ–‡ä»¶ï¼Œè€Œæ˜¯äº¤æ¢ç©ºé—´ï¼‰ã€‚è¿™äº›å®ä½“ä¿å­˜åœ¨é¡µé¢ç¼“å­˜å“ˆå¸Œè¡¨ä¸­ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ‰€è¿°æ•°æ®æ—¶å¯ä»¥å¿«é€ŸæŸ¥æ‰¾ã€‚ å†…å­˜æ˜ å°„çš„æ™®éæ€§ å†…å­˜æ˜ å°„æ—©äº Linux å‡ºç°äº†å¥½å‡ å¹´ï¼Œå¹¶åœ¨ Linux å’Œå…¶ä»–ç°ä»£ç³»ç»Ÿä¸­çš„è®¸å¤šåœ°æ–¹ä½¿ç”¨ã€‚è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•ï¼šé€šè¿‡åœ¨å·²ç»æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ä¸Šè°ƒç”¨ mmap()ï¼Œè¿›ç¨‹å°†è¿”å›ä¸€ä¸ªæŒ‡å‘æ–‡ä»¶å†…å®¹ä¼¼ä¹æ‰€åœ¨çš„è™šæ‹Ÿå†…å­˜åŒºåŸŸå¼€å¤´çš„æŒ‡é’ˆã€‚ç„¶åï¼Œé€šè¿‡ä½¿ç”¨è¯¥æŒ‡é’ˆï¼Œè¿›ç¨‹å¯ä»¥é€šè¿‡ç®€å•çš„æŒ‡é’ˆè§£å¼•ç”¨æ¥è®¿é—®æ–‡ä»¶çš„ä»»ä½•éƒ¨åˆ†ã€‚ å¯¹å†…å­˜æ˜ å°„æ–‡ä»¶ä¸­å°šæœªè¿›å…¥å†…å­˜çš„éƒ¨åˆ†çš„è®¿é—®ä¼šè§¦å‘é¡µé¢é”™è¯¯ï¼Œæ­¤æ—¶æ“ä½œç³»ç»Ÿå°†åˆ†é¡µç›¸å…³æ•°æ®ï¼Œå¹¶é€šè¿‡ç›¸åº”åœ°æ›´æ–°è¿›ç¨‹çš„é¡µè¡¨æ¥ä½¿å…¶å¯è®¿é—®ï¼ˆå³ï¼Œè¯·æ±‚åˆ†é¡µï¼‰ ï¼‰ã€‚ æ¯ä¸ªå¸¸è§„ Linux è¿›ç¨‹éƒ½ä½¿ç”¨å†…å­˜æ˜ å°„æ–‡ä»¶ï¼Œå³ä½¿ main() ä¸­çš„ä»£ç ä¹Ÿä¸ä¼šç›´æ¥è°ƒç”¨ mmap()ï¼Œå› ä¸º Linux å°†ä»£ç ä»å¯æ‰§è¡Œæ–‡ä»¶å’Œå…±äº«åº“ä»£ç åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä¸‹é¢æ˜¯ pmap å‘½ä»¤è¡Œå·¥å…·çš„ï¼ˆé«˜åº¦ç¼©å†™ï¼‰è¾“å‡ºï¼Œå®ƒæ˜¾ç¤ºäº†å“ªäº›ä¸åŒçš„æ˜ å°„æ„æˆäº†æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼ˆshellï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º tcshï¼‰çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚è¾“å‡ºæ˜¾ç¤ºå››åˆ—ï¼šæ˜ å°„çš„è™šæ‹Ÿåœ°å€ã€å…¶å¤§å°ã€åŒºåŸŸçš„ä¿æŠ¤ä½ä»¥åŠæ˜ å°„æºï¼š æ˜ å°„çš„è™šæ‹Ÿåœ°å€ å¤§å° åŒºåŸŸçš„ä¿æŠ¤ä½ æ˜ å°„æº 0000000000400000 372K r-xâ€“ tcsh 00000000019d5000 1780K rwâ€” [anon] 00007f4e7cf06000 1792K r-xâ€“ libc-2.23.so 00007f4e7d2d0000 36K r-xâ€“ libcrypt-2.23.so 00007f4e7d508000 148K r-xâ€“ libtinfo.so.5.9 00007f4e7d731000 152K r-xâ€“ ld-2.23.so 00007f4e7d932000 16K rwâ€” [stack] æ­£å¦‚ä½ å¯ä»¥çœ‹åˆ°çš„è¾“å‡ºä¸­ï¼Œæ¥è‡ª tcsh äºŒè¿›åˆ¶æ–‡ä»¶çš„ä»£ç ä»¥åŠæ¥è‡ª libcã€libcryptã€libtinfo çš„ä»£ç ä»¥åŠæ¥è‡ªåŠ¨æ€é“¾æ¥å™¨æœ¬èº« (ld.so) çš„ä»£ç éƒ½æ˜ å°„åˆ°åœ°å€ç©ºé—´ã€‚è¿˜å­˜åœ¨ä¸¤ä¸ªåŒ¿ååŒºåŸŸï¼šå †ï¼ˆç¬¬äºŒä¸ªæ¡ç›®ï¼Œæ ‡è®°ä¸º anonï¼‰å’Œæ ˆï¼ˆæ ‡è®°ä¸º stackï¼‰ã€‚å†…å­˜æ˜ å°„æ–‡ä»¶ä¸ºæ“ä½œç³»ç»Ÿæ„å»ºç°ä»£åœ°å€ç©ºé—´æä¾›äº†ä¸€ç§ç®€å•æœ‰æ•ˆçš„æ–¹æ³• é¡µé¢ç¼“å­˜ä¼šè·Ÿè¸ªæ¡ç›®æ˜¯å¦å¹²å‡€ï¼ˆè¯»å–ä½†æœªæ›´æ–°ï¼‰æˆ–è„ï¼ˆåˆç§°ä¿®æ”¹ï¼‰ã€‚è„æ•°æ®ç”±åå°çº¿ç¨‹ï¼ˆç§°ä¸º pdflushï¼‰å®šæœŸå†™å…¥åå¤‡å­˜å‚¨ï¼ˆå³ï¼Œå†™å…¥æ–‡ä»¶æ•°æ®çš„ç‰¹å®šæ–‡ä»¶ï¼Œæˆ–äº¤æ¢åŒ¿ååŒºåŸŸçš„ç©ºé—´ï¼‰ï¼Œä»è€Œç¡®ä¿ä¿®æ”¹åçš„æ•°æ®æœ€ç»ˆè¢«å†™å›æŒä¹…å­˜å‚¨ã€‚æ­¤åå°æ´»åŠ¨è¦ä¹ˆåœ¨ç‰¹å®šæ—¶é—´æ®µåå‘ç”Ÿï¼Œè¦ä¹ˆåœ¨å¤ªå¤šé¡µé¢è¢«è§†ä¸ºè„é¡µæ—¶å‘ç”Ÿï¼ˆå‡ä¸ºå¯é…ç½®å‚æ•°ï¼‰ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿè¿è¡Œæ—¶å†…å­˜ä¸è¶³ï¼ŒLinux å¿…é¡»å†³å®šä»å†…å­˜ä¸­å‰”é™¤å“ªäº›é¡µé¢ä»¥é‡Šæ”¾ç©ºé—´ã€‚ä¸ºæ­¤ï¼ŒLinux ä½¿ç”¨ 2Q æ›¿æ¢çš„æ”¹è¿›å½¢å¼ï¼Œæˆ‘ä»¬åœ¨æ­¤è¿›è¡Œæè¿°ã€‚ åŸºæœ¬æ€æƒ³å¾ˆç®€å•ï¼šæ ‡å‡† LRU æ›¿æ¢æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å¯èƒ½ä¼šè¢«æŸäº›å¸¸è§çš„è®¿é—®æ¨¡å¼é¢ è¦†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹é‡å¤è®¿é—®ä¸€ä¸ªå¤§æ–‡ä»¶ï¼ˆå°¤å…¶æ˜¯æ¥è¿‘å†…å­˜å¤§å°æˆ–æ›´å¤§çš„æ–‡ä»¶ï¼‰ï¼ŒLRU ä¼šå°†æ‰€æœ‰å…¶ä»–æ–‡ä»¶è¸¢å‡ºå†…å­˜ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼šå°†è¯¥æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹ä¿ç•™åœ¨å†…å­˜ä¸­æ²¡æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬åœ¨è¢«è¸¢å‡ºå†…å­˜ä¹‹å‰æ°¸è¿œä¸ä¼šè¢«é‡æ–°å¼•ç”¨ã€‚ Linux ç‰ˆæœ¬çš„ 2Q æ›¿æ¢ç®—æ³•é€šè¿‡ä¿ç•™ä¸¤ä¸ªåˆ—è¡¨å¹¶åœ¨å®ƒä»¬ä¹‹é—´åˆ’åˆ†å†…å­˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç¬¬ä¸€æ¬¡è®¿é—®æ—¶ï¼Œä¸€ä¸ªé¡µé¢è¢«æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼ˆåŸè®ºæ–‡ä¸­ç§°ä¸ºA1ï¼Œä½†Linuxä¸­ä¸ºéæ´»åŠ¨åˆ—è¡¨ï¼‰ï¼›å½“å®ƒè¢«é‡æ–°å¼•ç”¨æ—¶ï¼Œè¯¥é¡µé¢ä¼šè¢«æå‡åˆ°å¦ä¸€ä¸ªé˜Ÿåˆ—ï¼ˆåŸæ¥ç§°ä¸ºAqï¼Œä½†åœ¨Linuxä¸­ç§°ä¸ºæ´»åŠ¨åˆ—è¡¨ï¼‰ã€‚å½“éœ€è¦è¿›è¡Œæ›¿æ¢æ—¶ï¼Œä»éæ´»åŠ¨åˆ—è¡¨ä¸­å–å‡ºæ›¿æ¢å€™é€‰è€…ã€‚ Linux è¿˜å®šæœŸå°†é¡µé¢ä»æ´»åŠ¨åˆ—è¡¨åº•éƒ¨ç§»åŠ¨åˆ°éæ´»åŠ¨åˆ—è¡¨ï¼Œä½¿æ´»åŠ¨åˆ—è¡¨ä¿æŒåœ¨æ€»é¡µé¢ç¼“å­˜å¤§å°çš„ä¸‰åˆ†ä¹‹äºŒå·¦å³ã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼ŒLinux ä¼šä»¥å®Œç¾çš„ LRU é¡ºåºç®¡ç†è¿™äº›åˆ—è¡¨ï¼Œä½†æ˜¯ï¼Œæ­£å¦‚å‰é¢ç« èŠ‚ä¸­æ‰€è®¨è®ºçš„ï¼Œè¿™æ ·åšçš„æˆæœ¬å¾ˆé«˜ã€‚å› æ­¤ï¼Œä¸è®¸å¤šæ“ä½œç³»ç»Ÿä¸€æ ·ï¼Œä½¿ç”¨ LRU çš„è¿‘ä¼¼å€¼ï¼ˆç±»ä¼¼äºæ—¶é’Ÿæ›¿æ¢ï¼‰ã€‚ è¿™ç§ 2Q æ–¹æ³•çš„è¡Œä¸ºé€šå¸¸ä¸ LRU éå¸¸ç›¸ä¼¼ï¼Œä½†åœ¨å¤„ç†å¾ªç¯è®¿é—®å¤§æ–‡ä»¶çš„æƒ…å†µæ—¶ï¼Œå…¶æ˜¾è‘—ç‰¹ç‚¹æ˜¯å°†å¾ªç¯è®¿é—®çš„é¡µé¢é™åˆ¶åœ¨éæ´»åŠ¨åˆ—è¡¨ä¸­ã€‚ç”±äºè¿™äº›é¡µé¢åœ¨è¢«è¸¢å‡ºå†…å­˜ä¹‹å‰ä»æœªè¢«é‡æ–°å¼•ç”¨è¿‡ï¼Œå› æ­¤å®ƒä»¬ä¸ä¼šå†²æ‰æ´»åŠ¨åˆ—è¡¨ä¸­çš„å…¶ä»–æœ‰ç”¨é¡µé¢ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:3:4","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.5 å®‰å…¨å’Œç¼“å†²åŒºæº¢å‡º ç°ä»£ VM ç³»ç»Ÿï¼ˆLinuxã€Solaris æˆ– BSD å˜ä½“ä¹‹ä¸€ï¼‰ä¸å¤ä»£ VM ç³»ç»Ÿï¼ˆVAX/VMSï¼‰ä¹‹é—´çš„æœ€å¤§åŒºåˆ«å¯èƒ½æ˜¯ç°ä»£å¯¹å®‰å…¨æ€§çš„é‡è§†ã€‚ä¿æŠ¤ä¸€ç›´æ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªä¸¥é‡é—®é¢˜ï¼Œä½†éšç€æœºå™¨çš„äº’è”ç¨‹åº¦æ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´åŠ ç´§å¯†ï¼Œå¼€å‘äººå‘˜å®æ–½äº†å„ç§é˜²å¾¡å¯¹ç­–æ¥é˜»æ­¢é‚£äº›ç‹¡çŒ¾çš„é»‘å®¢è·å¾—ç³»ç»Ÿæ§åˆ¶æƒä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚ ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ˜¯ä¸€ç§ä¸»è¦å¨èƒï¼Œå®ƒå¯ä»¥é’ˆå¯¹æ™®é€šç”¨æˆ·ç¨‹åºç”šè‡³å†…æ ¸æœ¬èº«ã€‚è¿™äº›æ”»å‡»çš„ç›®çš„æ˜¯æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸­çš„é”™è¯¯ï¼Œä½¿æ”»å‡»è€…å¯ä»¥å°†ä»»æ„æ•°æ®æ³¨å…¥ç›®æ ‡çš„åœ°å€ç©ºé—´ã€‚æœ‰æ—¶ä¼šå‡ºç°æ­¤ç±»æ¼æ´ï¼Œå› ä¸ºå¼€å‘äººå‘˜ï¼ˆé”™è¯¯åœ°ï¼‰å‡è®¾è¾“å…¥ä¸ä¼šå¤ªé•¿ï¼Œå› æ­¤ï¼ˆå¯ä¿¡åœ°ï¼‰å°†è¾“å…¥å¤åˆ¶åˆ°ç¼“å†²åŒºä¸­ï¼›å› ä¸ºè¾“å…¥å®é™…ä¸Šå¤ªé•¿ï¼Œæ‰€ä»¥å®ƒä¼šæº¢å‡ºç¼“å†²åŒºï¼Œä»è€Œè¦†ç›–ç›®æ ‡çš„å†…å­˜ã€‚åƒä¸‹é¢è¿™æ ·æ— è¾œçš„ä»£ç å¯èƒ½æ˜¯é—®é¢˜çš„æ ¹æºï¼š int some_function(char *input) { char dest_buffer[100]; strcpy(dest_buffer, input); // oops, unbounded copy! } åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™ç§æº¢å‡ºå¹¶ä¸ä¼šé€ æˆç¾éš¾æ€§åæœï¼Œä¾‹å¦‚ï¼Œæ— æ„åœ°å‘ç”¨æˆ·ç¨‹åºç”šè‡³æ“ä½œç³»ç»Ÿæä¾›ä¸è‰¯è¾“å…¥å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒï¼Œä½†ä¸ä¼šæ›´ç³Ÿã€‚ç„¶è€Œï¼Œæ¶æ„ç¨‹åºå‘˜å¯ä»¥ç²¾å¿ƒè®¾è®¡ä½¿ç¼“å†²åŒºæº¢å‡ºçš„è¾“å…¥ï¼Œä»¥ä¾¿å°†è‡ªå·±çš„ä»£ç æ³¨å…¥ç›®æ ‡ç³»ç»Ÿï¼Œä»è€Œæ¥ç®¡ç³»ç»Ÿå¹¶ä¸ºæ‰€æ¬²ä¸ºã€‚å¦‚æœæ”»å‡»ç½‘ç»œè¿æ¥çš„ç”¨æˆ·ç¨‹åºæˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥åœ¨è¢«æ”»å‡»çš„ç³»ç»Ÿä¸Šè¿è¡Œä»»æ„è®¡ç®—ï¼Œç”šè‡³å‡ºç§Ÿè®¡ç®—èµ„æºï¼›å¦‚æœæ”»å‡»æ“ä½œç³»ç»Ÿæœ¬èº«æˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®æ›´å¤šèµ„æºï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æƒé™å‡çº§ï¼ˆå³ç”¨æˆ·ä»£ç è·å¾—å†…æ ¸è®¿é—®æƒé™ï¼‰ã€‚ é˜²æ­¢ç¼“å†²åŒºæº¢å‡ºçš„ç¬¬ä¸€é“ä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€é“é˜²çº¿å°±æ˜¯é˜²æ­¢åœ¨åœ°å€ç©ºé—´çš„ç‰¹å®šåŒºåŸŸï¼ˆå¦‚æ ˆå†…ï¼‰æ‰§è¡Œä»»ä½•ä»£ç ã€‚AMD åœ¨å…¶ x86 ç‰ˆæœ¬ä¸­å¼•å…¥çš„ NX ä½ï¼ˆNo-eXecute çš„ç¼©å†™ï¼‰ï¼ˆè‹±ç‰¹å°”ç‰ˆæœ¬ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„ XD ä½ï¼‰å°±æ˜¯è¿™æ ·ä¸€ç§é˜²å¾¡æªæ–½ï¼›å®ƒåªéœ€é˜»æ­¢åœ¨ç›¸åº”é¡µè¡¨æ¡ç›®ä¸­è®¾ç½®äº†è¯¥ä½çš„ä»»ä½•é¡µé¢çš„æ‰§è¡Œã€‚è¿™ç§æ–¹æ³•å¯ä»¥é˜²æ­¢æ”»å‡»è€…æ³¨å…¥ç›®æ ‡æ ˆçš„ä»£ç è¢«æ‰§è¡Œï¼Œä»è€Œå‡è½»äº†é—®é¢˜ã€‚ ç„¶è€Œï¼Œèªæ˜çš„æ”»å‡»è€…æ˜¯â€¦â€¦èªæ˜çš„ï¼Œå³ä½¿æ”»å‡»è€…ä¸èƒ½æ˜¾ç¤ºæ·»åŠ æ³¨å…¥çš„ä»£ç ï¼Œæ¶æ„ä»£ç ä¹Ÿèƒ½æ‰§è¡Œä»»æ„ä»£ç åºåˆ—ã€‚è¿™ç§æƒ³æ³•ä»¥å…¶æœ€æ™®éçš„å½¢å¼è¢«ç§°ä¸ºè¿”å›å¯¼å‘ç¼–ç¨‹ï¼ˆreturn-oriented programming, ROPï¼‰[S07]ï¼Œå®ƒç¡®å®éå¸¸å‡ºè‰²ã€‚ROP èƒŒåçš„åŸç†æ˜¯ï¼Œä»»ä½•ç¨‹åºçš„åœ°å€ç©ºé—´ä¸­éƒ½æœ‰å¤§é‡çš„ä»£ç ä½ï¼ˆç”¨ ROP æœ¯è¯­æ¥è¯´å°±æ˜¯å°å·¥å…·ï¼‰ï¼Œå°¤å…¶æ˜¯ä¸åºå¤§çš„ C åº“é“¾æ¥çš„ C ç¨‹åºã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–æ ˆï¼Œä½¿å½“å‰æ‰§è¡Œå‡½æ•°ä¸­çš„è¿”å›åœ°å€æŒ‡å‘æ‰€éœ€çš„æ¶æ„æŒ‡ä»¤ï¼ˆæˆ–ä¸€ç³»åˆ—æŒ‡ä»¤ï¼‰ï¼Œç„¶åå†è¿”å›æŒ‡ä»¤ã€‚é€šè¿‡ä¸²è”å¤§é‡å°å·¥å…·ï¼ˆå³ç¡®ä¿æ¯æ¬¡è¿”å›éƒ½è·³è½¬åˆ°ä¸‹ä¸€ä¸ªå°å·¥å…·ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚ ä¸ºäº†æŠµå¾¡ ROPï¼ˆåŒ…æ‹¬å…¶æ—©æœŸå½¢å¼ï¼Œè¿”å›åˆ°åº“æ”»å‡»ï¼ˆreturn-to-libc æ”»å‡»ï¼‰ï¼‰ï¼ŒLinuxï¼ˆå’Œå…¶ä»–ç³»ç»Ÿï¼‰å¢åŠ äº†å¦ä¸€ç§é˜²å¾¡æ‰‹æ®µï¼Œå³åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰ã€‚æ“ä½œç³»ç»Ÿä¸æ˜¯å°†ä»£ç ã€æ ˆå’Œå †æ”¾åœ¨è™šæ‹Ÿåœ°å€ç©ºé—´å†…çš„å›ºå®šä½ç½®ï¼Œè€Œæ˜¯å°†å®ƒä»¬çš„ä½ç½®éšæœºåŒ–ï¼Œä»è€Œä½¿å®ç°è¿™ç±»æ”»å‡»æ‰€éœ€çš„å¤æ‚ä»£ç åºåˆ—å˜å¾—ç›¸å½“å…·æœ‰æŒ‘æˆ˜æ€§ã€‚å› æ­¤ï¼Œé’ˆå¯¹æ˜“å—æ”»å‡»çš„ç”¨æˆ·ç¨‹åºçš„å¤§å¤šæ•°æ”»å‡»éƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œä½†æ— æ³•æ§åˆ¶è¿è¡Œä¸­çš„ç¨‹åºã€‚ æœ‰è¶£çš„æ˜¯ï¼Œåœ¨å®è·µä¸­å¯ä»¥å¾ˆå®¹æ˜“åœ°è§‚å¯Ÿåˆ°è¿™ç§éšæœºæ€§ã€‚ä¸‹é¢æ˜¯ä¸€æ®µåœ¨ç°ä»£ Linux ç³»ç»Ÿä¸Šæ¼”ç¤ºçš„ä»£ç ï¼š int main(int argc, char *argv[]) { int stack = 0; printf(\"%p\\n\", \u0026stack); return 0; } è¿™æ®µä»£ç åªæ˜¯æ‰“å°å‡ºå †æ ˆä¸­å˜é‡çš„ï¼ˆè™šæ‹Ÿï¼‰åœ°å€ã€‚åœ¨è¾ƒæ—©çš„é ASLR ç³»ç»Ÿä¸­ï¼Œè¯¥å€¼æ¯æ¬¡éƒ½æ˜¯ç›¸åŒçš„ã€‚ä½†å¦‚ä¸‹æ‰€ç¤ºï¼Œæ¯æ¬¡è¿è¡Œæ—¶ï¼Œè¯¥å€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼š \u003e ./random 0x7ffd3e55d2b4 \u003e ./random 0x7ffe1033b8f4 \u003e ./random 0x7ffe45522e94 ASLR å¯¹äºç”¨æˆ·çº§ç¨‹åºæ¥è¯´æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„é˜²å¾¡æ‰‹æ®µï¼Œå› æ­¤å®ƒä¹Ÿè¢«çº³å…¥äº†å†…æ ¸ï¼Œå¹¶è¢«ç§°ä¸ºå†…æ ¸åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ˆKASLRï¼‰ã€‚ç„¶è€Œï¼Œäº‹å®è¯æ˜ï¼Œå†…æ ¸å¯èƒ½æœ‰æ›´å¤§çš„é—®é¢˜éœ€è¦å¤„ç†ï¼Œæ­£å¦‚æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®¨è®ºçš„é‚£æ ·ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:3:5","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.6 å…¶ä»–å®‰å…¨é—®é¢˜ï¼šç†”æ–­æ¼æ´å’Œå¹½çµæ¼æ´ ç³»ç»Ÿå®‰å…¨ä¸–ç•Œå·²ç»è¢«ä¸¤ä¸ªæ–°çš„ç›¸å…³æ”»å‡»é¢ è¦†äº†ã€‚ç¬¬ä¸€ä¸ªå«åš â€œç†”æ¯â€ï¼ˆMeltdownï¼‰ï¼Œç¬¬äºŒä¸ªå«åš â€œå¹½çµâ€ï¼ˆSpectreï¼‰ã€‚å®ƒä»¬æ˜¯ç”±å››ç»„ä¸åŒçš„ç ”ç©¶äººå‘˜/å·¥ç¨‹å¸ˆåœ¨å·®ä¸å¤šåŒä¸€æ—¶é—´å‘ç°çš„ï¼Œå¹¶å¼•å‘äº†å¯¹è®¡ç®—æœºç¡¬ä»¶å’Œä¸Šè¿°æ“ä½œç³»ç»Ÿæ‰€æä¾›çš„åŸºæœ¬ä¿æŠ¤æªæ–½çš„æ·±åˆ»è´¨ç–‘ã€‚æœ‰å…³æ¯ç§æ”»å‡»çš„è¯¦ç»†æè¿°ï¼Œè¯·å‚è§ meltdownattack.com å’Œ spectreattack.comã€‚å¹½çµè¢«è®¤ä¸ºæ˜¯è¿™ä¸¤ç§æ”»å‡»ä¸­é—®é¢˜è¾ƒå¤šçš„ä¸€ç§ã€‚ è¿™äº›æ”»å‡»æ‰€åˆ©ç”¨çš„ä¸€èˆ¬å¼±ç‚¹æ˜¯ï¼Œç°ä»£ç³»ç»Ÿä¸­çš„ CPU ä¼šåœ¨å¹•åæ‰§è¡Œå„ç§ç–¯ç‹‚çš„æŠ€å·§æ¥æé«˜æ€§èƒ½ã€‚å…¶ä¸­ä¸€ç±»æŠ€æœ¯æ˜¯é—®é¢˜çš„æ ¸å¿ƒï¼Œè¢«ç§°ä¸º â€œé¢„æµ‹æ‰§è¡Œâ€ï¼Œå³ CPU çŒœæµ‹å“ªäº›æŒ‡ä»¤å°†åœ¨æœªæ¥æ‰§è¡Œï¼Œå¹¶æå‰å¼€å§‹æ‰§è¡Œã€‚å¦‚æœçŒœæµ‹æ­£ç¡®ï¼Œç¨‹åºè¿è¡Œé€Ÿåº¦å°±ä¼šåŠ å¿«ï¼›å¦‚æœçŒœæµ‹ä¸æ­£ç¡®ï¼ŒCPUå°±ä¼šæ’¤æ¶ˆè¿™äº›æŒ‡ä»¤å¯¹æ¶æ„çŠ¶æ€ï¼ˆå¦‚å¯„å­˜å™¨ï¼‰çš„å½±å“ï¼Œå¹¶å†æ¬¡å°è¯•æ‰§è¡Œï¼Œè¿™ä¸€æ¬¡ä¼šæ²¿ç€æ­£ç¡®çš„è·¯å¾„è¿è¡Œã€‚ é¢„æµ‹çš„é—®é¢˜åœ¨äºï¼Œå®ƒå¾€å¾€ä¼šåœ¨ç³»ç»Ÿçš„å„ä¸ªéƒ¨åˆ†ï¼ˆå¦‚å¤„ç†å™¨ç¼“å­˜ã€åˆ†æ”¯é¢„æµ‹å™¨ç­‰ï¼‰ç•™ä¸‹æ‰§è¡Œç—•è¿¹ã€‚å› æ­¤ï¼Œé—®é¢˜å°±å‡ºç°äº†ï¼šæ­£å¦‚æ”»å‡»äº‹ä»¶çš„ä½œè€…æ‰€å±•ç¤ºçš„ï¼Œè¿™ç§çŠ¶æ€ä¼šä½¿å†…å­˜å†…å®¹å˜å¾—è„†å¼±ï¼Œç”šè‡³æ˜¯æˆ‘ä»¬è®¤ä¸ºå—åˆ° MMU ä¿æŠ¤çš„å†…å­˜ã€‚ å› æ­¤ï¼ŒåŠ å¼ºå†…æ ¸ä¿æŠ¤çš„ä¸€ä¸ªé€”å¾„å°±æ˜¯å°½å¯èƒ½åœ°å°†å†…æ ¸åœ°å€ç©ºé—´ä»æ¯ä¸ªç”¨æˆ·è¿›ç¨‹ä¸­ç§»é™¤ï¼Œè½¬è€Œä¸ºå¤§å¤šæ•°å†…æ ¸æ•°æ®å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„å†…æ ¸é¡µè¡¨ï¼ˆç§°ä¸ºå†…æ ¸é¡µè¡¨éš”ç¦»ï¼Œæˆ– KPTIï¼‰[G+17]ã€‚è¿™æ ·ï¼Œå†…æ ¸çš„ä»£ç å’Œæ•°æ®ç»“æ„å°±ä¸å†æ˜ å°„åˆ°æ¯ä¸ªè¿›ç¨‹ä¸­ï¼Œè€Œæ˜¯åªä¿ç•™æœ€åŸºæœ¬çš„éƒ¨åˆ†ï¼›å½“åˆ‡æ¢åˆ°å†…æ ¸æ—¶ï¼Œå°±éœ€è¦åˆ‡æ¢åˆ°å†…æ ¸é¡µè¡¨ã€‚è¿™æ ·åšæé«˜äº†å®‰å…¨æ€§ï¼Œé¿å…äº†ä¸€äº›æ”»å‡»å‘é‡ï¼Œä½†ä¹Ÿä»˜å‡ºäº†ä»£ä»·ï¼šæ€§èƒ½ã€‚åˆ‡æ¢é¡µè¡¨çš„ä»£ä»·å¾ˆé«˜ã€‚å®‰å…¨çš„ä»£ä»·ï¼šæ–¹ä¾¿å’Œæ€§èƒ½ã€‚ ä¸å¹¸çš„æ˜¯ï¼ŒKPTI å¹¶ä¸èƒ½è§£å†³ä¸Šè¿°æ‰€æœ‰å®‰å…¨é—®é¢˜ï¼Œåªèƒ½è§£å†³éƒ¨åˆ†é—®é¢˜ã€‚è€Œç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚å…³é—­é¢„æµ‹åŠŸèƒ½ï¼Œä¹Ÿæ²¡æœ‰å¤šå¤§æ„ä¹‰ï¼Œå› ä¸ºç³»ç»Ÿè¿è¡Œé€Ÿåº¦ä¼šé™ä½æ•°åƒå€ã€‚ ","date":"2024-04-25","objectID":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/:3:6","tags":["OS"],"title":"å®Œæ•´VMç³»ç»Ÿ","uri":"/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åœ¨è™šæ‹Ÿå†…å­˜ç®¡ç†å™¨ä¸­ï¼Œå½“æ‚¨æ‹¥æœ‰å¤§é‡å¯ç”¨å†…å­˜æ—¶ï¼Œç”Ÿæ´»ä¼šå¾ˆå®¹æ˜“ã€‚å‘ç”Ÿé¡µé¢é”™è¯¯æ—¶ï¼Œæ‚¨åœ¨ç©ºé—²é¡µé¢åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€ä¸ªç©ºé—²é¡µé¢ï¼Œå¹¶å°†å…¶åˆ†é…ç»™å‘ç”Ÿé”™è¯¯çš„é¡µé¢ã€‚å˜¿ï¼Œæ“ä½œç³»ç»Ÿï¼Œæ­å–œï¼ä½ åˆè¿™ä¹ˆåšäº†ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œå½“ç©ºé—²å†…å­˜å¾ˆå°‘æ—¶ï¼Œäº‹æƒ…å°±ä¼šå˜å¾—æ›´æœ‰è¶£ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ç§å†…å­˜å‹åŠ›ä¼šè¿«ä½¿æ“ä½œç³»ç»Ÿå¼€å§‹è°ƒå‡ºé¡µé¢ï¼Œä¸ºä¸»åŠ¨ä½¿ç”¨çš„é¡µé¢è…¾å‡ºç©ºé—´ã€‚å†³å®šè°ƒå‡ºå“ªä¸ªé¡µé¢ï¼ˆæˆ–å“ªäº›é¡µé¢ï¼‰å°è£…åœ¨æ“ä½œç³»ç»Ÿçš„æ›¿æ¢ç­–ç•¥ä¸­ï¼›ä»å†å²ä¸Šçœ‹ï¼Œè¿™æ˜¯æ—©æœŸè™šæ‹Ÿå†…å­˜ç³»ç»Ÿåšå‡ºçš„æœ€é‡è¦çš„å†³å®šä¹‹ä¸€ï¼Œå› ä¸ºè¾ƒæ—§çš„ç³»ç»Ÿå‡ ä¹æ²¡æœ‰ç‰©ç†å†…å­˜ã€‚è‡³å°‘ï¼Œè¿™æ˜¯ä¸€å¥—å€¼å¾—æ›´å¤šäº†è§£çš„æœ‰è¶£æ”¿ç­–ã€‚å› æ­¤æˆ‘ä»¬çš„é—®é¢˜å…³é”®æ˜¯ï¼šæ“ä½œç³»ç»Ÿå¦‚ä½•å†³å®šä»å†…å­˜ä¸­é©±é€å“ªä¸€é¡µï¼ˆæˆ–å¤šé¡µï¼‰ï¼Ÿè¿™ä¸€å†³å®šæ˜¯ç”±ç³»ç»Ÿçš„æ›¿æ¢ç­–ç•¥åšå‡ºçš„ï¼Œè¯¥ç­–ç•¥é€šå¸¸éµå¾ªä¸€äº›ä¸€èˆ¬åŸåˆ™ï¼ˆå¦‚ä¸‹æ‰€è¿°ï¼‰ï¼Œä½†ä¹ŸåŒ…æ‹¬æŸäº›è°ƒæ•´ä»¥é¿å…æç«¯æƒ…å†µè¡Œä¸ºã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:0:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ç¼“å­˜ç®¡ç† åœ¨æ·±å…¥è®¨è®ºç­–ç•¥ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ›´è¯¦ç»†åœ°æè¿°æˆ‘ä»¬è¯•å›¾è§£å†³çš„é—®é¢˜ã€‚é‰´äºä¸»å†…å­˜ä¿å­˜ç³»ç»Ÿä¸­æ‰€æœ‰é¡µé¢çš„æŸäº›å­é›†ï¼Œå®ƒå¯ä»¥æ­£ç¡®åœ°è¢«è§†ä¸ºç³»ç»Ÿä¸­è™šæ‹Ÿå†…å­˜é¡µé¢çš„ç¼“å­˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸ºæ­¤ç¼“å­˜é€‰æ‹©æ›¿æ¢ç­–ç•¥çš„ç›®æ ‡æ˜¯æœ€å°åŒ–ç¼“å­˜æœªå‘½ä¸­çš„æ¬¡æ•°ï¼Œå³æœ€å°åŒ–æˆ‘ä»¬å¿…é¡»ä»ç£ç›˜è·å–é¡µé¢çš„æ¬¡æ•°ã€‚æˆ–è€…ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å¯ä»¥è§†ä¸ºæœ€å¤§åŒ–ç¼“å­˜å‘½ä¸­æ•°ï¼Œå³åœ¨å†…å­˜ä¸­æ‰¾åˆ°è¢«è®¿é—®é¡µé¢çš„æ¬¡æ•°ã€‚ äº†è§£ç¼“å­˜å‘½ä¸­å’Œæœªå‘½ä¸­çš„æ¬¡æ•°åï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ç¨‹åºçš„å¹³å‡å†…å­˜è®¿é—®æ—¶é—´ (average memory access time, AMAT)ï¼ˆè®¡ç®—æœºæ¶æ„å¸ˆè®¡ç®—ç¡¬ä»¶ç¼“å­˜çš„åº¦é‡æ ‡å‡†]ï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œç»™å®šè¿™äº›å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ç¨‹åºçš„ AMATï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š $$ \\text{AMAT}=\\text{T}M+\\text{P}{Miss}\\cdot\\text{T}\\text{D} $$ å…¶ä¸­$\\text{T}M$è¡¨ç¤ºè®¿é—®å†…å­˜çš„æˆæœ¬ï¼Œ$\\text{T}D$è¡¨ç¤ºè®¿é—®ç£ç›˜çš„æˆæœ¬ï¼Œ$\\text{T}\\text{Miss}$æ˜¯åœ¨ç¼“å­˜ä¸­æ‰¾ä¸åˆ°æ•°æ®çš„æ¦‚ç‡ï¼ˆæœªå‘½ä¸­ï¼‰ï¼› $\\text{T}\\text{Miss}$ ä» 0.0 åˆ° 1.0 ä¸ç­‰ï¼Œæœ‰æ—¶æˆ‘ä»¬æŒ‡çš„æ˜¯ä¸¢å¤±ç‡ç™¾åˆ†æ¯”è€Œä¸æ˜¯æ¦‚ç‡ï¼ˆä¾‹å¦‚ï¼Œ10% çš„ä¸¢å¤±ç‡æ„å‘³ç€ $\\text{T}\\text{Miss}=0.10$ï¼‰ã€‚è¯·æ³¨æ„ï¼Œæ‚¨æ€»æ˜¯è¦ä¸ºè®¿é—®å†…å­˜ä¸­çš„æ•°æ®ä»˜å‡ºä»£ä»·ï¼›ç„¶è€Œï¼Œå½“æ‚¨æœªå‘½ä¸­æ—¶ï¼Œæ‚¨å¿…é¡»é¢å¤–æ”¯ä»˜ä»ç£ç›˜è·å–æ•°æ®çš„æˆæœ¬ã€‚ ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æƒ³è±¡ä¸€å°å…·æœ‰ï¼ˆå¾®å°ï¼‰åœ°å€ç©ºé—´çš„æœºå™¨ï¼š4KBï¼Œå…·æœ‰ 256 å­—èŠ‚é¡µé¢ã€‚å› æ­¤ï¼Œè™šæ‹Ÿåœ°å€æœ‰ä¸¤ä¸ªç»„æˆéƒ¨åˆ†ï¼š4 ä½ VPNï¼ˆæœ€é«˜æœ‰æ•ˆä½ï¼‰å’Œ 8 ä½åç§»é‡ï¼ˆæœ€ä½æœ‰æ•ˆä½ï¼‰ã€‚å› æ­¤ï¼Œè¯¥ç¤ºä¾‹ä¸­çš„è¿›ç¨‹æ€»å…±å¯ä»¥è®¿é—® $2^4$ æˆ– 16 ä¸ªè™šæ‹Ÿé¡µã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œè¿›ç¨‹ç”Ÿæˆä»¥ä¸‹å†…å­˜å¼•ç”¨ï¼ˆå³è™šæ‹Ÿåœ°å€ï¼‰ï¼š0x000ã€0x100ã€0x200ã€0x300ã€0x400ã€0x500ã€0x600ã€0x700ã€0x800ã€0x900ã€‚è¿™äº›è™šæ‹Ÿåœ°å€æŒ‡çš„æ˜¯åœ°å€ç©ºé—´å‰åé¡µä¸­æ¯ä¸€é¡µçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆé¡µå·æ˜¯æ¯ä¸ªè™šæ‹Ÿåœ°å€çš„ç¬¬ä¸€ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼‰ã€‚ è®©æˆ‘ä»¬è¿›ä¸€æ­¥å‡è®¾é™¤è™šæ‹Ÿé¡µ 3 ä¹‹å¤–çš„æ‰€æœ‰é¡µéƒ½å·²åœ¨å†…å­˜ä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„å†…å­˜å¼•ç”¨åºåˆ—å°†é‡åˆ°ä»¥ä¸‹è¡Œä¸ºï¼šå‘½ä¸­ï¼Œå‘½ä¸­ï¼Œå‘½ä¸­ï¼Œæœªå‘½ä¸­ï¼Œå‘½ä¸­ï¼Œå‘½ä¸­ï¼Œå‘½ä¸­ï¼Œå‘½ä¸­ï¼Œå‘½ä¸­ï¼Œå‘½ä¸­ã€‚æˆ‘ä»¬å¯ä»¥è®¡ç®—å‘½ä¸­ç‡ï¼ˆåœ¨å†…å­˜ä¸­æ‰¾åˆ°çš„å¼•ç”¨çš„ç™¾åˆ†æ¯”ï¼‰ï¼š90%ï¼Œå› ä¸ºååˆ†ä¹‹ä¹çš„å¼•ç”¨åœ¨å†…å­˜ä¸­ã€‚å› æ­¤ï¼Œä¸ºå‘½ä¸­ç‡ç‡ä¸º 10%ï¼ˆ$\\text{P}\\text{Miss}=0.10$ï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ$\\text{P}\\text{Hit}+\\text{P}_\\text{Miss}=0.10=1.0$ï¼›å‘½ä¸­ç‡åŠ ä¸Šæœªå‘½ä¸­ç‡ä¹‹å’Œä¸º 100%ã€‚ ä¸ºäº†è®¡ç®—AMATï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è®¿é—®å†…å­˜çš„æˆæœ¬å’Œè®¿é—®ç£ç›˜çš„æˆæœ¬ã€‚å‡è®¾è®¿é—®å†…å­˜çš„æˆæœ¬ (TM ) çº¦ä¸º 100 çº³ç§’ï¼Œè®¿é—®ç£ç›˜çš„æˆæœ¬ (TD ) çº¦ä¸º 10 æ¯«ç§’ï¼Œåˆ™æˆ‘ä»¬æœ‰ä»¥ä¸‹ AMATï¼š100ns + 0.1 Â· 10msï¼Œå³ 100ns + 1msï¼Œå³ 1.0001 msï¼Œæˆ–å¤§çº¦1æ¯«ç§’ã€‚å¦‚æœæˆ‘ä»¬çš„å‘½ä¸­ç‡ä¸º 99.9%ï¼ˆPmiss = 0.001ï¼‰ï¼Œç»“æœå°±å®Œå…¨ä¸åŒï¼šAMAT ä¸º 10.1 å¾®ç§’ï¼Œæˆ–è€…å¤§çº¦å¿« 100 å€ã€‚å½“å‘½ä¸­ç‡æ¥è¿‘ 100% æ—¶ï¼ŒAMAT æ¥è¿‘ 100 çº³ç§’ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œæ­£å¦‚æ‚¨åœ¨æ­¤ç¤ºä¾‹ä¸­æ‰€çœ‹åˆ°çš„ï¼Œç°ä»£ç³»ç»Ÿä¸­ç£ç›˜è®¿é—®çš„æˆæœ¬éå¸¸é«˜ï¼Œå³ä½¿å¾ˆå°çš„æœªå‘½ä¸­ç‡ä¹Ÿä¼šå¾ˆå¿«ä¸»å¯¼æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„æ•´ä½“ AMATã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦å°½å¯èƒ½é¿å…æœªå‘½ä¸­æˆ–ä»¥ç£ç›˜é€Ÿç‡ç¼“æ…¢è¿è¡Œã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯ä»”ç»†åˆ¶å®šæ˜æ™ºçš„ç­–ç•¥ï¼Œå°±åƒæˆ‘ä»¬ç°åœ¨æ‰€åšçš„é‚£æ ·ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:1:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æœ€ä½³æ›¿æ¢ç­–ç•¥ ä¸ºäº†æ›´å¥½åœ°ç†è§£ç‰¹å®šæ›¿æ¢ç­–ç•¥çš„å·¥ä½œåŸç†ï¼Œæœ€å¥½å°†å…¶ä¸æœ€ä½³æ›¿æ¢ç­–ç•¥è¿›è¡Œæ¯”è¾ƒã€‚äº‹å®è¯æ˜ï¼ŒBeladyå¤šå¹´å‰å°±æå‡ºäº†è¿™æ ·ä¸€ç§æœ€ä½³ç­–ç•¥ï¼ˆä»–æœ€åˆç§°ä¹‹ä¸º MINï¼‰ã€‚æœ€ä½³æ›¿æ¢ç­–ç•¥ä¼šå¯¼è‡´æ€»ä½“æœªå‘½ä¸­æ¬¡æ•°æœ€å°‘ã€‚Belady è¯æ˜äº†ä¸€ç§ç®€å•ï¼ˆä½†ä¸å¹¸çš„æ˜¯ï¼Œå¾ˆéš¾å®ç°ï¼ï¼‰çš„æ–¹æ³•ï¼Œå³æ›¿æ¢æœªæ¥è®¿é—®è·ç¦»æœ€è¿œçš„é¡µé¢æ˜¯æœ€ä½³ç­–ç•¥ï¼Œå®ƒèƒ½å¸¦æ¥å°½å¯èƒ½å°‘çš„ç¼“å­˜ç¼ºå¤±ã€‚ TIPï¼šä¸æœ€ä¼˜ç®—æ³•è¿›è¡Œæ¯”è¾ƒæ˜¯æœ‰ç”¨çš„ è™½ç„¶æœ€ä¼˜ç®—æ³•ä½œä¸ºå®é™…ç­–ç•¥å¹¶ä¸å®ç”¨ï¼Œä½†åœ¨æ¨¡æ‹Ÿæˆ–å…¶ä»–ç ”ç©¶ä¸­ä½œä¸ºæ¯”è¾ƒç‚¹å´éå¸¸æœ‰ç”¨ã€‚å¦‚æœè¯´ä½ çš„æ–°ç®—æ³•æœ‰ 80% çš„å‘½ä¸­ç‡ï¼Œè¿™å¹¶æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼›å¦‚æœè¯´æœ€ä¼˜ç®—æ³•æœ‰ 82% çš„å‘½ä¸­ç‡ï¼ˆå› æ­¤ä½ çš„æ–°æ–¹æ³•éå¸¸æ¥è¿‘æœ€ä¼˜ç®—æ³•ï¼‰ï¼Œè¿™å°†ä½¿ç»“æœæ›´æœ‰æ„ä¹‰ï¼Œå¹¶èµ‹äºˆå…¶èƒŒæ™¯ã€‚å› æ­¤ï¼Œåœ¨ä½ è¿›è¡Œçš„ä»»ä½•ç ”ç©¶ä¸­ï¼ŒçŸ¥é“æœ€ä½³å€¼æ˜¯ä»€ä¹ˆå¯ä»¥è®©ä½ è¿›è¡Œæ›´å¥½çš„æ¯”è¾ƒï¼Œæ˜¾ç¤ºè¿˜æœ‰å¤šå°‘æ”¹è¿›çš„å¯èƒ½ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™ä½ å¯ä»¥åœæ­¢æ”¹è¿›ä½ çš„ç­–ç•¥ï¼Œå› ä¸ºå®ƒå·²ç»è¶³å¤Ÿæ¥è¿‘ç†æƒ³å€¼äº†ã€‚ å¸Œæœ›æœ€ä¼˜ç­–ç•¥èƒŒåçš„ç›´è§‰æ˜¯æœ‰é“ç†çš„ã€‚ä½ å¯ä»¥è¿™æ ·æƒ³ï¼šå¦‚æœä½ å¿…é¡»æ‰”æ‰æŸä¸ªé¡µé¢ï¼Œä¸ºä»€ä¹ˆä¸æ‰”æ‰ç¦»ç°åœ¨æœ€è¿œçš„é‚£ä¸ªé¡µé¢å‘¢ï¼Ÿè¿™æ ·åšå®è´¨ä¸Šæ˜¯åœ¨è¯´ï¼Œç¼“å­˜ä¸­çš„æ‰€æœ‰å…¶ä»–é¡µé¢éƒ½æ¯”æœ€è¿œçš„é‚£ä¸€é¡µæ›´é‡è¦ã€‚åŸå› å¾ˆç®€å•ï¼šåœ¨è®¿é—®æœ€è¿œçš„é‚£ä¸€é¡µä¹‹å‰ï¼Œä½ ä¼šå…ˆè®¿é—®å…¶ä»–é¡µé¢ã€‚ è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥äº†è§£æœ€ä¼˜ç­–ç•¥çš„å†³ç­–ã€‚å‡è®¾ä¸€ä¸ªç¨‹åºè®¿é—®ä»¥ä¸‹è™šæ‹Ÿé¡µé¢æµï¼š0, 1, 2, 0, 1, 3, 0, 3, 1, 2, 1ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æœ€ä¼˜ç­–ç•¥çš„è¡Œä¸ºï¼Œå‡è®¾ç¼“å­˜å¯ä»¥å®¹çº³ä¸‰ä¸ªé¡µé¢ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ä»¥ä¸‹æ“ä½œã€‚æ¯«ä¸å¥‡æ€ªï¼Œå‰ä¸‰æ¬¡è®¿é—®éƒ½æ˜¯æœªå‘½ä¸­ï¼Œå› ä¸ºé«˜é€Ÿç¼“å­˜ä¸€å¼€å§‹æ˜¯ç©ºçš„ï¼›è¿™ç§æœªå‘½ä¸­æœ‰æ—¶è¢«ç§°ä¸ºå†·å¯åŠ¨æœªå‘½ä¸­ï¼ˆæˆ–å¼ºåˆ¶æœªå‘½ä¸­ï¼‰ã€‚ç„¶åæˆ‘ä»¬å†æ¬¡è®¿é—®ç¬¬ 0 é¡µå’Œç¬¬ 1 é¡µï¼Œå®ƒä»¬éƒ½åœ¨ç¼“å­˜ä¸­è¢«å‘½ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬åˆå‘ç”Ÿäº†ä¸€æ¬¡ç¼ºå¤±ï¼ˆç¬¬ 3 é¡µï¼‰ï¼Œä½†è¿™æ¬¡ç¼“å­˜å·²æ»¡ï¼Œå¿…é¡»è¿›è¡Œæ›¿æ¢ï¼è¿™å°±å¼•å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬åº”è¯¥æ›¿æ¢å“ªä¸€é¡µï¼Ÿæ ¹æ®æœ€ä¼˜ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥å½“å‰ç¼“å­˜ä¸­æ¯ä¸ªé¡µé¢ï¼ˆ0ã€1 å’Œ 2ï¼‰çš„æœªæ¥è®¿é—®æƒ…å†µï¼Œå‘ç° 0 é¡µé¢å‡ ä¹ä¼šç«‹å³è¢«è®¿é—®ï¼Œ1 é¡µé¢ä¼šç¨åè¢«è®¿é—®ï¼Œè€Œ 2 é¡µé¢åœ¨æœªæ¥ä¼šè¢«è®¿é—®å¾—æœ€è¿œã€‚å› æ­¤ï¼Œæœ€ä¼˜ç­–ç•¥å¾ˆå®¹æ˜“åšå‡ºé€‰æ‹©ï¼šåˆ é™¤ç¬¬ 2 é¡µï¼Œè¿™æ ·ç¼“å­˜ä¸­å°±æœ‰äº†ç¬¬ 0ã€1 å’Œ 3 é¡µã€‚æ¥ä¸‹æ¥çš„ä¸‰ä¸ªå¼•ç”¨éƒ½æ˜¯å‘½ä¸­çš„ï¼Œä½†æˆ‘ä»¬åˆ°äº† 2 é¡µæ—¶ï¼Œå´åˆé­é‡äº†ä¸€æ¬¡æœªå‘½ä¸­ã€‚åœ¨è¿™é‡Œï¼Œæœ€ä¼˜ç­–ç•¥å†æ¬¡æ£€æŸ¥äº†ç¼“å­˜ä¸­æ¯ä¸ªé¡µé¢ï¼ˆ0ã€1 å’Œ 3ï¼‰çš„æœªæ¥è®¿é—®æƒ…å†µï¼Œå‘ç°åªè¦ä¸é©±é€ç¬¬ 1 é¡µï¼ˆå³å°†è¢«è®¿é—®ï¼‰ï¼Œæˆ‘ä»¬å°±ä¸ä¼šæœ‰é—®é¢˜ã€‚ç¤ºä¾‹æ˜¾ç¤ºç¬¬ 3 é¡µè¢«é©±é€ï¼Œå°½ç®¡ç¬¬ 0 é¡µä¹Ÿå¯ä»¥è¢«é©±é€ã€‚æœ€åï¼Œæˆ‘ä»¬å‘½ä¸­äº†ç¬¬ 1 é¡µï¼Œè·Ÿè¸ªå®Œæˆã€‚ æˆ‘ä»¬è¿˜å¯ä»¥è®¡ç®—ç¼“å­˜çš„å‘½ä¸­ç‡ï¼šåœ¨ 6 æ¬¡å‘½ä¸­å’Œ 5 æ¬¡æœªå‘½ä¸­çš„æƒ…å†µä¸‹ï¼Œå‘½ä¸­ç‡ä¸º$\\frac{\\text{Hits}}{\\text{Hits+Misses}}$å‘½ä¸­+æœªå‘½ä¸­ï¼Œå³ $\\frac{6}{6+5}$æˆ– 54.5%ã€‚æˆ‘ä»¬è¿˜å¯ä»¥è®¡ç®—å¼ºåˆ¶æœªå‘½ä¸­çš„å‘½ä¸­ç‡ï¼ˆå³å¿½ç•¥å¯¹ç»™å®šé¡µé¢çš„ç¬¬ä¸€æ¬¡æœªå‘½ä¸­ï¼‰ï¼Œç»“æœæ˜¯å‘½ä¸­ç‡ä¸º 85.7%ã€‚ é—æ†¾çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰åœ¨å¼€å‘è°ƒåº¦ç­–ç•¥æ—¶æ‰€çœ‹åˆ°çš„ï¼Œæœªæ¥å¹¶ä¸æ™®éä¸ºäººæ‰€çŸ¥ï¼›ä½ ä¸å¯èƒ½ä¸ºé€šç”¨æ“ä½œç³»ç»Ÿæ„å»ºæœ€ä¼˜ç­–ç•¥ã€‚å› æ­¤ï¼Œåœ¨å¼€å‘çœŸæ­£çš„ã€å¯éƒ¨ç½²çš„ç­–ç•¥æ—¶ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨é‚£äº›èƒ½æ‰¾åˆ°å…¶ä»–æ–¹æ³•æ¥å†³å®šé©±é€å“ªä¸ªé¡µé¢çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œæœ€ä½³ç­–ç•¥åªèƒ½ä½œä¸ºä¸€ä¸ªæ¯”è¾ƒç‚¹ï¼Œä»¥äº†è§£æˆ‘ä»¬ç¦» â€œå®Œç¾ â€œè¿˜æœ‰å¤šè¿œã€‚ ç¼“å­˜æœªå‘½ä¸­çš„ç±»å‹ åœ¨è®¡ç®—æœºä½“ç³»ç»“æ„é¢†åŸŸï¼Œæ¶æ„å¸ˆæœ‰æ—¶å‘ç°æŒ‰ç±»å‹å°†æœªå‘½ä¸­ç‰¹å¾åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ä¹‹ä¸€å¾ˆæœ‰ç”¨ï¼šå¼ºåˆ¶ã€å®¹é‡å’Œå†²çªæœªå‘½ä¸­ï¼Œæœ‰æ—¶ç§°ä¸º 3 Cã€‚å‘ç”Ÿå¼ºåˆ¶æœªå‘½ä¸­ï¼ˆæˆ–å†·å¯åŠ¨æœªå‘½ä¸­ï¼‰æ˜¯å› ä¸ºç¼“å­˜ä¸€å¼€å§‹å°±æ˜¯ç©ºçš„ï¼Œå¹¶ä¸”è¿™æ˜¯å¯¹è¯¥é¡¹ç›®çš„ç¬¬ä¸€æ¬¡å¼•ç”¨ï¼›ç›¸åï¼Œç”±äºç¼“å­˜ç©ºé—´ä¸è¶³ï¼Œå¿…é¡»é€å‡ºä¸€ä¸ªé¡¹ç›®æ‰èƒ½å°†æ–°é¡¹ç›®æ”¾å…¥ç¼“å­˜ï¼Œå› æ­¤ä¼šå‘ç”Ÿå®¹é‡æœªå‘½ä¸­ã€‚ç¬¬ä¸‰ç§ç±»å‹çš„æœªå‘½ä¸­ï¼ˆå†²çªæœªå‘½ä¸­ï¼‰å‡ºç°åœ¨ç¡¬ä»¶ä¸­ï¼Œå› ä¸ºç”±äºæ‰€è°“çš„â€œç»„å…³è”æ€§â€ï¼ˆsetassociativityï¼‰ï¼Œé¡¹ç›®å¯ä»¥æ”¾ç½®åœ¨ç¡¬ä»¶ç¼“å­˜ä¸­çš„ä½ç½®å—åˆ°é™åˆ¶ã€‚å®ƒä¸ä¼šå‡ºç°åœ¨æ“ä½œç³»ç»Ÿé¡µé¢ç¼“å­˜ä¸­ï¼Œå› ä¸ºæ­¤ç±»ç¼“å­˜å§‹ç»ˆæ˜¯å®Œå…¨å…³è”çš„ï¼Œå³é¡µé¢å¯ä»¥æ”¾ç½®åœ¨å†…å­˜ä¸­çš„ä½ç½®æ²¡æœ‰é™åˆ¶ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:2:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 FIFOï¼ˆå…ˆè¿›å…ˆå‡ºç­–ç•¥ï¼‰ è®¸å¤šæ—©æœŸç³»ç»Ÿé¿å…äº†å°è¯•æ¥è¿‘æœ€ä¼˜çš„å¤æ‚æ€§ï¼Œè€Œæ˜¯é‡‡ç”¨äº†éå¸¸ç®€å•çš„æ›¿æ¢ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œä¸€äº›ç³»ç»Ÿä½¿ç”¨ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æ›¿æ¢ï¼Œå…¶ä¸­é¡µé¢åœ¨è¿›å…¥ç³»ç»Ÿæ—¶è¢«ç®€å•åœ°æ”¾ç½®åœ¨é˜Ÿåˆ—ä¸­ï¼›å½“å‘ç”Ÿæ›¿æ¢æ—¶ï¼Œé˜Ÿåˆ—å°¾éƒ¨çš„é¡µé¢ï¼ˆâ€œå…ˆå…¥â€é¡µé¢ï¼‰å°†è¢«é€å‡ºã€‚ FIFO æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹ï¼šå®ç°èµ·æ¥éå¸¸ç®€å•ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸º FIFO åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹å¼•ç”¨æµä¸Šçš„è¡¨ç°ã€‚æˆ‘ä»¬å†æ¬¡ä»¥å¯¹é¡µé¢ 0ã€1 å’Œ 2 çš„ä¸‰ä¸ªå¼ºåˆ¶æœªå‘½ä¸­å¼€å§‹è·Ÿè¸ªï¼Œç„¶åå‘½ä¸­ 0 å’Œ 1ã€‚æ¥ä¸‹æ¥ï¼Œå¼•ç”¨ç¬¬ 3 é¡µï¼Œå¯¼è‡´æœªå‘½ä¸­ï¼›ä½¿ç”¨ FIFO è¿›è¡Œæ›¿æ¢å†³ç­–å¾ˆå®¹æ˜“ï¼šé€‰æ‹©ç¬¬ä¸€ä¸ªé¡µé¢ï¼ˆå›¾ä¸­çš„ç¼“å­˜çŠ¶æ€æŒ‰ FIFO é¡ºåºä¿å­˜ï¼Œç¬¬ä¸€ä¸ªé¡µé¢ä½äºå·¦ä¾§ï¼‰ï¼Œå³ç¬¬ 0 é¡µã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªè®¿é—®æ˜¯é¡µ 0ï¼Œå¯¼è‡´å¦ä¸€æ¬¡ä¸¢å¤±å’Œæ›¿æ¢ï¼ˆé¡µ 1ï¼‰ã€‚ç„¶åæˆ‘ä»¬å‘½ä¸­äº†ç¬¬ 3 é¡µï¼Œä½†ç¬¬ 1 å’Œç¬¬ 2 é¡µæœªå‘½ä¸­ï¼Œæœ€åå‘½ä¸­äº†ç¬¬ 1 é¡µã€‚ å°† FIFO ä¸æœ€ä½³å€¼ç›¸æ¯”ï¼ŒFIFO çš„å‘½ä¸­ç‡æ˜æ˜¾æ›´å·®ï¼š36.4% çš„å‘½ä¸­ç‡ï¼ˆæˆ– 57.1%ï¼Œä¸åŒ…æ‹¬å¼ºåˆ¶å‘½ä¸­ç‡ï¼‰ã€‚ FIFO æ ¹æœ¬æ— æ³•ç¡®å®šå—çš„é‡è¦æ€§ï¼šå³ä½¿é¡µ 0 å·²è¢«è®¿é—®å¤šæ¬¡ï¼ŒFIFO ä»ç„¶ä¼šå°†å…¶è¸¢å‡ºï¼Œä»…ä»…å› ä¸ºå®ƒæ˜¯ç¬¬ä¸€ä¸ªè¿›å…¥å†…å­˜çš„å—ã€‚ BELADY çš„å¼‚å¸¸ Beladyï¼ˆæœ€ä¼˜ç­–ç•¥æå‡ºè€…ï¼‰å’ŒåŒäº‹å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„å¼•ç”¨æµï¼Œå…¶è¡Œä¸ºæœ‰ç‚¹å‡ºä¹æ„æ–™ã€‚å†…å­˜å¼•ç”¨æµï¼š1,2,3,4,1,2,5,1,2,3,4,5ã€‚ä»–ä»¬ç ”ç©¶çš„æ›¿æ¢ç­–ç•¥æ˜¯å…ˆè¿›å…ˆå‡ºã€‚æœ‰è¶£çš„éƒ¨åˆ†æ˜¯ï¼šå½“ç¼“å­˜å¤§å°ä» 3 é¡µç§»åŠ¨åˆ° 4 é¡µæ—¶ï¼Œç¼“å­˜å‘½ä¸­ç‡å¦‚ä½•å˜åŒ–ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå½“ç¼“å­˜å˜å¤§æ—¶ï¼Œæ‚¨ä¼šæœŸæœ›ç¼“å­˜å‘½ä¸­ç‡ä¼šå¢åŠ ï¼ˆå˜å¾—æ›´å¥½ï¼‰ã€‚ä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä½¿ç”¨ FIFOï¼Œæƒ…å†µä¼šå˜å¾—æ›´ç³Ÿï¼è¿™ç§å¥‡æ€ªçš„è¡Œä¸ºé€šå¸¸è¢«ç§°ä¸ºBELADY çš„å¼‚å¸¸ã€‚å…¶ä»–ä¸€äº›ç­–ç•¥ï¼Œä¾‹å¦‚ LRUï¼Œä¸ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚äº‹å®è¯æ˜ï¼ŒLRU å…·æœ‰æ‰€è°“çš„å †æ ˆå±æ€§ ã€‚å¯¹äºå…·æœ‰æ­¤å±æ€§çš„ç®—æ³•ï¼Œå¤§å°ä¸º N + 1 çš„ç¼“å­˜è‡ªç„¶åŒ…å«å¤§å°ä¸º N çš„ç¼“å­˜çš„å†…å®¹ã€‚å› æ­¤ï¼Œå½“å¢åŠ ç¼“å­˜å¤§å°æ—¶ï¼Œå‘½ä¸­ç‡å°†ä¿æŒä¸å˜æˆ–æé«˜ã€‚ FIFO å’Œ Randomï¼ˆä»¥åŠå…¶ä»–ï¼‰æ˜¾ç„¶ä¸éµå®ˆå †æ ˆå±æ€§ï¼Œå› æ­¤å®¹æ˜“å—åˆ°å¼‚å¸¸è¡Œä¸ºçš„å½±å“ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:3:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 éšæœºç­–ç•¥ å¦ä¸€ç§ç±»ä¼¼çš„æ›¿æ¢ç­–ç•¥æ˜¯éšæœºç­–ç•¥ï¼Œå®ƒåªæ˜¯åœ¨å†…å­˜å‹åŠ›ä¸‹é€‰æ‹©éšæœºé¡µé¢è¿›è¡Œæ›¿æ¢ã€‚ Random å…·æœ‰ä¸ FIFO ç±»ä¼¼çš„å±æ€§ï¼›å®ƒå®ç°èµ·æ¥å¾ˆç®€å•ï¼Œä½†å®ƒå¹¶æ²¡æœ‰çœŸæ­£å°è¯•å¤ªæ™ºèƒ½åœ°é€‰æ‹©è¦é©±é€çš„å—ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ Random åœ¨æˆ‘ä»¬è‘—åçš„ç¤ºä¾‹å¼•ç”¨æµä¸Šçš„è¡¨ç°å¦‚ä½•ã€‚ å½“ç„¶ï¼ŒRandom çš„è¡¨ç°å®Œå…¨å–å†³äº Random åœ¨å…¶é€‰æ‹©ä¸­çš„å¹¸è¿ï¼ˆæˆ–ä¸å¹¸ï¼‰ç¨‹åº¦ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒRandom çš„è¡¨ç°æ¯” FIFO å¥½ä¸€ç‚¹ï¼Œæ¯”æœ€ä¼˜çš„å·®ä¸€ç‚¹ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œéšæœºå®éªŒæ•°åƒæ¬¡å¹¶ç¡®å®šå®ƒçš„æ€»ä½“è¡¨ç°ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº† Random åœ¨ 10,000 å¤šæ¬¡è¯•éªŒä¸­å®ç°äº†å¤šå°‘æ¬¡å‘½ä¸­ï¼Œæ¯æ¬¡è¯•éªŒéƒ½æœ‰ä¸åŒçš„éšæœºç§å­ã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæœ‰æ—¶ï¼ˆä»…è¶…è¿‡ 40% çš„æ—¶é—´ï¼‰ï¼ŒRandom ä¸æœ€ä½³æ•ˆæœä¸€æ ·å¥½ï¼Œåœ¨ç¤ºä¾‹è·Ÿè¸ªä¸Šå®ç°äº† 6 ä¸ªå‘½ä¸­ï¼›æœ‰æ—¶æ•ˆæœæ›´ç³Ÿï¼Œè¾¾åˆ° 2 æ¬¡æˆ–æ›´å°‘ã€‚éšæœºæŠ½å¥–çš„æ•ˆæœå¦‚ä½•å–å†³äºæŠ½å¥–çš„è¿æ°”ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:4:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 ä½¿ç”¨å†å²è®°å½•ï¼šLRU ä¸å¹¸çš„æ˜¯ï¼Œä»»ä½•åƒ FIFO æˆ– Random è¿™æ ·ç®€å•çš„ç­–ç•¥éƒ½å¯èƒ½å­˜åœ¨ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼šå®ƒå¯èƒ½ä¼šè¸¢å‡ºä¸€ä¸ªé‡è¦çš„é¡µé¢ï¼Œè€Œè¯¥é¡µé¢å°†è¢«å†æ¬¡å¼•ç”¨ã€‚ FIFOè¸¢å‡ºæœ€å…ˆå¸¦å…¥çš„é¡µé¢ï¼›å¦‚æœè¿™æ°å¥½æ˜¯ä¸€ä¸ªå¸¦æœ‰é‡è¦ä»£ç æˆ–æ•°æ®ç»“æ„çš„é¡µé¢ï¼Œé‚£ä¹ˆå®ƒæ— è®ºå¦‚ä½•éƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œå³ä½¿å®ƒå¾ˆå¿«å°±ä¼šè¢«åˆ†é¡µå›æ¥ã€‚å› æ­¤ï¼ŒFIFOã€Randomå’Œç±»ä¼¼çš„ç­–ç•¥ä¸å¤ªå¯èƒ½è¾¾åˆ°æœ€ä½³æ•ˆæœï¼›éœ€è¦æ›´æ™ºèƒ½çš„ä¸œè¥¿ã€‚ æ­£å¦‚æˆ‘ä»¬å¯¹è°ƒåº¦ç­–ç•¥æ‰€åšçš„é‚£æ ·ï¼Œä¸ºäº†æ”¹å–„æˆ‘ä»¬å¯¹æœªæ¥çš„çŒœæµ‹ï¼Œæˆ‘ä»¬å†æ¬¡ä¾é è¿‡å»å¹¶ä»¥å†å²ä¸ºæŒ‡å¯¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºåœ¨ä¸ä¹…çš„è¿‡å»è®¿é—®è¿‡ä¸€ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆå®ƒå¾ˆå¯èƒ½åœ¨ä¸ä¹…çš„å°†æ¥å†æ¬¡è®¿é—®å®ƒã€‚ é¡µé¢æ›¿æ¢ç­–ç•¥å¯ä»¥ä½¿ç”¨çš„ä¸€ç±»å†å²ä¿¡æ¯æ˜¯é¢‘ç‡ã€‚å¦‚æœä¸€ä¸ªé¡µé¢å·²è¢«è®¿é—®å¤šæ¬¡ï¼Œä¹Ÿè®¸å®ƒä¸åº”è¯¥è¢«æ›¿æ¢ï¼Œå› ä¸ºå®ƒæ˜¾ç„¶å…·æœ‰æŸäº›ä»·å€¼ã€‚é¡µé¢çš„ä¸€ä¸ªæ›´å¸¸ç”¨çš„å±æ€§æ˜¯è®¿é—®æ—¶é—´ï¼›é¡µé¢è¢«è®¿é—®çš„æ—¶é—´è¶Šè¿‘ï¼Œä¹Ÿè®¸å°±è¶Šæœ‰å¯èƒ½è¢«å†æ¬¡è®¿é—®ã€‚ è¿™ä¸€ç³»åˆ—ç­–ç•¥åŸºäºäººä»¬æ‰€è¯´çš„å±€éƒ¨æ€§åŸåˆ™ ï¼Œè¿™åŸºæœ¬ä¸Šåªæ˜¯å¯¹ç¨‹åºåŠå…¶è¡Œä¸ºçš„è§‚å¯Ÿã€‚è¿™ä¸ªåŸåˆ™çš„æ„æ€å¾ˆç®€å•ï¼Œå°±æ˜¯ç¨‹åºå€¾å‘äºéå¸¸é¢‘ç¹åœ°è®¿é—®æŸäº›ä»£ç åºåˆ—ï¼ˆä¾‹å¦‚ï¼Œåœ¨å¾ªç¯ä¸­ï¼‰å’Œæ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ï¼Œå¾ªç¯è®¿é—®çš„æ•°ç»„ï¼‰ï¼›å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥å°è¯•ä½¿ç”¨å†å²è®°å½•æ¥æ‰¾å‡ºå“ªäº›é¡µé¢æ˜¯é‡è¦çš„ï¼Œå¹¶åœ¨é©±é€æ—¶å°†è¿™äº›é¡µé¢ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚ å› æ­¤ï¼Œä¸€ç³»åˆ—ç®€å•çš„åŸºäºå†å²çš„ç®—æ³•è¯ç”Ÿäº†ã€‚å½“å¿…é¡»è¿›è¡Œé€å‡ºæ—¶ï¼Œæœ€ä¸å¸¸ç”¨ (LFU) ç­–ç•¥ä¼šæ›¿æ¢æœ€ä¸å¸¸ç”¨çš„é¡µé¢ã€‚ç±»ä¼¼åœ°ï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰ç­–ç•¥æ›¿æ¢æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡µé¢ã€‚è¿™äº›ç®—æ³•å¾ˆå®¹æ˜“è®°ä½ï¼šä¸€æ—¦æ‚¨çŸ¥é“åç§°ï¼Œæ‚¨å°±ç¡®åˆ‡åœ°çŸ¥é“å®ƒçš„ä½œç”¨ï¼Œè¿™æ˜¯åç§°çš„ä¸€ä¸ªæå¥½çš„å±æ€§ã€‚ ä¸ºäº†æ›´å¥½åœ°ç†è§£ LRUï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ LRU åœ¨ç¤ºä¾‹å¼•ç”¨æµä¸Šçš„è¡¨ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä»å›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ° LRU å¦‚ä½•åˆ©ç”¨å†å²è®°å½•æ¯” Random æˆ– FIFO ç­‰æ— çŠ¶æ€ç­–ç•¥åšå¾—æ›´å¥½ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼ŒLRU åœ¨ç¬¬ä¸€æ¬¡å¿…é¡»æ›¿æ¢é¡µé¢æ—¶ä¼šé€å‡ºé¡µé¢ 2ï¼Œå› ä¸ºæœ€è¿‘è®¿é—®è¿‡é¡µé¢ 0 å’Œ 1ã€‚ç„¶åå®ƒä¼šæ›¿æ¢ç¬¬ 0 é¡µï¼Œå› ä¸ºæœ€è¿‘è®¿é—®äº†ç¬¬ 1 é¡µå’Œç¬¬ 3 é¡µã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼ŒLRU åŸºäºå†å²çš„å†³å®šéƒ½è¢«è¯æ˜æ˜¯æ­£ç¡®çš„ï¼Œå› æ­¤ä¸‹ä¸€ä¸ªå¼•ç”¨ä¼šè¢«å‘½ä¸­ã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒLRU è¡¨ç°å¾—å°½å¯èƒ½å¥½ï¼Œå…¶æ€§èƒ½è¾¾åˆ°æœ€ä½³æ°´å¹³ã€‚ æˆ‘ä»¬è¿˜åº”è¯¥æ³¨æ„åˆ°ï¼Œè¿™äº›ç®—æ³•å­˜åœ¨ç›¸åçš„æƒ…å†µï¼šæœ€å¸¸ç”¨ï¼ˆMFUï¼‰å’Œæœ€è¿‘ä½¿ç”¨ï¼ˆMRUï¼‰ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ˆä¸æ˜¯å…¨éƒ¨ï¼ï¼‰ï¼Œè¿™äº›ç­–ç•¥æ•ˆæœä¸ä½³ï¼Œå› ä¸ºå®ƒä»¬å¿½ç•¥äº†å¤§å¤šæ•°ç¨‹åºæ‰€å±•ç¤ºçš„å±€éƒ¨æ€§ï¼Œè€Œä¸æ˜¯åˆ©ç”¨å®ƒã€‚ å±€éƒ¨æ€§çš„ç±»å‹ ç¨‹åºå¾€å¾€ä¼šè¡¨ç°å‡ºä¸¤ç§å±€éƒ¨æ€§ã€‚ç¬¬ä¸€ç§æ˜¯ç©ºé—´å±€éƒ¨æ€§ï¼Œå³å¦‚æœä¸€ä¸ªé¡µé¢ P è¢«è®¿é—®ï¼Œé‚£ä¹ˆå®ƒå‘¨å›´çš„é¡µé¢ï¼ˆå¦‚ P - 1 æˆ– P + 1ï¼‰ä¹Ÿå¾ˆå¯èƒ½è¢«è®¿é—®ã€‚ç¬¬äºŒç§æ˜¯æ—¶é—´å±€éƒ¨æ€§ï¼Œå³åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œåœ¨è¿‡å»è¢«è®¿é—®è¿‡çš„é¡µé¢å¾ˆå¯èƒ½ä¼šå†æ¬¡è¢«è®¿é—®ã€‚å­˜åœ¨è¿™äº›ç±»å‹çš„å±€éƒ¨æ€§çš„å‡è®¾åœ¨ç¡¬ä»¶ç³»ç»Ÿçš„ç¼“å­˜å±‚æ¬¡ç»“æ„ä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼Œç¡¬ä»¶ç³»ç»Ÿéƒ¨ç½²å¤šä¸ªçº§åˆ«çš„æŒ‡ä»¤ã€æ•°æ®å’Œåœ°å€è½¬æ¢ç¼“å­˜ï¼Œä»¥å¸®åŠ©ç¨‹åºåœ¨å­˜åœ¨æ­¤ç±»å±€éƒ¨æ€§æ—¶å¿«é€Ÿè¿è¡Œã€‚ å½“ç„¶ï¼Œé€šå¸¸æ‰€è¯´çš„å±€éƒ¨æ€§åŸåˆ™å¹¶ä¸æ˜¯æ‰€æœ‰ç¨‹åºéƒ½å¿…é¡»éµå®ˆçš„ç¡¬æ€§è§„å®šã€‚äº‹å®ä¸Šï¼Œæœ‰äº›ç¨‹åºä»¥ç›¸å½“éšæœºçš„æ–¹å¼è®¿é—®å†…å­˜ï¼ˆæˆ–ç£ç›˜ï¼‰ï¼Œåœ¨å…¶è®¿é—®æµä¸­å¹¶ä¸è¡¨ç°å‡ºå¤ªå¤šæˆ–ä»»ä½•å±€éƒ¨æ€§ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡ä»»ä½•ç±»å‹çš„ç¼“å­˜ï¼ˆç¡¬ä»¶æˆ–è½¯ä»¶ï¼‰æ—¶ï¼Œè™½ç„¶å±€éƒ¨æ€§æ˜¯ä¸€ä¸ªå€¼å¾—ç‰¢è®°çš„å¥½ä¸œè¥¿ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯æˆåŠŸã€‚ç›¸åï¼Œå®ƒæ˜¯ä¸€ç§å¯å‘å¼æ–¹æ³•ï¼Œåœ¨è®¡ç®—æœºç³»ç»Ÿè®¾è®¡ä¸­ç»å¸¸è¢«è¯æ˜æ˜¯æœ‰ç”¨çš„ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:5:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 å·¥ä½œè´Ÿè½½å®ä¾‹ è®©æˆ‘ä»¬å†çœ‹å‡ ä¸ªä¾‹å­ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å…¶ä¸­ä¸€äº›ç­–ç•¥çš„è¡Œä¸ºæ–¹å¼ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ£€æŸ¥æ›´å¤æ‚çš„å·¥ä½œè´Ÿè½½è€Œä¸æ˜¯å°è·Ÿè¸ªã€‚ç„¶è€Œï¼Œå³ä½¿æ˜¯è¿™äº›å·¥ä½œè´Ÿè½½ä¹Ÿè¢«å¤§å¤§ç®€åŒ–äº†ï¼›æ›´å¥½çš„ç ”ç©¶å°†åŒ…æ‹¬åº”ç”¨ç¨‹åºè·Ÿè¸ªã€‚ æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå·¥ä½œè´Ÿè½½æ²¡æœ‰å±€éƒ¨æ€§ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªå¼•ç”¨éƒ½æ˜¯å¯¹è®¿é—®é¡µé¢é›†ä¸­çš„éšæœºé¡µé¢ã€‚åœ¨è¿™ä¸ªç®€å•çš„ç¤ºä¾‹ä¸­ï¼Œå·¥ä½œè´Ÿè½½éšç€æ—¶é—´çš„æ¨ç§»è®¿é—® 100 ä¸ªå”¯ä¸€é¡µé¢ï¼Œéšæœºé€‰æ‹©ä¸‹ä¸€ä¸ªé¡µé¢è¿›è¡Œå¼•ç”¨ï¼›æ€»å…±è®¿é—®äº† 10,000 ä¸ªé¡µé¢ã€‚åœ¨å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ç¼“å­˜å¤§å°ä»éå¸¸å°ï¼ˆ1 é¡µï¼‰æ›´æ”¹ä¸ºè¶³ä»¥å®¹çº³æ‰€æœ‰å”¯ä¸€é¡µé¢ï¼ˆ100 é¡µï¼‰ï¼Œä»¥ä¾¿äº†è§£æ¯ä¸ªç­–ç•¥åœ¨ç¼“å­˜å¤§å°èŒƒå›´å†…çš„è¡Œä¸ºæ–¹å¼ã€‚ ä¸‹å›¾ç»˜åˆ¶äº†æœ€ä¼˜ã€LRUã€éšæœºå’Œ FIFO çš„å®éªŒç»“æœã€‚å›¾ä¸­çš„yè½´è¡¨ç¤ºæ¯ä¸ªç­–ç•¥è¾¾åˆ°çš„å‘½ä¸­ç‡ï¼› x è½´æ”¹å˜ç¼“å­˜å¤§å°ã€‚ æˆ‘ä»¬å¯ä»¥ä»å›¾ä¸­å¾—å‡ºè®¸å¤šç»“è®ºã€‚é¦–å…ˆï¼Œå½“å·¥ä½œè´Ÿè½½ä¸å­˜åœ¨å±€éƒ¨æ€§æ—¶ï¼Œæ‚¨ä½¿ç”¨å“ªç§å®é™…ç­–ç•¥å¹¶ä¸é‡è¦ï¼› LRUã€FIFO å’Œ Random çš„æ‰§è¡Œæ–¹å¼éƒ½æ˜¯ç›¸åŒçš„ï¼Œå‘½ä¸­ç‡å®Œå…¨ç”±ç¼“å­˜çš„å¤§å°å†³å®šã€‚å…¶æ¬¡ï¼Œå½“ç¼“å­˜è¶³å¤Ÿå¤§ä»¥é€‚åº”æ•´ä¸ªå·¥ä½œè´Ÿè½½æ—¶ï¼Œä½¿ç”¨å“ªç§ç­–ç•¥ä¹Ÿå¹¶ä¸é‡è¦ï¼›å½“æ‰€æœ‰å¼•ç”¨çš„å—éƒ½é€‚åˆç¼“å­˜æ—¶ï¼Œæ‰€æœ‰ç­–ç•¥ï¼ˆç”šè‡³éšæœºï¼‰éƒ½ä¼šæ”¶æ•›åˆ° 100% å‘½ä¸­ç‡ã€‚æœ€åï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æœ€ä¼˜ç­–ç•¥çš„æ€§èƒ½æ˜æ˜¾ä¼˜äºç°å®ç­–ç•¥ï¼›å¦‚æœå¯èƒ½çš„è¯ï¼Œå±•æœ›æœªæ¥å¯ä»¥æ›´å¥½åœ°è¿›è¡Œæ›¿ä»£ã€‚ æˆ‘ä»¬ç ”ç©¶çš„ä¸‹ä¸€ä¸ªå·¥ä½œè´Ÿè½½ç§°ä¸ºâ€œ80-20â€å·¥ä½œè´Ÿè½½ï¼Œå®ƒè¡¨ç°å‡ºå±€éƒ¨æ€§ï¼š80% çš„å¼•ç”¨æ˜¯é’ˆå¯¹ 20% çš„é¡µé¢ï¼ˆâ€œçƒ­é—¨â€é¡µé¢ï¼‰ï¼›å…¶ä½™ 20% çš„å¼•ç”¨æ˜¯é’ˆå¯¹å…¶ä½™ 80% çš„é¡µé¢ï¼ˆâ€œå†·â€é¡µé¢ï¼‰ã€‚åœ¨æˆ‘ä»¬çš„å·¥ä½œè´Ÿè½½ä¸­ï¼Œæ€»å…±æœ‰ 100 ä¸ªä¸åŒçš„é¡µé¢ï¼›å› æ­¤ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½å¼•ç”¨â€œçƒ­â€é¡µé¢ï¼Œå…¶ä½™æ—¶é—´å¼•ç”¨â€œå†·â€é¡µé¢ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ç­–ç•¥å¦‚ä½•åœ¨æ­¤å·¥ä½œè´Ÿè½½ä¸‹æ‰§è¡Œã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶éšæœºå’Œ FIFO éƒ½è¡¨ç°å¾—ç›¸å½“å¥½ï¼Œä½† LRU è¡¨ç°æ›´å¥½ï¼Œå› ä¸ºå®ƒæ›´æœ‰å¯èƒ½ä¿ç•™çƒ­ç‚¹é¡µï¼›ç”±äºè¿™äº›é¡µé¢è¿‡å»æ›¾è¢«é¢‘ç¹å¼•ç”¨ï¼Œå› æ­¤å¾ˆå¯èƒ½åœ¨ä¸ä¹…çš„å°†æ¥å†æ¬¡è¢«å¼•ç”¨ã€‚ Optimal å†æ¬¡è¡¨ç°æ›´å¥½ï¼Œè¯´æ˜ LRU çš„å†å²ä¿¡æ¯å¹¶ä¸å®Œç¾ã€‚ æ‚¨ç°åœ¨å¯èƒ½æƒ³çŸ¥é“ï¼šLRU ç›¸å¯¹äº Random å’Œ FIFO çš„æ”¹è¿›çœŸçš„æœ‰é‚£ä¹ˆå¤§å—ï¼Ÿç­”æ¡ˆæ˜¯â€œè§†æƒ…å†µè€Œå®šâ€ã€‚å¦‚æœæ¯æ¬¡æœªå‘½ä¸­çš„æˆæœ¬éƒ½éå¸¸é«˜ï¼ˆå¹¶ä¸ç½•è§ï¼‰ï¼Œé‚£ä¹ˆå³ä½¿å‘½ä¸­ç‡å°å¹…å¢åŠ ï¼ˆä¸ºå‘½ä¸­ç‡é™ä½ï¼‰ä¹Ÿä¼šå¯¹æ€§èƒ½äº§ç”Ÿå·¨å¤§å½±å“ã€‚å¦‚æœæœªå‘½ä¸­çš„ä»£ä»·ä¸é‚£ä¹ˆé«˜ï¼Œé‚£ä¹ˆ LRU å¯èƒ½å¸¦æ¥çš„å¥½å¤„å½“ç„¶å°±ä¸é‚£ä¹ˆé‡è¦äº†ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æœ€ç»ˆçš„å·¥ä½œè´Ÿè½½ã€‚æˆ‘ä»¬å°†å…¶ç§°ä¸ºâ€œå¾ªç¯é¡ºåºâ€å·¥ä½œè´Ÿè½½ï¼Œå› ä¸ºåœ¨å…¶ä¸­ï¼Œæˆ‘ä»¬æŒ‰é¡ºåºå¼•ç”¨ 50 ä¸ªé¡µé¢ï¼Œä» 0 å¼€å§‹ï¼Œç„¶åæ˜¯ 1ï¼Œâ€¦ï¼Œç›´åˆ°ç¬¬ 49 é¡µï¼Œç„¶åæˆ‘ä»¬å¾ªç¯ï¼Œé‡å¤è¿™äº›è®¿é—®ï¼Œä»¥è·å¾—å¯¹ 50 ä¸ªå”¯ä¸€é¡µé¢çš„æ€»å…± 10,000 æ¬¡è®¿é—®ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†è¯¥å·¥ä½œè´Ÿè½½ä¸‹ç­–ç•¥çš„è¡Œä¸ºã€‚ è¿™ç§å·¥ä½œè´Ÿè½½åœ¨è®¸å¤šåº”ç”¨ç¨‹åºï¼ˆåŒ…æ‹¬é‡è¦çš„å•†ä¸šåº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚æ•°æ®åº“ï¼‰ä¸­å¾ˆå¸¸è§ï¼Œä»£è¡¨äº† LRU å’Œ FIFO çš„æœ€åæƒ…å†µã€‚è¿™äº›ç®—æ³•åœ¨å¾ªç¯é¡ºåºå·¥ä½œè´Ÿè½½ä¸‹ä¼šè¸¢å‡ºæ—§é¡µé¢ï¼›ä¸å¹¸çš„æ˜¯ï¼Œç”±äºå·¥ä½œè´Ÿè½½çš„å¾ªç¯æ€§è´¨ï¼Œè¿™äº›è¾ƒæ—§çš„é¡µé¢å°†æ¯”ç­–ç•¥å¸Œæœ›ä¿ç•™åœ¨ç¼“å­˜ä¸­çš„é¡µé¢æ›´æ—©è¢«è®¿é—®ã€‚äº‹å®ä¸Šï¼Œå³ä½¿ç¼“å­˜å¤§å°ä¸º 49ï¼Œ50 é¡µçš„å¾ªç¯é¡ºåºå·¥ä½œè´Ÿè½½ä¹Ÿä¼šå¯¼è‡´ 0% çš„å‘½ä¸­ç‡ã€‚æœ‰è¶£çš„æ˜¯ï¼Œéšæœºçš„æ•ˆæœæ˜æ˜¾æ›´å¥½ï¼Œè™½ç„¶è¿˜æ²¡æœ‰å®Œå…¨æ¥è¿‘æœ€ä½³ï¼Œä½†è‡³å°‘å®ç°äº†éé›¶å‘½ä¸­ç‡ã€‚äº‹å®è¯æ˜éšæœºæœ‰ä¸€äº›å¾ˆå¥½çš„ç‰¹æ€§ï¼›å…¶ä¸­ä¸€ä¸ªå±æ€§å°±æ˜¯æ²¡æœ‰å¥‡æ€ªçš„æç«¯è¡Œä¸ºã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:6:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 å®ç°å†å²ç®—æ³• æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼ŒLRU ç­‰ç®—æ³•é€šå¸¸æ¯” FIFO æˆ–éšæœºç­‰ç®€å•ç­–ç•¥åšå¾—æ›´å¥½ï¼Œåè€…å¯èƒ½ä¼šä¸¢å¼ƒé‡è¦çš„é¡µé¢ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå†å²ç­–ç•¥ç»™æˆ‘ä»¬å¸¦æ¥äº†æ–°çš„æŒ‘æˆ˜ï¼šæˆ‘ä»¬å¦‚ä½•å®ç°å®ƒä»¬ï¼Ÿ æˆ‘ä»¬ä»¥ LRU ä¸ºä¾‹ã€‚ä¸ºäº†å®Œç¾åœ°å®ç°å®ƒï¼Œæˆ‘ä»¬éœ€è¦åšå¤§é‡çš„å·¥ä½œã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨æ¯æ¬¡é¡µé¢è®¿é—®ï¼ˆå³æ¯æ¬¡å†…å­˜è®¿é—®ï¼Œæ— è®ºæ˜¯æŒ‡ä»¤æå–è¿˜æ˜¯åŠ è½½æˆ–å­˜å‚¨ï¼‰æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ›´æ–°æŸäº›æ•°æ®ç»“æ„ä»¥å°†æ­¤é¡µé¢ç§»åŠ¨åˆ°åˆ—è¡¨çš„å‰é¢ï¼ˆå³ MRU ä¾§ï¼‰ã€‚ä¸ FIFO ç›¸æ¯”ï¼Œåªæœ‰å½“é¡µé¢è¢«é€å‡ºï¼ˆé€šè¿‡åˆ é™¤æœ€å…ˆè¿›å…¥çš„é¡µé¢ï¼‰æˆ–å°†æ–°é¡µé¢æ·»åŠ åˆ°åˆ—è¡¨ï¼ˆæœ€åè¿›å…¥çš„ä¸€ä¾§ï¼‰æ—¶ï¼Œæ‰ä¼šè®¿é—® FIFO é¡µé¢åˆ—è¡¨ã€‚ä¸ºäº†è·Ÿè¸ªå“ªäº›é¡µé¢è¢«æœ€å°‘å’Œæœ€è¿‘ä½¿ç”¨ï¼Œç³»ç»Ÿå¿…é¡»åœ¨æ¯æ¬¡å†…å­˜å¼•ç”¨ä¸Šè¿›è¡Œä¸€äº›ç»Ÿè®¡å·¥ä½œã€‚æ˜¾ç„¶ï¼Œå¦‚æœä¸å°å¿ƒå¤„ç†ï¼Œè¿™ç§ç»Ÿè®¡å·¥ä½œå¯èƒ½ä¼šå¤§å¤§é™ä½æ€§èƒ½ã€‚ ä¸€ç§æœ‰åŠ©äºåŠ å¿«é€Ÿåº¦çš„æ–¹æ³•æ˜¯æ·»åŠ ä¸€ç‚¹ç¡¬ä»¶æ”¯æŒã€‚ä¾‹å¦‚ï¼Œæœºå™¨å¯ä»¥åœ¨æ¯æ¬¡é¡µé¢è®¿é—®æ—¶æ›´æ–°å†…å­˜ä¸­çš„æ—¶é—´å­—æ®µï¼ˆä¾‹å¦‚ï¼Œè¿™å¯èƒ½ä½äºæ¯ä¸ªè¿›ç¨‹çš„é¡µè¡¨ä¸­ï¼Œæˆ–è€…ä»…ä½äºå†…å­˜ä¸­çš„æŸä¸ªå•ç‹¬çš„æ•°ç»„ä¸­ï¼Œç³»ç»Ÿä¸­çš„æ¯ä¸ªç‰©ç†é¡µæœ‰ä¸€ä¸ªæ¡ç›®ï¼‰ã€‚å› æ­¤ï¼Œå½“è®¿é—®é¡µé¢æ—¶ï¼Œæ—¶é—´å­—æ®µå°†ç”±ç¡¬ä»¶è®¾ç½®ä¸ºå½“å‰æ—¶é—´ã€‚ç„¶åï¼Œå½“æ›¿æ¢é¡µé¢æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ç®€å•åœ°æ‰«æç³»ç»Ÿä¸­çš„æ‰€æœ‰æ—¶é—´å­—æ®µä»¥æ‰¾åˆ°æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡µé¢ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œéšç€ç³»ç»Ÿä¸­é¡µé¢æ•°é‡çš„å¢é•¿ï¼Œæ‰«æå¤§é‡çš„æ—¶é—´åªæ˜¯ä¸ºäº†æ‰¾åˆ°ç»å¯¹æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡µé¢æ˜¯éå¸¸æ˜‚è´µçš„ã€‚æƒ³è±¡ä¸€ä¸‹ä¸€å°å…·æœ‰ 4GB å†…å­˜çš„ç°ä»£æœºå™¨ï¼Œè¢«åˆ†æˆ 4KB é¡µé¢ã€‚è¿™å°æœºå™¨æœ‰ 100 ä¸‡ä¸ªé¡µé¢ï¼Œå› æ­¤å³ä½¿åœ¨ç°ä»£ CPU é€Ÿåº¦ä¸‹ï¼Œæ‰¾åˆ° LRU é¡µé¢ä¹Ÿéœ€è¦å¾ˆé•¿æ—¶é—´ã€‚è¿™å°±å¼•å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬çœŸçš„éœ€è¦æ‰¾åˆ°ç»å¯¹æœ€æ—§çš„é¡µé¢æ¥æ›¿æ¢å—ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿‘ä¼¼æ¥ä»£æ›¿å—ï¼Ÿ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:7:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 è¿‘ä¼¼LRU äº‹å®è¯æ˜ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼šä»è®¡ç®—å¼€é”€çš„è§’åº¦æ¥çœ‹ï¼Œè¿‘ä¼¼ LRU æ›´å¯è¡Œï¼Œè€Œä¸”å®é™…ä¸Šè®¸å¤šç°ä»£ç³»ç»Ÿéƒ½æ˜¯è¿™ä¹ˆåšçš„ã€‚è¿™ä¸ªæƒ³æ³•éœ€è¦ä¸€äº›ç¡¬ä»¶æ”¯æŒï¼Œä»¥ä½¿ç”¨ä½ï¼ˆæœ‰æ—¶ç§°ä¸ºå¼•ç”¨ä½ï¼‰çš„å½¢å¼ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªæ˜¯åœ¨ç¬¬ä¸€ä¸ªå…·æœ‰åˆ†é¡µçš„ç³»ç»Ÿï¼ŒAtlas one-level storeä¸­å®ç°çš„ã€‚ç³»ç»Ÿçš„æ¯ä¸€é¡µéƒ½æœ‰ä¸€ä¸ªä½¿ç”¨ä½ï¼Œå¹¶ä¸”ä½¿ç”¨ä½å­˜åœ¨äºå†…å­˜ä¸­çš„æŸä¸ªä½ç½®ï¼ˆä¾‹å¦‚ï¼Œå®ƒä»¬å¯èƒ½ä½äºæ¯ä¸ªè¿›ç¨‹çš„é¡µè¡¨ä¸­ï¼Œæˆ–è€…åªæ˜¯ä½äºæŸä¸ªæ•°ç»„ä¸­ï¼‰ã€‚æ¯å½“å¼•ç”¨é¡µé¢ï¼ˆå³è¯»å–æˆ–å†™å…¥ï¼‰æ—¶ï¼Œç¡¬ä»¶éƒ½ä¼šå°†ä½¿ç”¨ä½è®¾ç½®ä¸º 1ã€‚ä¸è¿‡ï¼Œç¡¬ä»¶æ°¸è¿œä¸ä¼šæ¸…é™¤è¯¥ä½ï¼ˆå³å°†å…¶è®¾ç½®ä¸º 0ï¼‰ï¼›è¿™æ˜¯æ“ä½œç³»ç»Ÿçš„è´£ä»»ã€‚ æ“ä½œç³»ç»Ÿå¦‚ä½•åˆ©ç”¨ä½¿ç”¨ä½ä½æ¥è¿‘ä¼¼LRUï¼Ÿå—¯ï¼Œå¯èƒ½æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œä½†æ—¶é’Ÿç®—æ³•æå‡ºäº†ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚æƒ³è±¡ä¸€ä¸‹ç³»ç»Ÿçš„æ‰€æœ‰é¡µé¢æ’åˆ—åœ¨ä¸€ä¸ªå¾ªç¯åˆ—è¡¨ä¸­ã€‚æ—¶é’ŸæŒ‡é’ˆé¦–å…ˆæŒ‡å‘æŸä¸ªç‰¹å®šçš„é¡µé¢ï¼ˆå“ªä¸€é¡µå¹¶ä¸é‡è¦ï¼‰ã€‚å½“å¿…é¡»è¿›è¡Œæ›¿æ¢æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ£€æŸ¥å½“å‰æŒ‡å‘çš„é¡µé¢ P çš„ä½¿ç”¨ä½æ˜¯å¦ä¸º 1 æˆ– 0ã€‚å¦‚æœä¸º 1ï¼Œåˆ™æ„å‘³ç€é¡µé¢ P æœ€è¿‘è¢«ä½¿ç”¨è¿‡ï¼Œå› æ­¤ä¸æ˜¯æ›¿æ¢çš„è‰¯å¥½å€™é€‰è€…ã€‚å› æ­¤ï¼ŒP çš„ä½¿ç”¨ä½è®¾ç½®ä¸º 0ï¼ˆæ¸…é™¤ï¼‰ï¼Œå¹¶ä¸”æ—¶é’ŸæŒ‡é’ˆé€’å¢åˆ°ä¸‹ä¸€é¡µ (P + 1)ã€‚è¯¥ç®—æ³•ç»§ç»­è¿›è¡Œï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªè®¾ç½®ä¸º 0 çš„ä½¿ç”¨ä½ï¼Œè¿™æ„å‘³ç€è¯¥é¡µé¢æœ€è¿‘æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼ˆæˆ–è€…ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰é¡µé¢éƒ½å·²è¢«ä½¿ç”¨è¿‡ï¼Œå¹¶ä¸”æˆ‘ä»¬ç°åœ¨å·²ç»æœç´¢äº†æ•´ä¸ªé¡µé¢é›†ï¼Œä»è€Œæ¸…é™¤äº†æ‰€æœ‰ä½ï¼‰ã€‚ è¯·æ³¨æ„ï¼Œæ­¤æ–¹æ³•å¹¶ä¸æ˜¯ä½¿ç”¨ä½¿ç”¨ä½æ¥è¿‘ä¼¼ LRU çš„å”¯ä¸€æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œä»»ä½•å®šæœŸæ¸…é™¤ä½¿ç”¨ä½ï¼Œç„¶ååŒºåˆ†å“ªäº›é¡µé¢ä½¿ç”¨ 1 ä¸ 0 çš„ä½æ¥å†³å®šæ›¿æ¢å“ªä¸ªçš„æ–¹æ³•éƒ½å¯ä»¥ã€‚ Corbato çš„æ—¶é’Ÿç®—æ³•åªæ˜¯ä¸€ç§æ—©æœŸæ–¹æ³•ï¼Œå®ƒå–å¾—äº†ä¸€äº›æˆåŠŸï¼Œå¹¶ä¸”å…·æœ‰ä¸é‡å¤æ‰«ææ‰€æœ‰å†…å­˜å¯»æ‰¾æœªä½¿ç”¨é¡µé¢çš„è‰¯å¥½ç‰¹æ€§ã€‚ æ—¶é’Ÿç®—æ³•å˜ä½“çš„è¡Œä¸ºå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è¯¥å˜ä½“åœ¨è¿›è¡Œæ›¿æ¢æ—¶éšæœºæ‰«æé¡µé¢ï¼›å½“å®ƒé‡åˆ°å¼•ç”¨ä½è®¾ç½®ä¸º 1 çš„é¡µé¢æ—¶ï¼Œå®ƒä¼šæ¸…é™¤è¯¥ä½ï¼ˆå³å°†å…¶è®¾ç½®ä¸º 0ï¼‰ï¼›å½“å®ƒå‘ç°å¼•ç”¨ä½è®¾ç½®ä¸º 0 çš„é¡µé¢æ—¶ï¼Œå®ƒä¼šé€‰æ‹©å®ƒä½œä¸ºå—å®³è€…ã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œè™½ç„¶å®ƒçš„è¡¨ç°ä¸å¦‚å®Œç¾çš„ LRUï¼Œä½†å®ƒæ¯”æ ¹æœ¬ä¸è€ƒè™‘å†å²çš„æ–¹æ³•è¦å¥½ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:8:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"9 è€ƒè™‘è„ä½ï¼ˆåœ¨æ—¶é’Ÿç®—æ³•ä¸­ï¼‰ å¯¹æ—¶é’Ÿç®—æ³•ï¼ˆæœ€åˆä¹Ÿæ˜¯ç”± Corbatoæå‡ºçš„ï¼‰çš„ä¸€ä¸ªå°ä¿®æ”¹æ˜¯ï¼Œåœ¨å†…å­˜ä¸­é¢å¤–è€ƒè™‘é¡µé¢æ˜¯å¦è¢«ä¿®æ”¹ã€‚è¿™æ ·åšçš„åŸå› æ˜¯ï¼šå¦‚æœä¸€ä¸ªé¡µé¢è¢«ä¿®æ”¹è¿‡ï¼Œå› è€Œæ˜¯è„çš„ï¼Œå°±å¿…é¡»å°†å…¶å†™å›ç£ç›˜ä»¥å°†å…¶å‰”é™¤ï¼Œè€Œè¿™æ˜¯å¾ˆæ˜‚è´µçš„ã€‚å¦‚æœé¡µé¢æœªè¢«ä¿®æ”¹ï¼ˆå› æ­¤æ˜¯å¹²å‡€çš„ï¼‰ï¼Œåˆ™å‰”é™¤æ˜¯å…è´¹çš„ï¼›ç‰©ç†é¡µå¯ä»¥ç®€å•åœ°é‡æ–°ç”¨äºå…¶ä»–ç›®çš„ï¼Œè€Œæ— éœ€é¢å¤–çš„ I/Oã€‚å› æ­¤ï¼Œä¸€äº›è™šæ‹Ÿæœºç³»ç»Ÿæ›´å€¾å‘äºé©±é€å¹²å‡€çš„é¡µé¢ï¼Œè€Œä¸æ˜¯è„é¡µé¢ã€‚ ä¸ºæ”¯æŒè¿™ç§è¡Œä¸ºï¼Œç¡¬ä»¶åº”åŒ…å«ä¸€ä¸ªä¿®æ”¹ä½ï¼ˆåˆç§°è„ä½ï¼‰ã€‚è¯¥ä½åœ¨ä»»ä½•é¡µé¢è¢«å†™å…¥æ—¶éƒ½ä¼šè¢«è®¾ç½®ï¼Œå› æ­¤å¯è¢«çº³å…¥é¡µé¢æ›¿æ¢ç®—æ³•ä¸­ã€‚ä¾‹å¦‚ï¼Œæ—¶é’Ÿç®—æ³•å¯ä»¥ä¿®æ”¹ä¸ºé¦–å…ˆæ‰«ææœªä½¿ç”¨ä¸”å¹²å‡€çš„é¡µé¢ï¼Œç„¶åå†æ‰«ææœªä½¿ç”¨ä¸”è„çš„é¡µé¢ï¼Œä»¥æ­¤ç±»æ¨ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:9:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"10 å…¶ä»–VMç­–ç•¥ é¡µé¢æ›¿æ¢å¹¶ä¸æ˜¯VMå­ç³»ç»Ÿé‡‡ç”¨çš„å”¯ä¸€ç­–ç•¥ï¼ˆå°½ç®¡å®ƒå¯èƒ½æ˜¯æœ€é‡è¦çš„ï¼‰ã€‚ä¾‹å¦‚ï¼Œæ“ä½œç³»ç»Ÿè¿˜å¿…é¡»å†³å®šä½•æ—¶å°†é¡µé¢æ”¾å…¥å†…å­˜ã€‚è¯¥ç­–ç•¥æœ‰æ—¶ç§°ä¸ºé¡µé¢é€‰æ‹©ç­–ç•¥ï¼Œä¸ºæ“ä½œç³»ç»Ÿæä¾›äº†ä¸€äº›ä¸åŒçš„é€‰é¡¹ã€‚ å¯¹äºå¤§å¤šæ•°é¡µé¢ï¼Œæ“ä½œç³»ç»Ÿä»…ä½¿ç”¨æŒ‰éœ€åˆ†é¡µï¼Œè¿™æ„å‘³ç€æ“ä½œç³»ç»Ÿåœ¨è®¿é—®é¡µé¢æ—¶å°†é¡µé¢è°ƒå…¥å†…å­˜ï¼Œå¯ä»¥è¯´æ˜¯â€œæŒ‰éœ€â€ã€‚å½“ç„¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥çŒœæµ‹æŸä¸ªé¡µé¢å³å°†è¢«ä½¿ç”¨ï¼Œä»è€Œæå‰å°†å…¶å¼•å…¥ï¼›è¿™ç§è¡Œä¸ºç§°ä¸ºé¢„å–ï¼Œåªæœ‰åœ¨æœ‰åˆç†çš„æˆåŠŸæœºä¼šæ—¶æ‰åº”æ‰§è¡Œã€‚ä¾‹å¦‚ï¼ŒæŸäº›ç³»ç»Ÿä¼šå‡è®¾å¦‚æœå°†ä»£ç é¡µ P æ”¾å…¥å†…å­˜ä¸­ï¼Œåˆ™è¯¥ä»£ç é¡µ P+1 å¯èƒ½å¾ˆå¿«å°±ä¼šè¢«è®¿é—®ï¼Œå› æ­¤ä¹Ÿåº”è¯¥æ”¾å…¥å†…å­˜ä¸­ã€‚ å¦ä¸€ä¸ªç­–ç•¥å†³å®šæ“ä½œç³»ç»Ÿå¦‚ä½•å°†é¡µé¢å†™å…¥ç£ç›˜ã€‚å½“ç„¶ï¼Œå®ƒä»¬å¯ä»¥ç®€å•åœ°ä¸€æ¬¡å†™å‡ºä¸€ä¸ªï¼›ç„¶è€Œï¼Œè®¸å¤šç³»ç»Ÿåè€Œå°†å¤§é‡å¾…å¤„ç†çš„å†™å…¥é›†ä¸­åœ¨å†…å­˜ä¸­ï¼Œå¹¶é€šè¿‡ä¸€æ¬¡ï¼ˆæ›´æœ‰æ•ˆçš„ï¼‰å†™å…¥å°†å®ƒä»¬å†™å…¥ç£ç›˜ã€‚è¿™ç§è¡Œä¸ºé€šå¸¸ç§°ä¸ºé›†ç¾¤æˆ–ç®€å•çš„å†™å…¥åˆ†ç»„ï¼Œå¹¶ä¸”ç”±äºç£ç›˜é©±åŠ¨å™¨çš„æ€§è´¨è€Œæœ‰æ•ˆï¼Œç£ç›˜é©±åŠ¨å™¨æ‰§è¡Œå•ä¸ªå¤§å†™æ“ä½œæ¯”è®¸å¤šå°å†™æ“ä½œæ›´æœ‰æ•ˆã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:10:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"11 æŠ–åŠ¨ å½“å†…å­˜è¢«è¿‡åº¦å ç”¨ï¼Œè¿è¡Œè¿›ç¨‹çš„å†…å­˜éœ€æ±‚è¶…è¿‡äº†å¯ç”¨çš„ç‰©ç†å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿè¯¥æ€ä¹ˆåŠï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šä¸æ–­åœ°åˆ†é¡µï¼Œè¿™ç§æƒ…å†µæœ‰æ—¶è¢«ç§°ä¸º â€œæŠ–åŠ¨â€ï¼ˆthrashingï¼‰ã€‚ ä¸€äº›æ—©æœŸçš„æ“ä½œç³»ç»Ÿæœ‰ä¸€å¥—ç›¸å½“å¤æ‚çš„æœºåˆ¶ï¼Œå¯ä»¥æ£€æµ‹å¹¶å¤„ç†å‘ç”Ÿçš„æŠ–åŠ¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ç»™å®šä¸€ç»„è¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå¯ä»¥å†³å®šä¸è¿è¡Œå…¶ä¸­çš„ä¸€ä¸ªå­è¿›ç¨‹é›†ï¼Œå¸Œæœ›å‡å°‘çš„è¿›ç¨‹é›†çš„å·¥ä½œé›†ï¼ˆå®ƒä»¬æ­£åœ¨ç§¯æä½¿ç”¨çš„é¡µé¢ï¼‰èƒ½å¤Ÿé€‚åˆå†…å­˜ï¼Œä»è€Œå–å¾—è¿›å±•ã€‚è¿™ç§æ–¹æ³•é€šå¸¸è¢«ç§°ä¸º â€œå‡†å…¥æ§åˆ¶â€ï¼ˆacmission controlï¼‰ï¼Œå®ƒæŒ‡å‡ºï¼Œæœ‰æ—¶å°‘åšä¸€ç‚¹å·¥ä½œæ¯”ä»€ä¹ˆéƒ½åšä¸å¥½è¦å¥½ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ç°å®ç”Ÿæ´»å’Œç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­ç»å¸¸é‡åˆ°çš„æƒ…å†µã€‚ å½“å‰çš„ä¸€äº›ç³»ç»Ÿå¯¹å†…å­˜è¶…è½½é‡‡å–äº†æ›´ä¸ºä¸¥å‰çš„æªæ–½ã€‚ä¾‹å¦‚ï¼ŒæŸäº›ç‰ˆæœ¬çš„ Linux ä¼šåœ¨å†…å­˜è¢«è¶…é‡å ç”¨æ—¶è¿è¡Œä¸€ä¸ª â€œå†…å­˜ä¸è¶³æ€æ‰‹â€ï¼›è¿™ä¸ªå®ˆæŠ¤è¿›ç¨‹ä¼šé€‰æ‹©ä¸€ä¸ªå†…å­˜å¯†é›†å‹è¿›ç¨‹å¹¶å°†å…¶æ€æ­»ï¼Œä»è€Œä»¥ä¸€ç§ä¸å¤ªæ˜æ˜¾çš„æ–¹å¼å‡å°‘å†…å­˜ã€‚è¿™ç§æ–¹æ³•è™½ç„¶èƒ½æˆåŠŸå‡å°‘å†…å­˜å‹åŠ›ï¼Œä½†ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ï¼Œå®ƒå¯èƒ½ä¼šæ€æ­» X æœåŠ¡å™¨ï¼Œä»è€Œå¯¼è‡´ä»»ä½•éœ€è¦æ˜¾ç¤ºçš„åº”ç”¨ç¨‹åºæ— æ³•ä½¿ç”¨ã€‚ ","date":"2024-04-25","objectID":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/:11:0","tags":["OS"],"title":"äº¤æ¢ç­–ç•¥","uri":"/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡è®¾åœ°å€ç©ºé—´å°å¾—ä¸åˆ‡å®é™…ï¼Œå¹¶ä¸”é€‚åˆç‰©ç†å†…å­˜ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¸€ç›´å‡è®¾æ¯ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„æ¯ä¸ªåœ°å€ç©ºé—´éƒ½é€‚åˆå†…å­˜ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ”¾å®½è¿™äº›é‡å¤§å‡è®¾ï¼Œå¹¶å‡è®¾æˆ‘ä»¬å¸Œæœ›æ”¯æŒè®¸å¤šå¹¶å‘è¿è¡Œçš„å¤§å‹åœ°å€ç©ºé—´ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å†…å­˜å±‚æ¬¡ç»“æ„ä¸­å¢åŠ ä¸€ä¸ªçº§åˆ«ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰é¡µé¢éƒ½é©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚ç„¶è€Œï¼Œä¸ºäº†æ”¯æŒå¤§åœ°å€ç©ºé—´ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥å­˜æ”¾å½“å‰éœ€æ±‚ä¸å¤§çš„éƒ¨åˆ†åœ°å€ç©ºé—´ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™æ ·çš„ä½ç½®çš„ç‰¹ç‚¹æ˜¯å®¹é‡è¦å¤§äºå†…å­˜ï¼›å› æ­¤ï¼Œå®ƒé€šå¸¸ä¼šæ¯”è¾ƒæ…¢ï¼ˆå¦‚æœå®ƒæ›´å¿«ï¼Œæˆ‘ä»¬å°±ä¼šå°†å®ƒç”¨ä½œå†…å­˜ï¼Œä¸æ˜¯å—ï¼Ÿï¼‰ã€‚åœ¨ç°ä»£ç³»ç»Ÿä¸­ï¼Œæ­¤è§’è‰²é€šå¸¸ç”±ç¡¬ç›˜é©±åŠ¨å™¨æ‹…ä»»ã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„å†…å­˜å±‚æ¬¡ç»“æ„ä¸­ï¼Œå¤§è€Œæ…¢çš„ç¡¬ç›˜é©±åŠ¨å™¨ä½äºåº•éƒ¨ï¼Œå†…å­˜ä½äºä¸Šé¢ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†é—®é¢˜çš„å…³é”®ï¼š å¦‚ä½•è¶…è¶Šç‰©ç†å†…å­˜ï¼Ÿæ“ä½œç³»ç»Ÿå¦‚ä½•åˆ©ç”¨æ›´å¤§ã€æ›´æ…¢çš„è®¾å¤‡æ¥é€æ˜åœ°æä¾›å¤§è™šæ‹Ÿåœ°å€ç©ºé—´çš„å‡è±¡ï¼Ÿ æ‚¨å¯èƒ½æœ‰ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä¸ºè¿›ç¨‹æ”¯æŒå•ä¸ªå¤§åœ°å€ç©ºé—´ï¼Ÿç­”æ¡ˆå†æ¬¡æ˜¯æ–¹ä¾¿å’Œæ˜“ç”¨ã€‚æœ‰äº†å¤§çš„åœ°å€ç©ºé—´ï¼Œæ‚¨å°±ä¸å¿…æ‹…å¿ƒå†…å­˜ä¸­æ˜¯å¦æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å®¹çº³ç¨‹åºçš„æ•°æ®ç»“æ„ï¼›ç›¸åï¼Œæ‚¨åªéœ€è‡ªç„¶åœ°ç¼–å†™ç¨‹åºï¼Œæ ¹æ®éœ€è¦åˆ†é…å†…å­˜å³å¯ã€‚è¿™æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„å¼ºå¤§å¹»è§‰ï¼Œä½¿æ‚¨çš„ç”Ÿæ´»å˜å¾—æ›´åŠ ç®€å•ã€‚ä¸æ­¤å½¢æˆé²œæ˜å¯¹æ¯”çš„æ˜¯ä½¿ç”¨å†…å­˜è¦†ç›–çš„æ—§ç³»ç»Ÿï¼Œå®ƒè¦æ±‚ç¨‹åºå‘˜åœ¨éœ€è¦æ—¶æ‰‹åŠ¨å°†ä»£ç æˆ–æ•°æ®ç§»å…¥æˆ–ç§»å‡ºå†…å­˜ã€‚è¯•ç€æƒ³è±¡ä¸€ä¸‹è¿™å°†ä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼šåœ¨è°ƒç”¨å‡½æ•°æˆ–è®¿é—®æŸäº›æ•°æ®ä¹‹å‰ï¼Œä½ éœ€è¦é¦–å…ˆå®‰æ’ä»£ç æˆ–æ•°æ®è¿›å…¥å†…å­˜ã€‚ é™¤äº†å•ä¸ªè¿›ç¨‹ä¹‹å¤–ï¼Œæ·»åŠ äº¤æ¢ç©ºé—´è¿˜å…è®¸æ“ä½œç³»ç»Ÿä¸ºå¤šä¸ªå¹¶å‘è¿è¡Œçš„è¿›ç¨‹æä¾›å¤§è™šæ‹Ÿå†…å­˜çš„å‡è±¡ã€‚å¤šé“ç¨‹åºè®¾è®¡ï¼ˆâ€œåŒæ—¶â€è¿è¡Œå¤šä¸ªç¨‹åºï¼Œä»¥æ›´å¥½åœ°åˆ©ç”¨æœºå™¨ï¼‰çš„å‘æ˜å‡ ä¹éœ€è¦äº¤æ¢æŸäº›é¡µé¢çš„èƒ½åŠ›ï¼Œå› ä¸ºæ—©æœŸçš„æœºå™¨æ˜¾ç„¶æ— æ³•åŒæ—¶å®¹çº³æ‰€æœ‰è¿›ç¨‹æ‰€éœ€çš„æ‰€æœ‰é¡µé¢ã€‚å› æ­¤ï¼Œå¤šé“ç¨‹åºè®¾è®¡å’Œæ˜“ç”¨æ€§çš„ç»“åˆä½¿æˆ‘ä»¬å¸Œæœ›æ”¯æŒä½¿ç”¨æ¯”ç‰©ç†å¯ç”¨å†…å­˜æ›´å¤šçš„å†…å­˜ã€‚è¿™æ˜¯æ‰€æœ‰ç°ä»£ VM ç³»ç»Ÿéƒ½ä¼šåšçš„äº‹æƒ…ï¼›ç°åœ¨æˆ‘ä»¬å°†è¿›ä¸€æ­¥äº†è§£è¿™ä¸€ç‚¹ã€‚ ","date":"2024-04-25","objectID":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/:0:0","tags":["OS"],"title":"é¡µé¢äº¤æ¢","uri":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 äº¤æ¢ç©ºé—´ æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯åœ¨ç£ç›˜ä¸Šä¿ç•™ä¸€äº›ç©ºé—´ç”¨äºæ¥å›ç§»åŠ¨é¡µé¢ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å°†æ­¤ç±»ç©ºé—´ç§°ä¸ºäº¤æ¢ç©ºé—´ï¼Œå› ä¸ºæˆ‘ä»¬å°†å†…å­˜ä¸­çš„é¡µé¢äº¤æ¢å‡ºæ¥ï¼Œåˆå°†å†…å­˜ä¸­çš„é¡µé¢äº¤æ¢è¿›å»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç®€å•åœ°å‡è®¾æ“ä½œç³»ç»Ÿå¯ä»¥ä»¥é¡µé¢å¤§å°ä¸ºå•ä½è¯»å–å’Œå†™å…¥äº¤æ¢ç©ºé—´ã€‚ä¸ºæ­¤ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦è®°ä½ç»™å®šé¡µé¢çš„ç£ç›˜åœ°å€ã€‚ äº¤æ¢ç©ºé—´çš„å¤§å°å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒæœ€ç»ˆå†³å®šäº†ç³»ç»Ÿåœ¨ç»™å®šæ—¶é—´å¯ä»¥ä½¿ç”¨çš„æœ€å¤§å†…å­˜é¡µæ•°ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾å®ƒç°åœ¨éå¸¸å¤§ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ä¸€ä¸ª 4 é¡µç‰©ç†å†…å­˜å’Œ 8 é¡µäº¤æ¢ç©ºé—´çš„å°ä¾‹å­ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œä¸‰ä¸ªè¿›ç¨‹ï¼ˆProc 0ã€Proc 1 å’Œ Proc 2ï¼‰æ­£åœ¨ä¸»åŠ¨å…±äº«ç‰©ç†å†…å­˜ï¼›ç„¶è€Œï¼Œè¿™ä¸‰ä¸ªé¡µé¢ä¸­çš„æ¯ä¸€ä¸ªéƒ½åªæœ‰ä¸€äº›æœ‰æ•ˆé¡µé¢ä½äºå†…å­˜ä¸­ï¼Œå…¶ä½™éƒ¨åˆ†ä½äºç£ç›˜ä¸Šçš„äº¤æ¢ç©ºé—´ä¸­ã€‚ç¬¬å››ä¸ªè¿›ç¨‹ (Proc 3) å·²å°†å…¶æ‰€æœ‰é¡µé¢æ¢å‡ºåˆ°ç£ç›˜ï¼Œå› æ­¤æ˜¾ç„¶å½“å‰æœªè¿è¡Œã€‚ä¸€åŒºå—çš„äº¤æ¢ä»ç„¶æ˜¯ç©ºé—²çš„ã€‚å³ä½¿ä»è¿™ä¸ªå°ä¾‹å­ä¸­ï¼Œå¸Œæœ›æ‚¨å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº¤æ¢ç©ºé—´å¦‚ä½•è®©ç³»ç»Ÿå‡è£…å†…å­˜æ¯”å®é™…æ›´å¤§ã€‚ æˆ‘ä»¬åº”è¯¥æ³¨æ„ï¼Œäº¤æ¢ç©ºé—´å¹¶ä¸æ˜¯äº¤æ¢æµé‡çš„å”¯ä¸€ç£ç›˜ä½ç½®ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æ­£åœ¨è¿è¡Œä¸€ä¸ªç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆä¾‹å¦‚ ls æˆ–æ‚¨è‡ªå·±ç¼–è¯‘çš„ä¸»ç¨‹åºï¼‰ã€‚è¯¥äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ä»£ç é¡µæœ€åˆåœ¨ç£ç›˜ä¸Šæ‰¾åˆ°ï¼Œå½“ç¨‹åºè¿è¡Œæ—¶ï¼Œå®ƒä»¬è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼ˆæˆ–è€…åœ¨ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ä¸€æ¬¡å…¨éƒ¨åŠ è½½ï¼Œæˆ–è€…åƒåœ¨ç°ä»£ç³»ç»Ÿä¸­ä¸€æ ·ï¼Œåœ¨éœ€è¦æ—¶ä¸€æ¬¡åŠ è½½ä¸€é¡µï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœç³»ç»Ÿéœ€è¦åœ¨ç‰©ç†å†…å­˜ä¸­è…¾å‡ºç©ºé—´æ¥æ»¡è¶³å…¶ä»–éœ€æ±‚ï¼Œå®ƒå¯ä»¥å®‰å…¨åœ°é‡æ–°ä½¿ç”¨è¿™äº›ä»£ç é¡µçš„å†…å­˜ç©ºé—´ï¼Œå› ä¸ºå®ƒçŸ¥é“ä»¥åå¯ä»¥ä»æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç£ç›˜äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å†æ¬¡äº¤æ¢å®ƒä»¬ã€‚ ","date":"2024-04-25","objectID":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/:1:0","tags":["OS"],"title":"é¡µé¢äº¤æ¢","uri":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 å­˜åœ¨ä½ ç°åœ¨æˆ‘ä»¬åœ¨ç£ç›˜ä¸Šæœ‰äº†ä¸€äº›ç©ºé—´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç³»ç»Ÿä¸­æ·»åŠ ä¸€äº›æ›´é«˜çº§åˆ«çš„æœºå™¨ï¼Œä»¥æ”¯æŒä¸ç£ç›˜ä¹‹é—´çš„é¡µé¢äº¤æ¢ã€‚ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¸¦æœ‰ç¡¬ä»¶ç®¡ç†çš„ TLB çš„ç³»ç»Ÿã€‚ é¦–å…ˆå›æƒ³ä¸€ä¸‹å†…å­˜å¼•ç”¨ä¸Šå‘ç”Ÿçš„æƒ…å†µã€‚è¿è¡Œçš„è¿›ç¨‹ç”Ÿæˆè™šæ‹Ÿå†…å­˜å¼•ç”¨ï¼ˆç”¨äºæŒ‡ä»¤è·å–æˆ–æ•°æ®è®¿é—®ï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¡¬ä»¶åœ¨ä»å†…å­˜ä¸­è·å–æ‰€éœ€æ•°æ®ä¹‹å‰å°†å®ƒä»¬è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚ è¯·è®°ä½ï¼Œç¡¬ä»¶é¦–å…ˆä»è™šæ‹Ÿåœ°å€ä¸­æå– VPNï¼Œæ£€æŸ¥ TLB æ˜¯å¦åŒ¹é…ï¼ˆTLB å‘½ä¸­ï¼‰ï¼Œå¦‚æœå‘½ä¸­ï¼Œåˆ™ç”Ÿæˆç»“æœç‰©ç†åœ°å€å¹¶ä»å†…å­˜ä¸­è·å–å®ƒã€‚è¿™å¸Œæœ›æ˜¯å¸¸è§æƒ…å†µï¼Œå› ä¸ºå®ƒé€Ÿåº¦å¾ˆå¿«ï¼ˆä¸éœ€è¦é¢å¤–çš„å†…å­˜è®¿é—®ï¼‰ã€‚ å¦‚æœåœ¨ TLB ä¸­æœªæ‰¾åˆ° VPNï¼ˆå³ TLB æœªå‘½ä¸­ï¼‰ï¼Œç¡¬ä»¶å°†åœ¨å†…å­˜ä¸­å®šä½é¡µè¡¨ï¼ˆä½¿ç”¨é¡µè¡¨åŸºå€å¯„å­˜å™¨ï¼‰ï¼Œå¹¶ä½¿ç”¨ VPN æŸ¥æ‰¾è¯¥é¡µçš„é¡µè¡¨æ¡ç›® (PTE)ï¼šä¸€ä¸ªç´¢å¼•ã€‚å¦‚æœè¯¥é¡µæœ‰æ•ˆå¹¶ä¸”å­˜åœ¨äºç‰©ç†å†…å­˜ä¸­ï¼Œåˆ™ç¡¬ä»¶ä» PTE ä¸­æå– PFNï¼Œå°†å…¶å®‰è£…åˆ° TLB ä¸­ï¼Œå¹¶é‡è¯•è¯¥æŒ‡ä»¤ï¼Œè¿™æ¬¡ç”Ÿæˆ TLB å‘½ä¸­ï¼›åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚ ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›å…è®¸é¡µé¢äº¤æ¢åˆ°ç£ç›˜ï¼Œæˆ‘ä»¬å¿…é¡»æ·»åŠ æ›´å¤šçš„æœºå™¨ã€‚å…·ä½“æ¥è¯´ï¼Œå½“ç¡¬ä»¶æŸ¥çœ‹PTEæ—¶ï¼Œå®ƒå¯èƒ½ä¼šå‘ç°ç‰©ç†å†…å­˜ä¸­ä¸å­˜åœ¨è¯¥é¡µã€‚ç¡¬ä»¶ï¼ˆæˆ–æ“ä½œç³»ç»Ÿï¼Œåœ¨è½¯ä»¶ç®¡ç†çš„ TLB æ–¹æ³•ä¸­ï¼‰ç¡®å®šè¿™ä¸€ç‚¹çš„æ–¹å¼æ˜¯é€šè¿‡æ¯ä¸ªé¡µè¡¨æ¡ç›®ä¸­çš„ä¸€æ¡æ–°ä¿¡æ¯ï¼ˆç§°ä¸ºå­˜åœ¨ä½ï¼Œthe present bitï¼‰ã€‚å¦‚æœå­˜åœ¨ä½è®¾ç½®ä¸º 1ï¼Œåˆ™æ„å‘³ç€è¯¥é¡µå­˜åœ¨äºç‰©ç†å†…å­˜ä¸­ï¼Œå¹¶ä¸”ä¸€åˆ‡æŒ‰ä¸Šè¿°è¿›è¡Œï¼›å¦‚æœå®ƒè®¾ç½®ä¸ºé›¶ï¼Œåˆ™è¯¥é¡µé¢ä¸åœ¨å†…å­˜ä¸­ï¼Œè€Œæ˜¯åœ¨ç£ç›˜ä¸Šçš„æŸä¸ªä½ç½®ã€‚è®¿é—®ä¸åœ¨ç‰©ç†å†…å­˜ä¸­çš„é¡µé¢çš„è¡Œä¸ºé€šå¸¸ç§°ä¸ºé¡µé¢é”™è¯¯ã€‚ å‡ºç°é¡µé¢é”™è¯¯æ—¶ï¼Œå°†è°ƒç”¨æ“ä½œç³»ç»Ÿæ¥å¤„ç†é¡µé¢é”™è¯¯ã€‚æ­£å¦‚æˆ‘ä»¬ç°åœ¨æ‰€æè¿°çš„ï¼Œè¿è¡Œä¸€æ®µç§°ä¸ºé¡µé¢é”™è¯¯å¤„ç†ç¨‹åºçš„ç‰¹å®šä»£ç ï¼Œå¹¶ä¸”å¿…é¡»ä¸ºé¡µé¢é”™è¯¯æä¾›æœåŠ¡ã€‚ ","date":"2024-04-25","objectID":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/:2:0","tags":["OS"],"title":"é¡µé¢äº¤æ¢","uri":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 é¡µé¢é”™è¯¯ å›æƒ³ä¸€ä¸‹ï¼Œå¯¹äº TLB æœªå‘½ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§ç±»å‹çš„ç³»ç»Ÿï¼šç¡¬ä»¶ç®¡ç†çš„ TLBï¼ˆç¡¬ä»¶åœ¨é¡µè¡¨ä¸­æŸ¥æ‰¾æ‰€éœ€çš„è½¬æ¢ï¼‰å’Œè½¯ä»¶ç®¡ç†çš„ TLBï¼ˆæ“ä½œç³»ç»Ÿæ‰§è¡Œçš„æ“ä½œï¼‰ã€‚åœ¨ä»»ä¸€ç±»å‹çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æœé¡µé¢ä¸å­˜åœ¨ï¼Œæ“ä½œç³»ç»Ÿå°†è´Ÿè´£å¤„ç†é¡µé¢é”™è¯¯ã€‚æ“ä½œç³»ç»Ÿé¡µé¢é”™è¯¯å¤„ç†ç¨‹åºå°†è¿è¡Œä»¥ç¡®å®šè¦åšä»€ä¹ˆã€‚å‡ ä¹æ‰€æœ‰ç³»ç»Ÿéƒ½é€šè¿‡è½¯ä»¶æ¥å¤„ç†é¡µé¢é”™è¯¯ï¼›å³ä½¿ä½¿ç”¨ç¡¬ä»¶ç®¡ç†çš„ TLBï¼Œç¡¬ä»¶ä¹Ÿä¼šä¿¡ä»»æ“ä½œç³»ç»Ÿæ¥ç®¡ç†è¿™é¡¹é‡è¦èŒè´£ã€‚ å¦‚æœé¡µé¢ä¸å­˜åœ¨å¹¶ä¸”å·²äº¤æ¢åˆ°ç£ç›˜ï¼Œæ“ä½œç³»ç»Ÿå°†éœ€è¦å°†è¯¥é¡µé¢äº¤æ¢åˆ°å†…å­˜ä¸­ä»¥è§£å†³é¡µé¢é”™è¯¯ã€‚å› æ­¤ï¼Œå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼šæ“ä½œç³»ç»Ÿå¦‚ä½•çŸ¥é“åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æ‰€éœ€çš„é¡µé¢ï¼Ÿåœ¨è®¸å¤šç³»ç»Ÿä¸­ï¼Œé¡µè¡¨æ˜¯å­˜å‚¨æ­¤ç±»ä¿¡æ¯çš„è‡ªç„¶ä½ç½®ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨ PTE ä¸­é€šå¸¸ç”¨äºæ•°æ®çš„ä½ï¼Œä¾‹å¦‚ç£ç›˜åœ°å€é¡µé¢çš„ PFNã€‚å½“æ“ä½œç³»ç»Ÿæ”¶åˆ°é¡µé¢çš„ç¼ºé¡µé”™è¯¯æ—¶ï¼Œå®ƒä¼šåœ¨ PTE ä¸­æŸ¥æ‰¾åœ°å€ï¼Œå¹¶å‘ç£ç›˜å‘å‡ºè¯·æ±‚ä»¥å°†è¯¥é¡µé¢æå–åˆ°å†…å­˜ä¸­ã€‚ å½“ç£ç›˜ I/O å®Œæˆæ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†æ›´æ–°é¡µè¡¨ä»¥å°†é¡µé¢æ ‡è®°ä¸ºå­˜åœ¨ï¼Œæ›´æ–°é¡µè¡¨é¡¹ (PTE) çš„ PFN å­—æ®µä»¥è®°å½•æ–°è·å–çš„é¡µé¢åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œå¹¶é‡è¯•è¯¥æŒ‡ä»¤ã€‚ä¸‹ä¸€æ¬¡å°è¯•å¯èƒ½ä¼šç”Ÿæˆ TLB æœªå‘½ä¸­ï¼Œç„¶åå°†å¯¹å…¶è¿›è¡Œå¤„ç†å¹¶é€šè¿‡è½¬æ¢æ›´æ–° TLBï¼ˆå¯ä»¥åœ¨å¤„ç†é¡µé”™è¯¯æ—¶äº¤æ›¿æ›´æ–° TLBï¼Œä»¥é¿å…æ­¤æ­¥éª¤ï¼‰ã€‚æœ€åï¼Œæœ€åä¸€æ¬¡é‡æ–°å¯åŠ¨å°†åœ¨ TLB ä¸­æ‰¾åˆ°è½¬æ¢ï¼Œä»è€Œç»§ç»­ä»å†…å­˜ä¸­è½¬æ¢åçš„ç‰©ç†åœ°å€è·å–æ‰€éœ€çš„æ•°æ®æˆ–æŒ‡ä»¤ã€‚ è¯·æ³¨æ„ï¼Œå½“ I/O æ­£åœ¨è¿›è¡Œæ—¶ï¼Œè¿›ç¨‹å°†å¤„äºé˜»å¡çŠ¶æ€ã€‚å› æ­¤ï¼Œåœ¨å¤„ç†é¡µé¢é”™è¯¯æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†å¯ä»¥è‡ªç”±åœ°è¿è¡Œå…¶ä»–å°±ç»ªè¿›ç¨‹ã€‚ç”±äº I/O çš„æˆæœ¬å¾ˆé«˜ï¼Œå› æ­¤ä¸€ä¸ªè¿›ç¨‹çš„ I/Oï¼ˆé¡µé¢é”™è¯¯ï¼‰ä¸å¦ä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œçš„é‡å æ˜¯å¤šé“ç¨‹åºç³»ç»Ÿæœ€æœ‰æ•ˆåœ°åˆ©ç”¨å…¶ç¡¬ä»¶çš„å¦ä¸€ç§æ–¹å¼ã€‚ ","date":"2024-04-25","objectID":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/:3:0","tags":["OS"],"title":"é¡µé¢äº¤æ¢","uri":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å¦‚æœå†…å­˜å·²æ»¡æ€ä¹ˆåŠï¼Ÿ åœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œæˆ‘ä»¬å‡è®¾æœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜å¯ä»äº¤æ¢ç©ºé—´è°ƒå…¥é¡µé¢ã€‚å½“ç„¶ï¼Œæƒ…å†µä¹Ÿå¯èƒ½å¹¶éå¦‚æ­¤ï¼›å†…å­˜å¯èƒ½å·²æ»¡ï¼ˆæˆ–æ¥è¿‘æ»¡ï¼‰ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½å¸Œæœ›é¦–å…ˆè°ƒå‡ºä¸€ä¸ªæˆ–å¤šä¸ªé¡µé¢ï¼Œä»¥ä¾¿ä¸ºæ“ä½œç³»ç»Ÿå³å°†å¼•å…¥çš„æ–°é¡µé¢è…¾å‡ºç©ºé—´ã€‚é€‰æ‹©è¦è¸¢å‡ºæˆ–æ›¿æ¢çš„é¡µé¢çš„è¿‡ç¨‹ç§°ä¸ºé¡µé¢æ›¿æ¢ç­–ç•¥ã€‚ äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºè‰¯å¥½çš„é¡µé¢æ›¿æ¢ç­–ç•¥æ—¶èŠ±è´¹äº†å¾ˆå¤šå¿ƒæ€ï¼Œå› ä¸ºè¸¢å‡ºé”™è¯¯çš„é¡µé¢å¯èƒ½ä¼šç»™ç¨‹åºæ€§èƒ½å¸¦æ¥å·¨å¤§çš„æŸå¤±ã€‚åšå‡ºé”™è¯¯çš„å†³å®šå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºä»¥ç±»ä¼¼ç£ç›˜çš„é€Ÿåº¦è€Œä¸æ˜¯ç±»ä¼¼å†…å­˜çš„é€Ÿåº¦è¿è¡Œï¼›åœ¨å½“å‰æŠ€æœ¯ä¸­ï¼Œè¿™æ„å‘³ç€ç¨‹åºçš„è¿è¡Œé€Ÿåº¦å¯èƒ½ä¼šæ…¢ 10,000 æˆ– 100,000 å€ã€‚æ‰€ä»¥ï¼Œè¿™æ ·çš„ç­–ç•¥æ˜¯å€¼å¾—æˆ‘ä»¬ä»”ç»†ç ”ç©¶çš„ã€‚äº‹å®ä¸Šï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬åœ¨ä¸‹ä¸€ç« ä¸­è¦åšçš„äº‹æƒ…ã€‚ç°åœ¨ï¼Œåªè¦ç†è§£è¿™æ ·çš„æ”¿ç­–çš„å­˜åœ¨å°±è¶³å¤Ÿäº†ï¼Œå®ƒå»ºç«‹åœ¨æ­¤å¤„æè¿°çš„æœºåˆ¶ä¹‹ä¸Šã€‚ ","date":"2024-04-25","objectID":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/:4:0","tags":["OS"],"title":"é¡µé¢äº¤æ¢","uri":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 é¡µé¢é”™è¯¯æ§åˆ¶æµ æœ‰äº†è¿™äº›çŸ¥è¯†ï¼Œæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥å¤§è‡´å‹¾å‹’å‡ºå†…å­˜è®¿é—®çš„å®Œæ•´æ§åˆ¶æµç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ¢å¥è¯è¯´ï¼Œå½“æœ‰äººé—®ä½  â€œå½“ç¨‹åºä»å†…å­˜ä¸­è·å–ä¸€äº›æ•°æ®æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿâ€œæ—¶ï¼Œä½ åº”è¯¥å¯¹æ‰€æœ‰ä¸åŒçš„å¯èƒ½æ€§æœ‰ä¸€ä¸ªç›¸å½“å¥½çš„æ¦‚å¿µï¼Œå¦‚ä¸‹é¢ä¸¤æ®µä»£ç æ‰€ç¤ºã€‚ // Page-Fault Control Flow Algorithm (Hardware) 1 VPN = (VirtualAddress \u0026 VPN_MASK) \u003e\u003e SHIFT 2 (Success, TlbEntry) = TLB_Lookup(VPN) 3 if (Success == True) // TLB Hit 4 if (CanAccess(TlbEntry.ProtectBits) == True) 5 Offset = VirtualAddress \u0026 OFFSET_MASK 6 PhysAddr = (TlbEntry.PFN \u003c\u003c SHIFT) | Offset 7 Register = AccessMemory(PhysAddr) 8 else 9 RaiseException(PROTECTION_FAULT) 10 else // TLB Miss 11 PTEAddr = PTBR + (VPN * sizeof(PTE)) 12 PTE = AccessMemory(PTEAddr) 13 if (PTE.Valid == False) 14 RaiseException(SEGMENTATION_FAULT) 15 else 16 if (CanAccess(PTE.ProtectBits) == False) 17 RaiseException(PROTECTION_FAULT) 18 else if (PTE.Present == True) 19 // assuming hardware-managed TLB 20 TLB_Insert(VPN, PTE.PFN, PTE.ProtectBits) 21 RetryInstruction() 22 else if (PTE.Present == False) 23 RaiseException(PAGE_FAULT) // Page-Fault Control Flow Algorithm (Software) 1 PFN = FindFreePhysicalPage() 2 if (PFN == -1) // no free page found 3 PFN = EvictPage() // run replacement algorithm 4 DiskRead(PTE.DiskAddr, PFN) // sleep (waiting for I/O) 5 PTE.present = True // update page table with present bit 6 PTE.PFN = PFN // and translation (PFN) 7 RetryInstruction() // retry instruction ç¬¬ä¸€æ®µä»£ç æ˜¾ç¤ºäº†ç¡¬ä»¶åœ¨è½¬æ¢è¿‡ç¨‹ä¸­çš„æ“ä½œï¼Œç¬¬äºŒæ®µä»£ç æ˜¾ç¤ºäº†æ“ä½œç³»ç»Ÿåœ¨å‘ç”Ÿé¡µé¢é”™è¯¯æ—¶çš„æ“ä½œã€‚ ä»ç¬¬ä¸€æ®µä»£ç ä¸­çš„ç¡¬ä»¶æ§åˆ¶æµç¨‹å¯ä»¥çœ‹å‡ºï¼Œå½“å‘ç”Ÿ TLB æœªå‘½ä¸­æ—¶ï¼Œæœ‰ä¸‰ç§é‡è¦æƒ…å†µéœ€è¦äº†è§£ã€‚ç¬¬ä¸€ç§æƒ…å†µæ˜¯é¡µé¢æ—¢å­˜åœ¨åˆæœ‰æ•ˆï¼ˆç¬¬ 18-21 è¡Œï¼‰ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTLB æœªå‘½ä¸­å¤„ç†ç¨‹åºå¯ä»¥ç®€å•åœ°ä» PTE ä¸­è·å– PFNï¼Œé‡è¯•æŒ‡ä»¤ï¼ˆè¿™æ¬¡ä¼šå¯¼è‡´ TLB å‘½ä¸­ï¼‰ï¼Œç„¶åç»§ç»­ä¹‹å‰ï¼ˆå¤šæ¬¡ï¼‰æè¿°çš„æ“ä½œã€‚åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼ˆç¬¬ 22-23 è¡Œï¼‰ï¼Œå¿…é¡»è¿è¡Œé¡µé¢é”™è¯¯å¤„ç†ç¨‹åºï¼›è™½ç„¶è¿›ç¨‹è®¿é—®çš„é¡µé¢æ˜¯åˆæ³•çš„ï¼ˆæ¯•ç«Ÿæ˜¯æœ‰æ•ˆçš„ï¼‰ï¼Œä½†å®ƒä¸åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚ç¬¬ä¸‰ç§ï¼ˆä¹Ÿæ˜¯æœ€åä¸€ç§ï¼‰æƒ…å†µæ˜¯è®¿é—®çš„é¡µé¢æ— æ•ˆï¼Œä¾‹å¦‚ç”±äºç¨‹åºä¸­çš„é”™è¯¯ï¼ˆç¬¬ 13-14 è¡Œï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒPTE ä¸­çš„å…¶ä»–ä½éƒ½ä¸é‡è¦ï¼›ç¡¬ä»¶ä¼šæ•è·è¿™ç§æ— æ•ˆè®¿é—®ï¼Œæ“ä½œç³»ç»Ÿä¸­æ–­å¤„ç†ç¨‹åºä¹Ÿä¼šè¿è¡Œï¼Œä»è€Œç»ˆæ­¢è¿è§„è¿›ç¨‹ã€‚ ä»ç¬¬äºŒæ®µä»£ç çš„è½¯ä»¶æ§åˆ¶æµä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ“ä½œç³»ç»Ÿå¤„ç†é¡µé¢é”™è¯¯çš„å¤§è‡´æ­¥éª¤ã€‚é¦–å…ˆï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»ä¸ºå³å°†å‘ç”Ÿé”™è¯¯çš„é¡µé¢æ‰¾åˆ°ä¸€ä¸ªç‰©ç†é¡µå·ï¼›å¦‚æœæ²¡æœ‰è¿™æ ·çš„é¡µé¢ï¼Œæˆ‘ä»¬å°±å¿…é¡»ç­‰å¾…æ›¿æ¢ç®—æ³•è¿è¡Œï¼Œå°†ä¸€äº›é¡µé¢è¸¢å‡ºå†…å­˜ï¼Œä»è€Œé‡Šæ”¾å‡ºè¿™äº›é¡µé¢ä¾›æ­¤å¤„ä½¿ç”¨ã€‚æœ‰äº†ç‰©ç†é¡µï¼Œå¤„ç†ç¨‹åºå°±ä¼šå‘å‡º I/O è¯·æ±‚ä»¥ä»äº¤æ¢ç©ºé—´è¯»å…¥é¡µé¢ã€‚æœ€åï¼Œå½“ç¼“æ…¢çš„æ“ä½œå®Œæˆæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ›´æ–°é¡µè¡¨å¹¶é‡è¯•è¯¥æŒ‡ä»¤ã€‚é‡è¯•å°†å¯¼è‡´ TLB æœªå‘½ä¸­ï¼Œç„¶åï¼Œåœ¨å¦ä¸€æ¬¡é‡è¯•æ—¶ï¼ŒTLB å‘½ä¸­ï¼Œæ­¤æ—¶ç¡¬ä»¶å°†èƒ½å¤Ÿè®¿é—®æ‰€éœ€çš„é¡¹ã€‚ ","date":"2024-04-25","objectID":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/:5:0","tags":["OS"],"title":"é¡µé¢äº¤æ¢","uri":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 å½“æ›¿æ¢çœŸæ­£å‘ç”Ÿæ—¶ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æè¿°æ›¿æ¢å¦‚ä½•å‘ç”Ÿçš„æ–¹å¼æ˜¯å‡è®¾æ“ä½œç³»ç»Ÿç­‰å¾…å†…å­˜å®Œå…¨æ»¡ï¼Œç„¶åæ‰æ›¿æ¢ï¼ˆé€å‡ºï¼‰é¡µé¢ä¸ºå…¶ä»–é¡µé¢è…¾å‡ºç©ºé—´ã€‚æ­£å¦‚æ‚¨å¯ä»¥æƒ³è±¡çš„é‚£æ ·ï¼Œè¿™æœ‰ç‚¹ä¸ç°å®ï¼Œæ“ä½œç³»ç»Ÿä¸»åŠ¨ä¿ç•™ä¸€å°éƒ¨åˆ†å†…å­˜çš„åŸå› æœ‰å¾ˆå¤šã€‚ ä¸ºäº†ä¿æŒå°‘é‡å†…å­˜ç©ºé—²ï¼Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿéƒ½æœ‰æŸç§é«˜æ°´ä½çº¿ï¼ˆHWï¼‰å’Œä½æ°´ä½çº¿ï¼ˆLWï¼‰æ¥å¸®åŠ©å†³å®šä½•æ—¶å¼€å§‹ä»å†…å­˜ä¸­é€å‡ºé¡µé¢ã€‚å…¶å·¥ä½œåŸç†å¦‚ä¸‹ï¼šå½“æ“ä½œç³»ç»Ÿæ³¨æ„åˆ°å¯ç”¨çš„ LW é¡µæ•°è¾ƒå°‘æ—¶ï¼Œè´Ÿè´£é‡Šæ”¾å†…å­˜çš„åå°çº¿ç¨‹å°±ä¼šè¿è¡Œã€‚è¯¥çº¿ç¨‹é€å‡ºé¡µé¢ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„ç¡¬ä»¶é¡µé¢ã€‚**åå°çº¿ç¨‹ï¼ˆæœ‰æ—¶ç§°ä¸ºäº¤æ¢å®ˆæŠ¤ç¨‹åºæˆ–é¡µé¢å®ˆæŠ¤ç¨‹åºï¼‰**ç„¶åè¿›å…¥ç¡çœ çŠ¶æ€ï¼Œå¾ˆé«˜å…´å®ƒé‡Šæ”¾äº†ä¸€äº›å†…å­˜ä¾›æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å’Œæ“ä½œç³»ç»Ÿä½¿ç”¨ã€‚ é€šè¿‡åŒæ—¶æ‰§è¡Œå¤šä¸ªæ›¿æ¢ï¼Œæ–°çš„æ€§èƒ½ä¼˜åŒ–æˆä¸ºå¯èƒ½ã€‚ä¾‹å¦‚ï¼Œè®¸å¤šç³»ç»Ÿä¼šå°†å¤šä¸ªé¡µé¢èšé›†æˆ–åˆ†ç»„å¹¶ç«‹å³å°†å®ƒä»¬å†™å…¥äº¤æ¢åˆ†åŒºï¼Œä»è€Œæé«˜ç£ç›˜çš„æ•ˆç‡ï¼›æ­£å¦‚æˆ‘ä»¬ç¨åæ›´è¯¦ç»†åœ°è®¨è®ºç£ç›˜æ—¶å°†çœ‹åˆ°çš„é‚£æ ·ï¼Œè¿™ç§é›†ç¾¤å‡å°‘äº†ç£ç›˜çš„æŸ¥æ‰¾å’Œæ—‹è½¬å¼€é”€ï¼Œä»è€Œæ˜¾ç€æé«˜äº†æ€§èƒ½ã€‚ ä¸ºäº†ä¸åå°åˆ†é¡µçº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œä¸Šé¢çš„ç¬¬äºŒæ®µä»£ç æ§åˆ¶æµåº”è¯¥ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼›è¯¥ç®—æ³•ä¸ä¼šç›´æ¥æ‰§è¡Œæ›¿æ¢ï¼Œè€Œæ˜¯ç®€å•åœ°æ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨çš„ç©ºé—²é¡µé¢ã€‚å¦‚æœæ²¡æœ‰ï¼Œå®ƒä¼šé€šçŸ¥åå°åˆ†é¡µçº¿ç¨‹éœ€è¦ç©ºé—²é¡µé¢ï¼›å½“çº¿ç¨‹é‡Šæ”¾ä¸€äº›é¡µé¢æ—¶ï¼Œå®ƒä¼šé‡æ–°å”¤é†’åŸå§‹çº¿ç¨‹ï¼Œç„¶ååŸå§‹çº¿ç¨‹å¯ä»¥è°ƒå…¥æ‰€éœ€çš„é¡µé¢å¹¶ç»§ç»­å…¶å·¥ä½œã€‚ ","date":"2024-04-25","objectID":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/:6:0","tags":["OS"],"title":"é¡µé¢äº¤æ¢","uri":"/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"ç°åœ¨æˆ‘ä»¬è§£å†³åˆ†é¡µå¸¦æ¥çš„ç¬¬äºŒä¸ªé—®é¢˜ï¼šé¡µè¡¨å¤ªå¤§ï¼Œå› æ­¤æ¶ˆè€—å¤ªå¤šå†…å­˜ã€‚è®©æˆ‘ä»¬ä»çº¿æ€§é¡µè¡¨å¼€å§‹ã€‚æ‚¨å¯èƒ½è¿˜è®°å¾—ï¼Œçº¿æ€§é¡µè¡¨å˜å¾—ç›¸å½“å¤§ã€‚å†æ¬¡å‡è®¾ 32 ä½åœ°å€ç©ºé—´ï¼ˆ$2^{32}$å­—èŠ‚ï¼‰ï¼Œå…·æœ‰ 4KBï¼ˆ$2^{12}$ å­—èŠ‚ï¼‰é¡µé¢å’Œ 4 å­—èŠ‚é¡µè¡¨æ¡ç›®ã€‚å› æ­¤ï¼Œåœ°å€ç©ºé—´ä¸­å¤§çº¦æœ‰ä¸€ç™¾ä¸‡ä¸ªè™šæ‹Ÿé¡µï¼ˆ$\\frac{2^{32}}{2^{12}}$ï¼‰ï¼›ä¹˜ä»¥é¡µè¡¨æ¡ç›®å¤§å°ï¼Œæ‚¨ä¼šçœ‹åˆ°é¡µè¡¨å¤§å°ä¸º 4MBã€‚ å¦å›æƒ³ä¸€ä¸‹ï¼šæˆ‘ä»¬é€šå¸¸ä¸ºç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªé¡µè¡¨ï¼å¯¹äºä¸€ç™¾ä¸ªæ´»åŠ¨è¿›ç¨‹ï¼ˆåœ¨ç°ä»£ç³»ç»Ÿä¸Šå¹¶ä¸ç½•è§ï¼‰ï¼Œæˆ‘ä»¬å°†ä¸ºé¡µè¡¨åˆ†é…æ•°ç™¾å…†å­—èŠ‚çš„å†…å­˜ï¼å› æ­¤ï¼Œæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸€äº›æŠ€æœ¯æ¥å‡è½»è¿™ç§æ²‰é‡çš„è´Ÿæ‹…ã€‚å®ƒä»¬æœ‰å¾ˆå¤šï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ã€‚ä½†åœ¨ä¹‹å‰æˆ‘ä»¬çš„é—®é¢˜å…³é”®æ˜¯ï¼šç®€å•çš„åŸºäºæ•°ç»„çš„é¡µè¡¨ï¼ˆé€šå¸¸ç§°ä¸ºçº¿æ€§é¡µè¡¨ï¼‰å¤ªå¤§ï¼Œåœ¨å…¸å‹ç³»ç»Ÿä¸Šå ç”¨å¤ªå¤šå†…å­˜ã€‚å¦‚ä½•æ‰èƒ½è®©é¡µè¡¨å˜å°å‘¢ï¼Ÿå…³é”®çš„æƒ³æ³•æ˜¯ä»€ä¹ˆï¼Ÿè¿™äº›æ–°çš„æ•°æ®ç»“æ„ä¼šå¯¼è‡´å“ªäº›ä½æ•ˆç‡ï¼Ÿ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:0:0","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼šæ›´å¤§çš„é¡µé¢ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥å‡å°é¡µè¡¨çš„å¤§å°ï¼šä½¿ç”¨è¾ƒå¤§çš„é¡µé¢ã€‚å†æ¬¡ä½¿ç”¨æˆ‘ä»¬çš„ 32 ä½åœ°å€ç©ºé—´ï¼Œä½†è¿™æ¬¡å‡è®¾é¡µé¢ä¸º 16KBã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†æ‹¥æœ‰ä¸€ä¸ª 18 ä½ VPN åŠ ä¸Šä¸€ä¸ª 14 ä½åç§»é‡ã€‚å‡è®¾æ¯ä¸ª PTE çš„å¤§å°ç›¸åŒï¼ˆ4 å­—èŠ‚ï¼‰ï¼Œæˆ‘ä»¬çš„çº¿æ€§é¡µè¡¨ä¸­ç°åœ¨æœ‰ $2^{18}$ ä¸ªæ¡ç›®ï¼Œå› æ­¤æ¯ä¸ªé¡µè¡¨çš„æ€»å¤§å°ä¸º 1MBï¼Œé¡µè¡¨å¤§å°å‡å°‘äº†å››å€ï¼ˆæ¯«ä¸å¥‡æ€ªï¼Œå‡å°‘æ°å¥½åæ˜ äº†é¡µé¢å¤§å°å››å€çš„å¢åŠ ï¼‰ã€‚ ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•çš„ä¸»è¦é—®é¢˜æ˜¯å¤§é¡µé¢ä¼šå¯¼è‡´æ¯ä¸ªé¡µé¢å†…çš„æµªè´¹ï¼Œè¿™ä¸ªé—®é¢˜ç§°ä¸ºå†…éƒ¨ç¢ç‰‡ï¼ˆå› ä¸ºæµªè´¹æ˜¯åˆ†é…å•å…ƒå†…éƒ¨çš„ï¼‰ã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºæœ€ç»ˆä¼šåˆ†é…é¡µé¢ï¼Œä½†åªä½¿ç”¨æ¯ä¸ªé¡µé¢çš„ä¸€å°éƒ¨åˆ†ï¼Œå¹¶ä¸”å†…å­˜å¾ˆå¿«å°±ä¼šè¢«è¿™äº›è¿‡å¤§çš„é¡µé¢å¡«æ»¡ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°ç³»ç»Ÿåœ¨å¸¸è§æƒ…å†µä¸‹ä½¿ç”¨ç›¸å¯¹è¾ƒå°çš„é¡µé¢å¤§å°ï¼š4KBï¼ˆå¦‚åœ¨ x86 ä¸­ï¼‰æˆ– 8KBï¼ˆå¦‚åœ¨ SPARCv9 ä¸­ï¼‰ã€‚æˆ‘ä»¬çš„é—®é¢˜ä¸ä¼šè¿™ä¹ˆç®€å•åœ°è§£å†³ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:1:0","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 æ··åˆæ–¹æ³•ï¼šåˆ†é¡µå’Œåˆ†æ®µ æ¯å½“ä½ å¯¹ç”Ÿæ´»ä¸­çš„æŸä»¶äº‹æœ‰ä¸¤ç§åˆç†ä½†ä¸åŒçš„æ–¹æ³•æ—¶ï¼Œä½ åº”è¯¥å§‹ç»ˆæ£€æŸ¥ä¸¤è€…çš„ç»“åˆï¼Œçœ‹çœ‹æ˜¯å¦èƒ½è·å¾—ä¸¤å…¨å…¶ç¾çš„æ•ˆæœã€‚æˆ‘ä»¬å°†è¿™ç§ç»„åˆç§°ä¸ºæ··åˆä½“ã€‚ å¤šå¹´å‰ï¼ŒMultics çš„åˆ›å»ºè€…ï¼ˆç‰¹åˆ«æ˜¯ Jack Dennisï¼‰åœ¨æ„å»º Multics è™šæ‹Ÿå†…å­˜ç³»ç»Ÿæ—¶å¶ç„¶æƒ³åˆ°äº†è¿™æ ·çš„æƒ³æ³•ã€‚å…·ä½“æ¥è¯´ï¼ŒDennis æå‡ºäº†å°†åˆ†é¡µå’Œåˆ†æ®µç›¸ç»“åˆçš„æƒ³æ³•ï¼Œä»¥å‡å°‘é¡µè¡¨çš„å†…å­˜å¼€é”€ã€‚é€šè¿‡æ›´è¯¦ç»†åœ°æ£€æŸ¥å…¸å‹çš„çº¿æ€§é¡µè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æ˜ç™½ä¸ºä»€ä¹ˆè¿™å¯èƒ½èµ·ä½œç”¨ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåœ°å€ç©ºé—´ï¼Œå…¶ä¸­å †å’Œæ ˆçš„å·²ä½¿ç”¨éƒ¨åˆ†å¾ˆå°ã€‚ä¾‹å¦‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨ 16KB çš„å¾®å°åœ°å€ç©ºé—´å’Œ 1KB é¡µé¢ï¼› è¯¥åœ°å€ç©ºé—´çš„é¡µè¡¨å¦‚å›¾ä¸‹å›¾æ‰€ç¤ºã€‚ æœ¬ä¾‹å‡å®šå•ä¸ªä»£ç é¡µï¼ˆVPN 0ï¼‰æ˜ å°„åˆ°ç‰©ç†é¡µ 10ï¼Œå•ä¸ªå †é¡µï¼ˆVPN 4ï¼‰æ˜ å°„åˆ°ç‰©ç†é¡µ 23ï¼Œåœ°å€ç©ºé—´å¦ä¸€ç«¯çš„ä¸¤ä¸ªæ ˆé¡µï¼ˆVPN 14 å’Œ 15ï¼‰åˆ†åˆ«æ˜ å°„åˆ°ç‰©ç†é¡µ 28 å’Œ 4ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¤§éƒ¨åˆ†é¡µè¡¨éƒ½æœªä½¿ç”¨ï¼Œå……æ»¡äº†æ— æ•ˆæ¡ç›®ã€‚éå¸¸æµªè´¹ç©ºé—´ï¼Œä¸”è¿™åªæ˜¯ä¸€ä¸ª 16KB çš„å°åœ°å€ç©ºé—´ï¼Œå¦‚æœæ˜¯32ä½ï¼Œä¼šæµªè´¹çš„æ›´å¤šã€‚ å› æ­¤ï¼Œæˆ‘ä»¬çš„æ··åˆæ–¹æ³•æ˜¯ï¼šä¸å…¶ä¸ºè¿›ç¨‹çš„æ•´ä¸ªåœ°å€ç©ºé—´åˆ¶ä½œä¸€ä¸ªé¡µè¡¨ï¼Œä¸ºä»€ä¹ˆä¸ä¸ºæ¯ä¸ªé€»è¾‘æ®µåˆ¶ä½œä¸€ä¸ªé¡µè¡¨å‘¢ï¼Ÿåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰ä¸‰ä¸ªé¡µè¡¨ï¼Œåˆ†åˆ«ç”¨äºåœ°å€ç©ºé—´çš„ä»£ç ã€å †å’Œæ ˆéƒ¨åˆ†ã€‚ ç°åœ¨ï¼Œè¯·è®°ä½åˆ†æ®µï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŸºå€å¯„å­˜å™¨å‘Šè¯‰æˆ‘ä»¬æ¯ä¸ªæ®µåœ¨ç‰©ç†å†…å­˜ä¸­çš„ä½ç½®ï¼Œè¿˜æœ‰ä¸€ä¸ªè¾¹ç•Œæˆ–é™åˆ¶å¯„å­˜å™¨å‘Šè¯‰æˆ‘ä»¬æ‰€è¿°æ®µçš„å¤§å°ã€‚åœ¨æˆ‘ä»¬çš„æ··åˆä¸­ï¼Œæˆ‘ä»¬åœ¨ MMU ä¸­ä»ç„¶æœ‰è¿™äº›ç»“æ„ï¼›åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨åŸºå€ä¸æ˜¯æŒ‡å‘æ®µæœ¬èº«ï¼Œè€Œæ˜¯ä¿å­˜è¯¥æ®µé¡µè¡¨çš„ç‰©ç†åœ°å€ã€‚è¾¹ç•Œå¯„å­˜å™¨ç”¨äºæŒ‡ç¤ºé¡µè¡¨çš„æœ«å°¾ï¼ˆå³ï¼Œå®ƒæœ‰å¤šå°‘ä¸ªæœ‰æ•ˆé¡µï¼‰ã€‚ è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ã€‚å‡è®¾ 32 ä½è™šæ‹Ÿåœ°å€ç©ºé—´æœ‰ 4KB é¡µé¢ï¼Œåœ°å€ç©ºé—´åˆ†ä¸ºå››ä¸ªæ®µã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬åªä½¿ç”¨ä¸‰ä¸ªæ®µï¼šä¸€ä¸ªç”¨äºä»£ç ï¼Œä¸€ä¸ªç”¨äºå †ï¼Œä¸€ä¸ªç”¨äºæ ˆã€‚ ä¸ºäº†ç¡®å®šåœ°å€å¼•ç”¨å“ªä¸ªæ®µï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åœ°å€ç©ºé—´çš„å‰ä¸¤ä½ã€‚å‡è®¾ 00 æ˜¯æœªä½¿ç”¨çš„æ®µï¼Œ01 è¡¨ç¤ºä»£ç ï¼Œ10 è¡¨ç¤ºå †ï¼Œ11 è¡¨ç¤ºå †æ ˆã€‚å› æ­¤ï¼Œè™šæ‹Ÿåœ°å€å¦‚ä¸‹æ‰€ç¤ºï¼š åœ¨ç¡¬ä»¶ä¸­ï¼Œå‡è®¾æœ‰ä¸‰ä¸ªåŸºå¯„å­˜å™¨/è¾¹ç•Œå¯¹ï¼Œä»£ç ã€å †å’Œæ ˆå„ä¸€ä¸ªã€‚å½“è¿›ç¨‹è¿è¡Œæ—¶ï¼Œæ¯ä¸ªåˆ†æ®µçš„åŸºå¯„å­˜å™¨éƒ½åŒ…å«è¯¥åˆ†æ®µçº¿æ€§é¡µè¡¨çš„ç‰©ç†åœ°å€ï¼›å› æ­¤ï¼Œç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹ç°åœ¨éƒ½æœ‰ä¸‰ä¸ªä¸ä¹‹ç›¸å…³çš„é¡µè¡¨ã€‚åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œå¿…é¡»æ›´æ”¹è¿™äº›å¯„å­˜å™¨ï¼Œä»¥åæ˜ æ–°è¿è¡Œè¿›ç¨‹çš„é¡µè¡¨ä½ç½®ã€‚ åœ¨ TLB æœªå‘½ä¸­æ—¶ï¼ˆå‡è®¾ TLB ç”±ç¡¬ä»¶ç®¡ç†ï¼Œå³ç”±ç¡¬ä»¶è´Ÿè´£å¤„ç† TLB æœªå‘½ä¸­ï¼‰ï¼Œç¡¬ä»¶ä¼šä½¿ç”¨æ®µä½ï¼ˆSNï¼‰æ¥ç¡®å®šè¦ä½¿ç”¨çš„åŸºå€å’Œè¾¹ç•Œå¯¹ã€‚ç„¶åï¼Œç¡¬ä»¶å°†å…¶ä¸­çš„ç‰©ç†åœ°å€ä¸ VPN è¿›è¡Œå¦‚ä¸‹ç»„åˆï¼Œå½¢æˆé¡µè¡¨é¡¹ (PTE) çš„åœ°å€ï¼š SN = (VirtualAddress \u0026 SEG_MASK) \u003e\u003e SN_SHIFT VPN = (VirtualAddress \u0026 VPN_MASK) \u003e\u003e VPN_SHIFT AddressOfPTE = Base[SN] + (VPN * sizeof(PTE)) è¿™ä¸ªåºåˆ—çœ‹èµ·æ¥åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼›å®ƒå®é™…ä¸Šä¸æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„çº¿æ€§é¡µè¡¨ç›¸åŒã€‚å½“ç„¶ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ä½¿ç”¨ä¸‰ä¸ªæ®µåŸºå€å¯„å­˜å™¨ä¹‹ä¸€è€Œä¸æ˜¯å•é¡µè¡¨åŸºå€å¯„å­˜å™¨ã€‚ æˆ‘ä»¬çš„æ··åˆæ–¹æ¡ˆçš„å…³é”®åŒºåˆ«æ˜¯æ¯ä¸ªæ®µéƒ½å­˜åœ¨ä¸€ä¸ªè¾¹ç•Œå¯„å­˜å™¨ï¼›æ¯ä¸ªè¾¹ç•Œå¯„å­˜å™¨ä¿å­˜æ®µä¸­æœ€å¤§æœ‰æ•ˆé¡µçš„å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä»£ç æ®µæ­£åœ¨ä½¿ç”¨å…¶å‰ä¸‰é¡µï¼ˆ0ã€1 å’Œ 2ï¼‰ï¼Œåˆ™ä»£ç æ®µé¡µè¡¨å°†ä»…åˆ†é…æœ‰ä¸‰ä¸ªæ¡ç›®ï¼Œå¹¶ä¸”è¾¹ç•Œå¯„å­˜å™¨å°†è®¾ç½®ä¸º 3ï¼›è¶…å‡ºæ®µæœ«å°¾çš„å†…å­˜è®¿é—®å°†ç”Ÿæˆå¼‚å¸¸ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿›ç¨‹ç»ˆæ­¢ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸çº¿æ€§é¡µè¡¨ç›¸æ¯”ï¼Œæˆ‘ä»¬çš„æ··åˆæ–¹æ³•å®ç°äº†æ˜¾è‘—çš„å†…å­˜èŠ‚çœï¼›æ ˆå’Œå †ä¹‹é—´æœªåˆ†é…çš„é¡µé¢ä¸å†å ç”¨é¡µè¡¨ä¸­çš„ç©ºé—´ï¼ˆåªæ˜¯å°†å®ƒä»¬æ ‡è®°ä¸ºæ— æ•ˆï¼‰ã€‚ ç„¶è€Œï¼Œæ­£å¦‚æ‚¨å¯èƒ½æ³¨æ„åˆ°çš„ï¼Œè¿™ç§æ–¹æ³•å¹¶éæ²¡æœ‰é—®é¢˜ã€‚é¦–å…ˆï¼Œå®ƒä»ç„¶éœ€è¦æˆ‘ä»¬ä½¿ç”¨åˆ†æ®µï¼›æ­£å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ï¼Œåˆ†æ®µå¹¶ä¸åƒæˆ‘ä»¬å¸Œæœ›çš„é‚£ä¹ˆçµæ´»ï¼Œå› ä¸ºå®ƒå‡è®¾åœ°å€ç©ºé—´æœ‰æŸç§ä½¿ç”¨æ¨¡å¼ï¼›ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå¤§ä½†å¾ˆå°‘ä½¿ç”¨çš„å †ï¼Œæˆ‘ä»¬ä»ç„¶å¯èƒ½ä¼šäº§ç”Ÿå¤§é‡é¡µè¡¨æµªè´¹ã€‚å…¶æ¬¡ï¼Œè¿™ç§æ··åˆå¯¼è‡´å¤–éƒ¨ç¢ç‰‡å†æ¬¡å‡ºç°ã€‚è™½ç„¶å¤§å¤šæ•°å†…å­˜éƒ½æ˜¯ä»¥é¡µå¤§å°ä¸ºå•ä½è¿›è¡Œç®¡ç†çš„ï¼Œä½†é¡µè¡¨ç°åœ¨å¯ä»¥æ˜¯ä»»æ„å¤§å°ï¼ˆPTE çš„å€æ•°ï¼‰ã€‚å› æ­¤ï¼Œåœ¨å†…å­˜ä¸­ä¸ºå®ƒä»¬æ‰¾åˆ°å¯ç”¨ç©ºé—´æ›´åŠ å¤æ‚ã€‚ç”±äºè¿™äº›åŸå› ï¼Œäººä»¬ä¸æ–­å¯»æ‰¾æ›´å¥½çš„æ–¹æ³•æ¥å®ç°æ›´å°çš„é¡µè¡¨ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:2:0","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 å¤šçº§é¡µè¡¨ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:3:0","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 ä»‹ç» å¦ä¸€ç§æ–¹æ³•ä¸ä¾èµ–äºåˆ†æ®µï¼Œä½†è§£å†³äº†åŒæ ·çš„é—®é¢˜ï¼šå¦‚ä½•æ‘†è„±é¡µè¡¨ä¸­çš„æ‰€æœ‰æ— æ•ˆåŒºåŸŸï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬å…¨éƒ¨ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Ÿæˆ‘ä»¬å°†è¿™ç§æ–¹æ³•ç§°ä¸ºå¤šçº§é¡µè¡¨ï¼Œå› ä¸ºå®ƒå°†çº¿æ€§é¡µè¡¨å˜æˆäº†ç±»ä¼¼æ ‘çš„ä¸œè¥¿ã€‚è¿™ç§æ–¹æ³•éå¸¸æœ‰æ•ˆï¼Œä»¥è‡³äºè®¸å¤šç°ä»£ç³»ç»Ÿéƒ½é‡‡ç”¨å®ƒï¼ˆä¾‹å¦‚ x86 [BOH10]ï¼‰ã€‚æˆ‘ä»¬ç°åœ¨è¯¦ç»†æè¿°è¿™ç§æ–¹æ³•ã€‚ å¤šçº§é¡µè¡¨èƒŒåçš„åŸºæœ¬æ€æƒ³å¾ˆç®€å•ã€‚é¦–å…ˆï¼Œå°†é¡µè¡¨åˆ‡åˆ†æˆé¡µå¤§å°çš„å•å…ƒï¼›ç„¶åï¼Œå¦‚æœé¡µè¡¨æ¡ç›® (PTE) çš„æ•´ä¸ªé¡µæ— æ•ˆï¼Œåˆ™æ ¹æœ¬ä¸åˆ†é…é¡µè¡¨çš„è¯¥é¡µã€‚è¦è·Ÿè¸ªé¡µè¡¨çš„é¡µé¢æ˜¯å¦æœ‰æ•ˆï¼ˆä»¥åŠå¦‚æœæœ‰æ•ˆï¼Œåˆ™å®ƒåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼‰ï¼Œåˆ™ä½¿ç”¨ç§°ä¸ºé¡µç›®å½•çš„æ–°ç»“æ„ã€‚å› æ­¤ï¼Œé¡µç›®å½•å¯ä»¥ç”¨æ¥å‘Šè¯‰æ‚¨é¡µè¡¨çš„æŸä¸ªé¡µåœ¨å“ªé‡Œï¼Œæˆ–è€…é¡µè¡¨çš„æ•´ä¸ªé¡µä¸åŒ…å«æœ‰æ•ˆé¡µã€‚ ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªç¤ºä¾‹ã€‚å›¾å·¦è¾¹æ˜¯ç»å…¸çš„çº¿æ€§é¡µè¡¨ï¼›å³ä½¿åœ°å€ç©ºé—´çš„å¤§å¤šæ•°ä¸­é—´åŒºåŸŸæ— æ•ˆï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¸ºè¿™äº›åŒºåŸŸåˆ†é…é¡µè¡¨ç©ºé—´ï¼ˆå³é¡µè¡¨çš„ä¸­é—´ä¸¤é¡µï¼‰ã€‚å³è¾¹æ˜¯å¤šçº§é¡µè¡¨ã€‚é¡µç›®å½•ä»…å°†é¡µè¡¨çš„ä¸¤é¡µæ ‡è®°ä¸ºæœ‰æ•ˆï¼ˆç¬¬ä¸€é¡µå’Œæœ€åä¸€é¡µï¼‰ï¼›å› æ­¤ï¼Œåªæœ‰é¡µè¡¨çš„é‚£ä¸¤é¡µé©»ç•™åœ¨å†…å­˜ä¸­ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ä¸€ç§å¯è§†åŒ–å¤šçº§è¡¨æ­£åœ¨æ‰§è¡Œçš„æ“ä½œçš„æ–¹æ³•ï¼šå®ƒåªæ˜¯ä½¿éƒ¨åˆ†çº¿æ€§é¡µè¡¨æ¶ˆå¤±ï¼ˆé‡Šæ”¾è¿™äº›é¡µä»¥ä¾›å…¶ä»–ç”¨é€”ï¼‰ï¼Œå¹¶è·Ÿè¸ªé¡µè¡¨çš„å“ªäº›é¡µåˆ†é…äº†è¯¥é¡µç›®å½•ã€‚ é¡µç›®å½•åœ¨ä¸€ä¸ªç®€å•çš„ä¸¤çº§è¡¨ä¸­ï¼Œé¡µè¡¨çš„æ¯ä¸€é¡µåŒ…å«ä¸€ä¸ªæ¡ç›®ã€‚å®ƒç”±è®¸å¤šé¡µç›®å½•é¡¹ï¼ˆPDEï¼‰ç»„æˆã€‚ PDEï¼ˆè‡³å°‘ï¼‰å…·æœ‰æœ‰æ•ˆä½å’Œç‰©ç†é¡µæ¡†å· (PFN)ï¼Œä¸ PTE ç±»ä¼¼ã€‚ç„¶è€Œï¼Œæ­£å¦‚ä¸Šé¢æ‰€æš—ç¤ºçš„ï¼Œè¯¥æœ‰æ•ˆä½çš„å«ä¹‰ç•¥æœ‰ä¸åŒï¼šå¦‚æœ PDE æœ‰æ•ˆï¼Œåˆ™æ„å‘³ç€è¯¥æ¡ç›®ï¼ˆé€šè¿‡ PFNï¼‰æŒ‡å‘çš„é¡µè¡¨ä¸­çš„è‡³å°‘ä¸€é¡µæ˜¯æœ‰æ•ˆçš„ï¼Œå³ï¼Œåœ¨è¯¥PDEæŒ‡å‘çš„è¯¥é¡µä¸Šçš„è‡³å°‘ä¸€ä¸ªPTEä¸­ï¼Œè¯¥PTEä¸­çš„æœ‰æ•ˆä½è¢«è®¾ç½®ä¸º1ã€‚å¦‚æœ PDE æ— æ•ˆï¼ˆå³ç­‰äº 0ï¼‰ï¼Œåˆ™ PDE çš„å…¶ä½™éƒ¨åˆ†æœªå®šä¹‰ã€‚ ä¸æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢çœ‹åˆ°çš„æ–¹æ³•ç›¸æ¯”ï¼Œå¤šçº§é¡µè¡¨å…·æœ‰ä¸€äº›æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚é¦–å…ˆï¼Œä¹Ÿè®¸æœ€æ˜æ˜¾çš„æ˜¯ï¼Œå¤šçº§è¡¨ä»…æ ¹æ®æ‚¨æ­£åœ¨ä½¿ç”¨çš„åœ°å€ç©ºé—´é‡æŒ‰æ¯”ä¾‹åˆ†é…é¡µè¡¨ç©ºé—´ï¼›å› æ­¤å®ƒé€šå¸¸æ˜¯ç´§å‡‘çš„å¹¶ä¸”æ”¯æŒç¨€ç–åœ°å€ç©ºé—´ã€‚ å…¶æ¬¡ï¼Œå¦‚æœç²¾å¿ƒæ„å»ºï¼Œé¡µè¡¨çš„æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥æ•´é½åœ°å®¹çº³åœ¨ä¸€ä¸ªé¡µé¢ä¸­ï¼Œä»è€Œæ›´å®¹æ˜“ç®¡ç†å†…å­˜ï¼›å½“æ“ä½œç³»ç»Ÿéœ€è¦åˆ†é…æˆ–å¢é•¿é¡µè¡¨æ—¶ï¼Œå®ƒå¯ä»¥ç®€å•åœ°è·å–ä¸‹ä¸€ä¸ªç©ºé—²é¡µé¢ã€‚å°†æ­¤ä¸ç®€å•ï¼ˆéåˆ†é¡µï¼‰çº¿æ€§é¡µè¡¨ è¿›è¡Œå¯¹æ¯”ï¼Œåè€…åªæ˜¯ç”± VPN ç´¢å¼•çš„ PTE æ•°ç»„ï¼›é‡‡ç”¨è¿™æ ·çš„ç»“æ„ï¼Œæ•´ä¸ªçº¿æ€§é¡µè¡¨å¿…é¡»è¿ç»­åœ°é©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚å¯¹äºå¤§é¡µè¡¨ï¼ˆä¾‹å¦‚ 4MBï¼‰ï¼Œæ‰¾åˆ°è¿™ä¹ˆå¤§å—æœªä½¿ç”¨çš„è¿ç»­ç©ºé—²ç‰©ç†å†…å­˜å¯èƒ½æ˜¯ä¸€ä¸ªç›¸å½“å¤§çš„æŒ‘æˆ˜ã€‚å¯¹äºå¤šçº§ç»“æ„ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨é¡µç›®å½•æ¥æ·»åŠ é—´æ¥å±‚ï¼Œé¡µç›®å½•æŒ‡å‘é¡µè¡¨çš„å„ä¸ªéƒ¨åˆ†ï¼›è¿™ç§é—´æ¥å…è®¸æˆ‘ä»¬å°†é¡µè¡¨é¡µé¢æ”¾ç½®åœ¨ç‰©ç†å†…å­˜ä¸­çš„ä»»ä½•ä½ç½®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¤šçº§è¡¨æ˜¯æœ‰æˆæœ¬çš„ï¼›å¦‚æœ TLB æœªå‘½ä¸­ï¼Œåˆ™éœ€è¦ä»å†…å­˜åŠ è½½ä¸¤æ¬¡æ‰èƒ½ä»é¡µè¡¨è·å–æ­£ç¡®çš„è½¬æ¢ä¿¡æ¯ï¼ˆä¸€æ¬¡ç”¨äºé¡µç›®å½•ï¼Œä¸€æ¬¡ç”¨äº PTE æœ¬èº«ï¼‰ï¼Œè€Œçº¿æ€§é¡µè¡¨åªéœ€åŠ è½½ä¸€æ¬¡ã€‚å› æ­¤ï¼Œå¤šçº§è¡¨æ˜¯æ—¶ç©ºæƒè¡¡çš„ä¸€ä¸ªå°ä¾‹å­ã€‚æˆ‘ä»¬æƒ³è¦æ›´å°çš„è¡¨ï¼ˆå¹¶ä¸”å¾—åˆ°äº†ï¼‰ï¼Œä½†ä¸æ˜¯å…è´¹çš„ï¼›è™½ç„¶åœ¨å¸¸è§æƒ…å†µä¸‹ï¼ˆTLB å‘½ä¸­ï¼‰ï¼Œæ€§èƒ½æ˜¾ç„¶æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å¯¹äºè¿™ä¸ªè¾ƒå°çš„è¡¨ï¼ŒTLB æœªå‘½ä¸­ä¼šé­å—æ›´é«˜çš„æˆæœ¬ã€‚ å¦ä¸€ä¸ªæ˜æ˜¾çš„è´Ÿé¢å› ç´ æ˜¯å¤æ‚æ€§ã€‚æ— è®ºæ˜¯ç¡¬ä»¶è¿˜æ˜¯æ“ä½œç³»ç»Ÿå¤„ç†é¡µè¡¨æŸ¥æ‰¾ï¼ˆåœ¨ TLB æœªå‘½ä¸­æ—¶ï¼‰ï¼Œè¿™æ ·åšæ— ç–‘æ¯”ç®€å•çš„çº¿æ€§é¡µè¡¨æŸ¥æ‰¾æ›´å¤æ‚ã€‚é€šå¸¸æˆ‘ä»¬æ„¿æ„å¢åŠ å¤æ‚æ€§ä»¥æé«˜æ€§èƒ½æˆ–å‡å°‘å¼€é”€ï¼›å¯¹äºå¤šçº§è¡¨ï¼Œæˆ‘ä»¬ä½¿é¡µè¡¨æŸ¥æ‰¾æ›´åŠ å¤æ‚ï¼Œä»¥èŠ‚çœå®è´µçš„å†…å­˜ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:3:1","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 å¤šçº§é¡µè¡¨ç¤ºä¾‹ ä¸ºäº†æ›´å¥½åœ°ç†è§£å¤šçº§é¡µè¡¨èƒŒåçš„æƒ³æ³•ï¼Œè®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ã€‚æƒ³è±¡ä¸€ä¸ªå¤§å°ä¸º 16KBã€å…·æœ‰ 64 å­—èŠ‚é¡µé¢çš„å°åœ°å€ç©ºé—´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª 14 ä½è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå…¶ä¸­ 8 ä½ç”¨äº VPNï¼Œ6 ä½ç”¨äºåç§»é‡ã€‚å³ä½¿ä»…ä½¿ç”¨ä¸€å°éƒ¨åˆ†åœ°å€ç©ºé—´ï¼Œçº¿æ€§é¡µè¡¨ä¹Ÿå°†å…·æœ‰ $2^8$ (256) ä¸ªæ¡ç›®ã€‚ä¸‹å›¾å±•ç¤ºäº†æ­¤ç±»åœ°å€ç©ºé—´çš„ä¸€ä¸ªç¤ºä¾‹ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œè™šæ‹Ÿé¡µ 0 å’Œ 1 ç”¨äºä»£ç ï¼Œè™šæ‹Ÿé¡µ 4 å’Œ 5 ç”¨äºå †ï¼Œè™šæ‹Ÿé¡µ 254 å’Œ 255 ç”¨äºå †æ ˆï¼›åœ°å€ç©ºé—´çš„å…¶ä½™é¡µé¢æœªä½¿ç”¨ã€‚ ä¸ºäº†ä¸ºæ­¤åœ°å€ç©ºé—´æ„å»ºä¸¤çº§é¡µè¡¨ï¼Œæˆ‘ä»¬ä»å®Œæ•´çš„çº¿æ€§é¡µè¡¨å¼€å§‹ï¼Œå¹¶å°†å…¶åˆ†è§£ä¸ºé¡µé¢å¤§å°çš„å•å…ƒã€‚å›æƒ³ä¸€ä¸‹æˆ‘ä»¬çš„å®Œæ•´è¡¨ï¼ˆåœ¨æœ¬ä¾‹ä¸­ï¼‰æœ‰ 256 ä¸ªæ¡ç›®ï¼›å‡è®¾æ¯ä¸ª PTE çš„å¤§å°ä¸º 4 å­—èŠ‚ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„é¡µè¡¨å¤§å°ä¸º 1KBï¼ˆ256 Ã— 4 å­—èŠ‚ï¼‰ã€‚å‡è®¾æˆ‘ä»¬æœ‰64å­—èŠ‚çš„é¡µé¢ï¼Œé‚£ä¹ˆ1KBçš„é¡µè¡¨å¯ä»¥åˆ†ä¸º16ä¸ª64å­—èŠ‚çš„é¡µé¢ï¼›æ¯é¡µå¯å®¹çº³ 16 ä¸ª PTEã€‚ æˆ‘ä»¬ç°åœ¨éœ€è¦äº†è§£çš„æ˜¯å¦‚ä½•ä½¿ç”¨VPNå¹¶ä½¿ç”¨å®ƒé¦–å…ˆç´¢å¼•åˆ°é¡µç›®å½•ï¼Œç„¶åç´¢å¼•åˆ°é¡µè¡¨çš„é¡µé¢ã€‚è¯·è®°ä½ï¼Œæ¯ä¸ªéƒ½æ˜¯ä¸€ä¸ªæ¡ç›®æ•°ç»„ï¼›å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šçš„æ˜¯å¦‚ä½•ä¸º VPN çš„æ¯ä¸ªéƒ¨åˆ†æ„å»ºç´¢å¼•ã€‚ è®©æˆ‘ä»¬é¦–å…ˆç´¢å¼•åˆ°é¡µé¢ç›®å½•ã€‚æœ¬ä¾‹ä¸­çš„é¡µè¡¨å¾ˆå°ï¼š256 ä¸ªæ¡ç›®ï¼Œåˆ†å¸ƒåœ¨ 16 ä¸ªé¡µé¢ä¸Šã€‚é¡µç›®å½•éœ€è¦é¡µè¡¨çš„æ¯ä¸€é¡µä¸€ä¸ªæ¡ç›®ï¼›å› æ­¤ï¼Œå®ƒæœ‰ 16 ä¸ªæ¡ç›®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ VPN çš„å››ä½æ¥ç´¢å¼•ç›®å½•ï¼›æˆ‘ä»¬ä½¿ç”¨VPNçš„å‰å››ä½ï¼Œå¦‚ä¸‹ï¼š ä¸€æ—¦æˆ‘ä»¬ä»VPNä¸­æå–å‡ºé¡µç›®å½•ç´¢å¼•ï¼ˆç®€ç§°PDIndexï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç®€å•çš„è®¡ç®—æ¥æ‰¾åˆ°é¡µç›®å½•æ¡ç›®ï¼ˆPDEï¼‰çš„åœ°å€ï¼š PDEAddr = PageDirBase + (PDIndex * sizeof(PDE) ï¼‰ã€‚è¿™å°±äº§ç”Ÿäº†æˆ‘ä»¬çš„é¡µé¢ç›®å½•ï¼Œç°åœ¨æˆ‘ä»¬å¯¹å…¶è¿›è¡Œç ”ç©¶ï¼Œä»¥è¿›ä¸€æ­¥æ¨è¿›æˆ‘ä»¬çš„è½¬æ¢å·¥ä½œ å¦‚æœé¡µç›®å½•æ¡ç›®è¢«æ ‡è®°ä¸ºæ— æ•ˆï¼Œæˆ‘ä»¬å°±çŸ¥é“è®¿é—®æ— æ•ˆï¼Œä»è€Œå¼•å‘å¼‚å¸¸ã€‚ç„¶è€Œï¼Œå¦‚æœPDEæœ‰æ•ˆï¼Œæˆ‘ä»¬è¿˜æœ‰æ›´å¤šå·¥ä½œè¦åšã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ç°åœ¨å¿…é¡»ä»è¯¥é¡µç›®å½•é¡¹æŒ‡å‘çš„é¡µè¡¨é¡µä¸­è·å–é¡µè¡¨é¡¹ï¼ˆPTEï¼‰ã€‚ä¸ºäº†æ‰¾åˆ°è¿™ä¸ª PTEï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ VPN çš„å‰©ä½™ä½æ¥ç´¢å¼•é¡µè¡¨çš„éƒ¨åˆ†ï¼š ç„¶åå¯ä»¥ä½¿ç”¨æ­¤é¡µè¡¨ç´¢å¼•ï¼ˆç®€ç§° PTIndexï¼‰å¯¹é¡µè¡¨æœ¬èº«è¿›è¡Œç´¢å¼•ï¼Œä»è€Œä¸ºæˆ‘ä»¬æä¾› PTE çš„åœ°å€ï¼š PTEAddr = (PDE.PFN \u003c\u003c SHIFT) + (PTIndex * sizeof(PTE)) è¯·æ³¨æ„ï¼Œä»é¡µç›®å½•é¡¹è·å¾—çš„ç‰©ç†é¡µæ¡†å· (PFN) å¿…é¡»å…ˆå·¦ç§»åˆ°ä½ï¼Œç„¶åæ‰èƒ½ä¸é¡µè¡¨ç´¢å¼•ç»„åˆä»¥å½¢æˆ PTE çš„åœ°å€ã€‚ä¸ºäº†çœ‹çœ‹è¿™ä¸€åˆ‡æ˜¯å¦æœ‰æ„ä¹‰ï¼Œæˆ‘ä»¬ç°åœ¨å°†ç”¨ä¸€äº›å®é™…å€¼å¡«å……å¤šçº§é¡µè¡¨ï¼Œå¹¶è½¬æ¢å•ä¸ªè™šæ‹Ÿåœ°å€ã€‚è®©æˆ‘ä»¬ä»æœ¬ä¾‹çš„é¡µé¢ç›®å½•å¼€å§‹ï¼ˆå¦‚ä¸‹å›¾å·¦ä¾§ï¼‰ã€‚ åœ¨å›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ¯ä¸ªé¡µç›®å½•é¡¹ (PDE) æè¿°äº†æœ‰å…³åœ°å€ç©ºé—´é¡µè¡¨ä¸­çš„ä¸€é¡µçš„ä¿¡æ¯ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨åœ°å€ç©ºé—´ä¸­æœ‰ä¸¤ä¸ªæœ‰æ•ˆåŒºåŸŸï¼ˆä½äºå¼€å¤´å’Œç»“å°¾ï¼‰ï¼Œä»¥åŠä¸­é—´çš„è®¸å¤šæ— æ•ˆæ˜ å°„ã€‚åœ¨ç‰©ç†é¡µ100ï¼ˆé¡µè¡¨ç¬¬0é¡µçš„ç‰©ç†å¸§å·ï¼‰ä¸­ï¼Œæˆ‘ä»¬æœ‰åœ°å€ç©ºé—´ä¸­å‰16ä¸ªVPNçš„16ä¸ªé¡µè¡¨æ¡ç›®çš„ç¬¬ä¸€é¡µã€‚è¿™éƒ¨åˆ†é¡µè¡¨çš„å†…å®¹è§ä¸Šå›¾ï¼ˆä¸­é—´éƒ¨åˆ†ï¼‰ã€‚ é¡µè¡¨çš„è¯¥é¡µåŒ…å«å‰ 16 ä¸ª VPN çš„æ˜ å°„ï¼›åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒVPN 0 å’Œ 1 æœ‰æ•ˆï¼ˆä»£ç æ®µï¼‰ï¼Œ4 å’Œ 5ï¼ˆå †ï¼‰ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚å› æ­¤ï¼Œè¯¥è¡¨å…·æœ‰æ¯ä¸ªé¡µé¢çš„æ˜ å°„ä¿¡æ¯ã€‚å…¶ä½™æ¡ç›®è¢«æ ‡è®°ä¸ºæ— æ•ˆã€‚ é¡µè¡¨çš„å¦ä¸€ä¸ªæœ‰æ•ˆé¡µä½äº PFN 101 å†…ã€‚è¯¥é¡µåŒ…å«åœ°å€ç©ºé—´æœ€å 16 ä¸ª VPN çš„æ˜ å°„ï¼›å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ˆå³ï¼‰ã€‚ åœ¨ç¤ºä¾‹ä¸­ï¼ŒVPN 254 å’Œ 255ï¼ˆå †æ ˆï¼‰å…·æœ‰æœ‰æ•ˆæ˜ å°„ã€‚å¸Œæœ›æˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ªç¤ºä¾‹ä¸­çœ‹åˆ°ï¼Œä½¿ç”¨å¤šçº§ç´¢å¼•ç»“æ„å¯ä»¥èŠ‚çœå¤šå°‘ç©ºé—´ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸ºçº¿æ€§é¡µè¡¨åˆ†é…å®Œæ•´çš„ 16 ä¸ªé¡µé¢ï¼Œè€Œæ˜¯ä»…åˆ†é…ä¸‰ä¸ªé¡µé¢ï¼šä¸€ä¸ªç”¨äºé¡µç›®å½•ï¼Œä¸¤ä¸ªç”¨äºå…·æœ‰æœ‰æ•ˆæ˜ å°„çš„é¡µè¡¨å—ã€‚å¯¹äºå¤§å‹ï¼ˆ32 ä½æˆ– 64 ä½ï¼‰åœ°å€ç©ºé—´æ¥è¯´ï¼ŒèŠ‚çœçš„æˆæœ¬æ˜¾ç„¶è¦å¤§å¾—å¤šã€‚ æœ€åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥æ‰§è¡Œè½¬æ¢ã€‚è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨ VPN 254 ç¬¬ 0 ä¸ªå­—èŠ‚çš„åœ°å€ï¼š0x3F80ï¼Œæˆ–äºŒè¿›åˆ¶çš„ 11 1111 1000 0000ã€‚ å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ VPN çš„å‰ 4 ä½æ¥ç´¢å¼•é¡µé¢ç›®å½•ã€‚å› æ­¤ï¼Œ1111 å°†é€‰æ‹©ä¸Šé¢é¡µç›®å½•çš„æœ€åä¸€ä¸ªï¼ˆå¦‚æœä»ç¬¬ 0 ä¸ªå¼€å§‹ï¼Œåˆ™ä¸ºç¬¬ 15 ä¸ªï¼‰æ¡ç›®ã€‚è¿™å°†æˆ‘ä»¬æŒ‡å‘ä½äºåœ°å€ 101 çš„é¡µè¡¨çš„æœ‰æ•ˆé¡µé¢ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ VPN (1110) çš„æ¥ä¸‹æ¥ 4 ä½æ¥ç´¢å¼•é¡µè¡¨çš„è¯¥é¡µé¢å¹¶æ‰¾åˆ°æ‰€éœ€çš„ PTEã€‚ 1110 æ˜¯é¡µé¢ä¸Šçš„å€’æ•°ç¬¬äºŒä¸ªï¼ˆç¬¬ 14 ä¸ªï¼‰æ¡ç›®ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬è™šæ‹Ÿåœ°å€ç©ºé—´çš„ç¬¬ 254 é¡µæ˜ å°„åˆ°ç‰©ç†é¡µ 55ã€‚é€šè¿‡å°† PFN=55ï¼ˆæˆ–åå…­è¿›åˆ¶ 0x37ï¼‰ä¸ offset=000000 è¿æ¥ï¼Œæˆ‘ä»¬å› æ­¤å¯ä»¥å½¢æˆæˆ‘ä»¬æƒ³è¦çš„ç‰©ç†åœ°å€å¹¶å‘å†…å­˜ç³»ç»Ÿå‘å‡ºè¯·æ±‚ï¼šPhysAddr = (PTE.PFN \u003c\u003c SHIFT) + offset = 00 1101 1100 0000 = 0x0DC0ã€‚æ‚¨ç°åœ¨åº”è¯¥äº†è§£å¦‚ä½•ä½¿ç”¨æŒ‡å‘é¡µè¡¨é¡µé¢çš„é¡µç›®å½•æ¥æ„é€ ä¸¤çº§é¡µè¡¨ã€‚ç„¶è€Œä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬çš„å·¥ä½œè¿˜æ²¡æœ‰å®Œæˆã€‚æ­£å¦‚æˆ‘ä»¬ç°åœ¨å°†è®¨è®ºçš„ï¼Œæœ‰æ—¶ä¸¤çº§é¡µè¡¨æ˜¯ä¸å¤Ÿçš„ï¼ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:3:2","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 ä¸æ­¢ä¸¤çº§ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å‡è®¾å¤šçº§é¡µè¡¨åªæœ‰ä¸¤ä¸ªçº§åˆ«ï¼šé¡µç›®å½•ï¼Œç„¶åæ˜¯é¡µè¡¨çš„å„ä¸ªéƒ¨åˆ†ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ›´æ·±çš„æ ‘æ˜¯å¯èƒ½çš„ï¼ˆè€Œä¸”ç¡®å®æ˜¯éœ€è¦çš„ï¼‰ã€‚ è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¹¶ç”¨å®ƒæ¥è¯´æ˜ä¸ºä»€ä¹ˆæ›´æ·±çš„å¤šçº§è¡¨ä¼šå¾ˆæœ‰ç”¨ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª 30 ä½è™šæ‹Ÿåœ°å€ç©ºé—´å’Œä¸€ä¸ªå°ï¼ˆ512 å­—èŠ‚ï¼‰é¡µé¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„è™šæ‹Ÿåœ°å€æœ‰ä¸€ä¸ª 21 ä½è™šæ‹Ÿé¡µå·ç»„ä»¶å’Œä¸€ä¸ª 9 ä½åç§»é‡ã€‚ è¯·è®°ä½æˆ‘ä»¬æ„å»ºå¤šçº§é¡µè¡¨çš„ç›®æ ‡ï¼šä½¿é¡µè¡¨çš„æ¯ä¸€éƒ¨åˆ†éƒ½é€‚åˆå•ä¸ªé¡µé¢ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªè€ƒè™‘äº†é¡µè¡¨æœ¬èº«ï¼›ä½†æ˜¯ï¼Œå¦‚æœé¡µé¢ç›®å½•å˜å¾—å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ ä¸ºäº†ç¡®å®šå¤šçº§è¡¨ä¸­éœ€è¦å¤šå°‘çº§æ‰èƒ½ä½¿é¡µè¡¨çš„æ‰€æœ‰éƒ¨åˆ†éƒ½é€‚åˆä¸€ä¸ªé¡µé¢ï¼Œæˆ‘ä»¬é¦–å…ˆç¡®å®šä¸€ä¸ªé¡µé¢é€‚åˆå¤šå°‘ä¸ªé¡µè¡¨æ¡ç›®ã€‚é‰´äºæˆ‘ä»¬çš„é¡µé¢å¤§å°ä¸º 512 å­—èŠ‚ï¼Œå¹¶å‡è®¾ PTE å¤§å°ä¸º 4 å­—èŠ‚ï¼Œæ‚¨åº”è¯¥ä¼šå‘ç°å•ä¸ªé¡µé¢ä¸Šå¯ä»¥å®¹çº³ 128 ä¸ª PTEã€‚å½“æˆ‘ä»¬å¯¹é¡µè¡¨çš„æŸä¸ªé¡µé¢è¿›è¡Œç´¢å¼•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæˆ‘ä»¬éœ€è¦ VPN çš„æœ€ä½æœ‰æ•ˆ 7 ä½ ($\\log _2{128}$) ä½œä¸ºç´¢å¼•ï¼š ä»ä¸Šå›¾ä¸­æ‚¨è¿˜å¯èƒ½æ³¨æ„åˆ°ï¼Œï¼ˆå¤§ï¼‰é¡µç›®å½•ä¸­è¿˜å‰©ä¸‹å¤šå°‘ä½ï¼š 14ã€‚å¦‚æœæˆ‘ä»¬çš„é¡µç›®å½•æœ‰ $2^{14}$ä¸ªæ¡ç›®ï¼Œé‚£ä¹ˆå®ƒè·¨è¶Šçš„ä¸æ˜¯ä¸€é¡µè€Œæ˜¯ 128ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°†å¤šçº§é¡µè¡¨çš„æ¯ä¸€éƒ¨åˆ†éƒ½æ”¾å…¥ä¸€ä¸ªé¡µé¢çš„ç›®æ ‡å°±æ¶ˆå¤±äº†ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡å°†é¡µé¢ç›®å½•æœ¬èº«æ‹†åˆ†ä¸ºå¤šä¸ªé¡µé¢æ¥æ„å»ºæ ‘çš„æ›´é«˜çº§åˆ«ï¼Œç„¶ååœ¨å…¶é¡¶éƒ¨æ·»åŠ å¦ä¸€ä¸ªé¡µé¢ç›®å½•ï¼Œä»¥æŒ‡å‘é¡µé¢ç›®å½•çš„é¡µé¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†è™šæ‹Ÿåœ°å€æ‹†åˆ†å¦‚ä¸‹ï¼š ç°åœ¨ï¼Œåœ¨ç´¢å¼•ä¸Šå±‚é¡µé¢ç›®å½•æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨è™šæ‹Ÿåœ°å€çš„æœ€é¡¶å±‚ä½ï¼ˆå›¾ä¸­çš„ PD ç´¢å¼• 0ï¼‰ï¼›è¯¥ç´¢å¼•å¯ç”¨äºä»ä¸Šå±‚é¡µé¢ç›®å½•ä¸­è·å–é¡µé¢ç›®å½•æ¡ç›®ã€‚å¦‚æœæœ‰æ•ˆï¼Œåˆ™ç»“åˆé¡¶å±‚ PDE çš„ç‰©ç†é¡µå·å’Œ VPN çš„ä¸‹ä¸€éƒ¨åˆ†ï¼ˆPD ç´¢å¼• 1)ï¼ŒæŸ¥è¯¢é¡µé¢ç›®å½•çš„ç¬¬äºŒå±‚ã€‚æœ€åï¼Œå¦‚æœæœ‰æ•ˆï¼Œå°±å¯ä»¥ä½¿ç”¨é¡µè¡¨ç´¢å¼•ä¸äºŒçº§ PDE ä¸­çš„åœ°å€ç›¸ç»“åˆï¼Œå½¢æˆ PTE åœ°å€ã€‚å•§å•§è¿™å¯æ˜¯ä¸ªå¤§å·¥ç¨‹ã€‚è€Œè¿™ä¸€åˆ‡ä»…ä»…æ˜¯ä¸ºäº†åœ¨å¤šçº§è¡¨ä¸­æŸ¥æ‰¾æŸä¸ªå†…å®¹ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:3:3","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 è½¬æ¢è¿‡ç¨‹ï¼šè®°ä½ TLB ä¸ºäº†æ€»ç»“ä½¿ç”¨äºŒçº§é¡µè¡¨è¿›è¡Œåœ°å€è½¬æ¢çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å†æ¬¡ä»¥ç®—æ³•å½¢å¼å‘ˆç°æ§åˆ¶æµï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºã€‚ VPN = (VirtualAddress \u0026 VPN_MASK) \u003e\u003e SHIFT; (Success, TlbEntry) = TLB_Lookup(VPN); if (Success == True) { // TLB Hit if (CanAccess(TlbEntry.ProtectBits) == True) { Offset = VirtualAddress \u0026 OFFSET_MASK; PhysAddr = (TlbEntry.PFN \u003c\u003c SHIFT) | Offset; Register = AccessMemory(PhysAddr); } else { RaiseException(PROTECTION_FAULT); } } else { // TLB Miss // first, get page directory entry PDIndex = (VPN \u0026 PD_MASK) \u003e\u003e PD_SHIFT; PDEAddr = PDBR + (PDIndex * sizeof(PDE)); PDE = AccessMemory(PDEAddr); if (PDE.Valid == False) { RaiseException(SEGMENTATION_FAULT); } else { // PDE is valid: now fetch PTE from page table PTIndex = (VPN \u0026 PT_MASK) \u003e\u003e PT_SHIFT; PTEAddr = (PDE.PFN \u003c\u003c SHIFT) + (PTIndex * sizeof(PTE)); PTE = AccessMemory(PTEAddr); if (PTE.Valid == False) { RaiseException(SEGMENTATION_FAULT); } else if (CanAccess(PTE.ProtectBits) == False) { RaiseException(PROTECTION_FAULT); } else { TLB_Insert(VPN, PTE.PFN, PTE.ProtectBits); RetryInstruction(); } } } è¯¥æ®µä»£ç æ˜¾ç¤ºäº†æ¯æ¬¡å†…å­˜å¼•ç”¨æ—¶ç¡¬ä»¶ï¼ˆå‡è®¾æœ‰ç¡¬ä»¶ç®¡ç†çš„ TLBï¼‰ä¸­å‘ç”Ÿçš„æƒ…å†µã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨ä»»ä½•å¤æ‚çš„å¤šçº§é¡µè¡¨è®¿é—®å‘ç”Ÿä¹‹å‰ï¼Œç¡¬ä»¶é¦–å…ˆä¼šæ£€æŸ¥TLBï¼›ä¸€æ—¦å‘½ä¸­ï¼Œç‰©ç†åœ°å€å°±ç›´æ¥å½¢æˆï¼Œè€Œæ— éœ€åƒä»¥å‰ä¸€æ ·è®¿é—®é¡µè¡¨ã€‚ä»…å½“ TLB æœªå‘½ä¸­æ—¶ï¼Œç¡¬ä»¶æ‰éœ€è¦æ‰§è¡Œå®Œæ•´çš„å¤šçº§æŸ¥æ‰¾ã€‚åœ¨æ­¤è·¯å¾„ä¸Šï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ä¼ ç»Ÿä¸¤çº§é¡µè¡¨çš„æˆæœ¬ï¼šä¸¤æ¬¡é¢å¤–çš„å†…å­˜è®¿é—®æ¥æŸ¥æ‰¾æœ‰æ•ˆçš„è½¬æ¢ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:3:4","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.5 çœŸå®çš„å¤šçº§é¡µè¡¨ çœŸå®å¤šçº§é¡µé¢è¡¨ï¼ˆ$2^{48}$B=256TBï¼‰ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œçº¿æ€§åœ°å€çš„ç»“æ„åŒ…å«48ä½ï¼Œè¿™äº›ä½è¢«åˆ’åˆ†ä¸ºå‡ ä¸ªå…³é”®éƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†è´Ÿè´£æŒ‡å‘ä¸‹ä¸€çº§çš„å†…å­˜æ˜ å°„ç»“æ„æˆ–ç¡®å®šé¡µå†…çš„åç§»é‡ã€‚ PML4 (Page Map Level 4): çº¿æ€§åœ°å€çš„æœ€é«˜9ä½ï¼ˆä½39-47ï¼‰ç”¨äºç´¢å¼•PML4ï¼ˆPage Map Level 4ï¼‰è¡¨ã€‚PML4è¡¨æ˜¯ä¸€ä¸ªåŒ…å«ç€é¡µæ˜ å°„è¡¨æŒ‡é’ˆçš„æ•°ç»„ï¼Œæ¯ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªé¡µç›®å½•æŒ‡é’ˆè¡¨ï¼ˆPDPTï¼‰ã€‚ Directory Pointer (PDPT): æ¥ä¸‹æ¥çš„9ä½ï¼ˆä½30-38ï¼‰ç”¨äºåœ¨PDPTä¸­ç´¢å¼•ä¸€ä¸ªæ¡ç›®ï¼Œè¯¥æ¡ç›®æŒ‡å‘ä¸€ä¸ªé¡µç›®å½•ã€‚ Directory (PD): ç´§æ¥ç€çš„9ä½ï¼ˆä½21-29ï¼‰ç”¨äºåœ¨é¡µç›®å½•ä¸­ç´¢å¼•ä¸€ä¸ªæ¡ç›®ï¼Œè¯¥æ¡ç›®æŒ‡å‘ä¸€ä¸ªé¡µè¡¨ã€‚ Page Table (PT): å†ä¸‹æ¥çš„9ä½ï¼ˆä½12-20ï¼‰ç”¨äºåœ¨é¡µè¡¨ä¸­ç´¢å¼•ä¸€ä¸ªé¡µè¡¨é¡¹ï¼ˆPTEï¼‰ï¼Œè¯¥é¡µè¡¨é¡¹åŒ…å«äº†æœ€ç»ˆç‰©ç†é¡µé¢çš„åœ°å€ä¿¡æ¯ã€‚ Page Offset: æœ€åçš„12ä½ï¼ˆä½0-11ï¼‰æ˜¯é¡µå†…åç§»é‡ï¼Œç”¨äºç¡®å®šåœ¨ç‰©ç†é¡µé¢å†…çš„å…·ä½“åœ°å€ã€‚ é€šè¿‡è¿™ç§åˆ†å±‚çš„ç´¢å¼•æœºåˆ¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ä»çº¿æ€§åœ°å€ç”Ÿæˆå¯¹åº”çš„ç‰©ç†åœ°å€ï¼Œä»è€Œå…è®¸æ›´æœ‰æ•ˆåœ°ç®¡ç†å†…å­˜ï¼Œå¹¶å®ç°è¯¸å¦‚è™šæ‹Ÿå†…å­˜å’Œå†…å­˜ä¿æŠ¤ç­‰é«˜çº§åŠŸèƒ½ è‡ª2021å¹´èµ·ï¼ˆ$2^{56}$B=128PBï¼‰ ç›¸æ¯”ä¹‹å‰çš„48ä½çº¿æ€§åœ°å€ç»“æ„ï¼Œç°åœ¨çš„çº¿æ€§åœ°å€ç»“æ„åŒ…å«57ä½ï¼Œå¤šå‡ºäº†ä¸€ä¸ªPML5çº§åˆ«ï¼Œè¿™ä½¿å¾—é¡µè¡¨å±‚æ¬¡ç»“æ„æ›´åŠ æ·±å…¥ï¼Œä»è€Œèƒ½å¤Ÿç®¡ç†æ›´å¤§çš„åœ°å€ç©ºé—´ã€‚PML5 (Page Map Level 5): æ–°å¢çš„æœ€é«˜9ä½ï¼ˆä½48-56ï¼‰ç”¨äºç´¢å¼•PML5è¡¨ã€‚PML5è¡¨æ˜¯ä¸€ä¸ªåŒ…å«ç€é¡µæ˜ å°„è¡¨æŒ‡é’ˆçš„æ•°ç»„ï¼Œæ¯ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªPML4è¡¨ã€‚è¿™ä¸€çº§é¡µè¡¨çš„å­˜åœ¨å…è®¸ç³»ç»Ÿæ”¯æŒæ›´å¤§çš„ç‰©ç†å†…å­˜ï¼Œå› ä¸ºå®ƒå¢åŠ äº†åœ°å€è½¬æ¢çš„å±‚æ¬¡ï¼Œä½¿å¾—èƒ½å¤Ÿæ˜ å°„çš„åœ°å€ç©ºé—´æˆå€å¢é•¿ã€‚PML5çš„å¼•å…¥è¿›ä¸€æ­¥æ‰©å±•äº†è¿™ç§æœºåˆ¶ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿå¤„ç†æ›´å¤šçš„å†…å­˜ï¼Œè¿™å¯¹äºç°ä»£è®¡ç®—æœºç³»ç»Ÿå¤„ç†å¤§é‡æ•°æ®å’Œè¿è¡Œå¤§å‹åº”ç”¨ç¨‹åºæ˜¯éå¸¸é‡è¦çš„ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:3:5","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 åå‘é¡µè¡¨ åœ¨é¡µè¡¨çš„ä¸–ç•Œé‡Œï¼Œåå‘é¡µè¡¨å¯ä»¥èŠ‚çœæ›´å¤šçš„ç©ºé—´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦è®¸å¤šé¡µè¡¨ï¼ˆç³»ç»Ÿçš„æ¯ä¸ªè¿›ç¨‹ä¸€ä¸ªï¼‰ï¼Œè€Œåªéœ€ä¿å­˜ä¸€ä¸ªé¡µè¡¨ï¼Œè¯¥é¡µè¡¨ä¸ºç³»ç»Ÿçš„æ¯ä¸ªç‰©ç†é¡µæä¾›ä¸€ä¸ªæ¡ç›®ã€‚è¿™ä¸ªæ¡ç›®å‘Šè¯‰æˆ‘ä»¬å“ªä¸ªè¿›ç¨‹åœ¨ä½¿ç”¨è¿™ä¸ªé¡µé¢ï¼Œä»¥åŠè¯¥è¿›ç¨‹çš„å“ªä¸ªè™šæ‹Ÿé¡µé¢æ˜ å°„åˆ°è¿™ä¸ªç‰©ç†é¡µé¢ã€‚ è¦æ‰¾åˆ°æ­£ç¡®çš„æ¡ç›®ï¼Œåªéœ€åœ¨è¿™ä¸ªæ•°æ®ç»“æ„ä¸­è¿›è¡Œæœç´¢ã€‚çº¿æ€§æ‰«æçš„æˆæœ¬å¾ˆé«˜ï¼Œå› æ­¤é€šå¸¸ä¼šåœ¨åŸºç¡€ç»“æ„ä¸Šå»ºç«‹ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾é€Ÿåº¦ã€‚PowerPC å°±æ˜¯è¿™ç§æ¶æ„çš„ä¸€ä¸ªä¾‹å­ã€‚ æ›´å¹¿æ³›åœ°è¯´ï¼Œåå‘é¡µè¡¨è¯´æ˜äº†æˆ‘ä»¬ä»ä¸€å¼€å§‹å°±è¯´è¿‡çš„ï¼šé¡µè¡¨åªæ˜¯ä¸€ç§æ•°æ®ç»“æ„ã€‚ä½ å¯ä»¥ç”¨æ•°æ®ç»“æ„åšå¾ˆå¤šç–¯ç‹‚çš„äº‹æƒ…ï¼Œè®©å®ƒä»¬å˜å°æˆ–å˜å¤§ï¼Œå˜æ…¢æˆ–å˜å¿«ã€‚å¤šçº§é¡µè¡¨å’Œå€’è½¬é¡µè¡¨åªæ˜¯å…¶ä¸­çš„ä¸¤ä¸ªä¾‹å­ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:4:0","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 å°†é¡µè¡¨äº¤æ¢åˆ°ç£ç›˜ æœ€åï¼Œæˆ‘ä»¬è®¨è®ºæ”¾å®½æœ€åä¸€ä¸ªå‡è®¾çš„é—®é¢˜ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´å‡è®¾é¡µè¡¨ä½äºå†…æ ¸æ‰€æœ‰çš„ç‰©ç†å†…å­˜ä¸­ã€‚å³ä½¿æˆ‘ä»¬é‡‡ç”¨äº†è®¸å¤šæŠ€å·§æ¥ç¼©å°é¡µè¡¨çš„å¤§å°ï¼Œä½†ä»æœ‰å¯èƒ½å‡ºç°é¡µè¡¨è¿‡å¤§ï¼Œæ— æ³•ä¸€æ¬¡æ€§æ”¾å…¥å†…å­˜çš„æƒ…å†µã€‚å› æ­¤ï¼Œæœ‰äº›ç³»ç»Ÿä¼šå°†è¿™äº›é¡µè¡¨æ”¾åœ¨å†…æ ¸è™šæ‹Ÿå†…å­˜ä¸­ï¼Œè¿™æ ·å½“å†…å­˜å‹åŠ›æœ‰ç‚¹ç´§å¼ æ—¶ï¼Œç³»ç»Ÿå°±å¯ä»¥å°†å…¶ä¸­ä¸€äº›é¡µè¡¨äº¤æ¢åˆ°ç£ç›˜ä¸Šã€‚æˆ‘ä»¬å°†åœ¨ä»¥åçš„ç« èŠ‚ï¼ˆå³æœ‰å…³ VAX/VMS çš„æ¡ˆä¾‹ç ”ç©¶ï¼‰ä¸­è¿›ä¸€æ­¥è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œå±Šæ—¶æˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°äº†è§£å¦‚ä½•å°†é¡µé¢ç§»å…¥å’Œç§»å‡ºå†…å­˜ã€‚ ","date":"2024-04-25","objectID":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/:5:0","tags":["OS"],"title":"é«˜çº§é¡µè¡¨","uri":"/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"ä½¿ç”¨åˆ†é¡µä½œä¸ºæ”¯æŒè™šæ‹Ÿå†…å­˜çš„æ ¸å¿ƒæœºåˆ¶å¯èƒ½ä¼šå¯¼è‡´è¾ƒé«˜çš„æ€§èƒ½å¼€é”€ã€‚é€šè¿‡å°†åœ°å€ç©ºé—´åˆ†å‰²æˆå°çš„ã€å›ºå®šå¤§å°çš„å•å…ƒï¼ˆå³é¡µï¼‰ï¼Œåˆ†é¡µéœ€è¦å¤§é‡çš„æ˜ å°„ä¿¡æ¯ã€‚ç”±äºæ˜ å°„ä¿¡æ¯é€šå¸¸å­˜å‚¨åœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œå› æ­¤åˆ†é¡µé€»è¾‘ä¸Šéœ€è¦å¯¹ç¨‹åºç”Ÿæˆçš„æ¯ä¸ªè™šæ‹Ÿåœ°å€è¿›è¡Œé¢å¤–çš„å†…å­˜æŸ¥æ‰¾ã€‚åœ¨æ¯æ¬¡å–æŒ‡ä»¤æˆ–æ˜¾å¼åŠ è½½æˆ–å­˜å‚¨ä¹‹å‰è®¿é—®å†…å­˜ä»¥è·å–åœ°å€è½¬æ¢ä¿¡æ¯çš„é€Ÿåº¦éå¸¸æ…¢ã€‚ å› æ­¤æˆ‘ä»¬çš„é—®é¢˜å…³é”®æ˜¯ï¼šæˆ‘ä»¬å¦‚ä½•æ‰èƒ½åŠ å¿«åœ°å€è½¬æ¢ï¼Œå¹¶ä»æ€»ä½“ä¸Šé¿å…åˆ†é¡µä¼¼ä¹éœ€è¦çš„é¢å¤–å†…å­˜å¼•ç”¨ï¼Ÿéœ€è¦ä»€ä¹ˆç¡¬ä»¶æ”¯æŒï¼Ÿéœ€è¦ä»€ä¹ˆæ“ä½œç³»ç»Ÿå‚ä¸ï¼Ÿ å½“æˆ‘ä»¬æƒ³è®©äº‹æƒ…å˜å¾—æ›´å¿«æ—¶ï¼Œæ“ä½œç³»ç»Ÿé€šå¸¸éœ€è¦ä¸€äº›å¸®åŠ©ã€‚å¸®åŠ©é€šå¸¸æ¥è‡ªæ“ä½œç³»ç»Ÿçš„è€æœ‹å‹ï¼šç¡¬ä»¶ã€‚ä¸ºäº†åŠ é€Ÿåœ°å€è½¬æ¢ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªå«åšå¿«è¡¨ï¼ˆtranslation-lookaside buffer, TLBï¼‰çš„ç¡¬ä»¶ç¼“å­˜ã€‚ TLB æ˜¯èŠ¯ç‰‡å†…å­˜ç®¡ç†å•å…ƒ (MMU) çš„ä¸€éƒ¨åˆ†ï¼Œåªæ˜¯å¸¸ç”¨çš„è™šæ‹Ÿåˆ°ç‰©ç†åœ°å€è½¬æ¢çš„ç¡¬ä»¶ç¼“å­˜ï¼›å› æ­¤ï¼Œæ›´å¥½çš„åç§°æ˜¯åœ°å€è½¬æ¢ç¼“å­˜ï¼ˆaddress-translation cacheï¼‰ã€‚åœ¨æ¯æ¬¡è™šæ‹Ÿå†…å­˜å¼•ç”¨æ—¶ï¼Œç¡¬ä»¶é¦–å…ˆæ£€æŸ¥ TLB ä»¥æŸ¥çœ‹å…¶ä¸­æ˜¯å¦ä¿å­˜äº†æ‰€éœ€çš„è½¬æ¢ï¼›å¦‚æœæ˜¯è¿™æ ·ï¼Œåˆ™ï¼ˆå¿«é€Ÿï¼‰æ‰§è¡Œè½¬æ¢ï¼Œè€Œæ— éœ€æŸ¥é˜…é¡µè¡¨ï¼ˆå…¶ä¸­åŒ…å«æ‰€æœ‰è½¬æ¢ï¼‰ã€‚ç”±äºå…¶å·¨å¤§çš„æ€§èƒ½å½±å“ï¼ŒTLB çœŸæ­£æ„ä¹‰ä¸Šä½¿è™šæ‹Ÿå†…å­˜æˆä¸ºå¯èƒ½ã€‚ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:0:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 TLBåŸºæœ¬ç®—æ³• ä¸‹æ®µä»£ç ç²—ç•¥æ˜¾ç¤ºäº†ç¡¬ä»¶å¦‚ä½•å¤„ç†è™šæ‹Ÿåœ°å€è½¬æ¢ï¼Œå‡å®šæœ‰ä¸€ä¸ªç®€å•çš„çº¿æ€§é¡µè¡¨ï¼ˆå³é¡µè¡¨æ˜¯ä¸€ä¸ªæ•°ç»„ï¼‰å’Œä¸€ä¸ªç¡¬ä»¶ç®¡ç†çš„ TLBï¼ˆå³ç¡¬ä»¶å¤„ç†é¡µè¡¨è®¿é—®çš„å¤§éƒ¨åˆ†è´£ä»»ï¼‰ã€‚ 1: VPN = (VirtualAddress \u0026 VPN_MASK) \u003e\u003e SHIFT 2: (Success, TlbEntry) = TLB_Lookup(VPN) 3: if (Success == True) // TLB Hit 4: if (CanAccess(TlbEntry.ProtectBits) == True) 5: Offset = VirtualAddress \u0026 OFFSET_MASK 6: PhysAddr = (TlbEntry.PFN \u003c\u003c SHIFT) | Offset 7: Register = AccessMemory(PhysAddr) 8: else 9: RaiseException(PROTECTION_FAULT) 10: else // TLB Miss 11: PTEAddr = PTBR + (VPN * sizeof(PTE)) 12: PTE = AccessMemory(PTEAddr) 13: if (PTE.Valid == False) 14: RaiseException(SEGMENTATION_FAULT) 15: else if (CanAccess(PTE.ProtectBits) == False) 16: RaiseException(PROTECTION_FAULT) 17: else 18: TLB_Insert(VPN, PTE.PFN, PTE.ProtectBits) 19: RetryInstruction() ç¡¬ä»¶éµå¾ªçš„ç®—æ³•æ˜¯è¿™æ ·å·¥ä½œçš„ï¼šé¦–å…ˆï¼Œä»è™šæ‹Ÿåœ°å€ä¸­æå–è™šæ‹Ÿé¡µç ï¼ˆVPNï¼‰ï¼ˆç¬¬ä¸€è¡Œï¼‰ï¼Œç„¶åæ£€æŸ¥ TLB æ˜¯å¦æŒæœ‰è¯¥ VPN çš„è½¬æ¢ï¼ˆç¬¬ 2 è¡Œï¼‰ã€‚å¦‚æœæ˜¯ï¼Œæˆ‘ä»¬å°±æœ‰ä¸€ä¸ª TLB å‘½ä¸­ï¼Œè¿™æ„å‘³ç€ TLB ä¿ç•™äº†è½¬æ¢ã€‚æˆåŠŸï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»ç›¸å…³çš„ TLB æ¡ç›®ä¸­æå–ç‰©ç†é¡µç  (PFN)ï¼Œå°†å…¶ä¸åŸå§‹è™šæ‹Ÿåœ°å€çš„åç§»é‡è¿æ¥èµ·æ¥ï¼Œå½¢æˆæ‰€éœ€çš„ç‰©ç†åœ°å€ (PA)ï¼Œç„¶åè®¿é—®å†…å­˜ï¼ˆç¬¬ 5-7 è¡Œï¼‰ï¼Œå‰ææ˜¯ä¿æŠ¤æ£€æŸ¥æ²¡æœ‰å¤±è´¥ï¼ˆç¬¬ 4 è¡Œï¼‰ã€‚ å¦‚æœ CPU åœ¨ TLB ä¸­æ²¡æœ‰æ‰¾åˆ°è½¬æ¢ï¼ˆTLB æœªå‘½ä¸­ï¼‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›å·¥ä½œã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œç¡¬ä»¶ä¼šè®¿é—®é¡µè¡¨ä»¥æŸ¥æ‰¾è½¬æ¢ï¼ˆç¬¬ 11-12 è¡Œï¼‰ï¼Œå¹¶å‡è®¾è¿›ç¨‹ç”Ÿæˆçš„è™šæ‹Ÿå†…å­˜å¼•ç”¨æœ‰æ•ˆä¸”å¯è®¿é—®ï¼ˆç¬¬ 13ã€15 è¡Œï¼‰ï¼Œç„¶åç”¨è½¬æ¢æ›´æ–° TLBï¼ˆç¬¬ 18 è¡Œï¼‰ã€‚è¿™ä¸€ç³»åˆ—æ“ä½œä»£ä»·é«˜æ˜‚ï¼Œä¸»è¦æ˜¯å› ä¸ºè®¿é—®é¡µè¡¨éœ€è¦é¢å¤–çš„å†…å­˜å¼•ç”¨ï¼ˆç¬¬ 12 è¡Œï¼‰ã€‚æœ€åï¼Œä¸€æ—¦æ›´æ–°äº† TLBï¼Œç¡¬ä»¶å°±ä¼šé‡è¯•æŒ‡ä»¤ï¼›è¿™ä¸€æ¬¡ï¼Œè½¬æ¢å¯ä»¥åœ¨ TLB ä¸­æ‰¾åˆ°ï¼Œå†…å­˜å¼•ç”¨ä¹Ÿä¼šå¾—åˆ°å¿«é€Ÿå¤„ç†ã€‚ TLB å’Œæ‰€æœ‰ç¼“å­˜ä¸€æ ·ï¼Œå…¶å»ºç«‹çš„å‰ææ˜¯åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè½¬æ¢éƒ½èƒ½åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°ï¼ˆå³å‘½ä¸­ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äº TLB ä½äºå¤„ç†æ ¸å¿ƒé™„è¿‘ï¼Œè€Œä¸”è®¾è®¡å¾—ç›¸å½“å¿«ï¼Œå› æ­¤å‡ ä¹ä¸ä¼šå¢åŠ å¼€é”€ã€‚å½“å‡ºç°æœªå‘½ä¸­æ—¶ï¼Œå°±ä¼šäº§ç”Ÿé«˜æ˜‚çš„åˆ†é¡µæˆæœ¬ï¼›å¿…é¡»è®¿é—®é¡µè¡¨æ‰èƒ½æ‰¾åˆ°è½¬æ¢ï¼Œè¿™å°±ä¼šäº§ç”Ÿé¢å¤–çš„å†…å­˜å¼•ç”¨ï¼ˆæˆ–æ›´å¤šï¼Œå¦‚æœé¡µè¡¨æ›´å¤æ‚ï¼‰ã€‚å¦‚æœè¿™ç§æƒ…å†µç»å¸¸å‘ç”Ÿï¼Œç¨‹åºçš„è¿è¡Œé€Ÿåº¦å¯èƒ½ä¼šæ˜æ˜¾å˜æ…¢ï¼›ç›¸å¯¹äºå¤§å¤šæ•° CPU æŒ‡ä»¤è€Œè¨€ï¼Œå†…å­˜è®¿é—®çš„æˆæœ¬ç›¸å½“é«˜ï¼Œè€Œ TLB æœªå‘½ä¸­ä¼šå¯¼è‡´æ›´å¤šçš„å†…å­˜è®¿é—®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›å°½å¯èƒ½é¿å… TLB æœªå‘½ä¸­ã€‚ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:1:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ç¤ºä¾‹ï¼šè®¿é—®æ•°ç»„ ä¸ºäº†å¼„æ¸…æ¥š TLB çš„æ“ä½œï¼Œè®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸ªç®€å•çš„è™šæ‹Ÿåœ°å€è·Ÿè¸ªï¼Œçœ‹çœ‹ TLB å¦‚ä½•æé«˜å…¶æ€§èƒ½ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå‡è®¾å†…å­˜ä¸­æœ‰ä¸€ä¸ªç”± 10 ä¸ª 4 å­—èŠ‚æ•´æ•°ç»„æˆçš„æ•°ç»„ï¼Œä»è™šæ‹Ÿåœ°å€ 100 å¼€å§‹ã€‚è¿›ä¸€æ­¥å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå°çš„ 8 ä½è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå…·æœ‰ 16 å­—èŠ‚å¤§å°çš„é¡µé¢ï¼›å› æ­¤ï¼Œè™šæ‹Ÿåœ°å€åˆ†ä¸º 4 ä½ VPNï¼ˆæœ‰ 16 ä¸ªè™šæ‹Ÿé¡µé¢ï¼‰å’Œ 4 ä½åç§»é‡ï¼ˆæ¯ä¸ªé¡µé¢æœ‰ 16 ä¸ªå­—èŠ‚ï¼‰ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†ç³»ç»Ÿ 16 ä¸ª 16 å­—èŠ‚é¡µé¢ä¸Šçš„å¸ƒå±€ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªæ¡ç›®ï¼ˆa[0]ï¼‰å¼€å§‹äºï¼ˆVPN=06ï¼Œåç§»é‡=04ï¼‰ï¼›åœ¨è¿™ä¸€é¡µä¸Šåªèƒ½å®¹çº³ä¸‰ä¸ª 4 å­—èŠ‚çš„æ•´æ•°ã€‚æ•°ç»„ç»§ç»­è¿›å…¥ä¸‹ä¸€é¡µï¼ˆVPN=07ï¼‰ï¼Œåœ¨è¿™ä¸€é¡µä¸Šæ‰¾åˆ°æ¥ä¸‹æ¥å››ä¸ªæ¡ç›®ï¼ˆa[3] â€¦ a[6]ï¼‰ã€‚æœ€åï¼Œ10 ä¸ªæ¡ç›®æ•°ç»„çš„æœ€åä¸‰ä¸ªæ¡ç›®ï¼ˆa[7] â€¦ a[9]ï¼‰ä½äºåœ°å€ç©ºé—´çš„ä¸‹ä¸€é¡µï¼ˆVPN=08ï¼‰ã€‚ ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªè®¿é—®æ¯ä¸ªæ•°ç»„å…ƒç´ çš„ç®€å•å¾ªç¯ï¼Œåœ¨ C ä¸­çœ‹èµ·æ¥åƒè¿™æ ·ï¼š int sum = 0; for (i = 0; i \u003c 10; i++) { sum += a[i]; } ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾å¾ªç¯ç”Ÿæˆçš„å”¯ä¸€å†…å­˜è®¿é—®æ˜¯æ•°ç»„ï¼ˆå¿½ç•¥å˜é‡ i å’Œ sumï¼Œä»¥åŠæŒ‡ä»¤æœ¬èº«ï¼‰ã€‚å½“è®¿é—®ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´  (a[0]) æ—¶ï¼ŒCPU å°†çœ‹åˆ°å¯¹è™šæ‹Ÿåœ°å€ 100 çš„åŠ è½½ã€‚ç¡¬ä»¶ä»ä¸­æå– VPN (VPN=06)ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥æ£€æŸ¥ TLB çš„æœ‰æ•ˆè½¬æ¢ã€‚å‡è®¾è¿™æ˜¯ç¨‹åºç¬¬ä¸€æ¬¡è®¿é—®æ•°ç»„ï¼Œç»“æœå°†æ˜¯ TLB æœªå‘½ä¸­ã€‚ ä¸‹ä¸€æ¬¡è®¿é—®æ˜¯ a[1]ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼šTLB å‘½ä¸­ï¼å› ä¸ºæ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ç´§æŒ¨ç€ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å®ƒä½äºåŒä¸€ä¸ªé¡µé¢ä¸Šï¼›å› ä¸ºæˆ‘ä»¬åœ¨è®¿é—®æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶å·²ç»è®¿é—®äº†è¿™ä¸ªé¡µé¢ï¼Œæ‰€ä»¥è½¬æ¢å·²ç»åŠ è½½åˆ°TLBä¸­ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æˆåŠŸçš„åŸå› ã€‚è®¿é—® a[2] ä¼šé‡åˆ°ç±»ä¼¼çš„æˆåŠŸï¼ˆå¦ä¸€ä¸ªå‘½ä¸­ï¼‰ï¼Œå› ä¸ºå®ƒä¹Ÿä¸ a[0] å’Œ a[1] ä½äºåŒä¸€é¡µé¢ä¸Šã€‚ ä¸å¹¸çš„æ˜¯ï¼Œå½“ç¨‹åºè®¿é—®a[3]æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº†å¦ä¸€ä¸ªTLBæœªå‘½ä¸­ã€‚ç„¶è€Œï¼Œä¸‹ä¸€ä¸ªæ¡ç›® (a[4] â€¦ a[6]) å°†å†æ¬¡å‘½ä¸­ TLBï¼Œå› ä¸ºå®ƒä»¬éƒ½é©»ç•™åœ¨å†…å­˜ä¸­çš„åŒä¸€é¡µä¸Šã€‚ æœ€åï¼Œè®¿é—® a[7] ä¼šå¯¼è‡´æœ€åä¸€æ¬¡ TLB æœªå‘½ä¸­ã€‚ç¡¬ä»¶å†æ¬¡æŸ¥è¯¢é¡µè¡¨ä»¥æ‰¾å‡ºè¯¥è™šæ‹Ÿé¡µåœ¨ç‰©ç†å†…å­˜ä¸­çš„ä½ç½®ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°TLBã€‚æœ€åä¸¤æ¬¡è®¿é—®ï¼ˆa[8] å’Œ a[9]ï¼‰å—ç›Šäºè¯¥ TLB æ›´æ–°ï¼›å½“ç¡¬ä»¶åœ¨ TLB ä¸­æŸ¥æ‰¾è½¬æ¢æ—¶ï¼Œä¼šäº§ç”Ÿå¦å¤–ä¸¤æ¬¡å‘½ä¸­ã€‚ è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹åœ¨å¯¹æ•°ç»„è¿›è¡Œåæ¬¡è®¿é—®æœŸé—´ TLB çš„æ´»åŠ¨ï¼šmissã€hitã€hitã€missã€hitã€hitã€hitã€missã€hitã€hitã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ TLB å‘½ä¸­ç‡ï¼ˆå³å‘½ä¸­æ¬¡æ•°é™¤ä»¥æ€»è®¿é—®æ¬¡æ•°ï¼‰ä¸º 70%ã€‚è™½ç„¶è¿™ä¸æ˜¯å¤ªé«˜ï¼ˆäº‹å®ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›å‘½ä¸­ç‡æ¥è¿‘ 100%ï¼‰ï¼Œä½†å®ƒæ˜¯éé›¶çš„ï¼Œè¿™å¯èƒ½ä¼šä»¤äººæƒŠè®¶ã€‚å°½ç®¡è¿™æ˜¯ç¨‹åºç¬¬ä¸€æ¬¡è®¿é—®æ•°ç»„ï¼Œä½† TLB ç”±äºç©ºé—´å±€éƒ¨æ€§è€Œæé«˜äº†æ€§èƒ½ã€‚æ•°ç»„çš„å…ƒç´ è¢«ç´§å¯†åœ°æ‰“åŒ…åˆ°é¡µé¢ä¸­ï¼ˆå³ï¼Œå®ƒä»¬åœ¨ç©ºé—´ä¸Šå½¼æ­¤é è¿‘ï¼‰ï¼Œå› æ­¤åªæœ‰ç¬¬ä¸€æ¬¡è®¿é—®é¡µé¢ä¸Šçš„å…ƒç´ æ‰ä¼šäº§ç”Ÿ TLB æœªå‘½ä¸­ã€‚ è¿˜è¦æ³¨æ„é¡µé¢å¤§å°åœ¨æœ¬ä¾‹ä¸­çš„ä½œç”¨ã€‚å¦‚æœé¡µé¢å¤§å°æ˜¯åŸæ¥çš„ä¸¤å€ï¼ˆ32 å­—èŠ‚ï¼Œè€Œä¸æ˜¯ 16 å­—èŠ‚ï¼‰ï¼Œé‚£ä¹ˆé˜µåˆ—è®¿é—®çš„æœªå‘½ä¸­æ¬¡æ•°å°±ä¼šæ›´å°‘ã€‚ç”±äºå…¸å‹çš„é¡µé¢å¤§å°æ›´æ¥è¿‘ 4KBï¼Œè¿™äº›ç±»å‹çš„å¯†é›†ã€åŸºäºæ•°ç»„çš„è®¿é—®å®ç°äº†å‡ºè‰²çš„ TLB æ€§èƒ½ï¼Œæ¯é¡µè®¿é—®åªå‡ºç°ä¸€æ¬¡æœªå‘½ä¸­ã€‚ å…³äº TLB æ€§èƒ½çš„æœ€åä¸€ç‚¹ï¼šå¦‚æœç¨‹åºåœ¨å¾ªç¯ç»“æŸåä¸ä¹…å†æ¬¡è®¿é—®æ•°ç»„ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½ä¼šçœ‹åˆ°æ›´å¥½çš„ç»“æœï¼Œå‰ææ˜¯æˆ‘ä»¬æœ‰è¶³å¤Ÿå¤§çš„ TLB æ¥ç¼“å­˜æ‰€éœ€çš„è½¬æ¢ï¼šhitã€hitã€hitã€hitã€hitã€hitã€hitã€hitã€hitã€hitã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTLB å‘½ä¸­ç‡ä¼šå¾ˆé«˜ï¼Œè¿™æ˜¯å› ä¸ºæ—¶é—´å±€éƒ¨æ€§ï¼Œå³åœ¨æ—¶é—´ä¸Šå¿«é€Ÿé‡æ–°å¼•ç”¨å†…å­˜é¡¹ã€‚ä¸å…¶ä»–é«˜é€Ÿç¼“å­˜ä¸€æ ·ï¼ŒTLB çš„æˆåŠŸä¾èµ–äºç©ºé—´å’Œæ—¶é—´çš„å±€éƒ¨æ€§ï¼Œè€Œç©ºé—´å’Œæ—¶é—´çš„å±€éƒ¨æ€§æ˜¯ç¨‹åºçš„å±æ€§ã€‚å¦‚æœç›¸å…³ç¨‹åºå…·æœ‰è¿™ç§å±€éƒ¨æ€§ï¼ˆè®¸å¤šç¨‹åºéƒ½å…·æœ‰è¿™ç§å±€éƒ¨æ€§ï¼‰ï¼Œé‚£ä¹ˆ TLB çš„å‘½ä¸­ç‡å¾ˆå¯èƒ½ä¼šå¾ˆé«˜ã€‚ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:2:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 è°å¤„ç†TLBæœªå‘½ä¸­ï¼Ÿ æˆ‘ä»¬å¿…é¡»å›ç­”ä¸€ä¸ªé—®é¢˜ï¼šè°æ¥å¤„ç† TLB æœªå‘½ä¸­ï¼Ÿæœ‰ä¸¤ä¸ªå¯èƒ½çš„ç­”æ¡ˆï¼šç¡¬ä»¶æˆ–è½¯ä»¶ï¼ˆæ“ä½œç³»ç»Ÿï¼‰ã€‚åœ¨è¿‡å»ï¼Œç¡¬ä»¶å…·æœ‰å¤æ‚çš„æŒ‡ä»¤é›†ï¼ˆæœ‰æ—¶ç§°ä¸ºCISCï¼Œç”¨äºå¤æ‚æŒ‡ä»¤é›†è®¡ç®—æœºï¼‰ï¼Œè€Œæ„å»ºç¡¬ä»¶çš„äººä¸å¤ªä¿¡ä»»é‚£äº›é¬¼é¬¼ç¥Ÿç¥Ÿçš„æ“ä½œç³»ç»Ÿäººå‘˜ã€‚å› æ­¤ï¼Œç¡¬ä»¶å°†å®Œå…¨å¤„ç† TLB æœªå‘½ä¸­ã€‚ä¸ºæ­¤ï¼Œç¡¬ä»¶å¿…é¡»ç¡®åˆ‡åœ°çŸ¥é“é¡µè¡¨åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼ˆé€šè¿‡é¡µè¡¨åŸºå€å¯„å­˜å™¨ï¼‰ï¼Œä»¥åŠå®ƒä»¬çš„ç¡®åˆ‡æ ¼å¼ï¼›å¦‚æœæœªå‘½ä¸­ï¼Œç¡¬ä»¶å°†â€œéå†â€é¡µè¡¨ï¼Œæ‰¾åˆ°æ­£ç¡®çš„é¡µè¡¨æ¡ç›®å¹¶æå–æ‰€éœ€çš„è½¬æ¢ï¼Œç”¨è½¬æ¢æ›´æ–° TLBï¼Œç„¶åé‡è¯•æŒ‡ä»¤ã€‚å…·æœ‰ç¡¬ä»¶ç®¡ç† TLB çš„â€œæ—§â€æ¶æ„çš„ä¸€ä¸ªç¤ºä¾‹æ˜¯ Intel x86 æ¶æ„ï¼Œå®ƒä½¿ç”¨å›ºå®šçš„å¤šçº§é¡µè¡¨ï¼›å½“å‰é¡µè¡¨ç”±CR3å¯„å­˜å™¨æŒ‡å‘ã€‚ æ›´ç°ä»£çš„æ¶æ„ï¼ˆä¾‹å¦‚ï¼ŒMIPS R10k æˆ– Sun çš„ SPARC v9ï¼ŒRISC æˆ–ç²¾ç®€æŒ‡ä»¤é›†è®¡ç®—æœºï¼‰å…·æœ‰æ‰€è°“çš„è½¯ä»¶ç®¡ç† TLBã€‚å½“ TLB æœªå‘½ä¸­æ—¶ï¼Œç¡¬ä»¶åªä¼šå¼•å‘å¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸ä¼šæš‚åœå½“å‰æŒ‡ä»¤æµï¼Œå°†ç‰¹æƒçº§åˆ«æå‡åˆ°å†…æ ¸æ¨¡å¼ï¼Œå¹¶è·³è½¬åˆ°ä¸­æ–­å¤„ç†ç¨‹åºã€‚æ‚¨å¯èƒ½ä¼šçŒœåˆ°ï¼Œæ­¤ä¸­æ–­å¤„ç†ç¨‹åºæ˜¯æ“ä½œç³»ç»Ÿä¸­çš„ä»£ç ï¼Œå…¶ç¼–å†™çš„æ˜ç¡®ç›®çš„æ˜¯å¤„ç† TLB æœªå‘½ä¸­ã€‚è¿è¡Œæ—¶ï¼Œä»£ç å°†åœ¨é¡µè¡¨ä¸­æŸ¥æ‰¾è½¬æ¢ï¼Œä½¿ç”¨ç‰¹æ®Šçš„â€œç‰¹æƒâ€æŒ‡ä»¤æ¥æ›´æ–°TLBï¼Œç„¶åä»ä¸­æ–­è¿”å›ï¼›æ­¤æ—¶ï¼Œç¡¬ä»¶ä¼šé‡è¯•è¯¥æŒ‡ä»¤ï¼ˆå¯¼è‡´ TLB å‘½ä¸­ï¼‰ã€‚ è®©æˆ‘ä»¬è®¨è®ºå‡ ä¸ªé‡è¦çš„ç»†èŠ‚ã€‚é¦–å…ˆï¼Œä»ä¸­æ–­è¿”å›æŒ‡ä»¤éœ€è¦ä¸æˆ‘ä»¬ä¹‹å‰åœ¨æœåŠ¡ç³»ç»Ÿè°ƒç”¨æ—¶çœ‹åˆ°çš„ä»ä¸­æ–­è¿”å›æŒ‡ä»¤ç•¥æœ‰ä¸åŒã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œä»ä¸­æ–­è¿”å›åº”è¯¥åœ¨ä¸­æ–­è¿›å…¥æ“ä½œç³»ç»Ÿåçš„æŒ‡ä»¤å¤„æ¢å¤æ‰§è¡Œï¼Œå°±åƒä»è¿‡ç¨‹è°ƒç”¨è¿”å›åˆ°ç´§éšè¿‡ç¨‹è°ƒç”¨ä¹‹åçš„æŒ‡ä»¤ä¸€æ ·ã€‚åœ¨å‰ä¸€ç§æƒ…å†µä¸‹ï¼Œå½“ä» TLB æœªå‘½ä¸­å¤„ç†ä¸­æ–­è¿”å›æ—¶ï¼Œç¡¬ä»¶å¿…é¡»åœ¨å¯¼è‡´ä¸­æ–­çš„æŒ‡ä»¤å¤„æ¢å¤æ‰§è¡Œï¼›å› æ­¤ï¼Œæ­¤é‡è¯•è®©æŒ‡ä»¤å†æ¬¡è¿è¡Œï¼Œè¿™ä¸€æ¬¡å¯¼è‡´ TLB å‘½ä¸­ã€‚å› æ­¤ï¼Œæ ¹æ®ä¸­æ–­æˆ–å¼‚å¸¸çš„å¼•å‘æ–¹å¼ï¼Œç¡¬ä»¶åœ¨ä¸­æ–­è¿›å…¥æ“ä½œç³»ç»Ÿæ—¶å¿…é¡»ä¿å­˜ä¸åŒçš„ PCï¼Œä»¥ä¾¿åœ¨æ—¶é—´åˆ°æ¥æ—¶æ­£ç¡®æ¢å¤ã€‚ å…¶æ¬¡ï¼Œå½“è¿è¡Œ TLB æœªå‘½ä¸­å¤„ç†ä»£ç æ—¶ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦æ ¼å¤–å°å¿ƒï¼Œä¸è¦å¯¼è‡´å‘ç”Ÿæ— é™çš„ TLB æœªå‘½ä¸­é“¾ã€‚å­˜åœ¨è®¸å¤šè§£å†³æ–¹æ¡ˆï¼›ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å°† TLB æœªå‘½ä¸­å¤„ç†ç¨‹åºä¿ç•™åœ¨ç‰©ç†å†…å­˜ä¸­ï¼ˆå®ƒä»¬æœªæ˜ å°„ä¸”ä¸å—åœ°å€è½¬æ¢å½±å“ï¼‰ï¼Œæˆ–è€…åœ¨ TLB ä¸­ä¿ç•™ä¸€äº›æ¡ç›®ä»¥è¿›è¡Œæ°¸ä¹…æœ‰æ•ˆçš„è½¬æ¢ï¼Œå¹¶å°†å…¶ä¸­ä¸€äº›æ°¸ä¹…è½¬æ¢æ§½ç”¨äºå¤„ç†ç¨‹åºä»£ç æœ¬èº«;è¿™äº›æœ‰çº¿è½¬æ¢æ€»æ˜¯å‘½ä¸­ TLBã€‚ è½¯ä»¶ç®¡ç†æ–¹æ³•çš„ä¸»è¦ä¼˜ç‚¹æ˜¯çµæ´»æ€§ï¼šæ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨å®ƒæƒ³è¦å®ç°é¡µè¡¨çš„ä»»ä½•æ•°æ®ç»“æ„ï¼Œè€Œæ— éœ€æ›´æ”¹ç¡¬ä»¶ã€‚å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ç®€å•ã€‚å¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼Œç¡¬ä»¶åœ¨æœªå‘½ä¸­æ—¶ä¸ä¼šåšå¤ªå¤šäº‹æƒ…ï¼šåªæ˜¯å¼•å‘å¼‚å¸¸ï¼Œç„¶åè®©æ“ä½œç³»ç»Ÿ TLB æœªå‘½ä¸­å¤„ç†ç¨‹åºå®Œæˆå…¶ä½™çš„å·¥ä½œã€‚ 1: VPN = (VirtualAddress \u0026 VPN_MASK) \u003e\u003e SHIFT 2: (Success, TlbEntry) = TLB_Lookup(VPN) 3: if (Success == True) // TLB Hit 4: if (CanAccess(TlbEntry.ProtectBits) == True) 5: Offset = VirtualAddress \u0026 OFFSET_MASK 6: PhysAddr = (TlbEntry.PFN \u003c\u003c SHIFT) | Offset 7: Register = AccessMemory(PhysAddr) 8: else 9: RaiseException(PROTECTION_FAULT) 10: else // TLB Miss 11: RaiseException(TLB_MISS) ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:3:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 TLB å†…å®¹ï¼šé‡Œé¢æœ‰ä»€ä¹ˆï¼Ÿ è®©æˆ‘ä»¬è¯¦ç»†äº†è§£ä¸€ä¸‹ç¡¬ä»¶ TLB çš„å†…å®¹ã€‚å…¸å‹çš„ TLB å¯èƒ½æœ‰ 32ã€64 æˆ– 128 ä¸ªæ¡ç›®ï¼Œå¹¶ä¸”è¢«ç§°ä¸ºå…¨å…³è”ã€‚åŸºæœ¬ä¸Šï¼Œè¿™æ„å‘³ç€ä»»ä½•ç»™å®šçš„è½¬æ¢éƒ½å¯ä»¥åœ¨ TLB çš„ä»»ä½•ä½ç½®ï¼Œç¡¬ä»¶å°†å¹¶è¡Œæœç´¢æ•´ä¸ª TLB ä»¥æ‰¾åˆ°æ‰€éœ€çš„è½¬æ¢ã€‚ä¸€ä¸ª TLB æ¡ç›®å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š è¯·æ³¨æ„ï¼ŒVPN å’Œ PFN éƒ½å­˜åœ¨äºæ¯ä¸ªæ¡ç›®ä¸­ï¼Œå› ä¸ºè½¬æ¢å¯èƒ½æœ€ç»ˆä½äºè¿™äº›ä½ç½®ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼ˆåœ¨ç¡¬ä»¶æœ¯è¯­ä¸­ï¼ŒTLB ç§°ä¸ºå…¨å…³è”ç¼“å­˜ï¼‰ã€‚ç¡¬ä»¶å¹¶è¡Œæœç´¢æ¡ç›®ä»¥æŸ¥çœ‹æ˜¯å¦å­˜åœ¨åŒ¹é…ã€‚ æ›´æœ‰è¶£çš„æ˜¯â€œå…¶ä»–ä½â€ã€‚ä¾‹å¦‚ï¼ŒTLBé€šå¸¸æœ‰ä¸€ä¸ªæœ‰æ•ˆä½ï¼Œå®ƒè¡¨ç¤ºè¯¥æ¡ç›®æ˜¯å¦å…·æœ‰æœ‰æ•ˆçš„è½¬æ¢ã€‚åŒæ ·å¸¸è§çš„æ˜¯ä¿æŠ¤ä½ï¼Œå®ƒå†³å®šå¦‚ä½•è®¿é—®é¡µé¢ï¼ˆå¦‚åœ¨é¡µè¡¨ä¸­ï¼‰ã€‚ä¾‹å¦‚ï¼Œä»£ç é¡µå¯èƒ½è¢«æ ‡è®°ä¸ºè¯»å–å’Œæ‰§è¡Œï¼Œè€Œå †é¡µå¯èƒ½è¢«æ ‡è®°ä¸ºè¯»å–å’Œå†™å…¥ã€‚è¿˜å¯èƒ½æœ‰ä¸€äº›å…¶ä»–å­—æ®µï¼ŒåŒ…æ‹¬åœ°å€ç©ºé—´æ ‡è¯†ç¬¦ã€è„ä½ç­‰ã€‚ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:4:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 TLB é—®é¢˜ï¼šä¸Šä¸‹æ–‡åˆ‡æ¢ å¯¹äº TLBï¼Œåœ¨è¿›ç¨‹ï¼ˆä»¥åŠåœ°å€ç©ºé—´ï¼‰ä¹‹é—´åˆ‡æ¢æ—¶ä¼šå‡ºç°ä¸€äº›æ–°é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼ŒTLB åŒ…å«ä»…å¯¹å½“å‰è¿è¡Œçš„è¿›ç¨‹æœ‰æ•ˆçš„è™šæ‹Ÿåˆ°ç‰©ç†çš„è½¬æ¢ï¼›è¿™äº›è½¬æ¢å¯¹äºå…¶ä»–è¿›ç¨‹æ²¡æœ‰æ„ä¹‰ã€‚å› æ­¤ï¼Œå½“ä»ä¸€ä¸ªè¿›ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œç¡¬ä»¶æˆ–æ“ä½œç³»ç»Ÿï¼ˆæˆ–ä¸¤è€…ï¼‰å¿…é¡»å°å¿ƒï¼Œä»¥ç¡®ä¿å³å°†è¿è¡Œçš„è¿›ç¨‹ä¸ä¼šæ„å¤–ä½¿ç”¨æŸäº›å…ˆå‰è¿è¡Œçš„è¿›ç¨‹çš„è½¬æ¢ã€‚ ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ç§æƒ…å†µï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚å½“ä¸€ä¸ªè¿›ç¨‹ (P1) è¿è¡Œæ—¶ï¼Œå®ƒå‡è®¾ TLB å¯èƒ½æ­£åœ¨ç¼“å­˜å¯¹å…¶æœ‰æ•ˆçš„è½¬æ¢ï¼Œå³æ¥è‡ª P1 çš„é¡µè¡¨çš„è½¬æ¢ã€‚å¯¹äºæ­¤ç¤ºä¾‹ï¼Œå‡è®¾ P1 çš„ç¬¬ 10 ä¸ªè™šæ‹Ÿé¡µæ˜ å°„åˆ°ç‰©ç†é¡µ 100ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå‡è®¾å­˜åœ¨å¦ä¸€ä¸ªè¿›ç¨‹ (P2)ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿå¾ˆå¿«å¯èƒ½å†³å®šæ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢å¹¶è¿è¡Œå®ƒã€‚è¿™é‡Œå‡è®¾ P2 çš„ç¬¬ 10 ä¸ªè™šæ‹Ÿé¡µæ˜ å°„åˆ°ç‰©ç†é¡µ 170ã€‚å¦‚æœä¸¤ä¸ªè¿›ç¨‹çš„æ¡ç›®éƒ½åœ¨ TLB ä¸­ï¼Œåˆ™ TLB çš„å†…å®¹å°†ä¸ºï¼š åœ¨ä¸Šé¢çš„ TLB ä¸­ï¼Œæˆ‘ä»¬æ˜¾ç„¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šVPN 10 è½¬æ¢ä¸º PFN 100 (P1) æˆ– PFN 170 (P2)ï¼Œä½†ç¡¬ä»¶æ— æ³•åŒºåˆ†å“ªä¸ªæ¡ç›®é€‚ç”¨äºå“ªä¸ªè¿›ç¨‹ã€‚å› æ­¤ï¼Œä¸ºäº†è®©TLBèƒ½å¤Ÿæ­£ç¡®ã€é«˜æ•ˆåœ°æ”¯æŒè·¨å¤šè¿›ç¨‹çš„è™šæ‹ŸåŒ–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åšæ›´å¤šçš„å·¥ä½œã€‚å› æ­¤ï¼Œå…³é”®åœ¨äºï¼šå½“åœ¨è¿›ç¨‹ä¹‹é—´è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œæœ€åä¸€ä¸ªè¿›ç¨‹çš„ TLB ä¸­çš„è½¬æ¢å¯¹äºå³å°†è¿è¡Œçš„è¿›ç¨‹æ²¡æœ‰æ„ä¹‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç¡¬ä»¶æˆ–æ“ä½œç³»ç»Ÿåº”è¯¥åšä»€ä¹ˆï¼Ÿ å¯¹äºè¿™ä¸ªé—®é¢˜æœ‰å¤šç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚ä¸€ç§æ–¹æ³•æ˜¯ç®€å•åœ°åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶åˆ·æ–° TLBï¼Œä»è€Œåœ¨è¿è¡Œä¸‹ä¸€ä¸ªè¿›ç¨‹ä¹‹å‰æ¸…ç©ºå®ƒã€‚åœ¨åŸºäºè½¯ä»¶çš„ç³»ç»Ÿä¸Šï¼Œè¿™å¯ä»¥é€šè¿‡æ˜¾å¼ï¼ˆä¸”ç‰¹æƒï¼‰çš„ç¡¬ä»¶æŒ‡ä»¤æ¥å®Œæˆï¼›ä½¿ç”¨ç¡¬ä»¶ç®¡ç†çš„ TLBï¼Œå½“é¡µè¡¨åŸºå€å¯„å­˜å™¨æ›´æ”¹æ—¶å¯ä»¥æ‰§è¡Œåˆ·æ–°ï¼ˆè¯·æ³¨æ„ï¼Œæ“ä½œç³»ç»Ÿæ— è®ºå¦‚ä½•éƒ½å¿…é¡»åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶æ›´æ”¹ PTBRï¼‰ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œåˆ·æ–°æ“ä½œéƒ½åªæ˜¯å°†æ‰€æœ‰æœ‰æ•ˆä½è®¾ç½®ä¸º 0ï¼Œæœ¬è´¨ä¸Šæ˜¯æ¸…é™¤ TLB çš„å†…å®¹ã€‚ é€šè¿‡åœ¨æ¯æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶åˆ·æ–° TLBï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºè¿›ç¨‹æ°¸è¿œä¸ä¼šæ„å¤–åœ°é‡åˆ° TLB ä¸­çš„é”™è¯¯è½¬æ¢ã€‚ç„¶è€Œï¼Œè¿™æ˜¯æœ‰ä»£ä»·çš„ï¼šæ¯æ¬¡è¿›ç¨‹è¿è¡Œæ—¶ï¼Œå®ƒåœ¨æ¥è§¦å…¶æ•°æ®å’Œä»£ç é¡µæ—¶éƒ½å¿…é¡»å¯¼è‡´ TLB æœªå‘½ä¸­ã€‚å¦‚æœæ“ä½œç³»ç»Ÿé¢‘ç¹åœ°åœ¨è¿›ç¨‹ä¹‹é—´åˆ‡æ¢ï¼Œè¿™ä¸ªæˆæœ¬å¯èƒ½ä¼šå¾ˆé«˜ã€‚ ä¸ºäº†å‡å°‘è¿™ç§å¼€é”€ï¼Œä¸€äº›ç³»ç»Ÿæ·»åŠ äº†ç¡¬ä»¶æ”¯æŒä»¥å®ç°è·¨ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ TLB å…±äº«ã€‚ç‰¹åˆ«åœ°ï¼Œä¸€äº›ç¡¬ä»¶ç³»ç»Ÿåœ¨TLBä¸­æä¾›åœ°å€ç©ºé—´æ ‡è¯†ç¬¦(ASID)å­—æ®µã€‚æ‚¨å¯ä»¥å°† ASID è§†ä¸ºè¿›ç¨‹æ ‡è¯†ç¬¦ (PID)ï¼Œä½†é€šå¸¸å®ƒçš„ä½æ•°è¾ƒå°‘ï¼ˆä¾‹å¦‚ï¼ŒASID ä¸º 8 ä½ï¼Œè€Œ PID ä¸º 32 ä½ï¼‰ã€‚ å¦‚æœæˆ‘ä»¬é‡‡ç”¨ä¸Šé¢çš„ç¤ºä¾‹ TLB å¹¶æ·»åŠ  ASIDï¼Œå¾ˆæ˜æ˜¾è¿›ç¨‹å¯ä»¥è½»æ¾å…±äº« TLBï¼šä»…éœ€è¦ ASID å­—æ®µæ¥åŒºåˆ†å…¶ä»–ç›¸åŒçš„è½¬æ¢ã€‚ä»¥ä¸‹æ˜¯æ·»åŠ äº† ASID å­—æ®µçš„ TLB çš„æè¿°ï¼š å› æ­¤ï¼Œåˆ©ç”¨åœ°å€ç©ºé—´æ ‡è¯†ç¬¦ï¼ŒTLB å¯ä»¥åŒæ—¶ä¿å­˜æ¥è‡ªä¸åŒè¿›ç¨‹çš„è½¬æ¢ï¼Œè€Œä¸ä¼šäº§ç”Ÿä»»ä½•æ··æ·†ã€‚å½“ç„¶ï¼Œç¡¬ä»¶è¿˜éœ€è¦çŸ¥é“å½“å‰æ­£åœ¨è¿è¡Œå“ªä¸ªè¿›ç¨‹æ‰èƒ½æ‰§è¡Œè½¬æ¢ï¼Œå› æ­¤æ“ä½œç³»ç»Ÿå¿…é¡»åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶å°†æŸäº›ç‰¹æƒå¯„å­˜å™¨è®¾ç½®ä¸ºå½“å‰è¿›ç¨‹çš„ ASIDã€‚ æ‚¨å¯èƒ½è¿˜æƒ³åˆ°äº†å¦ä¸€ç§æƒ…å†µï¼Œå…¶ä¸­ TLB çš„ä¸¤ä¸ªæ¡ç›®éå¸¸ç›¸ä¼¼ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä¸¤ä¸ªä¸åŒè¿›ç¨‹çš„ä¸¤ä¸ªæ¡ç›®å…·æœ‰æŒ‡å‘åŒä¸€ç‰©ç†é¡µé¢çš„ä¸¤ä¸ªä¸åŒ VPNï¼šä¾‹å¦‚ï¼Œå½“ä¸¤ä¸ªè¿›ç¨‹å…±äº«ä¸€ä¸ªé¡µé¢ï¼ˆä¾‹å¦‚ä»£ç é¡µï¼‰æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œè¿›ç¨‹ 1 ä¸è¿›ç¨‹ 2 å…±äº«ç‰©ç†é¡µ 101ï¼› P1 å°†æ­¤é¡µæ˜ å°„åˆ°å…¶åœ°å€ç©ºé—´çš„ç¬¬ 10 é¡µï¼Œè€Œ P2 å°†æ­¤é¡µæ˜ å°„åˆ°å…¶åœ°å€ç©ºé—´çš„ç¬¬ 50 é¡µã€‚å…±äº«ä»£ç é¡µï¼ˆåœ¨äºŒè¿›åˆ¶æ–‡ä»¶æˆ–å…±äº«åº“ä¸­ï¼‰å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå‡å°‘äº†ä½¿ç”¨çš„ç‰©ç†é¡µæ•°é‡ï¼Œä»è€Œå‡å°‘äº†å†…å­˜å¼€é”€ã€‚ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:5:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 TLB æ›¿æ¢ç­–ç•¥ ä¸ä»»ä½•ç¼“å­˜ä¸€æ ·ï¼Œå¯¹äº TLB æ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ç¼“å­˜æ›¿æ¢ã€‚å…·ä½“æ¥è¯´ï¼Œå½“æˆ‘ä»¬åœ¨ TLB ä¸­å®‰è£…æ–°æ¡ç›®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ›¿æ¢æ—§æ¡ç›®ï¼Œå› æ­¤é—®é¢˜çš„å…³é”®æ˜¯ï¼šè¦æ›¿æ¢å“ªä¸€ä¸ªï¼Ÿå¦‚ä½•è®¾è®¡ TLB æ›¿æ¢ç­–ç•¥ï¼Ÿ å½“æˆ‘ä»¬æ·»åŠ æ–°çš„ TLB æ¡ç›®æ—¶ï¼Œåº”è¯¥æ›¿æ¢å“ªä¸ª TLB æ¡ç›®ï¼Ÿå½“ç„¶ï¼Œç›®æ ‡æ˜¯æœ€å¤§é™åº¦åœ°å‡å°‘æœªå‘½ä¸­ç‡ï¼ˆæˆ–æé«˜å‘½ä¸­ç‡ï¼‰ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚ å½“æˆ‘ä»¬è§£å†³å°†é¡µé¢äº¤æ¢åˆ°ç£ç›˜çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ç ”ç©¶è¿™äº›ç­–ç•¥ï¼›è¿™é‡Œæˆ‘ä»¬åªé‡ç‚¹ä»‹ç»ä¸€äº›å…¸å‹çš„æ”¿ç­–ã€‚ ä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯é€å‡ºæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ¡ç›®æˆ– LRU æ¡ç›®ã€‚ LRU å°è¯•åˆ©ç”¨å†…å­˜å¼•ç”¨æµä¸­çš„å±€éƒ¨æ€§ï¼Œå‡è®¾æœ€è¿‘æœªä½¿ç”¨çš„æ¡ç›®å¯èƒ½æ˜¯é©±é€çš„è‰¯å¥½å€™é€‰è€…ã€‚ å¦ä¸€ç§å…¸å‹çš„æ–¹æ³•æ˜¯ä½¿ç”¨éšæœºç­–ç•¥ï¼Œéšæœºé©±é€ TLB æ˜ å°„ã€‚è¿™ç§ç­–ç•¥éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒç®€å•å¹¶ä¸”èƒ½å¤Ÿé¿å…æç«¯æƒ…å†µè¡Œä¸ºï¼›ä¾‹å¦‚ï¼Œå½“ç¨‹åºåœ¨ TLB å¤§å°ä¸º n çš„ n + 1 ä¸ªé¡µé¢ä¸Šå¾ªç¯æ—¶ï¼Œè¯¸å¦‚ LRU ä¹‹ç±»çš„â€œåˆç†â€ç­–ç•¥å°±ä¼šè¡¨ç°å¾—éå¸¸ä¸åˆç†ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒLRU ä¼šé”™è¿‡æ¯æ¬¡è®¿é—®ï¼Œè€Œéšæœºåˆ™åšå¾—æ›´å¥½ã€‚ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:6:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 å®é™…ç³»ç»Ÿé‡Œçš„TLB æœ€åï¼Œè®©æˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹çœŸæ­£çš„TLBã€‚æ­¤ç¤ºä¾‹æ¥è‡ª MIPS R4000 ï¼Œè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨è½¯ä»¶ç®¡ç†çš„ TLB çš„ç°ä»£ç³»ç»Ÿï¼›å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°ç¨å¾®ç®€åŒ–çš„ MIPS TLB æ¡ç›®ã€‚ MIPS R4000 æ”¯æŒå…·æœ‰ 4KB é¡µçš„ 32 ä½åœ°å€ç©ºé—´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœŸæœ›åœ¨æˆ‘ä»¬çš„ç»å…¸è™šæ‹Ÿåœ°å€ä¸­æœ‰ 20 ä½ VPN å’Œ 12 ä½åç§»é‡ã€‚ç„¶è€Œï¼Œæ­£å¦‚æ‚¨åœ¨ TLB ä¸­çœ‹åˆ°çš„ï¼ŒVPN åªæœ‰ 19 ä½ï¼›äº‹å®è¯æ˜ï¼Œç”¨æˆ·åœ°å€ä»…æ¥è‡ªä¸€åŠçš„åœ°å€ç©ºé—´ï¼ˆå…¶ä½™éƒ¨åˆ†ä¸ºå†…æ ¸ä¿ç•™ï¼‰ï¼Œå› æ­¤åªéœ€è¦ 19 ä½çš„ VPNã€‚ VPN æœ€å¤šå¯è½¬æ¢ä¸º 24 ä½ç‰©ç†é¡µå· (PFN)ï¼Œå› æ­¤å¯ä»¥æ”¯æŒå…·æœ‰é«˜è¾¾ 64GBï¼ˆç‰©ç†ï¼‰ä¸»å†…å­˜ï¼ˆ224 ä¸ª 4KB é¡µï¼‰çš„ç³»ç»Ÿã€‚ MIPS TLB ä¸­è¿˜æœ‰ä¸€äº›å…¶ä»–æœ‰è¶£çš„ä½ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå…¨å±€ä½ï¼ˆGï¼‰ï¼Œå®ƒç”¨äºåœ¨è¿›ç¨‹ä¹‹é—´å…¨å±€å…±äº«çš„é¡µé¢ã€‚å› æ­¤ï¼Œå¦‚æœè®¾ç½®äº†å…¨å±€ä½ï¼Œåˆ™ ASID å°†è¢«å¿½ç•¥ã€‚æˆ‘ä»¬è¿˜çœ‹åˆ° 8 ä½ ASIDï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥åŒºåˆ†åœ°å€ç©ºé—´ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ã€‚æœ€åï¼Œæˆ‘ä»¬çœ‹åˆ° 3 ä¸ª Coherence (C) ä½ï¼Œå®ƒä»¬å†³å®šç¡¬ä»¶å¦‚ä½•ç¼“å­˜é¡µé¢ï¼›å½“é¡µé¢è¢«å†™å…¥æ—¶æ ‡è®°çš„è„ä½ï¼›ä¸€ä¸ªæœ‰æ•ˆä½ï¼Œå‘Šè¯‰ç¡¬ä»¶æ¡ç›®ä¸­æ˜¯å¦å­˜åœ¨æœ‰æ•ˆçš„è½¬æ¢ã€‚è¿˜æœ‰ä¸€ä¸ªé¡µé¢æ©ç å­—æ®µï¼ˆæœªæ˜¾ç¤ºï¼‰ï¼Œæ”¯æŒå¤šç§é¡µé¢å¤§å°ï¼›ç¨åæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸ºä»€ä¹ˆæ›´å¤§çš„é¡µé¢å¯èƒ½æœ‰ç”¨ã€‚æœ€åï¼Œè¿˜æœ‰éƒ¨åˆ†æœªä½¿ç”¨ã€‚ Flag Content 19-bit VPN å‰©ä½™éƒ¨åˆ†ä¿ç•™ç»™å†…æ ¸ã€‚ 24-bit PFN ç³»ç»Ÿæ”¯æŒæœ€å¤š64GBçš„ä¸»å­˜å‚¨ï¼ˆ$2^{24}\\times 4\\text{KB pages}$é¡µé¢ï¼‰ã€‚ Global bit(G) ç”¨äºåœ¨è¿›ç¨‹é—´å…±äº«çš„é¡µé¢ï¼ˆå¿½ç•¥ASIDï¼‰ã€‚ ASID æ“ä½œç³»ç»Ÿç”¨äºåŒºåˆ†åœ°å€ç©ºé—´çš„æ ‡è¯†ã€‚ Coherence bit(C) ç¡®å®šé¡µé¢å¦‚ä½•è¢«ç¡¬ä»¶ç¼“å­˜ Dirty bit(D) æ ‡è®°é¡µé¢æ˜¯å¦å·²è¢«å†™å…¥ Valid bit(V) å‘Šè¯‰ç¡¬ä»¶æ¡ç›®ä¸­æ˜¯å¦å­˜åœ¨æœ‰æ•ˆçš„è½¬æ¢ MIPS TLB é€šå¸¸æœ‰ 32 æˆ– 64 ä¸ªè¿™æ ·çš„æ¡ç›®ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†ç”±ç”¨æˆ·è¿›ç¨‹åœ¨è¿è¡Œæ—¶ä½¿ç”¨ã€‚ç„¶è€Œï¼Œæœ‰ä¸€äº›æ˜¯ä¸ºæ“ä½œç³»ç»Ÿä¿ç•™çš„ã€‚æ“ä½œç³»ç»Ÿå¯ä»¥è®¾ç½®ä¸€ä¸ªæœ‰çº¿å¯„å­˜å™¨æ¥å‘Šè¯‰ç¡¬ä»¶TLBè¦ä¸ºæ“ä½œç³»ç»Ÿä¿ç•™å¤šå°‘ä¸ªæ’æ§½ï¼›æ“ä½œç³»ç»Ÿå°†è¿™äº›ä¿ç•™çš„æ˜ å°„ç”¨äºå®ƒæƒ³è¦åœ¨å…³é”®æ—¶åˆ»è®¿é—®çš„ä»£ç å’Œæ•°æ®ï¼Œæ­¤æ—¶ TLB æœªå‘½ä¸­ä¼šå‡ºç°é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œåœ¨ TLB æœªå‘½ä¸­å¤„ç†ç¨‹åºä¸­ï¼‰ã€‚ ç”±äº MIPS TLB æ˜¯ç”±è½¯ä»¶ç®¡ç†çš„ï¼Œå› æ­¤éœ€è¦æœ‰æ›´æ–° TLB çš„æŒ‡ä»¤ã€‚ MIPS æä¾›äº†å››ç§è¿™æ ·çš„æŒ‡ä»¤ï¼š TLBPï¼šå®ƒæ¢æµ‹ TLB ä»¥æŸ¥çœ‹å…¶ä¸­æ˜¯å¦å­˜åœ¨ç‰¹å®šçš„è½¬æ¢ï¼› TLBRï¼šå°† TLB æ¡ç›®çš„å†…å®¹è¯»å…¥å¯„å­˜å™¨ï¼› TLBWIï¼šæ›¿æ¢ç‰¹å®šçš„ TLB æ¡ç›®ï¼› TLBWRï¼šå®ƒæ›¿æ¢éšæœº TLB æ¡ç›®ã€‚æ“ä½œç³»ç»Ÿä½¿ç”¨è¿™äº›æŒ‡ä»¤æ¥ç®¡ç† TLB çš„å†…å®¹ã€‚ å½“ç„¶ï¼Œè‡³å…³é‡è¦çš„æ˜¯è¿™äº›æŒ‡ä»¤å…·æœ‰ç‰¹æƒï¼›æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœç”¨æˆ·è¿›ç¨‹å¯ä»¥ä¿®æ”¹ TLB çš„å†…å®¹ï¼Œå®ƒä¼šåšä»€ä¹ˆï¼ˆæç¤ºï¼šå‡ ä¹ä»»ä½•äº‹æƒ…ï¼ŒåŒ…æ‹¬æ¥ç®¡æœºå™¨ã€è¿è¡Œè‡ªå·±çš„æ¶æ„â€œæ“ä½œç³»ç»Ÿâ€ï¼Œç”šè‡³è®© Sun æ¶ˆå¤±ï¼‰ã€‚ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:7:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 æ€»ç»“ æˆ‘ä»¬å·²ç»çœ‹åˆ°ç¡¬ä»¶å¦‚ä½•å¸®åŠ©æˆ‘ä»¬æ›´å¿«åœ°è¿›è¡Œåœ°å€è½¬æ¢ã€‚é€šè¿‡æä¾›å°å‹ä¸“ç”¨ç‰‡ä¸Š TLB ä½œä¸ºåœ°å€è½¬æ¢ç¼“å­˜ï¼Œå¤§å¤šæ•°å†…å­˜å¼•ç”¨æœ‰æœ›åœ¨æ— éœ€è®¿é—®ä¸»å†…å­˜ä¸­çš„é¡µè¡¨çš„æƒ…å†µä¸‹å¾—åˆ°å¤„ç†ã€‚å› æ­¤ï¼Œåœ¨å¸¸è§æƒ…å†µä¸‹ï¼Œç¨‹åºçš„æ€§èƒ½å‡ ä¹å°±åƒå†…å­˜æ ¹æœ¬æ²¡æœ‰è¢«è™šæ‹ŸåŒ–ä¸€æ ·ï¼Œè¿™å¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´æ˜¯ä¸€é¡¹å‡ºè‰²çš„æˆå°±ï¼Œå¹¶ä¸”å¯¹äºç°ä»£ç³»ç»Ÿä¸­åˆ†é¡µçš„ä½¿ç”¨å½“ç„¶è‡³å…³é‡è¦ã€‚ ç„¶è€Œï¼ŒTLB å¹¶æ²¡æœ‰è®©æ¯ä¸ªç°æœ‰çš„ç¨‹åºéƒ½å˜å¾—ç¾å¥½ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœç¨‹åºåœ¨çŸ­æ—¶é—´å†…è®¿é—®çš„é¡µæ•°è¶…è¿‡äº†TLBæ‰€èƒ½å®¹çº³çš„é¡µæ•°ï¼Œåˆ™ç¨‹åºå°†äº§ç”Ÿå¤§é‡çš„TLBæœªå‘½ä¸­ï¼Œä»è€Œè¿è¡Œé€Ÿåº¦ä¼šå˜å¾—ç›¸å½“æ…¢ã€‚æˆ‘ä»¬å°†è¿™ç§ç°è±¡ç§°ä¸ºè¶…å‡º TLB è¦†ç›–èŒƒå›´ï¼Œå¯¹äºæŸäº›ç¨‹åºæ¥è¯´è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ã€‚ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯æ”¯æŒæ›´å¤§çš„é¡µé¢å¤§å°ï¼›é€šè¿‡å°†å…³é”®æ•°æ®ç»“æ„æ˜ å°„åˆ°ç¨‹åºåœ°å€ç©ºé—´ä¸­ç”±è¾ƒå¤§é¡µé¢æ˜ å°„çš„åŒºåŸŸï¼Œå¯ä»¥å¢åŠ  TLB çš„æœ‰æ•ˆè¦†ç›–èŒƒå›´ã€‚å¯¹å¤§é¡µé¢çš„æ”¯æŒé€šå¸¸ç”±è¯¸å¦‚æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ä¹‹ç±»çš„ç¨‹åºåˆ©ç”¨ï¼Œè¿™äº›ç¨‹åºå…·æœ‰æŸäº›æ—¢å¤§åˆéšæœºè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ å¦ä¸€ä¸ªå€¼å¾—ä¸€æçš„ TLB é—®é¢˜æ˜¯ï¼šTLB è®¿é—®å¾ˆå®¹æ˜“æˆä¸º CPU ç®¡é“ä¸­çš„ç“¶é¢ˆï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ‰€è°“çš„ç‰©ç†ç´¢å¼•ç¼“å­˜ã€‚å¯¹äºè¿™æ ·çš„ç¼“å­˜ï¼Œå¿…é¡»åœ¨è®¿é—®ç¼“å­˜ä¹‹å‰è¿›è¡Œåœ°å€è½¬æ¢ï¼Œè¿™ä¼šå¤§å¤§å‡æ…¢é€Ÿåº¦ã€‚ç”±äºè¿™ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼Œäººä»¬ç ”ç©¶äº†å„ç§å·§å¦™çš„æ–¹æ³•æ¥ä½¿ç”¨è™šæ‹Ÿåœ°å€è®¿é—®ç¼“å­˜ï¼Œä»è€Œé¿å…ç¼“å­˜å‘½ä¸­æ—¶æ˜‚è´µçš„è½¬æ¢æ­¥éª¤ã€‚è¿™ç§è™šæ‹Ÿç´¢å¼•ç¼“å­˜è§£å†³äº†ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œä½†ä¹Ÿç»™ç¡¬ä»¶è®¾è®¡å¸¦æ¥äº†æ–°é—®é¢˜ã€‚ å·¨å‹é¡µé¢ï¼ˆ2MB é¡µé¢ï¼‰ åƒå…†é¡µé¢ï¼ˆ1GB é¡µé¢ï¼‰ æœ€å…ˆè¿›çš„ TLBï¼ˆAMD Zen4ï¼‰ ","date":"2024-04-25","objectID":"/posts/14.%E5%BF%AB%E8%A1%A8/:8:0","tags":["OS"],"title":"å¿«è¡¨","uri":"/posts/14.%E5%BF%AB%E8%A1%A8/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"æœ‰æ—¶æœ‰äººè¯´ï¼Œæ“ä½œç³»ç»Ÿåœ¨è§£å†³å¤§å¤šæ•°ç©ºé—´ç®¡ç†é—®é¢˜æ—¶ä¼šé‡‡ç”¨ä¸¤ç§æ–¹æ³•ä¹‹ä¸€ã€‚ç¬¬ä¸€ç§æ–¹æ³•æ˜¯å°†äº‹ç‰©åˆ‡æˆå¯å˜å¤§å°çš„å—ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„åˆ†æ®µä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªè§£å†³æ–¹æ¡ˆæœ‰å…¶å›ºæœ‰çš„å›°éš¾ã€‚ç‰¹åˆ«æ˜¯ï¼Œå½“å°†ç©ºé—´åˆ’åˆ†ä¸ºä¸åŒå¤§å°çš„å—æ—¶ï¼Œç©ºé—´æœ¬èº«å¯èƒ½ä¼šå˜å¾—ç¢ç‰‡åŒ–ï¼Œå› æ­¤éšç€æ—¶é—´çš„æ¨ç§»ï¼Œåˆ†é…å˜å¾—æ›´å…·æŒ‘æˆ˜æ€§ã€‚ å› æ­¤ï¼Œå¯èƒ½å€¼å¾—è€ƒè™‘ç¬¬äºŒç§æ–¹æ³•ï¼šå°†ç©ºé—´åˆ‡æˆå›ºå®šå¤§å°çš„å—ã€‚åœ¨è™šæ‹Ÿå†…å­˜ä¸­ï¼Œæˆ‘ä»¬å°†è¿™ç§æƒ³æ³•ç§°ä¸ºåˆ†é¡µï¼Œå®ƒå¯ä»¥è¿½æº¯åˆ°ä¸€ä¸ªæ—©æœŸä¸”é‡è¦çš„ç³»ç»Ÿï¼ŒAtlasã€‚æˆ‘ä»¬ä¸æ˜¯å°†è¿›ç¨‹çš„åœ°å€ç©ºé—´åˆ’åˆ†ä¸ºä¸€å®šæ•°é‡çš„å¯å˜å¤§å°çš„é€»è¾‘æ®µï¼ˆä¾‹å¦‚ä»£ç ã€å †ã€æ ˆï¼‰ï¼Œè€Œæ˜¯å°†å…¶åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„å•å…ƒï¼Œæ¯ä¸ªå•å…ƒç§°ä¸ºé¡µé¢ã€‚ç›¸åº”åœ°ï¼Œæˆ‘ä»¬å°†ç‰©ç†å†…å­˜è§†ä¸ºä¸€ç»„å›ºå®šå¤§å°çš„æ§½ï¼ˆç§°ä¸ºé¡µæ¡†ï¼‰ï¼›æ¯ä¸ªæ¡†éƒ½å¯ä»¥åŒ…å«ä¸€ä¸ªè™šæ‹Ÿå†…å­˜é¡µï¼›æ¯ä¸ªè¿›ç¨‹éƒ½éœ€è¦é¡µè¡¨æ¥å°†è™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚ã€‚æˆ‘ä»¬çš„æŒ‘æˆ˜ï¼š å…³é”®ï¼šå¦‚ä½•ä½¿ç”¨é¡µé¢è™šæ‹ŸåŒ–å†…å­˜ ? å¦‚ä½•ä½¿ç”¨é¡µé¢è™šæ‹ŸåŒ–å†…å­˜ï¼Œä»è€Œé¿å…åˆ†æ®µé—®é¢˜ï¼Ÿæœ‰å“ªäº›åŸºæœ¬æŠ€æœ¯ï¼Ÿæˆ‘ä»¬å¦‚ä½•ä»¥æœ€å°çš„ç©ºé—´å’Œæ—¶é—´å¼€é”€ä½¿è¿™äº›æŠ€æœ¯å‘æŒ¥è‰¯å¥½ä½œç”¨ï¼Ÿ ","date":"2024-04-25","objectID":"/posts/13.%E9%A1%B5/:0:0","tags":["OS"],"title":"é¡µ","uri":"/posts/13.%E9%A1%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ç¤ºä¾‹ï¼šä¸€ä¸ªç®€å•çš„åˆ†é¡µ ä¸ºäº†æ›´æ¸…æ¥šåœ°è¯´æ˜è¿™ç§æ–¹æ³•ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªå¾ˆå°çš„åœ°å€ç©ºé—´ï¼Œæ€»å¤§å°åªæœ‰ 64 å­—èŠ‚ï¼Œæœ‰å››ä¸ª 16 å­—èŠ‚çš„é¡µé¢ï¼ˆè™šæ‹Ÿé¡µé¢ 0ã€1ã€2 å’Œ 3ï¼‰ã€‚ å½“ç„¶ï¼ŒçœŸå®çš„åœ°å€ç©ºé—´è¦å¤§å¾—å¤šï¼Œé€šå¸¸ä¸º 32 ä½ï¼Œå› æ­¤æœ‰ 4GB çš„åœ°å€ç©ºé—´ï¼Œç”šè‡³ 64 ä½ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç‰©ç†å†…å­˜ä¹Ÿç”±è®¸å¤šå›ºå®šå¤§å°çš„æ§½ç»„æˆï¼Œåœ¨æœ¬ä¾‹ä¸­æ˜¯ 8 ä¸ªé¡µæ¡†ï¼ˆå¯¹äº 128 å­—èŠ‚çš„ç‰©ç†å†…å­˜æ¥è¯´ï¼Œä¹Ÿå°å¾—ç¦»è°±ï¼‰ã€‚è™šæ‹Ÿåœ°å€ç©ºé—´çš„é¡µé¢è¢«æ”¾ç½®åœ¨æ•´ä¸ªç‰©ç†å†…å­˜çš„ä¸åŒä½ç½®ï¼›è¯¥å›¾è¿˜æ˜¾ç¤ºæ“ä½œç³»ç»Ÿè‡ªèº«ä½¿ç”¨ä¸€äº›ç‰©ç†å†…å­˜ã€‚ æ­£å¦‚æˆ‘ä»¬å°†çœ‹åˆ°çš„ï¼Œåˆ†é¡µæ¯”æˆ‘ä»¬ä»¥å‰çš„æ–¹æ³•æœ‰è®¸å¤šä¼˜ç‚¹ã€‚æœ€é‡è¦çš„æ”¹è¿›å¯èƒ½æ˜¯çµæ´»æ€§ï¼šé€šè¿‡å®Œå…¨å¼€å‘çš„åˆ†é¡µæ–¹æ³•ï¼Œç³»ç»Ÿå°†èƒ½å¤Ÿæœ‰æ•ˆåœ°æ”¯æŒåœ°å€ç©ºé—´çš„æŠ½è±¡ï¼Œæ— è®ºè¿›ç¨‹å¦‚ä½•ä½¿ç”¨åœ°å€ç©ºé—´ï¼›ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¸ä¼šå¯¹å †å’Œæ ˆçš„å¢é•¿æ–¹å‘ä»¥åŠå®ƒä»¬çš„ä½¿ç”¨æ–¹å¼åšå‡ºå‡è®¾ã€‚ å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯åˆ†é¡µæä¾›çš„å¯ç”¨ç©ºé—´ç®¡ç†çš„ç®€å•æ€§ã€‚ä¾‹å¦‚ï¼Œå½“æ“ä½œç³»ç»Ÿå¸Œæœ›å°†æˆ‘ä»¬å¾®å°çš„ 64 å­—èŠ‚åœ°å€ç©ºé—´æ”¾å…¥æˆ‘ä»¬çš„å…«é¡µç‰©ç†å†…å­˜ä¸­æ—¶ï¼Œå®ƒåªä¼šæ‰¾åˆ°å››ä¸ªç©ºé—²é¡µï¼›ä¹Ÿè®¸æ“ä½œç³»ç»Ÿä¸ºæ­¤ä¿ç•™äº†æ‰€æœ‰ç©ºé—²é¡µé¢çš„ç©ºé—²åˆ—è¡¨ï¼Œå¹¶ä¸”åªä»è¯¥åˆ—è¡¨ä¸­è·å–å‰å››ä¸ªç©ºé—²é¡µé¢ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œæ“ä½œç³»ç»Ÿå·²å°†åœ°å€ç©ºé—´ (AS) çš„è™šæ‹Ÿé¡µ 0 æ”¾ç½®åœ¨ç‰©ç†é¡µ 3 ä¸­ï¼Œå°† AS çš„è™šæ‹Ÿé¡µ 1 æ”¾ç½®åœ¨ç‰©ç†é¡µ7 ä¸­ï¼Œå°†é¡µ 2 æ”¾ç½®åœ¨ç‰©ç†é¡µ 5 ä¸­ï¼Œå°†é¡µ 3 æ”¾ç½®åœ¨ç‰©ç†é¡µ 2 ä¸­ã€‚ é¡µæ¡† 1 ã€4 å’Œ 6 ç›®å‰ç©ºé—²ã€‚ ä¸ºäº†è®°å½•åœ°å€ç©ºé—´çš„æ¯ä¸ªè™šæ‹Ÿé¡µåœ¨ç‰©ç†å†…å­˜ä¸­çš„ä½ç½®ï¼Œæ“ä½œç³»ç»Ÿé€šå¸¸ä¼šä¸ºæ¯ä¸ªè¿›ç¨‹ä¿å­˜ä¸€ä¸ªåä¸ºé¡µè¡¨çš„æ•°æ®ç»“æ„ã€‚é¡µè¡¨çš„ä¸»è¦ä½œç”¨æ˜¯å­˜å‚¨åœ°å€ç©ºé—´ä¸­æ¯ä¸ªè™šæ‹Ÿé¡µçš„åœ°å€è½¬æ¢ï¼Œä»è€Œè®©æˆ‘ä»¬çŸ¥é“æ¯ä¸ªé¡µä½äºç‰©ç†å†…å­˜ä¸­çš„ä½ç½®ã€‚å¯¹äºæˆ‘ä»¬çš„ç®€å•ç¤ºä¾‹ï¼Œé¡µè¡¨å°†å…·æœ‰ä»¥ä¸‹å››ä¸ªæ¡ç›®ï¼šï¼ˆè™šæ‹Ÿé¡µ 0 â†’ ç‰©ç†é¡µ3ï¼‰ã€ï¼ˆVP 1 â†’ PF 7ï¼‰ã€ï¼ˆVP 2 â†’ PF 5ï¼‰å’Œï¼ˆVP 3 â†’ PF 2ï¼‰ã€‚ é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œè¿™ä¸ªé¡µè¡¨æ˜¯ä¸€ä¸ªæ¯ä¸ªè¿›ç¨‹çš„æ•°æ®ç»“æ„ï¼ˆæˆ‘ä»¬è®¨è®ºçš„å¤§å¤šæ•°é¡µè¡¨ç»“æ„éƒ½æ˜¯æ¯ä¸ªè¿›ç¨‹çš„ç»“æ„ï¼›æˆ‘ä»¬å°†æåˆ°ä¸€ä¸ªä¾‹å¤–ï¼Œå³åå‘é¡µè¡¨ï¼‰ã€‚å¦‚æœåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­è¿è¡Œå¦ä¸€ä¸ªè¿›ç¨‹ï¼Œåˆ™æ“ä½œç³»ç»Ÿå¿…é¡»ä¸ºå…¶ç®¡ç†ä¸åŒçš„é¡µè¡¨ï¼Œå› ä¸ºå®ƒçš„è™šæ‹Ÿé¡µé¢æ˜¾ç„¶æ˜ å°„åˆ°ä¸åŒçš„ç‰©ç†é¡µé¢ï¼ˆé™¤éæœ‰ä»»ä½•å…±äº«æ­£åœ¨è¿›è¡Œï¼‰ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“è¶³å¤Ÿå¤šä»¥æ‰§è¡Œåœ°å€è½¬æ¢ç¤ºä¾‹ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹å…·æœ‰å¾®å°åœ°å€ç©ºé—´ï¼ˆ64å­—èŠ‚ï¼‰çš„è¿›ç¨‹æ­£åœ¨æ‰§è¡Œå†…å­˜è®¿é—®ï¼š movl \u003cvirtual address\u003e, %eax å…·ä½“æ¥è¯´ï¼Œè®©æˆ‘ä»¬æ³¨æ„å°†æ•°æ®ä»åœ°å€\u003cvirtual address\u003eæ˜¾å¼åŠ è½½åˆ°å¯„å­˜å™¨ eax ä¸­ï¼ˆä»è€Œå¿½ç•¥ä¹‹å‰å¿…é¡»å‘ç”Ÿçš„æŒ‡ä»¤è·å–ï¼‰ã€‚ ä¸ºäº†è½¬æ¢è¿›ç¨‹ç”Ÿæˆçš„è™šæ‹Ÿåœ°å€ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆå°†å…¶åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šè™šæ‹Ÿé¡µå·ï¼ˆVitrual page number,VPNï¼‰å’Œé¡µé¢å†…çš„åç§»é‡ã€‚å¯¹äºæ­¤ç¤ºä¾‹ï¼Œç”±äºè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸º 64 å­—èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬çš„è™šæ‹Ÿåœ°å€æ€»å…±éœ€è¦ 6 ä½ ($2^6 = 64$)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„è™šæ‹Ÿåœ°å€å¯ä»¥æ¦‚å¿µåŒ–å¦‚ä¸‹ï¼š å…¶ä¸­ï¼ŒVa5æ˜¯è™šæ‹Ÿåœ°å€çš„æœ€é«˜ä½ï¼ŒVa0æ˜¯æœ€ä½ä½ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“é¡µé¢å¤§å°ï¼ˆ16å­—èŠ‚ï¼‰ï¼Œåˆ™å‰ä¸¤ä½ä»£è¡¨è™šæ‹Ÿé¡µå·ï¼Œåå››ä½ä»£è¡¨é¡µé¢åç§»é‡ã€‚åœ¨ 64 å­—èŠ‚åœ°å€ç©ºé—´ä¸­ï¼Œé¡µé¢å¤§å°ä¸º 16 å­—èŠ‚ï¼›å› æ­¤æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿé€‰æ‹© 4 ä¸ªé¡µé¢ï¼Œåœ°å€çš„å‰ 2 ä½å°±å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª 2 ä½è™šæ‹Ÿé¡µç  (VPN)ã€‚å‰©ä½™çš„ä½åˆ™è¡¨ç¤ºé¡µé¢åç§»é‡ã€‚ å½“è¿›ç¨‹ç”Ÿæˆè™šæ‹Ÿåœ°å€æ—¶ï¼Œæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¿…é¡»ç»“åˆèµ·æ¥å°†å…¶è½¬æ¢ä¸ºæœ‰æ„ä¹‰çš„ç‰©ç†åœ°å€ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸Šè¿°åŠ è½½åˆ°è™šæ‹Ÿåœ°å€ 21ï¼š movl 21, %eax å°†â€œ21â€è½¬æ¢ä¸ºäºŒè¿›åˆ¶å½¢å¼ï¼Œæˆ‘ä»¬å¾—åˆ°â€œ010101â€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¿™ä¸ªè™šæ‹Ÿåœ°å€å¹¶æŸ¥çœ‹å®ƒå¦‚ä½•åˆ†è§£ä¸ºè™šæ‹Ÿé¡µå·ï¼ˆVPNï¼‰å’Œåç§»é‡ï¼š å› æ­¤ï¼Œè™šæ‹Ÿåœ°å€â€œ21â€ä½äºè™šæ‹Ÿé¡µâ€œ01â€ï¼ˆæˆ–1ï¼‰çš„ç¬¬5ï¼ˆâ€œ0101â€ï¼‰å­—èŠ‚ã€‚æœ‰äº†è™šæ‹Ÿé¡µå·ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç´¢å¼•é¡µè¡¨å¹¶æ‰¾åˆ°è™šæ‹Ÿé¡µ 1 æ‰€åœ¨çš„ç‰©ç†é¡µã€‚åœ¨ä¸Šé¢çš„é¡µè¡¨ä¸­ï¼Œç‰©ç†é¡µå· (Physical page number, PPN)ï¼ˆæœ‰æ—¶ä¹Ÿç§°ä¸ºç‰©ç†å¸§å·æˆ– PFNï¼‰ä¸º 7ï¼ˆäºŒè¿›åˆ¶ 111ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç”¨ PPN æ›¿æ¢ VPN æ¥è½¬æ¢è¿™ä¸ªè™šæ‹Ÿåœ°å€ï¼Œç„¶åå‘ç‰©ç†å†…å­˜åŠ è½½æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è¯·æ³¨æ„ï¼Œåç§»é‡ä¿æŒä¸å˜ï¼ˆå³ï¼Œå®ƒæ²¡æœ‰è¢«è½¬æ¢ï¼‰ï¼Œå› ä¸ºåç§»é‡åªæ˜¯å‘Šè¯‰æˆ‘ä»¬æˆ‘ä»¬æƒ³è¦é¡µé¢ä¸­çš„å“ªä¸ªå­—èŠ‚ã€‚æˆ‘ä»¬çš„æœ€ç»ˆç‰©ç†åœ°å€æ˜¯ 1110101ï¼ˆåè¿›åˆ¶ä¸º 117ï¼‰ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬å¸Œæœ›åŠ è½½è·å–æ•°æ®çš„ä½ç½®ã€‚ ","date":"2024-04-25","objectID":"/posts/13.%E9%A1%B5/:1:0","tags":["OS"],"title":"é¡µ","uri":"/posts/13.%E9%A1%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 é¡µè¡¨å­˜å‚¨åœ¨å“ªï¼Ÿ é¡µè¡¨å¯ä»¥å˜å¾—éå¸¸å¤§ï¼Œæ¯”æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„å°åˆ†æ®µè¡¨æˆ–åŸºå€/è¾¹ç•Œå¯¹å¤§å¾—å¤šã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸ªå…¸å‹çš„ 32 ä½åœ°å€ç©ºé—´ï¼Œå…·æœ‰ 4KB é¡µé¢ã€‚è¯¥è™šæ‹Ÿåœ°å€åˆ†ä¸º 20 ä½ VPN å’Œ 12 ä½åç§»é‡ï¼ˆå›æƒ³ä¸€ä¸‹ï¼Œ1KB é¡µé¢å¤§å°éœ€è¦ 10 ä½ï¼Œåªéœ€å†æ·»åŠ ä¸¤ä½å³å¯è¾¾åˆ° 4KBï¼‰ã€‚ 20 ä½ VPN æ„å‘³ç€æ“ä½œç³»ç»Ÿå¿…é¡»ä¸ºæ¯ä¸ªè¿›ç¨‹ç®¡ç† $2^{20}$ ä¸ªè½¬æ¢ï¼ˆå¤§çº¦ä¸€ç™¾ä¸‡ä¸ªï¼‰ï¼›å‡è®¾æ¯ä¸ªé¡µè¡¨é¡¹ (page table entry, PTE) éœ€è¦ 4 ä¸ªå­—èŠ‚æ¥ä¿å­˜ç‰©ç†è½¬æ¢ä»¥åŠä»»ä½•å…¶ä»–æœ‰ç”¨çš„å†…å®¹ï¼Œé‚£ä¹ˆæ¯ä¸ªé¡µè¡¨éœ€è¦ 4MB çš„å·¨å¤§å†…å­˜ï¼é‚£æ˜¯ç›¸å½“å¤§çš„ã€‚ç°åœ¨å‡è®¾æœ‰ 100 ä¸ªè¿›ç¨‹æ­£åœ¨è¿è¡Œï¼šè¿™æ„å‘³ç€æ“ä½œç³»ç»Ÿéœ€è¦ 400MB å†…å­˜æ¥ç”¨äºæ‰€æœ‰è¿™äº›åœ°å€è½¬æ¢ï¼å³ä½¿åœ¨æœºå™¨æ‹¥æœ‰åƒå…†å­—èŠ‚å†…å­˜çš„ç°ä»£ï¼Œå°†å¤§é‡å†…å­˜ç”¨äºåœ°å€è½¬æ¢ä¼¼ä¹ä¹Ÿæœ‰ç‚¹ç–¯ç‹‚ï¼Œä¸æ˜¯å—ï¼Ÿæˆ‘ä»¬ç”šè‡³æ²¡æœ‰è€ƒè™‘å¯¹äº 64 ä½åœ°å€ç©ºé—´æ¥è¯´è¿™æ ·çš„é¡µè¡¨æœ‰å¤šå¤§ï¼›é‚£å¤ªå¯æ€•äº†ï¼Œä¹Ÿè®¸ä¼šæŠŠä½ å®Œå…¨å“è·‘ã€‚ ç”±äºé¡µè¡¨å¤ªå¤§ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨MMUä¸­ä¿ç•™ä»»ä½•ç‰¹æ®Šçš„ç‰‡ä¸Šç¡¬ä»¶æ¥å­˜å‚¨å½“å‰è¿è¡Œè¿›ç¨‹çš„é¡µè¡¨ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†æ¯ä¸ªè¿›ç¨‹çš„é¡µè¡¨å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æŸä¸ªä½ç½®ã€‚ç°åœ¨æˆ‘ä»¬å‡è®¾é¡µè¡¨ä½äºæ“ä½œç³»ç»Ÿç®¡ç†çš„ç‰©ç†å†…å­˜ä¸­ï¼Œä¸‹å›¾æ˜¯æ“ä½œç³»ç»Ÿå†…å­˜ä¸­é¡µè¡¨çš„å›¾ç‰‡ã€‚ ","date":"2024-04-25","objectID":"/posts/13.%E9%A1%B5/:2:0","tags":["OS"],"title":"é¡µ","uri":"/posts/13.%E9%A1%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 é¡µè¡¨ä¸­åˆ°åº•æœ‰ä»€ä¹ˆï¼Ÿ è®©æˆ‘ä»¬æ¥è°ˆè°ˆé¡µè¡¨çš„ç»„ç»‡ç»“æ„ã€‚é¡µè¡¨åªæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºå°†è™šæ‹Ÿåœ°å€ï¼ˆæˆ–å®é™…ä¸Šæ˜¯è™šæ‹Ÿé¡µç ï¼‰æ˜ å°„åˆ°ç‰©ç†åœ°å€ï¼ˆç‰©ç†é¡µå·ï¼‰ã€‚å› æ­¤ï¼Œä»»ä½•æ•°æ®ç»“æ„éƒ½å¯ä»¥ä½¿ç”¨ã€‚æœ€ç®€å•çš„å½¢å¼ç§°ä¸ºçº¿æ€§é¡µè¡¨ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æ“ä½œç³»ç»Ÿæ ¹æ®è™šæ‹Ÿé¡µç ï¼ˆVPNï¼‰å¯¹æ•°ç»„è¿›è¡Œç´¢å¼•ï¼Œå¹¶æŸ¥æ‰¾è¯¥ç´¢å¼•ä¸‹çš„é¡µè¡¨é¡¹ï¼ˆPTEï¼‰ï¼Œä»¥æ‰¾åˆ°æ‰€éœ€çš„ç‰©ç†é¡µå·ï¼ˆPFNï¼‰ã€‚ç›®å‰ï¼Œæˆ‘ä»¬å°†å‡è®¾è¿™ç§ç®€å•çš„çº¿æ€§ç»“æ„ï¼›åœ¨åé¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ›´é«˜çº§çš„æ•°æ®ç»“æ„æ¥å¸®åŠ©è§£å†³åˆ†é¡µä¸­çš„ä¸€äº›é—®é¢˜ã€‚ è‡³äºæ¯ä¸ª PTE çš„å†…å®¹ï¼Œæˆ‘ä»¬æœ‰è®¸å¤šä¸åŒçš„bitä½å€¼å¾—åœ¨ä¸€å®šç¨‹åº¦ä¸Šäº†è§£ã€‚æœ‰æ•ˆä½é€šå¸¸ç”¨äºæŒ‡ç¤ºç‰¹å®šè½¬æ¢æ˜¯å¦æœ‰æ•ˆã€‚ä¾‹å¦‚ï¼Œå½“ç¨‹åºå¼€å§‹è¿è¡Œæ—¶ï¼Œå…¶åœ°å€ç©ºé—´çš„ä¸€ç«¯æ˜¯ä»£ç å’Œå †ï¼Œå¦ä¸€ç«¯æ˜¯æ ˆã€‚ä¸­é—´æ‰€æœ‰æœªä½¿ç”¨çš„ç©ºé—´éƒ½ä¼šè¢«æ ‡è®°ä¸ºæ— æ•ˆï¼Œå¦‚æœè¿›ç¨‹è¯•å›¾è®¿é—®è¿™äº›å†…å­˜ï¼Œå°±ä¼šå‘æ“ä½œç³»ç»Ÿå‘å‡ºä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿå¾ˆå¯èƒ½ä¼šç»ˆæ­¢è¿›ç¨‹ã€‚å› æ­¤ï¼Œæœ‰æ•ˆä½å¯¹äºæ”¯æŒç¨€ç–åœ°å€ç©ºé—´è‡³å…³é‡è¦ï¼›åªéœ€å°†åœ°å€ç©ºé—´ä¸­æ‰€æœ‰æœªä½¿ç”¨çš„é¡µé¢æ ‡è®°ä¸ºæ— æ•ˆï¼Œæˆ‘ä»¬å°±æ— éœ€ä¸ºè¿™äº›é¡µé¢åˆ†é…ç‰©ç†é¡µå·ï¼Œä»è€ŒèŠ‚çœäº†å¤§é‡å†…å­˜ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¿æŠ¤ä½æ¥è¡¨æ˜æ˜¯å¦å¯ä»¥è¯»å–ã€å†™å…¥æˆ–æ‰§è¡Œé¡µé¢ã€‚åŒæ ·ï¼Œå¦‚æœä»¥è¿™äº›ä½ä¸å…è®¸çš„æ–¹å¼è®¿é—®é¡µé¢ï¼Œå°±ä¼šå‘æ“ä½œç³»ç»Ÿå‘å‡ºä¸­æ–­ã€‚ è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ä½ä¹Ÿå¾ˆé‡è¦ï¼Œä½†æˆ‘ä»¬ç°åœ¨å°±ä¸å¤šè¯´äº†ã€‚å­˜åœ¨ä½è¡¨ç¤ºè¯¥é¡µé¢æ˜¯åœ¨ç‰©ç†å†…å­˜ä¸­è¿˜æ˜¯åœ¨ç£ç›˜ä¸Šï¼ˆå³å·²è¢«æ¢å‡ºï¼‰ã€‚å½“æˆ‘ä»¬ç ”ç©¶å¦‚ä½•å°†éƒ¨åˆ†åœ°å€ç©ºé—´äº¤æ¢åˆ°ç£ç›˜ä»¥æ”¯æŒæ¯”ç‰©ç†å†…å­˜æ›´å¤§çš„åœ°å€ç©ºé—´æ—¶ï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥äº†è§£è¿™ä¸€æœºåˆ¶ï¼›äº¤æ¢å…è®¸æ“ä½œç³»ç»Ÿé€šè¿‡å°†å¾ˆå°‘ä½¿ç”¨çš„é¡µé¢ç§»åŠ¨åˆ°ç£ç›˜æ¥é‡Šæ”¾ç‰©ç†å†…å­˜ã€‚**è„ä½ï¼ˆdirty bitï¼‰**ä¹Ÿå¾ˆå¸¸è§ï¼Œè¡¨ç¤ºé¡µé¢è¿›å…¥å†…å­˜åæ˜¯å¦è¢«ä¿®æ”¹è¿‡ã€‚ å‚è€ƒä½ï¼ˆåˆç§°è®¿é—®ä½ï¼‰æœ‰æ—¶ç”¨äºè·Ÿè¸ªé¡µé¢æ˜¯å¦è¢«è®¿é—®è¿‡ï¼Œå®ƒæœ‰åŠ©äºç¡®å®šå“ªäº›é¡µé¢å—æ¬¢è¿ï¼Œå› æ­¤åº”ä¿ç•™åœ¨å†…å­˜ä¸­ï¼›åœ¨é¡µé¢æ›¿æ¢è¿‡ç¨‹ä¸­ï¼Œè¿™ç§çŸ¥è¯†è‡³å…³é‡è¦ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº† x86 æ¶æ„ä¸­çš„ä¸€ä¸ªé¡µè¡¨æ¡ç›®ç¤ºä¾‹ã€‚å®ƒåŒ…å«ä¸€ä¸ªå­˜åœ¨ä½ (P)ï¼›ä¸€ä¸ªè¯»/å†™ä½ (R/W)ï¼Œç”¨äºç¡®å®šæ˜¯å¦å…è®¸å†™å…¥è¯¥é¡µé¢ï¼›ä¸€ä¸ªç”¨æˆ·/ç›‘ç®¡è€…ä½ (U/S)ï¼Œç”¨äºç¡®å®šç”¨æˆ·æ¨¡å¼è¿›ç¨‹æ˜¯å¦å¯ä»¥è®¿é—®è¯¥é¡µé¢ï¼›å‡ ä¸ªä½ï¼ˆPWTã€PCDã€PAT å’Œ Gï¼‰ï¼Œç”¨äºç¡®å®šè¿™äº›é¡µé¢çš„ç¡¬ä»¶ç¼“å­˜å·¥ä½œæ–¹å¼ï¼›ä¸€ä¸ªå·²è®¿é—®ä½ (A) å’Œä¸€ä¸ªè„ä½ (D)ï¼›æœ€åæ˜¯ç‰©ç†é¡µå·ï¼ˆPFNï¼‰æœ¬èº«ã€‚ ","date":"2024-04-25","objectID":"/posts/13.%E9%A1%B5/:3:0","tags":["OS"],"title":"é¡µ","uri":"/posts/13.%E9%A1%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 åˆ†é¡µï¼šä¹Ÿå¤ªæ…¢ å¯¹äºå†…å­˜ä¸­çš„é¡µè¡¨ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å®ƒä»¬å¯èƒ½è¿‡å¤§ã€‚äº‹å®è¯æ˜ï¼Œå®ƒä»¬ä¹Ÿä¼šæ‹–æ…¢è¿è¡Œé€Ÿåº¦ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š movl 21, %eax åŒæ ·ï¼Œæˆ‘ä»¬åªæ£€æŸ¥å¯¹åœ°å€ 21 çš„æ˜¾å¼å¼•ç”¨ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå–æŒ‡ä»¤ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ç¡¬ä»¶ä¸ºæˆ‘ä»¬æ‰§è¡Œåœ°å€è½¬æ¢ã€‚ä¸ºäº†è·å–æ‰€éœ€çš„æ•°æ®ï¼Œç³»ç»Ÿå¿…é¡»é¦–å…ˆå°†è™šæ‹Ÿåœ°å€ï¼ˆ21ï¼‰è½¬æ¢ä¸ºæ­£ç¡®çš„ç‰©ç†åœ°å€ï¼ˆ117ï¼‰ã€‚å› æ­¤ï¼Œåœ¨ä»åœ°å€ 117 è·å–æ•°æ®ä¹‹å‰ï¼Œç³»ç»Ÿå¿…é¡»é¦–å…ˆä»è¿›ç¨‹çš„é¡µè¡¨ä¸­è·å–æ­£ç¡®çš„é¡µè¡¨æ¡ç›®ï¼Œæ‰§è¡Œè½¬æ¢ï¼Œç„¶åä»ç‰©ç†å†…å­˜åŠ è½½æ•°æ®ã€‚ ä¸ºæ­¤ï¼Œç¡¬ä»¶å¿…é¡»çŸ¥é“å½“å‰è¿è¡Œè¿›ç¨‹çš„é¡µè¡¨åœ¨å“ªé‡Œã€‚ç°åœ¨æˆ‘ä»¬å‡è®¾å•ä¸ªé¡µè¡¨åŸºå€å¯„å­˜å™¨åŒ…å«é¡µè¡¨èµ·å§‹ä½ç½®çš„ç‰©ç†åœ°å€ã€‚ä¸ºäº†æ‰¾åˆ°æ‰€éœ€ PTE çš„ä½ç½®ï¼Œç¡¬ä»¶å°†æ‰§è¡Œä»¥ä¸‹åŠŸèƒ½ï¼š VPN = (VirtualAddress \u0026 VPN_MASK) \u003e\u003e SHIFT PTEAddr = PageTableBaseRegister + (VPN * sizeof(PTE)) åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒVPN_MASK å°†è®¾ç½®ä¸º 0x30ï¼ˆåå…­è¿›åˆ¶ 30ï¼Œæˆ–äºŒè¿›åˆ¶ 110000ï¼‰ï¼Œå®ƒä»å®Œæ•´è™šæ‹Ÿåœ°å€ä¸­æŒ‘é€‰å‡º VPN ä½ï¼› SHIFT è®¾ç½®ä¸º 4ï¼ˆåç§»é‡ä¸­çš„ä½æ•°ï¼‰ï¼Œä»¥ä¾¿æˆ‘ä»¬å°† VPN ä½å‘ä¸‹ç§»åŠ¨ä»¥å½¢æˆæ­£ç¡®çš„æ•´æ•°è™šæ‹Ÿé¡µå·ã€‚ä¾‹å¦‚ï¼Œå¯¹äºè™šæ‹Ÿåœ°å€21ï¼ˆ010101ï¼‰ï¼Œæ©ç å°†è¯¥å€¼å˜æˆ010000ï¼›æ ¹æ®éœ€è¦ï¼Œç§»ä½ä¼šå°†å…¶å˜ä¸º 01 æˆ–è™šæ‹Ÿé¡µ 1ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¥å€¼ä½œä¸ºé¡µè¡¨åŸºå€å¯„å­˜å™¨æŒ‡å‘çš„ PTE æ•°ç»„çš„ç´¢å¼•ã€‚ ä¸€æ—¦çŸ¥é“è¿™ä¸ªç‰©ç†åœ°å€ï¼Œç¡¬ä»¶å°±å¯ä»¥ä»å†…å­˜ä¸­è·å– PTEï¼Œæå– PFNï¼Œå¹¶å°†å…¶ä¸è™šæ‹Ÿåœ°å€çš„åç§»é‡è¿æ¥èµ·æ¥ï¼Œå½¢æˆæ‰€éœ€çš„ç‰©ç†åœ°å€ã€‚å…·ä½“æ¥è¯´ï¼Œå¯ä»¥è®¤ä¸º PFN é€šè¿‡ SHIFT å·¦ç§»ï¼Œç„¶åä¸åç§»é‡æŒ‰ä½æˆ–è¿ç®—å½¢æˆæœ€ç»ˆåœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š offset = VirtualAddress \u0026 OFFSET_MASK PhysAddr = (PFN \u003c\u003c SHIFT) | offset æœ€åï¼Œç¡¬ä»¶å¯ä»¥ä»å†…å­˜ä¸­å–å‡ºæ‰€éœ€çš„æ•°æ®å¹¶å°†å…¶æ”¾å…¥å¯„å­˜å™¨eaxä¸­ã€‚ç¨‹åºç°åœ¨å·²æˆåŠŸä»å†…å­˜åŠ è½½ä¸€ä¸ªå€¼ï¼ æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬ç°åœ¨æè¿°æ¯ä¸ªå†…å­˜å¼•ç”¨ä¸Šå‘ç”Ÿçš„æƒ…å†µçš„åˆå§‹åè®®ã€‚ä¸‹é¢è¿™æ®µä»£ç æ˜¾ç¤ºäº†åŸºæœ¬æ–¹æ³•ã€‚ # Extract the VPN from the virtual address VPN = (VirtualAddress \u0026 VPN_MASK) \u003e\u003e SHIFT # Form the address of the page-table entry (PTE) PTEAddr = PTBR + (VPN * sizeof(PTE)) # Fetch the PTE PTE = AccessMemory(PTEAddr) # Check if process can access the page if (PTE.Valid == False) RaiseException(SEGMENTATION_FAULT) else if (CanAccess(PTE.ProtectBits) == False) RaiseException(PROTECTION_FAULT) else # Access is OK: form physical address and fetch it offset = VirtualAddress \u0026 OFFSET_MASK PhysAddr = (PTE.PFN \u003c\u003c PFN_SHIFT) | offset Register = AccessMemory(PhysAddr) å¯¹äºæ¯ä¸ªå†…å­˜å¼•ç”¨ï¼ˆæ— è®ºæ˜¯æŒ‡ä»¤è·å–è¿˜æ˜¯æ˜¾å¼åŠ è½½æˆ–å­˜å‚¨ï¼‰ï¼Œåˆ†é¡µè¦æ±‚æˆ‘ä»¬æ‰§è¡Œä¸€æ¬¡é¢å¤–çš„å†…å­˜å¼•ç”¨ï¼Œä»¥ä¾¿é¦–å…ˆä»é¡µè¡¨ä¸­è·å–ã€‚è¿™æ˜¯å¾ˆå¤šå·¥ä½œï¼é¢å¤–çš„å†…å­˜å¼•ç”¨æˆæœ¬é«˜æ˜‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¼šä½¿è¿›ç¨‹å‡æ…¢ä¸¤å€æˆ–æ›´å¤šã€‚ ç°åœ¨æ‚¨æœ‰æœ›çœ‹åˆ°æˆ‘ä»¬å¿…é¡»è§£å†³ä¸¤ä¸ªçœŸæ­£çš„é—®é¢˜ã€‚å¦‚æœæ²¡æœ‰ä»”ç»†è®¾è®¡ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œé¡µè¡¨ä¼šå¯¼è‡´ç³»ç»Ÿè¿è¡Œé€Ÿåº¦è¿‡æ…¢ï¼Œå¹¶ä¸”å ç”¨è¿‡å¤šçš„å†…å­˜ã€‚è™½ç„¶è¿™ä¼¼ä¹æ˜¯æ»¡è¶³æˆ‘ä»¬å†…å­˜è™šæ‹ŸåŒ–éœ€æ±‚çš„ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä½†å¿…é¡»é¦–å…ˆå…‹æœè¿™ä¸¤ä¸ªå…³é”®é—®é¢˜ã€‚ ","date":"2024-04-25","objectID":"/posts/13.%E9%A1%B5/:4:0","tags":["OS"],"title":"é¡µ","uri":"/posts/13.%E9%A1%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 å†…å­˜è·Ÿè¸ª åœ¨ç»“æŸä¹‹å‰ï¼Œæˆ‘ä»¬ç°åœ¨é€šè¿‡ä¸€ä¸ªç®€å•çš„å†…å­˜è®¿é—®ç¤ºä¾‹æ¥æ¼”ç¤ºä½¿ç”¨åˆ†é¡µæ—¶å‘ç”Ÿçš„æ‰€æœ‰ç»“æœå†…å­˜è®¿é—®ã€‚æˆ‘ä»¬æ„Ÿå…´è¶£çš„ä»£ç ç‰‡æ®µï¼ˆåœ¨ C è¯­è¨€ä¸­ï¼Œåœ¨åä¸º array.c çš„æ–‡ä»¶ä¸­ï¼‰å¦‚ä¸‹ï¼š int array[1000]; ... for (i = 0; i \u003c 1000; i++) array[i] = 0; æˆ‘ä»¬ç¼–è¯‘ array.c å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œå®ƒï¼š gcc -o array array.c -Wall -O ./array å½“ç„¶ï¼Œä¸ºäº†çœŸæ­£ç†è§£å†…å­˜è®¿é—®æ­¤ä»£ç ç‰‡æ®µï¼ˆå®ƒåªæ˜¯åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ï¼‰ä¼šäº§ç”Ÿä»€ä¹ˆï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“ï¼ˆæˆ–å‡è®¾ï¼‰æ›´å¤šçš„äº‹æƒ…ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»åæ±‡ç¼–ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆåœ¨ Linux ä¸Šä½¿ç”¨ objdumpï¼Œåœ¨ Mac ä¸Šä½¿ç”¨ otoolï¼‰ä»¥æŸ¥çœ‹ä½¿ç”¨å“ªäº›æ±‡ç¼–æŒ‡ä»¤æ¥åˆå§‹åŒ–å¾ªç¯ä¸­çš„æ•°ç»„ã€‚è¿™æ˜¯ç”Ÿæˆçš„æ±‡ç¼–ä»£ç ï¼š 0x1024 movl $0x0,(%edi,%eax,4) #Power of CISC! edi+eax*4 0x1028 incl %eax #Increase counter 0x102c cmpl $0x03e8,%eax #Check if last element 0x1030 jne 0x1024 #Implicit (eflags) Zero bit access å¦‚æœæ‚¨äº†è§£ä¸€ç‚¹ x86ï¼Œè¯¥ä»£ç å®é™…ä¸Šå¾ˆå®¹æ˜“ç†è§£ã€‚ç¬¬ä¸€æ¡æŒ‡ä»¤å°†å€¼é›¶ï¼ˆæ˜¾ç¤ºä¸º $0x0ï¼‰ç§»åŠ¨åˆ°æ•°ç»„ä½ç½®çš„è™šæ‹Ÿå†…å­˜åœ°å€ä¸­ï¼›è¯¥åœ°å€æ˜¯é€šè¿‡è·å– %edi çš„å†…å®¹å¹¶æ·»åŠ  %eax ä¹˜ä»¥å››æ¥è®¡ç®—çš„ã€‚å› æ­¤ï¼Œ%edi ä¿å­˜æ•°ç»„çš„åŸºåœ°å€ï¼Œè€Œ %eax ä¿å­˜æ•°ç»„ç´¢å¼• (i)ï¼›æˆ‘ä»¬ä¹˜ä»¥å››ï¼Œå› ä¸ºè¯¥æ•°ç»„æ˜¯æ•´æ•°æ•°ç»„ï¼Œæ¯ä¸ªæ•´æ•°å¤§å°ä¸ºå››ä¸ªå­—èŠ‚ã€‚ ç¬¬äºŒæ¡æŒ‡ä»¤é€’å¢ %eax ä¸­ä¿å­˜çš„æ•°ç»„ç´¢å¼•ï¼Œç¬¬ä¸‰æ¡æŒ‡ä»¤å°†è¯¥å¯„å­˜å™¨çš„å†…å®¹ä¸åå…­è¿›åˆ¶å€¼ 0x03e8 æˆ–åè¿›åˆ¶ 1000 è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ¯”è¾ƒæ˜¾ç¤ºä¸¤ä¸ªå€¼è¿˜ä¸ç›¸ç­‰ï¼ˆè¿™å°±æ˜¯ jne æŒ‡ä»¤æµ‹è¯•çš„ç»“æœï¼‰ï¼Œç¬¬å››æ¡æŒ‡ä»¤è·³å›å¾ªç¯é¡¶éƒ¨ã€‚ ä¸ºäº†äº†è§£è¯¥æŒ‡ä»¤åºåˆ—è®¿é—®å“ªäº›å†…å­˜ï¼ˆåœ¨è™šæ‹Ÿå’Œç‰©ç†çº§åˆ«ï¼‰ï¼Œæˆ‘ä»¬å¿…é¡»å‡è®¾ä»£ç ç‰‡æ®µå’Œæ•°ç»„åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„ä½ç½®ï¼Œä»¥åŠé¡µè¡¨çš„å†…å®¹å’Œä½ç½®ã€‚å¯¹äºæ­¤ç¤ºä¾‹ï¼Œæˆ‘ä»¬å‡è®¾è™šæ‹Ÿåœ°å€ç©ºé—´å¤§å°ä¸º 64KBï¼ˆå°å¾—ä¸åˆ‡å®é™…ï¼‰ã€‚æˆ‘ä»¬è¿˜å‡è®¾é¡µé¢å¤§å°ä¸º 1KBã€‚ æˆ‘ä»¬ç°åœ¨éœ€è¦çŸ¥é“çš„æ˜¯é¡µè¡¨çš„å†…å®¹åŠå…¶åœ¨ç‰©ç†å†…å­˜ä¸­çš„ä½ç½®ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçº¿æ€§ï¼ˆåŸºäºæ•°ç»„ï¼‰é¡µè¡¨ï¼Œå¹¶ä¸”å®ƒä½äºç‰©ç†åœ°å€ 1KB (1024)ã€‚ è‡³äºå…¶å†…å®¹ï¼Œæˆ‘ä»¬åªéœ€è¦æ‹…å¿ƒåœ¨æœ¬ç¤ºä¾‹ä¸­æ˜ å°„äº†å‡ ä¸ªè™šæ‹Ÿé¡µé¢ã€‚é¦–å…ˆï¼Œä»£ç æ‰€åœ¨çš„è™šæ‹Ÿé¡µé¢ã€‚ç”±äºé¡µé¢å¤§å°ä¸º 1KBï¼Œå› æ­¤è™šæ‹Ÿåœ°å€ 1024 é©»ç•™åœ¨è™šæ‹Ÿåœ°å€ç©ºé—´çš„ç¬¬äºŒé¡µä¸Šï¼ˆVPN=1ï¼Œå› ä¸º VPN=0 æ˜¯ç¬¬ä¸€é¡µï¼‰ã€‚æˆ‘ä»¬å‡è®¾è¯¥è™šæ‹Ÿé¡µé¢æ˜ å°„åˆ°ç‰©ç†å¸§ 4 (VPN 1 â†’ PFN 4)ã€‚ æ¥ä¸‹æ¥æ˜¯æ•°ç»„æœ¬èº«ã€‚å®ƒçš„å¤§å°æ˜¯ 4000 å­—èŠ‚ï¼ˆ1000 ä¸ªæ•´æ•°ï¼‰ï¼Œæˆ‘ä»¬å‡è®¾å®ƒé©»ç•™åœ¨è™šæ‹Ÿåœ°å€ 40000 åˆ° 44000ï¼ˆä¸åŒ…æ‹¬æœ€åä¸€ä¸ªå­—èŠ‚ï¼‰ã€‚æ­¤åè¿›åˆ¶èŒƒå›´çš„è™šæ‹Ÿé¡µé¢ä¸º VPN=39 â€¦ VPN=42ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è¿™äº›é¡µé¢çš„æ˜ å°„ã€‚æˆ‘ä»¬å‡è®¾ä»¥ä¸‹è™šæ‹Ÿåˆ°ç‰©ç†æ˜ å°„ä¸ºç¤ºä¾‹ï¼š(VPN 39 â†’ PFN 7)ã€(VPN 40 â†’ PFN 8)ã€(VPN 41 â†’ PFN 9)ã€(VPN 42 â†’ PFN 10)ã€‚ æˆ‘ä»¬ç°åœ¨å‡†å¤‡è·Ÿè¸ªç¨‹åºçš„å†…å­˜å¼•ç”¨ã€‚å½“å®ƒè¿è¡Œæ—¶ï¼Œæ¯ä¸ªæŒ‡ä»¤è·å–éƒ½ä¼šç”Ÿæˆä¸¤ä¸ªå†…å­˜å¼•ç”¨ï¼šä¸€ä¸ªåˆ°é¡µè¡¨ä»¥æŸ¥æ‰¾æŒ‡ä»¤æ‰€åœ¨çš„ç‰©ç†é¡µï¼Œå¦ä¸€ä¸ªåˆ°æŒ‡ä»¤æœ¬èº«ä»¥å°†å…¶è·å–åˆ° CPU è¿›è¡Œå¤„ç†ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªä»¥ mov æŒ‡ä»¤å½¢å¼å‡ºç°çš„æ˜¾å¼å†…å­˜å¼•ç”¨ï¼›è¿™é¦–å…ˆå¢åŠ äº†å¦ä¸€ä¸ªé¡µè¡¨è®¿é—®ï¼ˆå°†æ•°ç»„è™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºæ­£ç¡®çš„ç‰©ç†åœ°å€ï¼‰ï¼Œç„¶åæ‰æ˜¯æ•°ç»„è®¿é—®æœ¬èº«ã€‚ ä¸‹å›¾æè¿°äº†å‰äº”ä¸ªå¾ªç¯è¿­ä»£çš„æ•´ä¸ªè¿‡ç¨‹ã€‚æœ€ä¸‹é¢çš„å›¾ä»¥é»‘è‰²æ˜¾ç¤º y è½´ä¸Šçš„æŒ‡ä»¤å†…å­˜å¼•ç”¨ï¼ˆå·¦è¾¹æ˜¯è™šæ‹Ÿåœ°å€ï¼Œå³è¾¹æ˜¯å®é™…ç‰©ç†åœ°å€ï¼‰ï¼›ä¸­é—´çš„å›¾ä»¥æ·±ç°è‰²æ˜¾ç¤ºæ•°ç»„è®¿é—®ï¼ˆåŒæ ·æ˜¯å·¦è¾¹æ˜¯è™šæ‹Ÿåœ°å€ï¼Œå³è¾¹æ˜¯ç‰©ç†åœ°å€ï¼‰ï¼›æœ€åï¼Œæœ€ä¸Šé¢çš„å›¾ä»¥æµ…ç°è‰²æ˜¾ç¤ºé¡µè¡¨å†…å­˜è®¿é—®ï¼ˆåªæ˜¯ç‰©ç†è®¿é—®ï¼Œå› ä¸ºæœ¬ä¾‹ä¸­çš„é¡µè¡¨ä½äºç‰©ç†å†…å­˜ä¸­ï¼‰ã€‚æ•´ä¸ªè·Ÿè¸ªçš„ x è½´æ˜¾ç¤ºäº†å¾ªç¯å‰äº”æ¬¡è¿­ä»£çš„å†…å­˜è®¿é—®ï¼›æ¯ä¸ªå¾ªç¯æœ‰ 10 æ¬¡å†…å­˜è®¿é—®ï¼Œå…¶ä¸­åŒ…æ‹¬å››æ¬¡æŒ‡ä»¤å–å›ã€ä¸€æ¬¡å†…å­˜æ˜¾å¼æ›´æ–°å’Œäº”æ¬¡é¡µè¡¨è®¿é—®ï¼Œä»¥è½¬æ¢è¿™å››æ¬¡å–å›å’Œä¸€æ¬¡æ˜¾å¼æ›´æ–°ã€‚ ","date":"2024-04-25","objectID":"/posts/13.%E9%A1%B5/:5:0","tags":["OS"],"title":"é¡µ","uri":"/posts/13.%E9%A1%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å‡è®¾ æœ¬è®¨è®ºçš„å¤§éƒ¨åˆ†å†…å®¹å°†é›†ä¸­äºç”¨æˆ·çº§å†…å­˜åˆ†é…åº“ä¸­åˆ†é…å™¨çš„ä¼Ÿå¤§å†å²ã€‚ æˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸ªåŸºæœ¬æ¥å£ï¼Œä¾‹å¦‚ malloc() å’Œ free() æä¾›çš„æ¥å£ã€‚å…·ä½“æ¥è¯´ï¼Œvoid *malloc(size t size) é‡‡ç”¨å•ä¸ªå‚æ•° sizeï¼Œå®ƒæ˜¯åº”ç”¨ç¨‹åºè¯·æ±‚çš„å­—èŠ‚æ•°ï¼›å®ƒè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¤§å°ï¼ˆæˆ–æ›´å¤§ï¼‰çš„åŒºåŸŸçš„æŒ‡é’ˆï¼ˆæ²¡æœ‰ç‰¹å®šç±»å‹ï¼Œæˆ–è€… C è¯­è¨€ä¸­çš„ void æŒ‡é’ˆï¼‰ã€‚è¡¥å……ä¾‹ç¨‹ void free(void *ptr) æ¥å—ä¸€ä¸ªæŒ‡é’ˆå¹¶é‡Šæ”¾ç›¸åº”çš„å—ã€‚æ³¨æ„è¯¥æ¥å£çš„å«ä¹‰ï¼šç”¨æˆ·åœ¨é‡Šæ”¾ç©ºé—´æ—¶ï¼Œå¹¶ä¸å‘ŠçŸ¥åº“å…¶å¤§å°ï¼›å› æ­¤ï¼Œå½“åªæä¾›æŒ‡å‘å†…å­˜å—çš„æŒ‡é’ˆæ—¶ï¼Œåº“å¿…é¡»èƒ½å¤Ÿè®¡ç®—å‡ºå†…å­˜å—æœ‰å¤šå¤§ã€‚ è¯¥åº“ç®¡ç†çš„ç©ºé—´å†å²ä¸Šç§°ä¸ºå †ï¼Œç”¨äºç®¡ç†å †ä¸­ç©ºé—²ç©ºé—´çš„é€šç”¨æ•°æ®ç»“æ„æ˜¯æŸç§ç©ºé—²åˆ—è¡¨ã€‚è¯¥ç»“æ„åŒ…å«å¯¹æ‰˜ç®¡å†…å­˜åŒºåŸŸä¸­æ‰€æœ‰ç©ºé—²ç©ºé—´å—çš„å¼•ç”¨ã€‚å½“ç„¶ï¼Œè¯¥æ•°æ®ç»“æ„æœ¬èº«ä¸å¿…æ˜¯åˆ—è¡¨ï¼Œè€Œåªæ˜¯æŸç§ç”¨äºè·Ÿè¸ªå¯ç”¨ç©ºé—´çš„æ•°æ®ç»“æ„ã€‚ æˆ‘ä»¬è¿›ä¸€æ­¥å‡è®¾æˆ‘ä»¬ä¸»è¦å…³æ³¨å¤–éƒ¨ç¢ç‰‡ã€‚åˆ†é…å™¨å½“ç„¶ä¹Ÿå¯èƒ½å­˜åœ¨å†…éƒ¨ç¢ç‰‡çš„é—®é¢˜ï¼›å¦‚æœåˆ†é…å™¨åˆ†é…çš„å†…å­˜å—å¤§äºè¯·æ±‚çš„å†…å­˜å—ï¼Œåˆ™æ­¤ç±»å—ä¸­ä»»ä½•æœªè¯·æ±‚çš„ï¼ˆå› æ­¤æœªä½¿ç”¨çš„ï¼‰ç©ºé—´éƒ½è¢«è§†ä¸ºå†…éƒ¨ç¢ç‰‡ï¼ˆå› ä¸ºæµªè´¹å‘ç”Ÿåœ¨åˆ†é…çš„å•å…ƒå†…ï¼‰ï¼Œå¹¶ä¸”æ˜¯ç©ºé—´æµªè´¹çš„ä¸€ç§æƒ…å†µã€‚ç„¶è€Œï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œå¹¶ä¸”å› ä¸ºå®ƒæ˜¯ä¸¤ç§ç±»å‹çš„ç¢ç‰‡ä¸­æ›´æœ‰è¶£çš„ä¸€ç§ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¸»è¦å…³æ³¨å¤–éƒ¨ç¢ç‰‡ã€‚ æˆ‘ä»¬è¿˜å‡è®¾ä¸€æ—¦å†…å­˜è¢«åˆ†å‘ç»™å®¢æˆ·ç«¯ï¼Œå®ƒå°±ä¸èƒ½è¢«é‡æ–°å®šä½åˆ°å†…å­˜ä¸­çš„å¦ä¸€ä¸ªä½ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç¨‹åºè°ƒç”¨ malloc() å¹¶è·å¾—ä¸€ä¸ªæŒ‡å‘å †å†…æŸä¸ªç©ºé—´çš„æŒ‡é’ˆï¼Œåˆ™è¯¥å†…å­˜åŒºåŸŸæœ¬è´¨ä¸Šç”±ç¨‹åºâ€œæ‹¥æœ‰â€ï¼ˆå¹¶ä¸”ä¸èƒ½ç”±åº“ç§»åŠ¨ï¼‰ï¼Œç›´åˆ°ç¨‹åºé€šè¿‡ç›¸åº”çš„free()è°ƒç”¨è¿”å›å®ƒä¸ºæ­¢ã€‚å› æ­¤ï¼Œä¸å¯èƒ½å‹ç¼©å¯ç”¨ç©ºé—´ï¼Œè€Œå‹ç¼©æœ‰åŠ©äºæ¶ˆé™¤ç¢ç‰‡ã€‚ç„¶è€Œï¼Œåœ¨å®ç°åˆ†æ®µæ—¶ï¼Œå¯ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨å‹ç¼©æ¥å¤„ç†ç¢ç‰‡ã€‚ æœ€åï¼Œæˆ‘ä»¬å‡è®¾åˆ†é…å™¨ç®¡ç†ä¸€ä¸ªè¿ç»­çš„å­—èŠ‚åŒºåŸŸã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåˆ†é…è€…å¯èƒ½ä¼šè¦æ±‚è¯¥åŒºåŸŸå¢é•¿ï¼›ä¾‹å¦‚ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œç”¨æˆ·çº§å†…å­˜åˆ†é…åº“å¯èƒ½ä¼šè°ƒç”¨å†…æ ¸æ¥å¢åŠ å †ï¼ˆé€šè¿‡ sbrk ç­‰ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚ç„¶è€Œï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾è¯¥åŒºåŸŸåœ¨å…¶æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­éƒ½æ˜¯å•ä¸€çš„å›ºå®šå¤§å°ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:1:0","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ä½çº§æœºåˆ¶ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:2:0","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åˆ†å‰²ä¸åˆå¹¶ ç©ºé—²åˆ—è¡¨åŒ…å«ä¸€ç»„å…ƒç´ ï¼Œè¿™äº›å…ƒç´ æè¿°å †ä¸­ä»å‰©ä½™çš„ç©ºé—²ç©ºé—´ã€‚å› æ­¤ï¼Œå‡è®¾æœ‰ä»¥ä¸‹ 30 å­—èŠ‚å †ï¼š è¯¥å †çš„ç©ºé—²åˆ—è¡¨ä¸Šæœ‰ä¸¤ä¸ªå…ƒç´ ã€‚ä¸€ä¸ªæ¡ç›®æè¿°ç¬¬ä¸€ä¸ª 10 å­—èŠ‚ç©ºé—²æ®µï¼ˆå­—èŠ‚ 0-9ï¼‰ï¼Œä¸€ä¸ªæ¡ç›®æè¿°å¦ä¸€ä¸ªç©ºé—²æ®µï¼ˆå­—èŠ‚ 20-29ï¼‰ï¼š å¦‚ä¸Šæ‰€è¿°ï¼Œä»»ä½•å¤§äº 10 å­—èŠ‚çš„è¯·æ±‚éƒ½ä¼šå¤±è´¥ï¼ˆè¿”å› NULLï¼‰ï¼Œåªæ˜¯æ²¡æœ‰è¯¥å¤§å°çš„è¿ç»­å†…å­˜å—å¯ç”¨ã€‚ä»»ä½•ä¸€ä¸ªç©ºé—²å—éƒ½å¯ä»¥è½»æ¾æ»¡è¶³å¯¹è¯¥å¤§å°ï¼ˆ10 å­—èŠ‚ï¼‰çš„è¯·æ±‚ã€‚ä½†å¦‚æœè¯·æ±‚çš„å†…å®¹å°äº 10 ä¸ªå­—èŠ‚ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ å‡è®¾æˆ‘ä»¬åªè¯·æ±‚ä¸€ä¸ªå­—èŠ‚çš„å†…å­˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ†é…å™¨å°†æ‰§è¡Œç§°ä¸ºåˆ†å‰²çš„æ“ä½œï¼šå®ƒå°†æ‰¾åˆ°å¯ä»¥æ»¡è¶³è¯·æ±‚çš„ç©ºé—²å†…å­˜å—å¹¶å°†å…¶åˆ†å‰²ä¸ºä¸¤éƒ¨åˆ†ã€‚å®ƒå°†è¿”å›ç»™è°ƒç”¨è€…çš„ç¬¬ä¸€ä¸ªå—ï¼›ç¬¬äºŒå—å°†ä¿ç•™åœ¨åˆ—è¡¨ä¸­ã€‚å› æ­¤ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœå‘å‡ºäº† 1 ä¸ªå­—èŠ‚çš„è¯·æ±‚ï¼Œå¹¶ä¸”åˆ†é…å™¨å†³å®šä½¿ç”¨åˆ—è¡¨ä¸­ä¸¤ä¸ªå…ƒç´ ä¸­çš„ç¬¬äºŒä¸ªæ¥æ»¡è¶³è¯·æ±‚ï¼Œåˆ™å¯¹ malloc() çš„è°ƒç”¨å°†è¿”å› 20ï¼ˆåˆ†é…å™¨çš„åœ°å€ï¼‰ã€‚ 1 å­—èŠ‚åˆ†é…åŒºåŸŸï¼‰ï¼Œåˆ—è¡¨æœ€ç»ˆå°†å¦‚ä¸‹æ‰€ç¤ºï¼š ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°åˆ—è¡¨åŸºæœ¬ä¿æŒå®Œæ•´ï¼›å”¯ä¸€çš„å˜åŒ–æ˜¯ç©ºé—²åŒºåŸŸç°åœ¨ä» 21 è€Œä¸æ˜¯ 20 å¼€å§‹ï¼Œå¹¶ä¸”è¯¥ç©ºé—²åŒºåŸŸçš„é•¿åº¦ç°åœ¨ä»…ä¸º 9ã€‚å› æ­¤ï¼Œå½“è¯·æ±‚å°äºä»»ä½•ç‰¹å®šç©ºé—²å—çš„å¤§å°æ—¶ï¼Œåˆ†é…å™¨é€šå¸¸ä¼šä½¿ç”¨åˆ†å‰²æ–¹æ³•ã€‚è®¸å¤šåˆ†é…å™¨ä¸­éƒ½æœ‰ä¸€ä¸ªæ¨è®ºæœºåˆ¶ï¼Œç§°ä¸ºç©ºé—²ç©ºé—´åˆå¹¶ã€‚å†æ¬¡ä»¥ä¸Šé¢çš„ä¾‹å­ä¸ºä¾‹ï¼ˆç©ºé—² 10 ä¸ªå­—èŠ‚ï¼Œå·²ç”¨ 10 ä¸ªå­—èŠ‚ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªç©ºé—² 10 ä¸ªå­—èŠ‚ï¼‰ã€‚ ç»™å®šè¿™ä¸ªï¼ˆå¾ˆå°çš„ï¼‰å †ï¼Œå½“åº”ç”¨ç¨‹åºè°ƒç”¨ free(10) æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œä»è€Œè¿”å›å †ä¸­é—´çš„ç©ºé—´ï¼Ÿå¦‚æœæˆ‘ä»¬åªæ˜¯ç®€å•åœ°å°†è¿™ä¸ªå¯ç”¨ç©ºé—´æ·»åŠ å›æˆ‘ä»¬çš„åˆ—è¡¨ä¸­è€Œä¸éœ€è¦å¤ªå¤šæ€è€ƒï¼Œæˆ‘ä»¬æœ€ç»ˆå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„åˆ—è¡¨ï¼š è™½ç„¶æ•´ä¸ªå †ç°åœ¨æ˜¯ç©ºé—²çš„ï¼Œä½†å®ƒä¼¼ä¹è¢«åˆ†ä¸ºä¸‰ä¸ªå—ï¼Œæ¯ä¸ªå— 10 å­—èŠ‚ã€‚å› æ­¤ï¼Œå¦‚æœç”¨æˆ·è¯·æ±‚ 20 ä¸ªå­—èŠ‚ï¼Œç®€å•çš„åˆ—è¡¨éå†å°†æ‰¾ä¸åˆ°è¿™æ ·çš„ç©ºé—²å—ï¼Œå¹¶è¿”å›å¤±è´¥ã€‚ ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œåˆ†é…å™¨æ‰€åšçš„å°±æ˜¯åœ¨é‡Šæ”¾ä¸€å—å†…å­˜æ—¶åˆå¹¶å¯ç”¨ç©ºé—´ã€‚è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•ï¼šå½“è¿”å›å†…å­˜ä¸­çš„ç©ºé—²å—æ—¶ï¼Œä»”ç»†æŸ¥çœ‹è¦è¿”å›çš„å—çš„åœ°å€ä»¥åŠé™„è¿‘çš„ç©ºé—²ç©ºé—´å—ï¼›å¦‚æœæ–°é‡Šæ”¾çš„ç©ºé—´ç´§é‚»ä¸€ä¸ªï¼ˆæˆ–ä¸¤ä¸ªï¼Œå¦‚æœ¬ç¤ºä¾‹ä¸­æ‰€ç¤ºï¼‰ç°æœ‰ç©ºé—²å—ï¼Œè¯·å°†å®ƒä»¬åˆå¹¶ä¸ºä¸€ä¸ªæ›´å¤§çš„ç©ºé—²å—ã€‚å› æ­¤ï¼Œé€šè¿‡åˆå¹¶ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆåˆ—è¡¨åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š äº‹å®ä¸Šï¼Œè¿™å°±æ˜¯åœ¨è¿›è¡Œä»»ä½•åˆ†é…ä¹‹å‰å †åˆ—è¡¨æœ€åˆçš„æ ·å­ã€‚é€šè¿‡åˆå¹¶ï¼Œåˆ†é…å™¨å¯ä»¥æ›´å¥½åœ°ç¡®ä¿å¤§çš„ç©ºé—²èŒƒå›´å¯ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:2:1","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 è·Ÿè¸ªåˆ†é…åŒºåŸŸçš„å¤§å° æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ° free(void *ptr) çš„æ¥å£ä¸é‡‡ç”¨å¤§å°å‚æ•°ï¼›å› æ­¤ï¼Œå‡è®¾ç»™å®šä¸€ä¸ªæŒ‡é’ˆï¼Œmalloc åº“å¯ä»¥å¿«é€Ÿç¡®å®šæ­£åœ¨é‡Šæ”¾çš„å†…å­˜åŒºåŸŸçš„å¤§å°ï¼Œä»è€Œå°†ç©ºé—´åˆå¹¶å›ç©ºé—²åˆ—è¡¨ä¸­ã€‚ ä¸ºäº†å®Œæˆæ­¤ä»»åŠ¡ï¼Œå¤§å¤šæ•°åˆ†é…å™¨åœ¨headerå—ä¸­å­˜å‚¨ä¸€äº›é¢å¤–ä¿¡æ¯ï¼Œè¯¥headerå—ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé€šå¸¸å°±åœ¨åˆ†é…çš„å†…å­˜å—ä¹‹å‰ã€‚è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨æ£€æŸ¥ç”± ptr æŒ‡å‘çš„å¤§å°ä¸º 20 å­—èŠ‚çš„å·²åˆ†é…å—ï¼›æƒ³è±¡ä¸€ä¸‹ç”¨æˆ·è°ƒç”¨ malloc() å¹¶å°†ç»“æœå­˜å‚¨åœ¨ ptr ä¸­ï¼Œä¾‹å¦‚ ptr = malloc(20); headerè‡³å°‘åŒ…å«åˆ†é…åŒºåŸŸçš„å¤§å°ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º 20ï¼‰ï¼›å®ƒè¿˜å¯èƒ½åŒ…å«ç”¨äºåŠ é€Ÿé‡Šæ”¾çš„é™„åŠ æŒ‡é’ˆã€ç”¨äºæä¾›é™„åŠ å®Œæ•´æ€§æ£€æŸ¥çš„å¹»æ•°ä»¥åŠå…¶ä»–ä¿¡æ¯ã€‚è®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ªç®€å•çš„æ ‡å¤´ï¼Œå…¶ä¸­åŒ…å«åŒºåŸŸçš„å¤§å°å’Œä¸€ä¸ªå¹»æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š typedef struct __header_t { int size; int magic; } header_t; ä¸Šé¢çš„ç¤ºä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å½“ç”¨æˆ·è°ƒç”¨ free(ptr)ï¼Œç„¶ååº“ä½¿ç”¨ç®€å•çš„æŒ‡é’ˆç®—æœ¯æ¥ç¡®å®šæ ‡å¤´çš„å¼€å§‹ä½ç½®ï¼š void free(void *ptr) { header_t *hptr = (void *)ptr - sizeof(header_t); assert(hptr-\u003emagic == 1234567 \u0026\u0026 â€œHeap is corruptâ€); ... è·å¾—è¿™æ ·ä¸€ä¸ªæŒ‡å‘headerçš„æŒ‡é’ˆåï¼Œåº“å¯ä»¥è½»æ¾ç¡®å®šå¹»æ•°æ˜¯å¦ä¸é¢„æœŸå€¼åŒ¹é…ä½œä¸ºå¥å…¨æ€§æ£€æŸ¥ï¼ˆassert(hptr-\u003emagic == 1234567)ï¼‰ï¼Œå¹¶é€šè¿‡ç®€å•çš„æ•°å­¦è¿ç®—ï¼ˆå³ï¼Œå°†headerçš„å¤§å°æ·»åŠ åˆ°åŒºåŸŸçš„å¤§å°ï¼‰è®¡ç®—æ–°é‡Šæ”¾åŒºåŸŸçš„æ€»å¤§å°ã€‚è¯·æ³¨æ„æœ€åä¸€å¥ä¸­çš„å°ä½†å…³é”®çš„ç»†èŠ‚ï¼šç©ºé—²åŒºåŸŸçš„å¤§å°æ˜¯headerçš„å¤§å°åŠ ä¸Šåˆ†é…ç»™ç”¨æˆ·çš„ç©ºé—´çš„å¤§å°ã€‚å› æ­¤ï¼Œå½“ç”¨æˆ·è¯·æ±‚ N å­—èŠ‚çš„å†…å­˜æ—¶ï¼Œåº“ä¸ä¼šæœç´¢å¤§å°ä¸º N çš„ç©ºé—²å—ï¼›ç›¸åï¼Œå®ƒä¼šæœç´¢å¤§å°ä¸º N åŠ ä¸Šheaderå¤§å°çš„ç©ºé—²å—ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:2:2","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 åµŒå…¥ç©ºé—²åˆ—è¡¨ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å°†ç®€å•çš„ç©ºé—²åˆ—è¡¨è§†ä¸ºä¸€ä¸ªæ¦‚å¿µå®ä½“ï¼›å®ƒåªæ˜¯ä¸€ä¸ªæè¿°å †ä¸­ç©ºé—²å†…å­˜å—çš„åˆ—è¡¨ã€‚ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨ç©ºé—´ç©ºé—´æœ¬èº«å†…æ„å»ºè¿™æ ·çš„åˆ—è¡¨å‘¢ï¼Ÿ åœ¨æ›´å…¸å‹çš„åˆ—è¡¨ä¸­ï¼Œåˆ†é…æ–°èŠ‚ç‚¹æ—¶ï¼Œåªéœ€åœ¨éœ€è¦è¯¥èŠ‚ç‚¹çš„ç©ºé—´æ—¶è°ƒç”¨ malloc() å³å¯ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨å†…å­˜åˆ†é…åº“ä¸­ï¼Œä½ ä¸èƒ½è¿™æ ·åšï¼ç›¸åï¼Œæ‚¨éœ€è¦åœ¨å¯ç”¨ç©ºé—´æœ¬èº«å†…æ„å»ºåˆ—è¡¨ã€‚å¦‚æœè¿™å¬èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œè¯·ä¸è¦æ‹…å¿ƒï¼›æ˜¯çš„ï¼Œä½†å¹¶ä¸å¥‡æ€ªåˆ°ä½ åšä¸åˆ°ï¼ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª 4096 å­—èŠ‚çš„å†…å­˜å—éœ€è¦ç®¡ç†ï¼ˆå³å †ä¸º 4KBï¼‰ã€‚è¦å°†å…¶ä½œä¸ºç©ºé—²åˆ—è¡¨è¿›è¡Œç®¡ç†ï¼Œæˆ‘ä»¬é¦–å…ˆå¿…é¡»åˆå§‹åŒ–è¯¥åˆ—è¡¨ï¼›æœ€åˆï¼Œåˆ—è¡¨åº”è¯¥æœ‰ä¸€ä¸ªæ¡ç›®ï¼Œå¤§å°ä¸º 4096ï¼ˆå‡å»headerå¤§å°ï¼‰ã€‚ä»¥ä¸‹æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æè¿°ï¼š typedef struct __node_t { int size; struct __node_t *next; } node_t; ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€äº›åˆå§‹åŒ–å †å¹¶å°†ç©ºé—²åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ”¾å…¥è¯¥ç©ºé—´çš„ä»£ç ã€‚æˆ‘ä»¬å‡è®¾å †æ˜¯åœ¨é€šè¿‡è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ mmap() è·å¾—çš„ä¸€äº›å¯ç”¨ç©ºé—´å†…æ„å»ºçš„ï¼›è¿™ä¸æ˜¯æ„å»ºæ­¤ç±»å †çš„å”¯ä¸€æ–¹æ³•ï¼Œä½†åœ¨æœ¬ä¾‹ä¸­å¯¹æˆ‘ä»¬å¾ˆæœ‰å¸®åŠ©ã€‚è¿™æ˜¯ä»£ç ï¼š // mmap() returns a pointer to a chunk of free space node_t *head = mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_ANON|MAP_PRIVATE, -1, 0); head-\u003esize = 4096 - sizeof(node_t); head-\u003enext = NULL; è¿è¡Œè¿™æ®µä»£ç åï¼Œåˆ—è¡¨çš„çŠ¶æ€æ˜¯åªæœ‰ä¸€ä¸ªæ¡ç›®ï¼Œå¤§å°ä¸º 4088ã€‚æ˜¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå°çš„å †ï¼Œä½†å®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ headæŒ‡é’ˆåŒ…å«è¯¥èŒƒå›´çš„èµ·å§‹åœ°å€ï¼›æˆ‘ä»¬å‡è®¾å®ƒæ˜¯ 16KBï¼ˆå°½ç®¡ä»»ä½•è™šæ‹Ÿåœ°å€éƒ½å¯ä»¥ï¼‰ã€‚ä»è§†è§‰ä¸Šçœ‹ï¼Œå †çœ‹èµ·æ¥å°±åƒä¸‹é¢è¿™æ ·ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å‡è®¾è¯·æ±‚ä¸€å—å†…å­˜ï¼Œå¤§å°ä¸º 100 å­—èŠ‚ã€‚ä¸ºäº†æœåŠ¡è¿™ä¸ªè¯·æ±‚ï¼Œåº“å°†é¦–å…ˆæ‰¾åˆ°ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å—æ¥å®¹çº³è¯¥è¯·æ±‚ï¼›å› ä¸ºåªæœ‰ä¸€ä¸ªç©ºé—²å—ï¼ˆå¤§å°ï¼š4088ï¼‰ï¼Œæ‰€ä»¥å°†é€‰æ‹©è¯¥å—ã€‚ç„¶åï¼Œè¯¥å—å°†è¢«åˆ†å‰²æˆä¸¤éƒ¨åˆ†ï¼šä¸€ä¸ªè¶³å¤Ÿå¤§ä»¥æœåŠ¡è¯·æ±‚ï¼ˆå’Œheaderï¼Œå¦‚ä¸Šæ‰€è¿°ï¼‰ï¼Œä»¥åŠå‰©ä½™çš„ç©ºé—²å—ã€‚å‡è®¾æœ‰ä¸€ä¸ª 8 å­—èŠ‚çš„headerï¼ˆæ•´æ•°å¤§å°å’Œæ•´æ•°å¹»æ•°ï¼‰ï¼Œå †ä¸­çš„ç©ºé—´ç°åœ¨çœ‹èµ·æ¥å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å› æ­¤ï¼Œåœ¨è¯·æ±‚ 100 å­—èŠ‚æ—¶ï¼Œåº“ä»ç°æœ‰çš„ä¸€ä¸ªç©ºé—²å—ä¸­åˆ†é…äº† 108 å­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘å®ƒçš„æŒ‡é’ˆï¼ˆä¸Šå›¾ä¸­æ ‡è®°ä¸º ptrï¼‰ï¼Œå°†headerä¿¡æ¯å­˜å‚¨åœ¨åˆ†é…çš„ç©ºé—´ä¹‹å‰ï¼Œä»¥ä¾¿ä¹‹åä¾›free()ä½¿ç”¨ï¼Œå¹¶å°†é“¾è¡¨ä¸­çš„ä¸€ä¸ªç©ºé—²èŠ‚ç‚¹ç¼©å°åˆ° 3980 å­—èŠ‚ï¼ˆ4088 å‡ 108ï¼‰ã€‚ ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æœ‰ 3 ä¸ªåˆ†é…åŒºåŸŸçš„å †ï¼Œæ¯ä¸ªåŒºåŸŸ 100 ä¸ªå­—èŠ‚ï¼ˆæˆ– 108 ä¸ªå­—èŠ‚ï¼ŒåŒ…æ‹¬headerï¼‰ã€‚è¯¥å †çš„å¯è§†åŒ–å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ­£å¦‚æ‚¨åœ¨å…¶ä¸­çœ‹åˆ°çš„ï¼Œå †çš„å‰ 324 å­—èŠ‚ç°å·²åˆ†é…ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è¯¥ç©ºé—´ä¸­çœ‹åˆ°ä¸‰ä¸ªheaderä»¥åŠè°ƒç”¨ç¨‹åºæ­£åœ¨ä½¿ç”¨çš„ä¸‰ä¸ª 100 å­—èŠ‚åŒºåŸŸã€‚ç©ºé—²åˆ—è¡¨ä»ç„¶æ— è¶£ï¼šåªæ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆç”±headæŒ‡å‘ï¼‰ï¼Œä½†åœ¨ä¸‰ä¸ªåˆ†å‰²ä¹‹åç°åœ¨å¤§å°åªæœ‰ 3764 å­—èŠ‚ã€‚ä½†æ˜¯å½“è°ƒç”¨ç¨‹åºé€šè¿‡ free() è¿”å›ä¸€äº›å†…å­˜æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡è°ƒç”¨ free(16500)ï¼ˆå€¼16500æ˜¯é€šè¿‡å°†å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€16384ä¸å‰ä¸€ä¸ªå—çš„108ç›¸åŠ ä»¥åŠæ­¤å—å¤´éƒ¨çš„8å­—èŠ‚æ¥å¾—åˆ°çš„ã€‚ï¼‰ è¿”å›å·²åˆ†é…å†…å­˜çš„ä¸­é—´å—ã€‚è¯¥å€¼åœ¨ä¸Šå›¾ä¸­ç”±æŒ‡é’ˆ sptr æ˜¾ç¤ºã€‚ åº“ç«‹å³è®¡ç®—å‡ºç©ºé—²åŒºåŸŸçš„å¤§å°ï¼Œç„¶åå°†ç©ºé—²å—æ·»åŠ å›ç©ºé—²åˆ—è¡¨ã€‚å‡è®¾æˆ‘ä»¬åœ¨ç©ºé—²åˆ—è¡¨çš„å¤´éƒ¨æ’å…¥ï¼Œç©ºé—´ç°åœ¨çœ‹èµ·æ¥å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªä»¥å°ç©ºé—²å—ï¼ˆ100 å­—èŠ‚ï¼Œç”±åˆ—è¡¨é¦–éƒ¨æŒ‡å‘ï¼‰å’Œå¤§ç©ºé—²å—ï¼ˆ3764 å­—èŠ‚ï¼‰å¼€å§‹çš„åˆ—è¡¨ã€‚æˆ‘ä»¬çš„åˆ—è¡¨ç»ˆäºå¤šäº†ä¸€ä¸ªå…ƒç´ ï¼æ˜¯çš„ï¼Œç©ºé—²ç©ºé—´æ˜¯æ”¯ç¦»ç ´ç¢çš„ï¼Œè¿™æ˜¯ä¸€ç§ä¸å¹¸ä½†å¸¸è§çš„ç°è±¡ã€‚ æœ€åä¸€ä¸ªä¾‹å­ï¼šç°åœ¨è®©æˆ‘ä»¬å‡è®¾æœ€åä¸¤ä¸ªæ­£åœ¨ä½¿ç”¨çš„å—å·²è¢«é‡Šæ”¾ã€‚å¦‚æœä¸è¿›è¡Œåˆå¹¶ï¼Œæ‚¨æœ€ç»ˆå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªé«˜åº¦ç¢ç‰‡åŒ–çš„ç©ºé—²åˆ—è¡¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ç°åœ¨ä¸€å›¢ç³Ÿï¼ä¸ºä»€ä¹ˆï¼Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å¿˜è®°åˆå¹¶åˆ—è¡¨ã€‚è™½ç„¶æ‰€æœ‰çš„å†…å­˜éƒ½æ˜¯ç©ºé—²çš„ï¼Œä½†å®ƒå´è¢«åˆ†å‰²æˆç¢ç‰‡ï¼Œå› æ­¤ä¸æ˜¯å®Œæ•´çš„å†…å­˜ï¼Œè€Œæ˜¯å‘ˆç°å‡ºç¢ç‰‡åŒ–çš„å†…å­˜ã€‚è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼šéå†åˆ—è¡¨å¹¶åˆå¹¶ç›¸é‚»å—ï¼›å®Œæˆåï¼Œå †å°†å†æ¬¡å®Œæ•´ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:2:3","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.4 å¢åŠ å † æˆ‘ä»¬åº”è¯¥è®¨è®ºè®¸å¤šåˆ†é…åº“ä¸­çš„æœ€åä¸€ç§æœºåˆ¶ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœå †ç©ºé—´ä¸è¶³è¯¥æ€ä¹ˆåŠï¼Ÿæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å¤±è´¥ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ˜¯å”¯ä¸€çš„é€‰æ‹©ï¼Œå› æ­¤è¿”å› NULL æ˜¯ä¸€ç§å€¼å¾—å°Šæ•¬çš„æ–¹æ³•ã€‚ å¤§å¤šæ•°ä¼ ç»Ÿåˆ†é…å™¨éƒ½ä»ä¸€ä¸ªå°å †å¼€å§‹ï¼Œç„¶ååœ¨å†…å­˜è€—å°½æ—¶å‘æ“ä½œç³»ç»Ÿè¯·æ±‚æ›´å¤šå†…å­˜ã€‚é€šå¸¸ï¼Œè¿™æ„å‘³ç€å®ƒä»¬è¿›è¡ŒæŸç§ç³»ç»Ÿè°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œå¤§å¤šæ•° UNIX ç³»ç»Ÿä¸­çš„ sbrkï¼‰æ¥å¢åŠ å †ï¼Œç„¶åä»é‚£é‡Œåˆ†é…æ–°çš„å—ã€‚ä¸ºäº†æœåŠ¡ sbrk è¯·æ±‚ï¼Œæ“ä½œç³»ç»ŸæŸ¥æ‰¾ç©ºé—²ç‰©ç†é¡µï¼Œå°†å®ƒä»¬æ˜ å°„åˆ°è¯·æ±‚è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œç„¶åè¿”å›æ–°å †æœ«å°¾çš„å€¼ï¼›æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¤§çš„å †ï¼Œå¹¶ä¸”å¯ä»¥æˆåŠŸåœ°å¤„ç†è¯·æ±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:2:4","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ç®¡ç†ç©ºé—²ç©ºé—´ï¼šåŸºæœ¬ç­–ç•¥ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:3:0","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 æœ€ä½³é€‚åº”ç®—æ³• æœ€ä½³é€‚åº”ç®—æ³•çš„ç­–ç•¥éå¸¸ç®€å•ï¼šé¦–å…ˆï¼Œæœç´¢ç©ºé—²åˆ—è¡¨å¹¶æ‰¾åˆ°ä¸è¯·æ±‚å¤§å°ä¸€æ ·å¤§æˆ–æ›´å¤§çš„ç©ºé—²å†…å­˜å—ã€‚ç„¶åï¼Œè¿”å›è¯¥ç»„å€™é€‰è€…ä¸­æœ€å°çš„é‚£ä¸ªï¼›è¿™å°±æ˜¯æ‰€è°“çš„æœ€ä½³é€‚åº”å—ï¼ˆä¹Ÿå¯ä»¥ç§°ä¸ºæœ€å°é€‚åº”ï¼‰ã€‚éå†ä¸€æ¬¡ç©ºé—²åˆ—è¡¨å°±è¶³ä»¥æ‰¾åˆ°è¦è¿”å›çš„æ­£ç¡®å—ã€‚ æœ€ä½³é€‚åº”èƒŒåçš„ç›´è§‰å¾ˆç®€å•ï¼šé€šè¿‡è¿”å›æ¥è¿‘ç”¨æˆ·è¦æ±‚çš„å—ï¼Œæœ€ä½³é€‚åº”å°è¯•å‡å°‘æµªè´¹çš„ç©ºé—´ã€‚ç„¶è€Œï¼Œè¿™æ˜¯æœ‰ä»£ä»·çš„ï¼›å½“å¯¹æ­£ç¡®çš„ç©ºé—²å—æ‰§è¡Œè¯¦å°½çš„æœç´¢æ—¶ï¼Œå¹¼ç¨šçš„å®ç°ä¼šå¸¦æ¥ä¸¥é‡çš„æ€§èƒ½æŸå¤±ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:3:1","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 æœ€å·®é€‚åº”ç®—æ³• æœ€å·®é€‚åº”ç®—æ³•ä¸æœ€ä½³é€‚åº”ç®—æ³•ç›¸åï¼›æ‰¾åˆ°æœ€å¤§çš„å—å¹¶è¿”å›è¯·æ±‚çš„æ•°é‡ï¼›å°†å‰©ä½™çš„ï¼ˆå¤§ï¼‰å—ä¿ç•™åœ¨ç©ºé—²åˆ—è¡¨ä¸­ã€‚å› æ­¤ï¼Œæœ€å·®é€‚åº”å°è¯•ç•™ä¸‹å¤§å—ï¼Œè€Œä¸æ˜¯æœ€ä½³é€‚åº”æ–¹æ³•å¯èƒ½äº§ç”Ÿçš„å¤§é‡å°å—ã€‚ç„¶è€Œï¼Œå†æ¬¡éœ€è¦å¯¹å¯ç”¨ç©ºé—´è¿›è¡Œå…¨é¢æœç´¢ï¼Œå› æ­¤è¿™ç§æ–¹æ³•çš„æˆæœ¬å¯èƒ½å¾ˆé«˜ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¤§å¤šæ•°ç ”ç©¶è¡¨æ˜å®ƒçš„æ€§èƒ½å¾ˆå·®ï¼Œå¯¼è‡´è¿‡å¤šçš„ç¢ç‰‡ï¼ŒåŒæ—¶ä»ç„¶å…·æœ‰å¾ˆé«˜çš„å¼€é”€ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:3:2","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 é¦–æ¬¡é€‚åº”ç®—æ³• é¦–æ¬¡é€‚åº”ç®—æ³•åªéœ€æ‰¾åˆ°ç¬¬ä¸€ä¸ªè¶³å¤Ÿå¤§çš„åŒºå—ï¼Œå¹¶å°†è¯·æ±‚çš„å¤§å°è¿”å›ç»™ç”¨æˆ·ã€‚ä¸ä¹‹å‰ä¸€æ ·ï¼Œå‰©ä½™çš„ç©ºé—²ç©ºé—´å°†ä¿ç•™ç»™åç»­è¯·æ±‚ã€‚ é¦–æ¬¡é€‚åº”ç®—æ³•çš„ä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«ï¼Œæ— éœ€ç©·ä¸¾æœç´¢æ‰€æœ‰ç©ºé—²ç©ºé—´ï¼Œä½†æœ‰æ—¶ä¼šç”¨å°å¯¹è±¡æ±¡æŸ“ç©ºé—²åˆ—è¡¨çš„å¼€å¤´éƒ¨åˆ†ã€‚å› æ­¤ï¼Œåˆ†é…å™¨å¦‚ä½•ç®¡ç†ç©ºé—²åˆ—è¡¨çš„é¡ºåºå°±æˆäº†ä¸€ä¸ªé—®é¢˜ã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨åŸºäºåœ°å€çš„æ’åºï¼›é€šè¿‡ä¿æŒåˆ—è¡¨æŒ‰ç©ºé—²ç©ºé—´çš„åœ°å€æ’åºï¼Œå‡èšå˜å¾—æ›´å®¹æ˜“ï¼Œç¢ç‰‡ä¹Ÿä¼šå‡å°‘ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:3:3","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³• å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•å¹¶ä¸æ€»æ˜¯åœ¨åˆ—è¡¨çš„å¼€å¤´å¼€å§‹é¦–æ¬¡é€‚åº”æœç´¢ï¼Œè€Œæ˜¯ä¿ç•™ä¸€ä¸ªé¢å¤–çš„æŒ‡é’ˆï¼ŒæŒ‡å‘åˆ—è¡¨ä¸­æœ€åä¸€æ¬¡æŸ¥æ‰¾çš„ä½ç½®ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯åœ¨æ•´ä¸ªåˆ—è¡¨ä¸­æ›´å‡åŒ€åœ°åˆ†å¸ƒå¯¹å¯ç”¨ç©ºé—´çš„æœç´¢ï¼Œä»è€Œé¿å…åˆ—è¡¨å¼€å¤´çš„åˆ†å‰²ã€‚è¿™ç§æ–¹æ³•çš„æ€§èƒ½ä¸é¦–æ¬¡é€‚åº”ç®—æ³•éå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºå†æ¬¡é¿å…äº†ç©·ä¸¾æœç´¢ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:3:4","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.5 å››ç§ç®—æ³•å®ä¾‹å¯¹æ¯” ä»¥ä¸‹æ˜¯ä¸Šè¿°ç­–ç•¥çš„ä¸€äº›ç¤ºä¾‹ã€‚è®¾æƒ³ä¸€ä¸ªç©ºé—²åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå…ƒç´ ï¼Œå¤§å°åˆ†åˆ«ä¸º 10ã€30 å’Œ 20ï¼ˆè¿™é‡Œæˆ‘ä»¬å°†å¿½ç•¥headerså’Œå…¶ä»–ç»†èŠ‚ï¼Œè€Œåªå…³æ³¨ç­–ç•¥çš„è¿ä½œæ–¹å¼ï¼‰ï¼š å‡è®¾åˆ†é…è¯·æ±‚å¤§å°ä¸º 15ã€‚æœ€ä½³é€‚åº”ç®—æ³•ä¼šæœç´¢æ•´ä¸ªåˆ—è¡¨å¹¶å‘ç° 20 æ˜¯æœ€é€‚åˆçš„ï¼Œå› ä¸ºå®ƒæ˜¯å¯ä»¥å®¹çº³è¯·æ±‚çš„æœ€å°å¯ç”¨ç©ºé—´ã€‚ç”Ÿæˆçš„ç©ºé—²åˆ—è¡¨ï¼š æ­£å¦‚æœ¬ä¾‹ä¸­å‘ç”Ÿçš„æƒ…å†µï¼Œä¹Ÿæ˜¯æœ€ä½³é€‚åº”æ–¹æ³•ç»å¸¸å‘ç”Ÿçš„æƒ…å†µï¼Œç°åœ¨å‰©ä¸‹äº†ä¸€ä¸ªå°çš„ç©ºé—²å—ã€‚æœ€å·®æ‹Ÿåˆæ–¹æ³•ä¸æ­¤ç±»ä¼¼ï¼Œä½†å®ƒæ‰¾åˆ°çš„æ˜¯æœ€å¤§çš„å—ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º 30ã€‚ç»“æœåˆ—è¡¨å¦‚ä¸‹ï¼š åœ¨æœ¬ä¾‹ä¸­ï¼Œé¦–æ¬¡é€‚åº”ç®—æ³•ä¸æœ€å·®é€‚åº”ç®—æ³•æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œä¹Ÿæ˜¯æŸ¥æ‰¾å¯ä»¥æ»¡è¶³è¯·æ±‚çš„ç¬¬ä¸€ä¸ªç©ºé—²å—ã€‚åŒºåˆ«åœ¨äºæœç´¢æˆæœ¬ï¼›æœ€ä½³ç®—æ³•å’Œæœ€å·®ç®—æ³•éƒ½ä¼šæµè§ˆæ•´ä¸ªåˆ—è¡¨ï¼› é¦–æ¬¡é€‚åº”ç®—æ³• ä»…æ£€æŸ¥ç©ºé—²å—ï¼Œç›´åˆ°æ‰¾åˆ°é€‚åˆçš„å—ï¼Œä»è€Œé™ä½æœç´¢æˆæœ¬ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:3:5","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å…¶ä»–æ–¹æ³• ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:4:0","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.1 éš”ç¦»åˆ—è¡¨ï¼šslabåˆ†é…å™¨ ä¸€ç§å·²ç»å­˜åœ¨ä¸€æ®µæ—¶é—´çš„æœ‰è¶£æ–¹æ³•æ˜¯ä½¿ç”¨éš”ç¦»åˆ—è¡¨ã€‚åŸºæœ¬æ€æƒ³å¾ˆç®€å•ï¼šå¦‚æœç‰¹å®šåº”ç”¨ç¨‹åºå‘å‡ºä¸€ä¸ªï¼ˆæˆ–å‡ ä¸ªï¼‰å¸¸è§å¤§å°çš„è¯·æ±‚ï¼Œåˆ™ä¿ç•™ä¸€ä¸ªå•ç‹¬çš„åˆ—è¡¨æ¥ç®¡ç†è¯¥å¤§å°çš„å¯¹è±¡ï¼›æ‰€æœ‰å…¶ä»–è¯·æ±‚éƒ½è½¬å‘åˆ°æ›´é€šç”¨çš„å†…å­˜åˆ†é…å™¨ã€‚ è¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚é€šè¿‡å°†ä¸€å—å†…å­˜ä¸“ç”¨äºç‰¹å®šå¤§å°çš„è¯·æ±‚ï¼Œç¢ç‰‡å°±ä¸å†æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚æ­¤å¤–ï¼Œå½“åˆ†é…å’Œé‡Šæ”¾è¯·æ±‚çš„å¤§å°åˆé€‚æ—¶ï¼Œå¯ä»¥éå¸¸å¿«é€Ÿåœ°å¤„ç†å®ƒä»¬ï¼Œå› ä¸ºä¸éœ€è¦å¤æ‚çš„åˆ—è¡¨æœç´¢ã€‚ ä½†è¿™ç§æ–¹æ³•ä¹Ÿä¼šç»™ç³»ç»Ÿå¸¦æ¥æ–°çš„å¤æ‚æ€§ã€‚ä¾‹å¦‚ï¼Œä¸é€šç”¨å†…å­˜æ± ç›¸æ¯”ï¼Œåº”è¯¥å°†å¤šå°‘å†…å­˜ä¸“é—¨ç”¨äºæœåŠ¡ç»™å®šå¤§å°çš„ç‰¹æ®Šè¯·æ±‚çš„å†…å­˜æ± ï¼Ÿä¸€ä¸ªç‰¹æ®Šçš„åˆ†é…å™¨ï¼Œç”±è¶…çº§å·¥ç¨‹å¸ˆ Jeff Bonwick è®¾è®¡çš„slab åˆ†é…å™¨ï¼ˆè®¾è®¡ç”¨äº Solaris å†…æ ¸ï¼‰ï¼Œä»¥ä¸€ç§ç›¸å½“å¥½çš„æ–¹å¼å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ å…·ä½“æ¥è¯´ï¼Œå½“å†…æ ¸å¯åŠ¨æ—¶ï¼Œå®ƒä¼šä¸ºå¯èƒ½è¢«é¢‘ç¹è¯·æ±‚çš„å†…æ ¸å¯¹è±¡ï¼ˆä¾‹å¦‚é”ã€æ–‡ä»¶ç³»ç»Ÿ inode ç­‰ï¼‰åˆ†é…ä¸€äº›å¯¹è±¡ç¼“å­˜ã€‚å› æ­¤ï¼Œå¯¹è±¡ç¼“å­˜éƒ½æ˜¯ç»™å®šå¤§å°çš„éš”ç¦»ç©ºé—²åˆ—è¡¨ï¼Œå¹¶å¿«é€ŸæœåŠ¡å†…å­˜åˆ†é…å’Œç©ºé—²è¯·æ±‚ã€‚å½“ç»™å®šçš„ç¼“å­˜å¯ç”¨ç©ºé—´ä¸è¶³æ—¶ï¼Œå®ƒä¼šä»æ›´é€šç”¨çš„å†…å­˜åˆ†é…å™¨è¯·æ±‚ä¸€äº›å†…å­˜å—ï¼ˆslabï¼‰ï¼ˆè¯·æ±‚çš„æ€»é‡æ˜¯é¡µé¢å¤§å°å’Œç›¸å…³å¯¹è±¡çš„å€æ•°ï¼‰ã€‚ç›¸åï¼Œå½“ç»™å®šslabå†…çš„å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å…¨éƒ¨å˜ä¸ºé›¶æ—¶ï¼Œé€šç”¨åˆ†é…å™¨å¯ä»¥ä»ä¸“ç”¨åˆ†é…å™¨ä¸­å›æ”¶å®ƒä»¬ï¼Œè¿™é€šå¸¸åœ¨VMç³»ç»Ÿéœ€è¦æ›´å¤šå†…å­˜æ—¶æ‰§è¡Œã€‚ é€šè¿‡å°†åˆ—è¡¨ä¸Šçš„ç©ºé—²å¯¹è±¡ä¿æŒåœ¨é¢„åˆå§‹åŒ–çŠ¶æ€ï¼Œslab åˆ†é…å™¨è¿˜è¶…è¶Šäº†å¤§å¤šæ•°éš”ç¦»åˆ—è¡¨æ–¹æ³•ã€‚ Bonwick è¡¨æ˜æ•°æ®ç»“æ„çš„åˆå§‹åŒ–å’Œé”€æ¯ä»£ä»·é«˜æ˜‚ ï¼Œé€šè¿‡å°†ç‰¹å®šåˆ—è¡¨ä¸­çš„å·²é‡Šæ”¾å¯¹è±¡ä¿æŒåœ¨å…¶åˆå§‹åŒ–çŠ¶æ€ï¼Œslab åˆ†é…å™¨å› æ­¤é¿å…äº†æ¯ä¸ªå¯¹è±¡çš„é¢‘ç¹åˆå§‹åŒ–å’Œé”€æ¯å‘¨æœŸï¼Œä»è€Œæ˜¾ç€é™ä½äº†å¼€é”€ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:4:1","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.2 ä¼™ä¼´åˆ†é…å™¨ ç”±äºåˆå¹¶å¯¹äºåˆ†é…å™¨è‡³å…³é‡è¦ï¼Œå› æ­¤è®¾è®¡äº†ä¸€äº›æ–¹æ³•æ¥ç®€åŒ–åˆå¹¶ã€‚äºŒè¿›åˆ¶ä¼™ä¼´åˆ†é…å™¨å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ åœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­ï¼Œç©ºé—²å†…å­˜é¦–å…ˆåœ¨æ¦‚å¿µä¸Šè¢«è®¤ä¸ºæ˜¯å¤§å°ä¸º $2^N$ çš„å¤§ç©ºé—´ã€‚å½“å‘å‡ºå†…å­˜è¯·æ±‚æ—¶ï¼Œå¯¹å¯ç”¨ç©ºé—´çš„æœç´¢ä¼šé€’å½’åœ°å°†å¯ç”¨ç©ºé—´ä¸€åˆ†ä¸ºäºŒï¼Œç›´åˆ°æ‰¾åˆ°è¶³å¤Ÿå¤§ä»¥å®¹çº³è¯·æ±‚çš„å—ï¼ˆè¿›ä¸€æ­¥åˆ†æˆä¸¤éƒ¨åˆ†å°†å¯¼è‡´ç©ºé—´å¤ªå°ï¼‰ã€‚æ­¤æ—¶ï¼Œæ‰€è¯·æ±‚çš„å—å°±è¿”å›ç»™ç”¨æˆ·äº†ã€‚ä»¥ä¸‹æ˜¯åœ¨æœç´¢ 7KB å—æ—¶åˆ’åˆ† 64KB å¯ç”¨ç©ºé—´çš„ç¤ºä¾‹ï¼š åœ¨ç¤ºä¾‹ä¸­ï¼Œæœ€å·¦è¾¹çš„ 8KB å—è¢«åˆ†é…ï¼ˆå¦‚è¾ƒæ·±çš„è“è‰²é˜´å½±æ‰€ç¤ºï¼‰å¹¶è¿”å›ç»™ç”¨æˆ·ï¼›è¯·æ³¨æ„ï¼Œè¯¥æ–¹æ¡ˆå¯èƒ½ä¼šå—åˆ°å†…éƒ¨ç¢ç‰‡çš„å½±å“ï¼Œå› ä¸ºæ‚¨åªèƒ½ç»™å‡ºä¸¤å€å¤§å°çš„å—ã€‚ ä¼™ä¼´åˆ†é…çš„ç¾å¦™ä¹‹å¤„åœ¨äºé‡Šæ”¾è¯¥å—æ—¶å‘ç”Ÿçš„æƒ…å†µã€‚å½“å°†8KBå—è¿”å›åˆ°ç©ºé—²åˆ—è¡¨æ—¶ï¼Œåˆ†é…å™¨æ£€æŸ¥â€œä¼™ä¼´â€8KBæ˜¯å¦ç©ºé—²ï¼›å¦‚æœæ˜¯ï¼Œå®ƒå°†æŠŠä¸¤ä¸ªå—åˆå¹¶æˆä¸€ä¸ª 16KB çš„å—ã€‚ç„¶ååˆ†é…å™¨æ£€æŸ¥ 16KB å—çš„ä¼™ä¼´æ˜¯å¦ä»ç„¶ç©ºé—²ï¼›å¦‚æœæ˜¯è¿™æ ·ï¼Œå®ƒå°†åˆå¹¶è¿™ä¸¤ä¸ªå—ã€‚è¿™ç§é€’å½’åˆå¹¶è¿‡ç¨‹æ²¿ç€æ ‘ç»§ç»­è¿›è¡Œï¼Œè¦ä¹ˆæ¢å¤æ•´ä¸ªå¯ç”¨ç©ºé—´ï¼Œè¦ä¹ˆåœ¨å‘ç°ä¼™ä¼´æ­£åœ¨ä½¿ç”¨æ—¶åœæ­¢ã€‚ ä¼™ä¼´åˆ†é…å·¥ä½œå¦‚æ­¤é¡ºåˆ©çš„åŸå› æ˜¯ç¡®å®šç‰¹å®šå—çš„ä¼™ä¼´å¾ˆç®€å•ã€‚æƒ³æƒ³ä¸Šé¢ç©ºé—²ç©ºé—´ä¸­å—çš„åœ°å€ã€‚å¦‚æœæ‚¨ä»”ç»†æ€è€ƒï¼Œæ‚¨ä¼šå‘ç°æ¯ä¸ªå¥½å‹å¯¹çš„åœ°å€ä»…ç›¸å·®ä¸€ä½ï¼›å“ªä¸€ä½ç”±å¥½å‹æ ‘ä¸­çš„çº§åˆ«å†³å®šã€‚è¿™æ ·æ‚¨å°±å¯¹äºŒè¿›åˆ¶å¥½å‹åˆ†é…æ–¹æ¡ˆçš„å·¥ä½œåŸç†æœ‰äº†åŸºæœ¬çš„äº†è§£ã€‚ ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:4:2","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.3 å…¶ä»–æ–¹æ³• ä¸Šè¿°è®¸å¤šæ–¹æ³•çš„ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯å®ƒä»¬ç¼ºä¹æ‰©å±•æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œæœç´¢åˆ—è¡¨å¯èƒ½ä¼šéå¸¸æ…¢ã€‚å› æ­¤ï¼Œé«˜çº§åˆ†é…å™¨ä½¿ç”¨æ›´å¤æ‚çš„æ•°æ®ç»“æ„æ¥è§£å†³è¿™äº›æˆæœ¬ï¼Œä»¥ç®€å•æ€§æ¢å–æ€§èƒ½ã€‚ä¾‹å¦‚å¹³è¡¡äºŒå‰æ ‘ã€å±•å¼€æ ‘æˆ–éƒ¨åˆ†æ’åºæ ‘ç­‰ã€‚ é‰´äºç°ä»£ç³»ç»Ÿé€šå¸¸å…·æœ‰å¤šä¸ªå¤„ç†å™¨å¹¶è¿è¡Œå¤šçº¿ç¨‹å·¥ä½œè´Ÿè½½ï¼Œå› æ­¤åœ¨åŸºäºå¤šå¤„ç†å™¨çš„ç³»ç»Ÿä¸ŠèŠ±è´¹å¤§é‡ç²¾åŠ›ä½¿åˆ†é…å™¨æ­£å¸¸å·¥ä½œä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚ Understanding glibc malloc ","date":"2024-04-25","objectID":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/:4:3","tags":["OS"],"title":"ç©ºé—²ç©ºé—´ç®¡ç†","uri":"/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 åˆ†æ®µï¼šå¹¿ä¹‰åŸºæ•°/è¾¹ç•Œ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å°†æ¯ä¸ªè¿›ç¨‹çš„æ•´ä¸ªåœ°å€ç©ºé—´æ”¾å…¥å†…å­˜ä¸­ã€‚é€šè¿‡åŸºå€å¯„å­˜å™¨å’Œè¾¹ç•Œå¯„å­˜å™¨ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥è½»æ¾åœ°å°†è¿›ç¨‹é‡æ–°å®šä½åˆ°ç‰©ç†å†…å­˜çš„ä¸åŒéƒ¨åˆ†ã€‚ç„¶è€Œï¼Œæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°æˆ‘ä»¬çš„è¿™äº›åœ°å€ç©ºé—´æœ‰ä¸€äº›æœ‰è¶£çš„åœ°æ–¹ï¼šåœ¨æ ˆå’Œå †ä¹‹é—´çš„ä¸­é—´æœ‰ä¸€å¤§å—â€œç©ºé—²â€ç©ºé—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è™½ç„¶æ ˆå’Œå †ä¹‹é—´çš„ç©ºé—´æ²¡æœ‰è¢«è¿›ç¨‹ä½¿ç”¨ï¼Œä½†å½“æˆ‘ä»¬å°†æ•´ä¸ªåœ°å€ç©ºé—´é‡æ–°å®šä½åˆ°ç‰©ç†å†…å­˜ä¸­çš„æŸä¸ªä½ç½®æ—¶ï¼Œå®ƒä»ç„¶å ç”¨ç‰©ç†å†…å­˜ï¼›å› æ­¤ï¼Œä½¿ç”¨åŸºå€å’Œè¾¹ç•Œå¯„å­˜å™¨å¯¹æ¥è™šæ‹ŸåŒ–å†…å­˜çš„ç®€å•æ–¹æ³•æ˜¯æµªè´¹çš„ã€‚å½“æ•´ä¸ªåœ°å€ç©ºé—´æ— æ³•æ”¾å…¥å†…å­˜æ—¶ï¼Œå®ƒä¹Ÿä¼šä½¿ç¨‹åºçš„è¿è¡Œå˜å¾—éå¸¸å›°éš¾ï¼›å› æ­¤ï¼ŒåŸºæ•°å’Œè¾¹ç•Œå¹¶ä¸åƒæˆ‘ä»¬å¸Œæœ›çš„é‚£æ ·çµæ´»ã€‚å› æ­¤ï¼šå…³é”®ï¼šå¦‚ä½•æ”¯æŒå¤§åœ°å€ç©ºé—´ æˆ‘ä»¬å¦‚ä½•æ”¯æŒå¤§åœ°å€ç©ºé—´ä»¥åŠæ ˆå’Œå †ä¹‹é—´ï¼ˆå¯èƒ½ï¼‰æœ‰å¤§é‡å¯ç”¨ç©ºé—´ï¼Ÿ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæƒ³æ³•åº”è¿è€Œç”Ÿï¼Œå®ƒå°±æ˜¯åˆ†æ®µã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å½“å¤è€çš„æƒ³æ³•ï¼Œè‡³å°‘å¯ä»¥è¿½æº¯åˆ° 1960 å¹´ä»£åˆã€‚è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•ï¼šä¸å…¶åœ¨æˆ‘ä»¬çš„ MMU ä¸­åªæœ‰ä¸€ä¸ªåŸºå€å’Œè¾¹ç•Œå¯¹ï¼Œä¸ºä»€ä¹ˆä¸åœ¨åœ°å€ç©ºé—´çš„æ¯ä¸ªé€»è¾‘æ®µéƒ½æœ‰ä¸€ä¸ªåŸºå€å’Œè¾¹ç•Œå¯¹å‘¢ï¼Ÿæ®µåªæ˜¯ç‰¹å®šé•¿åº¦çš„åœ°å€ç©ºé—´çš„è¿ç»­éƒ¨åˆ†ï¼Œåœ¨æˆ‘ä»¬çš„è§„èŒƒåœ°å€ç©ºé—´ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªé€»è¾‘ä¸Šä¸åŒçš„æ®µï¼šä»£ç ã€æ ˆå’Œå †ã€‚åˆ†æ®µå…è®¸æ“ä½œç³»ç»Ÿåšçš„æ˜¯å°†æ¯ä¸ªæ®µæ”¾ç½®åœ¨ç‰©ç†å†…å­˜çš„ä¸åŒéƒ¨åˆ†ï¼Œä»è€Œé¿å…ç”¨æœªä½¿ç”¨çš„è™šæ‹Ÿåœ°å€ç©ºé—´å¡«å……ç‰©ç†å†…å­˜ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦å°†ä¸‹å›¾ä¸­çš„åœ°å€ç©ºé—´æ”¾å…¥ç‰©ç†å†…å­˜ä¸­ã€‚ç”±äºæ¯ä¸ªæ®µéƒ½æœ‰ä¸€ä¸ªåŸºå€å’Œè¾¹ç•Œå¯¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªæ®µç‹¬ç«‹åœ°æ”¾ç½®åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚æ‚¨å¯ä»¥çœ‹åˆ° 64KB ç‰©ç†å†…å­˜ï¼Œå…¶ä¸­åŒ…å«è¿™ä¸‰ä¸ªæ®µï¼ˆè¿˜æœ‰ 16KB ä¸ºæ“ä½œç³»ç»Ÿä¿ç•™ï¼‰ ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»£ç æ®µæ”¾ç½®åœ¨ç‰©ç†åœ°å€32KBï¼Œå¤§å°ä¸º2KBï¼Œå †æ®µæ”¾ç½®åœ¨34KBï¼Œå¤§å°ä¹Ÿä¸º2KBã€‚å‡è®¾å¯¹è™šæ‹Ÿåœ°å€ 100ï¼ˆä½äºä»£ç æ®µä¸­ï¼Œä»£ç æ®µä»åœ°å€ç©ºé—´ä¸­çš„è™šæ‹Ÿåœ°å€0å¼€å§‹ã€‚ï¼‰è¿›è¡Œäº†å¼•ç”¨ã€‚å½“å‘ç”Ÿå¼•ç”¨æ—¶ï¼ˆä¾‹å¦‚ï¼Œåœ¨æŒ‡ä»¤è·å–æ—¶ï¼‰ï¼Œç¡¬ä»¶ä¼šå°†åŸºå€å€¼æ·»åŠ åˆ°è¯¥æ®µçš„åç§»é‡ï¼ˆæœ¬ä¾‹ä¸­ä¸º 100ï¼‰ï¼Œä»¥è¾¾åˆ°æ‰€éœ€çš„ç‰©ç†åœ°å€ï¼š100 + 32KBï¼Œæˆ– 32868ã€‚ç„¶åæ£€æŸ¥è¯¥åœ°å€æ˜¯å¦åœ¨èŒƒå›´å†…ï¼ˆ100å°äº2KBï¼‰ï¼Œå‘ç°å®ƒåœ¨èŒƒå›´å†…ï¼Œç„¶åå‘å‡ºå¯¹ç‰©ç†å†…å­˜åœ°å€32868çš„å¼•ç”¨ã€‚ ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å †ä¸­çš„ä¸€ä¸ªåœ°å€ï¼Œè™šæ‹Ÿåœ°å€ 4200ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¦‚æœæˆ‘ä»¬åªæ˜¯å°†è™šæ‹Ÿåœ°å€ 4200 æ·»åŠ åˆ°å †åŸºå€ (34KB)ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ç‰©ç†åœ°å€ 39016ï¼Œè¿™ä¸æ˜¯æ­£ç¡®çš„ç‰©ç†åœ°å€ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦åšçš„æ˜¯å°†åç§»é‡æå–åˆ°å †ä¸­ï¼Œå³åœ°å€å¼•ç”¨äº†è¯¥æ®µä¸­çš„å“ªä¸ªå­—èŠ‚ã€‚å› ä¸ºå †ä»è™šæ‹Ÿåœ°å€ 4KB (4096) å¼€å§‹ï¼Œæ‰€ä»¥ 4200 çš„åç§»é‡å®é™…ä¸Šæ˜¯ 4200 å‡å» 4096ï¼Œå³ 104ã€‚ç„¶åæˆ‘ä»¬å°†è¿™ä¸ªåç§»é‡ (104) æ·»åŠ åˆ°åŸºå€å¯„å­˜å™¨ç‰©ç†åœ°å€ (34K) ä»¥è·å¾—æ‰€éœ€çš„ç»“æœï¼š34920ã€‚ å¦‚æœæˆ‘ä»¬å°è¯•å¼•ç”¨éæ³•åœ°å€ï¼Œä¾‹å¦‚è¶…å‡ºå †æœ«å°¾çš„7KBï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿæ‚¨å¯ä»¥æƒ³è±¡ä¼šå‘ç”Ÿä»€ä¹ˆï¼šç¡¬ä»¶æ£€æµ‹åˆ°åœ°å€è¶Šç•Œï¼Œè¿›å…¥æ“ä½œç³»ç»Ÿä¸­æ–­ï¼Œå¯èƒ½å¯¼è‡´è¿è§„è¿›ç¨‹ç»ˆæ­¢ã€‚ç°åœ¨æ‚¨çŸ¥é“äº†æ‰€æœ‰ C ç¨‹åºå‘˜éƒ½å®³æ€•çš„è‘—åæœ¯è¯­çš„ç”±æ¥ï¼šåˆ†æ®µè¿è§„æˆ–åˆ†æ®µé”™è¯¯ã€‚ â€œåˆ†æ®µé”™è¯¯â€æˆ–â€œè¿è§„â€æ˜¯ç”±åˆ†æ®µæœºå™¨ä¸Šå¯¹éæ³•åœ°å€çš„å†…å­˜è®¿é—®å¼•èµ·çš„ã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™ä¸ªæœ¯è¯­ä»ç„¶å­˜åœ¨ï¼Œå³ä½¿åœ¨æ ¹æœ¬ä¸æ”¯æŒåˆ†æ®µçš„æœºå™¨ä¸Šä¹Ÿæ˜¯å¦‚æ­¤ã€‚æˆ–è€…ï¼Œå¦‚æœä½ æ— æ³•å¼„æ¸…æ¥šä¸ºä»€ä¹ˆä½ çš„ä»£ç æ€»æ˜¯å‡ºé”™ï¼Œé‚£å°±ä¸é‚£ä¹ˆå¹½é»˜äº†ã€‚ ","date":"2024-04-25","objectID":"/posts/11.%E6%AE%B5/:1:0","tags":["OS"],"title":"æ®µ","uri":"/posts/11.%E6%AE%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 å¼•ç”¨æ®µ ç¡¬ä»¶åœ¨è½¬æ¢æœŸé—´ä½¿ç”¨æ®µå¯„å­˜å™¨ã€‚å®ƒå¦‚ä½•çŸ¥é“æ®µä¸­çš„åç§»é‡ä»¥åŠåœ°å€å¼•ç”¨å“ªä¸ªæ®µï¼Ÿ ä¸€ç§å¸¸è§çš„æ–¹æ³•ï¼ˆæœ‰æ—¶ç§°ä¸ºæ˜¾å¼æ–¹æ³•ï¼‰æ˜¯æ ¹æ®è™šæ‹Ÿåœ°å€çš„å‰å‡ ä½å°†åœ°å€ç©ºé—´åˆ†æˆå¤šä¸ªæ®µï¼›è¯¥æŠ€æœ¯ç”¨äº VAX/VMS ç³»ç»Ÿã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼›å› æ­¤æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä½æ¥å®Œæˆæˆ‘ä»¬çš„ä»»åŠ¡ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ 14 ä½è™šæ‹Ÿåœ°å€çš„å‰ä¸¤ä½æ¥é€‰æ‹©æ®µï¼Œæˆ‘ä»¬çš„è™šæ‹Ÿåœ°å€å¦‚ä¸‹æ‰€ç¤ºï¼š åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœå‰ä¸¤ä½æ˜¯ 00ï¼Œåˆ™ç¡¬ä»¶çŸ¥é“è™šæ‹Ÿåœ°å€ä½äºä»£ç æ®µä¸­ï¼Œå› æ­¤ä½¿ç”¨ä»£ç åŸºå€å’Œè¾¹ç•Œå¯¹å°†åœ°å€é‡æ–°å®šä½åˆ°æ­£ç¡®çš„ç‰©ç†ä½ç½®ã€‚å¦‚æœå‰ä¸¤ä½æ˜¯ 01ï¼Œåˆ™ç¡¬ä»¶çŸ¥é“è¯¥åœ°å€åœ¨å †ä¸­ï¼Œå› æ­¤ä½¿ç”¨å †åŸºå€å’Œè¾¹ç•Œã€‚è®©æˆ‘ä»¬ä»¥ä¸Šé¢çš„ç¤ºä¾‹å †è™šæ‹Ÿåœ°å€ (4200) ä¸ºä¾‹å¹¶å¯¹å…¶è¿›è¡Œè½¬æ¢ï¼Œåªæ˜¯ä¸ºäº†ç¡®ä¿è¿™ä¸€ç‚¹æ˜¯æ¸…æ¥šçš„ã€‚äºŒè¿›åˆ¶å½¢å¼çš„è™šæ‹Ÿåœ°å€ 4200 å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå‰ä¸¤ä½ (01) å‘Šè¯‰ç¡¬ä»¶æˆ‘ä»¬æ­£åœ¨å¼•ç”¨å“ªä¸ªæ®µã€‚åº•éƒ¨ 12 ä½æ˜¯æ®µä¸­çš„åç§»é‡ï¼š0000 0110 1000ï¼Œæˆ–åå…­è¿›åˆ¶ 0x068ï¼Œæˆ–åè¿›åˆ¶ 104ã€‚å› æ­¤ï¼Œç¡¬ä»¶åªéœ€ä½¿ç”¨å‰ä¸¤ä½æ¥ç¡®å®šè¦ä½¿ç”¨å“ªä¸ªæ®µå¯„å­˜å™¨ï¼Œç„¶åå°†æ¥ä¸‹æ¥çš„ 12 ä½ä½œä¸ºæ®µä¸­çš„åç§»é‡ã€‚é€šè¿‡å°†åŸºå€å¯„å­˜å™¨ä¸åç§»é‡ç›¸åŠ ï¼Œç¡¬ä»¶å¾—å‡ºæœ€ç»ˆçš„ç‰©ç†åœ°å€ã€‚è¯·æ³¨æ„ï¼Œåç§»é‡ä¹Ÿç®€åŒ–äº†è¾¹ç•Œæ£€æŸ¥ï¼šæˆ‘ä»¬å¯ä»¥ç®€å•åœ°æ£€æŸ¥åç§»é‡æ˜¯å¦å°äºè¾¹ç•Œï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™è¯¥åœ°å€æ˜¯éæ³•çš„ã€‚å› æ­¤ï¼Œå¦‚æœåŸºå€å’Œè¾¹ç•Œæ˜¯æ•°ç»„ï¼ˆæ¯ä¸ªæ®µä¸€ä¸ªæ¡ç›®ï¼‰ï¼Œç¡¬ä»¶å°†æ‰§è¡Œç±»ä¼¼ä»¥ä¸‹æ“ä½œæ¥è·å–æ‰€éœ€çš„ç‰©ç†åœ°å€ï¼š // get top 2 bits of 14-bit VA Segment = (VirtualAddress \u0026 SEG_MASK) \u003e\u003e SEG_SHIFT; // now get offset Offset = VirtualAddress \u0026 OFFSET_MASK; if (Offset \u003e= Bounds[Segment]) { RaiseException(PROTECTION_FAULT); } else { PhysAddr = Base[Segment] + Offset; Register = AccessMemory(PhysAddr); } åœ¨æˆ‘ä»¬çš„è¿è¡Œç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¡«å†™ä¸Šé¢å¸¸é‡çš„å€¼ã€‚å…·ä½“æ¥è¯´ï¼ŒSEG MASK å°†è®¾ç½®ä¸º 0x3000ï¼ŒSEG SHIFT è®¾ç½®ä¸º 12ï¼ŒOFFSET MASK è®¾ç½®ä¸º 0xFFFã€‚æ‚¨å¯èƒ½è¿˜æ³¨æ„åˆ°ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨å‰ä¸¤ä½æ—¶ï¼Œå¹¶ä¸”åªæœ‰ä¸‰ä¸ªæ®µï¼ˆä»£ç ã€å †ã€æ ˆï¼‰ï¼Œåœ°å€ç©ºé—´çš„ä¸€ä¸ªæ®µæœªè¢«ä½¿ç”¨ã€‚å› æ­¤ï¼Œä¸€äº›ç³»ç»Ÿå°†ä»£ç æ”¾åœ¨ä¸å †ç›¸åŒçš„æ®µä¸­ï¼Œä»è€Œä»…ä½¿ç”¨ä¸€ä½æ¥é€‰æ‹©è¦ä½¿ç”¨çš„æ®µã€‚ ç¡¬ä»¶è¿˜æœ‰å…¶ä»–æ–¹æ³•æ¥ç¡®å®šç‰¹å®šåœ°å€ä½äºå“ªä¸ªæ®µã€‚åœ¨éšå¼æ–¹æ³•ä¸­ï¼Œç¡¬ä»¶é€šè¿‡æ³¨æ„åœ°å€çš„å½¢æˆæ–¹å¼æ¥ç¡®å®šæ®µã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ°å€æ˜¯ä»ç¨‹åºè®¡æ•°å™¨ç”Ÿæˆçš„ï¼ˆå³ï¼Œå®ƒæ˜¯æŒ‡ä»¤æå–ï¼‰ï¼Œåˆ™è¯¥åœ°å€åœ¨ä»£ç æ®µå†…ï¼›å¦‚æœåœ°å€åŸºäºæ ˆæˆ–åŸºå€æŒ‡é’ˆï¼Œåˆ™å®ƒå¿…é¡»ä½äºæ ˆæ®µä¸­ï¼›ä»»ä½•å…¶ä»–åœ°å€åˆ™éƒ½ä½äºå †ä¸­ã€‚ ","date":"2024-04-25","objectID":"/posts/11.%E6%AE%B5/:2:0","tags":["OS"],"title":"æ®µ","uri":"/posts/11.%E6%AE%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 å…³äºæ ˆ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬é—æ¼äº†åœ°å€ç©ºé—´çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼šæ ˆã€‚ä¸Šå›¾ä¸­ï¼Œæ ˆå·²é‡æ–°å®šä½åˆ°ç‰©ç†åœ°å€ 28KBï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®åŒºåˆ«ï¼šå®ƒå‘åå¢é•¿ã€‚åœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œä»28KBå¼€å§‹ï¼Œå¢é•¿åˆ°26KBï¼Œå¯¹åº”è™šæ‹Ÿåœ°å€16KBåˆ°14KBï¼›åœ°å€è½¬æ¢å¿…é¡»ä»¥ä¸åŒçš„æ–¹å¼è¿›è¡Œã€‚ æˆ‘ä»¬é¦–å…ˆéœ€è¦çš„æ˜¯ä¸€äº›é¢å¤–çš„ç¡¬ä»¶æ”¯æŒã€‚ç¡¬ä»¶ä¸ä»…éœ€è¦çŸ¥é“åŸºå€å€¼å’Œè¾¹ç•Œå€¼ï¼Œè¿˜éœ€è¦çŸ¥é“æ®µå¢é•¿çš„æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œå½“æ®µæ²¿æ­£æ–¹å‘å¢é•¿æ—¶è®¾ç½®ä¸º 1ï¼Œå½“æ®µæ²¿è´Ÿæ–¹å‘å¢é•¿æ—¶è®¾ç½®ä¸º 0ï¼‰ã€‚æˆ‘ä»¬å¯¹ç¡¬ä»¶è·Ÿè¸ªå†…å®¹çš„æ›´æ–°è§†å›¾å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š Segment Base Size Grows Positive? Protection Code 32K 2K 1 Read-Execute Heap 34K 2K 1 Read-Write Stack 28K 2K 0 Read-Write ç”±äºç¡¬ä»¶äº†è§£æ®µå¯ä»¥å‘è´Ÿæ–¹å‘å¢é•¿ï¼Œå› æ­¤ç¡¬ä»¶ç°åœ¨å¿…é¡»ç¨å¾®ä¸åŒåœ°è½¬æ¢æ­¤ç±»è™šæ‹Ÿåœ°å€ã€‚è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªæ ˆè™šæ‹Ÿåœ°å€çš„ä¾‹å­ï¼Œå¹¶è½¬æ¢å®ƒæ¥ç†è§£è¿™ä¸ªè¿‡ç¨‹ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå‡è®¾æˆ‘ä»¬å¸Œæœ›è®¿é—®è™šæ‹Ÿåœ°å€ 15KBï¼Œè¯¥åœ°å€åº”æ˜ å°„åˆ°ç‰©ç†åœ°å€ 27KBã€‚æˆ‘ä»¬çš„äºŒè¿›åˆ¶å½¢å¼çš„è™šæ‹Ÿåœ°å€å¦‚ä¸‹æ‰€ç¤ºï¼š11 1100 0000 0000ï¼ˆåå…­è¿›åˆ¶0x3C00ï¼‰ã€‚ç¡¬ä»¶ä½¿ç”¨å‰ä¸¤ä½ (11) æ¥æŒ‡å®šæ®µï¼Œä½†æˆ‘ä»¬ç•™ä¸‹äº† 3KB çš„åç§»é‡ã€‚ä¸ºäº†è·å¾—æ­£ç¡®çš„è´Ÿåç§»é‡ï¼Œæˆ‘ä»¬å¿…é¡»ä» 3KB ä¸­å‡å»æœ€å¤§æ®µå¤§å°ï¼šåœ¨æœ¬ä¾‹ä¸­ï¼Œä¸€ä¸ªæ®µå¯ä»¥æ˜¯ 4KBï¼Œå› æ­¤æ­£ç¡®çš„è´Ÿåç§»é‡æ˜¯ 3KB å‡å» 4KBï¼Œç­‰äº -1KBã€‚æˆ‘ä»¬åªéœ€å°†è´Ÿåç§»é‡ (-1KB) æ·»åŠ åˆ°åŸºå€ (28KB) å³å¯å¾—åˆ°æ­£ç¡®çš„ç‰©ç†åœ°å€ï¼š27KBã€‚å¯ä»¥é€šè¿‡ç¡®ä¿è´Ÿåç§»çš„ç»å¯¹å€¼å°äºæ®µçš„å¤§å°æ¥è®¡ç®—è¾¹ç•Œæ£€æŸ¥ã€‚ ","date":"2024-04-25","objectID":"/posts/11.%E6%AE%B5/:3:0","tags":["OS"],"title":"æ®µ","uri":"/posts/11.%E6%AE%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 æ”¯æŒæ®µå…±äº« éšç€å¯¹åˆ†æ®µçš„æ”¯æŒä¸æ–­å¢é•¿ï¼Œç³»ç»Ÿè®¾è®¡äººå‘˜å¾ˆå¿«æ„è¯†åˆ°ï¼Œä»–ä»¬å¯ä»¥é€šè¿‡æ›´å¤šçš„ç¡¬ä»¶æ”¯æŒæ¥å®ç°æ–°å‹æ•ˆç‡ã€‚å…·ä½“æ¥è¯´ï¼Œä¸ºäº†èŠ‚çœå†…å­˜ï¼Œæœ‰æ—¶åœ¨åœ°å€ç©ºé—´ä¹‹é—´å…±äº«æŸäº›å†…å­˜æ®µå¾ˆæœ‰ç”¨ã€‚ç‰¹åˆ«æ˜¯ï¼Œä»£ç å…±äº«å¾ˆå¸¸è§ï¼Œå¹¶ä¸”åœ¨å½“ä»Šçš„ç³»ç»Ÿä¸­ä»åœ¨ä½¿ç”¨ã€‚ ä¸ºäº†æ”¯æŒå…±äº«ï¼Œæˆ‘ä»¬éœ€è¦ç¡¬ä»¶ä»¥ä¿æŠ¤ä½çš„å½¢å¼æä¾›ä¸€äº›é¢å¤–çš„æ”¯æŒã€‚åŸºæœ¬æ”¯æŒä¸ºæ¯ä¸ªæ®µæ·»åŠ ä¸€äº›ä½ï¼ŒæŒ‡ç¤ºç¨‹åºæ˜¯å¦å¯ä»¥è¯»å–æˆ–å†™å…¥æ®µï¼Œæˆ–è€…æ˜¯å¦å¯ä»¥æ‰§è¡Œæ®µå†…çš„ä»£ç ã€‚é€šè¿‡å°†ä»£ç æ®µè®¾ç½®ä¸ºåªè¯»ï¼Œå¯ä»¥åœ¨å¤šä¸ªè¿›ç¨‹ä¹‹é—´å…±äº«ç›¸åŒçš„ä»£ç ï¼Œè€Œä¸å¿…æ‹…å¿ƒæŸå®³éš”ç¦»æ€§ï¼›è™½ç„¶æ¯ä¸ªè¿›ç¨‹ä»ç„¶è®¤ä¸ºå®ƒæ­£åœ¨è®¿é—®è‡ªå·±çš„ç§æœ‰å†…å­˜ï¼Œä½†æ“ä½œç³»ç»Ÿæ­£åœ¨ç§˜å¯†å…±äº«è¯¥è¿›ç¨‹æ— æ³•ä¿®æ”¹çš„å†…å­˜ï¼Œå› æ­¤ä¿ç•™äº†è¿™ç§é”™è§‰ã€‚ ä¸Šè¡¨æ˜¾ç¤ºäº†ç¡¬ä»¶ï¼ˆå’Œæ“ä½œç³»ç»Ÿï¼‰è·Ÿè¸ªçš„é™„åŠ ä¿¡æ¯çš„ç¤ºä¾‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œä»£ç æ®µè¢«è®¾ç½®ä¸ºè¯»å–å’Œæ‰§è¡Œï¼Œå› æ­¤å†…å­˜ä¸­çš„åŒä¸€ç‰©ç†æ®µå¯ä»¥æ˜ å°„åˆ°å¤šä¸ªè™šæ‹Ÿåœ°å€ç©ºé—´ã€‚ æœ‰äº†ä¿æŠ¤ä½ï¼Œå‰é¢æè¿°çš„ç¡¬ä»¶ç®—æ³•ä¹Ÿå¿…é¡»æ”¹å˜ã€‚é™¤äº†æ£€æŸ¥è™šæ‹Ÿåœ°å€æ˜¯å¦åœ¨èŒƒå›´å†…ä¹‹å¤–ï¼Œç¡¬ä»¶è¿˜å¿…é¡»æ£€æŸ¥æ˜¯å¦å…è®¸ç‰¹å®šè®¿é—®ã€‚å¦‚æœç”¨æˆ·è¿›ç¨‹å°è¯•å†™å…¥åªè¯»æ®µï¼Œæˆ–ä»ä¸å¯æ‰§è¡Œæ®µæ‰§è¡Œï¼Œåˆ™ç¡¬ä»¶åº”å¼•å‘å¼‚å¸¸ï¼Œä»è€Œè®©æ“ä½œç³»ç»Ÿå¤„ç†è¿è§„è¿›ç¨‹ã€‚ ","date":"2024-04-25","objectID":"/posts/11.%E6%AE%B5/:4:0","tags":["OS"],"title":"æ®µ","uri":"/posts/11.%E6%AE%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 ç»†ç²’åº¦åˆ†æ®µä¸ç²—ç²’åº¦åˆ†æ®µ è¿„ä»Šä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„å¤§å¤šæ•°ç¤ºä¾‹éƒ½é›†ä¸­åœ¨åªæœ‰å‡ ä¸ªåˆ†æ®µï¼ˆå³ä»£ç ã€æ ˆã€å †ï¼‰çš„ç³»ç»Ÿä¸Šï¼›æˆ‘ä»¬å¯ä»¥å°†è¿™ç§åˆ†æ®µè§†ä¸ºç²—ç²’åº¦åˆ†æ®µï¼Œå› ä¸ºå®ƒå°†åœ°å€ç©ºé—´åˆ†å‰²æˆç›¸å¯¹è¾ƒå¤§ã€è¾ƒç²—çš„å—ã€‚ç„¶è€Œï¼Œä¸€äº›æ—©æœŸçš„ç³»ç»Ÿï¼ˆå¦‚ Multicsï¼‰æ›´åŠ çµæ´»ï¼Œå…è®¸åœ°å€ç©ºé—´ç”±å¤§é‡è¾ƒå°çš„æ®µç»„æˆï¼Œç§°ä¸ºç»†ç²’åº¦åˆ†æ®µã€‚ æ”¯æŒå¤šåˆ†æ®µéœ€è¦æ›´å¤šç¡¬ä»¶æ”¯æŒï¼Œåœ¨å†…å­˜ä¸­å­˜å‚¨æŸç§åˆ†æ®µè¡¨ã€‚è¿™ç§æ®µè¡¨é€šå¸¸æ”¯æŒåˆ›å»ºå¤§é‡çš„æ®µï¼Œä»è€Œä½¿ç³»ç»Ÿèƒ½å¤Ÿä»¥æ¯”æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢è®¨è®ºçš„æ›´çµæ´»çš„æ–¹å¼ä½¿ç”¨æ®µã€‚ä¾‹å¦‚ï¼Œæ—©æœŸçš„æœºå™¨ï¼ˆå¦‚ Burroughs B5000ï¼‰æ”¯æŒæ•°åƒä¸ªåˆ†æ®µï¼Œå¹¶æœŸæœ›ç¼–è¯‘å™¨å°†ä»£ç å’Œæ•°æ®åˆ‡åˆ†æˆç‹¬ç«‹çš„åˆ†æ®µï¼Œç„¶åæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å°†æ”¯æŒè¿™äº›åˆ†æ®µã€‚å½“æ—¶çš„æƒ³æ³•æ˜¯ï¼Œé€šè¿‡ç»†åŒ–åˆ†æ®µï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥æ›´å¥½åœ°äº†è§£å“ªäº›åˆ†æ®µæ­£åœ¨ä½¿ç”¨ï¼Œå“ªäº›æ²¡æœ‰ä½¿ç”¨ï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°åˆ©ç”¨ä¸»å†…å­˜ã€‚ ","date":"2024-04-25","objectID":"/posts/11.%E6%AE%B5/:5:0","tags":["OS"],"title":"æ®µ","uri":"/posts/11.%E6%AE%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 æ“ä½œç³»ç»Ÿæ”¯æŒ æ‚¨ç°åœ¨åº”è¯¥å¯¹åˆ†æ®µçš„å·¥ä½œåŸç†æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ã€‚å½“ç³»ç»Ÿè¿è¡Œæ—¶ï¼Œåœ°å€ç©ºé—´çš„å„ä¸ªéƒ¨åˆ†ä¼šè¢«é‡æ–°å®šä½åˆ°ç‰©ç†å†…å­˜ä¸­ï¼Œå› æ­¤ï¼Œç›¸å¯¹äºæ•´ä¸ªåœ°å€ç©ºé—´ä»…ä½¿ç”¨å•ä¸ªåŸºå€/è¾¹ç•Œå¯¹çš„æ›´ç®€å•æ–¹æ³•ï¼Œå¯ä»¥èŠ‚çœå¤§é‡ç‰©ç†å†…å­˜ã€‚å…·ä½“æ¥è¯´ï¼Œæ ˆå’Œå †ä¹‹é—´æ‰€æœ‰æœªä½¿ç”¨çš„ç©ºé—´éƒ½ä¸éœ€è¦åˆ†é…åœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œä»è€Œå…è®¸æˆ‘ä»¬å°†æ›´å¤šçš„åœ°å€ç©ºé—´æ”¾å…¥ç‰©ç†å†…å­˜ä¸­ã€‚ ç„¶è€Œï¼Œåˆ†æ®µå¼•å‘äº†è®¸å¤šæ–°é—®é¢˜ã€‚æˆ‘ä»¬å°†é¦–å…ˆæè¿°å¿…é¡»è§£å†³çš„æ–°æ“ä½œç³»ç»Ÿé—®é¢˜ã€‚ ç¬¬ä¸€ä¸ªæ˜¯æ—§çš„ï¼šæ“ä½œç³»ç»Ÿåœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶åº”è¯¥åšä»€ä¹ˆï¼Ÿç°åœ¨æ‚¨åº”è¯¥æœ‰ä¸€ä¸ªå¾ˆå¥½çš„çŒœæµ‹ï¼šå¿…é¡»ä¿å­˜å’Œæ¢å¤æ®µå¯„å­˜å™¨ã€‚æ˜¾ç„¶ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»ç¡®ä¿åœ¨è®©è¿›ç¨‹å†æ¬¡è¿è¡Œä¹‹å‰æ­£ç¡®è®¾ç½®è¿™äº›å¯„å­˜å™¨ã€‚ ç¬¬äºŒä¸ªä¹Ÿæ˜¯æ›´é‡è¦çš„é—®é¢˜æ˜¯ç®¡ç†ç‰©ç†å†…å­˜ä¸­çš„å¯ç”¨ç©ºé—´ã€‚å½“åˆ›å»ºæ–°çš„åœ°å€ç©ºé—´æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿåœ¨ç‰©ç†å†…å­˜ä¸­ä¸ºå…¶æ®µæ‰¾åˆ°ç©ºé—´ã€‚ä»¥å‰ï¼Œæˆ‘ä»¬å‡è®¾æ¯ä¸ªåœ°å€ç©ºé—´çš„å¤§å°ç›¸åŒï¼Œå› æ­¤ç‰©ç†å†…å­˜å¯ä»¥è¢«è®¤ä¸ºæ˜¯è¿›ç¨‹å¯ä»¥å®¹çº³çš„ä¸€å †æ’æ§½ã€‚ç°åœ¨ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰å¤šä¸ªæ®µï¼Œæ¯ä¸ªæ®µå¯èƒ½æ˜¯ä¸åŒçš„å°ºå¯¸ã€‚ å‡ºç°çš„æ™®éé—®é¢˜æ˜¯ç‰©ç†å†…å­˜å¾ˆå¿«å°±ä¼šå……æ»¡å¯ç”¨ç©ºé—´çš„å°å­”ï¼Œä½¿å¾—åˆ†é…æ–°æ®µæˆ–å¢åŠ ç°æœ‰æ®µå˜å¾—å›°éš¾ã€‚æˆ‘ä»¬ç§°è¿™ä¸ªé—®é¢˜ä¸ºå¤–éƒ¨ç¢ç‰‡ï¼›å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå·¦ï¼‰ã€‚ åœ¨ç¤ºä¾‹ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹å‡ºç°å¹¶å¸Œæœ›åˆ†é…ä¸€ä¸ª 20KB çš„æ®µã€‚åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæœ‰ 24KB ç©ºé—²ç©ºé—´ï¼Œä½†ä¸æ˜¯åœ¨ä¸€ä¸ªè¿ç»­çš„æ®µä¸­ï¼ˆè€Œæ˜¯åœ¨ä¸‰ä¸ªä¸è¿ç»­çš„å—ä¸­ï¼‰ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿæ— æ³•æ»¡è¶³ 20KB è¯·æ±‚ã€‚ è¯¥é—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡é‡æ–°æ’åˆ—ç°æœ‰æ®µæ¥å‹ç¼©ç‰©ç†å†…å­˜ã€‚ä¾‹å¦‚ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥åœæ­¢æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå°†å…¶æ•°æ®å¤åˆ¶åˆ°ä¸€ä¸ªè¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œæ›´æ”¹å…¶æ®µå¯„å­˜å™¨å€¼ä»¥æŒ‡å‘æ–°çš„ç‰©ç†ä½ç½®ï¼Œä»è€Œæ‹¥æœ‰å¤§é‡å¯ç”¨çš„å¯ç”¨å†…å­˜ã€‚é€šè¿‡è¿™æ ·åšï¼Œæ“ä½œç³»ç»Ÿä½¿æ–°çš„åˆ†é…è¯·æ±‚èƒ½å¤ŸæˆåŠŸã€‚ç„¶è€Œï¼Œå‹ç¼©çš„æˆæœ¬å¾ˆé«˜ï¼Œä¸”å› ä¸ºå¤åˆ¶æ®µæ˜¯å†…å­˜å¯†é›†å‹çš„ï¼Œå¹¶ä¸”é€šå¸¸ä¼šå ç”¨ç›¸å½“å¤šçš„å¤„ç†å™¨æ—¶é—´ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ˆå³ï¼‰ï¼Œå¯æŸ¥çœ‹å‹ç¼©ç‰©ç†å†…å­˜åçš„ç»“æœã€‚ ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ç©ºé—²åˆ—è¡¨ç®¡ç†ç®—æ³•ï¼Œè¯¥ç®—æ³•å°è¯•ä¿æŒå¤§èŒƒå›´çš„å†…å­˜å¯ç”¨äºåˆ†é…ã€‚äººä»¬å®é™…ä¸Šå·²ç»é‡‡ç”¨äº†æ•°ç™¾ç§æ–¹æ³•ï¼ŒåŒ…æ‹¬ç»å…¸ç®—æ³•ï¼Œä¾‹å¦‚æœ€ä½³é€‚åº”ï¼ˆä¿ç•™å¯ç”¨ç©ºé—´åˆ—è¡¨å¹¶è¿”å›æ»¡è¶³è¯·æ±‚è€…æ‰€éœ€åˆ†é…çš„æœ€æ¥è¿‘å¤§å°çš„ç®—æ³•ï¼‰ã€æœ€å·®é€‚åº”ã€é¦–æ¬¡é€‚åº”ï¼Œä»¥åŠæ›´å¤æ‚çš„æ–¹æ¡ˆï¼Œå¦‚ä¼™ä¼´ç®—æ³• ã€‚ä½†ä¸å¹¸çš„æ˜¯ï¼Œæ— è®ºç®—æ³•å¤šä¹ˆèªæ˜ï¼Œå¤–éƒ¨ç¢ç‰‡ä»ç„¶å­˜åœ¨ï¼›å› æ­¤ï¼Œä¸€ä¸ªå¥½çš„ç®—æ³•åªæ˜¯å°è¯•å°†å…¶æœ€å°åŒ–ã€‚ TIPï¼šå¦‚æœå­˜åœ¨ 1000 ç§è§£å†³æ–¹æ¡ˆï¼Œé‚£ä¹ˆæ²¡æœ‰ä¸€ä¸ªæ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆ å­˜åœ¨å¦‚æ­¤å¤šä¸åŒçš„ç®—æ³•æ¥å°è¯•æœ€å¤§é™åº¦åœ°å‡å°‘å¤–éƒ¨ç¢ç‰‡è¿™ä¸€äº‹å®è¡¨æ˜äº†ä¸€ä¸ªæ›´å¼ºæœ‰åŠ›çš„æ½œåœ¨äº‹å®ï¼šæ²¡æœ‰ä¸€ç§â€œæœ€ä½³â€æ–¹æ³•å¯ä»¥è§£å†³é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©åˆç†çš„ä¸œè¥¿ï¼Œå¹¶å¸Œæœ›å®ƒè¶³å¤Ÿå¥½ã€‚å”¯ä¸€çœŸæ­£çš„è§£å†³æ–¹æ¡ˆæ˜¯å®Œå…¨é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæ°¸è¿œä¸è¦ä»¥å¯å˜å¤§å°çš„å—åˆ†é…å†…å­˜ã€‚ ","date":"2024-04-25","objectID":"/posts/11.%E6%AE%B5/:6:0","tags":["OS"],"title":"æ®µ","uri":"/posts/11.%E6%AE%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 æ€»ç»“ åˆ†æ®µè§£å†³äº†è®¸å¤šé—®é¢˜ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬æ„å»ºæ›´æœ‰æ•ˆçš„å†…å­˜è™šæ‹ŸåŒ–ã€‚é™¤äº†åŠ¨æ€é‡å®šä½ä¹‹å¤–ï¼Œåˆ†æ®µè¿˜å¯ä»¥é€šè¿‡é¿å…åœ°å€ç©ºé—´çš„é€»è¾‘æ®µä¹‹é—´æ½œåœ¨çš„å·¨å¤§å†…å­˜æµªè´¹æ¥æ›´å¥½åœ°æ”¯æŒç¨€ç–åœ°å€ç©ºé—´ã€‚å®ƒä¹Ÿå¾ˆå¿«ï¼Œå› ä¸ºè¿›è¡Œç®—æœ¯åˆ†æ®µæ‰€éœ€çš„æ“ä½œå¾ˆå®¹æ˜“å¹¶ä¸”éå¸¸é€‚åˆç¡¬ä»¶ï¼›åœ°å€è½¬æ¢è´¹ç”¨å¾ˆå°‘ã€‚è¿˜å‡ºç°äº†ä¸€ä¸ªé™„å¸¦å¥½å¤„ï¼šä»£ç å…±äº«ã€‚å¦‚æœä»£ç æ”¾ç½®åœ¨å•ç‹¬çš„æ®µä¸­ï¼Œåˆ™è¿™æ ·çš„æ®µå¯èƒ½ä¼šåœ¨å¤šä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºä¹‹é—´å…±äº«ã€‚ ç„¶è€Œï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€çŸ¥ï¼Œåœ¨å†…å­˜ä¸­åˆ†é…å¯å˜å¤§å°çš„æ®µä¼šå¯¼è‡´ä¸€äº›æˆ‘ä»¬å¸Œæœ›å…‹æœçš„é—®é¢˜ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¤–éƒ¨ç¢ç‰‡ã€‚å› ä¸ºæ®µæ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥å¯ç”¨å†…å­˜è¢«åˆ†æˆå¥‡æ•°å¤§å°çš„å—ï¼Œå› æ­¤æ»¡è¶³å†…å­˜åˆ†é…è¯·æ±‚å¯èƒ½å¾ˆå›°éš¾ã€‚äººä»¬å¯ä»¥å°è¯•ä½¿ç”¨æ™ºèƒ½ç®—æ³•æˆ–å®šæœŸå‹ç¼©å†…å­˜ï¼Œä½†é—®é¢˜æ˜¯æ ¹æœ¬æ€§çš„ä¸”éš¾ä»¥é¿å…ã€‚ ç¬¬äºŒä¸ªä¹Ÿè®¸æ›´é‡è¦çš„é—®é¢˜æ˜¯åˆ†æ®µä»ç„¶ä¸å¤Ÿçµæ´»ï¼Œæ— æ³•æ”¯æŒæˆ‘ä»¬å®Œå…¨é€šç”¨çš„ç¨€ç–åœ°å€ç©ºé—´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªé€»è¾‘æ®µä¸­æœ‰ä¸€ä¸ªå¤§ä½†å¾ˆå°‘ä½¿ç”¨çš„å †ï¼Œåˆ™æ•´ä¸ªå †å¿…é¡»ä»ç„¶é©»ç•™åœ¨å†…å­˜ä¸­æ‰èƒ½è¢«è®¿é—®ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬çš„åœ°å€ç©ºé—´ä½¿ç”¨æ–¹å¼æ¨¡å‹ä¸åº•å±‚åˆ†æ®µçš„è®¾è®¡æ”¯æŒæ–¹å¼ä¸å®Œå…¨åŒ¹é…ï¼Œåˆ†æ®µå°±ä¸èƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€äº›æ–°çš„è§£å†³æ–¹æ¡ˆã€‚ ","date":"2024-04-25","objectID":"/posts/11.%E6%AE%B5/:7:0","tags":["OS"],"title":"æ®µ","uri":"/posts/11.%E6%AE%B5/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"è™šæ‹ŸåŒ–å†…å­˜ä½¿ç”¨çš„é€šç”¨æŠ€æœ¯è¢«ç§°ä¸ºåŸºäºç¡¬ä»¶çš„åœ°å€è½¬æ¢ï¼Œæˆ–è€…ç®€ç§°ä¸ºåœ°å€è½¬æ¢ï¼Œæ‚¨å¯ä»¥å°†å…¶è§†ä¸ºå¯¹æœ‰é™ç›´æ¥æ‰§è¡Œçš„é€šç”¨æ–¹æ³•çš„è¡¥å……ã€‚é€šè¿‡åœ°å€è½¬æ¢ï¼Œç¡¬ä»¶å¯ä»¥è½¬æ¢æ¯ä¸ªå†…å­˜è®¿é—®ï¼ˆä¾‹å¦‚ï¼ŒæŒ‡ä»¤æå–ã€åŠ è½½æˆ–å­˜å‚¨ï¼‰ï¼Œå°†æŒ‡ä»¤æä¾›çš„è™šæ‹Ÿåœ°å€æ›´æ”¹ä¸ºæ‰€éœ€ä¿¡æ¯å®é™…æ‰€åœ¨çš„ç‰©ç†åœ°å€ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ªå­˜å‚¨å™¨å¼•ç”¨ï¼Œç¡¬ä»¶éƒ½ä¼šæ‰§è¡Œåœ°å€è½¬æ¢ï¼Œä»¥å°†åº”ç”¨ç¨‹åºå­˜å‚¨å™¨å¼•ç”¨é‡å®šå‘åˆ°å®ƒä»¬åœ¨å­˜å‚¨å™¨ä¸­çš„å®é™…ä½ç½®ã€‚å½“ç„¶ï¼Œç¡¬ä»¶æœ¬èº«æ— æ³•è™šæ‹ŸåŒ–å†…å­˜ï¼Œå› ä¸ºå®ƒåªæ˜¯æä¾›äº†æœ‰æ•ˆåœ°è™šæ‹ŸåŒ–å†…å­˜çš„ä½çº§æœºåˆ¶ã€‚æ“ä½œç³»ç»Ÿå¿…é¡»åœ¨å…³é”®ç‚¹å‚ä¸è®¾ç½®ç¡¬ä»¶ï¼Œä»¥ä¾¿è¿›è¡Œæ­£ç¡®çš„è½¬æ¢ï¼›å› æ­¤ï¼Œå®ƒå¿…é¡»ç®¡ç†å†…å­˜ï¼Œè·Ÿè¸ªå“ªäº›ä½ç½®æ˜¯ç©ºé—²çš„ï¼Œå“ªäº›ä½ç½®æ­£åœ¨ä½¿ç”¨ï¼Œå¹¶æ˜æ™ºåœ°è¿›è¡Œå¹²é¢„ä»¥ä¿æŒå¯¹å†…å­˜ä½¿ç”¨æ–¹å¼çš„æ§åˆ¶ã€‚ æ‰€æœ‰è¿™äº›å·¥ä½œçš„ç›®æ ‡å†æ¬¡æ˜¯åˆ›é€ ä¸€ä¸ªç¾ä¸½çš„å¹»è§‰ï¼šç¨‹åºæ‹¥æœ‰è‡ªå·±çš„ç§æœ‰å†…å­˜ï¼Œå…¶ä¸­é©»ç•™ç€è‡ªå·±çš„ä»£ç å’Œæ•°æ®ã€‚è™šæ‹Ÿç°å®çš„èƒŒåéšè—ç€ä¸‘é™‹çš„ç‰©ç†äº‹å®ï¼šå½“ CPUï¼ˆæˆ–å¤šä¸ª CPUï¼‰åœ¨è¿è¡Œä¸€ä¸ªç¨‹åºå’Œä¸‹ä¸€ä¸ªç¨‹åºä¹‹é—´åˆ‡æ¢æ—¶ï¼Œè®¸å¤šç¨‹åºå®é™…ä¸ŠåŒæ—¶å…±äº«å†…å­˜ã€‚é€šè¿‡è™šæ‹ŸåŒ–ï¼Œæ“ä½œç³»ç»Ÿï¼ˆåœ¨ç¡¬ä»¶çš„å¸®åŠ©ä¸‹ï¼‰å°†ä¸‘é™‹çš„æœºå™¨ç°å®è½¬å˜ä¸ºæœ‰ç”¨ã€å¼ºå¤§ä¸”æ˜“äºä½¿ç”¨çš„æŠ½è±¡ã€‚ ","date":"2024-04-25","objectID":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/:0:0","tags":["OS"],"title":"åœ°å€è½¬æ¢","uri":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å‡è®¾ï¼ˆç¬¬ä¸€æ¬¡å°è¯•ï¼‰ ç”¨æˆ·åœ°å€ç©ºé—´åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ ç”¨æˆ·åœ°å€ç©ºé—´å°äºç‰©ç†å†…å­˜ï¼ˆæœ€å¤§64KBï¼‰ æ¯ä¸ªåœ°å€ç©ºé—´å…·æœ‰ç›¸åŒçš„å¤§å°ï¼ˆæœ€å¤§16KBï¼‰ ","date":"2024-04-25","objectID":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/:1:0","tags":["OS"],"title":"åœ°å€è½¬æ¢","uri":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ä¾‹å­ æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚å‡è®¾æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œå…¶åœ°å€ç©ºé—´å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æˆ‘ä»¬è¦ç ”ç©¶çš„æ˜¯ä¸€ä¸ªç®€çŸ­çš„ä»£ç åºåˆ—ï¼šä»å†…å­˜ä¸­åŠ è½½ä¸€ä¸ªå€¼ï¼Œå°†å…¶å¢åŠ  3ï¼Œç„¶åå°†è¯¥å€¼å­˜å‚¨å›å†…å­˜ä¸­ã€‚ void func() { int x = 3000; x = x + 3; // this is the line of code we are interested in ... ç¼–è¯‘å™¨å°†è¿™è¡Œä»£ç è½¬æ¢ä¸ºæ±‡ç¼–è¯­è¨€ï¼Œå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼ˆåœ¨ x86 æ±‡ç¼–è¯­è¨€ä¸­ï¼‰ã€‚åœ¨ Linux ä¸Šä½¿ç”¨ objdump æˆ–åœ¨ Mac ä¸Šä½¿ç”¨ otool æ¥åæ±‡ç¼–å®ƒï¼š 128: movl 0x0(%ebx), %eax ;load 0+ebx into eax 132: addl $0x03, %eax ;add 3 to eax register 135: movl %eax, 0x0(%ebx) ;store eax back to mem è¿™æ®µä»£ç ç›¸å¯¹ç®€å•ï¼›å®ƒå‡å®š x çš„åœ°å€å·²æ”¾å…¥å¯„å­˜å™¨ ebx ä¸­ï¼Œç„¶åä½¿ç”¨ movl æŒ‡ä»¤ï¼ˆç”¨äºâ€œé•¿å­—â€ç§»åŠ¨ï¼‰å°†è¯¥åœ°å€å¤„çš„å€¼åŠ è½½åˆ°é€šç”¨å¯„å­˜å™¨ eax ä¸­ã€‚ä¸‹ä¸€æ¡æŒ‡ä»¤å°† eax åŠ  3ï¼Œæœ€åä¸€æ¡æŒ‡ä»¤å°† eax ä¸­çš„å€¼å­˜å‚¨å›å†…å­˜ä¸­çš„åŒä¸€ä½ç½®ã€‚ åœ¨ä¸Šå›¾ä¸­ï¼Œè§‚å¯Ÿä»£ç å’Œæ•°æ®åœ¨è¿›ç¨‹åœ°å€ç©ºé—´ä¸­çš„å¸ƒå±€æ–¹å¼ï¼›ä¸‰æŒ‡ä»¤ä»£ç åºåˆ—ä½äºåœ°å€ 128ï¼ˆåœ¨é è¿‘é¡¶éƒ¨çš„ä»£ç æ®µä¸­ï¼‰ï¼Œå˜é‡ x çš„å€¼ä½äºåœ°å€ 15 KBï¼ˆåœ¨é è¿‘åº•éƒ¨çš„å †æ ˆä¸­ï¼‰ã€‚å›¾ä¸­ï¼Œxçš„åˆå§‹å€¼ä¸º3000ï¼Œå¦‚å…¶åœ¨å †æ ˆä¸­çš„ä½ç½®æ‰€ç¤ºã€‚å½“è¿™äº›æŒ‡ä»¤è¿è¡Œæ—¶ï¼Œä»è¿›ç¨‹çš„è§’åº¦æ¥çœ‹ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å†…å­˜è®¿é—®ã€‚ å–åœ°å€ 128 çš„æŒ‡ä»¤ æ‰§è¡Œè¯¥æŒ‡ä»¤ï¼ˆä»åœ°å€ 15 KB åŠ è½½ï¼‰ å–åœ°å€ 132 çš„æŒ‡ä»¤ - æ‰§è¡Œè¯¥æŒ‡ä»¤ï¼ˆæ— å†…å­˜å¼•ç”¨ï¼‰ å–åœ°å€ 135 çš„æŒ‡ä»¤ æ‰§è¡Œè¯¥æŒ‡ä»¤ï¼ˆå­˜å‚¨åˆ°åœ°å€ 15 KBï¼‰ ä»ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œå®ƒçš„åœ°å€ç©ºé—´ä»åœ°å€0å¼€å§‹ï¼Œæœ€å¤§å¢é•¿åˆ°16KBï¼›å®ƒç”Ÿæˆçš„æ‰€æœ‰å†…å­˜å¼•ç”¨éƒ½åº”è¯¥åœ¨è¿™äº›èŒƒå›´å†…ã€‚ç„¶è€Œï¼Œä¸ºäº†è™šæ‹ŸåŒ–å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿå¸Œæœ›å°†è¿›ç¨‹æ”¾ç½®åœ¨ç‰©ç†å†…å­˜ä¸­çš„å…¶ä»–ä½ç½®ï¼Œè€Œä¸ä¸€å®šæ˜¯åœ°å€0ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é‡åˆ°äº†é—®é¢˜ï¼šå¦‚ä½•ä»¥å¯¹è¿›ç¨‹é€æ˜çš„æ–¹å¼åœ¨å†…å­˜ä¸­é‡æ–°å®šä½è¯¥è¿›ç¨‹ï¼Ÿå½“å®é™…ä¸Šåœ°å€ç©ºé—´ä½äºå…¶ä»–ç‰©ç†åœ°å€æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•æä¾›ä» 0 å¼€å§‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´çš„å‡è±¡ï¼Ÿ ä¸‹å›¾å±•ç¤ºäº†è¿›ç¨‹çš„åœ°å€ç©ºé—´æ”¾å…¥å†…å­˜åç‰©ç†å†…å­˜å¯èƒ½æ˜¯ä»€ä¹ˆæ ·å­ã€‚åœ¨å›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ“ä½œç³»ç»Ÿä¸ºè‡ªå·±ä½¿ç”¨ç‰©ç†å†…å­˜çš„ç¬¬ä¸€ä¸ªæ’æ§½ï¼Œå¹¶ä¸”å®ƒå·²å°†ä¸Šä¾‹ä¸­çš„è¿›ç¨‹é‡æ–°å®šä½åˆ°ä»ç‰©ç†å†…å­˜åœ°å€ 32 KB å¼€å§‹çš„æ’æ§½ä¸­ã€‚å¦å¤–ä¸¤ä¸ªæ’æ§½æ˜¯ç©ºé—²çš„ï¼ˆ16 KB-32 KB å’Œ 48 KB-64 KBï¼‰ã€‚ ","date":"2024-04-25","objectID":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/:2:0","tags":["OS"],"title":"åœ°å€è½¬æ¢","uri":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 åŠ¨æ€ï¼ˆåŸºäºç¡¬ä»¶ï¼‰é‡å®šä½ ä¸ºäº†å¯¹åŸºäºç¡¬ä»¶çš„åœ°å€è½¬æ¢æœ‰ä¸€å®šçš„äº†è§£ï¼Œæˆ‘ä»¬é¦–å…ˆè®¨è®ºå®ƒçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚ 1950 å¹´ä»£æœ«çš„ç¬¬ä¸€å°åˆ†æ—¶æœºä¸­å¼•å…¥äº†ä¸€ä¸ªç®€å•çš„æ¦‚å¿µï¼Œç§°ä¸ºåŸºæ•°å’Œè¾¹ç•Œï¼›è¯¥æŠ€æœ¯ä¹Ÿç§°ä¸ºåŠ¨æ€é‡å®šä½ï¼›æˆ‘ä»¬å°†äº¤æ›¿ä½¿ç”¨è¿™ä¸¤ä¸ªæœ¯è¯­ã€‚ å…·ä½“æ¥è¯´ï¼Œæ¯ä¸ª CPU ä¸­æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªç¡¬ä»¶å¯„å­˜å™¨ï¼šä¸€ä¸ªç§°ä¸ºåŸºå€å¯„å­˜å™¨ï¼Œå¦ä¸€ä¸ªç§°ä¸ºè¾¹ç•Œå¯„å­˜å™¨ï¼ˆæœ‰æ—¶ç§°ä¸ºé™åˆ¶å¯„å­˜å™¨ï¼‰ã€‚è¿™ä¸ªåŸºå€å’Œè¾¹ç•Œå¯¹å°†å…è®¸æˆ‘ä»¬å°†åœ°å€ç©ºé—´æ”¾ç½®åœ¨ç‰©ç†å†…å­˜ä¸­çš„ä»»ä½•ä½ç½®ï¼Œå¹¶åŒæ—¶ç¡®ä¿è¿›ç¨‹åªèƒ½è®¿é—®è‡ªå·±çš„åœ°å€ç©ºé—´ã€‚ åœ¨æ­¤è®¾ç½®ä¸­ï¼Œæ¯ä¸ªç¨‹åºéƒ½è¢«ç¼–å†™å’Œç¼–è¯‘ï¼Œå°±å¥½åƒå®ƒè¢«åŠ è½½åˆ°åœ°å€é›¶ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå½“ç¨‹åºå¼€å§‹è¿è¡Œæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå†³å®šåº”å°†å…¶åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¸­çš„ä½•å¤„ï¼Œå¹¶å°†åŸºå€å¯„å­˜å™¨è®¾ç½®ä¸ºè¯¥å€¼ã€‚ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæ“ä½œç³»ç»Ÿå†³å®šåœ¨ç‰©ç†åœ°å€ 32 KB å¤„åŠ è½½è¿›ç¨‹ï¼Œä»è€Œå°†åŸºå€å¯„å­˜å™¨è®¾ç½®ä¸ºè¯¥å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å½“è¿›ç¨‹è¿è¡Œæ—¶ï¼Œæœ‰è¶£çš„äº‹æƒ…å¼€å§‹å‘ç”Ÿã€‚ç°åœ¨ï¼Œå½“è¿›ç¨‹ç”Ÿæˆä»»ä½•å†…å­˜å¼•ç”¨æ—¶ï¼Œå¤„ç†å™¨ä¼šæŒ‰ä»¥ä¸‹æ–¹å¼å¯¹å…¶è¿›è¡Œè½¬æ¢ï¼š physical address = virtual address + base è¿›ç¨‹ç”Ÿæˆçš„æ¯ä¸ªå†…å­˜å¼•ç”¨éƒ½æ˜¯ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼›ç¡¬ä»¶ä¾æ¬¡å°†åŸºå€å¯„å­˜å™¨çš„å†…å®¹æ·»åŠ åˆ°è¯¥åœ°å€ï¼Œç»“æœæ˜¯å†…å­˜ç³»ç»Ÿçš„ç‰©ç†åœ°å€ã€‚ ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬è¿½è¸ªä¸€ä¸‹æ‰§è¡Œå•ä¸ªæŒ‡ä»¤æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å…·ä½“æ¥è¯´ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å‰é¢åºåˆ—ä¸­çš„ä¸€æ¡æŒ‡ä»¤ï¼š asm 128: movl 0x0(%ebx), %eax ç¨‹åºè®¡æ•°å™¨ (PC) è®¾ç½®ä¸º 128ï¼›å½“ç¡¬ä»¶éœ€è¦å–è¯¥æŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆå°†è¯¥å€¼ä¸åŸºå€å¯„å­˜å™¨å€¼32 KBï¼ˆ32768ï¼‰ç›¸åŠ ï¼Œå¾—åˆ°ç‰©ç†åœ°å€32896ï¼›ç„¶åç¡¬ä»¶ä»è¯¥ç‰©ç†åœ°å€è·å–æŒ‡ä»¤ã€‚ æ¥ä¸‹æ¥ï¼Œå¤„ç†å™¨å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤ã€‚åœ¨æŸä¸ªæ—¶åˆ»ï¼Œè¿›ç¨‹ä¼šä»è™šæ‹Ÿåœ°å€ 15 KB å‘å‡ºåŠ è½½ï¼Œå¤„ç†å™¨å°†å…¶è·å–å¹¶å†æ¬¡æ·»åŠ åˆ°åŸºå€å¯„å­˜å™¨ (32 KB)ï¼Œä»è€Œè·å¾— 47 KB çš„æœ€ç»ˆç‰©ç†åœ°å€ï¼Œä»è€Œè·å¾—æ‰€éœ€çš„å†…å®¹ã€‚ å°†è™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€æ­£æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åœ°å€è½¬æ¢æŠ€æœ¯ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œç¡¬ä»¶è·å–è¿›ç¨‹è®¤ä¸ºå®ƒæ­£åœ¨å¼•ç”¨çš„è™šæ‹Ÿåœ°å€ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæ•°æ®å®é™…é©»ç•™çš„ç‰©ç†åœ°å€ã€‚å› ä¸ºè¿™ç§åœ°å€é‡å®šä½å‘ç”Ÿåœ¨è¿è¡Œæ—¶ï¼Œå¹¶ä¸”å³ä½¿åœ¨è¿›ç¨‹å¼€å§‹è¿è¡Œåæˆ‘ä»¬ä¹Ÿå¯ä»¥ç§»åŠ¨åœ°å€ç©ºé—´ï¼Œæ‰€ä»¥è¯¥æŠ€æœ¯é€šå¸¸ç§°ä¸ºåŠ¨æ€é‡å®šä½ã€‚ ç°åœ¨æ‚¨å¯èƒ½ä¼šé—®ï¼šè¾¹ç•Œï¼ˆé™åˆ¶ï¼‰å¯„å­˜å™¨å‘ç”Ÿäº†ä»€ä¹ˆï¼Œèµ·åˆ°äº†ä»€ä¹ˆä½œç”¨ï¼Ÿæ¯•ç«Ÿï¼Œè¿™ä¸æ˜¯åŸºæ•°å’Œè¾¹ç•Œæ–¹æ³•å—ï¼Ÿå®ƒçš„ç¡®æ˜¯ã€‚æ­£å¦‚æ‚¨å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œè¾¹ç•Œå¯„å­˜å™¨æ˜¯ä¸ºäº†å¸®åŠ©ä¿æŠ¤ã€‚å…·ä½“æ¥è¯´ï¼Œå¤„ç†å™¨ä¼šé¦–å…ˆæ£€æŸ¥å†…å­˜å¼•ç”¨æ˜¯å¦åœ¨èŒƒå›´å†…ï¼Œä»¥ç¡®ä¿å®ƒæ˜¯åˆæ³•çš„ï¼›åœ¨ä¸Šé¢çš„ç®€å•ç¤ºä¾‹ä¸­ï¼Œè¾¹ç•Œå¯„å­˜å™¨å°†å§‹ç»ˆè®¾ç½®ä¸º 16 KBã€‚å¦‚æœè¿›ç¨‹ç”Ÿæˆçš„è™šæ‹Ÿåœ°å€å¤§äºè¾¹ç•Œï¼Œæˆ–è€…ä¸ºè´Ÿæ•°ï¼ŒCPU å°†å¼•å‘å¼‚å¸¸ï¼Œå¹¶ä¸”è¯¥è¿›ç¨‹å¯èƒ½ä¼šè¢«ç»ˆæ­¢ã€‚å› æ­¤ï¼Œè¾¹ç•Œçš„ç›®çš„æ˜¯ç¡®ä¿è¿›ç¨‹ç”Ÿæˆçš„æ‰€æœ‰åœ°å€éƒ½æ˜¯åˆæ³•çš„å¹¶ä¸”åœ¨è¿›ç¨‹çš„â€œè¾¹ç•Œâ€å†…ã€‚ æˆ‘ä»¬åº”è¯¥æ³¨æ„ï¼ŒåŸºå€å¯„å­˜å™¨å’Œè¾¹ç•Œå¯„å­˜å™¨æ˜¯ä¿å­˜åœ¨èŠ¯ç‰‡ä¸Šçš„ç¡¬ä»¶ç»“æ„ï¼ˆæ¯ä¸ª CPU ä¸€å¯¹ï¼‰ã€‚æœ‰æ—¶äººä»¬å°†å¤„ç†å™¨ä¸­å¸®åŠ©è¿›è¡Œåœ°å€è½¬æ¢çš„éƒ¨åˆ†ç§°ä¸ºå†…å­˜ç®¡ç†å•å…ƒï¼ˆMMUï¼‰ï¼›éšç€æˆ‘ä»¬å¼€å‘æ›´å¤æ‚çš„å†…å­˜ç®¡ç†æŠ€æœ¯ï¼Œæˆ‘ä»¬å°†ä¸º MMU æ·»åŠ æ›´å¤šç”µè·¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä¸ºäº†æ›´è¯¦ç»†åœ°ç†è§£é€šè¿‡åŸºå€å’Œè¾¹ç•Œè¿›è¡Œçš„åœ°å€è½¬æ¢ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªåœ°å€ç©ºé—´å¤§å°ä¸º 4 KBçš„è¿›ç¨‹è¢«åŠ è½½åˆ°ç‰©ç†åœ°å€ 16 KBã€‚ä¸‹é¢æ˜¯ä¸€äº›åœ°å€è½¬æ¢çš„ç»“æœï¼š Virtual Address Physical Address 0 16 KB 1 KB 17 KB 3000 19384 4400 Fault (Out of Bounds) ä»ç¤ºä¾‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œåªéœ€å°†åŸºåœ°å€ä¸è™šæ‹Ÿåœ°å€ç›¸åŠ ï¼ˆå¯ä»¥æ­£ç¡®åœ°å°†å…¶è§†ä¸ºåœ°å€ç©ºé—´çš„åç§»é‡ï¼‰ï¼Œå°±å¯ä»¥è½»æ¾å¾—åˆ°ç‰©ç†åœ°å€ã€‚åªæœ‰å½“è™šæ‹Ÿåœ°å€ â€œè¿‡å¤§ â€œæˆ–ä¸ºè´Ÿæ•°æ—¶ï¼Œç»“æœæ‰ä¼šæ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œä»è€Œå¼•å‘å¼‚å¸¸ã€‚ ","date":"2024-04-25","objectID":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/:3:0","tags":["OS"],"title":"åœ°å€è½¬æ¢","uri":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å†…å­˜è™šæ‹ŸåŒ–çš„æ“ä½œç³»ç»Ÿé—®é¢˜ æ­£å¦‚ç¡¬ä»¶æä¾›äº†æ”¯æŒåŠ¨æ€é‡å®šä½çš„æ–°åŠŸèƒ½ä¸€æ ·ï¼Œæ“ä½œç³»ç»Ÿç°åœ¨ä¹Ÿæœ‰å¿…é¡»å¤„ç†çš„æ–°é—®é¢˜ï¼›ç¡¬ä»¶æ”¯æŒå’Œæ“ä½œç³»ç»Ÿç®¡ç†çš„ç»“åˆå¯¼è‡´äº†ç®€å•è™šæ‹Ÿå†…å­˜çš„å®ç°ã€‚å…·ä½“æ¥è¯´ï¼Œæœ‰å‡ ä¸ªå…³é”®æ—¶åˆ»ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»å‚ä¸å…¶ä¸­ï¼Œä»¥å®ç°æˆ‘ä»¬çš„è™šæ‹Ÿå†…å­˜çš„åŸºå€å’Œè¾¹ç•Œç‰ˆæœ¬ã€‚ é¦–å…ˆï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»åœ¨åˆ›å»ºè¿›ç¨‹æ—¶é‡‡å–è¡ŒåŠ¨ï¼Œä¸ºå…¶åœ¨å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ‰¾åˆ°ç©ºé—´ã€‚å¹¸è¿çš„æ˜¯ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬å‡è®¾æ¯ä¸ªåœ°å€ç©ºé—´ï¼ˆaï¼‰å°äºç‰©ç†å†…å­˜çš„å¤§å°ä»¥åŠï¼ˆbï¼‰ç›¸åŒçš„å¤§å°ï¼Œè¿™å¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´éå¸¸å®¹æ˜“ï¼›å®ƒå¯ä»¥ç®€å•åœ°å°†ç‰©ç†å†…å­˜è§†ä¸ºä¸€ç»„æ’æ§½ï¼Œå¹¶è·Ÿè¸ªæ¯ä¸ªæ’æ§½æ˜¯å¦ç©ºé—²æˆ–æ­£åœ¨ä½¿ç”¨ã€‚åˆ›å»ºæ–°è¿›ç¨‹æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»æœç´¢æ•°æ®ç»“æ„ï¼ˆé€šå¸¸ç§°ä¸ºç©ºé—²åˆ—è¡¨ï¼‰æ¥ä¸ºæ–°åœ°å€ç©ºé—´æ‰¾åˆ°ç©ºé—´ï¼Œç„¶åå°†å…¶æ ‡è®°ä¸ºå·²ä½¿ç”¨ã€‚å¯¹äºå¯å˜å¤§å°çš„åœ°å€ç©ºé—´ï¼Œæƒ…å†µä¼šæ›´åŠ å¤æ‚ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ“ä½œç³»ç»Ÿä¸ºè‡ªå·±ä½¿ç”¨ç‰©ç†å†…å­˜çš„ç¬¬ä¸€ä¸ªæ’æ§½ï¼Œå¹¶ä¸”å®ƒå·²å°†ä¸Šé¢ç¤ºä¾‹ä¸­çš„è¿›ç¨‹é‡æ–°å®šä½åˆ°ä»ç‰©ç†å†…å­˜åœ°å€ 32 KB å¼€å§‹çš„æ’æ§½ä¸­ã€‚å¦å¤–ä¸¤ä¸ªæ’æ§½æ˜¯ç©ºé—²çš„ï¼ˆ16 KB-32 KB å’Œ 48 KB-64 KBï¼‰ï¼›å› æ­¤ï¼Œç©ºé—²åˆ—è¡¨åº”è¯¥ç”±è¿™ä¸¤ä¸ªæ¡ç›®ç»„æˆã€‚ ç¬¬äºŒï¼Œå½“è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼ˆå³ï¼Œå½“å®ƒæ­£å¸¸é€€å‡ºæˆ–ç”±äºè¡Œä¸ºä¸å½“è€Œè¢«å¼ºåˆ¶ç»ˆæ­¢æ—¶ï¼‰ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»åšä¸€äº›å·¥ä½œï¼Œå›æ”¶å…¶æ‰€æœ‰å†…å­˜ä»¥ä¾›å…¶ä»–è¿›ç¨‹æˆ–æ“ä½œç³»ç»Ÿä½¿ç”¨ã€‚è¿›ç¨‹ç»ˆæ­¢åï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å…¶å†…å­˜æ”¾å›åˆ°ç©ºé—²åˆ—è¡¨ä¸­ï¼Œå¹¶æ ¹æ®éœ€è¦æ¸…ç†ä»»ä½•å…³è”çš„æ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ç¬¬ä¸‰ï¼Œå½“å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œæ“ä½œç³»ç»Ÿè¿˜å¿…é¡»æ‰§è¡Œä¸€äº›é¢å¤–çš„æ­¥éª¤ã€‚æ¯•ç«Ÿï¼Œæ¯ä¸ª CPU ä¸Šåªæœ‰ä¸€å¯¹åŸºå€å’Œè¾¹ç•Œå¯„å­˜å™¨ï¼Œå¹¶ä¸”æ¯ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å€¼éƒ½ä¸åŒï¼Œå› ä¸ºæ¯ä¸ªç¨‹åºéƒ½åŠ è½½åˆ°å†…å­˜ä¸­ä¸åŒçš„ç‰©ç†åœ°å€ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿåœ¨è¿›ç¨‹ä¹‹é—´åˆ‡æ¢æ—¶å¿…é¡»ä¿å­˜å’Œæ¢å¤åŸºå€å’Œè¾¹ç•Œå¯¹ã€‚ å…·ä½“æ¥è¯´ï¼Œå½“æ“ä½œç³»ç»Ÿå†³å®šåœæ­¢è¿è¡ŒæŸä¸ªè¿›ç¨‹æ—¶ï¼Œå®ƒå¿…é¡»å°†åŸºå€å¯„å­˜å™¨å’Œè¾¹ç•Œå¯„å­˜å™¨çš„å€¼ä¿å­˜åˆ°å†…å­˜ä¸­çš„æŸäº›æ¯ä¸ªè¿›ç¨‹çš„ç»“æ„ä¸­ï¼Œä¾‹å¦‚è¿›ç¨‹ç»“æ„æˆ–è¿›ç¨‹æ§åˆ¶å— (PCB)ã€‚åŒæ ·ï¼Œå½“æ“ä½œç³»ç»Ÿæ¢å¤æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼ˆæˆ–ç¬¬ä¸€æ¬¡è¿è¡Œå®ƒï¼‰æ—¶ï¼Œå®ƒå¿…é¡»å°† CPU ä¸Šçš„åŸºæ•°å’Œè¾¹ç•Œå€¼è®¾ç½®ä¸ºè¯¥è¿›ç¨‹çš„æ­£ç¡®å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æˆ‘ä»¬åº”è¯¥æ³¨æ„åˆ°ï¼Œå½“è¿›ç¨‹åœæ­¢ï¼ˆå³ä¸è¿è¡Œï¼‰æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°å°†åœ°å€ç©ºé—´ä»å†…å­˜ä¸­çš„ä¸€ä¸ªä½ç½®ç§»åŠ¨åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚è¦ç§»åŠ¨è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œæ“ä½œç³»ç»Ÿé¦–å…ˆä¼šå¯¹è¿›ç¨‹å–æ¶ˆè°ƒåº¦ï¼›ç„¶åï¼Œæ“ä½œç³»ç»Ÿä¼šå°†åœ°å€ç©ºé—´ä»å½“å‰ä½ç½®å¤åˆ¶åˆ°æ–°ä½ç½®ï¼›æœ€åï¼Œæ“ä½œç³»ç»Ÿä¼šæ›´æ–°ï¼ˆè¿›ç¨‹ç»“æ„ä¸­çš„ï¼‰ä¿å­˜åŸºå€å¯„å­˜å™¨ï¼Œä½¿å…¶æŒ‡å‘æ–°ä½ç½®ã€‚å½“è¿›ç¨‹æ¢å¤æ—¶ï¼Œå®ƒçš„ï¼ˆæ–°ï¼‰åŸºå€å¯„å­˜å™¨ä¼šè¢«æ¢å¤ï¼Œç„¶åå®ƒåˆå¼€å§‹è¿è¡Œï¼Œå…¨ç„¶ä¸é¡¾å®ƒçš„æŒ‡ä»¤å’Œæ•°æ®ç°åœ¨åœ¨å†…å­˜ä¸­ä¸€ä¸ªå…¨æ–°çš„ä½ç½®ã€‚ ç¬¬å››ï¼Œå¦‚ä¸Šæ‰€è¿°ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»æä¾›å¼‚å¸¸å¤„ç†ç¨‹åºæˆ–è°ƒç”¨å‡½æ•°ï¼›æ“ä½œç³»ç»Ÿåœ¨å¯åŠ¨æ—¶ï¼ˆé€šè¿‡ç‰¹æƒæŒ‡ä»¤ï¼‰å®‰è£…è¿™äº›å¤„ç†ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹è¯•å›¾è®¿é—®è¶…å‡ºå…¶è¾¹ç•Œçš„å†…å­˜ï¼ŒCPU å°±ä¼šå¼•å‘å¼‚å¸¸ï¼›æ“ä½œç³»ç»Ÿå¿…é¡»åšå¥½å‡†å¤‡ï¼Œåœ¨å‡ºç°è¿™ç§å¼‚å¸¸æ—¶é‡‡å–è¡ŒåŠ¨ã€‚æ“ä½œç³»ç»Ÿçš„é€šå¸¸ååº”æ˜¯æ•Œæ„ï¼šå®ƒå¯èƒ½ä¼šç»ˆæ­¢è¿è§„è¿›ç¨‹ã€‚æ“ä½œç³»ç»Ÿåº”é«˜åº¦ä¿æŠ¤å®ƒæ‰€è¿è¡Œçš„æœºå™¨ï¼Œå› æ­¤å®ƒä¸ä¼šå–„å¾…è¯•å›¾è®¿é—®å†…å­˜æˆ–æ‰§è¡Œä¸è¯¥æ‰§è¡ŒæŒ‡ä»¤çš„è¿›ç¨‹ã€‚ ä¸‹è¡¨ä»¥æ—¶é—´è½´çš„å½¢å¼å±•ç¤ºäº†ç¡¬ä»¶ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„äº¤äº’ã€‚è¡¨ä¸­æ˜¾ç¤ºäº†æ“ä½œç³»ç»Ÿåœ¨å¯åŠ¨æ—¶ä¸ºå‡†å¤‡ä½¿ç”¨æœºå™¨æ‰€åšçš„å·¥ä½œï¼Œä»¥åŠè¿›ç¨‹ï¼ˆè¿›ç¨‹ Aï¼‰å¼€å§‹è¿è¡Œæ—¶å‘ç”Ÿçš„æƒ…å†µï¼›è¯·æ³¨æ„å…¶å†…å­˜è½¬æ¢æ˜¯å¦‚ä½•åœ¨æ²¡æœ‰æ“ä½œç³»ç»Ÿå¹²é¢„çš„æƒ…å†µä¸‹ç”±ç¡¬ä»¶å¤„ç†çš„ã€‚æ­¤æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»ä»‹å…¥ï¼Œç»ˆæ­¢è¿›ç¨‹å¹¶æ¸…ç† B çš„å†…å­˜ï¼Œå°†å…¶ä»è¿›ç¨‹è¡¨ä¸­åˆ é™¤ã€‚ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ä»ç„¶éµå¾ªæœ‰é™ç›´æ¥æ‰§è¡Œçš„åŸºæœ¬æ–¹æ³•ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿåªéœ€é€‚å½“è®¾ç½®ç¡¬ä»¶ï¼Œè®©è¿›ç¨‹ç›´æ¥åœ¨ CPU ä¸Šè¿è¡Œï¼›åªæœ‰å½“è¿›ç¨‹å‡ºç°å¼‚å¸¸æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¼šä»‹å…¥ã€‚ OS @ boot (kernel mode) Hardware Program (user mode) åˆå§‹åŒ–ä¸­æ–­è¡¨ è®°ä½ç³»ç»Ÿè°ƒç”¨å¤„ç†ç¨‹åºã€å®šæ—¶å™¨å¤„ç†ç¨‹åº ã€éæ³•å†…å­˜è®¿é—®å¤„ç†ç¨‹åºã€éæ³•æŒ‡ä»¤å¤„ç†ç¨‹åºâ€¦â€¦çš„åœ°å€ - å¯åŠ¨ä¸­æ–­å®šæ—¶å™¨ å¯åŠ¨è®¡æ—¶å™¨ï¼›X æ¯«ç§’åä¸­æ–­ - åˆå§‹åŒ–è¿›ç¨‹è¡¨ï¼›åˆå§‹åŒ–ç©ºé—²åˆ—è¡¨ - - OS @ run (kernel mode) Hardware Program (user mode) å¯åŠ¨è¿›ç¨‹ Aï¼š åˆ†é…è¿›ç¨‹è¡¨ä¸­çš„æ¡ç›®ï¼›ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜ï¼›è®¾ç½®åŸºå‡†/è¾¹ç•Œå¯„å­˜å™¨ ï¼›ä»ä¸­æ–­è¿”å›ï¼ˆè¿›å…¥ Aï¼‰ - - æ¢å¤ A çš„å¯„å­˜å™¨ï¼›ç§»åŠ¨åˆ°ç”¨æˆ·æ¨¡å¼ï¼›è·³è½¬åˆ° A çš„ï¼ˆåˆå§‹ï¼‰PC è¿›ç¨‹ A è¿è¡Œï¼›å–æŒ‡ä»¤ è½¬æ¢è™šæ‹Ÿåœ°å€å¹¶æ‰§è¡Œæå– æ‰§è¡ŒæŒ‡ä»¤ å¦‚æœæ˜¯æ˜¾å¼åŠ è½½/å­˜å‚¨ï¼šç¡®ä¿åœ°å€åœ¨è¾¹ç•Œå†…ï¼›è½¬æ¢è™šæ‹Ÿåœ°å€å¹¶æ‰§è¡ŒåŠ è½½/å­˜å‚¨ å®šæ—¶å™¨ä¸­æ–­è½¬å…¥å†…æ ¸æ¨¡å¼ï¼›è·³è½¬åˆ°ä¸­æ–­å¤„ç†ç¨‹åº å¤„ç†ä¸­æ–­ï¼› è°ƒç”¨ switch() ä¾‹ç¨‹ ï¼›å°† regs(A) ä¿å­˜åˆ° proc-struct(A)ï¼ˆåŒ…æ‹¬åŸºå€/è¾¹ç•Œï¼‰ ï¼›ä» proc-struct(B)ï¼ˆåŒ…æ‹¬åŸºå€/è¾¹ç•Œï¼‰æ¢å¤ regs(B) ï¼›ä»ä¸­æ–­è¿”å› (è¿›å…¥Bï¼‰ æ¢å¤Bçš„å¯„å­˜å™¨ï¼›è½¬ç§»åˆ°ç”¨æˆ·æ¨¡å¼ï¼› è·³è½¬åˆ°Bçš„PC è¿›ç¨‹Bè¿è¡Œï¼›æ‰§è¡Œé”™è¯¯åŠ è½½ åŠ è½½è¶Šç•Œï¼›è½¬å…¥å†…æ ¸æ¨¡å¼ï¼Œè·³è½¬åˆ°ä¸­æ–­å¤„ç†ç¨‹åº å¤„ç†ä¸­æ–­ï¼›å†³å®šç»ˆæ­¢è¿›ç¨‹ Bï¼›é‡Šæ”¾ B çš„å†…å­˜ï¼›é‡Šæ”¾ B åœ¨è¿›ç¨‹è¡¨ä¸­çš„æ¡ç›® ","date":"2024-04-25","objectID":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/:4:0","tags":["OS"],"title":"åœ°å€è½¬æ¢","uri":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 æ€»ç»“ åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ç”¨è™šæ‹Ÿå†…å­˜ä¸­ä½¿ç”¨çš„ä¸€ç§ç‰¹å®šæœºåˆ¶ï¼ˆå³åœ°å€è½¬æ¢ï¼‰æ‰©å±•äº†æœ‰é™ç›´æ¥æ‰§è¡Œçš„æ¦‚å¿µã€‚é€šè¿‡åœ°å€è½¬æ¢ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥æ§åˆ¶è¿›ç¨‹çš„æ¯æ¬¡å†…å­˜è®¿é—®ï¼Œç¡®ä¿è®¿é—®ä¸è¶…å‡ºåœ°å€ç©ºé—´çš„èŒƒå›´ã€‚ç¡¬ä»¶æ”¯æŒæ˜¯è¿™é¡¹æŠ€æœ¯é«˜æ•ˆçš„å…³é”®ï¼Œå®ƒèƒ½ä¸ºæ¯æ¬¡è®¿é—®å¿«é€Ÿæ‰§è¡Œè½¬æ¢ï¼Œå°†è™šæ‹Ÿåœ°å€ï¼ˆè¿›ç¨‹å¯¹å†…å­˜çš„çœ‹æ³•ï¼‰è½¬æ¢ä¸ºç‰©ç†åœ°å€ï¼ˆå®é™…çœ‹æ³•ï¼‰ã€‚æ‰€æœ‰è¿™äº›éƒ½æ˜¯ä»¥å¯¹è¢«é‡å®šä½çš„è¿›ç¨‹é€æ˜çš„æ–¹å¼è¿›è¡Œçš„ï¼Œè¿›ç¨‹æ ¹æœ¬ä¸çŸ¥é“å…¶å†…å­˜å¼•ç”¨æ­£åœ¨è¢«è½¬æ¢ï¼Œè¿™å°±é€ æˆäº†ä¸€ç§å¥‡å¦™çš„é”™è§‰ã€‚ æˆ‘ä»¬è¿˜çœ‹åˆ°äº†ä¸€ç§ç‰¹æ®Šå½¢å¼çš„è™šæ‹ŸåŒ–ï¼Œå³åŸºå€è¾¹ç•Œè™šæ‹ŸåŒ–æˆ–åŠ¨æ€é‡å®šä½ã€‚åŸºå€è¾¹ç•Œè™šæ‹ŸåŒ–ç›¸å½“é«˜æ•ˆï¼Œå› ä¸ºåªéœ€è¦å¤šä¸€ç‚¹ç¡¬ä»¶é€»è¾‘ï¼Œå°±èƒ½åœ¨è™šæ‹Ÿåœ°å€ä¸­æ·»åŠ ä¸€ä¸ªåŸºå€å¯„å­˜å™¨ï¼Œå¹¶æ£€æŸ¥è¿›ç¨‹ç”Ÿæˆçš„åœ°å€æ˜¯å¦åœ¨è¾¹ç•Œå†…ã€‚åŸºå€è¾¹ç•Œè™šæ‹ŸåŒ–è¿˜èƒ½æä¾›ä¿æŠ¤ï¼›æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ç›¸ç»“åˆï¼Œç¡®ä¿ä»»ä½•è¿›ç¨‹éƒ½æ— æ³•åœ¨è‡ªèº«åœ°å€ç©ºé—´ä¹‹å¤–ç”Ÿæˆå†…å­˜å¼•ç”¨ã€‚ä¿æŠ¤æ— ç–‘æ˜¯æ“ä½œç³»ç»Ÿæœ€é‡è¦çš„ç›®æ ‡ä¹‹ä¸€ï¼›å¦‚æœæ²¡æœ‰ä¿æŠ¤ï¼Œæ“ä½œç³»ç»Ÿå°±æ— æ³•æ§åˆ¶æœºå™¨ï¼ˆå¦‚æœè¿›ç¨‹å¯ä»¥éšæ„è¦†ç›–å†…å­˜ï¼Œå®ƒä»¬å°±èƒ½è½»æ˜“åšå‡ºä¸€äº›ä»¤äººè®¨åŒçš„äº‹æƒ…ï¼Œæ¯”å¦‚è¦†ç›–ä¸­æ–­è¡¨å¹¶æ¥ç®¡ç³»ç»Ÿï¼‰ã€‚ ä¸è¿‡ï¼Œè¿™ç§ç®€å•çš„åŠ¨æ€é‡å®šä½æŠ€æœ¯ç¡®å®å­˜åœ¨æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé‡å®šä½åçš„è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ä» 32 KB å¢åŠ åˆ° 48 KBï¼Œä½†ç”±äºè¿›ç¨‹å †æ ˆå’Œå †å¹¶ä¸å¤ªå¤§ï¼Œä¸¤è€…ä¹‹é—´çš„æ‰€æœ‰ç©ºé—´éƒ½è¢«æµªè´¹æ‰äº†ã€‚è¿™ç§æµªè´¹é€šå¸¸è¢«ç§°ä¸ºå†…éƒ¨ç¢ç‰‡ï¼Œå› ä¸ºåˆ†é…å•å…ƒå†…éƒ¨çš„ç©ºé—´æ²¡æœ‰è¢«å…¨éƒ¨ä½¿ç”¨ï¼ˆå³è¢«ç¢ç‰‡åŒ–ï¼‰ï¼Œä»è€Œé€ æˆæµªè´¹ã€‚åœ¨æˆ‘ä»¬ç›®å‰çš„æ–¹æ³•ä¸­ï¼Œè™½ç„¶å¯èƒ½æœ‰è¶³å¤Ÿçš„ç‰©ç†å†…å­˜æ¥å®¹çº³æ›´å¤šè¿›ç¨‹ï¼Œä½†æˆ‘ä»¬ç›®å‰åªèƒ½å°†åœ°å€ç©ºé—´æ”¾ç½®åœ¨å›ºå®šå¤§å°çš„æ’æ§½ä¸­ï¼Œå› æ­¤å¯èƒ½ä¼šå‡ºç°å†…éƒ¨ç¢ç‰‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¤æ‚çš„æœºåˆ¶æ¥æ›´å¥½åœ°åˆ©ç”¨ç‰©ç†å†…å­˜ï¼Œé¿å…å†…éƒ¨ç¢ç‰‡ã€‚ ","date":"2024-04-25","objectID":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/:5:0","tags":["OS"],"title":"åœ°å€è½¬æ¢","uri":"/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"githubåœ°å€ é¦–å…ˆï¼Œç¼–å†™ä¸€ä¸ªåä¸º null.c çš„ç®€å•ç¨‹åºï¼Œè¯¥ç¨‹åºåˆ›å»ºä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼Œå°†å…¶è®¾ç½®ä¸º NULLï¼Œç„¶åå°è¯•å–æ¶ˆå¼•ç”¨å®ƒã€‚å°†å…¶ç¼–è¯‘ä¸ºåä¸º null çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å½“ä½ è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ #include \u003cstdio.h\u003e int main() { int *p = NULL; printf(\"Value of p: %d\\n\", *p); return 0; } â¯ gcc null.c -o null â¯ ./null [1] 67350 segmentation fault ./null æ¥ä¸‹æ¥ï¼Œåœ¨ç¼–è¯‘ç¨‹åºæ—¶åŠ å…¥ç¬¦å·ä¿¡æ¯ï¼ˆä½¿ç”¨ -g æ ‡å¿—ï¼‰ã€‚è¿™æ ·åšå¯ä»¥åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŠ å…¥æ›´å¤šä¿¡æ¯ï¼Œä½¿è°ƒè¯•å™¨å¯ä»¥è®¿é—®æ›´å¤šæœ‰ç”¨çš„å˜é‡åç­‰ä¿¡æ¯ã€‚åœ¨è°ƒè¯•å™¨ä¸‹è¿è¡Œç¨‹åºï¼Œé”®å…¥ gdb nullï¼Œç„¶ååœ¨ gdb è¿è¡Œåé”®å…¥ runã€‚gdb ä¼šæ˜¾ç¤ºä»€ä¹ˆï¼Ÿ \u003e gcc null.c -g -o null \u003e gdb null GNU gdb (Ubuntu 12.1-0ubuntu1~22.04) 12.1 Copyright (C) 2022 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later \u003chttp://gnu.org/licenses/gpl.html\u003e This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Type \"show copying\" and \"show warranty\" for details. This GDB was configured as \"x86_64-linux-gnu\". Type \"show configuration\" for configuration details. For bug reporting instructions, please see: \u003chttps://www.gnu.org/software/gdb/bugs/\u003e. Find the GDB manual and other documentation resources online at: \u003chttp://www.gnu.org/software/gdb/documentation/\u003e. For help, type \"help\". Type \"apropos word\" to search for commands related to \"word\"... Reading symbols from null... (gdb) run Starting program: /home/zfhe/null [Thread debugging using libthread_db enabled] Using host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\". Program received signal SIGSEGV, Segmentation fault. 0x0000555555555161 in main () at null.c:5 5 printf(\"Value of p: %d\\n\", *p); æœ€åï¼Œåœ¨è¿™ä¸ªç¨‹åºä¸Šä½¿ç”¨ valgrind å·¥å…·ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ valgrind ä¸­çš„ memcheck å·¥å…·æ¥åˆ†æå‘ç”Ÿçš„æƒ…å†µã€‚è¿è¡Œæ—¶è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼švalgrind --leak-check=yes ./nullã€‚è¿è¡Œæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ èƒ½è§£é‡Šè¯¥å·¥å…·çš„è¾“å‡ºå—ï¼Ÿ \u003e valgrind --leak-check=yes ./null ==1316115== Memcheck, a memory error detector ==1316115== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al. ==1316115== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info ==1316115== Command: ./null ==1316115== ==1316115== Invalid read of size 4 ==1316115== at 0x109161: main (null.c:5) ==1316115== Address 0x0 is not stack'd, malloc'd or (recently) free'd ==1316115== ==1316115== ==1316115== Process terminating with default action of signal 11 (SIGSEGV) ==1316115== Access not within mapped region at address 0x0 ==1316115== at 0x109161: main (null.c:5) ==1316115== If you believe this happened as a result of a stack ==1316115== overflow in your program's main thread (unlikely but ==1316115== possible), you can try to increase the size of the ==1316115== main thread stack using the --main-stacksize= flag. ==1316115== The main thread stack size used in this run was 8388608. ==1316115== ==1316115== HEAP SUMMARY: ==1316115== in use at exit: 0 bytes in 0 blocks ==1316115== total heap usage: 0 allocs, 0 frees, 0 bytes allocated ==1316115== ==1316115== All heap blocks were freed -- no leaks are possible ==1316115== ==1316115== For lists of detected and suppressed errors, rerun with: -s ==1316115== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0) [1] 1316115 segmentation fault (core dumped) valgrind --leak-check=yes ./null è¾“å‡ºçš„è§£é‡Šï¼š Invalid read of size 4ï¼šç¨‹åºå°è¯•è¯»å–ä¸€ä¸ªæ— æ•ˆçš„å†…å­˜åœ°å€ï¼Œè¯¥åœ°å€çš„å¤§å°ä¸º 4 å­—èŠ‚ã€‚è¿™è¡¨æ˜åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä¸€æ¬¡æ— æ•ˆçš„å†…å­˜è¯»å–æ“ä½œã€‚ Address 0x0 is not stack'd, malloc'd or (recently) free'dï¼šValgrind æŠ¥å‘Šäº†è¯•å›¾è®¿é—®çš„å†…å­˜åœ°å€æ˜¯ 0x0ï¼Œå³ç©ºæŒ‡é’ˆã€‚ç¨‹åºå°è¯•è¯»å–äº†ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œè¿™æ˜¯éæ³•æ“ä½œï¼Œå› ä¸ºç©ºæŒ‡é’ˆé€šå¸¸ä¸æŒ‡å‘ä»»ä½•æœ‰æ•ˆçš„å†…å­˜ä½ç½®ã€‚ Process terminating with default action of signal 11 (SIGSEGV)ï¼šç”±äºç¨‹åºå°è¯•è®¿é—®æ— æ•ˆçš„å†…å­˜åœ°å€å¯¼è‡´äº†æ®µé”™è¯¯ï¼Œç¨‹åºè¢«ç»ˆæ­¢ï¼Œå¹¶ä¸”é»˜è®¤è¡Œä¸ºæ˜¯å‘é€ä¿¡å· 11 (SIGSEGV)ã€‚ Access not within mapped region at address 0x0ï¼šValgrind æŠ¥å‘Šäº†è®¿é—®çš„å†…å­˜åœ°å€ä¸åœ¨æ˜ å°„åŒºåŸŸå†…ï¼Œå³ç¨‹åºè¯•å›¾è®¿é—®æœªåˆ†é…æˆ–æœªåˆå§‹åŒ–çš„å†…å­˜åŒºåŸŸã€‚ HEAP SUMMARY å’Œ ERROR SUMMARYï¼šValgrind æä¾›äº†å †å†…å­˜ä½¿ç”¨æƒ…å†µçš„æ€»ç»“å’Œé”™è¯¯æ‘˜è¦ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå †å†…å­˜ä¸­æ²¡æœ‰åˆ†é…ä»»ä½•å†…å­˜å—ï¼Œä¹Ÿæ²¡æœ‰å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ All heap blocks were freed -- no leaks are possibleï¼šValgrind å‘Šè¯‰æˆ‘ä»¬åœ¨ç¨‹åºç»“æŸæ—¶æ‰€æœ‰çš„å †å†…å­˜éƒ½å·²è¢«é‡Šæ”¾ï¼Œå› æ­¤ä¸å­˜åœ¨å†…å­˜æ³„æ¼çš„å¯èƒ½æ€§ã€‚ ç¼–å†™ä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œä½¿ç”¨ malloc() åˆ†é…å†…å­˜ï¼Œä½†åœ¨é€€å‡ºå‰å¿˜è®°é‡Šæ”¾å†…å­˜ã€‚ç¨‹åºè¿è¡Œæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ èƒ½ç”¨ gdb æŸ¥æ‰¾å‡ºä»»ä½•é—®é¢˜å—ï¼Ÿä½¿ç”¨ valgrindï¼ˆåŒæ ·ä½¿ç”¨ â€“leak-check=yes æ ‡å¿—ï¼‰å¦‚ä½•ï¼Ÿ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e void malloc_but_nofree() { int *p = (int *)malloc(sizeof(int)); } int main() { malloc_but_nofree(); return 0; } ç¨‹åºæ­£å¸¸è¿è¡Œæ­£å¸¸ç»“æŸï¼Œgdbä¹Ÿæ— æ³•å‘ç°å†…å­˜æ³„æ¼ï¼Œä½†valgrindå¯ä»¥ã€‚ ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä½¿ç”¨ malloc åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 100 çš„åä¸º data çš„æ•´æ•°æ•°ç»„ï¼Œç„¶åå°† data[100] è®¾ç½®ä¸ºé›¶ã€‚è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½¿ç”¨ va","date":"2024-04-25","objectID":"/posts/09.%E5%86%85%E5%AD%98api/:0:0","tags":["OS"],"title":"å†…å­˜API","uri":"/posts/09.%E5%86%85%E5%AD%98api/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":" ä»€ä¹ˆæ˜¯å†…å­˜è™šæ‹ŸåŒ–ï¼Ÿ æ“ä½œç³»ç»Ÿè™šæ‹Ÿå…¶ç‰©ç†å†…å­˜ã€‚ æ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹æä¾›ä¸€ä¸ªè™šæ‹Ÿå†…å­˜ç©ºé—´ã€‚ çœ‹èµ·æ¥æ¯ä¸ªè¿›ç¨‹éƒ½ä½¿ç”¨æ•´ä¸ªå†…å­˜ã€‚ å†…å­˜è™šæ‹ŸåŒ–çš„å¥½å¤„ æ˜“äºç¼–ç¨‹ åœ¨æ—¶é—´å’Œç©ºé—´æ–¹é¢æé«˜å†…å­˜æ•ˆç‡ ä¿è¯è¿›ç¨‹å’Œæ“ä½œç³»ç»Ÿçš„éš”ç¦»ï¼Œé˜²æ­¢å…¶ä»–è¿›ç¨‹çš„é”™è¯¯è®¿é—® ","date":"2024-04-25","objectID":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/:0:0","tags":["OS"],"title":"åœ°å€ç©ºé—´","uri":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 æ—©æœŸæ“ä½œç³»ç»Ÿ ä»å†…å­˜çš„è§’åº¦æ¥çœ‹ï¼Œæ—©æœŸçš„æœºå™¨å¹¶æ²¡æœ‰ä¸ºç”¨æˆ·æä¾›å¤ªå¤šçš„æŠ½è±¡æ¦‚å¿µã€‚åŸºæœ¬ä¸Šï¼Œæœºå™¨çš„ç‰©ç†å†…å­˜å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ“ä½œç³»ç»Ÿæ˜¯ä¸€ç»„ä½äºå†…å­˜ï¼ˆæœ¬ä¾‹ä¸­ä»ç‰©ç†åœ°å€ 0 å¼€å§‹ï¼‰ä¸­çš„ä¾‹ç¨‹ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªåº“ï¼‰ï¼Œè€Œå½“å‰ä½äºç‰©ç†å†…å­˜ï¼ˆæœ¬ä¾‹ä¸­ä»ç‰©ç†åœ°å€ 64k å¼€å§‹ï¼‰ä¸­çš„ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼ˆè¿›ç¨‹ï¼‰åˆ™ä½¿ç”¨å†…å­˜çš„å…¶ä½™éƒ¨åˆ†ã€‚ç”¨æˆ·å¯¹æ“ä½œç³»ç»Ÿçš„æœŸæœ›å€¼å¹¶ä¸é«˜ã€‚ ","date":"2024-04-25","objectID":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/:1:0","tags":["OS"],"title":"åœ°å€ç©ºé—´","uri":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 å¤šé“ç¨‹åºè®¾è®¡å’Œåˆ†æ—¶ ä¸€æ®µæ—¶é—´åï¼Œç”±äºæœºå™¨ä»·æ ¼æ˜‚è´µï¼Œäººä»¬å¼€å§‹æ›´æœ‰æ•ˆåœ°å…±äº«æœºå™¨ã€‚å› æ­¤ï¼Œå¤šé“ç¨‹åºè®¾è®¡çš„æ—¶ä»£è¯ç”Ÿäº†ï¼Œå…¶ä¸­å¤šä¸ªè¿›ç¨‹å‡†å¤‡åœ¨ç»™å®šæ—¶é—´è¿è¡Œï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿå°†åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ï¼Œä¾‹å¦‚å½“ä¸€ä¸ªè¿›ç¨‹å†³å®šæ‰§è¡Œ I/O æ—¶ã€‚è¿™æ ·åšæé«˜äº† CPU çš„æœ‰æ•ˆåˆ©ç”¨ç‡ã€‚åœ¨å½“æ—¶æ¯å°æœºå™¨çš„æˆæœ¬é«˜è¾¾æ•°åä¸‡ç”šè‡³æ•°ç™¾ä¸‡ç¾å…ƒï¼ˆè€Œä¸”æ‚¨è®¤ä¸ºæ‚¨çš„ Mac å¾ˆæ˜‚è´µï¼ï¼‰ï¼Œè¿™ç§æ•ˆç‡çš„æé«˜å°¤å…¶é‡è¦ã€‚ ç„¶è€Œï¼Œå¾ˆå¿«ï¼Œäººä»¬å¼€å§‹å¯¹æœºå™¨æå‡ºæ›´å¤šè¦æ±‚ï¼Œåˆ†æ—¶æ—¶ä»£è¯ç”Ÿäº†ã€‚å…·ä½“æ¥è¯´ï¼Œè®¸å¤šäººæ„è¯†åˆ°æ‰¹å¤„ç†è®¡ç®—çš„å±€é™æ€§ï¼Œç‰¹åˆ«æ˜¯å¯¹ç¨‹åºå‘˜æœ¬èº«è€Œè¨€ï¼Œä»–ä»¬åŒå€¦äº†é•¿çš„ç¨‹åºè°ƒè¯•å‘¨æœŸã€‚äº¤äº’æ€§çš„æ¦‚å¿µå˜å¾—å¾ˆé‡è¦ï¼Œå› ä¸ºè®¸å¤šç”¨æˆ·å¯èƒ½åŒæ—¶ä½¿ç”¨ä¸€å°æœºå™¨ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ç­‰å¾…ï¼ˆæˆ–å¸Œæœ›ï¼‰å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡åŠæ—¶å“åº”ã€‚å®ç°åˆ†æ—¶çš„ä¸€ç§æ–¹æ³•æ˜¯è¿è¡Œä¸€ä¸ªè¿›ç¨‹ä¸€å°ä¼šå„¿ï¼Œèµ‹äºˆå®ƒå¯¹æ‰€æœ‰å†…å­˜çš„å®Œå…¨è®¿é—®æƒé™ï¼Œç„¶ååœæ­¢å®ƒï¼Œå°†å…¶æ‰€æœ‰çŠ¶æ€ä¿å­˜åˆ°æŸç§ç£ç›˜ï¼ˆåŒ…æ‹¬æ‰€æœ‰ç‰©ç†å†…å­˜ï¼‰ï¼ŒåŠ è½½å…¶ä»–è¿›ç¨‹çš„çŠ¶æ€ï¼Œè¿è¡Œä¸€æ®µæ—¶é—´ï¼Œä»è€Œå®ç°æŸç§æœºå™¨çš„ç²—ç•¥å…±äº«ã€‚ ä½†è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªå¤§é—®é¢˜ï¼šå®ƒå¤ªæ…¢äº†ï¼Œå°¤å…¶æ˜¯å½“å†…å­˜å¢é•¿æ—¶ã€‚è™½ç„¶ä¿å­˜å’Œæ¢å¤å¯„å­˜å™¨çº§çŠ¶æ€ï¼ˆPCã€é€šç”¨å¯„å­˜å™¨ç­‰ï¼‰ç›¸å¯¹è¾ƒå¿«ï¼Œä½†å°†å†…å­˜çš„å…¨éƒ¨å†…å®¹ä¿å­˜åˆ°ç£ç›˜çš„æ€§èƒ½å´éå¸¸ä½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å®æ„¿åšçš„æ˜¯å°†è¿›ç¨‹ç•™åœ¨å†…å­˜ä¸­ï¼ŒåŒæ—¶åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ï¼Œä»è€Œå…è®¸æ“ä½œç³»ç»Ÿæœ‰æ•ˆåœ°å®ç°æ—¶é—´å…±äº«ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å›¾ä¸­ï¼Œæœ‰ä¸‰ä¸ªè¿›ç¨‹ï¼ˆAã€B å’Œ Cï¼‰ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸ºå…¶åˆ†é…çš„ 512KB ç‰©ç†å†…å­˜çš„ä¸€å°éƒ¨åˆ†ã€‚å‡è®¾åªæœ‰ä¸€ä¸ª CPUï¼Œæ“ä½œç³»ç»Ÿé€‰æ‹©è¿è¡Œå…¶ä¸­ä¸€ä¸ªè¿›ç¨‹ï¼ˆä¾‹å¦‚ Aï¼‰ï¼Œè€Œå…¶ä»–è¿›ç¨‹ï¼ˆB å’Œ Cï¼‰åˆ™ä½äºå°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…è¿è¡Œã€‚ä½†å…è®¸å¤šä¸ªç¨‹åºåŒæ—¶é©»ç•™åœ¨å†…å­˜ä¸­ä½¿å¾—ä¿æŠ¤æˆä¸ºä¸€ä¸ªé‡è¦é—®é¢˜ï¼›ä½ ä¸å¸Œæœ›ä¸€ä¸ªè¿›ç¨‹èƒ½å¤Ÿè¯»å–ï¼Œæˆ–è€…æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå†™å…¥å…¶ä»–è¿›ç¨‹çš„å†…å­˜ã€‚ ","date":"2024-04-25","objectID":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/:2:0","tags":["OS"],"title":"åœ°å€ç©ºé—´","uri":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 åœ°å€ç©ºé—´ è¿™æ ·å°±éœ€è¦æ“ä½œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæ˜“äºä½¿ç”¨çš„ç‰©ç†å†…å­˜æŠ½è±¡ã€‚æˆ‘ä»¬å°†è¿™ç§æŠ½è±¡ç§°ä¸ºåœ°å€ç©ºé—´ï¼Œå®ƒæ˜¯æ­£åœ¨è¿è¡Œçš„ç¨‹åºå¯¹ç³»ç»Ÿä¸­å†…å­˜çš„è§†å›¾ã€‚äº†è§£æ“ä½œç³»ç»Ÿå¯¹å†…å­˜çš„åŸºæœ¬æŠ½è±¡æ˜¯ç†è§£å†…å­˜å¦‚ä½•è™šæ‹ŸåŒ–çš„å…³é”®ã€‚ è¿›ç¨‹çš„åœ°å€ç©ºé—´åŒ…å«æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„æ‰€æœ‰å†…å­˜çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œç¨‹åºçš„ä»£ç ï¼ˆæŒ‡ä»¤ï¼‰å¿…é¡»ä½äºå†…å­˜ä¸­çš„æŸä¸ªä½ç½®ï¼Œå› æ­¤å®ƒä»¬ä½äºåœ°å€ç©ºé—´ä¸­ã€‚ç¨‹åºåœ¨è¿è¡Œæ—¶ä½¿ç”¨æ ˆæ¥è·Ÿè¸ªå®ƒåœ¨å‡½æ•°è°ƒç”¨é“¾ä¸­çš„ä½ç½®ï¼Œä»¥åŠåˆ†é…å±€éƒ¨å˜é‡å’Œå‘ä¾‹ç¨‹ä¼ é€’å‚æ•°å’Œè¿”å›å€¼ã€‚æœ€åï¼Œå †ç”¨äºåŠ¨æ€åˆ†é…ã€ç”¨æˆ·ç®¡ç†çš„å†…å­˜ï¼Œä¾‹å¦‚æ‚¨å¯èƒ½ä» C ä¸­è°ƒç”¨ malloc() æˆ–é¢å‘å¯¹è±¡è¯­è¨€ï¼ˆä¾‹å¦‚ C++ æˆ– Javaï¼‰ä¸­çš„ new è°ƒç”¨ä¸­æ¥æ”¶åˆ°çš„å†…å­˜ã€‚å½“ç„¶ï¼Œå…¶ä¸­è¿˜æœ‰å…¶ä»–ä¸œè¥¿ï¼ˆä¾‹å¦‚é™æ€åˆå§‹åŒ–å˜é‡ï¼‰ï¼Œä½†ç°åœ¨æˆ‘ä»¬åªå‡è®¾è¿™ä¸‰ä¸ªç»„ä»¶ï¼šä»£ç ã€æ ˆå’Œå †ã€‚ åœ¨ä¸Šå›¾çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¾ˆå°çš„åœ°å€ç©ºé—´ï¼ˆåªæœ‰ 16KBï¼‰ã€‚ç¨‹åºä»£ç ä½äºåœ°å€ç©ºé—´çš„é¡¶éƒ¨ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä» 0 å¼€å§‹ï¼Œå¹¶è¢«æ‰“åŒ…åˆ°åœ°å€ç©ºé—´çš„å‰ 1KB ä¸­ï¼‰ã€‚ä»£ç æ˜¯é™æ€çš„ï¼ˆå› æ­¤å¾ˆå®¹æ˜“æ”¾ç½®åœ¨å†…å­˜ä¸­ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†å…¶æ”¾ç½®åœ¨åœ°å€ç©ºé—´çš„é¡¶éƒ¨ï¼Œå¹¶ä¸”çŸ¥é“ç¨‹åºè¿è¡Œæ—¶å®ƒä¸ä¼šéœ€è¦æ›´å¤šç©ºé—´ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªåœ¨ç¨‹åºè¿è¡Œæ—¶å¯èƒ½ä¼šå¢é•¿ï¼ˆå’Œæ”¶ç¼©ï¼‰çš„åœ°å€ç©ºé—´åŒºåŸŸã€‚è¿™äº›æ˜¯å †ï¼ˆåœ¨é¡¶éƒ¨ï¼‰å’Œæ ˆï¼ˆåœ¨åº•éƒ¨ï¼‰ã€‚æˆ‘ä»¬è¿™æ ·æ”¾ç½®å®ƒä»¬æ˜¯å› ä¸ºæ¯ä¸ªéƒ½å¸Œæœ›èƒ½å¤Ÿå¢é•¿ï¼Œå¹¶ä¸”é€šè¿‡å°†å®ƒä»¬æ”¾åœ¨åœ°å€ç©ºé—´çš„ä¸¤ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥å…è®¸è¿™æ ·çš„å¢é•¿ï¼šå®ƒä»¬åªéœ€è¦å‘ç›¸åçš„æ–¹å‘å¢é•¿å³å¯ã€‚å› æ­¤ï¼Œå †åœ¨ä»£ç ä¹‹åå¼€å§‹ï¼ˆ1KBï¼‰å¹¶å‘ä¸‹å¢é•¿ï¼ˆä¾‹å¦‚ï¼Œå½“ç”¨æˆ·é€šè¿‡ malloc() è¯·æ±‚æ›´å¤šå†…å­˜æ—¶ï¼‰ï¼›å †æ ˆä» 16KB å¼€å§‹å¹¶å‘ä¸Šå¢é•¿ï¼ˆä¾‹å¦‚å½“ç”¨æˆ·è¿›è¡Œè¿‡ç¨‹è°ƒç”¨æ—¶ï¼‰ã€‚ç„¶è€Œï¼Œæ ˆå’Œå †çš„è¿™ç§æ”¾ç½®åªæ˜¯ä¸€ç§çº¦å®šï¼›å¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥ä»¥ä¸åŒçš„æ–¹å¼å®‰æ’åœ°å€ç©ºé—´ï¼ˆæ­£å¦‚æˆ‘ä»¬ç¨åå°†çœ‹åˆ°çš„ï¼Œå½“å¤šä¸ªçº¿ç¨‹å…±å­˜äºä¸€ä¸ªåœ°å€ç©ºé—´ä¸­æ—¶ï¼Œæ²¡æœ‰åƒè¿™æ ·åˆ’åˆ†åœ°å€ç©ºé—´çš„å¥½æ–¹æ³•äº†ï¼‰ã€‚ å½“ç„¶ï¼Œå½“æˆ‘ä»¬æè¿°åœ°å€ç©ºé—´æ—¶ï¼Œæˆ‘ä»¬æè¿°çš„æ˜¯æ“ä½œç³»ç»Ÿä¸ºæ­£åœ¨è¿è¡Œçš„ç¨‹åºæä¾›çš„æŠ½è±¡ã€‚è¯¥ç¨‹åºå®é™…ä¸Šå¹¶ä¸ä½äºç‰©ç†åœ°å€ 0 åˆ° 16KB çš„å†…å­˜ä¸­ï¼›ç›¸åï¼Œå®ƒè¢«åŠ è½½åˆ°æŸä¸ªä»»æ„çš„ç‰©ç†åœ°å€ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šå›¾ ä¸­çš„è¿›ç¨‹ Aã€B å’Œ Cï¼Œæ¯ä¸ªè¿›ç¨‹å¦‚ä½•åŠ è½½åˆ°ä¸åŒåœ°å€çš„å†…å­˜ä¸­ã€‚å› æ­¤å‡ºç°äº†é—®é¢˜ï¼šæ€ä¹ˆè™šæ‹ŸåŒ–å†…å­˜ï¼Ÿæ“ä½œç³»ç»Ÿå¦‚ä½•åœ¨å•ä¸ªç‰©ç†å†…å­˜ä¹‹ä¸Šä¸ºå¤šä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼ˆæ‰€æœ‰å…±äº«å†…å­˜ï¼‰æ„å»ºç§æœ‰çš„ã€å¯èƒ½å¾ˆå¤§çš„åœ°å€ç©ºé—´çš„æŠ½è±¡ï¼Ÿ å½“æ“ä½œç³»ç»Ÿæ‰§è¡Œæ­¤æ“ä½œæ—¶ï¼Œæˆ‘ä»¬è¯´æ“ä½œç³»ç»Ÿæ­£åœ¨è™šæ‹ŸåŒ–å†…å­˜ï¼Œå› ä¸ºæ­£åœ¨è¿è¡Œçš„ç¨‹åºè®¤ä¸ºå®ƒå·²åŠ è½½åˆ°å†…å­˜ä¸­çš„ç‰¹å®šåœ°å€ï¼ˆä¾‹å¦‚ 0ï¼‰ï¼Œå¹¶ä¸”å…·æœ‰æ½œåœ¨çš„éå¸¸å¤§çš„åœ°å€ç©ºé—´ï¼ˆä¾‹å¦‚ 32 ä½æˆ– 64 ä½ï¼‰ ï¼Œä½†ç°å®å´æˆªç„¶ä¸åŒã€‚ ä¾‹å¦‚ï¼Œå½“ä¸Šå›¾çš„è¿›ç¨‹ A å°è¯•åœ¨åœ°å€ 0ï¼ˆæˆ‘ä»¬å°†å…¶ç§°ä¸ºè™šæ‹Ÿåœ°å€ï¼‰å¤„æ‰§è¡ŒåŠ è½½æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸æŸäº›ç¡¬ä»¶æ”¯æŒç›¸ç»“åˆï¼Œå¿…é¡»ç¡®ä¿åŠ è½½å®é™…ä¸Šä¸æ˜¯åˆ°ç‰©ç†åœ°å€ 0ï¼Œè€Œæ˜¯è½¬åˆ°ç‰©ç†åœ°å€ 320KBï¼ˆA è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼‰ã€‚è¿™æ˜¯å†…å­˜è™šæ‹ŸåŒ–çš„å…³é”®ï¼Œå†…å­˜è™šæ‹ŸåŒ–æ˜¯ä¸–ç•Œä¸Šæ¯ä¸ªç°ä»£è®¡ç®—æœºç³»ç»Ÿçš„åŸºç¡€ã€‚ TIP éš”ç¦»åŸåˆ™ éš”ç¦»æ˜¯æ„å»ºå¯é ç³»ç»Ÿçš„å…³é”®åŸåˆ™ã€‚å¦‚æœä¸¤ä¸ªå®ä½“é€‚å½“åœ°ç›¸äº’éš”ç¦»ï¼Œè¿™æ„å‘³ç€å…¶ä¸­ä¸€ä¸ªå®ä½“å‘ç”Ÿæ•…éšœæ—¶ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå®ä½“ã€‚æ“ä½œç³»ç»ŸåŠªåŠ›å°†è¿›ç¨‹ç›¸äº’éš”ç¦»ï¼Œä»è€Œé˜²æ­¢ä¸€ä¸ªè¿›ç¨‹æŸå®³å¦ä¸€ä¸ªè¿›ç¨‹ã€‚ é€šè¿‡ä½¿ç”¨å†…å­˜éš”ç¦»ï¼Œæ“ä½œç³»ç»Ÿè¿›ä¸€æ­¥ç¡®ä¿è¿è¡Œä¸­çš„ç¨‹åºä¸ä¼šå½±å“åº•å±‚æ“ä½œç³»ç»Ÿçš„è¿è¡Œã€‚ä¸€äº›ç°ä»£æ“ä½œç³»ç»Ÿç”šè‡³æ›´è¿›ä¸€æ­¥ï¼Œå°†æ“ä½œç³»ç»Ÿçš„å„ä¸ªéƒ¨åˆ†ä¸æ“ä½œç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†éš”ç¦»å¼€æ¥ã€‚å› æ­¤ï¼Œè¿™ç§å¾®å†…æ ¸æ¯”å…¸å‹çš„å•ç‰‡å†…æ ¸è®¾è®¡æ›´å¯é ã€‚ ","date":"2024-04-25","objectID":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/:3:0","tags":["OS"],"title":"åœ°å€ç©ºé—´","uri":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 ç›®æ ‡ å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è¿™ç»„ç¬”è®°ä¸­æ‰¾åˆ°äº†æ“ä½œç³»ç»Ÿçš„å·¥ä½œï¼šè™šæ‹ŸåŒ–å†…å­˜ã€‚ä¸è¿‡ï¼Œæ“ä½œç³»ç»Ÿä¸ä»…ä¼šè™šæ‹ŸåŒ–å†…å­˜ï¼›å®ƒä¼šå¾ˆæœ‰é£æ ¼åœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚ä¸ºäº†ç¡®ä¿æ“ä½œç³»ç»Ÿåšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›ç›®æ ‡æ¥æŒ‡å¯¼æˆ‘ä»¬ã€‚ è™šæ‹Ÿå†…å­˜ (VM) ç³»ç»Ÿçš„ä¸»è¦ç›®æ ‡ä¹‹ä¸€æ˜¯é€æ˜åº¦ã€‚æ“ä½œç³»ç»Ÿåº”è¯¥ä»¥å¯¹æ­£åœ¨è¿è¡Œçš„ç¨‹åºä¸å¯è§çš„æ–¹å¼å®ç°è™šæ‹Ÿå†…å­˜ã€‚å› æ­¤ï¼Œç¨‹åºä¸åº”è¯¥æ„è¯†åˆ°å†…å­˜æ˜¯è™šæ‹ŸåŒ–çš„ï¼›ç›¸åï¼Œç¨‹åºçš„è¡Œä¸ºå°±å¥½åƒå®ƒæœ‰è‡ªå·±çš„ç§æœ‰ç‰©ç†å†…å­˜ä¸€æ ·ã€‚æ“ä½œç³»ç»Ÿï¼ˆå’Œç¡¬ä»¶ï¼‰åœ¨èƒŒåå®Œæˆäº†åœ¨è®¸å¤šä¸åŒä½œä¸šä¹‹é—´å¤ç”¨å†…å­˜çš„æ‰€æœ‰å·¥ä½œï¼Œä»è€Œå®ç°äº†è¿™ç§é”™è§‰ã€‚ VMçš„å¦ä¸€ä¸ªç›®æ ‡æ˜¯æ•ˆç‡ã€‚æ“ä½œç³»ç»Ÿåº”åŠªåŠ›ä½¿è™šæ‹ŸåŒ–å°½å¯èƒ½é«˜æ•ˆï¼Œæ— è®ºæ˜¯åœ¨æ—¶é—´ï¼ˆå³ä¸ä½¿ç¨‹åºè¿è¡Œå¾—æ›´æ…¢ï¼‰è¿˜æ˜¯åœ¨ç©ºé—´ï¼ˆå³ä¸ä¸ºæ”¯æŒè™šæ‹ŸåŒ–æ‰€éœ€çš„ç»“æ„ä½¿ç”¨å¤ªå¤šå†…å­˜ï¼‰æ–¹é¢ã€‚åœ¨å®ç°é«˜æ•ˆè™šæ‹ŸåŒ–æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»ä¾èµ–ç¡¬ä»¶æ”¯æŒï¼ŒåŒ…æ‹¬TLBç­‰ç¡¬ä»¶åŠŸèƒ½ã€‚ æœ€åï¼Œç¬¬ä¸‰ä¸ªVMç›®æ ‡æ˜¯ä¿æŠ¤ã€‚æ“ä½œç³»ç»Ÿåº”ç¡®ä¿è¿›ç¨‹å…å—å…¶ä»–è¿›ç¨‹çš„å½±å“ä»¥åŠæ“ä½œç³»ç»Ÿæœ¬èº«å…å—è¿›ç¨‹çš„å½±å“ã€‚å½“ä¸€ä¸ªè¿›ç¨‹æ‰§è¡ŒåŠ è½½ã€å­˜å‚¨æˆ–å–æŒ‡ä»¤æ—¶ï¼Œå®ƒä¸åº”è¯¥èƒ½å¤Ÿä»¥ä»»ä½•æ–¹å¼è®¿é—®æˆ–å½±å“ä»»ä½•å…¶ä»–è¿›ç¨‹æˆ–æ“ä½œç³»ç»Ÿæœ¬èº«çš„å†…å­˜å†…å®¹ï¼ˆå³å…¶åœ°å€ç©ºé—´ä¹‹å¤–çš„ä»»ä½•å†…å®¹ï¼‰ã€‚å› æ­¤ï¼Œä¿æŠ¤ä½¿æˆ‘ä»¬èƒ½å¤Ÿæä¾›è¿›ç¨‹ä¹‹é—´çš„éš”ç¦»ç‰¹æ€§ï¼›æ¯ä¸ªè¿›ç¨‹éƒ½åº”è¯¥åœ¨è‡ªå·±éš”ç¦»çš„èŒ§ä¸­è¿è¡Œï¼Œå…å—å…¶ä»–é”™è¯¯ç”šè‡³æ¶æ„è¿›ç¨‹çš„ç ´åã€‚ ","date":"2024-04-25","objectID":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/:4:0","tags":["OS"],"title":"åœ°å€ç©ºé—´","uri":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 è™šæ‹Ÿåœ°å€ äº‹å®ä¸Šï¼Œä½œä¸ºç”¨æˆ·çº§ç¨‹åºçš„ç¨‹åºå‘˜ï¼Œä½ èƒ½çœ‹åˆ°çš„ä»»ä½•åœ°å€éƒ½æ˜¯è™šæ‹Ÿåœ°å€ã€‚åªæœ‰æ“ä½œç³»ç»Ÿé€šè¿‡å…¶å·§å¦™çš„è™šæ‹Ÿå†…å­˜æŠ€æœ¯ï¼Œæ‰èƒ½çŸ¥é“è¿™äº›æŒ‡ä»¤å’Œæ•°æ®å€¼åœ¨æœºå™¨ç‰©ç†å†…å­˜ä¸­çš„ä½ç½®ã€‚å› æ­¤ï¼Œåƒä¸‡ä¸è¦å¿˜è®°ï¼šå¦‚æœä½ åœ¨ç¨‹åºä¸­æ‰“å°å‡ºä¸€ä¸ªåœ°å€ï¼Œé‚£åªæ˜¯ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œæ˜¯å†…å­˜ä¸­äº‹ç‰©å¸ƒå±€çš„å‡è±¡ï¼›åªæœ‰æ“ä½œç³»ç»Ÿï¼ˆå’Œç¡¬ä»¶ï¼‰æ‰çŸ¥é“çœŸæ­£çš„çœŸç›¸ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°ç¨‹åº (va.c)ï¼Œå®ƒå¯ä»¥æ‰“å°å‡º main() ä¾‹ç¨‹ï¼ˆä»£ç æ‰€åœ¨ä½ç½®ï¼‰çš„ä½ç½®ã€å…¨å±€å˜é‡çš„ä½ç½®ã€malloc() è¿”å›çš„å †åˆ†é…å€¼ä»¥åŠå †æ ˆä¸­æ•´æ•°çš„ä½ç½®ï¼š #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e int global = 1; int main(int argc, char *argv[]) { // Declaring a variable x on the stack int x = 3; // Printing the location of the code printf(\"location of code : %p\\n\", (void *) main); // Printing the location of global variable printf(\"location of data : %p\\n\", (void *) \u0026global); // Printing the location of heap memory printf(\"location of heap : %p\\n\", (void *) malloc(1)); // Printing the location of stack variable x printf(\"location of stack : %p\\n\", (void *) \u0026x); return x; } å½“è¿è¡Œåœ¨64ä½çš„Linuxï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š location of code: 0x40057d location of data : 0x401010 location of heap : 0xcf2010 location of stack : 0x7fff9ca45fcc å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°ä»£ç é¦–å…ˆå‡ºç°åœ¨åœ°å€ç©ºé—´ä¸­ï¼Œå…¶æ¬¡æ˜¯é™æ€æ•°æ®ï¼Œç„¶åæ˜¯å †ï¼Œè€Œæ ˆä¸€ç›´ä½äºè¿™ä¸ªå¤§è™šæ‹Ÿç©ºé—´çš„å¦ä¸€ç«¯ã€‚æ‰€æœ‰è¿™äº›åœ°å€éƒ½æ˜¯è™šæ‹Ÿçš„ï¼Œå¹¶ä¸”å°†ç”±æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶è¿›è¡Œè½¬æ¢ï¼Œä»¥ä¾¿ä»å…¶çœŸå®çš„ç‰©ç†ä½ç½®è·å–å€¼ã€‚ ","date":"2024-04-25","objectID":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/:5:0","tags":["OS"],"title":"åœ°å€ç©ºé—´","uri":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 æ€»ç»“ æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä¸€ä¸ªä¸»è¦æ“ä½œç³»ç»Ÿå­ç³»ç»Ÿçš„å¼•å…¥ï¼šè™šæ‹Ÿå†…å­˜ã€‚ VMç³»ç»Ÿè´Ÿè´£ä¸ºç¨‹åºæä¾›ä¸€ä¸ªå¤§çš„ã€ç¨€ç–çš„ã€ç§æœ‰çš„åœ°å€ç©ºé—´çš„å‡è±¡ï¼Œå…¶ä¸­ä¿å­˜äº†å®ƒä»¬çš„æ‰€æœ‰æŒ‡ä»¤å’Œæ•°æ®ã€‚åœ¨ä¸€äº›ç¡¬ä»¶çš„å¸®åŠ©ä¸‹ï¼Œæ“ä½œç³»ç»Ÿå°†è·å–æ¯ä¸ªè™šæ‹Ÿå†…å­˜å¼•ç”¨ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºç‰©ç†åœ°å€ï¼Œå¯ä»¥å°†å…¶å‘ˆç°ç»™ç‰©ç†å†…å­˜ä»¥è·å–æ‰€éœ€çš„ä¿¡æ¯ã€‚æ“ä½œç³»ç»Ÿå°†åŒæ—¶å¯¹è®¸å¤šè¿›ç¨‹æ‰§è¡Œæ­¤æ“ä½œï¼Œç¡®ä¿ä¿æŠ¤ç¨‹åºå…å—å½¼æ­¤çš„ä¾µå®³ï¼Œå¹¶ä¿æŠ¤æ“ä½œç³»ç»Ÿã€‚ VMçš„ç›®æ ‡å¦‚ä¸‹ï¼š é€æ˜åº¦ VM å¯¹äºæ­£åœ¨è¿è¡Œçš„ç¨‹åºåº”è¯¥æ˜¯ä¸å¯è§çš„ æ•ˆç‡ æœ€å°åŒ–æ—¶é—´å’Œç©ºé—´æ–¹é¢çš„å¼€é”€ ä¿æŠ¤ éš”ç¦»è¿›ç¨‹ï¼ˆå’Œæ“ä½œç³»ç»Ÿæœ¬èº«ï¼‰[ä½†å…è®¸é€‰æ‹©æ€§â€œé€šä¿¡â€] ","date":"2024-04-25","objectID":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/:6:0","tags":["OS"],"title":"åœ°å€ç©ºé—´","uri":"/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 å¤šå¤„ç†å™¨æ¶æ„ è¦ç†è§£å›´ç»•å¤šå¤„ç†å™¨è°ƒåº¦çš„æ–°é—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»äº†è§£å• CPU ç¡¬ä»¶ä¸å¤š CPU ç¡¬ä»¶ä¹‹é—´çš„ä¸€ä¸ªæ–°çš„æ ¹æœ¬åŒºåˆ«ã€‚è¿™ç§åŒºåˆ«ä¸»è¦å›´ç»•ç¡¬ä»¶ç¼“å­˜çš„ä½¿ç”¨ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œä»¥åŠå¤šä¸ªå¤„ç†å™¨ä¹‹é—´å…±äº«æ•°æ®çš„å…·ä½“æ–¹å¼ã€‚ åœ¨å•ä¸ªCPUç³»ç»Ÿä¸­ï¼Œç¡¬ä»¶ç¼“å­˜ï¼ˆCacheï¼‰çš„å±‚æ¬¡ç»“æ„é€šå¸¸æœ‰åŠ©äºå¤„ç†å™¨æ›´å¿«åœ°è¿è¡Œç¨‹åºã€‚Cacheæ˜¯ä¸€ç§å°å‹å¿«é€Ÿå­˜å‚¨å™¨ï¼Œï¼ˆä¸€èˆ¬æ¥è¯´ï¼‰ä¿å­˜ç³»ç»Ÿä¸»å­˜å‚¨å™¨ä¸­å¸¸ç”¨æ•°æ®çš„å‰¯æœ¬ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¸»å­˜å‚¨å™¨ä¿å­˜äº†æ‰€æœ‰æ•°æ®ï¼Œä½†è®¿é—®è¿™ä¸ªè¾ƒå¤§çš„å†…å­˜æ—¶é€Ÿåº¦è¾ƒæ…¢ã€‚é€šè¿‡å°†é¢‘ç¹è®¿é—®çš„æ•°æ®ä¿å­˜åœ¨é«˜é€Ÿç¼“å­˜ä¸­ï¼Œç³»ç»Ÿå¯ä»¥è®©åˆå¤§åˆæ…¢çš„å†…å­˜çœ‹èµ·æ¥å¾ˆå¿«ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªç¨‹åºè¦ä»å†…å­˜ä¸­è·å–ä¸€ä¸ªå€¼ï¼Œéœ€è¦å‘å‡ºä¸€æ¡æ˜¾å¼åŠ è½½æŒ‡ä»¤ï¼Œè€Œä¸€ä¸ªç®€å•çš„ç³»ç»Ÿåªæœ‰ä¸€ä¸ª CPUï¼›CPU æœ‰ä¸€ä¸ªå°ç¼“å­˜ï¼ˆæ¯”å¦‚ 64 KBï¼‰å’Œä¸€ä¸ªå¤§ä¸»å­˜ã€‚ç¨‹åºé¦–æ¬¡å‘å‡ºåŠ è½½æŒ‡ä»¤æ—¶ï¼Œæ•°æ®ä½äºä¸»å†…å­˜ä¸­ï¼Œå› æ­¤éœ€è¦å¾ˆé•¿æ—¶é—´ï¼ˆå¯èƒ½æ˜¯å‡ åçº³ç§’ï¼Œç”šè‡³å‡ ç™¾çº³ç§’ï¼‰æ‰èƒ½è·å–ã€‚å¤„ç†å™¨é¢„è®¡æ•°æ®å¯èƒ½ä¼šè¢«é‡å¤ä½¿ç”¨ï¼Œå› æ­¤ä¼šå°†åŠ è½½æ•°æ®çš„å‰¯æœ¬æ”¾å…¥ CPU ç¼“å­˜ã€‚å¦‚æœç¨‹åºç¨åå†æ¬¡æå–ç›¸åŒçš„æ•°æ®é¡¹ï¼ŒCPU ä¼šé¦–å…ˆæ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰è¯¥æ•°æ®é¡¹ï¼›å¦‚æœåœ¨ç¼“å­˜ä¸­æ‰¾åˆ°äº†è¯¥æ•°æ®é¡¹ï¼Œæå–æ•°æ®çš„é€Ÿåº¦å°±ä¼šå¿«å¾—å¤šï¼ˆæ¯”å¦‚åªéœ€å‡ çº³ç§’ï¼‰ï¼Œä»è€ŒåŠ å¿«ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ã€‚ å› æ­¤ï¼Œç¼“å­˜æ˜¯ä»¥å±€éƒ¨æ€§æ¦‚å¿µä¸ºåŸºç¡€çš„ï¼Œå±€éƒ¨æ€§æœ‰ä¸¤ç§ï¼šæ—¶é—´å±€éƒ¨æ€§å’Œç©ºé—´å±€éƒ¨æ€§ã€‚æ—¶é—´å±€éƒ¨æ€§èƒŒåçš„ç†å¿µæ˜¯ï¼Œå½“ä¸€ä¸ªæ•°æ®è¢«è®¿é—®æ—¶ï¼Œå®ƒå¾ˆå¯èƒ½åœ¨ä¸ä¹…çš„å°†æ¥å†æ¬¡è¢«è®¿é—®ï¼›æƒ³è±¡ä¸€ä¸‹å˜é‡ç”šè‡³æŒ‡ä»¤æœ¬èº«åœ¨å¾ªç¯ä¸­è¢«åå¤è®¿é—®çš„æƒ…æ™¯ã€‚ç©ºé—´å±€éƒ¨æ€§èƒŒåçš„ç†å¿µæ˜¯ï¼Œå¦‚æœç¨‹åºè®¿é—®äº†åœ°å€ä¸º x çš„æ•°æ®é¡¹ï¼Œé‚£ä¹ˆå®ƒå¾ˆå¯èƒ½ä¹Ÿä¼šè®¿é—® x é™„è¿‘çš„æ•°æ®é¡¹ï¼›åœ¨è¿™é‡Œï¼Œå¯ä»¥æƒ³è±¡ç¨‹åºåœ¨æ•°ç»„ä¸­æµæ°´ä½œä¸šï¼Œæˆ–è€…æŒ‡ä»¤è¢«ä¸€æ¡æ¥ä¸€æ¡åœ°æ‰§è¡Œã€‚ç”±äºè®¸å¤šç¨‹åºéƒ½å­˜åœ¨è¿™äº›ç±»å‹çš„å±€éƒ¨æ€§ï¼Œå› æ­¤ç¡¬ä»¶ç³»ç»Ÿå¯ä»¥å¾ˆå¥½åœ°çŒœæµ‹å“ªäº›æ•°æ®åº”æ”¾å…¥é«˜é€Ÿç¼“å­˜ï¼Œä»è€Œå¾ˆå¥½åœ°å·¥ä½œã€‚ ä½†å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ä½¿ç”¨å¤šä¸ªå¤„ç†å™¨å’Œä¸€ä¸ªå…±äº«ä¸»å­˜å‚¨å™¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ äº‹å®è¯æ˜ï¼Œå¤š CPU ç¼“å­˜è¦å¤æ‚å¾—å¤šã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾åœ¨ CPU 1 ä¸Šè¿è¡Œçš„ç¨‹åºè¯»å–å¹¶æ›´æ–°äº†åœ°å€ A ä¸Šçš„ä¸€ä¸ªæ•°æ®é¡¹ï¼ˆå€¼ä¸º Dï¼‰ï¼›ç”±äº CPU 1 çš„ç¼“å­˜ä¸­æ²¡æœ‰è¯¥æ•°æ®ï¼Œç³»ç»Ÿä¼šä»ä¸»å­˜ä¸­è·å–è¯¥æ•°æ®é¡¹ï¼Œå¹¶å¾—åˆ°å€¼ Dã€‚ç„¶åå‡è®¾æ“ä½œç³»ç»Ÿå†³å®šåœæ­¢è¿è¡Œç¨‹åºï¼Œå¹¶å°†å…¶ç§»è‡³ CPU 2ã€‚ç„¶åç¨‹åºé‡æ–°è¯»å–åœ°å€ A å¤„çš„å€¼ï¼Œå‘ç°ç¼“å­˜æ²¡æœ‰è¿™æ ·çš„æ•°æ® ï¼Œå› æ­¤ç³»ç»Ÿä»ä¸»å†…å­˜ä¸­è·å–å€¼ï¼Œå¹¶è·å–æ—§å€¼ D è€Œä¸æ˜¯æ­£ç¡®å€¼ D â€²ã€‚è¿™ä¸ªæ™®éé—®é¢˜ç§°ä¸ºç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚ ç¡¬ä»¶æä¾›äº†åŸºæœ¬çš„è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡ç›‘æ§å†…å­˜è®¿é—®ï¼Œç¡¬ä»¶å¯ä»¥ç¡®ä¿åŸºæœ¬ä¸Š â€œæ­£ç¡®çš„äº‹æƒ… â€œå‘ç”Ÿäº†ï¼Œå¹¶ä¸”å•ä¸ªå…±äº«å†…å­˜çš„è§†å›¾å¾—ä»¥ä¿ç•™ã€‚åœ¨åŸºäºæ€»çº¿çš„ç³»ç»Ÿï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ä¸Šå®ç°è¿™ä¸€ç‚¹çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ç§ç§°ä¸ºæ€»çº¿çª¥æ¢ï¼ˆbus snoopingï¼‰çš„å¤è€æŠ€æœ¯ï¼›æ¯ä¸ªé«˜é€Ÿç¼“å­˜é€šè¿‡è§‚å¯Ÿè¿æ¥å†…å­˜å’Œä¸»å†…å­˜çš„æ€»çº¿æ¥å…³æ³¨å†…å­˜æ›´æ–°ã€‚å½“ CPU çœ‹åˆ°å…¶ç¼“å­˜ä¸­çš„æ•°æ®é¡¹æœ‰æ›´æ–°æ—¶ï¼Œå°±ä¼šæ³¨æ„åˆ°è¿™ä¸€å˜åŒ–ï¼Œè¦ä¹ˆä½¿å…¶å‰¯æœ¬å¤±æ•ˆï¼ˆå³ä»è‡ªå·±çš„ç¼“å­˜ä¸­åˆ é™¤ï¼‰ï¼Œè¦ä¹ˆè¿›è¡Œæ›´æ–°ï¼ˆå³æŠŠæ–°å€¼ä¹Ÿæ”¾å…¥è‡ªå·±çš„ç¼“å­˜ä¸­ï¼‰ã€‚å¦‚ä¸Šæ–‡è¿°ï¼Œå›å†™ç¼“å­˜ä¼šä½¿è¿™ä¸€è¿‡ç¨‹å˜å¾—æ›´åŠ å¤æ‚ï¼ˆå› ä¸ºå†™å…¥ä¸»å†…å­˜çš„å†…å®¹è¦åˆ°ç¨åæ‰èƒ½çœ‹åˆ°ï¼‰ï¼Œä½†ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹åŸºæœ¬æ–¹æ¡ˆæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ ","date":"2024-04-25","objectID":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/:1:0","tags":["OS"],"title":"å¤šCPUè°ƒåº¦","uri":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ä¸è¦å¿˜è®°åŒæ­¥ æ—¢ç„¶ç¼“å­˜ä¸ºæä¾›ä¸€è‡´æ€§åšäº†æ‰€æœ‰è¿™äº›å·¥ä½œï¼Œé‚£ä¹ˆç¨‹åºï¼ˆæˆ–æ“ä½œç³»ç»Ÿæœ¬èº«ï¼‰åœ¨è®¿é—®å…±äº«æ•°æ®æ—¶è¿˜éœ€è¦æ‹…å¿ƒä»€ä¹ˆå—ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œç¨‹åºï¼ˆæˆ–æ“ä½œç³»ç»Ÿï¼‰åœ¨è®¿é—®å…±äº«æ•°æ®æ—¶ä»ç„¶éœ€è¦è€ƒè™‘ä¸€äº›é—®é¢˜ï¼š ç«äº‰æ¡ä»¶ï¼ˆRace Conditionsï¼‰ï¼šå³å½“å¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹è¯•å›¾åŒæ—¶è®¿é—®å…±äº«èµ„æºæ—¶å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚ åŸå­æ€§æ“ä½œï¼šæŸäº›æ“ä½œå¯èƒ½æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œéœ€è¦ç¡®ä¿è¿™äº›æ­¥éª¤çš„æ‰§è¡Œæ˜¯åŸå­çš„ã€‚ å†…å­˜æ …æ å’ŒåŒæ­¥ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œéœ€è¦ä½¿ç”¨å†…å­˜æ …æ ï¼ˆmemory barriersï¼‰æˆ–è€…åŒæ­¥æœºåˆ¶æ¥ç¡®ä¿åœ¨ä¸åŒå¤„ç†å™¨ä¸Šçš„æ“ä½œæ‰§è¡Œé¡ºåºã€‚è¿™æ˜¯å› ä¸ºç¼“å­˜ä¸€è‡´æ€§åªä¿è¯äº†ç¼“å­˜ä¹‹é—´å’Œç¼“å­˜ä¸å†…å­˜ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œè€Œä¸æ˜¯å¯¹æ‰€æœ‰æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºåšå‡ºä¿è¯ã€‚ åœ¨è·¨ CPU è®¿é—®ï¼ˆå°¤å…¶æ˜¯æ›´æ–°ï¼‰å…±äº«æ•°æ®é¡¹æˆ–ç»“æ„æ—¶ï¼Œåº”ä½¿ç”¨äº’æ–¥åŸè¯­ï¼ˆå¦‚é”ï¼‰æ¥ä¿è¯æ­£ç¡®æ€§ï¼ˆå…¶ä»–æ–¹æ³•ï¼Œå¦‚æ„å»ºæ— é”æ•°æ®ç»“æ„ï¼Œæ¯”è¾ƒå¤æ‚ï¼Œåªèƒ½å¶å°”ä½¿ç”¨ï¼‰ã€‚ä¾‹å¦‚ï¼Œå‡è®¾å¤šä¸ª CPU åŒæ—¶è®¿é—®ä¸€ä¸ªå…±äº«é˜Ÿåˆ—ã€‚å¦‚æœæ²¡æœ‰é”ï¼Œå³ä½¿ä½¿ç”¨äº†åº•å±‚ä¸€è‡´æ€§åè®®ï¼Œå¹¶å‘æ·»åŠ æˆ–åˆ é™¤é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¹Ÿæ— æ³•è¾¾åˆ°é¢„æœŸæ•ˆæœï¼›æˆ‘ä»¬éœ€è¦ç”¨é”å°†æ•°æ®ç»“æ„åŸå­æ›´æ–°åˆ°æ–°çŠ¶æ€ã€‚ ä¸ºäº†æ›´å…·ä½“åœ°è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹é¢è¿™æ®µç”¨äºä»å…±äº«é“¾è¡¨ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ çš„ä»£ç åºåˆ—ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä¸¤ä¸ª CPU ä¸Šçš„çº¿ç¨‹åŒæ—¶è¿›å…¥è¿™ä¸ªä¾‹ç¨‹ã€‚å¦‚æœçº¿ç¨‹ 1 æ‰§è¡Œäº†ç¬¬ä¸€è¡Œï¼Œå®ƒçš„ tmp å˜é‡ä¸­å°†å­˜å‚¨ head çš„å½“å‰å€¼ï¼›å¦‚æœçº¿ç¨‹ 2 ä¹Ÿæ‰§è¡Œäº†ç¬¬ä¸€è¡Œï¼Œå®ƒçš„ç§æœ‰ tmp å˜é‡ä¸­ä¹Ÿå°†å­˜å‚¨ head çš„ç›¸åŒå€¼ï¼ˆtmp åœ¨æ ˆä¸­åˆ†é…ï¼Œå› æ­¤æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç§æœ‰å­˜å‚¨ç©ºé—´ï¼‰ã€‚è¿™æ ·ï¼Œæ¯ä¸ªçº¿ç¨‹å°±ä¸ä¼šä»åˆ—è¡¨å¤´éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ äº†ï¼Œè€Œæ˜¯å°è¯•åˆ é™¤è¿™ç›¸åŒçš„å¤´å…ƒç´ ï¼Œå°±ä¼šå¯¼è‡´å„ç§é—®é¢˜ï¼ˆä¾‹å¦‚ç¬¬ 4 è¡Œä¸­è¯•å›¾å¯¹å¤´éƒ¨å…ƒç´ è¿›è¡ŒåŒé‡é‡Šæ”¾ï¼Œä»¥åŠå¯èƒ½ä¸¤æ¬¡è¿”å›ç›¸åŒçš„æ•°æ®å€¼ï¼‰ã€‚ typedef struct __Node_t { int value; struct __Node_t *next; } Node_t; int List_Pop() { Node_t *tmp = head; // remember old head ... int value = head-\u003evalue; // ... and its value head = head-\u003enext; // advance head to next pointer free(tmp); // free old head return value; // return value at head } å½“ç„¶ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡é”å®šæ¥ä½¿æ­¤ç±»ä¾‹ç¨‹æ­£ç¡®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ†é…ä¸€ä¸ªç®€å•çš„äº’æ–¥ä½“ï¼ˆä¾‹å¦‚ï¼Œpthread mutex t m;ï¼‰ï¼Œç„¶ååœ¨ä¾‹ç¨‹çš„å¼€å¤´æ·»åŠ ä¸€ä¸ª lock(\u0026m) å¹¶åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ª unlock(\u0026m) å°†è§£å†³é—®é¢˜ï¼Œç¡®ä¿ä»£ç èƒ½å¤Ÿæ‰§è¡Œå¦‚é¢„æœŸçš„ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬å°†çœ‹åˆ°çš„ï¼Œè¿™ç§æ–¹æ³•å¹¶éæ²¡æœ‰é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨æ€§èƒ½æ–¹é¢ã€‚å…·ä½“æ¥è¯´ï¼Œéšç€CPUæ•°é‡çš„å¢åŠ ï¼Œå¯¹åŒæ­¥å…±äº«æ•°æ®ç»“æ„çš„è®¿é—®å˜å¾—ç›¸å½“æ…¢ã€‚ pthread_mutex_t m; typedef struct __Node_t { int value; struct __Node_t *next; } Node_t; int List_Pop() { lock(\u0026m); Node_t *tmp = head; // remember old head ... int value = head-\u003evalue; // ... and its value head = head-\u003enext; // advance head to next pointer free(tmp); // free old head unlock(\u0026m); return value; // return value at head } ","date":"2024-04-25","objectID":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/:2:0","tags":["OS"],"title":"å¤šCPUè°ƒåº¦","uri":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 æœ€åä¸€ä¸ªé—®é¢˜ï¼šç¼“å­˜äº²å’Œæ€§ æœ€åä¸€ä¸ªé—®é¢˜æ˜¯åœ¨æ„å»ºå¤šå¤„ç†å™¨ç¼“å­˜è°ƒåº¦ç¨‹åºæ—¶å‡ºç°çš„ï¼Œç§°ä¸ºç¼“å­˜äº²å’Œæ€§ã€‚è¿™ä¸ªæ¦‚å¿µå¾ˆç®€å•ï¼šè¿›ç¨‹åœ¨ç‰¹å®š CPU ä¸Šè¿è¡Œæ—¶ï¼Œä¼šåœ¨ CPU çš„ç¼“å­˜ï¼ˆå’Œ TLBï¼‰ä¸­æ„å»ºç›¸å½“å¤šçš„çŠ¶æ€ã€‚ä¸‹ä¸€æ¬¡è¿›ç¨‹è¿è¡Œæ—¶ï¼Œåœ¨åŒä¸€ä¸ª CPU ä¸Šè¿è¡Œå®ƒé€šå¸¸æ˜¯æœ‰åˆ©çš„ï¼Œå› ä¸ºå¦‚æœå®ƒçš„æŸäº›çŠ¶æ€å·²ç»å­˜åœ¨äºè¯¥ CPU ä¸Šçš„ç¼“å­˜ä¸­ï¼Œé‚£ä¹ˆå®ƒä¼šè¿è¡Œå¾—æ›´å¿«ã€‚ç›¸åï¼Œå¦‚æœæ¯æ¬¡åœ¨ä¸åŒçš„ CPU ä¸Šè¿è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œåˆ™è¯¥è¿›ç¨‹çš„æ€§èƒ½ä¼šæ›´å·®ï¼Œå› ä¸ºæ¯æ¬¡è¿è¡Œæ—¶éƒ½å¿…é¡»é‡æ–°åŠ è½½çŠ¶æ€ï¼ˆæ³¨æ„ï¼Œç”±äºç¡¬ä»¶çš„ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼Œå®ƒå¯ä»¥åœ¨ä¸åŒçš„ CPU ä¸Šæ­£å¸¸è¿è¡Œï¼‰ã€‚å› æ­¤ï¼Œå¤šå¤„ç†å™¨è°ƒåº¦ç¨‹åºåœ¨åšå‡ºè°ƒåº¦å†³ç­–æ—¶åº”è€ƒè™‘ç¼“å­˜å…³è”æ€§ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œå¯èƒ½æ›´æ„¿æ„å°†è¿›ç¨‹ä¿ç•™åœ¨åŒä¸€ CPU ä¸Šã€‚ ","date":"2024-04-25","objectID":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/:3:0","tags":["OS"],"title":"å¤šCPUè°ƒåº¦","uri":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 Single queue Multiprocessor Scheduling (SQMS) æœ‰äº†è¿™ä¸ªèƒŒæ™¯ï¼Œæˆ‘ä»¬ç°åœ¨è®¨è®ºå¦‚ä½•ä¸ºå¤šå¤„ç†å™¨ç³»ç»Ÿæ„å»ºè°ƒåº¦ç¨‹åºã€‚æœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯ç®€å•åœ°é‡ç”¨å•å¤„ç†å™¨è°ƒåº¦çš„åŸºæœ¬æ¡†æ¶ï¼Œå°†æ‰€æœ‰éœ€è¦è°ƒåº¦çš„ä½œä¸šæ”¾å…¥å•ä¸ªé˜Ÿåˆ—ä¸­ï¼›æˆ‘ä»¬å°†æ­¤ç§°ä¸ºå•é˜Ÿåˆ—å¤šå¤„ç†å™¨è°ƒåº¦æˆ–ç®€ç§°ä¸º SQMSã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼›ä¸éœ€è¦å¤ªå¤šå·¥ä½œå°±å¯ä»¥é‡‡ç”¨ç°æœ‰ç­–ç•¥æ¥é€‰æ‹©æ¥ä¸‹æ¥è¿è¡Œçš„æœ€ä½³ä½œä¸šï¼Œå¹¶å°†å…¶è°ƒæ•´ä¸ºåœ¨å¤šä¸ª CPU ä¸Šå·¥ä½œï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸¤ä¸ª CPUï¼Œå®ƒå¯èƒ½ä¼šé€‰æ‹©æœ€å¥½çš„ä¸¤ä¸ªä½œä¸šæ¥è¿è¡Œï¼‰ ã€‚ ç„¶è€Œï¼ŒSQMS ä¹Ÿæœ‰æ˜æ˜¾çš„ç¼ºç‚¹ã€‚ ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ç¼ºä¹å¯æ‰©å±•æ€§ã€‚ä¸ºäº†ç¡®ä¿è°ƒåº¦ç¨‹åºåœ¨å¤šä¸ª CPU ä¸Šæ­£å¸¸å·¥ä½œï¼Œå¼€å‘äººå‘˜å°†åœ¨ä»£ç ä¸­æ’å…¥æŸç§å½¢å¼çš„é”ï¼Œå¦‚ä¸Šæ‰€è¿°ã€‚é”ç¡®ä¿å½“ SQMS ä»£ç è®¿é—®å•ä¸ªé˜Ÿåˆ—ï¼ˆä¾‹å¦‚ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ä½œä¸šï¼‰æ—¶ï¼Œä¼šå‡ºç°æ­£ç¡®çš„ç»“æœã€‚ä½†é”ä¼šå¤§å¤§é™ä½æ€§èƒ½ï¼Œå°¤å…¶æ˜¯å½“ç³»ç»Ÿä¸­çš„ CPU æ•°é‡å¢åŠ ã€‚éšç€å¯¹å•ä¸ªé”çš„äº‰å¤ºå¢åŠ ï¼Œç³»ç»ŸèŠ±åœ¨é”å¼€é”€ä¸Šçš„æ—¶é—´è¶Šæ¥è¶Šå¤šï¼Œè€ŒèŠ±åœ¨ç³»ç»Ÿæœ¬åº”å®Œæˆçš„å·¥ä½œä¸Šçš„æ—¶é—´å´è¶Šæ¥è¶Šå°‘ã€‚ SQMS çš„ç¬¬äºŒä¸ªä¸»è¦é—®é¢˜æ˜¯ç¼“å­˜äº²å’Œæ€§ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰äº”ä¸ªä½œä¸šï¼ˆAã€Bã€Cã€Dã€Eï¼‰å’Œå››ä¸ªå¤„ç†å™¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„è°ƒåº¦é˜Ÿåˆ—çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå‡è®¾æ¯ä¸ªä½œä¸šè¿è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œç„¶åé€‰æ‹©å¦ä¸€ä¸ªä½œä¸šï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå¯èƒ½çš„è·¨ CPU ä½œä¸šæ—¶é—´è¡¨ï¼š ç”±äºæ¯ä¸ª CPU åªéœ€ä»å…¨å±€å…±äº«é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ä½œä¸šï¼Œå› æ­¤æ¯ä¸ªä½œä¸šæœ€ç»ˆéƒ½ä¼šåœ¨ CPU ä¹‹é—´æ¥å›è·³è½¬ï¼Œè¿™ä¸ç¼“å­˜äº²å’Œæ€§çš„è§‚ç‚¹æ°æ°ç›¸åã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¤§å¤šæ•° SQMS è°ƒåº¦å™¨éƒ½åŒ…å«æŸç§äº²å’Œæ€§æœºåˆ¶ï¼Œä»¥å°½å¯èƒ½ä½¿è¿›ç¨‹æ›´æœ‰å¯èƒ½ç»§ç»­åœ¨åŒä¸€ CPU ä¸Šè¿è¡Œã€‚å…·ä½“æ¥è¯´ï¼Œè°ƒåº¦å™¨å¯èƒ½ä¼šä¸ºæŸäº›ä½œä¸šæä¾›äº²å’Œæ€§ï¼Œä½†ä¼šç§»åŠ¨å…¶ä»–ä½œä¸šä»¥å¹³è¡¡è´Ÿè½½ã€‚ä¾‹å¦‚ï¼Œè®¾æƒ³åŒæ ·çš„äº”ä¸ªå·¥ä½œè°ƒåº¦å¦‚ä¸‹ï¼š åœ¨è¿™ç§å®‰æ’ä¸‹ï¼Œä½œä¸š A åˆ° D ä¸ä¼šè·¨å¤„ç†å™¨è¿ç§»ï¼Œåªæœ‰ä½œä¸š E ä¼šä» CPU è¿ç§»åˆ° CPUï¼Œä»è€Œä¿ç•™äº†å¤§éƒ¨åˆ†çš„äº²å’Œæ€§ã€‚ç„¶åï¼Œä½ å¯ä»¥å†³å®šåœ¨ä¸‹ä¸€æ¬¡è¿ç§»æ—¶è¿ç§»ä¸åŒçš„ä½œä¸šï¼Œä»è€Œå®ç°æŸç§äº²å’Œæ€§å…¬å¹³æ€§ã€‚ä¸è¿‡ï¼Œå®æ–½è¿™æ ·çš„æ–¹æ¡ˆå¯èƒ½ä¼šå¾ˆå¤æ‚ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° SQMS æ–¹æ³•æœ‰å…¶ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚å¯¹äºç°æœ‰çš„å• CPU è°ƒåº¦å™¨ï¼ˆé¡¾åæ€ä¹‰ï¼Œå®ƒåªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼‰æ¥è¯´ï¼Œå®ƒå¯ä»¥ç›´æ¥å®æ–½ã€‚ä½†æ˜¯ï¼Œå®ƒçš„æ‰©å±•æ€§ä¸ä½³ï¼ˆç”±äºåŒæ­¥å¼€é”€ï¼‰ï¼Œè€Œä¸”ä¸èƒ½è½»æ˜“ä¿ç•™é«˜é€Ÿç¼“å­˜äº²å’Œæ€§ã€‚ ","date":"2024-04-25","objectID":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/:4:0","tags":["OS"],"title":"å¤šCPUè°ƒåº¦","uri":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 Multi-queue Multiprocessor Scheduling (MQMS) ç”±äºå•é˜Ÿåˆ—è°ƒåº¦å™¨æ‰€å¸¦æ¥çš„é—®é¢˜ï¼Œä¸€äº›ç³»ç»Ÿé€‰æ‹©äº†å¤šé˜Ÿåˆ—ï¼Œä¾‹å¦‚æ¯ä¸ª CPU ä¸€ä¸ªé˜Ÿåˆ—ã€‚æˆ‘ä»¬ç§°è¿™ç§æ–¹æ³•ä¸ºå¤šé˜Ÿåˆ—å¤šå¤„ç†å™¨è°ƒåº¦ï¼ˆæˆ– MQMSï¼‰ã€‚ åœ¨ MQMS ä¸­ï¼Œæˆ‘ä»¬çš„åŸºæœ¬è°ƒåº¦æ¡†æ¶ç”±å¤šä¸ªè°ƒåº¦é˜Ÿåˆ—ç»„æˆã€‚æ¯ä¸ªé˜Ÿåˆ—éƒ½å¯èƒ½éµå¾ªç‰¹å®šçš„è°ƒåº¦è§„åˆ™ï¼Œå¦‚å¾ªç¯è°ƒåº¦ï¼ˆRRï¼‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»ä½•ç®—æ³•ã€‚å½“ä½œä¸šè¿›å…¥ç³»ç»Ÿæ—¶ï¼Œä¼šæ ¹æ®æŸç§å¯å‘å¼ï¼ˆå¦‚éšæœºï¼Œæˆ–æŒ‘é€‰ä½œä¸šæ•°é‡å°‘äºå…¶ä»–é˜Ÿåˆ—çš„é˜Ÿåˆ—ï¼‰ï¼Œå°†å…¶æ°å¥½ç½®äºä¸€ä¸ªè°ƒåº¦é˜Ÿåˆ—ä¸­ã€‚ç„¶åï¼Œå®ƒåŸºæœ¬ä¸Šè¢«ç‹¬ç«‹è°ƒåº¦ï¼Œä»è€Œé¿å…äº†å•é˜Ÿåˆ—æ–¹æ³•ä¸­çš„ä¿¡æ¯å…±äº«å’ŒåŒæ­¥é—®é¢˜ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ç³»ç»Ÿä¸­åªæœ‰ä¸¤ä¸ª CPUï¼ˆCPU 0 å’Œ CPU 1ï¼‰ï¼Œæœ‰è‹¥å¹²ä½œä¸šè¿›å…¥ç³»ç»Ÿï¼šä¾‹å¦‚ Aã€Bã€C å’Œ Dã€‚é‰´äºæ¯ä¸ª CPU ç°åœ¨éƒ½æœ‰ä¸€ä¸ªè°ƒåº¦é˜Ÿåˆ—ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»å†³å®šå°†æ¯ä¸ªä½œä¸šæ”¾å…¥å“ªä¸ªé˜Ÿåˆ—ã€‚æ“ä½œç³»ç»Ÿå¯èƒ½ä¼šè¿™æ ·åšï¼š æ ¹æ®é˜Ÿåˆ—è°ƒåº¦ç­–ç•¥çš„ä¸åŒï¼Œç°åœ¨æ¯ä¸ª CPU åœ¨å†³å®šè¿è¡Œä»€ä¹ˆä½œä¸šæ—¶éƒ½æœ‰ä¸¤ä¸ªä½œä¸šå¯ä¾›é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé‡‡ç”¨å¾ªç¯è°ƒåº¦ï¼Œç³»ç»Ÿå¯èƒ½ä¼šäº§ç”Ÿå¦‚ä¸‹è°ƒåº¦ï¼š ä¸ SQMS ç›¸æ¯”ï¼ŒMQMS æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ä¼˜åŠ¿ï¼Œé‚£å°±æ˜¯å®ƒæœ¬è´¨ä¸Šæ›´å…·å¯æ‰©å±•æ€§ã€‚éšç€ CPU æ•°é‡çš„å¢åŠ ï¼Œé˜Ÿåˆ—çš„æ•°é‡ä¹Ÿä¼šå¢åŠ ï¼Œå› æ­¤é”å’Œç¼“å­˜äº‰ç”¨ä¸ä¼šæˆä¸ºæ ¸å¿ƒé—®é¢˜ã€‚æ­¤å¤–ï¼ŒMQMS æœ¬èº«è¿˜æä¾›ç¼“å­˜äº²å’Œæ€§ï¼Œè¿™äº›å·¥ä½œéƒ½åœ¨åŒä¸€ä¸ª CPU ä¸Šè¿è¡Œï¼Œå› æ­¤å¯ä»¥è·å¾—é‡å¤ä½¿ç”¨å…¶ä¸­ç¼“å­˜å†…å®¹çš„ä¼˜åŠ¿ã€‚ ä½†æ˜¯ï¼Œä½ å¯èƒ½ä¼šå‘ç°æˆ‘ä»¬é‡åˆ°äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯åŸºäºå¤šé˜Ÿåˆ—æ–¹æ³•çš„åŸºæœ¬é—®é¢˜ï¼šè´Ÿè½½ä¸å¹³è¡¡ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸ä¸Šè¿°ç›¸åŒçš„è®¾ç½®ï¼ˆå››ä¸ªå·¥ä½œã€ä¸¤ä¸ª CPUï¼‰ï¼Œä½†å…¶ä¸­ä¸€ä¸ªå·¥ä½œï¼ˆæ¯”å¦‚ Cï¼‰å®Œæˆäº†ã€‚ç°åœ¨æˆ‘ä»¬æœ‰ä»¥ä¸‹è°ƒåº¦é˜Ÿåˆ—ï¼š å¦‚æœæˆ‘ä»¬åœ¨ç³»ç»Ÿçš„æ¯ä¸ªé˜Ÿåˆ—ä¸Šè¿è¡Œè½®å¾ªç­–ç•¥ï¼Œå°±ä¼šçœ‹åˆ°è¿™æ ·çš„è°ƒåº¦è¡¨ï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒA è·å¾—çš„ CPU èµ„æºæ˜¯ B å’Œ D çš„ä¸¤å€ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚æ›´ç³Ÿçš„æ˜¯ï¼Œå‡è®¾ A å’Œ C éƒ½å®Œæˆäº†å·¥ä½œï¼Œç³»ç»Ÿä¸­åªå‰©ä¸‹å·¥ä½œ B å’Œ Dã€‚è°ƒåº¦é˜Ÿåˆ—å°†å¦‚ä¸‹æ‰€ç¤ºï¼š å› æ­¤ï¼ŒCPU 0 å°†å¤„äºé—²ç½®çŠ¶æ€ï¼ é‚£ä¹ˆï¼Œå…³é”®æ˜¯æ€ä¹ˆè§£å†³è´Ÿè½½ä¸å‡è¡¡çš„é—®é¢˜å‘¢ï¼ŸMQMSåº”å¦‚ä½•å¤„ç†è´Ÿè½½ä¸å¹³è¡¡é—®é¢˜ï¼Œä»è€Œæ›´å¥½åœ°å®ç°é¢„æœŸè°ƒåº¦ç›®æ ‡ï¼Ÿ å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæ˜¾è€Œæ˜“è§çš„ç­”æ¡ˆå°±æ˜¯ç§»åŠ¨ä½œä¸šï¼Œæˆ‘ä»¬ï¼ˆå†æ¬¡ï¼‰å°†è¿™ç§æŠ€æœ¯ç§°ä¸ºè¿ç§»ã€‚é€šè¿‡å°†ä½œä¸šä»ä¸€ä¸ª CPU è¿ç§»åˆ°å¦ä¸€ä¸ª CPUï¼Œå¯ä»¥å®ç°çœŸæ­£çš„è´Ÿè½½å¹³è¡¡ã€‚è®©æˆ‘ä»¬çœ‹å‡ ä¸ªä¾‹å­æ¥è¿›ä¸€æ­¥è¯´æ˜ã€‚æˆ‘ä»¬å†ä¸€æ¬¡é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼šä¸€ä¸ª CPU ç©ºé—²ï¼Œå¦ä¸€ä¸ª CPU æœ‰ä¸€äº›ä½œä¸šã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€éœ€çš„è¿ç§»å¾ˆå®¹æ˜“ç†è§£ï¼šæ“ä½œç³»ç»Ÿåªéœ€å°† B æˆ– D ä¸­çš„ä¸€ä¸ªè¿ç§»åˆ° CPU 0ã€‚ è¿™ç§å•ä¸€ä½œä¸šè¿ç§»çš„ç»“æœæ˜¯è´Ÿè½½å‡è¡¡ï¼Œå¤§å®¶éƒ½å¾ˆé«˜å…´ã€‚ åœ¨æˆ‘ä»¬ä¹‹å‰çš„ç¤ºä¾‹ä¸­å‡ºç°äº†ä¸€ä¸ªæ›´æ£˜æ‰‹çš„æƒ…å†µï¼Œå…¶ä¸­ A å•ç‹¬ç•™åœ¨ CPU 0 ä¸Šï¼Œè€Œ B å’Œ D äº¤æ›¿å‡ºç°åœ¨ CPU 1 ä¸Šï¼š åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€æ¬¡è¿ç§»å¹¶ä¸èƒ½è§£å†³é—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è¿ç»­è¿ç§»ä¸€ä¸ªæˆ–å¤šä¸ªå·¥ä½œã€‚ä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸æ–­åˆ‡æ¢å·¥ä½œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚åœ¨å›¾ä¸­ï¼Œé¦–å…ˆ A å•ç‹¬è¿è¡Œåœ¨ CPU 0 ä¸Šï¼ŒB å’Œ D äº¤æ›¿è¿è¡Œåœ¨ CPU 1 ä¸Šã€‚å‡ ä¸ªæ—¶é—´ç‰‡åï¼ŒB è¢«è½¬ç§»åˆ° CPU 0 ä¸Šä¸ A ç«äº‰ï¼Œè€Œ D åˆ™åœ¨ CPU 1 ä¸Šå•ç‹¬è¿è¡Œå‡ ä¸ªæ—¶é—´ç‰‡ã€‚è¿™æ ·ï¼Œè´Ÿè½½å°±å¹³è¡¡äº†ï¼š å½“ç„¶ï¼Œè¿˜å­˜åœ¨è®¸å¤šå…¶ä»–å¯èƒ½çš„è¿ç§»æ¨¡å¼ã€‚ä½†ç°åœ¨æ˜¯æ£˜æ‰‹çš„éƒ¨åˆ†ï¼šç³»ç»Ÿåº”è¯¥å¦‚ä½•å†³å®šå®æ–½è¿™æ ·çš„è¿ç§»ï¼Ÿ ä¸€ç§åŸºæœ¬æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ç§ç§°ä¸ºå·¥ä½œçªƒå–ï¼ˆwork stealingï¼‰çš„æŠ€æœ¯ã€‚é€šè¿‡å·¥ä½œçªƒå–æ–¹æ³•ï¼Œä½œä¸šé‡è¾ƒä½çš„ï¼ˆæºï¼‰é˜Ÿåˆ—å¶å°”ä¼šæŸ¥çœ‹å¦ä¸€ä¸ªï¼ˆç›®æ ‡ï¼‰é˜Ÿåˆ—ï¼Œçœ‹çœ‹å®ƒæœ‰å¤šæ»¡ã€‚å¦‚æœç›®æ ‡é˜Ÿåˆ—ï¼ˆç‰¹åˆ«æ˜¯ï¼‰æ¯”æºé˜Ÿåˆ—æ›´æ»¡ï¼Œåˆ™æºé˜Ÿåˆ—å°†ä»ç›®æ ‡â€œçªƒå–â€ä¸€ä¸ªæˆ–å¤šä¸ªä½œä¸šä»¥å¸®åŠ©å¹³è¡¡è´Ÿè½½ã€‚ å½“ç„¶ï¼Œè¿™ç§æ–¹æ³•è‡ªç„¶ä¼šäº§ç”ŸçŸ›ç›¾ã€‚å¦‚æœè¿‡äºé¢‘ç¹åœ°æŸ¥çœ‹å…¶ä»–é˜Ÿåˆ—ï¼Œå°±ä¼šé€ æˆé«˜å¼€é”€å’Œæ‰©å±•å›°éš¾ï¼Œè€Œå®æ–½å¤šé˜Ÿåˆ—è°ƒåº¦çš„ç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ï¼å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä¸ç»å¸¸æŸ¥çœ‹å…¶ä»–é˜Ÿåˆ—ï¼Œå°±æœ‰å¯èƒ½å‡ºç°ä¸¥é‡çš„è´Ÿè½½ä¸å¹³è¡¡ã€‚åœ¨ç³»ç»Ÿç­–ç•¥è®¾è®¡ä¸­ï¼Œæ‰¾åˆ°åˆé€‚çš„é˜ˆå€¼ä»ç„¶æ˜¯ä¸€é—¨é»‘ç§‘æŠ€ã€‚ ","date":"2024-04-25","objectID":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/:5:0","tags":["OS"],"title":"å¤šCPUè°ƒåº¦","uri":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 Linux å¤šå¤„ç†å™¨è°ƒåº¦å™¨ æœ‰è¶£çš„æ˜¯ï¼ŒLinux ç¤¾åŒºåœ¨æ„å»ºå¤šå¤„ç†å™¨è°ƒåº¦ç¨‹åºæ–¹é¢æ²¡æœ‰é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå‡ºç°äº†ä¸‰ç§ä¸åŒçš„è°ƒåº¦å™¨ï¼š O(1)è°ƒåº¦å™¨ åŸºäºä¼˜å…ˆçº§çš„è°ƒåº¦ç¨‹åº ä½¿ç”¨å¤šé˜Ÿåˆ—ï¼ˆç±»ä¼¼äºMLFQï¼‰ éšç€æ—¶é—´çš„æ¨ç§»æ”¹å˜æµç¨‹çš„ä¼˜å…ˆçº§ è°ƒåº¦ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹ äº¤äº’æ€§æ˜¯å…³æ³¨çš„é‡ç‚¹ å®Œå…¨å…¬å¹³è°ƒåº¦å™¨ï¼ˆCFSï¼‰ ä½¿ç”¨å¤šé˜Ÿåˆ— ç¡®å®šæ€§æ¯”ä¾‹ä»½é¢æ–¹æ³• åŸºäºé˜¶æ¢¯æˆªæ­¢æ—¥æœŸï¼ˆå…¬å¹³æ˜¯é‡ç‚¹ï¼‰ çº¢é»‘æ ‘å¯æ‰©å±•æ€§ BFè°ƒåº¦å™¨ï¼ˆBFSï¼‰ å•é˜Ÿåˆ—è°ƒåº¦æ–¹æ³• ä½¿ç”¨æ¯”ä¾‹ä»½é¢æ–¹æ³• åŸºäºæœ€æ—©ç¬¦åˆæ¡ä»¶çš„è™šæ‹Ÿæˆªæ­¢æ—¶é—´ä¼˜å…ˆï¼ˆEEVDFï¼‰ ä¾§é‡äºäº¤äº’å¼ï¼ˆä¸èƒ½å¾ˆå¥½åœ°æ‰©å±•å†…æ ¸ï¼‰ã€‚å·²è¢« MuQSS å–ä»£ï¼Œä»¥è§£å†³è¿™ä¸€é—®é¢˜ ","date":"2024-04-25","objectID":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/:6:0","tags":["OS"],"title":"å¤šCPUè°ƒåº¦","uri":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 æ€»ç»“ æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¤šç§å¤šå¤„ç†å™¨è°ƒåº¦æ–¹æ³•ã€‚å•é˜Ÿåˆ—æ–¹æ³• (SQMS) æ„å»ºèµ·æ¥ç›¸å½“ç®€å•ï¼Œå¹¶ä¸”å¯ä»¥å¾ˆå¥½åœ°å¹³è¡¡è´Ÿè½½ï¼Œä½†æœ¬è´¨ä¸Šéš¾ä»¥æ‰©å±•åˆ°è®¸å¤šå¤„ç†å™¨å’Œç¼“å­˜äº²å’ŒåŠ›ã€‚å¤šé˜Ÿåˆ—æ–¹æ³•ï¼ˆMQMSï¼‰å¯æ‰©å±•æ€§æ›´å¥½ï¼Œå¹¶ä¸”å¯ä»¥å¾ˆå¥½åœ°å¤„ç†ç¼“å­˜äº²å’Œæ€§ï¼Œä½†å­˜åœ¨è´Ÿè½½ä¸å¹³è¡¡çš„é—®é¢˜ï¼Œå¹¶ä¸”æ›´å¤æ‚ã€‚æ— è®ºæ‚¨é‡‡ç”¨å“ªç§æ–¹æ³•ï¼Œéƒ½æ²¡æœ‰ç®€å•çš„ç­”æ¡ˆï¼šæ„å»ºé€šç”¨è°ƒåº¦å™¨ä»ç„¶æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ï¼Œå› ä¸ºå°çš„ä»£ç æ›´æ”¹å¯èƒ½ä¼šå¯¼è‡´å¤§çš„è¡Œä¸ºå·®å¼‚ã€‚ ","date":"2024-04-25","objectID":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/:7:0","tags":["OS"],"title":"å¤šCPUè°ƒåº¦","uri":"/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¸€ç§ä¸åŒç±»å‹çš„è°ƒåº¦å™¨ï¼Œç§°ä¸ºæ¯”ä¾‹ä»½é¢ï¼ˆProportional-shareï¼‰è°ƒåº¦å™¨ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºå…¬å¹³å…±äº«è°ƒåº¦å™¨ã€‚æ¯”ä¾‹å…±äº«åŸºäºä¸€ä¸ªç®€å•çš„æ¦‚å¿µï¼šè°ƒåº¦å™¨å¯èƒ½ä¼šå°è¯•ä¿è¯æ¯ä¸ªä½œä¸šè·å¾—ä¸€å®šç™¾åˆ†æ¯”çš„ CPU æ—¶é—´ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å‘¨è½¬æ—¶é—´æˆ–å“åº”æ—¶é—´è¿›è¡Œä¼˜åŒ–ã€‚ æ¯”ä¾‹ä»½é¢è°ƒåº¦æœ‰ä¸€ä¸ªéå¸¸å‡ºè‰²çš„æ—©æœŸä¾‹å­æ˜¯å½©ç¥¨è°ƒåº¦ï¼ˆlottery schedulingï¼‰ï¼Œç”± Waldspurger å’Œ Weihl å‘ç°ã€‚å…¶åŸºæœ¬æ€æƒ³éå¸¸ç®€å•ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œå°±ä¼šä¸¾è¡Œä¸€æ¬¡å½©ç¥¨æŠ½å¥–ï¼Œæ¥ç¡®å®šæ¥ä¸‹æ¥è¯¥è¿è¡Œå“ªä¸ªè¿›ç¨‹ã€‚æ›´é¢‘ç¹è¿è¡Œçš„è¿›ç¨‹åˆ™æ›´æœ‰æœºä¼šä¸­å¥–ã€‚ åœ¨å¤„ç†ç»†èŠ‚å‰å…ˆæŠ›å‡ºæˆ‘ä»¬çš„å…³é”®é—®é¢˜ï¼šå¦‚ä½•æŒ‰æ¯”ä¾‹å…±äº«CPUï¼Ÿæˆ‘ä»¬å¦‚ä½•è®¾è®¡ä¸€ä¸ªè°ƒåº¦å™¨ä»¥æŒ‰æ¯”ä¾‹å…±äº« CPUï¼Ÿè¿™æ ·åšçš„å…³é”®æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä»¬çš„æ•ˆæœå¦‚ä½•ï¼Ÿ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:0:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 åŸºæœ¬æ¦‚å¿µï¼šå½©ç¥¨ä»£è¡¨ä»½é¢ å½©ç¥¨è°ƒåº¦èƒŒåæ˜¯ä¸€ä¸ªéå¸¸åŸºæœ¬çš„æ¦‚å¿µï¼šå½©ç¥¨æ•°ï¼Œä»£è¡¨äº†è¿›ç¨‹ï¼ˆæˆ–ç”¨æˆ·æˆ–å…¶ä»–ï¼‰å æœ‰æŸä¸ªèµ„æºçš„ä»½é¢ã€‚ä¸€ä¸ªä¸€ä¸ªè¿›ç¨‹æ‹¥æœ‰çš„å½©ç¥¨æ•°å æ€»å½©ç¥¨æ•°çš„ç™¾åˆ†æ¯”ï¼Œå°±æ˜¯å®ƒå æœ‰ç³»ç»Ÿèµ„æºçš„ä»½é¢ã€‚ ä¾‹å¦‚ï¼Œæœ‰ä¸¤ä¸ªè¿›ç¨‹Aå’ŒBï¼Œå…¶ä¸­Aæœ‰75å¼ å½©ç¥¨ï¼Œè€ŒBåªæœ‰25å¼ å½©ç¥¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›Aå æœ‰$75%$çš„CPUï¼ŒBå æœ‰$25%$çš„CPUã€‚ å½©ç¥¨è°ƒåº¦é€šè¿‡æ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆæ¯”å¦‚æ¯ä¸ªæ—¶é—´ç‰‡ï¼‰ä¸¾è¡Œä¸€æ¬¡æŠ½å¥–ï¼Œä»¥æ¦‚ç‡æ–¹å¼ï¼ˆè€Œéç¡®å®šæ–¹å¼ï¼‰å®ç°è¿™ä¸€ç›®æ ‡ã€‚ä¸¾è¡ŒæŠ½å¥–å¾ˆç®€å•ï¼šè°ƒåº¦å™¨å¿…é¡»çŸ¥é“æ€»å…±æœ‰å¤šå°‘å¼ å½©ç¥¨ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæœ‰ 100 å¼ å½©ç¥¨ï¼‰ï¼Œè°ƒåº¦å™¨æ¥ä¸‹æ¥éšæœºæŠ½å–ä¸­å¥–å½©ç¥¨ï¼Œæ˜¯$[0,99]$çš„æ•°å­—ã€‚å‡è®¾ A æŒæœ‰ 0 åˆ° 74 å·å½©ç¥¨ï¼ŒB æŒæœ‰ 75 åˆ° 99 å·å½©ç¥¨ï¼Œä¸­å¥–å½©ç¥¨å°±å†³å®šäº†è¿è¡ŒAæˆ–Bã€‚ç„¶åè°ƒåº¦ç¨‹åºåŠ è½½ä¸­å¥–è¿›ç¨‹çš„çŠ¶æ€ï¼Œå¹¶è¿è¡Œå®ƒã€‚ ä¸‹é¢æ˜¯å½©ç¥¨è°ƒåº¦ç¨‹åºè¾“å‡ºçš„ä¸­å¥–å½©ç¥¨å’Œå¯¹åº”çš„è°ƒåº¦ç»“æœ: 63 85 70 39 76 17 29 41 36 39 10 99 68 83 63 62 43 0 49 49 A A A A A A A A A A A A A A A A B B B B ä»è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå½©ç¥¨è°ƒåº¦çš„éšæœºæ€§å¯¼è‡´äº†ä»æ¦‚ç‡ä¸Šæ»¡è¶³æœŸæœ›çš„æ¯”ä¾‹ï¼Œä½†ä¸èƒ½ç¡®ä¿ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå·¥ä½œ B è¿è¡Œäº† 20 ä¸ªæ—¶é—´ç‰‡ä¸­çš„ 4 ä¸ªï¼Œåªæ˜¯å äº†$20%$ï¼Œè€Œä¸æ˜¯æœŸæœ›çš„$25%$ã€‚ä½†æ˜¯ï¼Œè¿™ä¸¤ä¸ªå·¥ä½œè¿è¡Œå¾—æ—¶é—´è¶Šé•¿ï¼Œå®ƒä»¬å¾—åˆ°çš„ CPU æ—¶é—´æ¯”ä¾‹å°±ä¼šè¶Šæ¥è¿‘æœŸæœ›ã€‚ éšæœºæ€§å†³ç­–æœ‰ä¼˜åŠ¿ä¹Ÿæœ‰åŠ£åŠ¿ï¼š ä¼˜åŠ¿ é¿å…æœ€å·®æƒ…å†µ è½»é‡ï¼Œä¸éœ€è¦è®°å½•è¿‡å¤šçŠ¶æ€ï¼Œä¼ ç»Ÿå…¬å¹³è°ƒåº¦éœ€è¦è®°å½•è¿›ç¨‹çš„å¤§é‡çŠ¶æ€ éšæœºæ–¹æ³•å¾ˆå¿«ï¼Œå†³ç­–ä¹Ÿå¿« åŠ£åŠ¿ ç³»ç»Ÿè¡Œä¸ºå¯èƒ½ä¸å¯é¢„æµ‹ï¼Œå› ä¸ºå®ƒä»¬ä¸å—å…ˆå‰çŠ¶æ€æˆ–è¾“å…¥çš„ç›´æ¥å½±å“ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸€äº›è¿›ç¨‹ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œè€Œå¦ä¸€äº›åˆ™è¿‡çŸ­ã€‚ å¯èƒ½å¯¼è‡´æ€§èƒ½æ³¢åŠ¨ TIPï¼šä½¿ç”¨å½©ç¥¨æ•°ä»£è¡¨ä»½é¢ å½©ç¥¨ï¼ˆå’Œæ­¥å¹…ï¼‰è°ƒåº¦è®¾è®¡ä¸­æœ€å¼ºå¤§ï¼ˆä¹Ÿæ˜¯åŸºæœ¬ï¼‰çš„æœºåˆ¶ä¹‹ä¸€å°±æ˜¯å½©ç¥¨æ•°æœºåˆ¶ã€‚åœ¨è¿™äº›ç¤ºä¾‹ä¸­ï¼Œå½©ç¥¨æ•°ç”¨äºè¡¨ç¤ºè¿›ç¨‹å¯¹ CPU çš„ä»½é¢ï¼Œä½†å…¶åº”ç”¨èŒƒå›´å¯ä»¥æ›´å¹¿æ³›ã€‚ä¾‹å¦‚ï¼Œåœ¨è™šæ‹Ÿæœºç®¡ç†ç¨‹åºè™šæ‹Ÿå†…å­˜ç®¡ç†çš„æœ€æ–°ç ”ç©¶ä¸­ï¼ŒWaldspurger å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å½©ç¥¨æ•°æ¥è¡¨ç¤ºå®¢æˆ·æ“ä½œç³»ç»Ÿçš„å†…å­˜ä»½é¢ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨éœ€è¦ä¸€ç§æœºåˆ¶æ¥ä»£è¡¨ä¸€å®šæ¯”ä¾‹çš„æ‰€æœ‰æƒï¼Œè¿™ä¸ªæ¦‚å¿µå¯èƒ½å°±æ˜¯â€¦â€¦ï¼ˆç­‰ç­‰ï¼‰â€¦â€¦å½©ç¥¨æ•°ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:1:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 å½©ç¥¨æœºåˆ¶ å½©ç¥¨è°ƒåº¦è¿˜æä¾›äº†è®¸å¤šæœºåˆ¶ï¼Œä»¥ä¸åŒçš„æ–¹å¼ï¼ˆæœ‰æ—¶æ˜¯æœ‰ç”¨çš„æ–¹å¼ï¼‰æ“çºµå½©ç¥¨ã€‚ä¸€ç§æœºåˆ¶æ˜¯å½©ç¥¨è´§å¸ï¼ˆticket currencyï¼‰ã€‚è¿™ç§æœºåˆ¶å…è®¸æ‹¥æœ‰ä¸€ç»„å½©ç¥¨çš„ç”¨æˆ·åœ¨è‡ªå·±çš„å·¥ä½œä¸­ä»¥ä»»æ„è´§å¸åˆ†é…å½©ç¥¨ï¼›ç„¶åç³»ç»Ÿä¼šè‡ªåŠ¨å°†æ‰€è¿°è´§å¸è½¬æ¢ä¸ºæ­£ç¡®çš„å…¨å±€å½©ç¥¨ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ç”¨æˆ·Aå’Œç”¨æˆ·Béƒ½æœ‰100å¼ å½©ç¥¨ï¼ŒAæ­£åœ¨è¿è¡Œä¸¤ä¸ªä½œä¸šï¼šA1å’ŒA2ï¼Œç„¶åç”¨ A çš„è´§å¸ç»™å®ƒä»¬æ¯äºº 500 å¼ å½©ç¥¨ï¼ˆæ€»å…± 1000 å¼ ï¼‰ã€‚ç”¨æˆ·Bæ­£åœ¨è¿è¡Œä¸€ä¸ªä½œä¸šï¼Œç„¶åç”¨Bçš„è´§å¸ç»™å®ƒåˆ†é…10å¼ å½©ç¥¨ï¼ˆæ€»å…±10å¼ ï¼‰ã€‚ç³»ç»Ÿå°† A1 å’Œ A2 çš„åˆ†é…ä» A è´§å¸å„ 500 è½¬æ¢ä¸ºå…¨çƒè´§å¸å„ 50ï¼›åŒæ ·ï¼ŒB1çš„10å¼ ç¥¨æŠ˜ç®—ä¸º100å¼ ç¥¨ã€‚ç„¶ååœ¨å…¨çƒå½©ç¥¨è´§å¸ï¼ˆå…± 200 ä¸ªï¼‰ä¸Šè¿›è¡ŒæŠ½ç­¾ï¼Œä»¥å†³å®šå“ªä¸ªå·¥ä½œè¿è¡Œã€‚A1çš„å…·ä½“è®¡ç®—æ–¹æ³•æ˜¯$\\frac{\\text{Ticket}{A1}}{\\text{Ticket}{A1}+\\text{Ticket}{A2}}\\times \\text{Ticket}{A}$ï¼Œå…¶ä»–åŒç†ã€‚ User A -\u003e 500 (A's ticket currency) to A1 -\u003e 50 (global currency) -\u003e 500 (A's ticket currency) to A2 -\u003e 50 (global currency) User B -\u003e 10 (B's ticket currency) to B1 -\u003e 100 (global currency) å¦ä¸€ä¸ªæœ‰ç”¨çš„æœºåˆ¶æ˜¯å½©ç¥¨è½¬è®©ï¼ˆticket transferï¼‰ã€‚é€šè¿‡è½¬è®©ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æš‚æ—¶å°†å…¶å½©ç¥¨è½¬è®©ç»™å¦ä¸€ä¸ªè¿›ç¨‹ã€‚è¿™ç§èƒ½åŠ›åœ¨å®¢æˆ·ç«¯/æœåŠ¡å™¨è®¾ç½®ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå…¶ä¸­å®¢æˆ·ç«¯è¿›ç¨‹å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼Œè¦æ±‚æœåŠ¡å™¨ä»£è¡¨å®¢æˆ·ç«¯æ‰§è¡Œä¸€äº›å·¥ä½œã€‚ä¸ºäº†åŠ å¿«å·¥ä½œé€Ÿåº¦ï¼Œå®¢æˆ·ç«¯å¯ä»¥å°†å½©ç¥¨è½¬è®©ç»™æœåŠ¡å™¨ï¼Œå¹¶å°è¯•æœ€å¤§åŒ–æœåŠ¡å™¨çš„æ€§èƒ½ï¼ŒåŒæ—¶å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å®Œæˆåï¼ŒæœåŠ¡å™¨å°†ç¥¨æ®å½’è¿˜ç»™å®¢æˆ·ç«¯ï¼Œä¸€åˆ‡å¦‚æ—§ã€‚ æœ€åï¼Œå½©ç¥¨é€šèƒ€ï¼ˆticket inflationï¼‰æœºåˆ¶æœ‰æ—¶ä¹Ÿå¾ˆæœ‰ç”¨ã€‚é€šè¿‡é€šè´§è†¨èƒ€ï¼Œè¿›ç¨‹å¯ä»¥æš‚æ—¶å¢åŠ æˆ–å‡å°‘å…¶æ‹¥æœ‰çš„å½©ç¥¨æ•°ã€‚å½“ç„¶ï¼Œåœ¨è¿›ç¨‹ç›¸äº’ä¸ä¿¡ä»»çš„ç«äº‰åœºæ™¯ä¸­ï¼Œè¿™æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼›ä¸€ä¸ªè´ªå©ªçš„è¿›ç¨‹å¯ä»¥ç»™è‡ªå·±å¤§é‡çš„å½©ç¥¨ä»è€Œæ¥ç®¡æœºå™¨ã€‚ä½†æ˜¯ï¼Œé€šèƒ€å¯ä»¥åº”ç”¨äºä¸€ç»„è¿›ç¨‹ç›¸äº’ä¿¡ä»»çš„ç¯å¢ƒä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä»»ä½•ä¸€ä¸ªè¿›ç¨‹çŸ¥é“å®ƒéœ€è¦æ›´å¤šçš„ CPU æ—¶é—´ï¼Œå®ƒå¯ä»¥å¢åŠ è‡ªå·±çš„å½©ç¥¨æ•°ï¼Œä½œä¸ºå‘ç³»ç»Ÿåæ˜ è¯¥éœ€æ±‚çš„ä¸€ç§æ–¹å¼ï¼Œè€Œæ— éœ€ä¸ä»»ä½•å…¶ä»–è¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:2:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 å®ç° å½©ç¥¨è°ƒåº¦æœ€ä»¤äººæƒŠå¹çš„åœ°æ–¹å¯èƒ½å°±æ˜¯å…¶å®æ–½çš„ç®€å•æ€§ã€‚ä½ åªéœ€è¦ä¸€ä¸ªå¥½çš„éšæœºæ•°ç”Ÿæˆå™¨æ¥æŒ‘é€‰ä¸­å¥–å½©ç¥¨ï¼Œä¸€ä¸ªè·Ÿè¸ªç³»ç»Ÿè¿›ç¨‹çš„æ•°æ®ç»“æ„ï¼ˆå¦‚åˆ—è¡¨ï¼‰ï¼Œä»¥åŠå½©ç¥¨æ€»æ•°ã€‚ å‡è®¾æˆ‘ä»¬å°†è¿›ç¨‹ä¿å­˜åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç”± Aã€B å’Œ C ä¸‰ä¸ªè¿›ç¨‹ç»„æˆçš„ç¤ºä¾‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€å®šæ•°é‡çš„å½©ç¥¨æ•°ã€‚ ä¸ºäº†åšå‡ºè°ƒåº¦å†³ç­–ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ä»é—¨ç¥¨æ€»æ•°ï¼ˆ400ï¼‰ ä¸­éšæœºæŠ½å–ä¸€ä¸ªæ•°å­—ï¼ˆä¸­å¥–å·ç ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬åªéœ€éå†åˆ—è¡¨ï¼Œç”¨ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°ä¸­å¥–è€…ã€‚ # counter: used to track if we've found the winner yet counter = 0 # winner: use some call to a random number generator to get a value, between 0 and the total # of tickets winner = random.randint(0, totaltickets) # current: use this to walk through the list of jobs current = head # loop until the sum of ticket values is \u003e the winner while current: counter = counter + current.tickets if counter \u003e winner: break # found the winner current = current.next # 'current' is the winner: schedule it... è¯¥ä»£ç ä»å‰å¾€åéå†è¿›ç¨‹åˆ—è¡¨ï¼Œå°†æ¯ä¸ªå½©ç¥¨å€¼æ·»åŠ åˆ°è®¡æ•°å™¨ä¸­ï¼Œç›´åˆ°è¯¥å€¼è¶…è¿‡è·èƒœè€…ã€‚ä¸€æ—¦å‡ºç°è¿™ç§æƒ…å†µï¼Œå½“å‰åˆ—è¡¨è¿›ç¨‹å°±æ˜¯ä¸­å¥–è€…ã€‚ä»¥ä¸­å¥–å½©ç¥¨ä¸º 300 çš„ç¤ºä¾‹ä¸ºä¾‹ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µã€‚é¦–å…ˆï¼Œè®¡æ•°å™¨å¢åŠ åˆ° 100 ä»¥è®¡ç®— A çš„ç¥¨ï¼›å› ä¸º 100 å°äº 300ï¼Œæ‰€ä»¥å¾ªç¯ç»§ç»­ã€‚ç„¶åè®¡æ•°å™¨ä¼šæ›´æ–°ä¸º 150ï¼ˆB çš„ç¥¨ï¼‰ï¼Œä»ç„¶å°‘äº 300ï¼Œå› æ­¤æˆ‘ä»¬å†æ¬¡ç»§ç»­ã€‚æœ€åï¼Œè®¡æ•°å™¨æ›´æ–°ä¸º 400ï¼ˆæ˜æ˜¾å¤§äº 300ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬è·³å‡ºå¾ªç¯ï¼Œå½“å‰æŒ‡å‘ Cï¼ˆä¸­å¥–è€…ï¼‰ã€‚ è¦è®©è¿™ä¸ªè¿‡ç¨‹æ›´æœ‰æ•ˆç‡ï¼Œå»ºè®®å°†åˆ—è¡¨é¡¹æŒ‰ç…§å½©ç¥¨æ•°é€’å‡æ’åºã€‚è¿™ä¸ªé¡ºåºå¹¶ä¸ä¼šå½±å“ç®—æ³•çš„æ­£ç¡®æ€§ï¼Œä½†èƒ½ä¿è¯ç”¨æœ€å°çš„è¿­ä»£æ¬¡æ•°æ‰¾åˆ°éœ€è¦çš„ç»“ç‚¹ï¼Œå°¤å…¶å½“å¤§å¤šå½©ç¥¨è¢«å°‘æ•°è¿›ç¨‹æŒæ¡æ—¶ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:3:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 è¯„ä¼°æŒ‡æ ‡ ä¸ºäº†æ›´å®¹æ˜“ç†è§£åŠ¨æ€å½©ç¥¨è°ƒåº¦ï¼Œæˆ‘ä»¬ç°åœ¨å¯¹ä¸¤ä¸ªç›¸äº’ç«äº‰çš„ä½œä¸šçš„å®Œæˆæ—¶é—´è¿›è¡Œç®€è¦ç ”ç©¶ï¼Œæ¯ä¸ªä½œä¸šéƒ½æœ‰ç›¸åŒæ•°é‡çš„å½©ç¥¨ (100) å’Œç›¸åŒçš„è¿è¡Œæ—¶é—´ (Rï¼Œæˆ‘ä»¬å°†æ”¹å˜å®ƒ) ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸ªä½œä¸šå¤§è‡´åœ¨åŒä¸€æ—¶é—´å®Œæˆï¼Œä½†ç”±äºå½©ç¥¨è°ƒåº¦çš„éšæœºæ€§ï¼Œæœ‰æ—¶ä¸€ä¸ªä½œä¸šä¼šå…ˆäºå¦ä¸€ä¸ªä½œä¸šå®Œæˆã€‚ä¸ºäº†é‡åŒ–è¿™ç§å·®å¼‚ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„ä¸å…¬å¹³æŒ‡æ ‡ï¼ˆunfairness metricï¼‰ $U$ï¼Œå®ƒå°±æ˜¯ç¬¬ä¸€ä¸ªä½œä¸šå®Œæˆçš„æ—¶é—´é™¤ä»¥ç¬¬äºŒä¸ªä½œä¸šå®Œæˆçš„æ—¶é—´ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœ R = 10ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªä½œä¸šåœ¨ 10 å®Œæˆï¼ˆç¬¬äºŒä¸ªä½œä¸šåœ¨ 20 å®Œæˆï¼‰ï¼Œåˆ™ $U=\\frac{10}{20}=0.5$ã€‚å½“ä¸¤ä¸ªä½œä¸šå‡ ä¹åŒæ—¶å®Œæˆæ—¶ï¼Œ$U$ å°†éå¸¸æ¥è¿‘ 1ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼šå®Œå…¨å…¬å¹³çš„è°ƒåº¦ç¨‹åºå°†å®ç° $U = 1$ã€‚ ä¸‹å›¾æç»˜äº†åœ¨30æ¬¡è¯•éªŒä¸­ï¼Œä¸¤ä¸ªä½œä¸šï¼ˆRï¼‰çš„é•¿åº¦ä»1åˆ°1000ä¸ç­‰æ—¶çš„å¹³å‡ä¸å…¬å¹³æ€§ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“å·¥ä½œæ—¶é—´ä¸é•¿æ—¶ï¼Œå¹³å‡ä¸å…¬å¹³ç°è±¡å¯èƒ½ç›¸å½“ä¸¥é‡ã€‚åªæœ‰å½“ä½œä¸šè¿è¡Œäº†å¤§é‡çš„æ—¶é—´ç‰‡æ—¶ï¼Œå½©ç¥¨è°ƒåº¦ç¨‹åºæ‰èƒ½æ¥è¿‘æ‰€éœ€çš„ç»“æœã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:4:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 å¦‚ä½•åˆ†é…å½©ç¥¨ åœ¨å½©ç¥¨è°ƒåº¦æ–¹é¢ï¼Œæˆ‘ä»¬å°šæœªè§£å†³çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šå¦‚ä½•ä¸ºä½œä¸šåˆ†é…å½©ç¥¨ï¼Ÿè¿™æ˜¯ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼Œå› ä¸ºç³»ç»Ÿå¦‚ä½•è¿è¡Œå½“ç„¶åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå¦‚ä½•åˆ†é…å½©ç¥¨ã€‚ä¸€ç§æ–¹æ³•æ˜¯å‡å®šç”¨æˆ·æœ€äº†è§£æƒ…å†µï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šå¾—åˆ°ä¸€å®šæ•°é‡çš„é—¨ç¥¨ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å°†é—¨ç¥¨åˆ†é…ç»™ä»–ä»¬è¿è¡Œçš„ä»»ä½•ä½œä¸šã€‚ç„¶è€Œï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆä¸æ˜¯è§£å†³æ–¹æ¡ˆï¼šå®ƒå¹¶æ²¡æœ‰å‘Šè¯‰ä½ è¯¥æ€ä¹ˆåšã€‚å› æ­¤ï¼Œåœ¨ç»™å®šä¸€ç³»åˆ—å·¥ä½œçš„æƒ…å†µä¸‹ï¼Œâ€œå½©ç¥¨åˆ†é…é—®é¢˜ â€œä»ç„¶æ‚¬è€Œæœªå†³ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:5:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"6 æ­¥å¹…è°ƒåº¦ ä½ å¯èƒ½è¿˜æƒ³çŸ¥é“ï¼šä¸ºä»€ä¹ˆè¦ä½¿ç”¨éšæœºæ€§å‘¢ï¼Ÿå¦‚ä¸Šæ‰€è¿°ï¼Œè™½ç„¶éšæœºæ€§å¯ä»¥ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªç®€å•ï¼ˆä¸”è¿‘ä¼¼æ­£ç¡®ï¼‰çš„è°ƒåº¦å™¨ï¼Œä½†å®ƒå¶å°”æ— æ³•æä¾›ç²¾ç¡®æ­£ç¡®çš„æ¯”ä¾‹ï¼Œå°¤å…¶æ˜¯åœ¨çŸ­æ—¶é—´å†…ã€‚ä¸ºæ­¤ï¼ŒWaldspurger å‘æ˜äº†ä¸€ç§ç¡®å®šæ€§å…¬å¹³åˆ†é…è°ƒåº¦å™¨â€”æ­¥å¹…è°ƒåº¦å™¨ ã€‚ æ­¥å¹…è°ƒåº¦ä¹Ÿå¾ˆç®€å•ï¼Œç³»ç»Ÿä¸­æ¯ä¸ªä½œä¸šéƒ½æœ‰ä¸€ä¸ªæ­¥å¹…ï¼Œè¿™ä¸å®ƒæ‹¥æœ‰çš„å½©ç¥¨æ•°æˆåæ¯”ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¯¹äºä½œä¸š Aã€B å’Œ Cï¼Œåˆ†åˆ«æœ‰ 100ã€50 å’Œ 250 å¼ å½©ç¥¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æŸä¸ªè¾ƒå¤§çš„æ•°å­—é™¤ä»¥æ¯ä¸ªè¿›ç¨‹åˆ†é…çš„å½©ç¥¨æ•°é‡æ¥è®¡ç®—æ¯ä¸ªä½œä¸šçš„æ­¥å¹…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ 10,000 é™¤ä»¥æ¯ä¸ªå½©ç¥¨å€¼ï¼Œæˆ‘ä»¬å°†è·å¾— Aã€B å’Œ C çš„æ­¥å¹…å€¼ï¼š100ã€200 å’Œ 40ã€‚æˆ‘ä»¬å°†æ­¤å€¼ç§°ä¸ºæ¯ä¸ªè¿›ç¨‹çš„æ­¥å¹…ï¼›æ¯æ¬¡è¿›ç¨‹è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæŒ‰å…¶æ­¥å¹…å¢åŠ å®ƒçš„è®¡æ•°å™¨ï¼ˆç§°ä¸ºå…¶è¡Œç¨‹å€¼ï¼‰ï¼Œä»¥è·Ÿè¸ªå…¶å…¨å±€è¿›åº¦ã€‚ ç„¶åï¼Œè°ƒåº¦ç¨‹åºä½¿ç”¨æ­¥å¹…å’Œè¡Œç¨‹å€¼æ¥ç¡®å®šæ¥ä¸‹æ¥åº”è¯¥è¿è¡Œå“ªä¸ªè¿›ç¨‹ã€‚åŸºæœ¬æ€æƒ³å¾ˆç®€å•ï¼šåœ¨ä»»ä½•ç»™å®šæ—¶é—´ï¼Œé€‰æ‹©è¿„ä»Šä¸ºæ­¢å…·æœ‰æœ€ä½è¡Œç¨‹å€¼çš„è¿›ç¨‹æ¥è¿è¡Œï¼›å½“æ‚¨è¿è¡Œä¸€ä¸ªè¿›ç¨‹æ—¶ï¼ŒæŒ‰å…¶æ­¥å¹…å¢åŠ å…¶è¡Œç¨‹å€¼ã€‚ Waldspurger æä¾›äº†ä¼ªä»£ç å®ç°ï¼š curr = remove_min(queue); // pick client with min pass schedule(curr); // run for quantum curr-\u003epass += curr-\u003estride; // update pass using stride insert(queue, curr); // return curr to queue åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œä¸€å¼€å§‹æœ‰ä¸‰ä¸ªè¿›ç¨‹ï¼ˆAã€B å’Œ Cï¼‰ï¼Œå®ƒä»¬çš„æ­¥å¹…åˆ†åˆ«ä¸º 100ã€200 å’Œ 40ï¼Œæ‰€æœ‰è¿›ç¨‹çš„è¡Œç¨‹å€¼æœ€åˆéƒ½æ˜¯ 0ã€‚å‡è®¾æˆ‘ä»¬é€‰æ‹© Aï¼ˆä»»æ„é€‰æ‹©ï¼›å¯ä»¥é€‰æ‹©ä»»ä½•ä¸€ä¸ªè¡Œç¨‹å€¼åŒæ ·ä½çš„è¿›ç¨‹ï¼‰ã€‚A è¿è¡Œåï¼Œåœ¨å®Œæˆæ—¶é—´ç‰‡åï¼Œæˆ‘ä»¬å°†å…¶è¡Œç¨‹å€¼æ›´æ–°ä¸º 100ã€‚ç„¶åè¿è¡Œ Bï¼Œå°†å…¶è¡Œç¨‹å€¼è®¾ç½®ä¸º 200ã€‚æœ€åè¿è¡Œ Cï¼Œå…¶è¡Œç¨‹å€¼é€’å¢åˆ° 40ã€‚æ­¤æ—¶ï¼Œç®—æ³•å°†é€‰æ‹©æœ€ä½çš„è¡Œç¨‹å€¼ï¼Œå³ Cçš„è¡Œç¨‹å€¼ï¼Œç„¶åè¿è¡ŒCï¼Œå°†å…¶è¡Œç¨‹å€¼æ›´æ–°ä¸º 80ï¼ˆC çš„æ­¥å¹…ä¸º 40ï¼‰ã€‚ç„¶å C å°†å†æ¬¡è¿è¡Œï¼ˆä»ç„¶æ˜¯æœ€ä½çš„è¡Œç¨‹å€¼ï¼‰ï¼Œå°†å…¶è¡Œç¨‹å€¼æå‡è‡³ 120ã€‚A ç°åœ¨è¿è¡Œï¼Œå°†å…¶è¡Œç¨‹å€¼æ›´æ–°ä¸º 200ï¼ˆç°åœ¨ç­‰äº B çš„è¡Œç¨‹å€¼ï¼‰ã€‚ç„¶å C å†è¿è¡Œä¸¤æ¬¡ï¼Œå°†å…¶è¡Œç¨‹å€¼æ›´æ–°ä¸º 160ï¼Œç„¶åæ˜¯ 200ã€‚æ­¤æ—¶ï¼Œæ‰€æœ‰è¡Œç¨‹å€¼å†æ¬¡ç›¸ç­‰ï¼Œè¿™ä¸ªè¿‡ç¨‹å°†æ— é™é‡å¤ã€‚ä¸‹è¡¨è·Ÿè¸ªäº†è°ƒåº¦å™¨éšæ—¶é—´å˜åŒ–çš„è¡Œä¸ºã€‚ Pass(A) Pass(B) Pass(C) Who Runs? 0 0 0 A 100 0 0 B 100 200 0 C 100 200 40 C 100 200 80 C 100 200 120 A 200 200 120 C 200 200 160 C 200 200 200 â€¦ ä»ä¸Šè¡¨å¯ä»¥çœ‹å‡ºï¼ŒCè¿è¡Œäº†5æ¬¡ï¼ŒA2æ¬¡ï¼ŒBåªæœ‰ä¸€æ¬¡ï¼Œæ­£å¥½ä¸å®ƒä»¬çš„å½©ç¥¨å€¼ 250ã€100 å’Œ 50 æˆæ¯”ä¾‹ã€‚å½©ç¥¨è°ƒåº¦æ˜¯éšç€æ—¶é—´çš„æ¨ç§»æ¦‚ç‡æ€§åœ°å®ç°æ¯”ä¾‹çš„ï¼Œè€Œæ­¥å¹…è°ƒåº¦åˆ™æ˜¯åœ¨æ¯ä¸ªè°ƒåº¦å‘¨æœŸç»“æŸæ—¶ç²¾ç¡®åœ°å®ç°æ¯”ä¾‹ã€‚ æ‰€ä»¥ä½ å¯èƒ½æƒ³çŸ¥é“ï¼šè·¨æ­¥è°ƒåº¦è¿™ä¹ˆç²¾å‡†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨å½©ç¥¨è°ƒåº¦å‘¢ï¼Ÿå—¯ï¼Œå½©ç¥¨è°ƒåº¦æœ‰ä¸€ä¸ªæ­¥å¹…è°ƒåº¦æ²¡æœ‰çš„å¥½ç‰¹æ€§ï¼šæ²¡æœ‰å…¨å±€çŠ¶æ€ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸Šé¢çš„è·¨æ­¥è°ƒåº¦ç¤ºä¾‹ä¸­ï¼Œæœ‰ä¸€ä¸ªæ–°ä½œä¸šè¿›å…¥ï¼›å®ƒçš„è¡Œç¨‹å€¼åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿåº”è¯¥è®¾ç½®ä¸º0å—ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œå°±ä¼šç‹¬å CPUã€‚å¯¹äºå½©ç¥¨è°ƒåº¦ï¼Œæ¯ä¸ªè¿›ç¨‹æ²¡æœ‰å…¨å±€çŠ¶æ€ï¼›æˆ‘ä»¬åªéœ€æ·»åŠ ä¸€ä¸ªæ–°è¿›ç¨‹åŠå…¶æ‹¥æœ‰çš„ä»»ä½•å½©ç¥¨ï¼Œæ›´æ–°å•ä¸ªå…¨å±€å˜é‡ä»¥è·Ÿè¸ªæˆ‘ä»¬æ€»å…±æ‹¥æœ‰å¤šå°‘å½©ç¥¨ï¼Œç„¶åä»é‚£é‡Œå¼€å§‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå½©ç¥¨ä»¥åˆç†çš„æ–¹å¼åˆå¹¶æ–°è¿›ç¨‹æ›´åŠ å®¹æ˜“ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:6:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7 Linuxå®Œå…¨å…¬å¹³è°ƒåº¦å™¨ï¼ˆCFSï¼‰ å°½ç®¡åœ¨å…¬å¹³ä»½é¢è°ƒåº¦æ–¹é¢å·²æœ‰æ—©æœŸå·¥ä½œï¼Œä½†å½“å‰çš„Linuxæ–¹æ³•ä»¥å¦ä¸€ç§æ–¹å¼å®ç°äº†ç±»ä¼¼çš„ç›®æ ‡ã€‚åä¸ºå®Œå…¨å…¬å¹³è°ƒåº¦å™¨ï¼ˆæˆ–CFSï¼‰çš„è°ƒåº¦å™¨å®æ–½äº†å…¬å¹³ä»½é¢è°ƒåº¦ï¼Œä½†æ˜¯ä»¥é«˜æ•ˆä¸”å¯æ‰©å±•çš„æ–¹å¼è¿›è¡Œã€‚ ä¸ºäº†å®ç°å…¶æ•ˆç‡ç›®æ ‡ï¼ŒCFSé€šè¿‡å…¶å›ºæœ‰è®¾è®¡å’Œå¯¹ä»»åŠ¡éå¸¸é€‚åˆçš„æ•°æ®ç»“æ„å·§å¦™åœ°ä½¿ç”¨æå°‘æ—¶é—´åšå‡ºè°ƒåº¦å†³ç­–ã€‚æœ€è¿‘ç ”ç©¶è¡¨æ˜ï¼Œè°ƒåº¦å™¨æ•ˆç‡éå¸¸é‡è¦ï¼›å…·ä½“è€Œè¨€ï¼Œåœ¨å¯¹è°·æ­Œæ•°æ®ä¸­å¿ƒè¿›è¡Œç ”ç©¶æ—¶ï¼ŒKanevç­‰äººå‘ç°ï¼Œå³ä½¿ç»è¿‡ç§¯æä¼˜åŒ–ï¼Œè°ƒåº¦ä»ç„¶å ç”¨æ•´ä¸ªæ•°æ®ä¸­å¿ƒçº¦5%çš„CPUæ—¶é—´ã€‚å› æ­¤ï¼Œå°½å¯èƒ½å‡å°‘å¼€é”€æ˜¯ç°ä»£è°ƒåº¦ç¨‹åºæ¶æ„çš„ä¸€ä¸ªå…³é”®ç›®æ ‡ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:7:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.1 åŸºæœ¬æ“ä½œ å¤§å¤šæ•°è°ƒåº¦ç¨‹åºéƒ½åŸºäºå›ºå®šæ—¶é—´ç‰‡çš„æ¦‚å¿µï¼Œè€Œ CFS çš„è¿è¡Œæ–¹å¼åˆ™æœ‰äº›ä¸åŒã€‚å®ƒçš„ç›®æ ‡å¾ˆç®€å•ï¼šå°† CPU å…¬å¹³åœ°å¹³å‡åˆ†é…ç»™æ‰€æœ‰ç«äº‰è¿›ç¨‹ã€‚å®ƒé€šè¿‡ä¸€ç§ç®€å•çš„åŸºäºè®¡æ•°çš„æŠ€æœ¯æ¥å®ç°è¿™ä¸€ç›®æ ‡ï¼Œè¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºè™šæ‹Ÿè¿è¡Œæ—¶é—´ï¼ˆvruntimeï¼‰ã€‚ æ¯ä¸ªè¿›ç¨‹è¿è¡Œæ—¶ï¼Œéƒ½ä¼šç´¯ç§¯vruntimeã€‚åœ¨æœ€åŸºæœ¬çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè¿›ç¨‹çš„ vruntime éƒ½ä»¥ç›¸åŒçš„é€Ÿç‡å¢é•¿ï¼Œä¸ç‰©ç†ï¼ˆå®é™…ï¼‰æ—¶é—´æˆæ¯”ä¾‹ã€‚åœ¨è¿›è¡Œè°ƒåº¦å†³ç­–æ—¶ï¼ŒCFS ä¼šé€‰æ‹© vruntime æœ€ä½çš„è¿›ç¨‹ä½œä¸ºä¸‹ä¸€ä¸ªè¿è¡Œè¿›ç¨‹ã€‚ é‚£è¿™å°±æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šè°ƒåº¦å™¨æ€ä¹ˆçŸ¥é“ä½•æ—¶åœæ­¢æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå¹¶è¿è¡Œä¸‹ä¸€ä¸ªè¿›ç¨‹å‘¢ï¼Ÿè¿™é‡ŒçŸ›ç›¾å°±å¾ˆæ˜æ˜¾ï¼šå¦‚æœ CFS åˆ‡æ¢è¿‡äºé¢‘ç¹ï¼Œå…¬å¹³æ€§å°±ä¼šæé«˜ï¼Œå› ä¸º CFS å°†ç¡®ä¿æ¯ä¸ªè¿›ç¨‹å³ä½¿åœ¨æå°çš„æ—¶é—´çª—å£å†…ä¹Ÿèƒ½è·å¾—å…¶ CPU ä»½é¢ï¼Œä½†ä»£ä»·æ˜¯æ€§èƒ½é™ä½ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢è¿‡å¤šï¼‰ï¼›å¦‚æœ CFS åˆ‡æ¢é¢‘ç‡é™ä½ï¼Œæ€§èƒ½å°±ä¼šæé«˜ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢å‡å°‘ï¼‰ï¼Œä½†ä»£ä»·æ˜¯è¿‘æœŸå…¬å¹³æ€§é™ä½ã€‚ CFSé€šè¿‡å„ç§æ§åˆ¶å‚æ•°æ¥ç®¡ç†è¿™ç§çŸ›ç›¾ã€‚ç¬¬ä¸€ä¸ªæ˜¯sched_latencyï¼ˆè°ƒåº¦å»¶è¿Ÿï¼‰ï¼ŒCFSä½¿ç”¨è¯¥å€¼æ¥ç¡®å®šä¸€ä¸ªè¿›ç¨‹åœ¨è€ƒè™‘åˆ‡æ¢ä¹‹å‰åº”è¿è¡Œå¤šé•¿æ—¶é—´ï¼ˆä»¥åŠ¨æ€æ–¹å¼æœ‰æ•ˆç¡®å®šå…¶æ—¶é—´ç‰‡ï¼‰ã€‚å…¸å‹çš„sched_latencyå€¼ä¸º$48$ï¼ˆæ¯«ç§’ï¼‰ï¼ŒCFS å°†è¯¥å€¼é™¤ä»¥ CPU ä¸Šè¿è¡Œçš„è¿›ç¨‹æ•°ï¼ˆnï¼‰ï¼Œä»¥ç¡®å®šè¿›ç¨‹çš„æ—¶é—´ç‰‡ï¼Œä»è€Œç¡®ä¿åœ¨è¿™æ®µæ—¶é—´å†…ï¼ŒCFS å®Œå…¨å…¬å¹³ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¿™æœ‰$n=4$çš„è¿›ç¨‹åœ¨è¿è¡Œï¼ŒCFSå°†sched_latencyçš„å€¼é™¤ä»¥$n$å¾—å‡ºæ¯ä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡ä¸º$12\\text{ms}$ã€‚ç„¶åï¼ŒCFS ä¼šè°ƒåº¦ç¬¬ä¸€ä¸ªä½œä¸šå¹¶è¿è¡Œå®ƒï¼Œç›´åˆ°ç”¨å®Œ $12\\text{ms}$ çš„ï¼ˆè™šæ‹Ÿï¼‰è¿è¡Œæ—¶é—´ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦æœ‰ vruntime æ›´ä½çš„ä½œä¸šå¯æ›¿ä»£è¿è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæœ‰ï¼ŒCFS å°±ä¼šåˆ‡æ¢åˆ°å…¶ä»–ä¸‰ä¸ªä½œä¸šä¸­çš„ä¸€ä¸ªï¼Œä¾æ­¤ç±»æ¨ã€‚ä¸‹å›¾å±•ç¤ºäº†è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼šå››ä¸ªä½œä¸šï¼ˆAã€Bã€Cã€Dï¼‰ä»¥è¿™ç§æ–¹å¼å„è¿è¡Œä¸¤ä¸ªæ—¶é—´ç‰‡ï¼›å…¶ä¸­ä¸¤ä¸ªä½œä¸šï¼ˆCã€Dï¼‰å®Œæˆåï¼Œåªå‰©ä¸‹ä¸¤ä¸ªä½œä¸šï¼Œç„¶åå®ƒä»¬ä»¥å¾ªç¯æ–¹å¼å„è¿è¡Œ $12\\text{ms}$ã€‚ ä½†å¦‚æœæœ‰ â€œå¤ªå¤š â€œè¿›ç¨‹åœ¨è¿è¡Œå‘¢ï¼Ÿè¿™ä¼šä¸ä¼šå¯¼è‡´æ—¶é—´ç‰‡å¤ªå°ï¼Œä»è€Œå¯¼è‡´å¤ªå¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒCFSå¢åŠ äº†å¦ä¸€ä¸ªå‚æ•°min_granularityï¼Œé€šå¸¸è®¾ç½®ä¸º 6 msã€‚CFSç»ä¸ä¼šè®¾ç½®è¿›ç¨‹çš„æ—¶é—´ç‰‡å°äºå€¼ï¼Œç¡®ä¿ä¸ä¼šåœ¨è°ƒåº¦å¼€é”€ä¸ŠèŠ±è´¹å¤ªå¤šæ—¶é—´ã€‚ ä¾‹å¦‚ï¼Œè¿™æœ‰10ä¸ªè¿›ç¨‹æ­£åœ¨è¿è¡Œï¼Œæˆ‘ä»¬åŸæ¥çš„è®¡ç®—ä¼šç”¨sched_latencyé™¤ä»¥$10$å¾—å‡ºè¿›ç¨‹æ—¶é—´ç‰‡ï¼ˆç»“æœä¸º$4.8\\text{ms}$ï¼‰ã€‚ä½†å› ä¸ºmin_granularityï¼ŒCFSä¼šæ¯ä¸ªè¿›ç¨‹çš„æ—¶é—´ç‰‡è®¾ç½®ä¸º$6\\text{ms}$ã€‚è™½ç„¶ CFS çš„å…¬å¹³æ€§ä¸ä¼šè¶…è¿‡åœ¨ $4.8\\text{ms}$ çš„ç›®æ ‡è°ƒåº¦å»¶è¿Ÿï¼ˆsched_latencyï¼‰ï¼Œä½†å®ƒå°†æ¥è¿‘ç›®æ ‡å€¼ï¼ŒåŒæ—¶ä»èƒ½å®ç°è¾ƒé«˜çš„ CPU æ•ˆç‡ã€‚ éœ€è¦çš„æ³¨æ„æ˜¯ï¼ŒCFS ä½¿ç”¨çš„æ˜¯å‘¨æœŸæ€§å®šæ—¶å™¨ä¸­æ–­ï¼Œè¿™æ„å‘³ç€å®ƒåªèƒ½åœ¨å›ºå®šçš„æ—¶é—´é—´éš”å†…åšå‡ºå†³å®šã€‚è¯¥ä¸­æ–­ä¼šé¢‘ç¹å“èµ·ï¼ˆä¾‹å¦‚ï¼Œæ¯ 1 mså“ä¸€æ¬¡ï¼‰ï¼Œè®© CFS æœ‰æœºä¼šå”¤é†’å¹¶ç¡®å®šå½“å‰ä½œä¸šæ˜¯å¦å·²è¿è¡Œç»“æŸã€‚å¦‚æœä½œä¸šçš„æ—¶é—´ç‰‡ä¸æ˜¯å®šæ—¶å™¨ä¸­æ–­é—´éš”çš„æ•´æ•°å€ï¼Œä¹Ÿæ²¡å…³ç³»ï¼›CFS ä¼šç²¾ç¡®è·Ÿè¸ª vruntimeï¼Œè¿™æ„å‘³ç€ä»é•¿è¿œæ¥çœ‹ï¼Œå®ƒæœ€ç»ˆä¼šæ¥è¿‘ç†æƒ³çš„ CPU å…±äº«çŠ¶æ€ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:7:1","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.2 æƒé‡ï¼ˆä¼˜å…ˆçº§ï¼‰ CFS è¿˜å¯ä»¥æ§åˆ¶è¿›ç¨‹ä¼˜å…ˆçº§ï¼Œä½¿ç”¨æˆ·æˆ–ç®¡ç†å‘˜èƒ½å¤Ÿä¸ºæŸäº›è¿›ç¨‹æä¾›æ›´é«˜çš„ CPU ä»½é¢ã€‚å®ƒä¸æ˜¯é€šè¿‡å½©ç¥¨æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œè€Œæ˜¯é€šè¿‡ç»å…¸ UNIX æœºåˆ¶â€”è¿›ç¨‹çš„niceçº§åˆ«çš„æ¥å®ç°è¿™ä¸€ç‚¹ã€‚å¯¹äºè¿›ç¨‹ï¼Œnice å‚æ•°å¯ä»¥è®¾ç½®ä¸º -20 åˆ° +19 ä¹‹é—´çš„ä»»æ„å€¼ï¼Œé»˜è®¤å€¼ä¸º 0ã€‚æ­£çš„ Nice å€¼æ„å‘³ç€è¾ƒä½çš„ä¼˜å…ˆçº§ï¼Œè´Ÿå€¼æ„å‘³ç€è¾ƒé«˜çš„ä¼˜å…ˆçº§ï¼›å½“ä½ å¤ªå¥½çš„æ—¶å€™ï¼Œä½ å°±ä¸ä¼šå¾—åˆ°é‚£ä¹ˆå¤šï¼ˆå®‰æ’ï¼‰å…³æ³¨ï¼Œå”‰ã€‚ CFSå°†æ¯ä¸ªè¿›ç¨‹çš„niceå€¼æ˜ å°„åˆ°ä¸€ä¸ªæƒé‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š static const int prio_to_weight[40] = { /* -20 */ 88761, 71755, 56483, 46273, 36291, /* -15 */ 29154, 23254, 18705, 14949, 11916, /* -10 */ 9548, 7620, 6100, 4904, 3906, /* -5 */ 3121, 2501, 1991, 1586, 1277, /* 0 */ 1024, 820, 655, 526, 423, /* 5 */ 335, 272, 215, 172, 137, /* 10 */ 110, 87, 70, 56, 45, /* 15 */ 36, 29, 23, 18, 15, }; æœ‰äº†è¿™äº›æƒé‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—æ¯ä¸ªè¿›ç¨‹çš„æœ‰æ•ˆæ—¶é—´ç‰‡ï¼ˆå°±åƒæˆ‘ä»¬ä¹‹å‰æ‰€åšçš„ï¼‰ï¼Œä½†ç°åœ¨è¦è€ƒè™‘å®ƒä»¬çš„ä¼˜å…ˆçº§å·®å¼‚ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š $$ \\text{time_slice}_k= \\frac {\\text{weight}k}{\\sum _ {i=0}^ {n-1}\\text{weight} {i}} \\cdot \\text{sched_latency} $$ è®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å‡å®šæœ‰ä¸¤ä¸ªå·¥ä½œï¼ŒA å’Œ Bã€‚A å› ä¸ºæ˜¯æˆ‘ä»¬æœ€å®è´µçš„å·¥ä½œï¼Œæ‰€ä»¥ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œniceå€¼ä¸º$-5$ï¼›B å› ä¸ºæˆ‘ä»¬ä¸å–œæ¬¢å®ƒï¼Œæ‰€ä»¥ä¼˜å…ˆçº§ä¸ºé»˜è®¤å€¼ï¼ˆniceå€¼ç­‰äº 0ï¼‰ã€‚è¿™æ„å‘³ç€$\\text{weight}_A$ï¼ˆæ¥è‡ªæƒé‡è¡¨ï¼‰ä¸º 3121ï¼Œè€Œ$\\text{weight}_B$ ä¸º 1024ã€‚å¦‚æœè®¡ç®—æ¯ä¸ªä½œä¸šçš„æ—¶é—´ç‰‡ï¼Œå°±ä¼šå‘ç° A çš„æ—¶é—´ç‰‡çº¦ä¸ºsched_latencyçš„ $\\frac{3}{4}$ï¼ˆå³ $36\\text{ms}$ï¼‰ï¼Œè€Œ B çº¦ä¸º$\\frac{1}{4}$ï¼ˆå³ $12\\text{ms}$ï¼‰ã€‚ é™¤äº†æ³›åŒ–æ—¶é—´ç‰‡è®¡ç®—å¤–ï¼ŒCFSè®¡ç®—vruntimeçš„æ–¹å¼ä¹Ÿå¿…é¡»è¿›è¡Œè°ƒæ•´ï¼Œä»¥ä¸‹æ˜¯æ–°å…¬å¼ï¼š $$ \\text{vruntime}_i=\\text{vruntime}_i+\\frac{\\text{weight}_0}{\\text{weight}_i}\\cdot \\text{runtime}_i $$ å®ƒæ ¹æ®è¿›ç¨‹$i$ç´¯ç§¯çš„å®é™…è¿è¡Œæ—¶é—´ï¼ˆ$\\text{runtime}_i$ï¼‰ï¼Œå¹¶ä¸è¿›ç¨‹çš„æƒé‡æˆåæ¯”ã€‚åœ¨æˆ‘ä»¬çš„è¿è¡Œç¤ºä¾‹ä¸­ï¼ŒA çš„ vruntime ç´¯ç§¯é€Ÿåº¦æ˜¯ B çš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ„å»ºä¸Šè¿°æƒé‡è¡¨çš„ä¸€ä¸ªå·§å¦™ä¹‹å¤„åœ¨äºï¼Œå½“ nice å€¼çš„å·®å¼‚æ’å®šæ—¶ï¼Œè¯¥è¡¨ä¿ç•™äº† CPU æ¯”ä¾‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¿›ç¨‹ A çš„ nice å€¼ä¸º 5ï¼ˆä¸æ˜¯ -5ï¼‰ï¼Œè¿›ç¨‹ B çš„ nice å€¼ä¸º 10ï¼ˆä¸æ˜¯ 0ï¼‰ï¼Œåˆ™ CFS å°†ä»¥ä¸ä¹‹å‰å®Œå…¨ç›¸åŒçš„æ–¹å¼è°ƒåº¦å®ƒä»¬ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:7:2","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.3 ä½¿ç”¨çº¢é»‘æ ‘ å¦‚ä¸Šæ‰€è¿°ï¼ŒCFS çš„ä¸€ä¸ªé‡ç‚¹æ˜¯æ•ˆç‡ã€‚å¯¹äºè°ƒåº¦å™¨æ¥è¯´ï¼Œæ•ˆç‡æœ‰å¾ˆå¤šæ–¹é¢ï¼Œä½†å…¶ä¸­ä¸€ä¸ªæ–¹é¢éå¸¸ç®€å•ï¼šå½“è°ƒåº¦å™¨éœ€è¦æŸ¥æ‰¾ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ä½œä¸šæ—¶ï¼Œå®ƒåº”è¯¥å°½å¯èƒ½å¿«åœ°æ‰¾åˆ°è¯¥ä½œä¸šã€‚ç®€å•çš„æ•°æ®ç»“æ„ï¼ˆå¦‚åˆ—è¡¨ï¼‰ä¸å…·æ‰©å±•æ€§ï¼šç°ä»£ç³»ç»Ÿæœ‰æ—¶ç”±ä¸Šåƒä¸ªè¿›ç¨‹ç»„æˆï¼Œå› æ­¤æ¯éš”å‡ æ¯«ç§’æœç´¢ä¸€æ¬¡é•¿åˆ—è¡¨ä¼šéå¸¸æµªè´¹ã€‚ CFS é€šè¿‡å°†è¿›ç¨‹ä¿ç•™åœ¨çº¢é»‘æ ‘ä¸Šæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚çº¢é»‘æ ‘æ˜¯å¤šç§ç±»å‹çš„å¹³è¡¡æ ‘ä¹‹ä¸€ï¼›ä¸ç®€å•çš„äºŒå‰æ ‘ï¼ˆåœ¨æœ€ç³Ÿç³•çš„æ’å…¥æ¨¡å¼ä¸‹ï¼Œå®ƒçš„æ€§èƒ½ä¼šé€€åŒ–åˆ°ç±»ä¼¼äºåˆ—è¡¨ï¼‰ä¸åŒï¼Œå¹³è¡¡æ ‘éœ€è¦åšä¸€äº›é¢å¤–çš„å·¥ä½œæ¥ä¿æŒè¾ƒä½çš„æ·±åº¦ï¼Œä»è€Œç¡®ä¿æ“ä½œåœ¨æ—¶é—´ä¸Šæ˜¯$\\log$ï¼ˆè€Œéçº¿æ€§ï¼‰çš„ã€‚ CFS ä¸ä¼šå°†æ‰€æœ‰è¿›ç¨‹éƒ½ä¿å­˜åœ¨æ­¤ç»“æ„ä¸­ï¼›ç›¸åï¼Œåªæœ‰æ­£åœ¨è¿è¡Œï¼ˆæˆ–å¯è¿è¡Œï¼‰çš„è¿›ç¨‹æ‰ä¼šä¿å­˜åœ¨æ­¤ç»“æ„ä¸­ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œç­‰å¾… I/O å®Œæˆæˆ–ç­‰å¾…ç½‘ç»œæ•°æ®åŒ…åˆ°è¾¾ï¼‰ï¼Œå®ƒå°±ä¼šä»è¿›ç¨‹æ ‘ä¸­åˆ é™¤ï¼Œå¹¶åœ¨å…¶ä»–åœ°æ–¹è·Ÿè¸ªã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­æ¥æ›´æ¸…æ¥šåœ°è¯´æ˜è¿™ä¸€ç‚¹ã€‚å‡è®¾æœ‰åä¸ªä½œä¸šï¼Œå®ƒä»¬çš„ vruntime å€¼åˆ†åˆ«ä¸ºï¼š1ã€5ã€9ã€10ã€14ã€18ã€17ã€21ã€22 å’Œ 24ã€‚å¦‚æœæˆ‘ä»¬å°†è¿™äº›ä½œä¸šä¿å­˜åœ¨ä¸€ä¸ªæœ‰åºåˆ—è¡¨ä¸­ï¼Œé‚£ä¹ˆæŸ¥æ‰¾ä¸‹ä¸€ä¸ªè¦è¿è¡Œçš„ä½œä¸šå°±å¾ˆç®€å•äº†ï¼šåªéœ€åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ å³å¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†è¯¥ä½œä¸šæŒ‰é¡ºåºæ”¾å›åˆ—è¡¨ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»æ‰«æè¿™ä¸ªåˆ—è¡¨ï¼Œå¯»æ‰¾æ­£ç¡®çš„ä½ç½®æ’å…¥ï¼Œè¿™æ˜¯ä¸€ä¸ª $O(n)$ è¿ç®—ã€‚ä»»ä½•æœç´¢çš„æ•ˆç‡ä¹Ÿå¾ˆä½ï¼Œå¹³å‡ä¹Ÿéœ€è¦çº¿æ€§æ—¶é—´ã€‚ è€Œåœ¨çº¢é»‘æ ‘ä¸Šä¿æŒç›¸åŒçš„å€¼å¯ä»¥æé«˜å¤§å¤šæ•°æ“ä½œçš„æ•ˆç‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è¿›ç¨‹åœ¨æ ‘ä¸­æŒ‰ vruntime æ’åºï¼Œå¤§å¤šæ•°æ“ä½œï¼ˆå¦‚æ’å…¥å’Œåˆ é™¤ï¼‰çš„æ—¶é—´éƒ½æ˜¯å¯¹æ•°çº§åˆ«ï¼Œå³ $O(\\log n)$ã€‚å½“ n è¶Šæ¥è¶Šå¤§ï¼Œå¯¹æ•°æ•ˆç‡æ˜æ˜¾é«˜äºçº¿æ€§æ•ˆç‡ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:7:3","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"7.4 å¤„ç†I/Oå’Œä¼‘çœ è¿›ç¨‹ å¯¹äºå·²ç»è¿›å…¥ä¼‘çœ çŠ¶æ€å¾ˆé•¿ä¸€æ®µæ—¶é—´çš„ä½œä¸šæ¥è¯´ï¼Œé€‰æ‹©ä¸‹ä¸€ä¸ªè¿è¡Œçš„æœ€ä½ vruntime ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ã€‚ä¾‹å¦‚æœ‰ä¸¤ä¸ªè¿›ç¨‹ A å’Œ Bï¼Œå…¶ä¸­ä¸€ä¸ª (A) è¿ç»­è¿è¡Œï¼Œå¦ä¸€ä¸ª (B) å·²ç»è¿›å…¥ä¼‘çœ çŠ¶æ€å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼ˆä¾‹å¦‚ 10 ç§’ï¼‰ã€‚å½“ B é†’æ¥æ—¶ï¼Œå®ƒçš„ vruntime å°†è½å A 10 ç§’ï¼Œå› æ­¤ï¼ˆå¦‚æœæˆ‘ä»¬ä¸å°å¿ƒçš„è¯ï¼‰ï¼ŒB ç°åœ¨å°†åœ¨æ¥ä¸‹æ¥çš„ 10 ç§’å†…ç‹¬å  CPUï¼ŒåŒæ—¶èµ¶ä¸Š Aï¼Œè¿™å®é™…ä¸Šä¼šè®©Aé¥¥é¥¿ã€‚ CFS é€šè¿‡åœ¨ä½œä¸šå”¤é†’æ—¶æ›´æ”¹å…¶ vruntimeæ¥å¤„ç†è¿™ç§æƒ…å†µã€‚å…·ä½“æ¥è¯´ï¼ŒCFS ä¼šå°†è¯¥ä½œä¸šçš„ vruntime è®¾ç½®ä¸ºåœ¨æ ‘ä¸­æ‰¾åˆ°çš„æœ€å°å€¼ï¼ˆè®°ä½ï¼Œæ ‘ä¸­åªåŒ…å«æ­£åœ¨è¿è¡Œçš„ä½œä¸šï¼‰ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒCFS é¿å…äº†é¥¥é¥¿ï¼Œä½†ä¹Ÿå¹¶éæ²¡æœ‰ä»£ä»·ï¼šçŸ­æ—¶é—´ç¡çœ çš„ä½œä¸šå¾€å¾€æ— æ³•è·å¾—å…¬å¹³çš„ CPU ä»½é¢ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:7:4","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"8 æ€»ç»“ æˆ‘ä»¬ä»‹ç»äº†æ¯”ä¾‹ä»½é¢è°ƒåº¦çš„æ¦‚å¿µï¼Œå¹¶ç®€è¦è®¨è®ºäº†ä¸‰ç§æ–¹æ³•ï¼šå½©ç¥¨è°ƒåº¦ã€æ­¥å¹…è°ƒåº¦å’Œ Linux çš„å®Œå…¨å…¬å¹³è°ƒåº¦å™¨ï¼ˆCFSï¼‰ã€‚å½©ç¥¨è°ƒåº¦å·§å¦™åœ°åˆ©ç”¨éšæœºæ€§æ¥å®ç°æ¯”ä¾‹ä»½é¢ï¼Œè€Œæ­¥å¹…è°ƒåº¦åˆ™æ˜¯ç¡®å®šæ€§åœ°å®ç°æ¯”ä¾‹ä»½é¢ã€‚CFS æ˜¯æœ¬ç« è®¨è®ºçš„å”¯ä¸€ä¸€ç§ â€œçœŸæ­£çš„ â€œè°ƒåº¦ç¨‹åºï¼Œæœ‰ç‚¹åƒå¸¦æœ‰åŠ¨æ€æ—¶é—´ç‰‡çš„åŠ æƒå¾ªç¯è°ƒåº¦ç¨‹åºï¼Œä½†å…¶è®¾è®¡å¯åœ¨è´Ÿè½½æƒ…å†µä¸‹è¿›è¡Œæ‰©å±•å¹¶è¡¨ç°è‰¯å¥½ï¼›æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œå®ƒæ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„å…¬å¹³åˆ†é…è°ƒåº¦ç¨‹åºã€‚ ä»»ä½•è°ƒåº¦å™¨éƒ½ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå…¬å¹³å…±äº«è°ƒåº¦å™¨ä¹Ÿæœ‰è‡ªå·±çš„é—®é¢˜ã€‚å…¶ä¸­ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè¿™ç§æ–¹æ³•ä¸ I/O å¹¶ä¸ååˆ†åŒ¹é…ï¼›å¦‚ä¸Šæ‰€è¿°ï¼Œå¶å°”æ‰§è¡Œ I/O çš„ä½œä¸šå¯èƒ½æ— æ³•è·å¾—å…¬å¹³åˆ†é…çš„ CPUã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå®ƒä»¬æ²¡æœ‰è§£å†³å½©ç¥¨æˆ–ä¼˜å…ˆçº§åˆ†é…çš„éš¾é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æ€ä¹ˆçŸ¥é“åº”è¯¥ç»™ä½ çš„æµè§ˆå™¨åˆ†é…å¤šå°‘å½©ç¥¨ï¼Œæˆ–è€…ç»™ä½ çš„æ–‡æœ¬ç¼–è¾‘å™¨è®¾ç½®niceçš„å€¼å‘¢ï¼Ÿå…¶ä»–é€šç”¨è°ƒåº¦ç¨‹åºï¼ˆå¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡çš„ MLFQ å’Œå…¶ä»–ç±»ä¼¼çš„ Linux è°ƒåº¦ç¨‹åºï¼‰ä¼šè‡ªåŠ¨å¤„ç†è¿™äº›é—®é¢˜ï¼Œå› æ­¤å¯èƒ½æ›´å®¹æ˜“éƒ¨ç½²ã€‚ å¥½æ¶ˆæ¯æ˜¯ï¼Œåœ¨è®¸å¤šé¢†åŸŸä¸­ï¼Œè¿™äº›é—®é¢˜å¹¶ä¸æ˜¯ä¸»è¦é—®é¢˜ï¼Œæ¯”ä¾‹ä»½é¢è°ƒåº¦å™¨çš„ä½¿ç”¨æ•ˆæœå¾ˆå¥½ã€‚ä¾‹å¦‚ï¼Œåœ¨è™šæ‹ŸåŒ–æ•°æ®ä¸­å¿ƒï¼ˆæˆ–äº‘è®¡ç®—ï¼‰ä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›å°†å››åˆ†ä¹‹ä¸€çš„ CPU å‘¨æœŸåˆ†é…ç»™ Windows VMï¼Œå…¶ä½™çš„åˆ†é…ç»™åŸºæœ¬çš„ Linux å®‰è£…ï¼ŒæŒ‰æ¯”ä¾‹ä»½é¢å¯ä»¥ç®€å•è€Œæœ‰æ•ˆåœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚è¿™ä¸ªæƒ³æ³•è¿˜å¯ä»¥æ‰©å±•åˆ°å…¶ä»–åœ°æ–¹ã€‚ ","date":"2024-04-25","objectID":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/:8:0","tags":["OS"],"title":"æ¯”ä¾‹ä»½é¢è°ƒåº¦","uri":"/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"githubåœ°å€ ","date":"2024-04-25","objectID":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/:0:0","tags":["OS"],"title":"å¤šçº§åé¦ˆé˜Ÿåˆ—","uri":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 Note/Translation åŸºæœ¬è§„åˆ™ MLFQæœ‰è®¸å¤šä¸åŒçš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—åˆ†é…äº†ä¸åŒçš„ä¼˜å…ˆçº§ã€‚åœ¨ä»»ä½•ç»™å®šæ—¶é—´ï¼Œå‡†å¤‡è¿è¡Œçš„ä½œä¸šéƒ½ä½äºå•ä¸ªé˜Ÿåˆ—ä¸Šã€‚ MLFQ ä½¿ç”¨ä¼˜å…ˆçº§æ¥å†³å®šåœ¨ç»™å®šæ—¶é—´åº”è¿è¡Œå“ªä¸ªä½œä¸šï¼šé€‰æ‹©è¿è¡Œå…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„ä½œä¸šï¼ˆå³è¾ƒé«˜é˜Ÿåˆ—ä¸Šçš„ä½œä¸šï¼‰ã€‚å½“ç„¶ï¼Œä¸€ä¸ªé˜Ÿåˆ—ä¸Šå¯èƒ½æœ‰å¤šä¸ªä½œä¸šï¼Œå³å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œè¿™ç§æƒ…å†µåˆ™å¯¹è¿™äº›å·¥ä½œä½¿ç”¨RRè°ƒåº¦ã€‚åˆ™MLFQåŸºæœ¬è§„åˆ™å¦‚ä¸‹ï¼š $\\text{Rule}\\space1:\\text{If Priority(A)\u003ePriority(B),A runs (B doesnâ€™t).}$ $\\text{Rule}\\space1:\\text{If Priority(A)=Priority(B),A and B run in RR.}$ MLFQä¾‹å­ å¦‚æœæˆ‘ä»¬è¦å±•ç¤ºç»™å®šæ—¶åˆ»é˜Ÿåˆ—çš„æ ·å­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„å†…å®¹ï¼ˆå›¾ 8.1ï¼‰ã€‚å›¾ä¸­ï¼Œä¸¤ä¸ªä½œä¸šï¼ˆA å’Œ Bï¼‰çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œä½œä¸š C å¤„äºä¸­é—´ï¼Œä½œä¸š D çš„ä¼˜å…ˆçº§æœ€ä½ã€‚é‰´äºæˆ‘ä»¬ç›®å‰å¯¹ MLFQ å·¥ä½œåŸç†çš„äº†è§£ï¼Œè°ƒåº¦ç¨‹åºåªä¼šåœ¨ A å’Œ B ä¹‹é—´äº¤æ›¿æ—¶é—´ç‰‡ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç³»ç»Ÿä¸­ä¼˜å…ˆçº§æœ€é«˜çš„ä½œä¸šï¼›å¯æ€œçš„å·¥ä½œ C å’Œ D æ ¹æœ¬æ— æ³•è¿è¡Œï¼ å°è¯•#1ï¼šæ€ä¹ˆæ”¹å˜ä½œä¸šçš„ä¼˜å…ˆçº§ ç°åœ¨ï¼Œæˆ‘ä»¬å¿…é¡»å†³å®š MLFQ å°†å¦‚ä½•åœ¨ä½œä¸šçš„ç”Ÿå‘½å‘¨æœŸå†…æ›´æ”¹ä½œä¸šçš„ä¼˜å…ˆçº§ï¼ˆä»¥åŠå®ƒæ‰€åœ¨çš„é˜Ÿåˆ—ï¼‰ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ç‰¢è®°æˆ‘ä»¬çš„å·¥ä½œè´Ÿè½½ï¼šçŸ­æœŸè¿è¡Œçš„äº¤äº’å¼ä½œä¸šï¼ˆå¯èƒ½ç»å¸¸æ”¾å¼ƒ CPUï¼‰ï¼Œä»¥åŠä¸€äº›éœ€è¦å¤§é‡ CPU æ—¶é—´ä½†è¿è¡Œæ—¶é—´è¾ƒé•¿çš„â€œCPU å¯†é›†å‹â€ä½œä¸šã€‚å…¶ä¸­å“åº”æ—¶é—´å¹¶ä¸é‡è¦ã€‚è¿™æ˜¯æˆ‘ä»¬å¯¹ä¼˜å…ˆçº§è°ƒæ•´ç®—æ³•çš„ç¬¬ä¸€æ¬¡å°è¯•ï¼š $\\text{Rule 3: When a job enters the system, it is placed at the highest priority (the topmost queue).}$ $\\text{Rule 4a: If a job uses up an entire time slice while running, its pri- ority is reduced (i.e., it moves down one queue).}$ $\\text{Rule 4b: If a job gives up the CPU before the time slice is up, it stays at the same priority level.}$ ä¾‹å­#1.1ï¼šå•ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä½œä¸š é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å½“ç³»ç»Ÿä¸­æœ‰ä¸€é¡¹é•¿æœŸè¿è¡Œçš„å·¥ä½œæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ä¸‰é˜Ÿåˆ—è°ƒåº¦ç¨‹åºä¸­è¯¥ä½œä¸šéšæ—¶é—´å‘ç”Ÿçš„å˜åŒ–ã€‚ å¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œä½œä¸šä»¥æœ€é«˜ä¼˜å…ˆçº§ï¼ˆQ2ï¼‰è¿›å…¥ã€‚ç»è¿‡ $\\text{10ms}$ çš„å•ä¸ªæ—¶é—´ç‰‡åï¼Œè°ƒåº¦ç¨‹åºå°†ä½œä¸šçš„ä¼˜å…ˆçº§é™ä½äº†ä¸€ä¸ªï¼Œå› æ­¤ä½œä¸šçš„ä¼˜å…ˆçº§ä¸º Q1ã€‚åœ¨ Q1 ä¸Šè¿è¡Œä¸€ä¸ªæ—¶é—´ç‰‡åï¼Œä½œä¸šæœ€ç»ˆè¢«é™åˆ°ç³»ç»Ÿä¸­çš„æœ€ä½ä¼˜å…ˆçº§ï¼ˆQ0ï¼‰ï¼Œå¹¶ä¿æŒä¸å˜ã€‚ ä¾‹å­#1.2ï¼šåŠ å…¥ä¸€ä¸ªçŸ­ä½œä¸š åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰ä¸¤ä¸ªä½œä¸šï¼šAæ˜¯ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„CPUå¯†é›†å‹ä½œä¸šï¼ŒBæ˜¯ä¸€ä¸ªçŸ­æœŸè¿è¡Œçš„äº¤äº’ä½œä¸šã€‚å‡è®¾Aå·²ç»è¿è¡Œäº†ä¸€æ®µæ—¶é—´ï¼Œç„¶åBæ‰åˆ°è¾¾ï¼Œè¿™æ ·ä¼šå‘ç”Ÿä»€ä¹ˆï¼ŸMLFQæ˜¯å¦ä¼šè¿‘ä¼¼äºBçš„SJFï¼Ÿ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒAï¼ˆé»‘è‰²æ˜¾ç¤ºï¼‰åœ¨æœ€ä½ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­è¿è¡Œï¼ˆä»»ä½•é•¿æœŸè¿è¡Œçš„ CPU å¯†é›†å‹ä½œä¸šéƒ½æ˜¯å¦‚æ­¤ï¼‰ï¼›Bï¼ˆç°è‰²æ˜¾ç¤ºï¼‰åœ¨ T = 100 æ—¶åˆ°è¾¾ï¼Œå› æ­¤ä¼šæ’å…¥åˆ°æœ€é«˜é˜Ÿåˆ—ï¼Œç”±äºå…¶è¿è¡Œæ—¶é—´å¾ˆçŸ­ï¼ˆä»…20msï¼‰ï¼ŒB åœ¨åˆ°è¾¾åº•å±‚é˜Ÿåˆ—ä¹‹å‰å®Œæˆï¼Œåˆ†ä¸¤ä¸ªæ—¶é—´ç‰‡ï¼›ç„¶å A æ¢å¤è¿è¡Œï¼ˆä½ä¼˜å…ˆçº§ï¼‰ã€‚ ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ æœ‰æœ›ç†è§£ç®—æ³•çš„ä¸€ä¸ªä¸»è¦ç›®æ ‡ï¼šå› ä¸ºå®ƒä¸çŸ¥é“ä¸€é¡¹ä½œä¸šæ˜¯çŸ­ä½œä¸šè¿˜æ˜¯é•¿æœŸä½œä¸šï¼Œæ‰€ä»¥å®ƒé¦–å…ˆå‡å®šå®ƒå¯èƒ½æ˜¯çŸ­ä½œä¸šï¼Œä»è€Œç»™äºˆè¯¥ä½œä¸šé«˜ä¼˜å…ˆçº§ã€‚å¦‚æœå®ƒç¡®å®æ˜¯çŸ­ä½œä¸šï¼Œå®ƒå°±ä¼šå¿«é€Ÿè¿è¡Œå¹¶å®Œæˆï¼›å¦‚æœå®ƒä¸æ˜¯çŸ­ä½œä¸šï¼Œå®ƒå°±ä¼šåœ¨é˜Ÿåˆ—ä¸­ç¼“æ…¢ç§»åŠ¨ï¼Œä»è€Œå¾ˆå¿«è¯æ˜è‡ªå·±æ˜¯ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„æ›´ç±»ä¼¼æ‰¹å¤„ç†çš„è¿›ç¨‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒMLFQ è¿‘ä¼¼äº SJFã€‚ ä¾‹å­#1.3ï¼šå…³äºI/O å¦‚ä¸Šæ–‡è§„åˆ™ 4b æ‰€è¿°ï¼Œå¦‚æœè¿›ç¨‹åœ¨ç”¨å®Œå…¶æ—¶é—´ç‰‡ä¹‹å‰æ”¾å¼ƒäº†å¤„ç†å™¨ï¼Œæˆ‘ä»¬ä¼šå°†å…¶ä¿æŒåœ¨ç›¸åŒçš„ä¼˜å…ˆçº§ã€‚è¿™æ¡è§„åˆ™çš„ç”¨æ„å¾ˆç®€å•ï¼šä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªäº¤äº’å¼ä½œä¸šæ­£åœ¨è¿›è¡Œå¤§é‡çš„ I/Oï¼ˆæ¯”å¦‚ç­‰å¾…é”®ç›˜æˆ–é¼ æ ‡çš„ç”¨æˆ·è¾“å…¥ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šåœ¨å…¶æ—¶é—´ç‰‡å®Œæˆä¹‹å‰æ”¾å¼ƒ CPUï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æƒ©ç½šè¯¥ä½œä¸šï¼Œå› æ­¤åªéœ€å°†å…¶ä¿æŒåœ¨åŒä¸€ä¼˜å…ˆçº§å³å¯ã€‚ ä¸‹å›¾ä¸¾ä¾‹è¯´æ˜äº†è¿™ç§æ–¹æ³•çš„å·¥ä½œåŸç†ï¼Œäº¤äº’å¼ä½œä¸š Bï¼ˆç°è‰²æ˜¾ç¤ºï¼‰åªéœ€è¦ CPU 1 msï¼Œç„¶åæ‰§è¡Œ I/Oï¼Œä¸é•¿æœŸè¿è¡Œçš„æ‰¹å¤„ç†ä½œä¸š Aï¼ˆé»‘è‰²æ˜¾ç¤ºï¼‰äº‰å¤º CPUã€‚MLFQ æ–¹æ³•å°† B ä¿æŒåœ¨æœ€é«˜ä¼˜å…ˆçº§ï¼Œå› ä¸º B ä¸€ç›´åœ¨é‡Šæ”¾ CPUï¼›å¦‚æœ B æ˜¯äº¤äº’å¼ä½œä¸šï¼ŒMLFQ å°†è¿›ä¸€æ­¥å®ç°å¿«é€Ÿè¿è¡Œäº¤äº’å¼ä½œä¸šçš„ç›®æ ‡ã€‚ æˆ‘ä»¬ç°åœ¨è®¾è®¡çš„MLFQå­˜åœ¨çš„é—®é¢˜ è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„ MLFQã€‚å®ƒä¼¼ä¹åšå¾—ç›¸å½“ä¸é”™ï¼Œåœ¨é•¿æ—¶é—´è¿è¡Œçš„ä½œä¸šä¹‹é—´å…¬å¹³åœ°å…±äº« CPUï¼Œå¹¶è®©çŸ­æ—¶é—´æˆ– I/O å¯†é›†å‹äº¤äº’å¼ä½œä¸šå¿«é€Ÿè¿è¡Œã€‚é—æ†¾çš„æ˜¯ï¼Œæˆ‘ä»¬è¿„ä»Šä¸ºæ­¢å¼€å‘çš„æ–¹æ³•å­˜åœ¨ä¸¥é‡ç¼ºé™·ã€‚ é¥¥é¥¿é—®é¢˜ï¼šå¦‚æœç³»ç»Ÿå­˜åœ¨å¤ªå¤šäº¤äº’ä½œä¸šï¼Œå®ƒä»¬å°†ä¼šå…±åŒæ¶ˆè€—æ‰€æœ‰CPUæ—¶é—´ï¼Œè¿™æ ·é•¿æ—¶é—´è¿è¡Œçš„ä½œä¸šå°†ä¸ä¼šè·å¾—ä»»ä½•CPUæ—¶é—´ï¼ˆå³é¥¥é¥¿ï¼‰ã€‚ æ¬ºéª—è°ƒåº¦ç¨‹åºï¼šèªæ˜çš„ç”¨æˆ·å¯ä»¥é‡å†™ç¨‹åºï¼Œç©å¼„è°ƒåº¦ç¨‹åºã€‚å³æ˜¯æŒ‡å·å·æ‘¸æ‘¸åœ°æ¬ºéª—è°ƒåº¦ç¨‹åºï¼Œè®©è°ƒåº¦ç¨‹åºç»™ä½ åˆ†é…æ›´å¤šçš„èµ„æºã€‚æˆ‘ä»¬æ‰€æè¿°çš„ç®—æ³•å¾ˆå®¹æ˜“å—åˆ°ä»¥ä¸‹æ”»å‡»ï¼šåœ¨æ—¶é—´ç‰‡ç»“æŸå‰ï¼Œè¿›è¡Œä¸€æ¬¡ I/O æ“ä½œï¼ˆå¯¹æŸä¸ªä½ å¹¶ä¸å…³å¿ƒçš„æ–‡ä»¶ï¼‰ï¼Œä»è€Œæ”¾å¼ƒ CPUï¼›è¿™æ ·åšå¯ä»¥è®©ä½ ä¿æŒåœ¨åŒä¸€é˜Ÿåˆ—ä¸­ï¼Œä»è€Œè·å¾—æ›´å¤šçš„ CPU æ—¶é—´ã€‚å¦‚æœæ“ä½œå¾—å½“ï¼ˆä¾‹å¦‚ï¼Œè¿è¡Œ 99% çš„æ—¶é—´ç‰‡åæ‰æ”¾å¼ƒ CPUï¼‰ï¼Œä½œä¸šå‡ ä¹å¯ä»¥å„æ–­ CPUã€‚ ç¨‹åºè¡Œä¸ºæ”¹å˜ï¼šä¸€ä¸ªç¨‹åºå¯èƒ½ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜å…¶è¡Œä¸ºï¼›åŸæ¥çš„ CPU çº¦æŸå¯èƒ½ä¼šè¿‡æ¸¡åˆ°äº¤äº’é˜¶æ®µã€‚é‡‡ç”¨æˆ‘ä»¬ç›®å‰çš„æ–¹æ³•ï¼Œè¿™æ ·çš„ä½œä¸šå°±ä¼šå€’éœ‰ï¼Œä¸ä¼šåƒç³»ç»Ÿä¸­çš„å…¶ä»–äº¤äº’å¼ä½œä¸šä¸€æ ·å¾—åˆ°å¤„ç†ã€‚ å°è¯•#2ï¼šä¼˜å…ˆçº§æå‡ è®©æˆ‘ä»¬è¯•ç€æ”¹å˜è§„åˆ™ï¼Œçœ‹çœ‹èƒ½å¦é¿å… â€œé¥¥é¥¿ â€œé—®é¢˜ã€‚ä¸ºäº†ä¿è¯å ç”¨ CPU çš„ä½œä¸šèƒ½å–å¾—ä¸€äº›è¿›å±•ï¼ˆå³ä½¿è¿›å±•ä¸å¤§ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åšäº›ä»€ä¹ˆï¼Ÿç®€å•æ¥è¯´ï¼Œå°±æ˜¯å®šæœŸæå‡ç³»ç»Ÿä¸­æ‰€æœ‰ä½œä¸šçš„ä¼˜å…ˆçº§ã€‚å®ç°è¿™ä¸€ç‚¹çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä½†æˆ‘ä»¬åªéœ€åšä¸€ä»¶ç®€å•çš„äº‹ï¼šæŠŠæ‰€æœ‰ä½œä¸šéƒ½æ‰”åˆ°æœ€ä¸Šé¢çš„é˜Ÿåˆ—ä¸­ï¼›å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ¡æ–°è§„åˆ™ï¼š $\\text{Rule 5: After some time period S, move all the jobs in the system to the topmost queue.}$ æˆ‘ä»¬çš„æ–°è§„åˆ™åŒæ—¶è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œä¿è¯äº†è¿›ç¨‹ä¸ä¼šé¥¥é¥¿ï¼šä½œä¸šæ’åœ¨é˜Ÿåˆ—çš„æœ€å‰é¢ï¼Œå°±èƒ½ä¸å…¶ä»–é«˜ä¼˜å…ˆçº§ä½œä¸šä»¥å¾ªç¯æ–¹å¼å…±äº« CPUï¼Œä»è€Œæœ€ç»ˆè·å¾—æœåŠ¡ã€‚å…¶æ¬¡ï¼Œå¦‚æœå— CPU é™åˆ¶çš„ä½œä¸šå·²å¼€å§‹äº¤äº’ï¼Œè°ƒåº¦ç¨‹åºä¼šåœ¨å…¶è·å¾—ä¼˜å…ˆçº§æå‡åå¯¹å…¶è¿›è¡Œé€‚å½“å¤„ç†ã€‚ ä¾‹å­#2.1ï¼šç«äº‰CPU åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»…å±•ç¤ºä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä½œä¸šä¸ä¸¤ä¸ªçŸ­æ—¶é—´è¿è¡Œçš„äº¤äº’å¼ä½œä¸šç«äº‰ CPU æ—¶çš„è¡Œä¸ºã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸¤ä¸ªå›¾è¡¨ã€‚åœ¨å·¦è¾¹ï¼Œæ²¡æœ‰ä¼˜å…ˆçº§æå‡ï¼Œå› æ­¤ä¸€æ—¦ä¸¤ä¸ªçŸ­æœŸä½œä¸šåˆ°è¾¾ï¼Œé•¿æœŸè¿è¡Œçš„ä½œä¸šå°±ä¼šé™·å…¥é¥¥é¥¿ï¼›å³è¾¹ï¼Œæ¯ 50 æ¯«ç§’å°±æœ‰ä¸€æ¬¡ä¼˜å…ˆçº§æå‡ï¼ˆè¿™ä¸ªå€¼å¯èƒ½å¤ªå°ï¼Œä½†è¿™é‡Œç”¨äºç¤ºä¾‹ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬è‡³å°‘ä¿è¯é•¿æ—¶é—´è¿è¡Œçš„ä½œä¸šä¼šå–å¾—ä¸€äº›è¿›å±•ï¼Œæå‡åˆ°æ¯ 50 æ¯«ç§’è®¾ç½®ä¸€æ¬¡æœ€é«˜ä¼˜å…ˆçº§ï¼Œä»è€Œå®šæœŸè¿è¡Œã€‚ å½“ç„¶ï¼Œå¢åŠ æ—¶é—´æ®µSä¼šå¸¦æ¥ä¸€ä¸ªæ˜æ˜¾çš„é—®é¢˜ï¼šSåº”è¯¥è®¾ç½®ä¸ºä»€ä¹ˆï¼Ÿ John Ousterhoutï¼Œä¸€ä½å—äººå°Šæ•¬çš„ç³»ç»Ÿç ”ç©¶å‘˜ ï¼Œè¿‡å»å¸¸å¸¸å°†ç³»ç»Ÿä¸­çš„æ­¤ç±»å€¼ç§°ä¸ºâ€œå·«æœ¯å¸¸é‡â€ï¼Œå› ä¸ºå®ƒä»¬ä¼¼ä¹éœ€è¦æŸç§å½¢å¼çš„é»‘é­”æ³•æ‰èƒ½æ­£ç¡®è®¾ç½®å®ƒä»¬ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒSæœ‰é‚£ç§å‘³é“ã€‚å¦‚æœè®¾ç½®å¾—å¤ªé«˜ï¼Œé•¿æ—¶é—´è¿è¡Œçš„ä½œä¸šå¯èƒ½ä¼šé™·å…¥å›°å¢ƒï¼›å¤ªä½ï¼Œäº¤äº’å¼ä½œä¸šå¯èƒ½æ— æ³•è·å¾—é€‚å½“çš„ CPU ä»½é¢ã€‚ å°è¯•#3ï¼šæ›´å¥½çš„è®¡ç®— ç°åœ¨ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªé—®é¢˜è¦è§£å†³ï¼šå¦‚ä½•é˜²æ­¢è°ƒåº¦ç¨‹åºè¢«ç©å¼„ï¼Ÿæ­£å¦‚ä½ å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼ŒçœŸæ­£çš„ç½ªé­ç¥¸é¦–æ˜¯Rule 4a å’Œ 4bï¼Œå®ƒä»¬å…è®¸ä½œä¸šåœ¨æ—¶é—´ç‰‡åˆ°æœŸå‰æ”¾å¼ƒ CPUï¼Œä»è€Œä¿ç•™å…¶ä¼˜å…ˆçº§ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè§£å†³åŠæ³•æ˜¯åœ¨ MLFQ çš„æ¯ä¸€çº§æ›´å¥½åœ°è®¡ç®— CPU æ—¶é—´ã€‚è°ƒåº¦ç¨‹åºä¸åº”è¯¥å¿˜è®°è¿›ç¨‹åœ¨ç‰¹å®šçº§åˆ«ä¸Šä½¿ç”¨äº†å¤šå°‘æ—¶é—´ç‰‡ï¼Œè€Œåº”è¯¥è¿›è¡Œè·Ÿè¸ªï¼›ä¸€æ—¦è¿›ç¨‹ç”¨å®Œäº†åˆ†é…çš„æ—¶é—´ç‰‡ï¼Œå°±ä¼šè¢«é™çº§åˆ°ä¸‹ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚è‡³äºè¿›ç¨‹æ˜¯åœ¨ä¸€ä¸ªé•¿çš„æ—¶é—´æ®µå†…ä½¿ç”¨æ—¶é—´ç‰‡ï¼Œè¿˜æ˜¯åœ¨è®¸å¤šå°çš„æ—¶é—´æ®µå†…ä½¿ç”¨æ—¶é—´ç‰‡ï¼Œè¿™å¹¶ä¸é‡è¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†è§„åˆ™ 4a å’Œ 4b é‡å†™ä¸ºä»¥ä¸‹å•ä¸€è§„åˆ™ï¼š $\\text{Rule 4: Once a job uses up its time allotment at a given level (re- gardless of how many times it has given up the CPU), its priority is reduced (i.e., it moves down one queue).}$ ä¾‹å­#3.1ï¼šæ—§è§„åˆ™å’Œæ–°è§„åˆ™å¯¹æ¯” ä¸‹å›¾æ˜¾ç¤ºäº†å½“å·¥ä½œè´Ÿè½½è¯•å›¾åˆ©ç”¨æ—§è§„åˆ™ 4a å’Œ 4bï¼ˆå·¦ä¾§ï¼‰ä»¥åŠæ–°çš„åç©å¼„è§„åˆ™ 4 æ¥ç©å¼„è°ƒåº¦ç¨‹åºæ—¶ä¼šå‘ç”Ÿçš„æƒ…å†µã€‚å¦‚æœæ²¡æœ‰ä»»ä½•é˜²æ­¢ç©å¼„çš„ä¿æŠ¤æªæ–½ï¼Œè¿›ç¨‹å¯ä»¥åœ¨æ—¶é—´ç‰‡ç»“æŸå‰å‘å‡º I/Oï¼Œä»è€Œæ”¯é… CPU æ—¶é—´ã€‚æœ‰äº†è¿™ç§ä¿æŠ¤æªæ–½ï¼Œæ— è®ºè¿›ç¨‹çš„ I/O è¡Œä¸ºå¦‚ä½•ï¼Œå®ƒéƒ½ä¼šåœ¨é˜Ÿåˆ—ä¸­ç¼“æ…¢ç§»åŠ¨ï¼Œä»è€Œæ— æ³•è·å¾—ä¸å…¬å¹³çš„ CPU å æœ‰ç‡ã€‚ è°ƒæ•´ MLFQ åŠå…¶ä»–é—®é¢˜ MLFQ è°ƒåº¦è¿˜å­˜åœ¨å…¶ä»–ä¸€äº›é—®é¢˜ã€‚ä¸€ä¸ªå¤§é—®é¢˜æ˜¯å¦‚ä½•ä¸ºè¿™æ ·çš„è°ƒåº¦å™¨è®¾ç½®å‚æ•°ã€‚ä¾‹å¦‚ï¼Œåº”è¯¥æœ‰å¤šå°‘ä¸ªé˜Ÿåˆ—ï¼Ÿæ¯ä¸ªé˜Ÿåˆ—çš„æ—¶é—´ç‰‡åº”è¯¥æœ‰å¤šå¤§ï¼Ÿä¸ºäº†é¿å…é¥¥é¥¿å¹¶è€ƒè™‘åˆ°è¡Œä¸ºçš„å˜åŒ–ï¼Œåº”è¯¥å¤šä¹…æå‡ä¸€æ¬¡ä¼˜å…ˆçº§ï¼Ÿè¿™äº›é—®é¢˜éƒ½æ²¡æœ‰ç®€å•çš„ç­”æ¡ˆï¼Œå› æ­¤åªæœ‰åœ¨å·¥ä½œè´Ÿè½½æ–¹é¢ç§¯ç´¯ä¸€å®šçš„ç»éªŒï¼Œç„¶åå¯¹è°ƒåº¦ç¨‹åºè¿›è¡Œè°ƒæ•´ï¼Œæ‰èƒ½å–å¾—ä»¤äººæ»¡æ„çš„å¹³è¡¡ã€‚ ä¾‹å¦‚ï¼Œå¤§å¤šæ•° MLFQ å˜ä½“éƒ½å…è®¸åœ¨ä¸åŒé˜Ÿåˆ—ä¸­ä½¿ç”¨ä¸åŒçš„æ—¶é—´ç‰‡é•¿åº¦ã€‚é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—çš„æ—¶é—´ç‰‡é€šå¸¸è¾ƒçŸ­ï¼›æ¯•ç«Ÿå®ƒä»¬ç”±äº¤äº’å¼ä½œä¸šç»„æˆï¼Œå› æ­¤åœ¨å®ƒä»¬ä¹‹é—´å¿«é€Ÿäº¤æ›¿æ˜¯åˆç†çš„ï¼ˆä¾‹å¦‚","date":"2024-04-25","objectID":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/:1:0","tags":["OS"],"title":"å¤šçº§åé¦ˆé˜Ÿåˆ—","uri":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 Program Explanation è¿™ä¸ªç¨‹åº mlfq.py å…è®¸æ‚¨æŸ¥çœ‹æœ¬ç« ä¸­ä»‹ç»çš„ MLFQ è°ƒåº¦ç¨‹åºçš„è¡Œä¸ºæ–¹å¼ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥ä½¿ç”¨éšæœºç§å­ä¸ºè‡ªå·±ç”Ÿæˆé—®é¢˜ï¼Œæˆ–è€…ä½¿ç”¨å®ƒæ„å»ºä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„å®éªŒï¼Œä»¥äº†è§£ MLFQ åœ¨ä¸åŒæƒ…å†µä¸‹çš„å·¥ä½œåŸç†ã€‚è¦è¿è¡Œè¯¥ç¨‹åºï¼Œè¯·é”®å…¥ï¼š â¯ python mlfq.py ä½¿ç”¨å‚æ•°-hæŸ¥çœ‹é€‰é¡¹å¸®åŠ©ï¼š â¯ python mlfq.py -h Usage: mlfq.py [options] Options: -h, --help show this help message and exit -s SEED, --seed=SEED the random seed -n NUMQUEUES, --numQueues=NUMQUEUES number of queues in MLFQ (if not using -Q) -q QUANTUM, --quantum=QUANTUM length of time slice (if not using -Q) -a ALLOTMENT, --allotment=ALLOTMENT length of allotment (if not using -A) -Q QUANTUMLIST, --quantumList=QUANTUMLIST length of time slice per queue level, specified as x,y,z,... where x is the quantum length for the highest priority queue, y the next highest, and so forth -A ALLOTMENTLIST, --allotmentList=ALLOTMENTLIST length of time allotment per queue level, specified as x,y,z,... where x is the # of time slices for the highest priority queue, y the next highest, and so forth -j NUMJOBS, --numJobs=NUMJOBS number of jobs in the system -m MAXLEN, --maxlen=MAXLEN max run-time of a job (if randomly generating) -M MAXIO, --maxio=MAXIO max I/O frequency of a job (if randomly generating) -B BOOST, --boost=BOOST how often to boost the priority of all jobs back to high priority -i IOTIME, --iotime=IOTIME how long an I/O should last (fixed constant) -S, --stay reset and stay at same priority level when issuing I/O -I, --iobump if specified, jobs that finished I/O move immediately to front of current queue -l JLIST, --jlist=JLIST a comma-separated list of jobs to run, in the form x1,y1,z1:x2,y2,z2:... where x is start time, y is run time, and z is how often the job issues an I/O request -c compute answers for me ä½¿ç”¨æ¨¡æ‹Ÿå™¨æœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•ï¼Œä¸€ç§æ–¹æ³•æ˜¯ç”Ÿæˆä¸€äº›éšæœºä½œä¸šï¼Œç„¶åçœ‹çœ‹æ‚¨æ˜¯å¦å¯ä»¥å¼„æ¸…æ¥šå®ƒä»¬åœ¨ç»™å®š MLFQ è°ƒåº¦ç¨‹åºçš„æƒ…å†µä¸‹å°†å¦‚ä½•è¡¨ç°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³åˆ›å»ºéšæœºç”Ÿæˆçš„ä¸‰ä½œä¸šå·¥ä½œè´Ÿè½½ï¼Œæ‚¨åªéœ€è¿è¡Œ â¯ python mlfq.py -j 3 Here is the list of inputs: OPTIONS jobs 3 OPTIONS queues 3 OPTIONS allotments for queue 2 is 1 OPTIONS quantum length for queue 2 is 10 OPTIONS allotments for queue 1 is 1 OPTIONS quantum length for queue 1 is 10 OPTIONS allotments for queue 0 is 1 OPTIONS quantum length for queue 0 is 10 OPTIONS boost 0 OPTIONS ioTime 5 OPTIONS stayAfterIO False OPTIONS iobump False For each job, three defining characteristics are given: startTime : at what time does the job enter the system runTime : the total CPU time needed by the job to finish ioFreq : every ioFreq time units, the job issues an I/O (the I/O takes ioTime units to complete) Job List: Job 0: startTime 0 - runTime 84 - ioFreq 7 Job 1: startTime 0 - runTime 42 - ioFreq 3 Job 2: startTime 0 - runTime 51 - ioFreq 4 Compute the execution trace for the given workloads. If you would like, also compute the response and turnaround times for each of the jobs. Use the -c flag to get the exact results when you are finished. è¿™ä¼šåœ¨å…·æœ‰å¤šä¸ªé»˜è®¤è®¾ç½®çš„é»˜è®¤æ•°é‡çš„é˜Ÿåˆ—ä¸Šç”Ÿæˆä¸‰ä¸ªä½œä¸šï¼ˆæ ¹æ®æŒ‡å®šï¼‰çš„éšæœºå·¥ä½œè´Ÿè½½ã€‚å¦‚æœæ‚¨ä½¿ç”¨ (-c) ä¸Šçš„æ±‚è§£é€‰é¡¹å†æ¬¡è¿è¡Œï¼Œæ‚¨å°†çœ‹åˆ°ä¸ä¸Šé¢ç›¸åŒçš„æ‰“å°è¾“å‡ºï¼Œä»¥åŠä»¥ä¸‹å†…å®¹ï¼š Execution Trace: [ time 0 ] JOB BEGINS by JOB 0 [ time 0 ] JOB BEGINS by JOB 1 [ time 0 ] JOB BEGINS by JOB 2 [ time 0 ] Run JOB 0 at PRIORITY 2 [ TICKS 9 ALLOT 1 TIME 83 (of 84) ] [ time 1 ] Run JOB 0 at PRIORITY 2 [ TICKS 8 ALLOT 1 TIME 82 (of 84) ] [ time 2 ] Run JOB 0 at PRIORITY 2 [ TICKS 7 ALLOT 1 TIME 81 (of 84) ] [ time 3 ] Run JOB 0 at PRIORITY 2 [ TICKS 6 ALLOT 1 TIME 80 (of 84) ] [ time 4 ] Run JOB 0 at PRIORITY 2 [ TICKS 5 ALLOT 1 TIME 79 (of 84) ] [ time 5 ] Run JOB 0 at PRIORITY 2 [ TICKS 4 ALLOT 1 TIME 78 (of 84) ] [ time 6 ] Run JOB 0 at PRIORITY 2 [ TICKS 3 ALLOT 1 TIME 77 (of 84) ] [ time 7 ] IO_START by JOB 0 IO DONE [ time 7 ] Run JOB 1 at PRIORITY 2 [ TICKS 9 ALLOT 1 TIME 41 (of 42) ] [ time 8 ] Run JOB 1 at PRIORITY 2 [ TICKS 8 ALLOT 1 TIME 40 (of 42) ] [ time 9 ] Run JOB 1 at PRIORITY 2 [ TICKS 7 ALLOT 1 TIME 39 (of 42) ] ... Final statistics: Job 0: startTime 0 - response 0 - turnaround 175 Job 1: startTime 0 - response 7 - turnaround 191 Job 2: startTime 0 - response 9 - turnaround 168 Avg 2: startTime n/a - response 5.33 - turnaround 178.00 è¯¥è·Ÿè¸ªä»¥æ¯«ç§’ä¸ºå•ä½å‡†ç¡®æ˜¾ç¤ºäº†è°ƒåº¦ç¨‹åºå†³å®šæ‰§è¡Œçš„æ“ä½œã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå®ƒé¦–å…ˆè¿è¡Œä½œä¸š 0 7 æ¯«ç§’ï¼Œç›´åˆ°ä½œä¸š 0 å‘å‡º I/Oï¼›è¿™æ˜¯","date":"2024-04-25","objectID":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/:2:0","tags":["OS"],"title":"å¤šçº§åé¦ˆé˜Ÿåˆ—","uri":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 QA ä»…ä½¿ç”¨ä¸¤ä¸ªä½œä¸šå’Œä¸¤ä¸ªé˜Ÿåˆ—è¿è¡Œä¸€äº›éšæœºç”Ÿæˆçš„é—®é¢˜ï¼›è®¡ç®—æ¯ä¸ªçš„ MLFQ æ‰§è¡Œè½¨è¿¹ã€‚é€šè¿‡é™åˆ¶æ¯ä¸ªä½œä¸šçš„é•¿åº¦å’Œå…³é—­ I/O è®©æ‚¨çš„ç”Ÿæ´»æ›´è½»æ¾ã€‚ ä¾‹å­ï¼špython mlfq.py -n 2 -j 2 -m 20 -M 0 -s 66 Job List: Job 0: startTime 0 - runTime 2 - ioFreq 0 Job 1: startTime 0 - runTime 5 - ioFreq 0 Execution Trace: [ time 0 ] JOB BEGINS by JOB 0 [ time 0 ] JOB BEGINS by JOB 1 [ time 0 ] Run JOB 0 at PRIORITY 1 [ TICKS 9 ALLOT 1 TIME 1 (of 2) ] [ time 1 ] Run JOB 0 at PRIORITY 1 [ TICKS 8 ALLOT 1 TIME 0 (of 2) ] [ time 2 ] FINISHED JOB 0 [ time 2 ] Run JOB 1 at PRIORITY 1 [ TICKS 9 ALLOT 1 TIME 4 (of 5) ] [ time 3 ] Run JOB 1 at PRIORITY 1 [ TICKS 8 ALLOT 1 TIME 3 (of 5) ] [ time 4 ] Run JOB 1 at PRIORITY 1 [ TICKS 7 ALLOT 1 TIME 2 (of 5) ] [ time 5 ] Run JOB 1 at PRIORITY 1 [ TICKS 6 ALLOT 1 TIME 1 (of 5) ] [ time 6 ] Run JOB 1 at PRIORITY 1 [ TICKS 5 ALLOT 1 TIME 0 (of 5) ] [ time 7 ] FINISHED JOB 1 Final statistics: Job 0: startTime 0 - response 0 - turnaround 2 Job 1: startTime 0 - response 2 - turnaround 7 Avg 1: startTime n/a - response 1.00 - turnaround 4.50 æ‚¨å°†å¦‚ä½•è¿è¡Œè°ƒåº¦ç¨‹åºæ¥é‡ç°æœ¬ç« ä¸­çš„æ¯ä¸ªç¤ºä¾‹ï¼Ÿ // Figure 8.2 Long-running Job Over Time \u003epython mlfq.py -n 3 -q 10 -l 0,200,0 -c // Figure 8.3 Along Came An Interactive Job \u003epython mlfq.py -n 3 -q 10 -l 0,180,0:100,20,0 -c // Figure 8.4 A Mixed I/O-intensive and CPU-intensive Workload \u003epython mlfq.py -n 3 -q 10 -l 0,175,0:50,25,1 -i 5 -S -c // Figure 8.5 without priority boost \u003epython mlfq.py -n 3 -q 10 -l 0,120,0:100,50,1:100,50,1 -i 1 -S -c // Figure 8.5 with priority boost python mlfq.py -n 3 -q 10 -l 0,120,0:100,50,1:100,50,1 -i 1 -S -B 50 -c // Figure 8.6 without gaming tolerance \u003e python mlfq.py -n 3 -q 10 -i 1 -S -l 0,200,0:80,100,9 -c // Figure 8.6 with gaming tolerance python mlfq.py -n 3 -q 10 -i 1 -l 0,200,0:80,100,9 -c // Figure 8.7 Lower Priority, Longer Quanta python mlfq.py -n 3 -a 2 -Q 10,20,40 -l 0,200,0:0,200,0 -c å¦‚ä½•é…ç½®è°ƒåº¦ç¨‹åºå‚æ•°ä»¥ä½¿å…¶åƒå¾ªç¯è°ƒåº¦ç¨‹åºä¸€æ ·è¿è¡Œï¼Ÿ åŒä¸€é˜Ÿåˆ—ä¸Šçš„ä½œä¸šæ˜¯æŒ‰æ—¶é—´åˆ†ç‰‡çš„ï¼Œå› æ­¤ç­”æ¡ˆæ˜¯åªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ã€‚ ä½¿ç”¨ä¸¤ä¸ªä½œä¸šå’Œè°ƒåº¦ç¨‹åºå‚æ•°åˆ¶ä½œä¸€ä¸ªå·¥ä½œè´Ÿè½½ï¼Œä»¥ä¾¿ä¸€ä¸ªä½œä¸šåˆ©ç”¨æ—§çš„è§„åˆ™ 4a å’Œ 4bï¼ˆä½¿ç”¨ -S å‚æ•°æ‰“å¼€ï¼‰æ¥æ¬ºéª—è°ƒåº¦ç¨‹åºå¹¶åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹è·å¾— 99% çš„ CPU å ç”¨ç‡æ—¶é—´é—´éš”ã€‚ é¦–å…ˆï¼Œä½¿ç”¨ -i å°† I/O æ—¶é—´è®¾ç½®ä¸º 1ï¼Œç„¶åç¡®ä¿ CPU hog åœ¨ 100 ä¸ªç‚¹å‡»æ—¶é—´ç‰‡é•¿åº¦çš„ç¬¬ 99 ä¸ªç‚¹å‡»æ—¶è°ƒç”¨ I/O æ“ä½œã€‚å¦å¤–ï¼ŒåŒ…å« -I æ ‡å¿—ä»¥ç¡®ä¿ CPU å ç”¨è€…åœ¨ I/O è¯·æ±‚å®Œæˆæ—¶é‡æ–°è·å¾—æ§åˆ¶æƒï¼š python mlfq.py -S -i 1 -l 0,297,99:0,60,0 -q 100 -n 3 -I -c ç»™å®šä¸€ä¸ªç³»ç»Ÿï¼Œå…¶æœ€é«˜é˜Ÿåˆ—çš„æ—¶é—´ç‰‡é•¿åº¦ä¸º 10 æ¯«ç§’ï¼Œæ‚¨éœ€è¦å¤šä¹…å°†ä½œä¸šæå‡å›æœ€é«˜ä¼˜å…ˆçº§ï¼ˆä½¿ç”¨ -B æ ‡å¿—ï¼‰æ‰èƒ½ä¿è¯å•ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä½œä¸šï¼ˆå¹¶ä¸”å¯èƒ½ä¼šé¥¥é¥¿ï¼‰ä½œä¸šè‡³å°‘è·å¾— 5% çš„ CPU èµ„æºï¼Ÿ å¦‚æœæ¯ 10 æ¯«ç§’å°±æœ‰ä¸€ä¸ªæ–°çš„ 10 æ¯«ç§’é•¿ä½œä¸šåˆ°è¾¾ - å¦‚å›¾ 8.5ï¼ˆå·¦ï¼‰æ‰€ç¤ºï¼Œæ¯ 200 ä¸ªæ—¶é’Ÿå‘¨æœŸæå‡å¯ç¡®ä¿é•¿è¿›ç¨‹å°†è¿è¡Œ 10/200 ä¸ª CPU å‘¨æœŸ = 5%ã€‚ è°ƒåº¦ä¸­å‡ºç°çš„ä¸€ä¸ªé—®é¢˜æ˜¯åœ¨é˜Ÿåˆ—çš„å“ªä¸€ç«¯æ·»åŠ åˆšåˆšå®Œæˆ I/O çš„ä½œä¸šï¼› -I å‚æ•°æ›´æ”¹æ­¤è°ƒåº¦æ¨¡æ‹Ÿå™¨çš„æ­¤è¡Œä¸ºã€‚å°è¯•ä¸€äº›å·¥ä½œè´Ÿè½½ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥çœ‹åˆ°æ­¤å‚æ•°çš„æ•ˆæœã€‚ python mlfq.py -n 2 -q 10 -l 0,50,0:0,50,11 -i 1 -S -c python mlfq.py -n 2 -q 10 -l 0,50,0:0,50,11 -i 1 -S -I -c ä½¿ç”¨-Içš„å‘¨è½¬æ—¶é—´ä¸‹é™äº†å¾ˆå¤šã€‚ ","date":"2024-04-25","objectID":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/:3:0","tags":["OS"],"title":"å¤šçº§åé¦ˆé˜Ÿåˆ—","uri":"/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"githubä»£ç  ","date":"2024-04-25","objectID":"/posts/04.cpu%E8%B0%83%E5%BA%A6/:0:0","tags":["OS"],"title":"CPUè°ƒåº¦","uri":"/posts/04.cpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 Program Explanation ç¨‹åºscheduler.pyå…è®¸æ‚¨æŸ¥çœ‹ä¸åŒè°ƒåº¦ç¨‹åºåœ¨å“åº”æ—¶é—´ã€å‘¨è½¬æ—¶é—´å’Œæ€»ç­‰å¾…æ—¶é—´ç­‰è°ƒåº¦æŒ‡æ ‡ä¸‹çš„æ‰§è¡Œæƒ…å†µã€‚ â€œå®ç°â€äº†ä¸‰ä¸ªè°ƒåº¦ç¨‹åºï¼šFIFOã€SJF å’Œ RRã€‚ è¦è¿è¡Œè¯¥ç¨‹åºè·å–å…¶é€‰é¡¹ï¼Œå¯æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š ./scheduler.py -h æˆ–è€… python scheduler.py -h å¾—åˆ°ï¼š â¯ python scheduler.py -h Usage: scheduler.py [options] Options: -h, --help show this help message and exit -s SEED, --seed=SEED the random seed -j JOBS, --jobs=JOBS number of jobs in the system -l JLIST, --jlist=JLIST instead of random jobs, provide a comma-separated list of run times -m MAXLEN, --maxlen=MAXLEN max length of job -p POLICY, --policy=POLICY sched policy to use: SJF, FIFO, RR -q QUANTUM, --quantum=QUANTUM length of time slice for RR policy -c compute answers for me é¦–å…ˆï¼Œåœ¨ä¸å¸¦ -c é€‰é¡¹çš„æƒ…å†µä¸‹è¿è¡Œï¼šè¿™ä¼šå‘æ‚¨æ˜¾ç¤ºè¦è§£å†³çš„é—®é¢˜è€Œä¸é€éœ²ç­”æ¡ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦ä½¿ç”¨ FIFO ç­–ç•¥è®¡ç®—å“åº”ã€å‘¨è½¬å’Œç­‰å¾…ä¸‰ä¸ªä½œä¸šï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š python scheduler.py -p FIFO -j 3 -s 100 è¿™æŒ‡å®šäº†å…·æœ‰ä¸‰ä¸ªä½œä¸šçš„ FIFO ç­–ç•¥ï¼Œè€Œä¸”é‡è¦çš„æ˜¯ï¼ŒæŒ‡å®šäº† 100 çš„ç‰¹å®šéšæœºç§å­ã€‚å¦‚æœæ‚¨æƒ³æŸ¥çœ‹è¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œåˆ™å¿…é¡»å†æ¬¡æŒ‡å®šè¯¥å®Œå…¨ç›¸åŒçš„éšæœºç§å­ã€‚è®©æˆ‘ä»¬è¿è¡Œä¸€ä¸‹ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚è¿™æ˜¯æ‚¨åº”è¯¥çœ‹åˆ°çš„ï¼š â¯ python scheduler.py -p FIFO -j 3 -s 100 ARG policy FIFO ARG jobs 3 ARG maxlen 10 ARG seed 100 Here is the job list, with the run time of each job: Job 0 ( length = 2 ) Job 1 ( length = 5 ) Job 2 ( length = 8 ) Compute the turnaround time, response time, and wait time for each job. When you are done, run this program again, with the same arguments, but with -c, which will thus provide you with the answers. You can use -s \u003csomenumber\u003e or your own job list (-l 10,15,20 for example) to generate different problems for yourself. è®¡ç®—æ¯ä¸ªä½œä¸šçš„å‘¨è½¬æ—¶é—´ã€å“åº”æ—¶é—´å’Œç­‰å¾…æ—¶é—´ã€‚å®Œæˆåï¼Œä½¿ç”¨ç›¸åŒçš„å‚æ•°å†æ¬¡è¿è¡Œè¯¥ç¨‹åºï¼Œä½†ä½¿ç”¨ -cé€‰é¡¹ï¼Œè¿™å°†ä¸ºæ‚¨æä¾›ç­”æ¡ˆã€‚æ‚¨å¯ä»¥ä½¿ç”¨ -s æˆ–æ‚¨è‡ªå·±çš„ä½œä¸šåˆ—è¡¨ï¼ˆä¾‹å¦‚ -l 10,15,20ï¼‰ä¸ºè‡ªå·±ç”Ÿæˆä¸åŒçš„é—®é¢˜ã€‚ ä»è¿™ä¸ªä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œç”Ÿæˆäº†ä¸‰ä¸ªä½œä¸šï¼šé•¿åº¦ä¸º 2 çš„ä½œä¸š 0ã€é•¿åº¦ä¸º 5 çš„ä½œä¸š 1 å’Œé•¿åº¦ä¸º 8 çš„ä½œä¸š 2ã€‚æ­£å¦‚ç¨‹åºæ‰€è¿°ï¼Œæ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¡ç®—ä¸€äº›ç»Ÿè®¡æ•°æ®ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥æŒæ¡åŸºæœ¬æ¦‚å¿µã€‚ å®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ç¨‹åºæ¥â€œè§£å†³â€é—®é¢˜å¹¶æŸ¥çœ‹æ‚¨çš„å·¥ä½œæ˜¯å¦æ­£ç¡®ã€‚ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨â€œ-câ€é€‰é¡¹ã€‚è¾“å‡ºï¼š â¯ python scheduler.py -p FIFO -j 3 -s 100 -c ARG policy FIFO ARG jobs 3 ARG maxlen 10 ARG seed 100 Here is the job list, with the run time of each job: Job 0 ( length = 2 ) Job 1 ( length = 5 ) Job 2 ( length = 8 ) ** Solutions ** Execution trace: [ time 0 ] Run job 0 for 2.00 secs ( DONE at 2.00 ) [ time 2 ] Run job 1 for 5.00 secs ( DONE at 7.00 ) [ time 7 ] Run job 2 for 8.00 secs ( DONE at 15.00 ) Final statistics: Job 0 -- Response: 0.00 Turnaround 2.00 Wait 0.00 Job 1 -- Response: 2.00 Turnaround 7.00 Wait 2.00 Job 2 -- Response: 7.00 Turnaround 15.00 Wait 7.00 Average -- Response: 3.00 Turnaround 8.00 Wait 3.00 ä»ä¸Šè¿°è¾“å‡ºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä½œä¸š0é¦–å…ˆè¿è¡Œäº†2ç§’ï¼Œä½œä¸š2æ¥ç€è¿è¡Œäº†5ç§’ï¼Œæœ€åä½œä¸š2è¿è¡Œäº†8ç§’ã€‚ æœ€ç»ˆçš„ç»Ÿè®¡æ•°æ®ä¹Ÿå¾ˆæœ‰ç”¨ï¼šå®ƒä»¬è®¡ç®—â€œå“åº”æ—¶é—´â€ï¼ˆä½œä¸šåˆ°è¾¾åç¬¬ä¸€æ¬¡è¿è¡Œä¹‹å‰ç­‰å¾…æ‰€èŠ±è´¹çš„æ—¶é—´ï¼‰ã€â€œå‘¨è½¬æ—¶é—´â€ï¼ˆè‡ªç¬¬ä¸€æ¬¡åˆ°è¾¾ä»¥æ¥å®Œæˆä½œä¸šæ‰€èŠ±è´¹çš„æ—¶é—´ï¼‰ä»¥åŠæ€»æ—¶é—´ã€‚ â€œç­‰å¾…æ—¶é—´â€ï¼ˆå‡†å¤‡å¥½ä½†æœªè¿è¡Œçš„ä»»ä½•æ—¶é—´ï¼‰ã€‚ç»Ÿè®¡æ•°æ®æŒ‰ä½œä¸šæ˜¾ç¤ºï¼Œç„¶åæ˜¾ç¤ºæ‰€æœ‰ä½œä¸šçš„å¹³å‡å€¼ã€‚å½“ç„¶ï¼Œæ‚¨åº”è¯¥åœ¨ä½¿ç”¨â€œ-câ€é€‰é¡¹è¿è¡Œä¹‹å‰è®¡ç®—å‡ºæ‰€æœ‰è¿™äº›å†…å®¹ï¼ å¦‚æœæ‚¨æƒ³å°è¯•ç›¸åŒç±»å‹çš„é—®é¢˜ä½†ä½¿ç”¨ä¸åŒçš„è¾“å…¥ï¼Œè¯·å°è¯•æ›´æ”¹ä½œä¸šæ•°é‡æˆ–éšæœºç§å­æˆ–åŒæ—¶æ›´æ”¹ä¸¤è€…ã€‚ä¸åŒçš„éšæœºç§å­åŸºæœ¬ä¸Šä¸ºæ‚¨æä¾›äº†ä¸€ç§ä¸ºè‡ªå·±ç”Ÿæˆæ— æ•°ä¸åŒé—®é¢˜çš„æ–¹æ³•ï¼Œå¹¶ä¸”â€œ-câ€é€‰é¡¹å¯ä»¥è®©æ‚¨æ£€æŸ¥è‡ªå·±çš„å·¥ä½œã€‚ç»§ç»­è¿™æ ·åšï¼Œç›´åˆ°æ‚¨è§‰å¾—è‡ªå·±çœŸæ­£ç†è§£äº†è¿™äº›æ¦‚å¿µã€‚ å¦ä¸€ä¸ªæœ‰ç”¨çš„é€‰é¡¹æ˜¯â€œ-lâ€ï¼ˆè¿™æ˜¯ä¸€ä¸ªå°å†™çš„ Lï¼‰ï¼Œå®ƒå¯ä»¥è®©æ‚¨æŒ‡å®šæ‚¨å¸Œæœ›çœ‹åˆ°çš„è®¡åˆ’çš„ç¡®åˆ‡ä½œä¸šã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³äº†è§£ SJF å¦‚ä½•æ‰§è¡Œé•¿åº¦ä¸º 5ã€10 å’Œ 15 çš„ä¸‰ä¸ªä½œä¸šï¼Œæ‚¨å¯ä»¥è¿è¡Œï¼š â¯ python scheduler.py -p SJF -l 5,10,15 ARG policy SJF ARG jlist 5,10,15 Here is the job list, with the run time of each job: Job 0 ( length = 5.0 ) Job 1 ( length = 10.0 ) Job 2 ( length = 15.0 ) Compute the turnaround time, response time, and wait time for each job. When you are done, run this program again, with the same arguments, but with -c, which will thus provide you with the answers. You can use -s \u003csomenumber\u003e or your own job list (-l 10,15,20 for example) to generate different problems for yourself. è®¡ç®—å®Œåè¿˜æ˜¯é€šè¿‡-cé€‰é¡¹è·å¾—ç­”æ¡ˆã€‚æŒ‡å®šç¡®åˆ‡çš„ä½œä¸šæ—¶ï¼Œæ— é¡»æŒ‡å®šéšæœºç§å­æˆ–è€…ä½œä¸šæ•°é‡ã€‚ æˆ‘ä»¬æœ€åæµ‹è¯•ä¸€ä¸‹RRï¼Œå¯ä»¥è¿è¡Œï¼š â¯ python scheduler.py -p RR -l 5,10,15 -c ARG policy RR ARG jlist 5,10,15 Here is the job list, with the run time of each job: Job 0 ( length = 5.0 ) Job 1 ( length = 10.0 ) Job 2 ( length = 15.0 ) ** Solutions ** Execution trace: [ time 0 ] Run job 0 for 1.00 secs [ time 1 ] Run job 1 for 1.00 secs [ time 2 ] Run job 2 for 1.00 secs [ time 3 ] Run job 0 for 1.00 secs [ time 4 ] Run job 1 for 1.00 secs [ time 5 ] Run job 2 for 1.00 secs [ time 6 ] Run job 0 for 1.00 secs [ time 7 ] Run job 1 for 1.00 secs [ time 8 ] Run job 2 for 1.00 secs [ time 9 ] Run job 0 for 1.00 secs [ time 10 ] Run job 1 for 1.00 secs [ time 11 ] Run job 2 for 1.00 secs [ time 12 ] Run job 0 for 1.00 secs ( DONE at 13.00 ) [ time 13 ] Run job 1 fo","date":"2024-04-25","objectID":"/posts/04.cpu%E8%B0%83%E5%BA%A6/:1:0","tags":["OS"],"title":"CPUè°ƒåº¦","uri":"/posts/04.cpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 QA ä»¥ä¸‹é—®é¢˜éƒ½å¯ä»¥é€šè¿‡scheduler.pyè¿›è¡ŒéªŒè¯ ä½¿ç”¨ SJF å’Œ FIFO è°ƒåº¦å™¨è¿è¡Œé•¿åº¦ä¸º 200 çš„ä¸‰ä¸ªä½œä¸šæ—¶ï¼Œè®¡ç®—å“åº”æ—¶é—´å’Œå‘¨è½¬æ—¶é—´ SJF $turnaround = \\frac{200-0+400-0+600-0}{3}=400$ $response=\\frac{0+200+400}{3}=200$ FIFO è·ŸSJFä¸€æ · ç°åœ¨æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œä½†ä½¿ç”¨ä¸åŒé•¿åº¦çš„ä½œä¸šï¼š100ã€200 å’Œ 300ã€‚ SJF $turnaround = \\frac{100-0+300-0+600-0}{3}=333$ $response=\\frac{0+100+300}{3}=133$ FIFO ç”±äºåˆ°è¾¾æ—¶é—´æ˜¯ä¸€æ ·ï¼Œæ‰€ä»¥è°ƒåº¦å…·æœ‰ä¸ç¡®å®šæ€§ï¼Œæœ€ä½³æ–¹æ¡ˆå°±æ˜¯å’ŒSJFä¸€æ ·ã€‚ ç°åœ¨æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œä½†ä¹Ÿä½¿ç”¨ RR è°ƒåº¦ç¨‹åºå’Œæ—¶é—´ç‰‡ 1 å¯¹äºRRï¼Œ$response=\\frac{0+1+2}{3}=1$ $turnaround=\\frac{298+499+600}{3}=265.67$ åœ¨å“ªäº›ç±»å‹çš„å·¥ä½œè´Ÿè½½ä¸­ï¼ŒSJF çš„å‘¨è½¬æ—¶é—´ä¸ FIFO ç›¸åŒï¼Ÿ SJF å§‹ç»ˆæä¾›ä¸ FIFO ç›¸åŒçš„å‘¨è½¬æ—¶é—´ï¼Œé™¤éè¾ƒçŸ­çš„ä½œä¸šåœ¨è¾ƒé•¿çš„ä½œä¸šä¹‹ååˆ°è¾¾ã€‚åªè¦æ‰€æœ‰ä½œä¸šé•¿åº¦ç›¸ç­‰æˆ–æŒ‰å‡åºåˆ°è¾¾ï¼Œå‘¨è½¬æ—¶é—´å°±ä¼šç›¸åŒã€‚ åœ¨å“ªäº›ç±»å‹çš„å·¥ä½œè´Ÿè½½å’Œæ—¶é—´ç‰‡é•¿åº¦ä¸‹ï¼ŒSJF å¯ä»¥æä¾›ä¸ RR ç›¸åŒçš„å“åº”æ—¶é—´ï¼Ÿ å¦‚æœæ‰€æœ‰ä½œä¸šé•¿åº¦(x)ç›¸åŒï¼Œä¸”æ—¶é—´ç‰‡é•¿åº¦(q)=xï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒSJFæä¾›ä¸RRç›¸åŒçš„å“åº”æ—¶é—´ã€‚é€šè¿‡è¿è¡Œä»¥ä¸‹ä»£ç éªŒè¯ï¼š ./scheduler.py -p SJF -l 100,100,100 -c ./scheduler.py -p RR -l 100,100,100 -c -q 100 éšç€ä½œä¸šé•¿åº¦çš„å¢åŠ ï¼ŒSJF çš„å“åº”æ—¶é—´ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿæ‚¨èƒ½å¦ä½¿ç”¨æ¨¡æ‹Ÿå™¨æ¥æ¼”ç¤ºè¿™ä¸€è¶‹åŠ¿ï¼Ÿ å¦‚æœæˆ‘ä»¬å°†æ¯ä¸ªå·¥ä½œçš„é•¿åº¦åŠ å€ï¼Œå¹³å‡å“åº”æ—¶é—´ä¹Ÿä¼šåŠ å€ã€‚è¿™æ„å‘³ç€å·¥ä½œé•¿åº¦å’Œå“åº”æ—¶é—´ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»ã€‚ éšç€æ—¶é—´ç‰‡é•¿åº¦çš„å¢åŠ ï¼ŒRR çš„å“åº”æ—¶é—´ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿä½ èƒ½å†™å‡ºä¸€ä¸ªæ–¹ç¨‹ï¼Œåœ¨ç»™å®š N ä¸ªä½œä¸šçš„æƒ…å†µä¸‹ç»™å‡ºæœ€åæƒ…å†µçš„å“åº”æ—¶é—´å—ï¼Ÿ å“åº”æ—¶é—´éšç€æ—¶é—´ç‰‡é•¿åº¦çš„å¢åŠ è€Œçº¿æ€§å¢åŠ ã€‚ä»¤ N ä¸ºä½œä¸šæ•°é‡ï¼Œq ä¸ºæ—¶é—´ç‰‡é•¿åº¦ï¼Œåˆ™æœ€åæƒ…å†µçš„å“åº”æ—¶é—´ä¸º $\\frac{(N-1)q}{N}$ã€‚ ","date":"2024-04-25","objectID":"/posts/04.cpu%E8%B0%83%E5%BA%A6/:2:0","tags":["OS"],"title":"CPUè°ƒåº¦","uri":"/posts/04.cpu%E8%B0%83%E5%BA%A6/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"githubä»£ç  åœ¨æœ¬ä½œä¸šä¸­ï¼Œæ‚¨å°†æµ‹é‡ç³»ç»Ÿè°ƒç”¨å’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬ã€‚æµ‹é‡ç³»ç»Ÿè°ƒç”¨çš„æˆæœ¬ç›¸å¯¹å®¹æ˜“ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åå¤è°ƒç”¨ä¸€ä¸ªç®€å•çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚æ‰§è¡Œ 0 å­—èŠ‚è¯»å–ï¼‰ï¼Œå¹¶è®¡ç®—æ‰€éœ€æ—¶é—´ï¼›å°†æ—¶é—´é™¤ä»¥è¿­ä»£æ¬¡æ•°ï¼Œå°±èƒ½ä¼°ç®—å‡ºç³»ç»Ÿè°ƒç”¨çš„æˆæœ¬ã€‚ æ‚¨å¿…é¡»è€ƒè™‘çš„ä¸€ä»¶äº‹æ˜¯è®¡æ—¶å™¨çš„ç²¾åº¦å’Œå‡†ç¡®æ€§ã€‚å¯ä»¥ä½¿ç”¨çš„å…¸å‹è®¡æ—¶å™¨æ˜¯ gettimeofday()ï¼›é˜…è¯»æ‰‹å†Œé¡µäº†è§£è¯¦ç»†ä¿¡æ¯ã€‚æ‚¨å°†çœ‹åˆ° gettimeofday() è¿”å› 1970 å¹´ä»¥æ¥çš„æ—¶é—´ï¼ˆä»¥å¾®ç§’ä¸ºå•ä½ï¼‰ï¼›ç„¶è€Œï¼Œè¿™å¹¶ä¸æ„å‘³ç€è®¡æ—¶å™¨ç²¾ç¡®åˆ°å¾®ç§’ã€‚æµ‹é‡å¯¹ gettimeofday() çš„è¿ç»­è°ƒç”¨ï¼Œä»¥äº†è§£è®¡æ—¶å™¨çš„ç²¾ç¡®åº¦ï¼›è¿™å°†å‘Šè¯‰æ‚¨å¿…é¡»è¿è¡Œå¤šå°‘æ¬¡ç©ºç³»ç»Ÿè°ƒç”¨æµ‹è¯•è¿­ä»£æ‰èƒ½è·å¾—è‰¯å¥½çš„æµ‹é‡ç»“æœã€‚å¦‚æœ gettimeofday() å¯¹æ‚¨æ¥è¯´ä¸å¤Ÿç²¾ç¡®ï¼Œæ‚¨å¯ä»¥è€ƒè™‘ä½¿ç”¨ x86 æœºå™¨ä¸Šå¯ç”¨çš„ rdtsc æŒ‡ä»¤ã€‚ æµ‹é‡ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬æ¯”è¾ƒéº»çƒ¦ã€‚lmbench åŸºå‡†æµ‹è¯•çš„æ–¹æ³•æ˜¯åœ¨å•ä¸ª CPU ä¸Šè¿è¡Œä¸¤ä¸ªè¿›ç¨‹ï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´è®¾ç½®ä¸¤ä¸ª UNIX ç®¡é“ï¼›ç®¡é“åªæ˜¯ UNIX ç³»ç»Ÿä¸­è¿›ç¨‹ç›¸äº’é€šä¿¡çš„ä¼—å¤šæ–¹å¼ä¹‹ä¸€ã€‚ç¬¬ä¸€ä¸ªè¿›ç¨‹å‘ç¬¬ä¸€ä¸ªç®¡é“å‘å‡ºå†™æ“ä½œï¼Œå¹¶ç­‰å¾…ç¬¬äºŒä¸ªç®¡é“çš„è¯»æ“ä½œï¼›å½“çœ‹åˆ°ç¬¬ä¸€ä¸ªè¿›ç¨‹åœ¨ç­‰å¾…ä»ç¬¬äºŒä¸ªç®¡é“è¯»å–æ•°æ®æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†ç¬¬ä¸€ä¸ªè¿›ç¨‹ç½®äºé˜»å¡çŠ¶æ€ï¼Œå¹¶åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œåè€…ä»ç¬¬ä¸€ä¸ªç®¡é“è¯»å–æ•°æ®ï¼Œç„¶åå‘ç¬¬äºŒä¸ªç®¡é“å†™æ“ä½œã€‚å½“ç¬¬äºŒä¸ªè¿›ç¨‹å†æ¬¡å°è¯•ä»ç¬¬ä¸€ä¸ªç®¡é“è¯»å–æ•°æ®æ—¶ï¼Œå®ƒå°±ä¼šé˜»å¡ï¼Œè¿™æ ·æ¥å›å¾ªç¯çš„é€šä¿¡å°±ç»§ç»­è¿›è¡Œã€‚é€šè¿‡æµ‹é‡è¿™æ ·åå¤é€šä¿¡çš„æˆæœ¬ï¼Œlmbench å¯ä»¥å¾ˆå¥½åœ°ä¼°ç®—å‡ºä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬ã€‚æ‚¨å¯ä»¥å°è¯•ä½¿ç”¨ç®¡é“æˆ–å…¶ä»–é€šä¿¡æœºåˆ¶ï¼ˆå¦‚ UNIX å¥—æ¥å­—ï¼‰åœ¨è¿™é‡Œé‡æ–°åˆ›å»ºç±»ä¼¼çš„åŠŸèƒ½ã€‚ åœ¨æ‹¥æœ‰å¤šä¸ª CPU çš„ç³»ç»Ÿä¸­ï¼Œæµ‹é‡ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬æ˜¯ä¸ªéš¾é¢˜ï¼›åœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­ï¼Œä½ éœ€è¦åšçš„æ˜¯ç¡®ä¿ä¸Šä¸‹æ–‡åˆ‡æ¢è¿›ç¨‹ä½äºåŒä¸€ä¸ªå¤„ç†å™¨ä¸Šã€‚å¹¸è¿çš„æ˜¯ï¼Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿéƒ½æœ‰å°†è¿›ç¨‹ç»‘å®šåˆ°ç‰¹å®šå¤„ç†å™¨çš„è°ƒç”¨ï¼›ä¾‹å¦‚ï¼Œåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œè°ƒç”¨ sched_setaffinity() å°±æ˜¯ä½ è¦æ‰¾çš„ã€‚é€šè¿‡ç¡®ä¿ä¸¤ä¸ªè¿›ç¨‹ä½äºåŒä¸€å¤„ç†å™¨ä¸Šï¼Œå°±èƒ½ç¡®ä¿è¡¡é‡æ“ä½œç³»ç»Ÿåœ¨åŒä¸€ CPU ä¸Šåœæ­¢ä¸€ä¸ªè¿›ç¨‹å¹¶æ¢å¤å¦ä¸€ä¸ªè¿›ç¨‹çš„æˆæœ¬ã€‚ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cunistd.h\u003e #include \u003csys/time.h\u003e #define ITERATIONS 1000 // Measure the cost of a system call void measure_system_call() { struct timeval start, end; gettimeofday(\u0026start, NULL); for (int i = 0; i \u003c ITERATIONS; i++) { read(0, NULL, 0); // Example of a simple system call } gettimeofday(\u0026end, NULL); double time_per_call = ((double)(end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec)) / ITERATIONS; printf(\"Estimated cost of a system call: %f microseconds\\n\", time_per_call); } // Measure the precision of gettimeofday() void measure_gettimeofday_precision() { struct timeval start, end; gettimeofday(\u0026start, NULL); for (int i = 0; i \u003c ITERATIONS; i++) { gettimeofday(\u0026end, NULL); } double precision = ((double)(end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec)) / ITERATIONS; printf(\"Precision of gettimeofday(): %f microseconds\\n\", precision); } // Measure the cost of a context switch void measure_context_switch() { int pipefd[2]; if (pipe(pipefd) == -1) { perror(\"pipe\"); exit(EXIT_FAILURE); } pid_t pid = fork(); if (pid == -1) { perror(\"fork\"); exit(EXIT_FAILURE); } if (pid == 0) { // Child process close(pipefd[1]); struct timeval start, end; gettimeofday(\u0026start, NULL); read(pipefd[0], NULL, 0); gettimeofday(\u0026end, NULL); double time_diff = (end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec); printf(\"Child process context switch time: %f microseconds\\n\", time_diff); exit(EXIT_SUCCESS); } else { // Parent process close(pipefd[0]); struct timeval start, end; gettimeofday(\u0026start, NULL); write(pipefd[1], \"\", 1); wait(NULL); gettimeofday(\u0026end, NULL); double time_diff = (end.tv_sec - start.tv_sec) * 1000000 + (end.tv_usec - start.tv_usec); printf(\"Parent process context switch time: %f microseconds\\n\", time_diff); } } int main() { measure_system_call(); measure_gettimeofday_precision(); measure_context_switch(); return 0; } è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š Estimated cost of a system call: 0.333000 microseconds Precision of gettimeofday(): 0.014000 microseconds Child process context switch time: 1.000000 microseconds Parent process context switch time: 160.000000 microseconds ","date":"2024-04-25","objectID":"/posts/03.%E6%9C%89%E9%99%90%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C/:0:0","tags":["OS"],"title":"æœ‰é™ç›´æ¥æ‰§è¡Œ","uri":"/posts/03.%E6%9C%89%E9%99%90%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"githubä»£ç  ç¼–å†™ä¸€ä¸ªè°ƒç”¨ fork() çš„ç¨‹åºã€‚åœ¨è°ƒç”¨ fork() ä¹‹å‰ï¼Œè®©ä¸»è¿›ç¨‹è®¿é—®ä¸€ä¸ªå˜é‡ï¼ˆå¦‚ xï¼‰å¹¶å°†å…¶å€¼è®¾ä¸ºæŸä¸ªå€¼ï¼ˆå¦‚ 100ï¼‰ã€‚å­è¿›ç¨‹ä¸­çš„å˜é‡å€¼æ˜¯å¤šå°‘ï¼Ÿå½“å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹éƒ½æ”¹å˜ x çš„å€¼æ—¶ï¼Œå˜é‡ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿ è°ƒç”¨forkä¼šåˆ›å»ºä¸€ä¸ªä¸çˆ¶è¿›ç¨‹å‡ ä¹å®Œå…¨ä¸€æ ·çš„å‰¯æœ¬ï¼Œä¸”ä¼šå¤åˆ¶å½“å‰æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥å­è¿›ç¨‹ä¸­çš„å˜é‡å€¼æ˜¯100ï¼Œå®ƒä»¬æ”¹å˜xçš„å€¼éƒ½æ˜¯äº’ä¸å½±å“çš„ã€‚æ‰§è¡Œpython q1.pyå¯å¾—åˆ°ç»“æœå¦‚ä¸‹ï¼š Parent process - x: 100 Parent process - x after modification: 150 Child process - x: 100 Child process - x after modification: 50 ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼ˆä½¿ç”¨ open() ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œç„¶åè°ƒç”¨ fork() åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ã€‚å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹éƒ½èƒ½è®¿é—® open() è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦å—ï¼Ÿå½“å®ƒä»¬åŒæ—¶ï¼ˆå³åŒæ—¶ï¼‰å‘æ–‡ä»¶å†™å…¥æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ çˆ¶è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦ä¹Ÿä¼šç»§æ‰¿ï¼Œæ‰€ä»¥å­è¿›ç¨‹ä¹Ÿå¯ä»¥å¾€ test.txtå†™å…¥æ¶ˆæ¯ï¼Œè™½ç„¶çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å®ƒä»¬å„è‡ªçš„æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„æ˜¯ç›¸åŒæ–‡ä»¶çš„ä¸åŒåç§»ä½ç½®ã€‚åœ¨å†™å…¥æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç»´æŠ¤ä¸¤ä¸ªè¿›ç¨‹çš„æ–‡ä»¶åç§»ï¼Œç¡®ä¿å®ƒä»¬äº’ä¸å¹²æ‰°ã€‚æ‰§è¡Œpython q2.pyå¯éªŒè¯ã€‚ ä½¿ç”¨fork()ç¼–å†™å¦ä¸€ä¸ªç¨‹åºã€‚å­è¿›ç¨‹åº”æ‰“å°â€œhelloâ€ï¼Œçˆ¶è¿›ç¨‹åº”æ‰“å°â€œgoodbyeâ€ã€‚æ‚¨åº”å°½é‡ç¡®ä¿å­è¿›ç¨‹å§‹ç»ˆå…ˆæ‰“å°ï¼›æ‚¨èƒ½åœ¨ä¸åœ¨çˆ¶è¿›ç¨‹ä¸­è°ƒç”¨wait()çš„æƒ…å†µä¸‹å®ç°å—ï¼Ÿ å¦‚æœä¸ä½¿ç”¨waitï¼Œåˆ™å¯ä»¥ä½¿ç”¨time.sleep()é€šè¿‡çŸ­æš‚çš„ä¼‘çœ æ¥å®ç°ã€‚æ‰§è¡Œpython q3.pyå¯éªŒè¯ç»“æœã€‚ ç¼–å†™ä¸€ä¸ªè°ƒç”¨fork()ç„¶åè°ƒç”¨æŸç§å½¢å¼çš„exec()æ¥è¿è¡Œç¨‹åº/bin/lsçš„ç¨‹åºã€‚çœ‹çœ‹ä½ èƒ½å¦å°è¯•æ‰€æœ‰çš„exec()å˜ä½“ï¼ŒåŒ…æ‹¬ï¼ˆåœ¨Linuxä¸Šï¼‰execl()ã€execle()ã€execlp()ã€execv()ã€execvp()å’Œexecvpe(). ä¸ºä»€ä¹ˆä½ è®¤ä¸ºåŒä¸€åŸºæœ¬è°ƒç”¨æœ‰è¿™ä¹ˆå¤šå˜ä½“ï¼Ÿ q4.pyå°è¯•äº†æ‰€æœ‰çš„å˜ä½“ã€‚è¿™äº›å˜ä½“çš„å­˜åœ¨ä¸»è¦æ˜¯ä¸ºäº†æä¾›ä¸åŒçš„å‚æ•°ä¼ é€’æ–¹å¼å’Œç¯å¢ƒè®¾ç½®ï¼Œä»¥æ»¡è¶³ä¸åŒçš„ç¼–ç¨‹éœ€æ±‚å’Œåœºæ™¯ã€‚å…·ä½“å¦‚ä¸‹ï¼š execl()å’Œexeclp()ï¼š execl()æ¥å—ä¸€ä¸ªå¯å˜æ•°é‡çš„å‚æ•°ï¼Œç”¨äºæŒ‡å®šæ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ä»¥åŠå‘½ä»¤è¡Œå‚æ•°ï¼Œå‚æ•°åˆ—è¡¨ä»¥NULLç»“å°¾ã€‚ execlp()å‡½æ•°æ¥å—ä¸execl()ç›¸åŒçš„å‚æ•°åˆ—è¡¨ï¼Œä½†å®ƒè¿˜ä¼šåœ¨ç³»ç»Ÿçš„PATHç¯å¢ƒå˜é‡ä¸­æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚ execv()å’Œexecvp()ï¼š execv()æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ‰§è¡Œçš„æ–‡ä»¶çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè¡¨ç¤ºå‘½ä»¤è¡Œå‚æ•°ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ é€šå¸¸æ˜¯æ‰§è¡Œæ–‡ä»¶çš„åç§°ã€‚ execvp()å‡½æ•°ä¸execv()ç±»ä¼¼ï¼Œä½†å®ƒä¼šåœ¨ç³»ç»Ÿçš„PATHç¯å¢ƒå˜é‡ä¸­æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚ execle()å’Œexecvpe()ï¼š execle()å‡½æ•°å…è®¸æŒ‡å®šæ–°ç¨‹åºçš„ç¯å¢ƒå˜é‡ï¼Œå®ƒæ¥å—ä¸€ä¸ªé¢å¤–çš„å‚æ•°environï¼Œç”¨äºä¼ é€’ç¯å¢ƒå˜é‡æ•°ç»„ã€‚ execvpe()å‡½æ•°å…è®¸æŒ‡å®šæ–°ç¨‹åºçš„ç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”ä¼šåœ¨ç³»ç»Ÿçš„PATHç¯å¢ƒå˜é‡ä¸­æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚ ç°åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­ä½¿ç”¨wait()ç­‰å¾…å­è¿›ç¨‹å®Œæˆã€‚wait()è¿”å›ä»€ä¹ˆï¼Ÿå¦‚æœåœ¨å­è¿›ç¨‹ä¸­ä½¿ç”¨wait()ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ wait()è¿”å›çš„çŠ¶æ€ä¿¡æ¯é€šå¸¸æ˜¯ä¸€ä¸ª16ä½çš„æ•´æ•°ï¼Œå…¶ä¸­é«˜8ä½å­˜å‚¨äº†å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ç ï¼Œä½8ä½å­˜å‚¨äº†ç»ˆæ­¢ä¿¡å·çš„ç¼–å·ï¼ˆå¦‚æœå­è¿›ç¨‹æ˜¯ç”±ä¿¡å·ç»ˆæ­¢çš„è¯ï¼‰ã€‚å¦‚æœåœ¨å­è¿›ç¨‹ä¸­è°ƒç”¨wait()å‡½æ•°ï¼Œç”±äºå­è¿›ç¨‹æ²¡æœ‰å­è¿›ç¨‹ï¼Œwait()å‡½æ•°ä¼šç«‹å³è¿”å›-1ï¼Œå¹¶è®¾ç½® errno ä¸º ECHILDã€‚å®éªŒè§q5.py å¯¹ä¹‹å‰çš„ç¨‹åºç¨ä½œä¿®æ”¹ï¼Œè¿™æ¬¡ä½¿ç”¨ waitpid() è€Œä¸æ˜¯ wait()ã€‚ waitpid() ä»€ä¹ˆæ—¶å€™æœ‰ç”¨ï¼Ÿ å½“æ‚¨æƒ³è¦ç­‰å¾…ç‰¹å®šå­è¿›ç¨‹å®Œæˆè€Œä¸æ˜¯åƒ wait() é‚£æ ·ç­‰å¾…ä»»ä½•å­è¿›ç¨‹å®Œæˆæ—¶ï¼Œwaitpid() éå¸¸æœ‰ç”¨ã€‚å®ƒå…è®¸æ‚¨æŒ‡å®šæ‚¨æœ‰å…´è¶£ç­‰å¾…çš„å­è¿›ç¨‹çš„ PIDã€‚è¿™åœ¨çˆ¶è¿›ç¨‹ç”Ÿæˆå¤šä¸ªå­è¿›ç¨‹å¹¶éœ€è¦å•ç‹¬å¤„ç†å®ƒä»¬çš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚ ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶ååœ¨å­è¿›ç¨‹ä¸­å…³é—­æ ‡å‡†è¾“å‡ºï¼ˆSTDOUT FILENOï¼‰ã€‚å¦‚æœå­è¿›ç¨‹åœ¨å…³é—­æè¿°ç¬¦åè°ƒç”¨ printf() æ¥æ‰“å°ä¸€äº›è¾“å‡ºï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å¦‚æœæˆ‘ä»¬å…³é—­ stdout æ–‡ä»¶æè¿°ç¬¦ï¼Œæˆ‘ä»¬å°†æ— æ³•ä½¿ç”¨ printf() åœ¨å±å¹•ä¸Šå†™å…¥å†…å®¹ã€‚ä½†ä¸ä¼šå‘ç”Ÿä»»ä½•é”™è¯¯ã€‚ ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œåˆ›å»ºä¸¤ä¸ªå­è¿›ç¨‹ï¼Œå¹¶ä½¿ç”¨pipe()ç³»ç»Ÿè°ƒç”¨å°†ä¸€ä¸ªå­è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºè¿æ¥åˆ°å¦ä¸€ä¸ªå­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ã€‚ æˆ‘ä»¬ä½¿ç”¨ pipe() ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå¦‚æœä¸æˆåŠŸåˆ™é€€å‡ºã€‚æˆ‘ä»¬é€šè¿‡ fork() è°ƒç”¨åˆ›å»ºç¬¬ä¸€ä¸ªå­è¿›ç¨‹ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º Aï¼‰ï¼Œç„¶åï¼Œåœ¨ä¸ºçˆ¶è¿›ç¨‹è¿è¡Œçš„ä»£ç éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬è¿›è¡Œç¬¬äºŒä¸ª fork() è°ƒç”¨æ¥åˆ›å»ºç¬¬äºŒä¸ªå­è¿›ç¨‹ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º Bï¼‰ã€‚ A ä½¿ç”¨ dup2 ä½¿ stdout æŒ‡å‘ç®¡é“çš„å†™å…¥ç«¯ï¼Œå¹¶å‘ç®¡é“çš„å†™å…¥ç«¯ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚Bä½¿ç”¨dup2ä½¿stdinæŒ‡å‘ç®¡é“çš„è¯»å–ç«¯ï¼Œå¹¶ä»ç®¡é“çš„è¯»å–ç«¯è¯»å–ã€‚è¿™å°† A çš„æ ‡å‡†è¾“å‡ºè¿æ¥åˆ° B çš„æ ‡å‡†è¾“å…¥ã€‚ ","date":"2024-04-25","objectID":"/posts/02.%E8%BF%9B%E7%A8%8Bapi/:0:0","tags":["OS"],"title":"è¿›ç¨‹API","uri":"/posts/02.%E8%BF%9B%E7%A8%8Bapi/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"githubä»£ç  ","date":"2024-04-25","objectID":"/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/:0:0","tags":["OS"],"title":"è¿›ç¨‹ä»‹ç»","uri":"/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 Program Explanation process-run.pyï¼šå¯ä»¥æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€åœ¨CPUä¸Šè¿è¡Œæ—¶å¦‚ä½•å˜åŒ–ã€‚ è¿›ç¨‹å¯ä»¥å¤„äºä»¥ä¸‹å‡ ç§ä¸åŒçš„çŠ¶æ€ï¼š RUNNINGï¼šè¿›ç¨‹æ­£åœ¨ä½¿ç”¨CPU READYï¼šè¿›ç¨‹ç°åœ¨å¯ä»¥ä½¿ç”¨CPUä½†å…¶ä»–è¿›ç¨‹æ­£åœ¨ä½¿ç”¨ BLOCKEDï¼šè¿›ç¨‹æ­£åœ¨ç­‰å¾…I/Oï¼ˆä¾‹å¦‚ï¼Œå®ƒå‘ç£ç›˜å‘é€è¯·æ±‚ï¼‰ DONEï¼šè¿›ç¨‹å·²ç»æ‰§è¡Œå®Œæˆ è¦è¿è¡Œè¯¥ç¨‹åºè·å–å…¶é€‰é¡¹ï¼Œå¯æ‰§è¡Œä»¥ä¸‹æ“ä½œ ./process-run.py -h æˆ–è€… python process-run.py -h å¾—åˆ°ï¼š Usage: process-run.py [options] Options: -h, --help show this help message and exit -s SEED, --seed=SEED the random seed -l PROCESS_LIST, --processlist=PROCESS_LIST a comma-separated list of processes to run, in the form X1:Y1,X2:Y2,... where X is the number of instructions that process should run, and Y the chances (from 0 to 100) that an instruction will use the CPU or issue an IO -L IO_LENGTH, --iolength=IO_LENGTH how long an IO takes -S PROCESS_SWITCH_BEHAVIOR, --switch=PROCESS_SWITCH_BEHAVIOR when to switch between processes: SWITCH_ON_IO, SWITCH_ON_END -I IO_DONE_BEHAVIOR, --iodone=IO_DONE_BEHAVIOR type of behavior when IO ends: IO_RUN_LATER, IO_RUN_IMMEDIATE -c compute answers for me -p, --printstats print statistics at end; only useful with -c flag (otherwise stats are not printed) è¦ç†è§£çš„æœ€é‡è¦çš„é€‰é¡¹æ˜¯ PROCESS_LISTï¼ˆç”± -l æˆ– â€“processlist å‚æ•°æŒ‡å®šï¼‰ï¼Œå®ƒå‡†ç¡®æŒ‡å®šæ¯ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼ˆæˆ–â€œè¿›ç¨‹â€ï¼‰å°†æ‰§è¡Œçš„æ“ä½œã€‚ä¸€ä¸ªè¿›ç¨‹ç”±æŒ‡ä»¤ç»„æˆï¼Œæ¯æ¡æŒ‡ä»¤åªèƒ½æ‰§è¡Œä»¥ä¸‹ä¸¤ä»¶äº‹ä¹‹ä¸€ï¼š ä½¿ç”¨CPU è¯·æ±‚IOï¼ˆå¹¶ç­‰å¾…å…¶å®Œæˆï¼‰ å½“è¿›ç¨‹ä½¿ç”¨ CPUï¼ˆä¸æ‰§è¡Œ IOï¼‰æ—¶ï¼Œå®ƒåº”è¯¥ç®€å•åœ°åœ¨ CPU ä¸Šè¿è¡Œæˆ–å‡†å¤‡è¿è¡Œä¹‹é—´äº¤æ›¿ã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„è¿è¡Œï¼Œä»…è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œå¹¶ä¸”è¯¥ç¨‹åºä»…ä½¿ç”¨ CPUï¼ˆä¸æ‰§è¡Œ IOï¼‰ã€‚ â¯ python process-run.py -l 5:100 Produce a trace of what would happen when you run these processes: Process 0 cpu cpu cpu cpu cpu Important behaviors: System will switch when the current process is FINISHED or ISSUES AN IO After IOs, the process issuing the IO will run LATER (when it is its turn) è¿™é‡Œï¼Œæˆ‘ä»¬æŒ‡å®šçš„è¿›ç¨‹æ˜¯â€œ5:100â€ï¼Œè¿™æ„å‘³ç€å®ƒåº”è¯¥ç”±5æ¡æŒ‡ä»¤ç»„æˆï¼Œå¹¶ä¸”æ¯æ¡æŒ‡ä»¤æ˜¯CPUæŒ‡ä»¤çš„æœºä¼šæ˜¯100%ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨-cå‚æ•°æ¥æŸ¥çœ‹è¿›ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š â¯ python process-run.py -l 5:100 -c Time PID: 0 CPU IOs 1 RUN:cpu 1 2 RUN:cpu 1 3 RUN:cpu 1 4 RUN:cpu 1 5 RUN:cpu 1 è¿™ä¸ªç»“æœå¹¶ä¸æ˜¯å¤ªæœ‰è¶£ï¼šè¯¥è¿‡ç¨‹åœ¨ RUNNING çŠ¶æ€ä¸‹å¾ˆç®€å•ï¼Œç„¶åå®Œæˆï¼Œå§‹ç»ˆä½¿ç”¨ CPUï¼Œä»è€Œä½¿ CPU åœ¨æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­ä¿æŒå¿™ç¢Œï¼Œå¹¶ä¸”ä¸æ‰§è¡Œä»»ä½• I/Oã€‚ æˆ‘ä»¬å¯ä»¥è¿è¡Œä¸‰ä¸ªè¿›ç¨‹çœ‹çœ‹ç»“æœï¼š â¯ python process-run.py -l 5:100,5:100,5:100 -c Time PID: 0 PID: 1 PID: 2 CPU IOs 1 RUN:cpu READY READY 1 2 RUN:cpu READY READY 1 3 RUN:cpu READY READY 1 4 RUN:cpu READY READY 1 5 RUN:cpu READY READY 1 6 DONE RUN:cpu READY 1 7 DONE RUN:cpu READY 1 8 DONE RUN:cpu READY 1 9 DONE RUN:cpu READY 1 10 DONE RUN:cpu READY 1 11 DONE DONE RUN:cpu 1 12 DONE DONE RUN:cpu 1 13 DONE DONE RUN:cpu 1 14 DONE DONE RUN:cpu 1 15 DONE DONE RUN:cpu 1 é¦–å…ˆé¦–å…ˆâ€œè¿›ç¨‹ IDâ€ï¼ˆæˆ–â€œPIDâ€ï¼‰ä¸º 0 çš„è¿›ç¨‹è¿è¡Œï¼Œè€Œè¿›ç¨‹ 1 å’Œè¿›ç¨‹2å·²å‡†å¤‡å¥½è¿è¡Œï¼Œä½†åªæ˜¯ç­‰å¾… 0 å®Œæˆã€‚å½“0å®Œæˆæ—¶ï¼Œå®ƒè¿›å…¥DONEçŠ¶æ€ï¼Œè€Œ1åˆ™è¿è¡Œï¼Œ2ç»§ç»­ç­‰å¾…ã€‚å½“ 1 å®Œæˆæ—¶ï¼Œåˆ™2æ‰å¼€å§‹è¿è¡Œã€‚ æˆ‘ä»¬ç»§ç»­çœ‹ä¸€ä¸ªä¾‹å­ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œè¿›ç¨‹ä»…å‘å‡ºI/Oè¯·æ±‚ã€‚æˆ‘ä»¬ä½¿ç”¨-Lå‚æ•°æŒ‡å®šI/Oéœ€è¦5ä¸ªæ—¶é—´å•ä½æ‰èƒ½å®Œæˆã€‚ â¯ python process-run.py -l 3:0 -L 5 Produce a trace of what would happen when you run these processes: Process 0 io io_done io io_done io io_done Important behaviors: System will switch when the current process is FINISHED or ISSUES AN IO After IOs, the process issuing the IO will run LATER (when it is its turn) æˆ‘ä»¬è®¾ç½®è·Ÿè¸ªå‚æ•°çœ‹çœ‹ä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼š â¯ python process-run.py -l 3:0 -L 5 -c Time PID: 0 CPU IOs 1 RUN:io 1 2 BLOCKED 1 3 BLOCKED 1 4 BLOCKED 1 5 BLOCKED 1 6 BLOCKED 1 7* RUN:io_done 1 8 RUN:io 1 9 BLOCKED 1 10 BLOCKED 1 11 BLOCKED 1 12 BLOCKED 1 13 BLOCKED 1 14* RUN:io_done 1 15 RUN:io 1 16 BLOCKED 1 17 BLOCKED 1 18 BLOCKED 1 19 BLOCKED 1 20 BLOCKED 1 21* RUN:io_done 1 â¯ python process-run.py -l 3:0 -L 5 -c Time PID: 0 CPU IOs 1 RUN:io 1 2 BLOCKED 1 3 BLOCKED 1 4 BLOCKED 1 5 BLOCKED 1 6 BLOCKED 1 7* RUN:io_done 1 8 RUN:io 1 9 BLOCKED 1 10 BLOCKED 1 11 BLOCKED 1 12 BLOCKED 1 13 BLOCKED 1 14* RUN:io_done 1 15 RUN:io 1 16 BLOCKED 1 17 BLOCKED 1 18 BLOCKED 1 19 BLOCKED 1 20 BLOCKED 1 21* RUN:io_done 1 å¦‚ä¸Šæ‰€ç¤ºï¼Œè¯¥ç¨‹åºä»…å‘å‡ºä¸‰ä¸ª I/Oã€‚å½“å‘å‡ºæ¯ä¸ª I/O æ—¶ï¼Œè¿›ç¨‹å°†è¿›å…¥ BLOCKED çŠ¶æ€ï¼Œå½“è®¾å¤‡å¿™äºä¸º I/O æä¾›æœåŠ¡æ—¶ï¼ŒCPU å¤„äºç©ºé—²çŠ¶æ€ã€‚ ä¸ºäº†å¤„ç† I/O çš„å®Œæˆï¼Œè¿˜ä¼šå‘ç”Ÿä¸€é¡¹ CPU æ“ä½œã€‚è¯·æ³¨æ„ï¼Œå¤„ç† I/O å¯åŠ¨å’Œå®Œæˆçš„å•ä¸ªæŒ‡ä»¤å¹¶ä¸æ˜¯ç‰¹åˆ«ç°å®ï¼Œä½†è¿™é‡Œåªæ˜¯ä¸ºäº†ç®€å•èµ·è§è€Œä½¿ç”¨ã€‚è®©æˆ‘ä»¬æ‰“å°ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ï¼ˆè¿è¡Œä¸ä¸Šé¢ç›¸åŒçš„å‘½ä»¤ï¼Œä½†ä½¿ç”¨ -p å‚æ•°ï¼‰æ¥æŸ¥çœ‹ä¸€äº›æ€»ä½“è¡Œä¸ºï¼š Stats: Total Time 21 Stats: CPU Busy 6 (28.57%) Stats: IO Busy 15 (71.43%) å¦‚ä¸Šæ‰€ç¤ºï¼Œè·Ÿè¸ªè¿è¡Œéœ€è¦ 21 ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œä½† CPU å¿™ç¢Œçš„æ—¶é—´ä¸åˆ° 30%ã€‚å¦ä¸€æ–¹é¢ï¼ŒI/O è®¾å¤‡å´ç›¸å½“å¿™ç¢Œã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›è®©æ‰€æœ‰è®¾å¤‡ä¿æŒå¿™ç¢Œï¼Œå› ä¸ºè¿™æ ·å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨èµ„æºã€‚ ","date":"2024-04-25","objectID":"/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/:1:0","tags":["OS"],"title":"è¿›ç¨‹ä»‹ç»","uri":"/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 QA è¿è¡Œ process-run.pyï¼ŒæŒ‡å®šå‚æ•°ï¼š-l 5:100ã€‚CPU åˆ©ç”¨ç‡åº”è¯¥æ˜¯å¤šå°‘ï¼ˆä¾‹å¦‚ï¼ŒCPU ä½¿ç”¨æ—¶é—´çš„ç™¾åˆ†æ¯”ï¼‰ï¼Ÿä½¿ç”¨ -c å’Œ -p å‚æ•°æ¥æŸ¥çœ‹ä½ æ˜¯å¦æ­£ç¡®ã€‚ CPUåˆ©ç”¨ç‡ä¸º100%ï¼Œå› ä¸ºæœ‰5æ¡æŒ‡ä»¤ï¼Œä½¿ç”¨CPUçš„æŒ‡ä»¤æœºä¼šä¸º100%ã€‚ â¯ python process-run.py -l 5:100 -c -p Time PID: 0 CPU IOs 1 RUN:cpu 1 2 RUN:cpu 1 3 RUN:cpu 1 4 RUN:cpu 1 5 RUN:cpu 1 Stats: Total Time 5 Stats: CPU Busy 5 (100.00%) Stats: IO Busy 0 (0.00%) è¿è¡Œï¼š./process-run.py -l 4:100,1:0ã€‚è¿™äº›å‚æ•°æŒ‡å®šä¸€ä¸ªå…·æœ‰ 4 æ¡æŒ‡ä»¤çš„è¿›ç¨‹ï¼ˆå…¨éƒ¨ä½¿ç”¨ CPUï¼‰ï¼Œä»¥åŠä¸€ä¸ªä»…å‘å‡º I/O å¹¶ç­‰å¾…å…¶å®Œæˆçš„è¿›ç¨‹ã€‚å®Œæˆè¿™ä¸¤ä¸ªè¿‡ç¨‹éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿä½¿ç”¨ -c å’Œ -p æ¥çœ‹çœ‹ä½ æ˜¯å¦æ­£ç¡®ã€‚ PIDä¸º0çš„è¿›ç¨‹è¿è¡Œå››æ¡æŒ‡ä»¤éœ€è¦4ï¼ŒPIDä¸º1çš„è¿›ç¨‹å®ŒæˆIOéœ€è¦5ï¼Œä½†æ˜¯å‘å‡ºIOæŒ‡ä»¤ä»¥åŠå®ŒæˆIOæŒ‡ä»¤éœ€è¦CPUï¼Œæ‰€ä»¥ä¸º4+5+2=11ã€‚ â¯ python process-run.py -l 4:100,1:0 -c -p Time PID: 0 PID: 1 CPU IOs 1 RUN:cpu READY 1 2 RUN:cpu READY 1 3 RUN:cpu READY 1 4 RUN:cpu READY 1 5 DONE RUN:io 1 6 DONE BLOCKED 1 7 DONE BLOCKED 1 8 DONE BLOCKED 1 9 DONE BLOCKED 1 10 DONE BLOCKED 1 11* DONE RUN:io_done 1 Stats: Total Time 11 Stats: CPU Busy 6 (54.55%) Stats: IO Busy 5 (45.45%) æ”¹å˜è¿›ç¨‹çš„é¡ºåºï¼š ./process-run.py -l 1:0,4:100ã€‚ç°åœ¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿåˆ‡æ¢é¡ºåºé‡è¦å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿï¼ˆåƒå¾€å¸¸ä¸€æ ·ï¼Œä½¿ç”¨ -c å’Œ -p æŸ¥çœ‹ä½ æ˜¯å¦æ­£ç¡®ï¼‰ è¿™æ ·è¿›ç¨‹0å°±å¯ä»¥å…ˆè·å¾—CPUå‘èµ·IOè¯·æ±‚ï¼Œç„¶åè¿›è¡ŒI/Oã€‚æ­¤æ—¶CPUç©ºé—²ï¼Œè¿›ç¨‹1åˆ™å¯ä»¥è·å¾—CPUã€‚åœ¨2ä¸­ï¼Œè¿›ç¨‹0åˆ™éœ€è¦ç­‰åˆ°è¿›ç¨‹1è¿è¡Œå®Œæˆæ‰å¯ä»¥è·å¾—ã€‚è¿™èŠ‚çœäº†æ—¶é—´ã€‚ â¯ python process-run.py -l 1:0,4:100 -c -p Time PID: 0 PID: 1 CPU IOs 1 RUN:io READY 1 2 BLOCKED RUN:cpu 1 1 3 BLOCKED RUN:cpu 1 1 4 BLOCKED RUN:cpu 1 1 5 BLOCKED RUN:cpu 1 1 6 BLOCKED DONE 1 7* RUN:io_done DONE 1 Stats: Total Time 7 Stats: CPU Busy 6 (85.71%) Stats: IO Busy 5 (71.43%) ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä»–ä¸€äº›å‚æ•°ã€‚å…¶ä¸­ä¸€ä¸ªé‡è¦çš„å‚æ•°æ˜¯ -Sï¼Œå®ƒå†³å®šäº†å½“ä¸€ä¸ªè¿›ç¨‹å‘å‡º I/O æ—¶ç³»ç»Ÿçš„ååº”ã€‚å°†è¯¥æ ‡å¿—è®¾ç½®ä¸º SWITCH ON END æ—¶ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨è¿›è¡Œ I/O æ—¶ï¼Œç³»ç»Ÿä¸ä¼šåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œæ˜¯ç­‰å¾…è¯¥è¿›ç¨‹å®Œå…¨ç»“æŸã€‚å¦‚æœè¿è¡Œä»¥ä¸‹ä¸¤ä¸ªè¿›ç¨‹ï¼ˆ-l 1:0,4:100 -c -S SWITCH_ON_ENDï¼‰ï¼Œå…¶ä¸­ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œ I/O æ“ä½œï¼Œå¦ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œ CPU æ“ä½œï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ æ­¤æ—¶è¿›ç¨‹0ä¼šä¸€ç›´å ç”¨CPUï¼Œç›´åˆ°I/Oæ“ä½œå®Œæˆã€‚ç”¨æ—¶ä¹Ÿæ˜¯11ã€‚ â¯ python process-run.py -l 1:0,4:100 -c -S SWITCH_ON_END -p Time PID: 0 PID: 1 CPU IOs 1 RUN:io READY 1 2 BLOCKED READY 1 3 BLOCKED READY 1 4 BLOCKED READY 1 5 BLOCKED READY 1 6 BLOCKED READY 1 7* RUN:io_done READY 1 8 DONE RUN:cpu 1 9 DONE RUN:cpu 1 10 DONE RUN:cpu 1 11 DONE RUN:cpu 1 Stats: Total Time 11 Stats: CPU Busy 6 (54.55%) Stats: IO Busy 5 (45.45%) ç°åœ¨ï¼Œè¿è¡Œç›¸åŒçš„è¿›ç¨‹ï¼Œä½†å°†åˆ‡æ¢è¡Œä¸ºè®¾ç½®ä¸ºæ¯å½“ä¸€ä¸ªè¿›ç¨‹ç­‰å¾… I/O æ—¶å°±åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼ˆ-l 1:0,4:100 -c -S SWITCH_ON_IOï¼‰ã€‚ç°åœ¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½¿ç”¨ -c å’Œ -p æ¥ç¡®è®¤æ˜¯å¦æ­£ç¡®ã€‚ æ­¤æ—¶è¿›ç¨‹0å‘èµ·I/Oè¯·æ±‚åï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šåˆ‡æ¢è¿›ç¨‹ï¼Œæ€»ç”¨æ—¶ä¸º7 â¯ python process-run.py -l 1:0,4:100 -c -S SWITCH_ON_IO -p Time PID: 0 PID: 1 CPU IOs 1 RUN:io READY 1 2 BLOCKED RUN:cpu 1 1 3 BLOCKED RUN:cpu 1 1 4 BLOCKED RUN:cpu 1 1 5 BLOCKED RUN:cpu 1 1 6 BLOCKED DONE 1 7* RUN:io_done DONE 1 Stats: Total Time 7 Stats: CPU Busy 6 (85.71%) Stats: IO Busy 5 (71.43%) å¦ä¸€ä¸ªé‡è¦çš„è¡Œä¸ºæ˜¯åœ¨ I/O å®Œæˆæ—¶è¯¥åšä»€ä¹ˆã€‚ä½¿ç”¨ -I IO RUN LATER é€‰é¡¹æ—¶ï¼Œå½“ I/O å®Œæˆæ—¶ï¼Œå‘å‡ºå®ƒçš„è¿›ç¨‹ä¸ä¸€å®šä¼šç«‹å³è¿è¡Œï¼›ç›¸åï¼Œæ­£åœ¨è¿è¡Œçš„å†…å®¹å°†ç»§ç»­è¿è¡Œã€‚å½“æ‚¨è¿è¡Œè¿™ç»„è¿›ç¨‹ç»„åˆæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼ˆè¿è¡Œ python process-run.py -l 3:0,5:100,5:100,5:100 -S SWITCH_ON_IO -I IO_RUN_LATER -c -pï¼‰ç³»ç»Ÿèµ„æºæ˜¯å¦å¾—åˆ°æœ‰æ•ˆåˆ©ç”¨ï¼Ÿ æ­¤æ—¶ç³»ç»Ÿèµ„æºæ²¡æœ‰å¾—åˆ°æœ‰æ•ˆåˆ©ç”¨ã€‚å› ä¸ºCPUå¤„ç†I/Oå®Œæˆè¶Šæ—©ï¼Œè¿›ç¨‹å°±å¯ä»¥ç»§ç»­å¤„ç†I/Oï¼Œå®ƒå¯ä»¥åœ¨ä¸å ç”¨CPUçš„æ—¶å€™è¿›è¡Œã€‚ â¯ python process-run.py -l 3:0,5:100,5:100,5:100 -S SWITCH_ON_IO -I IO_RUN_LATER -c -p Time PID: 0 PID: 1 PID: 2 PID: 3 CPU IOs 1 RUN:io READY READY READY 1 2 BLOCKED RUN:cpu READY READY 1 1 3 BLOCKED RUN:cpu READY READY 1 1 4 BLOCKED RUN:cpu READY READY 1 1 5 BLOCKED RUN:cpu READY READY 1 1 6 BLOCKED RUN:cpu READY READY 1 1 7* READY DONE RUN:cpu READY 1 8 READY DONE RUN:cpu READY 1 9 READY DONE RUN:cpu READY 1 10 READY DONE RUN:cpu READY 1 11 READY DONE RUN:cpu READY 1 12 READY DONE DONE RUN:cpu 1 13 READY DONE DONE RUN:cpu 1 14 READY DONE DONE RUN:cpu 1 15 READY DONE DONE RUN:cpu 1 16 READY DONE DONE RUN:cpu 1 17 RUN:io_done DONE DONE DONE 1 18 RUN:io DONE DONE DONE 1 19 BLOCKED DONE DONE DONE 1 20 BLOCKED DONE DONE DONE 1 21 BLOCKED DONE DONE DONE 1 22 BLOCKED DONE DONE DONE 1 23 BLOCKED DONE DONE DONE 1 24* RUN:io_done DONE DONE DONE 1 25 RUN:io DONE DONE DONE 1 26 BLOCKED DONE DONE DONE 1 27 BLOCKED DONE DONE DONE 1 28 BLOCKED DONE DONE DONE 1 29 BLOCKED DONE DONE DONE 1 30 BLOCKED DONE DONE DONE 1 31* RUN:io_done DONE DONE DONE 1 Stats: Total Time 31 Stats: CPU Busy 21 (67.74%) Stats: IO Busy 15 (48.39%) ç°åœ¨è¿è¡Œç›¸åŒçš„è¿›ç¨‹ï¼Œä½†ä½¿ç”¨ -I IO_RUN_IMMEDIATE è®¾ç½®ï¼Œè¯¥è®¾ç½®ä¼šç«‹å³è¿è¡Œå‘å‡º I/O çš„è¿›ç¨‹ã€‚è¿™ç§è¡Œä¸ºæœ‰ä½•ä¸åŒï¼Ÿä¸ºä»€ä¹ˆå†æ¬¡è¿è¡Œåˆšå®Œæˆ I/O çš„è¿›ç¨‹å¯èƒ½æ˜¯ä¸ªå¥½ä¸»æ„ï¼Ÿ è¿™ç§è¡Œä¸ºä¼šè®©è¿›ç¨‹å¤„ç†I/Oè¯·æ±‚çš„æ—¶å€™è¿˜ç»™å…¶ä»–CPUï¼Œä½†å®Œæˆåç«‹å³è·å¾—CPUï¼Œèƒ½è®©I/Oå¤„ç†å’ŒCPUå¤„ç†ä¸€èµ·è¿›è¡Œï¼ŒèŠ‚çœæ€»æ—¶é—´ï¼Œæœ‰æ•ˆæé«˜CPUåˆ©ç”¨ç‡ã€‚ â¯ python process-run.py -l 3:0,5:100,5:100,5:100 -S SWITCH_ON_IO -I IO_RUN_IMMEDIATE -c -p Time PID: 0","date":"2024-04-25","objectID":"/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/:2:0","tags":["OS"],"title":"è¿›ç¨‹ä»‹ç»","uri":"/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/"},{"categories":["æŠ€æœ¯åŸºç¡€"],"content":"å‡ºå¤„ å¦‚ä½•ä½¿ç”¨Cè¯­è¨€ç”Ÿæˆéšæœºæ•°ï¼Ÿä¾‹å¦‚å¸Œæœ›ç”Ÿæˆä¸€æ®µç‰¹å®šèŒƒå›´çš„éšæœºæ•°ï¼Œå¦‚$[1,6]$æ¥æ¨¡æ‹Ÿæ·éª°å­ã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‰€æœ‰ç­”æ¡ˆåœ¨æ•°å­¦ä¸Šéƒ½æ˜¯é”™è¯¯çš„ã€‚è¿”å› rand() % N å¹¶ä¸ç»Ÿä¸€ç»™å‡º [0, N) èŒƒå›´å†…çš„æ•°å­—ï¼Œé™¤é N é™¤ä»¥ rand() è¿”å›çš„åŒºé—´é•¿åº¦ï¼ˆå³æ˜¯ 2 çš„å¹‚ï¼‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸çŸ¥é“ rand() çš„æ¨¡æ•°æ˜¯å¦ç‹¬ç«‹ï¼šå®ƒä»¬æœ‰å¯èƒ½æ˜¯ 0, 1, 2, ... ï¼Œè¿™æ˜¯å‡åŒ€çš„ä½†ä¸æ˜¯å¾ˆéšæœºã€‚å”¯ä¸€ä¼¼ä¹åˆç†çš„å‡è®¾æ˜¯ rand() ç»™å‡ºæ³Šæ¾åˆ†å¸ƒï¼šä»»ä½•ä¸¤ä¸ªç›¸åŒå¤§å°çš„éé‡å å­åŒºé—´å‡å¯èƒ½ä¸”ç‹¬ç«‹ã€‚å¯¹äºä¸€ç»„æœ‰é™çš„å€¼ï¼Œè¿™æ„å‘³ç€å‡åŒ€åˆ†å¸ƒï¼Œå¹¶ä¸”è¿˜ç¡®ä¿ rand() çš„å€¼å¾ˆå¥½åœ°åˆ†æ•£ã€‚ è¿™æ„å‘³ç€æ›´æ”¹ rand() èŒƒå›´çš„å”¯ä¸€æ­£ç¡®æ–¹æ³•æ˜¯å°†å…¶åˆ†ä¸ºå¤šä¸ªæ¡†ï¼›ä¾‹å¦‚ï¼Œå¦‚æœ RAND_MAX == 11 å¹¶ä¸”æ‚¨æƒ³è¦ 1..6 çš„èŒƒå›´ï¼Œåˆ™åº”å°† {0,1} åˆ†é…ç»™ 1ï¼Œå°† {2,3} åˆ†é…ç»™ 2ï¼Œä¾æ­¤ç±»æ¨åœ¨ã€‚è¿™äº›æ˜¯ä¸ç›¸äº¤çš„ã€å¤§å°ç›¸ç­‰çš„åŒºé—´ï¼Œå› æ­¤æ˜¯å‡åŒ€ä¸”ç‹¬ç«‹åˆ†å¸ƒçš„ã€‚ ä½¿ç”¨æµ®ç‚¹é™¤æ³•çš„å»ºè®®åœ¨æ•°å­¦ä¸Šæ˜¯åˆç†çš„ï¼Œä½†åŸåˆ™ä¸Šå­˜åœ¨èˆå…¥é—®é¢˜ã€‚ä¹Ÿè®¸ double çš„ç²¾åº¦è¶³ä»¥ä½¿å…¶å·¥ä½œï¼›ä¹Ÿè®¸ä¸æ˜¯ã€‚æˆ‘ä¸çŸ¥é“ï¼Œä¹Ÿä¸æƒ³å¼„æ¸…æ¥šï¼›æ— è®ºå¦‚ä½•ï¼Œç­”æ¡ˆå–å†³äºç³»ç»Ÿã€‚ æ­£ç¡®çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ•´æ•°è¿ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨æƒ³è¦å¦‚ä¸‹æ‰€ç¤ºçš„å†…å®¹ï¼š #include \u003cstdlib.h\u003e // For random(), RAND_MAX // Assumes 0 \u003c= max \u003c= RAND_MAX // Returns in the closed interval [0, max] long random_at_most(long max) { unsigned long // max \u003c= RAND_MAX \u003c ULONG_MAX, so this is okay. num_bins = (unsigned long) max + 1, num_rand = (unsigned long) RAND_MAX + 1, bin_size = num_rand / num_bins, defect = num_rand % num_bins; long x; do { x = random(); } // This is carefully written not to overflow while (num_rand - defect \u003c= (unsigned long)x); // Truncated division is intentional return x/bin_size; } ä¸ºäº†è·å¾—å®Œå…¨å‡åŒ€çš„åˆ†å¸ƒï¼Œå¾ªç¯æ˜¯å¿…è¦çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç»™ä½  0 åˆ° 2 ä¹‹é—´çš„éšæœºæ•°ï¼Œè€Œä½ åªæƒ³è¦ 0 åˆ° 1 ä¹‹é—´çš„æ•°å­—ï¼Œä½ å°±ç»§ç»­æ‹‰ï¼Œç›´åˆ°æ²¡æœ‰ 2 ä¸ºæ­¢ï¼›ä¸éš¾æ£€æŸ¥è¿™æ˜¯å¦ä»¥ç›¸åŒçš„æ¦‚ç‡ç»™å‡º 0 æˆ– 1ã€‚ è¿™é‡Œä½¿ç”¨ random() è€Œä¸æ˜¯ rand() å› ä¸ºå®ƒå…·æœ‰æ›´å¥½çš„åˆ†å¸ƒï¼ˆå¦‚ rand() çš„æ‰‹å†Œé¡µæ‰€è¿°ï¼‰ã€‚ å¦‚æœä½ æƒ³è·å¾—é»˜è®¤èŒƒå›´ [0, RAND_MAX] ä¹‹å¤–çš„éšæœºå€¼ï¼Œé‚£ä¹ˆä½ å¿…é¡»åšä¸€äº›æ£˜æ‰‹çš„äº‹æƒ…ã€‚ä¹Ÿè®¸æœ€æ–¹ä¾¿çš„æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªå‡½æ•° random_extended() æå– n ä½ï¼ˆä½¿ç”¨ random_at_most() ï¼‰å¹¶è¿”å› [0, 2**n) ï¼Œç„¶ååº”ç”¨ random_at_most() ç”¨ random_extended() ä»£æ›¿ random() ï¼ˆå¹¶ç”¨ 2**n - 1 ä»£æ›¿ RAND_MAX ï¼‰æ¥æå–éšæœºå€¼å°äº 2**n ï¼Œå‡è®¾æ‚¨æœ‰ä¸€ä¸ªå¯ä»¥ä¿å­˜è¿™æ ·çš„å€¼çš„æ•°å­—ç±»å‹ã€‚æœ€åï¼Œå½“ç„¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ min + random_at_most(max - min) è·å– [min, max] ä¸­çš„å€¼ï¼ŒåŒ…æ‹¬è´Ÿå€¼ã€‚ è¿™æ®µä»£ç é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¡®ä¿ç”Ÿæˆçš„éšæœºæ•°åœ¨é—­åŒºé—´ [0, max] å†…å‡åŒ€åˆ†å¸ƒï¼š ç¡®å®šéšæœºæ•°çš„èŒƒå›´å’Œæ•°é‡ï¼š num_bins è¡¨ç¤ºç”Ÿæˆçš„éšæœºæ•°çš„æ•°é‡ï¼Œå³ max çš„å€¼åŠ ä¸€ï¼Œå› ä¸ºéšæœºæ•°ç”Ÿæˆå™¨çš„èŒƒå›´æ˜¯å·¦é—­å³å¼€çš„ã€‚ num_rand è¡¨ç¤ºéšæœºæ•°ç”Ÿæˆå™¨çš„æœ€å¤§å€¼åŠ ä¸€ï¼Œè¡¨ç¤ºæ€»çš„å¯èƒ½çš„éšæœºæ•°çš„æ•°é‡ã€‚ è®¡ç®—æ¯ä¸ªåŒºé—´çš„å¤§å°ï¼š bin_size è¡¨ç¤ºæ¯ä¸ªåŒºé—´çš„å¤§å°ï¼Œå³å°†éšæœºæ•°çš„æ€»æ•°é‡é™¤ä»¥å¯èƒ½çš„éšæœºæ•°çš„æ•°é‡ï¼Œä»¥ç¡®ä¿æ¯ä¸ªéšæœºæ•°çš„æ¦‚ç‡ç›¸ç­‰ã€‚ å¤„ç†ä¸èƒ½å‡åŒ€åˆ†é…çš„æƒ…å†µï¼š defect è¡¨ç¤ºéšæœºæ•°æ€»æ•°é‡é™¤ä»¥å¯èƒ½çš„éšæœºæ•°æ•°é‡çš„ä½™æ•°ï¼Œç”¨äºå¤„ç†ä¸èƒ½å‡åŒ€åˆ†é…çš„æƒ…å†µã€‚ ç”Ÿæˆéšæœºæ•°å¹¶æ£€æŸ¥èŒƒå›´ï¼š ä½¿ç”¨ do-while å¾ªç¯æ¥ç”Ÿæˆéšæœºæ•°ï¼Œå¹¶æ£€æŸ¥ç”Ÿæˆçš„éšæœºæ•°æ˜¯å¦åœ¨æŒ‡å®šçš„èŒƒå›´å†…ï¼Œå¦‚æœä¸åœ¨èŒƒå›´å†…åˆ™é‡æ–°ç”Ÿæˆï¼Œç›´åˆ°ç”Ÿæˆçš„éšæœºæ•°åœ¨æŒ‡å®šèŒƒå›´å†…ã€‚ è¿”å›å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ï¼š å°†ç”Ÿæˆçš„éšæœºæ•°é™¤ä»¥åŒºé—´å¤§å°å¾—åˆ°çš„ç»“æœï¼Œå³åœ¨é—­åŒºé—´ [0, max] å†…å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ã€‚ é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä»£ç ç¡®ä¿äº†ç”Ÿæˆçš„éšæœºæ•°åœ¨æŒ‡å®šèŒƒå›´å†…ä¸”åˆ†å¸ƒå‡åŒ€ã€‚ ","date":"2024-03-27","objectID":"/posts/02.c%E8%AF%AD%E8%A8%80%E5%A6%82%E4%BD%95%E4%BB%8E%E4%B8%80%E5%AE%9A%E8%8C%83%E5%9B%B4%E5%86%85%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E6%95%B4%E6%95%B0/:0:0","tags":["C++","éšæœºæ•°"],"title":"å¦‚ä½•ä½¿ç”¨Cè¯­è¨€ä»ä¸€å®šèŒƒå›´å†…ç”Ÿæˆéšæœºæ•´æ•°ï¼Ÿ","uri":"/posts/02.c%E8%AF%AD%E8%A8%80%E5%A6%82%E4%BD%95%E4%BB%8E%E4%B8%80%E5%AE%9A%E8%8C%83%E5%9B%B4%E5%86%85%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E6%95%B4%E6%95%B0/"},{"categories":["èµ„æºæ”¶è—"],"content":"æ¸…åå¤§å­¦Pypié•œåƒç«™ Dockeré•œåƒä»£ç† Githubé•œåƒä»£ç† ","date":"2024-03-20","objectID":"/posts/02.%E9%95%9C%E5%83%8F/:0:0","tags":["é•œåƒ"],"title":"é•œåƒç½‘ç«™","uri":"/posts/02.%E9%95%9C%E5%83%8F/"},{"categories":["èµ„æºæ”¶è—"],"content":"1 MacOS Macå‘½ä»¤è¡Œå‘½ä»¤ è¿™ä¸ªç½‘ç«™æ”¶é›†å„ç§æœ‰ç”¨çš„ Mac å‘½ä»¤è¡Œçš„å‘½ä»¤ã€‚ ","date":"2024-03-19","objectID":"/posts/01.%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/:1:0","tags":["å·¥å…·"],"title":"å®ç”¨å·¥å…·æ±‡æ€»","uri":"/posts/01.%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/"},{"categories":["èµ„æºæ”¶è—"],"content":"2 Linux ","date":"2024-03-19","objectID":"/posts/01.%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/:2:0","tags":["å·¥å…·"],"title":"å®ç”¨å·¥å…·æ±‡æ€»","uri":"/posts/01.%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 åŸºæœ¬ä»‹ç» #include \u003cunistd.h\u003e int execve(const char *pathname, char *const argv[], char *const envp[]); æè¿° execve()æ‰§è¡Œç”±pathnameå¼•ç”¨çš„ç¨‹åºã€‚è¿™ä¼šå¯¼è‡´å½“å‰ç”±è°ƒç”¨è¿›ç¨‹è¿è¡Œçš„ç¨‹åºè¢«ä¸€ä¸ªæ–°ç¨‹åºæ›¿æ¢ï¼Œè¯¥æ–°ç¨‹åºå…·æœ‰æ–°åˆå§‹åŒ–çš„å †æ ˆã€å †å’Œï¼ˆå·²åˆå§‹åŒ–å’Œæœªåˆå§‹åŒ–ï¼‰æ•°æ®æ®µã€‚ pathnameå¿…é¡»æ˜¯äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶æˆ–ä»¥å½¢å¼ä¸º#!interpreter [optional-arg]å¼€å¤´çš„è„šæœ¬ã€‚ argvæ˜¯ä¼ é€’ç»™æ–°ç¨‹åºä½œä¸ºå…¶å‘½ä»¤è¡Œå‚æ•°çš„å­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œè¿™äº›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªï¼ˆå³argv[0]ï¼‰åº”åŒ…å«ä¸æ­£åœ¨æ‰§è¡Œæ–‡ä»¶ç›¸å…³è”çš„æ–‡ä»¶åã€‚argvæ•°ç»„å¿…é¡»ä»¥NULLæŒ‡é’ˆç»“å°¾ã€‚ï¼ˆå› æ­¤ï¼Œåœ¨æ–°ç¨‹åºä¸­ï¼Œargv[argc]å°†ä¸ºNULLï¼‰ã€‚ envpæ˜¯ä¼ é€’ç»™æ–°ç¨‹åºç¯å¢ƒå˜é‡çš„å­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ã€‚è¯¥æ•°ç»„åŒ…å«äº†ç¯å¢ƒå˜é‡ã€‚æ¯ä¸ªç¯å¢ƒå˜é‡éƒ½æ˜¯ä¸€ä¸ª char* æŒ‡é’ˆï¼Œæ ¼å¼ä¸º â€œname=valueâ€ã€‚envpæ•°ç»„åŒæ ·å¿…é¡»ä»¥NULLæŒ‡é’ˆç»“å°¾ã€‚ char *envp[] = { \"PATH=/bin\", \"HOME=/home/user\", \"USER=user\", NULL // ç»ˆæ­¢ç¯å¢ƒå˜é‡æ•°ç»„ }; argvå’Œenvpå¯ä»¥ä»æ–°ç¨‹åºçš„ä¸»å‡½æ•°è®¿é—®ã€‚ä¾‹å¦‚æˆ‘ä»¬ç¼–å†™çš„Cç¨‹åºï¼Œå®é™…ä¸Šæ˜¯ç”±æ“ä½œç³»ç»Ÿé€šè¿‡execve()ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œï¼ˆè¿™é‡Œæ˜¯æ“ä½œç³»ç»Ÿå…ˆæ‰§è¡Œforkç³»ç»Ÿè°ƒç”¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ï¼Œç„¶ååœ¨æ–°çš„å­è¿›ç¨‹ä¸­ï¼Œæ“ä½œç³»ç»Ÿæ‰§è¡Œexecve()ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå®ƒä¼šä¼ é€’è¿™äº›å‚æ•°ç»™æ–°ç¨‹åºçš„ä¸»å‡½æ•°ï¼Œå³ main å‡½æ•°ã€‚è¿™äº›å‚æ•°å®šä¹‰äº†æ–°ç¨‹åºæ‰§è¡Œæ—¶çš„ç¯å¢ƒå’Œå‘½ä»¤è¡Œå‚æ•°ï¼Œåœ¨ç¨‹åºå¯åŠ¨æ—¶ç”±æ“ä½œç³»ç»Ÿè®¾ç½®ï¼Œå¹¶åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡ŒæœŸé—´ä¿æŒä¸å˜ã€‚è¿™ä½¿å¾—ç¨‹åºèƒ½å¤Ÿæ ¹æ®ä¼ é€’ç»™å®ƒçš„å‚æ•°å’Œç¯å¢ƒå˜é‡æ¥æ‰§è¡Œä¸åŒçš„ä»»åŠ¡æˆ–è°ƒæ•´å…¶è¡Œä¸ºã€‚ è¿”å›å€¼ æˆåŠŸæ—¶ï¼Œexecve() ä¸è¿”å›ä»»ä½•å€¼ï¼Œå½“ execve æˆåŠŸæ›¿æ¢å½“å‰è¿›ç¨‹çš„æ˜ åƒå¹¶å¼€å§‹æ‰§è¡Œæ–°çš„ç¨‹åºæ—¶ï¼ŒåŸæ¥çš„è¿›ç¨‹ï¼ˆå³è°ƒç”¨ execve çš„è¿›ç¨‹ï¼‰å·²ç»ä¸å†å­˜åœ¨ï¼Œå› æ­¤æ— æ³•è¿”å›ä»»ä½•å€¼ã€‚ åœ¨å‡ºé”™æ—¶è¿”å› -1ï¼Œå¹¶è®¾ç½®é€‚å½“çš„ errnoã€‚ é‡ç‚¹ execveå®é™…ä¸Šå°±æ˜¯å°†å½“å‰è¿è¡Œçš„çŠ¶æ€æœºé‡ç½®æˆå¦ä¸€ä¸ªç¨‹åºçš„åˆå§‹çŠ¶æ€ å…è®¸å¯¹æ–°çŠ¶æ€æœºè®¾ç½®å‚æ•° argv (v) å’Œç¯å¢ƒå˜é‡ envp (e) åœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œæ“ä½œç³»ç»Ÿé¦–å…ˆæ‰§è¡Œ fork ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ã€‚ç„¶åï¼Œæ“ä½œç³»ç»Ÿåœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œ execve ç³»ç»Ÿè°ƒç”¨ï¼Œä»¥æ›¿æ¢å­è¿›ç¨‹çš„ç¨‹åºæ˜ åƒå¹¶å¼€å§‹æ‰§è¡Œæ–°çš„ç¨‹åºã€‚åŸæ¥çš„çˆ¶è¿›ç¨‹ç»§ç»­æ‰§è¡Œ fork ä¹‹åçš„ä»£ç ã€‚ åœ¨è°ƒç”¨ execve ä¹‹å‰ï¼Œç¡®ä¿é‡Šæ”¾æ‰€æœ‰ä¸å†éœ€è¦çš„èµ„æºï¼Œå¦‚æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€é”ç­‰ã€‚ åœ¨è°ƒç”¨ execve ä¹‹å‰ï¼Œç¡®ä¿å­è¿›ç¨‹å·²ç»å¤„ç†äº†æ‰€æœ‰å¾…å¤„ç†çš„ä¿¡å·ï¼Œé™¤éä½ å¸Œæœ›ä¿¡å·å¤„ç†ç¨‹åºåœ¨æ–°ç¨‹åºä¸­æ‰§è¡Œã€‚ å¦‚æœ execve å¤±è´¥ï¼Œå­è¿›ç¨‹é€šå¸¸åº”è¯¥ç»ˆæ­¢ã€‚ åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œé€šå¸¸ä¼šåœ¨ fork ä¹‹åç«‹å³è°ƒç”¨ wait æˆ– waitpid æ¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸï¼Œä»¥ç¡®ä¿çˆ¶è¿›ç¨‹ä¸ä¼šè¿‡æ—©é€€å‡ºï¼Œä»è€Œå¯¼è‡´å­è¿›ç¨‹çš„åƒµå°¸è¿›ç¨‹ã€‚ ","date":"2024-03-13","objectID":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:1:0","tags":["Linux"],"title":"Linux execveå‡½æ•°è¯¦è§£","uri":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 execveå®ä¾‹ ","date":"2024-03-13","objectID":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:2:0","tags":["Linux"],"title":"Linux execveå‡½æ•°è¯¦è§£","uri":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 è‡ªå®šä¹‰argvå’Œenvp #include \u003cunistd.h\u003e #include \u003cstdio.h\u003e int main() { char * const argv[] = { \"/bin/bash\", \"-c\", \"env\", NULL, }; char * const envp[] = { \"HELLO=WORLD\", NULL, }; execve(argv[0], argv, envp); printf(\"Hello, World!\\n\"); return 0; } åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æ˜¾å¼çš„è®¾ç½®äº†argvå’Œenvpï¼Œå…¶ä¸­å‚æ•° \"/bin/bash\", \"-c\", \"env\", NULLï¼Œè¿™é‡Œçš„å‚æ•°å®é™…ä¸Šæ˜¯åœ¨å‘Šè¯‰ bash æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼ˆç”± -c åé¢çš„å­—ç¬¦ä¸²æŒ‡å®šï¼‰ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ envï¼Œå®ƒæ‰“å°å½“å‰çš„ç¯å¢ƒå˜é‡ã€‚ æˆ‘ä»¬è¿è¡Œä»£ç ï¼Œå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š å¦‚æœæˆ‘ä»¬ä¸ä¼  -c å‚æ•°å’Œéšåçš„å‘½ä»¤ï¼Œå³åªä¼ å…¥ \"/bin/bash\", NULL ä½œä¸ºå‚æ•°ï¼Œbash ä¼šé»˜è®¤è¿›å…¥äº¤äº’å¼æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå®ƒä¸ä¼šæ‰§è¡Œä»»ä½•å‘½ä»¤å¹¶ç«‹å³é€€å‡ºï¼Œè€Œæ˜¯ä¼šç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œè¡¨ç°ä¸ºè¿›å…¥äº† shell ç¯å¢ƒã€‚ æˆ‘ä»¬å‘ç°ï¼Œæ‰“å°çš„å½“å‰ç¯å¢ƒå˜é‡é™¤äº†è‡ªå®šçš„envpï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„è¾“å‡ºã€‚è¿™æ˜¯å› ä¸ºé™¤äº†æˆ‘ä»¬è®¾å®šçš„ç¯å¢ƒå˜é‡å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç³»ç»Ÿæˆ–è€… shell é»˜è®¤çš„ç¯å¢ƒå˜é‡ä¼šè¢«æ·»åŠ åˆ°æ–°è¿›ç¨‹ä¸­ï¼Œä¾‹å¦‚ PWD è¡¨ç¤ºå½“å‰å·¥ä½œç›®å½•ï¼ŒSHLVL è¡¨ç¤º shell å±‚çº§ï¼Œ_ æ˜¯ä¸Šä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šçœ‹åˆ°é¢å¤–çš„ç¯å¢ƒå˜é‡å‡ºç°åœ¨è¾“å‡ºä¸­ã€‚ ","date":"2024-03-13","objectID":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:2:1","tags":["Linux"],"title":"Linux execveå‡½æ•°è¯¦è§£","uri":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 forkåå†é€šè¿‡å­è¿›ç¨‹æ‰§è¡Œexecve #include \u003cstdio.h\u003e #include \u003csys/types.h\u003e #include \u003csys/wait.h\u003e int main() { pid_t pid = fork(); if (pid == 0) { // å­è¿›ç¨‹ char * const argv[] = {\"/bin/echo\", \"Hello, World!\", NULL}; char * const envp[] = {NULL}; execve(\"/bin/echo\", argv, envp); } else if (pid \u003e 0) { // çˆ¶è¿›ç¨‹ wait(NULL); // ç­‰å¾…å­è¿›ç¨‹ç»“æŸ printf(\"Child process finished.\\n\"); } else { // forkå¤±è´¥ perror(\"fork\"); return 1; } return 0; } è¿™æ®µä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ fork() ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ï¼Œç„¶ååœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œ execve() ç³»ç»Ÿè°ƒç”¨ã€‚è¿™æ˜¯åœ¨ Unix-like ç³»ç»Ÿä¸­å¸¸è§çš„æ“ä½œæ¨¡å¼ï¼Œå› ä¸º execve() ç³»ç»Ÿè°ƒç”¨æœ‰ä¸€äº›å…³é”®çš„é™åˆ¶ï¼š ä¸€æ¬¡æœºä¼šï¼šexecve() ç³»ç»Ÿè°ƒç”¨åªèƒ½ç”¨äºæ›¿æ¢å½“å‰è¿›ç¨‹çš„æ˜ åƒä¸€æ¬¡ã€‚å¦‚æœä¸€ä¸ªè¿›ç¨‹å·²ç»è°ƒç”¨äº† execve()ï¼Œå®ƒå°±ä¸èƒ½å†è°ƒç”¨ fork() æˆ–å†æ¬¡æ‰§è¡Œ execve()ã€‚ æ— è¿”å›å€¼ï¼šexecve() æˆåŠŸæ‰§è¡Œæ—¶ï¼ŒåŸæ¥çš„è¿›ç¨‹æ˜ åƒè¢«æ–°ç¨‹åºæ˜ åƒæ›¿æ¢ï¼ŒåŸæ¥çš„è¿›ç¨‹ä¸å†å­˜åœ¨ï¼Œå› æ­¤æ— æ³•è¿”å›ä»»ä½•å€¼ã€‚å¦‚æœåœ¨ execve() æ‰§è¡Œä¹‹å‰æœ‰ä»»ä½•è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿”å›å€¼æ˜¯åœ¨ fork() è°ƒç”¨ä¹‹åï¼Œç”±çˆ¶è¿›ç¨‹è·å¾—çš„ã€‚ å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå…ˆä½¿ç”¨ fork() åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶ååœ¨å­è¿›ç¨‹ä¸­è°ƒç”¨ execve() æ‰§è¡Œæ–°çš„ç¨‹åºã€‚çˆ¶è¿›ç¨‹åœ¨ fork() ä¹‹åä¼šç»§ç»­æ‰§è¡Œï¼Œå¹¶é€šè¿‡è°ƒç”¨ wait(NULL) æ¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸã€‚è¿™æ ·ï¼Œçˆ¶è¿›ç¨‹å¯ä»¥çŸ¥é“å­è¿›ç¨‹å·²ç»æˆåŠŸæ‰§è¡Œäº† execve()ï¼Œå¹¶ä¸”å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡æˆ–é€€å‡ºã€‚ åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº† fork() å¹¶å°è¯•åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œ execve()ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹å°†ç»§ç»­æ‰§è¡Œï¼Œä¸å— fork() å’Œ execve() çš„å½±å“ã€‚åªæœ‰è°ƒç”¨ fork() çš„çº¿ç¨‹ä¼šè¿›å…¥å­è¿›ç¨‹ï¼Œè€Œå…¶ä»–çº¿ç¨‹åˆ™ç»§ç»­åœ¨çˆ¶è¿›ç¨‹ä¸­è¿è¡Œã€‚ å¾—åˆ°çš„è¿è¡Œç»“æœï¼š ","date":"2024-03-13","objectID":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:2:2","tags":["Linux"],"title":"Linux execveå‡½æ•°è¯¦è§£","uri":"/posts/05.linux-execve%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 fork ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:1:0","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.1 åŸºæœ¬ä»‹ç» #include \u003csys/types.h\u003e #include \u003cunistd.h\u003e pid_t fork(void) æè¿° forkç”¨äºåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå®ƒä¸çˆ¶è¿›ç¨‹çš„å”¯ä¸€åŒºåˆ«åœ¨äºå…¶PIDå’ŒPPIDï¼Œä»¥åŠèµ„æºåˆ©ç”¨è®¾ç½®ä¸º0ã€‚æ–‡ä»¶é”å’ŒæŒ‚èµ·ä¿¡å·ï¼ˆæŒ‡å·²ç»è¢«å†…æ ¸å‘é€ç»™ä¸€ä¸ªè¿›ç¨‹ï¼Œä½†å°šæœªè¢«è¯¥è¿›ç¨‹å¤„ç†çš„ä¿¡å·ï¼‰ä¸ä¼šè¢«ç»§æ‰¿ï¼Œå…¶ä»–å’Œçˆ¶è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒï¼šä¼šè·å¾—çˆ¶è¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€æ ˆã€æ•°æ®æ®µã€å †ã€æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·å¤„ç†å‡½æ•°ã€è¿›ç¨‹ä¼˜å…ˆçº§ã€ç¯å¢ƒå˜é‡ç­‰èµ„æºçš„å‰¯æœ¬ã€‚ è¿”å›å€¼ æˆåŠŸæ—¶ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„ PIDï¼Œåœ¨å­è¿›ç¨‹ä¸­è¿”å› $0$ã€‚å¤±è´¥æ—¶ï¼Œçˆ¶è¿›ç¨‹è¿”å› $-1$ï¼Œä¸åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶é€‚å½“è®¾ç½® errnoã€‚ å…¶ä¸­errnoæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒç”¨äºè¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨æˆ–åº“å‡½æ•°è°ƒç”¨äº§ç”Ÿçš„é”™è¯¯ä»£ç ã€‚å½“ç³»ç»Ÿè°ƒç”¨æˆ–åº“å‡½æ•°å¤±è´¥æ—¶ï¼Œå®ƒä»¬é€šå¸¸ä¼šè®¾ç½® errno ä»¥æŒ‡ç¤ºé”™è¯¯çš„åŸå› ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ errno é”™è¯¯ä»£ç åŠå…¶å«ä¹‰ï¼š EAGAINï¼šèµ„æºæš‚æ—¶ä¸å¯ç”¨ï¼Œé€šå¸¸æ˜¯å› ä¸ºè¾¾åˆ°äº†ç³»ç»Ÿé™åˆ¶ï¼Œå¦‚æ–‡ä»¶æè¿°ç¬¦æˆ–å†…å­˜é™åˆ¶ã€‚ ENOMEMï¼šå†…å­˜ä¸è¶³ï¼Œæ— æ³•åˆ†é…è¯·æ±‚çš„èµ„æºã€‚ EACCESï¼šæƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®æŸä¸ªèµ„æºã€‚ EINTRï¼šç³»ç»Ÿè°ƒç”¨è¢«ä¿¡å·ä¸­æ–­ã€‚ EINVALï¼šæ— æ•ˆçš„å‚æ•°ã€‚ é‡ç‚¹ fork() å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¼šä»çˆ¶è¿›ç¨‹å¤åˆ¶æ‰§è¡Œé¡ºåºã€‚å…·ä½“æ¥è¯´ï¼Œå­è¿›ç¨‹ä¼šä»çˆ¶è¿›ç¨‹å¤åˆ¶å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬æŒ‡ä»¤æŒ‡é’ˆï¼ˆinstruction pointerï¼‰å’Œå¯„å­˜å™¨çš„çŠ¶æ€ã€‚è¿™æ„å‘³ç€å­è¿›ç¨‹å°†ä» fork() ç³»ç»Ÿè°ƒç”¨ä¹‹åçš„æŒ‡ä»¤å¼€å§‹æ‰§è¡Œï¼Œä¸çˆ¶è¿›ç¨‹åœ¨ fork() ä¹‹ååº”è¯¥æ‰§è¡Œçš„æŒ‡ä»¤å®Œå…¨ç›¸åŒã€‚å› æ­¤ï¼Œfork() ä¹‹åé€šå¸¸ä¼šæœ‰ä¸€ä¸ªåŸºäºè¿”å›å€¼çš„åˆ†æ”¯ç»“æ„ï¼Œä»¥åŒºåˆ†çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹çš„æ‰§è¡Œè·¯å¾„ã€‚ ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:1:1","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.2 forkå®ä¾‹ 1.2.1 1.2.1å¤šä¸ªforkè¿”å›å€¼ #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e int main() { pid_t pid1 = fork(); pid_t pid2 = fork(); pid_t pid3 = fork(); pid_t pid = getpid(); printf(\"The PID of the current process is %d\\n Hello World from (%d, %d, %d)\\n\", pid, pid1, pid2, pid3); return 0; } è¿™æ®µç¨‹åºåŒ…å«äº†ä¸‰ä¸ª fork() è°ƒç”¨ï¼Œæ¯ä¸ª fork() éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ã€‚ç”±äºæ¯æ¬¡ fork() è°ƒç”¨éƒ½ä¼šå¯¼è‡´è¿›ç¨‹æ•°ç¿»å€ï¼Œæ‰€ä»¥æ€»å…±ä¼šæœ‰$2^3=8$ä¸ªè¿›ç¨‹ ï¼ˆåŒ…æ‹¬æœ€åˆçš„çˆ¶è¿›ç¨‹ï¼‰ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šæ‰“å°å‡ºå®ƒçš„è¿›ç¨‹ ID (pid) ä»¥åŠä¸‰ä¸ª fork() è°ƒç”¨çš„è¿”å›å€¼ (pid1, pid2, pid3)ã€‚ å¾—åˆ°çš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š æˆ‘ä»¬ç”»ä¸ªçŠ¶æ€æœºæ¥ç†è§£å®ƒä»¬çš„è¾“å‡ºï¼Œå‡è®¾æœ€åˆçš„çˆ¶è¿›ç¨‹PIDä¸º291871ï¼š 1.2.2 Cè¯­è¨€ forkä¸è¾“å‡º #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e int main(int argc, char *argv[]) { int n = 2; for (int i = 0; i \u003c n; i++) { fork(); printf(\"Hello\\n\"); } for (int i = 0; i \u003c n; i++) { wait(NULL); } } è¿™æ®µä»£ç ä¸­ï¼ŒæŒ‰æˆ‘ä»¬çš„ç†è§£ï¼Œç¬¬ä¸€æ¬¡forkåæœ‰2ä¸ªè¿›ç¨‹ï¼Œç„¶åä¸€èµ·æ‰§è¡Œprintfè¾“å‡ºï¼Œå¾—åˆ°ä¸¤ä¸ªHelloï¼Œç„¶åç¬¬äºŒæ¬¡forkåæœ‰4ä¸ªè¿›ç¨‹ï¼Œç„¶åæ‰§è¡Œprintfï¼Œå¾—åˆ°å››ä¸ªHelloï¼Œåˆ™ä¼šæœ‰6ä¸ª``Hello`ï¼Œå¦‚ä¸‹ï¼š ä½†æ˜¯å½“æˆ‘ä»¬å°†è¾“å‡ºé€šè¿‡ç®¡é“ä¼ ç»™catç­‰å‘½ä»¤æ—¶ï¼Œä¼šçœ‹åˆ°8ä¸ªHelloï¼š è¿™æ˜¯å› ä¸ºæ ‡å‡†è¾“å‡ºä¸€èˆ¬æ˜¯è¡Œç¼“å†²çš„ï¼Œç¢°åˆ°\\nï¼Œç¼“å†²åŒºä¸­çš„å†…å®¹ä¼šè¢«åˆ·æ–°ï¼Œå³è¾“å‡ºåˆ°ç»ˆç«¯æˆ–æ–‡ä»¶ä¸­ã€‚è¿™ç§ç¼“å†²æ–¹å¼çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å‡å°‘å¯¹ç£ç›˜ I/O çš„è°ƒç”¨æ¬¡æ•°ã€‚ å¦‚æœæ ‡å‡†è¾“å‡ºè¢«é‡å®šå‘åˆ°ç®¡é“ï¼Œå®ƒå¯èƒ½ä¸å†æ˜¯è¡Œç¼“å†²çš„ï¼Œè€Œæ˜¯å˜ä¸ºå…¨ç¼“å†²çš„ã€‚è¿™æ„å‘³ç€ç¼“å†²åŒºå¯èƒ½ä¼šåœ¨å¡«æ»¡æ—¶åˆ·æ–°ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡é‡åˆ°æ¢è¡Œç¬¦æ—¶åˆ·æ–°ã€‚å¦‚æœç¼“å†²åŒºè¶³å¤Ÿå¤§ï¼Œä»¥è‡³äºå¯ä»¥å®¹çº³æ‰€æœ‰çš„ Hello è¾“å‡ºï¼Œé‚£ä¹ˆforkçš„æ—¶å€™å­è¿›ç¨‹ä¹Ÿä¼šå¤åˆ¶ç¼“å†²åŒºï¼Œå¯¼è‡´æœ€åæ¯ä¸ªè¿›ç¨‹ä¸­çš„ç¼“å†²åŒºéƒ½æœ‰2ä¸ªHelloï¼Œæœ€åè¾“å‡ºä¸º8ä¸ªã€‚ å¦‚æœä¸ºäº†ç¡®ä¿ç¼“å†²åŒºåœ¨éœ€è¦çš„æ—¶å€™è¢«åˆ·æ–°ï¼Œå¯ä»¥åœ¨ printf è°ƒç”¨ä¹‹åæ˜¾å¼åœ°è°ƒç”¨ fflush(stdout) æ¥åˆ·æ–°æ ‡å‡†è¾“å‡ºç¼“å†²åŒºã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ‰€æœ‰çš„è¾“å‡ºéƒ½è¢«ç«‹å³å†™å…¥ï¼Œè€Œä¸ä¼šå—åˆ°ç¼“å†²è¡Œä¸ºçš„å½±å“ã€‚ #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e int main(int argc, char *argv[]) { int n = 2; for (int i = 0; i \u003c n; i++) { fork(); printf(\"Hello\\n\"); fflush(stdout); } for (int i = 0; i \u003c n; i++) { wait(NULL); } return 0; } 1.2.3 fork ğŸ’£ #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e int main(int argc, char *argv[]) { while(1) { fork(); } return 0; } è¿™æ®µä»£ç ä¼šæ— é™å¾ªç¯åœ°è°ƒç”¨ fork() å‡½æ•°ï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ã€‚ç”±äºæ¯æ¬¡ fork() è°ƒç”¨éƒ½ä¼šæˆåŠŸåˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œè€Œä¸”è¿™ä¸ªæ–°è¿›ç¨‹åˆä¼šç«‹å³è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯å¹¶å†æ¬¡è°ƒç”¨ fork()ï¼Œå› æ­¤è¿›ç¨‹çš„æ•°é‡ä¼šä»¥æŒ‡æ•°é€Ÿåº¦å¢é•¿ï¼Œå¾ˆå¿«å°±ä¼šè€—å°½ç³»ç»Ÿçš„å¯ç”¨èµ„æºã€‚ ç»å¯¹ä¸è¦åœ¨ä»»ä½•ç”Ÿäº§ç¯å¢ƒæˆ–æ‚¨æ²¡æœ‰æƒé™çš„ä»»ä½•ç³»ç»Ÿä¸Šè¿è¡Œforkç‚¸å¼¹ã€‚ ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:1:2","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 vfork ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:2:0","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åŸºæœ¬ä»‹ç» æè¿° #include \u003csys/types.h\u003e #include \u003cunistd.h\u003e pid_t vfork(void); vfork() ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œä¸ fork() ç±»ä¼¼ï¼Œä½†å®ƒä½¿ç”¨çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè€Œä¸æ˜¯å¤åˆ¶çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚vfork() è°ƒç”¨åï¼Œçˆ¶è¿›ç¨‹ä¼šé˜»å¡ï¼Œç›´åˆ°å­è¿›ç¨‹è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œäº† exit å‡½æ•°ã€‚è¿™æ˜¯å› ä¸ºå­è¿›ç¨‹éœ€è¦ç‹¬å çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚ä¸€ã€‚åœ¨å­è¿›ç¨‹è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œäº† exit å‡½æ•°ä¹‹åï¼Œå­è¿›ç¨‹å°†è·å¾—è‡ªå·±çš„å†…å­˜ç©ºé—´ã€‚ è¿”å›å€¼ å’Œforkä¸€è‡´ é‡ç‚¹ vfork() åˆ›å»ºçš„å­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„ç¯å¢ƒï¼Œä½†ä¸ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„å †æ ˆã€‚ åœ¨å­è¿›ç¨‹æ‰§è¡Œè¿™äº›execæˆ–exitæ“ä½œä¹‹å‰ï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å¯èƒ½ä¼šè®¿é—®ç›¸åŒçš„å†…å­˜åœ°å€ï¼Œè¿™å¯èƒ½å¯¼è‡´æ•°æ®ç«äº‰å’Œä¸ä¸€è‡´ã€‚ åœ¨ vfork() è°ƒç”¨æˆåŠŸåï¼Œå­è¿›ç¨‹åº”è¯¥ç«‹å³è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œ exit å‡½æ•°ã€‚å¦‚æœåœ¨å­è¿›ç¨‹ä¸­ä¿®æ”¹é™¤äº†ç”¨äºå­˜å‚¨ä» vfork() è¿”å›å€¼çš„ pid_t ç±»å‹å˜é‡ä¹‹å¤–çš„ä»»ä½•æ•°æ®ï¼Œæˆ–è€…ä»è°ƒç”¨ vfork() çš„å‡½æ•°è¿”å›ï¼Œæˆ–åœ¨æˆåŠŸè°ƒç”¨ _exit() æˆ– exec() å‡½æ•°æ—ä¸­çš„ä¸€ä¸ªå‡½æ•°ä¹‹å‰è°ƒç”¨å…¶ä»–ä»»ä½•å‡½æ•°ï¼Œåˆ™è¡Œä¸ºæ˜¯æœªå®šä¹‰çš„ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–è¡¨ç°å‡ºä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚ å› æ­¤ï¼Œä½¿ç”¨ vfork() æ—¶ï¼Œå¿…é¡»ç¡®ä¿å­è¿›ç¨‹åœ¨è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œ exit å‡½æ•°ä¹‹å‰ä¸æ‰§è¡Œä»»ä½•å¯èƒ½å½±å“å…±äº«å†…å­˜çš„æ“ä½œã€‚ vfork() ç³»ç»Ÿè°ƒç”¨ä¼šé˜»å¡çˆ¶è¿›ç¨‹ï¼Œç›´åˆ°å­è¿›ç¨‹å®Œæˆ exec è°ƒç”¨æˆ– exit è°ƒç”¨ã€‚çˆ¶è¿›ç¨‹ä¸éœ€è¦æ˜¾å¼è°ƒç”¨ wait() æˆ– waitpid() æ¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸã€‚ ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:2:1","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 éªŒè¯vforkå…±äº«å†…å­˜ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e #include \u003cstring.h\u003e #include \u003cassert.h\u003e int main() { // åœ¨çˆ¶è¿›ç¨‹ä¸­åˆ†é…å†…å­˜å¹¶åˆå§‹åŒ– char *buffer = malloc(1024); assert(buffer != NULL); memset(buffer, 'A', 1024); // ä½¿ç”¨vforkåˆ›å»ºå­è¿›ç¨‹ pid_t pid = vfork(); if (pid \u003c 0) { perror(\"vfork error\"); exit(EXIT_FAILURE); } else if (pid == 0) { // å­è¿›ç¨‹ printf(\"Child process: PID = %d\\n\", getpid()); // ä¿®æ”¹å†…å®¹ memset(buffer, 'B', 1024); // å­è¿›ç¨‹ char * const argv[] = {\"/bin/echo\", \"Hello, Linux!\", NULL}; char * const envp[] = {NULL}; // æ‰§è¡Œexecå‡½æ•° execve(argv[0], argv, envp); } else { // çˆ¶è¿›ç¨‹ printf(\"Parent process: PID = %d, child's PID = %d\\n\", getpid(), pid); // éªŒè¯å†…å­˜å†…å®¹æ˜¯å¦è¢«å­è¿›ç¨‹ä¿®æ”¹ for (int i = 0; i \u003c 1024; i++) { if (buffer[i] != 'B') { printf(\"Memory corruption detected at index %d\\n\", i); exit(EXIT_FAILURE); } } printf(\"Memory is consistent\\n\"); } return 0; } è¿™ä¸ªç¨‹åºçš„ç›®çš„æ˜¯éªŒè¯åœ¨ vfork() ä¹‹åï¼Œå­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹æ˜¯å¦å…±äº«å†…å­˜ã€‚é¦–å…ˆåœ¨çˆ¶è¿›ç¨‹ä¸­åˆ†é…ä¸€å—å†…å­˜ ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸ºå­—ç¬¦ â€˜Aâ€™ã€‚ç„¶åï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨ vfork() åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚åœ¨å­è¿›ç¨‹ä¸­ï¼Œç¨‹åºè¯•å›¾å°†å†…å®¹ä¿®æ”¹ä¸ºå­—ç¬¦ â€˜Bâ€™ï¼Œå¹¶æ‰§è¡Œ execve()ã€‚åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œç¨‹åºæ£€æŸ¥ç¼“å†²åŒºçš„å†…å®¹æ˜¯å¦è¢«ä¿®æ”¹ä¸ºå­—ç¬¦ â€˜Bâ€™ï¼Œä»¥éªŒè¯å†…å­˜æ˜¯å¦è¢«æ­£ç¡®å…±äº«ã€‚ ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:2:2","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 clone ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:3:0","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 åŸºæœ¬ä»‹ç» æè¿° #define _GNU_SOURCE #include \u003csched.h\u003e int clone(int (*fn)(void *), void *child_stack, int flags, void *arg, ... /* pid_t *parent_tid, void *tls, pid_t *child_tid */ ); cloneä¸forkç±»ä¼¼ï¼Œæ˜¯ç”¨äºåˆ›å»ºæ–°è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä½†cloneæä¾›äº†æ›´ç²¾ç¡®çš„æ§åˆ¶ï¼Œå¯ä»¥ç¡®å®šåœ¨è°ƒç”¨è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰å’Œå­è¿›ç¨‹ä¹‹é—´å…±äº«å“ªäº›æ‰§è¡Œä¸Šä¸‹æ–‡çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œè°ƒç”¨è€…å¯ä»¥æ§åˆ¶ä¸¤ä¸ªè¿›ç¨‹æ˜¯å¦å…±äº«è™šæ‹Ÿåœ°å€ç©ºé—´ã€æ–‡ä»¶æè¿°ç¬¦è¡¨å’Œä¿¡å·å¤„ç†ç¨‹åºè¡¨ã€‚è¿™äº›ç³»ç»Ÿè°ƒç”¨è¿˜å…è®¸å°†æ–°çš„å­è¿›ç¨‹æ”¾ç½®åœ¨å•ç‹¬çš„å‘½åç©ºé—´ä¸­ã€‚ å‚æ•° fnæ˜¯æŒ‡å‘æ–°è¿›ç¨‹è¦æ‰§è¡Œçš„å‡½æ•°çš„æŒ‡é’ˆï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª void* å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª int ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªè¿”å›å€¼å°†è¢« clone ç³»ç»Ÿè°ƒç”¨æ•è·ï¼Œå¹¶ä½œä¸ºå­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼› child_stackæ˜¯æ–°è¿›ç¨‹çš„å †æ ˆåœ°å€ï¼Œç”±äºå­è¿›ç¨‹å’Œè°ƒç”¨è¿›ç¨‹å¯èƒ½å…±äº«å†…å­˜ï¼Œå› æ­¤å­è¿›ç¨‹ä¸å¯èƒ½ä¸è°ƒç”¨è¿›ç¨‹åœ¨åŒä¸€å †æ ˆä¸­æ‰§è¡Œã€‚è°ƒç”¨è¿›ç¨‹å¿…é¡»ä¸ºå­å †æ ˆè®¾ç½®å†…å­˜ç©ºé—´ï¼Œå¹¶å°†æŒ‡å‘è¯¥ç©ºé—´çš„æŒ‡é’ˆä¼ é€’ç»™clone()ã€‚ flagså¯ä»¥è®¾ç½®æ–°è¿›ç¨‹çš„å±æ€§ï¼ˆé€šè¿‡äºŒè¿›åˆ¶ä½è®¾ç½®ï¼‰ï¼ŒåŒ…æ‹¬æ˜¯å¦ä¸åŸè¿›ç¨‹å…±äº«åœ°å€ç©ºé—´ï¼ˆCLONE_VMï¼‰ã€æ˜¯å¦å…±äº«æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼ˆCLONE_FILESï¼‰ã€æ˜¯å¦å…±äº«ä¿¡å·å¤„ç†å™¨ï¼ˆCLONE_SIGHANDï¼‰ç­‰ç­‰ï¼› int flags = CLONE_VM | CLONE_FS | CLONE_FILES | CLONE_SIGHAND | CLONE_THREAD | CLONE_SYSVSEM | CLONE_SETTLS; æ ‡å¿— å«ä¹‰ CLONE_PARENT åˆ›å»ºçš„å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹æ˜¯è°ƒç”¨è€…çš„çˆ¶è¿›ç¨‹ï¼Œæ–°è¿›ç¨‹ä¸åˆ›å»ºå®ƒçš„è¿›ç¨‹æˆäº†â€œå…„å¼Ÿâ€è€Œä¸æ˜¯â€œçˆ¶å­â€ CLONE_FS å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬rootã€å½“å‰ç›®å½•ã€umask CLONE_FILES å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰è¡¨ CLONE_NEWNS åœ¨æ–°çš„namespaceå¯åŠ¨å­è¿›ç¨‹ï¼Œnamespaceæè¿°äº†è¿›ç¨‹çš„æ–‡ä»¶hierarchy CLONE_SIGHAND å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„ä¿¡å·å¤„ç†ï¼ˆsignal handlerï¼‰è¡¨ CLONE_PTRACE è‹¥çˆ¶è¿›ç¨‹è¢«traceï¼Œå­è¿›ç¨‹ä¹Ÿè¢«trace CLONE_VFORK çˆ¶è¿›ç¨‹è¢«æŒ‚èµ·ï¼Œç›´è‡³å­è¿›ç¨‹é‡Šæ”¾è™šæ‹Ÿå†…å­˜èµ„æº CLONE_VM å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹è¿è¡Œäºç›¸åŒçš„å†…å­˜ç©ºé—´ CLONE_PID å­è¿›ç¨‹åœ¨åˆ›å»ºæ—¶PIDä¸çˆ¶è¿›ç¨‹ä¸€è‡´ CLONE_THREAD Linux 2.4ä¸­å¢åŠ ä»¥æ”¯æŒPOSIXçº¿ç¨‹æ ‡å‡†ï¼Œå­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„çº¿ç¨‹ç¾¤ argæ˜¯ä¼ é€’ç»™æ–°è¿›ç¨‹çš„å‚æ•°ï¼› å¯é€‰å‚æ•°ï¼ŒåŒ…æ‹¬ pid_t *parent_tidç­‰ã€‚ è¿”å›å€¼ æˆåŠŸæ—¶ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„ PIDã€‚å¤±è´¥æ—¶ï¼Œçˆ¶è¿›ç¨‹è¿”å› $-1$ï¼Œä¸åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶é€‚å½“è®¾ç½® errnoã€‚ é‡ç‚¹ clone å¯ä»¥åˆ›å»ºæ–°çš„è¿›ç¨‹æˆ–çº¿ç¨‹ï¼ŒLinuxåˆ›å»ºçº¿ç¨‹ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨å°±æ˜¯cloneã€‚è€Œ fork å’Œvforkåªèƒ½åˆ›å»ºè¿›ç¨‹ã€‚è¿™æ„å‘³ç€ clone å¯ä»¥åœ¨å•ä¸ªè¿›ç¨‹ä¸­åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œè€Œ fork åˆ™æ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ã€‚ clone æä¾›æ¯” fork å’Œ vfork æ›´å¤šçš„é€‰é¡¹ï¼Œå¯ä»¥æŒ‡å®šå­è¿›ç¨‹æˆ–çº¿ç¨‹çš„å †æ ˆã€ä¿¡å·å¤„ç†ã€æƒé™ç­‰ã€‚ clone çš„ä½¿ç”¨æ¯” fork å’Œ vfork æ›´å¤æ‚ï¼Œéœ€è¦æ­£ç¡®è®¾ç½® flagsã€child_stackã€parent_pidptrã€ptrã€stack_size å’Œ tls ç­‰å‚æ•°ã€‚ ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:3:1","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 cloneä½¿ç”¨ #define _GNU_SOURCE #include \u003csched.h\u003e #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cstring.h\u003e #include \u003csys/wait.h\u003e #include \u003cunistd.h\u003e #define STACK_SIZE (1024 * 1024) /* Stack size for cloned child */ // å®ï¼Œç®€åŒ–é”™è¯¯å¤„ç† #define ERREXIT(msg) { perror(msg); exit(EXIT_FAILURE); } // å®‰å…¨åˆ†é…å†…å­˜å‡½æ•°ï¼Œåˆ†é…å¤±è´¥æŠ¥å‘Šé”™è¯¯ #define CHECKALLOC(ptr, msg) ({ void *p = ptr; if (p == NULL) {ERREXIT(msg);} p;}) /* * å­è¿›ç¨‹å‡½æ•° * params: æ¥å—ä¸€ä¸ªvoid *ç±»å‹å‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œåé¢çš„å£°æ˜æ˜¯ç”¨äºå‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå‚æ•°æ˜¯æœªè¢«ä½¿ç”¨çš„ */ static int childFunc(void *arg __attribute__((unused))) { puts(\"child: start\"); sleep(2); puts(\"child: terminate\"); return 0; /* Child terminates now */ } int main(int argc, char *argv[]) { /* Start of stack buffer */ char **stacks; /* Child process's pids */ pid_t *pids; size_t nproc, i; // æ¥å—ä¸¤ä¸ªå‚æ•° if (argc != 2) { puts(\"Wrong way to execute the program:\\n\" \"\\t\\t./waitpid nProcesses\\n\" \"example:\\t./waitpid 2\"); return EXIT_FAILURE; } // åˆå§‹åŒ–nprocï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„å­è¿›ç¨‹æ•° nproc = atol(argv[1]); /* Process count */ // åˆ†é…å†…å­˜ç©ºé—´ stacks = CHECKALLOC(malloc(nproc * sizeof(void *)), \"malloc\"); pids = CHECKALLOC(malloc(nproc * sizeof(pid_t)), \"malloc\"); for (i = 0; i \u003c nproc; i++) { char *stackTop; /* End of stack buffer */ stacks[i] = CHECKALLOC(malloc(STACK_SIZE), \"stack malloc\"); // å¾—åˆ°æ ˆé¡¶ä½ç½® stackTop = stacks[i] + STACK_SIZE; /* * åˆ›å»ºå­è¿›ç¨‹ * ç¬¬ä¸€ä¸ªæ ‡å¿—è¡¨ç¤ºåœ¨å­è¿›ç¨‹æ¸…é™¤çº¿ç¨‹ç»„IDï¼ˆTIDï¼‰ï¼Œç›®çš„æ˜¯ä¸ºäº†é¿å…å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹æˆ–å…¶ä»–å­è¿›ç¨‹çš„çº¿ç¨‹ç»„IDå†²çª * ç¬¬äºŒä¸ªè¡¨ç¤ºå‘Šè¯‰åœ¨å­è¿›ç¨‹ä¸­è®¾ç½®çº¿ç¨‹IDï¼Œç›®çš„æ˜¯ä¸ºäº†å…è®¸çˆ¶è¿›ç¨‹åœ¨å­è¿›ç¨‹ä¸­è¿½è¸ªçº¿ç¨‹ * å‘Šè¯‰ clone ç³»ç»Ÿè°ƒç”¨åœ¨å­è¿›ç¨‹ä¸­é‡æ–°å®‰è£…ä¿¡å·å¤„ç†ç¨‹åºï¼Œç›®çš„æ˜¯ä¸ºäº†å…è®¸å­è¿›ç¨‹æ•è·å’Œå¤„ç†ä¿¡å·ï¼Œè€Œä¸æ˜¯ä¼ é€’ç»™çˆ¶è¿›ç¨‹ã€‚ */ pids[i] = clone(childFunc, stackTop, CLONE_CHILD_CLEARTID | CLONE_CHILD_SETTID | SIGCHLD, NULL); if (pids[i] == -1) ERREXIT(\"clone\"); printf(\"clone() returned %ld\\n\", (long)pids[i]); } sleep(1); // ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹ for (i = 0; i \u003c nproc; i++) { // ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­è¿›ç¨‹idï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä¸å…³å¿ƒå­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºç­‰å¾…ä»»ä½•å­è¿›ç¨‹ if (waitpid(pids[i], NULL, 0) == -1) ERREXIT(\"waitpid\"); printf(\"child %ld has terminated\\n\", (long)pids[i]); } // å›æ”¶å†…å­˜ç©ºé—´ for (i = 0; i \u003c nproc; i++) free(stacks[i]); free(stacks); free(pids); return EXIT_SUCCESS; } è¿è¡Œï¼šgcc clone-example.c \u0026\u0026 ./a.out 5ï¼Œå…¶ä¸­5ä¸ºnprocï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„è¿›ç¨‹æ•°ã€‚ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š ","date":"2024-03-12","objectID":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/:3:2","tags":["Linux"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/04.linux_fork%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"},{"categories":["èµ„æºæ”¶è—"],"content":" Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ è½¬è½½åˆ†äº«ï¼Œå‡ºå¤„å¦‚ä¸‹ï¼Œè°¢è°¢ ğŸ˜† åŸæ–‡åœ°å€: https://shockerli.net/post/go-awesome GitHub: https://github.com/shockerli/go-awesome å®˜ç½‘: https://golang.org å›½å†…å®˜ç½‘é•œåƒ(è®¿é—®å¿«): https://golang.google.cn GitHub: https://github.com/golang/go å¼€å‘è€…å¹³å°: https://go.dev Wiki: https://github.com/golang/go/wiki å®˜æ–¹åšå®¢: https://blog.golang.org ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:0:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"1 æŒ‡å¯¼åŸåˆ™ ç®€å•æ€§ å¤æ‚æ€§æŠŠå¯è¯»çš„ç¨‹åºå˜å¾—ä¸å¯è¯»ï¼Œå¤æ‚æ€§ç»ˆç»“äº†å¾ˆå¤šè½¯ä»¶é¡¹ç›®ã€‚ å¯è¯»æ€§ ä»£ç æ˜¯ç»™äººçœ‹çš„ï¼Œä»£ç é˜…è¯»æ—¶é•¿è¿œè¶…ç¼–å†™ã€‚ç¨‹åºå¿…é¡»å¯ç»´æŠ¤ï¼Œé‚£å¯è¯»æ˜¯ç¬¬ä¸€æ­¥ã€‚ ç”Ÿäº§ç‡ æ‹¥æœ‰ä¼—å¤šçš„å·¥å…·é›†å’ŒåŸºç¡€åº“ï¼Œå¯ä»¥å¾ˆç®€å•æ–¹ä¾¿çš„å®Œæˆç»å¤§å¤šæ•°å·¥ä½œã€‚ ç¼–è¯‘é€Ÿåº¦è¶³å¤Ÿå¿«ï¼Œæ‹¥æœ‰åŠ¨æ€è¯­è¨€çš„é«˜æ•ˆï¼Œä½†å´ä¸ä¼šé¢ä¸´åŠ¨æ€è¯­è¨€ä¸å¯é çš„é—®é¢˜ã€‚ è‡ªå¸¦ç¼–ç¨‹è§„èŒƒï¼Œä½¿å¾—å›¢é˜Ÿä»£ç ä¸€è‡´ï¼Œä¹Ÿå¸®åŠ©å¼€å‘è€…å‘ç°å’Œé¿å…æ½œåœ¨çš„é”™è¯¯ã€‚ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:1:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"2 Awesome GitHub Topic for Go Awesome Go golang-open-source-projects - å«æè¿°çš„ä¸­æ–‡ç‰ˆ Awesome Go Awesome Go Storage - Go å­˜å‚¨ç›¸å…³å¼€æºé¡¹ç›® awesome-go-China - ä¸“é—¨æ”¶é›†åäººå†™çš„å¼€æºé¡¹ç›® Go Patterns - Go ç‰ˆæœ¬çš„è®¾è®¡æ¨¡å¼ sevenelevenlee/go-patterns - è®¾è®¡æ¨¡å¼ GoF è®¾è®¡æ¨¡å¼ greyireland/algorithm-pattern - ç®—æ³•æ¨¡æ¿ go-algorithms - Go ç‰ˆæœ¬çš„æ•°æ®ç»“æ„å’Œç®—æ³• Go å­¦ä¹ ä¹‹è·¯ - Go å­¦ä¹ èµ„æ–™æ±‡é›† Go å¼€å‘è€…è·¯çº¿å›¾ ReposHub-Go VisuAlgo - æ•°æ®ç»“æ„å’Œç®—æ³•åŠ¨æ€å¯è§†åŒ– ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:2:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"3 å¤§ç‰›/ç»„ç»‡ Go è¯­è¨€æ–¹é¢çš„å¤§ç‰›ï¼Œæˆ–è€…ä¼˜ç§€ Go é¡¹ç›®çš„ç»„ç»‡ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:3:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"3.1 å¤§ç‰› mattn - å†™äº†æ•°ç™¾ä¸ª Go é¡¹ç›®ï¼Œç››äº§ä¼˜è´¨é¡¹ç›® Unknwon - gogs/macaron ç­‰é¡¹ç›®ä½œè€…ï¼Œã€ŠThe Way to Goã€‹è¯‘è€… Jinzhu - gorm/QOR ç­‰ä½œè€… valyala - fasthttp/fastjson ç­‰ä½œè€… vmihailenco - go-redis/go-pg ç­‰ä½œè€… kataras - iris ä½œè€… bep spf13 tidwall ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:3:1","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"3.2 ç»„ç»‡ Gorilla web toolkit loov HashiCorp lestrrat-go Uber - Open Source Software at Uber Stretchr - Tame your unstructured data Containous Charm - æä¾›ä¸€ç³»åˆ—ä¼˜ç§€çš„å‘½ä»¤è¡Œå·¥å…·å’Œåº“ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:3:2","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"4 æ–‡æ¡£ Proposing Changes to Go - Go è¯­è¨€è®¾è®¡æ–‡æ¡£ Go è¯­è¨€è®¾è®¡ä¸å®ç° Go è¯­è¨€åŸæœ¬ Go 101 ï¼ˆä¸­æ–‡ç‰ˆï¼‰ Go å®˜æ–¹å…¥é—¨æŒ‡å— Go è¯­è¨€é«˜çº§ç¼–ç¨‹ Go ä¸“å®¶ç¼–ç¨‹ Go ç¼–ç¨‹è¯­è¨€ Golang æ ‡å‡†åº“æ–‡æ¡£(å®˜æ–¹/ä¸­æ–‡) Go è¯­è¨€æ ‡å‡†åº“ åœ¨çº¿é˜…è¯» ã€ŠThe Way to Goã€‹ä¸­æ–‡ç‰ˆ Go è¯­è¨€åœ£ç»ï¼ˆä¸­æ–‡ç‰ˆï¼‰ Goè¯­è¨€å…¥é—¨æ•™ç¨‹ Go å®æˆ˜å¼€å‘ Go Web åº”ç”¨å¼€å‘ Go å­¦ä¹ æŠ€èƒ½æ ‘ å®æ•ˆ Go ç¼–ç¨‹ Go è¯­è¨€è¯­æ³•è¯¦è§£ç¬”è®° Go è¯­è¨€å­¦ä¹ èµ„æ–™ä¸ç¤¾åŒºç´¢å¼• Go database/sql tutorial GO å‘½ä»¤æ•™ç¨‹ æ·±å…¥è§£æ Go Go è¯­è¨€åšå®¢å®è·µ å­¦ä¹  Go è¯­è¨€ Go2ç¼–ç¨‹æŒ‡å— Go database/sql tutorial - Go æ•°æ®åº“(database/sql)å¼€å‘ä½¿ç”¨æ•™ç¨‹ Go Web Examples - Go Web å¼€å‘ç¤ºä¾‹ Go Assembly - é€šè¿‡ç¤ºä¾‹ä»‹ç» Go æ±‡ç¼–åŠŸèƒ½ Ultimate Go - ç»ˆæ Go å­¦ä¹ æŒ‡å—ï¼ŒåŒ…å«å¤§é‡æ–‡æ¡£åŒ–çš„ä»£ç å’Œç¨‹åºåˆ†æ Go æ•™ç¨‹ - è…¾è®¯äº‘å¼€å‘è€…æ‰‹å†Œ Golang å¼€å‘ç¬”è®° golang-notes - Go æºç é˜…è¯»ç¬”è®° The Little Go Book ï¼ˆä¸­æ–‡ç‰ˆï¼‰ Learning Goâ€Šâ€”â€Šfrom zero to hero go-internals - æ·±å…¥ç†è§£ Go Learn Go with Tests GoåŸºç¡€æ•™ç¨‹ 7å¤©ç”¨Goä»é›¶å®ç°ç³»åˆ— Go è¯­è¨€é«˜æ€§èƒ½ç¼–ç¨‹ Golang - 100å¤©ä»æ–°æ‰‹åˆ°å¤§å¸ˆ - æŸåŸ¹è®­æœºæ„çš„éƒ¨åˆ†æ•™ç¨‹å†…å®¹ hoanhan101/algo - 107+ ç¼–ç é¢è¯•é—®é¢˜ï¼ŒåŒ…æ‹¬è¯¦ç»†çš„è§£å†³æ–¹æ¡ˆï¼Œæµ‹è¯•ç”¨ä¾‹å’Œç¨‹åºåˆ†æ over-golang - Go å­¦ä¹ ç¬”è®° over-algorithm - Go ç®—æ³•ç¬”è®° learngo - 1000+ Go ç¤ºä¾‹ã€ç»ƒä¹ å’Œæµ‹è¯• go-leetcode - LeetCode å®ç° ç©è½¬ GO - ã€ŠMastering GOã€‹ä¸­æ–‡è¯‘æœ¬ leetcode-cookbook - LeetCode in Go Golangä¿®å…»ä¹‹è·¯ Goè¯­æ³•æ ‘å…¥é—¨ Go Concurrency Patterns - Go å¹¶å‘æ¨¡å¼åœºæ™¯é›†åˆ yezihack/algo - æ•°æ®ç»“æ„ä¸ç®—æ³• golang-cheat-sheet-cn - GitHubä¸Šæœ€æµè¡Œçš„Golangä»£ç é€ŸæŸ¥è¡¨ä¸­æ–‡ç¿»è¯‘ç‰ˆæœ¬ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:4:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"5 æŒ‡å— Uber Go Style Guide The Go Programming Language Specification ï¼ˆä¸­æ–‡è€ç‰ˆï¼‰ å®æ•ˆ Go ç¼–ç¨‹ Go Code Review Comments Go Code Convention Go FAQ 101 Go Details 101 Go Tips 101 Go Quizzes 101 go-advices go-perfbook - ç¼–å†™å’Œä¼˜åŒ–Goä»£ç  Practical Go: Real world advice for writing maintainable Go programs ï¼ˆGo è¯­è¨€å®è·µï¼šç¼–å†™å¯ç»´æŠ¤çš„ç¨‹åºçš„å»ºè®®ï¼‰ Go å®‰å…¨æŒ‡å— - è…¾è®¯å‘å¸ƒçš„ã€Šä»£ç å®‰å…¨æŒ‡å—ã€‹Go è¯­è¨€ç¯‡ Go Concurrency Guide Go Recipes - ä¸€äº›æŠ€å·§ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:5:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"6 æ–‡ç«  Go Training - å¤§é‡ä¼˜è´¨ Go ç›¸å…³æ–‡ç« ã€è§†é¢‘ç­‰èµ„æ–™ Goè¯­è¨€çˆ±å¥½è€…å‘¨åˆŠ Go å¤œè¯» - Go æ ‡å‡†åŒ…ã€å¼€æºé¡¹ç›®æºä»£ç é˜…è¯»è®²è§£ Go-Questions - Go è¯­è¨€å­¦ä¹ å…¥é—¨å’Œè¿›é˜¶çŸ¥è¯† Goçš„50åº¦ç°ï¼šGolangæ–°å¼€å‘è€…è¦æ³¨æ„çš„é™·é˜±å’Œå¸¸è§é”™è¯¯ Go ç¨‹åºçš„æ€§èƒ½ä¼˜åŒ–åŠ pprof çš„ä½¿ç”¨ gops - Goè¯­è¨€ç¨‹åºæŸ¥çœ‹å’Œè¯Šæ–­å·¥å…· Goæºç åˆ†æâ€”â€”http.ListenAndServe()æ˜¯å¦‚ä½•å·¥ä½œçš„ GoConvey æ¡†æ¶ä½¿ç”¨æŒ‡å— GoStub æ¡†æ¶ä½¿ç”¨æŒ‡å— GoMock æ¡†æ¶ä½¿ç”¨æŒ‡å— Monkey æ¡†æ¶ä½¿ç”¨æŒ‡å— The Evolution of a Go Programmer - Go ç¨‹åºå‘˜çš„è¿›åŒ–ä¹‹è·¯ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:6:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"7 ä»˜è´¹æ•™ç¨‹ åŸºäº Go è¯­è¨€æ„å»ºä¼ä¸šçº§çš„ RESTful API æœåŠ¡ - æ˜é‡‘å°å†Œ Goè¯­è¨€æ ¸å¿ƒ36è®² - æå®¢æ—¶é—´ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:7:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"8 æˆå“é¡¹ç›® Shiori - ä¹¦ç­¾ç®¡ç† studygolang - Go è¯­è¨€ä¸­æ–‡ç½‘ mkcert - ç”Ÿæˆæœ¬åœ° HTTPS åŠ å¯†è¯ä¹¦çš„å·¥å…· cfssl - Cloudflare å¼€æºçš„ PKI å’Œ TLS å·¥å…·é›† Rainbond - åŸºäºDockerã€Kubernetesç­‰å®¹å™¨æŠ€æœ¯çš„å¼€æºPaaS NYADB2 - Go å®ç°çš„å…³ç³»å‹æ•°æ®åº“, å€¼å¾—ç”¨äºå­¦ä¹  EiBlog - åšå®¢ pan-light - ä¸é™é€Ÿçš„ç™¾åº¦ç½‘ç›˜å®¢æˆ·ç«¯, åŸºäº Go + Qt5 å¼€å‘ BaiduPCS-Go - ç™¾åº¦ç½‘ç›˜å®¢æˆ·ç«¯ï¼ˆå‘½ä»¤è¡Œï¼‰ daily-warm - æ¯å¤©å®šæ—¶å‘é‚®ä»¶ç»™ä½ å…³å¿ƒçš„äºº pipe - åšå®¢å¹³å° mdr - å‘½ä»¤è¡Œä¸‹çš„ Markdown é˜…è¯»å·¥å…· miniflux - Feed é˜…è¯»å™¨ golinks - åˆ›å»ºè‡ªå®šä¹‰ä¹¦ç­¾ã€å‘½ä»¤ã€æœç´¢ç­‰ é“¾æ»´ç¬”è®° - æ¡Œé¢ç«¯ç¬”è®°åº”ç”¨ wayback - ç½‘é¡µå¿«ç…§å¤‡ä»½ bbs-go - å¼€æºç¤¾åŒº OpenSCRM - åŸºäºGoå’ŒReactçš„ä¼ä¸šå¾®ä¿¡ç§åŸŸæµé‡ç®¡ç†ç³»ç»Ÿ Answer - é—®ç­”ç¤¾åŒº listmonk - èµ„è®¯ã€é‚®ä»¶åˆ—è¡¨ç®¡ç†å·¥å…·ï¼ˆWebï¼‰ 1Panel - Linux æœåŠ¡å™¨è¿ç»´ç®¡ç†é¢æ¿ Artalk - è‡ªæ‰˜ç®¡è¯„è®ºç³»ç»Ÿ memos - ç¬”è®°æœåŠ¡ï¼Œå…·æœ‰ç§»åŠ¨å®¢æˆ·ç«¯ã€æµè§ˆå™¨æ‰©å±•ç­‰ç”Ÿæ€ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:8:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"8.1 é™æ€ç½‘ç«™ç”Ÿæˆå™¨ Hugo jrnl plenti verless ink moul - ç”Ÿæˆç…§ç‰‡ç«™ç‚¹ zas ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:8:1","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"9 å­¦ä¹ é¡¹ç›® 1m-go-websockets - è¯¥é¡¹ç›®æ¼”ç¤ºäº†å¦‚ä½•ç”¨ Go ç¼–å†™ä¸€ä¸ªå¯ä»¥æä¾›è¶…è¿‡ä¸€ç™¾ä¸‡ä¸ª websockets è¿æ¥ã€è¿è¡Œå†…å­˜å°äº 1GB çš„æœåŠ¡å™¨ Go by Example - é€šè¿‡å®ä¾‹å­¦ä¹  Go IAM - èº«ä»½è¯†åˆ«ä¸è®¿é—®ç®¡ç†ç³»ç»Ÿï¼ˆæ•™å­¦é¡¹ç›®ï¼‰ 100-go-mistakes - 100 ä¸ª Go å¸¸è§é”™è¯¯ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:9:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10 å¼€æºç±»åº“ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.1 Web æ¡†æ¶ Macaron - ä¸€æ¬¾å…·æœ‰é«˜ç”Ÿäº§åŠ›å’Œæ¨¡å—åŒ–è®¾è®¡çš„ Go Web æ¡†æ¶ å›½äº§ Beego - ä¸€ä¸ªä½¿ç”¨ Go çš„æ€ç»´æ¥å¸®åŠ©æ‚¨æ„å»ºå¹¶å¼€å‘ Go åº”ç”¨ç¨‹åºçš„å¼€æºæ¡†æ¶ å›½äº§ Gin - è½»é‡ Web æ¡†æ¶ Iris - Web å¼€å‘æ¡†æ¶ Revel echo Faygo - å›½äº§ Teleport - Socket æ¡†æ¶ GoFrame - å›½äº§ QOR - ç³»åˆ—åº”ç”¨å¼€å‘ç»„ä»¶åŒ… DotWeb - å›½äº§ REST Layer - REST API framework Honeytrap Ponzu utron muxie Buffalo - å¿«é€Ÿç”Ÿæˆ Web é¡¹ç›®çš„å¼€å‘å·¥å…· go-web-framework-benchmark fiber - ä¸€ç§ Express é£æ ¼çš„ã€åŸºäº fasthttp çš„ HTTP Web æ¡†æ¶ aah go-zero - å¥½æœªæ¥å¼€æºçš„ Web æ¡†æ¶ pingcap/fn - æ”¯æŒç»‘å®šä»»ä½•æ–¹æ³•ï¼Œæ„å»ºæˆ POST+JSON æ¥å£ flamego - unknwon å¼€å‘çš„åˆä¸€æ¬¾ Web æ¡†æ¶ REST Layer - REST API æ¡†æ¶ rk-boot ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:1","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.2 ä¸šåŠ¡æ¡†æ¶ YAO - ä½¿ç”¨ JSON å³å¯åˆ›å»ºæ•°æ®åº“æ¨¡å‹ã€ç¼–å†™ API æ¥å£ã€æè¿°ç®¡ç†åå°ç•Œé¢çš„åº”ç”¨å¼•æ“ GoAdminGroup/go-admin - åå°ç®¡ç†å¿«é€Ÿå¼€å‘æ¡†æ¶ï¼Œä¸ laravel-admin ç±»ä¼¼ wenjianzhang/go-admin - åŸºäº Gin + Vue å®ç°çš„åå°æ¡†æ¶ gin-vue-admin - åŸºäº Gin + Vue å®ç°çš„åå°æ¡†æ¶ goxygen - åŸºäº Go, React, MongoDB æŠ€æœ¯å®ç°çš„å…¨æ ˆåº”ç”¨ç”Ÿæˆå™¨ nging - Goè¯­è¨€é€šç”¨åå°ç®¡ç†æ¡†æ¶ snake - ä¸šåŠ¡APIæ¡†æ¶ PocketBase - å¸¦æœ‰åå°ç®¡ç†é¢æ¿ã€æ–‡ä»¶å’Œæƒé™ç®¡ç†ã€é›†æˆ SQLite æ•°æ®åº“çš„å•ä¸€æ–‡ä»¶åç«¯æœåŠ¡å¼€å‘æ¡†æ¶ï¼Œæ”¯æŒ Dart å’Œ JS SDK å¿«é€Ÿå¼€å‘ APP DoTenX - ä½ä»£ç æ¡†æ¶ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:2","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.3 é¡¹ç›®éª¨æ¶ Standard Go Project Layout - Go é¡¹ç›®ç›®å½•ç»“æ„ç¤ºä¾‹ go-starter - Adobe çš„ Go å·¥ç¨‹æ¨¡æ¿ go-clean-arch go-rest-api - Go RESTful API Starter Kit Create Go App CLI - é€šè¿‡å‘½ä»¤è¡Œåˆ›å»ºå‰åç«¯é¡¹ç›®çš„å¼€å‘éª¨æ¶ clean-gin - åŸºäº Gin æ„å»ºçš„æ•´æ´æ¶æ„é¡¹ç›®éª¨æ¶ golang-repo-template - ä¸€ä¸ªåŒ…å«äº†å¾ˆå¤šå®è·µçš„é¡¹ç›®æ¨¡æ¿ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:3","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.4 DDD æ¡†æ¶ Wild Workouts - DDDã€æ•´æ´æ¶æ„ã€CQRSçš„ç¤ºä¾‹é¡¹ç›® Clean Architecture in Go - æ•´æ´æ¶æ„ç¤ºä¾‹ freedom - åŸºäºå…­è¾¹å½¢æ¶æ„çš„æ¡†æ¶ esim - åŸºäºå…­è¾¹å½¢æ¶æ„çš„å¾®æœåŠ¡æ¡†æ¶ go-cleanarch - Go æ•´æ´æ¶æ„è§„åˆ™æ ¡éªŒå·¥å…· ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:4","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.5 TCP æ¡†æ¶ zinx - TCPå¹¶å‘æœåŠ¡å™¨æ¡†æ¶ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:5","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.6 ä¸­é—´ä»¶ Negroni - Web ä¸­é—´ä»¶ csrf - CSRF ä¸­é—´ä»¶ handlers - A collection of useful handlers for Goâ€™s net/http package ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:6","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.7 å¹¶å‘ SizedWaitGroup - å¹¶å‘æ§åˆ¶ concurrent - concurrency utilities ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:7","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.8 å‘½ä»¤è¡Œ 10.8.1 å‚æ•°è§£æ urfave/cli - å‘½ä»¤è¡Œç¨‹åºæ„å»ºå·¥å…· Cobra - å‘½ä»¤è¡Œæ„å»ºåŒ… flaggy - å‘½ä»¤å‚æ•°è§£æ pflag - å‘½ä»¤è¡Œå‚æ•°å¤„ç† kong - å‘½ä»¤è¡Œè§£æ clop - å‘½ä»¤è¡Œè§£æåŒ… go-flags - å‘½ä»¤è¡Œå‚æ•°è§£æ mow.cli go-arg - åŸºäºç»“æ„ä½“Tagè§£æå‘½ä»¤è¡Œå‚æ•° 10.8.2 è¾“å‡ºå±•ç¤º progressbar - åœ¨ç»ˆç«¯ä¸Šè¾“å‡ºè¿›åº¦æ¡ cheggaaa/pb - ç»ˆç«¯è¿›åº¦æ¡ mpb - æ”¯æŒå¤šä¸ªè¿›åº¦æ¡ Color - å‘½ä»¤è¡Œæ–‡å­—é¢œè‰² gookit/color - å‘½ä»¤è¡Œè‰²å½©ä½¿ç”¨åº“ termui - ç»ˆç«¯ä»ªè¡¨ç›˜ tui - ç»ˆç«¯ UI termenv - ç»ˆç«¯åº”ç”¨ç¨‹åºçš„é«˜çº§ ANSI æ ·å¼å’Œé¢œè‰²æ”¯æŒ asciigraph - åœ¨ç»ˆç«¯ä¸­ç»˜åˆ¶ ASCII å­—ç¬¦çš„å›¾è¡¨ spinner - æ¶µç›–70å¤šç§ç¬¦å·æˆ–è¿›åº¦æ¡çš„æ§åˆ¶å™¨ tablewriter - ç»ˆç«¯ä¸­è¾“å‡ºè¡¨æ ¼å†…å®¹ PIXterm - åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸­ç»˜å›¾ WTF - ä¸€ä¸ªå‘½ä»¤è¡Œçš„ä¿¡æ¯ä»ªè¡¨ç›˜ï¼Œå¯ä»¥å®šåˆ¶æ˜¾ç¤ºå†…å®¹ termdash - åŸºäº Go Terminal çš„ä»ªè¡¨æ¿ç³»ç»Ÿ bubbles - TUI ç»„ä»¶ bubbletea - TUI æ¡†æ¶ PTerm - æ”¯æŒå›¾è¡¨ã€è¡¨æ ¼ã€è¿›åº¦æ¡ã€æ ‘ç­‰ç»ˆç«¯è¾“å‡ºå±•ç¤º Lip Gloss - ç»ˆç«¯å¸ƒå±€ã€æ ·å¼ gum glow - ç»ˆç«¯æ¸²æŸ“å±•ç¤º Markdown Slides - ç»ˆç«¯æ¸²æŸ“å±•ç¤º Markdown tview - Terminal UI ASCIIPlayer - åœ¨ç»ˆç«¯ä¸­é€šè¿‡ ASCII è¾“å‡ºå›¾ç‰‡æˆ–è§†é¢‘ï¼Œæ”¯æŒ pngã€jpegã€gifã€mp4ã€avi ç­‰æ ¼å¼ go-pretty - ç»ˆç«¯æ¸²æŸ“è¡¨æ ¼ã€åˆ—è¡¨ã€è¿›åº¦æ¡ç­‰ tcell 10.8.3 å…¶ä»– gosu - ä»¥æŒ‡å®šçš„ç”¨æˆ·æƒé™æ¥è¿è¡Œè„šæœ¬ gotop - ç±» top ç³»ç»Ÿç›‘æ§æ˜¾ç¤º go-colorable - Colorable writer for Windows go-isatty - TTY ç¯å¢ƒåˆ¤æ–­ fzf - ç»ˆç«¯æ¨¡ç³ŠæŸ¥è¯¢ç¥å™¨ï¼Œæ”¯æŒå¤šå¹³å° go-daemon - daemon è¿›ç¨‹åŒ… go-prompt - å‘½ä»¤è¡Œäº¤äº’å¼è¾“å…¥ peco - äº¤äº’å¼è¿‡æ»¤å·¥å…· pty - PTY for Go vtclean - ä»ç»ˆç«¯è¾“å‡ºå­—ç¬¦ä¸²ä¸­è§£æå‡ºçº¯æ–‡æœ¬ Survey - äº¤äº’å¼è¾“å…¥ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:8","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.9 ç»ˆç«¯å·¥å…· vgrep - æ”¯æŒæ»šåŠ¨åˆ†é¡µçš„ grep GoTTY - åŸºäºWebçš„å‘½ä»¤è¡Œå®æ—¶å…±äº« Jump - æ ¹æ®ä¹ æƒ¯å¿«é€Ÿè·³è½¬ç›®å½• GoFish - ä¸€ä¸ªå— Homebrew å¯å‘çš„è·¨å¹³å°è½¯ä»¶ç®¡ç†å·¥å…·ï¼Œæ”¯æŒ Linux å’Œ Windows viddy - å¢å¼ºç‰ˆ watch å‘½ä»¤ miller - ä¸€ä¸ªç±»ä¼¼ sedã€awkã€cutã€join å’Œ sort çš„å·¥å…·ï¼Œç”¨æ¥å¤„ç†åŸºäºå‘½åç´¢å¼•çš„æ•°æ® assh - SSH å¢å¼ºå·¥å…· duf - æ¯” df æ›´å¥½ç”¨çš„ç£ç›˜ä½¿ç”¨ç‡å·¥å…· ov - ç»ˆç«¯æ–‡æœ¬é˜…è¯»å™¨ï¼Œå¯æ›¿ä»£ lessã€moreã€tail -f ç­‰ trdsql - å¯å¯¹ CSV/LTSV/JSON/TBLN ç­‰æ–‡ä»¶æ‰§è¡Œ SQL æŸ¥è¯¢å’Œå¯¼å‡º vhs - ç»ˆç«¯å½•åƒå·¥å…·ï¼Œæä¾›äº†åœ¨ç»ˆç«¯ä¸­å½•åˆ¶å’Œå›æ”¾ç»ˆç«¯ä¼šè¯çš„åŠŸèƒ½ï¼Œç±»ä¼¼äºå°†ç»ˆç«¯ä¼šè¯è®°å½•ä¸ºè§†é¢‘çš„æ–¹å¼ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:9","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.10 è·¯ç”± HttpRouter mux - URL è·¯ç”±å’Œè°ƒåº¦å™¨ chi gocraft/web go-querystring - è½¬æ¢ç»“æ„ä½“ä¸ºURLè¯·æ±‚å‚æ•° gorilla/schema - converts structs to and from form values CleverGo rewrite - rewrite ä¸­é—´ä»¶ BunRouter - æ”¯æŒä¸­é—´ä»¶ã€é”™è¯¯å¤„ç†ã€è·¯ç”±ä¼˜å…ˆçº§ã€å…¼å®¹ net/http æ¥å£ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:10","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.11 ç½‘ç»œ DNS - DNS åº“ CoreDNS - DNS æœåŠ¡å™¨ RoadRunner - PHP åº”ç”¨æœåŠ¡å™¨ã€è¿›ç¨‹ç®¡ç†å™¨ã€è´Ÿè½½å‡è¡¡ï¼Œç”¨äºæ›¿ä»£ Nginx + FPM FrankenPHP - PHP åº”ç”¨æœåŠ¡å™¨ GoReplay - æµé‡æ”¶é›†\u0026å›æ”¾ Sharingan - æ»´æ»´å¼€æºçš„æµé‡å½•åˆ¶å›æ”¾å·¥å…· Glorp - HTTP æ‹¦æˆª\u0026é‡æ”¾çš„ CLI å·¥å…· p2pspider - ç§å­å—…æ¢å™¨ torrent - BitTorrent ç›¸å…³å·¥å…·åº“ rain - BitTorrent å®¢æˆ·ç«¯å’Œåº“ httpteleport - Teleports 10Gbps http traffic over 1Gbps networks FIND3 - WiFi è®¾å¤‡å‘ç° SubFinder - å­åŸŸåå‘ç°å·¥å…· ggz - çŸ­ç½‘å€æœåŠ¡ httpstat grab - æ–‡ä»¶ä¸‹è½½ go-getter - å¯ä½¿ç”¨ URL ä½œä¸ºè¾“å…¥çš„ä¸»è¦å½¢å¼ä»å„ç§æ¥æºä¸‹è½½æ–‡ä»¶æˆ–ç›®å½• go-netty - ç½‘ç»œæ¡†æ¶ gnet - äº‹ä»¶é©±åŠ¨ Go ç½‘ç»œæ¡†æ¶ netpoll - ä¸“æ³¨äº RPC åœºæ™¯çš„ Non-blocking I/O ç½‘ç»œåº“ httplab - The interactive web server yamux - Multiplexer sftp - SFTP support for the go.crypto/ssh package goftp - FTP å®¢æˆ·ç«¯ SFTPGo - åŠŸèƒ½é½å…¨ä¸”å¯é«˜åº¦é…ç½®çš„SFTPæœåŠ¡å™¨ï¼Œå¯é€‰æ‹©æ”¯æŒHTTP/Sã€FTP/Så’ŒWebDAVã€‚æ”¯æŒçš„å­˜å‚¨åç«¯åŒ…æ‹¬ï¼šæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€åŠ å¯†çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€S3ï¼ˆå…¼å®¹ï¼‰å¯¹è±¡å­˜å‚¨ã€Google Cloud Storageã€Azure Blob Storageä»¥åŠå…¶ä»–SFTPæœåŠ¡å™¨ã€‚ evio - äº‹ä»¶é©±åŠ¨ç½‘ç»œæ¡†æ¶ï¼ˆreactor æ¨¡å¼ï¼‰ gaio - äº‹ä»¶é©±åŠ¨ç½‘ç»œæ¡†æ¶ï¼ˆproactor æ¨¡å¼ï¼‰ httpretty - åœ¨ç»ˆç«¯ä¸Šæ¼‚äº®åœ°æ‰“å°å‡º HTTP è¯·æ±‚ blocky - ä½œä¸ºå±€åŸŸç½‘ DNS ä»£ç†æ‹¦æˆªå¹¿å‘Š lossy - æ¨¡æ‹Ÿ net.PacketConn å’Œ net.Conn æ¥å£çš„å¸¦å®½ï¼Œå»¶è¿Ÿå’Œæ•°æ®åŒ…ä¸¢å¤± go-libp2p - P2P go-ipfs-api - IPFS gomobile-ipfs - ä¸ºç§»åŠ¨ç»ˆç«¯æä¾›IPFSç½‘ç»œè®¿é—®æ”¯æŒ go-multiaddr - multiaddr kcp-go - å¯é çš„ UDP é€šè®¯åŒ… gliderlabs/ssh - åƒ net/http ä¸€æ ·è½»æ¾æ­å»º SSH æœåŠ¡å™¨ netaddr - ç½‘ç»œåœ°å€å¤„ç† sx - ç½‘ç»œæ‰«æå‘½ä»¤å·¥å…· echoip - IP åœ°å€æŸ¥æ‰¾æœåŠ¡ EasyTCP - TCP Server æ¡†æ¶ GoPacket - ç½‘ç»œæ•è·æŠ“åŒ… croc - ä¸¤å°ç”µè„‘ä¹‹é—´ä¼ è¾“æ–‡ä»¶ cmux - ç›‘å¬åŒä¸€ä¸ªç«¯å£ï¼Œå¯åŠ¨å¤šç§åè®®æœåŠ¡ GeoIP2 Reader for Go - è§£æ\u0026è¯»å– MaxMind GeoLite2 å’Œ GeoIP2 æ•°æ®åº“ dns.toys - DNS æœåŠ¡å™¨ Apache Traffic Control - CDN æµé‡æ§åˆ¶ NextTrace - å¯è§†åŒ–è·¯ç”±è¿½è¸ªå·¥å…· pget - æ–‡ä»¶ä¸‹è½½å·¥å…·ï¼Œå¯å¤šè¿æ¥ä¸‹è½½ CloudflareSpeedTest - æµ‹è¯• Cloudflare CDN å»¶è¿Ÿå’Œé€Ÿåº¦ï¼Œè·å–æœ€å¿« IP 10.11.1 LDAP go-ldap GLAuth - LDAP Server gldap - LDAP Service 10.11.2 ç½‘ç»œä»£ç† Caddy - ç±»ä¼¼ Nginx çš„ Web æœåŠ¡å™¨ Traefik - åå‘ä»£ç†\u0026è´Ÿè½½å‡è¡¡ snail007/goproxy - golang å®ç°çš„é«˜æ€§èƒ½ä»£ç†æœåŠ¡å™¨ ProxyPool - é‡‡é›†å…è´¹çš„ä»£ç†èµ„æºä¸ºçˆ¬è™«æä¾›æœ‰æ•ˆçš„IPä»£ç† frp - å¯ç”¨äºå†…ç½‘ç©¿é€çš„é«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ nps - ä¸€æ¬¾è½»é‡çº§ã€é«˜æ€§èƒ½ã€åŠŸèƒ½å¼ºå¤§çš„å†…ç½‘ç©¿é€ä»£ç†æœåŠ¡å™¨ Pomerium - åŸºäºèº«ä»½çš„åå‘ä»£ç† V2Ray V2Fly - V2Ray çš„ç¤¾åŒºç‰ˆæœ¬ Tailscale - WireGuard è§£å†³æ–¹æ¡ˆ Clash - æ”¯æŒå¤šç§åè®®çš„å¤šå¹³å°ä»£ç†å®¢æˆ·ç«¯ elazarl/goproxy - HTTP ä»£ç† oxy - Go middlewares for HTTP servers \u0026 proxies ouqiang/goproxy - Go HTTP(S)ä»£ç†åº“, æ”¯æŒä¸­é—´äººä»£ç†è§£å¯†HTTPS pgrok - æä¾›ç»™ç©·äººçš„å†…ç½‘ç©¿é€ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:11","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.12 HTTPå‹æµ‹ Vegeta - HTTP è´Ÿè½½å‹æµ‹å·¥å…· hey - Web å‹æµ‹å·¥å…· bombardier - Web å‹æµ‹å·¥å…· go-wrk plow Ddosify ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:12","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.13 HTTP fasthttp - æ¯” net/http å¿« 10 å€çš„ HTTP å·¥å…·åŒ… Resty - HTTP \u0026 REST å®¢æˆ·ç«¯åŒ… gout - HTTP å®¢æˆ·ç«¯ gentleman - HTTP å®¢æˆ·ç«¯ goz UserAgent - è§£æ HTTP User Agent purell - URL è§„èŒƒå·¥å…·åŒ… go-autorest - HTTP ç®¡é“è¯·æ±‚æ–¹å¼çš„å®¢æˆ·ç«¯ Req - HTTP å®¢æˆ·ç«¯ cors - CORS Handler CertMagic - ä¸ºä»»æ„ Go ç¨‹åºè‡ªåŠ¨åŠ ä¸Š HTTPSï¼ŒTLS è¯ä¹¦ç­¾å‘ã€æ›´æ–°å…¨è‡ªåŠ¨ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:13","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.14 WebSocket gorilla/websocket nhooyr/websocket - å®˜æ–¹æ¨èçš„åŒ… websocketd - Go å¼€å‘çš„ä¸€é”®æ­å»º WebSocket æœåŠ¡å™¨å‘½ä»¤è¡Œå·¥å…· ws - WebSocket å¼€å‘åŒ… melody - WebSocket æœåŠ¡æ¡†æ¶ neffos - ä¸€ä¸ªå¿«é€Ÿä¸”å¯æ‰©å±•çš„ WebSocket æ¡†æ¶ fastws ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:14","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.15 å³æ—¶é€šä¿¡ Centrifugo - å®æ—¶æ¶ˆæ¯æœåŠ¡å™¨ï¼Œå¯ä»¥ä¸ä»»ä½•è¯­è¨€ç¼–å†™çš„åº”ç”¨ç¨‹åºåç«¯ç»“åˆä½¿ç”¨ goim - æ”¯æŒé›†ç¾¤çš„ im åŠå®æ—¶æ¨é€æœåŠ¡ Tinode - å³æ—¶æ¶ˆæ¯æœåŠ¡å™¨ï¼Œé€šè¿‡ websocket/JSON æˆ– gRPC/TCP ç­‰åè®®ä¼ è¾“ WebRTC - WebRTC å®ç° Berty - å®‰å…¨çš„ç‚¹å¯¹ç‚¹é€šè®¯è½¯ä»¶ Keybase - å³æ—¶é€šè®¯å·¥å…· Keybase å…¨å¹³å°å®¢æˆ·ç«¯ gotify - åŸºäº WebSocket çš„ PUSH é€šçŸ¥æœåŠ¡ nakama - ç”¨äºç¤¾äº¤/å®æ—¶æ¸¸æˆ/å®æ—¶åº”ç”¨çš„åˆ†å¸ƒå¼æœåŠ¡ç«¯ç¨‹åºï¼Œè‡ªå¸¦é¢æ¿ã€ç”¨æˆ·ã€èŠå¤©ã€å­˜å‚¨ã€ç¤¾äº¤ç­‰åŠŸèƒ½ OpenIM ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:15","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.16 ç½‘å…³ GoKu API Gateway CE - eoLinker å¼€æºçš„ API ç½‘å…³ Easegress Manba Tpk BFE - åŸºäºç™¾åº¦ç»Ÿä¸€æ¥å…¥å‰ç«¯å¼€æºçš„ä¸ƒå±‚æµé‡æ¥å…¥ç³»ç»Ÿ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:16","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.17 åºåˆ—åŒ– vmihailenco/msgpack - æ”¯æŒ msgpack go/codec - æ”¯æŒ msgpack/binc/cbor/json golang/protobuf - Go ç‰ˆæœ¬çš„ Protocol Buffers gogo/protobuf - golang/protobuf çš„æ‰©å±•æ›¿ä»£å“ Objx - æ“ä½œ map, slice, JSON ç­‰æ•°æ®çš„åŒ… msgp - MessagePack ä»£ç ç”Ÿæˆå™¨ Buf - protoc æ›¿ä»£å“ protoc-gen-doc - Google Protocol Buffers æ–‡æ¡£ç”Ÿæˆæ’ä»¶ï¼Œæ”¯æŒ HTMLã€JSONã€DocBookã€Markdown å’Œè‡ªå®šä¹‰æ¨¡æ¿ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:17","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.18 è§£å‹ç¼© snappy - Go è¯­è¨€ç‰ˆæœ¬çš„ Snappy cae - å®ç° ZIP/TAR.GZ è§£å‹ç¼© archiver - å¤šæ ¼å¼æ”¯æŒçš„è§£å‹ç¼©åŒ… compress - Optimized compression packages Brotli xz - xz å‹ç¼©æ ¼å¼è¯»å†™åŒ… ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:18","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.19 RPC gRPC-Go - gRPC å®˜æ–¹åŒ… Go gRPC Middleware - gRPC å¸¸ç”¨ä¸­é—´ä»¶ gorpc gorilla/rpc - æ„å»ºåŸºäº HTTP çš„ RPC æœåŠ¡ï¼Œæ¯”å¦‚ JSON-RPC Lile - gRPC æœåŠ¡æ„å»ºåŒ… rpcx Twirp - åŸºäº Protobuf çš„ RPC æ¡†æ¶ï¼Œä¸ gRPC ç±»ä¼¼ dubbo-go - Dubbo Go ç‰ˆæœ¬ Kitex gRPCurl - åƒ cURL ä¸€æ ·é€šè¿‡å‘½ä»¤è¡Œè®¿é—® gRPC æœåŠ¡ protoc-gen-doc - æ–‡æ¡£ç”Ÿæˆæ’ä»¶ gRPC-Gateway - è¯»å– gRPC æœåŠ¡å®šä¹‰å¹¶ç”Ÿæˆä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ï¼ŒåŒæ—¶æä¾› gRPC å’Œ RESTful é£æ ¼çš„ API ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:19","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.20 é‚®ä»¶ gomail - é‚®ä»¶å‘é€åŒ… scorredoira/email Hermes - Go ç‰ˆæœ¬çš„ mailgen å¼•æ“ï¼Œæ ¹æ®é…ç½®ç”Ÿæˆ HTML æ ¼å¼çš„é‚®ä»¶ Go-Guerrilla - SMTP é‚®ä»¶æœåŠ¡å™¨ MailHog - åŸºäºWebå’ŒAPIçš„SMTPæµ‹è¯•å·¥å…· Maddy - é‚®ä»¶æœåŠ¡å™¨ jordan-wright/email Mox - é‚®ä»¶æœåŠ¡å™¨ Pop - é‚®ä»¶å‘é€å·¥å…·ï¼Œæ”¯æŒäº¤äº’å¼å’Œå‚æ•°å¼ email-verifier - é‚®ç®±æ ¡éªŒï¼Œæ— éœ€å‘é€é‚®ä»¶ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:20","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.21 æ¶ˆæ¯é˜Ÿåˆ— NSQ - å®æ—¶åˆ†å¸ƒå¼æ¶ˆæ¯å¹³å° NATS - äº‘åŸç”Ÿæ¶ˆæ¯ä¸­é—´ä»¶ amqp - AMQP 0.9.1 å®¢æˆ·ç«¯ sarama - Kafka å®¢æˆ·ç«¯ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:21","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.22 æ–‡ä»¶/å­˜å‚¨ MinIO - å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨ rclone - ä¸åŒäº‘å­˜å‚¨ä¹‹é—´åŒæ­¥æ–‡ä»¶ Syncthing - æ–‡ä»¶åŒæ­¥ fsnotify - æ–‡ä»¶ç³»ç»Ÿç›‘æ§å·¥å…· reflex - ç›‘å¬æ–‡ä»¶å˜æ›´å¹¶æ‰§è¡Œå‘½ä»¤ gohttpserver - HTTP é™æ€æ–‡ä»¶æœåŠ¡å™¨ XLSX - Excel è¯»å†™åŒ… Excelize - 360 å¼€æºçš„ Excel å·¥å…·åŒ… gopdf - PDF ç”Ÿæˆ rsc/pdf - PDF reader SeaweedFS - åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ go-fastdfs - åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨æœåŠ¡ Dragonfly - åŸºäº P2P çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ filetype - æ£€æµ‹æ–‡ä»¶ç±»å‹ Afero - æ–‡ä»¶æ“ä½œåŒ… fsync - æ–‡ä»¶/ç›®å½•åŒæ­¥ filebrowser - Web File Browser Bigfile - æ–‡ä»¶ä¼ è¾“ç®¡ç†ç³»ç»Ÿ filetype - æ–‡ä»¶ç±»å‹ä¸ MIME æ£€æµ‹ go-app-paths - è·¨å¹³å°æ£€ç´¢ç›®å½•æ–‡ä»¶ copy - æ‹·è´æ–‡ä»¶å¤¹ lakeFS - ç±» Git æ–‡ä»¶å¯¹è±¡å­˜å‚¨ Duplicacy - æ— é”äº‘å¤‡ä»½å·¥å…·ï¼Œæ”¯æŒå‡ ä¹æ‰€æœ‰å­˜å‚¨æ–¹å¼ CasaOS - å®¶åº­äº‘ç³»ç»Ÿ AList - æ”¯æŒå¤šå­˜å‚¨çš„æ–‡ä»¶åˆ—è¡¨ç¨‹åº UniPDF - PDF è¯»å†™å¤„ç† mimetype - MIME ç±»å‹ä¸æ–‡ä»¶æ‰©å±•æ£€æµ‹ gocryptfs - åŠ å¯† overlay æ–‡ä»¶ç³»ç»Ÿ restic - å¤‡ä»½å·¥å…·ï¼Œä½¿ç”¨ç°ä»£çš„åŠ å¯†æ–¹æ³•å¯¹æ•°æ®è¿›è¡Œå®‰å…¨çš„å¤‡ä»½ï¼Œæ”¯æŒ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:22","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.23 æ¨¡æ¿å¼•æ“ goTemplateBenchmark - ç»™å„ Go æ¨¡æ¿å¼•æ“åšæ€§èƒ½æµ‹è¯•ï¼Œå½“ç„¶ä¹Ÿå°±åŒ…å«äº†æœ€å…¨çš„æ¨¡æ¿å¼•æ“åŒ… Jet - é€Ÿåº¦å¾ˆå¿« amber - HTML æ¨¡æ¿å¼•æ“ fasttemplate - Simple and fast template engine for Go quicktemplate mustache Ace Sprig - å¸¸ç”¨æ¨¡æ¿æ–¹æ³• pongo2 - Django è¯­æ³•é£æ ¼çš„æ¨¡æ¿å¼•æ“ plush ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:23","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.24 ä»£ç ç”Ÿæˆ esc ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:24","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.25 æ–‡æœ¬å¤„ç† 10.25.1 Markdown Blackfriday - Markdown è§£æå™¨ Lute - ç»“æ„åŒ–çš„ Markdown å¼•æ“ goldmark - Markdown è§£æå™¨ docx2md - è½¬æ¢ Word ä¸º Markdown glamour - å‘½ä»¤è¡Œä¸‹æ¸²æŸ“ Markdown go-md2man - è½¬æ¢ Markdown ä¸º man æ‰‹å†Œå†…å®¹ gomarkdown/markdown html-to-markdown - è½¬æ¢ HTML ä¸º Markdown 10.25.2 HTML/CSS DOM - HTML DOM èŠ‚ç‚¹æ“ä½œ obelisk - ä¿å­˜ Web ç½‘é¡µä¸º HTML å•é¡µé¢ html2text - HTML è½¬ text go-readability - è®© HTML å¯è¯»æ€§æ›´é«˜ gomponents - å£°æ˜å¼è§†å›¾ç»„ä»¶ï¼Œå¯ä»¥æ¸²æŸ“æˆ HTML5 daz - HTML ç»„ä»¶ç»„åˆï¼Œæ¸²æŸ“ HTML html-strip-tags-go - å»é™¤ HTML æ ‡ç­¾ bluemonday - XSS æ¢æµ‹ cascadia - CSS é€‰æ‹©å™¨ htmlquery - XPath è¯­æ³•æŸ¥è¯¢ HTML xmlquery - XPath è¯­æ³•æŸ¥è¯¢ XML xpath - XPath è¯­æ³• goquery - jQuery è¯­æ³•æŸ¥è¯¢ HTML css - CSS é€‰æ‹©å™¨ 10.25.3 å…¶ä»– go-runewidth - å­—ç¬¦é•¿åº¦è®¡ç®— gpy - Go è¯­è¨€æ±‰å­—è½¬æ‹¼éŸ³å·¥å…· go-hashids - hashids çš„ Go ç‰ˆæœ¬ go-pinyin - æ±‰è¯­æ‹¼éŸ³è½¬æ¢å·¥å…· Go ç‰ˆ mahonia - å­—ç¬¦é›†ç¼–ç è½¬æ¢ pangu.go - Go ç‰ˆæœ¬çš„ panguï¼Œç»™ä¸­è‹±æ–‡ä¹‹é—´åŠ ç©ºæ ¼ goorgeous - A Go ORG syntax parser to HTML sergi/go-diff - Go ç‰ˆæœ¬çš„ diff å·¥å…·åŒ… sourcegraph/go-diff - Go ç‰ˆæœ¬çš„ diff å·¥å…·åŒ… Chroma - ä»£ç è¯­æ³•é«˜äº® syntaxhighlight - ä»£ç é«˜äº® kyokomi/emoji enescakir/emoji golang/freetype - Freetype font rasterizer prose - natural language processing library minify - Web é™æ€èµ„æºå‹ç¼©(HTML/JS/CSS/JSON/XML/SVG) Inflection - Pluralizes and singularizes English nouns autocorrect - è‡ªåŠ¨ç»™ä¸­è‹±æ–‡ä¹‹é—´åŠ å…¥åˆç†çš„ç©ºæ ¼å¹¶çº æ­£ä¸“ç”¨åè¯å¤§å°å†™ bleve - modern text indexing etree - XML è§£æ\u0026ç”Ÿæˆ go-xml feeds - RSS å†…å®¹ç”Ÿæˆ gofeed - RSS \u0026 Atom feeds å†…å®¹è§£æ sitemap - sitemap.xml ç”Ÿæˆ yarr - RSS é˜…è¯»è½¯ä»¶ gogrep - é€šè¿‡è¯­æ³•æ ‘æœç´¢ Go æºç  PipeIt - æ–‡æœ¬è½¬æ¢ï¼Œæ¸…ç†å’Œæå–å·¥å…· regexp2 - å…¨åŠŸèƒ½æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ã€‚å¦‚æœæ ‡å‡†åº“çš„ regexp æ»¡è¶³ä¸äº†ä½ ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ regexp2 html2article - åŸºäºæ–‡æœ¬å¯†åº¦çš„ html2article å®ç° hostctl - hosts å‘½ä»¤è¡Œç®¡ç†å·¥å…· go-shellwords - è§£æå‘½ä»¤è¡Œä¸­å­—æ®µ woke - æ£€æŸ¥æ–‡æœ¬æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨æ­§è§†è¯æ±‡ go-password-validator - å¯†ç å¼ºåº¦æ ¡éªŒå™¨ xurls - ä»æ–‡æœ¬ä¸­æå– URL whatlanggo - è‡ªç„¶è¯­è¨€æ¢æµ‹ go-enry - æ£€æµ‹ç¼–ç¨‹è¯­è¨€ fuzzy - å­—ç¬¦ä¸²æ¨¡ç³ŠåŒ¹é… godlp - æ•°æ®è„±æ• Zoekt - æ–‡æœ¬æœç´¢å¼•æ“ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:25","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.26 æ–‡æ¡£ swag - Swagger for Go gin-swagger - Swagger for Gin go-swagger - Swagger 2.0 implementation for go ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:26","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.27 æ•°å­¦è®¡ç®— decimal - è§£å†³æµ®ç‚¹æ•°è®¡ç®—ç²¾åº¦é—®é¢˜ fixed apd - decimal åŒ… mathfmt - å°† LaTeX è¯­æ³•çš„æ³¨é‡Šè½¬æ¢ä¸ºæ•°å­¦å…¬å¼æ ¼å¼ q - é‡å­è®¡ç®—æ¨¡æ‹Ÿå™¨ accounting - è´§å¸æ ¼å¼åŒ– ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:27","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.28 æ—¥æœŸæ—¶é—´ now when - è‡ªç„¶æ—¥æœŸæ—¶é—´è§£æ Carbon - Carbon æ—¶é—´å¤„ç†åº“çš„ Go è¯­è¨€å®ç° strftime - æ—¶é—´æ ¼å¼åŒ– dateparse - è§£æä»»æ„æœªçŸ¥æ ¼å¼çš„æ—¶é—´å­—ç¬¦ä¸² ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:28","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.29 é…ç½® GoDotEnv - .env é…ç½®æ–‡ä»¶è§£æ go-yaml/yaml ghodss/yaml toml - TOML è§£æ\u0026ç¼–ç åŒ… INI - INI é…ç½®æ–‡ä»¶è§£æ Viper - æ”¯æŒ JSON, TOML, YAML, HCL, Java ç­‰é…ç½®æ–‡ä»¶ fig Multiconfig configor envconfig confd - é…ç½®ç®¡ç†å·¥å…· HCL - configuration language env - è§£æ ENV ç¯å¢ƒå˜é‡åˆ°ç»“æ„ä½“ä¸­ configor koanf go-toml - TOML butler - Adobe å¼€æºçš„é…ç½®ç®¡ç†ç³»ç»Ÿ envsubst - ç¯å¢ƒå˜é‡æ›¿æ¢ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:29","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.30 çˆ¬è™« Crawlab - åŸºäºGolangçš„åˆ†å¸ƒå¼çˆ¬è™«ç®¡ç†å¹³å°ï¼Œæ”¯æŒPythonã€NodeJSã€Goã€Javaã€PHPç­‰å¤šç§ç¼–ç¨‹è¯­è¨€ä»¥åŠå¤šç§çˆ¬è™«æ¡†æ¶ Colly - ç½‘ç»œçˆ¬è™«æ¡†æ¶ Pholcus - æ”¯æŒåˆ†å¸ƒå¼çš„é«˜å¹¶å‘ã€é‡é‡çº§çˆ¬è™«è½¯ä»¶ go_spider Muffet - ç½‘ç«™é“¾æ¥æ£€æŸ¥å™¨ Creeper Geziyor - æ”¯æŒ JS æ¸²æŸ“çš„å¿«é€Ÿçˆ¬è™«æ¡†æ¶ Apollo - ä¸€ä¸ªçˆ¬è™«å·¥å…· ferret - å£°æ˜å¼ Web æ•°æ®æŠ“å– gocrawl Antch katana - çˆ¬è™«\u0026èœ˜è››æ¡†æ¶ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:30","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.31 æ•°æ®åº“ 10.31.1 SQLè§£æ pingcap/parser - å…¼å®¹ MySQL çš„ SQL è§£æ xsqlparser - SQL è§£æ sqlparser - SQL è§£æ vitess-sqlparser - SQL è§£æ dbml-go - DBML è§£æ 10.31.2 åˆ†å¸ƒå¼äº‹åŠ¡ go-saga - Saga åˆ†å¸ƒå¼äº‹åŠ¡å®ç° DTM - è·¨è¯­è¨€çš„åˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†æœåŠ¡ï¼Œæ”¯æŒTCCã€Sagaã€XAç­‰ 10.31.3 æ•°æ®åº“ç›¸å…³ usql - å‡ ä¹æ”¯æŒå…¨éƒ¨ SQL ä¸ NoSQL æ•°æ®åº“çš„å‘½ä»¤è¡Œå·¥å…· GORM - GORM V2 GORM V1 gorm2sql - æ ¹æ® Model Struct ç”Ÿæˆå»ºè¡¨è¯­å¥ gorm-sharding - åŸºäº Conn å±‚åš SQL æ‹¦æˆªã€AST è§£æã€åˆ†è¡¨è·¯ç”±ã€è‡ªå¢ä¸»é”®å¡«å……ï¼Œå¯¹ä½¿ç”¨è€…é€æ˜ Xorm XormPlus - Xorm çš„å®šåˆ¶å¢å¼ºç‰ˆæœ¬ GoRose sqlx - database/sql æ‰©å±•åŒ… dbq - æ•°æ®åº“æ“ä½œ gendry - æ»´æ»´å¼€æºçš„SQL Builder ozzo-dbx Squirrel - Fluent SQL Builder qb - the database toolkit for go mgo globalsign/mgo - The MongoDB driver for Go mgoä½¿ç”¨æŒ‡å— kingshard - MySQL Proxy SOAR - å¯¹SQLè¿›è¡Œä¼˜åŒ–å’Œæ”¹å†™çš„è‡ªåŠ¨åŒ–å·¥å…· SQLE - SQL å®¡æ ¸å·¥å…· Vitess - ç”¨äºéƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†å¤§å‹MySQLå®ä¾‹é›†ç¾¤çš„æ•°æ®åº“è§£å†³æ–¹æ¡ˆ gh-ost - GitHub å¼€æºçš„åœ¨çº¿æ›´æ”¹ MySQL è¡¨ç»“æ„çš„å·¥å…· SQLer - write APIs using direct SQL queries with no hassle, letâ€™s rethink about SQL gocraft/dbr Gaea - å°ç±³å¼€æºçš„åŸºäº MySQL åè®®çš„æ•°æ®åº“ä¸­é—´ä»¶ OctoSQL - æ”¯æŒå¤šæ•°æ®åº“çš„ SQL æŸ¥è¯¢å·¥å…· goose - æ•°æ®åº“è¿ç§»å·¥å…· migrate - æ•°æ®åº“è¿ç§»å·¥å…· dbmate - æ•°æ®åº“è¿ç§»å·¥å…· ent - An Entity Framework For Go godb - a Go query builder and struct mapper go-nulltype go-mysql - MySQL å·¥å…·é›† SQLittle - çº¯è¯»å– SQLite æ–‡ä»¶ Bifrost - MySQL åŒæ­¥åˆ° Redisã€ClickHouse ç­‰æœåŠ¡çš„å¼‚æ„ä¸­é—´ä»¶ elasticsql - è½¬æ¢ SQL æˆ Elasticsearch DSL POP - åŸºäº sqlx å°è£…çš„æ•°æ®åº“ ORM å·¥å…· REL - Modern Database Access Layer for Go RDB - Redis RDB æ–‡ä»¶è§£æå’Œç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒè½¬ JSONã€è½¬ AOFã€å¯»æ‰¾ Big Keyã€ç”Ÿæˆ RDB æ–‡ä»¶åŠç»˜åˆ¶å†…å­˜ç«ç„°å›¾ç­‰åŠŸèƒ½ Bytebase - åŸºäºç½‘ç»œã€é›¶é…ç½®ã€æ— ä¾èµ–çš„æ•°æ®åº“ Schema å˜æ›´å’Œç‰ˆæœ¬æ§åˆ¶ç®¡ç†å·¥å…· Bun - SQL ä¼˜å…ˆçš„ ORMï¼Œå†™ SQL çš„æ–¹å¼å†™ Go ä»£ç ï¼Œæ”¯æŒ PostgreSQLã€MySQLã€MSSQLã€SQLite 10.31.4 æ•°æ®åº“å®¢æˆ·ç«¯ Go-MySQL-Driver - MySQL é©±åŠ¨ go-mssqldb - MSSQL é©±åŠ¨ pq - PostgreSQL é©±åŠ¨ mongo-go-driver - MongoDB å®˜æ–¹å‡ºå“çš„ Go è¯­è¨€é©±åŠ¨ qmgo - MongoDB å®¢æˆ·ç«¯ clickhouse-go - ClickHouse å®˜æ–¹ Go è¯­è¨€å®¢æˆ·ç«¯ go-clickhouse - ClickHouse å®¢æˆ·ç«¯ go-sqlite3 - SQLite3 é©±åŠ¨ gohbase - HBase å®¢æˆ·ç«¯ redigo - Redis å®¢æˆ·ç«¯ go-redis - Redis å®¢æˆ·ç«¯ rueidis - Redis å®¢æˆ·ç«¯ redsync - åŸºäº Redis çš„åˆ†å¸ƒå¼é” redislock - åŸºäº Redis çš„åˆ†å¸ƒå¼é” Tiny RDM - Redis æ¡Œé¢å®¢æˆ·ç«¯ 10.31.5 æ•°æ®åº“å¼•æ“ etcd - KV åˆ†å¸ƒå¼å­˜å‚¨ InfluxDB - æ—¶é—´åºåˆ—æ•°æ®åº“ Prometheus - æœåŠ¡ç›‘æ§ç³»ç»Ÿ \u0026 æ—¶é—´åºåˆ—æ•°æ®åº“ tstorage - æ—¶é—´åºåˆ—æ•°æ®åº“ Thanos - æ”¯æŒ Prometheus ç®€åŒ–éƒ¨ç½²ã€é«˜å¯ç”¨ã€åˆ†å¸ƒå¼å­˜å‚¨ CockroachDB - åˆ†å¸ƒå¼ SQL æ•°æ®åº“ Cayley - å›¾æ•°æ®åº“ RadonDB - åŸºäº MySQL ç ”å‘çš„æ–°ä¸€ä»£åˆ†å¸ƒå¼å…³ç³»å‹æ•°æ®åº“ TiDB - åˆ†å¸ƒå¼å…³ç³»å‹æ•°æ®åº“ï¼Œå…¼å®¹ MySQL åè®® AresDB - Uber å¼€æºçš„ GPU é©±åŠ¨çš„å®æ—¶åˆ†æå­˜å‚¨\u0026æŸ¥è¯¢å¼•æ“ leveldb - LevelDB çš„ Go å®ç° Dgraph - åˆ†å¸ƒå¼å›¾æ•°æ®åº“ rqlite - åŸºäº SQLite çš„è½»é‡çº§åˆ†å¸ƒå¼å…³ç³»æ•°æ®åº“ gaeadb BadgerDB - KV æ•°æ®åº“ï¼Œæ”¯æŒ ACID äº‹åŠ¡ LBADD - ç”¨ Go å®ç°çš„åˆ†å¸ƒå¼ SQL æ•°æ®åº“ go-memdb - å»ºç«‹åœ¨ä¸å¯å˜ Radix æ ‘ä¸Šçš„å†…å­˜æ•°æ®åº“ VectorSQL - åº”ç”¨äº IoT å’Œå¤§æ•°æ®çš„ DBMS æ•°æ®åº“ï¼Œç±»ä¼¼äº ClickHouse BuntDB - åŸºäºå†…å­˜çš„KVæ•°æ®åº“ï¼Œæ”¯æŒç£ç›˜æŒä¹…åŒ–ã€ACIDäº‹åŠ¡ TinySQL - è¿·ä½ åˆ†å¸ƒå¼å…³ç³»å‹æ•°æ®åº“ Tile38 - GEO æ•°æ®åº“ Redcon - å…¼å®¹ Redis åè®®çš„è‡ªå®šä¹‰ Redis æœåŠ¡ï¼Œé‡‡ç”¨ BuntDB å’Œ Tile38 å®ç°å­˜å‚¨ genji - æ–‡æ¡£å†…åµŒå‹æ•°æ®åº“ Dolt - åƒ Git ä¸€æ ·æ“ä½œæ•°æ®åº“ rosedb - ç®€æ´ã€é«˜æ•ˆçš„ KV æ•°æ®åº“ï¼Œæ”¯æŒå¤šç§æ•°æ®ç»“æ„ LinDB - åˆ†å¸ƒå¼æ—¶åºæ•°æ®åº“ mandodb - ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼Œä½œè€…ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹å®ç°ä¸€ä¸ªå°å‹çš„æ—¶åºæ•°æ®åº“ go-mysql-server - è§£æ MySQL åè®®å¹¶ä¼˜åŒ– SQL çš„æ•°æ®åº“å¼•æ“ Milvus - å‘é‡æ•°æ®åº“ FerretDB - MangoDB æ›¿ä»£å“ LotusDB - å¿«é€Ÿ KV å­˜å‚¨å¼•æ“ï¼Œå…¼å®¹ LSM å’Œ B+ æ ‘ NutsDB - å¯æŒä¹…åŒ–ã€äº‹åŠ¡çš„å†…åµŒ KV æ•°æ®åº“ Olric ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:31","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.32 ç¼“å­˜ GCache bbolt - key/value store BigCache go-cache - KV å†…å­˜ç¼“å­˜ gomemcache - Memcache å®¢æˆ·ç«¯ cache2go ristretto fastcache FreeCache godis - Go è¯­è¨€å®ç°çš„ Redis æœåŠ¡å™¨å’Œåˆ†å¸ƒå¼é›†ç¾¤ groupcache - åˆ†å¸ƒå¼ç¼“å­˜ cachego - æ”¯æŒ Redisã€Bolt ç­‰ç¼“å­˜æ¥å£ diskv - åŸºäºç¡¬ç›˜çš„ KV å­˜å‚¨ Pebble - è¢« CockroachDB ä½¿ç”¨çš„ KV å­˜å‚¨ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:32","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.33 æœç´¢æ¨è wukong - å…¨æ–‡æœç´¢å¼•æ“ go-elasticsearch - å®˜æ–¹ ES å®¢æˆ·ç«¯ elastic - Elasticsearch å®¢æˆ·ç«¯ go-mysql-elasticsearch - Sync MySQL data into elasticsearch gse - Go è¯­è¨€åˆ†è¯ sego - Go ä¸­æ–‡åˆ†è¯ gojieba - â€œç»“å·´\"ä¸­æ–‡åˆ†è¯çš„ Go è¯­è¨€ç‰ˆæœ¬ Riot - å…¨æ–‡æœç´¢å¼•æ“ simplefts - è¶…ç®€å•çš„å…¨æ–‡æœç´¢å¼•æ“å®ç° Blast - å…¨æ–‡æœç´¢(Archived) Fuzzy Search - æ–‡æœ¬æ¨¡ç³Šæœç´¢ gorse - å•èŠ‚ç‚¹è®­ç»ƒå’Œåˆ†å¸ƒå¼é¢„æµ‹æ¨èç³»ç»Ÿå¼•æ“ gofound - å…¨æ–‡æœç´¢å¼•æ“ ZincSearch - å…¨æ–‡æœç´¢å¼•æ“ Bluge - æ–‡æœ¬åˆ†è¯ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:33","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.34 è¡¨å• validator ozzo-validation - ä½¿ç”¨ä»£ç æŒ‡å®šè§„åˆ™ï¼Œè€ŒéTag go-tagexpr - å­—èŠ‚è·³åŠ¨å¼€æºçš„ç»“æ„ä½“æ ‡ç­¾è¡¨è¾¾å¼è§£é‡Šå™¨ govalidator ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:34","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.35 Auth Casbin - æƒé™æ§åˆ¶ç®¡ç† pam-ussh - Uberâ€™s SSH certificate pam module jwt-go - JWT for Go kataras/jwt - JWT è½»é‡çº§å®ç° cristalhq/jwt sessions - åç«¯ SESSION æœåŠ¡ securecookie - cookie åŠ å¯†/è§£å¯† Goth - Multi-Provider Authentication for Go branca - å·ç§°æ¯” JWT æ›´å®‰å…¨çš„ token è§£å†³æ–¹æ¡ˆ gin-jwt - Gin æ¡†æ¶çš„ JWT ä¸­é—´ä»¶ Authboss - Web Auth ç³»ç»Ÿ ZITADEL - èº«ä»½è®¤è¯ç³»ç»Ÿï¼Œæ”¯æŒå„ç§è®¤è¯æ¨¡å¼ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:35","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.36 åŠ å¯†/è§£å¯† 2fa - Two-factor authentication on the command line age - æ–‡ä»¶åŠ å¯†å·¥å…·ï¼ˆåº“ï¼‰ CIRCL - Cloudflare Interoperable, Reusable Cryptographic Library ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:36","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.37 è§†é¢‘ goav - FFmpeg è§†é¢‘å¤„ç† lal - ç›´æ’­æµåª’ä½“ç½‘ç»œä¼ è¾“æœåŠ¡å™¨ bililive-go - ç›´æ’­å½•åˆ¶å·¥å…· screego - é€šè¿‡æµè§ˆå™¨å…±äº«å¼€å‘è€…å±å¹• livego - ç›´æ’­æœåŠ¡å™¨ Monibuca - æµåª’ä½“æœåŠ¡å™¨å¼€å‘æ¡†æ¶ olive - æ”¯æŒè™ç‰™ç­‰å¹³å°çš„ç›´æ’­å½•åˆ¶ lux - å„å¤§è§†é¢‘ç½‘ç«™çš„è§†é¢‘ä¸‹è½½å·¥å…· ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:37","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.38 å›¾å½¢å¤„ç† barcode - æ¡å½¢ç /äºŒç»´ç ç”Ÿæˆå™¨ picfit - å›¾ç‰‡æ“ä½œã€è£å‰ªã€ç®¡ç†æœåŠ¡å™¨ gmfs - å›¾ç‰‡æ“ä½œã€è£å‰ªã€ç®¡ç†æœåŠ¡å™¨ besticon - favicon æœåŠ¡ Caire - å›¾ç‰‡æ“ä½œåº“ Imaging - å›¾ç‰‡æ“ä½œåº“ gocaptcha - éªŒè¯ç ç”Ÿæˆ base64Captcha - éªŒè¯ç  go-is-svg - æ ¡éªŒæ˜¯å¦ä¸º SVG å›¾ç‰‡ identicon - æ ¹æ®ç”¨æˆ·çš„ IP ã€é‚®ç®±åç­‰ä»»æ„æ•°æ®ä¸ºç”¨æˆ·äº§ç”Ÿæ¼‚äº®çš„éšæœºå¤´åƒ prominentcolor - è¯†åˆ«å›¾ç‰‡çš„ä¸»è¦é¢œè‰² dchest/captcha - ç”Ÿæˆå’ŒéªŒè¯å›¾ç‰‡æˆ–éŸ³é¢‘éªŒè¯ç  bimg - å›¾ç‰‡å¤„ç† imaginary - å›¾ç‰‡å¤„ç†æœåŠ¡ primitive - ç”¨åŸå§‹å‡ ä½•å›¾å½¢ç»˜åˆ¶å›¾å½¢ orly - ç”Ÿæˆä½ è‡ªå·±çš„Oâ€™RLYåŠ¨ç‰©ä¹¦å°é¢ smartcrop - æ™ºèƒ½è£å‰ªå›¾ç‰‡ gift - å›¾ç‰‡æ»¤é•œ Germanium - ç»™ä»£ç ç”Ÿæˆå›¾ç‰‡ Go Graphics - 2D å›¾ç‰‡æ¸²æŸ“ canvas - çŸ¢é‡å›¾ç»˜åˆ¶ formulae - æ•°å­¦å…¬å¼è§£æã€è®¡ç®—ã€å›¾è¡¨ç»˜åˆ¶ imagor - å›¾åƒå¤„ç†æœåŠ¡å™¨ Triangula - ç»™å›¾ç‰‡å¢åŠ ä¸‰è§’å½¢çº¹æ ·é£æ ¼çš„æ»¤é•œ D2 - ä¸€ç§å°†æ–‡æœ¬è½¬æ¢æˆå›¾å½¢çš„å›¾è¡¨è„šæœ¬è¯­è¨€ ImGo - ç®€æ´ã€é“¾å¼è°ƒç”¨çš„å›¾åƒå¤„ç†åº“ Invoice - å‘ç¥¨ç”Ÿæˆå·¥å…·ï¼Œå¯é€šè¿‡å‚æ•°å’Œé…ç½®æ–‡ä»¶è¿›è¡Œåˆ›å»ºå’Œç®¡ç†å„ç§ç±»å‹çš„å‘ç¥¨ 10.38.1 å›¾ç‰‡è¯†åˆ« go-face - é¢éƒ¨è¯†åˆ« ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:38","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.39 å›¾è¡¨ go-echarts - Echarts å›¾è¡¨åº“ gonum/plot - å›¾å½¢ç»˜åˆ¶ pinhole - 3D çº¿æ¡†å›¾ç»˜åˆ¶ globe - åœ°çƒçº¿æ¡†å›¾ç»˜åˆ¶ ink - Go ä¸­çš„ 2D å›¾å½¢æ¡†æ¶ go-plantuml - åŸºäº Go æºç ç”Ÿæˆ plantuml å›¾ go-diagrams - é€šè¿‡ä»£ç ç”Ÿæˆå›¾è¡¨ GoCity - 3D å±•ç¤ºåŸå¸‚ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:39","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.40 æ„å»ºç¼–è¯‘ Mage - ç±»ä¼¼äº Makefile çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ„å»ºå’Œè¿è¡Œ Go é¡¹ç›® GoReleaser - Go å¤šå¹³å°äºŒè¿›åˆ¶æ–‡ä»¶æ‰“åŒ…ã€å¹¶æ”¯æŒå‘å¸ƒåˆ° Homebrew çš„å·¥å…· goxc - è·¨å¹³å°ç¼–è¯‘å·¥å…·ï¼ˆå›  1.5 ç‰ˆæœ¬å¼€å§‹å·²è‡ªå¸¦äº¤å‰ç¼–è¯‘ï¼Œæ•…å·²ä¸å†ç»´æŠ¤ï¼‰ Task - ç±»ä¼¼äº Make çš„æ„å»ºå·¥å…· codegangsta/gin - çƒ­ç¼–è¯‘å·¥å…· Air - çƒ­ç¼–è¯‘å·¥å…· gowatch - çƒ­ç¼–è¯‘å·¥å…· Fresh - çƒ­ç¼–è¯‘å·¥å…· dh-make-golang - è‡ªåŠ¨æ„å»º Debian åŒ… gobinaries - ä¸ç”¨å®‰è£…Goå°±èƒ½ç¼–è¯‘å®‰è£…Goç¼–å†™çš„ç¨‹åº nFPM - debã€rpmã€apk ç­‰æ‰“åŒ…å·¥å…· Gox - Go è·¨ç«¯ç¼–è¯‘å·¥å…· garble - æ··æ·†ä»£ç  gobfuscate - æ··æ·†ä»£ç  go-appimage - Go è¯­è¨€å®ç° AppImage æ‰“åŒ…å·¥å…· 10.40.1 é™æ€èµ„æºå†…åµŒ pkger - å°†é™æ€æ–‡ä»¶æ‰“åŒ…æˆ Go äºŒè¿›åˆ¶æ–‡ä»¶ mewn - é™æ€æ–‡ä»¶åµŒå…¥æ‰“åŒ…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ statik - é™æ€æ–‡ä»¶åµŒå…¥ go.rice go-bindata - å°†é™æ€æ–‡ä»¶è½¬æ¢æˆ Go ä»£ç æ–‡ä»¶ vfsgen - å°†é™æ€æ–‡ä»¶æ‰“åŒ…æˆ http.FileSystem ç±»å‹è¿›è¡Œè®¿é—® packr ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:40","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.41 ä¼˜é›…å‡çº§ tableflip - Web æœåŠ¡å‡çº§ selfupdate - äºŒè¿›åˆ¶æ–‡ä»¶è‡ªåŠ¨å‡çº§ overseer go-github-selfupdate - ä¾æ‰˜ GitHub è‡ªåŠ¨å‡çº§ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:41","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.42 ä»£ç åˆ†æ reviewdog - Code Review æœºå™¨äºº revive - ä»£ç æ£€æŸ¥åˆ†æ GolangCI-Lint - ä»£ç è´¨é‡æ£€æŸ¥åˆ†æå·¥å…· errcheck - æ£€æµ‹æœªå¤„ç†çš„é”™è¯¯(errors) Staticcheck - ä¸€ç³»åˆ—çš„ Go ä»£ç é™æ€åˆ†æå·¥å…· Golint - Google å®˜æ–¹å‡ºå“çš„ä»£ç è´¨é‡æ£€æµ‹å·¥å…· GoReporter go-critic gocloc - åˆ†è¯­è¨€ä»£ç è¡Œæ•°ç»Ÿè®¡ coca - ä»£ç ç»Ÿè®¡åˆ†æ Go Report Card - Go é¡¹ç›®è´¨é‡åˆ†ææŠ¥å‘Šå·¥å…· ddsv-go - æ­»é”æ£€æµ‹å·¥å…· golang/perf - å®˜æ–¹æ€§èƒ½é‡åŒ–åˆ†æå·¥å…· GoPlantUML - ä¸º Go é¡¹ç›®ç”Ÿæˆ PlantUML ç±»å›¾ gosize - åˆ†æGoäºŒè¿›åˆ¶æ–‡ä»¶å¤§å° shotizam - åˆ†æ Go äºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°å¹¶è¾“å‡ºåˆ° SQLite3 goconst - æŸ¥æ‰¾å¯ä»¥è¢«å¸¸é‡æ›¿æ¢çš„é‡å¤å­—ç¬¦ä¸² sploit - å¸®åŠ©äºŒè¿›åˆ¶åˆ†æå’Œå¼€å‘çš„åº“ perf - Perf Utilities for Go fgprof - Go æ€§èƒ½åˆ†æå·¥å…· conprof - åç¨‹åˆ†æ statsview - å®æ—¶ Go è¿è¡Œæ—¶ç»Ÿè®¡æ•°æ®å¯è§†åŒ–åˆ†æå™¨ codesearch - ä»£ç æœç´¢å·¥å…· Pyroscope - å¯è§†åŒ–ç¨‹åºæ€§èƒ½ç›‘æ§å·¥å…·ï¼Œæ”¯æŒå¤šç§è¯­è¨€ gosec - ä»£ç å®‰å…¨æ€§æ£€æŸ¥å·¥å…· gokart - ä»£ç é™æ€åˆ†æå·¥å…· gofumpt - gofmt å¢å¼ºç‰ˆä»£ç æ ¼å¼åŒ–å·¥å…· NoVerify - PHP ä»£ç åˆ†æå·¥å…· fieldalignment - ç»“æ„ä½“å­—æ®µå†…å­˜å¯¹é½åˆ†æå’Œè‡ªåŠ¨ä¿®å¤å·¥å…· Bearer - ä»£ç å®‰å…¨æ‰«æå·¥å…· ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:42","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.43 è°ƒè¯• go-spew - å˜é‡æ‰“å°å·¥å…· Delve - Debug å·¥å…· gdlv - Delve ç•Œé¢ç‰ˆæœ¬ Weaver - è·Ÿè¸ª Go ç¨‹åºæ‰§è¡Œé“¾è·¯ repr - å˜é‡æ‰“å°å·¥å…· pp - å½©è‰²å˜é‡æ‰“å°å·¥å…· ffmt - å˜é‡æ‰“å°å·¥å…· gops - è°·æ­Œå®˜æ–¹å‡ºå“çš„ Go ç¨‹åºç›‘æ§è°ƒè¯•å·¥å…· pprof go-callvis - å¯è§†åŒ–Goç¨‹åºçš„è°ƒç”¨å›¾ q - è‡ªåŠ¨æ‰“å°å˜é‡ç±»å‹å¹¶ä¸”æ ¼å¼åŒ–è¾“å‡º Litter RDebug - æ»´æ»´å¼€æºçš„ä¸€æ¬¾ç”¨äº RD ç ”å‘ã€è‡ªæµ‹ã€è°ƒè¯•çš„å®ç”¨å·¥å…· debugcharts - Go å†…å­˜å ç”¨å¯è§†åŒ–è°ƒè¯•å·¥å…· gcvis - å®æ—¶å¯è§†åŒ– gctrace pkg/profile statsviz - åœ¨æµè§ˆå™¨ä¸­å®æ—¶æŸ¥çœ‹ Go åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯ï¼ˆGCï¼ŒMemStats ç­‰ï¼‰ autopprof - è‡ªåŠ¨åˆ†æ pprof stack - æ•è·ã€æ“ä½œã€æ ¼å¼åŒ–è°ƒç”¨æ ˆä¿¡æ¯ pretty - æ‰“å°å˜é‡ go-deadlock - å¯¹ (RW)Mutex è¿›è¡Œæ³¨å…¥ï¼Œå¹¶æä¾›æ­»é”æ£€æµ‹ mmcloughlin/profile gcnotifier - å½“å‘ç”Ÿ GC æ—¶é€šçŸ¥ grmon - å‘½ä»¤è¡Œç›‘æ§æ˜¾ç¤º goroutines valast - æ‰“å°è¾“å‡ºå˜é‡çš„ go/ast ç»“æ„ï¼Œç±»ä¼¼äº PHP çš„ var_export å‡½æ•° lensm - Go æ±‡ç¼–ä¸æºç å¯¹ç…§æŸ¥çœ‹å·¥å…· holmes - åŸºäºè§„åˆ™çš„è‡ªåŠ¨ Go Profile Dumper ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:43","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.44 æµ‹è¯• GoConvey - å«Webç•Œé¢çš„å•å…ƒæµ‹è¯•æ¡†æ¶ GoMock - è°·æ­Œå‡ºå“çš„Mockæµ‹è¯•æ¡†æ¶ GoStub Monkey - (Archived) Monkey patching in Go gomonkey - çŒ´å­è¡¥ä¸ï¼Œå¯¹å‡½æ•°ã€å˜é‡ç­‰è¿›è¡Œæ‰“æ¡©ï¼Œæ–¹ä¾¿å•å…ƒæµ‹è¯•ï¼ŒFork è‡ª Monkey SuperMonkey - è®©ç§æœ‰æ–¹æ³•å¯æµ‹ mockery - è‡ªåŠ¨ä¸ºæ¥å£ç”Ÿæˆ mock ä»£ç  Ginkgo - BBD æµ‹è¯•æ¡†æ¶ fperf - å‹æµ‹å·¥å…· gocheck Testify gotests - æ ¹æ®æºç è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æ–‡ä»¶ TestSQL - æ ¹æ® SQL åˆ›å»ºè¯­å¥ç”Ÿæˆæµ‹è¯•æ•°æ® httpmock - HTTP Mock Goblin - BDD æµ‹è¯•æ¡†æ¶ go-faker/faker - Struct Data Fake Generator gofakeit - éšæœºæ•°æ®ç”Ÿæˆå™¨ dmgk/faker go-tprof - åŒ…æµ‹è¯•æŠ¥å‘Šç”Ÿæˆå·¥å…· go-fuzz - randomized testing for Go gofight - Testing API Handler sqlmock - SQL æµ‹è¯• sqlbench - SQL silk - åŸºäº Markdown çš„æ¥å£æµ‹è¯• gock - HTTP mock æµ‹è¯• godog - BDD æµ‹è¯•æ¡†æ¶ Cucumber çš„ Go ç‰ˆæœ¬ endly - E2Eï¼ˆç«¯åˆ°ç«¯ï¼‰æµ‹è¯• is - è¿·ä½ æµ‹è¯•æ¡†æ¶ Terratest - åŸºç¡€è®¾æ–½æµ‹è¯•ï¼Œæ¯”å¦‚ Docker agouti - Web é©±åŠ¨çš„éªŒæ”¶æµ‹è¯•æ¡†æ¶ httpexpect - ç«¯åˆ°ç«¯ HTTP \u0026 REST æµ‹è¯•æ¡†æ¶ gocov - æµ‹è¯•è¦†ç›–ç‡ miniredis - Redis æ•°æ®æµ‹è¯• htmltest - HTML æµ‹è¯• gnomock - æ— éœ€ mock çš„ Go ä»£ç æµ‹è¯•æ¡†æ¶ gunit - xUnit é£æ ¼æµ‹è¯•æ¡†æ¶ quicktest k6 - è´Ÿè½½æµ‹è¯•å·¥å…· go-cover-treemap - å°†è¦†ç›–ç‡æµ‹è¯•ç»“æœè½¬æ¢æˆ TreeMap å›¾ ZTF - ç¦…é“å¼€æºçš„è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ Moq - ä¸ºæ¥å£ç”Ÿæˆ Mock ä»£ç  ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:44","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.45 é”™è¯¯å¤„ç† errors errorx errwrap - Go tool to wrap and fix errors with the new %w verb directive erris - Linter for errors.Is and errors.As eris - æ—¨åœ¨é€šè¿‡é”™è¯¯åŒ…è£…ï¼Œå †æ ˆè·Ÿè¸ªå’Œè¾“å‡ºæ ¼å¼ä¸ºä½ æä¾›å¯¹é”™è¯¯å¤„ç†çš„æ›´å¤šæ§åˆ¶ errlog - ä½¿ç”¨é™æ€å’Œå †æ ˆè·Ÿè¸ªåˆ†ææ¥å¿«é€Ÿç¡®å®šå“ªä¸ªå‡½æ•°è°ƒç”¨å¯¼è‡´çš„é”™è¯¯ juju/errors go-fault - GitHub å®˜æ–¹å‡ºå“ï¼ŒåŸºäºæ ‡å‡†åº“ http ä¸­é—´ä»¶çš„æ•…éšœæ³¨å…¥åº“ merry - æ”¯æŒå †æ ˆã€çŠ¶æ€ç çš„é”™è¯¯å¤„ç† cockroachdb/errors - åŠŸèƒ½å¼ºå¤§ã€å¯æ›¿ä»£ errors å’Œ github.com/pkg/errors çš„é”™è¯¯å¤„ç†åŒ… go-multierror - æ”¯æŒé”™è¯¯åˆ—è¡¨ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:45","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.46 å®‰å…¨ Kunpeng - å¼€æºPOCæ£€æµ‹æ¡†æ¶ nmap - å®‰å…¨å®¡è®¡å·¥å…· nmap å¼€å‘åŒ… Hetty - ç”¨äºå®‰å…¨ç ”ç©¶çš„ HTTP å·¥å…·åŒ…ï¼Œå…·æœ‰ Web æ¥å£å’Œä»£ç†æ—¥å¿—æŸ¥çœ‹å™¨çš„æ‹¦æˆª HTTP ä»£ç† Fibratus - Windows å†…æ ¸æ¼æ´åˆ©ç”¨å’Œè·Ÿè¸ªå·¥å…· Secure - HTTP å®‰å…¨ä¸­é—´ä»¶ nuclei - åŸºäºYAMLè¯­æ³•æ¨¡æ¿çš„å®šåˆ¶åŒ–å¿«é€Ÿæ¼æ´æ‰«æå™¨ Gitleaks - ç”¨äºåœ¨ Git å­˜å‚¨åº“ä¸­æŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯å’Œå¯†é’¥çš„å¼€æºå·¥å…· ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:46","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.47 ç³»ç»Ÿä¿¡æ¯ go-hardware - æ”¶é›†äº†ä¸€å †å…³äºç¡¬ä»¶ä¿¡æ¯çš„åŒ… cpuid - CPU ä¿¡æ¯ gopsutil - ps åŠŸèƒ½åŒ… go-sysinfo - ç³»ç»Ÿä¿¡æ¯ go-locale - è·¨å¹³å°è¯­è¨€æ£€æµ‹åº“ go-ps - ç³»ç»Ÿè¿›ç¨‹ä¿¡æ¯ psgo - ps å‘½ä»¤å®ç° ghw - ç¡¬ä»¶ä¿¡æ¯ machineid - è·å–æœºå™¨ID ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:47","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.48 UUID go.uuid - UUID åº“ SEQSVR - Go + MySQL å®ç°çš„åˆ†å¸ƒå¼ ID ç”ŸæˆæœåŠ¡ google/uuid - Google å¼€æºçš„ uuid åŒ… gofrs/uuid snowflake - Twitter snowflake IDs sonyflake - Sony ç‰ˆæœ¬çš„ Twitterâ€™s Snowflake ulid - ULID Go è¯­è¨€å®ç° ksuid - K-Sortable Globally Unique IDs go-nanoid - NanoID å®ç° xid - å…¨å±€å”¯ä¸€ ID ç”Ÿæˆå™¨ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:48","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.49 æ—¥å¿— logr - æ—¥å¿—åŒ…æ ‡å‡†æ¥å£ Logrus - æ—¥å¿—è®°å½•åŒ… zerolog zap - Uber å¼€å‘çš„æ—¥å¿—è®°å½•åŒ… Seelog logkit - ä¸ƒç‰›å¼€æºçš„æ—¥å¿—æ”¶é›†å·¥å…· gogstash - ç±»ä¼¼äº Logstash çš„æ—¥å¿—æ”¶é›†å™¨ lumberjack - æ—¥å¿—æ–‡ä»¶åˆ‡å‰² file-rotatelogs - æ—¥å¿—æ–‡ä»¶åˆ‡å‰² go-syslog - æé€Ÿ Syslog è§£æå™¨ glog ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:49","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.50 ç›‘æ§å‘Šè­¦ OpenFalcon - å°ç±³å¼€æºçš„ç›‘æ§ç³»ç»Ÿ Prometheus - æœåŠ¡ç›‘æ§ç³»ç»Ÿ \u0026 æ—¶é—´åºåˆ—æ•°æ®åº“ Grafana - åˆ†æç›‘è§†å¹³å°, æ”¯æŒ Graphite, Elasticsearch, OpenTSDB, Prometheus, InfluxDB ç­‰æ•°æ®æº grabana - ç”¨ Go ä»£ç å¿«é€Ÿåˆ›å»º grafana dashboards Jaeger - åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿ go-osstat - ç³»ç»ŸæŒ‡æ ‡ç»Ÿè®¡ grafterm - Metrics dashboards on terminal mymon - MySQL è¿è¡Œç›‘æ§ PingMe - æ”¯æŒå¤šæ¶ˆæ¯å¹³å°çš„æœåŠ¡å¯ç”¨æ€§æŠ¥è­¦å‘½ä»¤å·¥å…· supervisord - Go è¯­è¨€å®ç° Supervisor Grafana Tempo - åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿ EaseProbe - æœåŠ¡æ¢æ´»å·¥å…·å¹¶é€šçŸ¥ Uptrace - APM å·¥å…·ï¼Œæ”¯æŒ OpenTelemetry è¿½è¸ªã€æŒ‡æ ‡å’Œæ—¥å¿— Nightingale - æ»´æ»´åŸºäº OpenFalcon å¼€æºçš„ç›‘æ§ç³»ç»Ÿ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:50","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.51 ç»Ÿè®¡åˆ†æ Fathom - Web ç«™ç‚¹ç»Ÿè®¡ Veneur - åˆ†å¸ƒå¼å®æ—¶æ•°æ®å¤„ç†ç®¡é“ gonum - ç§‘å­¦è®¡ç®—ç›¸å…³ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:51","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.52 å®¹å™¨æŠ€æœ¯ moby - Docker docker-ce Rancher - å…¨æ ˆåŒ–ä¼ä¸šçº§å®¹å™¨ç®¡ç†å¹³å° Gorsair docui - TUI Client for Docker Podman - ç®¡ç†å’Œè¿è¡Œä»»ä½•ç¬¦åˆ OCI è§„èŒƒçš„å®¹å™¨å’Œå®¹å™¨é•œåƒ Skopeo - é•œåƒç®¡ç†å·¥å…· Buildah - æ„å»º OCI å®¹å™¨é•œåƒçš„å·¥å…· go-docker - ç”¨ Go å®ç° Docker æ ¸å¿ƒåŠŸèƒ½ Packer - è½»é‡çº§çš„é•œåƒå®šä¹‰å·¥å…· cosign - å®¹å™¨ç­¾åå’ŒéªŒè¯ SlimToolkit - æ£€æŸ¥ã€ç¼©å°å’Œè°ƒè¯•å®¹å™¨ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:52","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.53 é›†ç¾¤ç®¡ç† Nomad - é›†ç¾¤ç®¡ç†å™¨å’Œè°ƒåº¦å™¨ OpenShift Origin - Red Hat å¼€å‘çš„å®¹å™¨åŒ–è½¯ä»¶è§£å†³æ–¹æ¡ˆ 10.53.1 Kubernetes kubernetes - å®¹å™¨è°ƒåº¦ç®¡ç†å¹³å° k0s - æœ€å°ä½“ç§¯çš„ k8s å‘è¡Œç‰ˆ sealos - ä¸€æ¡å‘½ä»¤éƒ¨ç½² Kubernetes é«˜å¯ç”¨é›†ç¾¤ KubeEye - é€šè¿‡é…ç½®è§„åˆ™å‘ç° Kubernetes ä¸Šçš„å„ç§é—®é¢˜ endpoints-operator - K8Så†…éƒ¨æœåŠ¡è®¿é—®å¤–éƒ¨æœåŠ¡çš„å…·å¤‡æ¢æ´»åŠŸèƒ½çš„4å±‚LB ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:53","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.54 æœºå™¨å­¦ä¹  goml - æœºå™¨å­¦ä¹ åº“ GoLearn - ä¸€ä¸ª â€œå¼€ç®±å³ç”¨â€ çš„æœºå™¨å­¦ä¹ åº“ glow - æ˜“ç”¨çš„åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿ Gobot - æœºå™¨äººå’Œç‰©ç†è®¡ç®—è¯­è¨€åº“ Olivia - ç¥ç»ç½‘ç»œ Pico - åŸºäºåƒç´ å¼ºåº¦æ¯”è¾ƒçš„ç‰©ä½“æ£€æµ‹çº¸å¼ çš„çº¯ Go è„¸éƒ¨æ£€æµ‹åº“ tfgo - Tensorflow in Go Prophecis - å¾®ä¼—é“¶è¡Œè‡ªç ”çš„ä¸€ç«™å¼äº‘åŸç”Ÿæœºå™¨å­¦ä¹ å¹³å° AID - æœºå™¨å­¦ä¹ opså¹³å°ï¼Œå‘ç°ã€éƒ¨ç½²ã€ä¼˜åŒ– SQLFlow - SQLå¼•æ“+AIå¼•æ“ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:54","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.55 äººå·¥æ™ºèƒ½ go-openai - OpenAI API Go å®¢æˆ·ç«¯ SDK LocalAI - ä½æˆæœ¬çš„ç¡¬ä»¶ä¸Šè¿è¡Œæ¨¡å‹è®¡ç®—çš„æœ¬åœ°è®¡ç®—æ¡†æ¶ï¼Œæ”¯æŒå¤šç§æ¨¡å‹ï¼Œæä¾›å…¼å®¹ OpenAI æ¥å£åè®®çš„ REST API ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:55","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.56 ç®—æ³• GoDS - Go å®ç°äº†å¤šç§æ•°æ®ç»“æ„ Dragonboat - å¤šç»„ Raft å…±è¯†ç®—æ³•åº“ eliben/raft - Raft ç®—æ³• hashicorp/raft - Raft ç®—æ³• Graft - Raft ç®—æ³• golang-lru - LRU ç®—æ³•å®ç° tinylru finn - Fast Raft framework using the Redis protocol for Go xorfilter priyankchheda/algorithms - å„ç§ç®—æ³•çš„ Go è¯­è¨€å®ç° meow - Meow hash basalt - é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼çš„ä¸“é—¨ç©ºé—´ä¼˜åŒ–çš„ Bitmap æœåŠ¡, æœç» Bloomfilter å’Œ CuckooFilter çš„è¯¯åˆ¤ go-blurhash - BlurHashï¼Œæ˜¯æ¨¡ç³Šå›¾ç‰‡çš„ä¸€ç§å“ˆå¸Œç®—æ³• xxhash - xxHash å“ˆå¸Œç®—æ³•å®ç° go-multihash - å„ç§ Hash ç®—æ³•å®ç° memberlist - åŸºäº gossip åè®®å®ç°çš„ç®¡ç†é›†ç¾¤æˆå‘˜å’Œæˆå‘˜å¤±è´¥æ£€æµ‹çš„å¼€å‘åŒ… backoff - æŒ‡æ•°é€€é¿ç®—æ³•(Exponential Backoff) FSM - æœ‰é™çŠ¶æ€æœº ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:56","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.57 æ•°æ®ç»“æ„ go-datastructures Play-with-Data-Structures - ã€Œç©è½¬æ•°æ®ç»“æ„ã€è¯¾ç¨‹çš„ Go è¯­è¨€å®ç°ç‰ˆæœ¬ HashMap SipHash - SipHash-2-4 Bigslice golang-set - The missing set collection rbang - R!tree å®ç° rtreego - R-tree google/btree - B-Tree tinybtree - B-tree dataframe-go - ç”¨äºæ•°æ®ç»Ÿè®¡å’Œæ“ä½œçš„åŒ… go-set - é›†åˆå·¥å…·åŒ… orderedmap - æœ‰åºå­—å…¸ trie Slim - ç©ºé—´é«˜åˆ©ç”¨ç‡çš„æ•°æ®ç»“æ„ bitset - ä½é›†åˆåŠå…¶æ“ä½œ bloom - Bloom filters roaring - å‹ç¼©ä½å›¾ go-immutable-radix - Radix æ ‘ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:57","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.58 ä¾èµ–æ³¨å…¥ go-autowire - ä½¿ç”¨æ³¨è§£è‡ªåŠ¨ç”Ÿæˆ wire - ä¾èµ–æ³¨å…¥ dig Fx ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:58","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.59 JSON GJSON - JSON è§£é‡Šå™¨ SJSON - JSON ä¿®æ”¹å·¥å…· fastjson - fast JSON parser and validator for Go jsonparser ffjson json-iterator - æ»´æ»´å¼€æºçš„ JSON è§£æå™¨ gojsonq - JSON/YAML/XML/CSV ç­‰æ•°æ®æŸ¥è¯¢ easyjson go-jsonc - å°†å¸¦æ³¨é‡Šçš„ JSON è½¬ä¸ºæ— æ³¨é‡Šçš„ jin - JSON æ“ä½œå·¥å…·åŒ…ï¼ŒåŒæ—¶å…·æœ‰æ ‡å‡†åº“å’Œç±»ä¼¼ tidwall/gjson å’Œ tidwall/sjson çš„åŠŸèƒ½ hujson - æ”¯æŒæ³¨é‡Šçš„ JSON è§£ç  pkg/json - JSON Decoder ColorJSON - ç»ˆç«¯ä¸­æ‰“å°å½©è‰² JSON jid - JSON æ•°æ®è§£æè¯»å–å·¥å…· jsonc - æ”¯æŒæ³¨é‡Šä¸é€—å· sonic - å­—èŠ‚è·³åŠ¨å¼€æºçš„ JSON è§£æå™¨\u0026ä¿®æ”¹å™¨ go-json jsonquery - XPath è¯­æ³•æŸ¥è¯¢ JSON fx - å‘½ä»¤è¡Œ JSON æ˜¾ç¤º ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:59","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.60 ä¾èµ–ç®¡ç† goproxy.io - GOPROXY ä»£ç†æœåŠ¡ goproxy.cn - æ›´é€‚åˆå›½å†…ç”¨æˆ·çš„ä»£ç†æœåŠ¡ Gopm - Go åŒ…ç®¡ç†å·¥å…· govendor - Vendor åŒ…ç®¡ç†å·¥å…· gom - åŒ…ç‰ˆæœ¬ç®¡ç†å·¥å…· rvflash/goup - æ£€æŸ¥åŒ…ç‰ˆæœ¬æ˜¯å¦æœ‰æ›´æ–° owenthereal/goup - Go å¤šç‰ˆæœ¬ç®¡ç† Athens - GOPROXY ä»£ç†æœåŠ¡ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:60","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.61 å¾®æœåŠ¡ Istio [ä¸­æ–‡æ–‡æ¡£] - å¤§å‹å¾®æœåŠ¡ç³»ç»Ÿç®¡ç†å·¥å…· goa Micro - å¾®æœåŠ¡å·¥å…· Go Micro - å¾®æœåŠ¡æ¡†æ¶ Go kit - Go å¾®æœåŠ¡å·¥å…·é›† GoKit CLI - Go kit è„šæ‰‹æ¶ gogo go-chassis Kite Kratos - Bç«™å¼€æºçš„å¾®æœåŠ¡æ¡†æ¶ Temporal - å¾®æœåŠ¡ç¼–æ’å¹³å° Serf - æœåŠ¡ç¼–æ’ç®¡ç†å¹³å° Open Policy Agent - é€šç”¨ç­–ç•¥å¼•æ“ï¼ŒCNCF å­µåŒ–é¡¹ç›® gizmo - å¾®æœåŠ¡å·¥å…·é›† MOSN - ç”¨äºè¾¹ç¼˜å’ŒæœåŠ¡ç½‘æ ¼çš„äº‘åŸç”Ÿç½‘ç»œæ•°æ®å¹³é¢ Erda - ä¸ºä¼ä¸šæä¾› DevOpsã€å¾®æœåŠ¡æ²»ç†ã€å¤šäº‘ç®¡ç†çš„ PaaS Service Weaver Consul - æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†ä¸­å¿ƒæœåŠ¡ Traefik Mesh - ç®€å•çš„æœåŠ¡ç½‘æ ¼ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:61","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.62 Serverless OpenFaaS - Serverless Functions Made Simple(åŠŸèƒ½æœåŠ¡åŒ–çš„ FaaS æ¡†æ¶) faasd - è½»é‡çº§ FaaS å¼•æ“ fn - äº‹ä»¶é©±åŠ¨çš„ FaaS riff - åŸºäº Kubernetes çš„ FaaS Nuclio - å®æ—¶äº‹ä»¶ä¸æ•°æ®çš„ Serverless æ¡†æ¶ Flogo - äº‹ä»¶é©±åŠ¨çš„ Serverless æ¡†æ¶ Dapr - å¾®è½¯å¼€æºçš„äº‘å’Œè¾¹ç¼˜è®¡ç®—çš„å¾®æœåŠ¡æ„ä»¶ kubeless Fission - åŸºäº Kubernetes çš„ Serverless pulumi Knative fx IronFunctions schollz/faas - è®©ä»»ä½•åŒ…çš„å‡½æ•°å˜æˆä¸€ä¸ª HTTP æ¥å£ Vanus - æ— æœåŠ¡äº‹ä»¶æµå¤„ç†ç³»ç»Ÿ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:62","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.63 devops act - æœ¬åœ°è¿è¡Œ GitHub Actions ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:63","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.64 æŒç»­é›†æˆ/éƒ¨ç½² CDS - æŒç»­é›†æˆæœåŠ¡ gopub CodePub syncd - ä»£ç éƒ¨ç½²å·¥å…· Drone - åŸºäº Docker çš„æŒç»­å‘å¸ƒå¹³å° Cyclone - æŒç»­é›†æˆ\u0026å‘å¸ƒå¹³å° tbls - ç”¨äºè®°å½•æ•°æ®åº“æ–‡æ¡£çš„ CI å‹å¥½å·¥å…· Woodpecker - Fork è‡ª Drone Dagger - åŸºäºå®¹å™¨çš„ CI/CD å·¥å…· ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:64","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.65 Git gogs - ç±»ä¼¼äº GitLab çš„ Git æœåŠ¡å™¨ Gitea - ç”± gogs åˆ†å‰å‡ºçš„ Git æœåŠ¡å™¨ go-git - Go å®ç°çš„ Git æ“ä½œ gitin - commit/branch/status explorer for git hub - GitHub å‘½ä»¤è¡Œå·¥å…· git-o-matic - ä¸€ä¸ªç›‘æ§ Git ä»“åº“å˜åŒ–å’Œè‡ªåŠ¨ pull/push çš„å·¥å…· gitbase - SQL çš„æ–¹å¼æŸ¥è¯¢ Git æ—¥å¿— git-chglog - CHANGELOG ç®¡ç†å·¥å…· chglog - CHANGELOG ç®¡ç†å·¥å…· lazyhub - GitHub çš„ç»ˆç«¯ UI å®¢æˆ·ç«¯ goaction - åœ¨ Go ä¸­ç¼–å†™ GitHub Action bit - Git å‘½ä»¤å¢å¼ºç‰ˆï¼Œæ”¯æŒæ–‡ä»¶å’Œåˆ†æ”¯åç§°è‡ªåŠ¨å®Œæˆã€å‘½ä»¤å’Œæ ‡å¿—å»ºè®® go-github - GitHub API æ“ä½œåº“ askgit - é€šè¿‡ SQL è®¿é—® Git ä»“åº“ä¿¡æ¯ git2graph - æ ¹æ® Git ä»“åº“æäº¤è®°å½•ç”Ÿæˆç»“æ„å›¾ lazygit - Git ç»ˆç«¯ UI gh-dash - GitHub CLIï¼ˆghï¼‰æ¼‚äº®ç»ˆç«¯é¢æ¿ Soft Serve - å‘½ä»¤è¡Œå¼è‡ªæ‰˜ç®¡ Git æœåŠ¡å™¨ Git LFS - å¤„ç†å¤§æ–‡ä»¶çš„ Git æ‰©å±• ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:65","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.66 é™æµå™¨ Tollbooth - Simple middleware to rate-limit HTTP requests ratelimit RateLimit go-rate Circuit - ç†”æ–­å™¨ uber-go/ratelimit Sentinel - é˜¿é‡Œå·´å·´å¼€æºçš„é¢å‘åˆ†å¸ƒå¼æœåŠ¡æ¶æ„çš„æµé‡æ§åˆ¶ç»„ä»¶ Go è¯­è¨€ç‰ˆæœ¬ gohalt - é™æµ gobreaker - ç†”æ–­å™¨ ulule/limiter ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:66","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.67 ç¼–è¯‘å™¨ TinyGo - ä¸€ä¸ªé€‚ç”¨äºå¾®æ§åˆ¶å™¨ã€WebAssembly å’Œå‘½ä»¤è¡Œå·¥å…·çš„ Go ç¼–è¯‘å™¨ minigo - A Go compiler from scratch llir/llvm - LLVM ç¼–è¯‘å™¨ jit-compiler - JIT ç¼–è¯‘å™¨ Go+ - ä¸ƒç‰›äº‘å¼€æºé¢å‘æ•°æ®ç§‘å­¦çš„è¯­è¨€ï¼Œå®Œå…¨å…¼å®¹Goè¯­è¨€ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:67","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.68 è§£é‡Šå™¨ 10.68.1 è¯­è¨€è§£é‡Šå™¨ participle - é€šç”¨çš„è‡ªå®šä¹‰è¯­æ³•è§£æåŒ… GopherLua - VM and compiler for Lua in Go go-lua - A Lua VM in pure Go DCLua - Go Lua Compiler and VM otto - JavaScript è§£é‡Šå™¨ goja - ECMAScript 5.1(+) å®ç° v8go - Execute JavaScript from Go gpython - Python Interpreter on Go Grumpy - è½¬æ¢ Python ä¸º Go ä»£ç ï¼Œè°·æ­Œå¼€æº starlark-go - Starlark in Go avo - x86 æ±‡ç¼–ç¨‹åºæ„å»ºå™¨ wagon - WebAssembly è§£é‡Šå™¨ GopherJS - æŠŠ Go ä»£ç ç¼–è¯‘æˆ JavaScript ä»£ç  Yaegi - Go è¯­è¨€è§£é‡Šå™¨ properties - Java properties scanner for Go jvm.go - JVM gobasic - A BASIC interpreter written in golang golisp - Lisp è§£é‡Šå™¨ dst - Go Decorated Syntax Tree mvdan/sh - Shell è§£æã€æ ¼å¼åŒ–ã€æ¥å£ tdewolff/parse - é€šç”¨è¯æ³•åˆ†æå™¨ Lexerï¼Œå¹¶å†…ç½®æ”¯æŒè§£æ HTML/CSS/JSON/XML/JS/SVG è¯­æ³• Joker - Clojure 10.68.2 PHP z7zmey/php-parser - PHP AST è¯­æ³•è§£æ deuill/go-php - PHP bindings for Go goridge - High-performance PHP-to-Golang IPC bridge RoadRunner - é«˜æ€§èƒ½PHPåº”ç”¨æœåŠ¡å™¨ï¼Œæ”¯æŒè´Ÿè½½å‡è¡¡åŠè¿›ç¨‹ç®¡ç† VKCOM/php-parse - PHP AST è¯­æ³•è§£æ 10.68.3 è‡ªå®šä¹‰è§£é‡Šå™¨ CUE - Configure Unify Execute(Validate and define text-based and dynamic configuration) cel-go - Common Expression Language(CEL çš„ Go å®ç°) Math-Engine - ä½¿ç”¨ Go å®ç°çš„æ•°å­¦è¡¨è¾¾å¼è§£æè®¡ç®—å¼•æ“åº“ï¼Œå­¦ä¹ è¯­æ³•è§£æå¾ˆé€‚ç”¨ Gval - è¡¨è¾¾å¼è®¡ç®— expression-parsing goexp - Recursive descent expression parser in Go goastch - Go AST è¯­æ³•è§£æ tdop swallow Anko Expr - ç¼–è¯‘\u0026æ‰§è¡Œå­—ç¬¦ä¸²ä¸­çš„è¡¨è¾¾å¼ Tengo - ç”¨ Go ç¼–å†™çš„è„šæœ¬è¯­è¨€ V - Go ç¼–å†™çš„è¯­è¨€ kumarUjjawal/bison Monkey govaluate Compiler - å°†è‡ªå®šä¹‰è¯­æ³•ä»£ç ç¼–è¯‘æˆ X86-64 Assembly elvish - äº¤äº’å¼ Shell è¯­è¨€ QLBridge - Go SQL Runtime Engine YQL - SQL WHERE é£æ ¼çš„è§„åˆ™å¼•æ“ Flux - InfluxDB æ•°æ®è¯­è¨€ Spiker - Go ç¼–å†™çš„ç®€å•è§„åˆ™è¡¨è¾¾å¼æ‰§è¡Œå™¨ï¼Œæ”¯æŒè‡ªå®šä¹‰å‡½æ•°å’Œæµç¨‹æ§åˆ¶ï¼Œé€‚ç”¨äºä¸šåŠ¡è§„åˆ™å¤æ‚çš„åœºæ™¯ gocc - è§£æå™¨ç”Ÿæˆå™¨ï¼Œå¯ä»¥å°†æŒ‡å®šçš„æ–‡æ³•è½¬æ¢ä¸º Go è¯­è¨€çš„è§£æå™¨ç¨‹åºä»£ç ï¼Œç”¨äºç¼–è¯‘å’Œè§£æç‰¹å®šç±»å‹çš„æºä»£ç  ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:68","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.69 ä»£ç ç”Ÿæˆ jennifer - Go ä»£ç ç”Ÿæˆ ifacemaker - æ ¹æ®ç»“æ„ä½“æ–¹æ³•ç”Ÿæˆæ¥å£ gg - Go ä»£ç ç”Ÿæˆ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:69","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.70 ç¼–è¾‘å™¨ micro - åŸºäºç»ˆç«¯çš„ç¼–è¾‘å™¨ sourcegraph - ä»£ç æœç´¢\u0026å¯¼èˆª ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:70","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.71 è¿è¡Œå™¨ gore - åœ¨çº¿è¿è¡Œ Go ä»£ç  nodebook - åœ¨çº¿è¿è¡Œå¤šç§è¯­è¨€ go-pry - åƒ Pythonã€Rã€PHP ç­‰åœ¨ç»ˆç«¯äº¤äº’å¼è¾“å…¥ä¸è¿è¡Œ Go ä»£ç  ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:71","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.72 æŸ¥è¯¢è¯­è¨€ graphql - Go å®ç°çš„ GraphQL graphql-go GQLEngine - åŸºäº graphql-go å®ç° RQL - REST èµ„æºæŸ¥è¯¢è¯­è¨€ Thunder - GraphQL æœåŠ¡æ„å»ºæ¡†æ¶ gqlgen - æ„å»º GraphQL æœåŠ¡å™¨çš„åŒ… super-graph - æ— éœ€ç¼–å†™ä»£ç å³å¯åœ¨ Go é¡¹ç›®ä¸­æ„å»ºå¤æ‚çš„ GraphQL API ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:72","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.73 æ¸¸æˆç›¸å…³ Nano - æ¸¸æˆå¼€å‘æ¡†æ¶ Leaf einx CloudRetro - æ¸¸æˆäº‘æœåŠ¡æ¡†æ¶ G3N - Go 3D Game Engine Ebiten - 2D æ¸¸æˆåº“ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:73","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.74 æ¡Œé¢å¼€å‘ 10.74.1 GUI Lorca - ç”¨ Go ç¼–å†™ HTML5 æ¡Œé¢ç¨‹åºï¼Œä¾èµ– Chrome è¿›è¡Œ UI æ¸²æŸ“ï¼Œä½†å´ä¸æŠŠ Chrome æ‰“åŒ…åˆ°åº”ç”¨ä¸­ webview - ç”¨ Go/C/C++ æ„å»ºè·¨å¹³å°çš„æ¡Œé¢è½¯ä»¶ walk - Windows GUI toolkit go-gtk - Go bindings for GTK andlabs/ui - Platform-native GUI library for Go fyne - Material Design é£æ ¼çš„ GUI go-gl - Go bindings for OpenGL (generated via glow) therecipe/qt - åŸºäº Qt çš„è·¨å…¨å¹³å° UI åŒ… giu - åŸºäº Dear ImGui çš„è·¨å¹³å° GUI æ¡†æ¶ go-app - ä¸€ä¸ª WebAssembly æ¡†æ¶ï¼Œç”¨äºä½¿ç”¨ Goï¼ŒHTML å’Œ CSS æ„å»º GUI åº”ç”¨ wails - ä½¿ç”¨ Go å’Œ Web æŠ€æœ¯åˆ›å»ºæ¡Œé¢åº”ç”¨ç¨‹åº chromedp - çº¯ Go è¯­è¨€å®ç°çš„é©±åŠ¨æµè§ˆå™¨çš„ Chrome DevTools Protocolï¼Œå¯ç”¨äºçˆ¬è™«ã€åçˆ¬è™«ã€æµ‹è¯•ç­‰åœºæ™¯ Rod - ä¸€ä¸ªä¸ºç®€åŒ–è‡ªåŠ¨åŒ–å’Œçˆ¬è™«è®¾è®¡çš„ devtools driverï¼Œåˆ©ç”¨æµè§ˆå™¨çš„ devtools å¯ç¼–ç¨‹æ¥å£æ¥æ“æ§æµè§ˆå™¨ go-astilectron - åŸºäº Electron çš„è·¨å¹³å°å¼€å‘ Gio - è·¨å¹³å° UI æ¡†æ¶ï¼Œæ”¯æŒç§»åŠ¨åº”ç”¨ nucular - åŸºäº Gio çš„å®ç° GoVCL - è·¨å¹³å°çš„ GUI åŒ… vugu - WebAssembly UI æ¡†æ¶ GoGi - 2D/3D GUI æ¡†æ¶ systray - è·¨å¹³å°æ”¯æŒèœå•æ ç®¡ç† go-flutter - ç»‘å®š Flutter åˆ°æ¡Œé¢åº”ç”¨ NuxUI 10.74.2 æ¡Œé¢è¾…åŠ©åŒ… pkg/browser - åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ–‡ä»¶ã€URL MacDriver - macOS åŸç”Ÿ API gon - ä¸º macOS ç­¾åå’Œå…¬è¯ 10.74.3 æ¡Œé¢åº”ç”¨ xbar - åŸºäº Wails.app å¼€å‘çš„ macOS èœå•æ ç®¡ç† é˜¿é‡Œäº‘ç›˜å°ç™½ç¾Šç‰ˆ - UIç”±Flutteræ„å»º ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:74","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.75 ç§»åŠ¨ç«¯ golang/mobile - Go support for Mobile devices ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:75","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.76 åç¨‹/çº¿ç¨‹ ants - åç¨‹æ±  tunny go-workers - å®‰å…¨åœ°å¹¶å‘è¿è¡Œä¸€ç»„ workerï¼Œé€šè¿‡ channel è¿›è¡Œè¾“å…¥è¾“å‡º Machine - å— errgroup.Group å¯å‘çš„åç¨‹ç®¡ç† thread conc - æ›´å¥½ç”¨çš„ç»“æ„åŒ–å¹¶å‘æ§åˆ¶ zeropool - é›¶å›æ”¶ã€ç±»å‹å®‰å…¨çš„åç¨‹æ±  workerpool - æ— é˜»å¡é˜Ÿåˆ—ä»»åŠ¡æ±  pond - åç¨‹æ±  ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:76","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.77 ä»»åŠ¡/å®šæ—¶å™¨ RxGo - Go ç‰ˆ ReactiveXï¼Œç®€å•æ–¹ä¾¿çš„å¤„ç†å¼‚æ­¥æ•°æ®æµ Grift - Go based task runner cron - a cron library for go gocron - ä»»åŠ¡å®šæ—¶è°ƒåº¦å™¨ jobrunner CurlyQ - åå°ä»»åŠ¡å¤„ç†åº“ overtalk/task - ä»»åŠ¡çš„ç®¡ç†\u0026æ‰§è¡Œï¼Œæ”¯æŒè‡ªå®šä¹‰æ¬¡æ•°çš„é‡å‘ PPGo_Job - å®šæ—¶ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ gocelery - Celery çš„ Go è¯­è¨€å®ç° Machinery - é€šè¿‡åˆ†å¸ƒå¼æ¶ˆæ¯å®ç°å¼‚æ­¥ä»»åŠ¡è°ƒåº¦ dkron - åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ Grit - åŸºäº MultiTree å®ç°çš„ä»»åŠ¡ç®¡ç† Asynq - å¼‚æ­¥åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ— cronsun - åˆ†å¸ƒå¼ä»»åŠ¡ç³»ç»Ÿ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:77","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.78 æµå¤„ç† benthos gostream watermill go-streams goflow Cadence (Cadence Web UI) - Uberå¼€æºçš„åˆ†å¸ƒå¼å·¥ä½œæµå¼•æ“ï¼Œä¸»è¦ç”¨äºå¾®æœåŠ¡ç¼–æ’å’Œåˆ†å¸ƒå¼äº‹åŠ¡ç­‰åœºæ™¯ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:78","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.79 å¾®ä¿¡ weapp - å¾®ä¿¡å°ç¨‹åº SDK wechat - WeChat SDK for Go wechat-go - å¾®ä¿¡ Web ç‰ˆ API çš„ Go å®ç° ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:79","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.80 SDK gopay - QQã€å¾®ä¿¡ï¼ˆWeChatï¼‰ã€æ”¯ä»˜å®ï¼ˆAliPayï¼‰çš„Goç‰ˆæœ¬SDK alipay - æ”¯ä»˜å®SDK ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:80","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.81 åŒºå—é“¾ Hyperledger Fabric - åŸºäºåŒºå—é“¾çš„è¶…çº§è´¦æœ¬ go-ethereum - ä»¥å¤ªåŠåè®®çš„å®˜æ–¹ Go è¯­è¨€å®ç° bbgo - ç”¨ Go ç¼–å†™çš„åŠ å¯†è´§å¸äº¤æ˜“æ¡†æ¶ btcd - æ¯”ç‰¹å¸å®ç° ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:81","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.82 å¼€å‘è¾…åŠ©åŒ… cvt - ä»»æ„æ•°æ®ç±»å‹è½¬æ¢ï¼Œæ”¯æŒè‡ªå®šä¹‰ç±»å‹ã€æå–ç»“æ„ä½“å­—æ®µå’Œå€¼ copier - struct ä¹‹é—´æ‹·è´å€¼ cast - æ•°æ®ç±»å‹è½¬æ¢ diff - ç»“æ„ä½“\u0026å€¼æ¯”è¾ƒ go-extend com - å·¥å…·åŒ… php2go - Go å®ç°çš„ 140+ ä¸ª PHP å‡½æ•°åŠŸèƒ½åŒ… gommon - Common packages for Go reflect2 - reflect api without runtime reflect.Value cost mapstructure - å°† map å€¼è½¬æ¢åˆ°ç»“æ„ä½“ä¸­ naza - Goè¯­è¨€åŸºç¡€åº“ automaxprocs - è‡ªåŠ¨è®¾ç½® GOMAXPROCS c2go - å°† C ä»£ç è½¬æ¢ä¸º Go ä»£ç çš„å·¥å…· rnm - ä»£ç é‡æ„è¾…åŠ©å·¥å…· memviz - å›¾å½¢åŒ–æ•°æ®ç»“æ„ underscore.go go-testdeep - éå¸¸çµæ´»çš„æ·±åº¦æ¯”è¾ƒåŒ…ï¼Œæ‰©å±•äº† Go æµ‹è¯•åŒ… go-model - struct æ“ä½œåŒ… concurrent-map - å¹¶å‘å®‰å…¨ map goleak - æ£€æµ‹ goroutine æ³„æ¼ guregu/null - SQL/JSONçš„nullå¤„ç†åŒ…ï¼Œæä¾›æ›¿ä»£ç±»å‹ stats - æ ‡å‡†æ•°å­—ç»Ÿè®¡ Chronos - é™æ€ç«äº‰æ£€æµ‹å™¨ collection - æ›¿ä»£åŸç”Ÿçš„ Slice rf - ä»£ç é‡æ„å·¥å…· bytebufferpool - byte buffers pool bpool - byte buffers poolï¼Œæ”¯æŒ bytes.Buffers mergo - åˆå¹¶ç»“æ„ä½“å’Œå­—å…¸æ•°æ® go-funk - åŸºäºåå°„å®ç°çš„å¸¸ç”¨å‡½æ•° lo - åŸºäº 1.18+ æ³›å‹çš„å¸¸ç”¨å‡½æ•° juniper - åŸºäºæ³›å‹å®ç°å¸¸ç”¨çš„å®¹å™¨ã€è¿­ä»£å™¨ã€æ•°æ®æµç­‰åŠŸèƒ½ mergo - åˆå¹¶ç»“æ„ä½“å’Œå­—å…¸ xstrings - å­—ç¬¦ä¸²ç›¸å…³å‡½æ•° pie - slice/map é“¾å¼å¤„ç† ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:82","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.83 ä»£ç ç”Ÿæˆ ChimeraCoder/gojson - æ ¹æ® JSON ç”Ÿæˆç»“æ„ä½“ db2struct - æ ¹æ®è¡¨ç»“æ„ç”Ÿæˆç»“æ„ä½“ smallnest/gen - æ ¹æ®è¡¨ç»“æ„ç”Ÿæˆç»“æ„ä½“ sqlc - æ ¹æ® SQL è¯­å¥ç”Ÿæˆ Go ä»£ç  xo - æ ¹æ®è¡¨ç»“æ„æˆ–æŸ¥è¯¢è¯­å¥è‡ªåŠ¨ç”Ÿæˆ Go ä»£ç  ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:83","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.84 ç³»ç»Ÿå¼€å‘ LinuxKit - ä¸ºå®¹å™¨æ„å»ºå®‰å…¨ã€ä¾¿æºã€å¯ç§»æ¤æ“ä½œç³»ç»Ÿçš„å·¥å…·åŒ… go-systemd - ç»‘å®š systemd Lima - Linux-on-Mac (â€œmacOS subsystem for Linuxâ€, â€œcontainerd for Macâ€) gopher-os - ä¸€ä¸ªå…¼å®¹ Linux çš„ 64 ä½ POSIX é£æ ¼ç³»ç»Ÿ gouring - ä¸ä¾èµ– CGO å®ç°ç³»ç»Ÿè°ƒç”¨ ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:84","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"10.85 æœªå½’ç±» go-playground - æ¯”å®˜æ–¹æ›´å¥½ç”¨çš„ Go Playground Robotgo - Golang è·¨å¹³å°è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œæ§åˆ¶é”®ç›˜é¼ æ ‡ä½å›¾å’Œè¯»å–å±å¹•ï¼Œçª—å£å¥æŸ„ä»¥åŠå…¨å±€äº‹ä»¶ç›‘å¬ go-homedir i18n - i18n å¤šè¯­è¨€å·¥å…·åŒ… go-i18n - å¤šè¯­è¨€å·¥å…·åŒ… Paginater - åˆ†é¡µå·¥å…· gls - Goroutine local storage mcuadros/go-version - ç‰ˆæœ¬å·æ¯”è¾ƒ go-semver - è¯­ä¹‰ç‰ˆæœ¬ semver - å¦ä¸€ä¸ªè¯­ä¹‰ç‰ˆæœ¬ hashicorp/go-version Metabolize - Decodes HTML meta tags into a Golang struct otp - ä¸€æ¬¡æ€§å¯†ç å·¥å…·åŒ…(One Time Password utilities) misspell - å¸¸æ‹¼å†™é”™è¯¯çš„è‹±è¯­å•è¯ CRDT - CRDT(Convergent and Commutative Replicated Data Types)æœ€ç»ˆä¸€è‡´æ€§ç®—æ³•çš„å®ç° script - Making it easy to write shell-like scripts in Go sysadmin-utils licenseclassifier - è¯†åˆ«æ–‡ä»¶ä¸­çš„ LICENSE ç±»å‹ go-license-detector rose - åœ¨ HTML ä¸­åµŒå…¥å’Œè¿è¡Œ Go ä»£ç  esbuild - JavaScript æ„å»ºæ‰“åŒ…å·¥å…· clipboard - å‰ªåˆ‡æ¿ clipboard - å‰ªåˆ‡æ¿ clipboard - å‰ªåˆ‡æ¿ Timeliner - æœé›†æ•´ç†ä¸ªäººåœ¨ç¤¾äº¤ç½‘ç«™ä¸Šçš„æ•°æ®å¹¶ç´¢å¼•æˆæ—¶é—´çº¿ hc - HomeKit å¹³å°å¼€å‘æ¡†æ¶ address - åœ°å€å¤„ç†åº“ï¼Œæ”¯æŒå¤šå›½è¯­è¨€ webhook - å¯æ‰§è¡Œ Shell å‘½ä»¤çš„ Web Hook æœåŠ¡ webhookd - ä¸º Shell è„šæœ¬æä¾› Web Hook æœåŠ¡ go-cid - CID spec Go è¯­è¨€å®ç° gorush - APP æ¶ˆæ¯é€šçŸ¥æœåŠ¡ EventBus - äº‹ä»¶æ€»çº¿ go-winio - ä¸º Win32 IO æ“ä½œæä¾›æ¥å£æ”¯æŒ fq - ä»¥ jq è¯­æ³•è¯»å–äºŒè¿›åˆ¶æ•°æ®/æ–‡ä»¶ lego - Letâ€™s Encrypt client and ACME library ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:10:85","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"11 logo Gophers ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:11:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"12 å·¥å…· syndbg/goenv - Go ç‰ˆæœ¬ç®¡ç† wfarr/goenv - Go ç‰ˆæœ¬ç®¡ç† gvm - Go ç‰ˆæœ¬ç®¡ç† GoLand - IDE è½¯ä»¶ Visual Studio Code ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:12:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—"],"content":"13 èµ„æºç«™ç‚¹ Go 101 Go è¯­è¨€ä¸­æ–‡ç½‘ Golang ä¸­å›½ go-zh Golang sizeof tips - è¾“å…¥ç»“æ„ä½“å®šä¹‰ï¼Œä¼šæ˜¾ç¤ºå†…å­˜å¸ƒå±€ Golang Programs Golang bot ","date":"2023-12-15","objectID":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/:13:0","tags":["Go"],"title":"Go è¯­è¨€ä¼˜ç§€èµ„æºæ•´ç†ï¼Œä¸ºé¡¹ç›®è½åœ°åŠ é€ŸğŸƒ","uri":"/posts/03.go%E4%BC%98%E7%A7%80%E8%B5%84%E6%BA%90/"},{"categories":["èµ„æºæ”¶è—","è®¾è®¡æ¨¡å¼"],"content":"23ç§è®¾è®¡æ¨¡å¼åˆ†ç±»å¦‚ä¸‹ï¼š æ¨¡å¼ç±»å‹ æè¿° åŒ…æ‹¬çš„æ¨¡å¼ åˆ›å»ºå‹æ¨¡å¼ è¿™äº›è®¾è®¡æ¨¡å¼æä¾›äº†ä¸€ç§åœ¨åˆ›å»ºå¯¹è±¡çš„åŒæ—¶éšè—åˆ›å»ºé€»è¾‘çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ new è¿ç®—ç¬¦ç›´æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚è¿™ä½¿å¾—ç¨‹åºåœ¨åˆ¤æ–­é’ˆå¯¹æŸä¸ªç»™å®šå®ä¾‹éœ€è¦åˆ›å»ºå“ªäº›å¯¹è±¡æ—¶æ›´åŠ çµæ´»ã€‚ å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰ æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰ å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰ å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰ åŸå‹æ¨¡å¼ï¼ˆPrototype Patternï¼‰ ç»“æ„å‹æ¨¡å¼ è¿™äº›è®¾è®¡æ¨¡å¼å…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»„åˆã€‚ç»§æ‰¿çš„æ¦‚å¿µè¢«ç”¨æ¥ç»„åˆæ¥å£å’Œå®šä¹‰ç»„åˆå¯¹è±¡è·å¾—æ–°åŠŸèƒ½çš„æ–¹å¼ã€‚ é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰ æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰ è¿‡æ»¤å™¨æ¨¡å¼ï¼ˆFilterã€Criteria Patternï¼‰ ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰ è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰ å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰ äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰ ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰ è¡Œä¸ºå‹æ¨¡å¼ è¿™äº›è®¾è®¡æ¨¡å¼ç‰¹åˆ«å…³æ³¨å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ï¼Œå³å¯¹è±¡ä¹‹é—´çš„è¡Œä¸ºã€‚ è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰ è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰ è¿­ä»£å™¨æ¨¡å¼ï¼ˆIterator Patternï¼‰ ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰ å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMemento Patternï¼‰ è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰ çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ ç©ºå¯¹è±¡æ¨¡å¼ï¼ˆNull Object Patternï¼‰ ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰ è®¾è®¡æ¨¡å¼çš„å…­å¤§åŸåˆ™æ˜¯è½¯ä»¶è®¾è®¡ä¸­çš„åŸºçŸ³ï¼Œå®ƒä»¬ä¸ºæ„å»ºçµæ´»ã€æ˜“äºç»´æŠ¤å’Œå‡çº§çš„è½¯ä»¶ç³»ç»Ÿæä¾›äº†æŒ‡å¯¼ã€‚ä»¥ä¸‹æ˜¯å¯¹è¿™å…­å¤§åŸåˆ™çš„ç®€è¦è¯´æ˜ï¼š å¼€é—­åŸåˆ™ï¼ˆOpen Close Principleï¼‰ï¼š æ„ä¹‰ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚å³åœ¨éœ€è¦è¿›è¡Œæ‹“å±•æ—¶ï¼Œä¸ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œå®ç°çƒ­æ’æ‹”çš„æ•ˆæœã€‚ å®ç°æ–¹å¼ï¼šä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»ï¼Œé€šè¿‡æŠ½è±¡åŒ–æ¥ä¿æŒç¨‹åºçš„æ‰©å±•æ€§ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ã€‚ é‡Œæ°ä»£æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰ï¼š æ„ä¹‰ï¼šä»»ä½•åŸºç±»å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ã€‚åŸºç±»èƒ½å¤Ÿè¢«æ´¾ç”Ÿç±»æ›¿æ¢ï¼Œä¸”ä¸å½±å“è½¯ä»¶å•ä½çš„åŠŸèƒ½ï¼Œå®ç°çœŸæ­£çš„å¤ç”¨ã€‚ è¡¥å……å…³ç³»ï¼šæ˜¯å¯¹å¼€é—­åŸåˆ™çš„è¡¥å……ï¼Œé€šè¿‡ç»§æ‰¿å…³ç³»å®ç°å¯¹æŠ½è±¡åŒ–çš„å…·ä½“æ­¥éª¤è§„èŒƒã€‚ ä¾èµ–å€’è½¬åŸåˆ™ï¼ˆDependence Inversion Principleï¼‰ï¼š åŸºç¡€ï¼šæ˜¯å¼€é—­åŸåˆ™çš„åŸºç¡€ã€‚å…·ä½“å†…å®¹ä¸ºé’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“ã€‚ æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰ï¼š æ„ä¹‰ï¼šä½¿ç”¨å¤šä¸ªéš”ç¦»çš„æ¥å£æ¯”ä½¿ç”¨å•ä¸ªæ¥å£æ›´å¥½ï¼Œé™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ã€‚ è®¾è®¡æ€æƒ³ï¼šä»å¤§å‹è½¯ä»¶æ¶æ„å‡ºå‘ï¼Œå¼ºè°ƒé™ä½ä¾èµ–ï¼Œé™ä½è€¦åˆã€‚ è¿ªç±³ç‰¹æ³•åˆ™ï¼Œåˆç§°æœ€å°‘çŸ¥é“åŸåˆ™ï¼ˆDemeter Principleï¼‰ï¼š å®šä¹‰ï¼šä¸€ä¸ªå®ä½“åº”å½“å°½é‡å°‘åœ°ä¸å…¶ä»–å®ä½“ä¹‹é—´å‘ç”Ÿç›¸äº’ä½œç”¨ï¼Œä½¿å¾—ç³»ç»ŸåŠŸèƒ½æ¨¡å—ç›¸å¯¹ç‹¬ç«‹ã€‚ åˆæˆå¤ç”¨åŸåˆ™ï¼ˆComposite Reuse Principleï¼‰ï¼š æ„ä¹‰ï¼šå°½é‡ä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿ã€‚é€šè¿‡ç»„åˆè€Œéç»§æ‰¿å®ç°ä»£ç å¤ç”¨ï¼Œå¢å¼ºç³»ç»Ÿçš„çµæ´»æ€§ã€‚ è¿™äº›åŸåˆ™æä¾›äº†ä¸€ç§æŒ‡å¯¼æ€æƒ³ï¼Œå¸®åŠ©å¼€å‘äººå‘˜è®¾è®¡å‡ºå…·æœ‰å¼¹æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§çš„è½¯ä»¶ç³»ç»Ÿã€‚é€šè¿‡éµå¾ªè¿™äº›åŸåˆ™ï¼Œå¯ä»¥æœ‰æ•ˆåº”å¯¹è½¯ä»¶å˜åŒ–ï¼Œæé«˜ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚ ä»¥ä¸‹æ˜¯éƒ¨åˆ†è¯­è¨€å®ç°è®¾è®¡æ¨¡å¼çš„ä»“åº“ï¼Œä»¥ä¾›å­¦ä¹ ã€‚ Go Java C++ Python JavaScript ","date":"2023-12-14","objectID":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%E6%A8%A1%E7%89%88/:0:0","tags":["è®¾è®¡æ¨¡å¼"],"title":"éµå¾ªæœ€ä½³å®è·µï¼Œå„ç§è¯­è¨€å®ç°è®¾è®¡æ¨¡å¼çš„æ¨¡ç‰ˆ","uri":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%E6%A8%A1%E7%89%88/"},{"categories":["èµ„æºæ”¶è—"],"content":" The Algorithmsæä¾› GitHub æœ€å¤§çš„å¼€æºç®—æ³•åº“ã€‚ The Algorithms å®˜æ–¹ç½‘ç«™ The Algorithms Githubä»“åº“ ä»¥ä¸‹æ˜¯éƒ¨åˆ†è¯­è¨€å®ç°æ•°æ®å’Œç®—æ³•çš„ä»“åº“ï¼Œä»¥ä¾›å­¦ä¹ ã€‚ Go Java C++ C Python JavaScript ","date":"2023-12-14","objectID":"/posts/01.%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0%E6%A8%A1%E7%89%88/:0:0","tags":["ç®—æ³•"],"title":"éµå¾ªæœ€ä½³å®è·µï¼Œå„ç§è¯­è¨€å®ç°æ•°æ®ç»“æ„å’Œç®—æ³•çš„æ¨¡ç‰ˆ","uri":"/posts/01.%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0%E6%A8%A1%E7%89%88/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 å®šä¹‰ æ•°åŸŸå®šä¹‰ æ•°åŸŸ$F$ï¼Œæ˜¯è‡³å°‘åŒ…å«$0$å’Œ$1$çš„æ•°é›†ï¼Œå¹¶æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š $\\forall a\\in F, -a\\in F$ $\\forall b\\in F(b\\neq 0), b^{-1}\\in F$ $\\forall a, b\\in F, a+b\\in F$ $\\forall a,b\\in F, a\\cdot b\\in F$ çŸ©é˜µè®ºä¸­æœ€å¸¸ç”¨åˆ°çš„ä¸¤ä¸ªæ•°åŸŸæ˜¯$R$ï¼ˆå®æ•°åŸŸï¼‰å’Œ$C$ï¼ˆå¤æ•°åŸŸï¼‰ ä»£æ•°ç³»ç»Ÿå®šä¹‰ ä»£æ•°ç³»ç»Ÿé€šå¸¸æ˜¯å®šä¹‰äº†ä¸€äº›è¿ç®—å’Œè¿ç®—è§„åˆ™çš„é›†åˆã€‚æè¿°ä¸€ä¸ªä»£æ•°ç³»ç»Ÿéœ€è¦ï¼š ä¸€ç»„å…ƒç´  è¿ç®— è¿ç®—è§„åˆ™ å‡ ä½•å‘é‡å®šä¹‰ æœ‰å¤§å°æœ‰æ–¹å‘çš„é‡ï¼Œå¯ä»¥ç”¨æœ‰å‘çº¿æ®µè¡¨ç¤ºï¼Œå¦‚$\\vec{\\alpha}$ã€‚æœ‰åŠ æ³•å’Œæ•°ä¹˜è¿ç®—ã€‚ å‘é‡ç©ºé—´å®šä¹‰ ä¸€ä¸ªåŸŸ $F$ï¼ˆåº•åŸŸï¼‰ä¸Šçš„å‘é‡ç©ºé—´ï¼ˆçº¿æ€§ç©ºé—´æˆ–çº¿æ€§å‘é‡ç©ºé—´ï¼‰$V$ æ˜¯ä¸€ç»„å…ƒç´ ï¼ˆç§°ä¸ºå‘é‡ï¼‰ä»¥åŠåŠ æ³•å’Œæ ‡é‡ä¹˜æ³•è¿™ä¸¤ç§è¿ç®—ï¼Œå¹¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š é—­åŒ…æ€§ $\\forall x,y\\in V, x+y\\in V$ï¼Œä¸”$x+y$è¿ç®—ç»“æœå”¯ä¸€ $\\forall a\\in F,x\\in V, a\\cdot x\\in V$ï¼Œä¸”$a\\cdot x$è¿ç®—ç»“æœå”¯ä¸€ åŠ æ³•å…¬ç† äº¤æ¢å¾‹ï¼š$\\forall x,y\\in V, x+y=y+x$ ç»“åˆå¾‹ï¼š$\\forall x,y,z\\in V, x+(y+z)=(x+y)+z$ å­˜åœ¨é›¶å‘é‡ï¼š$\\forall x\\in V,x+0=0+x=x$ å­˜åœ¨ç›¸åå‘é‡ï¼š$\\forall x\\in V,\\exist (-x)\\in V,x+(-x)=0$ æ ‡é‡ä¹˜æ³•å…¬ç† ç»“åˆå¾‹ï¼š$\\forall a,b\\in F, x\\in V,a\\cdot (b\\cdot x)=(ab)\\cdot x$ åˆ†é…å¾‹$1$ï¼š$\\forall a\\in F, x,y\\in V,a\\cdot(x+y)=a\\cdot x+a\\cdot y$ åˆ†é…å¾‹$2$ï¼š$\\forall a,b\\in F, x\\in V,(a+b)\\cdot x=a\\cdot x + b\\cdot x$ å­˜åœ¨å•ä½å…ƒç´ ï¼š$\\forall x\\in V,1\\cdot x=x$ å‘é‡ç©ºé—´é‡ç‚¹ å®šä¹‰ä¸€ä¸ªå‘é‡ç©ºé—´éœ€è¦ï¼šä¸€ä¸ªé›†åˆ$V$ï¼Œä¸€ä¸ªæ•°åŸŸ$F$ï¼Œä¸¤ç§è¿ç®—ï¼Œå…«ç§è¿ç®—è§„åˆ™ã€‚ å¸¸è§å‘é‡ç©ºé—´ $R^{m\\times n},(R^{m\\times 1}=R^m)$ï¼š$m\\times n$çš„å®æ•°çŸ©é˜µé›†åˆï¼Œåœ¨$R$ä¸Šçš„å‘é‡ç©ºé—´ $C^{m\\times n},(C^{m\\times 1}=R^m)$ï¼š$m\\times n$çš„å¤æ•°çŸ©é˜µé›†åˆï¼Œåœ¨$C$ä¸Šçš„å‘é‡ç©ºé—´ $C_{[a,b]}$ï¼šé—­åŒºé—´ä¸Šçš„è¿ç»­å‡½æ•°é›†åˆï¼Œåœ¨$R$ä¸Šçš„å‘é‡ç©ºé—´ $P_n$ï¼šæ¬¡æ•°å°äº $n$ çš„å®å¤šé¡¹å¼çš„é›†åˆï¼Œåœ¨$R$ä¸Šçš„å‘é‡ç©ºé—´ ","date":"2023-12-01","objectID":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 1â€”å‘é‡ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 å­ç©ºé—´ å­ç©ºé—´å®šä¹‰ å¦‚æœ$S$æ˜¯å‘é‡ç©ºé—´$V$åœ¨æ•°åŸŸ$F$ä¸Šçš„ä¸€ä¸ªéç©ºå­é›†ï¼Œä¸”æ»¡è¶³é—­åŒ…æ€§ï¼Œåˆ™$S$å°±æ˜¯$V$çš„ä¸€ä¸ªå­ç©ºé—´ã€‚ ç”±$V$çš„é›¶å‘é‡æ‰€ç»„æˆçš„è‡ªå·±${0}$æ˜¯$V$çš„ä¸€ä¸ªå­ç©ºé—´ï¼Œç§°ä¸ºé›¶å­ç©ºé—´ï¼Œå‘é‡ç©ºé—´$V$æœ¬èº«ä¹Ÿæ˜¯$V$çš„ä¸€ä¸ªå­ç©ºé—´ï¼Œå®ƒä»¬éƒ½ç§°ä¸º$V$çš„å¹³å‡¡å­ç©ºé—´ï¼Œ$V$çš„å…¶ä»–å­ç©ºé—´ç§°ä¸ºéå¹³å‡¡å­ç©ºé—´ã€‚ å­ç©ºé—´é‡ç‚¹ $V$ çš„å­ç©ºé—´ $S$ ä»¥åŠ $V$ çš„åŠ æ³•å’Œæ ‡é‡ä¹˜æ³•è¿ç®—æ»¡è¶³å‘é‡ç©ºé—´å®šä¹‰ä¸­çš„æ‰€æœ‰æ¡ä»¶ã€‚å› æ­¤ï¼Œå‘é‡ç©ºé—´çš„æ¯ä¸ªå­ç©ºé—´æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‘é‡ç©ºé—´ã€‚$S$ çš„åº•å±‚åŸŸä¸ $V$ çš„åº•å±‚åŸŸç›¸åŒã€‚ é›¶ç©ºé—´å®šä¹‰ è®¾$A\\in F^{m\\times n},N(A)={x\\in F^n|Ax=0}$ï¼Œåˆ™$N(A)$ä¸º$F^n$çš„å­ç©ºé—´ï¼Œ$N(A)$ç§°ä¸º$A$çš„é›¶ç©ºé—´ã€‚ å‘é‡çš„çº¿æ€§ç›¸å…³æ€§ è®¾$V$æ˜¯æ•°åŸŸ$F$ä¸Šçš„çº¿æ€§ç©ºé—´ï¼Œ$a_1,\\cdots,a_n\\in F,v_1,\\cdots,v_n\\in V$ï¼Œåˆ™$a_1v_1+\\cdots+a_nv_n$å°±æ˜¯$v_1,\\cdots,v_n$çš„çº¿æ€§ç»„åˆã€‚ è‹¥å­˜åœ¨$n$ä¸ªä¸å…¨ä¸ºé›¶çš„æ•°$a_1,\\cdots,a_n\\in F$ï¼Œä½¿å¾—$a_1v_1+\\cdots+a_nv_n=0$ï¼Œåˆ™ç§°$v_1,\\cdots,v_n$çº¿æ€§ç›¸å…³ï¼Œå¦åˆ™å°±ç§°ä¸ºçº¿æ€§æ— å…³ã€‚ çº¿æ€§ç›¸å…³çš„å……è¦æ¡ä»¶æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªå‘é‡æ˜¯å…¶ä½™å‘é‡çš„çº¿æ€§ç»„åˆ ç”Ÿæˆé›†å®šä¹‰ $span(K)={v|v\\texttt{æ˜¯å‘é‡}K\\texttt{çš„ä¸€ä¸ªçº¿æ€§ç»„åˆ}}$ï¼Œå³ä¸ºå‘é‡$K$çš„çº¿æ€§ç»„åˆç”Ÿæˆçš„é›†åˆã€‚å¦‚æœ$K$æ˜¯å‘é‡ç©ºé—´$V$ä¸­çš„æœ‰é™é›†ï¼Œé‚£ä¹ˆ$span(K)$ä¹Ÿå°±æ˜¯$V$çš„å­ç©ºé—´ã€‚ å¦‚æœ$v_1,\\cdots,v_n$æ˜¯å‘é‡ç©ºé—´$V$çš„å‘é‡ï¼Œä¸”$V=span{v_1,\\cdots,v_n}$ï¼Œåˆ™é›†åˆ${v_1,\\cdots,v_n}$ç§°ä¸º$V$çš„ç”Ÿæˆé›†ã€‚ å­ç©ºé—´çš„äº¤é›†ã€å’Œ è®¾$U_1,U_2$ä¸ºå‘é‡ç©ºé—´$V$çš„å­ç©ºé—´ï¼Œåˆ™$U_1\\cap U_2={v|v\\in U_1, v\\in U_2}$ï¼Œ$U_1\\cap U_2$ä¹Ÿæ˜¯$V$çš„å­ç©ºé—´ã€‚ è®¾$U_1,U_2$ä¸ºå‘é‡ç©ºé—´$V$çš„å­ç©ºé—´ï¼Œåˆ™$U_1+U_2={v_1+v_2|v_1\\in U_1,v_2\\in U_2}$ï¼Œ$U_1+ U_2$ä¹Ÿæ˜¯$V$çš„å­ç©ºé—´ã€‚ å¦‚æœ$U_1=span(u_1,\\cdots_,u_k),U_2=span(w_1,\\cdots,w_s)$ï¼Œåˆ™$U_1+U_2=span(u_1,\\cdots,u_k,w_1,\\cdots,w_s)$ã€‚ å­ç©ºé—´çš„ç›´å’Œ è®¾$V_1,V_2$æ˜¯å‘é‡ç©ºé—´$V$çš„ä¸¤ä¸ªå­ç©ºé—´ï¼Œå¦‚æœå’Œ$V_1+V_2$ä¸­æ¯ä¸€ä¸ªå‘é‡$\\alpha$å¯å”¯ä¸€è¡¨ç¤ºæˆ$\\alpha=\\alpha_1+\\alpha_2,\\alpha_1\\in V_1,\\alpha_2\\in V_2$ï¼Œåˆ™ç§°å’Œ$V_1+V_2$ä¸ºç›´å’Œï¼Œè®°ä¸º$V_1+V_2$ã€‚ å’Œ$V_1+V_2$æ˜¯ç›´å’Œ$\\Longleftrightarrow$å’Œ$V_1+V_2$ä¸­é›¶å‘é‡çš„è¡¨ç¤ºæ³•å”¯ä¸€ï¼Œå³è‹¥$\\alpha_1+\\alpha_2=0(\\alpha_1\\in V_1,\\alpha_2\\in V_2)$ï¼Œåˆ™$\\alpha_1=0,\\alpha_2=0\\Longleftrightarrow V_1\\cap V_2={0}\\Longleftrightarrow\\dim(V_1+V_2)=\\dim(V_1)+\\dim(V_2)$ è¡¥ç©ºé—´å®šä¹‰ å¦‚æœ$V=V_1\\oplus V_2 $ï¼Œæˆ‘ä»¬åˆ™ç§°$V_1$å’Œ$V_2$äº’ä¸ºè¡¥ç©ºé—´ï¼Œå³$V_1$æ˜¯$V_2$çš„è¡¥ã€‚ è¡¥ç©ºé—´å®šç† å¦‚æœ$U$æ˜¯$V$çš„å­ç©ºé—´ï¼Œåˆ™å­˜åœ¨$V$çš„å­ç©ºé—´$W$ï¼Œä½¿å¾—$V=U\\oplus W$ ","date":"2023-12-01","objectID":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 1â€”å‘é‡ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 åŸºã€åæ ‡å’Œç»´æ•° åŸºã€åæ ‡å®šä¹‰ $n$ä¸ªå‘é‡$v_1,\\cdots,v_n$æ˜¯å‘é‡ç©ºé—´$V$çš„ä¸€ç»„åŸºï¼Œå½“ä¸”ä»…å½“ï¼š $v_1,\\cdots,v_n$çº¿æ€§æ— å…³ $V=span(v_1,\\cdots,v_n)$ åŸºä¸æ˜¯å”¯ä¸€çš„ï¼Œä½†$V$çš„æ‰€æœ‰åŸºä¸­çš„å‘é‡ä¸ªæ•°æ˜¯ç›¸åŒçš„ è®¾$a$æ˜¯$V$ä¸­çš„ä»»ä¸€å‘é‡ï¼Œåˆ™$a$å¯ä»¥å”¯ä¸€çš„è¡¨ç¤ºä¸ºåŸº$v_1,\\cdots,v_n$çš„çº¿æ€§ç»„åˆ$a=k_1v_1+\\cdots+k_nv_n$ï¼Œå…¶ä¸­ç³»æ•°$k_1,\\cdots,k_n$ç§°ä¸º$a$åœ¨åŸº$v_1,\\cdots,v_n$ä¸‹çš„åæ ‡ï¼Œè®°ä¸º$(k_1,\\cdots,k_n)^T$ã€‚ ç»´æ•°å®šä¹‰ å¦‚æœå‘é‡ç©ºé—´$V$çš„åŸºç”±$n$ä¸ªå‘é‡ç»„æˆï¼Œåˆ™æˆ‘ä»¬ç§°$V$çš„ç»´æ•°æ˜¯$n$ã€‚ å®šç† åœ¨$n$ç»´çº¿æ€§ç©ºé—´$V$ä¸­ï¼Œä»»æ„ä¸€ä¸ªçº¿æ€§æ— å…³çš„å‘é‡ç»„$a_1,\\cdots,a_r$éƒ½å¯ä»¥æ‰©å……ä¸º$V$çš„ä¸€ç»„åŸºã€‚ ç»´æ•°å…¬å¼ è®¾$U_1,U_2$ä¸ºå‘é‡ç©ºé—´$V$çš„ä¸¤ä¸ªå­ç©ºé—´ï¼Œåˆ™ $\\dim(U_1+U_2)=\\dim(U_1)+\\dim(U_2)-\\dim(U_1\\cap U_2)$ ","date":"2023-12-01","objectID":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 1â€”å‘é‡ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 åŸºå˜æ¢ è¿‡æ¸¡çŸ©é˜µ è®¾$u_1,\\cdots,u_n$ä¸$v_1,\\cdots,v_n$æ˜¯$n$ç»´çº¿æ€§ç©ºé—´$V$çš„ä¸¤ç»„åŸºï¼Œåˆ™æœ‰å¦‚ä¸‹å…³ç³» å…³ç³»å¼ç”¨çŸ©é˜µè¡¨ç¤ºä¸º $n$é˜¶çŸ©é˜µ ç§°ä¸ºç”±åŸº$u_1,\\cdots,u_n$åˆ°åŸº$v_1,\\cdots,v_n$çš„è¿‡æ¸¡çŸ©é˜µã€‚ ","date":"2023-12-01","objectID":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 1â€”å‘é‡ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"5 è¡Œç©ºé—´å’Œåˆ—ç©ºé—´ çŸ©é˜µçš„ç§© å¦‚æœçŸ©é˜µ$A$çš„ç§©ä¸º$r$ï¼Œåˆ™è¯´æ˜ï¼š å­˜åœ¨ä¸€ä¸ª$rÃ—r$å­çŸ©é˜µï¼Œå…¶è¡Œåˆ—å¼ä¸ä¸ºé›¶ï¼›å’Œ æ‰€æœ‰çš„ $(r+1)\\times (r+1)$ çš„å­çŸ©é˜µçš„è¡Œåˆ—å¼ä¸ºé›¶ã€‚ è¡Œç©ºé—´å’Œåˆ—ç©ºé—´ è®¾$A\\in F^{m\\times n}$ è¡Œç©ºé—´ï¼šç”±$A$çš„è¡Œå‘é‡ç”Ÿæˆçš„$F^{1\\times n}$çš„å­ç©ºé—´ã€‚ï¼ˆä¹Ÿä¸º$A^T$çš„åˆ—ç©ºé—´ï¼‰ åˆ—ç©ºé—´ï¼šç”±$A$çš„åˆ—å‘é‡ç”Ÿæˆçš„$F^{m\\times 1}$çš„å­ç©ºé—´ã€‚ï¼ˆä¹Ÿä¸º$A^T$çš„è¡Œç©ºé—´ï¼‰ è¡Œç­‰ä»·æ¡ä»¶ çŸ©é˜µ$A$å’Œ$B$è¢«ç§°ä¸ºæ˜¯è¡Œç­‰ä»·$\\Longleftrightarrow$$B$å¯ä»¥ç”±$A$è¿›è¡Œåˆç­‰è¡Œå˜æ¢å¾—åˆ°ã€‚ ç‰¹åˆ«åœ°ï¼Œå¯¹äºéå¥‡å¼‚çŸ©é˜µï¼Œæœ‰å……è¦æ¡ä»¶æ˜¯å­˜åœ¨ä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µ$M$ä½¿å¾—ï¼Œ$MA=B$ã€‚ è¡Œç­‰ä»·æ€§è´¨ è®¾çŸ©é˜µ$A,B$æ˜¯ä¸¤ä¸ªè¡Œç­‰ä»·çš„çŸ©é˜µï¼Œåˆ™ï¼š å®ƒä»¬æœ‰ç›¸åŒçš„è¡Œç©ºé—´ã€‚ å¦‚æœ$A$ä¸­çš„åˆ—å‘é‡$a_{i_1},\\cdots,a_{i_k}$æ˜¯çº¿æ€§æ— å…³çš„ï¼Œåˆ™$B$ä¸­çš„åˆ—å‘é‡$b_{i_1},\\cdots,b_{i_k}$ä¹Ÿæ˜¯çº¿æ€§æ— å…³çš„ åˆ—ç©ºé—´æ€§è´¨ çº¿æ€§ç³»ç»Ÿ$Ax=b$ç›¸å®¹ï¼ˆæœ‰è§£ï¼‰$\\Longleftrightarrow$$b$åœ¨$A$çš„åˆ—ç©ºé—´é‡Œ $Ax=b$ç›¸å®¹å½“ä¸”ä»…å½“$rank(A)=rank(A,b)$ï¼Œå³ç­‰ä»·äº$A$çš„åˆ—ç©ºé—´ç­‰äº$(A,b)$çš„åˆ—ç©ºé—´ å¦‚æœ$\\forall b\\in F^m$ï¼Œ$Ax=b$ç›¸å®¹ï¼Œè¯´æ˜$A$çš„åˆ—ç©ºé—´æ˜¯$F^m$ã€‚ å¦‚æœ$\\forall b,Ax=b$è‡³å¤šåªæœ‰ä¸€ä¸ªè§£ï¼Œè¯´æ˜$A$çš„åˆ—å‘é‡æ˜¯çº¿æ€§æ— å…³çš„ï¼Œåˆ™$A$çš„åˆ—å‘é‡æ˜¯$A$çš„åˆ—ç©ºé—´çš„åŸºï¼Œç­‰ä»·äº$A$æ˜¯éå¥‡å¼‚çŸ©é˜µã€‚ ç§©â€”â€”é›¶åº¦å®šç† è®¾$A$ä¸º$m\\times n$çŸ©é˜µï¼Œåˆ™$rank(A)+rank(N(A))=0$ ç§©å’Œç»´æ•° è®¾$A$æ˜¯$m\\times n$çŸ©é˜µï¼Œ$A$çš„è¡Œç©ºé—´ç»´æ•°ç­‰äº$A$çš„åˆ—ç©ºé—´ç»´æ•°ï¼Œå³$\\dim(R(A^T))=\\dim(R(A))$ï¼Œå…¶ä¸­$R(A^T)$è¡¨ç¤º$A^T$çš„åˆ—ç©ºé—´ï¼Œå³$A$çš„è¡Œç©ºé—´ã€‚ è™½ç„¶çŸ©é˜µ$A$çš„è¡Œç©ºé—´å’Œåˆ—ç©ºé—´ä¸ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬æœ‰ç›¸åŒçš„ç»´æ•°ï¼Œéƒ½ä¸º$A$çš„ç§©ï¼ŒçŸ©é˜µ$A$åœ¨åˆç­‰å˜æ¢ä¸‹ç§©æ˜¯ä¸å˜çš„ã€‚ ","date":"2023-12-01","objectID":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/:5:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 1â€”å‘é‡ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/01.%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 å†…ç§¯ç©ºé—´ å†…ç§¯ç©ºé—´å®šä¹‰ è®¾$V$æ˜¯åœ¨æ•°åŸŸ$F$ä¸Šçš„å‘é‡ç©ºé—´ï¼Œåˆ™$V$åˆ°$F$çš„ä¸€ä¸ªä»£æ•°è¿ç®—è®°ä¸º$(\\alpha,\\beta)$ã€‚å¦‚æœ$(\\alpha,\\beta)$æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š $(\\alpha,\\beta)=\\overline{(\\beta,\\alpha)}$ï¼ˆ$\\overline{}$è¡¨ç¤ºå…±è½­ç¬¦ï¼Œé’ˆå¯¹å¤æ•°åŸŸï¼Œä¸ºäº†ä¿è¯å¤æ•°è¿ç®—çš„æ­£ç¡®æ€§ï¼‰ $(\\alpha+\\beta,\\gamma)=(\\alpha,\\gamma)+(\\beta,\\gamma)$ $(k\\alpha,\\beta)=k(\\alpha,\\beta)$ $(\\alpha,\\alpha)\\geq 0$ï¼Œå½“ä¸”ä»…å½“$\\alpha=0$æ—¶ï¼Œ$(\\alpha,\\alpha)=0$ã€‚ å…¶ä¸­$k\\in F,\\alpha,\\beta,\\gamma\\in V$ã€‚åˆ™ç§°$(\\alpha,\\beta)$ä¸º$\\alpha$å’Œ$\\beta$çš„å†…ç§¯ã€‚å®šä¹‰äº†å†…ç§¯çš„å‘é‡ç©ºé—´$V$ç§°ä¸ºå†…ç§¯ç©ºé—´ã€‚ç‰¹åˆ«åœ°ï¼Œç§°å®æ•°åŸŸ$R$ä¸Šçš„å†…ç§¯ç©ºé—´$V$ä¸ºEuclidç©ºé—´ï¼ˆæ¬§å¼ç©ºé—´ï¼‰ï¼›ç§°å¤æ•°åŸŸ$C$ä¸Šçš„å†…ç§¯ç©ºé—´$V$ä¸ºé…‰ç©ºé—´ã€‚ æ ‡å‡†å†…ç§¯ åœ¨å®æ•°åŸŸ$R$ä¸Šçš„$n$ç»´å‘é‡ç©ºé—´$R^n$ä¸­ï¼Œå¯¹å‘é‡$x=(x_1,\\cdots,x_n)^T,y=(y_1,\\cdots,y_n)^T$ï¼Œå®šä¹‰å†…ç§¯ åœ¨å¤æ•°åŸŸ$C$ä¸Šçš„$n$ç»´å‘é‡ç©ºé—´$C^n$ï¼Œå¯¹å‘é‡$x=(x_1,\\cdots,x_n)^T,y=(y_1,\\cdots,y_n)^T$ï¼Œå®šä¹‰å†…ç§¯ å…¶ä¸­$y^H$è¡¨ç¤º$y$çš„å…±è½­è½¬ç½®ã€‚ ä»¥ä¸Šä¸¤ä¸ªå†…ç§¯æˆ‘ä»¬ç§°ä¸º$R^n$æˆ–$C^n$çš„æ ‡å‡†å†…ç§¯ï¼Œä¸€èˆ¬æˆ‘ä»¬æ¢è®¨çš„ä¹Ÿå°±æ˜¯æ ‡å‡†å†…ç§¯ã€‚ é‡è¦å®šä¹‰ è®¾$u,v$æ˜¯å†…ç§¯ç©ºé—´$V$çš„å‘é‡ åˆ™$v$çš„é•¿åº¦æˆ–èŒƒæ•°ä¸ºï¼š$||v||=\\sqrt{(v,v)}$ï¼Œé•¿åº¦ä¸º$1$çš„ç§°ä¸ºå•ä½å‘é‡ã€‚å¦‚æœ$v\\neq 0$ï¼Œåˆ™$\\frac{v}{||v||}$æ˜¯ä¸€ä¸ªå•ä½å‘é‡ å¦‚æœ$v\\neq 0$ï¼Œåˆ™$u$åœ¨$v$ä¸Šçš„æ•°é‡æŠ•å½±è¢«å®šä¹‰ä¸ºï¼š$\\alpha=\\frac{(u,v)}{||v||}$ï¼Œ$u$åœ¨$v$ä¸Šçš„å‘é‡æŠ•å½±è¢«å®šä¹‰ä¸ºï¼š$p=\\alpha\\frac{v}{||v||}=\\frac{(u,v)}{(v,v)}v$ å¦‚æœ$(u,v)=0$ï¼Œåˆ™ç§°$u$å’Œ$v$æ­£äº¤ å†…ç§¯çš„åŸºæœ¬æ€§è´¨ è®¾$u,v\\in V$ï¼Œå…¶ä¸­$V$æ˜¯å†…ç§¯ç©ºé—´ï¼Œåˆ™ å‹¾è‚¡å®šç†ï¼šå¦‚æœ$u\\perp v$ï¼Œåˆ™$||u-v||^2=||u||^2+||v||^2$ è¯æ˜ï¼š æŸ¯è¥¿ä¸ç­‰å¼ï¼š$|(u,v)|\\leq ||u||\\space ||v||$ã€‚ç­‰å¼æˆç«‹å½“ä¸”ä»…å½“$u$å’Œ$v$çº¿æ€§ç›¸å…³ã€‚ è¯æ˜ï¼š å¦‚æœ$u,v$çº¿æ€§ç›¸å…³ï¼Œåˆ™è®¾$u=kv,k\\in F$ï¼Œåˆ™$(u,v)=(kv,v)=k||v||^2$ å¦‚æœ$u,v$çº¿æ€§æ— å…³ï¼Œè®¾$z=u-\\frac{(u,v)}{(v,v)}v$ï¼Œåˆ™$(z,v)=(u-\\frac{(u,v)}{(v,v)}v,v)=(u,v)-\\frac{(u,v)}{(v,v)}(v,v)=0$ï¼Œåˆ™$z$å’Œ$v$æ­£äº¤ã€‚è½¬æ¢å¾—åˆ°$u=z+\\frac{(u,v)}{(v,v)}v$ï¼Œæ ¹æ®æ­£äº¤æ€§ï¼Œç»“åˆå‹¾è‚¡å®šç†åˆ™$||u||^2=||z||^2+|\\frac{(u,v)}{(v,v)}|^2||v||^2=||z||^2+\\frac{|(u,v)|^2}{(||v||^2)^2}||v||^2=||z||^2+\\frac{|(u,v)|^2}{||v||^2}$ åˆå› ä¸º$||z||^2\u003e 0$ï¼ˆçº¿æ€§æ— å…³ï¼Œ$||z||^2$å¿…å¤§äº$0$ï¼‰ï¼Œåˆ™$|(u,v|\u003c||u||\\space ||v||$ ä¸‰è§’ä¸ç­‰å¼ï¼š$||u+v||^2\\leq ||u||^2+||v||^2$ è¯æ˜ï¼š å¹³è¡Œå››è¾¹å½¢å‡†åˆ™ï¼š$||u+v||^2+||u-v||^2=2(||u||^2+||v||^2)$ è¯æ˜ï¼š ","date":"2023-12-01","objectID":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 2â€”å†…ç§¯ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 æ ‡å‡†æ­£äº¤å‘é‡é›† æ­£äº¤å‘é‡é›†å®šä¹‰ è®¾$v_1,\\cdots,v_n$æ˜¯å†…ç§¯ç©ºé—´$V$ä¸­çš„éé›¶å‘é‡ï¼Œå¦‚æœ$V$ä¸­çš„ä»»æ„ä¸¤ä¸ªå‘é‡$(v_i,v_j)=0(i\\neq j)$ï¼Œåˆ™$V$æ˜¯ä¸€ä¸ªæ­£äº¤å‘é‡é›†ã€‚ æ ‡å‡†æ­£äº¤å‘é‡é›†å®šä¹‰ å¦‚æœ$V$æ˜¯ä¸€ä¸ªæ­£äº¤å‘é‡é›†ï¼Œä¸”$V$ä¸­çš„æ‰€æœ‰å‘é‡éƒ½æ˜¯å•ä½å‘é‡ï¼Œå³$(v_i,v_i)=1$ï¼Œåˆ™$V$æ˜¯ä¸€ä¸ªæ ‡å‡†æ­£äº¤å‘é‡é›†ã€‚ æ­£äº¤å‘é‡é›†æ€§è´¨ å¦‚æœ$v_1,\\cdots,v_n$æ˜¯å†…ç§¯ç©ºé—´$V$çš„ä¸€ä¸ªæ­£äº¤å‘é‡é›†ï¼Œåˆ™$v_1,\\cdots,v_n$éƒ½æ˜¯çº¿æ€§æ— å…³çš„ã€‚ æ­£äº¤åŸºå’Œæ ‡å‡†æ­£äº¤åŸº åœ¨$n$ç»´å†…ç§¯ç©ºé—´ä¸­ï¼Œç”±$n$ä¸ªæ­£äº¤å‘é‡ç»„æˆçš„åŸºç§°ä¸ºæ­£äº¤åŸºï¼Œç”±$n$ä¸ªæ ‡å‡†æ­£äº¤å‘é‡ç»„æˆçš„åŸºç§°ä¸ºæ ‡å‡†æ­£äº¤åŸºã€‚ æ ‡å‡†æ­£äº¤åŸºè¡¨ç¤ºå‘é‡åæ ‡ è®¾$u_1,\\cdots,u_n$æ˜¯å†…ç§¯ç©ºé—´$V$çš„ä¸€ä¸ªæ ‡å‡†æ­£äº¤åŸºï¼Œå¦‚æœ$v=\\sum_{i=1}^nc_iu_i$ï¼Œåˆ™$c_i=(v,u_i)$å…¶ä¸­$c_i$ä¸ºå‘é‡$v$åœ¨å‘é‡$u_i$çš„æ ‡é‡æŠ•å½±ã€‚ Parsevalå…¬å¼ è®¾$u_1,\\cdots,u_n$æ˜¯å†…ç§¯ç©ºé—´$V$çš„ä¸€ä¸ªæ ‡å‡†æ­£äº¤åŸºï¼Œå¦‚æœ$u=\\sum_{i=1}^na_iu_i,v=\\sum_{i=1}^nb_iu_i$ï¼Œåˆ™$(u,v)=\\sum_{i=1}^na_i\\bar{b_i}$ã€‚å¹¶ä¸”ï¼Œ$||v||^2=\\sum_{i=1}^n b_i\\bar{b_i}=\\sum_{i=1}^n|b_i|^2$ã€‚ æ­£äº¤æŠ•å½±å‘é‡å®šä¹‰ å¦‚æœ$S$æ˜¯å†…ç§¯ç©ºé—´$V$çš„å­ç©ºé—´ï¼Œä»¤$b\\in V$ï¼Œå¦‚æœå­˜åœ¨å‘é‡$p\\in S,q$ï¼Œä½¿å¾—$q\\perp S,b=p+q$ï¼Œåˆ™ç§°$p$æ˜¯$b$åœ¨å­ç©ºé—´$S$ä¸Šçš„æ­£äº¤æŠ•å½±å‘é‡ã€‚ è®¾$u_1,\\cdots ,u_n$ä¸º$S$çš„æ ‡å‡†æ­£äº¤åŸºï¼Œå¦‚æœ$p=\\sum_{i=1}^n(b,u_i)u_i$ï¼Œåˆ™ $b-p$ä¸$s$çš„ä»»æ„ä¸€ä¸ªå‘é‡æ­£äº¤ $p$æ˜¯$S$ä¸­å”¯ä¸€ä¸€ä¸ªæœ€æ¥è¿‘$b$çš„å‘é‡ã€‚ä¹Ÿå°±æ˜¯è¯´$\\forall y\\in S,y \\neq p$ï¼Œæœ‰$||y-b||\u003e||p-b||$ã€‚å‘é‡$p$æ˜¯$b$åœ¨å­ç©ºé—´$S$ä¸Šçš„æ­£äº¤æŠ•å½±å‘é‡ã€‚ æŠ•å½±çŸ©é˜µ è®¾$S$æ˜¯å†…ç§¯ç©ºé—´$F^n$çš„éé›¶å­ç©ºé—´ï¼Œ$b\\in F^n$ï¼Œ$u_1,\\cdots,u_n$ä¸º$S$çš„æ ‡å‡†æ­£äº¤åŸºï¼Œ$U={u_1,\\cdots,u_n}$ï¼Œåˆ™$b$åœ¨å­ç©ºé—´$S$çš„æ­£äº¤æŠ•å½±$p=UU^Hb$ï¼Œå…¶ä¸­$U$åˆ™æ˜¯æŠ•å½±çŸ©é˜µã€‚ ","date":"2023-12-01","objectID":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 2â€”å†…ç§¯ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 Gram-Schmidtæ­£äº¤åŒ–æ–¹æ³• è®¾$\\alpha_1,\\cdots,\\alpha_n$æ˜¯å‘é‡ç©ºé—´$V$çš„çº¿æ€§æ— å…³å‘é‡ç»„ã€‚æˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ ‡å‡†æ­£äº¤åŒ–å¾—åˆ°æ ‡å‡†æ­£äº¤å‘é‡ç»„$\\beta_1,\\cdots,\\beta_n$ å•ä½åŒ–å‘é‡$\\alpha_1$ï¼Œå¾—åˆ°$\\beta_1=\\frac{\\alpha_1}{||\\alpha_1||}$ã€‚æ˜“çŸ¥$span(\\alpha_1)=span(\\beta_1)$ã€‚ æ‰¾åˆ°$\\alpha_2$åœ¨$span(\\beta_1)$ä¸Šçš„å‘é‡æŠ•å½±$p_1=(\\alpha_2,\\beta_1)\\beta_1$ï¼Œæ ¹æ®æ¨å¯¼å¯çŸ¥$\\alpha_2-p_1$å’Œ$span(\\beta_1)$æ­£äº¤ã€‚æˆ‘ä»¬å¯¹å…¶å•ä½åŒ–å¾—åˆ°$\\beta_2=\\frac{\\alpha_2-p_1}{||\\alpha_2-p_1||}$ã€‚æ˜“å¾—$span(\\alpha_1,\\alpha_2)=span(\\beta_1,\\beta_2)$ã€‚ æ‰¾åˆ°$\\alpha_3$åœ¨$span(\\beta_1,\\beta_2)$ä¸Šçš„å‘é‡æŠ•å½±$p_2=(\\alpha_3,\\beta_1)\\beta_1+(\\alpha_3,\\beta_2)\\beta_2$ï¼Œæ ¹æ®æ¨å¯¼å¯çŸ¥$\\alpha_3-p_2$å’Œ$span(\\beta_1,\\beta_2)$æ­£äº¤ã€‚æˆ‘ä»¬å¯¹å…¶å•ä½åŒ–å¾—åˆ°$\\beta_3=\\frac{\\alpha_3-p_2}{||\\alpha_3-p_2||}$ã€‚æ˜“å¾—$span(\\alpha_1,\\alpha_2,\\alpha_3)=span(\\beta_1,\\beta_2,\\beta_3)$ã€‚ å¦‚ä¸Šè¿›è¡Œæ“ä½œï¼Œ$\\alpha_i$åœ¨$S_{i-1}=span(\\alpha_1,\\cdots,\\alpha_i)=span(\\beta_1,\\cdots,\\beta_i)$çš„å‘é‡æŠ•å½±$p_{i-1}=(\\alpha_i,\\beta_1)\\beta_1+\\cdots+(\\alpha_i,\\beta_{i-1})\\beta_{i-1}$ï¼Œåˆ™$\\alpha_i-p_{i-1}$å’Œ$S_{i-1}$æ­£äº¤ã€‚æ‰€ä»¥å¯¹å…¶å•ä½åŒ–å¾—åˆ°$\\beta_i=\\frac{\\alpha_i-p_{i-1}}{||\\alpha_i-p_{i-1}||}$ã€‚æ˜“å¾—$span(\\alpha_1,\\cdots,\\alpha_{i})=span(\\beta_1,\\cdots,\\beta_{i})$ã€‚ ç›´åˆ°æ±‚å¾—$\\beta_n$ï¼Œå¾—åˆ°æ ‡å‡†æ­£äº¤å‘é‡ç»„$\\beta_1,\\cdots,\\beta_n$ ","date":"2023-12-01","objectID":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 2â€”å†…ç§¯ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 æ­£äº¤å­ç©ºé—´ æ­£äº¤å­ç©ºé—´å®šä¹‰ $X,Y$æ˜¯å†…ç§¯ç©ºé—´$V$çš„å­ç©ºé—´ï¼Œå¦‚æœ$\\forall x\\in X,y\\in Y$ï¼Œ$(x,y)=0$ï¼Œåˆ™$X$å’Œ$Y$æ­£äº¤ï¼Œæˆ‘ä»¬è®°ä½œ$X\\perp Y$ã€‚ æ­£äº¤è¡¥å®šä¹‰ è®¾$Y$æ˜¯å†…ç§¯ç©ºé—´$V$çš„å­ç©ºé—´ï¼Œåˆ™$V$ä¸­ä¸$Y$çš„æ¯ä¸ªå‘é‡æ­£äº¤çš„æ‰€æœ‰å‘é‡ç§°ä¸º$Y^{\\perp}$ï¼Œ$Y^\\perp ={x\\in V|\\forall y\\in Y,(x,y)=0 }$ã€‚ æ­£äº¤å­ç©ºé—´å®šç† å¦‚æœ$V_1$å’Œ$V_2$æ­£äº¤ï¼Œåˆ™$V_1+V_2$çš„å’Œä¸ºç›´å’Œã€‚ æ­£äº¤è¡¥æ€§è´¨ è®¾$S$ä¸ºæœ‰é™ç»´å†…ç§¯ç©ºé—´$V$çš„å­ç©ºé—´ï¼Œåˆ™ï¼š $V=S\\oplus S^\\perp$ã€‚å¹¶ä¸”å¦‚æœ$V=S\\oplus W,W\\perp S$ï¼Œåˆ™$W=S^\\perp$ã€‚ $(S^{\\perp})^{\\perp}=S$ å‘é‡åˆ°å­ç©ºé—´çš„æœ€å°è·ç¦» è®¾$S$ä¸ºæœ‰é™ç»´å†…ç§¯ç©ºé—´$V$çš„å­ç©ºé—´ï¼Œ$\\forall b\\in V$ï¼Œåˆ™$S$ ä¸­çš„ç»™å®šå‘é‡ $p$ ä¸ç»™å®šå‘é‡$b$ æœ€æ¥è¿‘ï¼Œå½“ä¸”ä»…å½“$b-p\\perp S^{\\perp}$ã€‚å³$p$æ˜¯$b$åœ¨$S$ä¸Šçš„å‘é‡æŠ•å½±ã€‚ çŸ©é˜µçš„åŸºæœ¬å­ç©ºé—´ è®¾$A$ä¸º$m\\times n$çŸ©é˜µï¼Œåˆ™ $N(A)={x\\in F^n|Ax=0}$ï¼š$A$çš„é›¶ç©ºé—´ï¼Œ$F^n$çš„å­ç©ºé—´ã€‚ $R(A)={Ax|x\\in F^n}$ï¼š$A$çš„åˆ—ç©ºé—´ï¼Œ$F^m$çš„å­ç©ºé—´ã€‚ $N(A^H)$ï¼š$A^H$çš„é›¶ç©ºé—´ï¼Œ$F^m$çš„å­ç©ºé—´ã€‚ $R(A^H)$ï¼š$A^H$çš„åˆ—ç©ºé—´ï¼Œ$F^n$çš„å­ç©ºé—´ã€‚ $N(A)=R(A^H)^\\perp,N(A^h)=R(A)^\\perp$ $F^n=N(A)\\oplus N(A)^\\perp=N(A)\\oplus R(A^H)$ $\\dim(F^n)=\\dim(N(A))+\\dim(R(A^H))$ ","date":"2023-12-01","objectID":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 2â€”å†…ç§¯ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"5 æœ€å°äºŒä¹˜é—®é¢˜ é—®é¢˜å®šä¹‰ è®¾çº¿æ€§ç³»ç»Ÿ$Ax=b$ï¼Œå…¶ä¸­$A\\in F^{m\\times n}$ï¼Œå¯èƒ½ä¸ç›¸å®¹ï¼ˆæ— è§£ï¼‰ã€‚æˆ‘ä»¬èƒ½å¦æ‰¾åˆ°ä¸€ä¸ªæœ€ä½³è§£ï¼Œå³å‘é‡$\\hat{x}$ä½¿å¾—$A\\hat{x}-b=\\min_{x\\in F^n}||Ax-b||$ é—®é¢˜æ ¸å¿ƒ æ‰¾åˆ°å‘é‡$\\hat{x}$å³æ˜¯ä½¿å¾—$A\\hat{x}$ç­‰äº$b$åœ¨$R(A)$ä¸Šçš„å‘é‡æŠ•å½±ã€‚ æœ€å°äºŒä¹˜è§£ç­‰ä»·æ¡ä»¶ $\\hat{x}$æ˜¯$Ax=b$çš„æœ€å°äºŒä¹˜è§£ $A\\hat{x}-b=\\min_{x\\in F^n}||Ax-b||$ $A\\hat{x}$ç­‰äº$b$åœ¨$R(A)$ä¸Šçš„æ­£äº¤å‘é‡æŠ•å½± $A\\hat{x}-b\\in R(A)^\\perp =N(A^H)$ $A^H(A\\hat{x}-b)=0$ $A^HA\\hat{x}=A^Hb$ï¼ˆæ­£è§„æ–¹ç¨‹ï¼‰ æ­£è§„æ–¹ç¨‹çš„ç›¸å®¹æ€§ è®¾$A\\in F^{m\\times n}$ï¼Œåˆ™æ­£è§„æ–¹ç¨‹$A^HAx=A^Hb$æœ‰è§£ï¼Œå…¶ä¸º$Ax=b$çš„æœ€å°äºŒä¹˜è§£ã€‚ æœ€å°äºŒä¹˜è§£ä¸å”¯ä¸€ï¼Œä½†æ˜¯å¯¹äºä»»æ„è§£$x,y$ï¼Œ$Ax=Ay$ï¼Œä¸”$Ax$å’Œ$Ay$éƒ½æ˜¯$b$åœ¨$R(A)$ä¸Šçš„å‘é‡æŠ•å½±ã€‚ æœ€å°äºŒä¹˜è§£å”¯ä¸€è§£ è®¾$A\\in F^{m\\times n}$ï¼Œä¸”$rank(A)=n$ï¼ˆåˆ—æ»¡ç§©ï¼‰ï¼Œ$b\\in F^n$ï¼Œåˆ™æ­£è§„æ–¹ç¨‹$A^HAx=A^Hb$æœ‰å”¯ä¸€è§£$\\hat{x}=(A^HA)^{-1}A^Hb$ã€‚$\\hat{x}$ä¸º$Ax-b$çš„å”¯ä¸€æœ€å°äºŒä¹˜è§£ã€‚ ","date":"2023-12-01","objectID":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/:5:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 2â€”å†…ç§¯ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"6 æ­£äº¤çŸ©é˜µå’Œé…‰çŸ©é˜µ æ­£äº¤çŸ©é˜µå®šä¹‰ è®¾$A\\in R^{n\\times n}$ï¼Œ$A$çš„æ‰€æœ‰åˆ—å‘é‡æ„æˆ$R^n$çš„æ ‡å‡†æ­£äº¤é›†ï¼Œå…·æœ‰$R^n$ä¸Šçš„æ ‡å‡†å†…ç§¯ã€‚ é…‰çŸ©é˜µå®šä¹‰ è®¾$A\\in C^{n\\times n}$ï¼Œ$A$çš„æ‰€æœ‰åˆ—å‘é‡æ„æˆ$C^n$çš„æ ‡å‡†æ­£äº¤é›†ï¼Œå…·æœ‰$C^n$ä¸Šçš„æ ‡å‡†å†…ç§¯ã€‚ æ˜“çŸ¥ï¼Œæ­£äº¤çŸ©é˜µä¹Ÿæ˜¯é…‰çŸ©é˜µã€‚ æ­£äº¤çŸ©é˜µå’Œé…‰çŸ©é˜µçš„å……è¦æ¡ä»¶ $A$æ˜¯æ­£äº¤çŸ©é˜µå½“ä¸”ä»…å½“$A^TA=I$ $A$æ˜¯é…‰çŸ©é˜µå½“ä¸”ä»…å½“$A^HA=I$ è‹¥$A\\in C^{n\\times n}$ï¼Œåˆ™ä»¥ä¸‹æ¡ä»¶ç­‰ä»· $A$æ˜¯é…‰çŸ©é˜µ $A$çš„åˆ—å‘é‡æ„æˆ$C^n$çš„æ ‡å‡†æ­£äº¤é›† $A^HA=I$ $A^{-1}=A^H$ $\\forall x,y \\in C^n,(Ax,Ay)=(x,y)$ $\\forall x\\in C^n,(Ax,Ax)=(x,x)$ ","date":"2023-12-01","objectID":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/:6:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 2â€”å†…ç§¯ç©ºé—´çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/02.%E5%86%85%E7%A7%AF%E7%A9%BA%E9%97%B4/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 çº¿æ€§æ˜ å°„åŠå…¶çŸ©é˜µè¡¨ç¤º æ˜ å°„å®šä¹‰ è®¾$A,B$æ˜¯ä¸¤ä¸ªé›†åˆï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªè§„åˆ™$f$ï¼Œä½¿å¾—å¯¹äº$A$ä¸­çš„å…ƒç´ $x$éƒ½æœ‰$B$ä¸­å”¯ä¸€çš„å…ƒç´ $y$ä¸ä¹‹å¯¹åº”ï¼Œåˆ™ç§°$f$æ˜¯ä»$A$åˆ°$B$çš„æ˜ å°„ï¼Œè®°ä½œï¼š$f:A\\rightarrow B$ã€‚åœ¨æ˜ å°„$f:A\\rightarrow B$ä¸­ï¼Œ$A$çš„å…ƒç´ $x$è¢«æ˜ å°„åˆ°$B$çš„å…ƒç´ $y$ï¼Œæˆ‘ä»¬é€šå¸¸å†™ä½œ$f(x)=y$ï¼Œ å¦‚æœ$\\forall x_1,x_2\\in A,x_1\\neq x_2,f(x_1)\\neq f(x_2)$ï¼Œåˆ™ç§°æ˜ å°„$f:A\\rightarrow B$æ˜¯å•å°„çš„ï¼› å¦‚æœ$\\forall y\\in B,\\exist x\\in A,f(x)=y$ï¼Œåˆ™ç§°æ˜ å°„$f:A\\rightarrow B$æ˜¯æ»¡å°„çš„ï¼› å¦‚æœæ˜ å°„$f:A\\rightarrow B$æ—¢æ»¡è¶³å•å°„åˆæ»¡è¶³æ»¡å°„ï¼Œåˆ™ç§°æ˜ å°„$f:A\\rightarrow B$æ˜¯åŒå°„çš„ã€‚ çº¿æ€§æ˜ å°„å®šä¹‰ è®¾$V,W$æ˜¯åœ¨æ•°åŸŸ$F$ä¸Šçš„å‘é‡ç©ºé—´ï¼Œå¦‚æœ$\\forall v_1,v_2\\in V,\\forall \\alpha_1,\\alpha_2\\in F$æœ‰$\\sigma(\\alpha_1v_1+\\alpha_2v_2)=\\alpha_1\\sigma(v_1)+\\alpha_2\\sigma(v_2)$ï¼Œåˆ™ä»$V$åˆ°$W$çš„æ˜ å°„$\\sigma$ç§°ä¸ºçº¿æ€§æ˜ å°„ã€‚ çº¿æ€§æ˜ å°„å®šç† è®¾$\\sigma,\\gamma$æ˜¯çº¿æ€§ç©ºé—´$V$åˆ°$W$çš„çº¿æ€§æ˜ å°„ï¼Œåˆ™ï¼š $\\sigma(0)=0$ $\\forall x\\in V_1,\\sigma(-x)=-\\sigma(x)$ å¦‚æœ$x_1,\\cdots,x_n$æ˜¯$V_1$çš„ä¸€ç»„å‘é‡ï¼Œ$k_1,\\cdots,k_n\\in F$ï¼Œåˆ™æœ‰ $\\sigma(k_1x_1+\\cdots+k_nx_n)=k_1\\sigma(x_1)+\\cdots+k_n\\sigma(x_n)$ å¦‚æœ$x_1,\\cdots,x_n$æ˜¯$V_1$çš„ä¸€ç»„çº¿æ€§ç›¸å…³å‘é‡ï¼Œåˆ™$\\sigma(x_1),\\cdots,\\sigma(x_n)$æ˜¯$V_2$ä¸­çš„ä¸€ç»„çº¿æ€§ç›¸å…³å‘é‡ï¼›å¹¶ä¸”å½“ä¸”ä»…å½“$\\sigma$æ˜¯ä¸€ä¸€æ˜ å°„æ—¶ï¼Œ$V_1$ä¸­çš„çº¿æ€§æ— å…³å‘é‡ç»„çš„åƒï¼ˆåƒå³æ˜¯çº¿æ€§æ˜ å°„çš„å€¼åŸŸï¼‰æ˜¯$V_2$ä¸­çš„çº¿æ€§æ— å…³å‘é‡ç»„ã€‚ å¦‚æœ$v_1,\\cdots,v_n$æ˜¯$V$çš„ä¸€ç»„åŸºï¼Œä¸”$\\sigma(v_i)=\\gamma(v_i)(1\\leq i\\leq n)$ï¼Œåˆ™$\\sigma=\\gamma$ã€‚è¯´æ˜çº¿æ€§æ˜ å°„ç”±åŸºåƒç»„å”¯ä¸€ç¡®å®šã€‚ çº¿æ€§æ˜ å°„è¿ç®— è®¾$V_1$åˆ°$V_2$çš„æ‰€æœ‰çº¿æ€§æ˜ å°„ç»„æˆçš„é›†åˆè®°ä¸º$\\varphi(V_1,V_2)$ï¼Œç±»ä¼¼åœ°ï¼Œ$\\varphi(V_1,V_3),\\varphi(V_2,V_3)$åˆ†åˆ«è¡¨ç¤º$V_1$åˆ°$V_3$çš„æ‰€æœ‰çº¿æ€§æ˜ å°„ç»„æˆçš„é›†åˆå’Œ$V_2$åˆ°$V_3$çš„æ‰€æœ‰çº¿æ€§æ˜ å°„ç»„æˆçš„é›†åˆ è®¾$\\sigma,\\gamma \\in \\varphi(V_1,V_2)$ï¼Œå®šä¹‰å®ƒä»¬çš„å’Œ$\\sigma+\\gamma$ä¸º$(\\sigma+\\gamma)(x)=\\sigma(x)+\\gamma(x),\\forall x\\in V_1$ã€‚ $\\sigma,\\gamma \\in \\varphi(V_1,V_2)$ï¼Œåˆ™$\\sigma+\\gamma \\in \\varphi(V_1,V_2)$ $\\sigma\\in \\varphi(V_1,V_2),\\gamma \\in \\varphi(V_2,V_3)$ï¼Œåˆ™$\\sigma \\gamma \\in \\varphi(V_1,V_2)$ çº¿æ€§æ˜ å°„çš„åŠ æ³•é€‚åˆäº¤æ¢å¾‹å’Œç»“åˆå¾‹ï¼Œä¹˜æ³•é€‚åˆç»“åˆå¾‹ï¼Œæ ‡é‡ä¹˜æ³•é€‚åˆç»“åˆå¾‹ï¼Œåˆ†é…å¾‹ã€‚ é‡è¦å®šç† è®¾$\\sigma \\in \\varphi(V_1,V_2)$ï¼Œå¦‚æœ$\\sigma$æ˜¯å¯é€†æ˜ å°„ï¼Œåˆ™$\\sigma^{-1}\\in \\varphi(V_2,V_1)$ã€‚ çº¿æ€§æ˜ å°„çš„çŸ©é˜µè¡¨ç¤º è®¾$\\sigma:U\\rightarrow V$æ˜¯ä¸€ä¸ªçº¿æ€§æ˜ å°„ï¼Œ$[u_1,\\cdots,u_n]$æ˜¯$U$çš„ä¸€ç»„åŸºï¼Œ$\\sigma$å®Œå…¨ç”±$\\sigma(u_1),\\cdots,\\sigma(u_n)$ç¡®å®šï¼Œå¦‚æœ$u=x_1u_1+\\cdots,x_nu_n$ï¼Œåˆ™$\\sigma(u)=x_1\\sigma(u_1)+\\cdots+x_n\\sigma(u_n)$ã€‚ è®¾$v_1,\\cdots,v_m$æ˜¯$V$çš„ä¸€ç»„åŸºï¼Œåˆ™ æ•…$[\\sigma(u_1),\\cdots,\\sigma(u_n)]=[v_1,\\cdots,v_m]A$ï¼Œå…¶ä¸­ã€‚ çŸ©é˜µ$A$ç§°ä¸ºçº¿æ€§æ˜ å°„$\\sigma$åœ¨$U$çš„åŸº$[u_1,\\cdots,u_n]$å’Œ$V$çš„åŸº$[v_1,\\cdots,v_n]$ä¸‹çš„è¡¨ç¤ºçŸ©é˜µã€‚ é‡è¦å®šç† è®¾è®¾$\\sigma$ä¸ºæ•°åŸŸ$F$ä¸Šçº¿æ€§ç©ºé—´$U$åˆ°$V$çš„çº¿æ€§æ˜ å°„ï¼Œå…¶ä¸­$u_1,\\cdots,u_n$æ˜¯$U$çš„ä¸€ç»„åŸºï¼Œ$v_1,\\cdots,v_m$æ˜¯$V$çš„ä¸€ç»„åŸºï¼Œ$\\sigma$åœ¨è¿™å¯¹åŸºä¸‹çš„çŸ©é˜µæ˜¯$A$ï¼Œ$\\forall \\alpha =\\sum_{i=1}^nx_iu_i$ï¼Œæœ‰$\\sigma(\\alpha)=\\sum_{i=1}^my_iv_i$ï¼Œåˆ™$[y_i,\\cdots,y_m]^T=A[x_1,\\cdots,x_n]$ã€‚ çº¿æ€§æ˜ å°„åœ¨ä¸åŒåŸºä¸‹çš„çŸ©é˜µä¹‹é—´çš„å…³ç³» åŒä¸€ä¸ªçº¿æ€§æ˜ å°„åœ¨ä¸åŒåŸºä¸‹çš„çŸ©é˜µä¸€èˆ¬æ˜¯ä¸åŒçš„ è®¾$\\sigma$ä¸ºæ•°åŸŸ$F$ä¸Š$n$ç»´çº¿æ€§ç©ºé—´$U$åˆ°$n$ç»´çº¿æ€§ç©ºé—´$V$çš„çº¿æ€§æ˜ å°„ï¼Œå…¶ä¸­$u_1,\\cdots,u_n$å’Œ$u_1â€™,\\cdots,uâ€™_n$æ˜¯$U$çš„ä¸¤ç»„åŸºï¼Œç”±$u_1,\\cdots,u_n$åˆ°$u_1â€™,\\cdots,uâ€™_n$çš„è¿‡æ¸¡çŸ©é˜µæ˜¯$Q$ï¼Œ$v_1,\\cdots,v_m$å’Œ$v_1â€™,\\cdots,v_mâ€™$æ˜¯$V$çš„ä¸¤ç»„åŸºï¼Œç”±$v_1,\\cdots,v_m$åˆ°$v_1â€™,\\cdots,v_mâ€™$çš„è¿‡æ¸¡çŸ©é˜µæ˜¯$P$ï¼Œ$\\sigma$åœ¨åŸº$u_1,\\cdots,u_n$ä¸åŸº$v_1,\\cdots,v_m$ä¸‹çš„çŸ©é˜µæ˜¯$A$ï¼Œè€Œåœ¨åŸº$u_1â€™,\\cdots,uâ€™_n$ä¸åŸº$v_1â€™,\\cdots,v_mâ€™$çš„çŸ©é˜µä¸º$B$ï¼Œåˆ™$B=P^{-1}AQ$ã€‚ æ¨å¯¼ï¼š å› ä¸ºï¼š åˆ™æŠŠå¼å­ä»£å…¥å¾—åˆ°ï¼š å› ä¸ºçº¿æ€§æ˜ å°„$\\sigma$çš„çŸ©é˜µç”±åŸºå”¯ä¸€ç¡®å®šï¼Œæ‰€ä»¥$B=P^{-1}AQ$ã€‚ ç›¸æŠµ è®¾$A,B\\in F^{m\\times n}$ï¼Œå¦‚æœå­˜åœ¨æ•°åŸŸ$F$ä¸Šçš„$m$é˜¶éå¥‡å¼‚çŸ©é˜µ$P$å’Œ$n$é˜¶éå¥‡å¼‚çŸ©é˜µ$Q$ä½¿å¾—$B=PAQ$ï¼Œåˆ™ç§°$A$ä¸$B$ç›¸æŠµï¼ˆç­‰ä»·ï¼‰ã€‚ å¦‚æœ$A$ä¸$B$ç›¸æŠµï¼Œåˆ™å®ƒä»¬å¯ä½œä¸º$n$ç»´çº¿æ€§ç©ºé—´$U$åˆ°$m$ç»´çº¿æ€§ç©ºé—´$V$çš„åŒä¸€çº¿æ€§æ˜ å°„åœ¨ä¸¤å¯¹åŸºæ‰€å¯¹åº”çš„çŸ©é˜µã€‚ ç›¸æŠµçš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯å®ƒä»¬æœ‰ç›¸åŒçš„ç§©ã€‚ ","date":"2023-12-01","objectID":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 3â€”çº¿æ€§æ˜ å°„å’Œçº¿æ€§å˜æ¢çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 çº¿æ€§æ˜ å°„çš„å€¼åŸŸï¼ˆåƒï¼‰å’Œæ ¸ å€¼åŸŸï¼ˆåƒï¼‰å’Œæ ¸çš„å®šä¹‰ è®¾$\\sigma$ä¸ºæ•°åŸŸ$F$ä¸Šçº¿æ€§ç©ºé—´$U$åˆ°$V$çš„çº¿æ€§æ˜ å°„ï¼Œä»¤$R(\\sigma)=I_m(\\sigma)={\\sigma(x)| x\\in U}$ï¼Œ$Ker(\\sigma)=N(\\sigma)={x\\in U|\\sigma(x)=0}$ã€‚ ç§°$R(\\sigma)$æ˜¯çº¿æ€§æ˜ å°„$\\sigma$çš„å€¼åŸŸï¼ˆä¹Ÿç§°åƒï¼‰ï¼Œ$Ker(\\sigma)$æ˜¯çº¿æ€§æ˜ å°„$\\sigma$çš„æ ¸ã€‚ æ˜“çŸ¥$R(\\sigma)$æ˜¯$V$çš„ä¸€ä¸ªå­ç©ºé—´ï¼Œ$Ker(\\sigma)$æ˜¯$U$çš„ä¸€ä¸ªå­ç©ºé—´ã€‚ å€¼åŸŸï¼ˆåƒï¼‰å’Œæ ¸ç†è§£ å€¼åŸŸï¼ˆåƒï¼‰æ˜¯æ˜ å°„æ‰€èƒ½åˆ°çš„ç©ºé—´ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰åœ¨æ˜ å°„è¿‡ç¨‹ä¸­çœŸå®æ˜ å°„åˆ°çš„ç‚¹ï¼Œæè¿°äº†æ˜ å°„çš„è¦†ç›–èŒƒå›´ã€‚å€¼åŸŸï¼ˆåƒï¼‰æ˜¯ç›®æ ‡ç©ºé—´ $W$çš„ä¸€ä¸ªå­ç©ºé—´ã€‚ æ ¸æ˜¯æ˜ å°„çš„é›¶ç©ºé—´ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰è¢«æ˜ å°„åˆ°é›¶çš„è¾“å…¥å‘é‡ï¼Œæè¿°äº†æ˜ å°„çš„éå•å°„æ€§ï¼Œå³å­˜åœ¨æ˜ å°„åˆ°åŒä¸€ä¸ªå…ƒç´ çš„ä¸åŒè¾“å…¥ã€‚æ ¸æ˜¯å®šä¹‰åœ¨$V$ä¸Šçš„ä¸€ä¸ªå­ç©ºé—´ã€‚ å®šç† è®¾$\\sigma$ä¸ºæ•°åŸŸ$F$ä¸Š$n$ç»´çº¿æ€§ç©ºé—´$U$åˆ°$n$ç»´çº¿æ€§ç©ºé—´$V$çš„çº¿æ€§æ˜ å°„ï¼Œå…¶ä¸­$u_1,\\cdots,u_n$æ˜¯$U$çš„ä¸€ç»„åŸºï¼Œ$v_1,\\cdots,v_m$æ˜¯$V$çš„ä¸€ç»„åŸºï¼Œ$\\sigma$åœ¨è¿™å¯¹åŸºä¸‹çš„çŸ©é˜µæ˜¯$A$ï¼Œåˆ™ $R(\\sigma)=span(\\sigma(u_1),\\cdots,\\sigma(u_n))$ $rank(\\sigma)=rank(A)$ $dim(R(\\sigma))+dim(Ker(\\sigma))=n$ ä¸€èˆ¬æ±‚æ³• $R(\\sigma)=R[x])_3$ $Ker(\\sigma)={0}$ ","date":"2023-12-01","objectID":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 3â€”çº¿æ€§æ˜ å°„å’Œçº¿æ€§å˜æ¢çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 çº¿æ€§å˜æ¢ å®šä¹‰ è®¾$V$æ˜¯æ•°åŸŸ$F$ä¸Šçš„çº¿æ€§ç©ºé—´ï¼Œ$V$åˆ°è‡ªèº«çš„çº¿æ€§æ˜ å°„ç§°ä¸º$V$ä¸Šçš„çº¿æ€§å˜æ¢ã€‚ $n$ç»´çº¿æ€§ç©ºé—´$V$ä¸Šçš„çº¿æ€§å˜æ¢ä¸çŸ©é˜µä¹‹é—´çš„å…³ç³» è®¾$\\sigma$æ˜¯åœ¨$V$ä¸Šçš„çº¿æ€§å˜æ¢ï¼Œ$v_1,\\cdots,v_n$æ˜¯ä¸€ç»„åŸºï¼Œåˆ™ æ•…$[\\sigma(v_1),\\cdots,\\sigma(v_n)]=[v_1,\\cdots,v_m]A$ï¼Œå…¶ä¸­ã€‚çŸ©é˜µ$A$ç§°ä¸ºçº¿æ€§å˜æ¢$\\sigma$åœ¨$U$çš„åŸº$[v_1,\\cdots,v_n]$ä¸‹çš„è¡¨ç¤ºçŸ©é˜µã€‚ é‡è¦å®šç† è®¾$n$ç»´çº¿æ€§ç©ºé—´$V$ä¸Šçº¿æ€§å˜æ¢$\\sigma$åœ¨åŸº$v_1,\\cdots,v_n$å’Œ$v_1â€™,\\cdots,v_nâ€™$ä¸‹çš„çŸ©é˜µåˆ†åˆ«ä¸º$A$å’Œ$B$ï¼Œç”±åŸº$v_1,\\cdots,v_n$åˆ°åŸº$v_1â€™,\\cdots,v_nâ€™$çš„è¿‡æ¸¡çŸ©é˜µä¸º$P$ï¼Œåˆ™$B=P^{-1}AP$ æ¨å¯¼ï¼š å› ä¸º åˆ™ä»£å…¥å¾—åˆ° æ‰€ä»¥$AP=PB$ï¼Œå·¦ä¹˜$P^{-1}$ï¼Œå¾—$B=P^{-1}AP$ã€‚ ç›¸ä¼¼ è®¾$A,B\\in F^{m\\times n}$ï¼Œå¦‚æœå­˜åœ¨å¯é€†çŸ©é˜µ$P\\in F^{n\\times n}$ä½¿å¾—$B=P^{-1}AB$ï¼Œåˆ™ç§°$A$ä¸$B$ç›¸ä¼¼ã€‚ ","date":"2023-12-01","objectID":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 3â€”çº¿æ€§æ˜ å°„å’Œçº¿æ€§å˜æ¢çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 é…‰å˜æ¢å’Œæ­£äº¤å˜æ¢ å®šä¹‰ è®¾$V$æ˜¯$n$ç»´é…‰ï¼ˆæ¬§å¼ï¼‰ç©ºé—´ï¼ˆä¸€ä¸ªåœ¨å¤æ•°ï¼ˆå®æ•°ï¼‰åŸŸä¸Šçš„å†…ç§¯ç©ºé—´ï¼‰ï¼Œ$\\sigma:V\\rightarrow V$æ˜¯çº¿æ€§å˜æ¢ï¼Œå¦‚æœ $$ \\forall x\\in V,||\\sigma(x)||=||x|| $$ $\\sigma$å°±ç§°ä¸ºé…‰ï¼ˆæ­£äº¤ï¼‰å˜æ¢ å®šç† è®¾$V$æ˜¯$n$ç»´é…‰ï¼ˆæ¬§å¼ï¼‰ç©ºé—´ï¼ˆä¸€ä¸ªåœ¨å¤æ•°ï¼ˆå®æ•°ï¼‰åŸŸä¸Šçš„å†…ç§¯ç©ºé—´ï¼‰ï¼Œå¦‚æœ$\\sigma:V\\rightarrow V$æ˜¯é…‰ï¼ˆæ­£äº¤ï¼‰å˜æ¢ï¼Œåˆ™ $$ \\forall x,y\\in V,(\\sigma(x),\\sigma(y))\u003e=(x,y) $$ å³é…‰ï¼ˆæ­£äº¤å˜æ¢ï¼‰ä¿æŒå‘é‡çš„å†…ç§¯ã€‚ å¦‚æœ$v_1,\\cdots,v_n$æ˜¯$V$çš„ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºï¼Œåˆ™$\\sigma(v_1),\\cdots,\\sigma(v_n)$ä¹Ÿæ˜¯$V$çš„ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºã€‚ $\\sigma$åœ¨$V$çš„ä»»æ„ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºä¸‹çš„çŸ©é˜µæ˜¯é…‰ï¼ˆæ­£äº¤ï¼‰çŸ©é˜µã€‚ è®¾$v=[v_1,\\cdots,v_n]$æ˜¯é…‰ï¼ˆæ¬§å¼ï¼‰ç©ºé—´$V$çš„ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºï¼Œ$A$ç»´$\\sigma: V\\rightarrow V$åœ¨åŸº$v$çš„è¡¨ç¤ºçŸ©é˜µä¸º$A$ï¼Œåˆ™$\\sigma$æ˜¯ä¸€ä¸ªé…‰ï¼ˆæ­£äº¤ï¼‰å˜æ¢å½“ä¸”ä»…å½“$A^HA=I(A^T=I)$ã€‚ å³ï¼Œ$A$çš„åˆ—å‘é‡ç»„æˆäº†$C^{n}(R^n)$çš„æ ‡å‡†æ­£äº¤åŸºã€‚ ","date":"2023-12-01","objectID":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 3â€”çº¿æ€§æ˜ å°„å’Œçº¿æ€§å˜æ¢çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"5 åŒæ€å’ŒåŒæ„ å®šä¹‰ è®¾$V$å’Œ$W$æ˜¯åœ¨ç›¸åŒæ•°åŸŸ$F$ä¸Šçš„ä¸¤ä¸ªå‘é‡ç©ºé—´ï¼Œ$\\sigma:V\\rightarrow W$æ˜¯çº¿æ€§å˜æ¢ï¼ˆä¹Ÿç§°ä¸ºåŒæ€ï¼‰ã€‚å¦‚æœ$\\sigma$æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œåˆ™ç§°ä¸ºåŒæ„ã€‚ å¦‚æœå­˜åœ¨ä»$V$åˆ°$W$çš„åŒæ„ï¼Œåˆ™ç§°$V$ä¸$W$åŒæ„ã€‚ å¯¹äºåŒæ„$\\sigma: V\\rightarrow W,ker(\\sigma)={0} \\space and \\space \\sigma(V)=W$ã€‚ å®šç† è®¾$V$å’Œ$W$æ˜¯åœ¨ç›¸åŒæ•°åŸŸ$F$ä¸Šçš„ä¸¤ä¸ªå‘é‡ç©ºé—´ï¼Œ$\\sigma$æ˜¯ä»$V$åˆ°$W$çš„åŒæ„ï¼Œ$S$ä¸º$V$çš„å­ç©ºé—´ï¼Œåˆ™$\\dim(S)=\\dim(\\sigma(S))$ã€‚å³ï¼Œä¸¤ä¸ªåŒæ„ç©ºé—´æœ‰ç›¸åŒçš„ç»´æ•°ï¼ˆå……è¦æ¡ä»¶ï¼‰ã€‚ è®¾$\\sigma$æ˜¯ä»$V$åˆ°$W$çš„åŒæ„ï¼Œåˆ™$\\sigma^{-1}$æ˜¯ä»$W$åˆ°$V$çš„åŒæ„ æ•°åŸŸ $F$ ä¸Šä»»æ„ä¸€ä¸ª $n$ç»´ å‘é‡ç©ºé—´$V$åŒæ„äºå‘é‡ç©ºé—´ $F^n$ã€‚ æ€§è´¨ åŒæ„å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š è‡ªåæ€§ å¯¹ç§°æ€§ ä¼ é€’æ€§ ","date":"2023-12-01","objectID":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/:5:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 3â€”çº¿æ€§æ˜ å°„å’Œçº¿æ€§å˜æ¢çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"6 ä¸å˜å­ç©ºé—´ å®šä¹‰ è®¾$\\sigma:V\\rightarrow V$æ˜¯çº¿æ€§å˜æ¢ï¼Œå¦‚æœ$V$çš„å­ç©ºé—´$S$æ»¡è¶³$\\forall x\\in S, \\sigma(x)\\in S$ï¼Œå³$\\sigma(x)\\subset S$ï¼Œåˆ™ç§°$S$æ˜¯ä¸€ä¸ªä¸å˜å­ç©ºé—´ã€‚ å½“è¯´åˆ°ä¸å˜å­ç©ºé—´æ—¶ï¼Œè¦æŒ‡æ˜æ˜¯åœ¨ä»€ä¹ˆæ˜ å°„ä¸‹æ˜¯ä¸å˜çš„ã€‚åˆ©ç”¨$\\sigma$-ä¸å˜å­ç©ºé—´ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–$\\sigma$çš„è¡¨ç¤ºçŸ©é˜µã€‚ çŸ©é˜µçš„ä¸å˜å­ç©ºé—´ è®¾$A\\in F^{n\\times n}$ï¼Œ$\\sigma_A:F^n\\rightarrow F^n$è¢«å®šä¹‰ä¸ºï¼š$\\sigma_A(x)=Ax$ï¼Œ$F^n$çš„å­ç©ºé—´$S$å¦‚æœæ»¡è¶³$\\forall x\\in S, Ax\\in S$ï¼Œåˆ™ç§°$S$æ˜¯$\\sigma $-ä¸å˜å­ç©ºé—´ã€‚ å®šç† è®¾$\\sigma:V\\rightarrow V$æ˜¯çº¿æ€§å˜æ¢ï¼Œåˆ™ä¸¤ä¸ª$\\sigma$-ä¸å˜å­ç©ºé—´çš„äº¤ã€å’Œã€ç›´å’Œä¹Ÿæ˜¯$\\sigma$-ä¸å˜å­ç©ºé—´ã€‚ è®¾$\\sigma$æ˜¯åœ¨å‘é‡ç©ºé—´$V$ä¸Šçš„çº¿æ€§å˜æ¢ï¼Œ$W=span{x_1,\\cdots,x_k}$æ˜¯$V$çš„$\\sigma$-ä¸å˜å­ç©ºé—´å½“ä¸”ä»…å½“$\\sigma(x_i)\\in W(i=1,2,\\cdots,k)$ã€‚ è®¾$\\sigma$æ˜¯æ•°åŸŸ$F$ä¸Š$n$ç»´å‘é‡ç©ºé—´$V$ä¸Šçš„çº¿æ€§å˜æ¢ï¼Œåˆ™$\\sigma$å¯ä»¥å¯¹è§’åŒ–çš„å……è¦æ¡ä»¶æ˜¯$V$å¯ä»¥åˆ†è§£æˆ$\\sigma$çš„ä¸€ç»´ä¸å˜å­ç©ºé—´çš„ç›´å’Œã€‚ è®¾$\\sigma$æ˜¯æ•°åŸŸ$F$ä¸Š$n$ç»´å‘é‡ç©ºé—´$V$ä¸Šçš„çº¿æ€§å˜æ¢ï¼Œåˆ™$\\sigma$åœ¨$V$çš„ä¸€ç»„åŸºä¸‹çš„çŸ©é˜µä¸ºå½¢å¦‚ çš„å—ä¸Šä¸‰è§’çŸ©é˜µçš„å……è¦æ¡ä»¶æ˜¯$\\sigma$çš„éå¹³å‡¡çš„ä¸å˜å­ç©ºé—´ã€‚ è®¾$\\sigma$æ˜¯æ•°åŸŸ$F$ä¸Š$n$ç»´å‘é‡ç©ºé—´$V$ä¸Šçš„çº¿æ€§å˜æ¢ï¼Œåˆ™$\\sigma$åœ¨$V$çš„ä¸€ç»„åŸºä¸‹çš„çŸ©é˜µä¸ºå—å¯¹è§’å·¨å¥½ç€å‘¢çš„å……è¦æ¡ä»¶æ˜¯$V$å¯ä»¥åˆ†è§£æˆ$\\sigma$çš„è‹¥å¹²ä¸ªéå¹³å‡¡ä¸å˜å­ç©ºé—´çš„ç›´å’Œã€‚ ","date":"2023-12-01","objectID":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/:6:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 3â€”çº¿æ€§æ˜ å°„å’Œçº¿æ€§å˜æ¢çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/03.%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ å®šä¹‰ è®¾$\\sigma$ä¸ºæ•°åŸŸ$F$ä¸Šçº¿æ€§ç©ºé—´$V$ä¸Šçš„ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œä¸€ä¸ªéé›¶å‘é‡$v\\in V$ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ª$\\lambda \\in F$ä½¿å¾—$\\sigma(v)=\\lambda v$ï¼Œåˆ™$\\lambda$ç§°ä¸º$\\sigma$çš„ç‰¹å¾å€¼ã€‚$\\sigma$çš„ç‰¹å¾å€¼çš„é›†åˆç§°ä¸º$\\sigma$çš„è°±ã€‚å¹¶ç§°$v$ä¸º$\\sigma$çš„å±äºï¼ˆæˆ–å¯¹åº”äºï¼‰ç‰¹å¾å€¼$\\lambda $çš„ç‰¹å¾å‘é‡ã€‚ ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çš„æ±‚æ³• è®¾$V$æ˜¯æ•°åŸŸ$F$ä¸Šçš„$n$ç»´çº¿æ€§ç©ºé—´ï¼Œ$v_1,\\cdots,v_n$æ˜¯$V$çš„ä¸€ç»„åŸºï¼Œçº¿æ€§å˜æ¢$\\sigma$åœ¨è¿™ç»„åŸºä¸‹çš„çŸ©é˜µä¸º$A$ï¼Œå¦‚æœ$\\lambda$æ˜¯$\\sigma$çš„ç‰¹å¾å€¼ï¼Œ$\\alpha$æ˜¯ç›¸åº”çš„ç‰¹å¾å‘é‡ã€‚åˆ™ å°†ä¸Šå¼ä»£å…¥$\\sigma(v)=\\lambda v$å¾—åˆ° ç”±äº$v_1,\\cdots,v_n$çº¿æ€§æ— å…³ï¼Œæ‰€ä»¥ åˆ™è¯´æ˜ç‰¹å¾å‘é‡$\\alpha$çš„åæ ‡æ»¡è¶³é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„$(\\lambda I-A)x=0$ã€‚ å› ä¸º$\\alpha\\neq 0$ï¼Œåˆ™$x\\neq 0$ï¼Œå³é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„$(\\lambda I-A)x=0$æœ‰éé›¶è§£ã€‚æœ‰éé›¶è§£çš„å……è¦æ¡ä»¶æ˜¯å®ƒçš„ç³»æ•°çŸ©é˜µå®ƒçš„ç³»æ•°çŸ©é˜µè¡Œåˆ—å¼$|\\lambda I-A|=0$ã€‚ ç›¸å…³å®šä¹‰ è®¾$A$æ˜¯æ•°åŸŸ$F$ä¸Šçš„$n$é˜¶çŸ©é˜µï¼Œ$\\lambda$æ˜¯ä¸€ä¸ªç¬¦å·ï¼Œä¹Ÿæ˜¯æœªçŸ¥çš„ç‰¹å¾å€¼ï¼ŒçŸ©é˜µ$\\lambda I-A$ç§°ä¸º$A$çš„ç‰¹å¾çŸ©é˜µï¼Œå…¶è¡Œåˆ—å¼$|\\lambda I-A|$ç§°ä¸º$A$çš„ç‰¹å¾å¤šé¡¹å¼ã€‚æ–¹ç¨‹$|\\lambda I-A|=0$ç§°ä¸º$A$çš„ç‰¹å¾æ–¹ç¨‹ï¼Œå®ƒçš„æ ¹ï¼ˆå³$\\lambda$çš„å€¼ï¼‰ç§°ä¸º$A$çš„ç‰¹å¾æ ¹ï¼ˆæˆ–ç‰¹å¾å€¼ï¼‰ã€‚ä»¥$A$çš„ç‰¹å¾å€¼$\\lambda$ä»£å…¥$Ax=\\lambda x$ä¸­æ‰€å¾—åˆ°çš„éé›¶è§£$x$ç§°ä¸º$A$å¯¹åº”äº$\\lambda$çš„ç‰¹å¾å‘é‡ã€‚ å®šç† è®¾$A$ä¸º$n\\times n$çŸ©é˜µï¼Œ$\\lambda$æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œä»¥ä¸‹å‘½é¢˜ç­‰ä»·ï¼š $\\lambda$æ˜¯$A$çš„ç‰¹å¾å€¼ $(\\lambda I-A)x=0$æœ‰ä¸€ä¸ªéå¹³å‡¡çš„è§£ï¼ˆå³æœ‰éé›¶å‘é‡çš„è§£ï¼‰ $N(\\lambda I-A)\\neq{0}$ $\\lambda I-A$çŸ©é˜µæ˜¯å¥‡å¼‚çŸ©é˜µ $\\det(\\lambda I-A)=0$ ç‰¹å¾å¤šé¡¹å¼çš„ç³»æ•° å¦‚æœ åˆ™$c_k(1\\leq k\\leq n)$æ˜¯æ‰€æœ‰$k$é˜¶ä¸»å­å¼ï¼ˆé€‰æ‹©$k$è¡Œ$k$åˆ—å½¢æˆçš„è¡Œåˆ—å¼ï¼‰çš„å’Œï¼Œç‰¹åˆ«çš„ï¼Œ$c_1=\\text{tr}(A),c_n=\\text{det}(A)$ã€‚ å®šç† è®¾$A\\in C^{n\\times n}$ï¼Œå¦‚æœ$A$æœ‰ç‰¹å¾å€¼$\\lambda_1,\\cdots,\\lambda_n$ï¼Œåˆ™ å¦‚æœ$A$ç›¸ä¼¼$B$ï¼Œåˆ™ä¸¤ä¸ªçŸ©é˜µæœ‰ç›¸åŒçš„ç‰¹å¾å€¼å’Œç‰¹å¾å¤šé¡¹å¼ã€‚ è®¾$A\\in C^{m\\times n}$ï¼Œåˆ™$A^HA$å’Œ$AA^H$ç‰¹å¾å€¼éƒ½æ˜¯éè´Ÿå®æ•°ï¼Œä¸”å®ƒä»¬éƒ½æœ‰ç›¸åŒçš„éé›¶ç‰¹å¾å€¼å’Œç›¸åŒçš„é‡æ•°ï¼Œå¹¶ä¸”éé›¶ç‰¹å¾å€¼ï¼ˆåŒ…å«é‡æ•°ï¼‰çš„æ•°é‡ç­‰äº$\\text{rank}(A)$ã€‚ ","date":"2023-12-01","objectID":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 4â€”ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 å¯¹è§’åŒ– å®šä¹‰ è®¾çŸ©é˜µ$A\\in F^{n\\times n}$ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µ$P\\in F^{n\\times n}$å’Œä¸€ä¸ªå¯¹è§’çŸ©é˜µ$D\\in F^{n\\times n}$ï¼Œä½¿å¾—$P^{-1}AP=D$ï¼Œåˆ™ç§°$A$å¯è¢«å¯¹è§’åŒ–ã€‚ å®šç† $A$å¯ä»¥è¢«å¯¹è§’åŒ–å½“ä¸”ä»…å½“$A$æœ‰$n$ä¸ªçº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡ $\\lambda_1,\\cdots,\\lambda_k$æ˜¯$A$çš„ä¸åŒçš„ç‰¹å¾å€¼ï¼Œåˆ™å¯¹åº”çš„ç‰¹å¾å‘é‡$x_1,\\cdots,x_k$å®ƒä»¬æ˜¯çº¿æ€§æ— å…³çš„ ç”±ä»¥ä¸Šä¸¤æ¡å®šç†å³å¯æ¨å‡ºå¦‚æœ$A$æœ‰$n$ä¸ªä¸åŒçš„ç‰¹å¾å€¼ï¼Œåˆ™$A$å¯è¢«å¯¹è§’åŒ– ä¸åŒç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡çš„é›†åˆçš„å¹¶é›†æ˜¯çº¿æ€§æ— å…³çš„ã€‚å³å–æ¯ä¸ªç‰¹å¾å€¼çš„æ‰€æœ‰ç‰¹å¾å‘é‡ï¼Œæ— è®ºè¿™äº›å‘é‡å±äºå“ªä¸ªç‰¹å¾å€¼ï¼Œå®ƒä»¬çš„å¹¶é›†éƒ½æ˜¯çº¿æ€§æ— å…³çš„ã€‚ ä»£æ•°é‡æ•° è®¾$A\\in F^{n\\times n}$ï¼Œå¦‚æœ$\\det(\\lambda I-A)=(\\lambda -\\lambda_i)^{r_1}\\cdots(\\lambda-\\lambda_k)^{r_k}$ï¼Œå…¶ä¸­$\\lambda_1,\\cdots,\\lambda_k$æ˜¯$A$çš„ç‰¹å¾å€¼ï¼Œå®ƒä»¬æ˜¯ä¸åŒçš„ã€‚åˆ™ç‰¹å¾å€¼$\\lambda_i$çš„ä»£æ•°é‡æ•°æ˜¯$r_i$ï¼Œå³ç‰¹å¾å€¼$\\lambda_i$å‡ºç°çš„æ¬¡æ•°ã€‚ å‡ ä½•é‡æ•° ä¸ç‰¹å¾å€¼$\\lambda_i$å¯¹åº”çš„ç‰¹å¾å­ç©ºé—´æ˜¯$N(\\lambda_i I-A)$ï¼Œåˆ™ç‰¹å¾å€¼$\\lambda_i$çš„å‡ ä½•é‡æ•°ä¸º$\\dim(N(\\lambda_i I-A))$ã€‚ å‡ ä½•é‡æ•°$\\leq $ä»£æ•°é‡æ•° å‡ ä½•é‡æ•°çœ‹å¯å¯¹è§’åŒ– çŸ©é˜µ$A\\in F^{n\\times n}$å¯å¯¹è§’åŒ–å½“ä¸”ä»…å½“$A$ä¸­ä¸åŒç‰¹å¾å€¼çš„å‡ ä½•é‡æ•°å’Œç­‰äº$n$ï¼ˆå³æ¯ä¸ªç‰¹å¾å€¼çš„ä»£æ•°é‡æ•°éƒ½è¦ç­‰äºå‡ ä½•é‡æ•°ï¼‰ ","date":"2023-12-01","objectID":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 4â€”ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 Schurå®šç†å’Œæ­£è§„çŸ©é˜µ é…‰ï¼ˆæ­£äº¤ï¼‰ç›¸ä¼¼å®šä¹‰ è®¾$A\\in C^{n\\times n}(R^{n\\times n})$ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªé…‰ï¼ˆæ­£äº¤ï¼‰çŸ©é˜µ$U$ä½¿å¾—$U^HAU=B\\space\\space\\space(U^H=U^{-1})$ï¼Œåˆ™å¯ç§°$A$é…‰ï¼ˆæ­£äº¤ï¼‰ç›¸ä¼¼$B$ Schurå®šç† $\\forall A\\in C^{n\\times n}$ï¼Œ$A$éƒ½ä¸ä¸Šä¸‰è§’çŸ©é˜µç›¸ä¼¼ï¼Œä¸”å­˜åœ¨é…‰çŸ©é˜µ$U$å’Œä¸Šä¸‰è§’çŸ©é˜µ$T$ä½¿å¾—$U^HAU=U^{-1}AU=T$ã€‚ ä»…é€‚ç”¨äºå¤æ•°åŸŸï¼Œå®æ•°åŸŸä¸Šä¸ä¸€å®šé€‚ç”¨ æ­£è§„çŸ©é˜µå®šä¹‰ è®¾$A\\in C^{n\\times n}$ï¼Œå¦‚æœ$A$æ»¡è¶³$A^HA=AA^H$ï¼Œåˆ™ç§°$A$æ˜¯æ­£è§„çŸ©é˜µã€‚ HermiteçŸ©é˜µï¼Œé…‰ï¼ˆæ­£äº¤ï¼‰çŸ©é˜µéƒ½æ˜¯æ­£è§„çŸ©é˜µ è°±å®šç† è®¾$A\\in C^{n\\times n}$ï¼Œå¦‚æœ$A$æ˜¯HermiteçŸ©é˜µï¼Œåˆ™$A$é…‰ç›¸ä¼¼äºä¸€ä¸ªå®å¯¹è§’çŸ©é˜µï¼Œæ¢å¥è¯è¯´ï¼ŒHermiteçŸ©é˜µçš„ç‰¹å¾å€¼éƒ½æ˜¯å®æ•°ã€‚ å¼•ç† è®¾$A\\in C^{n\\times n}$ï¼Œ$A$æ˜¯æ­£è§„çŸ©é˜µå½“ä¸”ä»…å½“$\\forall \\lambda,x$ä½¿å¾—$||Ax-\\lambda x||=||A^Hx-\\bar{\\lambda}x||$ã€‚ åŒæ—¶å¯¹è§’åŒ– è®¾$A,B$éƒ½æ˜¯ç›¸åŒé˜¶æ•°çš„æ­£è§„çŸ©é˜µï¼Œåˆ™å­˜åœ¨ä¸€ä¸ªé…‰çŸ©é˜µå¯ä»¥åŒæ—¶é…‰å¯¹è§’åŒ–$A,B$å½“ä¸”ä»…å½“$AB=BA$ ","date":"2023-12-01","objectID":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 4â€”ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 Pythonæ±‚è§£ import numpy as np from sympy import symbols, Matrix import pprint # å®šä¹‰ç¬¦å·å˜é‡ lambda_ = symbols('lambda') A = np.array([[0, 2, 1], [-2, 0, 3], [-1, -3, 0]]) A = Matrix(A) # æ±‚ç‰¹å¾çŸ©é˜µ characteristic_matrix = A - lambda_ * np.eye(3) pprint.pprint(\"å…³äº lambda çš„ç‰¹å¾çŸ©é˜µ:\") pprint.pprint(characteristic_matrix) # è®¡ç®—ç‰¹å¾å¤šé¡¹å¼ characteristic_polynomial = A.charpoly(lambda_) pprint.pprint(\"å…³äº lambda çš„ç‰¹å¾å¤šé¡¹å¼:\") pprint.pprint(characteristic_polynomial) # æ±‚ç‰¹å¾å€¼ eigenvalues = A.eigenvals() # æ‰“å°ç‰¹å¾å€¼ã€å…¶ä»£æ•°é‡æ•°ã€ç‰¹å¾å‘é‡å’Œå‡ ä½•é‡æ•° for k, v in eigenvalues.items(): pprint.pprint(\"ç‰¹å¾å€¼ %s çš„ä»£æ•°é‡æ•°ä¸º %s\" % (k, v)) pprint.pprint(\"ç‰¹å¾å€¼ %s çš„å‡ ä½•é‡æ•°ä¸º %s\" % (k, A.eigenvects()[list(eigenvalues.keys()).index(k)][1])) pprint.pprint(\"ç‰¹å¾å€¼ %s çš„ç‰¹å¾å‘é‡ä¸º %s\" % (k, A.eigenvects()[list(eigenvalues.keys()).index(k)][2])) # åˆ¤æ–­Aæ˜¯å¦å¯å¯¹è§’åŒ–ï¼Œå¦‚æœå¯ä»¥ï¼Œæ‰“å°å‡ºå¯¹è§’åŒ–çŸ©é˜µ if A.is_diagonalizable(): pprint.pprint(\"Aå¯å¯¹è§’åŒ–\") pprint.pprint(\"å¯¹è§’åŒ–çŸ©é˜µä¸º:\") pprint.pprint(A.diagonalize()[0]) # æ±‚Açš„è¡Œç©ºé—´ã€åˆ—ç©ºé—´ã€é›¶ç©ºé—´ pprint.pprint(\"Açš„è¡Œç©ºé—´ä¸º:\") pprint.pprint(A.rowspace()) pprint.pprint(\"Açš„åˆ—ç©ºé—´ä¸º:\") pprint.pprint(A.columnspace()) pprint.pprint(\"Açš„é›¶ç©ºé—´ä¸º:\") pprint.pprint(A.nullspace()) ","date":"2023-12-01","objectID":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 4â€”ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/04.%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"$\\lambda$çŸ©é˜µä¸Jordan æ ‡å‡†å‹ ","date":"2023-12-01","objectID":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/:0:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 5â€”lambdaçŸ©é˜µä¸Jordan æ ‡å‡†å‹","uri":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 $\\lambda $çŸ©é˜µå…³é”®æ¦‚å¿µ $\\lambda$çŸ©é˜µå®šä¹‰ è®¾$a_{ij}(\\lambda)(1\\leq i \\leq m,1\\leq j \\leq n)$æ˜¯æ•°åŸŸ$P$ä¸Šçš„å¤šé¡¹å¼ï¼Œä»¥$a_{ij}(\\lambda)$ä¸ºå…ƒç´ çš„$m\\times n$çŸ©é˜µ æˆä¸ºå¤šé¡¹å¼çŸ©é˜µæˆ–$\\lambda$çŸ©é˜µï¼Œå¤šé¡¹å¼$a_{ij}(\\lambda)(1\\leq i \\leq m,1\\leq j \\leq n)$ä¸­çš„æœ€é«˜æ¬¡æ•°æˆä¸º$A(\\lambda)$çš„æ¬¡æ•°ï¼Œåˆ™æ•°å­—çŸ©é˜µæ˜¾ç„¶æ˜¯$\\lambda$çŸ©é˜µï¼Œä¸º$0$æ¬¡ï¼›æ•°å­—çŸ©é˜µ$A$çš„ç‰¹å¾çŸ©é˜µ$\\lambda I-A$å°±æ˜¯$1$æ¬¡$\\lambda$çŸ©é˜µã€‚ è®¾$A(\\lambda)$çŸ©é˜µçš„æ¬¡æ•°ä¸º$k$ï¼Œåˆ™$A(\\lambda)$å¯è¡¨ç¤ºä¸º å…¶ä¸­$A_i(0\\leq i \\leq k)$æ˜¯æ•°å­—çŸ©é˜µï¼Œå¹¶ä¸”$A_k\\neq 0$ã€‚ $\\lambda$çŸ©é˜µæ€§è´¨ $\\lambda$çŸ©é˜µä¹Ÿå¯ä»¥è¿›è¡Œåˆç­‰å˜æ¢ è‹¥$A(\\lambda)$å¯ä»¥ç»è¿‡æœ‰é™æ¬¡åˆç­‰å˜æ¢åŒ–ä¸º$B(\\lambda)$ï¼Œåˆ™ç§°$\\lambda$çŸ©é˜µ$A(\\lambda)$å’Œ$B(\\lambda)$ç›¸æŠµï¼Œè®°ä¸º$A(\\lambda)\\cong B(\\lambda)$ $\\lambda$çŸ©é˜µå®šç† è®¾$A(\\lambda)=(a_{ij}(\\lambda))\\in P[\\lambda]^{m\\times n}$ï¼Œä¸”$rank(A(\\lambda))=r$ï¼Œåˆ™$A(\\lambda)$ç›¸ä¼¼äºå¦‚ä¸‹çš„å¯¹è§’çŸ©é˜µ å…¶ä¸­$d_i(\\lambda)(1\\leq i \\leq r)$æ˜¯é¦–é¡¹ç³»æ•°ä¸º$1$çš„å¤šé¡¹å¼ï¼Œå¹¶ä¸”$d_i(\\lambda)|d_{i+1}(\\lambda)(1\\leq i \\leq r-1)$ $Smith$æ ‡å‡†å‹ $\\lambda$çŸ©é˜µå®šç†ä¸­çš„å¯¹è§’çŸ©é˜µå°±ç§°ä¸º$\\lambda $çŸ©é˜µ$A(\\lambda)$åœ¨ç›¸æŠµä¸‹çš„æ ‡å‡†å‹æˆ–è€…$Smith$æ ‡å‡†å‹ã€‚ $Smith$æ ‡å‡†å‹æ˜¯å”¯ä¸€çš„ ä¸å˜å› å­ã€è¡Œåˆ—å¼å› å­ã€åˆç­‰å› å­ é‡è¦æ€§è´¨ï¼šç›¸æŠµçš„$\\lambda$çŸ©é˜µå…·æœ‰ç›¸åŒçš„ç§©ã€ç›¸åŒçš„å„é˜¶è¡Œåˆ—å¼å› å­ã€ç›¸åŒçš„ä¸å˜å› å­ $Smith$æ ‡å‡†å‹â€œä¸»å¯¹è§’çº¿â€ä¸Šéé›¶å…ƒ$d_1(\\lambda),d_2(\\lambda),\\dots,d_r(\\lambda)$ç§°ä¸º$A(\\lambda)$çš„ä¸å˜å› å­ï¼› $A(\\lambda)$çš„å…¨éƒ¨$k$é˜¶å­å¼çš„æœ€å¤§å…¬å› å¼ç§°ä¸º$A(\\lambda)$çš„$k$é˜¶è¡Œåˆ—å¼å› å­ï¼Œè®°ä¸º$D_k(\\lambda)$ï¼› å…¶ä¸­$d_k(\\lambda)=\\frac{D_{k+1}(\\lambda)}{D_k(\\lambda)}$ åˆç­‰å› å­æ˜¯ä»ä¸å˜å› å­åˆ†è§£å¾—æ¥çš„ï¼Œå…·ä½“å¦‚ä¸‹ï¼š å‡è®¾ä¸å˜å› å­ä¸º åˆ™æ‰€æœ‰æŒ‡æ•°å¤§äº$0$çš„å› å­$(\\lambda -\\lambda _ {j})^ {e_ {ij}}(1\\leq i \\leq r,1\\leq j\\leq k)$ç§°ä¸º$\\lambda $çŸ©é˜µ$A(\\lambda)$çš„åˆç­‰å› å­ ","date":"2023-12-01","objectID":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 5â€”lambdaçŸ©é˜µä¸Jordan æ ‡å‡†å‹","uri":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 çŸ©é˜µç›¸ä¼¼çš„æ¡ä»¶ å®šä¹‰ è®¾$A$ä¸º$n$é˜¶æ•°å­—çŸ©é˜µï¼Œå…¶ç‰¹å¾çŸ©é˜µ$\\lambda I-A$çš„è¡Œåˆ—å¼å› å­ï¼Œä¸å˜å› å­å’Œåˆç­‰å› å­åˆ†åˆ«ç§°ä¸ºçŸ©é˜µ$A$çš„è¡Œåˆ—å¼å› å­ï¼Œä¸å˜å› å­å’Œåˆç­‰å› å­ã€‚ ç›¸ä¼¼çš„å……åˆ†å¿…è¦æ¡ä»¶ $n$é˜¶çŸ©é˜µ$A$å’Œ$B$ç›¸ä¼¼$\\Longleftrightarrow $å­˜åœ¨ä¸€ä¸ªå¯é€†çŸ©é˜µ $P$ï¼Œä½¿å¾—$B = P^{-1} A P $$\\Longleftrightarrow $å®ƒä»¬çš„ç‰¹å¾çŸ©é˜µ$\\lambda I-A$å’Œ$\\lambda I-B$ç›¸æŠµ$\\Longleftrightarrow $å®ƒä»¬å…·æœ‰ç›¸åŒçš„è¡Œåˆ—å¼å› å­æˆ–è€…å®ƒä»¬æœ‰ç›¸åŒçš„ä¸å˜å› å­$\\Longleftrightarrow $å®ƒä»¬å…·æœ‰ç›¸åŒçš„åˆç­‰å› å­ ","date":"2023-12-01","objectID":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 5â€”lambdaçŸ©é˜µä¸Jordan æ ‡å‡†å‹","uri":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 çŸ©é˜µçš„Jordanæ ‡å‡†å‹ Jordanå—å’ŒJordanæ ‡å‡†å‹ Jordanå—åˆ†ä¸ŠJordanå—å’Œä¸‹Jordanå—ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨ä¸ŠJordanå—ã€‚ å¦‚æœ$(\\lambda -a)^d$æ˜¯$A$çš„åˆç­‰å› å­ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥æ„å»ºä¸€ä¸ª$d\\times d$çš„çŸ©é˜µå½¢å¼ è¿™ä¸ªçŸ©é˜µæˆ‘ä»¬ç§°ä¸ºä¸ŠJordanå—ã€‚ä¸‹Jordanå—åˆ™ä¸º é‚£ç”±è‹¥å¹²ä¸ªJordanå—ä¸ºå¯¹è§’å—ç»„æˆçš„å—å¯¹è§’çŸ©é˜µç§°ä¸ºJordanæ ‡å‡†å‹ æ€§è´¨ Jordanå—è¢«å®ƒçš„åˆç­‰å› å­å”¯ä¸€ç¡®å®š Jordanæ ‡å‡†å‹çš„å…¨éƒ¨åˆç­‰å› å­ç”±å®ƒçš„å…¨éƒ¨Jordanå—çš„åˆç­‰å› å­ç»„æˆ æ¯ä¸ª$n$é˜¶çŸ©é˜µéƒ½ç›¸ä¼¼äºå®ƒçš„Jordanæ ‡å‡†å‹ Jordanæ ‡å‡†å‹ä¸å”¯ä¸€ï¼Œå…¶å†…éƒ¨Jordanå—çš„é¡ºåºå¯ä»¥éšæ„ï¼Œä½†æ¯ä¸ªJordanå—å”¯ä¸€ï¼Œå¦‚æœé™¤å»å…¶ä¸­Jordanå—æ’åˆ—çš„æ¬¡åºå¤–æ˜¯è¢«çŸ©é˜µ$A$å”¯ä¸€ç¡®å®šçš„ æ±‚$n$é˜¶æ–¹é˜µ$A$çš„Jordanæ ‡å‡†å‹ å¾—åˆ°$(\\lambda I-A)$çŸ©é˜µï¼Œæ±‚å®ƒçš„å„é˜¶è¡Œåˆ—å¼å› å­$D_k(\\lambda)$ æ ¹æ®å…¬å¼$d_1(\\lambda)=D_1(\\lambda)$ï¼Œ$d_k(\\lambda)=\\frac{D_{k+1}(\\lambda)}{D_k(\\lambda)}(2\\leq k\\leq n)$å¾—åˆ°ä¸å˜å› å­ ä»ä¸å˜å› å­åˆ†è§£å¾—åˆ°åˆç­‰å› å­ æ ¹æ®åˆç­‰å› å­æ„æˆJordanå—$J_i$ï¼Œå†ç»„æˆJordanæ ‡å‡†å‹$J$ æ±‚å¯é€†çŸ©é˜µ$P$ï¼Œä½¿å¾—$P^{-1}AP=J$ æ ¹æ®ä¸Šä¸€ä¸ªæ–¹æ³•æ±‚å‡ºçŸ©é˜µ$A$çš„Jordanæ ‡å‡†å‹$J$ å·¦å³ä¸¤è¾¹å·¦ä¹˜$P^{-1}$å˜æ¢å…¬å¼å¾—åˆ°$AP=PJ$ è®¾$P=(P_1,..,P_n)$ï¼Œæ ¹æ®å…¬å¼æ„é€  å…¶ä¸­$J_{(i,i+1)}$çš„å–å€¼åªèƒ½ä¸º$0\\space or\\space 1$ï¼Œ$J_{ii}$çš„å–å€¼å³ä¸ºå¯¹è§’çº¿å…ƒç´ ã€‚æ ¹æ®æ–¹ç¨‹ä»è€Œè§£å¾—$P$ã€‚ æ³¨æ„ï¼š$P$ä¸å”¯ä¸€ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è®¾$P$å…ƒç´ çš„æ—¶å€™ä¸€å®šè¦ä¿è¯$P$å¯é€†ï¼Œå³$rank(P)=n$ã€‚å¯ä»¥è‡ªå·±è¿›è¡Œåˆç­‰å˜æ¢éªŒè¯ä¸€ä¸‹æ˜¯å¦æ­£ç¡®ï¼ Pythonæ±‚è§£$J$å’Œå¯é€†çŸ©é˜µ$P$ import numpy as np from sympy import Matrix import pprint A = np.array([[2, 2, 1], [-2, 6, 1], [0, 0, 4]]) A = Matrix(A) P, J = A.jordan_form() # éªŒè¯P^-1 * A * P = J assert P ** -1 * A * P == J, \"P^-1 * A * P != J\" pprint.pprint(\"P:\", P) pprint.pprint(\"J:\", J) ","date":"2023-12-01","objectID":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 5â€”lambdaçŸ©é˜µä¸Jordan æ ‡å‡†å‹","uri":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 Cayley-Hamilton å®šç†ä¸æœ€å°å¤šé¡¹å¼ Cayley-Hamilton å®šç† è®¾$A$æ˜¯$n$é˜¶çŸ©é˜µï¼Œ$f(\\lambda)$æ˜¯$A$çš„ç‰¹å¾å¤šé¡¹å¼ï¼Œåˆ™$f(A)=0$ ç›¸å…³å®šä¹‰ è®¾$A$ä¸º$n$é˜¶çŸ©é˜µï¼Œå¦‚æœå­˜åœ¨å¤šé¡¹å¼$\\varphi(\\lambda)$ä½¿å¾—$\\varphi(A)=0$ï¼Œåˆ™ç§°$\\varphi(\\lambda)$ä¸º$A$çš„åŒ–é›¶å¤šé¡¹å¼ã€‚æ˜“çŸ¥$f(\\lambda)$ä¸º$A$çš„åŒ–é›¶å¤šé¡¹å¼ï¼Œä¸”$g(\\lambda)f(\\lambda)$ä¹Ÿä¸º$A$çš„åŒ–é›¶å¤šé¡¹å¼ï¼Œæ•…$A$çš„åŒ–é›¶å¤šé¡¹å¼æœ‰æ— ç©·å¤šä¸ª $A$çš„æ‰€æœ‰åŒ–é›¶å¤šé¡¹å¼ä¸­ï¼Œæ¬¡æ•°æœ€ä½ï¼Œä¸”é¦–é¡¹ç³»æ•°ä¸º$1$çš„å¤šé¡¹å¼ç§°ä¸º$A$çš„æœ€å°å¤šé¡¹å¼ã€‚$A$çš„æœ€å°å¤šé¡¹å¼æ˜¯å”¯ä¸€çš„ ç»“è®º $A$çš„æœ€å°å¤šé¡¹å¼å°±æ˜¯$d_n(\\lambda)$ï¼Œå³$A$çš„ç¬¬$n$ä¸ªä¸å˜å› å­ ","date":"2023-12-01","objectID":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 5â€”lambdaçŸ©é˜µä¸Jordan æ ‡å‡†å‹","uri":"/posts/05.lambda%E7%9F%A9%E9%98%B5%E4%B8%8Ejordan%E6%A0%87%E5%87%86%E5%9E%8B/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"çŸ©é˜µåˆ†è§£ ","date":"2023-12-01","objectID":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/:0:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 6â€”çŸ©é˜µåˆ†è§£çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ï¼ˆé™„Pythonå®ç°ï¼‰","uri":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 æ»¡ç§©åˆ†è§£ï¼ˆFull-Rank Factorizationï¼‰ æ»¡ç§©åˆ†è§£å®šç† è®¾$m\\times n$çŸ©é˜µ$A$çš„ç§©ä¸º$r\u003e0$ï¼Œåˆ™å­˜åœ¨$m\\times r$çŸ©é˜µ$B$ï¼ˆåˆ—æ»¡ç§©çŸ©é˜µï¼‰å’Œ$r\\times n$çŸ©é˜µ$C$ï¼ˆè¡Œæ»¡ç§©çŸ©é˜µï¼‰ä½¿å¾— å¹¶ä¸”$rank(B)=rank(C)=r$ æ»¡ç§©åˆ†è§£ä¸å”¯ä¸€ å®šç†ï¼šè®¾$A$ä¸º$m\\times n$çŸ©é˜µï¼Œä¸”$rank(A)=r$ï¼Œå­˜åœ¨$m$é˜¶å¯é€†çŸ©é˜µ$P$å’Œ$n$é˜¶å¯é€†çŸ©é˜µ$Q$ï¼Œä½¿å¾—ã€‚ è¯æ˜æ»¡ç§©åˆ†è§£å®šç†ï¼š åˆ™ä»¤ï¼Œå¯å¾—åˆ°$A=BC$ $\\because$ $P,C$æ˜¯å¯é€†çŸ©é˜µï¼Œ$B$çš„$r$ä¸ªåˆ—æ˜¯$P$çš„å‰$r$åˆ—ï¼›$C$çš„$r$ä¸ªè¡Œæ˜¯$Q$çš„å‰$r$è¡Œ $\\therefore$ $rank(B)=rank(C)=r$ æ»¡ç§©åˆ†è§£æ­¥éª¤ è®¾$A$ä¸º$m\\times n$çŸ©é˜µï¼Œé¦–å…ˆæ±‚$rank(A)$ å–$A$çš„$j_1,j_2,â€¦j_r$åˆ—æ„æˆ$B_{m\\times r}$ å–$A$çš„Hermiteæ ‡å‡†å‹ï¼ˆå³è¡Œæœ€ç®€è¡ŒçŸ©é˜µï¼‰$H$çš„å‰$r$è¡Œæ„æˆçŸ©é˜µ$C_{r\\times n}$ åˆ™$A=BC$å°±æ˜¯çŸ©é˜µ$A$çš„ä¸€ä¸ªæ»¡ç§©åˆ†è§£ Pythonæ±‚è§£æ»¡ç§©åˆ†è§£ import numpy as np from sympy import Matrix ''' Full-Rank Factorization @params: A Matrix @return: F, G Matrix ''' def full_rank(A): r = A.rank() A_arr1 = np.array(A.tolist()) # æ±‚è§£Açš„æœ€ç®€è¡Œé˜¶æ¢¯çŸ©é˜µï¼Œè¦è½¬æ¢æˆlistï¼Œå†è½¬æ¢æˆarray A_rref = np.array(A.rref()[0].tolist()) k = [] # å­˜å‚¨è¢«é€‰ä¸­çš„åˆ—å‘é‡çš„ä¸‹æ ‡ # éå†A_rrefçš„è¡Œ for i in range(A_rref.shape[0]): # éå†A_rrefçš„åˆ— for j in range(A_rref.shape[1]): # é‡åˆ°1å°±è¯´æ˜æ‰¾åˆ°äº†AçŸ©é˜µçš„åˆ—å‘é‡çš„ä¸‹æ ‡ # è¿™äº›ä¸‹æ ‡çš„åˆ—å‘é‡ç»„æˆFçŸ©é˜µï¼Œç„¶åå†æ‰¾ä¸‹ä¸€è¡Œ if A_rref[i][j] == 1: k.append(j) break # é€šè¿‡é€‰ä¸­çš„åˆ—ä¸‹æ ‡ï¼Œæ„å»ºFçŸ©é˜µ B = Matrix(A_arr1[:,k]) # Gå°±æ˜¯å–è¡Œæœ€ç®€è¡ŒçŸ©é˜µAçš„å‰rè¡Œæ„æˆçš„çŸ©é˜µ C = Matrix(A_rref[:r]) return B, C if __name__ == \"__main__\": # è¡¨ç¤ºçŸ©é˜µA A = np.array([[1, 1, 0], [0, 1, 1], [-1, 0, 0], [1, 1, 1]]) A = Matrix(A) B, C = full_rank(A) print(\"B:\", B) print(\"C:\", C) ","date":"2023-12-01","objectID":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 6â€”çŸ©é˜µåˆ†è§£çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ï¼ˆé™„Pythonå®ç°ï¼‰","uri":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 ä¸‰è§’åˆ†è§£ï¼ˆTriangular Factorizationï¼‰ $LU$åˆ†è§£å®šä¹‰ å¦‚æœæœ‰ä¸€ä¸ªçŸ©é˜µ$A$ï¼Œæˆ‘ä»¬èƒ½è¡¨ç¤ºä¸‹ä¸‰è§’çŸ©é˜µ$L$å’Œä¸Šä¸‰è§’çŸ©é˜µ$U$çš„ä¹˜ç§¯ï¼Œç§°ä¸º$A$çš„ä¸‰è§’åˆ†è§£æˆ–$LU$åˆ†è§£ã€‚ æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸‹ä¸‰è§’çŸ©é˜µçš„å¯¹è§’å…ƒç´ éƒ½ä¸º$1$ $LU$åˆ†è§£å®šç† è‹¥$A$æ˜¯$n$é˜¶éå¥‡å¼‚çŸ©é˜µï¼Œåˆ™å­˜åœ¨å”¯ä¸€çš„å•ä½ä¸‹ä¸‰è§’çŸ©é˜µ$L$å’Œä¸Šä¸‰è§’çŸ©é˜µ$U$ä½¿å¾—$A=LU$çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯$A$çš„æ‰€æœ‰é¡ºåºä¸»å­å¼å‡éé›¶ï¼ˆè¿™ä¸€æ¡ä»¶ä¿è¯äº†å¯¹è§’çº¿å…ƒç´ éé›¶ï¼‰ï¼Œå³$\\Delta_k\\neq 0(k=1,â€¦,n-1)$ $LU$åˆ†è§£æ­¥éª¤ è®¾$A$ä¸º$n\\times n$çŸ©é˜µ è¿›è¡Œåˆç­‰è¡Œå˜æ¢ï¼ˆæ³¨æ„ï¼šä¸æ¶‰åŠè¡Œäº¤æ¢çš„åˆç­‰å˜æ¢ï¼‰ï¼Œä»ç¬¬$1$è¡Œå¼€å§‹ï¼Œåˆ°ç¬¬$n$è¡Œç»“æŸã€‚å°†ç¬¬$i$è¡Œç¬¬$i$åˆ—ä»¥ä¸‹çš„å…ƒç´ å…¨éƒ¨æ¶ˆä¸º$0$ è¿™æ ·æ“ä½œåå¾—åˆ°çš„çŸ©é˜µå³ä¸º$U$ æ„é€ å¯¹è§’çº¿å…ƒç´ å…¨ä¸º$1$çš„å•ä½ä¸‹ä¸‰è§’çŸ©é˜µ$L$ï¼Œ$L$çš„å‰©ä½™å…ƒç´ é€šè¿‡æ„å»ºæ–¹ç¨‹ç»„çš„å½¢å¼æ¥æ±‚è§£ã€‚ Pythonæ±‚è§£$LU$åˆ†è§£ $LU$åˆ†è§£çš„å®é™…æ„ä¹‰ è§£çº¿æ€§æ–¹ç¨‹ç»„ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„$Ax=b$ï¼Œå…¶ä¸­$A$æ˜¯ä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µï¼Œè€Œ$b$æ˜¯ä¸€ä¸ªåˆ—å‘é‡ã€‚é€šè¿‡$LU$åˆ†è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ–¹ç¨‹ç»„è½¬åŒ–ä¸ºä¸¤ä¸ªç®€åŒ–çš„æ–¹ç¨‹ç»„$Ly=b$å’Œ$Ux=y$ï¼Œå…¶ä¸­$L$æ˜¯ä¸‹ä¸‰è§’çŸ©é˜µï¼Œ$U$æ˜¯ä¸Šä¸‰è§’çŸ©é˜µã€‚è¿™ä¸¤ä¸ªæ–¹ç¨‹ç»„åˆ†åˆ«æ˜“äºæ±‚è§£ã€‚ å…·ä½“ï¼š é¦–å…ˆï¼Œé€šè¿‡å‰ä»£æ³•ï¼ˆforward substitutionï¼‰è§£$Ly=b$ï¼Œç„¶åé€šè¿‡å›ä»£æ³•ï¼ˆbackward substitutionï¼‰è§£$Ux=y$ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æ–¹ç¨‹ç»„çš„è§£ã€‚ $LDU$åˆ†è§£å®šç† è®¾$A$æ˜¯$n$é˜¶éå¥‡å¼‚çŸ©é˜µï¼Œåˆ™å­˜åœ¨å”¯ä¸€çš„å•ä½ä¸‹ä¸‰è§’çŸ©é˜µ$L$ï¼Œå¯¹è§’çŸ©é˜µ$D=diag(d_1,d_2,â€¦,d_n)$å’Œä¸Šä¸‰è§’çŸ©é˜µ$U$ä½¿å¾—$A=LDU$çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯$A$çš„æ‰€æœ‰é¡ºåºä¸»å­å¼å‡éé›¶ï¼ˆè¿™ä¸€æ¡ä»¶ä¿è¯äº†å¯¹è§’çº¿å…ƒç´ éé›¶ï¼‰ï¼Œå³$\\Delta_k\\neq 0(k=1,â€¦,n-1)$å¹¶ä¸”$d_1=a_{11},d_k=\\frac{\\Delta_k}{\\Delta_{k+1}},k=2,â€¦,n$ $LDU$åˆ†è§£æ­¥éª¤ è®¾$A$ä¸º$n\\times n$çŸ©é˜µ å…ˆæ±‚$LU$åˆ†è§£ å°†$U$çš„å¯¹è§’çº¿å…ƒç´ æå‡ºæ¥æ„æˆå¯¹è§’çŸ©é˜µ$D$ $U$ä¸­çš„å…ƒç´ $u_{ij}$é™¤ä»¥$d_i$ï¼Œå…¶ä¸­$d_i$è¡¨ç¤ºç¬¬$i$ä¸ªå¯¹è§’å…ƒç´ ã€‚è¿™æ ·æ“ä½œå¾—åˆ°å˜æ¢åçš„$U$ Pythonæ±‚è§£$LDU$åˆ†è§£ import numpy as np from sympy import Matrix import pprint EPSILON = 1e-8 def is_zero(x): return abs(x) \u003c EPSILON def LU(A): # æ–­è¨€Aå¿…é¡»æ˜¯éå¥‡å¼‚æ–¹é˜µA assert A.rows == A.cols, \"Matrix A must be a square matrix\" assert A.det() != 0, \"Matrix A must be a nonsingular matrix\" n = A.rows U = A # æ„å»ºå‡ºUçŸ©é˜µ # å°†Uè½¬æ¢æˆlistï¼Œå†è½¬æ¢æˆarray U = np.array(U.tolist()) # éå†Uçš„æ¯ä¸€è¡Œåˆ©ç”¨é«˜æ–¯æ¶ˆå…ƒæ³• for i in range(n): # åˆ¤æ–­U[i][i]æ˜¯å¦ä¸º0 assert not is_zero(U[i][i]), \"ä¸»å…ƒä¸º0ï¼Œæ— æ³•è¿›è¡ŒLUåˆ†è§£\" # å¯¹i+1è¡Œåˆ°nè¡Œè¿›è¡Œæ¶ˆå…ƒ for j in range(i + 1, n): # è®¡ç®—æ¶ˆå…ƒå› å­ factor = U[j][i] / U[i][i] # å¯¹ç¬¬jè¡Œè¿›è¡Œæ¶ˆå…ƒ for k in range(i, n): U[j][k] -= factor * U[i][k] # æ¶ˆå…ƒåçš„çŸ©é˜µUåˆ™æ˜¯æœ€ç»ˆUçŸ©é˜µ U = Matrix(U) # æ ¹æ®LU = Aï¼Œå¾—åˆ°LçŸ©é˜µ L = A * U.inv() return L, U def LDU(A): L, U = LU(A) D = Matrix(np.diag(np.diag(U))) U = D.inv() * U return L, D, U if __name__ == '__main__': A = np.array([[2, 3, 4], [1, 1, 9], [1, 2, -6]]) A = Matrix(A) ''' # test LUåˆ†è§£ L, U = LU(A) pprint.pprint(\"L:\") pprint.pprint(L) pprint.pprint(\"U:\") pprint.pprint(U) ''' # test LDUåˆ†è§£ L, D, U = LDU(A) pprint.pprint(\"L:\") pprint.pprint(L) pprint.pprint(\"D:\") pprint.pprint(D) pprint.pprint(\"U:\") pprint.pprint(U) $PLU$åˆ†è§£ PLU åˆ†è§£æ˜¯å°†çŸ©é˜µ$A$åˆ†è§£æˆä¸€ä¸ªç½®æ¢çŸ©é˜µ$P$ã€å•ä½ä¸‹ä¸‰è§’çŸ©é˜µ$L$å’Œä¸Šä¸‰è§’çŸ©é˜µ$U$çš„ä¹˜ç§¯ï¼Œå³ ä¹‹å‰$LU$åˆ†è§£ä¸­é™åˆ¶äº†è¡Œäº¤æ¢ï¼Œå¦‚æœä¸å¯é¿å…çš„å¿…é¡»è¿›è¡Œè¡Œäº’æ¢ï¼Œæˆ‘ä»¬å°±éœ€è¦è¿›è¡Œ$PLU$åˆ†è§£ã€‚ å®é™…ä¸Šåªéœ€è¦æŠŠ$A = LU$å˜æˆ$P^{-1}A = P^{-1}PLU$å°±å¯ä»¥äº†ï¼Œå®é™…ä¸Šæ‰€æœ‰çš„$A = LU$éƒ½å¯ä»¥å†™æˆ$P^{-1}A = LU$çš„å½¢å¼ï¼Œç”±äºå·¦ä¹˜ç½®æ¢çŸ©é˜µ$P^{-1}$æ˜¯åœ¨äº¤æ¢è¡Œçš„é¡ºåºï¼Œæ‰€ä»¥ç”±$P^{-1}A = P^{-1}PLU$æ¨å¾—é€‚å½“çš„äº¤æ¢$A$çš„è¡Œçš„é¡ºåºï¼Œå³å¯å°†$A$ åš $LU$ åˆ†è§£ã€‚å½“$A$æ²¡æœ‰è¡Œäº’æ¢æ—¶ï¼Œ$P$å°±æ˜¯å•ä½çŸ©é˜µã€‚ äº‹å®ä¸Šï¼Œæ‰€æœ‰çš„æ–¹é˜µéƒ½å¯ä»¥å†™æˆ $PLU$ åˆ†è§£çš„å½¢å¼ï¼Œäº‹å®ä¸Šï¼Œ$PLU$ åˆ†è§£æœ‰å¾ˆé«˜çš„æ•°å€¼ç¨³å®šæ€§ï¼Œå› æ­¤å®ç”¨ä¸Šæ˜¯å¾ˆå¥½ç”¨çš„å·¥å…·ã€‚ æœ‰æ—¶ä¸ºäº†è®¡ç®—ä¸Šçš„æ–¹ä¾¿ï¼Œä¼šåŒæ—¶é—´æ¢è¡Œä¸åˆ—çš„é¡ºåºï¼Œæ­¤æ—¶ä¼šå°† $A$ åˆ†è§£æˆ å…¶ä¸­ $P$ã€$L$ã€$U$ åŒä¸Šï¼Œ$Q$ æ˜¯ä¸€ä¸ªç½®æ¢çŸ©é˜µã€‚ ","date":"2023-12-01","objectID":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 6â€”çŸ©é˜µåˆ†è§£çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ï¼ˆé™„Pythonå®ç°ï¼‰","uri":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 æ­£äº¤ä¸‰è§’åˆ†è§£ï¼ˆQR Factorizationï¼‰ $QR$åˆ†è§£å®šç† è®¾$A$æ˜¯$m\\times n$å®ï¼ˆå¤ï¼‰çŸ©é˜µï¼Œ$m\\ge n$ä¸”å…¶$n$ä¸ªåˆ—å‘é‡çº¿æ€§æ— å…³ï¼Œåˆ™å­˜åœ¨$m$é˜¶æ­£äº¤ï¼ˆé…‰ï¼‰çŸ©é˜µ$Q$å’Œ$né˜¶$éå¥‡å¼‚å®ï¼ˆå¤ï¼‰ä¸Šä¸‰è§’çŸ©é˜µ$R$ä½¿å¾— $QR$åˆ†è§£æ­¥éª¤ è®¾$A$ä¸º$3\\times 3$çŸ©é˜µï¼Œå³$A=(\\alpha_1, \\alpha_2,\\alpha_3)$ã€‚åˆ™ï¼š æ­£äº¤åŒ–ï¼š$\\beta_1=\\alpha_1$ï¼Œ$\\beta_2=\\alpha_2-k_{21}\\beta_1$ï¼Œ$\\beta_3=\\alpha_3-k_{31}\\beta_1-k_{32}\\beta_2$ï¼Œå…¶ä¸­$k_{21}=\\frac{\u003c\\alpha_2,\\beta_1\u003e}{\u003c\\beta_1,\\beta_1\u003e}$ï¼Œ$k_{31}=\\frac{\u003c\\alpha_3,\\beta_1\u003e}{\u003c\\beta_1,\\beta_1\u003e}$ï¼Œ$k_{31}=\\frac{\u003c\\alpha_3,\\beta_2\u003e}{\u003c\\beta_2,\\beta_2\u003e}$ã€‚ å•ä½åŒ–å¾—åˆ°çŸ©é˜µ$Q$ï¼š$Q=(\\frac{\\beta_1}{||\\beta_1||},\\frac{\\beta_2}{||\\beta_2||},\\frac{\\beta_3}{||\\beta_3||})$ è®¡ç®—å¾—åˆ°çŸ©é˜µ$R$ï¼š è¿™æ ·ï¼Œ$A=QR$ Pythonæ±‚è§£$QR$åˆ†è§£ å¸¸è§„è®¡ç®—ï¼š import numpy as np import sympy from sympy import Matrix from sympy import * import pprint #æ­£äº¤ä¸‰è§’åˆ†è§£ï¼ˆQRï¼‰ a = [[1, 1, -1], [-1, 1, 1], [1, 1, -1], [1, 1, 1]] # a = [[1,1,-1], # [1,0,0], # [0,1,0], # [0,0,1]] A_mat = Matrix(a)#Î±å‘é‡ç»„æˆçš„çŸ©é˜µA # A_gs= GramSchmidt(A_mat) A_arr = np.array(A_mat) L = [] for i in range(A_mat.shape[1]): L.append(A_mat[:,i]) #æ±‚Q A_gs = GramSchmidt(L)#Î±çš„æ–½å¯†ç‰¹æ­£äº¤åŒ–å¾—åˆ°Î² A_gs_norm = GramSchmidt(L,True)#Î²çš„å•ä½åŒ–å¾—åˆ°v A = [] for i in range(A_mat.shape[1]): for j in range(A_mat.shape[0]): A.append(A_gs_norm[i][j])#æŠŠæ•°æ’æˆä¸€è¡Œ A_arr = np.array(A) A_arr = A_arr.reshape((A_mat.shape[0],A_mat.shape[1]),order = 'F')#ç”¨reshapeé‡æ–°æ’åˆ—ï¼ˆâ€˜Fâ€™ä¸ºç«–ç€å†™ï¼‰ #å¾—åˆ°æœ€åçš„Q Q = Matrix(A_arr) #æ±‚R C = [] for i in range(A_mat.shape[1]): for j in range(A_mat.shape[1]): if i \u003e j: C.append(0) elif i == j: t = np.array(A_gs[i]) m = np.dot(t.T,t) C.append(sympy.sqrt(m[0][0])) else: t = np.array(A_mat[:,j]) x = np.array(A_gs_norm[i]) n = np.dot(t.T,x) # print(n) C.append(n[0][0]) # C_finalä¸ºR C_arr = np.array(C) # print(C_arr) C_arr = C_arr.reshape((A_mat.shape[1],A_mat.shape[1])) R = Matrix(C_arr) pprint.pprint(\"Q:\") pprint.pprint(Q) pprint.pprint(\"R:\") pprint.pprint(R) è°ƒç”¨åº“å‡½æ•° # æ±‚çŸ©é˜µAçš„QRåˆ†è§£ï¼Œä¿ç•™æ ¹å· Q_, R_ = A_mat.QRdecomposition() pprint.pprint(\"Q_:\") pprint.pprint(Q_) pprint.pprint(\"R_:\") pprint.pprint(R_) assert Q_ == Q, \"Q_ != Q\" assert R_ == R, \"R_ != R\" ","date":"2023-12-01","objectID":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 6â€”çŸ©é˜µåˆ†è§£çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ï¼ˆé™„Pythonå®ç°ï¼‰","uri":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰ $SVD$å®šç† è®¾$A$æ˜¯$m\\times n$çŸ©é˜µï¼Œä¸”$rank(A)=r$ï¼Œåˆ™å­˜åœ¨$m$é˜¶é…‰çŸ©é˜µ$U$å’Œ$n$é˜¶é…‰çŸ©é˜µ$V$ä½¿å¾— å…¶ä¸­$\\Sigma=diag(\\sigma_1,â€¦,\\sigma_r)$ï¼Œä¸”$\\sigma_1\\geq â€¦\\geq \\sigma_r\u003e0$ã€‚ $\\sigma$ä¸º$A$çš„å¥‡å¼‚å€¼ï¼Œå…·ä½“å«ä¹‰è¿™é‡Œä¸åœ¨å™è¿°ï¼Œä½†éœ€è¦è®°ä½çš„æ˜¯$\\sigma^2$æ˜¯$A^HA$çš„ç‰¹å¾å€¼ï¼Œä¹Ÿæ˜¯$AA^H$çš„ç‰¹å¾å€¼ï¼Œä¸”ï¼š $A^HA$ä¸$AA^H$çš„ç‰¹å¾å€¼å‡ä¸ºéè´Ÿæ•° $A^HA$ä¸$AA^H$çš„éé›¶ç‰¹å¾å€¼ç›¸åŒï¼Œå¹¶ä¸”éé›¶ç‰¹å¾å€¼çš„ä¸ªæ•°ï¼ˆé‡ç‰¹å¾å€¼æŒ‰é‡æ•°è®¡ç®—ï¼‰ç­‰äº$rank(A)$ æ‰€ä»¥æˆ‘ä»¬æ±‚$\\Sigma$å°±è½¬æ¢æˆæ±‚è¿™ä¸¤ä¸ªçŸ©é˜µå…¶ä¸­ä¸€ä¸ªçš„ç‰¹å¾å€¼ã€‚ $SVD$åˆ†è§£æ­¥éª¤ æ±‚$A^HA$çš„$n$ä¸ªç‰¹å¾å€¼ï¼Œå³è®¡ç®—$|\\lambda I-A^HA|=0$ã€‚å¾—åˆ°ç‰¹å¾å€¼ï¼š$\\lambda_1,â€¦,\\lambda_r,\\lambda_{r+1}=0,â€¦,\\lambda_n=0$ï¼Œå…¶ä¸­$r=rank(A)$ã€‚ å°†$r$ä¸ªå¥‡å¼‚å€¼ï¼ˆå³éé›¶ç‰¹å¾å€¼å¼€æ ¹å·ï¼‰ä»å¤§åˆ°å°æ’åˆ—ç»„æˆå¯¹è§’çŸ©é˜µï¼Œå†æ·»åŠ é¢å¤–çš„$0$æ„æˆ$\\Sigma_{m\\times n}$çŸ©é˜µã€‚ æ±‚ç‰¹å¾å€¼ï¼š$\\lambda_1,â€¦,\\lambda_r,\\lambda_{r+1}=0,â€¦,\\lambda_n=0$å¯¹åº”çš„ç‰¹å¾å‘é‡$\\xi_1,â€¦,\\xi_n$ï¼šå½“$\\lambda=\\lambda_1$æ—¶ï¼Œ$(\\lambda I-A^HA)\\times \\xi_1=0$ï¼Œè§£å¾—$\\xi_1$ï¼ŒåŒç†ï¼Œè®¡ç®—å…¶ä½™ç‰¹å¾å‘é‡ã€‚ å› ä¸º$\\xi_1,â€¦,\\xi_n$ç›¸äº’æ­£äº¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œå•ä½åŒ–ï¼Œå¾—åˆ°$v_1,â€¦,v_n$ï¼Œå³$v_1=\\frac{\\xi_1}{||\\xi_1||},â€¦,v_n=\\frac{\\xi_n}{||\\xi_n||}$ã€‚åˆ™$V=(v_1,â€¦,v_n)$ã€‚ æ ¹æ®$A=U_{m\\times m}\\Sigma_{m\\times n}V_{n\\times n}^H$ï¼Œå¯å¾—$U_1=AV_{n\\times n}\\Sigma_{r\\times n}^{-1}$ï¼ˆæ³¨æ„ï¼Œ$\\sigma$æ­¤æ—¶ä¸º$\\Sigma_{m\\times n}$çš„å‰$r$è¡Œï¼‰ï¼Œæ˜“çŸ¥$U_1$ä¸º$m\\times r$çš„çŸ©é˜µï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰©å……$U_2$ï¼Œå…¶ä¸º$m\\times (m-r)$çŸ©é˜µã€‚ å–$U_1^HU_2=0$ï¼Œå–$U_2$ï¼Œå¿…é¡»è¦å•ä½åŒ–$U_2$ï¼Œè¿™æ ·$U=[U_1:U_2]$ åˆ™ Pythonæ±‚è§£å¥‡å¼‚å€¼åˆ†è§£ import numpy as np from sympy import Matrix import pprint A = np.array([[1,0],[0,1],[1,1]]) # æ±‚Açš„å¥‡å¼‚å€¼åˆ†è§£ U, sigma, VT = np.linalg.svd(A) print (\"U:\", U) print (\"sigma:\", sigma) print (\"VT:\", VT) ","date":"2023-12-01","objectID":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 6â€”çŸ©é˜µåˆ†è§£çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ï¼ˆé™„Pythonå®ç°ï¼‰","uri":"/posts/06.%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 HermiteçŸ©é˜µ å®šä¹‰ è®¾$A$ä¸º$n$é˜¶æ–¹é˜µï¼Œå¦‚æœç§°$A$ä¸ºHermiteçŸ©é˜µï¼Œåˆ™éœ€æ»¡è¶³$A^H=A$ï¼Œå…¶ä¸­$A^H$è¡¨ç¤º$A$çš„å…±è½­è½¬ç½®ï¼Œä¹Ÿç§°Hermiteè½¬ç½®ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š å°†çŸ©é˜µçš„æ¯ä¸ªå…ƒç´ å–å…±è½­ã€‚å¯¹äºå¤æ•°$a+bi$ï¼Œå®ƒçš„å…±è½­æ˜¯$a-bi$ï¼Œå…¶ä¸­$a$å’Œ$b$ æ˜¯å®éƒ¨å’Œè™šéƒ¨ å°†çŸ©é˜µçš„è¡Œå’Œåˆ—äº’æ¢ HermiteçŸ©é˜µä¸å®å¯¹ç§°çŸ©é˜µçš„æ€§è´¨å’Œè¯æ˜æ–¹æ³•éƒ½ååˆ†ç›¸ä¼¼ HermiteçŸ©é˜µæ€§è´¨ è‹¥$A,B$ä¸º$n$é˜¶HermiteçŸ©é˜µï¼Œåˆ™ $A$çš„æ‰€æœ‰ç‰¹å¾å€¼å…¨æ˜¯å®æ•° $A$çš„ä¸åŒç‰¹å¾å€¼æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡æ˜¯ç›¸äº’æ­£äº¤çš„ å¯¹æ­£æ•´æ•°$k$ï¼Œ$A^k$ä¹Ÿæ˜¯HermiteçŸ©é˜µ è‹¥$A$å¯é€†ï¼Œåˆ™$A^{-1}$ä¹Ÿæ˜¯HermiteçŸ©é˜µ å¯¹å®æ•°$k,p,kA+pB$ä¹Ÿæ˜¯HermiteçŸ©é˜µ HermiteçŸ©é˜µå……åˆ†å¿…è¦æ¡ä»¶ è®¾$A\\in C^{n\\times n},B\\in C^{n\\times n}$ $A$æ˜¯HermiteçŸ©é˜µçš„å……è¦æ¡ä»¶æ˜¯å­˜åœ¨é…‰çŸ©é˜µ$U$ä½¿å¾— å…¶ä¸­$\\lambda_1,â€¦,\\lambda_n$å‡ä¸ºå®æ•°ã€‚å®å¯¹ç§°çŸ©é˜µåˆ™æ˜¯å­˜åœ¨æ­£äº¤çŸ©é˜µ$Uâ€¦$ Aæ˜¯HermiteçŸ©é˜µçš„å……è¦æ¡ä»¶æ˜¯å¯¹ä»»æ„æ–¹é˜µ$S$ï¼Œ$S^HAS$æ˜¯HermiteçŸ©é˜µ å¦‚æœ$A,B$æ˜¯Hermiteé˜µï¼Œåˆ™$AB$æ˜¯HermiteçŸ©é˜µçš„å……è¦æ¡ä»¶æ˜¯$AB=BA$ ç›¸åˆæ ‡å‡†å½¢ è®¾$A$ä¸º$n$é˜¶HermiteçŸ©é˜µï¼Œåˆ™$A$ç›¸åˆçŸ©é˜µ å…¶ä¸­$r=rank(A)$ï¼Œ$s$æ˜¯$A$çš„æ­£ç‰¹å¾å€¼ï¼ˆé‡ç‰¹å¾å€¼æŒ‰é‡æ•°è®¡ç®—ï¼‰çš„ä¸ªæ•°ã€‚çŸ©é˜µ$D_0$åˆ™ç§°ä¸º$n$é˜¶HermiteçŸ©é˜µ$A$çš„ç›¸åˆæ ‡å‡†å½¢ã€‚ Sylvesteræƒ¯æ€§å®šå¾‹ è®¾$A,B$ä¸º$n$é˜¶HermiteçŸ©é˜µï¼Œåˆ™$A$ä¸$B$ç›¸åˆçš„å……è¦æ¡ä»¶æ˜¯ å…¶ä¸­$In(A)$ç§°ä¸º$A$çš„æƒ¯æ€§ï¼Œ$In(A)={\\pi(A),v(A),\\delta(A)}$ã€‚å…¶ä¸­$\\pi(A)$,$v(A)$,$\\delta(A)$åˆ†åˆ«è¡¨ç¤º$A$çš„æ­£ã€è´Ÿå’Œé›¶ç‰¹å¾å€¼çš„ä¸ªæ•°ï¼ˆé‡ç‰¹å¾å€¼æŒ‰é‡æ•°è®¡ç®—ï¼‰ã€‚åˆ™$A$éå¥‡å¼‚çš„å……è¦æ¡ä»¶ä¸º$\\delta(A)=0$ä¸”$\\pi(A)+v(A)=rank(A)$ã€‚ ","date":"2023-12-01","objectID":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 7â€”HermiteçŸ©é˜µä¸æ­£å®šçŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 HermiteäºŒæ¬¡å‹ HermiteäºŒæ¬¡å‹å®šä¹‰ ç”±$n$ä¸ªå¤å˜é‡$x_1,â€¦,x_n$ï¼Œç³»æ•°ä¸ºè´Ÿæ•°çš„äºŒæ¬¡é½å¼ å…¶ä¸­$a_{ij}=a_{ji}$ï¼Œç§°ä¸ºHermiteäºŒæ¬¡å‹ã€‚HermiteäºŒæ¬¡å‹å¯å†™ä¸º$f(x)=x^HAx$ï¼Œæˆ‘ä»¬ç§°$A$çš„ç§©å°±ä¸ºHermiteäºŒæ¬¡å‹çš„ç§©ã€‚ HermiteäºŒæ¬¡å‹çš„æ ‡å‡†å½¢å®šç† å¯¹HermiteäºŒæ¬¡å‹$f(x)=x^HAx$ï¼Œå­˜åœ¨é…‰çº¿æ€§å˜æ¢$x=Uy$ï¼ˆå…¶ä¸­$U$æ˜¯é…‰çŸ©é˜µï¼‰ä½¿å¾—HermiteäºŒæ¬¡å‹$f(x)$å˜æˆæ ‡å‡†å½¢ï¼ˆåªåŒ…å«å¹³æ–¹é¡¹çš„äºŒæ¬¡å‹ï¼‰ å…¶ä¸­$\\lambda_1,â€¦,\\lambda_n$ä¸º$A$çš„ç‰¹å¾å€¼ã€‚ HermiteäºŒæ¬¡å‹åŒ–æ ‡å‡†å½¢ï¼ˆé…‰çº¿æ€§å˜æ¢ï¼‰ è®¾$f(x)=x^HAx$ï¼Œå…¶ä¸­$A$ä¸º$n$é˜¶HermiteçŸ©é˜µ æ±‚å‡ºäºŒæ¬¡å‹çŸ©é˜µ$A$çš„ç‰¹å¾å€¼$\\lambda_1,â€¦\\lambda_n$å’Œç‰¹å¾å‘é‡$v_1,â€¦,v_n$ï¼Œå¹¶å°†ç‰¹å¾å‘é‡$v_1,â€¦,v_n$è§„èŒƒæ­£äº¤ ä»¤$U=(v_1,â€¦,v_n),x=Uy$ï¼Œåˆ™ HermiteäºŒæ¬¡å‹è§„èŒƒå½¢å®šç† å¯¹äºŒæ¬¡å‹$f(x)=x^HAx$ï¼Œå­˜åœ¨å¯é€†çº¿æ€§å˜æ¢$x=Py$ä½¿å¾—HermiteäºŒæ¬¡å‹$f(x)$åŒ–ä¸º å…¶ä¸­$r=rank(A),s=\\pi(A)$ã€‚ä¸Šå¼åˆ™ä¸ºHermiteäºŒæ¬¡å‹$f(x)$çš„è§„èŒƒå½¢ï¼Œå…¶ä¸­$s$å’Œ$(r-s)$åˆ†åˆ«ç§°ä¸ºHermiteäºŒæ¬¡å‹çš„æ­£æƒ¯æ€§æŒ‡æ•°å’Œè´Ÿæƒ¯æ€§æŒ‡æ•°ã€‚ äºŒæ¬¡å‹åŒ–è§„èŒƒå½¢ è®¾$f(x)=x^HAx$ï¼Œå…¶ä¸­$A$ä¸º$n$é˜¶HermiteçŸ©é˜µ å°†äºŒæ¬¡å‹åŒ–ä¸ºæ ‡å‡†å½¢ï¼Œå¾—åˆ°æ ‡å‡†å½¢$f(x)=y^H\\Lambda y$å’Œé…‰çŸ©é˜µ$U$ å°†å¯¹è§’çº¿å…ƒç´ æå–å‡ºæ¥ï¼Œå³åªä¿ç•™$\\lambda_i$çš„æ­£è´Ÿæ€§ï¼Œåˆ™ å…¶ä¸­$\\Lambda_1$ä¸ºå¯¹è§’çŸ©é˜µï¼Œå¯¹è§’çº¿å…ƒç´ ä¸º$\\sqrt {|\\lambda_i}|(1\\leq i \\leq n)$ã€‚ ä»¤$y=\\Lambda_1^{-1} z$ï¼Œåˆ™ æ•…$x=U\\Lambda^{-1}z$ï¼Œå¯é€†çŸ©é˜µ$P=U\\Lambda^{-1}$ æ­£å®šç›¸å…³æ¦‚å¿µ è®¾$f(x)=x^HAx$ä¸ºHermiteäºŒæ¬¡å‹ å¦‚æœ$f(x)\u003e0$ï¼ˆç­‰ä»·$s=r=n$ï¼‰ï¼Œåˆ™ç§°$f(x)$ä¸ºæ­£å®šçš„ï¼› å¦‚æœ$f(x)\\geq0$ï¼ˆç­‰ä»·$s=r\u003cn$ï¼‰ï¼Œåˆ™ç§°$f(x)$ä¸ºåŠæ­£å®šï¼ˆéè´Ÿå®šçš„ï¼‰çš„ï¼› å¦‚æœ$f(x)\u003c0$ï¼ˆç­‰ä»·$s=0,r=n$ï¼‰ï¼Œåˆ™ç§°$f(x)$ä¸ºè´Ÿå®šçš„ï¼› å¦‚æœ$f(x)\\leq0$ï¼ˆç­‰ä»·$s=0,r\u003cn$ï¼‰ï¼Œåˆ™ç§°$f(x)$ä¸ºåŠè´Ÿå®šçš„ï¼› å¦‚æœ$f(x)$æœ‰æ—¶ä¸ºæ­£æœ‰æ—¶ä¸ºè´Ÿï¼ˆç­‰ä»·$0\u003cs\u003cr\\leq n$ï¼‰ï¼Œåˆ™ç§°$f(x)$ä¸ºä¸å®šçš„ï¼› ","date":"2023-12-01","objectID":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 7â€”HermiteçŸ©é˜µä¸æ­£å®šçŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 Hermiteæ­£å®šï¼ˆéè´Ÿå®šçŸ©é˜µï¼‰ å®šä¹‰ æ ¹æ®HermiteäºŒæ¬¡å‹çš„æ­£å®šï¼ˆéè´Ÿå®šï¼‰å¯ä»¥å®šä¹‰HermiteçŸ©é˜µçš„æ­£å®šï¼ˆéè´Ÿå®šï¼‰ã€‚ è®¾$A$ä¸º$n$é˜¶HermiteçŸ©é˜µï¼Œ$f(x)=x^HAx$ å¦‚æœ$f(x)\u003e0$ï¼Œåˆ™ç§°$A$ä¸ºæ­£å®šçš„ï¼Œè®°ä½œ$A\u003e0$ï¼› å¦‚æœ$f(x)\\geq0$ï¼Œåˆ™ç§°$A$ä¸ºåŠæ­£å®šï¼ˆéè´Ÿå®šçš„ï¼‰çš„ï¼Œè®°ä½œ$A\\geq 0$ï¼› å¦‚æœ$f(x)\u003c0$ï¼Œåˆ™ç§°$A$ä¸ºè´Ÿå®šçš„ï¼Œè®°ä½œ$A\u003c0$ï¼› å¦‚æœ$f(x)\\leq0$ï¼Œåˆ™ç§°$A$ä¸ºåŠè´Ÿå®šçš„ï¼Œè®°ä½œ$A\\leq 0$ï¼› å¦‚æœ$f(x)$æœ‰æ—¶ä¸ºæ­£æœ‰æ—¶ä¸ºè´Ÿï¼Œåˆ™ç§°$A$ä¸ºä¸å®šçš„ï¼› åˆ¤æ–­$n$é˜¶HermiteçŸ©é˜µ$A$æ­£å®š é€šè¿‡æ­£å®šçŸ©é˜µçš„å®šä¹‰ $A$çš„$n$ä¸ªç‰¹å¾å€¼å‡ä¸ºæ­£æ•° $A$çš„é¡ºåºä¸»å­å¼å‡ä¸ºæ­£æ•° $A$çš„æ‰€æœ‰ä¸»å­å¼å…¨å¤§äº$0$ å­˜åœ¨$n$é˜¶éå¥‡å¼‚ä¸‹ä¸‰è§’çŸ©é˜µ$L$ï¼Œä½¿å¾—$A=LL^H$ï¼ˆè¯¥åˆ†è§£ç§°ä¸ºCholeskyåˆ†è§£ï¼‰ å­˜åœ¨$n$é˜¶éå¥‡å¼‚çŸ©é˜µï¼Œä½¿å¾—$A=B^HB$ å­˜åœ¨$n$é˜¶éå¥‡å¼‚HermiteçŸ©é˜µ$A=S^2$ åˆ¤æ–­$n$é˜¶HermiteçŸ©é˜µ$A$åŠæ­£å®š é€šè¿‡åŠæ­£å®šçŸ©é˜µçš„å®šä¹‰ $A$çš„$n$ä¸ªç‰¹å¾å€¼å‡ä¸ºéè´Ÿæ•° $A$çš„æ‰€æœ‰ä¸»å­å¼å‡éè´Ÿ å®šç†è¯æ˜ è®¾$A,B$å‡ä¸º$n$é˜¶HermiteçŸ©é˜µï¼Œä¸”$B\u003e0$ï¼Œåˆ™å­˜åœ¨éå¥‡å¼‚çŸ©é˜µ$P$ä½¿å¾— å…¶ä¸­$\\lambda_1,â€¦,\\lambda_n$æ˜¯å¹¿ä¹‰ç‰¹å¾å€¼é—®é¢˜çš„ç‰¹å¾å€¼ è¯æ˜ï¼š $\\because B \u003e0$ $\\therefore $å­˜åœ¨éå¥‡å¼‚çŸ©é˜µ$P_1$ä½¿å¾—$P_1^HBP_1=I$ åˆ$\\because P_1^HAP_1$ä»ä¸ºHermiteçŸ©é˜µ $\\therefore$é…‰çŸ©é˜µ$U$ä½¿å¾— ä»¤$P=P_1U$ $\\because P$éå¥‡å¼‚ï¼Œæ ¹æ®å®šç†$P^HBP=I$ $\\therefore P^HBP=(P_1U)^HB(P_1U)=U^HP_1^HBP_1U=I$ åˆ$\\because P_1$éå¥‡å¼‚ï¼Œä½¿å¾—$P_1^HBP_1=I$ $\\therefore$ $\\therefore$ $\\therefore$æˆ‘ä»¬å¯ä»¥å¯¹$(12)$å³ä¹˜$P^{-1}$å’Œ$B^{-1}$ï¼Œå¾—åˆ° $\\therefore $å°†$(14)$ä»£å…¥$(13)$ä¸­å¾—åˆ° å³$B^{-1}A$ç›¸ä¼¼äºå¯¹è§’çŸ©é˜µï¼Œæ•…$\\lambda_1,â€¦,\\lambda_n$æ˜¯çŸ©é˜µ$B^{-1}A$çš„ç‰¹å¾å€¼ï¼Œå³$\\lambda_1,â€¦,\\lambda_n)$æ˜¯å¹¿ä¹‰ç‰¹å¾å€¼é—®é¢˜çš„ç‰¹å¾å€¼ã€‚ å¹¿ä¹‰ç‰¹å¾å€¼é—®é¢˜$Ax=\\lambda Bx$ï¼Œå·¦ä¹˜$B^{-1}$ï¼Œå³ä¸º$B^{-1}Ax=\\lambda x$ ","date":"2023-12-01","objectID":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 7â€”HermiteçŸ©é˜µä¸æ­£å®šçŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 çŸ©é˜µä¸ç­‰å¼ å®šä¹‰ è®¾$A,B$éƒ½æ˜¯$n$é˜¶HermiteçŸ©é˜µï¼Œå¦‚æœ$A-B\\geq 0$åˆ™ç§°$A$å¤§äºæˆ–ç­‰äº$B$ï¼ˆæˆ–ç§°$B$å°äºç­‰äº$A$ï¼‰ï¼Œè®°ä½œ$A\\geq B$ï¼ˆæˆ–$B\\leq A$ï¼‰ï¼Œå³$A-B$åŠæ­£å®šï¼›å¦‚æœ$A-B\u003e0$ï¼Œåˆ™ç§°$A$å¤§äº$B$ï¼ˆæˆ–ç§°$B$å°äº$A$ï¼‰ï¼Œè®°ä½œ$A\u003eB$ï¼ˆæˆ–$B\u003cA$ï¼‰ï¼Œå³$A-B$æ­£å®šã€‚ æ€§è´¨ è®¾$A,B,C$å‡ä¸º$n$é˜¶HermiteçŸ©é˜µï¼Œåˆ™ $A\\geq B(A\u003eB) \\Longleftrightarrow-A\\leq -B(-A\u003c-B)\\Longleftrightarrow$å¯¹ä»»æ„$n$é˜¶å¯é€†çŸ©é˜µ$P$éƒ½æœ‰$P^HAP\\geq P^HBP(P^HAP\u003eP^HBP)$ è‹¥$A\u003e0(A\\geq 0),C\u003e0(C\\geq 0)$ï¼Œä¸”$AC=CA$ï¼Œåˆ™$AC\u003e0(AC\\geq 0)$ è‹¥$A\u003eB$ï¼Œ$P$ä¸º$n\\times m$åˆ—æ»¡ç§©çŸ©é˜µï¼Œåˆ™$P^HAP\u003eP^HBP$ è‹¥$A\\geq B$ï¼Œ$P$ä¸º$n\\times m$çŸ©é˜µï¼Œåˆ™$P^HAP\\geq P^HBP$ å®šç† è®¾$A,B$éƒ½æ˜¯$n$é˜¶HermiteçŸ©é˜µï¼Œä¸”$A\\geq 0,B\u003e0$ï¼Œåˆ™ $B\\geq A$çš„å……è¦æ¡ä»¶æ˜¯$\\rho(AB^{-1})\\leq 1$ $B\u003eA$çš„å……è¦æ¡ä»¶æ˜¯$\\rho(AB^{-1})\u003c1$ è®¾$A$æ˜¯$n$é˜¶HermiteçŸ©é˜µï¼Œåˆ™$\\lambda_{min}(A)I\\leq A\\leq\\lambda_{max}I$ï¼Œè¿™æ—¶$\\lambda_{min}$å’Œ$\\lambda_{max}$åˆ†åˆ«è¡¨ç¤º$A$çš„æœ€å¤§å’Œæœ€å°ç‰¹å¾å€¼ã€‚ è®¾$A,B$å‡ä¸º$n$é˜¶Hermiteæ­£å®šçŸ©é˜µï¼Œåˆ™ è‹¥$A\\geq B\u003e0$ï¼Œåˆ™$B^{-1}\\geq A^{-1}\u003e0$ è‹¥$A\u003eB\u003e0$ï¼Œåˆ™$B^{-1}\u003eA^{-1}\u003e0$ è®¾$A,B$å‡ä¸º$n$é˜¶Hermiteæ­£å®šçŸ©é˜µï¼Œä¸”$AB=BA$ï¼Œåˆ™ è‹¥$A\\geq B$ï¼Œåˆ™$A^2\\geq B^2$ è¯æ˜ï¼š$A^2-B^2=(A-B)(A+B)=(A+B)(A-B)$ï¼Œæ˜“çŸ¥$(A-B)\\geq0,A+B\u003e0$ï¼Œåˆ™å…‹åˆ¶ è‹¥$A\\geq B$ï¼Œåˆ™$A^2\u003e B^2$ åŒç†å¾—è¯ è®¾$A$æ˜¯$m\\times n$è¡Œæ»¡ç§©çŸ©é˜µï¼Œ$B$æ˜¯$n\\times k$çŸ©é˜µï¼Œåˆ™ $$ B^HB\\geq (AB)^H(AA^H)^{-1}(AB) $$ ç­‰å·æˆç«‹å½“ä¸”ä»…å½“å­˜åœ¨ä¸€ä¸ª$m\\times k$çŸ©é˜µ$C$ä½¿å¾—$B=A^HC$ ","date":"2023-12-01","objectID":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 7â€”HermiteçŸ©é˜µä¸æ­£å®šçŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/07.hermite%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 å‘é‡èŒƒæ•° å‘é‡èŒƒæ•°å®šä¹‰ è®¾$V$æ˜¯æ•°åŸŸ$P$ä¸Šçš„çº¿æ€§ç©ºé—´ï¼Œ$||x||$æ˜¯ä»¥$V$ä¸­çš„å‘é‡$x$ä¸ºè‡ªå˜é‡çš„éè´Ÿå®å€¼å‡½æ•°ï¼Œå¦‚æœæ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š éè´Ÿæ€§ï¼š$||x||\\geq 0$ï¼Œä¸”$||x||=0$å½“ä¸”ä»…å½“$x=0$ é½æ¬¡æ€§ï¼š$\\forall \\alpha \\in P,x\\in V$ï¼Œæœ‰$||\\alpha x||=|\\alpha|||x||$ ä¸‰è§’ä¸ç­‰å¼ï¼š$\\forall x,y \\in V$ï¼Œæœ‰$||x+y||\\leq ||x||+||y||$ åˆ™ç§°$||x||$ä¸ºå‘é‡$x$çš„èŒƒæ•°ï¼Œå¹¶ç§°å®šä¹‰äº†èŒƒæ•°çš„çº¿æ€§ç©ºé—´ä¸ºèµ‹èŒƒçº¿æ€§ç©ºé—´ã€‚ $1$èŒƒæ•°ï¼Œ$2$èŒƒæ•°ã€$\\infty$èŒƒæ•°å’Œ$p$èŒƒæ•° åœ¨$n$ç»´å‘é‡ç©ºé—´$C^n$ä¸­ï¼Œå¯¹ä»»æ„å‘é‡$x=(x_1,â€¦,x_n)^T\\in C^n$ $1$èŒƒæ•°ï¼š $2$èŒƒæ•°ï¼š $\\infty$èŒƒæ•°ï¼š $p$èŒƒæ•°ï¼š åˆ©ç”¨å·²çŸ¥èŒƒæ•°æ„é€ æ–°èŒƒæ•° è®¾æ˜¯$C^m$ä¸Šçš„å‘é‡èŒƒæ•°ï¼Œ$A\\in C^{m\\times n}$ä¸”$rank(A)=n$ï¼Œåˆ™ç”±æ‰€å®šä¹‰çš„$||\\cdot||$æ˜¯$C^n$ä¸Šçš„å‘é‡èŒƒæ•° æ€§è´¨ å‘é‡èŒƒæ•°çš„ç­‰ä»·å…·æœ‰è‡ªåæ€§ã€å¯¹ç§°æ€§å’Œä¼ é€’æ€§ æœ‰é™ç»´çº¿æ€§ç©ºé—´$V$ä¸Šçš„ä»»æ„ä¸¤ä¸ªå‘é‡èŒƒæ•°éƒ½æ˜¯ç­‰ä»·çš„ ","date":"2023-12-01","objectID":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 8â€”èŒƒæ•°ä¸æé™çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 çŸ©é˜µèŒƒæ•° çŸ©é˜µèŒƒæ•°å®šä¹‰ è®¾$||A||$æ˜¯ä»¥$C^{m\\times n}$ä¸­çš„çŸ©é˜µ$A$ä¸ºè‡ªå˜é‡çš„éè´Ÿå®å€¼å‡½æ•°ï¼Œå¦‚æœæ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼š éè´Ÿæ€§ï¼š$||A||\\geq 0$ï¼Œä¸”$||A||=0$å½“ä¸”ä»…å½“$A=0$ é½æ¬¡æ€§ï¼š$\\forall \\alpha \\in C,A\\in C^{m\\times n}$ï¼Œæœ‰$||\\alpha A||=|\\alpha|||A||$ ä¸‰è§’ä¸ç­‰å¼ï¼š$\\forall A,B \\in C^{m\\times n}$ï¼Œæœ‰$||A+B||\\leq ||A||+||B||$ ç›¸å®¹æ€§ï¼š$\\forall A,B \\in C^{m\\times n}$ï¼Œæœ‰$||AB||\\leq ||A||\\space ||B||$ åˆ™ç§°$||A||$ä¸º$m\\times n$çŸ©é˜µ$A$çš„èŒƒæ•° å®šç† è®¾$A=(a_{ij})\\in C^{n\\times n}$ï¼Œåˆ™ç”±$l_1,l_2,l_{\\infty}$å‘é‡èŒƒæ•°å„è‡ªæ¨å¯¼å¾—åˆ°çš„çŸ©é˜µèŒƒæ•° è¡Œå’ŒèŒƒæ•°ï¼š åˆ—å’ŒèŒƒæ•°ï¼š è°±èŒƒæ•°ï¼š $F$èŒƒæ•°ï¼š Pythonæ±‚è§£çŸ©é˜µèŒƒæ•° import numpy as np A = np.matrix([[-1, -1, 4], [1, 1, 2], [1, -2, 2]]) # è¡¨ç¤ºå¤æ•°çŸ©é˜µ[[1, -1, 1], [-i, 0, 2i], [1, 1, 1]] B = np.matrix([[1, -1, 1], [-1j, 0, 2j], [1, 1, 1]]) # æ±‚Açš„çŸ©é˜µèŒƒæ•°ï¼Œordåˆ†åˆ«ä¸º1ï¼Œ2ï¼Œnp.infï¼ŒF print(\"AèŒƒæ•°\") print(\"Açš„1èŒƒæ•°ï¼ˆåˆ—å’ŒèŒƒæ•°ï¼‰ï¼š\", np.linalg.norm(A, ord=1)) print(\"Açš„2èŒƒæ•°ï¼ˆè°±èŒƒæ•°ï¼‰ï¼š\", np.linalg.norm(A, ord=2)) print(\"Açš„æ— ç©·èŒƒæ•°ï¼ˆè¡Œå’ŒèŒƒæ•°ï¼‰ï¼š\", np.linalg.norm(A, ord=np.inf)) print(\"Açš„FèŒƒæ•°ï¼š\", np.linalg.norm(A, ord='fro')) print(\"BèŒƒæ•°\") print(\"Bçš„1èŒƒæ•°ï¼ˆåˆ—å’ŒèŒƒæ•°ï¼‰ï¼š\", np.linalg.norm(B, ord=1)) print(\"Bçš„2èŒƒæ•°ï¼ˆè°±èŒƒæ•°ï¼‰ï¼š\", np.linalg.norm(B, ord=2)) print(\"Bçš„æ— ç©·èŒƒæ•°ï¼ˆè¡Œå’ŒèŒƒæ•°ï¼‰ï¼š\", np.linalg.norm(B, ord=np.inf)) print(\"Bçš„FèŒƒæ•°ï¼š\", np.linalg.norm(B, ord='fro')) ","date":"2023-12-01","objectID":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 8â€”èŒƒæ•°ä¸æé™çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 çŸ©é˜µåºåˆ— çŸ©é˜µåºåˆ—çš„æ”¶æ•› è®¾æœ‰çŸ©é˜µåºåˆ—${A^{(k)}}$ï¼Œå…¶ä¸­$A^{(k)}=(a_{ij}^{(k)})\\in C^{m\\times n}$ï¼Œå¦‚æœå½“$k\\rightarrow \\infty$æ—¶ï¼ŒçŸ©é˜µ$A^{(k)}$çš„æ¯ä¸€ä¸ªå…ƒç´ $a_{ij}^{(k)}$éƒ½æœ‰æé™$a_{ij}$ï¼Œå³ $$ \\lim_{k\\rightarrow \\infty}a_{ij}^{(k)}=a_{ij},1\\leq i\\leq m;1\\leq j\\leq n $$ åˆ™ç§°çŸ©é˜µåºåˆ—${A^{(k)}}$æ˜¯æ”¶æ•›çš„ï¼Œå¹¶æŠŠçŸ©é˜µ$A=(a_{ij})\\in C^{m\\times n}$ç§°ä¸º${A^{(k)}}$çš„æé™ã€‚ å®šç† è®¾$A\\in C^{n\\times n}$ï¼Œ$\\lim_{k\\rightarrow \\infty}A^k=0$çš„å……è¦æ¡ä»¶æ˜¯$\\rho(A)\u003c1$ã€‚å…¶ä¸­$\\rho(A)$ä¸º$A$çš„è°±åŠå¾„ï¼Œå³æ‰€æœ‰ç‰¹å¾å€¼çš„ç»å¯¹å€¼çš„æœ€å¤§å€¼ã€‚ ","date":"2023-12-01","objectID":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 8â€”èŒƒæ•°ä¸æé™çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 çŸ©é˜µçº§æ•° çŸ©é˜µçº§æ•°å®šä¹‰ è®¾æœ‰çŸ©é˜µåºåˆ—${A^{(k)}}\\in C^{m\\times n}$ï¼Œåˆ™æ— ç©·å’Œ$A^{(1)}+A^{(2)}+â€¦+A^{(k)}+â€¦$ç§°ä¸ºçŸ©é˜µçº§æ•°ï¼Œè®°ä¸º$\\sum_{k=1}^{\\infty}A^{(k)}$ã€‚ç”±å®šä¹‰å¯çŸ¥ï¼ŒçŸ©é˜µçº§æ•°æ”¶æ•›çš„å……è¦æ¡ä»¶æ˜¯$mn$ä¸ªæ•°é¡¹çº§æ•°$\\sum_{k=1}^\\infty a_{ij}^{(k)}(1\\leq i\\leq m, 1\\leq j \\leq n)$éƒ½æ”¶æ•›ï¼Œå¦‚æœå®ƒä»¬éƒ½ç»å¯¹æ”¶æ•›ï¼Œåˆ™ç§°çŸ©é˜µçº§æ•°ç»å¯¹æ”¶æ•›ã€‚ å®šç† çŸ©é˜µçº§æ•°$\\sum_{k=1}^{\\infty}A^{(k)}$ç»å¯¹æ”¶æ•›çš„å……è¦æ¡ä»¶æ˜¯æ•°é¡¹çº§æ•°$\\sum_{k=1}^{\\infty}||A^{(k)}||$ï¼Œå…¶ä¸­$||\\cdot ||$æ˜¯$C^{m\\times n}$ä¸Šçš„ä»»ä¸€çŸ©é˜µèŒƒæ•°ã€‚ çŸ©é˜µå¹‚çº§æ•°å®šä¹‰ è®¾$A\\in C^{n\\times n}$ï¼Œå½¢å¦‚ $$ \\sum_{k=0}^{\\infty}c_kA^{k}=c_0I+c_1A+c_2A^2+\\cdots+c_kA^k+\\cdots $$ çš„çŸ©é˜µçº§æ•°ç§°ä¸ºçŸ©é˜µå¹‚çº§æ•°ã€‚ å®šç† è®¾$A\\in C^{n\\times n}$ï¼Œå¹¶ä¸”å¹‚çº§æ•°$\\sum_{k=0}^{\\infty}c_kx^k$çš„æ”¶æ•›åŠå¾„ä¸º$R$ï¼Œå¦‚æœ$\\rho(A)\u003cR$ï¼Œåˆ™çŸ©é˜µå¹‚çº§æ•°$\\sum_{k=0}^{\\infty}c_kA^k$ç»å¯¹æ”¶æ•›ï¼›å¦‚æœ$\\rho(A)\u003eR$ï¼Œåˆ™çŸ©é˜µå¹‚çº§æ•°$\\sum_{k=0}^{\\infty}c_kA^k$å‘æ•£ã€‚ æ±‚æ”¶æ•›åŠå¾„ è®¾å¹‚çº§æ•°$\\sum_{k=0}^{\\infty}c_kx^k$ æ¯”å€¼æ³• $R=\\lim_{n\\rightarrow \\infty}|\\frac{a_n}{a_{n+1}}|$ æ ¹å¼æ³• $R=\\lim_{n\\rightarrow \\infty}|\\frac{1}{\\sqrt[n]{a_n}}|$ ä¾‹é¢˜ Given For $T\u003e0$, find the radius of covergence for $$ s(z)=\\sum_{k=0}^{\\infty}\\frac{1}{(T^3+\\frac{3}{k^2+3})^{\\frac{k}{3}}}z^k $$ Let $h(z)=s(2z-T)$. Decide when the matrix power series $h(A)$ converges absolutely. Solution: For $s(z)$: $R=\\lim_{k\\rightarrow \\infty}\\frac{(T^3+\\frac{3}{(k+1)^2+3})^{\\frac{k+1}{3}}}{(T^3+\\frac{3}{k^2+3})^{\\frac{k}{3}}}=\\lim_{k\\rightarrow \\infty}\\frac{(T^3)^{\\frac{k+1}{3}}}{(T^3)^\\frac{k}{3}}=T$ So for matrix $2A-TI$, we can determine $|\\lambda I-2A+TI|=(\\lambda -2+T)^2(\\lambda -6 + T)=0$, The eigenvalues are solved as: $2-T,2-T,6-T$. From , so when $T\u003e3$, $h(A)$ converges absolutly. ","date":"2023-12-01","objectID":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 8â€”èŒƒæ•°ä¸æé™çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"5 çŸ©é˜µå‡½æ•° çŸ©é˜µå‡½æ•°å®šä¹‰ è®¾$A\\in C^{n\\times n}$ï¼Œä¸€å…ƒå‡½æ•°$f(z)$èƒ½å¤Ÿå±•å¼€ä¸º$z$çš„å¹‚çº§æ•°$f(z)=\\sum_{k=0}^\\infty c_kz^k$ï¼Œå¹¶ä¸”è¯¥å¹‚çº§æ•°çš„æ”¶æ•›åŠå¾„ä¸º$R$ã€‚å½“çŸ©é˜µ$A$çš„è°±åŠå¾„$\\rho(A)\u003cR$æ—¶ï¼Œåˆ™å°†æ”¶æ•›çŸ©é˜µå¹‚çº§æ•°$\\sum_{k=0}^{\\infty}c_kA^k$çš„å’Œå®šä¹‰ä¸ºçŸ©é˜µå‡½æ•°ï¼Œè®°ä¸º$f(A)$ï¼Œå³$f(A)=\\sum_{k=0}^{\\infty}c_kA^k$ã€‚ å¸¸è§çŸ©é˜µå‡½æ•° çŸ©é˜µæŒ‡æ•°å‡½æ•°ï¼š$e^A=\\sum_{k=0}^\\infty \\frac{1}{k!}A^k=I+A+\\frac{1}{2!}+\\cdots+\\frac{1}{n!}A^n+\\cdots$ çŸ©é˜µæ­£å¼¦å‡½æ•°ï¼š$sinA=\\sum_{k=0}^\\infty \\frac{(-1)^k}{(2k+1)!}A^{2k+1}=A-\\frac{1}{3!}A^3+\\frac{1}{5!}A^5-\\cdots+(-1)^n\\frac{1}{(2n+1)!}A^{2n+1}$ çŸ©é˜µä½™å¼¦å‡½æ•°ï¼š$cosA=\\sum_{k=0}^\\infty \\frac{(-1)^k}{(2k)!}A^{2k}=A-\\frac{1}{2!}A^2+\\frac{1}{4!}A^4-\\cdots+(-1)^n\\frac{1}{(2n)!}A^{2n}$ å®šç† è®¾$A,B\\in C^{n\\times n}$ï¼Œå¦‚æœ$AB=BA$ï¼Œåˆ™$e^Ae^B=e^Be^A=e^{A+B}$ã€‚ åˆ©ç”¨Jordanæ ‡å‡†å‹æ±‚çŸ©é˜µå‡½æ•°$f(A)$ æ±‚å‡ºçŸ©é˜µ$A$çš„è‹¥å½“æ ‡å‡†å‹$J$å’Œå¯é€†çŸ©é˜µ$P,P^{-1}$ï¼Œå…¶ä¸­$J=diag(J_1,J_2,\\cdots,J_s)$ è®¡ç®— åˆ™ ","date":"2023-12-01","objectID":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/:5:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 8â€”èŒƒæ•°ä¸æé™çŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/08.%E8%8C%83%E6%95%B0%E4%B8%8E%E6%9E%81%E9%99%90/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"Hermiteæ ‡å‡†å‹å®é™…ä¸Šå°±æ˜¯è¡Œæœ€ç®€è¡Œ ","date":"2023-12-01","objectID":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/:0:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 9â€”å¹¿ä¹‰é€†çŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"1 å¹¿ä¹‰é€†çŸ©é˜µå®šä¹‰ å¹¿ä¹‰é€†çŸ©é˜µ$G$çš„å®šä¹‰ï¼šå¯¹ä»»æ„$m\\times n$çŸ©é˜µçš„$A$ï¼Œå¦‚æœå­˜åœ¨æŸä¸ª$n\\times m$çš„çŸ©é˜µ$G$ï¼Œæ»¡è¶³Penroseæ–¹ç¨‹çš„ä¸€éƒ¨åˆ†æˆ–å…¨éƒ¨ï¼Œåˆ™ç§°$G$ä¸º$A$çš„å¹¿ä¹‰é€†çŸ©é˜µ Penroseæ–¹ç¨‹çš„å››ä¸ªæ¡ä»¶ï¼š $AGA=A$; $GAG=G$; $(AG)^T=AG$; $(GA)^T=GA$ æ»¡è¶³ç¬¬$i$ä¸ªæ¡ä»¶ï¼Œåˆ™æŠŠ$G$è®°ä¸º$A^{(i)}$ï¼Œè¿™ç±»çŸ©é˜µçš„å…¨ä½“è®°ä¸º$A{i}$ï¼Œæ‰€ä»¥$A^{i}\\in A{i}$ ç±»ä¼¼ï¼Œæ»¡è¶³ç¬¬$i,j$ä¸ªæ¡ä»¶ï¼š$A^{i,j}\\in A{i,j}$ æ ¹æ®ä»¥ä¸Šï¼Œæ»¡è¶³$1$ä¸ªï¼Œ$2$ä¸ªï¼Œ$3$ä¸ªï¼Œ$4$ä¸ªPenroseæ–¹ç¨‹çš„å¹¿ä¹‰é€†çŸ©é˜µæœ‰$C_4^1+C_4^2+C_4^3+C_4^4=4+6+4+1=15$ï¼Œä½†åº”ç”¨æœ€å¤šçš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€å­¦çš„ä»¥ä¸‹å››ç§ï¼š å‡å·é€†æˆ–è€…$g$é€†ï¼š$A^-=A^{(1)}$ æœ€å°äºŒä¹˜å¹¿ä¹‰é€†ï¼š$A_l^-=A^{(1,3)}$ æå°èŒƒæ•°å¹¿ä¹‰é€†ï¼š$A_m^-=A^{(1,4)}$ åŠ å·é€†æˆ–Moore-Penroseå¹¿ä¹‰é€†ï¼š$A^+=A^{(1,2,3,4)}$ ","date":"2023-12-01","objectID":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/:1:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 9â€”å¹¿ä¹‰é€†çŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"2 å‡å·é€† $A^-$çš„æ€§è´¨ è®¾$A$ä¸º$m\\times n$çŸ©é˜µï¼Œ$P$å’Œ$Q$åˆ†åˆ«æ˜¯$m$é˜¶å’Œ$n$é˜¶éå¥‡å¼‚æ–¹é˜µï¼Œä¸”$B=PAQ$ï¼Œ$A^-$ä¸ºAçš„å‡å·é€†ï¼Œåˆ™ï¼š $rank(A)\\leq rank(A^-)$ $AA^-$å’Œ$A^-A$æ˜¯å¹‚ç­‰çŸ©é˜µï¼Œå¹¶ä¸”$rank(AA^-)=rank(A^-A)=rank(A)$ $Q^{-1}A^-P^{-1}\\in B{1}$ $A^T{1}={G^T|G\\in A{1}}$ ï¼ˆPenroseå®šç†ï¼‰ è®¾$A,B,C$åˆ†åˆ«ä¸º$m\\times n,p\\times q,m\\times q$çŸ©é˜µï¼Œåˆ™çŸ©é˜µæ–¹ç¨‹ï¼š $$ AXB=C $$ æœ‰è§£çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ï¼š $$ AA^-CB^-B=C $$ å¹¶ä¸”åœ¨æœ‰è§£çš„æƒ…å†µä¸‹ï¼Œå…¶é€šè§£ä¸ºï¼š $$ X=A^-CB^-+Y-A^-AYBB^- $$ å…¶ä¸­$Y\\in R^{n\\times p}$æ˜¯ä»»æ„çš„çŸ©é˜µã€‚ æ±‚è§£$A^-$ $A$ä¸º$m\\times n$çŸ©é˜µ ï¼Œå…¶ä¸­$P,Q,E_r$é€šè¿‡å¯¹$A$è¿›è¡Œå¦‚ä¸‹æ“ä½œå¾—åˆ°ï¼Œ$G_{12},G_{21},G_{22}$å‡ä¸ºå¸¸æ•°çŸ©é˜µï¼Œæ¯ä¸€é¡¹å‡ç”¨$g_{ij}$è¡¨ç¤ºå¸¸æ•°ï¼Œä¸”$Q,P$ç»´åº¦å‡ä¸º$m\\times n$ï¼Œ$E_r$æ˜¯ä¸€ä¸ª$r \\times r$ çš„å¯¹è§’çŸ©é˜µï¼Œå…¶ä¸­$r$æ˜¯çŸ©é˜µ$A$çš„ç§©ï¼Œ$G_{12}$ç»´åº¦ä¸º$m \\times (n-r)$ ï¼Œ$G_{21}$ç»´åº¦ä¸º$(m-r) \\times n$ï¼Œ$G_{22}$æ˜¯ä¸€ä¸ª$ (m-r) \\times (n-r)$çš„çŸ©é˜µã€‚ ä¾‹å­ åˆç­‰è¡Œå˜æ¢åŒ–ä¸ºè¡Œæœ€ç®€é˜¶æ¢¯å½¢çŸ©é˜µï¼Œåˆ™ å†è¿›è¡Œåˆ—å˜æ¢åŒ–ä¸º$E_r$å¾—åˆ° åˆ™ ä»¤$g_{ij}=0$ï¼Œåˆ™ åˆ©ç”¨$A^-$æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$ $Ax=b$æœ‰è§£çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯$AA^-b=b$ï¼Œè¿™æ—¶ç‰¹è§£$x_0=A^-b$ï¼Œé€šè§£$x=A^-b+(I-A^-A)y,\\forall y\\in C^n$ è¿™é‡Œä¸ç»™å‡º$A^-$ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªå·±å»å®ç°ï¼Œå…·ä½“çš„ç®—æ³•å¦‚ä¸‹ï¼š æ„é€ æ°´å¹³å¢å¹¿çŸ©é˜µï¼š å°†åŸçŸ©é˜µå’Œå•ä½çŸ©é˜µæ°´å¹³æ‹¼æ¥ï¼Œå½¢æˆå¢å¹¿çŸ©é˜µã€‚ åˆç­‰è¡Œå˜æ¢ï¼š åˆ©ç”¨åˆç­‰è¡Œå˜æ¢å°†å¢å¹¿çŸ©é˜µè½¬åŒ–ä¸ºæœ€ç®€è¡Œé˜¶æ¢¯å½¢å¼ã€‚ æå–$P$ï¼šå˜æ¢åçš„å•ä½çŸ©é˜µå°±æ˜¯$P$ æ„é€ å‚ç›´å¢å¹¿çŸ©é˜µï¼šå†å°†æœ€ç®€è¡Œé˜¶æ¢¯å½¢ä¸å•ä½çŸ©é˜µå‚ç›´æ‹¼æ¥ï¼Œå½¢æˆå¢å¹¿çŸ©é˜µã€‚ åˆç­‰åˆ—å˜æ¢ï¼Œæå–$G$ï¼šå˜æ¢åçš„å•ä½çŸ©é˜µå°±æ˜¯$G$ ","date":"2023-12-01","objectID":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/:2:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 9â€”å¹¿ä¹‰é€†çŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"3 æœ€å°äºŒä¹˜å¹¿ä¹‰é€† å®šç†1 è®¾$A\\in C^{m\\times n}$ï¼Œ$G\\in A{1,3}$çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯$G$æ»¡è¶³ $$ A^HAG=A^H $$ è¿™å³ä¸º$A{1,3}$ï¼ˆæœ€å°äºŒä¹˜å¹¿ä¹‰é€†ï¼‰çš„é€šå¼ å®šç†2 è®¾$A\\in C^{m\\times n}$ï¼Œ$A_l^-$æ˜¯$A$çš„ä»»ä¸€æœ€å°äºŒä¹˜å¹¿ä¹‰é€†ï¼Œåˆ™ $$ A{1,3}={G\\in C^{n\\times m}|AG=AA_l^-} $$ å®šç†3 è®¾$A$æ˜¯$m\\times n$çŸ©é˜µï¼Œåˆ™$G\\in A{1,3}$ï¼ˆå³Gä¸ºæœ€å°äºŒä¹˜å¹¿ä¹‰é€†ï¼‰çš„å……åˆ†å¿…è¦æ¡ä»¶ä¸º$x=Gb$æ˜¯ä¸ç›¸å®¹çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$çš„æœ€å°äºŒä¹˜è§£ã€‚ åˆ©ç”¨$A_l^-$æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$ $x$æ˜¯ä¸ç›¸å®¹çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$çš„æœ€å°äºŒä¹˜è§£å½“ä¸”ä»…å½“$x$æ˜¯ç›¸å®¹çº¿æ€§æ–¹ç¨‹ç»„ $$ Ax=AA_l^-b $$ çš„è§£ï¼Œå¹¶ä¸”$Ax=b$çš„æœ€å°äºŒä¹˜è§£çš„é€šå¼ä¸º$x=A_l^-b+(I-A^-A)y,\\forall y\\in C^n$ ","date":"2023-12-01","objectID":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/:3:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 9â€”å¹¿ä¹‰é€†çŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"4 æå°èŒƒæ•°å¹¿ä¹‰é€† å®šç†1 è®¾$A\\in C^{m\\times n}$ï¼Œ$G\\in A{1,4}$çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯$G$æ»¡è¶³ $$ GAA^H=A^H $$ è¿™å³ä¸º$A{1,4}$ï¼ˆæå°èŒƒæ•°å¹¿ä¹‰é€†ï¼‰çš„é€šå¼ å®šç†2 è®¾$A\\in C^{m\\times n}$ï¼Œ$A_m^-$æ˜¯$A$çš„ä»»ä¸€æå°èŒƒæ•°å¹¿ä¹‰é€†ï¼Œåˆ™ $$ A{1,4}={G\\in C^{n\\times m}|GA=A_m^-A} $$ å®šç†$3$ è®¾$A$æ˜¯$m\\times n$çŸ©é˜µï¼Œåˆ™$G\\in A{1,4}$ï¼ˆå³Gä¸ºæå°èŒƒæ•°å¹¿ä¹‰é€†ï¼‰çš„å……åˆ†å¿…è¦æ¡ä»¶ä¸º$x=Gb$æ˜¯ç›¸å®¹çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$çš„æå°èŒƒæ•°è§£ã€‚ åˆ©ç”¨$A_m^-$æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$ è®¾$A$æ˜¯$m\\times n$çŸ©é˜µï¼Œåˆ™$G\\in A{1,4}$çš„å……åˆ†å¿…è¦æ¡ä»¶ä¸º$x=Gb$æ˜¯ç›¸å®¹çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$çš„æå°èŒƒæ•°è§£ï¼Œå³$x=A_m^-b$ä¸ºç›¸å®¹çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$çš„æå°èŒƒæ•°è§£ æ³¨æ„ï¼šæå°èŒƒæ•°è§£æ˜¯å”¯ä¸€çš„ï¼Œè€Œæœ€å°äºŒä¹˜è§£ä¸å”¯ä¸€ ","date":"2023-12-01","objectID":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/:4:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 9â€”å¹¿ä¹‰é€†çŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/"},{"categories":["è¯¾ç¨‹ç¬”è®°"],"content":"5 Moore-Penroseï¼ˆåŠ å·é€†ï¼‰ $A^+$çš„æ€§è´¨ $A^+$å­˜åœ¨ä¸”å”¯ä¸€ $A^+=A_m^-AA_l^-$ å®šç†1 è®¾$A$æ˜¯$m\\times n$çŸ©é˜µï¼Œåˆ™$G$æ˜¯åŠ å·é€†$A^+$çš„å……åˆ†å¿…è¦æ¡ä»¶ä¸º$x=Gb$æ˜¯ä¸ç›¸å®¹çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$çš„æå°æœ€å°äºŒä¹˜è§£ã€‚ é‡ç‚¹ å› ä¸ºåŠ å·é€†æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ˜¯å‡å·é€†ã€æœ€å°äºŒä¹˜å¹¿ä¹‰é€†ã€æå°èŒƒæ•°å¹¿ä¹‰é€†ã€‚æ‰€ä»¥ï¼š å½“$b\\in R(A)$æ—¶ï¼Œ$Ax=b$çš„é€šè§£ä¸ºï¼š $$ x=A^+b+(I-A^+A)y,\\forall y\\in R^n $$ å½“$b\\in R(A)$æ—¶ï¼Œ$Ax=b$çš„æå°èŒƒæ•°è§£ä¸ºï¼š $$ x=A^+b $$ æå°èŒƒæ•°è§£æ˜¯å”¯ä¸€çš„ å¯¹äº$\\forall b$ï¼Œ$Ax=b$çš„æœ€å°äºŒä¹˜è§£ä¸ºï¼š $$ x=A^+b+(I-A^+A)y,\\forall y\\in R^n $$ å¯¹äº$\\forall b$ï¼Œ$Ax=b$çš„å…·æœ‰æå°èŒƒæ•°çš„æœ€å°äºŒä¹˜è§£ä¸ºï¼š $$ x=A^+b $$ æ±‚è§£$A^+$ è‹¥$A$ä¸ºè¡Œæ»¡ç§©çŸ©é˜µï¼Œåˆ™ï¼š$A^+=A^H(AA^H)^{-1}$ è‹¥$A$ä¸ºåˆ—æ»¡ç§©çŸ©é˜µï¼šåˆ™ï¼š$A^+=(A^HA)^{-1}A^H$ å¦åˆ™åˆ©ç”¨æ»¡ç§©åˆ†è§£æ±‚è§£ï¼š$A^+=G^+F^+=G^H(GG^H)^{-1}(F^HF)^{-1}F^H$ Pythonä»£ç å¦‚ä¸‹ï¼š import numpy as np from sympy import Matrix, Symbol def get_A_plus(A): A_plus = None # åˆ¤æ–­Aæ˜¯è¡Œæ»¡ç§©è¿˜æ˜¯åˆ—æ»¡ç§©ï¼Œå¦‚æœéƒ½ä¸æ˜¯åˆ™åˆ©ç”¨æ»¡ç§©åˆ†è§£æ±‚è§£A_plus if A.rank() == A.rows: print(\"Aä¸ºè¡Œæ»¡ç§©çŸ©é˜µ\") A_plus = A.H * (A * A.H).inv() elif A.rank() == A.cols: print(\"Aä¸ºåˆ—æ»¡ç§©çŸ©é˜µ\") A_plus = (A.H * A).inv() * A.H else: print(\"Aä¸ºéæ»¡ç§©çŸ©é˜µ\") # åˆ©ç”¨æ»¡ç§©åˆ†è§£æ±‚è§£A_plusï¼Œfull_rankåœ¨å¦ä¸€ç¯‡çŸ©é˜µè®ºå¤ä¹ åšå®¢ä¸­ F, G = full_rank(A) A_plus = G.H * ((G * G.H).inv()) * ((F.H * F).inv()) * F.H return A_plus åˆ©ç”¨$A^+$æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„$Ax=b$ $Ax=b$æœ‰è§£ï¼ˆç›¸å®¹ï¼‰çš„å……è¦æ¡ä»¶æ˜¯$AA^+b=b$ $x=A^+b+(I-A^+A)y,\\forall y\\in C^n$æ˜¯ç›¸å®¹æ–¹ç¨‹ç»„$Ax=b$çš„é€šè§£ï¼Œæˆ–æ˜¯ä¸ç›¸å®¹æ–¹ç¨‹ç»„$Ax=b$çš„å…¨éƒ¨æœ€å°äºŒä¹˜è§£ $x_0=A^+b$æ˜¯ç›¸å®¹æ–¹ç¨‹ç»„$Ax=b$çš„å”¯ä¸€æå°èŒƒæ•°è§£ï¼Œæˆ–æ˜¯ä¸ç›¸å®¹æ–¹ç¨‹ç»„$Ax=b$çš„å”¯ä¸€æå°èŒƒæ•°æœ€å°äºŒä¹˜è§£ Pythonä»£ç å¦‚ä¸‹ï¼š import numpy as np from sympy import Matrix, Symbol def get_solution(A, b): A_plus = get_A_plus(A) # å•ä½çŸ©é˜µ I = Matrix(np.eye(A_plus.rows)) print(\"I:\", I) # ç”Ÿæˆç¬¦å·åˆ—è¡¨ symbols_list = [Symbol(f'y{i+1}') for i in range(A_plus.rows)] # ç”Ÿæˆç¬¦å·çŸ©é˜µ symbols_matrix = Matrix(symbols_list) print(\"symbols_matrix:\", symbols_matrix) if A * A_plus * b == b: print(\"Ax = bæœ‰è§£\") print(\"é€šè§£ä¸ºï¼š\") print(A_plus.rows) print(A_plus * b + (I - A_plus * A) * symbols_matrix) print(\"å”¯ä¸€æå°èŒƒæ•°è§£ä¸ºï¼š\") print(A_plus * b) else: print(\"Ax = bæ— è§£\") print(\"å…¨éƒ¨æœ€å°äºŒä¹˜è§£ä¸ºï¼š\") print(A_plus.rows) print(A_plus * b + (I - A_plus * A) * symbols_matrix) print(\"å”¯ä¸€æå°èŒƒæ•°æœ€å°äºŒä¹˜è§£ï¼š\") print(A_plus * b) get_solution(A, b) ","date":"2023-12-01","objectID":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/:5:0","tags":["çŸ©é˜µè®º"],"title":"ã€çŸ©é˜µè®ºã€‘Chapter 9â€”å¹¿ä¹‰é€†çŸ©é˜µçŸ¥è¯†ç‚¹æ€»ç»“å¤ä¹ ","uri":"/posts/09.%E5%B9%BF%E4%B9%89%E9%80%86%E7%9F%A9%E9%98%B5/"},{"categories":["æŠ€å·§"],"content":"1 æ™®é€šæœç´¢ æˆ‘ä»¬ä¸€èˆ¬åœ¨githubæœç´¢é¡¹ç›®ï¼Œéƒ½æ˜¯ç›´æ¥åœ¨æ ¹æ®ä»“åº“å…³é”®å­—æœç´¢é¡¹ç›®ï¼Œå¯èƒ½è¿˜ä¼šç”¨åˆ°å›¾ä¸­çš„åŒ¹é…æ¡ä»¶è¿›è¡Œç­›é€‰ã€‚ è¿™æ ·è™½ç„¶èƒ½å®ç°æˆ‘ä»¬çš„å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œä½†è¿˜ä¸è¶³å®ç°ç²¾ç¡®æŸ¥æ‰¾ã€‚è€Œgithubæœ‰è‡ªå·±çš„ä¸€å¥—æœç´¢è¯­æ³•ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬å®ç°ç²¾ç¡®æŸ¥æ‰¾ã€‚ ","date":"2023-11-21","objectID":"/posts/05.github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/:1:0","tags":["Github"],"title":"Githubæœç´¢æŠ€å·§","uri":"/posts/05.github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/"},{"categories":["æŠ€å·§"],"content":"2 é«˜çº§æœç´¢æŠ€å·§ in:name \u003cå…³é”®å­—\u003e æ ¹æ®ä»“åº“åç§°æœç´¢ä»“åº“ã€‚ in:description \u003cå…³é”®å­—\u003eï¼šæ ¹æ®ä»“åº“æè¿°æœç´¢ä»“åº“ã€‚ in:readme \u003cå…³é”®å­—\u003eï¼šæ ¹æ® README æ–‡ä»¶å†…å®¹æœç´¢ä»“åº“ã€‚ stars(fork): \u003e(=) \u003cæ•°å­—\u003e \u003cå…³é”®å­—\u003eï¼šæœç´¢ star æˆ– fork æ•°å¤§äºï¼ˆæˆ–ç­‰äºï¼‰æŒ‡å®šæ•°å­—çš„ä»“åº“ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ stars(fork): 10..20 \u003cå…³é”®è¯\u003eï¼šæœç´¢ star æˆ– fork æ•°åœ¨ 10 åˆ° 20 ä¹‹é—´çš„ä»“åº“ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ size:\u003e=5000 \u003cå…³é”®è¯\u003eï¼šæœç´¢ä»“åº“å¤§å°$\\geq$ 5000KBï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ pushed(created):\u003e2023-7-1 \u003cå…³é”®å­—\u003eï¼šæœç´¢æ›´æ–°æˆ–åˆ›å»ºæ—¥æœŸåœ¨ 2023 å¹´ 7 æœˆ 1 æ—¥ä¹‹åçš„ä»“åº“ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ license:mit \u003cå…³é”®å­—\u003eï¼šæœç´¢ LICENSE ä¸º MIT çš„ä»“åº“ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ language:Go \u003cå…³é”®å­—\u003eï¼šæœç´¢ä»“åº“è¯­è¨€ä¸º Go çš„ä»“åº“ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ user:\u003cç”¨æˆ·å\u003e \u003cå…³é”®å­—\u003eï¼šæŸ¥è¯¢æŸä¸ªç”¨æˆ·çš„é¡¹ç›®ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ org:\u003cç»„ç»‡å\u003e \u003cå…³é”®å­—\u003eï¼šæŸ¥è¯¢æŸä¸ªç»„ç»‡çš„é¡¹ç›®ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚ repo:owner/nameï¼š åŒ¹é…ç‰¹å®šä»“åº“åç§°ï¼Œä¾‹å¦‚repo:unique-pure/unique-pure.github.io is:public/private \u003cå…³é”®å­—\u003eï¼šæ ¹æ®å…¬æœ‰æˆ–ç§æœ‰ä»“åº“æœç´¢ï¼Œå¹¶åŒ…å«å…³é”®å­—ã€‚å½“ç„¶ï¼Œåªæœ‰ä½ å…·æœ‰è®¿é—®æƒé™çš„ç§æœ‰ä»“åº“æ‰å¯ä»¥æœç´¢åˆ°ã€‚ topic:\u003cå…³é”®å­—\u003eï¼šæ ¹æ®ä¸»é¢˜æœç´¢ä»“åº“ã€‚ topics:\u003e5ï¼šæœç´¢å…·æœ‰3ä¸ªä»¥ä¸Šä¸»é¢˜çš„ä»“åº“ã€‚ followers:nï¼šæ ¹æ®ä»“åº“å…³æ³¨è€…æ•°é‡æœç´¢ä»“åº“ã€‚ ","date":"2023-11-21","objectID":"/posts/05.github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/:2:0","tags":["Github"],"title":"Githubæœç´¢æŠ€å·§","uri":"/posts/05.github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/"},{"categories":["æŠ€å·§"],"content":"3 github advanceæŸ¥æ‰¾å·¥å…· githubå¼€å‘äº†ä¸€å¥—æŸ¥æ‰¾å·¥å…·ï¼Œéå¸¸å…¨é¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·è¿›è¡Œç²¾ç¡®æŸ¥æ‰¾ã€‚ https://github.com/search/advanced ","date":"2023-11-21","objectID":"/posts/05.github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/:3:0","tags":["Github"],"title":"Githubæœç´¢æŠ€å·§","uri":"/posts/05.github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/"},{"categories":["å·¥å…·"],"content":"1 å¼•è¨€ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:1:0","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.1 ä»€ä¹ˆæ˜¯WireGuard å®˜æ–¹ä»‹ç»å¦‚ä¸‹ï¼š WireGuard Â® æ˜¯ä¸€æ¬¾æå…¶ç®€å•ä½†å¿«é€Ÿä¸”ç°ä»£çš„ VPNï¼Œé‡‡ç”¨æœ€å…ˆè¿›çš„åŠ å¯†æŠ€æœ¯ã€‚å®ƒçš„ç›®æ ‡æ˜¯æ¯” IPsec æ›´å¿«ã€æ›´ç®€å•ã€æ›´ç²¾ç®€ã€æ›´æœ‰ç”¨ï¼ŒåŒæ—¶é¿å…ä»¤äººå¤´ç–¼çš„é—®é¢˜ã€‚å®ƒçš„æ€§èƒ½è¿œé«˜äº OpenVPNã€‚ WireGuard è¢«è®¾è®¡ä¸ºé€šç”¨ VPNï¼Œå¯åœ¨åµŒå…¥å¼æ¥å£å’Œè¶…çº§è®¡ç®—æœºä¸Šè¿è¡Œï¼Œé€‚åˆè®¸å¤šä¸åŒçš„æƒ…å†µã€‚å®ƒæœ€åˆé’ˆå¯¹ Linux å†…æ ¸å‘å¸ƒï¼Œç°åœ¨å·²è·¨å¹³å°ï¼ˆWindowsã€macOSã€BSDã€iOSã€Androidï¼‰ä¸”å¯å¹¿æ³›éƒ¨ç½²ã€‚å®ƒç›®å‰æ­£åœ¨å¤§åŠ›å¼€å‘ä¸­ï¼Œä½†å®ƒå¯èƒ½å·²è¢«è§†ä¸ºä¸šå†…æœ€å®‰å…¨ã€æœ€æ˜“äºä½¿ç”¨ä¸”æœ€ç®€å•çš„ VPN è§£å†³æ–¹æ¡ˆã€‚ æˆ‘ä»¬å¯ä»¥ç”¨ä¸€å¥è¯æ¦‚æ‹¬å®ƒï¼š WGuardæ˜¯ä¸€æ¬¾å¯ä»¥ç»„å»ºè™šæ‹Ÿç§äººå±€åŸŸç½‘ï¼ˆVPNï¼‰çš„è½¯ä»¶ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡å…¬å…±ç½‘ç»œï¼ˆå¦‚äº’è”ç½‘ï¼‰å®‰å…¨åœ°ä¼ è¾“æ•°æ®ï¼ŒåŒæ—¶ä¿æŒæ•°æ®çš„æœºå¯†æ€§å’Œå®Œæ•´æ€§ã€‚ WireGuardæœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š æ›´è½»ä¾¿ï¼šä»¥Linuxå†…æ ¸æ¨¡å—çš„å½¢å¼è¿è¡Œï¼Œèµ„æºå ç”¨å°ã€‚ æ›´é«˜æ•ˆï¼šç›¸æ¯”ç›®å‰ä¸»æµçš„IPSecã€OpenVPNç­‰åè®®ï¼ŒWireGuardçš„æ•ˆç‡è¦æ›´é«˜ã€‚ æ›´å¿«é€Ÿï¼šæ¯”ç›®å‰ä¸»æµçš„VPNåè®®ï¼Œè¿æ¥é€Ÿåº¦è¦æ›´å¿«ã€‚ æ›´å®‰å…¨ï¼šä½¿ç”¨äº†æ›´å…ˆè¿›çš„åŠ å¯†æŠ€æœ¯ã€‚ æ›´æ˜“æ­å»ºï¼šéƒ¨ç½²éš¾åº¦ç›¸å¯¹æ›´ä½ã€‚ æ›´éšè”½ï¼šä»¥UDPåè®®è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œæ¯”TCPåè®®æ›´ä½è°ƒã€‚ ä¸æ˜“è¢«å°é”ï¼šTCPé˜»æ–­å¯¹WireGuardæ— æ•ˆï¼ŒIPè¢«å¢™çš„æƒ…å†µä¸‹ä»ç„¶å¯ç”¨ã€‚ æ›´çœç”µï¼šä¸ä½¿ç”¨æ—¶ä¸è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œç§»åŠ¨ç«¯æ›´çœç”µã€‚ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:1:1","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.2 WireGuardå¯ä»¥ç”¨æ¥åšä»€ä¹ˆ å»ºç«‹VPNï¼ˆä¸é™è®¾å¤‡ç±»å‹ï¼‰ WireGuardæ”¯æŒå¤šç§å¹³å°ï¼ŒåŒ…æ‹¬ç”µè„‘ã€æ™ºèƒ½æ‰‹æœºå’Œè·¯ç”±å™¨ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å…¶æˆä¸ºæ„å»ºè™šæ‹Ÿç§æœ‰ç½‘ç»œï¼ˆVPNï¼‰çš„ç†æƒ³é€‰æ‹©ï¼Œèƒ½åœ¨è¿™äº›è®¾å¤‡ä¸Šå®ç°å®‰å…¨è¿æ¥ã€‚æ— è®ºæ˜¯ç”¨äºè¿œç¨‹å·¥ä½œã€ä¿æŠ¤æ•°æ®éšç§ï¼Œè¿˜æ˜¯ç»•è¿‡åœ°ç†é™åˆ¶ï¼ŒWireGuardéƒ½èƒ½æä¾›ç¨³å®šä¸”å®‰å…¨çš„ç½‘ç»œè¿æ¥ã€‚ å®ç°å†…ç½‘ç©¿é€ å†…ç½‘ç©¿é€ï¼Œå³NATï¼ˆNetwork Address Translatorï¼‰ç©¿é€ï¼Œæ˜¯æŒ‡è®¡ç®—æœºåœ¨å†…ç½‘ï¼ˆå±€åŸŸç½‘ï¼‰å†…ä½¿ç”¨ç§æœ‰IPåœ°å€ï¼Œåœ¨è¿æ¥å¤–ç½‘ï¼ˆäº’è”ç½‘ï¼‰æ—¶ä½¿ç”¨å…¨å±€IPåœ°å€çš„æŠ€æœ¯ã€‚è¯¥æŠ€æœ¯è¢«æ™®éä½¿ç”¨åœ¨æœ‰å¤šå°ä¸»æœºä½†åªé€šè¿‡ä¸€ä¸ªå…¬æœ‰IPåœ°å€è®¿é—®çš„ç§æœ‰ç½‘ç»œä¸­ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚æˆ‘åœ¨å®éªŒå®¤é…ç½®äº†ä¸€ä¸ªæœåŠ¡å™¨ Server Aï¼Œå½“æˆ‘åœ¨å®éªŒå®¤çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡è‡ªå·±çš„ç¬”è®°æœ¬ä½¿ç”¨SSHè¿æ¥ã€å› ä¸ºæˆ‘å’ŒæœåŠ¡å™¨å¤„äºä¸€ä¸ªå±€åŸŸç½‘ã€‘ï¼Œå½“æˆ‘å›å®¿èˆä»¥åï¼Œå°±æ²¡æœ‰åŠæ³•ç›´æ¥ä½¿ç”¨SSHè¿æ¥äº†ã€å› ä¸ºæˆ‘å’ŒæœåŠ¡å™¨ä¸åœ¨ä¸€ä¸ªå±€åŸŸç½‘ã€‘ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è¿›è¡ŒNATç©¿é€ï¼Œè®©æˆ‘åœ¨å®¿èˆä¹Ÿå¯ä»¥ä½¿ç”¨SSHè¿æ¥Server Aã€‚ é€šè¿‡Wireguardå¯ä»¥å°†å¹¿åŸŸç½‘ä¸Šçš„ä¸»æœºè¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå±€åŸŸç½‘ã€‚åªéœ€è¦æœ‰ä¸€å°å…·æœ‰å›ºå®šå…¬ç½‘IPçš„æœåŠ¡å™¨ï¼Œå°±å¯ä»¥å°†å…¶ä½œä¸ºæˆ‘ä»¬æ­å»ºçš„å±€åŸŸç½‘çš„ä¸­å¿ƒèŠ‚ç‚¹ï¼Œè®©å…¶ä»–çš„ä¸»æœºï¼ˆä¸è®ºæ˜¯å¦æœ‰å…¬ç½‘IPï¼Œä¸è®ºæ˜¯å¦åœ¨NATå†…ï¼‰ï¼Œéƒ½é€šè¿‡è¿™ä¸ªä¸­å¿ƒèŠ‚ç‚¹å’Œå½¼æ­¤ç›¸è¿ã€‚ç”±æ­¤å°±æ„å»ºäº†ä¸€ä¸ªä¸­å¿ƒè¾å°„å‹çš„å±€åŸŸç½‘ï¼Œå®ç°äº†å†…ç½‘ç©¿é€ç­‰åŠŸèƒ½ã€‚ Dockerå®¹å™¨é€šä¿¡ WireGuardè¿˜å¯ç”¨äºDockerå®¹å™¨ä¹‹é—´çš„é€šä¿¡ã€‚åœ¨Dockerç¯å¢ƒä¸­ï¼Œå®¹å™¨ä¹‹é—´çš„ç½‘ç»œé€šä¿¡æ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜ã€‚WireGuardé€šè¿‡æä¾›ä¸€ç§å®‰å…¨çš„é€šä¿¡æ–¹å¼ï¼Œèƒ½å¤Ÿåœ¨ä¸åŒå®¹å™¨ä¹‹é—´å»ºç«‹ä¸€ä¸ªåŠ å¯†çš„ç½‘ç»œè¿æ¥ï¼Œä»è€Œä¿éšœæ•°æ®çš„å®‰å…¨ä¼ è¾“ã€‚è¿™å¯¹äºéœ€è¦åœ¨ä¸åŒå®¹å™¨é—´å®‰å…¨å…±äº«æ•°æ®çš„åº”ç”¨å°¤ä¸ºé‡è¦ã€‚ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:1:2","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.3 WireGuardåŸç† WireGuardæºç åœ°å€ WireGuard æ˜¯ä¸€ç§åœ¨ç¬¬ 3 å±‚ï¼ˆç½‘ç»œå±‚ï¼‰è¿è¡Œçš„å®‰å…¨ç½‘ç»œéš§é“ï¼Œä¸ä¼ ç»Ÿçš„ VPN è§£å†³æ–¹æ¡ˆï¼ˆå¦‚ IPsec å’Œ OpenVPNï¼‰ç›¸æ¯”ï¼Œå®ƒçš„è®¾è®¡æ›´å®‰å…¨ã€æ€§èƒ½æ›´é«˜ä¸”æ›´æ˜“äºä½¿ç”¨ã€‚å®ƒæ˜¯ä½œä¸º Linux å†…æ ¸è™šæ‹Ÿç½‘ç»œæ¥å£å®ç°çš„ï¼ŒåŸºäºå®‰å…¨éš§é“çš„åŸºæœ¬åŸç†ï¼šå°†peerçš„å…¬é’¥ä¸éš§é“æº IP åœ°å€å…³è”ã€‚ ç›¸å…³æœ¯è¯­ï¼š Peer/Node/Device è¿æ¥åˆ°VPN å¹¶ä¸ºè‡ªå·±æ³¨å†Œä¸€ä¸ªVPNå­ç½‘åœ°å€ï¼ˆå¦‚ 192.0.2.3ï¼‰çš„ä¸»æœºã€‚è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨é€—å·åˆ†éš”çš„ CIDR æŒ‡å®šå­ç½‘èŒƒå›´ï¼Œä¸ºå…¶è‡ªèº«åœ°å€ä»¥å¤–çš„ IP åœ°å€é€‰æ‹©è·¯ç”±ã€‚ ä¸­ç»§æœåŠ¡å™¨ï¼ˆBounce Serverï¼‰ ä¸€ä¸ªå…¬ç½‘å¯è¾¾çš„peerï¼Œå¯ä»¥å°†æµé‡ä¸­ç»§åˆ° NAT åé¢çš„å…¶ä»–peerã€‚Bounce Server å¹¶ä¸æ˜¯ç‰¹æ®Šçš„èŠ‚ç‚¹ï¼Œå®ƒå’Œå…¶ä»–peerä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å®ƒæœ‰å…¬ç½‘ IPï¼Œå¹¶ä¸”å¼€å¯äº†å†…æ ¸çº§åˆ«çš„ IP è½¬å‘ï¼Œå¯ä»¥å°† å¨å±æ© çš„æµé‡è½¬å‘åˆ°å…¶ä»–å®¢æˆ·ç«¯ã€‚ å­ç½‘ï¼ˆSubnetï¼‰ ä¸€ç»„ç§æœ‰ IPï¼Œä¾‹å¦‚ 192.0.2.1-255 æˆ– 192.168.1.1/24ï¼Œä¸€èˆ¬åœ¨ NAT åé¢ï¼Œä¾‹å¦‚åŠå…¬å®¤å±€åŸŸç½‘æˆ–å®¶åº­ç½‘ç»œã€‚ CIDR è¡¨ç¤ºæ³• CIDRï¼Œå³æ— ç±»åŸŸé—´è·¯ç”±ï¼ˆClassless Inter-Domain Routingï¼‰ï¼Œæ˜¯ä¸€ç§ç”¨äºå¯¹IPåœ°å€è¿›è¡Œçµæ´»è¡¨ç¤ºå’Œåˆ†é…çš„æ ‡å‡†ã€‚ NAT å­ç½‘çš„ç§æœ‰ IP åœ°å€ç”±è·¯ç”±å™¨æä¾›ï¼Œé€šè¿‡å…¬ç½‘æ— æ³•ç›´æ¥è®¿é—®ç§æœ‰å­ç½‘è®¾å¤‡ï¼Œéœ€è¦é€šè¿‡ NAT åšç½‘ç»œåœ°å€è½¬æ¢ã€‚è·¯ç”±å™¨ä¼šè·Ÿè¸ªå‘å‡ºçš„è¿æ¥ï¼Œå¹¶å°†å“åº”è½¬å‘åˆ°æ­£ç¡®çš„å†…éƒ¨ IPã€‚ å…¬å¼€ç«¯ç‚¹ï¼ˆPublic Endpointï¼‰ èŠ‚ç‚¹çš„å…¬ç½‘ IP åœ°å€:ç«¯å£ï¼Œä¾‹å¦‚ 123.124.125.126:1234ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨åŸŸå some.domain.tld:1234ã€‚å¦‚æœpeerèŠ‚ç‚¹ä¸åœ¨åŒä¸€å­ç½‘ä¸­ï¼Œé‚£ä¹ˆèŠ‚ç‚¹çš„å…¬å¼€ç«¯ç‚¹å¿…é¡»ä½¿ç”¨å…¬ç½‘ IP åœ°å€ã€‚ ç§é’¥ï¼ˆPrivate keyï¼‰ å•ä¸ªèŠ‚ç‚¹çš„ WireGuard ç§é’¥ï¼Œç”Ÿæˆæ–¹æ³•æ˜¯ï¼šwg genkey \u003e example.keyã€‚ å…¬é’¥ï¼ˆPublic keyï¼‰ å•ä¸ªèŠ‚ç‚¹çš„ WireGuard å…¬é’¥ï¼Œç”Ÿæˆæ–¹å¼ä¸ºï¼šwg pubkey \u003c example.key \u003e example.key.pubã€‚ DNS åŸŸåæœåŠ¡å™¨ï¼Œç”¨äºå°†åŸŸåè§£æä¸º VPN å®¢æˆ·ç«¯çš„ IPï¼Œä¸è®© DNSè¯·æ±‚æ³„æ¼åˆ° VPN ä¹‹å¤–ã€‚ ä¸»è¦åŠŸèƒ½å’ŒåŸç†å¦‚ä¸‹ WireGuard é€šè¿‡æ·»åŠ ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç½‘ç»œæ¥å£æ¥å·¥ä½œï¼Œä¾‹å¦‚ eth0 æˆ– wlan0 ï¼Œç§°ä¸º wg0 ï¼ˆæˆ– wg1 ã€ wg2 ã€ wg3 ç­‰ï¼‰ã€‚ç„¶åå¯ä»¥ä½¿ç”¨ ifconfig(8) æˆ– ip-address(8) æ­£å¸¸é…ç½®è¯¥ç½‘ç»œæ¥å£ï¼Œå¹¶ä½¿ç”¨ route(8) æˆ– ip-route(8) æ·»åŠ å’Œåˆ é™¤å…¶è·¯ç”±ï¼Œä»¥åŠæ‰€æœ‰æ™®é€šç½‘ç»œå®ç”¨ç¨‹åºéƒ½æ˜¯å¦‚æ­¤ã€‚æ¥å£çš„ç‰¹å®š WireGuard æ–¹é¢ä½¿ç”¨ wg(8) å·¥å…·è¿›è¡Œé…ç½®ã€‚è¯¥æ¥å£å……å½“éš§é“æ¥å£ã€‚ WireGuard å°†éš§é“ IP åœ°å€ä¸å…¬é’¥å’Œè¿œç¨‹ç«¯ç‚¹ç›¸å…³è”ã€‚å½“æ¥å£å‘peerå‘é€æ•°æ®åŒ…æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š è¯¥æ•°æ®åŒ…é€‚ç”¨äº 192.168.30.8ã€‚é‚£æ˜¯å“ªä½peerå•Šï¼Ÿè®©æˆ‘çœ‹çœ‹â€¦å¥½å§ï¼Œè¿™æ˜¯ç»™peer ABCDEFGH çš„ã€‚ ï¼ˆæˆ–è€…ï¼Œå¦‚æœå®ƒä¸é€‚åˆä»»ä½•å·²é…ç½®çš„peerï¼Œåˆ™ä¸¢å¼ƒè¯¥æ•°æ®åŒ…ã€‚ï¼‰ ä½¿ç”¨peer ABCDEFGH çš„å…¬é’¥åŠ å¯†æ•´ä¸ª IP æ•°æ®åŒ…ã€‚ Peer ABCDEFGH çš„è¿œç¨‹ç«¯ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿè®©æˆ‘çœ‹çœ‹â€¦å¥½çš„ï¼Œç«¯ç‚¹æ˜¯ä¸»æœº 216.58.211.110 ä¸Šçš„ UDP ç«¯å£ 53133ã€‚ ä½¿ç”¨ UDP é€šè¿‡ Internet å°†æ­¥éª¤ 2 ä¸­çš„åŠ å¯†å­—èŠ‚å‘é€åˆ° 216.58.211.110:53133ã€‚ å½“æ¥å£æ”¶åˆ°æ•°æ®åŒ…æ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š æˆ‘åˆšåˆšä»ä¸»æœº 98.139.183.24 ä¸Šçš„ UDP ç«¯å£ 7361 æ”¶åˆ°ä¸€ä¸ªæ•°æ®åŒ…ã€‚è®©æˆ‘ä»¬æ¥è§£å¯†å§ï¼ å®ƒä¸ºpeer LMNOPQRS æ­£ç¡®è§£å¯†å’ŒéªŒè¯ã€‚å¥½çš„ï¼Œè®©æˆ‘ä»¬è®°ä½ï¼Œpeer LMNOPQRS çš„æœ€æ–° Internet ç«¯ç‚¹æ˜¯ä½¿ç”¨ UDP çš„ 98.139.183.24:7361ã€‚ è§£å¯†åï¼Œæ˜æ–‡æ•°æ®åŒ…æ¥è‡ª 192.168.43.89ã€‚æ˜¯å¦å…è®¸peer LMNOPQRS ä»¥ 192.168.43.89 å‘æˆ‘ä»¬å‘é€æ•°æ®åŒ…ï¼Ÿ å¦‚æœæ˜¯ï¼Œåˆ™åœ¨æ¥å£ä¸Šæ¥å—æ•°æ®åŒ…ã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±æ”¾å¼ƒå®ƒã€‚ WireGuard çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç§°ä¸ºåŠ å¯†å¯†é’¥è·¯ç”±çš„æ¦‚å¿µï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯å°†å…¬é’¥ä¸éš§é“å†…å…è®¸çš„éš§é“ IP åœ°å€åˆ—è¡¨ç›¸å…³è”ã€‚æ¯ä¸ªç½‘ç»œæ¥å£éƒ½æœ‰ä¸€ä¸ªç§é’¥å’Œä¸€ä¸ªpeerç‚¹åˆ—è¡¨ã€‚æ¯ä¸ªpeeréƒ½æœ‰ä¸€ä¸ªå…¬é’¥ã€‚å…¬é’¥çŸ­å°ä¸”ç®€å•ï¼Œç”±peerç”¨æ¥ç›¸äº’éªŒè¯ã€‚å®ƒä»¬å¯ä»¥é€šè¿‡ä»»ä½•å¸¦å¤–æ–¹æ³•ä¼ é€’ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œç±»ä¼¼äºå°† SSH å…¬é’¥å‘é€ç»™æœ‹å‹ä»¥è®¿é—® shell æœåŠ¡å™¨çš„æ–¹å¼ã€‚ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:1:3","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.4 WireGuardå®‰è£… wireGuardå®˜æ–¹å®‰è£…æ•™ç¨‹ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:1:4","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2 WireGuardç»„ç½‘å®ç°å†…ç½‘ç©¿é€ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:2:0","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.1 å‰ææ¡ä»¶ å…¬ç½‘æœåŠ¡å™¨ï¼š å¿…é¡»æ‹¥æœ‰ä¸€å°å…·æœ‰å…¬ç½‘IPåœ°å€çš„æœåŠ¡å™¨ï¼Œè¿™æ˜¯å†…ç½‘ç©¿é€çš„å…³é”®ã€‚è¯¥æœåŠ¡å™¨å……å½“ä¸­è½¬ç«™ï¼Œè´Ÿè´£å°†å¤–éƒ¨è¯·æ±‚ä¼ é€’åˆ°å†…éƒ¨ç½‘ç»œã€‚ ç½‘ç»œè®¾å¤‡é…ç½®æƒé™ï¼š éœ€è¦å¯¹å†…éƒ¨ç½‘ç»œçš„è·¯ç”±å™¨æˆ–é˜²ç«å¢™æœ‰ä¸€å®šçš„é…ç½®æƒé™ï¼Œä»¥ä¾¿è¿›è¡Œç«¯å£æ˜ å°„æˆ–å…¶ä»–å¿…è¦çš„ç½‘ç»œè®¾ç½®ã€‚è¿™ç¡®ä¿äº†ä»å…¬ç½‘æœåŠ¡å™¨åˆ°å†…ç½‘çš„è¿æ¥æ˜¯æœ‰æ•ˆçš„ã€‚ å®‰è£…WireGuardï¼š åœ¨å…¬ç½‘æœåŠ¡å™¨å’Œå†…ç½‘è®¾å¤‡ä¸Šéƒ½éœ€è¦å®‰è£…å’Œé…ç½®WireGuardè½¯ä»¶ã€‚ç¡®ä¿ä¸¤ç«¯çš„WireGuardé…ç½®ä¸€è‡´ï¼ŒåŒ…æ‹¬å…¬ç§é’¥çš„ç”Ÿæˆå’Œç½‘ç»œæ¥å£çš„é…ç½®ã€‚ å¼€å¯ç›¸åº”ç«¯å£ï¼š åœ¨å…¬ç½‘æœåŠ¡å™¨çš„é˜²ç«å¢™é…ç½®ä¸­ï¼Œéœ€è¦æ‰“å¼€WireGuardæ‰€ä½¿ç”¨çš„ç«¯å£ï¼ˆé»˜è®¤æ˜¯51820/UDPï¼‰ï¼Œä»¥ç¡®ä¿èƒ½å¤Ÿæ¥æ”¶æ¥è‡ªå†…ç½‘è®¾å¤‡çš„è¿æ¥è¯·æ±‚ã€‚ åˆé€‚çš„ç½‘ç»œæ‹“æ‰‘ï¼š ç¡®ä¿äº†è§£å†…éƒ¨ç½‘ç»œçš„æ‹“æ‰‘ç»“æ„ï¼Œä»¥ä¾¿æ­£ç¡®è®¾ç½®WireGuardé…ç½®ï¼ŒåŒ…æ‹¬å…è®¸æµé‡é€šè¿‡çš„å­ç½‘ã€è·¯ç”±ç­‰ã€‚ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:2:1","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.2 ç½‘ç»œæ‹“æ‰‘ç»“æ„ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:2:2","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.3 å…·ä½“æ­¥éª¤ 2.3.1 ä¸­ç»§æœåŠ¡å™¨é…ç½® åˆ›å»ºå¯†é’¥å¯¹ wg genkey | tee server_privatekey | wg pubkey \u003e server_publickey æ‰§è¡Œä»¥ä¸Šä¸¤æ¡å‘½ä»¤åï¼Œä¼šåœ¨æ‰§è¡Œå‘½ä»¤çš„å½“å‰æ–‡ä»¶å¤¹è‡ªåŠ¨ç”Ÿæˆ2ä¸ªæ–‡ä»¶ï¼š å¼€å¯IPåœ°å€è½¬å‘ sudo sysctl net.ipv4.ip_forward å¦‚æœæ˜¾ç¤º1åˆ™è¯´æ˜å·²å¼€å¯ï¼Œå¦åˆ™åˆ™æœªå¼€å¯ã€‚ echo \"net.ipv4.ip_forward = 1\" \u003e\u003e /etc/sysctl.conf echo \"net.ipv4.conf.all.proxy_arp = 1\" \u003e\u003e /etc/sysctl.conf sysctl -p /etc/sysctl.conf è®¾ç½®IPåœ°å€ä¼ªè£… # å…è®¸é˜²ç«å¢™ä¼ªè£…IP firewall-cmd --add-masquerade # æ£€æŸ¥æ˜¯å¦å…è®¸ä¼ªè£…IP firewall-cmd --query-masquerade # ç¦æ­¢é˜²ç«å¢™ä¼ªè£…IP firewall-cmd --remove-masquerade é…ç½®wireguardè™šæ‹Ÿç½‘å¡ï¼ˆä¸æ¨èï¼Œåªæ˜¯è®©è¯»è€…ç›´è§‚äº†è§£è¿‡ç¨‹ï¼‰ sudo ip link add wg0 type wireguard # æ·»åŠ ä¸€å—å« wg0 çš„è™šæ‹Ÿ wireguard ç½‘å¡ sudo ip addr add 192.168.71.1/24 dev wg0 # ç»™ wg0 ç½‘å¡æ·»åŠ  ip åœ°å€ 192.168.71.1ï¼Œå­ç½‘æ©ç  255.255.255.0 sudo wg set wg0 private-key ./server-privatekey # wireguard è®¾ç½®å¯†é’¥ sudo ip link set wg0 up # å¯ç”¨åˆšåˆšæ·»åŠ çš„ç½‘å¡ æˆ‘ä»¬å¯ä»¥é€šè¿‡ip addrå‘½ä»¤æŸ¥çœ‹åˆ°wg0ç½‘å¡çš„çŠ¶æ€ å¯ä»¥çœ‹åˆ°ç½‘å¡wg0 æ¥å£æ˜¯å·²å¯ç”¨çš„ï¼Œå…·æœ‰ IPv4 åœ°å€ 192.168.71.1 è¾“å…¥wgå‘½ä»¤åˆ™å¯ä»¥çœ‹åˆ°é…ç½®ä¿¡æ¯ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸åœ¨ æœ‰æƒ³ç»§ç»­å°è¯•è¿™ç§æ–¹å¼çš„å¯ä»¥çœ‹ä¸€ä¸‹å®˜æ–¹æ•™ç¨‹ ç¼–å†™é…ç½®æ–‡ä»¶é…ç½®ç½‘å¡ï¼ˆæ¨èï¼Œåº”è¯¥wg setå‘½ä»¤éœ€è¦æä¾›å¾ˆå¤šå‚æ•°ï¼Œå¾ˆå®¹æ˜“å‡ºé”™ï¼‰ æˆ‘ä»¬åœ¨/etc/wireguardç›®å½•ä¸­åˆ›å»ºwg0.confå¹¶ç¼–å†™é…ç½®ï¼Œé…ç½®é¡¹è¯·çœ‹2.4 é…ç½®é¡¹è¯´æ˜ [Interface] # æœ¬æœºå¯†é’¥ PrivateKey = KIDTljv66CgVYBNlrSD13Au6qfUdIcFJkTBkuErhTEk= # æœ¬æœºåœ°å€ Address = 192.168.71.1/24 # ç›‘å¬ç«¯å£ ListenPort = 51820 [Peer] # å¯¹ç«¯çš„publickey PublicKey = iWy57DmR6wVXcVzMDOa2WyywO0WT5JRAGYIlh0v/nW8= # å¯¹ç«¯åœ°å€ AllowedIPs = 192.168.71.2/24 é‡æ–°å¯åŠ¨ç½‘å¡ sudo wg-quick down wg0 sudo wg-quick up wg0 2.3.2 å…¶ä»–peer æˆ‘è¿™é‡Œåªåˆ—ä¸¾MacOSçš„æ“ä½œæ–¹å¼ï¼ˆå…¶ä»–éƒ½åŒç†ï¼Œå°±æ˜¯è¦é…ç½®ç§é’¥å’Œå…¬é’¥ï¼‰ æ“ä½œå®Œä¹‹åï¼Œå®ƒä¼šç»™å‡ºå¯†é’¥å¯¹ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ å¥½å…¶ä»–ä¿¡æ¯å³å¯ã€‚ é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š [Interface] # æœ¬æœºå¯†é’¥ PrivateKey = kDUqWzkbaB1EU5C2ADoId1TXtZF89xxn0VV45EcjFHs= # æœ¬æœºåœ°å€ Address = 192.168.71.2/24 [Peer] # å¯¹ç«¯å…¬é’¥ï¼Œå³å…¬ç½‘æœåŠ¡å™¨å…¬é’¥ PublicKey = bEm1p736FQySfKlTTUCeHmiwTmna5umZWOWLGWqioSk= # å…è®¸æ­¤å¯¹ç­‰æ–¹çš„ä¼ å…¥æµé‡å¹¶æŒ‡å®šä¼ å‡ºæµé‡çš„ç›®æ ‡ã€‚ AllowedIPs = 192.168.71.0/24 # å…¬ç½‘IP+ç›‘å¬ç«¯å£å· Endpoint = 1.1.1.1:51820 PersistentKeepalive = 25 2.3.3 æµ‹è¯• MacOSç«¯ï¼š æœåŠ¡å™¨Ping ä¸»æœºï¼š ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:2:3","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.4 WireGuardé…ç½®æ–‡ä»¶è¯´æ˜ interfaceéƒ¨åˆ†ï¼š PrivateKey: ç”± wg genkey ç”Ÿæˆçš„ Base64 ç¼–ç çš„ç§é’¥ã€‚å¿…é¡»é…ç½®ã€‚ ListenPort: ç”¨äºç›‘å¬çš„ 16 ä½ç«¯å£ã€‚å¯é€‰ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œåˆ™éšæœºé€‰æ‹©ç«¯å£ã€‚ DNS: æŒ‡å®š DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€‚ FwMark: ç”¨äºä¼ å‡ºæ•°æ®åŒ…çš„ 32 ä½ fwmarkã€‚å¦‚æœè®¾ç½®ä¸º 0 æˆ– â€œoffâ€ï¼Œåˆ™ç¦ç”¨æ­¤é€‰é¡¹ã€‚å¯é€‰ã€‚å¯ä»¥ä»¥åå…­è¿›åˆ¶å½¢å¼æŒ‡å®šï¼Œä¾‹å¦‚ï¼Œä»¥ â€œ0xâ€ å¼€å¤´ã€‚å¯é€‰ã€‚ Peer éƒ¨åˆ†ï¼š PublicKey: ç”± wg pubkey æ ¹æ®ç§é’¥è®¡ç®—çš„ Base64 ç¼–ç çš„å…¬é’¥ã€‚å¿…é¡»é…ç½®ã€‚ PresharedKey: ç”± wg genpsk ç”Ÿæˆçš„ Base64 ç¼–ç çš„é¢„å…±äº«å¯†é’¥ã€‚å¯é€‰ï¼Œå¯ä»¥çœç•¥ã€‚æ­¤é€‰é¡¹ä¸ºç°æœ‰çš„å…¬é’¥åŠ å¯†æä¾›äº†é¢å¤–çš„å¯¹ç§°å¯†é’¥åŠ å¯†å±‚ï¼Œä»¥å¢å¼ºå¯¹æŠ—åé‡å­è®¡ç®—çš„èƒ½åŠ›ã€‚ AllowedIPs: é€—å·åˆ†éš”çš„ IP åœ°å€ï¼ˆIPv4 æˆ– IPv6ï¼‰åˆ—è¡¨ï¼Œå¸¦æœ‰ CIDR æ©ç ï¼Œç”¨äºå…è®¸æ­¤å¯¹ç­‰æ–¹çš„ä¼ å…¥æµé‡å¹¶æŒ‡å®šä¼ å‡ºæµé‡çš„ç›®æ ‡ã€‚å¯ä»¥å¤šæ¬¡æŒ‡å®šã€‚å¯ç”¨ 0.0.0.0/0 åŒ¹é…æ‰€æœ‰ IPv4 åœ°å€ï¼Œä½¿ç”¨ ::/0 åŒ¹é…æ‰€æœ‰ IPv6 åœ°å€ã€‚ Endpoint: ä¸€ä¸ª IP åœ°å€æˆ–ä¸»æœºåï¼Œåè·Ÿå†’å·ï¼Œç„¶åæ˜¯ä¸€ä¸ªç«¯å£å·ã€‚æ­¤ç«¯ç‚¹å°†è‡ªåŠ¨æ›´æ–°ä¸ºæ¥è‡ªå¯¹ç­‰æ–¹çš„æ­£ç¡®ç»è¿‡èº«ä»½éªŒè¯çš„æ•°æ®åŒ…çš„æœ€æ–°æº IP åœ°å€å’Œç«¯å£ã€‚å¯é€‰ã€‚ PersistentKeepalive: ä¿æŒæ´»è·ƒçš„æ—¶é—´é—´éš”ï¼Œä»‹äº 1 å’Œ 65535 ä¹‹é—´ï¼Œè¡¨ç¤ºå¤šä¹…å‘é€ä¸€æ¬¡å¯¹ç­‰æ–¹çš„èº«ä»½éªŒè¯ç©ºæ•°æ®åŒ…ï¼Œä»¥ä¿æŒæœ‰çŠ¶æ€çš„é˜²ç«å¢™æˆ– NAT æ˜ å°„çš„æœ‰æ•ˆæ€§ã€‚å¦‚æœè®¾ç½®ä¸º 0 æˆ– â€œoffâ€ï¼Œåˆ™ç¦ç”¨æ­¤é€‰é¡¹ã€‚å¯é€‰ï¼Œé»˜è®¤æƒ…å†µä¸‹æ­¤é€‰é¡¹è¢«ç¦ç”¨ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š [Interface] PrivateKey = yAnz5TF+lXXJte14tji3zlMNq+hd2rYUIgJBgB3fBmk= ListenPort = 51820 [Peer] PublicKey = xTIBA5rboUvnH4htodjb6e697QjLERt1NAB4mZqp8Dg= Endpoint = 192.95.5.67:1234 AllowedIPs = 10.192.122.3/32, 10.192.124.1/24 [Peer] PublicKey = TrMvSoP4jYQlY6RIzBgbssQqY3vxI2Pi+y71lOWWXX0= Endpoint = [2607:5300:60:6b0::c05f:543]:2468 AllowedIPs = 10.192.122.4/32, 192.168.0.0/16 [Peer] PublicKey = gN65BkIKy1eCE9pP1wdc8ROUtkHLF2PfAqYdyYBz6EA= Endpoint = test.wireguard.com:18981 AllowedIPs = 10.10.10.230/32 ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:2:4","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3 WireGuardå·¥å…· ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:3:0","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.1 wg-easy githubåœ°å€ è¿™æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† WireGuard è®¾ç½®çš„ Web ç”¨æˆ·ç•Œé¢ã€‚ä½¿ç”¨å®ƒä¹‹å‰æˆ‘ä»¬å¾—å…ˆå®‰è£…dockerå’Œdocker-composeã€‚è¿™é‡Œæˆ‘ç»™å‡ºdocker-compose.ymlé…ç½®æ–‡ä»¶ç¤ºä¾‹ã€‚è¿˜æœ‰å¾ˆå¤šé…ç½®é¡¹å¯åœ¨ä»“åº“ä¸­æ‰¾åˆ°ï¼Œçµæ´»é…ç½®VPN version: '3' services: wg-easy: image: weejewel/wg-easy container_name: wg-easy environment: - WG_HOST=YOUR_SERVER_IP # å…¬ç½‘IP - PASSWORD=YOUR_ADMIN_PASSWORD # Web UIç™»å½•å¯†ç  - WG_PORT=51820 # ç›‘å¬ç«¯å£ - WG_PERSISTENT_KEEPALIVE=25 # ä¿æŒâ€œè¿æ¥â€æ‰“å¼€çš„å€¼ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ - WG_DEFAULT_ADDRESS=192.168.71.0 # å®¢æˆ·ç«¯ IP åœ°å€èŒƒå›´ - WG_ALLOWED_IPS=192.168.71.0/24 # å®¢æˆ·ç«¯å°†ä½¿ç”¨çš„å…è®¸ IP volumes: - ~/.wg-easy:/etc/wireguard ports: - 51820:51820/udp - 51821:51821/tcp cap_add: - NET_ADMIN - SYS_MODULE sysctls: - net.ipv4.conf.all.src_valid_mark=1 - net.ipv4.ip_forward=1 restart: unless-stopped é€šè¿‡docker compose up -déƒ¨ç½²å¥½åï¼Œæˆ‘ä»¬è¿›å…¥Webç•Œé¢å³å¯æ·»åŠ Clientã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸‰ä¸ªé…ç½®æ–‡ä»¶åˆ†ç»™å¯¹åº”çš„Clientçš„å³å¯å®Œæˆç½‘ç»œæ­å»ºï¼Œç‰¹åˆ«æ–¹ä¾¿ï¼ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:3:1","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.2 wg-gen-web wg-gen-web è·Ÿwg-easyç±»ä¼¼ï¼Œä¸è¿‡åŠŸèƒ½æ›´å¼ºå¤§ã€‚ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:3:2","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.3 dsnet githubåœ°å€ ä¸€æ¬¾ç”¨äºç®¡ç†é›†ä¸­å¼wireguard VPN çš„FAST å‘½ä»¤ã€‚ ","date":"2023-11-16","objectID":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/:3:3","tags":["VPN"],"title":"WireGuardç»„ç½‘æ•™ç¨‹","uri":"/posts/01.wireguard%E7%BB%84%E7%BD%91%E6%95%99%E7%A8%8B/"},{"categories":["å‰ç«¯"],"content":"1 æ„å»ºå·¥å…· ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:1:0","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"1.1 ä»€ä¹ˆæ˜¯æ„å»ºå·¥å…· æµè§ˆå™¨å®ƒåªè®¤è¯†htmlï¼Œcssï¼Œjs ä¼ä¸šçº§é¡¹ç›®é‡Œéƒ½å¯èƒ½å…·å¤‡å“ªäº›åŠŸèƒ½ï¼Ÿ typescriptï¼šä½¿ç”¨tscå·¥å…·å°†tsä»£ç è½¬æ¢ä¸ºjsä»£ç ï¼› React/Vueï¼šå®‰è£…react-compiler/vue-compilerï¼Œå°†æˆ‘ä»¬å†™çš„jsxæ–‡ä»¶æˆ–è€….vueæ–‡ä»¶è½¬æ¢ä¸ºrenderå‡½æ•°ï¼› less/sass/postcss/component-styleï¼šæˆ‘ä»¬æœ‰éœ€è¦å®‰è£…less-loader,sass-loaderç­‰ä¸€ç³»åˆ—ç¼–è¯‘å·¥å…·è½¬æ¢ä¸ºcssä»£ç ï¼› è¯­æ³•é™çº§ï¼šbabelå¯ä»¥å°†esçš„æ–°è¯­æ³•è½¬æ¢æ—§ç‰ˆæµè§ˆå™¨å¯ä»¥æ¥å—çš„è¯­æ³•ï¼› ä½“ç§¯ä¼˜åŒ–ï¼šuglifyjså¯ä»¥å°†æˆ‘ä»¬çš„ä»£ç è¿›è¡Œå‹ç¼©å˜æˆä½“ç§¯æ›´å°æ€§èƒ½æ›´é«˜çš„æ–‡ä»¶ã€‚ ä»¥ä¸Šç¨å¾®æ”¹ä¸€ç‚¹ï¼Œå°±ä¼šå¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªæ„å»ºå·¥å…·å¯ä»¥å°†ä»¥ä¸Šå·¥å…·å…¨éƒ¨é›†æˆåˆ°ä¸€èµ·ï¼Œå®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨æˆ‘ä»¬å†™çš„ä»£ç å³å¯ã€‚å³æ„å»ºå·¥å…·å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨å»tscï¼Œreact-comilerï¼Œlessï¼Œbabelï¼Œuglifyjså…¨éƒ¨èµ°ä¸€éï¼Œè®©æˆ‘ä»¬ä¸ç”¨æ¯æ¬¡å…³å¿ƒæˆ‘ä»¬çš„ä»£ç åœ¨æµè§ˆå™¨è¿è¡Œã€‚ æ‰“åŒ…ï¼šå°†æˆ‘ä»¬å†™çš„æµè§ˆå™¨ä¸è®¤è¯†çš„ä»£ç ï¼Œäº¤ç»™æ„å»ºå·¥å…·è¿›è¡Œç¼–è¯‘å¤„ç†çš„è¿‡ç¨‹å°±å«åšæ‰“åŒ…ï¼Œæ‰“åŒ…å®Œæˆä»¥åä¼šç»™æˆ‘ä»¬ä¸€ä¸ªæµè§ˆå™¨å¯ä»¥è®¤è¯†çš„æ–‡ä»¶ã€‚ æ„å»ºå·¥å…·æ‰¿æ‹…äº†ä»¥ä¸‹è„æ´»ç´¯æ´»ï¼š æ¨¡å—åŒ–å¼€å‘æ”¯æŒï¼šæ”¯æŒç›´æ¥ä»node_modulesé‡Œå¼•å…¥ä»£ç  + å¤šç§æ¨¡å—åŒ–æ”¯æŒ å¤„ç†ä»£ç å…¼å®¹æ€§ï¼šæ¯”å¦‚babelè¯­æ³•é™çº§ï¼Œlessï¼Œtsè¯­æ³•è½¬æ¢ï¼ˆä¸æ˜¯æ„å»ºå·¥å…·åšçš„ï¼Œæ„å»ºå·¥å…·å°†è¿™äº›è¯­æ³•å¯¹åº”çš„å¤„ç†å·¥å…·é›†æˆè¿›æ¥è‡ªåŠ¨åŒ–å¤„ç†ï¼‰ æé«˜é¡¹ç›®æ€§èƒ½ï¼šå‹ç¼©æ–‡ä»¶ï¼Œä»£ç åˆ†å‰² ä¼˜åŒ–å¼€å‘ä½“éªŒï¼š æ„å»ºå·¥å…·ä¼šå¸®ä½ è‡ªåŠ¨ç›‘å¬æ–‡ä»¶çš„å˜åŒ–ï¼Œå½“æ–‡ä»¶å˜åŒ–ä»¥åè‡ªåŠ¨å¸®ä½ è°ƒç”¨å¯¹åº”çš„é›†æˆå·¥å…·è¿›è¡Œé‡æ–°æ‰“åŒ…ï¼Œç„¶åå†æµè§ˆå™¨é‡æ–°è¿è¡Œï¼ˆæ•´ä¸ªè¿‡ç¨‹å«åšçƒ­æ›´æ–°ï¼Œhot replacementï¼‰ å¼€å‘æœåŠ¡å™¨ï¼šè·¨åŸŸçš„é—®é¢˜ï¼Œç”¨react-cli create-react-element vue-cliè§£å†³è·¨åŸŸçš„é—®é¢˜ æˆ‘ä»¬åªéœ€è¦é¦–æ¬¡ç»™æ„å»ºå·¥å…·æä¾›ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆè¿™ä¸ªé…ç½®æ–‡ä»¶ä¹Ÿä¸æ˜¯å¿…é¡»çš„ï¼Œæ²¡æœ‰å®ƒä¹Ÿä¼šé»˜è®¤å¤„ç†ï¼‰ï¼Œæœ‰äº†é›†æˆçš„é…ç½®æ–‡ä»¶ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸‹æ¬¡éœ€è¦æ›´æ–°çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡å¯¹åº”çš„å‘½ä»¤å³å¯ï¼Œå¦‚æœå†ç»“åˆçƒ­æ›´æ–°ï¼Œæˆ‘ä»¬å°±æ›´åŠ ä¸éœ€è¦ç®¡ä»»ä½•ä¸œè¥¿ï¼Œè¿™å°±æ˜¯æ„å»ºå·¥å…·å»åšçš„äº‹æƒ…ï¼Œå®ƒè®©æˆ‘ä»¬ä¸ç”¨å…³å¿ƒç”Ÿäº§çš„å¸¦å•Šå—ä¹Ÿä¸ç”¨å…³å¿ƒä»£ç å¦‚ä½•åœ¨æµè§ˆå™¨è¿è¡Œï¼Œåªéœ€è¦å…³å¿ƒæˆ‘ä»¬çš„å¼€å‘æ€ä¹ˆå†™çš„çˆ½æ€ä¹ˆå†™å°±å¥½äº†ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:1:1","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"1.2 ä¸»æµæ„å»ºå·¥å…· webpack vite parcel esbuild rollup grunt gulp å›½å†…ä¸»æµè¿˜æ˜¯webpackï¼Œviteå’Œesbuildã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:1:2","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"1.3 viteç›¸è¾ƒäºwebpackçš„ä¼˜åŠ¿ ç„¶è€Œï¼Œå½“æˆ‘ä»¬å¼€å§‹æ„å»ºè¶Šæ¥è¶Šå¤§å‹çš„åº”ç”¨æ—¶ï¼Œéœ€è¦å¤„ç†çš„ JavaScript ä»£ç é‡ä¹Ÿå‘ˆæŒ‡æ•°çº§å¢é•¿ã€‚åŒ…å«æ•°åƒä¸ªæ¨¡å—çš„å¤§å‹é¡¹ç›®ç›¸å½“æ™®éã€‚åŸºäº JavaScript å¼€å‘çš„å·¥å…·å°±ä¼šå¼€å§‹é‡åˆ°æ€§èƒ½ç“¶é¢ˆï¼šé€šå¸¸éœ€è¦å¾ˆé•¿æ—¶é—´ï¼ˆç”šè‡³æ˜¯å‡ åˆ†é’Ÿï¼ï¼‰æ‰èƒ½å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œå³ä½¿ä½¿ç”¨æ¨¡å—çƒ­æ›¿æ¢ï¼ˆHMRï¼‰ï¼Œæ–‡ä»¶ä¿®æ”¹åçš„æ•ˆæœä¹Ÿéœ€è¦å‡ ç§’é’Ÿæ‰èƒ½åœ¨æµè§ˆå™¨ä¸­åæ˜ å‡ºæ¥ã€‚å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œè¿Ÿé’çš„åé¦ˆä¼šæå¤§åœ°å½±å“å¼€å‘è€…çš„å¼€å‘æ•ˆç‡å’Œå¹¸ç¦æ„Ÿã€‚ èµ·å› ï¼šæˆ‘ä»¬çš„é¡¹ç›®è¶Šå¤§ï¼Œæ„å»ºå·¥å…·ï¼ˆwebpackï¼‰æ‰€è¦å¤„ç†çš„jsä»£ç å°±è¶Šå¤šã€è·Ÿwebpackçš„ä¸€ä¸ªæ„å»ºè¿‡ç¨‹ï¼ˆå·¥ä½œæµç¨‹æœ‰å…³ï¼‰ã€‘ é€ æˆçš„ç»“æœï¼šæ„å»ºå·¥å…·éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆæŠŠé¡¹ç›®è·‘èµ·æ¥ï¼‰ yarn start yarn dev npm run dev npm run start webpackä¸èƒ½æ”¹ï¼Œå¦‚æœè¦æ”¹ï¼Œåˆ™ä¼šåŠ¨åˆ°webpackçš„å¤§åŠ¨è„‰ã€‚ // è¿™æ®µä»£ç æœ€ç»ˆå›åˆ°æµè§ˆå™¨é‡Œå»è¿è¡Œ const lodash = require(\"lodash\"); // commonjs è§„èŒƒ import Vue from \"vue\"; // es6 module // webpackæ˜¯å…è®¸æˆ‘ä»¬è¿™ä¹ˆå†™çš„ï¼Œwebpackä¼šè¿™æ ·è½¬æ¢ const lodash = webpack_require(\"loadsh\"); const Vue = webpack_require(\"vue\"); webpackçš„ç¼–è¯‘åŸç†ï¼ŒASTæŠ½è±¡è¯­æ³•åˆ†æçš„å·¥å…·ï¼Œåˆ†æå‡ºjsæ–‡ä»¶æœ‰å“ªäº›å¯¼å…¥å¯¼å‡ºæ“ä½œ æ„å»ºå·¥å…·æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ (function(modules) { function webpack_require() {} // å…¥å£æ˜¯index.js // é€šè¿‡webpackçš„é…ç½®æ–‡ä»¶å¾—æ¥çš„ï¼šwebpack.config.js ./src/index.js modules[entry](webpack_require); }, ({ \"index.js\": (webpack_require) =\u003e { const lodash = webpack_require(\"lodash\"); const Vue = webpack_require(\"vue\"); } })) å› ä¸ºwebpackæ”¯æŒæ¨¡å—åŒ–ï¼Œå®ƒä¸€å¼€å§‹å°±å¿…é¡»è¦ç»Ÿä¸€æ¨¡å—åŒ–ä»£ç ï¼Œæ‰€ä»¥æ„å‘³ç€å®ƒéœ€è¦å°†æ‰€æœ‰çš„ä¾èµ–è¯»ä¸€éã€‚ viteä¼šä¸ä¼šç›´æ¥æŠŠwebpackå¹²ç¿»ï¼Ÿviteæ˜¯åŸºäºes modulesçš„ï¼Œä¾§é‡ç‚¹ä¸ä¸€æ ·ï¼Œwebpackæ›´å¤šçš„å…³æ³¨å…¼å®¹æ€§ï¼Œè€Œviteå…³æ³¨æµè§ˆå™¨ç«¯çš„å¼€å‘ä½“éªŒã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:1:3","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"2 viteå¯åŠ¨é¡¹ç›®åˆä½“éªŒ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:2:0","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"2.1 ä½ å¿…é¡»è¦ç†è§£çš„viteè„šæ‰‹æ¶å’Œvite viteå®˜ç½‘æ­å»ºviteé¡¹ç›®æ–‡æ¡£æ•™ç¨‹ï¼šhttps://cn.vitejs.dev/guide/#scaffolding-your-first-vite-project æ¯”å¦‚æˆ‘ä»¬æ•²äº†yarn create vite å¸®æˆ‘ä»¬å…¨å±€å®‰è£…äº†ä¸€ä¸ªä¸œè¥¿ï¼šcreate-viteï¼ˆviteçš„è„šæ‰‹æ¶ï¼‰ ç›´æ¥è¿è¡Œè¿™ä¸ªcreate-vite binç›®å½•ä¸‹çš„ä¸€ä¸ªæ‰§è¡Œé…ç½® è¯¯åŒºï¼šè®¤ä¸ºå®˜ç½‘ä¸­ä½¿ç”¨å¯¹åº”çš„yarn createæ„å»ºé¡¹ç›®çš„è¿‡ç¨‹ä¹Ÿæ˜¯viteåœ¨åšçš„äº‹æƒ… æˆ‘ä»¬ä¹‹å‰æ¥è§¦è¿‡vue-cliï¼Œcreate-viteå’Œviteçš„å…³ç³»æ˜¯ï¼šcreate-viteå†…ç½®äº†viteã€‚ä½¿ç”¨vue-cliä¼šå†…ç½®webpack å…ˆå­¦ä¹ çš„å°±æ˜¯viteï¼Œæš‚æ—¶ä¸ä¼šä½¿ç”¨yarn create vite my-vue-app --template vueã€‚vue-cliå¯ä»¥å’Œwebpackåˆ†çš„å¾ˆæ¸…æ¥šã€‚ vue-cliç»™æˆ‘ä»¬æä¾›å·²ç»ç²¾è£…ä¿®çš„æ¨¡æ¿ã€‚ æˆ‘ä»¬è‡ªå·±æ­å»ºä¸€ä¸ªé¡¹ç›®ï¼šä¸‹è½½viteï¼Œvueï¼Œpost-cssï¼Œlessï¼Œlabel vue-cli/create-viteç»™äº†ä¸€å¥—ç²¾è£…ä¿®çš„æ¨¡æ¿ï¼šä»€ä¹ˆéƒ½ä¸‹å¥½äº†ï¼Œå¹¶ä¸”ç»™ä½ åšäº†æœ€ä½³å®è·µçš„é…ç½® ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:2:1","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"2.2 viteå¼€ç®±å³ç”¨ å¼€ç®±å³ç”¨ï¼ˆout of boxï¼‰ï¼šä¸éœ€è¦åšä»»ä½•é¢å¤–çš„é…ç½®å°±å¯ä»¥ä½¿ç”¨viteæ¥å¸®ä½ å¤„ç†æ„å»ºå·¥ä½œ åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„esmoduleå»å¯¼å…¥èµ„æºçš„æ—¶å€™ï¼Œè¦ä¹ˆæ˜¯ç»å¯¹è·¯å¾„ï¼Œè¦ä¹ˆæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ—¢ç„¶æˆ‘ä»¬ç°åœ¨çš„æœ€ä½³å®è·µæ˜¯node_modulesï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆeså®˜æ–¹åœ¨æˆ‘ä»¬å¯¼å…¥éç»å¯¹è·¯å¾„å’Œéç›¸å¯¹è·¯å¾„çš„èµ„æºçš„æ—¶å€™ä¸é»˜è®¤å¸®æˆ‘ä»¬æœå¯»node_modulesï¼Ÿ æµè§ˆå™¨ç¯å¢ƒä¸­çš„å®‰å…¨æ€§åŸå› æ˜¯ä¸€ä¸ªä¸»è¦è€ƒè™‘å› ç´ ã€‚å¦‚æœæµè§ˆå™¨é»˜è®¤æœç´¢node_modulesç›®å½•ï¼Œé‚£ä¹ˆæ¶æ„çš„ä»£ç å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸ªåŠŸèƒ½è®¿é—®å’Œæ‰§è¡Œä¸å—ä¿¡ä»»çš„æ¨¡å—ä»£ç ï¼Œä»è€Œå¯¼è‡´å®‰å…¨é£é™©ã€‚é€šè¿‡é™åˆ¶å¯¼å…¥è·¯å¾„ï¼Œæµè§ˆå™¨å¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ¨¡å—çš„æ¥æºå’Œè®¿é—®æƒé™ã€‚ å¦å¤–ï¼Œæ€§èƒ½ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„è€ƒè™‘å› ç´ ã€‚æµè§ˆå™¨é»˜è®¤åªæ”¯æŒç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„çš„å¯¼å…¥ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶é™æ€è§£ææ¨¡å—ä¾èµ–å…³ç³»ï¼Œä»è€Œæé«˜åŠ è½½å’Œæ‰§è¡Œæ¨¡å—çš„æ•ˆç‡ã€‚å¦‚æœæµè§ˆå™¨è¦æœç´¢node_modulesç›®å½•ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œé¢å¤–çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œå’Œè·¯å¾„è§£æï¼Œå¢åŠ äº†åŠ è½½æ¨¡å—çš„æ—¶é—´å’Œèµ„æºæ¶ˆè€—ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:2:2","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"2.3 viteçš„é¢„åŠ è½½ import _ from \"lodash\"; // lodashå¯èƒ½ä¹Ÿimportäº†å…¶ä»–çš„ä¸œè¥¿ import _vite_cjsImport0_lodash from \"/node_modules/.vite/deps/loadsh.js?v=ebe57916\"; åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­å¦‚æœè¯´çœ‹åˆ°äº†æœ‰éç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„çš„å¼•ç”¨ï¼Œåˆ™ä¼šå°è¯•å¼€å¯è·¯å¾„è¡¥å…¨ æ‰¾å¯»ä¾èµ–çš„è¿‡ç¨‹æ˜¯è‡ªå½“å‰ç›®å½•ä¾æ¬¡å‘ä¸ŠæŸ¥æ‰¾çš„è¿‡ç¨‹ï¼Œç›´åˆ°æœå¯»åˆ°æ ¹ç›®å½•æˆ–è€…æœå¯»åˆ°å¯¹åº”ä¾èµ–ä¸ºæ­¢ /user/node_modules/lodash, ../ åŒºåˆ†ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒï¼š yarn dev â€”-\u003e å¼€å‘ï¼ˆæ¯æ¬¡ä¾èµ–é¢„æ„å»ºæ‰€é‡æ–°æ„å»ºçš„ç›¸å¯¹è·¯å¾„éƒ½æ˜¯æ­£ç¡®çš„ï¼‰ viteä¼šå…¨æƒäº¤ç»™ä¸€ä¸ªå«åšrollupçš„åº“å»å®Œæˆç”Ÿäº§ç¯å¢ƒçš„æ‰“åŒ… ç¼“å­˜ â€”-\u003e å®é™…ä¸Šviteåœ¨è€ƒè™‘å¦å¤–ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™å°±é¡ºä¾¿æŠŠè¿™ä¸ªé—®é¢˜è§£å†³äº† commonjs è§„èŒƒçš„å¯¼å‡º module.exports æœ‰çš„åŒ…æ˜¯ä»¥commonjsè§„èŒƒçš„æ ¼å¼å¯¼å‡º axios ä¾èµ–é¢„æ„å»ºï¼šé¦–å…ˆviteä¼šæ‰¾åˆ°å¯¹åº”çš„ä¾èµ–ï¼Œç„¶åè°ƒç”¨esbuildï¼ˆå¯¹jsè¯­æ³•è¿›è¡Œå¤„ç†çš„ä¸€ä¸ªåº“ï¼‰ï¼Œå°†å…¶ä»–è§„èŒƒçš„ä»£ç è½¬æ¢æˆesmoduleè§„èŒƒï¼Œç„¶åæ”¾åˆ°å½“å‰ç›®å½•ä¸‹çš„node_modules/.vite/depsï¼ŒåŒæ—¶å¯¹esmoduleè§„èŒƒçš„å„ä¸ªæ¨¡å—è¿›è¡Œç»Ÿä¸€é›†æˆ æ‰€ä»¥å®ƒè§£å†³äº†3ä¸ªé—®é¢˜ï¼š ä¸åŒçš„ç¬¬ä¸‰æ–¹åŒ…ä¼šæœ‰ä¸åŒçš„å¯¼å‡ºæ ¼å¼ï¼ˆè¿™ä¸ªæ˜¯viteæ²¡æ³•çº¦æŸäººå®¶çš„äº‹æƒ…ï¼‰ å¯¹è·¯å¾„çš„å¤„ç†ä¸Šå¯ä»¥ç›´æ¥ä½¿ç”¨.vite/depsï¼Œæ–¹ä¾¿è·¯å¾„é‡å†™ å«åšç½‘ç»œå¤šåŒ…ä¼ è¾“çš„æ€§èƒ½é—®é¢˜ï¼ˆä¹Ÿæ˜¯åŸç”Ÿesmoduleè§„èŒƒä¸æ•¢æ”¯æŒnode_modulesçš„åŸå› ä¹‹ä¸€ï¼‰ï¼Œæœ‰äº†ä¾èµ–é¢„æ„å»ºä»¥åæ— è®ºå®ƒæœ‰å¤šå°‘çš„é¢å¤–çš„exportå’Œimportï¼Œviteéƒ½ä¼šå°½å¯èƒ½çš„å°†ä»–ä»¬é›†æˆæœ€ååªç”Ÿæˆä¸€ä¸ªæˆ–è€…å‡ ä¸ªæ¨¡å— vite.config.js === webpack.config.js ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:2:3","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"2.4 viteé…ç½®æ–‡ä»¶å¤„ç†ç»†èŠ‚ viteé…ç½®æ–‡ä»¶çš„è¯­æ³•æç¤º å¦‚æœä½ ä½¿ç”¨çš„æ˜¯webstormï¼Œé‚£ä½ å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„è¯­æ³•è¡¥å…¨ å¦‚æœä½ ä½¿ç”¨çš„æ˜¯vscodeæˆ–è€…å…¶ä»–ç¼–è¾‘å™¨ï¼Œåˆ™éœ€è¦åšä¸€äº›ç‰¹æ®Šå¤„ç† å…³äºç¯å¢ƒçš„å¤„ç† è¿‡å»æˆ‘ä»¬ä½¿ç”¨webpackçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†é…ç½®æ–‡ä»¶çš„ä¸€ä¸ªç¯å¢ƒï¼š webpack.dev.config webpack.prod.config webpack.base.config webpackmerge ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:2:4","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"2.5 vueç¯å¢ƒå˜é‡é…ç½® ç¯å¢ƒå˜é‡ï¼šä¼šæ ¹æ®å½“å‰çš„ä»£ç ç¯å¢ƒäº§ç”Ÿå€¼çš„å˜åŒ–çš„å˜é‡å°±å«åšç¯å¢ƒå˜é‡ ä»£ç ç¯å¢ƒï¼š å¼€å‘ç¯å¢ƒï¼šå¼€å‘ç¯å¢ƒæ˜¯å¼€å‘äººå‘˜è¿›è¡Œè½¯ä»¶å¼€å‘å’Œè°ƒè¯•çš„åœ°æ–¹ã€‚åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå¼€å‘äººå‘˜å¯ä»¥è¿›è¡Œä»£ç ç¼–å†™ã€è°ƒè¯•ã€æµ‹è¯•å’ŒéªŒè¯ã€‚è¿™ä¸ªç¯å¢ƒé€šå¸¸æ˜¯æœ¬åœ°çš„å¼€å‘æœºå™¨ï¼Œå¼€å‘äººå‘˜å¯ä»¥é€šè¿‡ä½¿ç”¨ Vite çš„å¼€å‘æœåŠ¡å™¨ï¼ˆdev serverï¼‰æ¥æä¾›å®æ—¶çš„é‡æ–°åŠ è½½ï¼ˆlive reloadingï¼‰å’Œæ¨¡å—çƒ­æ›¿æ¢ï¼ˆhot module replacementï¼‰åŠŸèƒ½ï¼Œä»¥ä¾¿æ›´å¿«åœ°è¿›è¡Œå¼€å‘å’Œè°ƒè¯•ã€‚ æµ‹è¯•ç¯å¢ƒï¼šæµ‹è¯•ç¯å¢ƒæ˜¯ç”¨äºè¿›è¡Œè½¯ä»¶æµ‹è¯•çš„ç¯å¢ƒã€‚åœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œå¼€å‘äººå‘˜å’Œæµ‹è¯•äººå‘˜å¯ä»¥å¯¹è½¯ä»¶è¿›è¡Œä¸åŒç±»å‹çš„æµ‹è¯•ï¼Œä¾‹å¦‚å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ã€‚åœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Vite æ„å»ºå·¥å…·ç”Ÿæˆæµ‹è¯•æ‰€éœ€çš„æ„å»ºæ–‡ä»¶ï¼Œå¹¶åœ¨æ¨¡æ‹Ÿçš„ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚ é¢„å‘å¸ƒç¯å¢ƒï¼šé¢„å‘å¸ƒç¯å¢ƒæ˜¯åœ¨è½¯ä»¶å‘å¸ƒä¹‹å‰è¿›è¡Œæœ€åæµ‹è¯•å’ŒéªŒè¯çš„ç¯å¢ƒã€‚åœ¨é¢„å‘å¸ƒç¯å¢ƒä¸­ï¼Œå¯ä»¥å¯¹è½¯ä»¶è¿›è¡Œæ›´å…¨é¢çš„æµ‹è¯•ï¼Œä»¥ç¡®ä¿å®ƒç¬¦åˆå‘å¸ƒçš„è´¨é‡æ ‡å‡†ã€‚è¿™ä¸ªç¯å¢ƒé€šå¸¸æ˜¯ä¸€ä¸ªç±»ä¼¼äºç”Ÿäº§ç¯å¢ƒçš„ç¯å¢ƒï¼Œä½†åœ¨å®é™…å‘å¸ƒä¹‹å‰ï¼Œå¯èƒ½ä¼šä½¿ç”¨ä¸€äº›æ¨¡æ‹Ÿæ•°æ®å’Œæ¨¡æ‹Ÿç³»ç»Ÿè¿›è¡Œæµ‹è¯•ã€‚ ç°åº¦ç¯å¢ƒï¼šç°åº¦ç¯å¢ƒæ˜¯åœ¨è½¯ä»¶å‘å¸ƒåé€æ­¥å‘ç”¨æˆ·ç¾¤ä½“æ¨å‡ºæ–°åŠŸèƒ½æˆ–æ›´æ–°çš„ç¯å¢ƒã€‚åœ¨ç°åº¦ç¯å¢ƒä¸­ï¼Œæ–°çš„è½¯ä»¶ç‰ˆæœ¬æˆ–åŠŸèƒ½å°†éƒ¨ç½²åˆ°ä¸€å°éƒ¨åˆ†ç”¨æˆ·ä¸­ï¼Œä»¥ä¾¿æµ‹è¯•å…¶ç¨³å®šæ€§å’Œå…¼å®¹æ€§ã€‚è¿™ä¸ªç¯å¢ƒç±»ä¼¼äºç”Ÿäº§ç¯å¢ƒï¼Œä½†åªæœ‰ä¸€éƒ¨åˆ†ç”¨æˆ·èƒ½å¤Ÿè®¿é—®æ–°çš„åŠŸèƒ½æˆ–æ›´æ–°ã€‚ ç”Ÿäº§ç¯å¢ƒï¼šç”Ÿäº§ç¯å¢ƒæ˜¯æœ€ç»ˆå‘ç”¨æˆ·æä¾›æœåŠ¡çš„ç¯å¢ƒã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå·²ç»é€šè¿‡äº†å¼€å‘ã€æµ‹è¯•ã€é¢„å‘å¸ƒå’Œç°åº¦ç¯å¢ƒçš„éªŒè¯ï¼Œå¹¶ä¸”å·²å‡†å¤‡å¥½ä¸ºæœ€ç»ˆç”¨æˆ·æä¾›ç¨³å®šã€å¯é çš„æœåŠ¡ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨ Vite æ„å»ºå·¥å…·ç”Ÿæˆç”¨äºéƒ¨ç½²çš„ç”Ÿäº§çº§åˆ«çš„æ„å»ºæ–‡ä»¶ï¼Œå¹¶è¿›è¡Œå¿…è¦çš„ä¼˜åŒ–å’Œå‹ç¼©ï¼Œä»¥æä¾›æœ€ä½³çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚ æˆ‘ä»¬åœ¨å’Œåç«¯åŒå­¦å¯¹æ¥çš„æ—¶å€™ï¼Œå‰ç«¯åœ¨å¼€å‘ç¯å¢ƒä¸­è¯·æ±‚çš„åç«¯APIåœ°å€å’Œç”Ÿäº§ç¯å¢ƒè¯·æ±‚çš„åç«¯APIåœ°å€æ˜¯ä¸€ä¸ªå—ï¼Ÿè‚¯å®šä¸æ˜¯ä¸€ä¸ª å¼€å‘å’Œæµ‹è¯•ï¼šhttp://test.api/ ç”Ÿäº§ï¼šhttps://api/ åœ¨viteä¸­çš„ç¯å¢ƒå˜é‡å¤„ç†ï¼š viteå†…ç½®äº†dotenvè¿™ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œä¼šè‡ªåŠ¨è¯»å–.envæ–‡ä»¶ï¼Œå¹¶è§£æè¿™ä¸ªæ–‡ä»¶ä¸­çš„å¯¹åº”çš„ç¯å¢ƒå˜é‡ï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ°processå¯¹è±¡ä¸‹ï¼ˆä½†æ˜¯viteè€ƒè™‘åˆ°å’Œå…¶ä»–é…ç½®çš„ä¸€äº›å†²çªé—®é¢˜ï¼Œå®ƒä¸ä¼šç›´æ¥æ³¨å…¥åˆ°processå¯¹è±¡ä¸‹ï¼‰ æ¶‰åŠåˆ°vite.config.jsä¸­çš„ä¸€äº›é…ç½®ï¼š root envDirï¼šç”¨æ¥é…ç½®å½“å‰ç¯å¢ƒå˜é‡çš„æ–‡ä»¶åœ°å€ viteç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›è¡¥å¿æªæ–½ï¼šæˆ‘ä»¬å¯ä»¥è°ƒç”¨viteçš„loadEnvæ¥æ‰‹åŠ¨ç¡®è®¤envæ–‡ä»¶ porcess.cwdæ–¹æ³•ï¼šè¿”å›nodeè¿›ç¨‹çš„å·¥ä½œç›®å½• å°çŸ¥è¯†ï¼šä¸ºä»€ä¹ˆvite.config.jså¯ä»¥ä¹¦å†™æˆesmoduleçš„å½¢å¼ï¼Œè¿™æ˜¯å› ä¸ºviteä»–åœ¨è¯»å–è¿™ä¸ªvite.config.jsçš„æ—¶å€™ä¼šç‡å…ˆnodeå»è§£ææ–‡ä»¶è¯­æ³•ï¼Œå¦‚æœå‘ç°ä½ æ˜¯esmoduleè§„èŒƒåˆ™ä¼šç›´æ¥å°†ä½ çš„esmoduleè§„èŒƒæ›¿æ¢æˆcommon jsè§„èŒƒ .envï¼šæ‰€æœ‰ç¯å¢ƒéƒ½éœ€è¦ç”¨åˆ°çš„ç¯å¢ƒå˜é‡ .env.developmentï¼šå¼€å‘ç¯å¢ƒéœ€è¦ç”¨åˆ°çš„ç¯å¢ƒå˜é‡ï¼ˆé»˜è®¤æƒ…å†µä¸‹viteå°†æˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒå–åä¸ºdevelopmentï¼‰ .env.productionï¼šç”Ÿäº§ç¯å¢ƒéœ€è¦ç”¨åˆ°çš„ç¯å¢ƒå˜é‡ï¼ˆé»˜è®¤æƒ…å†µä¸‹viteå°†æˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒå–åä¸ºproductionï¼‰ yarn dev â€“mode development ä¼šå°†modeè®¾ç½®ä¸ºdevelopmentä¼ é€’è¿›æ¥ å½“æˆ‘ä»¬è°ƒç”¨loadenvçš„æ—¶å€™ï¼Œå®ƒä¼šåšå¦‚ä¸‹å‡ ä»¶äº‹æƒ…ï¼š ç›´æ¥æ‰¾åˆ°.envæ–‡ä»¶ä¸è§£é‡Šï¼Œå¹¶è§£æå…¶ä¸­çš„ç¯å¢ƒå˜é‡ï¼Œæ”¾åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œ ä¼šå°†ä¼ è¿›æ¥çš„modeè¿™ä¸ªå˜é‡çš„å€¼è¿›è¡Œæ‹¼æ¥ï¼šenv.developmentï¼Œå¹¶æ ¹æ®æˆ‘ä»¬æä¾›çš„ç›®å½•å»å–å¯¹åº”é…ç½®æ–‡ä»¶å¹¶è¿›è¡Œè§£æï¼Œå¹¶æ”¾è¿›ä¸€ä¸ªå¯¹è±¡ æˆ‘ä»¬å¯ä»¥ç†è§£ä¸º const baseEnvConfig = è¯»å–.envé…ç½® const modeEnvConfig = è¯»å–envç›¸å…³é…ç½® const lastEnvConfig = {...baseEnvConfig, ...modeEnvConfig} å¦‚æœæ˜¯å®¢æˆ·ç«¯ï¼Œviteä¼šå°†å¯¹åº”çš„ç¯å¢ƒå˜é‡æ³¨å…¥åˆ°import.meta.envé‡Œå» viteåšäº†ä¸€ä¸ªæ‹¦æˆªï¼Œä¸ºäº†é˜²æ­¢æˆ‘ä»¬å°†éšç§æ€§çš„å˜é‡ç›´æ¥é€åˆ°import.meta.envä¸­ï¼Œæ‰€ä»¥åšäº†ä¸€å±‚æ‹¦æˆªï¼Œå¦‚æœä½ çš„ç¯å¢ƒå˜é‡ä¸æ˜¯ä»¥VITEå¼€å¤´çš„ï¼Œä»–å°±ä¸ä¼šå¸®ä½ æ³¨å…¥åˆ°å®¢æˆ·ç«¯ä¸­å»ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´æ”¹è¿™ä¸ªå‰ç¼€ï¼Œå¯ä»¥å»ä½¿ç”¨envPrefixé…ç½®ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:2:5","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"3 vite åŸç†ç¯‡ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:3:0","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"3.1 viteæ˜¯æ€ä¹ˆè®©æµè§ˆå™¨å¯ä»¥è¯†åˆ«.vueæ–‡ä»¶å‘¢ Vite æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„å‰ç«¯æ„å»ºå·¥å…·ï¼Œå®ƒä½¿ç”¨äº†ä¸€ç§åä¸ºå•æ–‡ä»¶ç»„ä»¶ï¼ˆSingle File Componentsï¼‰çš„æŠ€æœ¯æ¥è®©æµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«å’ŒåŠ è½½ .vue æ–‡ä»¶ã€‚ åœ¨ä¼ ç»Ÿçš„å‰ç«¯å¼€å‘ä¸­ï¼Œæµè§ˆå™¨æ— æ³•ç›´æ¥è¯†åˆ«å’ŒåŠ è½½ .vue æ–‡ä»¶ï¼Œå› ä¸º .vue æ–‡ä»¶åŒ…å«äº† HTMLã€CSS å’Œ JavaScript ä»£ç ï¼Œè€Œæµè§ˆå™¨åªèƒ½è¯†åˆ«å’Œæ‰§è¡Œ JavaScript æ–‡ä»¶ã€‚ Vite åˆ©ç”¨äº†æ„å»ºå·¥å…·å’Œæ‰“åŒ…å™¨çš„èƒ½åŠ›ï¼Œåœ¨å¼€å‘é˜¶æ®µå°† .vue æ–‡ä»¶è½¬æ¢ä¸ºæµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„å½¢å¼ã€‚å®ƒå€ŸåŠ©ç‰¹å®šçš„ç¼–è¯‘å™¨ï¼ˆå¦‚ Vue ç¼–è¯‘å™¨ï¼‰å°† .vue æ–‡ä»¶çš„æ¨¡æ¿ã€æ ·å¼å’Œè„šæœ¬éƒ¨åˆ†åˆ†åˆ«æå–å‡ºæ¥ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºæµè§ˆå™¨å¯ä»¥ç†è§£çš„ä»£ç ã€‚ å…·ä½“åœ°è¯´ï¼ŒVite ä½¿ç”¨äº†åä¸º â€œvue-loaderâ€ çš„å·¥å…·æ¥è§£æå’Œè½¬æ¢ .vue æ–‡ä»¶ã€‚è¿™ä¸ªå·¥å…·ä¼šè§£æ .vue æ–‡ä»¶çš„å†…å®¹ï¼Œæå–å‡ºå…¶ä¸­çš„æ¨¡æ¿ã€æ ·å¼å’Œè„šæœ¬ï¼Œå¹¶å°†å®ƒä»¬è½¬åŒ–ä¸ºç‹¬ç«‹çš„ä»£ç å—ã€‚ç„¶åï¼ŒVite ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿçš„ ES æ¨¡å—å¯¼å…¥æœºåˆ¶ï¼Œé€šè¿‡ \u003cscript type=\"module\"\u003e æ ‡ç­¾å°†è¿™äº›ä»£ç å—åŠ è½½åˆ°æµè§ˆå™¨ä¸­ã€‚ å½“æµè§ˆå™¨é‡åˆ° \u003cscript type=\"module\"\u003e æ ‡ç­¾æ—¶ï¼Œå®ƒä¼šå°†æ ‡ç­¾ä¸­çš„ JavaScript ä»£ç ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—åŠ è½½å’Œæ‰§è¡Œã€‚Vite åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå°† .vue æ–‡ä»¶ä¸­çš„æ¨¡æ¿ã€æ ·å¼å’Œè„šæœ¬éƒ¨åˆ†åˆ†åˆ«ä½œä¸ºç‹¬ç«‹çš„æ¨¡å—åŠ è½½åˆ°æµè§ˆå™¨ä¸­ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­åŠ¨æ€ç»„åˆå®ƒä»¬ï¼Œæ„å»ºå‡ºæœ€ç»ˆçš„ç»„ä»¶ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:3:1","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"3.2 ä½¿ç”¨path.resolveçš„åŸå›  åœ¨ä½¿ç”¨è·¯å¾„æ—¶ï¼Œå°½é‡ä½¿ç”¨ path.resolve æ–¹æ³•å¯ä»¥ç¡®ä¿è·¯å¾„çš„å¯é æ€§å’Œè·¨å¹³å°æ€§ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªä½¿ç”¨ path.resolve æ–¹æ³•çš„å¥½å¤„ï¼š å¤„ç†ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ï¼špath.resolve æ–¹æ³•å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ï¼Œå°†å®ƒä»¬è§£æä¸ºä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶è§£æä¸ºç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚è¿™å¯¹äºç¡®å®šå‡†ç¡®çš„æ–‡ä»¶è·¯å¾„éå¸¸æœ‰ç”¨ã€‚ è§£å†³è·¨å¹³å°è·¯å¾„é—®é¢˜ï¼šåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œå¯¹äºè·¯å¾„åˆ†éš”ç¬¦å’Œè·¯å¾„è¡¨ç¤ºæ³•æœ‰æ‰€å·®å¼‚ã€‚ä½¿ç”¨ path.resolve æ–¹æ³•å¯ä»¥ç¡®ä¿ç”Ÿæˆçš„è·¯å¾„åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸‹éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨æ ¹æ®å½“å‰æ“ä½œç³»ç»Ÿè°ƒæ•´è·¯å¾„åˆ†éš”ç¬¦å’Œè¡¨ç¤ºæ³•ã€‚ å¤„ç†è·¯å¾„æ‹¼æ¥å’Œè§„èŒƒåŒ–ï¼špath.resolve æ–¹æ³•ä¼šå°†ä¼ å…¥çš„è·¯å¾„ç‰‡æ®µè¿›è¡Œæ‹¼æ¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªè§„èŒƒåŒ–çš„è·¯å¾„ã€‚è¿™æ„å‘³ç€å®ƒä¼šè§£æå’Œå¤„ç†è·¯å¾„ä¸­çš„ ..ã€. ç­‰ç›¸å¯¹è·¯å¾„ç¬¦å·ï¼Œç¡®ä¿ç”Ÿæˆçš„è·¯å¾„æ˜¯è§„èŒƒåŒ–çš„ã€å¹²å‡€çš„è·¯å¾„ã€‚ ç¡®ä¿è·¯å¾„çš„å­˜åœ¨æ€§ï¼šä½¿ç”¨ path.resolve æ–¹æ³•ç”Ÿæˆçš„è·¯å¾„æ˜¯ç¡®ä¿å­˜åœ¨çš„ï¼Œå®ƒä¸ä¼šæ£€æŸ¥è·¯å¾„æ˜¯å¦æœ‰æ•ˆæˆ–æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œä½†ä¼šç¡®ä¿è·¯å¾„çš„æ ¼å¼æ­£ç¡®ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ åœ¨æ“ä½œæ–‡ä»¶ç³»ç»Ÿæ—¶æä¾›æ­£ç¡®çš„è·¯å¾„ï¼Œé¿å…å‡ºç°é”™è¯¯æˆ–å¼‚å¸¸ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:3:2","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"4 viteä¸css ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:4:0","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"4.1 åœ¨viteä¸­å¤„ç†css viteå¤©ç”Ÿå°±æ”¯æŒå¯¹cssæ–‡ä»¶çš„ç›´æ¥å¤„ç† viteåœ¨è¯»å–åˆ°main.jsæ–‡ä»¶ä¸­å¼•ç”¨åˆ°äº†index.css ç›´æ¥ä½¿ç”¨fsæ¨¡å—å»è¯»å–index.cssä¸­æ–‡ä»¶å†…å®¹ ç›´æ¥åˆ›å»ºä¸€ä¸ªstyleæ ‡ç­¾ï¼Œå°†index.cssä¸­æ–‡ä»¶å†…å®¹ç›´æ¥copyåˆ°styleæ ‡ç­¾é‡Œ å°†styleæ ‡ç­¾æ’å…¥åˆ°index.htmlçš„headä¸­ å°†cssæ–‡ä»¶ä¸­çš„å†…å®¹ç›´æ¥æ›¿æ¢ä¸ºjsè„šæœ¬ï¼ˆæ–¹ä¾¿çƒ­æ›´æ–°æˆ–è€…cssæ¨¡å—åŒ–ï¼‰ï¼ŒåŒæ—¶è®¾ç½®Content-Typeä¸ºjsï¼Œä»è€Œè®©æµè§ˆå™¨ä»¥JSè„šæœ¬çš„å½¢å¼æ¥æ‰§è¡Œè¯¥cssåç¼€çš„æ–‡ä»¶ åœºæ™¯ï¼š ä¸€ä¸ªç»„ä»¶æœ€å¤–å±‚çš„å…ƒç´ ç±»åä¸€èˆ¬å–åï¼š wrapper ä¸€ä¸ªç»„ä»¶æœ€åº•å±‚çš„å…ƒç´ ç±»åä¸€èˆ¬å–åï¼šfooter ä½†ä½ å–äº†footerè¿™ä¸ªåå­—ï¼Œåˆ«äººå› ä¸ºæ²¡æœ‰çœ‹è¿‡ä½ è¿™ä¸ªç»„ä»¶çš„æºä»£ç ï¼Œä¹Ÿå¯èƒ½å»å–åfooterè¿™ä¸ªç±»åï¼Œæœ€åå¯èƒ½ä¼šå¯¼è‡´æ ·å¼è¢«è¦†ç›–ï¼ˆå› ä¸ºç±»åé‡å¤ï¼‰ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬åœ¨ååŒå¼€å‘å¾ˆå®¹æ˜“å‡ºç°çš„é—®é¢˜ cssmoduleå°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼š module.cssï¼ˆmoduleæ˜¯ä¸€ç§çº¦å®šï¼Œè¡¨ç¤ºéœ€è¦å¼€å¯cssæ¨¡å—åŒ–ï¼‰ ä»–ä¼šå°†ä½ çš„æ‰€æœ‰ç±»åè¿›è¡Œä¸€å®šè§„åˆ™çš„æ›¿æ¢ï¼ˆå°†footeræ›¿æ¢ä¸º_footer_i22st_1ï¼‰ åŒæ—¶åˆ›å»ºä¸€ä¸ªæ˜ å°„å¯¹è±¡{ footer: \"_footer_i22st_1\"} å°†æ›¿æ¢è¿‡åçš„å†…å®¹å¡è¿›styleæ ‡ç­¾é‡Œç„¶åæ”¾å…¥åˆ°headæ ‡ç­¾ä¸­ï¼ˆèƒ½å¤Ÿè¯»åˆ°index.htmlçš„æ–‡ä»¶å†…å®¹ï¼‰ å°†componentA.module.csså†…å®¹å…¨éƒ¨æŠ¹é™¤ï¼Œæ›¿æ¢ä¸ºJSè„šæœ¬ å°†åˆ›å»ºçš„æ˜ å°„å¯¹è±¡åœ¨è„šæœ¬ä¸­é»˜è®¤å¯¼å‡º ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:4:1","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"4.2 cssæ–‡ä»¶ç±»å‹ CSSï¼ˆ.cssï¼‰ï¼šCSS æ˜¯å±‚å æ ·å¼è¡¨çš„æ ‡å‡†æ–‡ä»¶æ ¼å¼ï¼Œå®ƒä½¿ç”¨ç±»ä¼¼äºé€‰æ‹©å™¨å’Œå±æ€§çš„è¯­æ³•æ¥æè¿°ç½‘é¡µçš„æ ·å¼ã€‚CSS æ˜¯å‰ç«¯å¼€å‘ä¸­æœ€å¸¸è§çš„æ ·å¼è¡¨è¯­è¨€ï¼Œæµè§ˆå™¨åŸç”Ÿæ”¯æŒã€‚ LESSï¼ˆ.lessï¼‰ï¼šLESS æ˜¯ CSS çš„æ‹“å±•ï¼Œå®ƒå¼•å…¥äº†å˜é‡ã€åµŒå¥—è§„åˆ™ã€Mixinï¼ˆæ··å…¥ï¼‰ç­‰åŠŸèƒ½ï¼Œä»¥ç®€åŒ– CSS çš„ç¼–å†™å’Œç»´æŠ¤ã€‚LESS æ–‡ä»¶éœ€è¦åœ¨å¼€å‘é˜¶æ®µé€šè¿‡ LESS ç¼–è¯‘å™¨è½¬æ¢ä¸ºæ ‡å‡†çš„ CSS æ–‡ä»¶ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­åŠ è½½ã€‚ SCSS/SASSï¼ˆ.scss/.sassï¼‰ï¼šSCSSï¼ˆSassy CSSï¼‰å’Œ SASSï¼ˆSyntactically Awesome Style Sheetsï¼‰ä¹Ÿæ˜¯ CSS çš„æ‹“å±•ï¼Œæä¾›äº†ç±»ä¼¼ LESS çš„åŠŸèƒ½ï¼Œå¦‚å˜é‡ã€åµŒå¥—è§„åˆ™å’Œ Mixinã€‚SCSS ä¸ SASS çš„è¯­æ³•ç•¥æœ‰ä¸åŒï¼Œä½†éƒ½éœ€è¦é€šè¿‡ç¼–è¯‘å™¨å°†å…¶è½¬æ¢ä¸ºæ ‡å‡†çš„ CSS æ–‡ä»¶ã€‚ /* SCSS */ .container { width: 100%; .header { background-color: #333; color: #fff; padding: 10px; } .content { padding: 20px; p { margin-bottom: 10px; } a { color: #f00; text-decoration: none; \u0026:hover { text-decoration: underline; } } } .footer { background-color: #333; color: #fff; padding: 10px; } } åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ.container æ˜¯æœ€å¤–å±‚çš„å®¹å™¨é€‰æ‹©å™¨ï¼Œå®ƒåŒ…å«äº† .headerã€.content å’Œ .footer å­é€‰æ‹©å™¨ã€‚é€šè¿‡åµŒå¥—å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ›´ç›´è§‚åœ°è¡¨ç¤ºè¿™äº›é€‰æ‹©å™¨ä¹‹é—´çš„å±‚æ¬¡ç»“æ„ã€‚ æ­¤å¤–ï¼ŒåµŒå¥—å®šä¹‰è¿˜å¯ä»¥å‡å°‘é‡å¤ä»£ç çš„ç¼–å†™ã€‚åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ.header å’Œ .footer å…·æœ‰ç›¸åŒçš„èƒŒæ™¯é¢œè‰²ã€æ–‡å­—é¢œè‰²å’Œå†…è¾¹è·ï¼Œé€šè¿‡åµŒå¥—å®šä¹‰ï¼Œæˆ‘ä»¬åªéœ€åœ¨çˆ¶é€‰æ‹©å™¨ä¸­æŒ‡å®šä¸€æ¬¡å³å¯ï¼Œé¿å…äº†é‡å¤çš„æ ·å¼å£°æ˜ã€‚ å¦å¤–ï¼ŒåµŒå¥—å®šä¹‰è¿˜å¯ä»¥æ–¹ä¾¿åœ°åº”ç”¨ä¼ªç±»å’Œä¼ªå…ƒç´ æ ·å¼ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼ŒåµŒå¥—å®šä¹‰äº† a å…ƒç´ çš„æ ·å¼ï¼Œå¹¶ä½¿ç”¨ \u0026:hover è¡¨ç¤ºå…¶æ‚¬åœçŠ¶æ€ä¸‹çš„æ ·å¼ï¼Œè¿™æ ·å¯ä»¥æ›´ç›´è§‚åœ°è¡¨ç¤ºé€‰æ‹©å™¨ä¹‹é—´çš„å…³ç³»ã€‚ é€šè¿‡ä½¿ç”¨åµŒå¥—å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¸…æ™°åœ°ç»„ç»‡å’Œç»´æŠ¤æ ·å¼ä»£ç ï¼Œå‡å°‘äº†å†—ä½™å’Œé‡å¤çš„å·¥ä½œï¼Œæé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:4:2","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"4.3 vite.config.jsä¸­cssé…ç½® åœ¨vite.config.jsä¸­æˆ‘ä»¬é€šè¿‡csså±æ€§å»æ§åˆ¶æ•´ä¸ªviteå¯¹äºcssçš„å¤„ç†è¡Œä¸º 4.3.1 moduleç¯‡ css: { modules: { } } css: { // å¯¹cssçš„è¡Œä¸ºè¿›è¡Œé…ç½® // modulesé…ç½®æœ€ç»ˆä¼šä¸¢ç»™postcss modules modules: { // æ˜¯å¯¹cssæ¨¡å—åŒ–çš„é»˜è®¤è¡Œä¸ºè¿›è¡Œè¦†ç›– localsConvention: 'camelCase', // ä¿®æ”¹ç”Ÿæˆçš„é…ç½®å¯¹è±¡çš„ key çš„å±•ç¤ºå½¢å¼ä¸ºé©¼å³°å‘½å scopeBehaviour: 'global', // é…ç½®å½“å‰çš„æ¨¡å—åŒ–è¡Œä¸ºä¸ºå…¨å±€åŒ– generateScopedName: '[name]__[local]___[hash:base64:5]', // æŒ‡å®šç”Ÿæˆçš„ç±»åçš„å‘½åè§„åˆ™ hashPrefix: 'my-app', // ç”Ÿæˆçš„ hash çš„å‰ç¼€ globalModulePaths: ['path/to/global/styles'] // ä¸å‚ä¸ CSS æ¨¡å—åŒ–çš„è·¯å¾„ } } localsConventionï¼šä¿®æ”¹ç”Ÿæˆçš„é…ç½®å¯¹è±¡çš„keyçš„å±•ç¤ºå½¢å¼ï¼ˆé©¼å³°è¿˜æ˜¯ä¸­åˆ’çº¿å½¢å¼ï¼‰ scopeBehaviourï¼šé…ç½®å½“å‰çš„æ¨¡å—åŒ–è¡Œä¸ºæ˜¯æ¨¡å—åŒ–è¿˜æ˜¯å…¨å±€åŒ–ï¼ˆæœ‰hashå°±æ˜¯å¼€å¯äº†æ¨¡å—åŒ–çš„ä¸€ä¸ªæ ‡å¿—ï¼Œå› ä¸ºå®ƒå¯ä»¥ä¿è¯äº§ç”Ÿä¸åŒçš„hashå€¼æ¥æ§åˆ¶æˆ‘ä»¬çš„æ ·å¼ç±»åä¸è¢«è¦†ç›–ï¼‰ generateScopedNameï¼š[name_[local]_[hash:5]]ï¼ŒæŒ‡å®šç”Ÿæˆçš„ç±»åçš„å‘½åè§„åˆ™ï¼ˆå¯ä»¥é…ç½®ä¸ºå‡½æ•°ï¼Œä¹Ÿå¯ä»¥é…ç½®æˆå­—ç¬¦ä¸²è§„åˆ™ï¼‰ hashPrefixï¼šç”Ÿæˆçš„hashä¼šæ ¹æ®ä½ çš„ç±»åè¿›è¡Œç”Ÿæˆï¼Œå¦‚æœæƒ³è¦ä½ ç”Ÿæˆçš„hashæ›´åŠ çš„ç‹¬ç‰¹ä¸€ç‚¹ï¼Œä½ å¯ä»¥é…ç½®hashPrefixï¼Œä½ é…ç½®çš„è¿™ä¸ªå­—ç¬¦ä¸²ä¼šå‚ä¸åˆ°æœ€ç»ˆçš„hashç”Ÿæˆ globalModulePathsï¼šä»£è¡¨ä½ ä¸æƒ³å‚ä¸åˆ°cssæ¨¡å—åŒ–çš„è·¯å¾„ 4.3.2 preprocessorOptionç¯‡ ä¸»è¦æ˜¯ç”¨æ¥é…ç½®cssé¢„å¤„ç†çš„ä¸€äº›å…¨å±€å‚æ•° css: { preprocessorOptions: { // é…ç½® CSS é¢„å¤„ç†å™¨çš„å…¨å±€å‚æ•° } } åœ¨ preprocessorOptions ä¸­ï¼Œä½ å¯ä»¥é…ç½® CSS é¢„å¤„ç†å™¨çš„ä¸€äº›å…¨å±€å‚æ•°ï¼Œå…·ä½“å‚æ•°çš„é…ç½®å–å†³äºä½ ä½¿ç”¨çš„é¢„å¤„ç†å™¨ï¼ˆå¦‚ Sassã€Less ç­‰ï¼‰ã€‚è¿™é‡Œå¯ä»¥é…ç½®ä¸€äº›é€šç”¨çš„é€‰é¡¹ï¼Œæ¯”å¦‚ï¼š additionalDataï¼šé¢å¤–çš„å…¨å±€æ ·å¼æ•°æ®ï¼Œå¯ä»¥åœ¨æ¯ä¸ª CSS æ–‡ä»¶çš„é¡¶éƒ¨æ³¨å…¥ï¼Œä¾‹å¦‚å…±äº«çš„å˜é‡ã€æ··åˆå™¨ç­‰ã€‚ sassï¼šç”¨äºé…ç½® Sass é¢„å¤„ç†å™¨çš„é€‰é¡¹ï¼Œå¦‚ sass é€‰é¡¹ä¸­çš„ indentedSyntax è¡¨ç¤ºæ˜¯å¦ä½¿ç”¨ç¼©è¿›è¯­æ³•ã€‚ lessï¼šç”¨äºé…ç½® Less é¢„å¤„ç†å™¨çš„é€‰é¡¹ï¼Œå¦‚ less é€‰é¡¹ä¸­çš„ javascriptEnabled è¡¨ç¤ºæ˜¯å¦å¯ç”¨ Less ä¸­çš„ JavaScript è¡¨è¾¾å¼ã€‚ 4.3.3 postcssç¯‡ import autoprefixer from 'autoprefixer'; export default { // ... css: { postcss: { plugins: [ autoprefixer(), // é…ç½® PostCSS æ’ä»¶ï¼Œä¾‹å¦‚ Autoprefixer // å…¶ä»–çš„ PostCSS æ’ä»¶... ] } } } åœ¨ postcss é…ç½®é¡¹ä¸­ï¼Œä½ å¯ä»¥æŒ‡å®šè¦ä½¿ç”¨çš„ PostCSS æ’ä»¶ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå¸¸è§çš„æ’ä»¶ Autoprefixerï¼Œå®ƒç”¨äºè‡ªåŠ¨æ·»åŠ  CSS æµè§ˆå™¨å‰ç¼€ï¼Œä»¥æä¾›è·¨æµè§ˆå™¨å…¼å®¹æ€§ã€‚ ä½ å¯ä»¥æ ¹æ®éœ€è¦ï¼Œå°†å…¶ä»–çš„ PostCSS æ’ä»¶æ·»åŠ åˆ° plugins æ•°ç»„ä¸­ã€‚è¿™äº›æ’ä»¶å¯ä»¥ç”¨äºæ‰§è¡Œå„ç§ CSS å¤„ç†ä»»åŠ¡ï¼Œä¾‹å¦‚å‹ç¼©ã€ä¼˜åŒ–ã€è½¬æ¢ç­‰ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†ä½¿ç”¨ç‰¹å®šçš„ PostCSS æ’ä»¶ï¼Œä½ éœ€è¦åœ¨é¡¹ç›®ä¸­å®‰è£…è¿™äº›æ’ä»¶çš„ç›¸åº”ä¾èµ–ï¼Œå¹¶åœ¨ vite.config.js æ–‡ä»¶ä¸­è¿›è¡Œæ­£ç¡®çš„å¯¼å…¥å’Œé…ç½®ã€‚ æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥åœ¨ postcss é…ç½®é¡¹ä¸­è®¾ç½®å…¶ä»–é€‰é¡¹ï¼Œä¾‹å¦‚ configã€sourceMap ç­‰ï¼Œä»¥æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚ã€‚å…·ä½“çš„é…ç½®é€‰é¡¹å’Œè¯­æ³•è§„åˆ™å¯ä»¥å‚è€ƒ PostCSS æ’ä»¶çš„æ–‡æ¡£æˆ–ç›¸å…³èµ„æºã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:4:3","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"5 viteç›¸å…³çŸ¥è¯† ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:5:0","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"5.1 viteåŠ è½½é™æ€èµ„æº ä»€ä¹ˆæ˜¯é™æ€èµ„æºï¼Ÿ é™æ€èµ„æºæ˜¯æŒ‡ä¸éœ€è¦ç»è¿‡æ„å»ºå¤„ç†çš„æ–‡ä»¶ï¼Œä¾‹å¦‚å›¾ç‰‡ã€è§†é¢‘ã€å­—ä½“ç­‰ï¼Œé™¤äº†åŠ¨æ€APIä»¥å¤–ï¼Œç™¾åˆ†ä¹‹ä¹åä¹çš„èµ„æºéƒ½è¢«è§†ä½œé™æ€èµ„æº viteå¯¹é™æ€èµ„æºåŸºæœ¬ä¸Šæ˜¯å¼€ç®±å³ç”¨çš„ï¼Œé™¤äº†ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼ˆsvgï¼‰ è¦åŠ è½½é™æ€èµ„æºï¼Œä½ å¯ä»¥å°†å®ƒä»¬æ”¾ç½®åœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸­çš„ä»»ä½•ä½ç½®ã€‚é€šå¸¸ï¼Œä½ å¯ä»¥å°†è¿™äº›é™æ€èµ„æºæ”¾ç½®åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ public æ–‡ä»¶å¤¹ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªé¢„å®šä¹‰çš„é™æ€èµ„æºæ–‡ä»¶å¤¹ã€‚å½“ä½ åœ¨ä»£ç ä¸­å¼•ç”¨è¿™äº›é™æ€èµ„æºæ—¶ï¼ŒVite ä¼šè‡ªåŠ¨å°†å®ƒä»¬æä¾›ç»™ä½ çš„åº”ç”¨ç¨‹åºã€‚ ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ä½ çš„é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªåä¸º public çš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ logo.pngï¼Œä½ å¯ä»¥åœ¨ä»£ç ä¸­åƒä¸‹é¢è¿™æ ·å¼•ç”¨å®ƒï¼š \u003cimg src=\"/logo.png\" alt=\"Logo\" /\u003e Vite ä¼šè‡ªåŠ¨å°†æ­¤è·¯å¾„è§£æä¸ºç›¸åº”çš„é™æ€èµ„æºï¼Œå¹¶å°†å…¶æä¾›ç»™ä½ çš„åº”ç”¨ç¨‹åºã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ Vite ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ç›¸å¯¹äºæ ¹ç›®å½•çš„ç»å¯¹è·¯å¾„æ¥å¼•ç”¨é™æ€èµ„æºï¼Œè€Œæ— éœ€è€ƒè™‘æ¨¡å—åŒ–çš„è·¯å¾„è§£æã€‚è¿™æ˜¯å› ä¸º Vite ä½¿ç”¨è‡ªå·±çš„å¼€å‘æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶åŠ¨æ€å¤„ç†è¿™äº›é™æ€èµ„æºçš„è¯·æ±‚ã€‚ å¯¹äºæŸäº›ç‰¹æ®Šçš„é™æ€èµ„æºï¼Œå¦‚ SVG æ–‡ä»¶ï¼Œä½ å¯èƒ½éœ€è¦é¢å¤–çš„é…ç½®æ¥ç¡®ä¿æ­£ç¡®åŠ è½½ã€‚å¯¹äº SVG æ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ @vitejs/plugin-svg æ’ä»¶æ¥å¤„ç†ã€‚ä½ å¯ä»¥æŒ‰ç…§ Vite å®˜æ–¹æ–‡æ¡£ä¸­çš„è¯´æ˜ï¼Œæ·»åŠ è¯¥æ’ä»¶å¹¶è¿›è¡Œç›¸åº”çš„é…ç½®ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:5:1","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"5.2 viteåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯¹é™æ€èµ„æºçš„å¤„ç† é™æ€èµ„æºçš„å¯¼å…¥å’Œå¤„ç†ï¼š åœ¨ä½ çš„ä»£ç ä¸­ï¼Œå¦‚æœæœ‰é™æ€èµ„æºçš„å¯¼å…¥è¯­å¥ï¼ˆå¦‚å›¾ç‰‡ã€å­—ä½“ã€CSS æ–‡ä»¶ç­‰ï¼‰ï¼ŒVite ä¼šæ ¹æ®è¿™äº›å¯¼å…¥è¯­å¥è‡ªåŠ¨å¤„ç†è¿™äº›èµ„æºã€‚ èµ„æºä¼˜åŒ–å’Œå‹ç¼©ï¼š Vite ä¼šå¯¹å¯¼å…¥çš„é™æ€èµ„æºè¿›è¡Œä¼˜åŒ–å’Œå‹ç¼©ï¼Œä»¥å‡å°æ–‡ä»¶å¤§å°å¹¶æå‡åŠ è½½æ€§èƒ½ã€‚è¿™åŒ…æ‹¬ä½†ä¸é™äºå‹ç¼©å›¾ç‰‡ã€å‹ç¼©å’Œåˆå¹¶ CSS æ–‡ä»¶ç­‰æ“ä½œã€‚ æŒ‡çº¹åŒ–æ–‡ä»¶åï¼š ä¸ºäº†æ›´å¥½çš„ç¼“å­˜ç®¡ç†å’Œæ›´æ–°æœºåˆ¶ï¼ŒVite ä¼šä¸ºå¤„ç†åçš„é™æ€èµ„æºç”Ÿæˆå¸¦æœ‰æŒ‡çº¹çš„æ–‡ä»¶åã€‚è¿™æ„å‘³ç€æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„å“ˆå¸Œå€¼ä½œä¸ºæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚ logo.8e4c5f7b.pngã€‚å½“æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå“ˆå¸Œå€¼ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»è€Œç¡®ä¿å®¢æˆ·ç«¯èƒ½å¤Ÿæ­£ç¡®åœ°ç¼“å­˜å’Œæ›´æ–°é™æ€èµ„æºã€‚ è¾“å‡ºé™æ€èµ„æºï¼š å¤„ç†åçš„é™æ€èµ„æºä¼šè¢«è¾“å‡ºåˆ°æ„å»ºç›®å½•ï¼ˆé»˜è®¤ä¸º distï¼‰ä¸­ã€‚Vite ä¼šæ ¹æ®èµ„æºç±»å‹ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶ï¼Œå¦‚å›¾ç‰‡ä¼šç”Ÿæˆ .pngã€.jpg ç­‰æ–‡ä»¶ï¼ŒCSS æ–‡ä»¶ä¼šç”Ÿæˆ .css æ–‡ä»¶ç­‰ã€‚ å¼•ç”¨é™æ€èµ„æºï¼š åœ¨ä½ çš„ HTML æ–‡ä»¶æˆ–ç”Ÿæˆçš„ä»£ç ä¸­ï¼ŒVite ä¼šè‡ªåŠ¨æ›´æ–°é™æ€èµ„æºçš„å¼•ç”¨è·¯å¾„ï¼Œä»¥æŒ‡å‘æ„å»ºç›®å½•ä¸­çš„æ­£ç¡®æ–‡ä»¶ã€‚è¿™æ ·ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ç›¸å¯¹äºæ„å»ºç›®å½•çš„è·¯å¾„æ¥å¼•ç”¨é™æ€èµ„æºï¼Œè€Œæ— éœ€å…³å¿ƒå¼€å‘ç¯å¢ƒä¸­çš„æ¨¡å—è§£æå’Œè·¯å¾„å¤„ç†ã€‚ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:5:2","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å‰ç«¯"],"content":"5.3 viteå¸¸ç”¨æ’ä»¶ æ’ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ viteä¼šåœ¨ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒé˜¶æ®µä¸­è°ƒç”¨ä¸åŒçš„æ’ä»¶ä»¥è¾¾åˆ°ä¸åŒçš„ç›®çš„ ç”Ÿå‘½å‘¨æœŸï¼šviteä»å¼€å§‹æ‰§è¡Œåˆ°æ‰§è¡Œç»“æŸ 5.3.1 vite-aliases ä½œç”¨ï¼šåˆ«åè‡ªåŠ¨ç”Ÿæˆ å®‰è£…ï¼šyarn add vite-aliases -D å°†å…¶æ·»åŠ åˆ°vite.config.jsä¸­ // vite.config.js import { ViteAliases } from 'vite-aliases' export default { plugins: [ ViteAliases() ] }; vite-aliasesçš„å¯é€‰é…ç½®é¡¹å¦‚ä¸‹ï¼š ViteAliases({ /** * Relative path to the project directory */ dir: 'src', /** * Prefix symbol for the aliases */ prefix: '~', /** * Allow searching for subdirectories */ deep: true, /** * Search depthlevel for subdirectories */ depth: 1, /** * Creates a Logfile * use `logPath` to change the location */ createLog: false, /** * Path for Logfile */ logPath: 'src/logs', /** * Create global project directory alias */ createGlobalAlias: true, /** * Turns duplicates into camelCased path aliases */ adjustDuplicates: false, /** * Used paths in JS/TS configs will now be relative to baseUrl */ useAbsolute: false, /** * Adds seperate index paths * approach created by @davidohlin */ useIndexes: false, /** * Generates paths in IDE config file * works with JS or TS */ useConfig: true, /** * Override config paths */ ovrConfig: false, /** * Will generate Paths in tsconfig * used in combination with `useConfig` * Typescript will be auto detected */ dts: false, /** * Disables any terminal output */ silent: true, /** * Root path of Vite project */ root: process.cwd() }); 5.3.2 vite-plugin-html åŠŸèƒ½ï¼š HTML å‹ç¼©èƒ½åŠ› EJS æ¨¡ç‰ˆèƒ½åŠ› å¤šé¡µåº”ç”¨æ”¯æŒ æ”¯æŒè‡ªå®šä¹‰entry æ”¯æŒè‡ªå®šä¹‰template å®‰è£…ï¼šyarn add vite-plugin-html -D å°†å…¶æ·»åŠ åˆ°vite.config.jsä¸­ ç”¨æ³•ï¼š å°†EJSæ ‡ç­¾æ·»åŠ åˆ°index.htmlä¸­ \u003chead\u003e \u003cmeta charset=\"UTF-8\" /\u003e \u003clink rel=\"icon\" href=\"/favicon.ico\" /\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /\u003e \u003ctitle\u003e\u003c%- title %\u003e\u003c/title\u003e \u003c%- injectScript %\u003e \u003c/head\u003e åœ¨vite.config.jsä¸­é…ç½®ï¼Œè¯¥æ–¹æ³•å¯ä»¥æ ¹æ®éœ€è¦å¼•å…¥éœ€è¦çš„åŠŸèƒ½ import { defineConfig, Plugin } from 'vite' import vue from '@vitejs/plugin-vue' import { createHtmlPlugin } from 'vite-plugin-html' export default defineConfig({ plugins: [ vue(), createHtmlPlugin({ minify: true, /** * After writing entry here, you will not need to add script tags in `index.html`, the original tags need to be deleted * @default src/main.ts */ entry: 'src/main.ts', /** * If you want to store `index.html` in the specified folder, you can modify it, otherwise no configuration is required * @default index.html */ template: 'public/index.html', /** * Data that needs to be injected into the index.html ejs template */ inject: { data: { title: 'index', injectScript: `\u003cscript src=\"./inject.js\"\u003e\u003c/script\u003e`, }, tags: [ { injectTo: 'body-prepend', tag: 'div', attrs: { id: 'tag', }, }, ], }, }), ], }) 5.3.3 vite-plugin-mock mockæ•°æ®ï¼šæ¨¡æ‹Ÿæ•°æ® å‰åç«¯ä¸€èˆ¬æ˜¯å¹¶è¡Œå¼€å‘ï¼Œç”¨æˆ·åˆ—è¡¨ï¼ˆæ¥å£æ–‡æ¡£ï¼‰ mockæ•°æ®ï¼Œå»åšä½ å‰ç«¯çš„å·¥ä½œ ç®€å•æ–¹å¼ï¼šç›´æ¥å»å†™æ­»ä¸€ä¸¤ä¸ªæ•°æ®ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚ ç¼ºé™·ï¼šæ²¡æ³•åšæµ·é‡æ•°æ®æµ‹è¯• æ²¡æ³•è·å¾—ä¸€äº›æ ‡å‡†æ•°æ® æ²¡æ³•å»æ„ŸçŸ¥httpçš„å¼‚å¸¸ mockjsï¼šæ¨¡æ‹Ÿæµ·é‡æ•°æ®çš„ï¼Œvite-plugin-mockçš„ä¾èµ–é¡¹æ˜¯mockjs å®‰è£…ï¼š yarn add mockjs -D yarn add vite-plugin-mock -D ä½¿ç”¨æ–¹æ³•ï¼šhttps://github.com/vbenjs/vite-plugin-mock 5.3.4 å…¶ä»–æ’ä»¶ æ’ä»¶åœ°å€ ","date":"2023-11-12","objectID":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/:5:3","tags":["Vite"],"title":"viteæ„å»ºå·¥å…·ä»‹ç»","uri":"/posts/01.vite%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"},{"categories":["å·¥å…·"],"content":"1 commit message è§„èŒƒ commit messageæ ¼å¼éƒ½åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šHeaderï¼ŒBodyå’ŒFooter \u003ctype\u003e(\u003cscope\u003e): \u003csubject\u003e \u003cbody\u003e \u003cfooter\u003e Headeræ˜¯å¿…éœ€çš„ï¼ŒBodyå’ŒFooteråˆ™å¯ä»¥çœç•¥ ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:1:0","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"1.1 Header Typeï¼ˆå¿…éœ€ï¼‰ typeç”¨äºè¯´æ˜git commitçš„ç±»åˆ«ï¼Œå…è®¸ä½¿ç”¨ä¸‹é¢å‡ ä¸ªæ ‡è¯†ã€‚ featï¼šæ–°åŠŸèƒ½ï¼ˆFeatureï¼‰ â€œfeat\"ç”¨äºè¡¨ç¤ºå¼•å…¥æ–°åŠŸèƒ½æˆ–ç‰¹æ€§çš„å˜åŠ¨ã€‚è¿™ç§å˜åŠ¨é€šå¸¸æ˜¯åœ¨ä»£ç åº“ä¸­æ–°å¢çš„åŠŸèƒ½ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¿®å¤é”™è¯¯æˆ–è¿›è¡Œä»£ç é‡æ„ã€‚ fix/toï¼šä¿®å¤bugã€‚è¿™äº›bugå¯èƒ½ç”±QAå›¢é˜Ÿå‘ç°ï¼Œæˆ–ç”±å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¯†åˆ«ã€‚ fixå…³é”®å­—ç”¨äºé‚£äº›ç›´æ¥è§£å†³é—®é¢˜çš„æäº¤ã€‚å½“åˆ›å»ºä¸€ä¸ªåŒ…å«å¿…è¦æ›´æ”¹çš„æäº¤ï¼Œå¹¶ä¸”è¿™äº›æ›´æ”¹èƒ½å¤Ÿç›´æ¥ä¿®å¤å·²è¯†åˆ«çš„bugæ—¶ï¼Œåº”ä½¿ç”¨fixã€‚è¿™è¡¨æ˜æäº¤çš„ä»£ç å¼•å…¥äº†è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”é—®é¢˜å·²è¢«ç«‹å³è§£å†³ã€‚ toå…³é”®å­—åˆ™ç”¨äºé‚£äº›éƒ¨åˆ†å¤„ç†é—®é¢˜çš„æäº¤ã€‚åœ¨ä¸€äº›å¤æ‚çš„ä¿®å¤è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½éœ€è¦å¤šä¸ªæ­¥éª¤æˆ–å¤šæ¬¡æäº¤æ¥å®Œå…¨è§£å†³é—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆå§‹å’Œä¸­é—´çš„æäº¤åº”ä½¿ç”¨toæ ‡è®°ï¼Œè¡¨ç¤ºå®ƒä»¬ä¸ºæœ€ç»ˆè§£å†³æ–¹æ¡ˆåšå‡ºäº†è´¡çŒ®ï¼Œä½†å¹¶æœªå®Œå…¨è§£å†³é—®é¢˜ã€‚æœ€ç»ˆè§£å†³é—®é¢˜çš„æäº¤åº”ä½¿ç”¨fixæ ‡è®°ï¼Œä»¥è¡¨æ˜é—®é¢˜å·²è¢«å½»åº•ä¿®å¤ã€‚ docsï¼šæ–‡æ¡£ï¼ˆDocumentationï¼‰ â€œdocsâ€ è¡¨ç¤ºå¯¹æ–‡æ¡£çš„å˜åŠ¨ï¼Œè¿™åŒ…æ‹¬å¯¹ä»£ç åº“ä¸­çš„æ³¨é‡Šã€README æ–‡ä»¶æˆ–å…¶ä»–æ–‡æ¡£çš„ä¿®æ”¹ã€‚è¿™ä¸ªå‰ç¼€çš„æäº¤é€šå¸¸ç”¨äºæ›´æ–°æ–‡æ¡£ä»¥åæ˜ ä»£ç çš„å˜æ›´ï¼Œæˆ–è€…æä¾›æ›´å¥½çš„ä»£ç ç†è§£å’Œä½¿ç”¨è¯´æ˜ã€‚ style: æ ¼å¼ï¼ˆFormatï¼‰ â€œstyleâ€ ç”¨äºè¡¨ç¤ºå¯¹ä»£ç æ ¼å¼çš„å˜åŠ¨ï¼Œè¿™äº›å˜åŠ¨ä¸å½±å“ä»£ç çš„è¿è¡Œã€‚é€šå¸¸åŒ…æ‹¬ç©ºæ ¼ã€ç¼©è¿›ã€æ¢è¡Œç­‰é£æ ¼è°ƒæ•´ã€‚ refactorï¼šé‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰ â€œrefactorâ€ è¡¨ç¤ºå¯¹ä»£ç çš„é‡æ„ï¼Œå³ä¿®æ”¹ä»£ç çš„ç»“æ„å’Œå®ç°æ–¹å¼ï¼Œä½†ä¸å½±å“å…¶å¤–éƒ¨è¡Œä¸ºã€‚é‡æ„çš„ç›®çš„æ˜¯æ”¹è¿›ä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§å’Œæ€§èƒ½ï¼Œè€Œä¸æ˜¯å¼•å…¥æ–°åŠŸèƒ½æˆ–ä¿®å¤é”™è¯¯ã€‚ perf: ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ â€œperfâ€ è¡¨ç¤ºä¸æ€§èƒ½ä¼˜åŒ–ç›¸å…³çš„å˜åŠ¨ã€‚è¿™å¯èƒ½åŒ…æ‹¬å¯¹ç®—æ³•ã€æ•°æ®ç»“æ„æˆ–ä»£ç å®ç°çš„ä¿®æ”¹ï¼Œä»¥æé«˜ä»£ç çš„æ‰§è¡Œæ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚ testï¼šå¢åŠ æµ‹è¯• â€œtestâ€ è¡¨ç¤ºå¢åŠ æµ‹è¯•ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•æˆ–å…¶ä»–ç±»å‹çš„æµ‹è¯•ã€‚ choreï¼šæ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨ â€œchoreâ€ è¡¨ç¤ºå¯¹æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨ã€‚è¿™å¯èƒ½åŒ…æ‹¬æ›´æ–°æ„å»ºè„šæœ¬ã€é…ç½®æ–‡ä»¶æˆ–å…¶ä»–ä¸æ„å»ºå’Œå·¥å…·ç›¸å…³çš„å†…å®¹ã€‚ revertï¼šå›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ â€œrevertâ€ ç”¨äºå›æ»šåˆ°ä»¥å‰çš„ç‰ˆæœ¬ï¼Œæ’¤é”€ä¹‹å‰çš„æäº¤ã€‚ mergeï¼šä»£ç åˆå¹¶ â€œmergeâ€ è¡¨ç¤ºè¿›è¡Œä»£ç åˆå¹¶ï¼Œé€šå¸¸æ˜¯åœ¨åˆ†æ”¯å¼€å‘å®Œæˆåå°†ä»£ç åˆå¹¶å›ä¸»çº¿ã€‚ syncï¼šåŒæ­¥ä¸»çº¿æˆ–åˆ†æ”¯çš„Bug â€œsyncâ€ è¡¨ç¤ºåŒæ­¥ä¸»çº¿æˆ–åˆ†æ”¯çš„ Bugï¼Œé€šå¸¸ç”¨äºè§£å†³å› ä¸ºåˆå¹¶è€Œå¼•å…¥çš„é—®é¢˜ã€‚ Scopeï¼ˆå¯é€‰ï¼‰ scopeç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®ä¸åŒè€Œä¸åŒã€‚ ä¾‹å¦‚ä¿®æ”¹äº†Daoæˆ–è€…Controllerï¼Œåˆ™å¯ä»¥æ·»åŠ è¡¨ç¤ºè¿™äº›èŒƒå›´å—åˆ°å½±å“ï¼Œè¿™æœ‰åŠ©äºæ›´æ¸…æ™°åœ°ç†è§£æäº¤çš„å˜æ›´å½±å“èŒƒå›´ã€‚ä¾‹å¦‚ï¼š feat(Controller): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½ è¿™ä¸ªæäº¤æ¶ˆæ¯ä¸­ï¼ŒController æ˜¯ scopeï¼Œè¡¨ç¤ºè¿™æ¬¡æäº¤å½±å“äº†æ§åˆ¶å±‚ã€‚ fix(DataAccess): ä¿®å¤æ•°æ®æŸ¥è¯¢é€»è¾‘ è¿™ä¸ªæäº¤æ¶ˆæ¯ä¸­ï¼ŒDataAccess æ˜¯ scopeï¼Œè¡¨ç¤ºè¿™æ¬¡æäº¤å½±å“äº†æ•°æ®è®¿é—®å±‚ã€‚ å¦‚æœä½ çš„ä¿®æ”¹å½±å“äº†ä¸æ­¢ä¸€ä¸ªscopeï¼Œä½ å¯ä»¥ä½¿ç”¨*ä»£æ›¿ã€‚ Subjectï¼ˆå¿…éœ€ï¼‰ subjectæ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50ä¸ªå­—ç¬¦ã€‚è§„èŒƒå¦‚ä¸‹ï¼š ä»¥åŠ¨è¯å¼€å¤´ï¼Œä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚changeï¼Œè€Œä¸æ˜¯changedæˆ–changes ç¬¬ä¸€ä¸ªå­—æ¯å°å†™ ç»“å°¾ä¸åŠ å¥å·ï¼ˆ.ï¼‰ ä¾‹å¦‚ï¼š feat(UserAuth): implement user authentication è¿™ä¸ªæäº¤æ¶ˆæ¯ä¸­ï¼Œimplement user authentication æ˜¯ subjectï¼Œç®€æ´æ˜äº†åœ°æè¿°äº†å¼•å…¥ç”¨æˆ·è®¤è¯åŠŸèƒ½çš„ç›®çš„ã€‚ fix(Validation): correct input validation logic è¿™ä¸ªæäº¤æ¶ˆæ¯ä¸­ï¼Œcorrect input validation logic æ˜¯ subjectï¼Œæ¸…æ™°åœ°è¯´æ˜äº†ä¿®å¤è¾“å…¥éªŒè¯é€»è¾‘çš„ç›®çš„ã€‚ ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:1:1","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"1.2 Body Body éƒ¨åˆ†æ˜¯å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œã€‚Bodyç¼–å†™æœ‰ä¸¤ä¸ªæ³¨æ„ç‚¹ã€‚ ä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚ä½¿ç”¨changeè€Œä¸æ˜¯changedæˆ–changesã€‚è¿™æœ‰åŠ©äºä½¿æè¿°æ›´åŠ ç›´è§‚å’Œè¿è´¯ï¼Œå¢å¼ºå¯è¯»æ€§ã€‚ åº”è¯¥è¯´æ˜ä»£ç å˜åŠ¨çš„åŠ¨æœºï¼Œä»¥åŠä¸ä»¥å‰è¡Œä¸ºçš„å¯¹æ¯”ã€‚ Body éƒ¨åˆ†ä¸ä»…ä»…æ˜¯æè¿°ä»£ç çš„å˜åŠ¨ï¼Œè¿˜åº”è¯¥è§£é‡Šä¸ºä»€ä¹ˆè¿›è¡Œè¿™ä¸ªå˜åŠ¨ï¼Œä»¥åŠä¸ä¹‹å‰çš„ä»£ç è¡Œä¸ºç›¸æ¯”æœ‰å“ªäº›æ”¹è¿›ã€‚è¿™æœ‰åŠ©äºå…¶ä»–å¼€å‘è€…æ›´å¥½åœ°ç†è§£ä»£ç å˜æ›´çš„èƒŒååŠ¨æœºå’Œæ„å›¾ã€‚ ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:1:2","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"1.3 Footer Footer éƒ¨åˆ†åªç”¨äºä¸¤ç§æƒ…å†µã€‚ ä¸å…¼å®¹å˜åŠ¨ å¦‚æœå½“å‰ä»£ç ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸å…¼å®¹ï¼Œåˆ™ Footer éƒ¨åˆ†ä»¥BREAKING CHANGEå¼€å¤´ï¼Œåé¢æ˜¯å¯¹å˜åŠ¨çš„æè¿°ã€ä»¥åŠå˜åŠ¨ç†ç”±å’Œè¿ç§»æ–¹æ³•ã€‚ å…³é—­ Issue å¦‚æœå½“å‰ commit é’ˆå¯¹æŸä¸ªissueï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Footer éƒ¨åˆ†å…³é—­è¿™ä¸ª issue ã€‚ Closes #234 ä¹Ÿå¯ä»¥ä¸€æ¬¡å…³é—­å¤šä¸ª issue ã€‚ Closes #123, #245, #992 ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:1:3","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"1.4 ç¤ºä¾‹ æ·»åŠ ç”¨æˆ·é…ç½®æ–‡ä»¶ç¼–è¾‘åŠŸèƒ½ feat(UserProfile): add user profile editing feature This commit introduces a new feature that allows users to edit their profiles directly from the user interface. The motivation behind this change is to enhance user interaction and provide a more seamless experience. Previously, users had to navigate to a separate editing page to update their profile information. With this new feature, users can now make changes efficiently from their profile page, eliminating unnecessary steps in the workflow. Changes included in this commit: - Added a new 'Edit Profile' button on the user profile page. - Implemented frontend components for profile editing. - Updated backend API to handle profile updates securely. By streamlining the profile editing process, we aim to improve overall user satisfaction and make our application more user-friendly. This enhancement is in response to user feedback, addressing the need for a more intuitive and accessible way to modify profile details. Closes #234 çº æ­£è¾“å…¥éªŒè¯é€»è¾‘ fix(Validation): correct input validation logic This commit addresses an issue related to input validation logic in the application. Previously, the validation process was not handling certain edge cases correctly, leading to unexpected behavior in specific scenarios. To resolve this issue, the validation logic has been revised to properly handle various input scenarios. This ensures that user input is thoroughly validated, reducing the likelihood of errors in the application. The changes made in this commit include: - Correcting boundary checks for user input. - Improving error messages for better user guidance. These adjustments align with our commitment to delivering a robust and reliable application experience. Closes #123 ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ refactor(DataAccess): optimize database queries In this commit, we have refactored the data access layer to optimize database queries and improve overall system performance. The existing query structure was identified as a bottleneck during performance testing, leading to longer response times. Changes made in this commit: - Reorganized database queries to reduce redundant operations. - Utilized database indexing for faster data retrieval. By optimizing database queries, we expect to see a significant improvement in system responsiveness and user experience. Closes #456 ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:1:4","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"2 git commit å·¥å…· ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:2:0","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"2.1 commitizen Commitizenæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºæ’°å†™åˆæ ¼çš„ Git æäº¤æ¶ˆæ¯ã€‚ä½¿ç”¨ Commitizen å¯ä»¥å¸®åŠ©å›¢é˜Ÿéµå¾ªç»Ÿä¸€çš„æäº¤æ¶ˆæ¯è§„èŒƒï¼Œä½¿æäº¤å†å²æ›´åŠ æ¸…æ™°å’Œæ˜“è¯»ã€‚ é¦–å…ˆï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å…¨å±€å®‰è£… Commitizenï¼š npm install -g commitizen ç„¶åï¼Œåœ¨é¡¹ç›®ç›®å½•é‡Œï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä½¿å…¶æ”¯æŒ Angular çš„ Commit message æ ¼å¼ã€‚ commitizen init cz-conventional-changelog --save --save-exact è¿™ä¸ªå‘½ä»¤ä¼šé…ç½®é¡¹ç›®ï¼Œä½¿å…¶æ”¯æŒ Angular è§„èŒƒçš„ Commit Messageã€‚åœ¨æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©å…¶ä»–é¢„å®šä¹‰çš„è§„èŒƒæˆ–è€…åˆ›å»ºè‡ªå®šä¹‰è§„èŒƒã€‚ ä¹‹åï¼Œå½“ä½ æ‰§è¡Œ git commit å‘½ä»¤æ—¶ï¼Œå°†å…¶æ›¿æ¢ä¸º git czã€‚æ­¤æ—¶ï¼ŒCommitizen å°†å¼•å¯¼ä½ é€šè¿‡ä¸€ä¸ªäº¤äº’å¼çš„ç•Œé¢ï¼Œä»¥ç”Ÿæˆç¬¦åˆè§„èŒƒçš„ Commit Messageã€‚ åœ¨è¿™ä¸ªäº¤äº’å¼ç•Œé¢ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©æäº¤çš„ç±»å‹ï¼ˆfeatã€fixã€docs ç­‰ï¼‰ã€å½±å“çš„èŒƒå›´ï¼ˆscopeï¼‰ã€ç®€çŸ­çš„æè¿°ï¼ˆsubjectï¼‰ä»¥åŠå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ç¡®ä¿æäº¤æ¶ˆæ¯ç¬¦åˆè§„èŒƒï¼Œå¹¶æä¾›äº†æ›´å¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾¿äºä»–äººç†è§£å˜æ›´çš„ç›®çš„ã€‚ ä½¿ç”¨ Commitizen å’Œè§„èŒƒåŒ–çš„æäº¤æ¶ˆæ¯æ ¼å¼ï¼Œæœ‰åŠ©äºæé«˜ä»£ç åº“çš„å¯è¯»æ€§ï¼Œæ–¹ä¾¿ç”Ÿæˆè‡ªåŠ¨åŒ–çš„å˜æ›´æ—¥å¿—ï¼Œå¹¶ä¿ƒä½¿å¼€å‘è€…æ›´æ³¨é‡å†™å‡ºæ¸…æ™°ã€æ˜ç¡®çš„æäº¤æ¶ˆæ¯ã€‚ ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:2:1","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"2.2 commitlint commitlintæ˜¯ä¸€ä¸ªç”¨äºæ£€æŸ¥æäº¤æ¶ˆæ¯æ˜¯å¦ç¬¦åˆæŒ‡å®šè§„èŒƒçš„å·¥å…·ã€‚å®ƒå¯ä»¥å¸®åŠ©å›¢é˜Ÿç¡®ä¿ Git æäº¤æ¶ˆæ¯çš„ä¸€è‡´æ€§å’Œè§„èŒƒæ€§ï¼Œå°¤å…¶æ˜¯å½“é¡¹ç›®é‡‡ç”¨ç±»ä¼¼ Angular Commit Message Conventions çš„è§„èŒƒæ—¶ã€‚ å®‰è£… Commitlint é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£… commitlint åŠå…¶ç›¸å…³çš„é…ç½®å’Œè§„åˆ™ã€‚é€šå¸¸ï¼Œ@commitlint/config-conventional æ˜¯ä¸ Angular è§„èŒƒå…¼å®¹çš„é…ç½®ã€‚ npm install --save-dev @commitlint/config-conventional @commitlint/cli é…ç½® Commitlint åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º commitlint.config.js æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š module.exports = { extends: ['@commitlint/config-conventional'], }; è¿™ä¸ªé…ç½®æ–‡ä»¶ä½¿ç”¨äº† @commitlint/config-conventional ä¸­é¢„å®šä¹‰çš„è§„åˆ™ï¼Œç¡®ä¿ç¬¦åˆå¸¸è§çš„æäº¤è§„èŒƒã€‚ é…ç½®Gité’©å­ ä½ å¯ä»¥ä½¿ç”¨ Husky é’©å­å·¥å…·æ¥åœ¨æäº¤å‰è¿è¡Œ commitlintã€‚é¦–å…ˆï¼Œå®‰è£… Huskyï¼š bashCopy code npm install --save-dev husky ç„¶åï¼Œåœ¨ package.json ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š jsonCopy code \"husky\": { \"hooks\": { \"commit-msg\": \"commitlint -E HUSKY_GIT_PARAMS\" } } è¿™æ ·é…ç½®åï¼Œæ¯æ¬¡æäº¤å‰éƒ½ä¼šè‡ªåŠ¨è¿è¡Œ commitlint æ£€æŸ¥æäº¤æ¶ˆæ¯æ˜¯å¦ç¬¦åˆè§„èŒƒã€‚ ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:2:2","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"3 ç”ŸæˆChange log å¦‚æœä½ çš„æ‰€æœ‰ Commit éƒ½ç¬¦åˆ Angular æ ¼å¼ï¼Œé‚£ä¹ˆå‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œ Change log å°±å¯ä»¥ç”¨è„šæœ¬è‡ªåŠ¨ç”Ÿæˆï¼ˆä¾‹1ï¼Œä¾‹2ï¼‰ã€‚ ![image-20231112222340929](/Users/zfhe/Library/Application Support/typora-user-images/image-20231112222340929.png) ç”Ÿæˆçš„æ–‡æ¡£åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚ New featuresï¼ˆæ–°ç‰¹æ€§ï¼‰ Bug fixesï¼ˆbugä¿®å¤ï¼‰ Breaking changesï¼ˆé‡å¤§å˜æ›´ï¼‰ æ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šç½—åˆ—ç›¸å…³çš„ commit ï¼Œå¹¶ä¸”æœ‰æŒ‡å‘è¿™äº› commit çš„é“¾æ¥ã€‚å½“ç„¶ï¼Œç”Ÿæˆçš„æ–‡æ¡£å…è®¸æ‰‹åŠ¨ä¿®æ”¹ï¼Œæ‰€ä»¥å‘å¸ƒå‰ï¼Œä½ è¿˜å¯ä»¥æ·»åŠ å…¶ä»–å†…å®¹ã€‚ conventional-changelog å°±æ˜¯ç”Ÿæˆ Change log çš„å·¥å…·ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ã€‚ npm install -g conventional-changelog cd my-project conventional-changelog -p angular -i CHANGELOG.md -w ä¸Šé¢å‘½ä»¤ä¸ä¼šè¦†ç›–ä»¥å‰çš„ Change logï¼Œåªä¼šåœ¨CHANGELOG.mdçš„å¤´éƒ¨åŠ ä¸Šè‡ªä»ä¸Šæ¬¡å‘å¸ƒä»¥æ¥çš„å˜åŠ¨ã€‚ å¦‚æœä½ æƒ³ç”Ÿæˆæ‰€æœ‰å‘å¸ƒçš„ Change logï¼Œè¦æ”¹ä¸ºè¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚ $ conventional-changelog -p angular -i CHANGELOG.md -w -r 0 ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå¯ä»¥å°†å…¶å†™å…¥package.jsonçš„scriptså­—æ®µã€‚ { \"scripts\": { \"changelog\": \"conventional-changelog -p angular -i CHANGELOG.md -w -r 0\" } } ä»¥åï¼Œç›´æ¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ã€‚ $ npm run changelog è¿™ä¸ªè‡ªåŠ¨åŒ–æµç¨‹ä¸ä»…ç®€åŒ–äº† Change log çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œè¿˜ç¡®ä¿äº†è®°å½•é¡¹ç›®å˜æ›´çš„ä¸€è‡´æ€§å’Œå‡†ç¡®æ€§ã€‚ç”Ÿæˆçš„æ–‡æ¡£ä¼šæŒ‰ç…§æ–°ç‰¹æ€§ã€bug ä¿®å¤å’Œé‡å¤§å˜æ›´ç­‰åˆ†ç±»ï¼Œæ–¹ä¾¿ç”¨æˆ·å¿«é€Ÿäº†è§£æ¯ä¸ªç‰ˆæœ¬çš„å˜æ›´æƒ…å†µã€‚ ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:3:0","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["å·¥å…·"],"content":"4 å‚è€ƒèµ„æ–™ å¦‚ä½•è§„èŒƒä½ çš„Git commitï¼Ÿâ€”é˜¿é‡Œäº‘å¼€å‘è€… Commit message å’Œ Change log ç¼–å†™æŒ‡å—â€”é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— ","date":"2023-11-12","objectID":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/:4:0","tags":["Git"],"title":"Git Commit ä¹‹é“ï¼šè§„èŒƒåŒ– Commit Message å†™ä½œæŒ‡å—","uri":"/posts/01.git-commit-%E4%B9%8B%E9%81%93%E8%A7%84%E8%8C%83%E5%8C%96-commit-message-%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97/"},{"categories":["æŠ€å·§"],"content":"1 ä¸‹è½½ç½‘é¡µä¸­çš„å†…åµŒ PDF åœ¨ä¸€äº›ç½‘é¡µä¸­ï¼ŒPDFæ–‡ä»¶æ˜¯ä»¥å†…åµŒå½¢å¼å‘ˆç°çš„ï¼Œç›´æ¥ä¸‹è½½é“¾æ¥å¯èƒ½éšè—åœ¨ç½‘ç»œè¯·æ±‚ä¸­ã€‚ä»¥ä¸‹æ˜¯æ‰¾åˆ°å¹¶ä¸‹è½½è¿™äº›å†…åµŒPDFæ–‡ä»¶çš„æ–¹æ³•ï¼š æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆFn+F12ï¼‰ é€‰ä¸­Networkæ ç›®åå†é€‰æ‹©XHRï¼Œè¿™ä¼šç­›é€‰å‡ºæ‰€æœ‰XMLHttpRequestï¼Œé€šå¸¸å†…åµŒPDFçš„è¯·æ±‚ä¼šå‡ºç°åœ¨è¿™é‡Œã€‚ Ctrl+Rï¼ˆåˆ·æ–°ï¼‰é‡æ–°åŠ è½½æ‰€æœ‰ç½‘ç»œè¯·æ±‚ åœ¨ Network é¢æ¿ä¸­ï¼Œæ‰¾åˆ°PDFæ–‡ä»¶çš„è¯·æ±‚ã€‚é€šå¸¸ï¼Œè¿™äº›è¯·æ±‚ä¼šæœ‰ä¸€ä¸ªæ–‡ä»¶åä»¥ .pdf ç»“å°¾ã€‚ å³é”®ç‚¹å‡»è¯¥è¯·æ±‚ï¼Œç„¶åé€‰æ‹© Open in new tabã€‚è¿™æ ·ä¼šåœ¨æ–°çš„æ ‡ç­¾é¡µä¸­æ‰“å¼€PDFæ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ç›´æ¥è·å–ä¸‹è½½é“¾æ¥å¹¶ä¿å­˜æ–‡ä»¶ã€‚ ","date":"2023-07-08","objectID":"/posts/01.%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%9E%E7%94%A8%E5%B0%8F%E6%8A%80%E5%B7%A7/:1:0","tags":["browser"],"title":"æµè§ˆå™¨å®ç”¨å°æŠ€å·§","uri":"/posts/01.%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%9E%E7%94%A8%E5%B0%8F%E6%8A%80%E5%B7%A7/"},{"categories":["æŠ€å·§"],"content":"2 è§£å†³ç½‘ç«™å¤åˆ¶é—®é¢˜ ä¸èƒ½å¤åˆ¶çš„æ ¹æœ¬åŸå› æ˜¯ç½‘ç«™ä½¿ç”¨äº†JavaScriptä»£ç æ¥é˜»æ­¢ç”¨æˆ·é€‰æ‹©å’Œå¤åˆ¶å†…å®¹ã€‚æˆ‘ä»¬åªéœ€è¦ç¦ç”¨JavaScriptå°±å¯ä»¥ã€‚ æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆFn+F12ï¼‰ Settings-\u003ePreferences åˆ’åˆ°æœ€åæœ‰ä¸ªDisable JavaScripté€‰é¡¹ ","date":"2023-07-08","objectID":"/posts/01.%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%9E%E7%94%A8%E5%B0%8F%E6%8A%80%E5%B7%A7/:2:0","tags":["browser"],"title":"æµè§ˆå™¨å®ç”¨å°æŠ€å·§","uri":"/posts/01.%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%9E%E7%94%A8%E5%B0%8F%E6%8A%80%E5%B7%A7/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 ç”¨æˆ·å’Œç”¨æˆ·ç»„ä»‹ç» ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:1:0","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.1 ç”¨æˆ· ä»»ä½•æ“ä½œç³»ç»Ÿéƒ½å­˜åœ¨â€œç”¨æˆ·â€çš„æ¦‚å¿µï¼ŒLinuxä¹Ÿä¸ä¾‹å¤–ã€‚Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·å¤šä»»åŠ¡çš„åˆ†æ—¶æ“ä½œç³»ç»Ÿï¼Œå³Linuxç³»ç»Ÿæ”¯æŒå¤šä¸ªç”¨æˆ·åœ¨åŒä¸€æ—¶é—´å†…ç™»å½•ï¼Œä¸åŒç”¨æˆ·å¯ä»¥æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œå¹¶ä¸”äº’ä¸å½±å“ã€‚æ¯ä¸ªç”¨æˆ·è´¦å·éƒ½æ‹¥æœ‰ä¸€ä¸ªç”¨æˆ·åå’Œå„è‡ªçš„å£ä»¤ï¼ˆå³å¯†ç ï¼‰ã€‚åœ¨ç™»å½•ç³»ç»Ÿæ—¶ï¼Œåªæœ‰æ­£ç¡®è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰èƒ½è¿›å…¥ç³»ç»Ÿå’Œè‡ªå·±çš„ä¸»ç›®å½•ã€‚ åœ¨Linuxä¸­ï¼Œç”¨æˆ·åˆ†ä¸ºä¸¤å¤§ç±»ã€ä¸‰å°ç±»ï¼šåˆ†åˆ«ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼ˆä¸€èˆ¬ä¸ºrootï¼‰å’Œæ™®é€šç”¨æˆ· ã€‚æ™®é€šç”¨æˆ·ä¸­ï¼Œåˆåˆ’åˆ†ä¸ºä¸¤ç±»ï¼Œåˆ†åˆ«ä¸ºç³»ç»Ÿç”¨æˆ·å’Œç™»å½•ç”¨æˆ·ã€‚ ç³»ç»Ÿç®¡ç†å‘˜ï¼šå³è¶…çº§ç®¡ç†å‘˜ï¼Œå¯ä»¥æ“ä½œç³»ç»Ÿä¸­ä»»æ„æ–‡ä»¶å’Œå‘½ä»¤ï¼Œæ‹¥æœ‰æœ€é«˜çš„ç®¡ç†æƒé™ã€‚ æ™®é€šç”¨æˆ· ç™»å½•ç”¨æˆ·ï¼šä¸ºç®¡ç†å‘˜æ‰‹åŠ¨æ·»åŠ çš„ç”¨æˆ·ï¼Œé»˜è®¤ä»…æ‹¥æœ‰æ“ä½œè‡ªèº«å®¶ç›®å½•ä¸­æ–‡ä»¶åŠç›®å½•çš„æƒé™ï¼Œä»¥åŠè¿›å…¥ä¸æµè§ˆç›¸å…³ç›®å½•æ–‡ä»¶çš„æƒé™ï¼ˆå¦‚/etcã€/var/logç­‰ï¼‰ï¼Œä½†æ²¡æœ‰åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ç­‰æƒé™ã€‚ ç³»ç»Ÿç”¨æˆ·ï¼šä¸€èˆ¬ä¸ºç³»ç»Ÿå®‰è£…åé»˜è®¤å­˜åœ¨çš„ï¼Œä¸”é»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ç™»å½•ç³»ç»Ÿï¼Œå®ƒä»¬çš„å­˜åœ¨ä¸»è¦æ˜¯ä¸ºäº†æ»¡è¶³ç³»ç»Ÿè¿›ç¨‹å¯¹æ–‡ä»¶å±ä¸»çš„éœ€æ±‚ã€‚ Tipsï¼šåœ¨éƒ¨ç½²æŸäº›æœåŠ¡æ˜¯ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æ·»åŠ æŸäº›ç³»ç»Ÿç”¨æˆ·ã€‚ Linuxç³»ç»Ÿä½¿ç”¨UIDï¼ˆUser IDï¼‰æ¥æ ‡è¯†ä¸åŒç”¨æˆ·ï¼Œè¯´ç™½äº†ï¼Œå…¶å®Linuxå¹¶ä¸è®¤è¯†ä½ çš„ç”¨æˆ·åç§°ï¼Œå®ƒåªè®¤è¯†ç”¨æˆ·åå¯¹åº”çš„UIDã€‚å…¶ä¸­UIDæ˜¯16bitçš„äºŒè¿›åˆ¶æ•°å­—ï¼Œæ‰€ä»¥æ¢ç®—æˆåè¿›åˆ¶ï¼ŒUIDçš„èŒƒå›´æ˜¯0~65535ï¼ŒLinuxæ ¹æ®ç”¨æˆ·ç±»åˆ«ï¼Œå¯¹UIDåˆ’åˆ†åšäº†è§„å®šï¼š 0ï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰ï¼šï¼Œå½“UIDæ˜¯0æ—¶ï¼Œä»£è¡¨è¿™ä¸ªç”¨æˆ·ä¸ºè¶…çº§ç®¡ç†å‘˜ï¼Œæ‰€ä»¥å½“ä½ æƒ³è¦å…¶ä»–çš„ç”¨æˆ·ä¹Ÿæœ‰rootæƒé™æ—¶ï¼Œå°†è¯¥ç”¨æˆ·çš„UIDæ”¹ä¸º0å³å¯ã€‚ä½†ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·çš„UIDåº”å½“æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå…¶ä»–ç”¨æˆ·ä¸åº”å½“æœ‰ç›¸åŒçš„UIDæ•°å€¼ï¼Œåªæœ‰UIDç­‰äº0æ—¶å¯ä»¥ä¾‹å¤–ã€‚ 1499ï¼ˆç³»ç»Ÿè´¦å·ï¼‰ï¼šè¯¥èŒƒå›´å†…çš„UIDæ˜¯ä¿ç•™ç»™ç³»ç»Ÿä½¿ç”¨çš„ IDï¼Œå…¶å® 165534 ä¹‹é—´çš„è´¦å·å¹¶æ²¡æœ‰ä¸åŒï¼Œ ä¹Ÿå°±æ˜¯é™¤äº† 0 ä¹‹å¤–ï¼Œå…¶å®ƒçš„ UID å¹¶æ²¡æœ‰ä¸ä¸€æ ·ï¼Œé¢„è®¾ 500 ä»¥ä¸‹ç»™ç³»ç»Ÿä½œä¸ºä¿ç•™è´¦å·åªæ˜¯ä¸€ä¸ªä¹ æƒ¯ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä»¥æœ‰åçš„ DNS æœåŠ¡å™¨çš„å¯åŠ¨æœåŠ¡ã€ named ã€ä¸ºä¾‹ï¼Œè¿™ä¸ªç¨‹åºçš„é¢„è®¾æ‰€æœ‰äºº named çš„è´¦å· UID æ˜¯ 25 ï¼Œå½“ä½ è‡ªå®šä¹‰çš„è´¦å·ä¹Ÿæ˜¯ 25 æ—¶ï¼Œä¼šé€ æˆç³»ç»Ÿå†²çªï¼ä¸ºäº†æœç»è¿™æ ·çš„é—®é¢˜ï¼Œå…»æˆå¥½ä¹ æƒ¯ï¼Œä¿ç•™ 500 ä»¥å‰çš„ UID ç»™ç³»ç»Ÿä½¿ç”¨ï¼ ä¸€èˆ¬æ¥è¯´ï¼Œ 1åˆ°99 ä¼šä¿ç•™ç»™ç³»ç»Ÿé¢„è®¾çš„è´¦å·ï¼Œå¦å¤– 100~499 åˆ™ä¿ç•™ç»™ä¸€äº›æœåŠ¡æ¥ä½¿ç”¨ã€‚ 500~65535ï¼ˆç™»å½•ç”¨æˆ·ï¼‰ï¼šç»™ä¸€èˆ¬ä½¿ç”¨è€…ç”¨çš„ã€‚äº‹å®ä¸Šï¼Œç›®å‰çš„ linux æ ¸å¿ƒ (2.6.x ç‰ˆ)å·²ç»å¯ä»¥æ”¯æŒåˆ° 4294967295 (2^32-1) è¿™ä¹ˆå¤§çš„ UID å·ç ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:1:1","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.2 ç”¨æˆ·ç»„ ç”¨æˆ·ç»„æ˜¯å…·æœ‰ç›¸åŒç‰¹å¾ç”¨æˆ·çš„é€»è¾‘é›†åˆã€‚ç®€å•çš„ç†è§£ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦è®©å¤šä¸ªç”¨æˆ·å…·æœ‰ç›¸åŒçš„æƒé™ï¼Œæ¯”å¦‚æŸ¥çœ‹ã€ä¿®æ”¹æŸä¸€ä¸ªæ–‡ä»¶çš„æƒé™ï¼Œä¸€ç§æ–¹æ³•æ˜¯åˆ†åˆ«å¯¹å¤šä¸ªç”¨æˆ·è¿›è¡Œæ–‡ä»¶è®¿é—®æˆæƒï¼Œå¦‚æœæœ‰ 10 ä¸ªç”¨æˆ·çš„è¯ï¼Œå°±éœ€è¦æˆæƒ 10 æ¬¡ï¼Œé‚£å¦‚æœæœ‰ 100ã€1000 ç”šè‡³æ›´å¤šçš„ç”¨æˆ·å‘¢ï¼Ÿ æ˜¾ç„¶ï¼Œè¿™ç§æ–¹æ³•ä¸å¤ªåˆç†ã€‚æœ€å¥½çš„æ–¹å¼æ˜¯å»ºç«‹ä¸€ä¸ªç»„ï¼Œè®©è¿™ä¸ªç»„å…·æœ‰æŸ¥çœ‹ã€ä¿®æ”¹æ­¤æ–‡ä»¶çš„æƒé™ï¼Œç„¶åå°†æ‰€æœ‰éœ€è¦è®¿é—®æ­¤æ–‡ä»¶çš„ç”¨æˆ·æ”¾å…¥è¿™ä¸ªç»„ä¸­ã€‚é‚£ä¹ˆï¼Œæ‰€æœ‰ç”¨æˆ·å°±å…·æœ‰äº†å’Œç»„ä¸€æ ·çš„æƒé™ï¼Œè¿™å°±æ˜¯ç”¨æˆ·ç»„ã€‚å°†ç”¨æˆ·åˆ†ç»„æ˜¯ Linux ç³»ç»Ÿä¸­å¯¹ç”¨æˆ·è¿›è¡Œç®¡ç†åŠæ§åˆ¶è®¿é—®æƒé™çš„ä¸€ç§æ‰‹æ®µï¼Œé€šè¿‡å®šä¹‰ç”¨æˆ·ç»„ï¼Œå¾ˆå¤šç¨‹åºä¸Šç®€åŒ–äº†å¯¹ç”¨æˆ·çš„ç®¡ç†å·¥ä½œã€‚ Linuxå¯¹ç”¨æˆ·ç»„ä¹Ÿæœ‰ä¸‰ç§åˆ’åˆ†æ–¹å¼ï¼š ç¬¬ä¸€ç§ç»„ç±»åˆ« ç®¡ç†å‘˜ç»„ æ™®é€šç”¨æˆ·ç»„ï¼ˆåŒ…æ‹¬ç³»ç»Ÿç”¨æˆ·ç»„å’Œç™»å½•ç”¨æˆ·ç»„ï¼‰ ç¬¬äºŒç§ç»„ç±»åˆ« ç”¨æˆ·çš„åŸºæœ¬ç»„ï¼ˆä¸»ç»„ï¼‰ï¼šç”¨æˆ·å¿…é¡»æœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªåŸºæœ¬ç»„ã€‚ ç”¨æˆ·çš„é™„åŠ ç»„ ï¼ˆé™„å±ç»„ï¼‰ï¼šç”¨æˆ·å¯ä»¥æœ‰0ä¸ªã€1ä¸ªæˆ–å¤šä¸ªé™„åŠ ç»„ã€‚ åŸºæœ¬ç»„å’Œé™„åŠ ç»„å°±æ¯”å¦‚ï¼Œæ¯ä¸ªäººæœ‰ä¸€ä¸ªç”¨æ¥å®‰å®¶çš„æˆ¿å­ï¼ˆåŸºæœ¬ç»„ï¼‰ï¼Œè¿˜å¯ä»¥æœ‰Nä¸ªç”¨äºæŠ•èµ„çš„æˆ¿å­ï¼ˆé™„å±ç»„ï¼‰ã€‚ ç¬¬ä¸‰ç§ç»„ç±»åˆ« ç§æœ‰ç»„ï¼šæ¯æ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œå¦‚æœä¸æŒ‡å®š-gå‚æ•°ï¼Œéƒ½ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå’Œç”¨æˆ·ååŒåçš„ç»„ï¼Œä¸”ç»„å†…åªåŒ…å«ç”¨æˆ·æœ¬èº«ã€‚ å…¬å…±ç»„ï¼šç»„å†…å¯åŒ…å«å¤šä¸ªç”¨æˆ·ã€‚ Linuxç³»ç»Ÿä¹Ÿæ˜¯ä½¿ç”¨GIDï¼ˆGroup IDï¼‰æ¥æ ‡è¯†ä¸åŒç»„ã€‚ç”¨æˆ·å’Œç”¨æˆ·ç»„çš„å¯¹åº”å…³ç³»æœ‰ä»¥ä¸‹ 4 ç§ï¼š ä¸€å¯¹ä¸€ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥å­˜åœ¨ä¸€ä¸ªç»„ä¸­ï¼Œæ˜¯ç»„ä¸­çš„å”¯ä¸€æˆå‘˜ï¼› ä¸€å¯¹å¤šï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥å­˜åœ¨å¤šä¸ªç”¨æˆ·ç»„ä¸­ï¼Œæ­¤ç”¨æˆ·å…·æœ‰è¿™å¤šä¸ªç»„çš„å…±åŒæƒé™ï¼› å¤šå¯¹ä¸€ï¼šå¤šä¸ªç”¨æˆ·å¯ä»¥å­˜åœ¨ä¸€ä¸ªç»„ä¸­ï¼Œè¿™äº›ç”¨æˆ·å…·æœ‰å’Œç»„ç›¸åŒçš„æƒé™ï¼› å¤šå¯¹å¤šï¼šå¤šä¸ªç”¨æˆ·å¯ä»¥å­˜åœ¨å¤šä¸ªç»„ä¸­ï¼Œä¹Ÿå°±æ˜¯ä»¥ä¸Š 3 ç§å…³ç³»çš„æ‰©å±•ã€‚ ä¸‹å›¾å½¢è±¡çš„è¡¨ç¤ºäº†ç”¨æˆ·å’Œç”¨æˆ·ç»„çš„4ç§å¯¹åº”å…³ç³»ã€‚ æ³¨æ„ï¼šæ¯ä¸€ä¸ªç”¨æˆ·ç»„ä¹Ÿæœ‰ä¸€ä¸ªå£ä»¤ï¼Œå½“æˆ‘ä»¬å°†ç”¨æˆ·æ·»åŠ åˆ°æŒ‡å®šç»„æ—¶éœ€è¦è¯¥ç”¨æˆ·ç»„çš„å¯†ç ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:1:2","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.3 æ–‡ä»¶æƒé™ åœ¨Linuxæ“ä½œç³»ç»Ÿä¸­ï¼Œä»»ä½•æ–‡ä»¶éƒ½å½’å±äºæŸä¸€ç‰¹å®šçš„ç”¨æˆ·ï¼Œå…¶ä½œä¸ºå¤šç”¨æˆ·ç³»ç»Ÿï¼Œå¦‚ä½•åŒºåˆ†ä¸åŒç”¨æˆ·å¯¹æ–‡ä»¶çš„æƒé™æˆäº†ä¸å¯é¿å…çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå° A å¸Œæœ›ä¸ªäººæ–‡ä»¶ä¸è¢«å…¶ä»–ç”¨æˆ·è¯»å–ï¼Œè€Œå¦‚æœä¸å¯¹æ–‡ä»¶è¿›è¡Œæƒé™è®¾ç½®ï¼Œå…±äº«äº†ä¸»æœºèµ„æºçš„å° B ä¹Ÿå¯ä»¥è¯»å–å° A çš„ä¸ªäººæ–‡ä»¶ï¼Œè¿™æ˜¯ä¸åˆç†çš„ï¼Œä¸åŒç”¨æˆ·å¯¹ä¸åŒæ–‡ä»¶æ‰€æ‹¥æœ‰çš„æƒé™åº”è¯¥ä¸å°½ç›¸åŒã€‚ å› æ­¤ï¼ŒLinux ä»¥ â€œç”¨æˆ·ä¸ç”¨æˆ·ç»„â€ çš„æ¦‚å¿µï¼Œå»ºç«‹ç”¨æˆ·ä¸æ–‡ä»¶æƒé™ä¹‹é—´çš„è”ç³»ï¼Œä¿è¯ç³»ç»Ÿèƒ½å¤Ÿå……åˆ†è€ƒè™‘æ¯ä¸ªç”¨æˆ·çš„éšç§ä¿æŠ¤ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šä¿éšœäº† Linux ä½œä¸ºå¤šç”¨æˆ·ç³»ç»Ÿçš„å¯è¡Œæ€§ã€‚ä»æ–‡ä»¶æƒé™çš„è§’åº¦å‡ºå‘ï¼Œâ€œç”¨æˆ·ä¸ç”¨æˆ·ç»„â€ å¼•ç”³ä¸ºä¸‰ä¸ªå…·ä½“çš„å¯¹è±¡â€”â€”æ–‡ä»¶æ‰€æœ‰è€…ã€ç”¨æˆ·ç»„æˆå‘˜ã€å…¶ä»–äººã€‚æ¯ä¸€ä¸ªå¯¹è±¡å¯¹æŸä¸€ä¸ªæ–‡ä»¶çš„æŒæœ‰æƒé™æ˜¯ä¸åŒçš„ã€‚ 1.3.1 æ–‡ä»¶æ‰€æœ‰è€…ï¼ˆUserï¼‰ å½“ä¸€ä¸ªç”¨æˆ·åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªç”¨æˆ·å°±æ˜¯è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æ‰€æœ‰è€…ã€‚æ–‡ä»¶æ‰€æœ‰è€…å¯¹æ–‡ä»¶æ‹¥æœ‰æœ€é«˜æƒé™ï¼Œé™¤éæ–‡ä»¶æ‰€æœ‰è€…å¼€æ”¾æƒé™ï¼Œå¦åˆ™å…¶ä»–äººæ— æ³•å¯¹æ–‡ä»¶æ‰§è¡ŒæŸ¥çœ‹ã€ä¿®æ”¹ç­‰æ“ä½œã€‚**è¿™ä¹Ÿæ˜¯ Linux ç³»ç»Ÿèƒ½å¤Ÿä¿æŠ¤ç”¨æˆ·éšç§çš„æœ€å…³é”®çš„åŸå› ã€‚**åœ¨æ–‡ä»¶æ‰€æœ‰è€…å æœ‰æ–‡ä»¶ä¹‹åï¼Œéœ€è¦æ–‡ä»¶æ‰€æœ‰è€…å¯¹å…¶ä»–ç”¨æˆ·å¼€æ”¾æƒé™ï¼Œå…¶ä»–ç”¨æˆ·æ‰èƒ½æŸ¥çœ‹ã€ä¿®æ”¹æ–‡ä»¶ã€‚ å¦‚æœä»…åŒºåˆ† â€œæ–‡ä»¶æ‰€æœ‰è€…â€ å’Œ â€œå…¶ä»–ç”¨æˆ·â€ï¼Œé‚£ä¹ˆæ–‡ä»¶æ‰€æœ‰è€…å¯¹å…¶ä»–ç”¨æˆ·å¼€æ”¾æƒé™åï¼Œæ‰€æœ‰å…¶ä»–ç”¨æˆ·å‡èƒ½æŸ¥çœ‹ã€ä¿®æ”¹æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œè‹¥æ–‡ä»¶æ‰€æœ‰è€…å¸Œæœ›ä»…å¯¹éƒ¨åˆ†ç”¨æˆ·å¼€æ”¾ï¼Œé‚£ä¹ˆä»…ä»…åŒºåˆ† â€œç”¨æˆ·æ‰€æœ‰è€…â€ å’Œ â€œå…¶ä»–ç”¨æˆ·â€ æ˜¾ç„¶ä¸æ»¡è¶³éœ€æ±‚ã€‚è¿™å°±å¼•å…¥äº† â€œç”¨æˆ·ç»„çš„æ¦‚å¿µâ€ã€‚ 1.3.2 ç”¨æˆ·ç»„æˆå‘˜ï¼ˆGroupï¼‰ å°† â€œå…¶ä»–ç”¨æˆ·â€ åŒºåˆ†ä¸ºç”¨æˆ·ç»„æˆå‘˜å’Œå…¶ä»–äººåï¼Œè‹¥æ–‡ä»¶æ‰€æœ‰è€…å¸Œæœ›å¯¹éƒ¨åˆ†ç”¨æˆ·å¼€æ”¾æƒé™ï¼Œè€Œå¯¹å…¶ä»–äººç»§ç»­ä¿æŒç§æœ‰ï¼Œåˆ™åªéœ€è¦å°†è¿™éƒ¨åˆ†ç”¨æˆ·ä¸æ–‡ä»¶æ‰€æœ‰è€…åˆ’å…¥ä¸€ä¸ªç”¨æˆ·ç»„ã€‚è¿™æ ·ï¼Œè¿™éƒ¨åˆ†ç”¨æˆ·å°±æˆäº†ä¸æ–‡ä»¶æ‰€æœ‰è€…åŒç»„çš„ç”¨æˆ·ç»„æˆå‘˜ã€‚ç”¨æˆ·å¯ä»¥å¯¹ç”¨æˆ·ç»„æˆå‘˜å¼€æ”¾æ–‡ä»¶æƒé™ï¼Œç”¨æˆ·ç»„æˆå‘˜åˆ™å…·å¤‡äº†æŸ¥çœ‹ã€ä¿®æ”¹æ–‡ä»¶çš„æƒé™ï¼Œè€Œå¯¹å…¶ä»–æ— å…³ç”¨æˆ·ä¿æŒç§æœ‰ã€‚ ç”¨æˆ·ç»„æˆå‘˜åœ¨å›¢é˜Ÿå¼€å‘ä¸­éå¸¸æœ‰å¸®åŠ©ã€‚ä¾‹å¦‚ï¼Œå›¢é˜Ÿæˆå‘˜ä¹‹é—´ä¿æŒæ–‡ä»¶èµ„æºå…±äº«ï¼Œä½†å¯¹éå›¢é˜Ÿæˆå‘˜ä¿æŒç§æœ‰ï¼Œè¿™å°±éœ€è¦å°†æ–‡ä»¶æ‰€æœ‰è€…ä¸å›¢é˜Ÿæˆå‘˜ç”¨æˆ·åˆ’åˆ†ä¸ºåŒä¸€ä¸ªç”¨æˆ·ç»„ï¼Œå†å¯¹ç”¨æˆ·ç»„æˆå‘˜å¼€æ”¾æƒé™å³å¯ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ªç”¨æˆ·å¯åœ¨å¤šä¸ªç”¨æˆ·ç»„ä¸­ã€‚ 1.3.3 å…¶ä»–äººï¼ˆOthersï¼‰ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸æ–‡ä»¶æ‰€æœ‰è€…æ²¡æœ‰ä»»ä½•è”ç³»çš„ç”¨æˆ·ï¼Œå³ä¸æ˜¯æ–‡ä»¶æ‰€æœ‰è€…ä¹Ÿä¸æ˜¯æ‰€åœ¨æ–‡ä»¶æ‰€å±ç”¨æˆ·ç»„ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:1:3","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.4 è¶…çº§ç®¡ç†å‘˜ï¼ˆrootï¼‰ ç”±äºLinuxç³»ç»Ÿä¸­ï¼Œrootå…·æœ‰æœ€é«˜æƒé™ï¼Œå¯ä»¥æ‰§è¡Œä»»ä½•æƒ³è¦æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œå¤„äºå®‰å…¨è€ƒè™‘ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸æ¨èä½¿ç”¨ root ç”¨æˆ·è¿›è¡Œæ—¥å¸¸ä½¿ç”¨ã€‚root ç”¨æˆ·æ‰€åœ¨çš„ç”¨æˆ·ç»„ç§°ä¸º â€œrootç»„â€ï¼Œå¤„äº root ç»„çš„æ™®é€šç”¨æˆ·ï¼Œèƒ½å¤Ÿé€šè¿‡ sudo å‘½ä»¤è·å– root æƒé™ï¼Œå³æˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡sudoæƒé™æ¥æ“ä½œæ–‡ä»¶çš„ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:1:4","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.5 AAAåŸºç¡€ AAAæŒ‡çš„æ˜¯Authenticationã€Authorizationã€Accountingï¼Œå³è®¤è¯ã€æˆæƒå’Œå®¡è®¡ã€‚ è®¤è¯ï¼šéªŒè¯ç”¨æˆ·æ˜¯å¦å¯ä»¥è·å¾—æƒé™ï¼Œæ˜¯AAAçš„ç¬¬ä¸€æ­¥ï¼Œå³éªŒè¯èº«ä»½ï¼› æˆæƒï¼šæˆæƒç”¨æˆ·å¯ä»¥ä½¿ç”¨é‚£äº›æœåŠ¡æˆ–èµ„æºï¼Œå³èº«ä»½éªŒè¯æˆåŠŸåï¼Œèµ‹äºˆè¿™ä¸ªèº«ä»½ç›¸åº”çš„æƒé™ï¼› å®¡è®¡ï¼šè®°å½•ç”¨æˆ·çš„æ“ä½œæƒ…å†µï¼Œåœ¨Linuxä¸­ï¼Œæ—¥å¿—å°±æ˜¯å®¡è®¡çš„ä¸€ç§æ‰‹æ®µã€‚ Linuxçš„ç”¨æˆ·å’Œç»„ç®¡ç†å¯ä»¥è¯´æ˜¯åŸºäºAAAè¿›è¡Œçš„ï¼Œé¦–å…ˆç”¨æˆ·ç™»å½•è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œå°±æ˜¯è®¤è¯çš„è¿‡ç¨‹ï¼›å…¶æ¬¡ï¼Œåœ¨ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œæ‰€æ‹¥æœ‰çš„æƒé™å„ä¸ç›¸åŒï¼Œè¿™å°±æ˜¯ æˆæƒï¼›æœ€åï¼Œç”¨æˆ·çš„æ“ä½œå†å²ä¼šè®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œè¿™æ˜¯å®¡è®¡ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:1:5","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ç”¨æˆ·å’Œç”¨æˆ·ç»„æ–‡ä»¶ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:2:0","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 ç”¨æˆ·è´¦å·æ–‡ä»¶â€” /etc/passwd /etc/passwdæ–‡ä»¶æ˜¯Linuxç³»ç»Ÿå®‰å…¨çš„å…³é”®æ–‡ä»¶ä¹‹ä¸€ï¼Œåªæœ‰ç³»ç»Ÿç®¡ç†å‘˜æ‰å¯ä»¥ä¿®æ”¹æ­¤æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ç”¨äºç”¨æˆ·ç™»å½•ç­‰æ“ä½œæ—¶æ ¡éªŒç”¨æˆ·çš„ç™»å½•åã€åŠ å¯†çš„å£ä»¤æ•°æ®é¡¹ã€ç”¨æˆ·IDï¼ˆUIDï¼‰ã€é»˜è®¤çš„ç”¨æˆ·ç»„IDï¼ˆGIDï¼‰ã€ç”¨æˆ·ä¿¡æ¯ã€ç”¨æˆ·ä¸»ç›®å½•åŠç™»å½•åä½¿ç”¨çš„shellã€‚è¯¥æ–‡ä»¶ç§æ¯ä¸€è¡Œä¿å­˜ä¸€ä¸ªç”¨æˆ·çš„èµ„æ–™ï¼Œè€Œç”¨æˆ·æ•°æ®æŒ‰åŸŸä»¥å†’å·â€™:â€˜åˆ†å‰²ã€‚æ ¼å¼å¦‚ä¸‹ã€‚ username:password:uid:gid:userinfo:home:shell å…·ä½“å«ä¹‰å¦‚è¡¨æ‰€ç¤ºã€‚ åŸŸ å«ä¹‰ username ç™»å½•å password åŠ å¯†çš„ç”¨æˆ·å£ä»¤ uid ç”¨æˆ·ID gid ç”¨æˆ·ç»„ID userinfo ç”¨æˆ·ä¿¡æ¯ home åˆ†é…ç»™ç”¨æˆ·çš„ä¸»ç›®å½• shell ç”¨æˆ·ç™»å½•åå°†æ‰§è¡Œçš„shellï¼ˆè‹¥ä¸ºç©ºæ ¼æ³½é»˜è®¤ä¸ºâ€œ/bin/shâ€ï¼‰ å…¶ä¸­å…³äºç”¨æˆ·ä¸»ç›®å½•ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½éœ€è¦ä¿å­˜ä¸“å±äºè‡ªå·±çš„é…ç½®æ–‡ä»¶åŠå…¶ä»–æ–‡æ¡£ï¼Œè¿™æ˜¯ä»¥å…ç”¨æˆ·é—´ç›¸äº’å¹²æ‰°ã€‚é™¤rootè´¦æˆ·å¤–ï¼ˆrootè´¦æˆ·çš„ä¸»ç›®å½•ä¸º\"/root\"ï¼‰ï¼Œå¤§å¤šæ•°Linuxé»˜è®¤å°†ç”¨æˆ·ä¸»ç›®å½•å®‰ç½®åœ¨\"/home\"ç›®å½•ä¸‹ï¼Œå¹¶æŠŠæ¯ä¸ªç”¨æˆ·çš„ä¸»ç›®å½•å‘½åä¸ºå…¶ä¸Šæœºä½¿ç”¨çš„ç™»å½•åã€‚ å¦‚å›¾ï¼Œacsçš„ç™»å½•ä¸»ç›®å½•ä¸º\"/home/acs\"ã€‚é€šå¸¸ï¼Œâ€œ~â€è¢«æŒ‡å‘å½“å‰ç”¨æˆ·çš„ç™»å½•å­ç›®å½•ã€‚ æ³¨æ„ï¼šç”¨æˆ·ä¸»ç›®å½•è¢«å®‰æ’åœ¨â€œ/homeâ€ä¸‹å®Œå…¨æ˜¯è®¤ä¸ºå†³å®šçš„ã€‚ç³»ç»Ÿå¹¶ä¸å…³å¿ƒæˆ‘ä»¬åˆ°åº•æŠŠç”¨æˆ·ä¸»ç›®å½•å®‰æ’åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œå› ä¸ºæ¯ä¸ªç”¨æˆ·çš„ä½ç½®æ˜¯åœ¨è´¦å·æ–‡ä»¶ä¸­å®šä¹‰è¯´æ˜çš„ã€‚æ‰€ä»¥ï¼Œç”¨æˆ·å¯ä»¥è‡ªè¡Œè°ƒæ•´ï¼Œçµæ´»ä½¿ç”¨ å…³äºshellï¼ŒShellæ˜¯ç”¨æˆ·ä¸Linuxç³»ç»Ÿä¹‹é—´çš„æ¥å£ã€‚Linuxçš„Shellæœ‰è®¸å¤šç§ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹ã€‚å½“ç”¨æˆ·ç™»å½•è¿›å…¥ç³»ç»Ÿæ—¶ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªShellç¨‹åºï¼Œé»˜è®¤æ˜¯bashã€‚ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æ ¹æ®ç³»ç»Ÿæƒ…å†µå’Œç”¨æˆ·ä¹ æƒ¯ä¸ºç”¨æˆ·æŒ‡å®šæŸä¸ªShellã€‚å¦‚æœä¸æŒ‡å®šShellï¼Œé‚£ä¹ˆç³»ç»Ÿä½¿ç”¨bashä¸ºé»˜è®¤çš„ç™»å½•Shellï¼Œå³è¿™ä¸ªå­—æ®µçš„å€¼ä¸º/bin/bashã€‚ç”¨æˆ·çš„ç™»å½•Shellä¹Ÿå¯ä»¥æŒ‡å®šä¸ºæŸä¸ªç‰¹å®šçš„ç¨‹åºï¼ˆæ­¤ç¨‹åºä¸æ˜¯ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨ï¼‰ã€‚ æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹/etc/passwdæ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å®Œæ•´çš„ç³»ç»Ÿè´¦å·æ–‡ä»¶ã€‚ æˆ‘ä»¬å‘ç°ï¼Œç¬¬äºŒåˆ—éƒ½ä¸ºxã€‚æˆ‘ä»¬å¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:2:1","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 ç”¨æˆ·å½±å­æ–‡ä»¶â€”/etc/shadow å®é™…ä¸Šï¼ŒLinxuä½¿ç”¨ä¸å¯é€†çš„åŠ å¯†ç®—æ³•ï¼ˆå¦‚MD5ï¼‰æ¥åŠ å¯†å£ä»¤ï¼Œç”±äºåŠ å¯†ç®—æ³•æ˜¯ä¸å¯é€†çš„ï¼Œæ‰€ä»¥é»‘å®¢ä»å¯†æ–‡æ˜¯å¾—ä¸åˆ°æ˜æ–‡çš„ã€‚ä½†/etc/passwdæ–‡ä»¶æ—¶å…¨å±€å¯è¯»çš„ï¼Œä¸”åŠ å¯†çš„ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œå¦‚æœåœ¨passwdä¸­æ˜¾ç¤ºå¯†æ–‡ï¼Œé»‘å®¢æ®æ­¤å¯ä»¥ç ´è§£å£ä»¤ã€‚Linuxç³»ç»Ÿç›®å‰å¹¿æ³›é‡‡ç”¨äº†â€œshadowï¼ˆå½±å­ï¼‰æ–‡ä»¶â€æœºåˆ¶ã€‚å°†åŠ å¯†çš„å£ä»¤è½¬ç§»åˆ°â€œ/etc/shadowâ€æ–‡ä»¶ä¸­ã€‚/etc/shadowæ–‡ä»¶åªä¸ºrootè¶…çº§ç”¨æˆ·å¯è¯»ï¼Œè€Œç›¸åº”çš„etc/passwdæ–‡ä»¶çš„å¯†æ–‡åŸŸæ³½æ˜¾ç¤ºä¸ºä¸€ä¸ªxï¼Œä»è€Œæœ€å¤§é™åº¦åœ°å‡å°‘äº†å¯†æ–‡æ³„éœ²çš„æœºä¼šã€‚xè¡¨ç¤ºè¯¥è´¦æˆ·éœ€è¦å¯†ç æ‰èƒ½ç™»å½•ï¼Œä¸ºç©ºæ—¶ï¼Œè´¦æˆ·æ— é¡»å¯†ç å³å¯ç™»å½•ã€‚ å’Œ/etc/passwdç±»ä¼¼ï¼Œ/etc/shadowæ–‡ä»¶ä¸­æ¯æ¡è®°å½•ç”¨å†’å·â€œï¼šâ€åˆ†éš”ï¼Œå½¢æˆ9ä¸ªåŸŸï¼Œæ ¼å¼å¦‚ä¸‹ã€‚ username:password:lastchg:min:max:warn:inactive:expire:flag åŸŸ å«ä¹‰ username ç”¨æˆ·ç™»é™†å password åŠ å¯†çš„ç”¨æˆ·å£ä»¤ lastchg è¡¨ç¤ºä»1970å¹´1æœˆ1æ—¥èµ·åˆ°ä¸Šæ¬¡ä¿®æ”¹å£ä»¤æ‰€ç»è¿‡çš„å¤©æ•° min è¡¨ç¤ºä¸¤æ¬¡ä¿®æ”¹å£ä»¤ä¹‹é—´è‡³å°‘ç»è¿‡çš„å¤©æ•° max è¡¨ç¤ºå£ä»¤è¿˜ä¼šæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ï¼Œå¦‚æœæ˜¯99999åˆ™è¡¨ç¤ºæ°¸ä¸è¿‡æœŸ warn è¡¨ç¤ºå£ä»¤å¤±æ•ˆå‰å¤šå°‘å¤©å†…ç³»ç»Ÿå‘ç”¨æˆ·å‘å‡ºè­¦å‘Š inactive è¡¨ç¤ºç¦æ­¢ç™»å½•å‰ç”¨æˆ·åè¿˜æœ‰æ•ˆçš„å¤©æ•° expire è¡¨ç¤ºç”¨æˆ·è¢«ç¦æ­¢ç™»å½•çš„æ—¶é—´ flag ä¿ç•™åŸŸï¼Œæš‚æœªä½¿ç”¨ ä¸‹å›¾ä¸ºç³»ç»Ÿä¸­å®é™…å½±å­æ–‡ä»¶çš„ä¾‹å­ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:2:2","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 åˆ›å»ºç”¨æˆ·çš„é»˜è®¤è®¾ç½®æ–‡ä»¶â€”/etc/login.defs /etc/login.defs æ–‡ä»¶ç”¨äºåœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼Œå¯¹ç”¨æˆ·çš„ä¸€äº›åŸºæœ¬å±æ€§åšé»˜è®¤è®¾ç½®ï¼Œä¾‹å¦‚æŒ‡å®šç”¨æˆ· UID å’Œ GID çš„èŒƒå›´ï¼Œç”¨æˆ·çš„è¿‡æœŸæ—¶é—´ï¼Œå¯†ç çš„æœ€å¤§é•¿åº¦ï¼Œç­‰ç­‰ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·é»˜è®¤é…ç½®å¯¹ root ç”¨æˆ·æ— æ•ˆã€‚å¹¶ä¸”ï¼Œå½“æ­¤æ–‡ä»¶ä¸­çš„é…ç½®ä¸ /etc/passwd å’Œ /etc/shadow æ–‡ä»¶ä¸­çš„ç”¨æˆ·ä¿¡æ¯æœ‰å†²çªæ—¶ï¼Œç³»ç»Ÿä¼šä»¥/etc/passwd å’Œ /etc/shadow ä¸ºå‡†ã€‚ å…¶ä¸­è®¾ç½®é¡¹å«ä¹‰å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ è®¾ç½®é¡¹ å«ä¹‰ MAIL_DIR /var/spool/mail åˆ›å»ºç”¨æˆ·æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨ç›®å½• /var/spool/mail ä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·é‚®ç®±ï¼Œæ¯”å¦‚ lamp ç”¨æˆ·çš„é‚®ç®±æ˜¯ /var/spool/mail/lampã€‚ PASS_MAX_DAYS 99999 å¯†ç æœ‰æ•ˆæœŸï¼Œ99999 æ˜¯è‡ª 1970 å¹´ 1 æœˆ 1 æ—¥èµ·å¯†ç æœ‰æ•ˆçš„å¤©æ•°ï¼Œç›¸å½“äº 273 å¹´ï¼Œå¯ç†è§£ä¸ºå¯†ç å§‹ç»ˆæœ‰æ•ˆã€‚ PASS_MIN_DAYS 0 è¡¨ç¤ºè‡ªä¸Šæ¬¡ä¿®æ”¹å¯†ç ä»¥æ¥ï¼Œæœ€å°‘éš”å¤šå°‘å¤©åç”¨æˆ·æ‰èƒ½å†æ¬¡ä¿®æ”¹å¯†ç ï¼Œé»˜è®¤å€¼æ˜¯ 0ã€‚ PASS_MIN_LEN 5 æŒ‡å®šå¯†ç çš„æœ€å°é•¿åº¦ï¼Œé»˜è®¤ä¸å°äº 5 ä½ï¼Œä½†æ˜¯ç°åœ¨ç”¨æˆ·ç™»å½•æ—¶éªŒè¯å·²ç»è¢« PAM æ¨¡å—å–ä»£ï¼Œæ‰€ä»¥è¿™ä¸ªé€‰é¡¹å¹¶ä¸ç”Ÿæ•ˆã€‚ PASS_WARN_AGE 7 æŒ‡å®šåœ¨å¯†ç åˆ°æœŸå‰å¤šå°‘å¤©ï¼Œç³»ç»Ÿå°±å¼€å§‹é€šè¿‡ç”¨æˆ·å¯†ç å³å°†åˆ°æœŸï¼Œé»˜è®¤ä¸º 7 å¤©ã€‚ UID_MIN 500 æŒ‡å®šæœ€å° UID ä¸º 500ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ·»åŠ ç”¨æˆ·æ—¶ï¼Œé»˜è®¤ UID ä» 500 å¼€å§‹ã€‚æ³¨æ„ï¼Œå¦‚æœæ‰‹å·¥æŒ‡å®šäº†ä¸€ä¸ªç”¨æˆ·çš„ UID æ˜¯ 550ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªåˆ›å»ºçš„ç”¨æˆ·çš„ UID å°±ä¼šä» 551 å¼€å§‹ï¼Œå“ªæ€• 500~549 ä¹‹é—´çš„ UID æ²¡æœ‰ä½¿ç”¨ã€‚ UID_MAX 60000 æŒ‡å®šç”¨æˆ·æœ€å¤§çš„ UID ä¸º 60000ã€‚ GID_MIN 500 æŒ‡å®šæœ€å° GID ä¸º 500ï¼Œä¹Ÿå°±æ˜¯åœ¨æ·»åŠ ç»„æ—¶ï¼Œç»„çš„ GID ä» 500 å¼€å§‹ã€‚ GID_MAX 60000 ç”¨æˆ· GID æœ€å¤§ä¸º 60000ã€‚ CREATE_HOME yes æŒ‡å®šåœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼Œæ˜¯å¦åŒæ—¶åˆ›å»ºç”¨æˆ·ä¸»ç›®å½•ï¼Œyes è¡¨ç¤ºåˆ›å»ºï¼Œno åˆ™ä¸åˆ›å»ºï¼Œé»˜è®¤æ˜¯ yesã€‚ UMASK 077 ç”¨æˆ·ä¸»ç›®å½•çš„æƒé™é»˜è®¤è®¾ç½®ä¸º 077ã€‚ USERGROUPS_ENAB yes æŒ‡å®šåˆ é™¤ç”¨æˆ·çš„æ—¶å€™æ˜¯å¦åŒæ—¶åˆ é™¤ç”¨æˆ·ç»„ï¼Œå‡†å¤‡åœ°è¯´ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯åˆ é™¤ç”¨æˆ·çš„åˆå§‹ç»„ï¼Œæ­¤é¡¹çš„é»˜è®¤å€¼ä¸º yesã€‚ ENCRYPT_METHOD SHA512 æŒ‡å®šç”¨æˆ·å¯†ç é‡‡ç”¨çš„åŠ å¯†è§„åˆ™ï¼Œé»˜è®¤é‡‡ç”¨ SHA512ï¼Œè¿™æ˜¯æ–°çš„å¯†ç åŠ å¯†æ¨¡å¼ï¼ŒåŸå…ˆçš„ Linux åªèƒ½ç”¨ DES æˆ– MD5 åŠ å¯†ã€‚ å¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹é»˜è®¤é…ç½®å³å¯ä¿®æ”¹é…ç½®é¡¹çš„å€¼å³å¯ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:2:3","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.4 ç”¨æˆ·ç»„è´¦å·æ–‡ä»¶â€”/etc/group æˆ‘ä»¬çŸ¥é“ï¼Œ/etc/passwdæ–‡ä»¶ä¸­åŒ…å«ç€æ¯ä¸ªç”¨æˆ·çš„ç”¨æˆ·ç»„IDï¼ˆGIDï¼‰ï¼Œä½†å¦‚æœæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªç”¨æˆ·ç»„ä¸­çš„æ‰€æœ‰ç”¨æˆ·ï¼Œé€šè¿‡/etc/passwdéš¾å…æœ‰äº›å¤æ‚ï¼Œéœ€è¦ä»å¤´åˆ°å°¾å¯»æ‰¾åŒç»„ç”¨æˆ·ã€‚è€Œ/etc/groupæ–‡ä»¶åŒ…å«å…³äºç”¨æˆ·ç»„ä¿¡æ¯ï¼ŒGIDè¢«æ˜ å°„åˆ°ç”¨æˆ·åˆ†ç»„çš„åç§°åŠåŒä¸€åˆ†ç»„ä¸­çš„å…¶ä»–æˆå‘˜ï¼Œè¿™æ ·æ‰¾åŒç»„ç”¨æˆ·ä»¥åŠé…ç½®ç”¨æˆ·ç»„å°±æ–¹ä¾¿äº†è®¸å¤šã€‚/etc/groupæ–‡ä»¶å¯¹ç”¨æˆ·ç»„çš„è®¸å¯æƒé™çš„æ§åˆ¶å¹¶ä¸æ˜¯å¿…è¦çš„ï¼Œè¿™æ˜¯å› ä¸ºLinuxç³»ç»Ÿç”¨æ¥è‡ªäº/etc/passwdæ–‡ä»¶çš„UIDã€GIDæ¥å†³å®šæ–‡ä»¶å­˜å–æƒé™ã€‚å³ä½¿/etc/groupæ–‡ä»¶ä¸å­˜åœ¨äºç³»ç»Ÿä¸­ï¼Œå…·æœ‰ç›¸åŒçš„GIDç”¨æˆ·ä¹Ÿèƒ½ä»¥ç”¨æˆ·ç»„çš„è®¸å¯æƒé™å…±äº«æ–‡ä»¶ã€‚ /etc/groupæ–‡ä»¶è®°å½•æ ¼å¼å¦‚ä¸‹ã€‚ group_name:group_password:group_id:group_members å…¶ä¸­ï¼Œå„ä¸ªåŸŸçš„å«ä¹‰å¦‚ä¸‹è¡¨ã€‚ åŸŸ å«ä¹‰ group_name ç”¨æˆ·ç»„å group_password åŠ å¯†åçš„ç”¨æˆ·ç»„å£ä»¤ group_id ç”¨æˆ·ç»„IDï¼ˆGIDï¼‰ group_members ä»¥é€—å·åˆ†éš”çš„æˆå‘˜ç”¨æˆ·æ¸…å• ä»¥ä¸‹æ˜¯ä¸€ä¸ª/etc/groupæ–‡ä»¶çš„å®ä¾‹ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:2:4","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.5 ç”¨æˆ·ç»„å½±å­æ–‡ä»¶â€”/etc/gshadow å’Œç”¨æˆ·è´¦å·æ–‡ä»¶passwdä¸€æ ·ï¼Œä¸ºäº†åº”å¯¹é»‘å®¢å¯¹å…¶è¿›è¡Œçš„æš´åŠ›æ”»å‡»ï¼Œç”¨æˆ·ç»„æ–‡ä»¶ä¹Ÿé‡‡ç”¨ä¸€ç§å°†ç»„å£ä»¤ä¸ç»„çš„å…¶ä»–ä¿¡æ¯ç›¸åˆ†ç¦»çš„å®‰å…¨æœºåˆ¶â€”â€”gshadowã€‚/etc/shadowæ–‡ä»¶è®°å½•æ ¼å¼å¦‚ä¸‹ã€‚ group_name:group_password:group_members å…¶ä¸­ï¼Œå„ä¸ªåŸŸçš„å«ä¹‰å¦‚ä¸‹è¡¨ã€‚ åŸŸ å«ä¹‰ group_name ç”¨æˆ·ç»„å group_password åŠ å¯†åçš„ç”¨æˆ·ç»„å£ä»¤ group_members ä»¥é€—å·åˆ†éš”çš„æˆå‘˜ç”¨æˆ·æ¸…å• ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:2:5","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç† ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:3:0","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 ç”¨æˆ·ç®¡ç† 3.1.1 ä½¿ç”¨useraddå‘½ä»¤æ·»åŠ ç”¨æˆ· Linuxä½¿ç”¨useraddå‘½ä»¤æ·»åŠ ç”¨æˆ·æˆ–æ›´æ–°æ–°åˆ›å»ºç”¨æˆ·çš„é»˜è®¤ä¿¡æ¯ã€‚å…¶å‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ useradd [option] username å¯ä½¿ç”¨çš„é€‰é¡¹å¦‚ä¸‹ï¼š -c commentï¼šæè¿°æ–°ç”¨æˆ·è´¦å·ï¼Œé€šå¸¸ä¸ºç”¨æˆ·å…¨åã€‚ -d home_dirï¼šè®¾ç½®ç”¨æˆ·ä¸»ç›®å½•ã€‚é»˜è®¤å€¼ä¸ºç”¨æˆ·çš„ç™»å½•åï¼Œå¹¶æ”¾åœ¨\"/home\"ç›®å½•ä¸‹ã€‚ -g groupï¼šæŒ‡å®šç”¨æˆ·æ‰€å±çš„åŸºæœ¬ç»„ã€‚ -G groupï¼šæŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„ã€‚ -u uidï¼šè®¾ç½®ç”¨æˆ·çš„IDã€‚ -s shellç±»å‹ï¼šè®¾å®šç”¨æˆ·ä½¿ç”¨çš„ç™»å½•shellç±»å‹ã€‚ -k dirï¼šè®¾ç½®æ¡†æ¶ç›®å½•ï¼Œåˆ›å»ºç”¨æˆ·æ—¶è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½è¢«å¤åˆ¶åˆ°ä¸»ç›®å½•ã€‚ -e expire_dateï¼šè®¾ç½®è´¦å·è¿‡æœŸæ—¶é—´ã€‚ -f inactivityï¼šè®¾ç½®å£ä»¤å¤±æ•ˆæ—¶é—´ã€‚ -nï¼šä¸ä¸ºç”¨æˆ·åˆ›å»ºç§æœ‰ç”¨æˆ·ç»„ã€‚ -p passwordï¼šä¸ºæ–°å»ºç”¨æˆ·æŒ‡å®šç™»å½•å¯†ç ã€‚æ­¤å¤„çš„ password æ˜¯å¯¹åº”ç™»å½•å¯†ç ç» MD5 åŠ å¯†åæ‰€å¾—åˆ°çš„å¯†ç å€¼ï¼Œä¸æ˜¯çœŸå®å¯†ç åŸæ–‡ï¼Œå› æ­¤åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¯¥å‚æ•°é€‰é¡¹ä½¿ç”¨è¾ƒå°‘ï¼Œé€šå¸¸å•ç‹¬ä½¿ç”¨ passwd å‘½ä»¤æ¥ä¸ºç”¨æˆ·è®¾ç½®ç™»å½•å¯†ç ã€‚ -rï¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ· ID å°äº 500 çš„ç³»ç»Ÿè´¦æˆ·ï¼Œé»˜è®¤ä¸åˆ›å»ºå¯¹åº”çš„ä¸»ç›®å½•ã€‚ -mï¼šè‹¥ä¸»ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒã€‚é€šå¸¸ä¸-rç»“åˆï¼Œå¯ä¸ºç³»ç»Ÿç”¨æˆ·ä¸»ç›®å½•ã€‚ -Mï¼šä¸åˆ›å»ºä¸»ç›®å½•ã€‚ å®ä¾‹1ï¼šåˆ›å»ºä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œåä¸ºhzfï¼Œå…¶ä¸­uidä¸º6666ï¼Œç”¨æˆ·ä¸»ç›®å½•æŒ‡å®šåœ¨/hzf/ã€‚ useradd -u 6666 -d /hzf/ hzf å®ä¾‹2ï¼šåˆ›å»ºä¸€ä¸ªç³»ç»Ÿè´¦æˆ·ï¼Œåä¸ºmysystemï¼Œå…¶ä¸­ä¸ºç³»ç»Ÿç”¨æˆ·åˆ›å»ºä¸»ç›®å½•ï¼ŒæŒ‡å®šå¯†ç ä¸º12345678 é¦–å…ˆéœ€è¦åŠ å¯†å¯†ç ä¸²ï¼Œè¿™é‡Œä½¿ç”¨md5sumå·¥å…·ã€‚ åˆ©ç”¨md5sumåŠ å¯†å­—ç¬¦ä¸²çš„æ–¹æ³• # md5sum //ç„¶åå›è½¦ 12345678 //è¾“å…¥12345678ï¼Œç„¶åæŒ‰ä¸¤æ¬¡ctrl+dã€‚ è¿™ä¸ªæ—¶å€™å°±ä¼šå¾—åˆ°ä¸€ä¸²å¯†æ–‡ã€‚ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯åˆ›å»ºè¯¥ç³»ç»Ÿç”¨æˆ· useradd -r -m -p 1234567825d55ad283aa400af464c76d713c07ad mysystem æŸ¥çœ‹/etc/passwdå³å¯çœ‹åˆ°æˆ‘ä»¬åˆ›å»ºå¾—ç”¨æˆ·ä¿¡æ¯ã€‚ 3.1.2 ä½¿ç”¨usermodå‘½ä»¤ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ å¯¹äºå·²åˆ›å»ºå¥½çš„ç”¨æˆ·ï¼Œå¯ä½¿ç”¨ usermod å‘½ä»¤æ¥ä¿®æ”¹å’Œè®¾ç½®è´¦æˆ·çš„å„é¡¹å±æ€§ï¼ŒåŒ…æ‹¬ç™»å½•åï¼Œä¸»ç›®å½•ï¼Œç”¨æˆ·ç»„ï¼Œç™»å½• shell ç­‰ï¼Œè¯¥å‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ usermod [option] username å¸¸ç”¨çš„é€‰é¡¹åŒ…æ‹¬-c, -d, -m, -g, -G, -s, -uä»¥åŠ-oç­‰ï¼Œè¿™äº›é€‰é¡¹çš„æ„ä¹‰ä¸useraddå‘½ä»¤ä¸­çš„é€‰é¡¹ä¸€æ ·ï¼Œå¯ä»¥ä¸ºç”¨æˆ·æŒ‡å®šæ–°çš„èµ„æºå€¼ã€‚ å¦å¤–ï¼Œæœ‰äº›ç³»ç»Ÿè¿˜å¯ä»¥ä½¿ç”¨-lä¿®æ”¹ç”¨æˆ·åã€‚ç”¨æ³•ä¸ºï¼šusermod -l newusername ä½¿ç”¨-Lå¯ä»¥é”å®šç”¨æˆ·è´¦å·ï¼Œä¸´æ—¶ç¦æ­¢ç”¨æˆ·ç™»å½•ã€‚ç”¨æ³•ä¸ºï¼šusermod -L usernameï¼ŒLinuxé”å®šç”¨æˆ·ï¼Œæ˜¯é€šè¿‡åœ¨å¯†ç æ–‡ä»¶ shadow çš„å¯†ç å­—æ®µå‰åŠ  â€œï¼â€ æ¥æ ‡è¯†è¯¥ç”¨æˆ·è¢«é”å®šã€‚ ä½†å¦‚æœæˆ‘ä»¬æ˜¯ç”¨rootç”¨æˆ·ç™»å½•ï¼Œå†ç”¨suå‘½ä»¤åˆ‡æ¢åˆ°è¢«é”å®šçš„è´¦å·æ˜¯å¯ä»¥è¿›å»çš„ã€‚ ä½¿ç”¨-Uå¯ä»¥è§£é”ç”¨æˆ·è´¦å·ã€‚ç”¨æ³•ä¸ºï¼šusermod -U usernameã€‚ 3.1.3 ä½¿ç”¨userdelå‘½ä»¤åˆ é™¤ç”¨æˆ· è¦åˆ é™¤ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨userdelå‘½ä»¤åˆ é™¤ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ userdel [-r] username å…¶ä¸­-rå‚æ•°å¯é€‰ï¼Œè‹¥å¸¦ä¸Šå‚æ•°ï¼Œè¡¨ç¤ºåœ¨åˆ é™¤è´¦æˆ·çš„åŒæ—¶ï¼Œä¸€å¹¶åˆ é™¤ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ 3.1.4 ä½¿ç”¨passwdå‘½ä»¤ç®¡ç†ç”¨æˆ·å£ä»¤ ç”¨æˆ·ç®¡ç†çš„ä¸€é¡¹é‡è¦å†…å®¹æ˜¯ç”¨æˆ·å£ä»¤çš„ç®¡ç†ã€‚ç”¨æˆ·è´¦å·åˆšåˆ›å»ºæ—¶æ²¡æœ‰å£ä»¤ï¼Œä½†æ˜¯è¢«ç³»ç»Ÿé”å®šï¼Œæ— æ³•ä½¿ç”¨ï¼Œå¿…é¡»ä¸ºå…¶æŒ‡å®šå£ä»¤åæ‰å¯ä»¥ä½¿ç”¨ï¼Œå³ä½¿æ˜¯æŒ‡å®šç©ºå£ä»¤ã€‚ æŒ‡å®šå’Œä¿®æ”¹ç”¨æˆ·å£ä»¤çš„Shellå‘½ä»¤æ˜¯passwdã€‚è¶…çº§ç”¨æˆ·å¯ä»¥ä¸ºè‡ªå·±å’Œå…¶ä»–ç”¨æˆ·æŒ‡å®šå£ä»¤ï¼Œæ™®é€šç”¨æˆ·åªèƒ½ç”¨å®ƒä¿®æ”¹è‡ªå·±çš„å£ä»¤ã€‚å‘½ä»¤çš„æ ¼å¼å¦‚ä¸‹ã€‚ passwd [option] username å¯ä½¿ç”¨çš„é€‰é¡¹å¦‚ä¸‹ï¼š -lï¼šé”å®šå£ä»¤ï¼Œå³ç¦ç”¨è´¦å·ã€‚ -uï¼šå£ä»¤è§£é”ã€‚ -dï¼šä½¿è´¦å·æ— å£ä»¤ã€‚è¿™æ ·ï¼Œä¸‹æ¬¡ç™»å½•çš„æ—¶å€™ï¼Œç³»ç»Ÿå°±ä¸å†å…è®¸è¯¥ç”¨æˆ·ç™»å½•äº†ã€‚ -fï¼šå¼ºè¿«ç”¨æˆ·ä¸‹æ¬¡ç™»é™†æ—¶ä¿®æ”¹å£ä»¤ã€‚ å¦‚æœä¸æŒ‡å®šç”¨æˆ·åï¼Œåˆ™è¡¨ç¤ºä¿®æ”¹è‡ªå·±çš„å£ä»¤ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:3:1","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 ç”¨æˆ·ç»„ç®¡ç† 3.2.1 ä½¿ç”¨groupaddå‘½ä»¤åˆ›å»ºç”¨æˆ·ç»„ å¢åŠ ä¸€ä¸ªæ–°çš„ç”¨æˆ·ç»„ä½¿ç”¨groupaddå‘½ä»¤ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ groupadd [option] groupname å¯ä½¿ç”¨çš„é€‰é¡¹å¦‚ä¸‹ï¼š -rï¼šè¡¨ç¤ºåˆ›å»ºç³»ç»Ÿç”¨æˆ·ç»„ï¼Œè¯¥ç±»ç”¨æˆ·ç»„çš„ GID å€¼å°äº 500ï¼›è‹¥æ²¡æœ‰ - r å‚æ•°ï¼Œåˆ™åˆ›å»ºæ™®é€šç”¨æˆ·ç»„ï¼Œå…¶ GID å€¼å¤§äºæˆ–ç­‰äº 500ã€‚ -g gidï¼šæŒ‡å®šæ–°ç”¨æˆ·ç»„çš„æ ‡è¯†å·GIDã€‚ -oï¼šä¸€èˆ¬ä¸-gé€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼Œè¡¨ç¤ºæ–°ç”¨æˆ·ç»„çš„GIDå¯ä»¥ä¸ç³»ç»Ÿå·²æœ‰ç”¨æˆ·ç»„çš„GIDç›¸åŒã€‚ å¦‚æœæ²¡æœ‰æŒ‡å®šé€‰æ‹©å‚æ•°ï¼Œæ–°ç»„çš„ç»„æ ‡è¯†å·æ˜¯åœ¨å½“å‰å·²æœ‰çš„æœ€å¤§ç»„æ ‡è¯†å·çš„åŸºç¡€ä¸ŠåŠ 1ã€‚ 3.2.2 ä½¿ç”¨groupmodä¿®æ”¹ ä¿®æ”¹ç”¨æˆ·ç»„çš„å±æ€§ä½¿ç”¨groupmodå‘½ä»¤ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ groupmod [option] groupname å¯ä½¿ç”¨çš„é€‰é¡¹å¦‚ä¸‹ï¼š -g gidï¼šä¸ºç”¨æˆ·ç»„æŒ‡å®šæ–°çš„ç»„æ ‡è¯†å·ã€‚ -oï¼šä¸-gé€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼Œç”¨æˆ·ç»„çš„æ–°GIDå¯ä»¥ä¸ç³»ç»Ÿå·²æœ‰ç”¨æˆ·ç»„çš„GIDç›¸åŒã€‚ -n newgroupnameï¼š å°†ç”¨æˆ·ç»„çš„åå­—æ”¹ä¸ºæ–°åå­— 3.2.3 ä½¿ç”¨groupdelå‘½ä»¤åˆ é™¤ç”¨æˆ·ç»„ ä½¿ç”¨groupdelå‘½ä»¤å¯ä»¥åˆ é™¤ç”¨æˆ·ç»„ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ groupdel groupname åœ¨åˆ é™¤ç”¨æˆ·ç»„æ—¶ï¼Œè¢«åˆ é™¤çš„ç”¨æˆ·ç»„ä¸èƒ½æ˜¯æŸä¸ªè´¦æˆ·çš„ç§æœ‰ç”¨æˆ·ç»„ï¼Œå¦åˆ™å°†æ— æ³•åˆ é™¤ï¼Œè‹¥è¦åˆ é™¤ï¼Œåˆ™åº”å…ˆåˆ é™¤å¼•ç”¨è¯¥ç§æœ‰ç”¨æˆ·ç»„çš„è´¦æˆ·ï¼Œç„¶åå†åˆ é™¤ç”¨æˆ·ç»„ã€‚ 3.2.4 ä½¿ç”¨gpasswdå‘½ä»¤ç®¡ç†ç”¨æˆ·ç»„ ä¸ºäº†é¿å…ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆrootï¼‰å¤ªå¿™ç¢Œï¼Œæ— æ³•åŠæ—¶ç®¡ç†ç¾¤ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ gpasswd å‘½ä»¤ç»™ç¾¤ç»„è®¾ç½®ä¸€ä¸ªç¾¤ç»„ç®¡ç†å‘˜ï¼Œä»£æ›¿ root å®Œæˆå°†ç”¨æˆ·åŠ å…¥æˆ–ç§»å‡ºç¾¤ç»„çš„æ“ä½œã€‚gpasswdå‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ gpasswd [option] groupname å¯é€‰æ‹©çš„é€‰é¡¹å¦‚ä¸‹ï¼š é€‰é¡¹ åŠŸèƒ½ é€‰é¡¹ä¸ºç©ºæ—¶ï¼Œè¡¨ç¤ºç»™ç¾¤ç»„è®¾ç½®å¯†ç ï¼Œä»… root ç”¨æˆ·å¯ç”¨ã€‚ -A user1,â€¦ å°†ç¾¤ç»„çš„æ§åˆ¶æƒäº¤ç»™ user1,â€¦ ç­‰ç”¨æˆ·ç®¡ç†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè®¾ç½® user1,â€¦ ç­‰ç”¨æˆ·ä¸ºç¾¤ç»„çš„ç®¡ç†å‘˜ï¼Œä»… root ç”¨æˆ·å¯ç”¨ã€‚ -M user1,â€¦ å°† user1,â€¦ åŠ å…¥åˆ°æ­¤ç¾¤ç»„ä¸­ï¼Œä»… root ç”¨æˆ·å¯ç”¨ã€‚ -r ç§»é™¤ç¾¤ç»„çš„å¯†ç ï¼Œä»… root ç”¨æˆ·å¯ç”¨ã€‚ -R è®©ç¾¤ç»„çš„å¯†ç å¤±æ•ˆï¼Œä»… root ç”¨æˆ·å¯ç”¨ã€‚ -a user å°† user ç”¨æˆ·åŠ å…¥åˆ°ç¾¤ç»„ä¸­ã€‚ -d user å°† user ç”¨æˆ·ä»ç¾¤ç»„ä¸­ç§»é™¤ã€‚ å®ä¾‹å¦‚ä¸‹ã€‚ 3.2.5 ä½¿ç”¨newgrpå‘½ä»¤åˆ‡æ¢ç”¨æˆ·çš„æœ‰æ•ˆç»„ æˆ‘ä»¬çŸ¥é“ï¼Œæ¯ä¸ªç”¨æˆ·å¯ä»¥å±äºä¸€ä¸ªåˆå§‹ç»„ï¼ˆç”¨æˆ·æ˜¯è¿™ä¸ªç»„çš„åˆå§‹ç”¨æˆ·ï¼‰ï¼Œä¹Ÿå¯ä»¥å±äºå¤šä¸ªé™„åŠ ç»„ï¼ˆç”¨æˆ·æ˜¯è¿™ä¸ªç»„çš„é™„åŠ ç”¨æˆ·ï¼‰ã€‚æ—¢ç„¶ç”¨æˆ·å¯ä»¥å±äºè¿™ä¹ˆå¤šç”¨æˆ·ç»„ï¼Œé‚£ä¹ˆç”¨æˆ·åœ¨åˆ›å»ºæ–‡ä»¶åï¼Œé»˜è®¤ç”Ÿæ•ˆçš„ç»„èº«ä»½æ˜¯å“ªä¸ªå‘¢ï¼Ÿ å½“ç„¶æ˜¯åˆå§‹ç”¨æˆ·ç»„çš„ç»„èº«ä»½ç”Ÿæ•ˆï¼Œå› ä¸ºåˆå§‹ç»„æ˜¯ç”¨æˆ·ä¸€æ—¦ç™»é™†å°±è·å¾—çš„ç»„èº«ä»½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·çš„æœ‰æ•ˆç»„é»˜è®¤æ˜¯åˆå§‹ç»„ï¼Œå› æ­¤æ‰€åˆ›å»ºæ–‡ä»¶çš„å±ç»„æ˜¯ç”¨æˆ·çš„åˆå§‹ç»„ã€‚é‚£ä¹ˆï¼Œæ—¢ç„¶ç”¨æˆ·å±äºå¤šä¸ªç”¨æˆ·ç»„ï¼Œèƒ½ä¸èƒ½æ”¹å˜ç”¨æˆ·çš„åˆå§‹ç»„å‘¢ï¼Ÿä½¿ç”¨å‘½ä»¤ newgrp å°±å¯ä»¥ã€‚æ­¤å‘½ä»¤åŸºæœ¬æ ¼å¼å¦‚ä¸‹ã€‚ newgrp groupname newgrp å‘½ä»¤å¯ä»¥ä»ç”¨æˆ·çš„é™„åŠ ç»„ä¸­é€‰æ‹©ä¸€ä¸ªç¾¤ç»„ï¼Œä½œä¸ºç”¨æˆ·æ–°çš„åˆå§‹ç»„ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:3:2","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å…¶ä»–ç›¸å…³å‘½ä»¤ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:4:0","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.1 idå‘½ä»¤æŸ¥çœ‹ç”¨æˆ·çš„UIDå’ŒGID id å‘½ä»¤å¯ä»¥æŸ¥è¯¢ç”¨æˆ·çš„UIDã€GID å’Œé™„åŠ ç»„çš„ä¿¡æ¯ã€‚å‘½ä»¤æ¯”è¾ƒç®€å•ï¼Œæ ¼å¼å¦‚ä¸‹ã€‚ id username å®ä¾‹å¦‚ä¸‹ï¼š ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:4:1","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.2 suå‘½ä»¤ä¸´æ—¶åˆ‡æ¢ç”¨æˆ·èº«ä»½ su æ˜¯æœ€ç®€å•çš„ç”¨æˆ·åˆ‡æ¢å‘½ä»¤ï¼Œé€šè¿‡è¯¥å‘½ä»¤å¯ä»¥å®ç°ä»»ä½•èº«ä»½çš„åˆ‡æ¢ï¼ŒåŒ…æ‹¬ä»æ™®é€šç”¨æˆ·åˆ‡æ¢ä¸º root ç”¨æˆ·ã€ä» root ç”¨æˆ·åˆ‡æ¢ä¸ºæ™®é€šç”¨æˆ·ä»¥åŠæ™®é€šç”¨æˆ·ä¹‹é—´çš„åˆ‡æ¢ã€‚ æ™®é€šç”¨æˆ·ä¹‹é—´åˆ‡æ¢ä»¥åŠæ™®é€šç”¨æˆ·åˆ‡æ¢è‡³ root ç”¨æˆ·ï¼Œéƒ½éœ€è¦çŸ¥æ™“å¯¹æ–¹çš„å¯†ç ï¼Œåªæœ‰æ­£ç¡®è¾“å…¥å¯†ç ï¼Œæ‰èƒ½å®ç°åˆ‡æ¢ï¼›ä» root ç”¨æˆ·åˆ‡æ¢è‡³å…¶ä»–ç”¨æˆ·ï¼Œæ— éœ€çŸ¥æ™“å¯¹æ–¹å¯†ç ï¼Œç›´æ¥å¯åˆ‡æ¢æˆåŠŸã€‚ suå‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ su [option] username å¯ä½¿ç”¨çš„é€‰é¡¹å¦‚ä¸‹ï¼š -læˆ–-ï¼šå¸¦è¿™ä¸ªå‚æ•°å°±å¥½åƒæ˜¯é‡æ–° login ä¸ºè¯¥ä½¿ç”¨è€…ä¸€æ ·ï¼Œå¤§éƒ¨ä»½ç¯å¢ƒå‚æ•°éƒ½æ˜¯ä»¥è¯¥ä½¿ç”¨è€…ä¸ºä¸»ï¼Œå¹¶ä¸”å·¥ä½œç›®å½•ä¹Ÿä¼šæ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®š USER ï¼Œå†…å®šæ˜¯ rootã€‚ -c \u003ccommand\u003e ï¼šä»…åˆ‡æ¢ç”¨æˆ·æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ï¼Œæ‰§è¡Œåè‡ªåŠ¨åˆ‡æ¢å›æ¥ï¼Œè¯¥é€‰é¡¹åé€šå¸¸ä¼šå¸¦æœ‰è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚ -s \u003cshell\u003eï¼š æŒ‡å®šè¦æ‰§è¡Œçš„ shell ï¼ˆbash csh tcsh ç­‰ï¼‰ï¼Œé¢„è®¾å€¼ä¸º /etc/passwd å†…çš„è¯¥ä½¿ç”¨è€…shell -hï¼šæ˜¾ç¤ºè¯´æ˜æ–‡ä»¶ã€‚ -Vï¼šæ˜¾ç¤ºç‰ˆæœ¬èµ„è®¯ã€‚ -mæˆ–-pï¼šæ‰§è¡Œsuæ—¶ä¸æ”¹å˜å·¥ä½œç¯å¢ƒã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:4:2","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.3 whoamiå’Œwho am iå‘½ä»¤ whoami å‘½ä»¤å’Œ who am i å‘½ä»¤æ˜¯ä¸åŒçš„ 2 ä¸ªå‘½ä»¤ï¼Œå‰è€…ç”¨æ¥æ‰“å°å½“å‰æ‰§è¡Œæ“ä½œçš„ç”¨æˆ·åï¼Œåè€…åˆ™ç”¨æ¥æ‰“å°ç™»é™†å½“å‰ Linux ç³»ç»Ÿçš„ç”¨æˆ·åã€‚ æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ“ä½œå®ä¾‹æ¥æ„Ÿå—åŒºåˆ«ï¼š åœ¨æœªåˆ‡æ¢ç”¨æˆ·èº«ä»½ä¹‹å‰ï¼Œwhoami å’Œ who am i å‘½ä»¤çš„è¾“å‡ºæ˜¯ä¸€æ ·çš„ï¼Œä½†ä½¿ç”¨ su å‘½ä»¤åˆ‡æ¢ç”¨æˆ·èº«ä»½åï¼Œä½¿ç”¨ whoami å‘½ä»¤æ‰“å°çš„æ˜¯åˆ‡æ¢åçš„ç”¨æˆ·åï¼Œè€Œ who am i å‘½ä»¤æ‰“å°çš„ä»æ—§æ˜¯ç™»é™†ç³»ç»Ÿæ—¶æ‰€ç”¨çš„ç”¨æˆ·åã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:4:3","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4.4 userså’Œgroupså‘½ä»¤ userså‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ users [option] å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œåˆ™æ˜¾ç¤ºå½“å‰ç™»å½•ç³»ç»Ÿçš„æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åˆ—è¡¨ã€‚æ¯ä¸ªæ˜¾ç¤ºçš„ç”¨æˆ·åå¯¹åº”ä¸€ä¸ªç™»å½•ä¼šè¯ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·æœ‰ä¸æ­¢ä¸€ä¸ªç™»å½•ä¼šè¯ï¼Œé‚£ä»–çš„ç”¨æˆ·åå°†æ˜¾ç¤ºç›¸åŒçš„æ¬¡æ•°ã€‚ --helpï¼šæ˜¾ç¤ºå‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ã€‚ --versionï¼šæ˜¾ç¤ºå‘½ä»¤çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚ groupså‘½ä»¤æ ¼å¼å¦‚ä¸‹ã€‚ groups [option] [groupname] å¦‚æœæ²¡æœ‰å‚æ•°ï¼ŒæŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·çš„ç»„å†…æˆå‘˜ã€‚å¦‚æœæŒ‡å®šäº†groupnameï¼Œåˆ™æ˜¾ç¤ºè¯¥groupçš„æˆå‘˜ã€‚ --helpï¼šæ˜¾ç¤ºå‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ã€‚ --versionï¼šæ˜¾ç¤ºå‘½ä»¤çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:4:4","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5 é«˜çº§æ“ä½œç¤ºä¾‹ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:5:0","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.1 é€šè¿‡æ›´æ”¹ç”¨æˆ·å’Œç»„çš„é…ç½®æ–‡ä»¶ï¼Œç›´æ¥æ·»åŠ æˆ–ä¿®æ”¹ç”¨æˆ·å’Œç»„ ä¸ºäº†æ›´æ·±å…¥äº†è§£ç”¨æˆ·å’Œç»„çš„ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥æ‰‹åŠ¨æ›´æ”¹é…ç½®æ–‡ä»¶ä»¥è¾¾åˆ°å‘½ä»¤çš„æ‰§è¡Œæ•ˆæœã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£Linuxä¸­çš„/etc/skelç›®å½•ã€‚skelæ˜¯skeletonçš„ç¼©å†™ï¼Œæ„ä¸ºéª¨éª¼ã€æ¡†æ¶ã€‚æ•…æ­¤ç›®å½•çš„ä½œç”¨æ˜¯åœ¨å»ºç«‹æ–°ç”¨æˆ·æ—¶ï¼Œç”¨äºåˆå§‹åŒ–ç”¨æˆ·æ ¹ç›®å½•ã€‚ç³»ç»Ÿä¼šå°†æ­¤ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€ç›®å½•éƒ½å¤åˆ¶åˆ°æ–°å»ºç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œå¹¶ä¸”å°†ç”¨æˆ·å±ä¸»ä¸ç”¨æˆ·ç»„è°ƒæ•´ä¸ºä¸æ­¤ä¸»ç›®å½•ç›¸åŒã€‚æ‰€ä»¥å¯å°†ç”¨æˆ·é…ç½®æ–‡ä»¶é¢„ç½®åˆ°/etc/skelç›®å½•ä¸‹ï¼Œæ¯”å¦‚è¯´.bashrcã€.profileä¸.vimrcç­‰ã€‚ æ³¨æ„ï¼š å¦‚æœåœ¨æ–°å»ºç”¨æˆ·æ—¶ï¼Œæ²¡æœ‰è‡ªåŠ¨å»ºç«‹ç”¨æˆ·æ ¹ç›®å½•ï¼Œåˆ™æ— æ³•è°ƒç”¨åˆ°æ­¤æ¡†æ¶ç›®å½•ã€‚ å¦‚æœä¸æƒ³ä»¥é»˜è®¤çš„/etc/skelç›®å½•ä½œä¸ºæ¡†æ¶ç›®å½•ï¼Œå¯ä»¥åœ¨è¿è¡Œuseraddå‘½ä»¤æ—¶ä½¿ç”¨-kæŒ‡å®šæ–°çš„æ¡†æ¶ç›®å½•ã€‚ å¦‚æœä¸æƒ³åœ¨æ¯æ¬¡æ–°å»ºç”¨æˆ·æ—¶ï¼Œéƒ½é‡æ–°æŒ‡å®šæ–°çš„æ¡†æ¶ç›®å½•ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹/etc/default/useraddé…ç½®æ–‡ä»¶æ¥æ”¹å˜é»˜è®¤çš„æ¡†æ¶ç›®å½•ã€‚ä¿®æ”¹SKELå˜é‡çš„å€¼å³å¯ã€‚åŸæ¥ä¸ºSKEL=/etc/skelã€‚ å®é™…æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š ç¼–è¾‘/etc/groupæ–‡ä»¶ï¼Œæ·»åŠ ç»„testï¼Œå…¶ä¸­GIDä¸º1500ã€‚ echo 'test:x:1500' \u003e\u003e /etc/group åˆ›å»ºç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ æˆ‘ä»¬éœ€è¦å°†æ¡†æ¶ç›®å½•ä¸­çš„æ–‡ä»¶æ”¾åˆ°ä¸»ç›®å½•ä¸­ã€‚åŒæ—¶è¿˜éœ€è¦ä¿®æ”¹å¥½ä¸»ç›®å½•å¯¹å…¶ä»–ç”¨æˆ·éƒ½æ²¡æœ‰ä»»ä½•è®¿é—®æƒé™ã€‚ ç¼–è¾‘/etc/passwdæ–‡ä»¶ï¼Œæ·»åŠ ç”¨æˆ·testï¼ŒUIDä¸º1500ï¼Œå…¶ä¸­åŸºæœ¬ç»„IDä¸ºtestç»„çš„GIDï¼Œå…¶å®¶ç›®å½•ä¸º/home/testã€‚ echo 'test:x:1500:1500::/home/test:/bin/bash' \u003e\u003e /etc/passwd ä¿®æ”¹/home/testç›®å½•åŠå…¶å†…éƒ¨æ‰€æœ‰æ–‡ä»¶çš„å±ä¸»ä¸ºtestï¼Œå±ç»„ä¸ºtestã€‚ ä¿®æ”¹testç”¨æˆ·çš„å¯†ç å¹¶å°è¯•ç™»å½•ã€‚ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:5:1","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"5.2 Linuxæ‰¹é‡æ·»åŠ ç”¨æˆ· æˆ‘ä»¬å¯ä»¥ä½¿ç”¨useradd+passwdå‘½ä»¤é…åˆshellè„šæœ¬æ¥å®ç°è¯¥åŠŸèƒ½ã€‚ é¦–å…ˆæˆ‘ä»¬å°†éœ€è¦åˆ›å»ºçš„ç”¨æˆ·åå†™å…¥ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­æ¯è¡Œä»£è¡¨ä¸€ä¸ªç”¨æˆ·åï¼š ç„¶åå®é™…ä¸Šæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯æå–å‡ºæ–‡ä»¶ä¸­çš„ç”¨æˆ·åç„¶åè‡ªåŠ¨æ‰§è¡Œuseraddå‘½ä»¤ï¼Œå†æ‰§è¡Œpasswdè‡ªåŠ¨å¡«å…¥åˆå§‹å¯†ç ã€‚ç¼–å†™çš„shellè„šæœ¬æ–‡ä»¶å¦‚ä¸‹ï¼š #! /bin/bash for username in $(more username.txt) do if [ -n $username ] then useradd -m $username # æ‰§è¡Œuseraddå‘½ä»¤ echo $username\"123456\" | passwd --stdin $username echo \"User $username's password is changed!\" else echo \"The username is null!\" fi done æµ‹è¯•ç™»å½•ï¼Œç™»å½•æˆåŠŸï¼ ","date":"2022-05-24","objectID":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/:5:2","tags":["Linux"],"title":"Linuxç”¨æˆ·å’Œç”¨æˆ·ç»„æ•™ç¨‹","uri":"/posts/03.linux%E7%94%A8%E6%88%B7%E5%92%8C%E7%94%A8%E6%88%B7%E7%BB%84%E6%95%99%E7%A8%8B/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 ç­–ç•¥æ¨¡å¼ä»‹ç» åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå®ç°æŸä¸ªç›®æ ‡çš„é€”å¾„ä¸æ­¢ä¸€æ¡ï¼Œä¾‹å¦‚åœ¨å¤–å‡ºæ—…æ¸¸æ—¶æ¸¸å®¢å¯ä»¥é€‰æ‹©å¤šç§ä¸åŒçš„å‡ºè¡Œæ–¹å¼ï¼Œå¯æ ¹æ®å®é™…æƒ…å†µæ¥ç¡®å®šæœ€é€‚åˆçš„å‡ºè¡Œæ–¹å¼ã€‚ åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œä¹Ÿå¸¸å¸¸ä¼šé‡åˆ°ç±»ä¼¼çš„æƒ…å†µï¼Œå®ç°æŸä¸ªåŠŸèƒ½æœ‰å¤šç§ç®—æ³•ï¼Œä¸€ç§å¸¸ç”¨çš„æ–¹æ³•æ˜¯é€šè¿‡ç¡¬ç¼–ç å°†æ‰€æœ‰çš„ç®—æ³•é›†ä¸­åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œåœ¨è¯¥ç±»ä¸­æä¾›å¤šä¸ªæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•å¯¹åº”ä¸€ä¸ªç®—æ³•ï¼›å½“ç„¶ä¹Ÿå¯ä»¥å°†è¿™äº›ç®—æ³•å°è£…åœ¨ä¸€ä¸ªç»Ÿä¸€çš„æ–¹æ³•ä¸­ï¼Œé€šè¿‡ifâ€¦elseâ€¦ç­‰æ¡ä»¶åˆ¤æ–­é€‰æ‹©ã€‚è¿™ä¸¤ç§å®ç°æ–¹æ³•éƒ½å¯ä»¥ç§°ä¸ºç¡¬ç¼–ç ã€‚ä½†è¿™æ ·çš„æ–¹å¼å°è£…äº†å¤§é‡çš„ç®—æ³•ï¼Œä»£ç éå¸¸å¤æ‚ï¼Œç»´æŠ¤ä¹Ÿå¾ˆå›°éš¾ã€‚ ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰å®šä¹‰ä¸€äº›ç‹¬ç«‹çš„ç±»æ¥å°è£…ä¸åŒçš„ç®—æ³•ï¼Œæ¯ä¸€ä¸ªç±»å°è£…ä¸€ç§å…·ä½“çš„ç®—æ³•ï¼Œåœ¨è¿™é‡Œæ¯ä¸€ä¸ªå°è£…ç®—æ³•çš„ç±»éƒ½å¯ä»¥ç§°ä¸ºä¸€ç§ç­–ç•¥ï¼ˆStrategyï¼‰ï¼Œä¸ºäº†ä¿è¯è¿™äº›ç­–ç•¥åœ¨ä½¿ç”¨æ—¶å…·æœ‰ä¸€è‡´æ€§ï¼Œä¸€èˆ¬ä¼šæä¾›ä¸€ä¸ªæŠ½è±¡çš„ç­–ç•¥ç±»æ¥åšç®—æ³•çš„å£°æ˜ï¼Œè€Œæ¯ç§ç®—æ³•å¯¹åº”äºä¸€ä¸ªå…·ä½“ç­–ç•¥ç±»ã€‚ ç­–ç•¥æ¨¡å¼å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼è®©ç®—æ³•å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒä»¬çš„å®¢æˆ·è€Œå˜åŒ–ã€‚å®ƒåˆç§°ä¸ºæ”¿ç­–ï¼ˆPolicyï¼‰æ¨¡å¼ï¼Œæ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚ ","date":"2022-05-01","objectID":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["ç­–ç•¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 ç­–ç•¥æ¨¡å¼è¯¦è§£ ","date":"2022-05-01","objectID":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["ç­–ç•¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 ç­–ç•¥æ¨¡å¼ç»“æ„ å…¶ç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±å›¾å¯çŸ¥ï¼Œç­–ç•¥æ¨¡å¼åŒ…å«ä»¥ä¸‹3ä¸ªè§’è‰²ã€‚ Contextï¼ˆç¯å¢ƒç±»ï¼‰ï¼šç¯å¢ƒç±»æ˜¯ä½¿ç”¨ç®—æ³•çš„è§’è‰²ï¼Œå®ƒåœ¨è§£å†³æŸä¸ªé—®é¢˜æ—¶å¯ä»¥é‡‡ç”¨å¤šç§ç­–ç•¥ã€‚åœ¨ç¯å¢ƒç±»ä¸­ç»´æŒä¸€ä¸ªå¯¹æŠ½è±¡ç­–ç•¥ç±»çš„å¼•ç”¨å®ä¾‹ï¼Œç”¨äºå®šä¹‰æ‰€é‡‡ç”¨çš„ç­–ç•¥ã€‚ Strategyï¼ˆæŠ½è±¡ç­–ç•¥ç±»ï¼‰ï¼šæŠ½è±¡ç­–ç•¥ç±»ä¸ºæ‰€æ”¯æŒçš„ç®—æ³•å£°æ˜äº†æŠ½è±¡æ–¹æ³•ï¼Œæ˜¯æ‰€æœ‰ç­–ç•¥ç±»çš„çˆ¶ç±»ï¼Œå®ƒå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–å…·ä½“ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¥å£ã€‚ç¯å¢ƒç±»é€šè¿‡æŠ½è±¡ç­–ç•¥ç±»ä¸­å£°æ˜çš„æ–¹æ³•åœ¨è¿è¡Œæ—¶è°ƒç”¨å…·ä½“ç­–ç•¥ç±»ä¸­å®ç°çš„ç®—æ³•ã€‚ ConcreteStrategyï¼ˆå…·ä½“ç­–ç•¥ç±»ï¼‰ï¼šå…·ä½“ç­–ç•¥ç±»å®ç°äº†åœ¨æŠ½è±¡ç­–ç•¥ç±»ä¸­å£°æ˜çš„ç®—æ³•ï¼Œåœ¨è¿è¡Œæ—¶å…·ä½“ç­–ç•¥ç±»å°†è¦†ç›–åœ¨ç¯å¢ƒç±»ä¸­å®šä¹‰çš„æŠ½è±¡ç­–ç•¥ç±»å¯¹è±¡ï¼Œä½¿ç”¨ä¸€ç§å…·ä½“çš„ç®—æ³•å®ç°æŸä¸ªä¸šåŠ¡åŠŸèƒ½ã€‚ ","date":"2022-05-01","objectID":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["ç­–ç•¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 ç­–ç•¥æ¨¡å¼å®ç° æŠ½è±¡ç­–ç•¥ç±»å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public abstract class AbstractStrategy { // å£°æ˜æŠ½è±¡ç®—æ³• public abstract void algorithm(); } å…·ä½“ç­–ç•¥ç±»å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class ConcreteStrategyA extends AbstractStrategy { // ç®—æ³•çš„å…·ä½“å®ç° public void algorithm() { // ç®—æ³•A } } ç¯å¢ƒç±»å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class Context { private AbstractStrategy strategy; // ç»´æŒä¸€ä¸ªå¯¹æŠ½è±¡ç­–ç•¥ç±»çš„å¼•ç”¨ public void setStrategy(AbstractStrategy strategy) { this.strategy = strategy; } // è°ƒç”¨ç­–ç•¥ç±»ä¸­çš„ç®—æ³• public void algorithm() { strategy.algorithm(); } } ","date":"2022-05-01","objectID":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["ç­–ç•¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 ç­–ç•¥æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸè½¯ä»¶å…¬å¸ä¸ºæŸç”µå½±é™¢å¼€å‘äº†ä¸€å¥—å½±é™¢å”®ç¥¨ç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸­éœ€è¦ä¸ºä¸åŒç±»å‹çš„ç”¨æˆ·æä¾›ä¸åŒçš„ç”µå½±ç¥¨æ‰“æŠ˜æ–¹å¼ï¼Œå…·ä½“æ‰“æŠ˜æ–¹æ¡ˆå¦‚ä¸‹ï¼š* (1) å­¦ç”Ÿå‡­å­¦ç”Ÿè¯å¯äº«å—ç¥¨ä»·8æŠ˜ä¼˜æƒ ã€‚ (2) å¹´é¾„åœ¨10å‘¨å²åŠä»¥ä¸‹çš„å„¿ç«¥å¯äº«å—æ¯å¼ ç¥¨å‡å…10å…ƒçš„ä¼˜æƒ ï¼ˆåŸå§‹ç¥¨ä»·éœ€å¤§äºç­‰äº20å…ƒï¼‰ã€‚ (3) å½±é™¢VIPç”¨æˆ·é™¤äº«å—ç¥¨ä»·åŠä»·ä¼˜æƒ å¤–è¿˜å¯è¿›è¡Œç§¯åˆ†ï¼Œç§¯åˆ†ç´¯è®¡åˆ°ä¸€å®šé¢åº¦å¯æ¢å–ç”µå½±é™¢èµ é€çš„å¥–å“ã€‚ è¯¥ç³»ç»Ÿåœ¨å°†æ¥å¯èƒ½è¿˜è¦æ ¹æ®éœ€è¦å¼•å…¥æ–°çš„æ‰“æŠ˜æ–¹å¼ã€‚ç°ä½¿ç”¨ç­–ç•¥æ¨¡å¼è®¾è®¡è¯¥å½±é™¢å”®ç¥¨ç³»ç»Ÿçš„æ‰“æŠ˜æ–¹æ¡ˆã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒMovieTicketå……å½“ç¯å¢ƒç±»è§’è‰²ï¼ŒDiscountå……å½“æŠ½è±¡ç­–ç•¥è§’è‰²ï¼ŒStudentDiscountã€ChildrenDiscountå’ŒVIPDiscountå……å½“å…·ä½“ç­–ç•¥è§’è‰²ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-05-01","objectID":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["ç­–ç•¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/13.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä»‹ç» åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼ŒæŸä¸ªæ–¹æ³•çš„å®ç°éœ€è¦å¤šä¸ªæ­¥éª¤ï¼Œå…¶ä¸­æœ‰äº›æ­¥éª¤æ˜¯å›ºå®šçš„ï¼Œè€Œæœ‰äº›æ­¥éª¤å¹¶ä¸å›ºå®šï¼Œå­˜åœ¨å¯å˜æ€§ã€‚ä¸ºäº†æé«˜ä»£ç çš„å¤ç”¨æ€§å’Œç³»ç»Ÿçš„çµæ´»æ€§ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ç§ç§°ä¸ºæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Method Patternï¼‰çš„è®¾è®¡æ¨¡å¼æ¥å¯¹è¿™ç±»æƒ…å†µè¿›è¡Œè®¾è®¡ã€‚åœ¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­å°†å®ç°åŠŸèƒ½çš„æ¯ä¸€ä¸ªæ­¥éª¤æ‰€å¯¹åº”çš„æ–¹æ³•ç§°ä¸ºåŸºæœ¬æ–¹æ³•ï¼Œè€Œå°†è°ƒç”¨è¿™äº›åŸºæœ¬æ–¹æ³•åŒæ—¶å®šä¹‰åŸºæœ¬æ–¹æ³•çš„æ‰§è¡Œæ¬¡åºçš„æ–¹æ³•ç§°ä¸ºæ¨¡æ¿æ–¹æ³•ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­ç®—æ³•çš„æ¡†æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚å®ƒæ˜¯ç»“æ„æœ€ç®€å•çš„è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œåœ¨å…¶ç»“æ„ä¸­åªå­˜åœ¨çˆ¶ç±»ä¸å­ç±»çš„ç»§æ‰¿å…³ç³»ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼å°†ä¸€äº›å¤æ‚æµç¨‹çš„å®ç°æ­¥éª¤å°è£…åœ¨ä¸€ç³»åˆ—åŸºæœ¬æ–¹æ³•ä¸­ï¼Œåœ¨æŠ½è±¡çˆ¶ç±»ä¸­æä¾›ä¸€ä¸ªç§°ä¹‹ä¸ºæ¨¡æ¿æ–¹æ³•çš„æ–¹æ³•æ¥å®šä¹‰è¿™äº›åŸºæœ¬æ–¹æ³•çš„æ‰§è¡Œæ¬¡åºï¼Œè€Œé€šè¿‡å…¶å­ç±»æ¥è¦†ç›–æŸäº›æ­¥éª¤ï¼Œä»è€Œä½¿å¾—ç›¸åŒçš„ç®—æ³•æ¡†æ¶å¯ä»¥æœ‰ä¸åŒçš„æ‰§è¡Œç»“æœã€‚ ä¸»è¦è§£å†³ï¼š ä¸€äº›æ–¹æ³•é€šç”¨ï¼Œå´åœ¨æ¯ä¸€ä¸ªå­ç±»éƒ½é‡æ–°å†™äº†è¿™ä¸€æ–¹æ³•ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š æœ‰ä¸€äº›é€šç”¨çš„æ–¹æ³•ã€‚ å¦‚ä½•è§£å†³ï¼š å°†è¿™äº›é€šç”¨ç®—æ³•æŠ½è±¡å‡ºæ¥ã€‚ å…³é”®ä»£ç ï¼š åœ¨æŠ½è±¡ç±»å®ç°ï¼Œå…¶ä»–æ­¥éª¤åœ¨å­ç±»å®ç°ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€åœ¨é€ æˆ¿å­çš„æ—¶å€™ï¼Œåœ°åŸºã€èµ°çº¿ã€æ°´ç®¡éƒ½ä¸€æ ·ï¼Œåªæœ‰åœ¨å»ºç­‘çš„åæœŸæ‰æœ‰åŠ å£æ©±åŠ æ …æ ç­‰å·®å¼‚ã€‚ 2ã€è¥¿æ¸¸è®°é‡Œé¢è©è¨å®šå¥½çš„ 81 éš¾ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé¡¶å±‚çš„é€»è¾‘éª¨æ¶ã€‚ 3ã€spring ä¸­å¯¹ Hibernate çš„æ”¯æŒï¼Œå°†ä¸€äº›å·²ç»å®šå¥½çš„æ–¹æ³•å°è£…èµ·æ¥ï¼Œæ¯”å¦‚å¼€å¯äº‹åŠ¡ã€è·å– Sessionã€å…³é—­ Session ç­‰ï¼Œç¨‹åºå‘˜ä¸é‡å¤å†™é‚£äº›å·²ç»è§„èŒƒå¥½çš„ä»£ç ï¼Œç›´æ¥ä¸¢ä¸€ä¸ªå®ä½“å°±å¯ä»¥ä¿å­˜ã€‚ ä¼˜ç‚¹ï¼š 1ã€å°è£…ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ã€‚ 2ã€æå–å…¬å…±ä»£ç ï¼Œä¾¿äºç»´æŠ¤ã€‚ 3ã€è¡Œä¸ºç”±çˆ¶ç±»æ§åˆ¶ï¼Œå­ç±»å®ç°ã€‚ ç¼ºç‚¹ï¼š æ¯ä¸€ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦ä¸€ä¸ªå­ç±»æ¥å®ç°ï¼Œå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œä½¿å¾—ç³»ç»Ÿæ›´åŠ åºå¤§ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€æœ‰å¤šä¸ªå­ç±»å…±æœ‰çš„æ–¹æ³•ï¼Œä¸”é€»è¾‘ç›¸åŒã€‚ 2ã€é‡è¦çš„ã€å¤æ‚çš„æ–¹æ³•ï¼Œå¯ä»¥è€ƒè™‘ä½œä¸ºæ¨¡æ¿æ–¹æ³•ã€‚ æ³¨æ„äº‹é¡¹ï¼š ä¸ºé˜²æ­¢æ¶æ„æ“ä½œï¼Œä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Š final å…³é”®è¯ã€‚ ","date":"2022-05-01","objectID":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["æ¨¡æ¿æ–¹æ³•æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¯¦è§£ ","date":"2022-05-01","objectID":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["æ¨¡æ¿æ–¹æ³•æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç»“æ„ æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç»“æ„æ¯”è¾ƒç®€å•ï¼Œå…¶æ ¸å¿ƒæ˜¯æŠ½è±¡ç±»å’Œå…¶ä¸­çš„æ¨¡æ¿æ–¹æ³•è®¾è®¡ï¼Œå…¶ç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªè§’è‰²ã€‚ AbstractClassï¼ˆæŠ½è±¡ç±»ï¼‰ï¼šåœ¨æŠ½è±¡ç±»ä¸­å®šä¹‰äº†ä¸€ç³»åˆ—åŸºæœ¬æ“ä½œï¼ˆPrimitive Operationsï¼‰ï¼Œè¿™äº›åŸºæœ¬æ“ä½œå¯ä»¥æ˜¯å…·ä½“çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡çš„ï¼Œæ¯ä¸€ä¸ªåŸºæœ¬æ“ä½œå¯¹åº”ç®—æ³•çš„ä¸€ä¸ªæ­¥éª¤ï¼Œåœ¨å…¶å­ç±»ä¸­å¯ä»¥é‡å®šä¹‰æˆ–å®ç°è¿™äº›æ­¥éª¤ã€‚åŒæ—¶åœ¨æŠ½è±¡ç±»ä¸­å®ç°äº†ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰ï¼Œç”¨äºå®šä¹‰ä¸€ä¸ªç®—æ³•çš„æ¡†æ¶ï¼Œæ¨¡æ¿æ–¹æ³•ä¸ä»…å¯ä»¥è°ƒç”¨åœ¨æŠ½è±¡ç±»ä¸­å®ç°çš„åŸºæœ¬æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨åœ¨æŠ½è±¡ç±»çš„å­ç±»ä¸­å®ç°çš„åŸºæœ¬æ–¹æ³•ï¼Œè¿˜å¯ä»¥è°ƒç”¨å…¶ä»–å¯¹è±¡ä¸­çš„æ–¹æ³•ã€‚ ConcreteClassï¼ˆå…·ä½“å­ç±»ï¼‰ï¼šå®ƒæ˜¯æŠ½è±¡ç±»çš„å­ç±»ï¼Œç”¨äºå®ç°åœ¨çˆ¶ç±»ä¸­å£°æ˜çš„æŠ½è±¡åŸºæœ¬æ“ä½œä»¥åŠå®Œæˆå­ç±»ç‰¹å®šç®—æ³•çš„æ­¥éª¤ï¼Œä¹Ÿå¯ä»¥è¦†ç›–åœ¨çˆ¶ç±»ä¸­å·²ç»å®ç°çš„å…·ä½“åŸºæœ¬æ“ä½œã€‚ ","date":"2022-05-01","objectID":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["æ¨¡æ¿æ–¹æ³•æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®ç° åœ¨å®ç°æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ—¶ï¼Œå¼€å‘æŠ½è±¡ç±»çš„è½¯ä»¶è®¾è®¡å¸ˆå’Œå¼€å‘å…·ä½“å­ç±»çš„è½¯ä»¶è®¾è®¡å¸ˆä¹‹é—´å¯ä»¥è¿›è¡Œåä½œã€‚ æ¨¡æ¿æ–¹æ³• ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•å°±æ˜¯å°†å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­çš„æŠŠåŸºæœ¬æ“ä½œæ–¹æ³•ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ€»ç®—æ³•æˆ–ä¸€ä¸ªæ€»è¡Œä¸ºçš„æ–¹æ³•ã€‚è¿™ä¸ªæ¨¡æ¿æ–¹æ³•å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­ï¼Œå¹¶ç”±å­ç±»ä¸åŠ ä¿®æ”¹åœ°å®Œå…¨ç»§æ‰¿ä¸‹æ¥ã€‚ç”±äºæ¨¡æ¿æ–¹æ³•æ˜¯å…·ä½“æ–¹æ³•ï¼Œå› æ­¤æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æŠ½è±¡å±‚åªèƒ½æ˜¯æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯æ¥å£ã€‚ åŸºæœ¬æ–¹æ³• åŸºæœ¬æ–¹æ³•æ˜¯å®ç°ç®—æ³•å„ä¸ªæ­¥éª¤çš„æ–¹æ³•ï¼Œæ˜¯æ¨¡æ¿æ–¹æ³•çš„ç»„æˆéƒ¨åˆ†ã€‚åŸºæœ¬æ–¹æ³•åˆå¯ä»¥åˆ†ä¸º3ç§ï¼Œå³æŠ½è±¡æ–¹æ³•ï¼ˆAbstract Methodï¼‰ã€å…·ä½“æ–¹æ³•ï¼ˆConcrete Methodï¼‰å’Œé’©å­æ–¹æ³•ï¼ˆHook Methodï¼‰ã€‚ æŠ½è±¡æ–¹æ³•ï¼šä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜ã€ç”±å…¶å…·ä½“å­ç±»å®ç°ã€‚ å…·ä½“æ–¹æ³•ï¼šä¸€ä¸ªå…·ä½“æ–¹æ³•ç”±ä¸€ä¸ªæŠ½è±¡ç±»æˆ–å…·ä½“ç±»å£°æ˜å¹¶å®ç°ï¼Œå…¶å­ç±»å¯ä»¥è¿›è¡Œè¦†ç›–ä¹Ÿå¯ä»¥ç›´æ¥ç»§æ‰¿ã€‚ é’©å­æ–¹æ³•ï¼šä¸€ä¸ªé’©å­æ–¹æ³•ç”±ä¸€ä¸ªæŠ½è±¡ç±»æˆ–å…·ä½“ç±»å£°æ˜å¹¶å®ç°ï¼Œè€Œå…¶å­ç±»å¯èƒ½ä¼šåŠ ä»¥æ‰©å±•ã€‚é€šå¸¸åœ¨çˆ¶ç±»ä¸­ç»™å‡ºçš„å®ç°æ˜¯ä¸€ä¸ªç©ºå®ç°ï¼Œå¹¶ä»¥è¯¥ç©ºå®ç°ä½œä¸ºæ–¹æ³•çš„é»˜è®¤å®ç°ã€‚å½“ç„¶ï¼Œé’©å­æ–¹æ³•ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªéç©ºçš„é»˜è®¤å®ç°ã€‚ æŠ½è±¡ç±»çš„å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public abstract class AbstractClass { //æ¨¡æ¿æ–¹æ³• public void templateMethod() { primitiveOperation1(); primitiveOperation2(); primitiveOperation3(); } //åŸºæœ¬æ–¹æ³•â€”å…·ä½“æ–¹æ³• public void primitiveOperation1() { //å®ç°ä»£ç  } //åŸºæœ¬æ–¹æ³•â€”æŠ½è±¡æ–¹æ³• public abstract void primitiveOperation2(); //åŸºæœ¬æ–¹æ³•â€”é’©å­æ–¹æ³• public void primitiveOperation3() { } } å…·ä½“å­ç±»çš„å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class ConcreteClass extends AbstractClass { public void primitiveOperation2() { //å®ç°ä»£ç  } public void primitiveOperation3() { //å®ç°ä»£ç  } } ","date":"2022-05-01","objectID":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["æ¨¡æ¿æ–¹æ³•æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 æ¨¡æ¿æ–¹æ³•æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸè½¯ä»¶å…¬å¸è¦ä¸ºæŸé“¶è¡Œçš„ä¸šåŠ¡æ”¯æ’‘ç³»ç»Ÿå¼€å‘ä¸€ä¸ªåˆ©æ¯è®¡ç®—æ¨¡å—ï¼Œåˆ©æ¯çš„è®¡ç®—æµç¨‹å¦‚ä¸‹ï¼š (1) ç³»ç»Ÿæ ¹æ®è´¦å·å’Œå¯†ç éªŒè¯ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœç”¨æˆ·ä¿¡æ¯é”™è¯¯ï¼Œåˆ™ç³»ç»Ÿæ˜¾ç¤ºå‡ºé”™æç¤ºã€‚ (2) å¦‚æœç”¨æˆ·ä¿¡æ¯æ­£ç¡®ï¼Œåˆ™æ ¹æ®ç”¨æˆ·ç±»å‹çš„ä¸åŒä½¿ç”¨ä¸åŒçš„åˆ©æ¯è®¡ç®—å…¬å¼è®¡ç®—åˆ©æ¯ï¼ˆå¦‚æ´»æœŸè´¦æˆ·å’Œå®šæœŸè´¦æˆ·å…·æœ‰ä¸åŒçš„åˆ©æ¯è®¡ç®—å…¬å¼ï¼‰ã€‚ (3) ç³»ç»Ÿæ˜¾ç¤ºåˆ©æ¯ã€‚ ç°ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼è®¾è®¡è¯¥åˆ©æ¯è®¡ç®—æ¨¡å—ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒAccountå……å½“æŠ½è±¡ç±»è§’è‰²ï¼ŒCurrentAccountå’ŒSavingAccountå……å½“å…·ä½“å­ç±»è§’è‰²ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-05-01","objectID":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["æ¨¡æ¿æ–¹æ³•æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/14.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 è§‚å¯Ÿè€…æ¨¡å¼ä»‹ç» â€œçº¢ç¯åœï¼Œç»¿ç¯è¡Œâ€ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œäº¤é€šä¿¡å·ç¯æ˜¯æ±½è½¦çš„è§‚å¯Ÿç›®æ ‡ï¼Œè€Œæ±½è½¦åˆ™æ˜¯è§‚å¯Ÿè€…ã€‚éšç€äº¤é€šä¿¡å·ç¯çš„å˜åŒ–ï¼Œæ±½è½¦çš„è¡Œä¸ºä¹Ÿéšä¹‹å˜åŒ–ï¼Œä¸€ç›äº¤é€šä¿¡å·ç¯å¯ä»¥æŒ‡æŒ¥å¤šè¾†æ±½è½¦ã€‚ åœ¨è½¯ä»¶ç³»ç»Ÿä¸­æœ‰äº›å¯¹è±¡ä¹‹é—´ä¹Ÿå­˜åœ¨ç±»ä¼¼äº¤é€šä¿¡å·ç¯å’Œæ±½è½¦ä¹‹é—´çš„å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€æˆ–è¡Œä¸ºçš„å˜åŒ–å°†å¯¼è‡´å…¶ä»–å¯¹è±¡çš„çŠ¶æ€æˆ–è¡Œä¸ºä¹Ÿå‘ç”Ÿæ”¹å˜ã€‚è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰åˆ™æ˜¯ç”¨äºå»ºç«‹ä¸€ç§å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶å…¶ç›¸å…³ä¾èµ–å¯¹è±¡çš†å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚å‘ç”Ÿæ”¹å˜çš„å¯¹è±¡ç§°ä¸ºè§‚å¯Ÿç›®æ ‡ï¼Œè¢«é€šçŸ¥çš„å¯¹è±¡ç§°ä¸ºè§‚å¯Ÿè€…ï¼Œä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯ä»¥å¯¹åº”å¤šä¸ªè§‚å¯Ÿè€…ã€‚å®ƒæœ‰å¦‚ä¸‹åˆ«åï¼š å‘å¸ƒ-è®¢é˜…(Publish/Subscribe)æ¨¡å¼ æ¨¡å‹-è§†å›¾(Model/View)æ¨¡å¼ æº-ç›‘å¬å™¨(Source/Listener)æ¨¡å¼ ä»å±è€…(Dependents)æ¨¡å¼ ä¸»è¦è§£å†³ï¼š ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜ç»™å…¶ä»–å¯¹è±¡é€šçŸ¥çš„é—®é¢˜ï¼Œè€Œä¸”è¦è€ƒè™‘åˆ°æ˜“ç”¨å’Œä½è€¦åˆï¼Œä¿è¯é«˜åº¦çš„åä½œã€‚ ä½•æ—¶ä½¿ç”¨ï¼š ä¸€ä¸ªå¯¹è±¡ï¼ˆç›®æ ‡å¯¹è±¡ï¼‰çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œæ‰€æœ‰çš„ä¾èµ–å¯¹è±¡ï¼ˆè§‚å¯Ÿè€…å¯¹è±¡ï¼‰éƒ½å°†å¾—åˆ°é€šçŸ¥ï¼Œè¿›è¡Œå¹¿æ’­é€šçŸ¥ã€‚ å¦‚ä½•è§£å†³ï¼š ä½¿ç”¨é¢å‘å¯¹è±¡æŠ€æœ¯ï¼Œå¯ä»¥å°†è¿™ç§ä¾èµ–å…³ç³»å¼±åŒ–ã€‚ å…³é”®ä»£ç ï¼š åœ¨æŠ½è±¡ç±»é‡Œæœ‰ä¸€ä¸ª ArrayList å­˜æ”¾è§‚å¯Ÿè€…ä»¬ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€æ‹å–çš„æ—¶å€™ï¼Œæ‹å–å¸ˆè§‚å¯Ÿæœ€é«˜æ ‡ä»·ï¼Œç„¶åé€šçŸ¥ç»™å…¶ä»–ç«ä»·è€…ç«ä»·ã€‚ 2ã€è¥¿æ¸¸è®°é‡Œé¢æ‚Ÿç©ºè¯·æ±‚è©è¨é™æœçº¢å­©å„¿ï¼Œè©è¨æ´’äº†ä¸€åœ°æ°´æ‹›æ¥ä¸€ä¸ªè€ä¹Œé¾Ÿï¼Œè¿™ä¸ªä¹Œé¾Ÿå°±æ˜¯è§‚å¯Ÿè€…ï¼Œä»–è§‚å¯Ÿè©è¨æ´’æ°´è¿™ä¸ªåŠ¨ä½œã€‚ ä¼˜ç‚¹ï¼š 1ã€è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…æ˜¯æŠ½è±¡è€¦åˆçš„ã€‚ 2ã€å»ºç«‹ä¸€å¥—è§¦å‘æœºåˆ¶ã€‚ ç¼ºç‚¹ï¼š 1ã€å¦‚æœä¸€ä¸ªè¢«è§‚å¯Ÿè€…å¯¹è±¡æœ‰å¾ˆå¤šçš„ç›´æ¥å’Œé—´æ¥çš„è§‚å¯Ÿè€…çš„è¯ï¼Œå°†æ‰€æœ‰çš„è§‚å¯Ÿè€…éƒ½é€šçŸ¥åˆ°ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚ 2ã€å¦‚æœåœ¨è§‚å¯Ÿè€…å’Œè§‚å¯Ÿç›®æ ‡ä¹‹é—´æœ‰å¾ªç¯ä¾èµ–çš„è¯ï¼Œè§‚å¯Ÿç›®æ ‡ä¼šè§¦å‘å®ƒä»¬ä¹‹é—´è¿›è¡Œå¾ªç¯è°ƒç”¨ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚ 3ã€è§‚å¯Ÿè€…æ¨¡å¼æ²¡æœ‰ç›¸åº”çš„æœºåˆ¶è®©è§‚å¯Ÿè€…çŸ¥é“æ‰€è§‚å¯Ÿçš„ç›®æ ‡å¯¹è±¡æ˜¯æ€ä¹ˆå‘ç”Ÿå˜åŒ–çš„ï¼Œè€Œä»…ä»…åªæ˜¯çŸ¥é“è§‚å¯Ÿç›®æ ‡å‘ç”Ÿäº†å˜åŒ–ã€‚ ä½¿ç”¨åœºæ™¯ï¼š ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€ä¸ªæ–¹é¢ã€‚å°†è¿™äº›æ–¹é¢å°è£…åœ¨ç‹¬ç«‹çš„å¯¹è±¡ä¸­ä½¿å®ƒä»¬å¯ä»¥å„è‡ªç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨ã€‚ ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜å°†å¯¼è‡´å…¶ä»–ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ä¹Ÿå‘ç”Ÿæ”¹å˜ï¼Œè€Œä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡å°†å‘ç”Ÿæ”¹å˜ï¼Œå¯ä»¥é™ä½å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦ã€‚ ä¸€ä¸ªå¯¹è±¡å¿…é¡»é€šçŸ¥å…¶ä»–å¯¹è±¡ï¼Œè€Œå¹¶ä¸çŸ¥é“è¿™äº›å¯¹è±¡æ˜¯è°ã€‚ éœ€è¦åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªè§¦å‘é“¾ï¼ŒAå¯¹è±¡çš„è¡Œä¸ºå°†å½±å“Bå¯¹è±¡ï¼ŒBå¯¹è±¡çš„è¡Œä¸ºå°†å½±å“Cå¯¹è±¡â€¦â€¦ï¼Œå¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼åˆ›å»ºä¸€ç§é“¾å¼è§¦å‘æœºåˆ¶ã€‚ æ³¨æ„äº‹é¡¹ï¼š 1ã€JAVA ä¸­å·²ç»æœ‰äº†å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒç±»ã€‚ 2ã€é¿å…å¾ªç¯å¼•ç”¨ã€‚ 3ã€å¦‚æœé¡ºåºæ‰§è¡Œï¼ŒæŸä¸€è§‚å¯Ÿè€…é”™è¯¯ä¼šå¯¼è‡´ç³»ç»Ÿå¡å£³ï¼Œä¸€èˆ¬é‡‡ç”¨å¼‚æ­¥æ–¹å¼ã€‚ ","date":"2022-05-01","objectID":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["è§‚å¯Ÿè€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£ ","date":"2022-05-01","objectID":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["è§‚å¯Ÿè€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 è§‚å¯Ÿè€…æ¨¡å¼ç»“æ„ è§‚å¯Ÿè€…æ¨¡å¼ç»“æ„ä¸­é€šå¸¸åŒ…æ‹¬è§‚å¯Ÿç›®æ ‡å’Œè§‚å¯Ÿè€…ä¸¤ä¸ªç»§æ‰¿å±‚æ¬¡ç»“æ„ï¼Œå…¶ç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±å›¾å¯çŸ¥ï¼Œè§‚å¯Ÿè€…æ¨¡å¼åŒ…å«ä»¥ä¸‹4ä¸ªè§’è‰²ã€‚ Subjectï¼ˆç›®æ ‡ï¼‰ï¼šç›®æ ‡åˆç§°ä¸ºä¸»é¢˜ï¼Œå®ƒæ˜¯æŒ‡è¢«è§‚å¯Ÿçš„å¯¹è±¡ã€‚åœ¨ç›®æ ‡ä¸­å®šä¹‰äº†ä¸€ä¸ªè§‚å¯Ÿè€…é›†åˆï¼Œä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„è§‚å¯Ÿè€…æ¥è§‚å¯Ÿï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ï¼ŒåŒæ—¶å®ƒå®šä¹‰äº†é€šçŸ¥æ–¹æ³•notify()ã€‚ç›®æ ‡ç±»å¯ä»¥æ˜¯æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–å…·ä½“ç±»ã€‚ ConcreteSubjectï¼ˆå…·ä½“ç›®æ ‡ï¼‰ï¼šå…·ä½“ç›®æ ‡æ˜¯ç›®æ ‡ç±»çš„å­ç±»ï¼Œå®ƒé€šå¸¸åŒ…å«æœ‰ç»å¸¸å‘ç”Ÿæ”¹å˜çš„æ•°æ®ï¼Œå½“å®ƒçš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶å®ƒå‘å„ä¸ªè§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ï¼›åŒæ—¶å®ƒè¿˜å®ç°äº†åœ¨ç›®æ ‡ç±»ä¸­å®šä¹‰çš„æŠ½è±¡ä¸šåŠ¡é€»è¾‘æ–¹æ³•ã€‚å¦‚æœæ— é¡»æ‰©å±•ç›®æ ‡ç±»ï¼Œå…·ä½“ç›®æ ‡ç±»å¯ä»¥çœç•¥ã€‚ Observerï¼ˆè§‚å¯Ÿè€…ï¼‰ï¼šè§‚å¯Ÿè€…å°†å¯¹è§‚å¯Ÿç›®æ ‡çš„æ”¹å˜åšå‡ºåæ˜ ï¼Œè§‚å¯Ÿè€…ä¸€èˆ¬å®šä¹‰ä¸ºæ¥å£ï¼Œè¯¥æ¥å£å£°æ˜äº†æ›´æ–°æ•°æ®çš„æ–¹æ³•update()ï¼Œå› æ­¤åˆç§°ä¸ºæŠ½è±¡è§‚å¯Ÿè€…ã€‚ ConcreteObserverï¼ˆå…·ä½“è§‚å¯Ÿè€…ï¼‰ï¼šåœ¨å…·ä½“è§‚å¯Ÿè€…ä¸­ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å…·ä½“ç›®æ ‡å¯¹è±¡çš„å¼•ç”¨ï¼Œå®ƒå­˜å‚¨å…·ä½“è§‚å¯Ÿè€…çš„æœ‰å…³çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€éœ€è¦å’Œå…·ä½“ç›®æ ‡çš„çŠ¶æ€ä¿æŒä¸€è‡´ï¼›å®ƒå®ç°äº†åœ¨æŠ½è±¡è§‚å¯Ÿè€…Observerä¸­å®šä¹‰çš„update()æ–¹æ³•ã€‚é€šå¸¸åœ¨å®ç°æ—¶å¯ä»¥è°ƒç”¨å…·ä½“ç›®æ ‡ç±»çš„attach()æ–¹æ³•å°†è‡ªå·±æ·»åŠ åˆ°ç›®æ ‡ç±»çš„é›†åˆä¸­æˆ–è€…é€šè¿‡detach()æ–¹æ³•å°†è‡ªå·±ä»ç›®æ ‡ç±»çš„é›†åˆä¸­åˆ é™¤ã€‚ ","date":"2022-05-01","objectID":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["è§‚å¯Ÿè€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 è§‚å¯Ÿè€…æ¨¡å¼å®ç° æŠ½è±¡ç›®æ ‡ç±»å…¸å‹ä»£ç å¦‚ä¸‹ï¼š import java.util.List; import java.util.ArrayList; public abstract class Subject { //å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…é›†åˆç”¨äºå­˜å‚¨æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ protected List\u003cObserver\u003e observers = new ArrayList(); //æ³¨å†Œæ–¹æ³•ï¼Œç”¨äºå‘è§‚å¯Ÿè€…é›†åˆä¸­å¢åŠ ä¸€ä¸ªè§‚å¯Ÿè€… public void attach(Observer observer) { observers.add(observer); } //æ³¨é”€æ–¹æ³•ï¼Œç”¨äºåœ¨è§‚å¯Ÿè€…é›†åˆä¸­åˆ é™¤ä¸€ä¸ªè§‚å¯Ÿè€… public void detach(Observer observer) { observers.remove(observer); } //å£°æ˜æŠ½è±¡é€šçŸ¥æ–¹æ³• public abstract void notify(); } å…·ä½“ç›®æ ‡ç±»å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class ConcreteSubject extends Subject { //å®ç°é€šçŸ¥æ–¹æ³• public void notify() { //éå†è§‚å¯Ÿè€…é›†åˆï¼Œè°ƒç”¨æ¯ä¸€ä¸ªè§‚å¯Ÿè€…çš„å“åº”æ–¹æ³• for(Observer obs:observers) { obs.update(); } } } æŠ½è±¡è§‚å¯Ÿè€…å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public interface Observer { //å£°æ˜å“åº”æ–¹æ³• public void update(); } å…·ä½“è§‚å¯Ÿè€…å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class ConcreteObserver implements Observer { //å®ç°å“åº”æ–¹æ³• public void update() { //å…·ä½“å“åº”ä»£ç  } } æœ‰æ—¶å€™åœ¨å…·ä½“è§‚å¯Ÿè€…ç±»ConcreteObserverä¸­éœ€è¦ä½¿ç”¨åˆ°å…·ä½“ç›®æ ‡ç±»ConcreteSubjectä¸­çš„çŠ¶æ€ï¼ˆå±æ€§ï¼‰ï¼Œä¼šå­˜åœ¨å…³è”æˆ–ä¾èµ–å…³ç³»ã€‚ å¦‚æœåœ¨å…·ä½“å±‚ä¹‹é—´å…·æœ‰å…³è”å…³ç³»ï¼Œç³»ç»Ÿçš„æ‰©å±•æ€§å°†å—åˆ°ä¸€å®šçš„å½±å“ï¼Œå¢åŠ æ–°çš„å…·ä½“ç›®æ ‡ç±»æœ‰æ—¶å€™éœ€è¦ä¿®æ”¹åŸæœ‰è§‚å¯Ÿè€…çš„ä»£ç ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿èƒŒäº†å¼€é—­åŸåˆ™ï¼Œä½†æ˜¯å¦‚æœåŸæœ‰è§‚å¯Ÿè€…ç±»æ— é¡»å…³è”æ–°å¢çš„å…·ä½“ç›®æ ‡ï¼Œåˆ™ç³»ç»Ÿæ‰©å±•æ€§ä¸å—å½±å“ã€‚ ","date":"2022-05-01","objectID":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["è§‚å¯Ÿè€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° åœ¨æŸå¤šäººè”æœºå¯¹æˆ˜æ¸¸æˆä¸­ï¼Œå¤šä¸ªç©å®¶å¯ä»¥åŠ å…¥åŒä¸€æˆ˜é˜Ÿç»„æˆè”ç›Ÿï¼Œå½“æˆ˜é˜Ÿä¸­çš„æŸä¸€æˆå‘˜å—åˆ°æ•Œäººæ”»å‡»æ—¶å°†ç»™æ‰€æœ‰å…¶ä»–ç›Ÿå‹å‘é€é€šçŸ¥ï¼Œç›Ÿå‹æ”¶åˆ°é€šçŸ¥åå°†åšå‡ºå“åº”ã€‚ç°ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼è®¾è®¡å¹¶å®ç°è¯¥è¿‡ç¨‹ï¼Œä»¥å®ç°æˆ˜é˜Ÿæˆå‘˜ä¹‹é—´çš„è”åŠ¨ã€‚ é¢˜ç›®åˆ†æ æˆ˜é˜Ÿæˆå‘˜ä¹‹é—´çš„è”åŠ¨è¿‡ç¨‹ï¼šè”ç›Ÿæˆå‘˜å—åˆ°æ”»å‡»â€”â€”\u003eå‘é€é€šçŸ¥ç»™ç›Ÿå‹â€”â€”\u003eç›Ÿå‹åšå‡ºå“åº”ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒAllyControlCenterå……å½“æŠ½è±¡ç›®æ ‡ç±»ï¼ŒConcreteAllyControlCenterå……å½“å…·ä½“ç›®æ ‡ç±»ï¼ŒObserverå……å½“æŠ½è±¡è§‚å¯Ÿè€…ï¼ŒPlayerå……å½“å…·ä½“è§‚å¯Ÿè€…ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-05-01","objectID":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["è§‚å¯Ÿè€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 è§‚å¯Ÿè€…æ¨¡å¼ä¸MVC åœ¨å½“å‰æµè¡Œçš„MVCï¼ˆModel-View-Controllerï¼‰æ¶æ„ä¸­ä¹Ÿåº”ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒMVCæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼Œå®ƒåŒ…å«äº†3ä¸ªè§’è‰²ï¼Œå³æ¨¡å‹(Model)ï¼Œè§†å›¾(View)å’Œæ§åˆ¶å™¨(Controller)ã€‚å…¶ä¸­ï¼Œæ¨¡å‹å¯å¯¹åº”äºè§‚å¯Ÿè€…æ¨¡å¼ä¸­çš„è§‚å¯Ÿç›®æ ‡ï¼Œè€Œè§†å›¾å¯¹åº”äºè§‚å¯Ÿè€…ï¼Œæ§åˆ¶å™¨å¯å……å½“ä¸¤è€…ä¹‹é—´çš„ä¸­ä»‹è€…ã€‚å½“æ¨¡å‹å±‚çš„æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè§†å›¾å±‚å°†è‡ªåŠ¨æ”¹å˜å…¶æ˜¾ç¤ºå†…å®¹ã€‚MVCçš„ç»“æ„å›¾å¦‚ä¸‹ï¼š ","date":"2022-05-01","objectID":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["è§‚å¯Ÿè€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/12.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 å‘½ä»¤æ¨¡å¼ä»‹ç» åœ¨ç°å®ç”Ÿæ´»ä¸­äººä»¬é€šè¿‡ä½¿ç”¨å¼€å…³æ¥æ§åˆ¶ä¸€äº›ç”µå™¨çš„æ‰“å¼€å’Œå…³é—­ï¼Œä¾‹å¦‚ç”µç¯æˆ–è€…æ’æ°”æ‰‡ï¼Œå¦‚ä¸‹å›¾ã€‚ æˆ‘ä»¬å¯ä»¥å°†å¼€å…³çœ‹æˆä¸€ä¸ªè¯·æ±‚å‘é€è€…ï¼Œç”µç¯æˆ–è€…æ’æ°”æ‰‡åˆ™æ˜¯è¯·æ±‚çš„æœ€ç»ˆæ¥æ”¶è€…å’Œå¤„ç†è€…ã€‚å¼€å…³å’Œç”µç¯ä¹‹é—´å¹¶ä¸å­˜åœ¨ç›´æ¥è€¦åˆå…³ç³»ï¼Œå®ƒä»¬é€šè¿‡ç”µçº¿è¿æ¥åœ¨ä¸€èµ·ï¼Œä½¿ç”¨ä¸åŒçš„ç”µçº¿å¯ä»¥è¿æ¥ä¸åŒçš„è¯·æ±‚æ¥æ”¶è€…ï¼Œåªéœ€è¦æ›´æ¢ä¸€æ ¹ç”µçº¿ï¼Œç›¸åŒçš„å‘é€è€…ï¼ˆå¼€å…³ï¼‰å³å¯å¯¹åº”ä¸åŒçš„æ¥æ”¶è€…ï¼ˆç”µå™¨ï¼‰ã€‚ åœ¨è½¯ä»¶å¼€å‘ä¸­ä¹Ÿå­˜åœ¨å¾ˆå¤šä¸å¼€å…³å’Œç”µå™¨ç±»ä¼¼çš„è¯·æ±‚å‘é€è€…å’Œæ¥æ”¶è€…å¯¹è±¡ï¼Œä¾‹å¦‚æŒ‰é’®å’Œäº‹ä»¶å¤„ç†ç±»ã€‚ä¸ºäº†é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ï¼Œå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰æ¥è®¾è®¡ç³»ç»Ÿã€‚ åœ¨å‘½ä»¤æ¨¡å¼ä¸­å‘é€è€…ä¸æ¥æ”¶è€…ä¹‹é—´å¼•å…¥äº†æ–°çš„å‘½ä»¤å¯¹è±¡ï¼ˆç±»ä¼¼ç”µçº¿ï¼‰ï¼Œå°†å‘é€è€…çš„è¯·æ±‚å°è£…åœ¨å‘½ä»¤å¯¹è±¡ä¸­ï¼Œå†é€šè¿‡å‘½ä»¤å¯¹è±¡æ¥è°ƒç”¨æ¥æ”¶è€…çš„æ–¹æ³•ã€‚å®ƒå¯ä»¥ä½¿è¯·æ±‚å‘é€è€…å’Œæ¥æ”¶è€…å®Œå…¨è§£è€¦ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´æ²¡æœ‰ç›´æ¥å¼•ç”¨çš„å…³ç³»ï¼Œå‘é€è¯·æ±‚çš„å¯¹è±¡åªéœ€è¦çŸ¥é“å¦‚ä½•å‘é€è¯·æ±‚ï¼Œè€Œä¸å¿…çŸ¥é“å¦‚ä½•å®Œæˆè¯·æ±‚ã€‚ å®šä¹‰ï¼š å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œå¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼Œå¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚ ä¸»è¦è§£å†³ï¼š åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œè¡Œä¸ºè¯·æ±‚è€…ä¸è¡Œä¸ºå®ç°è€…é€šå¸¸æ˜¯ä¸€ç§ç´§è€¦åˆçš„å…³ç³»ï¼Œä½†æŸäº›åœºåˆï¼Œæ¯”å¦‚éœ€è¦å¯¹è¡Œä¸ºè¿›è¡Œè®°å½•ã€æ’¤é”€æˆ–é‡åšã€äº‹åŠ¡ç­‰å¤„ç†æ—¶ï¼Œè¿™ç§æ— æ³•æŠµå¾¡å˜åŒ–çš„ç´§è€¦åˆçš„è®¾è®¡å°±ä¸å¤ªåˆé€‚ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š åœ¨æŸäº›åœºåˆï¼Œæ¯”å¦‚è¦å¯¹è¡Œä¸ºè¿›è¡Œ\"è®°å½•ã€æ’¤é”€/é‡åšã€äº‹åŠ¡\"ç­‰å¤„ç†ï¼Œè¿™ç§æ— æ³•æŠµå¾¡å˜åŒ–çš„ç´§è€¦åˆæ˜¯ä¸åˆé€‚çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä½•å°†\"è¡Œä¸ºè¯·æ±‚è€…\"ä¸\"è¡Œä¸ºå®ç°è€…\"è§£è€¦ï¼Ÿå°†ä¸€ç»„è¡Œä¸ºæŠ½è±¡ä¸ºå¯¹è±¡ï¼Œå¯ä»¥å®ç°äºŒè€…ä¹‹é—´çš„æ¾è€¦åˆã€‚ å¦‚ä½•è§£å†³ï¼š é€šè¿‡è°ƒç”¨è€…è°ƒç”¨æ¥å—è€…æ‰§è¡Œå‘½ä»¤ï¼Œé¡ºåºï¼šè°ƒç”¨è€…â†’å‘½ä»¤â†’æ¥å—è€…ã€‚ å…³é”®ä»£ç ï¼š å®šä¹‰ä¸‰ä¸ªè§’è‰²ï¼š1ã€received çœŸæ­£çš„å‘½ä»¤æ‰§è¡Œå¯¹è±¡ 2ã€Command 3ã€invoker ä½¿ç”¨å‘½ä»¤å¯¹è±¡çš„å…¥å£ åº”ç”¨å®ä¾‹ï¼š struts 1 ä¸­çš„ action æ ¸å¿ƒæ§åˆ¶å™¨ ActionServlet åªæœ‰ä¸€ä¸ªï¼Œç›¸å½“äº Invokerï¼Œè€Œæ¨¡å‹å±‚çš„ç±»ä¼šéšç€ä¸åŒçš„åº”ç”¨æœ‰ä¸åŒçš„æ¨¡å‹ç±»ï¼Œç›¸å½“äºå…·ä½“çš„ Commandã€‚ ä¼˜ç‚¹ï¼š 1ã€é™ä½äº†ç³»ç»Ÿè€¦åˆåº¦ã€‚ 2ã€æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“æ·»åŠ åˆ°ç³»ç»Ÿä¸­å»ã€‚ ç¼ºç‚¹ï¼š ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚ ä½¿ç”¨åœºæ™¯ï¼š è®¤ä¸ºæ˜¯å‘½ä»¤çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼Œæ¯”å¦‚ï¼š 1ã€GUI ä¸­æ¯ä¸€ä¸ªæŒ‰é’®éƒ½æ˜¯ä¸€æ¡å‘½ä»¤ã€‚ 2ã€æ¨¡æ‹Ÿ CMDã€‚ æ³¨æ„äº‹é¡¹ï¼š ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€(Undo)æ“ä½œå’Œæ¢å¤(Redo)æ“ä½œï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼Œè§å‘½ä»¤æ¨¡å¼çš„æ‰©å±•ã€‚ ","date":"2022-04-30","objectID":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["å‘½ä»¤æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 å‘½ä»¤æ¨¡å¼è¯¦è§£ ","date":"2022-04-30","objectID":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["å‘½ä»¤æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 å‘½ä»¤æ¨¡å¼ç»“æ„ å‘½ä»¤æ¨¡å¼çš„æ ¸å¿ƒåœ¨äºå¼•å…¥äº†æŠ½è±¡å‘½ä»¤ç±»å’Œå…·ä½“å‘½ä»¤ç±»ï¼Œé€šè¿‡å‘½ä»¤ç±»æ¥é™ä½å‘é€è€…å’Œæ¥æ”¶è€…çš„è€¦åˆåº¦ï¼Œè¯·æ±‚å‘é€è€…åªéœ€æŒ‡å®šä¸€ä¸ªå‘½ä»¤å¯¹è±¡ï¼Œå†é€šè¿‡å‘½ä»¤å¯¹è±¡æ¥è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„å¤„ç†æ–¹æ³•ï¼Œç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±å›¾å¯çŸ¥ï¼Œå‘½ä»¤æ¨¡å¼åŒ…å«ä»¥ä¸‹4ä¸ªè§’è‰²ã€‚ Commandï¼ˆæŠ½è±¡å‘½ä»¤ç±»ï¼‰ï¼šæŠ½è±¡å‘½ä»¤ç±»ä¸€èˆ¬æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£ï¼Œåœ¨å…¶ä¸­å£°æ˜äº†ç”¨äºæ‰§è¡Œè¯·æ±‚çš„execute()ç­‰æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å¯ä»¥è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„ç›¸å…³æ“ä½œã€‚ ConcreteCommandï¼ˆå…·ä½“å‘½ä»¤ç±»ï¼‰ï¼šå…·ä½“å‘½ä»¤ç±»æ˜¯æŠ½è±¡å‘½ä»¤ç±»çš„å­ç±»ï¼Œå®ç°äº†åœ¨æŠ½è±¡å‘½ä»¤ç±»ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œå®ƒå¯¹åº”å…·ä½“çš„æ¥æ”¶è€…å¯¹è±¡ï¼Œå°†æ¥æ”¶è€…å¯¹è±¡çš„åŠ¨ä½œç»‘å®šå…¶ä¸­ã€‚å…·ä½“å‘½ä»¤ç±»åœ¨å®ç°execute()æ–¹æ³•æ—¶å°†è°ƒç”¨æ¥æ”¶è€…å¯¹è±¡çš„ç›¸å…³æ“ä½œ(Action)ã€‚ Invokerï¼ˆè°ƒç”¨è€…ï¼‰ï¼šè°ƒç”¨è€…å³è¯·æ±‚å‘é€è€…ï¼Œå®ƒé€šè¿‡å‘½ä»¤å¯¹è±¡æ¥æ‰§è¡Œè¯·æ±‚ã€‚ä¸€ä¸ªè°ƒç”¨è€…å¹¶ä¸éœ€è¦åœ¨è®¾è®¡æ—¶ç¡®å®šå…¶æ¥æ”¶è€…ï¼Œå› æ­¤å®ƒåªä¸æŠ½è±¡å‘½ä»¤ç±»ä¹‹é—´å­˜åœ¨å…³è”å…³ç³»ã€‚åœ¨ç¨‹åºè¿è¡Œæ—¶å¯ä»¥å°†ä¸€ä¸ªå…·ä½“å‘½ä»¤å¯¹è±¡æ³¨å…¥å…¶ä¸­ï¼Œå†è°ƒç”¨å…·ä½“å‘½ä»¤å¯¹è±¡çš„execute()æ–¹æ³•ï¼Œä»è€Œå®ç°é—´æ¥è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„ç›¸å…³æ“ä½œã€‚ Receiverï¼ˆæ¥æ”¶è€…ï¼‰ï¼šæ¥æ”¶è€…æ‰§è¡Œä¸è¯·æ±‚ç›¸å…³çš„æ“ä½œï¼Œå…·ä½“å®ç°å¯¹è¯·æ±‚çš„ä¸šåŠ¡å¤„ç†ã€‚ ","date":"2022-04-30","objectID":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["å‘½ä»¤æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 å‘½ä»¤æ¨¡å¼å®ç° å…¸å‹çš„æŠ½è±¡å‘½ä»¤ç±»ä»£ç å¦‚ä¸‹ï¼š public abstract class Command { public abstract void execute(); } å¯¹äºè¯·æ±‚å‘é€è€…ï¼ˆå³è°ƒç”¨è€…ï¼‰è€Œè¨€ï¼Œå°†é’ˆå¯¹æŠ½è±¡å‘½ä»¤ç±»è¿›è¡Œç¼–ç¨‹ï¼Œå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°æˆ–è€…Setteræ–¹æ³•åœ¨è¿è¡Œæ—¶æ³¨å…¥å…·ä½“å‘½ä»¤ç±»å¯¹è±¡ï¼Œå¹¶åœ¨ä¸šåŠ¡æ–¹æ³•ä¸­è°ƒç”¨å‘½ä»¤å¯¹è±¡çš„execute()æ–¹æ³•ï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class Invoker { private Command command; // æ„é€ æ³¨å…¥ public Invoker(Command command) { this.command = command; } // è®¾å€¼æ³¨å…¥ public setCommand(Command command) { this.command = command; } // ä¸šåŠ¡æ–¹æ³•ï¼Œç”¨äºè°ƒç”¨å‘½ä»¤ç±»ä¸­çš„execute()æ–¹æ³• public void call() { command.execute(); } } å…·ä½“å‘½ä»¤ç±»ç»§æ‰¿äº†æŠ½è±¡å‘½ä»¤ç±»ï¼Œå®ƒä¸è¯·æ±‚æ¥æ”¶è€…å…³è”ï¼Œå®ç°äº†åœ¨æŠ½è±¡å‘½ä»¤ç±»ä¸­å£°æ˜çš„execute()æ–¹æ³•ï¼Œå¹¶åœ¨å®ç°æ—¶è°ƒç”¨æ¥æ”¶è€…çš„è¯·æ±‚å“åº”æ–¹æ³•ã€‚å…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class ConcreteCommand extends Command { private Receiver receiver; //ç»´æŒä¸€ä¸ªå¯¹è¯·æ±‚æ¥æ”¶è€…å¯¹è±¡çš„å¼•ç”¨ public void execute() { receiver.action(); //è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„ä¸šåŠ¡å¤„ç†æ–¹æ³•action() } } è¯·æ±‚æ¥æ”¶è€…Receiverå…·ä½“å®ç°å¯¹è¯·æ±‚çš„ä¸šåŠ¡å¤„ç†ï¼Œå®ƒæ‹¥æœ‰action()æ–¹æ³•ï¼Œç”¨äºæ‰§è¡Œä¸è¯·æ±‚ç›¸å…³æ“ä½œï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class Receiver { public void action() { //å…·ä½“æ“ä½œ } } ","date":"2022-04-30","objectID":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["å‘½ä»¤æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 å‘½ä»¤æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° ä¸ºäº†ç”¨æˆ·ä½¿ç”¨æ–¹ä¾¿ï¼ŒæŸç³»ç»Ÿæä¾›äº†ä¸€ç³»åˆ—åŠŸèƒ½é”®ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰åŠŸèƒ½é”®çš„åŠŸèƒ½ï¼Œä¾‹å¦‚åŠŸèƒ½é”®FunctionButtonå¯ä»¥ç”¨äºé€€å‡ºç³»ç»Ÿï¼ˆç”±SystemExitClassç±»æ¥å®ç°ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ˜¾ç¤ºå¸®åŠ©æ–‡æ¡£ï¼ˆç”±DisplayHelpClassç±»æ¥å®ç°ï¼‰ã€‚ ç”¨æˆ·å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ”¹å˜åŠŸèƒ½é”®çš„ç”¨é€”ï¼Œç°ä½¿ç”¨å‘½ä»¤æ¨¡å¼æ¥è®¾è®¡è¯¥ç³»ç»Ÿï¼Œä½¿å¾—åŠŸèƒ½é”®ç±»ä¸åŠŸèƒ½ç±»ä¹‹é—´è§£è€¦ï¼Œå¯ä¸ºåŒä¸€ä¸ªåŠŸèƒ½é”®è®¾ç½®ä¸åŒçš„åŠŸèƒ½ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒFunctionButtonå……å½“è¯·æ±‚è°ƒç”¨è€…ï¼ŒSystemExitClasså’ŒDisplayHelpClasså……å½“è¯·æ±‚æ¥æ”¶è€…ï¼ŒCommandæ˜¯æŠ½è±¡å‘½ä»¤ç±»ï¼ŒExitCommandå’ŒHelpCommandå……å½“å…·ä½“å‘½ä»¤ç±»ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-30","objectID":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["å‘½ä»¤æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 å®ç°å‘½ä»¤é˜Ÿåˆ— æœ‰æ—¶å€™ï¼Œå½“ä¸€ä¸ªè¯·æ±‚å‘é€è€…å‘é€ä¸€ä¸ªè¯·æ±‚æ—¶æœ‰ä¸æ­¢ä¸€ä¸ªè¯·æ±‚æ¥æ”¶è€…äº§ç”Ÿå“åº”ï¼Œè¿™äº›è¯·æ±‚æ¥æ”¶è€…å°†é€ä¸ªæ‰§è¡Œä¸šåŠ¡æ–¹æ³•ï¼Œå®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å‘½ä»¤é˜Ÿåˆ—æ¥å®ç°ã€‚ å‘½ä»¤é˜Ÿåˆ—çš„å®ç°æ–¹æ³•æœ‰å¤šç§å½¢å¼ï¼Œå…¶ä¸­æœ€å¸¸ç”¨ã€çµæ´»æ€§æœ€å¥½çš„ä¸€ç§æ–¹å¼å°±æ˜¯å¢åŠ ä¸€ä¸ªCommandQueueç±»ï¼Œç”±è¯¥ç±»è´Ÿè´£å­˜å‚¨å¤šä¸ªå‘½ä»¤å¯¹è±¡ï¼Œè€Œä¸åŒçš„å‘½ä»¤å¯¹è±¡å¯ä»¥å¯¹åº”ä¸åŒçš„è¯·æ±‚æ¥æ”¶è€…ã€‚CommandQueueç±»çš„å…¸å‹ä»£ç å¦‚ä¸‹ï¼š package homework; import java.util.ArrayList; import java.util.List; public class CommandQueue { private List\u003cCommand\u003e commandList = new ArrayList(); public void addCommand(Command command) { commandList.add(command); } public void removeCommand(Command command) { commandList.remove(command); } /** * å¾ªç¯è°ƒç”¨æ¯ä¸€ä¸ªå‘½ä»¤å¯¹è±¡çš„execute()æ–¹æ³• */ public void execute() { for (Command command : commandList) { command.execute(); } } } åœ¨å¢åŠ å‘½ä»¤é˜Ÿåˆ—ç±»CommandQueueä»¥åï¼Œè¯·æ±‚å‘é€è€…Invokerå°†é’ˆå¯¹CommandQueueç¼–ç¨‹ã€‚å³å°†Commandä¿®æ”¹ä¸ºCommandQueueå³å¯ã€‚ ","date":"2022-04-30","objectID":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["å‘½ä»¤æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/11.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 ä»£ç†æ¨¡å¼ä»‹ç» ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰æ˜¯å¸¸ç”¨çš„ç»“æ„å‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå½“æ— æ³•ç›´æ¥è®¿é—®æŸä¸ªå¯¹è±¡æˆ–è®¿é—®æŸä¸ªå¯¹è±¡å­˜åœ¨å›°éš¾æ—¶å¯ä»¥é€šè¿‡ä¸€ä¸ªä»£ç†å¯¹è±¡æ¥é—´æ¥è®¿é—®ï¼Œä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ï¼Œå®ƒå»æ‰å®¢æˆ·ä¸èƒ½çœ‹åˆ°çš„å†…å®¹å’ŒæœåŠ¡æˆ–è€…å¢æ·»å®¢æˆ·éœ€è¦çš„é¢å¤–çš„æ–°æœåŠ¡ã€‚ ä»£ç†æ¨¡å¼çš„å˜åŒ–å½¢å¼éå¸¸å¤šï¼Œå¸¸è§çš„ä»£ç†å½¢å¼æœ‰è¿œç¨‹ä»£ç†ã€ä¿æŠ¤ä»£ç†ã€è™šæ‹Ÿä»£ç†ã€ç¼“å†²ä»£ç†ã€æ™ºèƒ½å¼•ç”¨ä»£ç†ç­‰ã€‚ ä¸»è¦è§£å†³ï¼š åœ¨ç›´æ¥è®¿é—®å¯¹è±¡æ—¶å¸¦æ¥çš„é—®é¢˜ï¼Œæ¯”å¦‚è¯´ï¼šè¦è®¿é—®çš„å¯¹è±¡åœ¨è¿œç¨‹çš„æœºå™¨ä¸Šã€‚åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­ï¼Œæœ‰äº›å¯¹è±¡ç”±äºæŸäº›åŸå› ï¼ˆæ¯”å¦‚å¯¹è±¡åˆ›å»ºå¼€é”€å¾ˆå¤§ï¼Œæˆ–è€…æŸäº›æ“ä½œéœ€è¦å®‰å…¨æ§åˆ¶ï¼Œæˆ–è€…éœ€è¦è¿›ç¨‹å¤–çš„è®¿é—®ï¼‰ï¼Œç›´æ¥è®¿é—®ä¼šç»™ä½¿ç”¨è€…æˆ–è€…ç³»ç»Ÿç»“æ„å¸¦æ¥å¾ˆå¤šéº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è®¿é—®æ­¤å¯¹è±¡æ—¶åŠ ä¸Šä¸€ä¸ªå¯¹æ­¤å¯¹è±¡çš„è®¿é—®å±‚ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š æƒ³åœ¨è®¿é—®ä¸€ä¸ªç±»æ—¶åšä¸€äº›æ§åˆ¶ã€‚ å¦‚ä½•è§£å†³ï¼š å¢åŠ ä¸­é—´å±‚ã€‚ å…³é”®ä»£ç ï¼š å®ç°ä¸è¢«ä»£ç†ç±»ç»„åˆã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€Windows é‡Œé¢çš„å¿«æ·æ–¹å¼ã€‚ 2ã€çŒªå…«æˆ’å»æ‰¾é«˜ç¿ å…°ç»“æœæ˜¯å­™æ‚Ÿç©ºå˜çš„ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼šæŠŠé«˜ç¿ å…°çš„å¤–è²ŒæŠ½è±¡å‡ºæ¥ï¼Œé«˜ç¿ å…°æœ¬äººå’Œå­™æ‚Ÿç©ºéƒ½å®ç°äº†è¿™ä¸ªæ¥å£ï¼ŒçŒªå…«æˆ’è®¿é—®é«˜ç¿ å…°çš„æ—¶å€™çœ‹ä¸å‡ºæ¥è¿™ä¸ªæ˜¯å­™æ‚Ÿç©ºï¼Œæ‰€ä»¥è¯´å­™æ‚Ÿç©ºæ˜¯é«˜ç¿ å…°ä»£ç†ç±»ã€‚ 3ã€ä¹°ç«è½¦ç¥¨ä¸ä¸€å®šåœ¨ç«è½¦ç«™ä¹°ï¼Œä¹Ÿå¯ä»¥å»ä»£å”®ç‚¹ã€‚ 4ã€ä¸€å¼ æ”¯ç¥¨æˆ–é“¶è¡Œå­˜å•æ˜¯è´¦æˆ·ä¸­èµ„é‡‘çš„ä»£ç†ã€‚æ”¯ç¥¨åœ¨å¸‚åœºäº¤æ˜“ä¸­ç”¨æ¥ä»£æ›¿ç°é‡‘ï¼Œå¹¶æä¾›å¯¹ç­¾å‘äººè´¦å·ä¸Šèµ„é‡‘çš„æ§åˆ¶ã€‚ 5ã€spring aopã€‚ ä¼˜ç‚¹ï¼š 1ã€èŒè´£æ¸…æ™°ã€‚ 2ã€é«˜æ‰©å±•æ€§ã€‚ 3ã€æ™ºèƒ½åŒ–ã€‚ ç¼ºç‚¹ï¼š 1ã€ç”±äºåœ¨å®¢æˆ·ç«¯å’ŒçœŸå®ä¸»é¢˜ä¹‹é—´å¢åŠ äº†ä»£ç†å¯¹è±¡ï¼Œå› æ­¤æœ‰äº›ç±»å‹çš„ä»£ç†æ¨¡å¼å¯èƒ½ä¼šé€ æˆè¯·æ±‚çš„å¤„ç†é€Ÿåº¦å˜æ…¢ã€‚ 2ã€å®ç°ä»£ç†æ¨¡å¼éœ€è¦é¢å¤–çš„å·¥ä½œï¼Œæœ‰äº›ä»£ç†æ¨¡å¼çš„å®ç°éå¸¸å¤æ‚ã€‚ ä½¿ç”¨åœºæ™¯ï¼š æŒ‰èŒè´£æ¥åˆ’åˆ†ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹ä½¿ç”¨åœºæ™¯ï¼š 1ã€è¿œç¨‹ä»£ç†ã€‚ 2ã€è™šæ‹Ÿä»£ç†ã€‚ 3ã€Copy-on-Write ä»£ç†ã€‚ 4ã€ä¿æŠ¤ï¼ˆProtect or Accessï¼‰ä»£ç†ã€‚ 5ã€Cacheä»£ç†ã€‚ 6ã€é˜²ç«å¢™ï¼ˆFirewallï¼‰ä»£ç†ã€‚ 7ã€åŒæ­¥åŒ–ï¼ˆSynchronizationï¼‰ä»£ç†ã€‚ 8ã€æ™ºèƒ½å¼•ç”¨ï¼ˆSmart Referenceï¼‰ä»£ç†ã€‚ æ³¨æ„äº‹é¡¹ï¼š 1ã€å’Œé€‚é…å™¨æ¨¡å¼çš„åŒºåˆ«ï¼šé€‚é…å™¨æ¨¡å¼ä¸»è¦æ”¹å˜æ‰€è€ƒè™‘å¯¹è±¡çš„æ¥å£ï¼Œè€Œä»£ç†æ¨¡å¼ä¸èƒ½æ”¹å˜æ‰€ä»£ç†ç±»çš„æ¥å£ã€‚ 2ã€å’Œè£…é¥°å™¨æ¨¡å¼çš„åŒºåˆ«ï¼šè£…é¥°å™¨æ¨¡å¼ä¸ºäº†å¢å¼ºåŠŸèƒ½ï¼Œè€Œä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†åŠ ä»¥æ§åˆ¶ã€‚ ","date":"2022-04-30","objectID":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["ä»£ç†æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ä»£ç†æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 ä»£ç†æ¨¡å¼è¯¦è§£ ","date":"2022-04-30","objectID":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["ä»£ç†æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ä»£ç†æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 ä»£ç†æ¨¡å¼ç»“æ„ ä»£ç†æ¨¡å¼çš„ç»“æ„æ¯”è¾ƒç®€å•ï¼Œå…¶æ ¸å¿ƒæ˜¯ä»£ç†ç±»ï¼Œä¸ºäº†è®©å®¢æˆ·ç«¯èƒ½å¤Ÿä¸€è‡´åœ°å¯¹å¾…çœŸå®å¯¹è±¡å’Œä»£ç†å¯¹è±¡ï¼Œåœ¨ä»£ç†æ¨¡å¼ä¸­å¼•å…¥äº†æŠ½è±¡å±‚ï¼Œå…¶ç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±å›¾å¯çŸ¥ï¼Œä»£ç†æ¨¡å¼åŒ…å«ä»¥ä¸‹3ä¸ªè§’è‰²ã€‚ Subjectï¼ˆæŠ½è±¡ä¸»é¢˜è§’è‰²ï¼‰ï¼šå®ƒå£°æ˜äº†çœŸå®ä¸»é¢˜å’Œä»£ç†ä¸»é¢˜çš„å…±åŒæ¥å£ï¼Œè¿™æ ·ä¸€æ¥åœ¨ä»»ä½•ä½¿ç”¨çœŸå®ä¸»é¢˜çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ä»£ç†ä¸»é¢˜ï¼Œå®¢æˆ·ç«¯é€šå¸¸éœ€è¦é’ˆå¯¹æŠ½è±¡ä¸»é¢˜è§’è‰²è¿›è¡Œç¼–ç¨‹ã€‚ Proxyï¼ˆä»£ç†ä¸»é¢˜è§’è‰²ï¼‰ï¼šå®ƒåŒ…å«äº†å¯¹çœŸå®ä¸»é¢˜çš„å¼•ç”¨ï¼Œä»è€Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™æ“ä½œçœŸå®ä¸»é¢˜å¯¹è±¡ï¼›åœ¨ä»£ç†ä¸»é¢˜è§’è‰²ä¸­æä¾›äº†ä¸€ä¸ªä¸çœŸå®ä¸»é¢˜è§’è‰²ç›¸åŒçš„æ¥å£ï¼Œä»¥ä¾¿ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ä»£æ›¿çœŸå®ä¸»é¢˜ï¼›ä»£ç†ä¸»é¢˜è§’è‰²è¿˜å¯ä»¥æ§åˆ¶çœŸå®ä¸»é¢˜çš„ä½¿ç”¨ï¼Œè´Ÿè´£åœ¨éœ€è¦çš„æ—¶å€™åˆ›å»ºå’Œåˆ é™¤çœŸå®ä¸»é¢˜å¯¹è±¡ï¼Œå¹¶å¯¹çœŸå®ä¸»é¢˜å¯¹è±¡çš„ä½¿ç”¨åŠ ä»¥çº¦æŸã€‚ é€šå¸¸ï¼Œåœ¨ä»£ç†ä¸»é¢˜è§’è‰²ä¸­å®¢æˆ·ç«¯åœ¨è°ƒç”¨æ‰€å¼•ç”¨çš„çœŸå®ä¸»é¢˜æ“ä½œä¹‹å‰æˆ–ä¹‹åè¿˜éœ€è¦æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œè€Œä¸ä»…ä»…å•çº¯è°ƒç”¨çœŸå®ä¸»é¢˜å¯¹è±¡ä¸­çš„æ“ä½œã€‚ RealSubjectï¼ˆçœŸå®ä¸»é¢˜è§’è‰²ï¼‰ï¼šå®ƒå®šä¹‰äº†ä»£ç†è§’è‰²æ‰€ä»£è¡¨çš„çœŸå®å¯¹è±¡ï¼Œåœ¨çœŸå®ä¸»é¢˜è§’è‰²ä¸­å®ç°äº†çœŸå®çš„ä¸šåŠ¡æ“ä½œï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ä»£ç†ä¸»é¢˜è§’è‰²é—´æ¥ä½¿ç”¨çœŸå®ä¸»é¢˜è§’è‰²ä¸­å®šä¹‰çš„æ“ä½œã€‚ ","date":"2022-04-30","objectID":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["ä»£ç†æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ä»£ç†æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 ä»£ç†æ¨¡å¼å®ç° å…¸å‹çš„æŠ½è±¡ä¸»é¢˜ç±»ä»£ç å¦‚ä¸‹ï¼š public abstract class Subject { public abstract void request(); } çœŸå®ä¸»é¢˜ç±»ç»§æ‰¿äº†æŠ½è±¡ä¸»é¢˜ç±»ï¼Œæä¾›äº†ä¸šåŠ¡æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class RealSubject extends Subject { public void request() { // ä¸šåŠ¡æ–¹æ³•çš„å…·ä½“å®ç°ä»£ç  } } ä»£ç†ç±»ä¹Ÿæ˜¯æŠ½è±¡ä¸»é¢˜ç±»çš„å­ç±»ï¼Œå®ƒç»´æŒä¸€ä¸ªå¯¹çœŸå®ä¸»é¢˜å¯¹è±¡çš„å¼•ç”¨ï¼Œè°ƒç”¨åœ¨çœŸå®ä¸»é¢˜ä¸­å®ç°çš„ä¸šåŠ¡æ–¹æ³•ï¼Œåœ¨è°ƒç”¨æ—¶å¯ä»¥åœ¨åŸæœ‰ä¸šåŠ¡æ–¹æ³•çš„åŸºç¡€ä¸Šé™„åŠ ä¸€äº›æ–°çš„æ–¹æ³•å¯¹åŠŸèƒ½è¿›è¡Œæ‰©å……æˆ–çº¦æŸã€‚æœ€ç®€å•çš„ä»£ç†ç±»å®ç°ä»£ç å¦‚ä¸‹ï¼š public class Proxy extends Subject { // ç»´æŒä¸€ä¸ªå¯¹çœŸå®ä¸»é¢˜å¯¹è±¡çš„å¼•ç”¨ private RealSubject realSubject = new RealSubject(); public void preRequest() { ... } public void request() { preRequest(); // è°ƒç”¨çœŸå®ä¸»é¢˜å¯¹è±¡çš„æ–¹æ³• realSubject.request(); postRequest(); } public void postRequest() { ... } } ","date":"2022-04-30","objectID":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["ä»£ç†æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ä»£ç†æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 ä»£ç†æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° åœ¨ä¸€ä¸ªè®ºå›ä¸­å·²æ³¨å†Œç”¨æˆ·å’Œæ¸¸å®¢çš„æƒé™ä¸åŒï¼Œå·²æ³¨å†Œçš„ç”¨æˆ·æ‹¥æœ‰å‘å¸–ã€ä¿®æ”¹è‡ªå·±çš„æ³¨å†Œä¿¡æ¯ã€ä¿®æ”¹è‡ªå·±çš„å¸–å­ç­‰åŠŸèƒ½ï¼›è€Œæ¸¸å®¢åªèƒ½çœ‹åˆ°åˆ«äººå‘çš„å¸–å­ï¼Œæ²¡æœ‰å…¶ä»–æƒé™ã€‚ä½¿ç”¨ä¿æŠ¤ä»£ç†æ¥è®¾è®¡è¯¥æƒé™ç®¡ç†æ¨¡å—ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒAbstractPermission ä¸ºæŠ½è±¡ä¸»é¢˜è§’è‰²ï¼ŒPermissionProxy ä¸ºä»£ç†ä¸»é¢˜è§’è‰²ï¼Œ RealPermission ä¸ºçœŸå®ä¸»é¢˜è§’è‰²ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-30","objectID":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["ä»£ç†æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ä»£ç†æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/10.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 å¤–è§‚æ¨¡å¼æ¦‚è¿° åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæœ‰æ—¶å€™ä¸ºäº†å®Œæˆä¸€é¡¹è¾ƒä¸ºå¤æ‚çš„åŠŸèƒ½ï¼Œä¸€ä¸ªå®¢æˆ·ç±»éœ€è¦å’Œå¤šä¸ªä¸šåŠ¡ç±»äº¤äº’ï¼Œè€Œè¿™äº›éœ€è¦äº¤äº’çš„ä¸šåŠ¡ç±»ç»å¸¸ä¼šä½œä¸ºä¸€ä¸ªæ•´ä½“å‡ºç°ï¼Œç”±äºè®¾è®¡çš„ç±»æ¯”è¾ƒå¤šï¼Œå¯¼è‡´ä½¿ç”¨ä»£ç è¾ƒä¸ºå¤æ‚ï¼Œæ­¤æ—¶ç‰¹åˆ«éœ€è¦ä¸€ä¸ªç±»ä¼¼æœåŠ¡å‘˜çš„è§’è‰²ï¼Œç”±å®ƒæ¥è´Ÿè´£å’Œå¤šä¸ªä¸šåŠ¡ç±»è¿›è¡Œäº¤äº’ï¼Œè€Œå®¢æˆ·ç±»åªéœ€è¦ä¸è¯¥ç±»è¿›è¡Œäº¤äº’ã€‚å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰é€šè¿‡å¼•å…¥ä¸€ä¸ªæ–°çš„å¤–è§‚ç±»(Facade)æ¥è´Ÿè´£å’Œå¤šä¸ªä¸šåŠ¡ç±»ã€å­ç³»ç»Ÿ(Subsystem)ï¼Œæ‰€æŒ‡çš„å­ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¹¿ä¹‰çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªç±»ã€ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ã€ç³»ç»Ÿçš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†æˆ–è€…ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿã€‘è¿›è¡Œäº¤äº’ï¼Œè€Œå®¢æˆ·ç±»åªéœ€ä¸å¤–è§‚ç±»äº¤äº’ã€‚ å®ƒä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ã€‚å¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚ ä¸»è¦è§£å†³ï¼š é™ä½è®¿é—®å¤æ‚ç³»ç»Ÿçš„å†…éƒ¨å­ç³»ç»Ÿæ—¶çš„å¤æ‚åº¦ï¼Œç®€åŒ–å®¢æˆ·ç«¯ä¹‹é—´çš„æ¥å£ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š 1ã€å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“ç³»ç»Ÿå†…éƒ¨çš„å¤æ‚è”ç³»ï¼Œæ•´ä¸ªç³»ç»Ÿåªéœ€æä¾›ä¸€ä¸ª\"æ¥å¾…å‘˜\"å³å¯ã€‚ 2ã€å®šä¹‰ç³»ç»Ÿçš„å…¥å£ã€‚ å¦‚ä½•è§£å†³ï¼š å®¢æˆ·ç«¯ä¸ä¸ç³»ç»Ÿè€¦åˆï¼Œå¤–è§‚ç±»ä¸ç³»ç»Ÿè€¦åˆã€‚ å…³é”®ä»£ç ï¼š åœ¨å®¢æˆ·ç«¯å’Œå¤æ‚ç³»ç»Ÿä¹‹é—´å†åŠ ä¸€å±‚ï¼Œè¿™ä¸€å±‚å°†è°ƒç”¨é¡ºåºã€ä¾èµ–å…³ç³»ç­‰å¤„ç†å¥½ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€å»åŒ»é™¢çœ‹ç—…ï¼Œå¯èƒ½è¦å»æŒ‚å·ã€é—¨è¯Šã€åˆ’ä»·ã€å–è¯ï¼Œè®©æ‚£è€…æˆ–æ‚£è€…å®¶å±è§‰å¾—å¾ˆå¤æ‚ï¼Œå¦‚æœæœ‰æä¾›æ¥å¾…äººå‘˜ï¼Œåªè®©æ¥å¾…äººå‘˜æ¥å¤„ç†ï¼Œå°±å¾ˆæ–¹ä¾¿ã€‚ 2ã€JAVA çš„ä¸‰å±‚å¼€å‘æ¨¡å¼ã€‚ ä¼˜ç‚¹ï¼š 1ã€å‡å°‘ç³»ç»Ÿç›¸äº’ä¾èµ–ã€‚ 2ã€æé«˜çµæ´»æ€§ã€‚ 3ã€æé«˜äº†å®‰å…¨æ€§ã€‚ **ç¼ºç‚¹ï¼š**ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œå¦‚æœè¦æ”¹ä¸œè¥¿å¾ˆéº»çƒ¦ï¼Œç»§æ‰¿é‡å†™éƒ½ä¸åˆé€‚ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€ä¸ºå¤æ‚çš„æ¨¡å—æˆ–å­ç³»ç»Ÿæä¾›å¤–ç•Œè®¿é—®çš„æ¨¡å—ã€‚ 2ã€å­ç³»ç»Ÿç›¸å¯¹ç‹¬ç«‹ã€‚ 3ã€é¢„é˜²ä½æ°´å¹³äººå‘˜å¸¦æ¥çš„é£é™©ã€‚ æ³¨æ„äº‹é¡¹ï¼š åœ¨å±‚æ¬¡åŒ–ç»“æ„ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤–è§‚æ¨¡å¼å®šä¹‰ç³»ç»Ÿä¸­æ¯ä¸€å±‚çš„å…¥å£ã€‚ ","date":"2022-04-30","objectID":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["å¤–è§‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 å¤–è§‚æ¨¡å¼è¯¦è§£ ","date":"2022-04-30","objectID":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["å¤–è§‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 å¤–è§‚æ¨¡å¼ç»“æ„ å¤–è§‚æ¨¡å¼æ²¡æœ‰ä¸€ä¸ªä¸€èˆ¬åŒ–çš„ç±»å›¾æè¿°ï¼Œä¸‹å›¾å¯ä»¥ç”¨æ¥æè¿°å¤–è§‚æ¨¡å¼çš„ç»“æ„å›¾ã€‚ ç”±ä¸Šå›¾å¯çŸ¥ï¼Œå¤–è§‚æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªè§’è‰²ã€‚ Facadeï¼ˆå¤–è§‚è§’è‰²ï¼‰ï¼šåœ¨å®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼Œåœ¨å¤–è§‚è§’è‰²ä¸­å¯ä»¥çŸ¥é“ç›¸å…³çš„ï¼ˆä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼‰å­ç³»ç»Ÿçš„åŠŸèƒ½å’Œè´£ä»»ï¼›åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå®ƒå°†æ‰€æœ‰ä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚å§”æ´¾åˆ°ç›¸åº”çš„å­ç³»ç»Ÿï¼Œä¼ é€’ç»™ç›¸åº”çš„å­ç³»ç»Ÿå¯¹è±¡å¤„ç†ã€‚ SubSystemï¼ˆå­ç³»ç»Ÿè§’è‰²ï¼‰ï¼šåœ¨è½¯ä»¶ç³»ç»Ÿä¸­å¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­ç³»ç»Ÿè§’è‰²ï¼Œæ¯ä¸€ä¸ªå­ç³»ç»Ÿå¯ä»¥ä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç±»ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»çš„é›†åˆï¼Œå®ƒå®ç°å­ç³»ç»Ÿçš„åŠŸèƒ½ï¼›æ¯ä¸€ä¸ªå­ç³»ç»Ÿéƒ½å¯ä»¥è¢«å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨ï¼Œæˆ–è€…è¢«å¤–è§‚è§’è‰²è°ƒç”¨ï¼Œå®ƒå¤„ç†ç”±å¤–è§‚ç±»ä¼ è¿‡æ¥çš„è¯·æ±‚ï¼›å­ç³»ç»Ÿå¹¶ä¸çŸ¥é“å¤–è§‚çš„å­˜åœ¨ï¼Œå¯¹äºå­ç³»ç»Ÿè€Œè¨€ï¼Œå¤–è§‚è§’è‰²ä»…ä»…æ˜¯å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯è€Œå·²ã€‚ ","date":"2022-04-30","objectID":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["å¤–è§‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 å¤–è§‚æ¨¡å¼å®ç° å­ç³»ç»Ÿç±»é€šå¸¸æ˜¯ä¸€äº›ä¸šåŠ¡ç±»ï¼Œå®ç°äº†ä¸€äº›å…·ä½“çš„ã€ç‹¬ç«‹çš„ä¸šåŠ¡åŠŸèƒ½ï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class SubSystemA { public void methodA() { //ä¸šåŠ¡å®ç°ä»£ç  } } public class SubSystemB { public void methodB() { //ä¸šåŠ¡å®ç°ä»£ç  } } public class SubSystemC { public void methodC() { //ä¸šåŠ¡å®ç°ä»£ç  } } å¤–è§‚ç±»çš„å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class Facade { private SubSystemA obj1 = new SubSystemA(); private SubSystemB obj2 = new SubSystemB(); private SubSystemC obj3 = new SubSystemC(); public void method() { obj1.method(); obj2.method(); obj3.method(); } } ç”±äºåœ¨å¤–è§‚ç±»ä¸­ç»´æŒäº†å¯¹å­ç³»ç»Ÿå¯¹è±¡çš„å¼•ç”¨ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡å¤–è§‚ç±»æ¥é—´æ¥è°ƒç”¨å­ç³»ç»Ÿå¯¹è±¡çš„ä¸šåŠ¡æ–¹æ³•ï¼Œè€Œæ— é¡»ä¸å­ç³»ç»Ÿå¯¹è±¡ç›´æ¥äº¤äº’ã€‚åœ¨å¼•å…¥å¤–è§‚ç±»åï¼Œå®¢æˆ·ç«¯ä»£ç å˜å¾—éå¸¸ç®€å•ï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class Client { public static void main(String args[]) { Facade facade = new Facade(); facade.method(); } } ","date":"2022-04-30","objectID":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["å¤–è§‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 å¤–è§‚æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸè½¯ä»¶å…¬å¸è¦å¼€å‘ä¸€ä¸ªå¯åº”ç”¨äºå¤šä¸ªè½¯ä»¶çš„æ–‡ä»¶åŠ å¯†æ¨¡å—ï¼Œè¯¥æ¨¡å—å¯ä»¥å¯¹æ–‡ä»¶ä¸­çš„æ•°æ®è¿›è¡ŒåŠ å¯†å¹¶å°†åŠ å¯†ä¹‹åçš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ï¼Œå…·ä½“çš„æµç¨‹åŒ…æ‹¬3ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯è¯»å–æºæ–‡ä»¶ã€åŠ å¯†ã€ä¿å­˜åŠ å¯†ä¹‹åçš„æ–‡ä»¶ï¼Œå…¶ä¸­ï¼Œè¯»å–æ–‡ä»¶å’Œä¿å­˜æ–‡ä»¶ä½¿ç”¨æµæ¥å®ç°ï¼ŒåŠ å¯†æ“ä½œé€šè¿‡æ±‚æ¨¡è¿ç®—å®ç°ã€‚è¿™3ä¸ªæ“ä½œç›¸å¯¹ç‹¬ç«‹ï¼Œä¸ºäº†å®ç°ä»£ç çš„ç‹¬ç«‹é‡ç”¨ï¼Œè®©è®¾è®¡æ›´ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œè¿™3ä¸ªæ“ä½œçš„ä¸šåŠ¡ä»£ç å°è£…åœ¨3ä¸ªä¸åŒçš„ç±»ä¸­ã€‚ ç°ä½¿ç”¨å¤–è§‚æ¨¡å¼è®¾è®¡è¯¥æ–‡ä»¶åŠ å¯†æ¨¡å—ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒEncryptFacadeå……å½“å¤–è§‚ç±»ï¼ŒFileReaderã€CipherMachineå’ŒFileWriterå……å½“å­ç³»ç»Ÿç±»ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-30","objectID":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["å¤–è§‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 æŠ½è±¡å¤–è§‚ç±» åœ¨æ ‡å‡†çš„å¤–è§‚æ¨¡å¼çš„ç»“æ„å›¾ä¸­ï¼Œå¦‚æœéœ€è¦å¢åŠ ã€åˆ é™¤æˆ–æ›´æ¢ä¸å¤–è§‚ç±»äº¤äº’çš„å­ç³»ç»Ÿç±»ï¼Œå¿…é¡»ä¿®æ”¹å¤–è§‚ç±»æˆ–å®¢æˆ·ç«¯çš„æºä»£ç ï¼Œè¿™å°†è¿èƒŒå¼€é—­åŸåˆ™ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å¼•å…¥æŠ½è±¡å¤–è§‚ç±»å¯¹ç³»ç»Ÿè¿›è¡Œæ”¹è¿›ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³è¯¥é—®é¢˜ã€‚ å¦‚2.3ä¸­çš„é¢˜ç›®æˆ‘ä»¬éœ€è¦æ›´æ¢ä¸€ä¸ªåŠ å¯†ç±»ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„å¤–è§‚ç±»NewEncryptFacadeä¸FileReaderç±»ã€FileWriterç±»ä»¥åŠæ–°å¢åŠ çš„NewClipherMachineç±»äº¤äº’ï¼Œè™½ç„¶åŸæœ‰ç³»ç»Ÿç±»åº“æ— é¡»ä½œä¿®æ”¹ï¼Œä½†æ˜¯å› ä¸ºå®¢æˆ·ç«¯ä»£ç ä¸­åŸæ¥é’ˆå¯¹EncryptFacadeç±»è¿›è¡Œç¼–ç¨‹ï¼Œç°åœ¨éœ€è¦ä¿®æ”¹ä¸ºNewEncryptFacadeç±»ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹å®¢æˆ·ç«¯æºä»£ç ã€‚å¦‚ä½•åœ¨ä¸ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç çš„å‰æä¸‹ä½¿ç”¨æ–°çš„å¤–è§‚ç±»å‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸€ä¸ªæŠ½è±¡å¤–è§‚ç±»ï¼Œå®¢æˆ·ç«¯é’ˆå¯¹æŠ½è±¡å¤–è§‚ç±»ç¼–ç¨‹å³å¯ã€‚ç»“æ„å›¾å¦‚ä¸‹ï¼š ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š ä»£ç åœ°å€ ","date":"2022-04-30","objectID":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["å¤–è§‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å¤–è§‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/09.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 è£…é¥°æ¨¡å¼ä»‹ç» åœ¨ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šç»™å›¾ç‰‡å¢åŠ ä¸€äº›è¾¹æ¡†ç­‰æ¥è£…é¥°å›¾ç‰‡ï¼Œå¯ä»¥è®©å›¾ç‰‡å˜å¾—æ›´æ¼‚äº®ï¼Œå¦‚ä¸‹å›¾ï¼Œå°±æ˜¯å¯¹å°ç‹—å›¾ç‰‡çš„è£…é¥°ã€‚ åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ä¸€ç§ç±»ä¼¼å›¾ç‰‡çš„æŠ€æœ¯å¯ä»¥å¯¹å·²æœ‰å¯¹è±¡ï¼ˆå›¾ç‰‡ï¼‰çš„åŠŸèƒ½è¿›è¡Œæ‰©å±•ï¼ˆè£…ä¿®ï¼‰ï¼Œä»¥è·å¾—æ›´åŠ ç¬¦åˆç”¨æˆ·éœ€æ±‚çš„å¯¹è±¡ï¼Œä½¿å¾—å¯¹è±¡å…·æœ‰æ›´åŠ å¼ºå¤§çš„åŠŸèƒ½ã€‚è¿™ç§æŠ€æœ¯å¯¹åº”äºä¸€ç§è¢«ç§°ä¹‹ä¸ºè£…é¥°æ¨¡å¼ï¼ˆDecorator Patternï¼‰çš„è®¾è®¡æ¨¡å¼ã€‚è£…é¥°æ¨¡å¼èƒ½åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡å¢åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±æ‰©å±•åŠŸèƒ½è€Œè¨€ï¼Œè£…é¥°æ¨¡å¼æä¾›äº†ä¸€ç§æ¯”ä½¿ç”¨å­ç±»æ›´åŠ çµæ´»çš„æ›¿ä»£æ–¹æ¡ˆã€‚å¼•å…¥äº†è£…é¥°ç±»ï¼Œåœ¨è£…é¥°ç±»ä¸­æ—¢å¯ä»¥è°ƒç”¨å¾…è£…é¥°çš„åŸæœ‰ç±»çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥å¢åŠ æ–°çš„æ–¹æ³•ï¼Œä»¥æ‰©å±•åŸæœ‰ç±»çš„åŠŸèƒ½ ä¸»è¦è§£å†³ï¼š ä¸€èˆ¬çš„ï¼Œæˆ‘ä»¬ä¸ºäº†æ‰©å±•ä¸€ä¸ªç±»ç»å¸¸ä½¿ç”¨ç»§æ‰¿æ–¹å¼å®ç°ï¼Œç”±äºç»§æ‰¿ä¸ºç±»å¼•å…¥é™æ€ç‰¹å¾ï¼Œå¹¶ä¸”éšç€æ‰©å±•åŠŸèƒ½çš„å¢å¤šï¼Œå­ç±»ä¼šå¾ˆè†¨èƒ€ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š åœ¨ä¸æƒ³å¢åŠ å¾ˆå¤šå­ç±»çš„æƒ…å†µä¸‹æ‰©å±•ç±»ã€‚ å¦‚ä½•è§£å†³ï¼š å°†å…·ä½“åŠŸèƒ½èŒè´£åˆ’åˆ†ï¼ŒåŒæ—¶ç»§æ‰¿è£…é¥°è€…æ¨¡å¼ã€‚ å…³é”®ä»£ç ï¼š 1ã€Component ç±»å……å½“æŠ½è±¡è§’è‰²ï¼Œä¸åº”è¯¥å…·ä½“å®ç°ã€‚ 2ã€ä¿®é¥°ç±»å¼•ç”¨å’Œç»§æ‰¿ Component ç±»ï¼Œå…·ä½“æ‰©å±•ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€å­™æ‚Ÿç©ºæœ‰ 72 å˜ï¼Œå½“ä»–å˜æˆ\"åº™å®‡\"åï¼Œä»–çš„æ ¹æœ¬è¿˜æ˜¯ä¸€åªçŒ´å­ï¼Œä½†æ˜¯ä»–åˆæœ‰äº†åº™å®‡çš„åŠŸèƒ½ã€‚ 2ã€ä¸è®ºä¸€å¹…ç”»æœ‰æ²¡æœ‰ç”»æ¡†éƒ½å¯ä»¥æŒ‚åœ¨å¢™ä¸Šï¼Œä½†æ˜¯é€šå¸¸éƒ½æ˜¯æœ‰ç”»æ¡†çš„ï¼Œå¹¶ä¸”å®é™…ä¸Šæ˜¯ç”»æ¡†è¢«æŒ‚åœ¨å¢™ä¸Šã€‚åœ¨æŒ‚åœ¨å¢™ä¸Šä¹‹å‰ï¼Œç”»å¯ä»¥è¢«è’™ä¸Šç»ç’ƒï¼Œè£…åˆ°æ¡†å­é‡Œï¼›è¿™æ—¶ç”»ã€ç»ç’ƒå’Œç”»æ¡†å½¢æˆäº†ä¸€ä¸ªç‰©ä½“ã€‚ ä¼˜ç‚¹ï¼š è£…é¥°ç±»å’Œè¢«è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å‘å±•ï¼Œä¸ä¼šç›¸äº’è€¦åˆï¼Œè£…é¥°æ¨¡å¼æ˜¯ç»§æ‰¿çš„ä¸€ä¸ªæ›¿ä»£æ¨¡å¼ï¼Œè£…é¥°æ¨¡å¼å¯ä»¥åŠ¨æ€æ‰©å±•ä¸€ä¸ªå®ç°ç±»çš„åŠŸèƒ½ã€‚ ç¼ºç‚¹ï¼š å¤šå±‚è£…é¥°æ¯”è¾ƒå¤æ‚ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€æ‰©å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ã€‚ 2ã€åŠ¨æ€å¢åŠ åŠŸèƒ½ï¼ŒåŠ¨æ€æ’¤é”€ã€‚ æ³¨æ„äº‹é¡¹ï¼š å¯ä»£æ›¿ç»§æ‰¿ã€‚ ","date":"2022-04-28","objectID":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["è£…é¥°æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è£…é¥°æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 è£…é¥°æ¨¡å¼è¯¦è§£ ","date":"2022-04-28","objectID":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["è£…é¥°æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è£…é¥°æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 è£…é¥°æ¨¡å¼ç»“æ„ è£…é¥°æ¨¡å¼çš„ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š ç”±ç»“æ„å›¾å¯çŸ¥ï¼Œè£…é¥°æ¨¡å¼åŒ…å«ä»¥ä¸‹4ä¸ªè§’è‰²ã€‚ Componentï¼ˆæŠ½è±¡æ„ä»¶ï¼‰ï¼šå®ƒæ˜¯å…·ä½“æ„ä»¶å’ŒæŠ½è±¡è£…é¥°ç±»çš„å…±åŒçˆ¶ç±»ï¼Œå£°æ˜äº†åœ¨å…·ä½“æ„ä»¶ä¸­çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå®ƒçš„å¼•å…¥å¯ä»¥ä½¿å®¢æˆ·ç«¯ä»¥ä¸€è‡´çš„æ–¹å¼å¤„ç†æœªè¢«è£…é¥°çš„å¯¹è±¡ä»¥åŠè£…é¥°ä¹‹åçš„å¯¹è±¡ï¼Œå®ç°å®¢æˆ·ç«¯çš„é€æ˜æ“ä½œã€‚ ConcreteComponentï¼ˆå…·ä½“æ„ä»¶ï¼‰ï¼šå®ƒæ˜¯æŠ½è±¡æ„ä»¶çš„å­ç±»ï¼Œç”¨äºå®šä¹‰å…·ä½“çš„æ„ä»¶å¯¹è±¡ï¼Œå®ç°äº†åœ¨æŠ½è±¡æ„ä»¶ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œè£…é¥°ç±»å¯ä»¥ç»™å®ƒå¢åŠ é¢å¤–çš„èŒè´£ï¼ˆæ–¹æ³•ï¼‰ã€‚ Decoratorï¼ˆæŠ½è±¡è£…é¥°ç±»ï¼‰ï¼šå®ƒä¹Ÿæ˜¯æŠ½è±¡æ„ä»¶ç±»çš„å­ç±»ï¼Œç”¨äºç»™å…·ä½“æ„ä»¶å¢åŠ èŒè´£ï¼Œä½†æ˜¯å…·ä½“èŒè´£åœ¨å…¶å­ç±»ä¸­å®ç°ã€‚å®ƒç»´æŠ¤ä¸€ä¸ªæŒ‡å‘æŠ½è±¡æ„ä»¶å¯¹è±¡çš„å¼•ç”¨ï¼Œé€šè¿‡è¯¥å¼•ç”¨å¯ä»¥è°ƒç”¨è£…é¥°ä¹‹å‰æ„ä»¶å¯¹è±¡çš„æ–¹æ³•ï¼Œå¹¶é€šè¿‡å…¶å­ç±»æ‰©å±•è¯¥æ–¹æ³•ï¼Œä»¥è¾¾åˆ°è£…é¥°çš„ç›®çš„ã€‚ ConcreteDecoratorï¼ˆå…·ä½“è£…é¥°ç±»ï¼‰ï¼šå®ƒæ˜¯æŠ½è±¡è£…é¥°ç±»çš„å­ç±»ï¼Œè´Ÿè´£å‘æ„ä»¶æ·»åŠ æ–°çš„èŒè´£ã€‚æ¯ä¸€ä¸ªå…·ä½“è£…é¥°ç±»éƒ½å®šä¹‰äº†ä¸€äº›æ–°çš„è¡Œä¸ºï¼Œå®ƒå¯ä»¥è°ƒç”¨åœ¨æŠ½è±¡è£…é¥°ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå¹¶å¯ä»¥å¢åŠ æ–°çš„æ–¹æ³•ç”¨äºæ‰©å……è¯¥å¯¹è±¡çš„è¡Œä¸ºã€‚ ","date":"2022-04-28","objectID":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["è£…é¥°æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è£…é¥°æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 è£…é¥°æ¨¡å¼å®ç° æŠ½è±¡æ„ä»¶ç±»å…¸å‹ä»£ç ï¼š public abstract class Component { public abstract void operation(); } å…·ä½“æ„ä»¶ç±»å…¸å‹ä»£ç ï¼š public class ConcreteComponent extends Component { public void operation() { //å®ç°åŸºæœ¬åŠŸèƒ½ } } æŠ½è±¡è£…é¥°ç±»å…¸å‹ä»£ç ï¼š public class Decorator extends Component { private Component component; //ç»´æŒä¸€ä¸ªå¯¹æŠ½è±¡æ„ä»¶å¯¹è±¡çš„å¼•ç”¨ //æ³¨å…¥ä¸€ä¸ªæŠ½è±¡æ„ä»¶ç±»å‹çš„å¯¹è±¡ public Decorator(Component component) { this.component=component; } public void operation() { component.operation(); //è°ƒç”¨åŸæœ‰ä¸šåŠ¡æ–¹æ³• } } å…·ä½“è£…é¥°ç±»å…¸å‹ä»£ç ï¼š public class ConcreteDecorator extends Decorator { public ConcreteDecorator(Component component) { super(component); } public void operation() { super.operation(); //è°ƒç”¨åŸæœ‰ä¸šåŠ¡æ–¹æ³• addedBehavior(); //è°ƒç”¨æ–°å¢ä¸šåŠ¡æ–¹æ³• } //æ–°å¢ä¸šåŠ¡æ–¹æ³• public void addedBehavior() { â€¦â€¦ } } ","date":"2022-04-28","objectID":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["è£…é¥°æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è£…é¥°æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 è£…é¥°æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° ç®€å•çš„æ‰‹æœºï¼ˆSimplePhoneï¼‰å†æ¥æ”¶åˆ°æ¥ç”µçš„æ—¶å€™ï¼Œä¼šå‘å‡ºå£°éŸ³æé†’ä¸»äººï¼›è€Œç°åœ¨æˆ‘ä»¬éœ€è¦ä¸ºè¯¥æ‰‹æœºæ·»åŠ ä¸€é¡¹åŠŸèƒ½ï¼Œåœ¨æ¥æ”¶æ¥ç”µçš„æ—¶å€™ï¼Œé™¤äº†å£°éŸ³è¿˜èƒ½äº§ç”ŸæŒ¯åŠ¨ï¼ˆJarPhoneï¼‰ï¼›è¿˜å¯ä»¥å¾—åˆ°æ›´é«˜çº§çš„æ‰‹æœºï¼ˆComplexPhoneï¼‰ï¼Œæ¥ç”µçš„æ—¶å€™ï¼Œå®ƒä¸ä»…èƒ½å¤Ÿå‘å£°ï¼Œäº§ç”ŸæŒ¯åŠ¨ï¼Œè€Œä¸”è¿˜æœ‰ç¯å…‰åœ¨é—ªçƒæç¤ºã€‚ç°åœ¨ç”¨è£…é¥°æ¨¡å¼æ¥æ¨¡æ‹Ÿä¸€ä¸‹æ‰‹æœºçš„å‡çº§è¿‡ç¨‹ï¼Œè¦æ±‚ç»˜åˆ¶ç±»å›¾å¹¶ç¼–ç¨‹å®ç°ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒCellphone ä¸ºæŠ½è±¡ç±»ï¼Œå£°æ˜äº†æ¥ç”µæ–¹æ³• receiveCall()ï¼ŒSimplePhone ä¸ºç®€å•æ‰‹æœºç±»ï¼Œ æä¾›äº†å£°éŸ³æç¤ºï¼ŒJarPhone å’Œ ComplexPhone åˆ†åˆ«æä¾›äº†æŒ¯åŠ¨æç¤ºå’Œç¯å…‰é—ªçƒæç¤ºã€‚ PhoneDecorator æ˜¯æŠ½è±¡è£…é¥°è€…ï¼Œå®ƒç»´æŒä¸€ä¸ªå¯¹çˆ¶ç±»å¯¹è±¡çš„å¼•ç”¨ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-28","objectID":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["è£…é¥°æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è£…é¥°æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 é€æ˜è£…é¥°æ¨¡å¼å’ŒåŠé€æ˜è£…é¥°æ¨¡å¼ é€æ˜è£…é¥°æ¨¡å¼ è¦æ±‚å®¢æˆ·ç«¯å®Œå…¨é’ˆå¯¹æŠ½è±¡ç¼–ç¨‹ï¼Œè£…é¥°æ¨¡å¼çš„é€æ˜æ€§è¦æ±‚å®¢æˆ·ç«¯ç¨‹åºä¸åº”è¯¥å°†å¯¹è±¡å£°æ˜ä¸ºå…·ä½“æ„ä»¶ç±»å‹æˆ–å…·ä½“è£…é¥°ç±»å‹ï¼Œè€Œåº”è¯¥å…¨éƒ¨å£°æ˜ä¸ºæŠ½è±¡æ„ä»¶ç±»å‹ã€‚å¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œå…·ä½“æ„ä»¶å¯¹è±¡å’Œå…·ä½“è£…é¥°å¯¹è±¡æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚å¯ä»¥è®©å®¢æˆ·ç«¯é€æ˜åœ°ä½¿ç”¨è£…é¥°ä¹‹å‰çš„å¯¹è±¡å’Œè£…é¥°ä¹‹åçš„å¯¹è±¡ï¼Œæ— é¡»å…³å¿ƒå®ƒä»¬çš„åŒºåˆ«ã€‚å¯ä»¥å¯¹ä¸€ä¸ªå·²è£…é¥°è¿‡çš„å¯¹è±¡è¿›è¡Œå¤šæ¬¡è£…å®ä¾‹ï¼š â€¦â€¦ Component component_o,component_d1,component_d2; //å…¨éƒ¨ä½¿ç”¨æŠ½è±¡æ„ä»¶å®šä¹‰ component_o = new ConcreteComponent(); component_d1 = new ConcreteDecorator1(component_o); component_d2 = new ConcreteDecorator2(component_d1); component_d2.operation(); //æ— æ³•å•ç‹¬è°ƒç”¨component_d2çš„addedBehavior()æ–¹æ³• â€¦â€¦ åŠé€æ˜è£…é¥°æ¨¡å¼ ç”¨å…·ä½“è£…é¥°ç±»å‹æ¥å®šä¹‰è£…é¥°ä¹‹åçš„å¯¹è±¡ï¼Œè€Œå…·ä½“æ„ä»¶ä½¿ç”¨æŠ½è±¡æ„ä»¶ç±»å‹æ¥å®šä¹‰ã€‚å¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œå…·ä½“æ„ä»¶ç±»å‹æ— é¡»å…³å¿ƒï¼Œæ˜¯é€æ˜çš„ï¼›ä½†æ˜¯å…·ä½“è£…é¥°ç±»å‹å¿…é¡»æŒ‡å®šï¼Œè¿™æ˜¯ä¸é€æ˜çš„ã€‚å¯ä»¥ç»™ç³»ç»Ÿå¸¦æ¥æ›´å¤šçš„çµæ´»æ€§ï¼Œè®¾è®¡ç›¸å¯¹ç®€å•ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸æ–¹ä¾¿ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨å…·ä½“è£…é¥°ç±»å‹æ¥å®šä¹‰è£…é¥°åçš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥å•ç‹¬è°ƒç”¨addedBehavior()æ–¹æ³•ã€‚æœ€å¤§çš„ç¼ºç‚¹åœ¨äºä¸èƒ½å®ç°å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¤šæ¬¡è£…é¥°ï¼Œè€Œä¸”å®¢æˆ·ç«¯éœ€è¦æœ‰åŒºåˆ«åœ°å¯¹å¾…è£…é¥°ä¹‹å‰çš„å¯¹è±¡å’Œè£…é¥°ä¹‹åçš„å¯¹è±¡ã€‚å®ä¾‹ï¼š â€¦â€¦ Component component_o; //ä½¿ç”¨æŠ½è±¡æ„ä»¶ç±»å‹å®šä¹‰ component_o = new ConcreteComponent(); component_o.operation(); ConcreteDecorator component_d; //ä½¿ç”¨å…·ä½“è£…é¥°ç±»å‹å®šä¹‰ component_d = new ConcreteDecorator(component_o); component_d.operation(); component_d.addedBehavior(); //å•ç‹¬è°ƒç”¨æ–°å¢ä¸šåŠ¡æ–¹æ³• â€¦â€¦ ","date":"2022-04-28","objectID":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["è£…é¥°æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹è£…é¥°æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/08.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["é—®é¢˜è®°å½•"],"content":"å¼€æœºåæŠ¥é”™å¦‚ä¸‹ï¼š æŠ¥è¿™ä¸ªé”™è¯¯å¤šæ•°æƒ…å†µä¸‹æ˜¯å› ä¸º/etc/fstabæ–‡ä»¶çš„é”™è¯¯ã€‚æ³¨æ„ä¸€ä¸‹æ˜¯ä¸æ˜¯åŠ è½½äº†å¤–éƒ¨ç¡¬ç›˜ã€å­˜å‚¨å™¨æˆ–è€…æ˜¯ç½‘ç»œå…±äº«ç©ºé—´ï¼Œåœ¨é‡å¯æ—¶æ²¡æœ‰åŠ è½½ä¸Šå¯¼è‡´çš„ã€‚ æˆ‘å°±æ˜¯å› ä¸ºåœ¨ä¸Šæ¬¡ç¼–è¾‘äº†/etc/fstabæ–‡ä»¶æƒ³å®ç°è‡ªåŠ¨æŒ‚è½½ï¼Œä½†é‡å¯å¹¶æ²¡æœ‰æŒ‚è½½æˆåŠŸå¯¼è‡´çš„ã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ¢å¤/etc/fstabæ–‡ä»¶ï¼Œå¤„ç†æ–¹æ³•å¦‚ä¸‹ï¼š å…ˆè¾“å…¥å¯†ç ç™»å½•rootè´¦æˆ·ï¼› è¾“å…¥vim /etc/fstabç¼–è¾‘ï¼Œæ³¨é‡Šæˆ–è€…ä¿®æ”¹è‡ªå·±å¢åŠ çš„å†…å®¹ï¼› è¿™é‡Œæˆ‘æŒ‚è½½defaultså†™æˆdefaultäº†ï¼Œæ‰€ä»¥ä¼šå‡ºé”™ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œç›´æ¥æ›´æ”¹åå°±æ²¡æœ‰é—®é¢˜äº†ã€‚ ä¿å­˜å¹¶é€€å‡ºï¼› è¾“å…¥rebooté‡å¯å³å¯æ¢å¤æ­£å¸¸ã€‚ ","date":"2022-04-26","objectID":"/posts/03.%E8%A7%A3%E5%86%B3linux%E7%B3%BB%E7%BB%9Fcentos7%E7%9A%84%E5%BC%80%E6%9C%BA%E6%8A%A5%E9%94%99welcome-to-emergency-mode/:0:0","tags":["Linux"],"title":"è§£å†³Linuxç³»ç»Ÿcentos7çš„å¼€æœºæŠ¥é”™ï¼šWelcome to emergency mode","uri":"/posts/03.%E8%A7%A3%E5%86%B3linux%E7%B3%BB%E7%BB%9Fcentos7%E7%9A%84%E5%BC%80%E6%9C%BA%E6%8A%A5%E9%94%99welcome-to-emergency-mode/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 ç»„åˆæ¨¡å¼ä»‹ç» åœ¨æˆ‘ä»¬çš„æ ‘å½¢ç›®å½•ç»“æ„ä¸­ï¼ŒåŒ…å«æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ä¸¤ç±»ä¸åŒçš„å…ƒç´ ï¼Œå¦‚ä¸‹å›¾ã€‚ å…¶ä¸­æ–‡ä»¶å¤¹ä¸­å¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç»§ç»­åŒ…å«æ–‡ä»¶å¤¹ï¼›è€Œåœ¨æ–‡ä»¶ä¸­ä¸èƒ½å†åŒ…å«å­æ–‡ä»¶æˆ–è€…å­æ–‡ä»¶å¤¹ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†æ–‡ä»¶å¤¹çœ‹ä½œæ˜¯å®¹å™¨ï¼ˆContainerï¼‰ï¼Œå°†æ–‡ä»¶çœ‹ä½œæ˜¯å¶å­ï¼ˆLeafï¼‰ã€‚é‚£å¦‚ä½•ä¸€è‡´çš„å¯¹å¾…å®¹å™¨å¯¹è±¡å’Œå¶å­å¯¹è±¡å‘¢ï¼Ÿ ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰è®©å®¢æˆ·ç«¯å¯ä»¥ç»Ÿä¸€å¯¹å¾…å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ã€‚è¿™ç§æ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«è‡ªå·±å¯¹è±¡ç»„çš„ç±»ã€‚è¯¥ç±»æä¾›äº†ä¿®æ”¹ç›¸åŒå¯¹è±¡ç»„çš„æ–¹å¼ã€‚ ä¸»è¦è§£å†³ï¼š å®ƒåœ¨æˆ‘ä»¬æ ‘å‹ç»“æ„çš„é—®é¢˜ä¸­ï¼Œæ¨¡ç³Šäº†ç®€å•å…ƒç´ å’Œå¤æ‚å…ƒç´ çš„æ¦‚å¿µï¼Œå®¢æˆ·ç¨‹åºå¯ä»¥åƒå¤„ç†ç®€å•å…ƒç´ ä¸€æ ·æ¥å¤„ç†å¤æ‚å…ƒç´ ï¼Œä»è€Œä½¿å¾—å®¢æˆ·ç¨‹åºä¸å¤æ‚å…ƒç´ çš„å†…éƒ¨ç»“æ„è§£è€¦ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š 1ã€æ‚¨æƒ³è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„ï¼ˆæ ‘å½¢ç»“æ„ï¼‰ã€‚ 2ã€æ‚¨å¸Œæœ›ç”¨æˆ·å¿½ç•¥ç»„åˆå¯¹è±¡ä¸å•ä¸ªå¯¹è±¡çš„ä¸åŒï¼Œç”¨æˆ·å°†ç»Ÿä¸€åœ°ä½¿ç”¨ç»„åˆç»“æ„ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚ å¦‚ä½•è§£å†³ï¼š æ ‘æå’Œå¶å­å®ç°ç»Ÿä¸€æ¥å£ï¼Œæ ‘æå†…éƒ¨ç»„åˆè¯¥æ¥å£ã€‚ å…³é”®ä»£ç ï¼š æ ‘æå†…éƒ¨ç»„åˆè¯¥æ¥å£ï¼Œå¹¶ä¸”å«æœ‰å†…éƒ¨å±æ€§ Listï¼Œé‡Œé¢æ”¾ Componentã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€ç®—æœ¯è¡¨è¾¾å¼åŒ…æ‹¬æ“ä½œæ•°ã€æ“ä½œç¬¦å’Œå¦ä¸€ä¸ªæ“ä½œæ•°ï¼Œå…¶ä¸­ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°ä¹Ÿå¯ä»¥æ˜¯æ“ä½œæ•°ã€æ“ä½œç¬¦å’Œå¦ä¸€ä¸ªæ“ä½œæ•°ã€‚ 2ã€åœ¨ JAVA AWT å’Œ SWING ä¸­ï¼Œå¯¹äº Button å’Œ Checkbox æ˜¯æ ‘å¶ï¼ŒContainer æ˜¯æ ‘æã€‚ ä¼˜ç‚¹ï¼š 1ã€é«˜å±‚æ¨¡å—è°ƒç”¨ç®€å•ã€‚ 2ã€èŠ‚ç‚¹è‡ªç”±å¢åŠ ã€‚ ç¼ºç‚¹ï¼š åœ¨ä½¿ç”¨ç»„åˆæ¨¡å¼æ—¶ï¼Œå…¶å¶å­å’Œæ ‘æçš„å£°æ˜éƒ½æ˜¯å®ç°ç±»ï¼Œè€Œä¸æ˜¯æ¥å£ï¼Œè¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ã€‚ ä½¿ç”¨åœºæ™¯ï¼š éƒ¨åˆ†ã€æ•´ä½“åœºæ™¯ï¼Œå¦‚æ ‘å½¢èœå•ï¼Œæ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„ç®¡ç†ã€‚ æ³¨æ„äº‹é¡¹ï¼š å®šä¹‰æ—¶ä¸ºå…·ä½“ç±»ã€‚ ","date":"2022-04-25","objectID":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["ç»„åˆæ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç»„åˆæ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 ç»„åˆæ¨¡å¼è¯¦è§£ ","date":"2022-04-25","objectID":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["ç»„åˆæ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç»„åˆæ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 ç»„åˆæ¨¡å¼ç»“æ„ ç»„åˆæ¨¡å¼çš„ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š ç”±å›¾å¯çŸ¥ï¼Œç»„åˆæ¨¡å¼åŒ…å«ä»¥ä¸‹3ä¸ªè§’è‰²ã€‚ Componentï¼ˆæŠ½è±¡æ„ä»¶ï¼‰ï¼šå®ƒå¯ä»¥æ˜¯æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œä¸ºå¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶å¯¹è±¡å£°æ˜æ¥å£ï¼Œåœ¨è¯¥è§’è‰²ä¸­å¯ä»¥åŒ…å«æ‰€æœ‰å­ç±»å…±æœ‰è¡Œä¸ºçš„å£°æ˜å’Œå®ç°ã€‚åœ¨æŠ½è±¡æ„ä»¶ä¸­å®šä¹‰äº†è®¿é—®åŠç®¡ç†å®ƒçš„å­æ„ä»¶çš„æ–¹æ³•ï¼Œå¦‚å¢åŠ å­æ„ä»¶ã€åˆ é™¤å­æ„ä»¶ã€è·å–å­æ„ä»¶ç­‰ã€‚ Leafï¼ˆå¶å­æ„ä»¶ï¼‰ï¼šå®ƒåœ¨ç»„åˆç»“æ„ä¸­è¡¨ç¤ºå¶å­ç»“ç‚¹å¯¹è±¡ï¼Œå¶å­ç»“ç‚¹æ²¡æœ‰å­ç»“ç‚¹ï¼Œå®ƒå®ç°äº†åœ¨æŠ½è±¡æ„ä»¶ä¸­å®šä¹‰çš„è¡Œä¸ºã€‚å¯¹äºé‚£äº›è®¿é—®åŠç®¡ç†å­æ„ä»¶çš„æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡æŠ›å‡ºå¼‚å¸¸ã€æç¤ºé”™è¯¯ç­‰æ–¹å¼è¿›è¡Œå¤„ç†ã€‚ Compositeï¼ˆå®¹å™¨æ„ä»¶ï¼‰ï¼šå®ƒåœ¨ç»„åˆç»“æ„ä¸­è¡¨ç¤ºå®¹å™¨ç»“ç‚¹å¯¹è±¡ï¼Œå®¹å™¨ç»“ç‚¹åŒ…å«å­ç»“ç‚¹ï¼Œå…¶å­ç»“ç‚¹å¯ä»¥æ˜¯å¶å­ç»“ç‚¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å®¹å™¨ç»“ç‚¹ï¼Œå®ƒæä¾›ä¸€ä¸ªé›†åˆç”¨äºå­˜å‚¨å­ç»“ç‚¹ï¼Œå®ç°ç±»åœ¨æŠ½è±¡æ„ä»¶ä¸­å®šä¹‰çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬é‚£äº›è®¿é—®åŠç®¡ç†å­æ„ä»¶çš„æ–¹æ³•ï¼Œåœ¨å…¶ä¸šåŠ¡æ–¹æ³•ä¸­å¯ä»¥é€’å½’è°ƒç”¨å…¶å­ç»“ç‚¹çš„ä¸šåŠ¡æ–¹æ³•ã€‚ ","date":"2022-04-25","objectID":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["ç»„åˆæ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç»„åˆæ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 ç»„åˆæ¨¡å¼å®ç° å¯¹äºç»„åˆæ¨¡å¼ä¸­çš„æŠ½è±¡æ„ä»¶è§’è‰²ï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public abstract class Component { public abstract void addComponent(Component c); // å¢åŠ æˆå‘˜ public abstract void remove(Component c); // åˆ é™¤æˆå‘˜ public abstract Component getChild(int i); // è·å–æˆå‘˜ public abstract void operation(); // ä¸šåŠ¡æ–¹æ³• } å¯¹äºç»„åˆæ¨¡å¼ä¸­çš„å¶å­æ„ä»¶è§’è‰²ï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class Leaf extends Component { public void add(Component c) { // å¼‚å¸¸å¤„ç†æˆ–é”™è¯¯æç¤º } public void remove(Component c) { // å¼‚å¸¸å¤„ç†æˆ–é”™è¯¯æç¤º } public void getChild(int i) { // å¼‚å¸¸å¤„ç†æˆ–é”™è¯¯æç¤º } public void operation() { // å¶å­æ„ä»¶å…·ä½“ä¸šåŠ¡æ–¹æ³•çš„å®ç° } } å¯¹äºç»„åˆæ¨¡å¼ä¸­çš„å®¹å™¨æ„ä»¶è§’è‰²ï¼Œå…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š import java.util.*; public class Composite extends Component { private ArrayList\u003cComponent\u003e list = new ArrayList\u003cComponent\u003e(); public void add(Component c) { list.add(c); } public void remove(Component c) { list.remove(c); } public void getChild(int i) { return (Componnent) list.get(i); } public void operation() { // å®¹å™¨æ„ä»¶å…·ä½“ä¸šåŠ¡æ–¹æ³•çš„å®ç°ï¼Œå°†é€’å½’è°ƒç”¨æˆå‘˜æ„ä»¶çš„ä¸šåŠ¡æ–¹æ³• for (Object object : list) { ((Component)obj).operation(); } } } ","date":"2022-04-25","objectID":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["ç»„åˆæ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç»„åˆæ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 ç»„åˆæ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸè½¯ä»¶å…¬å¸æ¬²å¼€å‘ä¸€ä¸ªæ€æ¯’(Antivirus)è½¯ä»¶ï¼Œè¯¥è½¯ä»¶æ—¢å¯ä»¥å¯¹æŸä¸ªæ–‡ä»¶å¤¹(Folder)æ€æ¯’ï¼Œä¹Ÿå¯ä»¥å¯¹æŸä¸ªæŒ‡å®šçš„æ–‡ä»¶(File)è¿›è¡Œæ€æ¯’ã€‚è¯¥æ€æ¯’è½¯ä»¶è¿˜å¯ä»¥æ ¹æ®å„ç±»æ–‡ä»¶çš„ç‰¹ç‚¹ï¼Œä¸ºä¸åŒç±»å‹çš„æ–‡ä»¶æä¾›ä¸åŒçš„æ€æ¯’æ–¹å¼ï¼Œä¾‹å¦‚å›¾åƒæ–‡ä»¶(ImageFile)å’Œæ–‡æœ¬æ–‡ä»¶(TextFile)çš„æ€æ¯’æ–¹å¼å°±æœ‰æ‰€å·®å¼‚ã€‚ç°ä½¿ç”¨ç»„åˆæ¨¡å¼æ¥è®¾è®¡è¯¥æ€æ¯’è½¯ä»¶çš„æ•´ä½“æ¡†æ¶ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒAbstractFileå……å½“æŠ½è±¡æ„ä»¶ç±»ï¼ŒFolderå……å½“å®¹å™¨æ„ä»¶ç±»ï¼ŒImageFileã€TextFileå’ŒVideoFileå……å½“å¶å­æ„ä»¶ç±»ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-25","objectID":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["ç»„åˆæ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç»„åˆæ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 é€æ˜ç»„åˆæ¨¡å¼å’Œå®‰å…¨ç»„åˆæ¨¡å¼ ç»„åˆæ¨¡å¼æ ¹æ®æŠ½è±¡æ„ä»¶çš„å®šä¹‰å½¢å¼åˆå¯ä»¥åˆ†ä¸ºé€æ˜ç»„åˆæ¨¡å¼å’Œå®‰å…¨ç»„åˆæ¨¡å¼ã€‚ é€æ˜ç»„åˆæ¨¡å¼ æ ¹æ®ç»“æ„å›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæŠ½è±¡æ„ä»¶Componentä¸­å£°æ˜äº†æ‰€æœ‰ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬add()ã€remove()ï¼Œä»¥åŠgetChild()ç­‰æ–¹æ³•ï¼Œåœ¨å®¢æˆ·ç«¯çœ‹æ¥ï¼Œå¶å­å¯¹è±¡ä¸å®¹å™¨å¯¹è±¡æ‰€æä¾›çš„æ–¹æ³•æ˜¯ä¸€è‡´çš„ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´åœ°å¯¹å¾…æ‰€æœ‰çš„å¯¹è±¡ï¼Œç¼ºç‚¹æ˜¯ä¸å¤Ÿå®‰å…¨ï¼Œå› ä¸ºå¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡åœ¨æœ¬è´¨ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ã€‚ å®‰å…¨ç»„åˆæ¨¡å¼ æ ¹æ®ç»“æ„å›¾å¯ä»¥çœ‹å‡ºæŠ½è±¡æ„ä»¶Componentä¸­æ²¡æœ‰å£°æ˜ä»»ä½•ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨Compositeç±»ä¸­å£°æ˜å¹¶å®ç°è¿™äº›æ–¹æ³•ï¼Œå¯¹äºå¶å­å¯¹è±¡ï¼Œå®¢æˆ·ç«¯ä¸å¯èƒ½è°ƒç”¨åˆ°è¿™äº›æ–¹æ³•ã€‚ç¼ºç‚¹æ˜¯ä¸å¤Ÿé€æ˜ï¼Œå®¢æˆ·ç«¯ä¸èƒ½å®Œå…¨é’ˆå¯¹æŠ½è±¡ç¼–ç¨‹ï¼Œå¿…é¡»æœ‰åŒºåˆ«åœ°å¯¹å¾…å¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶ã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå®‰å…¨ç»„åˆæ¨¡å¼çš„ä½¿ç”¨é¢‘ç‡ä¹Ÿéå¸¸é«˜ã€‚ ","date":"2022-04-25","objectID":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["ç»„åˆæ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹ç»„åˆæ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/07.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 æ¡¥æ¥æ¨¡å¼ä»‹ç» æ¯›ç¬”å’Œèœ¡ç¬”æ˜¯ä¸¤ç§å¾ˆå¸¸è§çš„æ–‡å…·ï¼Œå®ƒä»¬éƒ½å½’å±äºç”»ç¬”ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦å¤§ã€ä¸­ã€å°3ç§å‹å·çš„ç”»ç¬”ï¼Œèƒ½å¤Ÿç»˜åˆ¶12ç§ä¸åŒçš„é¢œè‰²ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š æ˜¾ç„¶ï¼Œåœ¨æ¯›ç¬”ä¸­ï¼Œæˆ‘ä»¬å°†é¢œè‰²å’Œå‹å·è¿›è¡Œäº†åˆ†ç¦»ï¼Œå¢åŠ æ–°çš„é¢œè‰²æˆ–è€…å‹å·å¯¹å¦ä¸€æ–¹æ²¡æœ‰å½±å“ï¼Œå³ç”¨è½¯ä»¶å·¥ç¨‹ä¸­çš„æœ¯è¯­ï¼Œå¯ä»¥è®¤ä¸ºåœ¨èœ¡ç¬”ä¸­é¢œè‰²å’Œå‹å·ä¹‹é—´å­˜åœ¨è¾ƒå¼ºçš„è€¦åˆæ€§ï¼Œè€Œæ¯›ç¬”å¾ˆå¥½åœ°å°†äºŒè€…è§£è€¦ï¼Œä½¿ç”¨èµ·æ¥éå¸¸çµæ´»ï¼Œæ‰©å±•ä¹Ÿè¾ƒä¸ºæ–¹ä¾¿ã€‚ åœ¨è½¯ä»¶å¼€å‘ä¸­ä¹Ÿæœ‰ä¸€ç§è®¾è®¡æ¨¡å¼å¯ä»¥ç”¨æ¥å¤„ç†ä¸Šè¿°ç±»ä¼¼çš„å…·æœ‰å¤šå˜åŒ–ç»´åº¦çš„æƒ…å†µï¼Œå®ƒå°±æ˜¯æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰ã€‚å®ƒå°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†è§£è€¦ï¼Œä½¿å¾—ä¸¤è€…éƒ½èƒ½ç‹¬ç«‹å˜åŒ–ã€‚ æ¡¥æ¥æ¨¡å¼åˆè¢«ç§°ä¸ºæŸ„ä½“(Handle and Body)æ¨¡å¼æˆ–æ¥å£(Interface)æ¨¡å¼ï¼Œç”¨æŠ½è±¡å…³è”å–ä»£äº†ä¼ ç»Ÿçš„å¤šå±‚ç»§æ‰¿ï¼Œå°†ç±»ä¹‹é—´çš„é™æ€ç»§æ‰¿å…³ç³»è½¬æ¢ä¸ºåŠ¨æ€çš„å¯¹è±¡ç»„åˆå…³ç³»ã€‚ ä¸»è¦è§£å†³ï¼š åœ¨æœ‰å¤šç§å¯èƒ½ä¼šå˜åŒ–çš„æƒ…å†µä¸‹ï¼Œç”¨ç»§æ‰¿ä¼šé€ æˆç±»çˆ†ç‚¸é—®é¢˜ï¼Œæ‰©å±•èµ·æ¥ä¸çµæ´»ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š å®ç°ç³»ç»Ÿå¯èƒ½æœ‰å¤šä¸ªè§’åº¦åˆ†ç±»ï¼Œæ¯ä¸€ç§è§’åº¦éƒ½å¯èƒ½å˜åŒ–ã€‚ **å¦‚ä½•è§£å†³ï¼š**æŠŠè¿™ç§å¤šè§’åº¦åˆ†ç±»åˆ†ç¦»å‡ºæ¥ï¼Œè®©å®ƒä»¬ç‹¬ç«‹å˜åŒ–ï¼Œå‡å°‘å®ƒä»¬ä¹‹é—´è€¦åˆã€‚ å…³é”®ä»£ç ï¼š æŠ½è±¡ç±»ä¾èµ–å®ç°ç±»ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€çŒªå…«æˆ’ä»å¤©è“¬å…ƒå¸…è½¬ä¸–æŠ•èƒåˆ°çŒªï¼Œè½¬ä¸–æŠ•èƒçš„æœºåˆ¶å°†å°˜ä¸–åˆ’åˆ†ä¸ºä¸¤ä¸ªç­‰çº§ï¼Œå³ï¼šçµé­‚å’Œè‚‰ä½“ï¼Œå‰è€…ç›¸å½“äºæŠ½è±¡åŒ–ï¼Œåè€…ç›¸å½“äºå®ç°åŒ–ã€‚ç”Ÿçµé€šè¿‡åŠŸèƒ½çš„å§”æ´¾ï¼Œè°ƒç”¨è‚‰ä½“å¯¹è±¡çš„åŠŸèƒ½ï¼Œä½¿å¾—ç”Ÿçµå¯ä»¥åŠ¨æ€åœ°é€‰æ‹©ã€‚ 2ã€å¢™ä¸Šçš„å¼€å…³ï¼Œå¯ä»¥çœ‹åˆ°çš„å¼€å…³æ˜¯æŠ½è±¡çš„ï¼Œä¸ç”¨ç®¡é‡Œé¢å…·ä½“æ€ä¹ˆå®ç°çš„ã€‚ ä¼˜ç‚¹ï¼š 1ã€æŠ½è±¡å’Œå®ç°çš„åˆ†ç¦»ã€‚ 2ã€ä¼˜ç§€çš„æ‰©å±•èƒ½åŠ›ã€‚ 3ã€å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜ã€‚ **ç¼ºç‚¹ï¼š**æ¡¥æ¥æ¨¡å¼çš„å¼•å…¥ä¼šå¢åŠ ç³»ç»Ÿçš„ç†è§£ä¸è®¾è®¡éš¾åº¦ï¼Œç”±äºèšåˆå…³è”å…³ç³»å»ºç«‹åœ¨æŠ½è±¡å±‚ï¼Œè¦æ±‚å¼€å‘è€…é’ˆå¯¹æŠ½è±¡è¿›è¡Œè®¾è®¡ä¸ç¼–ç¨‹ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€å¦‚æœä¸€ä¸ªç³»ç»Ÿéœ€è¦åœ¨æ„ä»¶çš„æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“åŒ–è§’è‰²ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§ï¼Œé¿å…åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¹‹é—´å»ºç«‹é™æ€çš„ç»§æ‰¿è”ç³»ï¼Œé€šè¿‡æ¡¥æ¥æ¨¡å¼å¯ä»¥ä½¿å®ƒä»¬åœ¨æŠ½è±¡å±‚å»ºç«‹ä¸€ä¸ªå…³è”å…³ç³»ã€‚ 2ã€å¯¹äºé‚£äº›ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œæ¡¥æ¥æ¨¡å¼å°¤ä¸ºé€‚ç”¨ã€‚ 3ã€ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦è¿›è¡Œæ‰©å±•ã€‚ æ³¨æ„äº‹é¡¹ï¼š å¯¹äºä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä½¿ç”¨æ¡¥æ¥æ¨¡å¼å†é€‚åˆä¸è¿‡äº†ã€‚ ","date":"2022-04-24","objectID":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["æ¡¥æ¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 æ¡¥æ¥æ¨¡å¼è¯¦è§£ ","date":"2022-04-24","objectID":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["æ¡¥æ¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 æ¡¥æ¥æ¨¡å¼ç»“æ„ æ¡¥æ¥æ¨¡å¼çš„ç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼Œæ¡¥æ¥æ¨¡å¼åŒ…æ‹¬ä»¥ä¸‹4ä¸ªè§’è‰²ã€‚ Abstractionï¼ˆæŠ½è±¡ç±»ï¼‰ï¼šå®ƒæ˜¯ç”¨äºå®šä¹‰æŠ½è±¡ç±»çš„æ¥å£ï¼Œé€šå¸¸æ˜¯æŠ½è±¡ç±»è€Œä¸æ˜¯æ¥å£ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªImplementorï¼ˆå®ç°ç±»æ¥å£ï¼‰ç±»å‹çš„å¯¹è±¡å¹¶å¯ä»¥ç»´æŠ¤è¯¥å¯¹è±¡ï¼Œå®ƒä¸Implementorä¹‹é—´å…·æœ‰å…³è”å…³ç³»ï¼Œå®ƒæ—¢å¯ä»¥åŒ…å«æŠ½è±¡ä¸šåŠ¡æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åŒ…å«å…·ä½“ä¸šåŠ¡æ–¹æ³•ã€‚ RefinedAbstractionï¼ˆæ‰©å……æŠ½è±¡ç±»ï¼‰ï¼šå®ƒæ‰©å……ç”±Abstractionå®šä¹‰çš„æ¥å£ï¼Œé€šå¸¸æƒ…å†µä¸‹å®ƒä¸å†æ˜¯æŠ½è±¡ç±»è€Œæ˜¯å…·ä½“ç±»ï¼Œå®ç°äº†åœ¨Abstractionä¸­å£°æ˜çš„æŠ½è±¡ä¸šåŠ¡æ–¹æ³•ï¼Œåœ¨RefinedAbstractionä¸­å¯ä»¥è°ƒç”¨åœ¨Implementorä¸­å®šä¹‰çš„ä¸šåŠ¡æ–¹æ³•ã€‚ Implementorï¼ˆå®ç°ç±»æ¥å£ï¼‰ï¼šå®ƒæ˜¯å®šä¹‰å®ç°ç±»çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä¸ä¸€å®šè¦ä¸Abstractionçš„æ¥å£å®Œå…¨ä¸€è‡´ï¼Œäº‹å®ä¸Šè¿™ä¸¤ä¸ªæ¥å£å¯ä»¥å®Œå…¨ä¸åŒã€‚ä¸€èˆ¬è€Œè¨€ï¼ŒImplementoræ¥å£ä»…æä¾›åŸºæœ¬æ“ä½œï¼Œè€ŒAbstractionå®šä¹‰çš„æ¥å£å¯èƒ½ä¼šåšæ›´å¤šæ›´å¤æ‚çš„æ“ä½œã€‚Implementoræ¥å£å¯¹è¿™äº›åŸºæœ¬æ“ä½œè¿›è¡Œäº†å£°æ˜ï¼Œè€Œå…·ä½“å®ç°äº¤ç»™å…¶å­ç±»ã€‚é€šè¿‡å…³è”å…³ç³»ï¼Œåœ¨Abstractionä¸­ä¸ä»…æ‹¥æœ‰è‡ªå·±çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥è°ƒç”¨åˆ°Implementorä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œä½¿ç”¨å…³è”å…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»ã€‚ ConcreteImplementorï¼ˆå…·ä½“å®ç°ç±»ï¼‰ï¼šå®ƒå…·ä½“å®ç°äº†Implementoræ¥å£ï¼Œåœ¨ä¸åŒçš„ConcreteImplementorä¸­æä¾›åŸºæœ¬æ“ä½œçš„ä¸åŒå®ç°ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ConcreteImplementorå¯¹è±¡å°†æ›¿æ¢å…¶çˆ¶ç±»å¯¹è±¡ï¼Œæä¾›ç»™æŠ½è±¡ç±»å…·ä½“çš„ä¸šåŠ¡æ“ä½œæ–¹æ³•ã€‚ ","date":"2022-04-24","objectID":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["æ¡¥æ¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 æ¡¥æ¥æ¨¡å¼å®ç° åœ¨å…·ä½“ç¼–ç å®ç°æ—¶ï¼Œç”±äºåœ¨æ¡¥æ¥æ¨¡å¼ä¸­å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸ºäº†é™ä½ä¸¤è€…ä¹‹é—´çš„è€¦åˆåº¦ï¼Œé¦–å…ˆéœ€è¦é’ˆå¯¹ä¸¤ä¸ªä¸åŒçš„ç»´åº¦æå–æŠ½è±¡ç±»å’Œå®ç°ç±»æ¥å£ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªæŠ½è±¡å…³è”å…³ç³»ã€‚å¯¹äºâ€œå®ç°éƒ¨åˆ†ç»´åº¦â€ï¼Œå…¸å‹çš„æ¥å£ä»£ç å¦‚ä¸‹ï¼š public interface Implementor { public void operationImpl(); } åœ¨å®ç°Implementoræ¥å£çš„å­ç±»ConcreteImplementorä¸­å®ç°äº†åœ¨è¯¥æ¥å£ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œç”¨äºå®šä¹‰ä¸è¯¥ç»´åº¦ç›¸å¯¹åº”çš„ä¸€äº›å…·ä½“æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š public class ConcreteImplementor implements Implementor { public void operationImpl() { //å…·ä½“ä¸šåŠ¡æ–¹æ³•çš„å®ç° } } å¯¹äºå¦ä¸€â€œæŠ½è±¡éƒ¨åˆ†â€ç»´åº¦è€Œè¨€ï¼Œå…¶å…¸å‹çš„æŠ½è±¡ç±»ä»£ç å¦‚ä¸‹ï¼š public abstract class Abstraction { protected Implementor impl; //å®šä¹‰å®ç°ç±»æ¥å£å¯¹è±¡ public void setImpl(Implementor impl) { this.impl = impl; } public abstract void operation(); //å£°æ˜æŠ½è±¡ä¸šåŠ¡æ–¹æ³• } åœ¨æŠ½è±¡ç±»Abstractionä¸­å®šä¹‰äº†ä¸€ä¸ªå®ç°ç±»æ¥å£ç±»å‹çš„æˆå‘˜å¯¹è±¡implï¼Œå†é€šè¿‡Setteræ–¹æ³•æˆ–è€…æ„é€ æ–¹æ³•ä»¥æ³¨å…¥çš„æ–¹å¼ç»™è¯¥å¯¹è±¡èµ‹å€¼ã€‚ä¸€èˆ¬å°†è¯¥å¯¹è±¡çš„å¯è§æ€§å®šä¹‰ä¸ºprotectedï¼Œä»¥ä¾¿åœ¨å…¶å­ç±»ä¸­è®¿é—®Implementorçš„æ–¹æ³•ï¼Œå…¶å­ç±»ä¸€èˆ¬ç§°ä¸ºæ‰©å……å¯¹è±¡ç±»æˆ–ç»†åŒ–æŠ½è±¡ç±»ï¼ˆRefinedAbstractionï¼‰ï¼Œå…¸å‹çš„RefinedAbstractionç±»ä»£ç å¦‚ä¸‹ï¼š public class RefinedAbstraction extends Abstraction { public void operation() { //ä¸šåŠ¡ä»£ç  impl.operationImpl(); //è°ƒç”¨å®ç°ç±»çš„æ–¹æ³• //ä¸šåŠ¡ä»£ç  } } å¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œå¯ä»¥é’ˆå¯¹ä¸¤ä¸ªç»´åº¦çš„æŠ½è±¡å±‚ç¼–ç¨‹ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶å†åŠ¨æ€ç¡®å®šä¸¤ä¸ªç»´åº¦çš„å­ç±»ï¼ŒåŠ¨æ€ç»„åˆå¯¹è±¡ï¼Œå°†ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦å®Œå…¨è§£è€¦ï¼Œä»¥ä¾¿èƒ½å¤Ÿçµæ´»åœ°æ‰©å……ä»»ä¸€ç»´åº¦è€Œå¯¹å¦ä¸€ç»´åº¦ä¸é€ æˆä»»ä½•å½±å“ã€‚ ","date":"2022-04-24","objectID":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["æ¡¥æ¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 æ¡¥æ¥æ¨¡å¼åº”ç”¨å®ä¾‹ é¢˜ç›®æè¿° æŸè½¯ä»¶å…¬å¸æ¬²å¼€å‘ä¸€ä¸ªæ•°æ®è½¬æ¢å·¥å…·ï¼Œå¯ä»¥å°†æ•°æ®åº“ä¸­çš„æ•°æ®è½¬æ¢æˆå¤šç§æ–‡ä»¶æ ¼å¼ï¼Œä¾‹å¦‚TXTã€XMLã€PDFç­‰æ ¼å¼ï¼ŒåŒæ—¶è¯¥å·¥å…·éœ€è¦æ”¯æŒå¤šç§ä¸åŒçš„æ•°æ®åº“ã€‚è¯•ç”¨æ¡¥æ¥æ¨¡å¼å¯¹å…¶è¿›è¡Œè®¾è®¡ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒFileConvertor å……å½“æŠ½è±¡ç±»è§’è‰²ï¼ŒTXTConvertorã€XMLConvertor å’Œ PDFConvertor å……å½“æ‰©å……æŠ½è±¡ç±»è§’è‰²ï¼ŒDataHandler å……å½“å®ç°ç±»æ¥å£è§’è‰²ï¼ŒOracleHandler å’ŒSQLServerHandlerå……å½“å…·ä½“å®ç°ç±»è§’è‰²ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-24","objectID":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["æ¡¥æ¥æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 é€‚é…å™¨æ¨¡å¼ä»‹ç» åœ¨ç°å®ç”Ÿæ´»ä¸­ç”Ÿæ´»ç”¨ç”µ220Vå’Œç¬”è®°ç”µè„‘20Vä¸å…¼å®¹ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ AC Adapterï¼ˆäº¤æµç”µé€‚é…å™¨ï¼‰ï¼Œåœ¨è½¯ä»¶å¼€å‘ä¸­æˆ‘ä»¬ä¹Ÿä¼šå­˜åœ¨ä¸å…¼å®¹çš„ç»“æ„ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¼•å…¥é€‚é…å™¨æ¨¡å¼ã€‚ é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰å¯ä»¥å°†ä¸€ä¸ªç±»çš„æ¥å£å’Œå¦ä¸€ä¸ªç±»çš„æ¥å£åŒ¹é…èµ·æ¥ï¼Œè€Œæ— éœ€ä¿®æ”¹åŸæ¥çš„é€‚é…è€…æ¥å£å’ŒæŠ½è±¡ç›®æ ‡æ¥å£ã€‚ å®ƒå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢ç§°å®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œè®©é‚£äº›æ¥å£ä¸å…¼å®¹çš„ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ é€‚é…å™¨æ¨¡å¼çš„åˆ«åä¸ºåŒ…è£…å™¨æ¨¡å¼ï¼ˆWrapper Patternï¼‰ï¼Œå®ƒæ—¢å¯ä»¥ä½œä¸ºç±»ç»“æ„æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚åœ¨é€‚é…å™¨æ¨¡å¼çš„å®šä¹‰ä¸­æ‰€æåŠçš„æ¥å£æ˜¯æŒ‡å¹¿ä¹‰çš„æ¥å£ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸ºæ–¹æ³•æˆ–è€…æ–¹æ³•çš„é›†åˆã€‚ ä¸»è¦è§£å†³ï¼š ä¸»è¦è§£å†³åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œå¸¸å¸¸è¦å°†ä¸€äº›\"ç°å­˜çš„å¯¹è±¡\"æ”¾åˆ°æ–°çš„ç¯å¢ƒä¸­ï¼Œè€Œæ–°ç¯å¢ƒè¦æ±‚çš„æ¥å£æ˜¯ç°å¯¹è±¡ä¸èƒ½æ»¡è¶³çš„ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š 1ã€ç³»ç»Ÿéœ€è¦ä½¿ç”¨ç°æœ‰çš„ç±»ï¼Œè€Œæ­¤ç±»çš„æ¥å£ä¸ç¬¦åˆç³»ç»Ÿçš„éœ€è¦ã€‚ 2ã€æƒ³è¦å»ºç«‹ä¸€ä¸ªå¯ä»¥é‡å¤ä½¿ç”¨çš„ç±»ï¼Œç”¨äºä¸ä¸€äº›å½¼æ­¤ä¹‹é—´æ²¡æœ‰å¤ªå¤§å…³è”çš„ä¸€äº›ç±»ï¼ŒåŒ…æ‹¬ä¸€äº›å¯èƒ½åœ¨å°†æ¥å¼•è¿›çš„ç±»ä¸€èµ·å·¥ä½œï¼Œè¿™äº›æºç±»ä¸ä¸€å®šæœ‰ä¸€è‡´çš„æ¥å£ã€‚ 3ã€é€šè¿‡æ¥å£è½¬æ¢ï¼Œå°†ä¸€ä¸ªç±»æ’å…¥å¦ä¸€ä¸ªç±»ç³»ä¸­ã€‚ï¼ˆæ¯”å¦‚è€è™å’Œé£ç¦½ï¼Œç°åœ¨å¤šäº†ä¸€ä¸ªé£è™ï¼Œåœ¨ä¸å¢åŠ å®ä½“çš„éœ€æ±‚ä¸‹ï¼Œå¢åŠ ä¸€ä¸ªé€‚é…å™¨ï¼Œåœ¨é‡Œé¢åŒ…å®¹ä¸€ä¸ªè™å¯¹è±¡ï¼Œå®ç°é£çš„æ¥å£ã€‚ï¼‰ å¦‚ä½•è§£å†³ï¼š ç»§æ‰¿æˆ–ä¾èµ–ï¼ˆæ¨èï¼‰ã€‚ å…³é”®ä»£ç ï¼š é€‚é…å™¨ç»§æ‰¿æˆ–ä¾èµ–å·²æœ‰çš„å¯¹è±¡ï¼Œå®ç°æƒ³è¦çš„ç›®æ ‡æ¥å£ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€ç¾å›½ç”µå™¨ 110Vï¼Œä¸­å›½ 220Vï¼Œå°±è¦æœ‰ä¸€ä¸ªé€‚é…å™¨å°† 110V è½¬åŒ–ä¸º 220Vã€‚ 2ã€JAVA JDK 1.1 æä¾›äº† Enumeration æ¥å£ï¼Œè€Œåœ¨ 1.2 ä¸­æä¾›äº† Iterator æ¥å£ï¼Œæƒ³è¦ä½¿ç”¨ 1.2 çš„ JDKï¼Œåˆ™è¦å°†ä»¥å‰ç³»ç»Ÿçš„ Enumeration æ¥å£è½¬åŒ–ä¸º Iterator æ¥å£ï¼Œè¿™æ—¶å°±éœ€è¦é€‚é…å™¨æ¨¡å¼ã€‚ 3ã€åœ¨ LINUX ä¸Šè¿è¡Œ WINDOWS ç¨‹åºã€‚ 4ã€JAVA ä¸­çš„ jdbcã€‚ ä¼˜ç‚¹ï¼š 1ã€å¯ä»¥è®©ä»»ä½•ä¸¤ä¸ªæ²¡æœ‰å…³è”çš„ç±»ä¸€èµ·è¿è¡Œã€‚ 2ã€æé«˜äº†ç±»çš„å¤ç”¨ã€‚ 3ã€å¢åŠ äº†ç±»çš„é€æ˜åº¦ã€‚ 4ã€çµæ´»æ€§å¥½ã€‚ ç¼ºç‚¹ï¼š 1ã€è¿‡å¤šåœ°ä½¿ç”¨é€‚é…å™¨ï¼Œä¼šè®©ç³»ç»Ÿéå¸¸é›¶ä¹±ï¼Œä¸æ˜“æ•´ä½“è¿›è¡ŒæŠŠæ¡ã€‚æ¯”å¦‚ï¼Œæ˜æ˜çœ‹åˆ°è°ƒç”¨çš„æ˜¯ A æ¥å£ï¼Œå…¶å®å†…éƒ¨è¢«é€‚é…æˆäº† B æ¥å£çš„å®ç°ï¼Œä¸€ä¸ªç³»ç»Ÿå¦‚æœå¤ªå¤šå‡ºç°è¿™ç§æƒ…å†µï¼Œæ— å¼‚äºä¸€åœºç¾éš¾ã€‚å› æ­¤å¦‚æœä¸æ˜¯å¾ˆæœ‰å¿…è¦ï¼Œå¯ä»¥ä¸ä½¿ç”¨é€‚é…å™¨ï¼Œè€Œæ˜¯ç›´æ¥å¯¹ç³»ç»Ÿè¿›è¡Œé‡æ„ã€‚ 2.ç”±äº JAVA è‡³å¤šç»§æ‰¿ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥è‡³å¤šåªèƒ½é€‚é…ä¸€ä¸ªé€‚é…è€…ç±»ï¼Œè€Œä¸”ç›®æ ‡ç±»å¿…é¡»æ˜¯æŠ½è±¡ç±»ã€‚ ä½¿ç”¨åœºæ™¯ï¼š æœ‰åŠ¨æœºåœ°ä¿®æ”¹ä¸€ä¸ªæ­£å¸¸è¿è¡Œçš„ç³»ç»Ÿçš„æ¥å£ï¼Œè¿™æ—¶åº”è¯¥è€ƒè™‘ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ã€‚ æ³¨æ„äº‹é¡¹ï¼š é€‚é…å™¨ä¸æ˜¯åœ¨è¯¦ç»†è®¾è®¡æ—¶æ·»åŠ çš„ï¼Œè€Œæ˜¯è§£å†³æ­£åœ¨æœå½¹çš„é¡¹ç›®çš„é—®é¢˜ã€‚ ","date":"2022-04-24","objectID":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["é€‚é…å™¨æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 é€‚é…å™¨æ¨¡å¼è¯¦è§£ ","date":"2022-04-24","objectID":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["é€‚é…å™¨æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 é€‚é…å™¨æ¨¡å¼ç»“æ„ ç±»é€‚é…å™¨æ¨¡å¼çš„ç»“æ„å›¾å¦‚ä¸‹ï¼š å¯¹è±¡é€‚é…å™¨æ¨¡å¼çš„ç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼Œé€‚é…å™¨æ¨¡å¼åŒ…å«ä»¥ä¸‹3ä¸ªè§’è‰²ã€‚ Targetï¼ˆç›®æ ‡æŠ½è±¡ç±»ï¼‰ï¼šç›®æ ‡æŠ½è±¡ç±»å®šä¹‰å®¢æˆ·æ‰€éœ€çš„æ¥å£ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯å…·ä½“ç±»ã€‚åœ¨ç±»é€‚é…å™¨ä¸­ï¼Œç”±äºJavaè¯­è¨€ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå®ƒåªèƒ½æ˜¯æ¥å£ã€‚ Adapterï¼ˆé€‚é…å™¨ç±»ï¼‰ï¼šå®ƒå¯ä»¥è°ƒç”¨å¦ä¸€ä¸ªæ¥å£ ï¼Œä½œä¸ºä¸€ä¸ªè½¬æ¢å™¨ï¼Œå¯¹Adapteeå’ŒTargetè¿›è¡Œé€‚é…ã€‚é€‚é…å™¨Adapteræ˜¯é€‚é…å™¨æ¨¡å¼çš„æ ¸å¿ƒï¼Œåœ¨ç±»é€‚é…å™¨ä¸­ï¼Œå®ƒé€šè¿‡å®ç°Targetæ¥å£å¹¶ç»§æ‰¿Adapteeç±»æ¥ä½¿äºŒè€…äº§ç”Ÿè”ç³»ï¼Œåœ¨å¯¹è±¡é€‚é…å™¨ä¸­ï¼Œå®ƒé€šè¿‡ç»§æ‰¿Targetå¹¶å…³è”ä¸€ä¸ªAdapteeå¯¹è±¡æ¥ä½¿äºŒè€…äº§ç”Ÿè”ç³»ã€‚ Adapteeï¼ˆé€‚é…è€…ç±»ï¼‰ï¼šé€‚é…è€…å³è¢«é€‚é…çš„è§’è‰²ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£éœ€è¦é€‚é…ï¼Œé€‚é…è€…ç±»ä¸€èˆ¬æ˜¯ä¸€ä¸ªå…·ä½“çš„ç±»ï¼ŒåŒ…å«äº†å®¢æˆ·å¸Œæœ›ä½¿ç”¨çš„ä¸šåŠ¡æ–¹æ³•ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ç”šè‡³æ²¡æœ‰é€‚é…è€…ç±»çš„ä»£ç ã€‚ ","date":"2022-04-24","objectID":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["é€‚é…å™¨æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 é€‚é…å™¨æ¨¡å¼å®ç° 2.2.1 ç±»é€‚é…å™¨ æ ¹æ®ä¸Šå›¾ï¼Œåœ¨ç±»é€‚é…å™¨ä¸­é€‚é…è€…ç±»Adapteeæ²¡æœ‰requestæ–¹æ³•ï¼Œè€Œå®¢æˆ·ç«¯æœŸå¾…è¿™ä¸ªæ–¹æ³•ï¼Œä½†åœ¨é€‚é…è€…ç±»ä¸­å®ç°äº†specificRequest()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æä¾›çš„å®ç°æ­£å¼å®¢æˆ·ç«¯æ‰€éœ€è¦çš„ã€‚ä¸ºäº†ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä½¿ç”¨é€‚é…è€…ç±»ï¼Œæä¾›äº†ä¸€ä¸ªä¸­é—´ç±»ï¼Œå³é€‚é…å™¨ç±»Adapterï¼Œé€‚é…å™¨ç±»å®ç°äº†æŠ½è±¡ç›®æ ‡ç±»æ¥å£Targetï¼Œå¹¶ç»§æ‰¿äº†é€‚é…è€…ç±»ï¼Œåœ¨é€‚é…å™¨ç±»çš„request()æ–¹æ³•ä¸­è°ƒç”¨æ‰€ç»§æ‰¿çš„é€‚é…è€…ç±»çš„specificRequest()æ–¹æ³•ï¼Œè¾¾åˆ°äº†é€‚é…çš„ç›®çš„ã€‚ å› ä¸ºé€‚é…å™¨ç±»ä¸é€‚é…è€…ç±»ä½¿ç»§æ‰¿å…³ç³»ï¼Œæ‰€ä»¥è¿™ç§é€‚é…å™¨æ¨¡å¼ç§°ä¸ºç±»é€‚é…å™¨æ¨¡å¼ã€‚å…¸å‹çš„ç±»é€‚é…å™¨ä»£ç å¦‚ä¸‹ï¼š public class Adapter extends Adaptee implements Target { public void request() { super.specificRequest(); } } 2.2.2 å¯¹è±¡é€‚é…å™¨ æ ¹æ®ä¸Šå›¾ï¼Œåœ¨å¯¹è±¡é€‚é…å™¨ä¸­é€‚é…è€…ç±»Adapteeæ²¡æœ‰requestæ–¹æ³•ï¼Œè€Œå®¢æˆ·ç«¯æœŸå¾…è¿™ä¸ªæ–¹æ³•ï¼Œä½†åœ¨é€‚é…è€…ç±»ä¸­å®ç°äº†specificRequest()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æä¾›çš„å®ç°æ­£å¼å®¢æˆ·ç«¯æ‰€éœ€è¦çš„ã€‚ä¸ºäº†ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä½¿ç”¨é€‚é…è€…ç±»ï¼Œéœ€è¦æä¾›ä¸€ä¸ªåŒ…è£…ç±»Adapterï¼Œå³é€‚é…å™¨ç±»ã€‚ è¿™ä¸ªåŒ…è£…ç±»åŒ…è£…äº†ä¸€ä¸ªé€‚é…è€…çš„å®ä¾‹ï¼Œä»è€Œå°†å®¢æˆ·ç«¯ä¸é€‚é…è€…è¡”æ¥èµ·æ¥ï¼Œåœ¨é€‚é…å™¨çš„request()æ–¹æ³•ä¸­è°ƒç”¨é€‚é…è€…çš„specificRequest()æ–¹æ³•ã€‚ å› ä¸ºé€‚é…å™¨ç±»ä¸é€‚é…è€…ç±»æ˜¯å…³è”å…³ç³»ï¼Œæ‰€ä»¥è¿™ç§é€‚é…å™¨æ¨¡å¼ç§°ä¸ºå¯¹è±¡é€‚é…å™¨æ¨¡å¼ã€‚å…¸å‹çš„å¯¹è±¡é€‚é…å™¨ä»£ç å¦‚ä¸‹ï¼š public class Adapter extends Target { // ç»´æŒä¸€ä¸ªå¯¹é€‚é…è€…å¯¹è±¡çš„å¼•ç”¨ private Adaptee adaptee; public Adapter(Adaptee adaptee) { this.adaptee = adaptee; } public void request() { // è½¬å‘è°ƒç”¨ adaptee.specificRequest(); } } ","date":"2022-04-24","objectID":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["é€‚é…å™¨æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 é€‚é…å™¨æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸå…¬å¸æ¬²å¼€å‘ä¸€æ¬¾å„¿ç«¥ç©å…·æ±½è½¦ï¼Œä¸ºäº†æ›´å¥½åœ°å¸å¼•å°æœ‹å‹çš„æ³¨æ„åŠ›ï¼Œè¯¥ç©å…·æ±½è½¦åœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­ä¼´éšç€ç¯å…‰é—ªçƒå’Œå£°éŸ³æç¤ºã€‚åœ¨è¯¥å…¬å¸ä»¥å¾€çš„äº§å“ä¸­å·²ç»å®ç°äº†æ§åˆ¶ç¯å…‰é—ªçƒï¼ˆä¾‹å¦‚è­¦ç¯é—ªçƒï¼‰å’Œå£°éŸ³æç¤ºï¼ˆä¾‹å¦‚è­¦ç¬›éŸ³æ•ˆï¼‰çš„ç¨‹åºï¼Œä¸ºäº†é‡ç”¨å…ˆå‰çš„ä»£ç å¹¶ä¸”ä½¿å¾—æ±½è½¦æ§åˆ¶è½¯ä»¶å…·æœ‰æ›´å¥½çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ï¼Œç°ä½¿ç”¨é€‚é…å™¨æ¨¡å¼è®¾è®¡è¯¥ç©å…·æ±½è½¦æ§åˆ¶è½¯ä»¶ã€‚ UMLç±»å›¾ ä½¿ç”¨å¯¹è±¡é€‚é…å™¨æ¨¡å¼æ¥å®ç°ï¼Œå…¶UMLç±»å›¾å¦‚ä¸‹ï¼š å…¶ä¸­ï¼ŒCarControllerç±»å……å½“æŠ½è±¡ç›®æ ‡ï¼ŒPoliceSoundå’ŒPoliceLampç±»å……å½“é€‚é…è€…ï¼ŒPoliceCarAdapterå……å½“é€‚é…å™¨ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-24","objectID":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["é€‚é…å™¨æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 ç¼ºçœé€‚é…å™¨æ¨¡å¼ ç¼ºçœé€‚é…å™¨æ¨¡å¼(Default Adapter Pattern)ï¼šå½“ä¸éœ€è¦å®ç°ä¸€ä¸ªæ¥å£æ‰€æä¾›çš„æ‰€æœ‰æ–¹æ³•æ—¶ï¼Œå¯å…ˆè®¾è®¡ä¸€ä¸ªæŠ½è±¡ç±»å®ç°è¯¥æ¥å£ï¼Œå¹¶ä¸ºæ¥å£ä¸­æ¯ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤å®ç°ï¼ˆç©ºæ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆè¯¥æŠ½è±¡ç±»çš„å­ç±»å¯ä»¥é€‰æ‹©æ€§åœ°è¦†ç›–çˆ¶ç±»çš„æŸäº›æ–¹æ³•æ¥å®ç°éœ€æ±‚ï¼Œå®ƒé€‚ç”¨äºä¸æƒ³ä½¿ç”¨ä¸€ä¸ªæ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•çš„æƒ…å†µï¼Œåˆç§°ä¸ºå•æ¥å£é€‚é…å™¨æ¨¡å¼ã€‚å…¶ç»“æ„å›¾å¦‚ä¸‹ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼Œåœ¨ç¼ºçœé€‚é…å™¨æ¨¡å¼ä¸­åŒ…å«ä»¥ä¸‹3ä¸ªè§’è‰²ï¼š ServiceInterfaceï¼ˆé€‚é…è€…æ¥å£ï¼‰ï¼šå®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé€šå¸¸åœ¨æ¥å£ä¸­å£°æ˜äº†å¤§é‡çš„æ–¹æ³•ã€‚ AbstractServiceClassï¼ˆç¼ºçœé€‚é…å™¨ç±»ï¼‰ï¼šå®ƒæ˜¯ç¼ºçœé€‚é…å™¨æ¨¡å¼çš„æ ¸å¿ƒç±»ï¼Œä½¿ç”¨ç©ºæ–¹æ³•çš„å½¢å¼å®ç°äº†åœ¨ServiceInterfaceæ¥å£ä¸­å£°æ˜çš„æ–¹æ³•ã€‚é€šå¸¸å°†å®ƒå®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œå› ä¸ºå¯¹å®ƒè¿›è¡Œå®ä¾‹åŒ–æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ ConcreteServiceClassï¼ˆå…·ä½“ä¸šåŠ¡ç±»ï¼‰ï¼šå®ƒæ˜¯ç¼ºçœé€‚é…å™¨ç±»çš„å­ç±»ï¼Œåœ¨æ²¡æœ‰å¼•å…¥é€‚é…å™¨ä¹‹å‰å®ƒéœ€è¦å®ç°é€‚é…è€…æ¥å£ï¼Œå› æ­¤éœ€è¦å®ç°åœ¨é€‚é…è€…æ¥å£ä¸­å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ï¼Œè€Œå¯¹äºä¸€äº›æ— é¡»ä½¿ç”¨çš„æ–¹æ³•ä¸å¾—ä¸æä¾›ç©ºå®ç°ã€‚åœ¨æœ‰äº†ç¼ºçœé€‚é…å™¨ä¹‹åå¯ä»¥ç›´æ¥ç»§æ‰¿è¯¥é€‚é…è€…ç±»ï¼Œæ ¹æ®éœ€è¦æœ‰é€‰æ‹©æ€§åœ°è¦†ç›–åœ¨é€‚é…å™¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚ ç¼ºçœé€‚é…å™¨ç±»çš„å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public abstract class AbstractServiceClass implements ServiceInterface { public void serviceMethod1() { } //ç©ºæ–¹æ³• public void serviceMethod2() { } //ç©ºæ–¹æ³• public void serviceMethod3() { } //ç©ºæ–¹æ³• } ","date":"2022-04-24","objectID":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["é€‚é…å™¨æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"4 åŒå‘é€‚é…å™¨ åœ¨å¯¹è±¡é€‚é…å™¨çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨é€‚é…å™¨ä¸­åŒæ—¶åŒ…å«å¯¹ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»çš„å¼•ç”¨ï¼Œé€‚é…è€…å¯ä»¥é€šè¿‡å®ƒè°ƒç”¨ç›®æ ‡ç±»ä¸­çš„æ–¹æ³•ï¼Œç›®æ ‡ç±»ä¹Ÿå¯ä»¥é€šè¿‡å®ƒè°ƒç”¨é€‚é…è€…ç±»çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥é€‚é…å™¨å°±æ˜¯ä¸€ä¸ªåŒå‘é€‚é…å™¨ã€‚å…¶ç»“æ„å›¾å¦‚ä¸‹ï¼š å…¶å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class Adapter implements Target,Adaptee { // åŒæ—¶ç»´æŒå¯¹æŠ½è±¡ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»çš„å¼•ç”¨ private Target target; private Adaptee adaptee; public Adapter(Target target) { this.target = target; } public Adapter(Adaptee adaptee) { this.adaptee = adaptee; } public void request() { adaptee.specificRequest(); } public void specificRequest() { target.request(); } } ","date":"2022-04-24","objectID":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:4:0","tags":["é€‚é…å™¨æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/05.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 å»ºé€ è€…æ¨¡å¼ä»‹ç» å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰ä½¿ç”¨å¤šä¸ªç®€å•çš„å¯¹è±¡ä¸€æ­¥ä¸€æ­¥æ„å»ºæˆä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚ ä¸€ä¸ª Builder ç±»ä¼šä¸€æ­¥ä¸€æ­¥æ„é€ æœ€ç»ˆçš„å¯¹è±¡ã€‚è¯¥ Builder ç±»æ˜¯ç‹¬ç«‹äºå…¶ä»–å¯¹è±¡çš„ã€‚ æ„å›¾ï¼š å°†ä¸€ä¸ªå¤æ‚çš„æ„å»ºä¸å…¶è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚ ä¸»è¦è§£å†³ï¼š ä¸»è¦è§£å†³åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶å€™é¢ä¸´ç€\"ä¸€ä¸ªå¤æ‚å¯¹è±¡\"çš„åˆ›å»ºå·¥ä½œï¼Œå…¶é€šå¸¸ç”±å„ä¸ªéƒ¨åˆ†çš„å­å¯¹è±¡ç”¨ä¸€å®šçš„ç®—æ³•æ„æˆï¼›ç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œè¿™ä¸ªå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä½†æ˜¯å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·çš„ç®—æ³•å´ç›¸å¯¹ç¨³å®šã€‚ ä½•æ—¶ä½¿ç”¨ï¼š ä¸€äº›åŸºæœ¬éƒ¨ä»¶ä¸ä¼šå˜ï¼Œè€Œå…¶ç»„åˆç»å¸¸å˜åŒ–çš„æ—¶å€™ã€‚ å¦‚ä½•è§£å†³ï¼š å°†å˜ä¸ä¸å˜åˆ†ç¦»å¼€ã€‚ å…³é”®ä»£ç ï¼š å»ºé€ è€…ï¼šåˆ›å»ºå’Œæä¾›å®ä¾‹ï¼Œå¯¼æ¼”ï¼šç®¡ç†å»ºé€ å‡ºæ¥çš„å®ä¾‹çš„ä¾èµ–å…³ç³»ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€å»è‚¯å¾·åŸºï¼Œæ±‰å ¡ã€å¯ä¹ã€è–¯æ¡ã€ç‚¸é¸¡ç¿…ç­‰æ˜¯ä¸å˜çš„ï¼Œè€Œå…¶ç»„åˆæ˜¯ç»å¸¸å˜åŒ–çš„ï¼Œç”Ÿæˆå‡ºæ‰€è°“çš„\"å¥—é¤\"ã€‚ 2ã€JAVA ä¸­çš„ StringBuilderã€‚ ä¼˜ç‚¹ï¼š 1ã€å»ºé€ è€…ç‹¬ç«‹ï¼Œæ˜“æ‰©å±•ã€‚ 2ã€ä¾¿äºæ§åˆ¶ç»†èŠ‚é£é™©ã€‚ ç¼ºç‚¹ï¼š 1ã€äº§å“å¿…é¡»æœ‰å…±åŒç‚¹ï¼ŒèŒƒå›´æœ‰é™åˆ¶ã€‚ 2ã€å¦‚å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œä¼šæœ‰å¾ˆå¤šçš„å»ºé€ ç±»ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€éœ€è¦ç”Ÿæˆçš„å¯¹è±¡å…·æœ‰å¤æ‚çš„å†…éƒ¨ç»“æ„ã€‚ 2ã€éœ€è¦ç”Ÿæˆçš„å¯¹è±¡å†…éƒ¨å±æ€§æœ¬èº«ç›¸äº’ä¾èµ–ã€‚ æ³¨æ„äº‹é¡¹ï¼š ä¸å·¥å‚æ¨¡å¼çš„åŒºåˆ«æ˜¯ï¼šå»ºé€ è€…æ¨¡å¼æ›´åŠ å…³æ³¨ä¸é›¶ä»¶è£…é…çš„é¡ºåºã€‚ ","date":"2022-04-24","objectID":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["å»ºé€ è€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 å»ºé€ è€…æ¨¡å¼è¯¦è§£ ","date":"2022-04-24","objectID":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["å»ºé€ è€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 å»ºé€ è€…æ¨¡å¼ç»“æ„ å»ºé€ è€…æ¨¡å¼çš„UMLç±»å›¾å¦‚ä¸‹ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼Œå»ºé€ è€…æ¨¡å¼åŒ…å«ä»¥ä¸‹4ä¸ªè§’è‰²ã€‚ Builderï¼ˆæŠ½è±¡å»ºé€ è€…ï¼‰ï¼šå®ƒä¸ºåˆ›å»ºä¸€ä¸ªäº§å“å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šæŠ½è±¡æ¥å£ï¼Œåœ¨è¯¥æ¥å£ä¸­ä¸€èˆ¬å£°æ˜ä¸¤ç±»æ–¹æ³•ï¼Œä¸€ç±»æ–¹æ³•æ˜¯buildPartX()ï¼ˆå¦‚å›¾ä¸­çš„buildPartA()ã€buildPathB()ç­‰ï¼‰ï¼Œå®ƒä»¬ç”¨äºåˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶ï¼›å¦ä¸€ç±»æ–¹æ³•æ˜¯getResultï¼ˆï¼‰ï¼Œå®ƒä»¬ç”¨äºè¿”å›å¤æ‚å¯¹è±¡ã€‚Builderæ—¢å¯ä»¥æ˜¯æŠ½è±¡ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¥å£ã€‚ ConcreteBuilderï¼ˆå…·ä½“å»ºé€ è€…ï¼‰ï¼šå®ƒå®ç°äº†Builderæ¥å£ï¼Œå®ç°å„ä¸ªéƒ¨ä»¶çš„å…·ä½“æ„é€ å’Œè£…é…æ–¹æ³•ï¼Œå®šä¹‰å¹¶æ˜ç¡®æ‰€åˆ›å»ºçš„å¤æ‚å¯¹è±¡ï¼Œè¿˜å¯ä»¥æä¾›ä¸€ä¸ªæ–¹æ³•è¿”å›åˆ›å»ºå¥½çš„å¤æ‚äº§å“å¯¹è±¡ï¼ˆè¯¥æ–¹æ³•ä¹Ÿå¯ä»¥ç”±æŠ½è±¡å»ºé€ è€…å®ç°ï¼‰ã€‚ Productï¼ˆäº§å“ï¼‰ï¼šå®ƒæ˜¯è¢«æ„å»ºçš„å¤æ‚å¯¹è±¡ï¼ŒåŒ…å«å¤šä¸ªç»„æˆéƒ¨ä»¶ï¼Œå…·ä½“å»ºé€ è€…åˆ›å»ºè¯¥äº§å“çš„å†…éƒ¨è¡¨ç¤ºå¹¶å®šä¹‰å®ƒçš„è£…é…è¿‡ç¨‹ã€‚ Directorï¼ˆæŒ‡æŒ¥è€…ï¼‰ï¼šæŒ‡æŒ¥è€…åˆç§°ä¸ºå¯¼æ¼”ç±»ï¼Œå®ƒè´Ÿè´£å®‰æ’å¤æ‚å¯¹è±¡çš„å»ºé€ æ¬¡åºï¼ŒæŒ‡æŒ¥è€…ä¸æŠ½è±¡å»ºé€ è€…ä¹‹é—´å­˜åœ¨å…³è”å…³ç³»ï¼Œå¯ä»¥åœ¨å…¶construct()å»ºé€ æ–¹æ³•ä¸­è°ƒç”¨å»ºé€ è€…å¯¹è±¡çš„éƒ¨ä»¶æ„é€ ä¸è£…é…æ–¹æ³•ï¼Œå®Œæˆå¤æ‚å¯¹è±¡çš„å»ºé€ ã€‚ ","date":"2022-04-24","objectID":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["å»ºé€ è€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 å»ºé€ è€…æ¨¡å¼å®ç° å…¸å‹çš„å¤æ‚å¯¹è±¡ç±»çš„ä»£ç å¦‚ä¸‹ï¼š public class Product { private String partA; // å®šä¹‰éƒ¨ä»¶ï¼Œéƒ¨ä»¶å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼ŒåŒ…æ‹¬å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ private String partB; private String partC; // å±æ€§çš„Getterå’ŒSetteræ–¹æ³•çœç•¥ } å…¸å‹çš„æŠ½è±¡å»ºé€ è€…ç±»çš„ä»£ç å¦‚ä¸‹ï¼š public abstract class Builder { // åˆ›å»ºäº§å“å¯¹è±¡ protected Product product = new Product(); public abstract void buildPartA(); public abstract void buildPartB(); public abstract void buildPartC(); // è¿”å›äº§å“å¯¹è±¡ public Product getResult() { return product; } } å…¸å‹çš„å…·ä½“å»ºé€ è€…ç±»çš„ä»£ç å¦‚ä¸‹ï¼š public class ConcreteBuilder1 extends Builder { public void buildPartA() { product.setPartA(\"A1\"); } public void buildPartB() { product.setPartA(\"B1\"); } public void buildPartC() { product.setPartA(\"C1\"); } } å…¸å‹çš„æŒ‡æŒ¥è€…ç±»çš„ä»£ç å¦‚ä¸‹ï¼š public class Director { private Builder builder; public Director(Builder builder) { this.builder = builder; } public void setBuilder(Builder builder) { this.builder = builder; } // äº§å“çš„æ„å»ºä¸ç»„è£…æ–¹æ³• public Product construct() { builder.buildPartA(); builder.buildPartB(); builder.buildPartC(); return builder.getResult(); } } ","date":"2022-04-24","objectID":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["å»ºé€ è€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 å»ºé€ è€…æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° è®¡ç®—æœºç»„è£…å·¥å‚å¯ä»¥å°†CPUã€å†…å­˜ã€ç¡¬ç›˜ã€ä¸»æœºã€æ˜¾ç¤ºå™¨ç­‰ç¡¬ä»¶è®¾å¤‡ç»„è£…åœ¨ä¸€èµ·æ„æˆä¸€å°å®Œæ•´çš„è®¡ç®—æœºï¼Œä¸”æ„æˆçš„è®¡ç®—æœºå¯ä»¥æ˜¯ç¬”è®°æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯å°å¼æœºï¼Œè¿˜å¯ä»¥æ˜¯ä¸æä¾›æ˜¾ç¤ºå™¨çš„æœåŠ¡å™¨ä¸»æœºã€‚å¯¹äºç”¨æˆ·è€Œè¨€ï¼Œæ— é¡»å…³å¿ƒè®¡ç®—æœºçš„ç»„æˆè®¾å¤‡å’Œç»„è£…è¿‡ç¨‹ï¼Œå·¥å‚è¿”å›ç»™ç”¨æˆ·çš„ã€‚æ˜¯å®Œæ•´çš„è®¡ç®—æœºå¯¹è±¡ï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼å®ç°è®¡ç®—æœºç»„è£…è¿‡ç¨‹ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒComputerå……å½“ç¬¦åˆäº§å“ï¼ŒComputerBuilderå……å½“æŠ½è±¡å»ºé€ è€…ï¼ŒNotebookã€Desktopå’ŒServerå……å½“å…·ä½“å»ºé€ è€…ï¼ŒComputerAssembleDirectorå……å½“æŒ‡æŒ¥è€…ï¼Œå…¶assemble()æ–¹æ³•ç”¨äºå®šä¹‰äº§å“çš„æ„é€ è¿‡ç¨‹ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-24","objectID":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["å»ºé€ è€…æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 åŸå‹æ¨¡å¼ä»‹ç» åŸå‹æ¨¡å¼ï¼ˆPrototype Patternï¼‰æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæ˜¯ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šå¾…åˆ›å»ºå¯¹è±¡çš„ç±»å‹ï¼Œå¹¶ä¸”é€šè¿‡å¤åˆ¶è¿™ä¸ªåŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ å®ƒçš„å·¥ä½œåŸç†å¾ˆç®€å•ï¼šå°†ä¸€ä¸ªåŸå‹å¯¹è±¡ä¼ ç»™è¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼ˆå³å®¢æˆ·ç«¯å¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªè¦å‘åŠ¨åˆ›å»ºçš„å¯¹è±¡é€šè¿‡è¯·æ±‚åŸå‹å¯¹è±¡å¤åˆ¶è‡ªå·±æ¥å®ç°åˆ›å»ºè¿‡ç¨‹ã€‚ æ„å›¾ï¼š ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ ä¸»è¦è§£å†³ï¼š åœ¨è¿è¡ŒæœŸå»ºç«‹å’Œåˆ é™¤åŸå‹ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š 1ã€å½“ä¸€ä¸ªç³»ç»Ÿåº”è¯¥ç‹¬ç«‹äºå®ƒçš„äº§å“åˆ›å»ºï¼Œæ„æˆå’Œè¡¨ç¤ºæ—¶ã€‚ 2ã€å½“è¦å®ä¾‹åŒ–çš„ç±»æ˜¯åœ¨è¿è¡Œæ—¶åˆ»æŒ‡å®šæ—¶ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡åŠ¨æ€è£…è½½ã€‚ 3ã€ä¸ºäº†é¿å…åˆ›å»ºä¸€ä¸ªä¸äº§å“ç±»å±‚æ¬¡å¹³è¡Œçš„å·¥å‚ç±»å±‚æ¬¡æ—¶ã€‚ 4ã€å½“ä¸€ä¸ªç±»çš„å®ä¾‹åªèƒ½æœ‰å‡ ä¸ªä¸åŒçŠ¶æ€ç»„åˆä¸­çš„ä¸€ç§æ—¶ã€‚å»ºç«‹ç›¸åº”æ•°ç›®çš„åŸå‹å¹¶å…‹éš†å®ƒä»¬å¯èƒ½æ¯”æ¯æ¬¡ç”¨åˆé€‚çš„çŠ¶æ€æ‰‹å·¥å®ä¾‹åŒ–è¯¥ç±»æ›´æ–¹ä¾¿ä¸€äº›ã€‚ å¦‚ä½•è§£å†³ï¼š åˆ©ç”¨å·²æœ‰çš„ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå¿«é€Ÿåœ°ç”Ÿæˆå’ŒåŸå‹å¯¹è±¡ä¸€æ ·çš„å®ä¾‹ã€‚ å…³é”®ä»£ç ï¼š 1ã€å®ç°å…‹éš†æ“ä½œï¼Œåœ¨ JAVA ç»§æ‰¿ Cloneableï¼Œé‡å†™ clone()ï¼Œåœ¨ .NET ä¸­å¯ä»¥ä½¿ç”¨ Object ç±»çš„ MemberwiseClone() æ–¹æ³•æ¥å®ç°å¯¹è±¡çš„æµ…æ‹·è´æˆ–é€šè¿‡åºåˆ—åŒ–çš„æ–¹å¼æ¥å®ç°æ·±æ‹·è´ã€‚ 2ã€åŸå‹æ¨¡å¼åŒæ ·ç”¨äºéš”ç¦»ç±»å¯¹è±¡çš„ä½¿ç”¨è€…å’Œå…·ä½“ç±»å‹ï¼ˆæ˜“å˜ç±»ï¼‰ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œå®ƒåŒæ ·è¦æ±‚è¿™äº›\"æ˜“å˜ç±»\"æ‹¥æœ‰ç¨³å®šçš„æ¥å£ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€ç»†èƒåˆ†è£‚ã€‚ 2ã€JAVA ä¸­çš„ Object clone() æ–¹æ³•ã€‚ ä¼˜ç‚¹ï¼š 1ã€æ€§èƒ½æé«˜ã€‚ 2ã€é€ƒé¿æ„é€ å‡½æ•°çš„çº¦æŸã€‚ ç¼ºç‚¹ï¼š 1ã€é…å¤‡å…‹éš†æ–¹æ³•éœ€è¦å¯¹ç±»çš„åŠŸèƒ½è¿›è¡Œé€šç›˜è€ƒè™‘ï¼Œè¿™å¯¹äºå…¨æ–°çš„ç±»ä¸æ˜¯å¾ˆéš¾ï¼Œä½†å¯¹äºå·²æœ‰çš„ç±»ä¸ä¸€å®šå¾ˆå®¹æ˜“ï¼Œç‰¹åˆ«å½“ä¸€ä¸ªç±»å¼•ç”¨ä¸æ”¯æŒä¸²è¡ŒåŒ–çš„é—´æ¥å¯¹è±¡ï¼Œæˆ–è€…å¼•ç”¨å«æœ‰å¾ªç¯ç»“æ„çš„æ—¶å€™ã€‚ 2ã€å¿…é¡»å®ç° Cloneable æ¥å£ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€èµ„æºä¼˜åŒ–åœºæ™¯ã€‚ 2ã€ç±»åˆå§‹åŒ–éœ€è¦æ¶ˆåŒ–éå¸¸å¤šçš„èµ„æºï¼Œè¿™ä¸ªèµ„æºåŒ…æ‹¬æ•°æ®ã€ç¡¬ä»¶èµ„æºç­‰ã€‚ 3ã€æ€§èƒ½å’Œå®‰å…¨è¦æ±‚çš„åœºæ™¯ã€‚ 4ã€é€šè¿‡ new äº§ç”Ÿä¸€ä¸ªå¯¹è±¡éœ€è¦éå¸¸ç¹ççš„æ•°æ®å‡†å¤‡æˆ–è®¿é—®æƒé™ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼ã€‚ 5ã€ä¸€ä¸ªå¯¹è±¡å¤šä¸ªä¿®æ”¹è€…çš„åœºæ™¯ã€‚ 6ã€ä¸€ä¸ªå¯¹è±¡éœ€è¦æä¾›ç»™å…¶ä»–å¯¹è±¡è®¿é—®ï¼Œè€Œä¸”å„ä¸ªè°ƒç”¨è€…å¯èƒ½éƒ½éœ€è¦ä¿®æ”¹å…¶å€¼æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åŸå‹æ¨¡å¼æ‹·è´å¤šä¸ªå¯¹è±¡ä¾›è°ƒç”¨è€…ä½¿ç”¨ã€‚ 7ã€åœ¨å®é™…é¡¹ç›®ä¸­ï¼ŒåŸå‹æ¨¡å¼å¾ˆå°‘å•ç‹¬å‡ºç°ï¼Œä¸€èˆ¬æ˜¯å’Œå·¥å‚æ–¹æ³•æ¨¡å¼ä¸€èµ·å‡ºç°ï¼Œé€šè¿‡ clone çš„æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åç”±å·¥å‚æ–¹æ³•æä¾›ç»™è°ƒç”¨è€…ã€‚åŸå‹æ¨¡å¼å·²ç»ä¸ Java èä¸ºæµ‘ç„¶ä¸€ä½“ï¼Œå¤§å®¶å¯ä»¥éšæ‰‹æ‹¿æ¥ä½¿ç”¨ã€‚ æ³¨æ„äº‹é¡¹ï¼š ä¸é€šè¿‡å¯¹ä¸€ä¸ªç±»è¿›è¡Œå®ä¾‹åŒ–æ¥æ„é€ æ–°å¯¹è±¡ä¸åŒçš„æ˜¯ï¼ŒåŸå‹æ¨¡å¼æ˜¯é€šè¿‡æ‹·è´ä¸€ä¸ªç°æœ‰å¯¹è±¡ç”Ÿæˆæ–°å¯¹è±¡çš„ã€‚æµ…æ‹·è´å®ç° Cloneableï¼Œé‡å†™ï¼Œæ·±æ‹·è´æ˜¯é€šè¿‡å®ç° Serializable è¯»å–äºŒè¿›åˆ¶æµã€‚ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 åŸå‹æ¨¡å¼è¯¦è§£ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 åŸå‹æ¨¡å¼ç»“æ„ åŸå‹æ¨¡å¼åŒ…å«ä»¥ä¸‹3ä¸ªè§’è‰²ã€‚ Prototypeï¼ˆæŠ½è±¡åŸå‹ç±»ï¼‰ï¼šå®ƒæ˜¯å£°æ˜å…‹éš†æ–¹æ³•çš„æ¥å£ï¼Œæ˜¯æ‰€æœ‰å…·ä½“åŸå‹ç±»çš„å…¬å…±çˆ¶ç±»ï¼Œå®ƒå¯ä»¥æ˜¯æŠ½è±¡ç±»ä¹Ÿå¯ä»¥æ˜¯æ¥å£ï¼Œç”šè‡³è¿˜å¯ä»¥æ˜¯å…·ä½“å®ç°ç±»ã€‚ ConcretePrototypeï¼ˆå…·ä½“åŸå‹ç±»ï¼‰ï¼šå®ƒå®ç°åœ¨æŠ½è±¡åŸå‹ç±»ä¸­å£°æ˜çš„å…‹éš†æ–¹æ³•ï¼Œåœ¨å…‹éš†æ–¹æ³•ä¸­è¿”å›è‡ªå·±çš„ä¸€ä¸ªå…‹éš†å¯¹è±¡ã€‚ Clientï¼ˆå®¢æˆ·ç±»ï¼‰ï¼šåœ¨å®¢æˆ·ç±»ä¸­ï¼Œè®©ä¸€ä¸ªåŸå‹å¯¹è±¡å…‹éš†è‡ªèº«ä»è€Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œåªéœ€è¦ç›´æ¥å®ä¾‹åŒ–æˆ–é€šè¿‡å·¥å‚æ–¹æ³•ç­‰æ–¹å¼åˆ›å»ºä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå†é€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„å…‹éš†æ–¹æ³•å³å¯å¾—åˆ°å¤šä¸ªç›¸åŒçš„å¯¹è±¡ã€‚ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 æ·±å…‹éš†ä¸æµ…å…‹éš† æ ¹æ®åœ¨å¤åˆ¶åŸå‹å¯¹è±¡çš„åŒæ—¶æ˜¯å¦å¤åˆ¶åŒ…å«åœ¨åŸå‹å¯¹è±¡ä¸­å¼•ç”¨ç±»å‹çš„æˆå‘˜å˜é‡ï¼ŒåŸå‹æ¨¡å¼çš„å…‹éš†æœºåˆ¶å¯åˆ†ä¸ºä¸¤ç§ï¼Œå³æµ…å…‹éš†ï¼ˆShallow Cloneï¼‰å’Œæ·±å…‹éš†ï¼ˆDeep Cloneï¼‰ã€‚ 2.2.1 æµ…å…‹éš† åœ¨æµ…å…‹éš†ä¸­ï¼Œå¦‚æœåŸå‹å¯¹è±¡çš„æˆå‘˜å˜é‡æ˜¯å€¼ç±»å‹ï¼Œå°†å¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ï¼›å¦‚æœåŸå‹å¯¹è±¡çš„æˆå‘˜å˜é‡æ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™å°†å¼•ç”¨å¯¹è±¡çš„åœ°å€å¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´åŸå‹å¯¹è±¡å’Œå…‹éš†å¯¹è±¡çš„æˆå‘˜å˜é‡æŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨æµ…å…‹éš†ä¸­ï¼Œå½“å¯¹è±¡è¢«å¤åˆ¶æ—¶åªå¤åˆ¶å®ƒæœ¬èº«å’Œå…¶ä¸­åŒ…å«çš„å€¼ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œè€Œå¼•ç”¨ç±»å‹çš„æˆå‘˜å¯¹è±¡å¹¶æ²¡æœ‰å¤åˆ¶ã€‚ 2.2.2 æ·±å…‹éš† åœ¨æ·±å…‹éš†ä¸­ï¼Œæ— è®ºåŸå‹å¯¹è±¡çš„æˆå‘˜å˜é‡æ˜¯å€¼ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ï¼Œéƒ½å°†å¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ï¼Œæ·±å…‹éš†å°†åŸå‹å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨å¯¹è±¡ä¹Ÿå¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨æ·±å…‹éš†ä¸­ï¼Œé™¤äº†å¯¹è±¡æœ¬èº«è¢«å¤åˆ¶å¤–ï¼Œå¯¹è±¡æ‰€åŒ…å«çš„æ‰€æœ‰æˆå‘˜å˜é‡ä¹Ÿå°†å¤åˆ¶ã€‚ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 åŸå‹æ¨¡å¼å®ç° å®ç°åŸå‹æ¨¡å¼çš„å…³é”®åœ¨äºå¦‚ä½•å®ç°å…‹éš†æ–¹æ³•ã€‚è¿™é‡Œä»‹ç»ä¸¤ç§åœ¨Javaè¯­è¨€ä¸­æœ€å¸¸ç”¨çš„å…‹éš†å®ç°æ–¹æ³•ã€‚ 2.3.1 é€šç”¨å®ç°æ–¹æ³• é€šç”¨çš„å…‹éš†å®ç°æ–¹æ³•æ˜¯åœ¨å…·ä½“åŸå‹ç±»çš„å…‹éš†æ–¹æ³•ä¸­å®ä¾‹åŒ–ä¸€ä¸ªä¸è‡ªèº«ç±»å‹ç›¸åŒçš„å¯¹è±¡å¹¶å°†å…¶è¿”å›ï¼ŒåŒæ—¶å°†ç›¸å…³çš„å‚æ•°ä¼ å…¥æ–°åˆ›å»ºçš„å¯¹è±¡ä¸­ï¼Œä¿è¯å®ƒä»¬çš„æˆå‘˜å˜é‡ç›¸åŒã€‚ å…¸å‹çš„æŠ½è±¡åŸå‹ç±»ä»£ç å¦‚ä¸‹ï¼š public abstract class Prototype { public abstract Prototype clone(); } å…¸å‹çš„å…·ä½“åŸå‹ç±»ä»£ç å¦‚ä¸‹ï¼š public class ConcretePrototype extends Prototype { private String name; // æˆå‘˜å˜é‡ public void setName(String name) { this.name = name; } public void getName() { return this.name; } // å…‹éš†æ–¹æ³•å®ç° public Prototype clone() { Prototype prototype = new ConcretePrototype(); // åˆ›å»ºæ–°å¯¹è±¡ prototype.setName(this.name); return prototype; } } è¿™æ ·æˆ‘ä»¬å°±åªéœ€è¦åœ¨å®¢æˆ·ç±»ä¸­åˆ›å»ºä¸€ä¸ªConcretePrototypeå¯¹è±¡ä½œä¸ºåŸå‹å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å…¶clone()æ–¹æ³•å³å¯å¾—åˆ°å¯¹åº”çš„å…‹éš†å¯¹è±¡ã€‚ æ­¤æ–¹æ³•æ˜¯åŸå‹æ¨¡å¼çš„é€šç”¨å®ç°ï¼Œå®ƒä¸ç¼–ç¨‹è¯­è¨€æœ¬èº«çš„ç‰¹æ€§æ— å…³ï¼Œå…¶ä»–é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§å½¢å¼æ¥å®ç°å¯¹åŸå‹å¯¹è±¡çš„å…‹éš†ã€‚ åœ¨è¿™ç§é€šç”¨å®ç°æ–¹æ³•ä¸­ï¼Œå¯é€šè¿‡æ‰‹å·¥ç¼–å†™clone()æ–¹æ³•æ¥å®ç°æµ…å…‹éš†å’Œæ·±å…‹éš†ã€‚å¯¹äºå¼•ç”¨ç±»å‹çš„å¯¹è±¡ï¼Œå¯ä»¥åœ¨clone()æ–¹æ³•ä¸­é€šè¿‡èµ‹å€¼çš„æ–¹å¼æ¥å®ç°å¤åˆ¶ï¼Œè¿™æ˜¯ä¸€ç§æµ…å…‹éš†å®ç°æ–¹æ¡ˆï¼›å¦‚æœåœ¨clone()æ–¹æ³•ä¸­é€šè¿‡åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„æˆå‘˜å¯¹è±¡æ¥å®ç°å¤åˆ¶ï¼Œåˆ™æ˜¯ä¸€ç§æ·±å…‹éš†å®ç°æ–¹æ¡ˆã€‚ 2.3.2 Javaè¯­è¨€ä¸­çš„clone()æ–¹æ³•å’ŒCloneableæ¥å£ åœ¨Javaè¯­è¨€ä¸­ï¼Œæ‰€æœ‰çš„Javaç±»å‡ç»§æ‰¿è‡ªjava.lang.Objectç±»ï¼ŒObjectç±»æä¾›äº†ä¸€ä¸ªclone()æ–¹æ³•ï¼Œå¯ä»¥å°†ä¸€ä¸ªJavaå¯¹è±¡å¤åˆ¶ä¸€ä»½ã€‚å› æ­¤åœ¨Javaä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨Objectæä¾›clone()æ–¹æ³•æ¥å®ç°å¯¹è±¡çš„æµ…å…‹éš†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯èƒ½å¤Ÿå®ç°å…‹éš†çš„Javaç±»éƒ½å¿…é¡»å®ç°ä¸€ä¸ªæ ‡è¯†æ¥å£Cloneableï¼Œè¡¨ç¤ºè¿™ä¸ªJavaç±»æ”¯æŒè¢«å¤åˆ¶ã€‚å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰å®ç°è¿™ä¸ªæ¥å£ä½†æ˜¯è°ƒç”¨äº†clone()æ–¹æ³•ï¼ŒJavaç¼–è¯‘å™¨å°†ä¼šæŠ›å‡ºä¸€ä¸ªCloneNotSupportedExceptionå¼‚å¸¸ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š public class ConcretePrototype implements Cloneable { public Prototype clone() { Object object = null; try { object = super.clone(); // æµ…å…‹éš† } catch (CloneNotSupportedException exception) { System.err.println(\"Not support Cloneable\"); } return (Prototype)object; } } ä¸ºäº†è·å–å¯¹è±¡çš„ä¸€ä¸ªå…‹éš†ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨Objectç±»çš„clone()æ–¹æ³•ï¼Œå…¶å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š åœ¨æ´¾ç”Ÿç±»ä¸­è¦†ç›–åŸºç±»çš„clone()æ–¹æ³•ï¼Œå¹¶å£°æ˜ä¸ºpublicã€‚ åœ¨æ´¾ç”Ÿç±»çš„clone()æ–¹æ³•ä¸­è°ƒç”¨super.clone()ã€‚ æ´¾ç”Ÿç±»éœ€å®ç°Cloneableæ¥å£ã€‚ æ­¤æ—¶ï¼ŒObjectç±»ç›¸å½“äºæŠ½è±¡åŸå‹ç±»ï¼Œæ‰€æœ‰å®ç°äº†Cloneableæ¥å£çš„ç±»ç›¸å½“äºå…·ä½“åŸå‹ç±»ã€‚ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.4 åŸå‹æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸæ•°æ®å¤„ç†è½¯ä»¶éœ€è¦å¢åŠ ä¸€ä¸ªå›¾è¡¨å¤åˆ¶åŠŸèƒ½ã€‚åœ¨å›¾è¡¨å¯¹è±¡ï¼ˆDataChartï¼‰ä¸­åŒ…å«ä¸€ä¸ªæ•°æ®é›†å¯¹è±¡(DataSet)ã€‚æ•°æ®é›†å¯¹è±¡ç”¨äºå°è£…è¦æ˜¾ç¤ºçš„æ•°æ®ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç•Œé¢ä¸Šçš„å¤åˆ¶æŒ‰é’®å°†è¯¥å›¾è¡¨å¤åˆ¶ä¸€ä»½ï¼Œå¤åˆ¶åï¼Œå³å¯å¾—åˆ°æ–°çš„å›¾è¡¨å¯¹è±¡ï¼Œç„¶åå¯ä»¥ä¿®æ”¹æ–°å›¾è¡¨çš„ç¼–å·ã€é¢œè‰²ã€æ•°æ®ã€‚è¯•ç”¨åŸå‹æ¨¡å¼è®¾è®¡è½¯ä»¶å®ç°æ·±å…‹éš†ã€‚ UMLç±»å›¾ åœ¨è¯¥è®¾è®¡æ–¹æ¡ˆä¸­ï¼ŒDataChart ç±»åŒ…å«ä¸€ä¸ª DataSet å¯¹è±¡ï¼Œåœ¨å¤åˆ¶ DataChart å¯¹è±¡çš„åŒæ—¶å°† å¤åˆ¶ DataSet å¯¹è±¡ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨æ·±å…‹éš†æŠ€æœ¯ï¼Œå¯ä½¿ç”¨æµæ¥å®ç°æ·±å…‹éš†ã€‚å…¶ä¸­Serializableæ˜¯java.ioåŒ…ä¸­å®šä¹‰çš„ã€ç”¨äºå®ç°Javaç±»çš„åºåˆ—åŒ–æ“ä½œè€Œæä¾›çš„ä¸€ä¸ªè¯­ä¹‰çº§åˆ«çš„æ¥å£ã€‚Serializableåºåˆ—åŒ–æ¥å£æ²¡æœ‰ä»»ä½•æ–¹æ³•æˆ–è€…å­—æ®µï¼Œåªæ˜¯ç”¨äºæ ‡è¯†å¯åºåˆ—åŒ–çš„è¯­ä¹‰ã€‚å®ç°äº†Serializableæ¥å£çš„ç±»å¯ä»¥è¢«ObjectOutputStreamè½¬æ¢ä¸ºå­—èŠ‚æµï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ObjectInputStreamå†å°†å…¶è§£æä¸ºå¯¹è±¡ã€‚æ•…æˆ‘ä»¬å®ç°è¿™ä¸ªæ¥å£å³å¯ä½¿ç”¨æµæ¥å®ç°æ·±å…‹éš† ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:4","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 åŸå‹ç®¡ç†å™¨ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3.1 åŸå‹ç®¡ç†å™¨å®ç° åŸå‹ç®¡ç†å™¨(Prototype Manager)æ˜¯å°†å¤šä¸ªåŸå‹å¯¹è±¡å­˜å‚¨åœ¨ä¸€ä¸ªé›†åˆä¸­ä¾›å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸“é—¨è´Ÿè´£å…‹éš†å¯¹è±¡çš„å·¥å‚ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªé›†åˆç”¨äºå­˜å‚¨åŸå‹å¯¹è±¡ï¼Œ å¦‚æœéœ€è¦æŸä¸ªåŸå‹å¯¹è±¡çš„ä¸€ä¸ªå…‹éš†ï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶é›†åˆä¸­å¯¹åº”çš„åŸå‹å¯¹è±¡æ¥è·å¾—ã€‚ åœ¨åŸå‹ç®¡ç†å™¨ä¸­é’ˆå¯¹æŠ½è±¡åŸå‹ç±»è¿›è¡Œç¼–ç¨‹ï¼Œä»¥ä¾¿æ‰©å±•ã€‚ å…¶ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š å…¶ä¸­å…¸å‹çš„åŸå‹ç®¡ç†å™¨PrototypeManagerç±»çš„å®ç°ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š package prototype_pattern; import java.util.Hashtable; /** * @author Cnc_hzf * @date 2022/4/22 15:00 */ public class PrototypeManager { private Hashtable prototypeTable = new Hashtable(); // ä½¿ç”¨Hashtableå­˜å‚¨åŸå‹å¯¹è±¡ public PrototypeManager() { prototypeTable.put(\"A\", new ConcretePrototypeA()); prototypeTable.put(\"B\", new ConcretePrototypeB()); } public void add(String key, Prototype prototype) { prototypeTable.put(key, prototype); } public Prototype get(String key) { Prototype clone = ((Prototype) prototypeTable.get(key)).clone(); // é€šè¿‡å…‹éš†æ–¹æ³•åˆ›å»ºæ–°å¯¹è±¡ return clone; } } åœ¨å®é™…å¼€å‘ä¸­å¯ä»¥å°†PrototypeMangerè®¾è®¡ä¸ºå•ä¾‹ç±»ï¼Œç¡®ä¿ç³»ç»Ÿä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªPrototypeManagerå¯¹è±¡ï¼Œè¿™æ ·æ—¢æœ‰åˆ©äºèŠ‚çœç³»ç»Ÿèµ„æºï¼Œè¿˜å¯ä»¥æ›´å¥½åœ°å¯¹åŸå‹ç®¡ç†å™¨å¯¹è±¡è¿›è¡Œæ§åˆ¶ã€‚ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:1","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3.2 åŸå‹ç®¡ç†å™¨åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸå…¬å¸éœ€è¦åˆ›å»ºä¸€ä¸ªå…¬æ–‡ç®¡ç†å™¨ï¼Œå…¬æ–‡ç®¡ç†å™¨ä¸­éœ€è¦æä¾›ä¸€ä¸ªé›†åˆå¯¹è±¡æ¥å­˜å‚¨ä¸€äº›å…¬æ–‡æ¨¡æ¿ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å¤åˆ¶è¿™äº›æ¨¡æ¿å¿«é€Ÿçš„åˆ›å»ºæ–°çš„å…¬æ–‡ï¼Œè¯•ä½¿ç”¨å¸¦æœ‰åŸå‹ç®¡ç†å™¨çš„åŸå‹æ¨¡å¼æ¥è®¾è®¡è¯¥å…¬æ–‡ç®¡ç†å™¨å¹¶ä½¿ç”¨Javaä»£ç ç¼–ç¨‹æ¨¡æ‹Ÿã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒOfficialDocument ï¼ˆæŠ½è±¡å…¬æ–‡ç±»ï¼‰å……å½“æŠ½è±¡åŸå‹ç±»ï¼Œå…¶å­ç±» FARï¼ˆFeasibility Analysis Reportï¼Œå¯è¡Œæ€§åˆ†ææŠ¥å‘Šï¼‰å’Œ SRSï¼ˆSoftware Requirements Specificationï¼Œè½¯ä»¶éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ï¼‰å……å½“å…·ä½“åŸå‹ç±»ï¼ŒPrototypeManager å……å½“åŸå‹ç®¡ç†å™¨ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-24","objectID":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:2","tags":["åŸå‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/03.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 å•ä¾‹æ¨¡å¼ä»‹ç» å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹æ¥è®¿é—®è¿™ä¸ªå”¯ä¸€å®ä¾‹ã€‚ ä¾‹å¦‚Windowsä»»åŠ¡ç®¡ç†å™¨ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹åªèƒ½æ‰“å¼€å”¯ä¸€ä¸€ä¸ªä»»åŠ¡ç®¡ç†å™¨ã€‚ å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ï¼Œå…¶æœ‰ä¸‰ä¸ªè¦ç‚¹ï¼šä¸€æ˜¯æŸä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼›äºŒæ˜¯å®ƒå¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹ï¼›ä¸‰æ˜¯å®ƒå¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ã€‚ ä¸»è¦è§£å†³ï¼š ä¸€ä¸ªå…¨å±€ä½¿ç”¨çš„ç±»é¢‘ç¹åœ°åˆ›å»ºä¸é”€æ¯ã€‚ ä½•æ—¶ä½¿ç”¨ï¼š å½“æ‚¨æƒ³æ§åˆ¶å®ä¾‹æ•°ç›®ï¼ŒèŠ‚çœç³»ç»Ÿèµ„æºçš„æ—¶å€™ã€‚ å¦‚ä½•è§£å†³ï¼š åˆ¤æ–­ç³»ç»Ÿæ˜¯å¦å·²ç»æœ‰è¿™ä¸ªå•ä¾‹ï¼Œå¦‚æœæœ‰åˆ™è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºã€‚ å…³é”®ä»£ç ï¼š æ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€ä¸€ä¸ªç­çº§åªæœ‰ä¸€ä¸ªç­ä¸»ä»»ã€‚ 2ã€Windows æ˜¯å¤šè¿›ç¨‹å¤šçº¿ç¨‹çš„ï¼Œåœ¨æ“ä½œä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¸å¯é¿å…åœ°å‡ºç°å¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªæ–‡ä»¶çš„ç°è±¡ï¼Œæ‰€ä»¥æ‰€æœ‰æ–‡ä»¶çš„å¤„ç†å¿…é¡»é€šè¿‡å”¯ä¸€çš„å®ä¾‹æ¥è¿›è¡Œã€‚ 3ã€ä¸€äº›è®¾å¤‡ç®¡ç†å™¨å¸¸å¸¸è®¾è®¡ä¸ºå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸€ä¸ªç”µè„‘æœ‰ä¸¤å°æ‰“å°æœºï¼Œåœ¨è¾“å‡ºçš„æ—¶å€™å°±è¦å¤„ç†ä¸èƒ½ä¸¤å°æ‰“å°æœºæ‰“å°åŒä¸€ä¸ªæ–‡ä»¶ã€‚ ä¼˜ç‚¹ï¼š 1ã€åœ¨å†…å­˜é‡Œåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯å®ä¾‹ï¼ˆæ¯”å¦‚ç®¡ç†å­¦é™¢é¦–é¡µé¡µé¢ç¼“å­˜ï¼‰ã€‚ 2ã€é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ï¼ˆæ¯”å¦‚å†™æ–‡ä»¶æ“ä½œï¼‰ã€‚ ç¼ºç‚¹ï¼š æ²¡æœ‰æ¥å£ï¼Œä¸èƒ½ç»§æ‰¿ï¼Œä¸å•ä¸€èŒè´£åŸåˆ™å†²çªï¼Œä¸€ä¸ªç±»åº”è¯¥åªå…³å¿ƒå†…éƒ¨é€»è¾‘ï¼Œè€Œä¸å…³å¿ƒå¤–é¢æ€ä¹ˆæ ·æ¥å®ä¾‹åŒ–ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€è¦æ±‚ç”Ÿäº§å”¯ä¸€åºåˆ—å·ã€‚ 2ã€WEB ä¸­çš„è®¡æ•°å™¨ï¼Œä¸ç”¨æ¯æ¬¡åˆ·æ–°éƒ½åœ¨æ•°æ®åº“é‡ŒåŠ ä¸€æ¬¡ï¼Œç”¨å•ä¾‹å…ˆç¼“å­˜èµ·æ¥ã€‚ 3ã€åˆ›å»ºçš„ä¸€ä¸ªå¯¹è±¡éœ€è¦æ¶ˆè€—çš„èµ„æºè¿‡å¤šï¼Œæ¯”å¦‚ I/O ä¸æ•°æ®åº“çš„è¿æ¥ç­‰ã€‚ æ³¨æ„äº‹é¡¹ï¼š getInstance() æ–¹æ³•ä¸­éœ€è¦ä½¿ç”¨åŒæ­¥é” synchronized (Singleton.class) é˜²æ­¢å¤šçº¿ç¨‹åŒæ—¶è¿›å…¥é€ æˆ instance è¢«å¤šæ¬¡å®ä¾‹åŒ–ã€‚ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 å•ä¾‹æ¨¡å¼è¯¦è§£ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 å•ä¾‹æ¨¡å¼ç»“æ„ å•ä¾‹æ¨¡å¼æ˜¯ç»“æ„æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒåªåŒ…å«ä¸€ä¸ªç±»ï¼Œå³å•ä¾‹ç±»ã€‚å•ä¾‹æ¨¡å¼çš„ç»“æ„å›¾å¦‚ä¸‹ã€‚ ç”±å›¾å¯çŸ¥ï¼Œå•ä¾‹æ¨¡å¼åªåŒ…å«ä¸€ä¸ªå•ä¾‹è§’è‰²ï¼Œä¹Ÿå°±æ˜¯Singletonã€‚å¯¹äºSingletonï¼ˆå•ä¾‹ï¼‰ï¼Œåœ¨å•ä¾‹ç±»çš„å†…éƒ¨åˆ›å»ºå®ƒçš„å”¯ä¸€å®ä¾‹ï¼Œå¹¶é€šè¿‡é™æ€æ–¹æ³•getInstance()è®©å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨å®ƒçš„å”¯ä¸€å®ä¾‹ï¼›ä¸ºäº†é˜²æ­¢åœ¨å¤–éƒ¨å¯¹å•ä¾‹ç±»å®ä¾‹åŒ–ï¼Œå°†å…¶æ„é€ å‡½æ•°çš„å¯è§æ€§è®¾ä¸ºprivateï¼›åœ¨å•ä¾‹ç±»å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªSingletonç±»å‹çš„é™æ€å¯¹è±¡ä½œä¸ºå¯ä¾›å¤–éƒ¨è®¿é—®çš„å”¯ä¸€å®ä¾‹ã€‚ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 å•ä¾‹æ¨¡å¼å®ç° å…¸å‹çš„å•ä¾‹æ¨¡å¼çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š public class Singleton { // é™æ€ç§æœ‰æˆå‘˜å˜é‡ private static Singleton instance = null; // ç§æœ‰æ„é€ å‡½æ•° private Singleton() { } // é™æ€å…¬æœ‰å·¥å‚æ–¹æ³•ï¼Œè¿”å›å”¯ä¸€å®ä¾‹ public static Singleton getInstance() { if(instance == null) instance = new Singleton(); return instance; } } ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 å•ä¾‹æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŸè½¯ä»¶å…¬å¸æ‰¿æ¥äº†ä¸€ä¸ªæœåŠ¡å™¨è´Ÿè½½å‡è¡¡(Load Balance)è½¯ä»¶çš„å¼€å‘å·¥ä½œï¼Œè¯¥è½¯ä»¶è¿è¡Œåœ¨ä¸€å°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥å°†å¹¶å‘è®¿é—®å’Œæ•°æ®æµé‡åˆ†å‘åˆ°æœåŠ¡å™¨é›†ç¾¤ä¸­çš„å¤šå°è®¾å¤‡ä¸Šè¿›è¡Œå¹¶å‘å¤„ç†ï¼Œæé«˜äº†ç³»ç»Ÿçš„æ•´ä½“å¤„ç†èƒ½åŠ›ï¼Œç¼©çŸ­äº†å“åº”æ—¶é—´ã€‚ç”±äºé›†ç¾¤ä¸­çš„æœåŠ¡å™¨éœ€è¦åŠ¨æ€åˆ å‡ï¼Œä¸”å®¢æˆ·ç«¯è¯·æ±‚éœ€è¦ç»Ÿä¸€åˆ†å‘ï¼Œå› æ­¤éœ€è¦ç¡®ä¿è´Ÿè½½å‡è¡¡å™¨çš„å”¯ä¸€æ€§ï¼Œåªèƒ½æœ‰ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨æ¥è´Ÿè´£æœåŠ¡å™¨çš„ç®¡ç†å’Œè¯·æ±‚çš„åˆ†å‘ï¼Œå¦åˆ™å°†ä¼šå¸¦æ¥æœåŠ¡å™¨çŠ¶æ€çš„ä¸ä¸€è‡´ä»¥åŠè¯·æ±‚åˆ†é…å†²çªç­‰é—®é¢˜ã€‚å¦‚ä½•ç¡®ä¿è´Ÿè½½å‡è¡¡å™¨çš„å”¯ä¸€æ€§æ˜¯è¯¥è½¯ä»¶æˆåŠŸçš„å…³é”®ï¼Œè¯•ä½¿ç”¨å•ä¾‹æ¨¡å¼è®¾è®¡æœåŠ¡å™¨è´Ÿè½½å‡è¡¡å™¨ã€‚ UMLç±»å›¾ å…¶ä¸­å°†è´Ÿè½½å‡è¡¡å™¨LoadBalanceè®¾è®¡ä¸ºå•ä¾‹ç±»ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå­˜å‚¨æœåŠ¡å™¨ä¿¡æ¯çš„é›†åˆserverListï¼Œæ¯æ¬¡åœ¨serverListä¸­éšæœºé€‰æ‹©ä¸€å°æœåŠ¡å™¨æ¥å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3 é¥¿æ±‰å¼å•ä¾‹ä¸æ‡’æ±‰å¼å•ä¾‹ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:0","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3.1 é¥¿æ±‰å¼å•ä¾‹ é¥¿æ±‰å¼å•ä¾‹ï¼ˆEager Singletonï¼‰æ˜¯å®ç°èµ·æ¥æœ€ç®€å•çš„å•ä¾‹ç±»ï¼Œé¥¿æ±‰å¼å•ä¾‹ç±»ç»“æ„å›¾å¦‚ä¸‹ã€‚ æœ‰å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç”±äºåœ¨å®šä¹‰é™æ€å˜é‡çš„æ—¶å€™å®ä¾‹åŒ–å•ä¾‹ç±»ï¼Œå› æ­¤åœ¨ç±»åŠ è½½æ—¶å•ä¾‹å¯¹è±¡å°±å·²åˆ›å»ºï¼Œä»£ç å¦‚ä¸‹ï¼š public class EagerSingleton { private static final EagerSingleton instance = new EagerSingleton(); private EagerSingleton() { } public static EagerSingleton getInstance() { return instance; } } å½“ç±»è¢«åŠ è½½æ—¶ï¼Œé™æ€å˜é‡instanceä¼šè¢«åˆå§‹åŒ–ï¼Œæ­¤æ—¶ç±»çš„ç§æœ‰æ„é€ å‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼Œå•ä¾‹ç±»çš„å”¯ä¸€å®ä¾‹å°†è¢«åˆ›å»ºã€‚ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:1","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3.2 æ‡’æ±‰å¼å•ä¾‹ä¸åŒé‡æ£€æŸ¥é”å®š ä¸é¥¿æ±‰å¼å•ä¾‹ç›¸åŒçš„æ˜¯ï¼Œæ‡’æ±‰å¼å•ä¾‹ï¼ˆLazy Singletonï¼‰çš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯ç§æœ‰çš„ï¼›ä¸é¥¿æ±‰å¼å•ä¾‹ç±»ä¸åŒçš„æ˜¯ï¼Œæ‡’æ±‰å¼å•ä¾‹ç±»åœ¨ç¬¬ä¸€æ¬¡è¢«å¼•ç”¨æ—¶å°†è‡ªå·±å®ä¾‹åŒ–ï¼Œåœ¨æ‡’æ±‰å¼å•ä¾‹ç±»è¢«åŠ è½½æ—¶ä¸ä¼šå°†è‡ªå·±å®ä¾‹åŒ–ã€‚æ‡’æ±‰å¼å•ä¾‹ç±»çš„ç»“æ„å›¾å¦‚ä¸‹ã€‚ ä½†å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å°†å¯¼è‡´åˆ›å»ºå¤šä¸ªå•ä¾‹å¯¹è±¡ï¼è¿™ä¸ªæ—¶å€™ä¸ºäº†é¿å…å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨getInstance()æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨å…³é”®å­—synchronizedï¼Œä»£ç å¦‚ä¸‹ï¼š public class LazySingleton { private static LazySingleton instance = null; private LazySingleton() { } // ä½¿ç”¨synchronizedå…³é”®å­—å¯¹æ–¹æ³•åŠ é”ï¼Œç¡®ä¿ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œè¯¥æ–¹æ³• synchronized public static LazySingleton getInstance() { if (instance == null) { instance = new LazySingleton(); } return instance; } } åœ¨ä¸Šè¿°æ‡’æ±‰å¼å•ä¾‹ç±»ä¸­ï¼Œåœ¨getInstance()æ–¹æ³•å‰é¢å¢åŠ äº†å…³é”®å­—synchronizedè¿›è¡Œçº¿ç¨‹é”å®šï¼Œå·²å¤„ç†å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®é—®é¢˜ã€‚ä½†æˆ‘ä»¬æ¯æ¬¡è°ƒç”¨getInstance()æ—¶éƒ½éœ€è¦è¿›è¡Œçº¿ç¨‹é”å®šåˆ¤æ–­ï¼Œåœ¨å¤šçº¿ç¨‹é«˜å¹¶å‘ç¯å¢ƒä¸­å°†ä¼šå¯¼è‡´æ€§èƒ½å¤§å¤§é™ä½ã€‚å› æ­¤å¯ä»¥ç»§ç»­å¯¹æ‡’æ±‰å¼å•ä¾‹è¿›è¡Œæ”¹è¿›ï¼Œæˆ‘ä»¬å‘ç°æ— éœ€å¯¹getInstance()æ–¹æ³•è¿›è¡Œé”å®šï¼Œä»…éœ€é”å®šä»£ç æ®µinstance = new LazySingleton()å³å¯ã€‚æ•…å¯è¿›è¡Œå¦‚ä¸‹æ”¹è¿›ï¼š public static LazySingleton getInstance() { if (instance == null) { synchronized (LazySingleton.class) { instance = new LazySingleton(); } } return instance; } é—®é¢˜çœ‹ä¼¼è§£å†³ï¼Œä½†å¦‚æœä½¿ç”¨ä¸Šè¿°ä»£ç ï¼Œå®é™…ä¸Šè¿˜æ˜¯ä¼šå­˜åœ¨å•ä¾‹å¯¹è±¡ä¸å”¯ä¸€çš„æƒ…å†µã€‚å› ä¸ºçº¿ç¨‹Aå’Œçº¿ç¨‹Bå¦‚æœåŒæ—¶è¿›å…¥åˆ¤æ–­ï¼Œç”±äºé”çš„åŸå› ï¼Œä¸€ä¸ªä¼šå…ˆåˆ›å»ºï¼Œä½†æ˜¯å¦ä¸€ä¸ªå¹¶ä¸çŸ¥é“å¯¹è±¡å·²ç»åˆ›å»ºï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´äº§ç”Ÿå¤šä¸ªå®ä¾‹å¯¹è±¡ã€‚è¿èƒŒäº†å•ä¾‹æ¨¡å¼çš„è®¾è®¡æ€æƒ³ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨åŒé‡æ£€æŸ¥é”å®šï¼Œå³åœ¨é”å†…å†è¿›è¡Œä¸€æ¬¡instance == nullçš„åˆ¤æ–­ã€‚ä½¿ç”¨åŒé‡æ£€æŸ¥é”å®šå®ç°çš„æ‡’æ±‰å¼å•ä¾‹ç±»çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š public class LazySingleton { private volatile static LazySingleton instance = null; private LazySingleton() { } public static LazySingleton getInstance() { //ç¬¬ä¸€é‡åˆ¤æ–­ if (instance == null) { //é”å®šä»£ç å— synchronized (LazySingleton.class) { //ç¬¬äºŒé‡åˆ¤æ–­ if (instance == null) { instance = new LazySingleton(); //åˆ›å»ºå•ä¾‹å®ä¾‹ } } } return instance; } } éœ€è¦æ³¨æ„çš„æ—¶ï¼Œå¦‚æœä½¿ç”¨åŒé‡æ£€æŸ¥é”å®šæ¥å®ç°æ‡’æ±‰å¼å•ä¾‹ç±»ï¼Œéœ€è¦åœ¨é™æ€æˆå‘˜å˜é‡instanceä¹‹å‰å¢åŠ ä¿®é¥°ç¬¦volatileï¼Œè¢«volatileä¿®é¥°çš„æˆå‘˜å˜é‡å¯ä»¥ç¡®ä¿å¤šä¸ªçº¿ç¨‹éƒ½èƒ½å¤Ÿæ­£ç¡®å¤„ç†ã€‚ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:2","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"3.3 é¥¿æ±‰å¼å•ä¾‹ç±»ä¸æ‡’æ±‰å¼å•ä¾‹ç±»çš„æ¯”è¾ƒ é¥¿æ±‰å¼å•ä¾‹ç±»ï¼šæ— é¡»è€ƒè™‘å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®çš„é—®é¢˜ï¼›è°ƒç”¨é€Ÿåº¦å’Œååº”æ—¶é—´ä¼˜äºæ‡’æ±‰å¼å•ä¾‹ï¼›èµ„æºåˆ©ç”¨æ•ˆç‡ä¸åŠæ‡’æ±‰å¼å•ä¾‹ï¼›ç³»ç»ŸåŠ è½½æ—¶é—´å¯èƒ½ä¼šæ¯”è¾ƒé•¿ã€‚ æ‡’æ±‰å¼å•ä¾‹ç±»ï¼šå®ç°äº†å»¶è¿ŸåŠ è½½ï¼›å¿…é¡»å¤„ç†å¥½å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®çš„é—®é¢˜ï¼›éœ€é€šè¿‡åŒé‡æ£€æŸ¥é”å®šç­‰æœºåˆ¶è¿›è¡Œæ§åˆ¶ï¼Œå°†å¯¼è‡´ç³»ç»Ÿæ€§èƒ½å—åˆ°ä¸€å®šå½±å“ã€‚ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:3:3","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"4 ä½¿ç”¨é™æ€å†…éƒ¨ç±»å®ç°å•ä¾‹æ¨¡å¼ é¥¿æ±‰å¼å•ä¾‹ç±»ä¸èƒ½å®ç°å»¶è¿ŸåŠ è½½ï¼Œä¸ç®¡å°†æ¥ç”¨ä¸ç”¨å§‹ç»ˆå ç”¨å†…å­˜ï¼›æ‡’æ±‰å¼å•ä¾‹ç±»å®‰å…¨æ§åˆ¶çƒ¦çï¼Œè€Œä¸”æ€§èƒ½å—å½±å“ã€‚å¯è§å®ƒä»¬éƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¸ºäº†å…‹æœè¿™äº›é—®é¢˜ï¼Œåœ¨Javaè¯­è¨€ä¸­å¯ä»¥é€šè¿‡Initialization on Demand Holderï¼ˆIoDHï¼‰æŠ€æœ¯æ¥å®ç°å•ä¾‹æ¨¡å¼ã€‚ åœ¨IoDHä¸­ï¼Œéœ€è¦åœ¨å•ä¾‹ç±»ä¸­å¢åŠ ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œåœ¨è¯¥å†…éƒ¨ç±»ä¸­åˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œå†å°†è¯¥å•ä¾‹å¯¹è±¡é€šè¿‡getInstance()æ–¹æ³•è¿”å›ç»™å¤–éƒ¨ä½¿ç”¨ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š //Initialization on Demand Holder public class Singleton { private Singleton() { } //é™æ€å†…éƒ¨ç±» private static class HolderClass { private final static Singleton instance = new Singleton(); } public static Singleton getInstance() { return HolderClass.instance; } public static void main(String args[]) { Singleton s1, s2; s1 = Singleton.getInstance(); s2 = Singleton.getInstance(); System.out.println(s1==s2); } } é€šè¿‡ä½¿ç”¨IoDHæ—¢å¯ä»¥å®ç°å»¶è¿ŸåŠ è½½ï¼Œåˆå¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä¸å½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œä¸å¤±ä¸ºä¸€ç§æœ€å¥½çš„Javaè¯­è¨€å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼ï¼›å…¶ç¼ºç‚¹æ˜¯ä¸ç¼–ç¨‹è¯­è¨€æœ¬èº«çš„ç‰¹æ€§ç›¸å…³ï¼Œå¾ˆå¤šé¢å‘å¯¹è±¡è¯­è¨€å¹¶ä¸æ”¯æŒIoDHã€‚ ","date":"2022-04-24","objectID":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:4:0","tags":["å•ä¾‹æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/04.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"1 å·¥å‚æ¨¡å¼ä»‹ç» å·¥å‚é¡¾åæ€ä¹‰å°±æ˜¯åˆ›å»ºäº§å“ï¼Œæ ¹æ®äº§å“æ˜¯å…·ä½“äº§å“è¿˜æ˜¯å…·ä½“å·¥å‚å¯åˆ†ä¸ºç®€å•å·¥å‚æ¨¡å¼ï¼ˆSimple Factory Patternï¼‰å’Œå·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Method Patternï¼‰ï¼Œæ ¹æ®å·¥å‚çš„æŠ½è±¡ç¨‹åº¦å¯åˆ†ä¸ºå·¥å‚æ–¹æ³•æ¨¡å¼å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰ã€‚è¯¥æ¨¡å¼ç”¨äºå°è£…å’Œç®¡ç†å¯¹è±¡çš„åˆ›å»ºï¼Œæ˜¯ä¸€ç§åˆ›å»ºå‹æ¨¡å¼ã€‚ è¿™æ ·çœ‹æˆ‘ä»¬å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼Œä½†å…¶ä¸­ç®€å•å·¥å‚å…¶å®ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„çš„è®¾è®¡æ¨¡å¼ã€‚GOF 23 ç§è®¾è®¡æ¨¡å¼ä¸­åªæœ‰ã€Œå·¥å‚æ–¹æ³•æ¨¡å¼ã€ä¸ã€ŒæŠ½è±¡å·¥å‚æ¨¡å¼ã€ã€‚ç®€å•å·¥å‚æ¨¡å¼å¯ä»¥çœ‹ä¸ºå·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸€ç§ç‰¹ä¾‹ã€‚ åœ¨å·¥å‚æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¸ä¼šå¯¹å®¢æˆ·ç«¯æš´éœ²åˆ›å»ºé€»è¾‘ï¼Œå¹¶ä¸”æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„æ¥å£æ¥æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚ å®ƒçš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š å¯ä»¥ä½¿ä»£ç ç»“æ„æ¸…æ™°ï¼Œæœ‰æ•ˆåœ°å°è£…å˜åŒ–ã€‚ å¯¹è°ƒç”¨è€…å±è”½å…·ä½“çš„äº§å“ç±» é™ä½è€¦åˆåº¦ã€‚ é€‚ç”¨åœºæ™¯ï¼šä½œä¸ºä¸€ç§åˆ›å»ºç±»æ¨¡å¼ï¼Œåœ¨ä»»ä½•éœ€è¦ç”Ÿæˆå¤æ‚å¯¹è±¡çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯å¤æ‚å¯¹è±¡é€‚åˆä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œè€Œç®€å•å¯¹è±¡ï¼Œç‰¹åˆ«æ˜¯åªéœ€è¦é€šè¿‡ new å°±å¯ä»¥å®Œæˆåˆ›å»ºçš„å¯¹è±¡ï¼Œæ— éœ€ä½¿ç”¨å·¥å‚æ¨¡å¼ã€‚å¦‚æœä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œå°±éœ€è¦å¼•å…¥ä¸€ä¸ªå·¥å‚ç±»ï¼Œä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚ å…¶æ¬¡ï¼Œå·¥å‚æ¨¡å¼æ˜¯ä¸€ç§å…¸å‹çš„è§£è€¦æ¨¡å¼ï¼Œè¿ªç±³ç‰¹æ³•åˆ™åœ¨å·¥å‚æ¨¡å¼ä¸­è¡¨ç°çš„å°¤ä¸ºæ˜æ˜¾ã€‚å‡å¦‚è°ƒç”¨è€…è‡ªå·±ç»„è£…äº§å“éœ€è¦å¢åŠ ä¾èµ–å…³ç³»æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œå°†ä¼šå¤§å¤§é™ä½å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦ã€‚å†æ¬¡ï¼Œç”±äºå·¥å‚æ¨¡å¼æ˜¯ä¾é æŠ½è±¡æ¶æ„çš„ï¼Œå®ƒæŠŠå®ä¾‹åŒ–äº§å“çš„ä»»åŠ¡äº¤ç”±å®ç°ç±»å®Œæˆï¼Œæ‰©å±•æ€§æ¯”è¾ƒå¥½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“éœ€è¦ç³»ç»Ÿæœ‰æ¯”è¾ƒå¥½çš„æ‰©å±•æ€§æ—¶ï¼Œå¯ä»¥è€ƒè™‘å·¥å‚æ¨¡å¼ï¼Œä¸åŒçš„äº§å“ç”¨ä¸åŒçš„å®ç°å·¥å‚æ¥ç»„è£…ã€‚ ","date":"2022-04-21","objectID":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:1:0","tags":["å·¥å‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2 å·¥å‚æ¨¡å¼è¯¦è§£ ","date":"2022-04-21","objectID":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:0","tags":["å·¥å‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.1 ç®€å•å·¥å‚æ¨¡å¼ 2.1.1 ç®€å•å·¥å‚æ¨¡å¼ç»“æ„ è¯¥æ¨¡å¼å¯¹å¯¹è±¡åˆ›å»ºç®¡ç†æ–¹å¼æœ€ä¸ºç®€å•ï¼Œå› ä¸ºå…¶ä»…ä»…ç®€å•çš„å¯¹ä¸åŒç±»å¯¹è±¡çš„åˆ›å»ºè¿›è¡Œäº†ä¸€å±‚è–„è–„çš„å°è£…ã€‚è¯¥æ¨¡å¼é€šè¿‡å‘å·¥å‚ä¼ é€’ç±»å‹æ¥æŒ‡å®šè¦åˆ›å»ºçš„å¯¹è±¡ï¼Œå…¶UMLç±»å›¾å¦‚ä¸‹ï¼š å…¶ä¸­æ ¹æ®ä¸Šå›¾å¯çŸ¥ï¼Œç®€å•å·¥å‚æ¨¡å¼åŒ…å«ä»¥ä¸‹3ä¸ªè§’è‰²ã€‚ Factoryï¼ˆå·¥å‚è§’è‰²ï¼‰ï¼šå³å·¥å‚ç±»ï¼Œå®ƒæ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„æ ¸å¿ƒï¼Œè´Ÿè´£å®ç°åˆ›å»ºæ‰€æœ‰äº§å“å®ä¾‹çš„å†…éƒ¨é€»è¾‘ï¼›å…¶å¯ä»¥è¢«å¤–ç•Œç›´æ¥è°ƒç”¨ï¼Œåˆ›å»ºæ‰€éœ€çš„äº§å“å¯¹è±¡ã€‚ AbstractProductï¼ˆæŠ½è±¡äº§å“è§’è‰²ï¼‰ï¼šå®ƒæ˜¯å·¥å‚ç±»åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œå°è£…äº†å„ç§äº§å“å¯¹è±¡çš„å…±æœ‰æ–¹æ³•ã€‚ Product1ï¼ˆå…·ä½“äº§å“è§’è‰²ï¼‰ï¼šå®ƒæ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„åˆ›å»ºç›®æ ‡ï¼Œæ‰€æœ‰è¢«åˆ›å»ºçš„å¯¹è±¡éƒ½å……å½“è¿™ä¸ªè§’è‰²çš„æŸä¸ªå…·ä½“ç±»çš„å®ä¾‹ã€‚ 2.1.2 ç®€å•å·¥å‚æ¨¡å¼å®ç° å…¸å‹çš„æŠ½è±¡äº§å“ç±»ä»£ç å¦‚ä¸‹ï¼š public abstract class AbstractProduct { // æ‰€æœ‰äº§å“ç±»çš„å…¬å…±ä¸šåŠ¡æ–¹æ³• public void methodSame() { // å…¬æœ‰æ–¹æ³•çš„å®ç° } // å£°æ˜æŠ½è±¡ä¸šåŠ¡æ–¹æ³• public abstract void methodDiff() { } } å…¸å‹çš„å…·ä½“äº§å“ç±»çš„ä»£ç å¦‚ä¸‹ï¼š public class Product1 extends AbstractProduct { // å®ç°ä¸šåŠ¡æ–¹æ³• public void methodDiff() { // ä¸šåŠ¡æ–¹æ³•çš„å®ç° } } å…¸å‹çš„å·¥å‚ç±»çš„ä»£ç å¦‚ä¸‹ï¼š public class Factory { // é™æ€å·¥å‚æ–¹æ³• public static AbstractProduct createProduct(String arg) { AbstractProduct product = null; if (arg.equalsIgnoreCase(\"1\")) { product = new Product1(); } else if (arg.equalsIgnoreCase(\"2\")) { product = new Product2(); } return product; } } å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œé€šè¿‡è°ƒç”¨å·¥å‚ç±»çš„å·¥å‚æ–¹æ³•å³å¯å¾—åˆ°äº§å“å¯¹è±¡ã€‚ 2.1.3 ç®€å•å·¥å‚æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼è®¾è®¡ä¸€ä¸ªå¯ä»¥åˆ›å»ºä¸åŒå‡ ä½•å›¾å½¢ï¼ˆShapeï¼‰ï¼Œå¦‚Circleï¼ŒRectangleï¼ŒTriangleç­‰ç»˜å›¾å·¥å…·ç±»ï¼Œæ¯ä¸ªå‡ ä½•å›¾å½¢å‡å…·æœ‰ç»˜åˆ¶draw()å’Œæ“¦é™¤erase()ä¸¤ä¸ªæ–¹æ³•ï¼›è¦æ±‚åœ¨ç»˜åˆ¶ä¸æ”¯æŒçš„å‡ ä½•å›¾å½¢æ—¶ï¼ŒæŠ›å‡ºä¸€ä¸ªUnsuppShapeExceptionå¼‚å¸¸ï¼Œç»˜åˆ¶ç±»å›¾å¹¶ä½¿ç”¨Javaè¯­è¨€å®ç°ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼ŒShapeæ¥å£å……å½“æŠ½è±¡äº§å“ï¼Œå…¶å­ç±»Circleã€Rectangleã€Triangleç­‰å……å½“å…·ä½“äº§å“ï¼ŒShapeFactoryå……å½“å·¥å‚ç±»ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-21","objectID":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:1","tags":["å·¥å‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.2 å·¥å‚æ–¹æ³•æ¨¡å¼ 2.2.1 å·¥å‚æ–¹æ³•æ¨¡å¼ç»“æ„ å’Œç®€å•å·¥å‚æ¨¡å¼ä¸­å·¥å‚è´Ÿè´£ç”Ÿäº§æ‰€æœ‰äº§å“ç›¸æ¯”ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼å°†ç”Ÿæˆå…·ä½“äº§å“çš„ä»»åŠ¡åˆ†å‘ç»™å…·ä½“çš„äº§å“å·¥å‚ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰ä¸€ä¸ªæŠ½è±¡å·¥å‚ï¼Œå…¶å®šä¹‰äº†äº§å“çš„ç”Ÿäº§æ¥å£ï¼Œä½†ä¸è´Ÿè´£å…·ä½“çš„äº§å“ï¼Œå°†ç”Ÿäº§ä»»åŠ¡äº¤ç»™ä¸åŒçš„æ´¾ç”Ÿç±»å·¥å‚ã€‚è¿™æ ·ä¸ç”¨é€šè¿‡æŒ‡å®šç±»å‹æ¥åˆ›å»ºå¯¹è±¡äº†ã€‚å…¶UMLç±»å›¾å¦‚ä¸‹ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼åŒ…å«ä»¥ä¸‹å››ä¸ªè§’è‰²ã€‚ AbstractProductï¼ˆæŠ½è±¡äº§å“ï¼‰ï¼šå®ƒæ˜¯å®šä¹‰äº§å“çš„æ¥å£ï¼Œæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼æ‰€åˆ›å»ºå¯¹è±¡çš„å…¬å…±çˆ¶ç±»ã€‚ Product1ï¼ˆå…·ä½“äº§å“ï¼‰ï¼šå®ƒå®ç°äº†æŠ½è±¡äº§å“æ¥å£ï¼ŒæŸç§ç±»å‹çš„å…·ä½“äº§å“ç”±ä¸“é—¨çš„å…·ä½“å·¥å‚åˆ›å»ºï¼Œå…·ä½“å·¥å‚å’Œå…·ä½“äº§å“ä¹‹é—´ä¸€ä¸€å¯¹åº”ã€‚ AbstractFactoryï¼ˆæŠ½è±¡å·¥å‚ï¼‰ï¼šåœ¨æŠ½è±¡å·¥å‚ç±»ä¸­å£°æ˜äº†å·¥å‚æ–¹æ³•ï¼Œç”¨äºè¿”å›ä¸€ä¸ªäº§å“ã€‚æŠ½è±¡å·¥å‚æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œæ‰€æœ‰åˆ›å»ºå¯¹è±¡çš„å·¥å‚ç±»éƒ½å¿…é¡»å®ç°è¯¥æ¥å£ã€‚ ConcreteFactory1ï¼ˆå…·ä½“å·¥å‚ï¼‰ï¼šå®ƒæ˜¯æŠ½è±¡å·¥å‚ç±»çš„å­ç±»ï¼Œå®ç°äº†åœ¨æŠ½è±¡å·¥å‚ä¸­å£°æ˜çš„å·¥å‚æ–¹æ³•ï¼Œå¹¶å¯ç”±å®¢æˆ·ç«¯è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“äº§å“ç±»çš„å®ä¾‹ã€‚ 2.2.2 å·¥å‚æ–¹æ³•æ¨¡å¼å®ç° å…¸å‹çš„æŠ½è±¡äº§å“ç±»ä»£ç å¦‚ä¸‹ï¼š public abstract class AbstractProduct { // æ‰€æœ‰äº§å“ç±»çš„å…¬å…±ä¸šåŠ¡æ–¹æ³• public void methodSame() { // å…¬æœ‰æ–¹æ³•çš„å®ç° } // å£°æ˜æŠ½è±¡ä¸šåŠ¡æ–¹æ³• public abstract void methodDiff() { } } å…¸å‹çš„å…·ä½“äº§å“ç±»çš„ä»£ç å¦‚ä¸‹ï¼š public class Product1 extends AbstractProduct { // å®ç°ä¸šåŠ¡æ–¹æ³• public void methodDiff() { // ä¸šåŠ¡æ–¹æ³•çš„å®ç° } } å…¸å‹çš„æŠ½è±¡å·¥å‚ä»£ç å¦‚ä¸‹ï¼š public interface AbstractFactory { public Product createProduct(); } å…¸å‹çš„å…·ä½“å·¥å‚ä»£ç å¦‚ä¸‹ï¼š public class ConcreteFactory1 implements Factory { public Product createProduct() { return new Product1(); } } 2.2.3 å·¥å‚æ–¹æ³•æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° ç°éœ€è¦è®¾è®¡ä¸€ä¸ªç¨‹åºæ¥è¯»å–å¤šç§ä¸åŒç±»å‹çš„å›¾ç‰‡æ ¼å¼ï¼Œé’ˆå¯¹æ¯ä¸€ç§å›¾ç‰‡æ ¼å¼éƒ½è®¾è®¡ä¸€ä¸ªå›¾ç‰‡è¯»å–å™¨ï¼ˆImgReaderï¼‰ï¼Œå¦‚gifå›¾ç‰‡è¯»å–å™¨ï¼ˆGifReaderï¼‰ç”¨äºè¯»å–gifæ ¼å¼çš„å›¾ç‰‡,jpgå›¾ç‰‡è¯»å–å™¨ï¼ˆJpgReaderï¼‰ç”¨äºè¯»å–jpgæ ¼å¼çš„å›¾ç‰‡ã€‚å›¾ç‰‡è¯»å–å™¨å¯¹è±¡é€šè¿‡å›¾ç‰‡è¯»å–å™¨å·¥å‚ImgReaderFactoryæ¥åˆ›å»ºã€‚ImgReaderFactoryæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç”¨äºå®šä¹‰åˆ›å»ºå›¾ç‰‡è¯»å–å™¨çš„å·¥å‚æ–¹æ³•ï¼Œå…¶GifReaderFactoryå’ŒJpgReaderFactoryç”¨äºåˆ›å»ºå…·ä½“çš„å›¾ç‰‡è¯»å–å™¨å¯¹è±¡ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼Œæ¥å£ImageReaderFactoryå……å½“æŠ½è±¡å·¥å‚ï¼ŒGifReaderFactoryå’ŒJpgReaderFactoryå……å½“å…·ä½“å·¥å‚ï¼ŒImageReaderå……å½“æŠ½è±¡äº§å“ï¼ŒGifReaderå’ŒJpgReaderå……å½“å…·ä½“äº§å“ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-21","objectID":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:2","tags":["å·¥å‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["è®¾è®¡æ¨¡å¼"],"content":"2.3 æŠ½è±¡å·¥å‚æ¨¡å¼ 2.3.1 æŠ½è±¡å·¥å‚æ¨¡å¼ç»“æ„ ä¸Šé¢ä¸¤ç§æ¨¡å¼ä¸ç®¡å·¥å‚æ€ä¹ˆæ‹†åˆ†æŠ½è±¡ï¼Œéƒ½åªæ˜¯é’ˆå¯¹ä¸€ç±»äº§å“ï¼ˆAbstractProductï¼‰ï¼Œåº”è¯¥æ€ä¹ˆè¡¨ç¤ºå‘¢ï¼Ÿ æœ€ç®€å•çš„æ–¹å¼æ˜¯æŠŠ2ä¸­ä»‹ç»çš„å·¥å‚æ–¹æ³•æ¨¡å¼å®Œå…¨å¤åˆ¶ä¸€ä»½ï¼Œä¸è¿‡è¿™æ¬¡ç”Ÿäº§çš„æ˜¯å¦ä¸€ç±»äº§å“ã€‚ä½†åŒæ—¶ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬è¦å®Œå…¨å¤åˆ¶å’Œä¿®æ”¹åŸæ¥ç”Ÿäº§ç®¡ç†çš„æ‰€æœ‰ä»£ç ï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªç¬¨åŠæ³•ï¼Œå¹¶ä¸åˆ©äºæ‰©å±•å’Œç»´æŠ¤ã€‚ æŠ½è±¡å·¥å‚æ¨¡å¼é€šè¿‡åœ¨AbstarctFactoryä¸­å¢åŠ åˆ›å»ºäº§å“çš„æ¥å£ï¼Œå¹¶åœ¨å…·ä½“å­å·¥å‚ä¸­å®ç°æ–°åŠ äº§å“çš„åˆ›å»ºï¼Œå½“ç„¶å‰ææ˜¯å­å·¥å‚æ”¯æŒç”Ÿäº§è¯¥äº§å“ã€‚å¦åˆ™ç»§æ‰¿çš„è¿™ä¸ªæ¥å£å¯ä»¥ä»€ä¹ˆä¹Ÿä¸å¹²ã€‚å…¶UMLå›¾å¦‚ä¸‹ï¼š ç”±ä¸Šå›¾å¯çŸ¥ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼åŒ…å«ä»¥ä¸‹å››ä¸ªè§’è‰²ã€‚ AbstractProductï¼ˆæŠ½è±¡äº§å“ï¼‰ï¼šå®ƒä¸ºæ¯ç§äº§å“å£°æ˜æ¥å£ï¼Œåœ¨æŠ½è±¡äº§å“ä¸­å£°æ˜äº†äº§å“æ‰€å…·æœ‰çš„ä¸šåŠ¡æ–¹æ³•ã€‚ Product1ï¼ˆå…·ä½“äº§å“ï¼‰ï¼šå®ƒå®šä¹‰å…·ä½“å·¥å‚ç”Ÿäº§çš„å…·ä½“äº§å“çš„å…·ä½“äº§å“å¯¹è±¡ï¼Œå®ç°æŠ½è±¡äº§å“æ¥å£ä¸­å£°æ˜çš„ä¸šåŠ¡æ–¹æ³•ã€‚ AbstractFactoryï¼ˆæŠ½è±¡å·¥å‚ï¼‰ï¼šå®ƒå£°æ˜äº†ä¸€ç»„ç”¨äºåˆ›å»ºä¸€æ—äº§å“çš„æ–¹æ³•ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€ç§äº§å“ã€‚ ConcreteFactory1ï¼ˆå…·ä½“å·¥å‚ï¼‰ï¼šå®ƒå®ç°äº†åœ¨æŠ½è±¡å·¥å‚ä¸­å£°æ˜çš„åˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œç”Ÿæˆä¸€ç»„å…·ä½“äº§å“ï¼Œè¿™äº›äº§å“æ„æˆäº†ä¸€ä¸ªäº§å“æ—ï¼Œæ¯ä¸€ä¸ªäº§å“éƒ½ä½äºæŸä¸ªäº§å“ç­‰çº§ç»“æ„ä¸­ã€‚ 2.3.2 æŠ½è±¡å·¥å‚æ¨¡å¼å®ç° æŠ½è±¡å·¥å‚ç±»å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public interface AbstractFactory { public AbstractProduct1 createProduct1(); // å·¥å‚æ–¹æ³•ä¸€ public AbstractProduct2 createProduct2(); // å·¥å‚æ–¹æ³•ã€äºŒ } å…·ä½“å·¥å‚ç±»å…¸å‹ä»£ç å¦‚ä¸‹ï¼š public class ConcreteFactory1 implements AbstractFactory { // å·¥å‚æ–¹æ³•ä¸€ public AbstractProduct1 createProduct1() { return new Product1(); } // å·¥å‚æ–¹æ³•äºŒ public AbstractProduct2 createProduct2() { return new Product2(); } } 2.3.3 æŠ½è±¡å·¥å‚æ¨¡å¼åº”ç”¨ä¸¾ä¾‹ é¢˜ç›®æè¿° æŠ½è±¡å·¥å‚æ¨¡å¼æœ€æ—©çš„åº”ç”¨æ˜¯ç”¨äºåˆ›å»ºåˆ†å±äºä¸åŒæ“ä½œç³»ç»Ÿçš„è§†çª—æ„å»ºã€‚æ¯”å¦‚:å‘½ä»¤æŒ‰é”®(Button)ä¸æ–‡å­—æ¡†(Text)éƒ½æ˜¯è§†çª—æ„ä»¶ï¼Œåœ¨Unixã€Windowså’ŒLinuxæ“ä½œç³»ç»Ÿçš„è§†çª—ç¯å¢ƒä¸­ï¼Œè¿™ä¸¤ä¸ªæ„ä»¶æœ‰ä¸åŒçš„æœ¬åœ°å®ç°ï¼Œå®ƒä»¬çš„ç»†èŠ‚ä¹Ÿæœ‰æ‰€ä¸åŒã€‚è¯•ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼æ¥è®¾è®¡å¹¶æ¨¡æ‹Ÿå®ç°è¯¥ç»“æ„ã€‚ UMLç±»å›¾ å…¶ä¸­ï¼Œæ¥å£AbstractFactoryå……å½“æŠ½è±¡å·¥å‚ï¼Œå…¶å­ç±»WindowsFactoryã€UnixFactoryå’ŒLinuxFactoryå……å½“å…·ä½“å·¥å‚ï¼›Textå’ŒButtonå……å½“æŠ½è±¡äº§å“ï¼Œå…¶å­ç±»WindowsTextã€UnixTextã€LinuxTextå’ŒWindowsButtonã€UnixButtonã€LinuxButtonå……å½“å…·ä½“äº§å“ã€‚ ä»£ç  ä»£ç åœ°å€ ","date":"2022-04-21","objectID":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/:2:3","tags":["å·¥å‚æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼è¯¦è§£ï¼ˆJavaå®ç°ï¼‰","uri":"/posts/01.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3java%E5%AE%9E%E7%8E%B0/"},{"categories":["æŠ€æœ¯åŸºç¡€"],"content":"1 å‰è¨€ æˆ‘ä»¬çŸ¥é“ï¼Œå½“ç¨‹åºè¿è¡Œèµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ªè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹æ‰€å±çš„ä¸»çº¿ç¨‹å¼€å§‹è‡ªåŠ¨è¿è¡Œï¼ŒC/C++çš„ä¸»çº¿ç¨‹å°±æ˜¯mainå‡½æ•°ï¼›å½“ä¸»çº¿ç¨‹ä»main()å‡½æ•°è¿”å›ï¼Œåˆ™æ•´ä¸ªè¿›ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚ æ‰€ä»¥ä¸»çº¿ç¨‹æ˜¯ä»main()å¼€å§‹æ‰§è¡Œï¼Œå…¶ä¸­æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„çº¿ç¨‹ï¼Œä¹Ÿéœ€è¦ä»ä¸€ä¸ªå‡½æ•°å¼€å§‹è¿è¡Œï¼ˆåˆå§‹å‡½æ•°ï¼‰ï¼Œä¸€æ—¦è¿™ä¸ªå‡½æ•°è¿è¡Œå®Œæ¯•ï¼Œçº¿ç¨‹ä¹Ÿç»“æŸè¿è¡Œã€‚æ‰€ä»¥æ•´ä¸ªè¿›ç¨‹æ˜¯å¦æ‰§è¡Œå®Œæ¯•çš„æ ‡å¿—æ˜¯ï¼šä¸»çº¿ç¨‹æ˜¯å¦æ‰§è¡Œå®Œï¼Œå¦‚æœä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•äº†ï¼Œå°±ä»£è¡¨æ•´ä¸ªè¿›ç¨‹æ‰§è¡Œå®Œæ¯•äº†ï¼Œæ­¤æ—¶å¦‚æœå…¶ä»–å­çº¿ç¨‹è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä¹Ÿä¼šè¢«å¼ºè¡Œç»ˆæ­¢ï¼ˆç¬¦åˆå¤§éƒ¨åˆ†è§„å¾‹ï¼Œä¹Ÿæœ‰ä¾‹å¤–ï¼‰ã€‚ æˆ‘ä»¬éœ€è¦æ˜ç™½ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹åœ¨è·‘ï¼Œç›¸å½“äºæ•´ä¸ªç¨‹åºä¸­æœ‰ä¸¤æ¡çº¿åœ¨åŒæ—¶èµ°ï¼Œå³ä½¿ä¸€æ¡è¢«é˜»å¡ï¼Œå¦ä¸€æ¡ä¹Ÿèƒ½è¿è¡Œã€‚ åœ¨C++11ä»¥å‰ï¼Œä½¿ç”¨çº¿ç¨‹åº“ç‰¹åˆ«éº»çƒ¦ï¼ŒC++11æä¾›äº†ä¸€ä¸ªæ–°æ ‡å‡†çº¿ç¨‹åº“ï¼Œå³threadï¼Œæ„å‘³ç€C++è¯­è¨€æœ¬èº«å¢åŠ å¯¹å¤šçº¿ç¨‹çš„æ”¯æŒï¼Œæ„å‘³ç€å¯ç§»æ¤æ€§ï¼ˆè·¨å¹³å°ï¼‰ï¼Œè¿™å¤§å¤§å‡å°‘å¼€å‘äººå‘˜çš„å·¥ä½œé‡ã€‚ ","date":"2022-04-07","objectID":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/:1:0","tags":["å¤šçº¿ç¨‹","C++"],"title":"C++11å¤šçº¿ç¨‹ std::threadè¯¦è§£","uri":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/"},{"categories":["æŠ€æœ¯åŸºç¡€"],"content":"2 std::thread ","date":"2022-04-07","objectID":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/:2:0","tags":["å¤šçº¿ç¨‹","C++"],"title":"C++11å¤šçº¿ç¨‹ std::threadè¯¦è§£","uri":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/"},{"categories":["æŠ€æœ¯åŸºç¡€"],"content":"2.1 æ„é€ å‡½æ•° æ„é€ å‡½æ•°å¦‚ä¸‹ï¼Œå…¶å«ä¹‰åˆ†åˆ«æ³¨é‡Šï¼š thread() noexcept; // åˆ›å»ºä¸ä»£è¡¨çº¿ç¨‹çš„æ–°çº¿ç¨‹å¯¹è±¡ã€‚ thread( thread\u0026\u0026 other ) noexcept; // ç§»åŠ¨æ„é€ å‡½æ•°ã€‚æ„é€ è¡¨ç¤ºæ›¾ä¸º other æ‰€è¡¨ç¤ºçš„æ‰§è¡Œçº¿ç¨‹çš„ thread å¯¹è±¡ã€‚æ­¤è°ƒç”¨å other ä¸å†è¡¨ç¤ºæ‰§è¡Œçº¿ç¨‹ã€‚ä¸€èˆ¬éœ€è¦ä½¿ç”¨moveæ–¹æ³• template\u003c class Function, class... Args \u003e explicit thread( Function\u0026\u0026 f, Args\u0026\u0026... args ); // æ„é€ æ–°çš„ std::thread å¯¹è±¡å¹¶å°†å®ƒä¸æ‰§è¡Œçº¿ç¨‹å…³è”ã€‚æ–°çš„æ‰§è¡Œçº¿ç¨‹å¼€å§‹æ‰§è¡Œã€‚å…¶ä¸­fä¸ºå¯è°ƒç”¨å‡½æ•°å¯¹è±¡ï¼Œargsä¸ºä¼ é€’çš„å‡½æ•°å‚æ•°ï¼Œä¸€å®šè¦ç›¸äº’å¯¹åº”ã€‚ thread(const thread\u0026) = delete; // å¤åˆ¶æ„é€ å‡½æ•°è¢«åˆ é™¤ï¼Œçº¿ç¨‹ä¸å¯å¤åˆ¶ã€‚ åˆ›å»ºçº¿ç¨‹å¯¹è±¡æ€»å…±æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š #include \u003ciostream\u003e #include \u003cthread\u003e #include \u003cunistd.h\u003e // æä¾›sleepå‡½æ•° void sum(int a, int b) { std::cout \u003c\u003c a + b \u003c\u003c std::endl; } int main() { std::thread t1(); // ä¸æ˜¯çº¿ç¨‹ï¼Œä½¿ç”¨ç¬¬ä¸€ç§æ„é€ æ–¹æ³• int a = 1, b = 2; std::thread t2(sum, a, b); // æ˜¯çº¿ç¨‹ï¼ŒæŒ‰å€¼ä¼ é€’ï¼Œä½¿ç”¨ç¬¬ä¸‰ç§æ„é€ æ–¹æ³• std::thread t3(sum, std::ref(a), std::ref(b)); // æ˜¯çº¿ç¨‹ï¼ŒæŒ‰å¼•ç”¨ä¼ é€’ï¼Œä½¿ç”¨ç¬¬ä¸‰ç§æ„é€ æ–¹æ³• std::thread t4(std::move(t2)); // t3ç°åœ¨æ˜¯çº¿ç¨‹ï¼Œè¿è¡Œsumï¼Œt2ä¸å†æ˜¯çº¿ç¨‹ã€‚è¿™æ˜¯ä½¿ç”¨ç¬¬äºŒç§æ„é€ æ–¹æ³•ã€‚ t2.join(); t4.join(); return 0; } å®˜ç½‘ä¸Šçš„ç»™çš„ä»£ç å¦‚ä¸‹ï¼ˆè¿™ç§ç§ç±»æ›´å¤šï¼Œé€‚åˆç”¨æ¥åˆ†æå­¦ä¹ ï¼Œä¸Šé¢åˆ—ä¸¾çš„å†…å®¹å®é™…ä¸Šå°±å¤Ÿç”¨äº†ï¼‰ï¼š #include \u003ciostream\u003e #include \u003cutility\u003e #include \u003cthread\u003e #include \u003cchrono\u003e void f1(int n) { for (int i = 0; i \u003c 5; ++i) { std::cout \u003c\u003c \"Thread 1 executing\\n\"; ++n; std::this_thread::sleep_for(std::chrono::milliseconds(10)); } } void f2(int\u0026 n) { for (int i = 0; i \u003c 5; ++i) { std::cout \u003c\u003c \"Thread 2 executing\\n\"; ++n; std::this_thread::sleep_for(std::chrono::milliseconds(10)); } } class foo { public: void bar() { for (int i = 0; i \u003c 5; ++i) { std::cout \u003c\u003c \"Thread 3 executing\\n\"; ++n; std::this_thread::sleep_for(std::chrono::milliseconds(10)); } } int n = 0; }; class baz { public: void operator()() { for (int i = 0; i \u003c 5; ++i) { std::cout \u003c\u003c \"Thread 4 executing\\n\"; ++n; std::this_thread::sleep_for(std::chrono::milliseconds(10)); } } int n = 0; }; int main() { int n = 0; foo f; baz b; std::thread t1; // t1 is not a thread std::thread t2(f1, n + 1); // pass by value std::thread t3(f2, std::ref(n)); // pass by reference std::thread t4(std::move(t3)); // t4 is now running f2(). t3 is no longer a thread std::thread t5(\u0026foo::bar, \u0026f); // t5 runs foo::bar() on object f std::thread t6(b); // t6 runs baz::operator() on a copy of object b t2.join(); t4.join(); t5.join(); t6.join(); std::cout \u003c\u003c \"Final value of n is \" \u003c\u003c n \u003c\u003c '\\n'; std::cout \u003c\u003c \"Final value of f.n (foo::n) is \" \u003c\u003c f.n \u003c\u003c '\\n'; std::cout \u003c\u003c \"Final value of b.n (baz::n) is \" \u003c\u003c b.n \u003c\u003c '\\n'; } ","date":"2022-04-07","objectID":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/:2:1","tags":["å¤šçº¿ç¨‹","C++"],"title":"C++11å¤šçº¿ç¨‹ std::threadè¯¦è§£","uri":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/"},{"categories":["æŠ€æœ¯åŸºç¡€"],"content":"2.2 è§‚å¯Ÿå™¨ 2.2.1 std:ğŸ§µ:joinable bool joinable() const noexcept; è¿™ä¸ªå‡½æ•°ç”¨æ¥æ£€æŸ¥thisæ˜¯å¦æ ‡è¯†äº†ä¸€ä¸ªæ´»åŠ¨çš„æ‰§è¡Œçº¿ç¨‹ï¼Œå³å¦‚æœthisæ ‡è¯†äº†ä¸€ä¸ªæ´»åŠ¨çš„æ‰§è¡Œçº¿ç¨‹ï¼Œå°±è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ #include \u003ciostream\u003e #include \u003cthread\u003e #include \u003cchrono\u003e void foo() { std::this_thread::sleep_for(std::chrono::seconds(1)); } int main() { std::thread t; std::cout \u003c\u003c \"before starting, joinable: \" \u003c\u003c std::boolalpha \u003c\u003c t.joinable() \u003c\u003c '\\n'; t = std::thread(foo); std::cout \u003c\u003c \"after starting, joinable: \" \u003c\u003c t.joinable() \u003c\u003c '\\n'; t.join(); std::cout \u003c\u003c \"after joining, joinable: \" \u003c\u003c t.joinable() \u003c\u003c '\\n'; } Output: before starting, joinable: false after starting, joinable: true after joining, joinable: false 2.2.2 std:ğŸ§µ:get_id std::thread::id get_id() const noexcept; è¿”å›æ ‡è¯†ä¸ *this å…³è”çš„çº¿ç¨‹çš„ std::thread::id ã€‚å¦‚æœæ²¡æœ‰å…³è”çº¿ç¨‹ï¼Œåˆ™è¿”å›é»˜è®¤æ„é€ çš„std::thread::idã€‚ #include \u003ciostream\u003e #include \u003cthread\u003e #include \u003cchrono\u003e void foo() { std::this_thread::sleep_for(std::chrono::seconds(1)); } int main() { std::thread t1(foo); std::thread::id t1_id = t1.get_id(); std::thread t2(foo); std::thread::id t2_id = t2.get_id(); std::cout \u003c\u003c \"t1's id: \" \u003c\u003c t1_id \u003c\u003c '\\n'; std::cout \u003c\u003c \"t2's id: \" \u003c\u003c t2_id \u003c\u003c '\\n'; t1.join(); t2.join(); } Possible output: t1's id: 2 t2's id: 3 ","date":"2022-04-07","objectID":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/:2:2","tags":["å¤šçº¿ç¨‹","C++"],"title":"C++11å¤šçº¿ç¨‹ std::threadè¯¦è§£","uri":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/"},{"categories":["æŠ€æœ¯åŸºç¡€"],"content":"2.3 æ“ä½œ 2.3.1 std:ğŸ§µ:join void join(); é˜»å¡å½“å‰çº¿ç¨‹ç›´è‡³ *thisæ‰€æ ‡è¯†çš„çº¿ç¨‹ç»“æŸå…¶æ‰§è¡Œã€‚*this æ‰€æ ‡è¯†çš„çº¿ç¨‹çš„å®ŒæˆåŒæ­¥äºå¯¹åº”çš„ä» join() æˆåŠŸè¿”å›ã€‚*this è‡ªèº«ä¸Šä¸è¿›è¡ŒåŒæ­¥ã€‚åŒæ—¶ä»å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€ thread å¯¹è±¡ä¸Šè°ƒç”¨ join() æ„æˆæ•°æ®ç«äº‰ï¼Œå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚ å¯èƒ½å¼•å‘çš„å¼‚å¸¸ä¸ºï¼šstd::system_error #include \u003ciostream\u003e #include \u003cthread\u003e #include \u003cchrono\u003e void foo() { // simulate expensive operation std::this_thread::sleep_for(std::chrono::seconds(1)); } void bar() { // simulate expensive operation std::this_thread::sleep_for(std::chrono::seconds(1)); } int main() { std::cout \u003c\u003c \"starting first helper...\\n\"; std::thread helper1(foo); std::cout \u003c\u003c \"starting second helper...\\n\"; std::thread helper2(bar); std::cout \u003c\u003c \"waiting for helpers to finish...\" \u003c\u003c std::endl; helper1.join(); helper2.join(); std::cout \u003c\u003c \"done!\\n\"; } Output: starting first helper... starting second helper... waiting for helpers to finish... done! 2.3.2 std:ğŸ§µ:detach void detach(); ä» thread å¯¹è±¡åˆ†ç¦»æ‰§è¡Œçº¿ç¨‹ï¼Œå…è®¸æ‰§è¡Œç‹¬ç«‹åœ°æŒç»­ã€‚ä¸€æ—¦è¯¥çº¿ç¨‹é€€å‡ºï¼Œåˆ™é‡Šæ”¾ä»»ä½•åˆ†é…çš„èµ„æºã€‚è°ƒç”¨ detach å *this ä¸å†å æœ‰ä»»ä½•çº¿ç¨‹ã€‚ å¯èƒ½å¼•å‘çš„å¼‚å¸¸ä¸ºï¼šstd::system_error #include \u003ciostream\u003e #include \u003cchrono\u003e #include \u003cthread\u003e void independentThread() { std::cout \u003c\u003c \"Starting concurrent thread.\\n\"; std::this_thread::sleep_for(std::chrono::seconds(2)); std::cout \u003c\u003c \"Exiting concurrent thread.\\n\"; } void threadCaller() { std::cout \u003c\u003c \"Starting thread caller.\\n\"; std::thread t(independentThread); t.detach(); std::this_thread::sleep_for(std::chrono::seconds(1)); std::cout \u003c\u003c \"Exiting thread caller.\\n\"; } int main() { threadCaller(); std::this_thread::sleep_for(std::chrono::seconds(5)); } Possible output: Starting thread caller. Starting concurrent thread. Exiting thread caller. Exiting concurrent thread. è¿™ä¸ªç¤ºä¾‹å³è¡¨æ˜äº†ä¸»çº¿ç¨‹å°†å…ˆæ‰§è¡Œå®Œã€‚ ","date":"2022-04-07","objectID":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/:2:3","tags":["å¤šçº¿ç¨‹","C++"],"title":"C++11å¤šçº¿ç¨‹ std::threadè¯¦è§£","uri":"/posts/01.c-11%E5%A4%9A%E7%BA%BF%E7%A8%8B-stdthread%E8%AF%A6%E8%A7%A3/"},{"categories":["äº‘åŸç”Ÿ"],"content":"1 åˆè¯†Docker ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:1:0","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"1.1 Dockerå¼€æºé¡¹ç›® Dockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„äº‘å¼€æºé¡¹ç›®ï¼Œè¯ç”Ÿäº2013å¹´åˆï¼Œç”¨äºæ”¯æŒåˆ›å»ºå’Œä½¿ç”¨ Linuxå®¹å™¨ã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯â€œBuild, Ship and Run Any App, Anywhereâ€ï¼Œå³é€šè¿‡å¯¹åº”ç”¨å°è£…ï¼ˆPackagingï¼‰ã€åˆ†å‘ï¼ˆDeploymentï¼‰ã€è¿è¡Œï¼ˆRuntimeï¼‰ç­‰ç”Ÿå‘½ç®¡ç†ï¼Œè¾¾åˆ°åº”ç”¨ç»„ä»¶çº§åˆ«çš„ â€œä¸€æ¬¡å°è£…ã€åˆ°å¤„è¿è¡Œâ€ ã€‚è¿™é‡Œçš„åº”ç”¨ç»„ä»¶æ—¢å¯ä»¥æ˜¯ä¸€ä¸ªåº”ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€å¥—æ•°æ®åº“æœåŠ¡ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿæˆ–ç¼–è¯‘å™¨ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:1:1","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"1.2 Linuxå®¹å™¨æŠ€æœ¯ Dockerå¼•æ“çš„åŸºç¡€æ˜¯Linuxå®¹å™¨ï¼ˆLinux Containersï¼ŒLXCï¼‰æŠ€æœ¯ã€‚å®¹å™¨åˆ™æ˜¯æœ‰æ•ˆåœ°å°†ç”±å•ä¸ªæ“ä½œç³»ç»Ÿç®¡ç†çš„èµ„æºåˆ’åˆ†åˆ°å­¤ç«‹çš„ç»„ä¸­ï¼Œä»¥ä¾¿æ›´å¥½åœ°åœ¨å­¤ç«‹é—´å¹³è¡¡æœ‰å†²çªçš„èµ„æºä½¿ç”¨éœ€æ±‚ï¼Œè€ŒLXCé¡¹ç›®åˆ™æ˜¯å€ŸåŠ©å®¹å™¨è®¾è®¡ç†å¿µï¼Œå¹¶åŸºäºä¸€ç³»åˆ—æ–°çš„å†…æ ¸ç‰¹æ€§å®ç°äº†æ›´å…·æœ‰æ‰©å±•æ€§çš„è™šæ‹ŸåŒ–å®¹å™¨æ–¹æ¡ˆã€‚æ›´å…³é”®çš„æ˜¯ï¼ŒLXCè¢«é›†æˆåˆ°äº†ä¸»æµLinuxå†…æ ¸ä¸­ï¼Œè¿›è€Œæˆä¸ºLinuxç³»ç»Ÿè½»é‡çº§å®¹å™¨æŠ€æœ¯çš„äº‹å®æ ‡å‡†ã€‚ é‚£ä¹ˆåœ¨LXCçš„åŸºç¡€ä¸Šï¼ŒDockerè¿›ä¸€æ­¥ä¼˜åŒ–äº†å®¹å™¨çš„ä½¿ç”¨ä½“éªŒã€‚Dockeræä¾›äº†å„ç§å®¹å™¨ç®¡ç†å·¥å…·ï¼ˆå¦‚åˆ†å‘ã€ç‰ˆæœ¬ã€ç§»æ¤ç­‰ï¼‰è®©ç”¨æˆ·æ— éœ€å…³æ³¨åº•å±‚çš„æ“ä½œï¼Œå¯ä»¥ç®€å•æ˜äº†ç®¡ç†å’Œä½¿ç”¨å®¹å™¨ã€‚ç”¨æˆ·æ“ä½œDockerå®¹å™¨å°±åƒæ“ä½œä¸€ä¸ªè½»é‡çº§çš„è™šæ‹Ÿæœºé‚£æ ·ç®€å•ã€‚ æˆ‘ä»¬å¯ä»¥å°†Dockerå®¹å™¨ç†è§£ä¸ºä¸€ç§æ²™ç›’ï¼Œæ¯ä¸ªå®¹å™¨è¿è¡Œä¸€ä¸ªåº”ç”¨ï¼Œä¸åŒçš„å®¹å™¨ç›¸äº’éš”ç¦»ï¼Œå®¹å™¨ä¹‹é—´ä¹Ÿå¯ä»¥å»ºç«‹é€šä¿¡æœºåˆ¶ã€‚å®¹å™¨çš„åˆ›å»ºå’Œåœæ­¢éƒ½ååˆ†è¿…é€Ÿï¼Œå®¹å™¨è‡ªèº«å¯¹èµ„æºçš„éœ€æ±‚ä¹Ÿååˆ†æœ‰é™ï¼Œè¿œè¿œä½äºè™šæ‹Ÿæœºã€‚å¾ˆå¤šæ—¶å€™ï¼Œç”šè‡³å°†å®¹å™¨æ¯”ä½œæ˜¯åº”ç”¨æœ¬èº«ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:1:2","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"1.3 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Docker Dockerå®¹å™¨è™šæ‹ŸåŒ– ä¸¾ä¸ªç®€å•çš„åº”ç”¨åœºæ™¯çš„ä¾‹å­ï¼Œå‡è®¾ç”¨æˆ·è¯•å›¾åŸºäºæœ€å¸¸ç”¨çš„LAMPï¼ˆLinux+Apache+MySQL+PHPï¼‰ç»„åˆæ¥è¿ç»´ä¸€ä¸ªç½‘ç«™ã€‚æŒ‰ç…§æœ€ä¼ ç»Ÿçš„åšæ³•ï¼Œé¦–å…ˆéœ€è¦å®‰è£…Apacheã€Mysqlå’ŒPHPä»¥åŠå®ƒä»¬å„è‡ªè¿è¡Œæ‰€ä¾èµ–çš„ç¯å¢ƒï¼›ä¹‹ååˆ†åˆ«å¯¹å®ƒä»¬è¿›è¡Œé…ç½®ã€‚ç»è¿‡å¤§é‡æ“ä½œåï¼Œç„¶åè¿˜éœ€è¦è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ï¼Œçœ‹æ˜¯å¦å·¥ä½œæ­£å¸¸ï¼›å¦‚æœä¸æ­£å¸¸ï¼Œåˆ™æ„å‘³ç€æ›´å¤šçš„æ—¶é—´ä»£ä»·å’Œä¸å¯æ§çš„é£é™©ã€‚å¯ä»¥æƒ³è±¡ï¼Œå¦‚æœå†åŠ ä¸Šæ›´å¤šçš„åº”ç”¨ï¼Œäº‹æƒ…ä¼šå˜å¾—æ›´åŠ éš¾ä»¥å¤„ç†ã€‚æ›´ä¸ºå¯æ€•çš„æ˜¯ï¼Œå¦‚æœéœ€è¦è¿›è¡ŒæœåŠ¡å™¨è¿ç§»ï¼Œå¦‚ä»è…¾è®¯äº‘è¿ç§»åˆ°é˜¿é‡Œäº‘ï¼Œå¾€å¾€éœ€è¦é‡æ–°éƒ¨ç½²å’Œè°ƒè¯•ã€‚è€ŒDockeræä¾›äº†ä¸€ç§æ›´ä¸ºèªæ˜çš„æ–¹å¼ï¼Œé€šè¿‡å®¹å™¨æ¥æ‰“åŒ…åº”ç”¨ï¼Œæ„å‘³ç€è¿ç§»åªéœ€è¦å†æœåŠ¡å™¨ä¸Šå¯åŠ¨éœ€è¦çš„å®¹å™¨å°±å¯ä»¥äº†ï¼ŒèŠ‚çº¦å¤§é‡çš„å®è´µæ—¶é—´ï¼Œå¹¶é™ä½éƒ¨ç½²è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜çš„é£é™©ã€‚ Dockeråœ¨å¼€å‘å’Œè¿ç»´çš„ä¼˜åŠ¿ Dockerå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒã€ä»»æ„æ—¶é—´è®©åº”ç”¨æ­£å¸¸è¿è¡Œã€‚åœ¨å¼€å‘å’Œè¿ç»´ä¸­æœ‰4å¤§ä¼˜åŠ¿ï¼šæ›´å¿«é€Ÿçš„äº¤ä»˜å’Œéƒ¨ç½²ï¼›æ›´é«˜æ•ˆçš„èµ„æºåˆ©ç”¨ï¼›æ›´è½»æ¾çš„è¿ç§»å’Œæ‰©å±•ï¼›æ›´ç®€å•çš„æ›´æ–°ç®¡ç†ã€‚ Dockerä¸è™šæ‹Ÿæœºçš„æ¯”è¾ƒ ç‰¹æ€§ å®¹å™¨ è™šæ‹Ÿæœº å¯åŠ¨é€Ÿåº¦ ç§’çº§ åˆ†é’Ÿçº§ ç¡¬ç›˜ä½¿ç”¨ ä¸€èˆ¬ä¸ºMB ä¸€èˆ¬ä¸ºGB æ€§èƒ½ æ¥è¿‘åŸç”Ÿ å¼±äº ç³»ç»Ÿæ”¯æŒé‡ å•æœºæ”¯æŒä¸Šåƒä¸ªå®¹å™¨ ä¸€èˆ¬ä¸ºå‡ åä¸ª éš”ç¦»æ€§ å®‰å…¨éš”ç¦» å®Œå…¨éš”ç¦» ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:1:3","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"1.4 Dockerçš„æ ¸å¿ƒæ¦‚å¿µ Dockeræœ‰ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µï¼Œå¦‚æœæˆ‘ä»¬ç†è§£äº†è¿™ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå°±èƒ½é¡ºåˆ©ç†è§£Dockerçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚ é•œåƒï¼ˆImageï¼‰ Dockeré•œåƒï¼ˆImageï¼‰ç±»ä¼¼äºè™šæ‹Ÿæœºé•œåƒï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªé¢å‘Dockerå¼•æ“çš„åªè¯»æ¨¡æ¿ï¼ŒåŒ…å«äº†æ–‡ä»¶ç³»ç»Ÿã€‚ä¾‹å¦‚ä¸€ä¸ªé•œåƒå¯ä»¥åªåŒ…å«ä¸€ä¸ªå®Œæ•´çš„Ubuntuæ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œå¯ä»¥æŠŠå®ƒç§°ä¸ºä¸€ä¸ªUbuntué•œåƒã€‚é•œåƒä¹Ÿå¯ä»¥å®‰è£…äº†Apacheåº”ç”¨ç¨‹åºï¼Œå¯ä»¥æŠŠå®ƒç§°ä¸ºä¸€ä¸ªApacheé•œåƒã€‚ é•œåƒæ˜¯åˆ›å»ºDockerå®¹å™¨çš„åŸºç¡€ã€‚é€šè¿‡ç‰ˆæœ¬ç®¡ç†å’Œå¢é‡çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒDockeræä¾›äº†ä¸€å¥—ååˆ†ç®€å•çš„æœºåˆ¶æ¥åˆ›å»ºå’Œæ›´æ–°ç°æœ‰çš„é•œåƒï¼Œç”¨æˆ·ç”šè‡³å¯ä»¥ä»ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªå·²ç»åšå¥½çš„åº”ç”¨é•œåƒï¼Œå¹¶é€šè¿‡ç®€å•çš„å‘½ä»¤å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ å®¹å™¨ï¼ˆContainerï¼‰ Dockerå®¹å™¨ï¼ˆContainerï¼‰ç±»ä¼¼äºä¸€ä¸ªè½»é‡çº§çš„æ²™ç®±ï¼ŒDockeråˆ©ç”¨å®¹å™¨æ¥è¿è¡Œå’Œéš”ç¦»åº”ç”¨ã€‚å®¹å™¨æ˜¯ä»é•œåƒåˆ›å»ºçš„åº”ç”¨è¿è¡Œå®ä¾‹ï¼Œå¯ä»¥å°†å…¶å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ï¼Œè€Œè¿™äº›å®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»ã€äº’ä¸å¯è§çš„ã€‚æˆ‘ä»¬å®é™…æ˜¯å¯ä»¥å°†å®¹å™¨çœ‹ä½œæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„Linuxç³»ç»Ÿç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€è¿›ç¨‹ç©ºé—´ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰ï¼Œä»¥åŠè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºæ‰“åŒ…è€Œæˆçš„åº”ç”¨ç›’å­ã€‚ é•œåƒè‡ªèº«æ˜¯åªè¯»çš„ã€‚å®¹å™¨ä»é•œåƒå¯åŠ¨çš„æ—¶å€™ï¼ŒDockerä¼šåœ¨é•œåƒçš„æœ€ä¸Šå±‚åˆ›å»ºä¸€ä¸ªå¯å†™å±‚ï¼Œé•œåƒæœ¬èº«å°†ä¿æŒä¸å˜ã€‚å¦‚æœè®¤ä¸ºè™šæ‹Ÿæœºæ˜¯æ¨¡æ‹Ÿè¿è¡Œçš„ä¸€æ•´å¥—æ“ä½œç³»ç»Ÿï¼ˆæä¾›äº†è¿è¡Œæ€ç¯å¢ƒå’Œå…¶ä»–ç³»ç»Ÿç¯å¢ƒï¼‰å’Œè·‘åœ¨ä¸Šé¢çš„åº”ç”¨ï¼Œé‚£ä¹ˆDockerå®¹å™¨å°±æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ï¼Œä»¥åŠå®ƒä»¬çš„å¿…éœ€è¿è¡Œç¯å¢ƒã€‚ ä»“åº“ï¼ˆRepositoryï¼‰ Dockerä»“åº“ï¼ˆRepositoryï¼‰ç±»ä¼¼äºä»£ç ä»“åº“ï¼Œæ˜¯Dockeré›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶çš„åœºæ‰€ã€‚è€Œæ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰æ˜¯å­˜æ”¾ä»“åº“çš„åœ°æ–¹ï¼Œå…¶ä¸Šå¾€å¾€å­˜æ”¾ç€å¤šä¸ªä»“åº“ã€‚æ¯ä¸ªä»“åº“é›†ä¸­å­˜æ”¾æŸä¸€ç±»é•œåƒï¼Œå¾€å¾€åŒ…æ‹¬å¤šä¸ªé•œåƒæ–‡ä»¶ï¼Œé€šè¿‡ä¸åŒçš„æ ‡ç­¾ï¼ˆtagï¼‰æ¥è¿›è¡ŒåŒºåˆ†ã€‚ä¾‹å¦‚å­˜æ”¾Ubuntuæ“ä½œç³»ç»Ÿé•œåƒçš„ä»“åº“ï¼Œç§°ä¸ºUbuntuä»“åº“ï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬20.04ç­‰ä¸åŒç‰ˆæœ¬çš„é•œåƒã€‚æ ¹æ®æ‰€å­˜å‚¨çš„é•œåƒå…¬å¼€åˆ†äº«ä¸å¦ï¼ŒDockerä»“åº“å¯ä»¥åˆ†ä¸ºå…¬å¼€ä»“åº“ï¼ˆPublicï¼‰å’Œç§æœ‰ä»“åº“ï¼ˆPrivateï¼‰ä¸¤ç§å½¢å¼ã€‚ç›®å‰ï¼Œæœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯Docker Hubï¼Œå­˜æ”¾ç€æ•°é‡åºå¤§çš„é•œåƒä¾›ç”¨æˆ·ä¸‹è½½ï¼Œå›½å†…çš„å…¬å¼€ä»“åº“åŒ…æ‹¬Docker Poolç­‰ï¼Œå¯æä¾›ç¨³å®šçš„å›½å†…è®¿é—®ã€‚ å½“ç„¶ï¼Œç”¨æˆ·å¦‚æœä¸å¸Œæœ›å…¬å¼€åˆ†äº«è‡ªå·±çš„é•œåƒæ–‡ä»¶ï¼ŒDockerä¹Ÿæ”¯æŒç”¨æˆ·åœ¨æœ¬åœ°ç½‘ç»œå†…åˆ›å»ºä¸€ä¸ªåªèƒ½è‡ªå·±è®¿é—®çš„ç§æœ‰ä»“åº“ã€‚å½“ç”¨æˆ·åˆ›å»ºäº†è‡ªå·±çš„é•œåƒä¹‹åå°±å¯ä»¥ä½¿ç”¨pushå‘½ä»¤å°†å®ƒä¸Šä¼ åˆ°æŒ‡å®šçš„å…¬æœ‰æˆ–è€…ç§æœ‰ä»“åº“ã€‚è¿™æ ·ç”¨æˆ·ä¸‹æ¬¡åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šä½¿ç”¨è¯¥é•œåƒæ—¶ï¼Œåªéœ€å°†å…¶ä»ä»“åº“ä¸Špullä¸‹æ¥å°±å¯ä»¥äº†ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:1:4","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"1.5 Dockerå®‰è£…ï¼ˆLinuxï¼‰ å®‰è£…æ•™ç¨‹ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:1:5","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2 é•œåƒå…·ä½“æ“ä½œ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:0","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.1 è·å–é•œåƒ é•œåƒæ˜¯Dockerè¿è¡Œå®¹å™¨çš„å‰æã€‚ä½¿ç”¨docker pullå‘½ä»¤å³å¯ä»é•œåƒä»“åº“ä¸Šä¸‹è½½æŒ‡å®šé•œåƒåˆ°æœ¬åœ°ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker pull [options] NAME[:TAG] optionså‚æ•°è¯´æ˜ï¼š -aï¼šæ‹‰å–æ‰€æœ‰taggedé•œåƒ ä¾‹å¦‚ä»Docker Hubçš„Ubuntuä»“åº“ä¸‹è½½ä¸€ä¸ªæœ€æ–°ç‰ˆçš„Ubuntuæ“ä½œç³»ç»Ÿçš„é•œåƒ docker pull ubuntu:20.04 # æŒ‡å®šç‰ˆæœ¬å·ï¼Œç›®å‰æœ€æ–°ä¸º20.04 docker pull ubuntu #è¯¥å‘½ä»¤å®é™…ä¸Šä¸‹è½½çš„å°±æ˜¯ubuntu:latesté•œåƒã€‚ ä¸Šé¢è¿™ä¸¤æ¡å‘½ä»¤å®é™…ä¸Šç›¸å½“äºdocker pull registry.hub.docker.com/ubuntu:latestå‘½ä»¤ï¼Œå³ä»é»˜è®¤çš„æ³¨å†ŒæœåŠ¡å™¨registry.hub.docker.comä¸­çš„ubuntuä»“åº“æ¥ä¸‹è½½æ ‡è®°ä¸ºlatestçš„é•œåƒã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–æ³¨å†ŒæœåŠ¡å™¨çš„ä»“åº“ä¸‹è½½ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ä»“åº“å‰æŒ‡å®šå®Œæ•´çš„ä»“åº“æ³¨å†ŒæœåŠ¡å™¨åœ°å€ã€‚ä¾‹å¦‚ä»Docker Poolç¤¾åŒºçš„é•œåƒæºd1.dockerpool.comä¸‹è½½æœ€æ–°çš„ubuntué•œåƒã€‚ docker pull d1.dockerpool.com:5000/ubuntu ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:1","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.2 æŸ¥çœ‹é•œåƒä¿¡æ¯ ä½¿ç”¨docker imageså‘½ä»¤å¯ä»¥åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„æ‰€æœ‰é•œåƒã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker images [options] [repository:[tag]] optionså‚æ•°è¯´æ˜ï¼š -a :åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿‡æ»¤æ‰ä¸­é—´æ˜ åƒå±‚ï¼‰ï¼› -f :æ˜¾ç¤ºæ»¡è¶³æ¡ä»¶çš„é•œåƒï¼› -q :åªæ˜¾ç¤ºé•œåƒIDã€‚ å¦‚æœæ²¡æœ‰ç»™å‡ºä»“åº“åï¼Œé‚£ä¹ˆé»˜è®¤åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šå·²æœ‰çš„é•œåƒã€‚æˆ‘ä»¬ä½¿ç”¨docker imageså¯ä»¥æŸ¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š å¯ä»¥çœ‹åˆ°å‡ ä¸ªå­—æ®µä¿¡æ¯ï¼š repositoryï¼šæ¥è‡ªäºå“ªä¸ªä»“åº“ï¼Œæ¯”å¦‚ubuntuä»“åº“ã€‚ tagï¼šé•œåƒçš„æ ‡ç­¾ä¿¡æ¯ï¼Œæ¯”å¦‚20.04æˆ–latestã€‚ç”¨äºæ ‡è®°æ¥è‡ªåŒä¸€ä¸ªä»“åº“çš„ä¸åŒé•œåƒã€‚ image idï¼šé•œåƒçš„IDå·ï¼Œè¿™ä¸ªç‰¹åˆ«é‡è¦ï¼Œå”¯ä¸€æ ‡è¯†é•œåƒã€‚ createdï¼šé•œåƒåˆ›å»ºæ—¶é—´ã€‚ sizeï¼šé•œåƒå¤§å°ã€‚ æˆ‘ä»¬ä»å›¾ä¸­å¯ä»¥å‘ç°ï¼Œ20.04å’Œlatestæ ‡ç­¾çš„é•œåƒIDæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œè¯´æ˜å®ƒä»¬å®é™…ä¸ŠæŒ‡å‘äº†åŒä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œåªæ˜¯åˆ«åä¸åŒè€Œå·²ã€‚æ ‡ç­¾åœ¨è¿™é‡Œèµ·åˆ°äº†å¼•ç”¨æˆ–è€…å¿«æ·æ–¹å¼çš„ä½œç”¨ã€‚ æˆ‘ä»¬ä½¿ç”¨docker inpsect NAME|IDå³å¯æŸ¥çœ‹è¯¥é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œä¸ºjsonæ ¼å¼ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨docker historyå‘½ä»¤æŸ¥çœ‹æŒ‡å®šé•œåƒçš„åˆ›å»ºå†å²ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker history [options] IMAGE optionsè¯´æ˜ï¼š -q :ä»…åˆ—å‡ºæäº¤è®°å½•IDã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:2","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.3 æœå¯»é•œåƒ ä½¿ç”¨docker searchå‘½ä»¤å¯ä»¥æœç´¢äº‘ç«¯ä»“åº“ä¸­å…±äº«çš„é•œåƒï¼Œé»˜è®¤æœå¯»Docker Hubå®˜æ–¹ä»“åº“çš„é•œåƒã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker search [options] TERM optionsè¯´æ˜ï¼š â€“automated :åªåˆ—å‡º automated buildç±»å‹çš„é•œåƒï¼› â€“no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒæè¿°ï¼› -f \u003cè¿‡æ»¤æ¡ä»¶\u003e:ä¾‹å¦‚åˆ—å‡ºæ”¶è—æ•°ä¸å°äºæŒ‡å®šå€¼çš„é•œåƒã€‚ ä¾‹å¦‚æœå¯»å¸¦mysqlå…³é”®å­—çš„é•œåƒå¦‚ä¸‹ï¼š ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:3","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.4 åˆ é™¤é•œåƒ ä½¿ç”¨docker rmiå‘½ä»¤å¯ä»¥åˆ é™¤é•œåƒï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker rmi IMAGE [IMAGE...] å…¶ä¸­IMAGEå¯ä»¥ä¸ºé•œåƒæ ‡ç­¾æˆ–è€…é•œåƒIDï¼Œè¿™IDå¯ä»¥ä¸ºèƒ½è¿›è¡ŒåŒºåˆ†çš„éƒ¨åˆ†å‰ç¼€ä¸²ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æœ‰è¯¥é•œåƒåˆ›å»ºçš„å®¹å™¨å­˜åœ¨æ—¶ï¼Œé•œåƒæ–‡ä»¶æ—¶é»˜è®¤æ— æ³•åˆ é™¤çš„ï¼Œè‹¥æƒ³è¦å¼ºè¡Œåˆ é™¤æ–‡ä»¶åˆ™éœ€è¦åŠ å…¥-få‚æ•°æ¥å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªå­˜åœ¨å®¹å™¨ä¾èµ–çš„é•œåƒï¼Œä½†è¿™æ ·å¾€å¾€ä¼šé€ æˆä¸€äº›é—ç•™é—®é¢˜ã€‚æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯å…ˆåˆ é™¤ä¾èµ–è¯¥é•œåƒçš„æ‰€æœ‰å®¹å™¨ï¼Œå†æ¥åˆ é™¤é•œåƒã€‚ è‹¥è¦åˆ é™¤æ‰€æœ‰é•œåƒï¼Œå¯ç”¨docker images -qåˆ—å‡ºæ‰€æœ‰çš„IDï¼Œæ­£ç¡®å‘½ä»¤ä¸ºï¼šdocker rmi $(docker images -q)ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:4","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.5 åˆ›å»ºé•œåƒ åˆ›å»ºé•œåƒçš„æ–¹æ³•æœ‰ä¸‰ç§ï¼šåŸºäºå·²æœ‰é•œåƒçš„å®¹å™¨åˆ›å»ºã€åŸºäºæœ¬åœ°æ¨¡æ¿å¯¼å…¥ã€åŸºäºDockerfileåˆ›å»ºã€‚ 2.5.1 åŸºäºå·²æœ‰é•œåƒçš„å®¹å™¨åˆ›å»º ä½¿ç”¨docker commitå‘½ä»¤å³å¯ä»å®¹å™¨åˆ›å»ºä¸€ä¸ªé•œåƒï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker commit [options] CONTAINER [REPOSITORY[:TAG]] optionsè¯´æ˜ï¼š -a :æäº¤çš„é•œåƒä½œè€…ï¼› -c :ä½¿ç”¨DockerfileæŒ‡ä»¤æ¥åˆ›å»ºé•œåƒï¼› -m :æäº¤æ—¶çš„è¯´æ˜æ–‡å­—ï¼› -p :åœ¨commitæ—¶ï¼Œå°†å®¹å™¨æš‚åœã€‚ CONTAINERä¸ºå®¹å™¨IDã€‚ é¡ºåˆ©çš„è¯ï¼Œå‘½ä»¤ä¼šè¿”å›æ–°åˆ›å»ºçš„é•œåƒçš„IDä¿¡æ¯ã€‚ å®ä¾‹å¦‚ä¸‹ï¼š docker commit -a \"pursuit\" -m \"my ubuntu\" 3c61e963210c myubuntu:v1 2.5.2 åŸºäºæœ¬åœ°æ¨¡æ¿å¯¼å…¥ å¯ä»¥ä»ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ¨¡æ¿æ–‡ä»¶å¯¼å…¥ä¸€ä¸ªé•œåƒï¼Œä¹Ÿå¯ä»¥ä»ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªæ¨¡æ¿ã€‚ä¸€èˆ¬ä½¿ç”¨OpenVZæä¾›çš„æ¨¡æ¿æ¥åˆ›å»ºã€‚OpenVZä¸‹è½½åœ°å€ã€‚ é¦–å…ˆä¸‹è½½ä¸€ä¸ªï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š wget https://download.openvz.org/template/precreated/contrib/arch-20161108-x86_64.tar.gz ç„¶åå°†å¯¼å…¥è¯¥é•œåƒï¼š cat arch-20161108-x86_64.tar.gz | docker import - arch:x86_64 æŸ¥çœ‹æ–°å¯¼å…¥çš„é•œåƒï¼Œå·²ç»æœ¬åœ°å­˜åœ¨äº†ï¼š 2.5.3 åŸºäºDockerfileåˆ›å»º å…¶ä¸­Dockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ Dockerfile å¿«é€Ÿåˆ›å»ºè‡ªå®šä¹‰çš„é•œåƒã€‚ Dockerfileç”±ä¸€è¡Œè¡Œå‘½ä»¤è¯­å¥ç»„æˆï¼Œå¹¶ä¸”æ”¯æŒä»¥#å¼€å¤´çš„æ³¨é‡Šã€‚Dockerfileåˆ†ä¸ºå››éƒ¨åˆ†ï¼šåŸºç¡€é•œåƒä¿¡æ¯ã€ç»´æŠ¤è€…ä¿¡æ¯ã€é•œåƒæ“ä½œæŒ‡ä»¤å’Œå®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤ã€‚ä¾‹å¦‚ä¸‹é¢çš„æ–‡ä»¶æ¨¡æ¿ï¼š # This dockerfile user the ubuntu image # VERSION 2 - EDITON 1 # Author: docker_user # Command format: Instruction [arguments / command] .. # ç¬¬ä¸€è¡Œå¿…é¡»æŒ‡å®šåŸºäºçš„åŸºç¡€é•œåƒ FROM ubuntu # ç»´æŠ¤è€…ä¿¡æ¯ # ä¾‹å¦‚MAINTAINER docker_user docker_user@email.com MAINTAINER pursuit unique.hzf@gmail.com # é•œåƒçš„æ“ä½œæŒ‡ä»¤ # RUN \u003ccommand\u003eï¼Œå½“å‘½ä»¤è¾ƒé•¿ï¼Œå¯ä»¥ç”¨\\æ¥æ¢è¡Œã€‚ RUN echo \"Hello, World!\" # å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤ CMD /bin/bash åˆ›å»ºå¥½Dockerfileåï¼Œæˆ‘ä»¬åˆ©ç”¨docker buildå‘½ä»¤ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker build -t PATH|URL repository:tag å¦‚ï¼Œæˆ‘ä»¬åˆ©ç”¨Dockerfileç”Ÿæˆé•œåƒ sudo docker build . -t arch:x86_64_01 æŸ¥çœ‹æœ¬åœ°é•œåƒå¦‚ä¸‹ï¼š ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:5","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.6 å­˜å‡ºå’Œè½½å…¥é•œåƒ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨docker saveå’Œdocker loadå‘½ä»¤æ¥å­˜å‡ºå’Œè½½å…¥é•œåƒã€‚ å­˜å‡ºå³å°†é•œåƒä¿å­˜æˆtarå½’æ¡£æ–‡ä»¶ï¼Œè½½å…¥å³å°†ä½¿ç”¨docker saveå‘½ä»¤å¯¼å‡ºçš„tarå½’æ¡£æ–‡ä»¶è½½å…¥ç§°ä¸ºé•œåƒæ–‡ä»¶ã€‚ å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker save -o filename IMAGE æˆ–è€… docker save IMAGE\u003efilename docker load --input filename æˆ–è€… docker load \u003cfilename å®ä¾‹ï¼š docker save -o files/ubuntu_20_04.tar ubuntu:20.04 ç„¶åæˆ‘ä»¬éœ€è¦åˆ é™¤ubuntu:20.04é•œåƒï¼Œå†å¯¼å…¥ã€‚ docker rmi ubuntu:20.04 docker load \u003cubuntu_20_04.tar ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:6","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.7 ä¿®æ”¹é•œåƒ ä½¿ç”¨docker tagå‘½ä»¤å¯ä»¥æ ‡è®°æœ¬åœ°é•œåƒï¼Œå°†å…¶å½’å…¥æŸä¸€ä»“åº“ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG] å®ä¾‹ï¼š docker tag ubuntu:20.04 myubuntu/ubuntu:20.04 ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:7","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"2.8 ä¸Šä¼ é•œåƒ ä½¿ç”¨docker pushå‘½ä»¤å°†æœ¬åœ°çš„é•œåƒä¸Šä¼ åˆ°é•œåƒä»“åº“ï¼Œé»˜è®¤ä¸Šä¼ åˆ°DockerHubå®˜æ–¹ä»“åº“ã€‚è¦å…ˆç™»é™†åˆ°é•œåƒä»“åº“ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker push NAME[:TAG] ä¾‹å¦‚ç”¨æˆ·userä¸Šä¼ è‡ªå·±çš„æœ¬åœ°é•œåƒubuntu:20.04ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦æ·»åŠ æ–°çš„æ ‡ç­¾user/ubuntu:20.04ï¼ˆå…¶ä¸­userä¸€å®šè¦å’Œæˆ‘ä»¬çš„dockerhubä¸­ç”¨æˆ·ååŒåï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼‰ç„¶åå†ä¸Šä¼ ã€‚ ä¹‹åï¼Œæˆ‘ä»¬å³å¯åœ¨DockerHubå®˜ç½‘çœ‹åˆ°è‡ªå·±çš„ä»“åº“å’Œä¸Šä¼ çš„é•œåƒäº†ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:2:8","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3 å®¹å™¨å…·ä½“æ“ä½œ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:0","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.1 æŸ¥çœ‹å®¹å™¨ ä½¿ç”¨docker pså‘½ä»¤å³å¯åˆ—å‡ºå®¹å™¨ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker ps [OPTIONS] å…¶ä¸­optionsè¯´æ˜ï¼š -a :æ˜¾ç¤ºæ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æœªè¿è¡Œçš„ã€‚ -f :æ ¹æ®æ¡ä»¶è¿‡æ»¤æ˜¾ç¤ºçš„å†…å®¹ã€‚ -q :é™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚ æˆ‘ä»¬è¿è¡Œdocker ps -aå¯ä»¥å¾—åˆ°å¦‚å›¾ï¼š å…¶ä¸­è¾“å‡ºå­—æ®µè¯´æ˜å¦‚ä¸‹ï¼š CONTAINER ID: å®¹å™¨ IDã€‚ IMAGE: ä½¿ç”¨çš„é•œåƒã€‚ COMMAND: å¯åŠ¨å®¹å™¨æ—¶è¿è¡Œçš„å‘½ä»¤ã€‚ CREATED: å®¹å™¨çš„åˆ›å»ºæ—¶é—´ã€‚ STATUS: å®¹å™¨çŠ¶æ€ã€‚ PORTS: å®¹å™¨çš„ç«¯å£ä¿¡æ¯å’Œä½¿ç”¨çš„è¿æ¥ç±»å‹ï¼ˆtcp\\udpï¼‰ã€‚ NAMES: è‡ªåŠ¨åˆ†é…çš„å®¹å™¨åç§°ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨docker inspectå‘½ä»¤åˆ—å‡ºå®¹å™¨çš„å…ƒä¿¡æ¯ï¼Œè¾“å‡ºæ ¼å¼ä¸ºjsonæ ¼å¼ï¼Œè¿™ä¸ªå‘½ä»¤åœ¨æŸ¥çœ‹é•œåƒç« èŠ‚å·²ç»è¯´æ˜äº†ï¼Œç”¨æ³•ç›¸åŒï¼Œè¿™é‡Œä¸å†å™è¿°ã€‚ ä½¿ç”¨docker statså¯ä»¥æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬CPUã€å†…å­˜ã€å­˜å‚¨ã€ç½‘ç»œç­‰ä¿¡æ¯ã€‚ ä½¿ç”¨docker top CONTAINERå¯æŸ¥çœ‹æŸä¸ªå®¹å™¨å†…çš„æ‰€æœ‰è¿›ç¨‹ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:1","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.2 åˆ›å»ºå®¹å™¨ Dockerçš„å®¹å™¨ååˆ†è½»é‡çº§ï¼Œç”¨æˆ·å¯ä»¥éšæ—¶åˆ›å»ºæˆ–åˆ é™¤å®¹å™¨ã€‚ æ–°å»ºå®¹å™¨ å¯ä»¥ä½¿ç”¨docker createå‘½ä»¤æ–°å»ºä¸€ä¸ªå®¹å™¨ï¼Œä¾‹å¦‚ï¼š docker create -it ubuntu:20.04 å³åˆ©ç”¨é•œåƒubuntu:20.04åˆ›å»ºå®¹å™¨ã€‚ æ–°å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨ ä½¿ç”¨docker runå‘½ä»¤åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ã€‚å…¶å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker run [OPTIONS] IMAGE [COMMAND] [ARG...] å…¶ä¸­optionsè¯´æ˜ï¼š 1.--nameï¼šä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼› 2.-t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼› 3.-d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDã€‚ 4.-i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ã€‚ å½“ä½¿ç”¨dockeråˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨æ—¶ï¼ŒDockeråœ¨åå°è¿è¡Œçš„æ ‡å‡†æ“ä½œå¦‚ä¸‹ï¼š 1.æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰æŒ‡å®šçš„é•œåƒï¼Œä¸å­˜åœ¨å°±ä»å…¬æœ‰ä»“åº“ä¸‹è½½; 2.åˆ©ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼› 3.åˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å†™å±‚ï¼› 4.ä»å®¿ä¸»ä¸»æœºé…ç½®çš„ç½‘æ¡¥æ¥å£ä¸­æ¡¥æ¥ä¸€ä¸ªè™šæ‹Ÿæ¥å£åˆ°å®¹å™¨ä¸­å»ï¼› 5.ä»åœ°å€æ± é…ç½®ä¸€ä¸ªIPåœ°å€ç»™å®¹å™¨ï¼› 6.æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åºï¼› 7.æ‰§è¡Œå®Œæ¯•åå®¹å™¨è¢«ç»ˆæ­¢ã€‚ ä¸‹é¢è¿™ä¸ªå®ä¾‹å°†å¯åŠ¨ä¸€ä¸ªbashç»ˆç«¯ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œå¯ä»¥ä½¿ç”¨Linuxå‘½ä»¤ã€‚ docker run -it ubuntu:20.04 /bin/bash å…¶ä¸­rootä¸ºç”¨æˆ·åï¼Œ@åé¢çš„ä¸ºå®¹å™¨IDã€‚æˆ‘ä»¬ç”¨pså‘½ä»¤æŸ¥çœ‹è¿›ç¨‹å‘ç°åªè¿è¡Œäº†bashåº”ç”¨ï¼Œå¹¶æ²¡æœ‰è¿è¡Œå…¶ä»–ä¸éœ€è¦çš„è¿›ç¨‹ã€‚å¯ä»¥ä½¿ç”¨Ctrl+dæˆ–è¾“å…¥exitå‘½ä»¤æ¥é€€å‡ºå®¹å™¨ã€‚å½“é€€å‡ºå®¹å™¨ä¹‹åï¼Œè¯¥å®¹å™¨å°±è‡ªåŠ¨å¤„äºç»ˆæ­¢çŠ¶æ€äº†ã€‚ è¿™æ˜¯å› ä¸ºå¯¹äºDockerå®¹å™¨æ¥è¯´ï¼Œå½“è¿è¡Œçš„åº”ç”¨ï¼ˆæ­¤ä¾‹å­ä¸­ä¸ºbashï¼‰é€€å‡ºåï¼Œå®¹å™¨ä¹Ÿå°±æ²¡æœ‰å†è¿è¡Œçš„å¿…è¦äº†ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:2","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.3 å¯åŠ¨ç»ˆæ­¢å®¹å™¨ å¯åŠ¨å®¹å™¨ ä½¿ç”¨docker startå¯ä»¥å¯åŠ¨ä¸€ä¸ªå·²å­˜åœ¨çš„å®¹å™¨ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker start CONTAINER ç»ˆæ­¢å®¹å™¨ ä½¿ç”¨docker stopå¯ä»¥å¯åŠ¨ä¸€ä¸ªå·²å­˜åœ¨çš„å®¹å™¨ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker stop CONTAINER é‡å¯å®¹å™¨ ä½¿ç”¨docker restartå¯ä»¥å¯åŠ¨ä¸€ä¸ªå·²å­˜åœ¨çš„å®¹å™¨ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker restart CONTAINER ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:3","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.4 è·å–å®¹å™¨çš„æ—¥å¿— ä½¿ç”¨docker logså³å¯è·å–å®¹å™¨çš„æ—¥å¿—ã€‚å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker logs [OPTIONS] CONTAINER å…¶ä¸­OPTIONSè¯´æ˜ï¼š -f : è·Ÿè¸ªæ—¥å¿—è¾“å‡º â€“since :æ˜¾ç¤ºæŸä¸ªå¼€å§‹æ—¶é—´çš„æ‰€æœ‰æ—¥å¿— -t : æ˜¾ç¤ºæ—¶é—´æˆ³ â€“tail :ä»…åˆ—å‡ºæœ€æ–°Næ¡å®¹å™¨æ—¥å¿— å®ä¾‹ï¼š ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:4","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.5 è¿›å…¥å®¹å™¨ åœ¨ä½¿ç”¨-då‚æ•°åï¼Œå®¹å™¨å¯åŠ¨åä¼šè‡ªåŠ¨è¿›å…¥åå°ï¼Œç”¨æˆ·æ— æ³•çœ‹åˆ°å®¹å™¨ä¸­çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å¦‚æœéœ€è¦è¿›å…¥å®¹å™¨è¿›è¡Œæ“ä½œï¼Œæœ‰å¤šç§æ–¹æ³•ï¼Œè¿™é‡Œä»‹ç»ä¸¤ç§ã€‚ ä½¿ç”¨docker attach å‘½ä»¤æ ¼å¼ä¸ºï¼šdocker attach CONTAINER åœ¨å®¹å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŒ‰Ctrl-pï¼Œå†æŒ‰Ctrl-qå¯ä»¥æŒ‚èµ·å®¹å™¨ã€‚ ä½†æ˜¯ä½¿ç”¨attachå‘½ä»¤æœ‰æ—¶å€™å¹¶ä¸æ–¹ä¾¿ã€‚å½“å¤šä¸ªçª—å£åŒæ—¶attachåˆ°åŒä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œæ‰€æœ‰çª—å£éƒ½ä¼šåŒæ­¥æ˜¾ç¤ºã€‚å½“æŸä¸ªçª—å£å› å‘½ä»¤é˜»å¡åï¼Œå…¶ä»–çª—å£ä¹Ÿæ— æ³•æ‰§è¡Œæ“ä½œäº†ã€‚ ä½¿ç”¨docker execå‘½ä»¤ Dockerè‡ª1.3ç‰ˆæœ¬èµ·ï¼Œæä¾›äº†ä¸€ä¸ªæ›´æ–¹ä¾¿çš„å·¥å…·execï¼Œè¯¥å‘½ä»¤å¯ä»¥åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker exec [OPTIONS] CONTAINER COMMAND [ARG...] å…¶ä¸­OPTIONSè¯´æ˜ï¼š 1.-d :åˆ†ç¦»æ¨¡å¼: åœ¨åå°è¿è¡Œ 2.-i :å³ä½¿æ²¡æœ‰é™„åŠ ä¹Ÿä¿æŒSTDIN æ‰“å¼€ 3.-t :åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:5","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.6 åˆ é™¤å®¹å™¨ å¯ä»¥ä½¿ç”¨docker rmå‘½ä»¤æ¥åˆ é™¤å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker rm [OPTIONS] CONTAINER [CONTAINER...] å…¶ä¸­OPTIONSè¯´æ˜ï¼š -f :é€šè¿‡ SIGKILL ä¿¡å·å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ã€‚ -l:ç§»é™¤å®¹å™¨é—´çš„ç½‘ç»œè¿æ¥ï¼Œè€Œéå®¹å™¨æœ¬èº«ã€‚å³åˆ é™¤å®¹å™¨çš„è¿æ¥ï¼Œä½†ä¿ç•™å®¹å™¨ã€‚ -v :åˆ é™¤ä¸å®¹å™¨å…³è”çš„å·ã€‚ å¦‚æœéœ€è¦åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼Œå¯ä½¿ç”¨docker rm $(docker ps -aq)ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:6","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.7 åœ¨æœ¬åœ°å’Œå®¹å™¨ä¹‹é—´å¤åˆ¶æ–‡ä»¶ ä½¿ç”¨docker cpå‘½ä»¤ç”¨äºä¸»æœºå’Œå®¹å™¨ä¹‹é—´çš„æ•°æ®æ‹·è´ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker cp xxx CONTAINER:xxx docker cp CONTAINER:xxx xxx å®ä¾‹ï¼š docker cp data.txt 3c61e963210c:data.txt ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:7","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.8 ä¿®æ”¹å®¹å™¨ ä½¿ç”¨docker renameå¯ä»¥é‡å‘½åå®¹å™¨ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker rename CONTAINER1 CONTAINER2 ä½¿ç”¨docker updateå¯ä»¥ä¿®æ”¹å®¹å™¨é…ç½®ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker update CONTAINER [options] å…¶ä¸­OPTIONSå‚æ•°è¿‡å¤šï¼Œä½¿ç”¨çš„æ—¶å€™å¯ä»¥è‡ªè¡Œç™¾åº¦ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¿®æ”¹å®¹å™¨çš„å†…å­˜é™åˆ¶ï¼š docker update 3c61e963210 --memory 500MB ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:8","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"3.9 å¯¼å…¥å’Œå¯¼å‡ºå®¹å™¨ 3.9.1 å¯¼å‡ºå®¹å™¨ å¯¼å‡ºå®¹å™¨æ˜¯æŒ‡å¯¼å‡ºä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®¹å™¨åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸ç®¡æ­¤æ—¶è¿™ä¸ªå®¹å™¨æ˜¯å¦å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨docker exportå‘½ä»¤å¯¼å‡ºå®¹å™¨ã€‚è¯¥å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker export [options] xxx.tar CONTAINER æˆ–è€… docker export [options] CONTAINER\u003exxx.tar å…¶ä¸­optionsè¯´æ˜ï¼š -o :å°†è¾“å…¥å†…å®¹å†™åˆ°æ–‡ä»¶ã€‚ ä¾‹å¦‚å°†idä¸º3c61e963210çš„å®¹å™¨æŒ‰æ—¥æœŸä¿å­˜ä¸ºtaræ–‡ä»¶ï¼š å¯ä»¥å°†è¿™äº›æ–‡ä»¶ä¼ è¾“åˆ°å…¶ä»–çš„æœºå™¨ä¸Šï¼Œåœ¨å…¶ä»–æœºå™¨ä¸Šé€šè¿‡å¯¼å…¥å‘½ä»¤å®ç°å®¹å™¨çš„è¿ç§»ã€‚ 3.9.2 å¯¼å…¥å®¹å™¨ å¯¼å‡ºçš„æ–‡ä»¶åˆå¯ä»¥ä½¿ç”¨docker importå‘½ä»¤å¯¼å…¥ï¼Œæˆä¸ºé•œåƒï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š docker import [OPTIONS] xxx.tar image_name:tag å…¶ä¸­OPTIONSè¯´æ˜ï¼š -c :åº”ç”¨docker æŒ‡ä»¤åˆ›å»ºé•œåƒï¼› -m :æäº¤æ—¶çš„è¯´æ˜æ–‡å­—ã€‚ å®ä¾‹ï¼š docker import ubuntu-20220212.tar myubunt:latest æˆ‘ä»¬çŸ¥é“ï¼Œå‰é¢æˆ‘ä»¬å­¦ä¹ è¿‡docker loadå‘½ä»¤æ¥å¯¼å…¥ä¸€ä¸ªé•œåƒæ–‡ä»¶ã€‚å®é™…ä¸Šï¼Œæ—¢å¯ä»¥ä½¿ç”¨docker loadå‘½ä»¤æ¥å¯¼å…¥é•œåƒå­˜å‚¨æ–‡ä»¶åˆ°æœ¬åœ°çš„é•œåƒåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨docker importå‘½ä»¤æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ã€‚ è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºå®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰çš„å†å²è®°å½•å’Œå…ƒä¿¡æ¯ï¼ˆä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€)ï¼Œï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯ä¹Ÿè¦å¤§ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:3:9","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"4 ä»“åº“ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:4:0","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"4.1 Docker Hub 4.1.1 Linuxç™»å½•ç™»å‡ºDockerHub é¦–å…ˆåœ¨dockerhubå®˜ç½‘æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åä½¿ç”¨docker loginå³å¯ç™»å½•ã€‚ç™»å‡ºåˆ™ç›´æ¥è¾“å…¥docker logoutå³å¯ã€‚ å®ä¾‹ï¼š 4.1.2 åŸºæœ¬æ“ä½œ ç”¨æˆ·æ— éœ€ç™»å½•å³å¯é€šè¿‡docker searchå‘½ä»¤æ¥æŸ¥æ‰¾å®˜ç½‘ä»“åº“çš„é•œåƒï¼Œå¹¶åˆ©ç”¨docker pullå‘½ä»¤æ¥å°†å®ƒä¸‹è½½åˆ°æœ¬åœ°ã€‚ æ ¹æ®æ˜¯å¦ä¸ºå®˜æ–¹æä¾›ï¼Œ å¯å°†è¿™äº›é•œåƒèµ„æºåˆ†ä¸ºä¸¤ç±»ã€‚ä¸€ç§ç±»ä¼¼ubuntuè¿™æ ·çš„åŸºç¡€é•œåƒï¼Œç§°ä¸ºåŸºç¡€æˆ–æ ¹é•œåƒã€‚è¿™äº›é•œåƒæ˜¯ç”±Dockerå…¬å¸åˆ›å»ºã€éªŒè¯ã€æ”¯æŒã€æä¾›çš„ã€‚è¿™æ ·çš„é•œåƒå¾€å¾€ä½¿ç”¨å•ä¸ªå•è¯ä½œä¸ºåå­—ã€‚è¿˜æœ‰ä¸€ç§ç±»å‹ï¼Œæ¯”å¦‚pursuit/ubuntué•œåƒï¼Œå®ƒæ˜¯ç”±DockerHubç”¨æˆ·pursuitåˆ›å»ºå¹¶ç»´æŠ¤çš„ï¼Œå¸¦æœ‰ç”¨æˆ·åç§°ä¸ºå‰ç¼€ï¼Œè¡¨æ˜æ˜¯æŸç”¨æˆ·çš„æŸä»“åº“ã€‚å¯é€šè¿‡ç”¨æˆ·åç§°å‰ç¼€user_name/ æ¥æŒ‡å®šä½¿ç”¨æŸä¸ªç”¨æˆ·æä¾›çš„é•œåƒï¼Œæ¯”å¦‚pursuitç”¨æˆ·çš„é•œåƒå‰ç¼€ä¸ºpursuit/ã€‚ 4.1.3 è‡ªåŠ¨åˆ›å»º è‡ªåŠ¨åˆ›å»ºï¼ˆAutomated Buildsï¼‰åŠŸèƒ½å¯¹äºéœ€è¦ç»å¸¸å‡çº§é•œåƒå†…ç¨‹åºæ¥è¯´ååˆ†æ–¹ä¾¿ã€‚æœ‰æ—¶å€™ï¼Œç”¨æˆ·åˆ›å»ºäº†é•œåƒï¼Œå®‰è£…äº†æŸä¸ªè½¯ä»¶ï¼Œå¦‚æœè½¯ä»¶å‘å¸ƒæ–°ç‰ˆæœ¬åˆ™éœ€è¦æ‰‹åŠ¨æ›´æ–°é•œåƒã€‚ è€Œè‡ªåŠ¨åˆ›å»ºåŠŸèƒ½ä½¿å¾—ç”¨æˆ·é€šè¿‡DockerHubæŒ‡å®šè¿½è¸ªä¸€ä¸ªç›®æ ‡ç½‘ç«™ï¼ˆç›®å‰æ”¯æŒGithubæˆ–BitBucketï¼‰ä¸Šçš„é¡¹ç›®ï¼Œä¸€ä½†å‘ç°é¡¹ç›®æ–°çš„æäº¤ï¼Œåˆ™è‡ªåŠ¨æ‰§è¡Œåˆ›å»ºã€‚ è¦é…ç½®è‡ªåŠ¨åˆ›å»ºï¼Œæœ‰å¦‚ä¸‹æ­¥éª¤ï¼š 1ï¼‰åˆ›å»ºå¹¶ç™»å½•Docker Hubï¼Œä»¥åŠç›®æ ‡ç½‘ç«™ï¼› * åœ¨ç›®æ ‡ç½‘ç«™ä¸­è¿æ¥è´¦æˆ·åˆ°Docker Hubã€‚ 2ï¼‰åœ¨Docker Hubä¸­é…ç½®ä¸€ä¸ªè‡ªåŠ¨åˆ›å»ºã€‚ 3ï¼‰é€‰å–ä¸€ä¸ªç›®æ ‡ç½‘ç«™ä¸­çš„é¡¹ç›®ï¼ˆéœ€è¦å«Dockerfileï¼‰å’Œåˆ†æ”¯ã€‚ 4ï¼‰æŒ‡å®šDockerfileçš„ä½ç½®ï¼Œå¹¶æäº¤åˆ›å»ºã€‚ ä¹‹åï¼Œå°±å¯ä»¥åœ¨DockerHubçš„â€è‡ªåŠ¨åˆ›å»ºâ€œé¡µé¢è·Ÿè¸ªæ¯æ¬¡åˆ›å»ºçš„çŠ¶æ€ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:4:1","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"5 ç½‘ç»œåŸºç¡€é…ç½® ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:5:0","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["äº‘åŸç”Ÿ"],"content":"5.1 ç«¯å£æ˜ å°„å®ç°è®¿é—®å®¹å™¨ å¤§é‡çš„äº’è”ç½‘åº”ç”¨æœåŠ¡åŒ…æ‹¬å¤šä¸ªæœåŠ¡ç»„ä»¶ï¼Œè¿™å¾€å¾€éœ€è¦å¤šä¸ªå®¹å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œé€šä¿¡è¿›è¡Œç›¸äº’é…åˆã€‚Dockerç›®å‰æä¾›äº†æ˜ å°„å®¹å™¨ç«¯å£åˆ°å®¿ä¸»ä¸»æœºå’Œå®¹å™¨äº’è”æœºåˆ¶æ¥ä¸ºå®¹å™¨æä¾›äº’è”ç½‘æœåŠ¡ã€‚ åœ¨å¯åŠ¨å®¹å™¨æ—¶ï¼Œå¦‚æœä¸æŒ‡å®šå¯¹åº”å‚æ•°ï¼Œåœ¨å®¹å™¨å¤–éƒ¨æ˜¯æ— æ³•é€šè¿‡ç½‘ç»œæ¥è®¿é—®å®¹å™¨å†…çš„ç½‘ç»œåº”ç”¨å’ŒæœåŠ¡çš„ã€‚å½“å®¹å™¨ä¸­è¿è¡Œä¸€äº›åº”ç”¨ï¼Œè¦è®©å¤–éƒ¨è®¿é—®è¿™äº›åº”ç”¨æ—¶ï¼Œå¯ä»¥é€šè¿‡-på‚æ•°æ¥æŒ‡å®šç«¯å£æ˜ å°„ï¼Œå¹¶ä¸”ï¼Œåœ¨ä¸€ä¸ªæŒ‡å®šçš„ç«¯å£ä¸Šåªå¯ä»¥ç»‘å®šä¸€ä¸ªå®¹å™¨ã€‚æ”¯æŒçš„æ ¼å¼æœ‰ip:hostPort:containerPortã€ip::containerPortã€hostPort:containerPortã€‚ æ˜ å°„æ‰€æœ‰æ¥å£åœ°å€ ä½¿ç”¨hostPort:containerPortæ ¼å¼å°†æœ¬åœ°çš„4000ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„4000ç«¯å£ï¼Œå¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š docker run -itd -p 4000:4000 --name my_docker_ubuntu ubuntu:20.04 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»å®ç°äº†ç«¯å£æ˜ å°„ã€‚å¤šæ¬¡ä½¿ç”¨-pæ ‡è®°å¯ä»¥ç»‘å®šå¤šä¸ªç«¯å£ã€‚ä¾‹å¦‚ï¼š docker run -itd -p 4000:4000 -p 3000:3000 --name my_docker_ubuntu ubuntu:20.04 æ˜ å°„åˆ°æŒ‡å®šåœ°å€çš„æŒ‡å®šç«¯å£ å¯ä»¥ä½¿ç”¨ip:hostPort:containerPortæ ¼å¼æŒ‡å®šæ˜ å°„ä½¿ç”¨ä¸€ä¸ªç‰¹å®šåœ°å€ï¼Œæ¯”å¦‚localhoståœ°å€127.0.0.1ï¼š docker run -itd -p 127.0.0.1:3000:3000 --name my_docker_ubuntu ubuntu:20.04 æ˜ å°„åˆ°æŒ‡å®šåœ°å€çš„ä»»æ„ç«¯å£ ä½¿ç”¨ip::containerPortç»‘å®šlocalhostçš„ä»»æ„ç«¯å£åˆ°å®¹å™¨çš„5000ç«¯å£ï¼Œæœ¬åœ°ä¸»æœºä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªç«¯å£ï¼š docker run -itd -p 127.0.0.1::5000 --name my_docker_ubuntu ubuntu:20.04 æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½® å¯ä»¥ä½¿ç”¨docker port containerå‘½ä»¤æ¥æŸ¥çœ‹å½“å‰æ˜ å°„çš„ç«¯å£é…ç½®ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹åˆ°ç»‘å®šçš„åœ°å€ã€‚ ","date":"2022-02-13","objectID":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/:5:1","tags":["Docker"],"title":"Dockerå…¥é—¨æ•™ç¨‹","uri":"/posts/01.docker%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 Linuxå¸¸ç”¨å‘½ä»¤ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:0","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.1 ç³»ç»ŸçŠ¶å†µ topï¼šæŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çš„ä¿¡æ¯ï¼ˆLinuxçš„ä»»åŠ¡ç®¡ç†å™¨ï¼‰ã€‚ æ‰“å¼€åè¾“å…¥Mï¼šæŒ‰ä½¿ç”¨å†…å­˜æ’åºï¼› æ‰“å¼€åè¾“å…¥Pï¼šæŒ‰ä½¿ç”¨CPUæ’åºï¼› æ‰“å¼€åè¾“å…¥qï¼šé€€å‡ºã€‚ df -hï¼šæŸ¥çœ‹ç¡¬ç›˜ä½¿ç”¨æƒ…å†µã€‚ free -hï¼šæŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µã€‚ du -shï¼šæŸ¥çœ‹å½“å‰ç›®å½•å ç”¨çš„ç¡¬ç›˜ç©ºé—´ã€‚ ps auxï¼šæŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ã€‚ kill -9 pidï¼šæ€æ­»ç¼–å·ä¸ºpidçš„è¿›ç¨‹ã€‚ kill -s SIGTERM pidï¼šä¼ é€’æŸä¸ªå…·ä½“çš„ä¿¡å·ã€‚ netstat -ntï¼šæŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¿æ¥ã€‚ wï¼šåˆ—å‡ºå½“å‰ç™»å½•çš„ç”¨æˆ·ã€‚ ping www.baidu.comï¼šæµ‹è¯•ç½‘ç»œè¿æ¥ï¼Œæ£€æŸ¥æ˜¯å¦è”ç½‘ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:1","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.2 æ–‡ä»¶æƒé™ chmodï¼šä¿®æ”¹æ–‡ä»¶æƒé™ chmod +x filenameï¼šç»™filenameæ·»åŠ å¯æ‰§è¡Œæƒé™ï¼› chmod -x filenameï¼šå»æ‰filenameçš„å¯æ‰§è¡Œæƒé™ï¼› chmod abc filename:å…¶ä¸­aï¼Œbï¼Œcå„ä¸ºä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºUserã€Groupä»¥åŠOtherçš„æƒé™ã€‚r=4ï¼Œw=2ï¼Œx=1ï¼Œä¸ºè¯»ï¼Œå†™ï¼Œå¯æ‰§è¡Œã€‚ å¦‚è®¾ç½®æ‰€æœ‰äººå¯¹è¯¥æ–‡ä»¶éƒ½å¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œåˆ™è®¾ç½®chmod 777 filenameã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:2","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.3 æ–‡ä»¶æ£€ç´¢ find \u003cpath\u003e(æ–‡ä»¶è·¯å¾„) -name '*.py'ï¼šæœç´¢pathè·¯å¾„ä¸‹çš„æ‰€æœ‰pyæ–‡ä»¶ã€‚ grep xxxï¼šä»stdinä¸­è¯»å…¥è‹¥å¹²è¡Œæ•°æ®ï¼Œå¦‚æœæŸè¡Œä¸­åŒ…å«xxxï¼Œåˆ™è¾“å‡ºè¯¥è¡Œï¼Œå¦åˆ™å¿½ç•¥è¯¥è¡Œã€‚ wcï¼šç»Ÿè®¡è¡Œæ•°ã€å•è¯æ•°ã€å­—èŠ‚æ•°ã€‚ æ—¢å¯ä»¥ä»stdinä¸­ç›´æ¥è¯»å–å†…å®¹ï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œå‚æ•°ä¸­ä¼ å…¥æ–‡ä»¶ååˆ—è¡¨ã€‚ wc -lï¼šç»Ÿè®¡è¡Œæ•°ã€‚ wc -wï¼šç»Ÿè®¡å•è¯æ•°ã€‚ wc -cï¼šç»Ÿè®¡å­—èŠ‚æ•°ã€‚ treeï¼šå±•ç¤ºå½“å‰ç›®å½•çš„æ–‡ä»¶ç»“æ„ã€‚ tree pathï¼šå±•ç¤ºæŸä¸ªç›®å½•çš„æ–‡ä»¶ç»“æ„ã€‚ tree -aï¼šæ˜¾ç¤ºéšè—æ–‡ä»¶ã€‚ ag xxxï¼šæœç´¢å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ£€ç´¢xxxå­—ç¬¦ä¸²ã€‚ cutï¼šåˆ†å‰²ä¸€è¡Œå†…å®¹ã€‚ ä»stdinä¸­è¯»å…¥å¤šè¡Œæ•°æ®ã€‚ echo $PATH | cut -d ':' -f 3, 5ï¼šè¾“å‡ºPATHç”¨:åˆ†å‰²åçš„ç¬¬3ã€5åˆ—æ•°æ®ã€‚ echo $PATH | cut -d ':' -f 3-5ï¼šè¾“å‡ºPATHç”¨:åˆ†å‰²åçš„ç¬¬3-5åˆ—æ•°æ®ã€‚ echo $PATH | cut -c 3, 5ï¼šè¾“å‡ºPATHçš„ç¬¬3ã€5ä¸ªå­—ç¬¦ã€‚ echo $PATH | cut -c 3-5ï¼šè¾“å‡ºPATHçš„ç¬¬3-5ä¸ªå­—ç¬¦ã€‚ sortï¼šå°†æ¯è¡Œå†…å®¹æŒ‰å­—å…¸åºæ’åºã€‚ å¯ä»¥ä»stdinä¸­è¯»å–å¤šè¡Œæ•°æ®ã€‚ å¯ä»¥ä»å‘½ä»¤è¡Œå‚æ•°ä¸­è¯»å–æ–‡ä»¶ååˆ—è¡¨ã€‚ xargsï¼šå°†stdinä¸­çš„æ•°æ®ç”¨ç©ºæ ¼æˆ–å›è½¦åˆ†å‰²æˆå‘½ä»¤è¡Œå‚æ•°ï¼Œä½œä¸ºå…¶ä»–å‘½ä»¤ä½¿ç”¨ã€‚ find . -name '*.py' | xargs cat | wc -lï¼šç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ‰€æœ‰pythonæ–‡ä»¶çš„æ€»è¡Œæ•°ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:3","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.4 æŸ¥çœ‹æ–‡ä»¶å†…å®¹ moreï¼šæµè§ˆæ–‡ä»¶å†…å®¹ã€‚ å›è½¦æˆ–ç©ºæ ¼ï¼šä¸‹ä¸€è¡Œã€‚ bï¼šä¸Šä¸€é¡µã€‚ qï¼šé€€å‡ºã€‚ lessï¼šå’Œmoreç±»ä¼¼ï¼ŒåŠŸèƒ½æ›´å…¨ã€‚ å›è½¦ï¼šä¸‹ä¸€è¡Œã€‚ yï¼šä¸Šä¸€è¡Œã€‚ Page Downï¼šä¸‹ä¸€é¡µã€‚ Page Upï¼šä¸Šä¸€é¡µã€‚ qï¼šé€€å‡ºã€‚ head -3 xxxï¼šæ˜¾ç¤ºxxxçš„å‰3è¡Œå†…å®¹ã€‚ åŒæ—¶æ”¯æŒä»stdinè¯»å…¥å†…å®¹ã€‚ tail -3 xxxï¼šæ˜¾ç¤ºxxxæœ«å°¾3è¡Œå†…å®¹ã€‚ åŒæ—¶æ”¯æŒä»stdinè¯»å…¥å†…å®¹ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:4","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.5 ç”¨æˆ·ç›¸å…³ historyï¼šå±•ç¤ºå½“å‰ç”¨æˆ·çš„å†å²æ“ä½œã€‚å†…å®¹å­˜æ”¾åœ¨~/bash_historyä¸­ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:5","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.6 å·¥å…· md5Sumï¼šè®¡ç®—md5çš„å“ˆå¸Œå€¼ã€‚ ä¹Ÿå¯ä»¥ä»stdinä¸­è¯»å…¥å†…å®¹ï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œå‚æ•°ä¸­ä¼ å…¥æ–‡ä»¶ååˆ—è¡¨ã€‚ time commandï¼šç»Ÿè®¡commandå‘½ä»¤çš„æ‰§è¡Œæ—¶é—´ã€‚ ipython3ï¼šäº¤äº’å¼pythonç¯å¢ƒã€‚å¯ä»¥å½“ä½œè®¡ç®—å™¨ï¼Œæˆ–è€…æ‰¹é‡ç®¡ç†æ–‡ä»¶ã€‚ i commandï¼š!è¡¨ç¤ºæ‰§è¡Œshellè„šæœ¬å‘½ä»¤ã€‚ watch -n 0.1 commandï¼šæ¯éš”0.1så°±æ‰§è¡Œä¸€æ¬¡commandå‘½ä»¤ã€‚ tarï¼šå‹ç¼©æ–‡ä»¶ã€‚ tar -zcvf xxx.tar.gz /pathï¼šå‹ç¼©ã€‚ tar -zxvf xxx.tar.gz ï¼šè§£å‹ç¼©ã€‚ diff xxx yyyï¼šæŸ¥çœ‹æ–‡ä»¶xxxå’Œyyyçš„ä¸åŒç‚¹ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:6","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.7 å®‰è£…è½¯ä»¶ sudo commandï¼šä»¥rootèº«ä»½è¿è¡Œcommandå‘½ä»¤ã€‚ apt-get install xxxï¼šå®‰è£…xxxè½¯ä»¶ã€‚ pip install xxx --user --upgradeï¼šå®‰è£…pythonåŒ…ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:1:7","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 ç®¡é“ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:2:0","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 ç®¡é“å‘½ä»¤ ç®¡é“å‘½ä»¤æ“ä½œç¬¦æ˜¯|ï¼Œ,å®ƒåªèƒ½å¤„ç†ç»ç”±å‰é¢ä¸€ä¸ªæŒ‡ä»¤ä¼ å‡ºçš„æ­£ç¡®è¾“å‡ºä¿¡æ¯ï¼Œå¯¹é”™è¯¯ä¿¡æ¯ä¿¡æ¯æ²¡æœ‰ç›´æ¥å¤„ç†èƒ½åŠ›ã€‚ç„¶åä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ï¼Œä½œä¸ºæ ‡å‡†çš„è¾“å…¥ã€‚ ä¸‹å›¾ä¸ºç®¡é“å‘½ä»¤çš„è¾“å‡ºè¯´æ˜ï¼š ã€æŒ‡ä»¤1ã€‘æ­£ç¡®è¾“å‡ºï¼Œä½œä¸ºã€æŒ‡ä»¤2ã€‘çš„è¾“å…¥ï¼Œç„¶åã€æŒ‡ä»¤2ã€‘çš„è¾“å‡ºä½œä¸ºã€æŒ‡ä»¤3ã€‘çš„è¾“å…¥ ï¼Œã€æŒ‡ä»¤3ã€‘è¾“å‡ºå°±ä¼šç›´æ¥æ˜¾ç¤ºåœ¨å±å¹•ä¸Šé¢äº†ã€‚ é€šè¿‡ç®¡é“ä¹‹åï¼Œæˆ‘ä»¬å‘ç°ã€æŒ‡ä»¤1ã€‘å’Œã€æŒ‡ä»¤2ã€‘çš„æ­£ç¡®è¾“å‡ºä¸æ˜¾ç¤ºåœ¨å±å¹•ä¸Šé¢ï¼Œåªæ˜¾ç¤ºæŒ‡ä»¤3çš„è¾“å‡ºã€‚ å…¶ç±»ä¼¼äºä¹‹å‰å­¦ä¹ çš„æ–‡ä»¶é‡å®šå‘ï¼Œå¯ä»¥å°†å‰é¢ä¸€ä¸ªå‘½ä»¤çš„stdouté‡å®šå‘ä¸‹ä¸€ä¸ªå‘½ä»¤çš„stdinã€‚ä½†ä¸æ–‡ä»¶é‡å®šå‘æœ‰å¾ˆå¤§åŒºåˆ«ï¼šæ–‡ä»¶é‡å®šå‘å·¦è¾¹ä¸ºå‘½ä»¤ï¼Œå³è¾¹ä¸ºæ–‡ä»¶ï¼›ç®¡é“å·¦å³ä¸¤è¾¹å‡ä¸ºå‘½ä»¤ï¼Œå·¦è¾¹æœ‰stdoutï¼Œå³è¾¹æœ‰stdinã€‚ å€¼å¾—æ³¨æ„çš„ç‚¹ï¼š ç®¡é“å‘½ä»¤ä»…èƒ½å¤„ç†stdoutï¼Œå¿½ç•¥stderrã€‚ ç®¡é“å³è¾¹çš„å‘½ä»¤å¿…é¡»èƒ½æ¥å—stdinã€‚ å¤šä¸ªç®¡é“å‘½ä»¤å¯ä»¥ä¸²è”ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:2:1","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 å®ä¾‹ ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ‰€æœ‰pythonæ–‡ä»¶çš„æ€»è¡Œæ•° ç»Ÿè®¡æ€»è¡Œæ•°ï¼Œåœ¨å‰é¢å¸¸ç”¨å‘½ä»¤å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä¼šäº†ï¼šwc -lï¼Œç»Ÿè®¡å½“å‰ç›®å½•æ‰€æœ‰çš„pythonæ–‡ä»¶ï¼Œä¹Ÿæ˜“å¾—ä¸ºï¼šfind . -name '*.py'ã€‚é‚£ä¹ˆæˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜åˆ™æ˜¯å°†æ‰€æœ‰pythonæ–‡ä»¶é€‰å‡ºæ¥å¾—åˆ°å…¶å†…å®¹å†ç»Ÿè®¡ã€‚æˆ‘ä»¬åˆ™å¯èƒ½ä¼šè¿™æ ·ï¼šfind . -name '*.py' | cat | wc -lã€‚ä½†find . -name '*.py'å¾—åˆ°çš„æ˜¯å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åˆ©ç”¨xargså°†å­—ç¬¦ä¸²åˆ†å‰²ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™æ ·å³å¯è¾¾åˆ°æ•ˆæœã€‚ å³ï¼šfind . -name '*.py' | xargs cat | wc -lã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:2:2","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ç¯å¢ƒå˜é‡ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:3:0","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 æ¦‚å¿µ Linuxç³»ç»Ÿä¸­ä¼šç”¨å¾ˆå¤šç¯å¢ƒå˜é‡æ¥è®°å½•é…ç½®ä¿¡æ¯ã€‚ç¯å¢ƒå˜é‡ç±»ä¼¼äºå…¨å±€å˜é‡ï¼Œå¯ä»¥è¢«å„ä¸ªè¿›ç¨‹è®¿é—®åˆ°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ç¯å¢ƒå˜é‡æ¥æ–¹ä¾¿åœ°ä¿®æ”¹ç³»ç»Ÿé…ç½®ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:3:1","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 æŸ¥çœ‹ç¯å¢ƒå˜é‡ åˆ—å‡ºå½“å‰ç¯å¢ƒä¸‹çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼š env # æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„å˜é‡ï¼› set # æ˜¾ç¤ºå½“å‰shellçš„å˜é‡ï¼ŒåŒ…å«å½“å‰ç”¨æˆ·çš„å˜é‡ï¼› export # æ˜¾ç¤ºå½“å‰å¯¼å‡ºæˆç”¨æˆ·å˜é‡çš„shellå˜é‡ã€‚ è¾“å‡ºæŸä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼šecho $PATH ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:3:2","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.3 ä¿®æ”¹ç¯å¢ƒå˜é‡ ä¿®æ”¹ç¯å¢ƒå˜é‡æˆ‘ä»¬å¯ä»¥å…ˆå°†ä¿®æ”¹å‘½ä»¤æ”¾åˆ°~/.bashrcæ–‡ä»¶ä¸­ã€‚ä¿®æ”¹å®Œä¹‹åéœ€æ‰§è¡Œsource ~/.bashrcï¼Œæ¥å°†ä¿®æ”¹åº”ç”¨åˆ°å½“å‰çš„bashç¯å¢ƒä¸‹ã€‚ ä¸ºä½•å°†ä¿®æ”¹å‘½ä»¤æ”¾åˆ°~/.bashrcï¼Œå°±å¯ä»¥ç¡®ä¿ä¿®æ”¹ä¼šå½±å“æœªæ¥æ‰€æœ‰çš„ç¯å¢ƒå‘¢ï¼Ÿ æ¯æ¬¡å¯åŠ¨bashï¼Œéƒ½ä¼šå…ˆæ‰§è¡Œ~/.bashrcã€‚ æ¯æ¬¡sshç™»å½•è¿œç¨‹æœåŠ¡å™¨ï¼Œéƒ½ä¼šå¯åŠ¨ä¸€ä¸ªbashå‘½ä»¤è¡Œç»™æˆ‘ä»¬ã€‚ æ¯æ¬¡tmuxæ–°å¼€ä¸€ä¸ªpaneï¼Œéƒ½ä¼šå¯åŠ¨ä¸€ä¸ªbashå‘½ä»¤è¡Œç»™æˆ‘ä»¬ã€‚ æœªæ¥æ‰€æœ‰çš„æ–°å¼€ç¯å¢ƒéƒ½ä¼šåŠ è½½æˆ‘ä»¬ä¿®æ”¹çš„å†…å®¹ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:3:3","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.4 å¸¸è§ç¯å¢ƒå˜é‡ HOMEï¼šç”¨æˆ·çš„å®¶ç›®å½• PATHï¼šå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå‘½ä»¤ï¼‰çš„å­˜å‚¨è·¯å¾„ã€‚è·¯å¾„ä¸è·¯å¾„ä¹‹é—´ç”¨:åˆ†éš”ã€‚å½“æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶åŒæ—¶å‡ºç°å¤šä¸ªè·¯å¾„ä¸­æ—¶ï¼Œä¼šé€‰æ‹©ä»å·¦åˆ°å³æ•°ç¬¬ä¸€ä¸ªè·¯å¾„ä¸­çš„æ‰§è¡Œã€‚ä¸‹åˆ—æ‰€æœ‰å­˜å‚¨è·¯å¾„çš„ç¯å¢ƒå˜é‡ï¼Œå‡é‡‡ç”¨ä»å·¦åˆ°å³çš„ä¼˜å…ˆé¡ºåºã€‚ LD_LIBRARY_PATHï¼šç”¨äºæŒ‡å®šåŠ¨æ€é“¾æ¥åº“(.soæ–‡ä»¶)çš„è·¯å¾„ï¼Œå…¶å†…å®¹æ˜¯ä»¥å†’å·åˆ†éš”çš„è·¯å¾„åˆ—è¡¨ã€‚ C_INCLUDE_PATHï¼šCè¯­è¨€çš„å¤´æ–‡ä»¶è·¯å¾„ï¼Œå†…å®¹æ˜¯ä»¥å†’å·åˆ†éš”çš„è·¯å¾„åˆ—è¡¨ã€‚ CPLUS_INCLUDE_PATHï¼šCPPçš„å¤´æ–‡ä»¶è·¯å¾„ï¼Œå†…å®¹æ˜¯ä»¥å†’å·åˆ†éš”çš„è·¯å¾„åˆ—è¡¨ã€‚ PYTHONPATHï¼šPythonå¯¼å…¥åŒ…çš„è·¯å¾„ï¼Œå†…å®¹æ˜¯ä»¥å†’å·åˆ†éš”çš„è·¯å¾„åˆ—è¡¨ã€‚ JAVA_HOMEï¼šjdkçš„å®‰è£…ç›®å½•ã€‚ CLASSPATHï¼šå­˜æ”¾Javaå¯¼å…¥ç±»çš„è·¯å¾„ï¼Œå†…å®¹æ˜¯ä»¥å†’å·åˆ†éš”çš„è·¯å¾„åˆ—è¡¨ã€‚ ","date":"2022-02-05","objectID":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/:3:4","tags":["Linux"],"title":"Linuxå¸¸ç”¨å‘½ä»¤ã€ç®¡é“ã€ç¯å¢ƒå˜é‡","uri":"/posts/01.linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AE%A1%E9%81%93%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"},{"categories":["å·¥å…·"],"content":"1 gitç®€ä»‹ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:1:0","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.1 ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ ç‰ˆæœ¬æ§åˆ¶æ˜¯ä¸€ç§è®°å½•ä¸€ä¸ªæˆ–è‹¥å¹²æ–‡ä»¶å†…å®¹å˜åŒ–ï¼Œä»¥ä¾¿å°†æ¥æŸ¥é˜…ç‰¹å®šç‰ˆæœ¬ä¿®è®¢æƒ…å†µçš„ç³»ç»Ÿã€‚ é™¤äº†é¡¹ç›®æºä»£ç ï¼Œä½ å¯ä»¥å¯¹ä»»ä½•ç±»å‹çš„æ–‡ä»¶è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚ æœ‰äº†å®ƒä½ å°±å¯ä»¥å°†æŸä¸ªæ–‡ä»¶å›æº¯åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œç”šè‡³å°†æ•´ä¸ªé¡¹ç›®éƒ½å›é€€åˆ°è¿‡å»æŸä¸ªæ—¶é—´ç‚¹çš„çŠ¶æ€ï¼Œä½ å¯ä»¥æ¯”è¾ƒæ–‡ä»¶çš„å˜åŒ–ç»†èŠ‚ï¼ŒæŸ¥å‡ºæœ€åæ˜¯è°ä¿®æ”¹äº†å“ªä¸ªåœ°æ–¹ï¼Œä»è€Œæ‰¾å‡ºå¯¼è‡´æ€ªå¼‚é—®é¢˜å‡ºç°çš„åŸå› ï¼Œåˆæ˜¯è°åœ¨ä½•æ—¶æŠ¥å‘Šäº†æŸä¸ªåŠŸèƒ½ç¼ºé™·ç­‰ç­‰ã€‚ è€Œç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆVCSï¼‰åˆ™æ˜¯ä¸€ç§è½¯ä»¶ï¼Œå¯ä»¥å¸®åŠ©è½¯ä»¶å›¢é˜Ÿçš„å¼€å‘äººå‘˜ååŒå·¥ä½œï¼Œå¹¶å­˜æ¡£ä»–ä»¬å·¥ä½œçš„å®Œæ•´å†å²è®°å½•ã€‚ ç›®å‰ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæœ‰å¦‚ä¸‹ä¸‰ç§ï¼š æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼šå³é€šè¿‡ç”¨æ–‡ä»¶ç›®å½•å½¢å¼ä¿å­˜æ¯ä¸ªé¡¹ç›®ç‰ˆæœ¬ï¼Œå…¶ä¸­ç›®å½•åä¼šå¤‡æ³¨ä¸€äº›ç‰ˆæœ¬ä¿¡æ¯ã€ä¿®æ”¹æ—¶é—´ç­‰ã€‚å…¶æœ€å¤§çš„å¥½å¤„å°±æ˜¯ç®€å•ï¼Œä½†ç‰¹åˆ«å®¹æ˜“çŠ¯é”™ï¼Œä¸åˆ©äºç®¡ç†ï¼Œå®¹æ˜“è¦†ç›–é‡è¦çš„æ–‡ä»¶ï¼Œè€Œä¸”ä¸é€‚åˆååŒå·¥ä½œã€‚ é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆCentralized Version Control Systemsï¼ŒCVCSï¼‰ï¼šé›†ä¸­åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªå•ä¸€çš„é›†ä¸­ç®¡ç†çš„æœåŠ¡å™¨ï¼Œä¿å­˜æ‰€æœ‰æ–‡ä»¶çš„ä¿®è®¢ç‰ˆæœ¬ï¼Œè€ŒååŒå·¥ä½œçš„äººä»¬éƒ½é€šè¿‡å®¢æˆ·ç«¯è¿åˆ°è¿™å°æœåŠ¡å™¨ï¼Œå–å‡ºæœ€æ–°çš„æ–‡ä»¶æˆ–è€…æäº¤æ›´æ–°ã€‚è¿™ä¹ˆåšè™½ç„¶è§£å†³äº†æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ— æ³•è®©åœ¨ä¸åŒç³»ç»Ÿä¸Šçš„å¼€å‘è€…ååŒå·¥ä½œçš„è¯Ÿç—…ï¼Œä½†ä¹Ÿè¿˜æ˜¯å­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼šå¦‚æœä¸­å¤®æœåŠ¡å™¨å®•æœºï¼Œåˆ™å…¶ä»–äººæ— æ³•ä½¿ç”¨ï¼›å¿…é¡»è”ç½‘æ‰èƒ½å·¥ä½œã€‚ åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆDistributed Version Control Systemsï¼ŒDVCSï¼‰ï¼šåœ¨è¿™ç±»ç³»ç»Ÿä¸­ï¼Œåƒ Gitã€Mercurialã€Bazaar ä»¥åŠ Darcs ç­‰ï¼Œå®¢æˆ·ç«¯å¹¶ä¸åªæå–æœ€æ–°ç‰ˆæœ¬çš„æ–‡ä»¶å¿«ç…§ï¼Œ è€Œæ˜¯æŠŠä»£ç ä»“åº“å®Œæ•´åœ°é•œåƒä¸‹æ¥ï¼ŒåŒ…æ‹¬å®Œæ•´çš„å†å²è®°å½•ã€‚ è¿™ä¹ˆä¸€æ¥ï¼Œä»»ä½•ä¸€å¤„ååŒå·¥ä½œç”¨çš„æœåŠ¡å™¨å‘ç”Ÿæ•…éšœï¼Œäº‹åéƒ½å¯ä»¥ç”¨ä»»ä½•ä¸€ä¸ªé•œåƒå‡ºæ¥çš„æœ¬åœ°ä»“åº“æ¢å¤ã€‚ å› ä¸ºæ¯ä¸€æ¬¡çš„å…‹éš†æ“ä½œï¼Œå®é™…ä¸Šéƒ½æ˜¯ä¸€æ¬¡å¯¹ä»£ç ä»“åº“çš„å®Œæ•´å¤‡ä»½ã€‚ åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå¯ä»¥ä¸ç”¨è”ç½‘å°±å¯ä»¥å·¥ä½œï¼Œå› ä¸ºæ¯ä¸ªäººçš„ç”µè„‘ä¸Šéƒ½æ˜¯å®Œæ•´çš„ç‰ˆæœ¬åº“ï¼Œå½“ä½ ä¿®æ”¹äº†æŸä¸ªæ–‡ä»¶åï¼Œä½ åªéœ€è¦å°†è‡ªå·±çš„ä¿®æ”¹æ¨é€ç»™åˆ«äººå°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„æ—¶å€™ï¼Œå¾ˆå°‘ä¼šç›´æ¥è¿›è¡Œæ¨é€ä¿®æ”¹ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€å°å……å½“â€œä¸­å¤®æœåŠ¡å™¨â€çš„ä¸œè¥¿ã€‚è¿™ä¸ªæœåŠ¡å™¨çš„ä½œç”¨ä»…ä»…æ˜¯ç”¨æ¥æ–¹ä¾¿â€œäº¤æ¢â€å¤§å®¶çš„ä¿®æ”¹ï¼Œæ²¡æœ‰å®ƒå¤§å®¶ä¹Ÿä¸€æ ·å¹²æ´»ï¼Œåªæ˜¯äº¤æ¢ä¿®æ”¹ä¸æ–¹ä¾¿è€Œå·²ã€‚ åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„ä¼˜åŠ¿ä¸å•æ˜¯ä¸å¿…è”ç½‘è¿™ä¹ˆç®€å•ï¼Œåé¢æˆ‘ä»¬è¿˜ä¼šçœ‹åˆ° Git æå…¶å¼ºå¤§çš„åˆ†æ”¯ç®¡ç†ç­‰åŠŸèƒ½ã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:1:1","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.2 ä»€ä¹ˆæ˜¯git Gitæ˜¯ä¸€æ¬¾å…è´¹ã€å¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç”¨äºæ•æ·é«˜æ•ˆåœ°å¤„ç†ä»»ä½•æˆ–å°æˆ–å¤§çš„é¡¹ç›®ã€‚å…¶æ˜¯ Linus Torvalds ä¸ºäº†å¸®åŠ©ç®¡ç† Linux å†…æ ¸å¼€å‘è€Œå¼€å‘çš„ä¸€ä¸ªå¼€æ”¾æºç çš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ã€‚Git ä¸å¸¸ç”¨çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…· CVS, Subversion ç­‰ä¸åŒï¼Œå®ƒé‡‡ç”¨äº†åˆ†å¸ƒå¼ç‰ˆæœ¬åº“çš„æ–¹å¼ï¼Œä¸å¿…æœåŠ¡å™¨ç«¯è½¯ä»¶æ”¯æŒã€‚ å®˜ç½‘åœ°å€ä¸ºï¼šhttps://git-scm.com/ï¼Œåœ¨ä¸Šé¢æœ‰æƒå¨çš„gitä»‹ç»ä»¥åŠgitä¸‹è½½åœ°å€ã€‚ SVNæ˜¯é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œè€ŒGitæ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ŒGitä¸SVNçš„åŒºåˆ«å¯å‚è€ƒGitä¸SVNçš„åŒºåˆ«ã€‚ gitæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š é€‚åˆåˆ†å¸ƒå¼å¼€å‘ï¼Œå¼ºè°ƒä¸ªä½“ï¼›å…¬å…±æœåŠ¡å™¨å‹åŠ›å’Œæ•°æ®é‡éƒ½ä¸ä¼šå¤ªå¤§ï¼› é€Ÿåº¦å¿«ã€çµæ´»ï¼› ä»»æ„ä¸¤ä¸ªå¼€å‘è€…ä¹‹é—´å¯ä»¥å¾ˆå®¹æ˜“çš„è§£å†³å†²çªï¼› ç¦»çº¿å·¥ä½œã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:1:2","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.3 gitçš„å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ å·¥ä½œåŒºï¼ˆworkspaceï¼‰ï¼šä»“åº“çš„ç›®å½•ã€‚å·¥ä½œåŒºæ˜¯ç‹¬ç«‹äºå„ä¸ªåˆ†æ”¯çš„ã€‚åœ¨å½“å‰ä»“åº“ä¸­ï¼Œæ–°å¢ï¼Œæ›´æ”¹ï¼Œåˆ é™¤æ–‡ä»¶è¿™äº›åŠ¨ä½œï¼Œéƒ½å‘ç”Ÿåœ¨å·¥ä½œåŒºé‡Œé¢ã€‚ æš‚å­˜åŒºï¼ˆindex/stageï¼‰ï¼šæ•°æ®æš‚æ—¶å­˜æ”¾çš„åŒºåŸŸï¼Œç±»ä¼¼äºå·¥ä½œåŒºå†™å…¥ç‰ˆæœ¬åº“å‰çš„ç¼“å­˜åŒºã€‚æš‚å­˜åŒºæ˜¯ç‹¬ç«‹äºå„ä¸ªåˆ†æ”¯çš„ã€‚ä¸€èˆ¬å­˜æ”¾åœ¨ .git ç›®å½•ä¸‹çš„ index æ–‡ä»¶ï¼ˆ.git/indexï¼‰ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæš‚å­˜åŒºæœ‰æ—¶ä¹Ÿå«ä½œç´¢å¼•ï¼ˆindexï¼‰ã€‚ ç‰ˆæœ¬åº“ï¼ˆRepositoryï¼‰ï¼šä¹Ÿå¯ä»¥å«ä»“åº“åŒºï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬çš„æœ¬åœ°ä»“åº“ã€‚å°±æ˜¯å®‰å…¨å­˜æ”¾æ•°æ®çš„ä½ç½®ï¼Œè¿™é‡Œé¢æœ‰ä½ æäº¤åˆ°æ‰€æœ‰ç‰ˆæœ¬çš„æ•°æ®ã€‚å…¶ä¸­HEADæŒ‡å‘æœ€æ–°æ”¾å…¥ä»“åº“çš„ç‰ˆæœ¬ ç‰ˆæœ¬ç»“æ„ï¼šæ ‘ç»“æ„ï¼Œæ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªä»£ç ç‰ˆæœ¬ã€‚ è¿œç¨‹ä»“åº“ï¼ˆRemote Repositoryï¼‰ï¼š æ‰˜ç®¡ä»£ç çš„æœåŠ¡å™¨ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºæ˜¯ä½ é¡¹ç›®ç»„ä¸­çš„ä¸€å°ç”µè„‘ç”¨äºè¿œç¨‹æ•°æ®äº¤æ¢ã€‚ç›®å‰æµè¡Œçš„è¿œç¨‹ä»“åº“æœ‰ï¼šGithubã€Giteeã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:1:3","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.4 gitå·¥ä½œæµç¨‹ ä¸€èˆ¬å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š ä»è¿œç¨‹ä»“åº“ä¸­å…‹éš† Git èµ„æºä½œä¸ºæœ¬åœ°ä»“åº“ï¼› ä»æœ¬åœ°ä»“åº“ä¸­checkoutä»£ç ç„¶åè¿›è¡Œä»£ç ä¿®æ”¹ï¼› åœ¨æäº¤æœ¬åœ°ä»“åº“å‰å…ˆå°†ä»£ç æäº¤åˆ°æš‚å­˜åŒºï¼› æäº¤ä¿®æ”¹ï¼Œæäº¤åˆ°æœ¬åœ°ä»“åº“ï¼›æœ¬åœ°ä»“åº“ä¸­ä¿å­˜ä¿®æ”¹çš„å„ä¸ªå†å²ç‰ˆæœ¬ï¼› åœ¨éœ€è¦å’Œå›¢é˜Ÿæˆå‘˜å…±äº«ä»£ç æ—¶ï¼Œå¯ä»¥å°†ä¿®æ”¹ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:1:4","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2 gitå®‰è£…é…ç½® ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:2:0","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.1 windowså¹³å°å®‰è£… ä¸»è¦å­¦linuxï¼Œè¿™é‡Œåˆ—å‡ºå…¶ä»–blogçš„windowså¹³å°å®‰è£…æ•™ç¨‹ï¼šå®‰è£…æ•™ç¨‹ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:2:1","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.2 Linuxå¹³å°å®‰è£… é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ç€è¾“å…¥gitï¼Œçœ‹çœ‹ç³»ç»Ÿæœ‰æ²¡æœ‰å®‰è£…Gitï¼š $ git The program 'git' is currently not installed. You can install it by typing: sudo apt-get install git å¦‚æœå‡ºç°è¿™ä¸ªï¼Œåˆ™è¯´æ˜Gitè¿˜æ²¡æœ‰å®‰è£…ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¾—æ˜¯Debianæˆ–è€…Ubuntu Linuxï¼Œé€šè¿‡å‘½ä»¤ï¼šsudo apt-get install gitå°±å¯ä»¥ç›´æ¥å®ŒæˆGitçš„å®‰è£…ï¼Œéå¸¸ç®€å•ã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:2:2","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.3 Macå¹³å°å®‰è£… ä¸»è¦å­¦linuxï¼Œè¿™é‡Œåˆ—å‡ºå…¶ä»–blogçš„Macå¹³å°å®‰è£…é…ç½®æ•™ç¨‹ï¼šå®‰è£…é…ç½®æ•™ç¨‹ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:2:3","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.4 é…ç½® å®‰è£…å¥½gitä¹‹åï¼Œå°±éœ€è¦å¯¹gitè¿›è¡Œé…ç½®æ“ä½œäº†ï¼Œéœ€è¦é…ç½®è‡ªå·±çš„ç”¨æˆ·åå’ŒEmailã€‚é…ç½®çš„å‘½ä»¤å¦‚ä¸‹ï¼š $ git config --global user.name \"ç”¨æˆ·å\" $ git config --global user.email \"é‚®ç®±\" å¦‚æœä½ éœ€è¦æ£€æŸ¥ä½ çš„é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨git config --listå‘½ä»¤æ¥åˆ—å‡ºæ‰€æœ‰é…ç½®ä¿¡æ¯ï¼š ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:2:4","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3 gitåŸºæœ¬å‘½ä»¤ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:3:0","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.1 å»ºç«‹æœ¬åœ°ä»“åº“ (1). åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸ºæœ¬åœ°ä»“åº“ git init æœ¬åœ°ä»“åº“å (2). ä½¿ç”¨å½“å‰ç›®å½•ä½œä¸ºæœ¬åœ°ä»“åº“ git init (3). å°†è¿œç¨‹ä»“åº“å…‹éš†ä¸‹æ¥ä½œä¸ºæœ¬åœ°ä»“åº“ æ­¤å‘½ä»¤æ”¯æŒå¤šç§åè®®ï¼Œä½†æˆ‘ä¸€èˆ¬æ˜¯é€šè¿‡SSHåè®®ï¼Œå…¶å†…éƒ¨å®ç°æ˜¯é€šè¿‡SSHï¼Œæ‰€ä»¥è¿›è¡Œè¿™æ­¥æ“ä½œä¹‹å‰æˆ‘ä»¬éœ€è¦ç¡®ä¿åœ¨è¿œç¨‹ä»“åº“æ·»åŠ äº†SSHå…¬é’¥ï¼Œå¦‚æœæ²¡æœ‰æ·»åŠ éœ€è¦åœ¨æœ¬åœ°ä¸»æœºé€šè¿‡ssh-keygenï¼Œç„¶åä¼šç”Ÿæˆsshå…¬é’¥å’Œå¯†é’¥ï¼Œæˆ‘ä»¬å°†å…¬é’¥æ·»åŠ åˆ°è¿œç¨‹ä»“åº“å³å¯ã€‚ git clone git@æœåŠ¡å™¨å:ä»“åº“è·¯å¾„ è¯¥æ ¼å¼å’Œscpå‘½ä»¤ä¸€è‡´ï¼Œ@å‰é¢è¡¨ç¤ºç”¨æˆ·åï¼Œè¿™ä¸ªä¸€èˆ¬éƒ½æ˜¯gitï¼Œåé¢è¡¨ç¤ºæœåŠ¡å™¨åï¼Œå¯ä»¥æ˜¯IPåœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯åŸŸåï¼Œä¾‹å¦‚github.comï¼Œ:åé¢è¡¨ç¤ºä»“åº“è·¯å¾„ã€‚ä¸è¿‡ä¸éœ€è¦æ‹…å¿ƒï¼Œè¿™ä¸ªè¿œç¨‹ä»“åº“ä¼šç»™å‡ºã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:3:1","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.2 æäº¤ã€ä¿®æ”¹å’Œåˆ é™¤ (1). å°†æ–‡ä»¶æäº¤åˆ°æš‚å­˜åŒº # å°†æŒ‡å®šæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº git add file1 file2 ... fileN # å°†æŒ‡å®šç›®å½•æ·»åŠ åˆ°æš‚å­˜åŒº git add dir1 dir2 ... dirN # æ·»åŠ å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº git add . (2). å°†æ–‡ä»¶ä»æš‚å­˜åŒºä¸­æ’¤å‡ºï¼Œä½†ä¸ä¼šæ’¤é”€æ–‡ä»¶çš„æ›´æ”¹ git restore --staged (3). å°†ä¸åœ¨æš‚å­˜åŒºçš„æ–‡ä»¶æ’¤é”€æ›´æ”¹ï¼Œéœ€è¦å’Œ(2)ä½œåŒºåˆ†ï¼Œä¸¤è€…ä½œç”¨å®Œå…¨ä¸ä¸€æ ·ã€‚ git restore file æˆ– git checkout -- file (4). æ¯”è¾ƒæš‚å­˜åŒºå’Œå·¥ä½œåŒºæ–‡ä»¶ä¹‹é—´çš„å·®å¼‚ # æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¹‹é—´çš„å·®å¼‚ git diff [file] # æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€æ¬¡æäº¤çš„å·®å¼‚ git diff --cached [file] æˆ– git diff --staged [file] # æ˜¾ç¤ºä¸¤æ¬¡æäº¤çš„å·®å¼‚ è¯¥fileå¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥ï¼Œåˆ™æ˜¯æ¯”è¾ƒæš‚å­˜åŒºä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚æ³¨æ„ï¼Œå¦‚æœæš‚å­˜åŒºæ²¡æœ‰å†…å®¹ï¼Œåˆ™æ˜¯æ¯”è¾ƒHEADæŒ‡é’ˆæŒ‡å‘çš„ç‰ˆæœ¬åº“å†…å®¹ã€‚ (5). æŸ¥çœ‹ä»“åº“çŠ¶æ€ git status è¯¥å‘½ä»¤ç”¨äºæŸ¥çœ‹åœ¨ä½ ä¸Šæ¬¡æäº¤ä¹‹åæ˜¯å¦æœ‰å¯¹æ–‡ä»¶è¿›è¡Œå†æ¬¡ä¿®æ”¹ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è·å–ç®€çŸ­çš„è¾“å‡ºç»“æœï¼Œå¯æ·»åŠ -så‚æ•°æ¥å®ç°ã€‚ (6). æäº¤æš‚å­˜åŒºå†…å®¹åˆ°æœ¬åœ°ä»“åº“ æš‚å­˜åŒºçš„å†…å®¹å¯ä»¥é€šè¿‡git commitæ¥æäº¤åˆ°æœ¬åœ°ä»“åº“ã€‚ git commit [file1] [file2]...[fileN] -m [å¤‡æ³¨ä¿¡æ¯] å…¶ä¸­file1ç­‰æ˜¯å¯ä»¥ç›´æ¥çœç•¥çš„ï¼Œå¦‚æœæ„å‘³ç€æäº¤æ‰€æœ‰ä¿¡æ¯ï¼Œè€Œ-mæ˜¯å‚æ•°ï¼Œåé¢æ¥å¤‡æ³¨ä¿¡æ¯ã€‚å½“ç„¶ï¼Œåœ¨è¿›è¡Œgit commitä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡git addå‘½ä»¤å°†ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒºã€‚ (7). å›é€€ç‰ˆæœ¬ æˆ‘ä»¬å¯ä»¥é€šè¿‡git resetå‘½ä»¤æ¥å›é€€ç‰ˆæœ¬ï¼Œå¯ä»¥æŒ‡å®šé€€å›æŸä¸€æ¬¡æäº¤çš„ç‰ˆæœ¬ã€‚å…·ä½“å¦‚ä¸‹ï¼š # å°†ä»£ç åº“å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ git reset --hard HEAD^ æˆ– git reset --hard HEAD~ # å‘ä¸Šå›æ»šä¸¤æ¬¡ï¼Œä¸€æ¬¡ç±»æ¨ git reset --hard HEAD^^ # å‘ä¸Šå›æ»šnæ¬¡ã€‚ git rest --hard HEAD~n # å›æ»šåˆ°æŸä¸€ç‰¹å®šç‰ˆæœ¬ï¼Œç”¨ç‰ˆæœ¬å·å®ç°ï¼Œç‰ˆæœ¬å·å”¯ä¸€æ ‡è¯†ä¸€ä¸ªç‰ˆæœ¬ git reset --hard ç‰ˆæœ¬å· (8). åˆ é™¤æ–‡ä»¶ åœ¨Gitä¸­ï¼Œåˆ é™¤æ–‡ä»¶ä¹Ÿæ˜¯ä¸€ç§ä¿®æ”¹æ“ä½œï¼Œåˆ é™¤æ–‡ä»¶æœ‰ä¸‰ç§å½¢å¼ï¼š åˆ©ç”¨rm file å®ç°åˆ é™¤ï¼Œæ­¤å½¢å¼åªæ˜¯ä¼šåˆ é™¤å·¥ä½œåŒºçš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åˆ é™¤ç‰ˆæœ¬åº“çš„æ–‡ä»¶ï¼Œå¦‚æœè¿˜éœ€è¦åˆ é™¤ç‰ˆæœ¬åº“çš„æ–‡ä»¶è¿˜éœ€è¦æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å·¥ä½œåŒºå’Œç‰ˆæœ¬åº“çš„æ–‡ä»¶ï¼š git add file # åŠ å…¥æš‚å­˜åŒº git commit -m \"delete file\" åˆ©ç”¨git rm fileå®ç°åˆ é™¤ï¼Œä¼šåˆ é™¤å·¥ä½œåŒºçš„æ–‡ä»¶ï¼Œå¹¶ä¸”å°†æ­¤æ¬¡åˆ é™¤åŠ å…¥æš‚å­˜åŒºã€‚ä½†éœ€è¦æ³¨æ„è¦åˆ é™¤çš„æ–‡ä»¶æ˜¯æ²¡æœ‰ä¿®æ”¹è¿‡çš„ï¼Œå¦‚æœéœ€è¦åˆ é™¤ä¿®æ”¹è¿‡çš„ï¼Œéœ€è¦åŠ å…¥-fï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¹Ÿè¿˜æ²¡æœ‰åˆ é™¤ç‰ˆæœ¬åº“çš„æ–‡ä»¶ï¼Œåªæ˜¯æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œgit commit -m \"delete file\"å°±å¯ä»¥ã€‚ åˆ©ç”¨git rm --cached fileå®ç°åˆ é™¤ï¼Œåªä¼šåˆ é™¤æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œä½†ä¼šä¿ç•™å·¥ä½œåŒºçš„æ–‡ä»¶ï¼Œå¹¶ä¸”ä¼šå°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒºï¼Œç„¶åæˆ‘ä»¬æ‰§è¡Œgit commit -m \"delete file\"å°±å¯ä»¥å®ç°åˆ é™¤æš‚å­˜åŒºå’Œç‰ˆæœ¬åº“çš„æ–‡ä»¶ã€‚ (9). ç§»åŠ¨æˆ–è€…é‡å‘½åæ–‡ä»¶ git mv [file] [newFile]å¯ä»¥ç”¨æ¥ç§»åŠ¨æˆ–è€…é‡å‘½åä¸€ä¸ªæ–‡ä»¶ã€ç›®å½•æˆ–è€…è½¯è¿æ¥ã€‚å¦‚æœæ–°æ–‡ä»¶åå·²ç»å­˜åœ¨ï¼Œè¿˜éœ€è¦æ·»åŠ -få‚æ•°ã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:3:2","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.3 æŸ¥çœ‹æ—¥å¿— (1). æŸ¥çœ‹å½“å‰åˆ†æ”¯çš„æ‰€æœ‰ç‰ˆæœ¬ git logï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªå‘½ä»¤å†å²æäº¤è®°å½•ï¼Œå½“ç„¶è¿™ä¸ªå‘½ä»¤è¿˜æœ‰è®¸å¤šå‚æ•°ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼š --onelineï¼šæŸ¥çœ‹å†å²è®°å½•çš„ç®€æ´ç‰ˆæœ¬ã€‚ --graphï¼šæŸ¥çœ‹å†å²ä¸­ä»€ä¹ˆæ—¶å€™å‡ºç°äº†åˆ†æ”¯ã€åˆå¹¶ã€‚å¼€å¯æ‹“æ‰‘å›¾é€‰é¡¹ã€‚ --reverseï¼šé€†å‘æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—ã€‚ --author=userï¼šæŒ‡å®šæŸ¥çœ‹useræäº¤çš„éƒ¨åˆ†ã€‚ --sinceã€--beforeã€--afterç­‰ï¼šæŒ‡å®šæ—¥æœŸã€‚ (2). æŸ¥çœ‹HEADæŒ‡é’ˆçš„ç§»åŠ¨å†å²ï¼ˆåŒ…æ‹¬è¢«å›æ»šçš„ç‰ˆæœ¬ï¼‰ git reflog ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:3:3","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.4 åˆ†æ”¯ç®¡ç† å‡ ä¹æ¯ä¸€ç§ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿéƒ½ä»¥æŸç§å½¢å¼æ”¯æŒåˆ†æ”¯ã€‚ä½¿ç”¨åˆ†æ”¯æ„å‘³ç€ä½ å¯ä»¥ä»å¼€å‘ä¸»çº¿ä¸Šåˆ†ç¦»å¼€æ¥ï¼Œç„¶ååœ¨ä¸å½±å“ä¸»çº¿çš„åŒæ—¶ç»§ç»­å·¥ä½œã€‚ æœ‰äººæŠŠ Git çš„åˆ†æ”¯æ¨¡å‹ç§°ä¸ºå¿…æ€æŠ€ç‰¹æ€§ï¼Œè€Œæ­£æ˜¯å› ä¸ºå®ƒï¼Œå°† Git ä»ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå®¶æ—é‡ŒåŒºåˆ†å‡ºæ¥ã€‚ (1). åˆ›å»ºåˆ†æ”¯ git branch (branchName) (2). åˆ‡æ¢åˆ†æ”¯ git checkout (branchName) å½“ä½ åˆ‡æ¢åˆ†æ”¯çš„æ—¶å€™ï¼ŒGit ä¼šç”¨è¯¥åˆ†æ”¯çš„æœ€åæäº¤çš„å¿«ç…§æ›¿æ¢ä½ çš„å·¥ä½œç›®å½•çš„å†…å®¹ï¼Œ æ‰€ä»¥å¤šä¸ªåˆ†æ”¯ä¸éœ€è¦å¤šä¸ªç›®å½•ã€‚ æ·»åŠ -bå‚æ•°å¯ä»¥åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯ã€‚ (3). åˆå¹¶åˆ†æ”¯ git merge (branchName) å°†branch_nameåˆå¹¶åˆ°å½“å‰åˆ†æ”¯ä¸Šã€‚ (4) åˆ é™¤åˆ†æ”¯ git branch -d (branchName) åˆ é™¤æœ¬åœ°ä»“åº“çš„branchNameåˆ†æ”¯ã€‚ (5). åˆ—å‡ºåˆ†æ”¯ git branch æ²¡æœ‰å‚æ•°æ—¶ï¼Œgit branchä¼šåˆ—å‡ºä½ åœ¨æœ¬åœ°çš„åˆ†æ”¯ã€‚ (6). åˆå¹¶å†²çª åˆå¹¶å¹¶ä¸ä»…ä»…æ˜¯ç®€å•çš„æ–‡ä»¶æ·»åŠ ã€ç§»é™¤çš„æ“ä½œã€‚Gitä¹Ÿä¼šåˆå¹¶ä¿®æ”¹ï¼Œå½“ä¸¤ä¸ªåˆ†æ”¯å¯¹åŒä¸€ä¸ªæ–‡ä»¶éƒ½è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿåˆå¹¶å†²çªï¼Œæˆ‘ä»¬éœ€è¦å»æ‰‹åŠ¨ä¿®æ”¹å®ƒã€‚ç„¶åéœ€è¦ä½¿ç”¨git addå‘½ä»¤æ¥å‘Šè¯‰Gitå†²çªå·²ç»è§£å†³äº†ã€‚ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:3:4","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.5 è¿œç¨‹æ“ä½œ (1). å°†æœ¬åœ°ä»“åº“å…³è”åˆ°è¿œç¨‹ä»“åº“ git remote add [short-name] [url] å…¶ä¸­short-nameæŒ‡å®šä¸€ä¸ªæ–¹ä¾¿ä½¿ç”¨çš„ç®€å†™ï¼Œä¸ºè¿œç¨‹ä»“åº“çš„åˆ«åã€‚ä¾‹å¦‚git remote add origin git@git.acwing.com:unique_pursuit/test.git å³å¯æ·»åŠ è¿œç¨‹ä»“åº“ã€‚ (2). æŸ¥çœ‹å½“å‰é…ç½®æœ‰å“ªäº›è¿œç¨‹åº“ git remote æ‰§è¡Œæ—¶æ·»åŠ ä¸Š-vå‚æ•°å¯æŸ¥çœ‹åˆ°æ¯ä¸ªåˆ«åçš„å®é™…é“¾æ¥åœ°å€ã€‚ (3). åˆ é™¤è¿œç¨‹ä»“åº“ git remote rm name å…¶ä¸­nameä¸ºä»“åº“çš„åˆ«åã€‚ (4). ä¿®æ”¹ä»“åº“å git remote rename old_name new_name (5). æŸ¥çœ‹ä¸»æœºçš„è¯¦ç»†ä¿¡æ¯ git remote show \u003cä¸»æœºå\u003e (6) è®¾ç½®æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹ä»“åº“åˆ†æ”¯å¯¹åº” git push --set-upstream \u003cè¿œç¨‹ä¸»æœºå\u003e \u003cbranchName\u003e è®¾ç½®æœ¬åœ°çš„branchNameåˆ†æ”¯å¯¹åº”è¿œç¨‹ä»“åº“çš„branchNameåˆ†æ”¯ï¼Œè¿œç¨‹ä¸»æœºåä¸ºgit cloneè®¾ç½®çš„ä»“åº“åˆ«åã€‚ git branch --set-upstream-to=origin/branchName1 branchName2 å°†è¿œç¨‹ä»“åº“çš„branchName1åˆ†æ”¯ä¸æœ¬åœ°çš„branchName2åˆ†æ”¯å¯¹åº”ã€‚ (7). å°†æœ¬åœ°å½“å‰åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä¸»æœº git push \u003cè¿œç¨‹ä¸»æœºå\u003e \u003cæœ¬åœ°åˆ†æ”¯å\u003e:\u003cè¿œç¨‹åˆ†æ”¯å\u003e å¦‚æœæœ¬åœ°åˆ†æ”¯åå’Œè¿œç¨‹åˆ†æ”¯åç›¸åŒï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚ git push \u003cè¿œç¨‹ä¸»æœºå\u003e \u003cbranchName\u003e å°†æœ¬åœ°çš„branchNameåˆ†æ”¯æ¨åˆ°è¿œç¨‹ä»“åº“ï¼Œåœ¨æ­¤ä¹‹å‰éœ€è¦å…ˆè®¾ç½®ä¸è¿œç¨‹ä»“åº“å¯¹åº”åˆ†æ”¯ã€‚ å¦‚æœå½“å‰åˆ†æ”¯ä¸å¤šä¸ªä¸»æœºå­˜åœ¨è¿½è¸ªå…³ç³»ï¼Œéœ€è¦ä½¿ç”¨-uå‚æ•°æŒ‡å®šä¸€ä¸ªé»˜è®¤ä¸»æœºï¼Œè¿™æ ·åé¢å¯ä»¥ä¸åŠ ä»»ä½•å‚æ•°ä½¿ç”¨git push ã€‚ (8). åˆ é™¤è¿œç¨‹ä»“åº“çš„branchNameåˆ†æ”¯ git push -d \u003cè¿œç¨‹ä¸»æœºå\u003e branchName (9). å°†è¿œç¨‹ä»“åº“çš„åˆ†æ”¯ä¸æœ¬åœ°ä»“åº“çš„åˆ†æ”¯åˆå¹¶ git pull \u003cè¿œç¨‹ä¸»æœºå\u003e \u003cè¿œç¨‹åˆ†æ”¯å\u003e:\u003cæœ¬åœ°åˆ†æ”¯å\u003e å¦‚æœæœ¬åœ°åˆ†æ”¯åå’Œè¿œç¨‹åˆ†æ”¯åç›¸åŒï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚ git push \u003cè¿œç¨‹åˆ†æ”¯å\u003e \u003cbranchName\u003e ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:3:5","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.6 ä¿å­˜å’Œæ¢å¤è¿›åº¦ æˆ‘ä»¬æœ‰æ—¶ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œæ­£åœ¨devåˆ†æ”¯å¼€å‘æ–°åŠŸèƒ½ï¼Œåšåˆ°ä¸€åŠæ—¶æœ‰äººè¿‡æ¥åé¦ˆä¸€ä¸ªbugï¼Œè®©é©¬ä¸Šè§£å†³ï¼Œä½†æ˜¯æ–°åŠŸèƒ½åšåˆ°äº†ä¸€åŠä½ åˆä¸æƒ³æäº¤ï¼Œåˆæƒ³ä¿å­˜å®ƒï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨git stashå‘½ä»¤å…ˆæŠŠè¿›åº¦ä¿å­˜èµ·æ¥ã€‚ (1). ä¿å­˜å½“å‰å·¥ä½œè¿›åº¦ git stash å°†å·¥ä½œåŒºå’Œæš‚å­˜åŒºå°šæœªæäº¤çš„ä¿®æ”¹å­˜å…¥æ ˆä¸­ã€‚å†è¿è¡Œgit statuså¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªå¹²å‡€çš„å·¥ä½œåŒºï¼Œæ²¡æœ‰ä»»ä½•æ”¹åŠ¨ã€‚ä½¿ç”¨git stash save 'message'å¯ä»¥æ·»åŠ ä¸€äº›æ³¨é‡Š (2). æ¢å¤å·¥ä½œè¿›åº¦ æ¢å¤æœ€æ–°çš„è¿›åº¦åˆ°å·¥ä½œåŒºã€‚gitä¼šé»˜è®¤æŠŠå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„æ”¹åŠ¨éƒ½æ¢å¤åˆ°å·¥ä½œåŒºã€‚ git stash pop æ¢å¤æœ€æ–°çš„è¿›åº¦åˆ°å·¥ä½œåŒºå’Œæš‚å­˜åŒºã€‚ git stash pop --index æ¢å¤æŒ‡å®šçš„è¿›åº¦åˆ°å·¥ä½œåŒºã€‚ git stash pop stash_id å…¶ä¸­stash_idæ˜¯é€šè¿‡git stash listè·å–çš„ã€‚ é€šè¿‡git stash popæ¢å¤è¿›åº¦åï¼Œä¼šåˆ é™¤å½“å‰è¿›åº¦ã€‚ è¿˜æœ‰ä¸€ä¸ªgit stash applyå‘½ä»¤é™¤äº†ä¸åˆ é™¤è¿›åº¦ï¼Œå…¶ä»–å’Œgit stash popä¸€æ ·ã€‚ (3). æ˜¾ç¤ºä¿å­˜è¿›åº¦çš„åˆ—è¡¨ git stash list (4) åˆ é™¤è¿›åº¦ åˆ é™¤æ‰€æœ‰è¿›åº¦ git stash clear åˆ é™¤ä¸€ä¸ªå­˜å‚¨çš„è¿›åº¦ï¼Œå¦‚æœä¸æŒ‡å®šstash_idï¼Œåˆ™é»˜è®¤åˆ é™¤æœ€æ–°çš„è¿›åº¦ã€‚ git stash drop [stash_id] ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:3:6","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"4 Gitç”¨æ³•æ€ç»´å¯¼å›¾ ","date":"2022-01-26","objectID":"/posts/02.git%E6%95%99%E7%A8%8B/:4:0","tags":["Git"],"title":"Gitæ•™ç¨‹","uri":"/posts/02.git%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1 SSHåŸºæœ¬çŸ¥è¯† ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:1:0","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.1 SSHæ˜¯ä»€ä¹ˆ SSHä¸ºSecure Shellçš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œç”¨äºåŠ å¯†ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡ï¼Œä¿è¯ä¸è¢«çªƒå¬æˆ–ç¯¡æ”¹ï¼Œå¹¶ä¸”æ”¯æŒå„ç§èº«ä»½éªŒè¯æœºåˆ¶ã€‚åœ¨äº‹åŠ¡ä¸­ï¼Œå®ƒä¸»è¦ç”¨æˆ·ä¿è¯è¿œç¨‹ç™»å½•è´ºè¿œç¨‹é€šä¿¡çš„å®‰å…¨ï¼Œä»»ä½•ç½‘ç»œæœåŠ¡éƒ½å¯ä»¥ç”¨è¿™ä¸ªåè®®æ¥åŠ å¯†ã€‚ ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:1:1","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.2 SSHæ¶æ„ SSHçš„è½¯ä»¶æ¶æ„æ˜¯C/Sæ¨¡å¼ï¼Œå³å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å¼ã€‚åœ¨è¿™ä¸ªæ¶æ„ä¸­ï¼ŒSSHè½¯ä»¶åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼šå‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚çš„éƒ¨åˆ†ï¼Œç§°ä¸ºå®¢æˆ·ç«¯ï¼ŒOpenSSHçš„å®ç°ä¸ºsshï¼›æ¥å—å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚çš„éƒ¨åˆ†ï¼Œç§°ä¸ºæœåŠ¡å™¨ï¼ŒOpenSSHçš„å®ç°ä¸ºsshdã€‚ å…¶ä¸­å¤§å†™çš„SSHè¡¨ç¤ºåè®®ï¼Œå°å†™çš„sshè¡¨ç¤ºå®¢æˆ·ç«¯è½¯ä»¶ã€‚ OpenSSHçš„å®¢æˆ·ç«¯æ˜¯äºŒè¿›åˆ¶ç¨‹åºsshã€‚å®ƒåœ¨Linux/Unixç³»ç»Ÿçš„ä½ç½®æ˜¯/usr/local/bin/sshï¼Œwindowsç³»ç»Ÿçš„ä½ç½®æ˜¯/Program Files/OpenSSH/bin/ssh.exeã€‚Linuxç³»ç»Ÿä¸€èˆ¬éƒ½è‡ªå¸¦sshï¼Œå¦‚æœæ²¡æœ‰åˆ™éœ€è¦è‡ªå·±å®‰è£…ã€‚å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š # Ubuntu å’Œ Debian sudo apt install openssh-client # CentOS å’Œ Fedora sudo dnf install openssh-clients ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:1:2","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2 sshç™»å½• ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:2:0","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.1 åŸºæœ¬ç”¨æ³• è¿œç¨‹ç™»å½•æœåŠ¡å™¨æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š ssh hostname # æ²¡æœ‰æŒ‡å®šç”¨æˆ·åï¼Œå°†ä½¿ç”¨å®¢æˆ·ç«¯çš„å½“å‰ç”¨æˆ·å ssh user@hostname # æŒ‡å®šç”¨æˆ·å ssh user@hostname -p 22 # ç™»å½•ç«¯å£ä¸º22ï¼Œä½¿ç”¨-på¯ä»¥ç™»å½•åˆ°æŸä¸€ç‰¹å®šçš„ç«¯å£ã€‚ å…¶ä¸­userä¸ºç”¨æˆ·åï¼Œhostnameä¸ºIPåœ°å€æˆ–åŸŸå ç¬¬ä¸€æ¬¡ç™»å½•æ—¶ä¼šæç¤ºï¼š The authenticity of host '123.57.47.211 (123.57.47.211)' can't be established. ECDSA key fingerprint is SHA256:iy237yysfCe013/l+kpDGfEG9xxHxm0dnxnAbJTPpG8. Are you sure you want to continue connecting (yes/no/[fingerprint])? ä¸Šè¿°è¿™æ®µæ–‡å­—å‘Šè¯‰ç”¨æˆ·ï¼Œè¿™å°æœåŠ¡å™¨çš„æŒ‡çº¹æ˜¯é™Œç”Ÿçš„ï¼Œè®©ç”¨æˆ·é€‰æ‹©æ˜¯å¦è¦ç»§ç»­è¿æ¥ï¼ˆè¾“å…¥yesæˆ–noï¼‰ã€‚ æ‰€è°“â€œæœåŠ¡å™¨æŒ‡çº¹â€ï¼ŒæŒ‡çš„æ˜¯ SSH æœåŠ¡å™¨å…¬é’¥çš„å“ˆå¸Œå€¼ã€‚æ¯å° SSH æœåŠ¡å™¨éƒ½æœ‰å”¯ä¸€ä¸€å¯¹å¯†é’¥ï¼Œç”¨äºè·Ÿå®¢æˆ·ç«¯é€šä¿¡ï¼Œå…¶ä¸­å…¬é’¥çš„å“ˆå¸Œå€¼å°±å¯ä»¥ç”¨æ¥è¯†åˆ«æœåŠ¡å™¨ã€‚ è¾“å…¥yesï¼Œç„¶åå›è½¦å³å¯ã€‚è¿™æ ·ä¼šå°†æœåŠ¡å™¨çš„ä¿¡æ¯è®°å½•åœ¨~/.ssh//known_hostsæ–‡ä»¶ä¸­ï¼Œç„¶åè¾“å…¥å¯†ç å³å¯ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚ åœ¨~/.ssh/known_hostsæ–‡ä»¶ä¸­ä¿å­˜äº†æœ¬æœºè¿æ¥è¿‡çš„æ‰€æœ‰æœåŠ¡å™¨çš„å…¬é’¥æŒ‡çº¹ä¿¡æ¯ï¼Œæ¯æ¬¡é€šè¿‡sshè¿æ¥ä¸€å°æœåŠ¡å™¨ï¼Œç³»ç»Ÿä¼šé€šè¿‡è¯¥æ–‡ä»¶åˆ¤æ–­å½“å‰éœ€è¦è¿æ¥çš„æœåŠ¡å™¨æ˜¯å¦ä¸ºé™Œç”Ÿä¸»æœºã€‚è€Œå¦‚æœä¹‹å‰sshç™»é™†è¿‡çš„æœåŠ¡å™¨çš„å¯†é’¥å‘ç”Ÿäº†æ›´æ”¹ï¼Œé‚£ä¹ˆç™»å½•å°±ä¼šæ”¶åˆ°æç¤ºHost key verification failedï¼Œç”±äºå‘ç”Ÿæ”¹å˜äº†ï¼Œæ‰€ä»¥è¥¿æˆ‘ä»¬éœ€è¦åˆ é™¤ä¹‹å‰çš„ä¸»æœºçš„æŒ‡çº¹ä¿¡æ¯ï¼Œæ·»åŠ æ–°çš„ã€‚è¿™ä¸ªå¯ä»¥ä½¿ç”¨ssh-keygen -R \u003chostname\u003eæ¥è¿›è¡Œåˆ é™¤ã€‚ å¦‚æœæˆ‘ä»¬éœ€è¦é€€å‡ºç™»å½•ï¼Œè¾“å…¥logoutæˆ–exitéƒ½å¯ä»¥å®ç°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ·é”®Ctrl+dé€€å‡ºã€‚ ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:2:1","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.2 é…ç½®æ–‡ä»¶ åˆ›å»ºæ–‡ä»¶~/.ssh/configï¼Œæ­¤ä¸ºç”¨æˆ·çš„ä¸ªäººé…ç½®æ–‡ä»¶ï¼Œå…¶ä¿å­˜ç›¸å…³é…ç½®ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ–‡ä»¶ä¸­è¾“å…¥ï¼š Host myServer1 HostName IPåœ°å€æˆ–åŸŸå User ç”¨æˆ·å Host myServer2 HostName IPåœ°å€æˆ–åŸŸå User ç”¨æˆ·å ä¹‹åå†ä½¿ç”¨æœåŠ¡å™¨æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨åˆ«åmyServer1ã€myServer2è¿›è¡Œç™»å½•ã€‚ SSHå®¢æˆ·ç«¯çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸º/etc/ssh/ssh_configï¼Œå…¶ä¼˜å…ˆçº§ä½äºç”¨æˆ·ä¸ªäººé…ç½®æ–‡ä»¶ã€‚é™¤äº†é…ç½®æ–‡ä»¶ï¼Œ~/.sshè¿˜æœ‰ä¸€äº›ç”¨æˆ·ä¸ªäººçš„å¯†é’¥æ–‡ä»¶å’Œå…¶ä»–æ–‡ä»¶ ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:2:2","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2.3 å¯†é’¥ç™»å½• åˆ›å»ºå¯†é’¥ é¦–å…ˆåœ¨æœ¬å°ä¸»æœºä¸Šåˆ›å»ºå¯†é’¥ï¼Œè¾“å…¥ssh-keygenæŒ‡ä»¤ï¼Œç„¶åä¸€ç›´å›è½¦å³å¯ã€‚è¯¥å‘½ä»¤ä¼šä¸ºæœ¬æœºç”Ÿæˆå…¬ç§é’¥å¯¹ï¼Œé€šè¿‡å¯†é’¥æ¥è¿›è¡Œè¿œç¨‹ç™»å½•çš„éªŒè¯æœºåˆ¶ä½¿ç”¨äº†å¯†ç å­¦ä¸­çš„éå¯¹ç§°åŠ å¯†ä½“ç³»ã€‚æ‰§è¡Œå‘½ä»¤åï¼Œä¼šåœ¨~/.ssh/æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–°çš„æ–‡ä»¶ï¼š 1. `id_rsa`ï¼šç§é’¥ 2. `id_rsa.pub`ï¼šå…¬é’¥ æ³¨æ„ï¼Œä¸€å®šè¦ä¿æŠ¤å¥½ç”Ÿæˆçš„ç§é’¥`id_rsa`ï¼Œä¸€æ—¦æš´éœ²ï¼Œåˆ©ç”¨ä¸Šè¿°æŒ‡ä»¤å¯ä»¥é‡æ–°ç”Ÿæˆæ–°çš„å¯†é’¥ã€‚ å…å¯†ç™»å½• å¦‚æœæƒ³è¦å…å¯†ç™»å½•æŸä¸ªæœåŠ¡å™¨ï¼Œæˆ‘ä»¬åªéœ€è¦å°†åˆšæ‰ç”Ÿæˆçš„å…¬é’¥ä¿å­˜åœ¨éœ€è¦ç™»å½•çš„è¿œç¨‹æœåŠ¡å™¨~/.ssh/authorized_keysæ–‡ä»¶ä¸­ã€‚ä¾‹å¦‚æˆ‘æƒ³å…å¯†ç™»å½•åˆ°myServer1æœåŠ¡å™¨ï¼Œåˆ™å°†~/.ssh/id_rsa.pubå…¬é’¥ä¸­çš„å†…å®¹ï¼Œå¤åˆ¶åˆ°myServer1ä¸­çš„~/.ssh/authorized_keysæ–‡ä»¶ä¸­ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸€é”®æ·»åŠ å…¬é’¥ï¼š ssh-copy-id myServer1ã€‚ ç¬¬ä¸€æ¬¡åº”ç”¨ssh-copy-idç³»ç»Ÿä¼šæç¤ºè¾“å…¥è¿œç¨‹æœåŠ¡å™¨çš„å¯†ç ï¼Œä¹‹åç™»å½•æ—¶å°±å¯ä»¥å…å¯†ç™»å½•äº†ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨å¯†é’¥ç™»å½•æ¯”ä½¿ç”¨å¯†ç ç™»å½•æ›´åŠ å®‰å…¨ï¼Œæ‰€ä»¥å¯ç”¨å¯†é’¥ç™»å½•ä¹‹åï¼Œæœ€å¥½å…³é—­æœåŠ¡å™¨çš„å¯†ç ç™»å½•ã€‚å¦‚æœéœ€è¦åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šå…³é—­å¯†ç ç™»å½•ã€‚å…·ä½“æ–¹æ³•æ˜¯å…ˆè¿œç¨‹ç™»å½•åˆ°æœåŠ¡å™¨ä¸­ï¼Œç„¶åæ‰¾åˆ°sshdçš„é…ç½®æ–‡ä»¶/etc/ssh/sshd_configï¼Œæœ€åå°†PasswordAuthenticationè¿™ä¸€é¡¹è®¾ç½®ä¸ºnoã€‚ PasswordAuthentication no sshdæ˜¯æœåŠ¡å™¨è¿è¡Œçš„åå°è¿›ç¨‹ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹é…ç½®æ–‡ä»¶ä»¥åï¼Œéœ€è¦é‡æ–°å¯åŠ¨sshdï¼Œç„¶åä¿®æ”¹æ‰èƒ½ç”Ÿæ•ˆã€‚å¯åº”ç”¨ä¸‹é¢è¯­å¥é‡å¯è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„sshå’ŒsshdæœåŠ¡ã€‚ sudo systemctl restart ssh.service sudo systemctl restart sshd.service æ‰§è¡Œè¿œç¨‹å‘½ä»¤ å…å¯†ç™»å½•åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸‹ç›´æ¥æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼šssh user@hostname commandã€‚è¿™æ ·çš„å‘½ä»¤ä¼šä½¿SSHåœ¨ç™»å½•æˆåŠŸåï¼Œç«‹åˆ»åœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤comandã€‚ä½†å¹¶ä¸æ˜¯çœŸæ­£çš„ç™»å½•ï¼Œæ‰§è¡Œå®Œå‘½ä»¤åè¿˜åœ¨åŸä¸»æœºã€‚ æµ‹è¯•ï¼šssh myServer1 ls ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:2:3","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3 scpä¼ æ–‡ä»¶ ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:3:0","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.1 scpå‘½ä»¤ç®€ä»‹ scpæ˜¯secure copyçš„ç¼©å†™ï¼Œç›¸å½“äºcpå‘½ä»¤+SSHã€‚å®ƒçš„åº•å±‚æ˜¯SSHåè®®ï¼Œé»˜è®¤ç«¯å£æ˜¯22ï¼Œç›¸å½“äºå…ˆä½¿ç”¨sshå‘½ä»¤ç™»å½•è¿œç¨‹ä¸»æœºï¼Œç„¶åå†è¿›è¡Œæ‹·è´æ“ä½œã€‚ scpä¸»è¦ç”¨äºä»¥ä¸‹ä¸‰ç§å¤åˆ¶æ“ä½œï¼š æœ¬åœ°å¤åˆ¶åˆ°è¿œç¨‹ã€‚ è¿œç¨‹å¤åˆ¶åˆ°æœ¬åœ°ã€‚ ä¸¤ä¸ªè¿œç¨‹ç³»ç»Ÿä¹‹é—´çš„å¤åˆ¶ã€‚ ä½¿ç”¨scpä¼ è¾“æ•°æ®æ—¶ï¼Œæ–‡ä»¶å’Œå¯†ç éƒ½æ˜¯åŠ å¯†çš„ï¼Œä¸ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚ ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:3:1","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"3.2 åŸºæœ¬è¯­æ³• scpçš„è¯­æ³•ç±»ä¼¼cpçš„è¯­æ³•ã€‚ scp source destination ä¸Šé¢å‘½ä»¤ä¸­ï¼Œsourceæ˜¯æ–‡ä»¶å½“å‰çš„ä½ç½®ï¼Œdestinationæ˜¯æ–‡ä»¶æ‰€è¦å¤åˆ¶åˆ°çš„ä½ç½®ã€‚å®ƒä»¬éƒ½å¯ä»¥åŒ…å«ç”¨æˆ·åå’Œä¸»æœºåã€‚ä¾‹å¦‚ï¼š scp myServer1:main.cpp main.cpp ä¸Šé¢å‘½ä»¤å³æ˜¯å°†è¿œç¨‹ä¸»æœºï¼ˆmyServer1ï¼‰ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„main.cppå¤åˆ¶ä¸ºæœ¬æœºå½“å‰ç›®å½•ä¸‹çš„main.cppã€‚æ³¨æ„ä¸»æœºä¸æ–‡ä»¶ä¹‹é—´è¦ä½¿ç”¨:åˆ†éš”ã€‚ scpä¼šå…ˆç”¨SSHç™»å½•åˆ°è¿œç¨‹ä¸»æœºï¼Œç„¶ååœ¨åŠ å¯†è¿æ¥ä¹‹ä¸­å¤åˆ¶æ–‡ä»¶ã€‚å®¢æˆ·ç«¯å‘èµ·è¿æ¥åï¼Œä¼šæç¤ºç”¨æˆ·è¾“å…¥å¯†ç ã€‚å…¶ä¸­ç”¨æˆ·åå’Œä¸»æœºåè‹¥çœç•¥åˆ™æ˜¯ä»£è¡¨å½“å‰ä¸»æœºä¸‹çš„å½“å‰ç”¨æˆ·åã€‚ scpæ”¯æŒä¸€æ¬¡å¤åˆ¶å¤šä¸ªæ–‡ä»¶ã€‚scp source1 source2 destinationã€‚å¦‚æœå­˜åœ¨åŒåæ–‡ä»¶ï¼Œscpä¼šåœ¨æ²¡æœ‰è­¦å‘Šçš„æƒ…å†µä¸‹è¦†ç›–åŒåæ–‡ä»¶ã€‚ ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:3:2","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"4 å‚è€ƒæ–‡çŒ® LinuxåŸºç¡€è¯¾ èœé¸Ÿæ•™ç¨‹ ","date":"2022-01-23","objectID":"/posts/02.ssh%E6%95%99%E7%A8%8B/:4:0","tags":["SSH"],"title":"SSHæ•™ç¨‹","uri":"/posts/02.ssh%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 Shellæ¦‚è®º Shellæ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œå®ƒè¯ç”ŸäºUnixï¼Œæ˜¯æˆ‘ä»¬é€šè¿‡å‘½ä»¤è¡Œä¸Unix/Linuxäº¤äº’çš„å·¥å…·ã€‚ç¬¼ç»Ÿåœ°è¯´ï¼šShellæ—¢æ˜¯ä¸€ç§å‘½ä»¤è¯­è¨€ï¼Œåˆæ˜¯ä¸€ç§ç¨‹åºè®¾è®¡è¯­è¨€ã€‚ è€ŒShellè„šæœ¬æ˜¯ä¸€ç§ä¸ºShellç¼–å†™çš„è„šæœ¬ç¨‹åºï¼Œæœ‰çš„æ—¶å€™ä¹Ÿè¢«ç§°ä¸ºShellï¼ˆä½†äºŒè€…æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ¦‚å¿µï¼ï¼‰ï¼Œå®ƒå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å°†ä¸€å¥—é€»è¾‘ç»„ç»‡æˆä¸€ä¸ªæ–‡ä»¶ï¼Œæ–¹ä¾¿å¤ç”¨ã€‚ Acwingç½‘ç«™æä¾›ç»™çš„AC Terminalä¸­çš„å‘½ä»¤è¡Œå°±å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªâ€œShellè„šæœ¬åœ¨é€è¡Œæ‰§è¡Œâ€ã€‚ Unix/Linuxç³»ç»Ÿä¸­å¸¸è§çš„shellè„šæœ¬æœ‰å¾ˆå¤šï¼š Bourne Shellï¼ˆ/usr/bin/shæˆ–/bin/shï¼‰ Bourne Again Shellï¼ˆ/bin/bashï¼‰ C Shellï¼ˆ/usr/bin/cshï¼‰ K Shellï¼ˆ/usr/bin/kshï¼‰ Shell for Rootï¼ˆ/sbin/shï¼‰ ç”±äºLinuxç³»ç»Ÿä¸­ä¸€èˆ¬é»˜è®¤ä½¿ç”¨bashï¼Œè€Œä¸”å…¶æ˜“ç”¨å…è´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥å­¦ä¹ bashä¸­çš„è¯­æ³•ã€‚ è„šæœ¬ç¤ºä¾‹ è¿›å…¥ç»ˆç«¯ï¼Œæ–°å»ºä¸€ä¸ªhello.shæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š #! /bin/bash echo \"Hello, World!\" è¯´æ˜ï¼š shåç¼€åˆ™è¡¨ç¤ºè¯¥æ–‡ä»¶æ˜¯Shellè„šæœ¬æ–‡ä»¶ã€‚ #!å‘Šè¯‰ç³»ç»Ÿè¿™ä¸ªè„šæœ¬ç”¨ä»€ä¹ˆè§£é‡Šå™¨æ¥æ‰§è¡Œï¼Œåé¢æ‰€è·Ÿçš„å°±æ˜¯ä½ æ‰€éœ€è¦ç”¨çš„è§£é‡Šå™¨ã€‚è¿™ä¸ªä¸€èˆ¬éƒ½éœ€è¦æ·»åŠ ä¸Šï¼Œå…·ä½“è§£é‡Šè§è¿è¡Œã€‚ echoæŒ‡ä»¤ç”¨äºå­—ç¬¦ä¸²çš„è¾“å‡ºï¼Œæ‰€ä»¥è¿è¡Œè¯¥æ–‡ä»¶ä¼šè¾“å‡ºHello,Worldã€‚ è¿è¡Œæ–¹å¼ï¼š ä½œä¸ºå¯æ‰§è¡Œæ–‡ä»¶ è¯¥æ–¹æ³•å°†hello.shä½œä¸ºå¯æ‰§è¡Œç¨‹åºè¿è¡Œï¼Œç”±äºæœªæŒ‡å®šè§£é‡Šå™¨ï¼Œæ‰€ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ç¬¬ä¸€è¡Œä¸€å®šè¦æŒ‡å®šè§£é‡Šå™¨ã€‚ #! /bin/bash chmod +x hello.sh #ä½¿è„šæœ¬å…·æœ‰å¯æ‰§è¡Œæƒé™ï¼› ./hello.sh #å½“å‰è·¯å¾„ä¸‹æ‰§è¡Œ ç”¨è§£é‡Šå™¨æ‰§è¡Œ è¯¥æ–¹æ³•ç›´æ¥è¿è¡Œè§£é‡Šå™¨ï¼Œæ­¤æ—¶hello.shä½œä¸ºShellè§£é‡Šå™¨çš„å‚æ•°ã€‚æ­¤æ—¶Shellè„šæœ¬å°±ä¸éœ€è¦æŒ‡å®šè§£é‡Šå™¨ä¿¡æ¯ï¼Œåˆ™ä¸éœ€è¦ç¬¬ä¸€è¡Œçš„æ³¨é‡Šäº†ã€‚ bash hello.sh #å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ç¼©å†™ sh hello.sh è¾“å‡ºï¼š ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:1:0","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 Shellè¯­æ³• ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:0","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 æ³¨é‡Š å•è¡Œæ³¨é‡Š æ¯ä¸€è¡Œä¸­#ä¹‹åçš„å†…å®¹å‡æ˜¯æ³¨é‡Šã€‚ # è¿™æ˜¯ä¸€è¡Œæ³¨é‡Š echo \"Hello, World\" # è¿™ä¹Ÿæ˜¯ä¸€è¡Œæ³¨é‡Š å¤šè¡Œæ³¨é‡Š Shellä¸­çš„å¤šè¡Œæ³¨é‡Šæœ‰ç‚¹ç‰¹åˆ«ï¼Œæ ¼å¼ä¸ºï¼š :\u003c\u003cEOF ç¬¬ä¸€è¡Œæ³¨é‡Š ... ç¬¬nè¡Œæ³¨é‡Š EOF å…¶ä¸­EOFå¯ä»¥æ›¿æ¢æˆå…¶ä»–ä»»æ„å­—ç¬¦ä¸²ï¼Œå¦‚ï¼š :\u003c\u003c! ç¬¬ä¸€è¡Œæ³¨é‡Š ... ç¬¬nè¡Œæ³¨é‡Š ! ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:1","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 å˜é‡ å®šä¹‰å˜é‡ å®šä¹‰å˜é‡æ—¶ï¼Œå˜é‡åä¸åŠ ç¾å…ƒç¬¦å·$ï¼ŒåŒæ—¶ç‰¹åˆ«éœ€è¦æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯å˜é‡åä¸ç­‰å·ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ï¼ˆå¦‚æœæœ‰è‡ªåŠ¨æ‰“ç©ºæ ¼çš„ä¹ æƒ¯åœ¨è¿™é‡Œæœ€å¥½å…‹åˆ¶ï¼‰ã€‚shellä¸­çš„å˜é‡å‘½ååŒæ ·é¡»éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š å‘½ååªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé¦–ä¸ªå­—ç¬¦ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ã€‚ ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ _ã€‚ ä¸èƒ½ä½¿ç”¨æ ‡ç‚¹ç¬¦å·ã€‚ ä¸èƒ½ä½¿ç”¨bashé‡Œçš„å…³é”®å­—ï¼ˆå¯ç”¨helpå‘½ä»¤æŸ¥çœ‹ä¿ç•™å…³é”®å­—ï¼‰ã€‚ å¦‚ä¸‹ï¼š # æœ‰æ•ˆçš„Shellå˜é‡åç§° _var var123 LF_DDFHI_X # æ— æ•ˆçš„Shellå˜é‡åç§° ?var 123abc echo å’Œç°åœ¨å¤§å¤šæ•°çš„è¯­è¨€ä¸€æ ·ï¼ŒShellå®šä¹‰å˜é‡ä¸éœ€è¦æŒ‡å®šå˜é‡ç±»å‹ï¼Œå¦‚ä¸‹ï¼š name1=\"a\" #å•å¼•å·å®šä¹‰å­—ç¬¦ä¸² name2='a' #åŒå¼•å·å®šä¹‰å­—ç¬¦ä¸² name3=a #ä¹Ÿå¯ä»¥ä¸åŠ å¼•å·ï¼ŒåŒæ ·è¡¨ç¤ºå­—ç¬¦ä¸² åœ¨Bash shellä¸­ï¼Œæ¯ä¸€ä¸ªå˜é‡çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œæ— è®ºä½ ç»™å˜é‡èµ‹å€¼ç”¨çš„æ—¶å•å¼•å·åŒå¼•å·è¿˜æ˜¯æ²¡æœ‰ä½¿ç”¨å¼•å·ï¼Œéƒ½æ˜¯ä½¿ç”¨å­—ç¬¦ä¸²çš„iå½¢å¼å­˜å‚¨çš„ï¼Œè¿™å¾ˆç‰¹æ®Šã€‚ä¸²çš„iå½¢å¼å­˜å‚¨çš„ï¼Œè¿™å¾ˆç‰¹æ®Šã€‚ä¸²çš„iå½¢å¼å­˜å‚¨çš„ï¼Œè¿™å¾ˆç‰¹æ®Šã€‚ä¸²çš„iå½¢å¼å­˜å‚¨çš„ï¼Œè¿™å¾ˆç‰¹æ®Šã€‚ ä½¿ç”¨å˜é‡ ä½¿ç”¨å˜é‡æˆ‘ä»¬éœ€è¦åŠ ä¸Š$ç¬¦å·æˆ–è€…${}ç¬¦å·ã€‚èŠ±æ‹¬å·æ—¶å¯é€‰çš„ï¼Œä¸»è¦æ˜¯ä¸ºäº†å¸®åŠ©è§£é‡Šå™¨è¯†åˆ«å˜é‡è¾¹ç•Œã€‚ ä¸€å®šè¦æ³¨æ„ï¼šåªæœ‰ä½¿ç”¨å˜é‡çš„æ—¶å€™æ‰åŠ ç¾å…ƒç¬¦å·$å˜é‡çš„æ—¶å€™æ‰åŠ ç¾å…ƒç¬¦å·$å˜é‡çš„æ—¶å€™æ‰åŠ ç¾å…ƒç¬¦å·$ name=hzf echo $name echo ${name} echo ${name}123 åªè¯»å˜é‡ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨readOnlyæˆ–è€…declareå°†å˜é‡è®¾ç½®ä¸ºåªè¯»ã€‚ name=hzf readOnly name #declare -r name #ä¸¤ç§å†™æ³•å‡å¯ã€‚ name=ylf #æ­¤æ—¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºå·²ç»è®¾ç½®æˆäº†åªè¯»å˜é‡ã€‚ åˆ é™¤å˜é‡ unsetå¯ä»¥åˆ é™¤å˜é‡ã€‚ name=hzf unset name echo $name æ­¤æ—¶æ²¡æœ‰è¾“å‡ºhzfï¼Œä»£è¡¨å·²ç»åˆ é™¤äº†ï¼Œè¿™é‡Œæ²¡æœ‰æŠ¥é”™æ˜¯å› ä¸ºShellå°†æ²¡æœ‰å®šä¹‰çš„å˜é‡è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ å˜é‡ç±»å‹ æ ¹æ®è®¿é—®æƒé™åˆ’åˆ†å¯ä»¥åˆ†ä¸ºï¼š è‡ªå®šä¹‰å˜é‡ï¼ˆå±€éƒ¨å˜é‡ï¼‰ åœ¨è„šæœ¬æˆ–å‘½ä»¤ä¸­å®šä¹‰ï¼Œä»…åœ¨å½“å‰Shellç¤ºä¾‹ä¸­æœ‰æ•ˆï¼Œå…¶ä»–Shellå¯åŠ¨çš„ç¨‹åºä¸èƒ½è®¿é—®å±€éƒ¨å˜é‡ã€‚å³ä¸ºå­è¿›ç¨‹ä¸èƒ½è®¿é—®çš„å˜é‡ã€‚ ç¯å¢ƒå˜é‡ï¼ˆå…¨å±€å˜é‡ï¼‰ æ‰€æœ‰ç¨‹åºï¼ŒåŒ…æ‹¬shellå¯åŠ¨ç¨‹åºï¼Œéƒ½èƒ½è®¿é—®ç¯å¢ƒå˜é‡ï¼Œæœ‰äº›ç¨‹åºéœ€è¦ç¯å¢ƒå˜é‡æ¥ä¿è¯å…¶æ­£å¸¸è¿è¡Œã€‚å³ä¸ºå­è¿›ç¨‹å¯ä»¥è®¿é—®çš„å˜é‡ã€‚ è‡ªå®šä¹‰å˜é‡è½¬æ¢ä¸ºç¯å¢ƒå˜é‡ï¼š name=hzf#å®šä¹‰è‡ªå®šä¹‰å˜é‡ export name delcare -x name#ä¸¤ç§æ–¹æ³•å‡å¯ ç¯å¢ƒå˜é‡è½¬åŒ–ä¸ºè‡ªå®šä¹‰å˜é‡ export name=hzf#å®šä¹‰ç¯å¢ƒå˜é‡ã€‚ delcare +x name#æ”¹ä¸ºè‡ªå®šä¹‰å˜é‡ã€‚ Shellå­—ç¬¦ä¸² å­—ç¬¦ä¸²å¯ä»¥ç”¨å•å¼•å·ï¼Œä¹Ÿå¯ä»¥ç”¨åŒå¼•å·ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·ã€‚ä½†å…¶ä¸­æ˜¯æœ‰åŒºåˆ«çš„ï¼š ä½¿ç”¨å•å¼•å·å­—ç¬¦ä¸²ï¼Œå…¶ä¸­çš„å˜é‡åä¸ä¼šè¾“å‡ºï¼Œä½†å¯ä»¥è¾“å‡ºè½¬ä¹‰å­—ç¬¦ã€‚å•å¼•å·å­—ä¸²ä¸­ä¸èƒ½å‡ºç°å•ç‹¬ä¸€ä¸ªçš„å•å¼•å·ï¼ˆå¯¹å•å¼•å·ä½¿ç”¨è½¬ä¹‰ç¬¦åä¹Ÿä¸è¡Œï¼‰ï¼Œä½†å¯æˆå¯¹å‡ºç°ï¼Œä½œä¸ºå­—ç¬¦ä¸²æ‹¼æ¥ä½¿ç”¨ã€‚ ä¸ç”¨å¼•å·çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­å˜é‡å¯ä»¥è¾“å‡ºï¼Œä½†æ˜¯ä¸èƒ½è¾“å‡ºè½¬ç§»å­—ç¬¦ã€‚ ä½¿ç”¨åŒå¼•å·çš„å­—ç¬¦ä¸²ï¼Œæ—¢å¯ä»¥è¾“å‡ºå˜é‡ä¹Ÿå¯ä»¥è¾“å‡ºè½¬ä¹‰å­—ç¬¦ã€‚ ç¤ºä¾‹ï¼š name=hzf echo 123$name\\n echo \"123$name\\n\" echo '123$name\\n' è¾“å‡ºï¼š å­—ç¬¦ä¸²æ“ä½œ æ‹¼æ¥å­—ç¬¦ä¸² name=xyz #åŒå¼•å·å­—ç¬¦ä¸²æ‹¼æ¥ s1=\"Hello, $ {name} !â€ s2=\"Hello, \"$ {name}\"!\" echo $s1 $s2 è·å–å­—ç¬¦ä¸²é•¿åº¦ name=hzf echo ${#name} æå–å­—ç¬¦ä¸² æ³¨æ„ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•ä¸º$0$ï¼Œç»™å‡ºçš„ä¸¤ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªä¸ºèµ·å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªä¸ºæˆªå–é•¿åº¦ã€‚ name=\"Hello, World!\" echo ${name} echo ${name:0:4} echo ${name:0} echo ${name:1} æ–‡ä»¶å‚æ•°å˜é‡ åœ¨æ‰§è¡ŒShellè„šæœ¬æ—¶ï¼Œå¯ä»¥å‘è„šæœ¬ä¼ é€’å‚æ•°ã€‚$1æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ$2æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚ç‰¹æ®Šçš„ï¼Œ$0æ˜¯æ–‡ä»¶åï¼ˆåŒ…å«è·¯å¾„ï¼‰ã€‚ä¾‹å¦‚ï¼š echo \"æ–‡ä»¶å:$0\" echo \"ç¬¬ä¸€ä¸ªå‚æ•°:$1\" echo \"ç¬¬äºŒä¸ªå‚æ•°:$2\" echo \"$*\" echo \"$@\" ç„¶åæˆ‘ä»¬æ‰§è¡Œçš„æ—¶å€™åœ¨åé¢æ·»åŠ å‚æ•°å³å¯ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºï¼Œé‚£ä¹ˆåˆ™ä¸ºç©ºå­—ç¬¦ã€‚ å…¶ä»–å‚æ•°ç›¸å…³å˜é‡ å‚æ•° è¯´æ˜ $#` | ï¿½ï¿½è¡¨æ–‡ä»¶ä¼ å…¥çš„å‚æ•°ä¸ªæ•°ï¼Œå¦‚ä¸Šä¾‹ä¸­å€¼ä¸º2 | $*` | ï¿½ï¿½æ‰€æœ‰å‚æ•°æ„æˆçš„ç”¨ç©ºæ ¼éš”å¼€çš„å­—ç¬¦ä¸²ï¼Œå¦‚ä¸Šä¾‹ä¸­å€¼ä¸º\"$1 $2\" | $@` | ï¿½ï¿½ä¸ªå‚æ•°åˆ†åˆ«ç”¨åŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²ï¼Œå¦‚ä¸Šä¾‹ä¸­å€¼ä¸º\"$1\" \"$2\" | $$` | ï¿½ï¿½æœ¬å½“å‰è¿è¡Œçš„è¿›ç¨‹ID | $?` | ï¿½ï¿½ä¸€æ¡å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ï¼ˆæ³¨æ„ä¸æ˜¯stdoutï¼Œè€Œæ˜¯exit codeï¼‰ã€‚0è¡¨ç¤ºæ­£å¸¸é€€å‡ºï¼Œå…¶ä»–å€¼è¡¨ç¤ºé”™è¯¯ | $(command)` | ï¿½ï¿½å›commandè¿™æ¡å‘½ä»¤çš„stdoutï¼ˆå¯åµŒå¥—ï¼‰ | command` | ï¿½ï¿½å›commandè¿™æ¡å‘½ä»¤çš„stdoutï¼ˆä¸å¯åµŒå¥—ï¼‰ | ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:2","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.3 æ•°ç»„ æ•°ç»„ä¸­å¯ä»¥å­˜æ”¾å¤šä¸ªå€¼ã€‚Bash Shell åªæ”¯æŒä¸€ç»´æ•°ç»„ï¼ˆä¸æ”¯æŒå¤šç»´æ•°ç»„ï¼‰ï¼Œåˆå§‹åŒ–æ—¶ä¸éœ€è¦å®šä¹‰æ•°ç»„å¤§å°ï¼ˆä¸ PHP ç±»ä¼¼ï¼‰ã€‚ä¸å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€ç±»ä¼¼ï¼Œæ•°ç»„å…ƒç´ çš„ä¸‹æ ‡ç”± 0 å¼€å§‹ã€‚ å®šä¹‰ Shell æ•°ç»„ç”¨æ‹¬å·æ¥è¡¨ç¤ºï¼Œå…ƒç´ ç”¨\"ç©ºæ ¼\"ç¬¦å·åˆ†å‰²å¼€ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š array_name=(value1 value2 ... valuen) å¦‚ï¼š name=(å¼ ä¸‰ \"æå››\" 'ç‹äº”') ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡å®šä¹‰æ•°ç»„ä¸­å…ƒç´ çš„å€¼æ¥åˆ›å»ºæ•°ç»„ï¼Œå¦‚ï¼š name[0]=\"å¼ ä¸‰\" è¿™æ ·å°±åˆ›å»ºäº†nameæ•°ç»„ã€‚ è®¿é—®æ•°ç»„å…ƒç´  è®¿é—®å•ä¸ªå…ƒç´  è¯­æ³•æ ¼å¼ä¸ºï¼š${array_name[index]} å¦‚ï¼š name[0]=\"123\" name[3]=\"124\" echo \"${name[0]}\" echo \"${name[3]}\" è®¿é—®æ‰€æœ‰å…ƒç´  æ ¼å¼ï¼š ${array[@]}#ç¬¬ä¸€ç§å†™æ³• ${array[*]}#ç¬¬äºŒç§å†™æ³• ç¤ºä¾‹ï¼š array=(1 abc \"def\" yxc) echo ${array[@]} # ç¬¬ä¸€ç§å†™æ³• echo ${array[*]} # ç¬¬äºŒç§å†™æ³• è·å–æ•°ç»„é•¿åº¦ åŒå­—ç¬¦ä¸²å†™æ³•ï¼š array=(1 abc \"def\" yxc) echo ${#array[@]} #ç¬¬ä¸€ç§å†™æ³• echo ${#array[*]} #ç¬¬äºŒç§å†™æ³• ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:3","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.4 exprå‘½ä»¤ä¸åŸºæœ¬è¿ç®—ç¬¦ Shell å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œæ”¯æŒå¤šç§è¿ç®—ç¬¦ï¼ŒåŒ…æ‹¬ï¼š ç®—æ•°è¿ç®—ç¬¦ å…³ç³»è¿ç®—ç¬¦ å¸ƒå°”è¿ç®—ç¬¦ å­—ç¬¦ä¸²è¿ç®—ç¬¦ æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦ ä½†æ˜¯åŸç”ŸBashä¸æ”¯æŒç®€å•çš„æ•°å­¦è¿ç®—ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å…¶ä»–å‘½ä»¤æ¥å®ç°ï¼Œå¦‚awk,exprï¼Œexprå‘½ä»¤æœ€å¸¸ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œä»‹ç»exprã€‚ expræ˜¯ä¸€æ¬¾è¡¨è¾¾å¼è®¡ç®—å·¥å…·ï¼Œä½¿ç”¨å®ƒèƒ½å®Œæˆè¡¨è¾¾å¼çš„æ±‚å€¼æ“ä½œã€‚æ ¼å¼ä¸ºï¼š expr è¡¨è¾¾å¼ è¡¨è¾¾å¼è¯´æ˜ ç”¨ç©ºæ ¼éš”å¼€æ¯ä¸€é¡¹ ç”¨åæ–œæ æ”¾åœ¨shellç‰¹å®šçš„å­—ç¬¦å‰é¢ï¼ˆå‘ç°è¡¨è¾¾å¼è¿è¡Œé”™è¯¯æ—¶ï¼Œå¯ä»¥è¯•è¯•è½¬ä¹‰ï¼‰ å¯¹åŒ…å«ç©ºæ ¼å’Œå…¶ä»–ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²è¦ç”¨å¼•å·æ‹¬èµ·æ¥ exprä¼šåœ¨stdoutä¸­è¾“å‡ºç»“æœã€‚å¦‚æœä¸ºé€»è¾‘å…³ç³»è¡¨è¾¾å¼ï¼Œåˆ™ç»“æœä¸ºçœŸï¼Œstdoutä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚ exprçš„exit codeï¼šå¦‚æœä¸ºé€»è¾‘å…³ç³»è¡¨è¾¾å¼ï¼Œåˆ™ç»“æœä¸ºçœŸï¼Œexit codeä¸º0ï¼Œå¦åˆ™ä¸º1ã€‚ å®Œæ•´çš„è¡¨è¾¾å¼è¦è¢« ` ` åŒ…å«ï¼Œæ³¨æ„è¿™ä¸ªå­—ç¬¦ä¸æ˜¯å¸¸ç”¨çš„å•å¼•å·ï¼Œè€Œæ˜¯åå¼•å·ï¼Œä»£è¡¨æ‰§è¡Œè¯¥å‘½ä»¤ã€‚é€šå¸¸åœ¨ Esc é”®ä¸‹è¾¹ã€‚ ç®—æ•°è¡¨è¾¾å¼ ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„ç®—æœ¯è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º 10ï¼Œå˜é‡ b ä¸º 20ï¼š è¿ç®—ç¬¦ è¯´æ˜ ä¸¾ä¾‹ | ï¿½ï¿½æ³• | expr $a + $b` ç»“æœä¸º 30ã€‚ | | ï¿½ï¿½æ³• | expr $a - $b` ç»“æœä¸º -10ã€‚ | | ï¿½ï¿½æ³• | expr $a * $b` ç»“æœä¸º 200ã€‚ | | ï¿½ï¿½æ³• | expr $b / $a` ç»“æœä¸º 2ã€‚ | | ï¿½ï¿½ä½™ | expr $b % $a` ç»“æœä¸º 0ã€‚ | | ï¿½ï¿½å€¼ | a=$b` å°†æŠŠå˜é‡ b çš„å€¼èµ‹ç»™ aã€‚ | font color=â€œredâ€\u003e | ï¿½ï¿½ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œç›¸åŒåˆ™è¿”å› trueã€‚ | [ $a $b ]` è¿”å› falseã€‚ | = | ï¿½ï¿½ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œä¸ç›¸åŒåˆ™è¿”å› trueã€‚ | [ $a != $b ]` è¿”å› trueã€‚ | **æ³¨æ„ï¼š**æ¡ä»¶è¡¨è¾¾å¼è¦æ”¾åœ¨æ–¹æ‹¬å·ä¹‹é—´ï¼Œå¹¶ä¸”è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚: [$a\u003cfont color=\"red\"\u003e$b] æ˜¯é”™è¯¯çš„ï¼Œå¿…é¡»å†™æˆ [ $a \u003c/font\u003e $b ]ã€‚æ³¨æ„ä¹˜å·ç­‰ç‰¹æ®Šç¬¦å·éœ€è¦è½¬ä¹‰ã€‚()å¯è¡¨ä¼˜å…ˆçº§ï¼Œä½†åŒæ ·éœ€è¦åæ–œæ è½¬ç§»ã€‚ å®ä¾‹ï¼š a=10 b=20 echo \"a + b = `expr $a + $b`\" echo \"a - b = `expr $a - $b`\" echo \"a * b = `expr $a \\* $b`\" echo \"a / b = `expr $a / $b`\" echo \"a % b = `expr $a % $b`\" echo \"a \u003cfont color=\"red\"\u003e b = `expr [$a \u003c/font\u003e $b]`\" echo \"a != b = `expr [$a != $b]`\" a=$b echo \"$a\" å…³ç³»è¿ç®—ç¬¦ Shellæ”¯æŒæ­£å¸¸çš„å…³ç³»æ¯”è¾ƒè¿ç®—ç¬¦ï¼Œå³\u003c,\u003c=,\u003e,\u003e=ç­‰ã€‚å…¶ä¼šè¿”å›01ä»£è¡¨ç»“æœã€‚ å®ä¾‹ï¼š a=10 b=20 echo \"a \u003c b : `expr $a \\\u003c $b`\" #éœ€è¦è½¬ä¹‰ echo \"a \u003e b : `expr $a '\u003e' $b`\" #ä¹Ÿå¯ä»¥ç”¨å¼•å·æ‹¬èµ·æ¥ã€‚ echo \"a \u003e= b : `expr $a '\u003e=' $b`\" åŒæ—¶ï¼ŒShellä¹Ÿç»™å‡ºäº†è‡ªå·±ç‰¹å®šçš„æ¯”è¾ƒå‘½ä»¤ï¼Œå¦‚ä¸‹è¡¨ï¼š è¿ç®—ç¬¦ è¯´æ˜ ä¸¾ä¾‹ -eq æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚ [ $a -eq $b ] è¿”å› falseã€‚ -ne æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚ [ $a -ne $b ] è¿”å› trueã€‚ -gt æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -gt $b ] è¿”å› falseã€‚ -lt æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -lt $b ] è¿”å› trueã€‚ -ge æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -ge $b ] è¿”å› falseã€‚ -le æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ [ $a -le $b ] è¿”å› trueã€‚ å®ä¾‹ï¼ˆæ³¨ï¼šifâ€¦thenæ˜¯æ¡ä»¶è¯­å¥ï¼Œä¹‹åä¼šè®²è§£ï¼‰ï¼š #!/bin/bash a=10 b=20 if [ $a -eq $b ] then echo \"$a -eq $b : a ç­‰äº b\" else echo \"$a -eq $b: a ä¸ç­‰äº b\" fi if [ $a -ne $b ] then echo \"$a -ne $b: a ä¸ç­‰äº b\" else echo \"$a -ne $b : a ç­‰äº b\" fi if [ $a -gt $b ] then echo \"$a -gt $b: a å¤§äº b\" else echo \"$a -gt $b: a ä¸å¤§äº b\" fi if [ $a -lt $b ] then echo \"$a -lt $b: a å°äº b\" else echo \"$a -lt $b: a ä¸å°äº b\" fi if [ $a -ge $b ] then echo \"$a -ge $b: a å¤§äºæˆ–ç­‰äº b\" else echo \"$a -ge $b: a å°äº b\" fi if [ $a -le $b ] then echo \"$a -le $b: a å°äºæˆ–ç­‰äº b\" else echo \"$a -le $b: a å¤§äº b\" fi å­—ç¬¦ä¸²è¡¨è¾¾å¼ å³ç»“åˆexprå‘½ä»¤å®ç°å¯¹å­—ç¬¦ä¸²çš„æ“ä½œï¼Œå¸¸è§æœ‰ä»¥ä¸‹ï¼š length strï¼šè¿”å›strçš„é•¿åº¦ã€‚ index str charSet:è¿”å›å­—ç¬¦é›†charSetä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦åœ¨strä¸­æœ€å‰é¢å­—ç¬¦çš„ä½ç½®ã€‚ä¸‹æ ‡ä»1å¼€å§‹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›0ã€‚ substr str st lenï¼šæˆªå–å­—ç¬¦ä¸²strï¼Œä»stä½ç½®å¼€å§‹ï¼Œé•¿åº¦æœ€å¤§ä¸ºlençš„å­ä¸²ã€‚å¦‚æœæˆªå–ä¸æˆåŠŸï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚ å®ä¾‹ï¼š str=\"Hello,World!\" echo `expr length \"$str\"` #`ä¸æ˜¯å•å¼•å·ï¼Œè€Œæ˜¯åå¼•å·ï¼Œä»£è¡¨æ‰§è¡Œè¯¥å‘½ä»¤ã€‚ echo `expr index \"$str\" llo` echo `expr substr \"$str\" 1 4` æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦ æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦ç”¨äºæ£€æµ‹ Unix æ–‡ä»¶çš„å„ç§å±æ€§ã€‚ å±æ€§æ£€æµ‹æè¿°å¦‚ä¸‹ï¼š æ“ä½œç¬¦ è¯´æ˜ ä¸¾ä¾‹ b file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å—è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -b $file ] è¿”å› falseã€‚ | c file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -c $file ] è¿”å› falseã€‚ | d file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯ç›®å½•ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -d $file ] è¿”å› falseã€‚ | f file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆæ—¢ä¸æ˜¯ç›®å½•ï¼Œä¹Ÿä¸æ˜¯è®¾å¤‡æ–‡ä»¶ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -f $file ] è¿”å› trueã€‚ | g file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SGID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -g $file ] è¿”å› falseã€‚ | k file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº†ç²˜ç€ä½(Sticky Bit)ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -k $file ] è¿”å› falseã€‚ | p file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æœ‰åç®¡é“ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -p $file ] è¿”å› falseã€‚ | u file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SUID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -u $file ] è¿”å› falseã€‚ | r file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -r $file ] è¿”å› trueã€‚ | w file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦å¯å†™ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -w $file ] è¿”å› trueã€‚ | x file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -x $file ] è¿”å› trueã€‚ | s file | ï¿½ï¿½æµ‹æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼ˆæ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº0ï¼‰ï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚ | -s $file ] è¿”å› trueã€‚ | e file | ï¿½ï¿½æµ‹æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | -e $file ] è¿”å› trueã€‚ | ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:4","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.5 readå‘½ä»¤ readå‘½ä»¤å¯ç”¨äºä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–å•è¡Œæ•°æ®ï¼Œå½“è¯»åˆ°æ–‡ä»¶ç»“æŸç¬¦æ—¶ï¼Œexit codeä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚ å‚æ•°è¯´æ˜ï¼š -pï¼šåé¢å¯ä»¥æ¥æç¤ºä¿¡æ¯ã€‚ -tï¼šåé¢è·Ÿç§’æ•°ï¼Œå®šä¹‰è¾“å…¥å­—ç¬¦çš„ç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡ç­‰å¾…æ—¶é—´åä¼šè‡ªåŠ¨å¿½ç•¥æ­¤å‘½ä»¤ å®ä¾‹ï¼š read name echo $name read -p \"please input your name:\" -t 30 name #è¯»å…¥nameçš„å€¼ï¼Œç­‰å¾…30sã€‚ echo $name ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:5","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.6 echoå‘½ä»¤ echoå‘½ä»¤ç”¨äºå­—ç¬¦ä¸²çš„è¾“å‡ºï¼Œåœ¨å‰é¢çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å·²ç»æ¥è§¦åˆ°äº†ï¼Œå…¶å‘½ä»¤æ ¼å¼ä¸ºï¼š echo string æˆ‘ä»¬å¯ä»¥ç”¨echoå®ç°æ›´å¤æ‚çš„è¾“å‡ºæ ¼å¼æ§åˆ¶ã€‚ æ˜¾ç¤ºæ™®é€šå­—ç¬¦ä¸² echo \"Hello, World!\" è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸åŠ åŒå¼•å·ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ æ˜¾ç¤ºè½¬ä¹‰å­—ç¬¦ echo \"\\\"Hello,World!\\\"\" åŒæ ·ï¼Œè¿™é‡Œçš„åŒå¼•å·ä¹Ÿå¯ä»¥çœç•¥ã€‚ æ˜¾ç¤ºå˜é‡ name=hzf echo \"My name is $name\" æ˜¾ç¤ºæ¢è¡Œç­‰ç‰¹æ®Šå­—ç¬¦ æ³¨æ„ï¼Œè¿™äº›å­—ç¬¦éƒ½éœ€è¦é€šè¿‡-eå‘½ä»¤å¼€å¯è½¬ä¹‰æ‰èƒ½èµ·ä½œç”¨çš„ï¼Œå¦‚ï¼š\\\\ \\a \\b \\c \\d \\e \\f \\n \\r \\t \\v è¿™äº›æ˜¯è¦åœ¨æœ‰ -e çš„æ—¶å€™æ‰èƒ½èµ·ä½œç”¨, å…¶ä»–æ—¶å€™çš„è½¬ä¹‰æ˜¯ä¸ç”¨- eä¹Ÿèƒ½è½¬ä¹‰çš„ã€‚ echo -e \"Hello\\n\" #-eå¼€å¯è½¬ä¹‰ã€‚ echo \"World!\" æ˜¾ç¤ºç»“æœå®šå‘è‡³æ–‡ä»¶ echo \"Hello, World!\" \u003e output.txt åŸæ ·è¾“å‡ºå­—ç¬¦ä¸² å‰é¢æœ‰æåŠï¼Œå¦‚æœæƒ³åŸæ ·è¾“å‡ºï¼Œä¸è¿›è¡Œè½¬ä¹‰æˆ–è€…å–å˜é‡ï¼Œç”¨å•å¼•å·ã€‚ name=hzf echo '$name' æ˜¾ç¤ºå‘½ä»¤æ‰§è¡Œç»“æœ ä½¿ç”¨åå¼•å·ã€‚ echo `date` echo `ls` ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:6","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.7 printfå‘½ä»¤ Shellçš„printfå‘½ä»¤å’ŒCè¯­è¨€ä¸­çš„printfå·®ä¸å¤šï¼Œç”¨äºæ ¼å¼åŒ–è¾“å‡ºã€‚è¯¥å‘½ä»¤ä¸ä¼šåƒechoå‘½ä»¤ä¸€æ ·è‡ªåŠ¨æ·»åŠ æ¢è¡Œã€‚å…¶è¯­æ³•ä¸ºï¼š printf format-string [args] å…¶ä¸­format-stringä¸ºæ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²ï¼Œ[args]ä¸ºå‚æ•°åˆ—è¡¨ã€‚ å®ä¾‹ï¼š #-è¡¨ç¤ºå·¦å¯¹é½ï¼Œæ²¡æœ‰åˆ™è¡¨ç¤ºå³å¯¹é½ï¼Œdä¸ºå®½åº¦ã€‚%sè¡¨ç¤ºè¾“å‡ºå­—ç¬¦ä¸²ï¼Œ%dæ•´å‹è¾“å‡ºã€‚ #%-10såˆ™è¡¨ç¤ºè¾“å‡ºå®½åº¦ä¸º10çš„å·¦å¯¹é½å­—ç¬¦ä¸²ã€‚è€Œ%-4.2fåˆ™è¡¨ç¤ºè¾“å‡º4ä½æ•´æ•°ï¼Œä¿ç•™2ä½å°æ•°ã€‚ printf \"%-10s %-8s %-4s\\n\" å§“å æ€§åˆ« ä½“é‡kg printf \"%-10s %-8s %-4.2f\\n\" éƒ­é– ç”· 66.1234 printf \"%-10s %-8s %-4.2f\\n\" æ¨è¿‡ ç”· 48.6543 printf \"%-10s %-8s %-4.2f\\n\" éƒ­èŠ™ å¥³ 47.9876 å‘½ä»¤æ ¼å¼æŒ‡ç¤ºç¬¦ ç¬¦å· è¯´æ˜ c | SCIIå­—ç¬¦.æ˜¾ç¤ºç›¸å¯¹åº”å‚æ•°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ | d,%i | ï¿½ï¿½è¿›åˆ¶æ•´æ•° | E | ï¿½ï¿½ç‚¹æ ¼å¼([-d].precisionE [+-dd]) | e | ï¿½ï¿½ç‚¹æ ¼å¼([-d].precisione [+-dd]) | g | eæˆ–%fè½¬æ¢,çœ‹å“ªä¸€ä¸ªè¾ƒçŸ­,åˆ™åˆ é™¤ç»“å°¾çš„é›¶ | G | Eæˆ–%fè½¬æ¢,çœ‹å“ªä¸€ä¸ªè¾ƒçŸ­,åˆ™åˆ é™¤ç»“å°¾çš„é›¶ | s | ï¿½ï¿½ç¬¦ä¸² | u | ï¿½ï¿½å¸¦æ­£è´Ÿå·çš„åè¿›åˆ¶å€¼ | x | ï¿½ï¿½å¸¦æ­£è´Ÿå·çš„åå…­è¿›åˆ¶.ä½¿ç”¨aè‡³fè¡¨ç¤º10è‡³15 | % | ï¿½ï¿½é¢æ„ä¹‰çš„% | X | ï¿½ï¿½å¸¦æ­£è´Ÿå·çš„åå…­è¿›åˆ¶.ä½¿ç”¨Aè‡³Fè¡¨ç¤º10è‡³15 | ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:7","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.8 testå‘½ä»¤ä¸åˆ¤æ–­ç¬¦å·[] åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥man testï¼Œå³å¯æŸ¥çœ‹testå‘½ä»¤çš„ç”¨æ³•ã€‚ testå‘½ä»¤å¯ä»¥ç”¨äºåˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œä»¥åŠå¯¹å˜é‡åšæ¯”è¾ƒã€‚testå‘½ä»¤ç”¨exit codeè¿”å›ç»“æœï¼Œè€Œä¸æ˜¯ä½¿ç”¨stdoutã€‚0è¡¨ç¤ºçœŸï¼Œé0è¡¨ç¤ºå‡ã€‚è¿™é‡Œå¯ä»¥é€šè¿‡echo $?æ¥è¾“å‡ºä¸Šä¸€æ¡å‘½ä»¤çš„ç»“æœã€‚ æ–‡ä»¶åˆ¤æ–­ å‘½ä»¤æ ¼å¼ï¼štest æµ‹è¯•å‚æ•° filename å…¶ä¸­å¸¸ç”¨æµ‹è¯•å‚æ•°å¦‚ä¸‹è¡¨ï¼š æµ‹è¯•å‚æ•° ä»£è¡¨æ„ä¹‰ -e æ–‡ä»¶æ˜¯å¦å­˜åœ¨ -f æ˜¯å¦ä¸ºæ–‡ä»¶ -d æ˜¯å¦ä¸ºç›®å½• -r æ–‡ä»¶æ˜¯å¦å¯è¯» -w æ–‡ä»¶æ˜¯å¦å¯å†™ -x æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œ -s æ˜¯å¦ä¸ºéç©ºæ–‡ä»¶ æµ‹è¯• æ•´æ•°ä¹‹é—´çš„æ¯”è¾ƒ å‘½ä»¤æ ¼å¼ï¼štest $a å…³ç³»è¿ç®—ç¬¦ $b å…¶ä¸­å…³ç³»è¿ç®—ç¬¦ä¸ºä¸Šæ–‡æ‰€æåŠçš„ï¼Œè¿™é‡Œä¸ä½œåˆ—ä¸¾ã€‚ å­—ç¬¦ä¸²æ¯”è¾ƒ ç›¸å…³æ“ä½œå¦‚è¡¨æ‰€ç¤ºï¼š æµ‹è¯•å‚æ•° ä»£è¡¨æ„ä¹‰ test -z str åˆ¤æ–­stræ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œè¿”å›trueï¼Œå¦åˆ™false test -n str åˆ¤æ–­stræ˜¯å¦ä¸ºéç©ºï¼Œå¦‚æœéç©ºï¼Œè¿”å›trueï¼Œå¦åˆ™false.å…¶ä¸­-nå¯ä»¥çœç•¥ test str1 == str2 åˆ¤æ–­str1æ˜¯å¦ç­‰äºstr2 test str1 != str2 åˆ¤æ–­str1æ˜¯å¦ä¸ç­‰äºstr2 ` å¤šé‡æ¡ä»¶åˆ¤å®š å³åˆ¤æ–­å¤šä¸ªæ¡ä»¶æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œå¯ä»¥åµŒå¥—å¤šå±‚ã€‚å…·ä½“æ“ä½œå›¾è¡¨æ‰€ç¤ºï¼š æµ‹è¯•å‚æ•° ä»£è¡¨æ„ä¹‰ -a ä¸¤æ¡ä»¶æ˜¯å¦åŒæ—¶æˆç«‹ -o ä¸¤æ¡ä»¶æ˜¯å¦è‡³å°‘ä¸€ä¸ªæˆç«‹ ! å–åã€‚å¯¹è¿”å›ç»“æœå–å åˆ¤æ–­ç¬¦å·[] å’Œtestå‘½ä»¤ç”¨æ³•å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯å°†éœ€è¦åˆ¤æ–­çš„å†…å®¹æ”¾å…¥æ‹¬å·ä¸­ã€‚ æ›´å¸¸ç”¨äºifè¯­å¥ä¸­ï¼Œä¸”[[]]æ˜¯[]çš„åŠ å¼ºç‰ˆï¼Œæ”¯æŒçš„ç‰¹æ€§ä¹Ÿæ›´å¤šã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ä¸€äº›ç‰¹æ€§ï¼š[]å†…çš„æ¯ä¸€é¡¹éƒ½å¿…é¡»ç”¨ç©ºæ ¼éš”å¼€ï¼›ä¸­æ‹¬å·å†…çš„å˜é‡ï¼Œæœ€å¥½ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼›ä¸­æ‹¬å·å†…çš„å¸¸æ•°ï¼Œæœ€å¥½ç”¨å•æˆ–åŒå¼•å·æ‹¬èµ·æ¥ã€‚ ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:8","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.9 åˆ¤æ–­è¯­å¥ ifè¯­å¥ å’Œpythonçš„è¯­æ³•æœ‰ç‚¹åƒï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š if [ æ¡ä»¶ ] then å†…å®¹ elif [ æ¡ä»¶ ] then å†…å®¹ else å†…å®¹ fi æ³¨æ„fiä¸ºç»“æŸæ ‡è®°ï¼Œæ˜¯ä¸€å®šéœ€è¦åŠ çš„ï¼Œä½œä¸ºç»“å°¾é—­åˆã€‚ å®ä¾‹ï¼š case...esacå½¢å¼ å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š case $å˜é‡å in value1) å†…å®¹ ;; # ;;ï¼Œç±»ä¼¼break value2) å†…å®¹ ;; *) #ç±»ä¼¼default å†…å®¹ ;; esac # ä¹Ÿæ˜¯ç»“å°¾é—­åˆè¯­å¥ æµ‹è¯• ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:9","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.10 å¾ªç¯è¯­å¥ for...in...do...doneè¯­å¥ å‘½ä»¤æ ¼å¼ï¼š for var in val1 val2 val3 ... valN do å†…å®¹ done # ç»“å°¾é—­åˆ å¾ªç¯è§„åˆ™ä¸ºï¼šä»å·¦åˆ°å³éå†ï¼Œå½“å˜é‡å€¼ä¸ºåˆ—è¡¨æ—¶ï¼Œåˆ™ä¸€æ¬¡éå†å®Œåˆ—è¡¨ã€‚ å®ä¾‹1ï¼šè¾“å‡ºa 2 ccï¼Œæ¯ä¸ªå…ƒç´ ä¸€è¡Œï¼š for var in a 2 cc do echo $var done for((...;...;...)) do...doneè¯­å¥ å‘½ä»¤æ ¼å¼ï¼š for ((expression; condition; expression)) do å†…å®¹ done æµ‹è¯•ï¼šè¾“å‡º1-10ã€‚ for ((i=0; i\u003c=10; ++i)) do echo $i done while...do...doneè¯­å¥ å‘½ä»¤æ ¼å¼ï¼š while æ¡ä»¶ do å†…å®¹ done å®ä¾‹ï¼šæ–‡ä»¶ç»“æŸç¬¦ä¸ºctrl+dï¼Œè¾“å…¥æ–‡ä»¶ç»“æŸç¬¦åreadæŒ‡ä»¤è¿”å›falseã€‚ while reabashd name do echo $name done unti...do..doneè¯­å¥ å’Œwhileè¯­å¥ç›¸åŒï¼Œwhileèƒ½å®ç°çš„è„šæœ¬untilåŒæ ·å¯ä»¥å®ç°ã€‚ä½†åŒºåˆ«æ˜¯untilå¾ªç¯çš„é€€å‡ºçŠ¶æ€ä¸º0ï¼Œä¸whileåˆšå¥½ç›¸åï¼Œå³whileå¾ªç¯åœ¨æ¡ä»¶ä¸ºçœŸæ—¶ç»§ç»­æ‰§è¡Œå¾ªç¯è€Œuntilåœ¨æ¡ä»¶ä¸ºå‡æ—¶ç»§ç»­æ‰§è¡Œå¾ªç¯ã€‚ breakè¯­å¥ è·³å‡ºå½“å‰çš„ä¸€å±‚å¾ªç¯ï¼Œbreakä¸èƒ½è·³å‡ºcaseè¯­å¥ã€‚ continueè¯­å¥ è·³å‡ºå½“å‰å¾ªç¯ã€‚ æ­»å¾ªç¯çš„å¤„ç†æ–¹å¼ å¦‚æœTerminalå¯ä»¥æ‰“å¼€è¯¥ç¨‹åºï¼Œåˆ™è¾“å…¥Ctrl+cå³å¯ã€‚å¦åˆ™å¯ä»¥ç›´æ¥å…³é—­è¿›ç¨‹ï¼šä½¿ç”¨topå‘½ä»¤æ‰¾åˆ°è¯¥è¿›ç¨‹çš„PIDï¼›è¾“å…¥kill -9 PIDå³å¯å…³æ‰æ­¤è¿›ç¨‹ã€‚ ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:10","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.11 å‡½æ•° å®šä¹‰æ ¼å¼ï¼š [ function ] function_name [()]{ å†…å®¹; [return int;] } è¯´æ˜ï¼š å¯ä»¥å¸¦function func()å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥fun()å®šä¹‰ï¼Œä¸å¸¦ä»»ä½•å‚æ•°ã€‚ å‚æ•°è¿”å›ï¼Œå¯ä»¥æ˜¾ç¤ºåŠ ï¼šreturnè¿”å›ï¼Œå¦‚æœä¸åŠ ï¼Œå°†ä»¥æœ€åä¸€æ¡å‘½ä»¤è¿è¡Œç»“æœä½œä¸ºè¿”å›å€¼ã€‚returnåè·Ÿæ•°å€¼n(0-255ï¼Œä¸èƒ½è¶…è¿‡è¯¥èŒƒå›´)ã€‚ å…¶ä¸­å‡½æ•°è¿”å›å€¼é€šè¿‡$?è·å–ã€‚ å‡½æ•°ä½“å£°æ˜å±€éƒ¨å˜é‡å¯ä»¥ç”¨localå…³é”®å­—å£°æ˜ã€‚ å®ä¾‹ï¼š function add(){ echo \"ç›¸åŠ é¢„ç®—å‡½æ•°\" echo \"è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°\" read a echo \"è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°\" read b return $(($a + $b)) } add echo \"ç»“æœä¸º$?\" å‡½æ•°å‚æ•° åœ¨shellä¸­ï¼Œè°ƒç”¨å‡½æ•°å¯ä»¥å‘å…¶ä¼ é€’å‚æ•°ã€‚åœ¨å‡½æ•°ä½“å†…éƒ¨ï¼Œé€šè¿‡$nçš„å½¢å¼æ¥è·å–å‚æ•°çš„å€¼ã€‚ä¾‹å¦‚ï¼Œ$1è¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ$2è¡¨ç¤ºç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™ä¸ªè§„åˆ™å’Œä¸Šæ–‡è¯´çš„æ–‡ä»¶å‚æ•°ç›¸åŒã€‚ä¹Ÿæ˜¯åœ¨æ‰§è¡Œçš„åé¢æ·»åŠ å‚æ•°ã€‚ ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:11","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.12 exitå‘½ä»¤ exitå‘½ä»¤ç”¨æ¥é€€å‡ºå½“å‰çš„shellè¿›ç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ªé€€å‡ºçŠ¶æ€ï¼ˆ0-255ï¼Œåªæœ‰0è¡¨ç¤ºæˆåŠŸï¼Œå…¶ä»–éƒ½è¡¨ç¤ºå¤±è´¥ï¼‰ï¼›ä½¿ç”¨$?å³å¯æ¥æ”¶è¿™ä¸ªé€€å‡ºçŠ¶æ€ã€‚ exitå‘½ä»¤å¯ä»¥æ¥æ”¶ä¸€ä¸ªæ•´æ•°å€¼ä½œä¸ºå‚æ•°ï¼Œä»£è¡¨é€€å‡ºçŠ¶æ€ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤å€¼ä¸º0ã€‚ ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:12","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.13 æ–‡ä»¶é‡å®šå‘ æ¯ä¸ªè¿›ç¨‹é»˜è®¤æ‰“å¼€3ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼š stdinï¼šæ ‡å‡†è¾“å…¥ï¼Œä»å‘½ä»¤è¡Œè¯»å–æ•°æ®ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º0ã€‚ stdoutï¼šæ ‡å‡†è¾“å‡ºï¼Œå‘å‘½ä»¤è¡Œè¾“å‡ºæ•°æ®ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º1ã€‚ stderrï¼šæ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œå‘å‘½ä»¤è¡Œè¾“å‡ºæ•°æ®ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º2ã€‚ å¯ä»¥ç”¨æ–‡ä»¶é‡å®šå‘å°†è¿™ä¸‰ä¸ªæ–‡ä»¶é‡å®šå‘åˆ°å…¶ä»–æ–‡ä»¶ä¸­å»ã€‚é‡å®šå‘å‘½ä»¤åˆ—è¡¨å¦‚ä¸‹ï¼š å‘½ä»¤ è¯´æ˜ command \u003e file å°†è¾“å‡ºé‡å®šå‘åˆ° fileã€‚ command \u003c file å°†è¾“å…¥é‡å®šå‘åˆ° fileã€‚ command \u003e\u003e file å°†è¾“å‡ºä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ° fileã€‚ n \u003e file å°†æ–‡ä»¶æè¿°ç¬¦ä¸º n çš„æ–‡ä»¶é‡å®šå‘åˆ° fileã€‚ n \u003e\u003e file å°†æ–‡ä»¶æè¿°ç¬¦ä¸º n çš„æ–‡ä»¶ä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ° fileã€‚ n \u003e\u0026 m å°†è¾“å‡ºæ–‡ä»¶ m å’Œ n åˆå¹¶ã€‚ n \u003c\u0026 m å°†è¾“å…¥æ–‡ä»¶ m å’Œ n åˆå¹¶ã€‚ \u003c\u003c tag å°†å¼€å§‹æ ‡è®° tag å’Œç»“æŸæ ‡è®° tag ä¹‹é—´çš„å†…å®¹ä½œä¸ºè¾“å…¥ã€‚ è¾“å…¥è¾“å‡ºé‡å®šå‘å®ä¾‹ echo -e \"Hello \\c\" \u003e output.txt # å°†stdouté‡å®šå‘åˆ°output.txtä¸­ echo \"World\" \u003e\u003e output.txt # å°†å­—ç¬¦ä¸²è¿½åŠ åˆ°output.txtä¸­ read str \u003c output.txt # ä»output.txtä¸­è¯»å–å­—ç¬¦ä¸² echo $str # è¾“å‡ºç»“æœï¼šHello World åŒæ—¶é‡å®šå‘stdinå’Œstdout åˆ›å»ºmain.shç¼–å†™è„šæœ¬ï¼š read a read b echo $(expr \"$a\" + \"$b\") åˆ›å»ºinput.txtï¼Œå¡«å†™å†…å®¹ä¸ºï¼š 10 20 æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:13","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.14 å¼•å…¥å¤–éƒ¨è„šæœ¬ ç±»ä¼¼C/C++ä¸­çš„includeæ“ä½œï¼Œbashä¹Ÿå¯ä»¥å¼•å…¥å…¶ä»–æ–‡ä»¶ä¸­çš„ä»£ç ã€‚ è¯­æ³•æ ¼å¼ä¸ºï¼š . filename # æ³¨æ„ç©ºæ ¼ æˆ–è€… source filename ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:2:14","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 å‚è€ƒæ–‡çŒ® LinuxåŸºç¡€è¯¾ èœé¸Ÿæ•™ç¨‹ ","date":"2022-01-22","objectID":"/posts/06.shell%E6%95%99%E7%A8%8B/:3:0","tags":["Shell"],"title":"Shell æ•™ç¨‹","uri":"/posts/06.shell%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1 1. Vim ","date":"2022-01-21","objectID":"/posts/02.vim%E6%95%99%E7%A8%8B/:1:0","tags":["Vim"],"title":"Vimæ•™ç¨‹","uri":"/posts/02.vim%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.1 Vimç®€ä»‹ vimå°±æ˜¯linuxç³»ç»Ÿä¸Šçš„ä¸€æ¬¾æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå…·æœ‰è¯­æ³•é«˜äº®ï¼Œä»£ç è¡¥å…¨ï¼Œä»£ç ç¼©è¿›ï¼Œæ ¹æ®æ‰©å±•åè¯†åˆ«ç¼–ç¨‹è¯­è¨€ä»¥åŠç¼–è¯‘ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ã€‚æ˜¯ç¨‹åºå¼€å‘è€…ä¸€æ¬¾éå¸¸å¥½ç”¨çš„å·¥å…·ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å­¦ä¹ vimã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½œä¸ºç¨‹åºå‘˜ä¸€èˆ¬è®¤ä¸ºvimæ˜¯ä¸€ä¸ªç¨‹åºå¼€å‘å·¥å…·è€Œä¸æ˜¯æ–‡å­—å¤„ç†è½¯ä»¶ã€‚å¦‚æœå­¦ä¼šäº†vimï¼Œå¯¹ç¼–ç¨‹æ•ˆç‡æœ‰æå¤§çš„æé«˜ã€‚ å¦‚æœæ²¡æœ‰å®‰è£…vimï¼Œå¯ä»¥é€šè¿‡:sudo apt-get install vimæ¥å®‰è£…ã€‚ è¿™ä¸ªå°±æ˜¯vimçš„ç•Œé¢ï¼Œç•Œé¢ä»‹ç»åœ¨ä¹‹åä¼šä»‹ç»ï¼ŒåŒæ—¶vimå¯¹åº”çš„é”®ç›˜åŠŸèƒ½å›¾å¦‚ä¸‹ï¼š â€‹ å›¾æºï¼šhttps://www.runoob.com/linux/linux-vim.html è¿™ä¸ªé”®ç›˜å›¾ç‰¹åˆ«é‡è¦ï¼Œä¹Ÿæ˜¯vimçš„æ ¸å¿ƒã€‚ ","date":"2022-01-21","objectID":"/posts/02.vim%E6%95%99%E7%A8%8B/:1:1","tags":["Vim"],"title":"Vimæ•™ç¨‹","uri":"/posts/02.vim%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.2 Vimæ¨¡å¼ åœ¨ä½¿ç”¨vimä¹‹é—´ï¼Œæˆ‘ä»¬æœ‰å¿…è¦äº†è§£å®ƒçš„æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯çŠ¶æ€ï¼Œä¸€å…±æœ‰å››ç§æ¨¡å¼ï¼š æ­£å¸¸æ¨¡å¼(Normal-mode)ï¼› æ’å…¥æ¨¡å¼(Insert-mode)ï¼› å‘½ä»¤æ¨¡å¼(Command -mode)ï¼› å¯è§†æ¨¡å¼(Visual-mode)ã€‚ æœ‰çš„æ—¶å€™é€šå¸¸ä¹Ÿè®¤ä¸ºæ˜¯ä¸‰ä¸ªæ¨¡å¼ï¼Œå³æ²¡æœ‰å¯è§†æ¨¡å¼ï¼ˆå¯èƒ½æ˜¯å› ä¸ºè¿™ä¸ªæ¨¡å¼å­˜åœ¨æ„Ÿä½ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒä¸‹å›¾ç†è§£æ¨¡å¼ä¹‹é—´çš„è½¬æ¢ï¼š æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«ä»‹ç»è¿™å‡ ä¸ªæ¨¡å¼ã€‚ 1.2.1 æ­£å¸¸æ¨¡å¼(Normal-mode) æ­¤æ¨¡å¼ä¸€èˆ¬ç”¨äºæµè§ˆæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›å¤åˆ¶ï¼Œç²˜è´´ï¼Œåˆ é™¤ç­‰æ“ä½œã€‚æˆ‘ä»¬ä»ä»»ä½•æ¨¡å¼è¿”å›åˆ°æ­£å¸¸æ¨¡å¼ï¼Œåªéœ€è¦æŒ‰ä¸‹ESCé”®ã€‚ å½“æˆ‘ä»¬é€šè¿‡vim æ–‡ä»¶å.åç¼€å¯åŠ¨vimæ—¶ï¼Œå°±è¿›å…¥åˆ°äº†æ­£å¸¸æ¨¡å¼ï¼Œå¦‚æœå·²æœ‰æ–‡ä»¶ï¼Œåˆ™æ‰“å¼€å®ƒï¼Œå¦åˆ™å°±æ‰“å¼€ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå¹¶å‘½åä¸ºæ–‡ä»¶åã€‚ æ­¤æ—¶æˆ‘ä»¬æ˜¯æ— æ³•å‘æ–‡ä»¶å†™å†…å®¹çš„ï¼Œæ­¤çŠ¶æ€ä¸‹æ•²å‡»é”®ç›˜ä¼šè¢«vimè¯†åˆ«ä¸ºå‘½ä»¤ï¼Œè€Œä¸æ˜¯è¾“å…¥å­—ç¬¦ã€‚ å½“æˆ‘ä»¬è¾“å…¥iï¼ŒI, a,A æ—¶ä¼šè¿›å…¥æ’å…¥æ¨¡å¼ã€‚ å½“æˆ‘ä»¬è¾“å…¥væ—¶ä¼šè¿›å…¥å¯è§†æ¨¡å¼ã€‚ å½“æˆ‘ä»¬è¾“å…¥:æ—¶ä¼šè¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œå³åœ¨æœ€åº•ä¸‹ä¸€è¡Œè¾“å…¥å‘½ä»¤ã€‚æ‰€ä»¥ä¹Ÿå«åº•çº¿å‘½ä»¤æ¨¡å¼ã€‚ è¦é‡ç‚¹ä»‹ç»çš„ä¸€ä¸ªå†…å®¹å°±æ˜¯å¦‚ä½•åˆ é™¤ã€å¤åˆ¶ï¼Œå‰ªåˆ‡ä»¥åŠç²˜è´´äº†ã€‚vimå¯¹äºå¤åˆ¶ï¼Œå‰ªåˆ‡ï¼Œç²˜è´´æœ‰å®ƒè‡ªå·±çš„ä¸€å¥—æœ¯è¯­ã€‚å…¶ä¸­å¤åˆ¶è¢«å«åšyank(y)ï¼Œ å‰ªåˆ‡è¢«å«åšdelete(d)ï¼Œç²˜è´´è¢«å«åšput(p)ã€‚ åˆ é™¤ c -å‘ä¸‹åˆ é™¤ä¸€è¡Œã€‚å¦‚æœè¦åˆ é™¤å¤šè¡Œï¼Œåˆ™è¾“å…¥ncï¼Œå³å¯å‘ä¸‹åˆ é™¤$n$è¡Œã€‚ x - å‘ååˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œç›¸å½“äºdelæŒ‰é”®ã€‚å¦‚æœè¦è¿ç»­åˆ é™¤å¤šä¸ªå­—ç¬¦ï¼Œåˆ™è¾“å…¥nxï¼Œå³å¯åˆ é™¤$n$ä¸ªã€‚ X -å‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œ ç›¸å½“äºBackspaceæŒ‰é”®ã€‚åŒç†nXã€‚ å¤åˆ¶(yank) æˆ‘ä»¬å¦‚æœéœ€è¦å¤åˆ¶æ–‡æœ¬ï¼Œé‚£ä¹ˆéœ€è¦å°†å…‰æ ‡æ”¾åˆ°ä½ æƒ³è¦å¤åˆ¶çš„åœ°æ–¹ï¼Œç„¶åæ ¹æ®éœ€æ±‚æŒ‰ä¸‹ç›¸åº”å‘½ä»¤å³å¯ã€‚ y -å¤åˆ¶é€‰ä¸­çš„æ–‡æœ¬ï¼ˆé€‰ä¸­æ–‡æœ¬åœ¨è§†å›¾æ¨¡å¼ä¸­ä¼šè®²åˆ°ï¼‰ã€‚ yy -å¤åˆ¶å½“å‰è¡Œï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚ \u003cnumber\u003eyy -å¤åˆ¶ä»å…‰æ ‡æ‰€åœ¨çš„å½“å‰è¡Œå¼€å§‹çš„numberè¡Œæ–‡æœ¬ã€‚ ä¾‹å¦‚3yyå³å¯å¤åˆ¶ä»å½“å‰è¡Œå¼€å§‹çš„$3$è¡Œæ–‡æœ¬ã€‚ y$ -å¤åˆ¶ä»å…‰æ ‡ä½ç½®åˆ°è¡Œå°¾çš„æ–‡æœ¬ã€‚ y^ -å¤åˆ¶ä»å…‰æ ‡ä½ç½®åˆ°è¡Œé¦–çš„æ–‡æœ¬ã€‚ yw -å¤åˆ¶åˆ°ä¸‹ä¸€ä¸ªè¯çš„å¼€å¤´ã€‚ yiw - å¤åˆ¶å½“å‰è¯ã€‚ y% -å¤åˆ¶åŒ¹é…ç¬¦å·èŒƒå›´çš„å†…å®¹ã€‚é»˜è®¤æ”¯æŒçš„ç¬¦å·å¯¹ä¸º(),{},[]ã€‚è¿™ä¸ªåœ¨å¤åˆ¶æ‹¬å·å†…å®¹æ—¶ï¼Œéå¸¸æœ‰ç”¨ã€‚ yG -å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨è¡Œåˆ°æœ€åä¸€è¡Œçš„è¡Œçš„æ‰€æœ‰æ•°æ®ã€‚ ynG -nä¸ºæ•°ç»„ï¼Œå¤åˆ¶æ¸¸æ ‡æ‰€åœ¨è¡Œåˆ°ç¬¬$n$è¡Œçš„æ‰€æœ‰æ•°æ®ã€‚ å‰ªåˆ‡(delete) è¿™ä¸ªå‘½ä»¤æ­£å¸¸æ¥è¯´ä¹Ÿå¯ä»¥ä½œåˆ é™¤ç”¨ã€‚å‰ªåˆ‡æ–‡æœ¬æ—¶å°†å…‰æ ‡ç§»åŠ¨åˆ°æƒ³è¦çš„ä½ç½®ï¼Œæ ¹æ®éœ€æ±‚æŒ‰ä¸‹ç›¸åº”å‘½ä»¤å³å¯ã€‚ d -å‰ªåˆ‡é€‰ä¸­çš„æ–‡æœ¬ã€‚ dd -å‰ªåˆ‡å½“å‰è¡Œï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ç­‰ã€‚ \u003cnumber\u003edd -å‰ªåˆ‡ä»å…‰æ ‡ä½ç½®æ‰€åœ¨çš„è¡Œå¼€å§‹çš„numberè¡Œæ–‡æœ¬ã€‚ d$ - å‰ªåˆ‡ä»å…‰æ ‡ä½ç½®åˆ°è¡Œå°¾çš„å†…å®¹ã€‚ â€¦ä¸éš¾å‘ç°ï¼Œè¿™äº›å‘½ä»¤å’Œå¤åˆ¶å·®ä¸å¤šï¼Œå°±æ˜¯å°†yæ¢æˆdã€‚è¿™é‡Œå°±ä¸å†åšé˜è¿°äº†ã€‚ ç²˜è´´(put) å…ˆå°†å…‰æ ‡ç§»åŠ¨åˆ°æƒ³è¦ç²˜è´´çš„ä½ç½®ï¼Œç„¶åæŒ‰pé”®å³å¯å°†å‰ªè´´æ¿çš„å†…å®¹å¤åˆ¶åˆ°å½“å‰å…‰æ ‡åé¢ã€‚ å½“ç„¶ï¼Œå¤§å†™çš„Påˆ™æ˜¯å¤åˆ¶åˆ°å…‰æ ‡ä½ç½®å‰é¢ã€‚ å…¶ä»–å¸¸ç”¨æ“ä½œ å¿«æ·é”® åŠŸèƒ½ J | å°†å…‰æ ‡æ‰€åœ¨è¡Œä¸ä¸‹ä¸€è¡Œçš„æ•°æ®ç»“åˆæˆåŒä¸€è¡Œ | gg=G | å°†å…¨æ–‡ä»£ç æ ¼å¼åŒ– | u | æ’¤é”€ã€‚(å¸¸ç”¨) | Ctrl+r | å–æ¶ˆæ’¤é”€ã€‚(å¸¸ç”¨) | ï¿½ï¿½ä¸ª u ä¸ Ctrl+r æ˜¯å¾ˆå¸¸ç”¨çš„æŒ‡ä»¤ï¼ä¸€ä¸ªæ˜¯å¤åŸï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯é‡åšä¸€æ¬¡ï½ åˆ©ç”¨è¿™ä¸¤ä¸ªåŠŸèƒ½æŒ‰é”®ï¼Œä½ çš„ç¼–è¾‘ï¼Œå˜¿å˜¿ï¼å¾ˆå¿«ä¹çš„å•¦ï¼ | | . | ï¿½ï¿½è¦æ€€ç–‘ï¼è¿™å°±æ˜¯å°æ•°ç‚¹ï¼æ„æ€æ˜¯é‡å¤å‰ä¸€ä¸ªåŠ¨ä½œçš„æ„æ€ã€‚ å¦‚æœä½ æƒ³è¦é‡å¤åˆ é™¤ã€é‡å¤è´´ä¸Šç­‰ç­‰åŠ¨ä½œï¼ŒæŒ‰ä¸‹å°æ•°ç‚¹ã€.ã€å°±å¥½äº†ï¼ (å¸¸ç”¨) | n | é‡å¤å‰ä¸€ä¸ªæŸ¥æ‰¾æ“ä½œï¼ˆå¸¸ç”¨ï¼‰ | N | åå‘é‡å¤å‰ä¸€ä¸ªæŸ¥æ‰¾æ“ä½œï¼ˆå¸¸ç”¨ï¼‰ | å…¶ä»–çš„ä¸å¸¸ç”¨æ“ä½œè¿™é‡Œä¸ä½œåˆ—ä¸¾ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹å‘é”®æ“ä½œå…‰æ ‡ä½ç½®ï¼Œæ³¨æ„linuxä¸­çš„æ–¹å‘é”®å¯ä»¥é€šè¿‡hjklåˆ†åˆ«ä»£è¡¨å·¦ä¸‹ä¸Šå³ã€‚è¿™é‡Œç»™å‡ºç§»åŠ¨å…‰æ ‡çš„æ–¹æ³•è¡¨æ ¼ï¼š å¿«æ·é”® åŠŸèƒ½ h æˆ– å‘å·¦ç®­å¤´é”®(â†) å…‰æ ‡å‘å·¦ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ j æˆ– å‘ä¸‹ç®­å¤´é”®(â†“) å…‰æ ‡å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ k æˆ– å‘ä¸Šç®­å¤´é”®(â†‘) å…‰æ ‡å‘ä¸Šç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ l æˆ– å‘å³ç®­å¤´é”®(â†’) å…‰æ ‡å‘å³ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ å¦‚æœä½ å°†å³æ‰‹æ”¾åœ¨é”®ç›˜ä¸Šçš„è¯ï¼Œä½ ä¼šå‘ç° hjkl æ˜¯æ’åˆ—åœ¨ä¸€èµ·çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¿™å››ä¸ªæŒ‰é’®æ¥ç§»åŠ¨å…‰æ ‡ã€‚ å¦‚æœæƒ³è¦è¿›è¡Œå¤šæ¬¡ç§»åŠ¨çš„è¯ï¼Œä¾‹å¦‚å‘ä¸‹ç§»åŠ¨ 30 è¡Œï¼Œå¯ä»¥ä½¿ç”¨ â€œ30jâ€ æˆ– â€œ30â†“â€ çš„ç»„åˆæŒ‰é”®ï¼Œ äº¦å³åŠ ä¸Šæƒ³è¦è¿›è¡Œçš„æ¬¡æ•°(æ•°å­—)åï¼ŒæŒ‰ä¸‹åŠ¨ä½œå³å¯ï¼ Ctrl] + f å±å¹•ã€å‘ä¸‹ã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Down]æŒ‰é”® (å¸¸ç”¨) Ctrl + b å±å¹•ã€å‘ä¸Šã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Up] æŒ‰é”® (å¸¸ç”¨) Ctrl + d å±å¹•ã€å‘ä¸‹ã€ç§»åŠ¨åŠé¡µ Ctrl] + u å±å¹•ã€å‘ä¸Šã€ç§»åŠ¨åŠé¡µ + å…‰æ ‡ç§»åŠ¨åˆ°éç©ºæ ¼ç¬¦çš„ä¸‹ä¸€è¡Œè¡Œé¦– - å…‰æ ‡ç§»åŠ¨åˆ°éç©ºæ ¼ç¬¦çš„ä¸Šä¸€è¡Œè¡Œé¦– n\u003cspace\u003e é‚£ä¸ª n è¡¨ç¤ºã€æ•°å­—ã€ï¼Œä¾‹å¦‚ 20 ã€‚æŒ‰ä¸‹æ•°å­—åå†æŒ‰ç©ºæ ¼é”®ï¼Œå…‰æ ‡ä¼šå‘å³ç§»åŠ¨è¿™ä¸€è¡Œçš„ n ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ 20 åˆ™å…‰æ ‡ä¼šå‘åé¢ç§»åŠ¨ 20 ä¸ªå­—ç¬¦è·ç¦»ã€‚ 0 æˆ–åŠŸèƒ½é”®``Home` è¿™æ˜¯æ•°å­—ã€ 0 ã€ï¼šç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€å‰é¢å­—ç¬¦å¤„ (å¸¸ç”¨) $ æˆ–åŠŸèƒ½é”®``End` ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€åé¢å­—ç¬¦å¤„(å¸¸ç”¨) H å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸Šæ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ M å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„ä¸­å¤®é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ L å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸‹æ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ G ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„æœ€åä¸€è¡Œ(å¸¸ç”¨) :næˆ–nG n ä¸ºæ•°å­—ã€‚ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ n è¡Œã€‚ä¾‹å¦‚ 20G åˆ™ä¼šç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ 20 è¡Œ(å¯é…åˆ :set nu) gg ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ä¸€è¡Œï¼Œç›¸å½“äº 1G å•Šï¼ (å¸¸ç”¨) n\u003cEnter\u003e n ä¸ºæ•°å­—ã€‚å…‰æ ‡å‘ä¸‹ç§»åŠ¨ n è¡Œ(å¸¸ç”¨) f{char} å…‰æ ‡è·³è½¬åˆ°å…‰æ ‡æ‰€åœ¨è¡Œä»å…‰æ ‡å¼€å§‹ä¹‹åçš„charå­—ç¬¦å¤„ã€‚å³ä»å…‰æ ‡ä½ç½®åˆ°è¯¥è¡Œå°¾æ£€ç´¢charå­—ç¬¦ï¼Œå…‰æ ‡ä½ç½®å‰çš„ä¸å¤„ç† F{char} å…‰æ ‡è·³è½¬åˆ°å…‰æ ‡æ‰€åœ¨è¡Œä»å…‰æ ‡å¼€å§‹ä¹‹å‰çš„charå­—ç¬¦å¤„ã€‚å³ä»è¡Œå¼€å¤´åˆ°å…‰æ ‡å¤„æ£€ç´¢charå­—ç¬¦ï¼Œå…‰æ ‡ä½ç½®å‰çš„ä¸å¤„ç† Wæˆ–è€…wï¼ˆå¤§å°å†™å‡å¯ï¼‰ è·³è½¬åˆ°ä¸‹ä¸€ä¸ªå•è¯çš„å¼€å¤´ã€‚æ”¯æŒæ•°å­—å‰ç¼€ bæˆ–è€…Bï¼ˆå¤§å°å†™å‡å¯ï¼‰ è·³è½¬åˆ°ä¸Šä¸€ä¸ªå•è¯çš„å¼€å¤´ã€‚æ”¯æŒæ•°å­—å‰ç¼€ã€‚ { å…‰æ ‡è·³è½¬åˆ°æ®µé¦– } å…‰æ ‡è·³è½¬åˆ°æ®µå°¾ ^ å…‰æ ‡è·³è½¬åˆ°è½¯è¡Œé¦–ã€‚å³è¯¥è¡Œçš„æœ€æ—©éç©ºæ ¼ä½ç½®å­—ç¬¦ã€‚ Eæˆ–eï¼ˆå¤§å°å†™å‡å¯ï¼‰ ç§»åŠ¨åˆ°è¯å°¾ã€‚ ( å¥é¦– ) ä¸‹ä¸€å¥é¦– % æ‹¬å·åŒ¹é…ã€‚ æ­£å¸¸æ¨¡å¼åªæœ‰ä¸€äº›åŸºæœ¬çš„å‘½ä»¤ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é å‘½ä»¤æ¨¡å¼æ¥è¾“å…¥æ›´å¤šçš„å‘½ä»¤ã€‚ 1.2.2 æ’å…¥æ¨¡å¼(Insert-mode) ç”±ä¸Šç›¸ä¿¡å¤§å®¶åº”è¯¥çŸ¥é“æ€ä¹ˆç”±æ­£å¸¸æ¨¡å¼è¿›å…¥è¾“å…¥æ¨¡å¼ï¼Œå³æŒ‰ä¸‹i(insert)å³å¯è¿›å…¥æ’å…¥æ¨¡å¼ã€‚ åœ¨æ’å…¥æ¨¡å¼ä¸­ï¼Œæ“ä½œå’Œæ­£å¸¸çš„æ–‡æœ¬ç¼–è¾‘å™¨å·®ä¸å¤šï¼Œè¿™é‡Œä¸ä½œå™è¿°ã€‚ç»™å‡ºå¯¹åº”çš„å¿«æ·é”®æ“ä½œè¡¨ã€‚ å¿«æ·é”® åŠŸèƒ½ Ctrl + mæˆ–è€…Ctrl + j å¼€å¯æ–°è¡Œ Ctrl + e æ’å…¥å…‰æ ‡ä¸‹çš„å­—ç¬¦ Ctrl + y æ’å…¥å…‰æ ‡ä¸Šçš„å­—ç¬¦ Ctrl + a æ’å…¥ä¸Šæ¬¡æ’å…¥çš„æ–‡æœ¬ Ctrl + @ æ’å…¥ä¸Šæ¬¡æ’å…¥çš„æ–‡æœ¬å¹¶ç»“æŸæ’å…¥æ¨¡å¼ Ctrl + w åˆ é™¤å…‰æ ‡å‰çš„ä¸€ä¸ªå•è¯ Ctrl + u åˆ é™¤å½“å‰è¡Œçš„æ‰€æœ‰å­—ç¬¦ Ctrl + T åœ¨å½“å‰è¡Œé¦–æ’å…¥ä¸€ä¸ªç§»ä½å®½åº¦çš„ç¼©è¿› Ctrl + D ä»å½“å‰è¡Œé¦–åˆ é™¤ä¸€ä¸ªä½ç§»å®½åº¦çš„ç¼©è¿› 1.2.3 å‘½ä»¤æ¨¡å¼(Command -mode) æˆ‘ä»¬åœ¨ä¸€èˆ¬å‘½ä»¤æ¨¡å¼ä¸‹æŒ‰ä¸‹:/?è¿™ä¸‰ä¸ªå­—æ¯ä¸­çš„ä»»æ„ä¸€ä¸ªå°±å¯ä»¥è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼äº†ï¼Œå‘½ä»¤è¡Œåœ¨æœ€ä¸‹é¢ï¼Œå¯ä»¥è¿›è¡ŒæŸ¥æ‰¾ã€æ›¿æ¢ã€ä¿å­˜ã€é€€å‡ºã€é…ç½®ç¼–è¯‘å™¨ç­‰æ“ä½œã€‚éœ€è¦æ³¨æ„çš„å°±æ˜¯æˆ‘ä»¬æ¯æ‰§è¡Œå®Œä¸€ä¸ªå‘½ä»¤ä¹‹åå°±ä¼šå›åˆ°æ­£å¸¸æ¨¡å¼ï¼Œæ‰€ä»¥åœ¨éœ€è¦æ“ä½œçš„æ—¶å€™ä¸€å®šè¦è¾“å…¥:/?è¿™ä¸‰ä¸ªå­—æ¯ä¸­çš„å…¶ä¸­ä¸€ä¸ªã€‚ å½“ç„¶è¾“å…¥ä¸‰ä¸ªå­—æ¯è¿›å…¥å®ç°çš„å‘½ä»¤æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™é‡Œç»™å‡ºå…·ä½“æ“ä½œã€‚ /word -å‘å…‰æ ‡ä¹‹ä¸‹ï¼ˆå‘åæœç´¢ï¼‰å¯»æ‰¾ç¬¬ä¸€ä¸ªå€¼ä¸ºwordçš„å­—ç¬¦ä¸²ã€‚ ?word -å‘å…‰æ ‡ä¹‹ä¸Šï¼ˆå‘å‰æœç´¢ï¼‰å¯»æ‰¾ç¬¬ä¸€ä¸ªå€¼ä¸ºwordçš„å­—ç¬¦ä¸²ã€‚ :n1,n2s/word1/word2/g -n1ä¸n2ä¸ºæ•°å­—ï¼Œåœ¨ç¬¬n1è¡Œä¸n2è¡Œä¹‹é—´å¯»æ‰¾word1è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†å­—ç¬¦ä¸²æ›¿æ¢ä¸ºword2ã€‚ å¦‚æœåœ¨gåé¢åŠ ä¸Šcå‘½ä»¤ï¼Œå³:n1,n2s/word1/word2/gcé‚£ä¹ˆä¼šåœ¨æ›¿æ¢å‰è¦æ±‚ç”¨æˆ·ç¡®è®¤ã€‚ :1,$s/word1/word2/g -å°†å…¨æ–‡çš„word1æ›¿æ¢æˆword2ã€‚ åŒç†ï¼Œå¦‚æœåœ¨gåé¢åŠ ä¸Šcå‘½ä»¤ï¼Œä¹Ÿä¼šè¦æ±‚ç¡®è®¤ã€‚ :w -ä¿å­˜ã€‚ :w! -å¼ºåˆ¶ä¿å­˜ï¼Œå½“æ–‡ä»¶å±æ€§ä¸ºåªè¯»æ—¶å¼ºåˆ¶å†™å…¥ã€‚ä¸è¿‡è¿™è¿˜æ˜¯è·Ÿä½ å¯¹è¯¥æ–‡æ¡£çš„æƒé™æœ‰å…³ã€‚ :q -é€€å‡ºvimã€‚ :q! -å¼ºåˆ¶é€€å‡ºvimã€‚ :wq -ä¿å­˜å¹¶é€€å‡ºã€‚ :set paste -è®¾ç½®æˆç²˜è´´æ¨¡å¼ï¼Œå–æ¶ˆä»£ç è‡ªåŠ¨ç¼©è¿›ã€‚ :set nopaste -å–æ¶ˆç²˜è´´æ¨¡å¼ï¼Œå¼€å¯ä»£ç è‡ªåŠ¨ç¼©è¿›ã€‚ :set nu -æ˜¾ç¤ºè¡Œå·ã€‚ set nonu -éšè—è¡Œå·ã€‚ :noh -å…³é—­æŸ¥æ‰¾å…³é”®è¯é«˜äº®ã€‚ 1.2.4 å¯è§†æ¨¡å¼(Visual-mode) è¿™ä¸ªæ¨¡å¼å­˜åœ¨æ„Ÿå¾ˆä½ï¼Œæœ‰çš„ç”šè‡³å°†å®ƒå½’ç»“ä¸ºæ­£å¸¸æ¨¡å¼ã€‚å› ä¸ºè¿›å…¥å¯è§†æ¨¡å¼æœ€ç›´æ¥çš„ä¸€ä¸ªç›®çš„å°±æ˜¯é€‰ä¸­åŒºåŸŸï¼Œç„¶åå†è¿™ä¸ªåŒºåŸŸä¸Šè¿›è¡Œæ“ä½œï¼Œä¾‹å¦‚åˆ é™¤ï¼Œæ›¿æ¢ç­‰ã€‚ä¸è¿‡ï¼Œæˆ‘è®¤ä¸ºè¿™ä¸ªæ¨¡å¼å¼‚å¸¸é‡è¦ï¼Œå› ä¸ºæŠ€å·§æ€§ç‰¹åˆ«å¤šã€‚ç”¨å¥½äº†è¿™ä¸ªæ¨¡å¼ï¼Œæ•ˆç‡èƒ½å¤§å¤§çš„æé«˜ã€‚ å¦‚ä½•é€‰ä¸­ä¸€å—åŒºåŸŸï¼Ÿ åœ¨vimä¸­æœ‰ä¸‰ç§æ¿€æ´»å¯è§†æ¨¡å¼å¹¶é€‰æ‹©ä¸€å—åŒºåŸŸçš„æ–¹æ³•ï¼š æ¨¡å¼ç±»å‹ æ¿€æ´»æ–¹å¼ é€‰æ‹©æ•ˆæœ å·¦ä¸‹è§’æç¤ºï¼ˆå³æç¤ºä½ å½“å‰å¤„äºä½•ç§æ¨¡å¼ï¼‰ ï¿½ï¿½ç¬¦æ–‡æœ¬ | v`(å°å†™) | é€ä¸ªå­—ç¬¦é€‰æ‹©æ–‡æœ¬ | VISUAL | è¡Œæ–‡æœ¬ | V`(å¤§å†™) | é€è¡Œé€‰æ‹©æ–‡æœ¬ | VISUAL LINE | å—æ–‡æœ¬ | Ctrl + v` | ï¿½ï¿½ç…§å—çš„æ–¹å¼é€‰æ‹©æ–‡æœ¬ | VISUAL BLOCK | å¯èƒ½çœ‹ç€æœ‰ç‚¹æ‡µã€‚æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼Œ å¯¹äºå­—ç¬¦æ–‡æœ¬é€‰æ‹©ï¼Œå®é™…ä¸Šå°±æ˜¯ä»","date":"2022-01-21","objectID":"/posts/02.vim%E6%95%99%E7%A8%8B/:1:2","tags":["Vim"],"title":"Vimæ•™ç¨‹","uri":"/posts/02.vim%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.3 å¿«æ·é”®é€Ÿè§ˆå›¾ ","date":"2022-01-21","objectID":"/posts/02.vim%E6%95%99%E7%A8%8B/:1:3","tags":["Vim"],"title":"Vimæ•™ç¨‹","uri":"/posts/02.vim%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2 å‚è€ƒæ–‡çŒ® yæ€»LinuxåŸºç¡€è¯¾ ç²¾é€š VIM ï¼Œæ­¤æ–‡å°±å¤Ÿäº†-zempty Linux vi/vim - runoob.com vimç¼–è¾‘å™¨ è«è¿Ÿ ","date":"2022-01-21","objectID":"/posts/02.vim%E6%95%99%E7%A8%8B/:2:0","tags":["Vim"],"title":"Vimæ•™ç¨‹","uri":"/posts/02.vim%E6%95%99%E7%A8%8B/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 fork ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:1:0","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.1 åŸºæœ¬ä»‹ç» #include \u003csys/types.h\u003e #include \u003cunistd.h\u003e pid_t fork(void) æè¿° forkç”¨äºåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå®ƒä¸çˆ¶è¿›ç¨‹çš„å”¯ä¸€åŒºåˆ«åœ¨äºå…¶PIDå’ŒPPIDï¼Œä»¥åŠèµ„æºåˆ©ç”¨è®¾ç½®ä¸º0ã€‚æ–‡ä»¶é”å’ŒæŒ‚èµ·ä¿¡å·ï¼ˆæŒ‡å·²ç»è¢«å†…æ ¸å‘é€ç»™ä¸€ä¸ªè¿›ç¨‹ï¼Œä½†å°šæœªè¢«è¯¥è¿›ç¨‹å¤„ç†çš„ä¿¡å·ï¼‰ä¸ä¼šè¢«ç»§æ‰¿ï¼Œå…¶ä»–å’Œçˆ¶è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒï¼šä¼šè·å¾—çˆ¶è¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€æ ˆã€æ•°æ®æ®µã€å †ã€æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·å¤„ç†å‡½æ•°ã€è¿›ç¨‹ä¼˜å…ˆçº§ã€ç¯å¢ƒå˜é‡ç­‰èµ„æºçš„å‰¯æœ¬ã€‚ è¿”å›å€¼ æˆåŠŸæ—¶ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„ PIDï¼Œåœ¨å­è¿›ç¨‹ä¸­è¿”å› $0$ã€‚å¤±è´¥æ—¶ï¼Œçˆ¶è¿›ç¨‹è¿”å› $-1$ï¼Œä¸åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶é€‚å½“è®¾ç½® errnoã€‚ å…¶ä¸­errnoæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒç”¨äºè¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨æˆ–åº“å‡½æ•°è°ƒç”¨äº§ç”Ÿçš„é”™è¯¯ä»£ç ã€‚å½“ç³»ç»Ÿè°ƒç”¨æˆ–åº“å‡½æ•°å¤±è´¥æ—¶ï¼Œå®ƒä»¬é€šå¸¸ä¼šè®¾ç½® errno ä»¥æŒ‡ç¤ºé”™è¯¯çš„åŸå› ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ errno é”™è¯¯ä»£ç åŠå…¶å«ä¹‰ï¼š EAGAINï¼šèµ„æºæš‚æ—¶ä¸å¯ç”¨ï¼Œé€šå¸¸æ˜¯å› ä¸ºè¾¾åˆ°äº†ç³»ç»Ÿé™åˆ¶ï¼Œå¦‚æ–‡ä»¶æè¿°ç¬¦æˆ–å†…å­˜é™åˆ¶ã€‚ ENOMEMï¼šå†…å­˜ä¸è¶³ï¼Œæ— æ³•åˆ†é…è¯·æ±‚çš„èµ„æºã€‚ EACCESï¼šæƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®æŸä¸ªèµ„æºã€‚ EINTRï¼šç³»ç»Ÿè°ƒç”¨è¢«ä¿¡å·ä¸­æ–­ã€‚ EINVALï¼šæ— æ•ˆçš„å‚æ•°ã€‚ é‡ç‚¹ fork() å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¼šä»çˆ¶è¿›ç¨‹å¤åˆ¶æ‰§è¡Œé¡ºåºã€‚å…·ä½“æ¥è¯´ï¼Œå­è¿›ç¨‹ä¼šä»çˆ¶è¿›ç¨‹å¤åˆ¶å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬æŒ‡ä»¤æŒ‡é’ˆï¼ˆinstruction pointerï¼‰å’Œå¯„å­˜å™¨çš„çŠ¶æ€ã€‚è¿™æ„å‘³ç€å­è¿›ç¨‹å°†ä» fork() ç³»ç»Ÿè°ƒç”¨ä¹‹åçš„æŒ‡ä»¤å¼€å§‹æ‰§è¡Œï¼Œä¸çˆ¶è¿›ç¨‹åœ¨ fork() ä¹‹ååº”è¯¥æ‰§è¡Œçš„æŒ‡ä»¤å®Œå…¨ç›¸åŒã€‚å› æ­¤ï¼Œfork() ä¹‹åé€šå¸¸ä¼šæœ‰ä¸€ä¸ªåŸºäºè¿”å›å€¼çš„åˆ†æ”¯ç»“æ„ï¼Œä»¥åŒºåˆ†çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹çš„æ‰§è¡Œè·¯å¾„ã€‚ ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:1:1","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1.2 forkå®ä¾‹ 1.2.1 1.2.1å¤šä¸ªforkè¿”å›å€¼ #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e int main() { pid_t pid1 = fork(); pid_t pid2 = fork(); pid_t pid3 = fork(); pid_t pid = getpid(); printf(\"The PID of the current process is %d\\n Hello World from (%d, %d, %d)\\n\", pid, pid1, pid2, pid3); return 0; } è¿™æ®µç¨‹åºåŒ…å«äº†ä¸‰ä¸ª fork() è°ƒç”¨ï¼Œæ¯ä¸ª fork() éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ã€‚ç”±äºæ¯æ¬¡ fork() è°ƒç”¨éƒ½ä¼šå¯¼è‡´è¿›ç¨‹æ•°ç¿»å€ï¼Œæ‰€ä»¥æ€»å…±ä¼šæœ‰$2^3=8$ä¸ªè¿›ç¨‹ ï¼ˆåŒ…æ‹¬æœ€åˆçš„çˆ¶è¿›ç¨‹ï¼‰ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šæ‰“å°å‡ºå®ƒçš„è¿›ç¨‹ ID (pid) ä»¥åŠä¸‰ä¸ª fork() è°ƒç”¨çš„è¿”å›å€¼ (pid1, pid2, pid3)ã€‚ å¾—åˆ°çš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š æˆ‘ä»¬ç”»ä¸ªçŠ¶æ€æœºæ¥ç†è§£å®ƒä»¬çš„è¾“å‡ºï¼Œå‡è®¾æœ€åˆçš„çˆ¶è¿›ç¨‹PIDä¸º291871ï¼š 1.2.2 Cè¯­è¨€ forkä¸è¾“å‡º #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e int main(int argc, char *argv[]) { int n = 2; for (int i = 0; i \u003c n; i++) { fork(); printf(\"Hello\\n\"); } for (int i = 0; i \u003c n; i++) { wait(NULL); } } è¿™æ®µä»£ç ä¸­ï¼ŒæŒ‰æˆ‘ä»¬çš„ç†è§£ï¼Œç¬¬ä¸€æ¬¡forkåæœ‰2ä¸ªè¿›ç¨‹ï¼Œç„¶åä¸€èµ·æ‰§è¡Œprintfè¾“å‡ºï¼Œå¾—åˆ°ä¸¤ä¸ªHelloï¼Œç„¶åç¬¬äºŒæ¬¡forkåæœ‰4ä¸ªè¿›ç¨‹ï¼Œç„¶åæ‰§è¡Œprintfï¼Œå¾—åˆ°å››ä¸ªHelloï¼Œåˆ™ä¼šæœ‰6ä¸ª``Hello`ï¼Œå¦‚ä¸‹ï¼š ä½†æ˜¯å½“æˆ‘ä»¬å°†è¾“å‡ºé€šè¿‡ç®¡é“ä¼ ç»™catç­‰å‘½ä»¤æ—¶ï¼Œä¼šçœ‹åˆ°8ä¸ªHelloï¼š è¿™æ˜¯å› ä¸ºæ ‡å‡†è¾“å‡ºä¸€èˆ¬æ˜¯è¡Œç¼“å†²çš„ï¼Œç¢°åˆ°\\nï¼Œç¼“å†²åŒºä¸­çš„å†…å®¹ä¼šè¢«åˆ·æ–°ï¼Œå³è¾“å‡ºåˆ°ç»ˆç«¯æˆ–æ–‡ä»¶ä¸­ã€‚è¿™ç§ç¼“å†²æ–¹å¼çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å‡å°‘å¯¹ç£ç›˜ I/O çš„è°ƒç”¨æ¬¡æ•°ã€‚ å¦‚æœæ ‡å‡†è¾“å‡ºè¢«é‡å®šå‘åˆ°ç®¡é“ï¼Œå®ƒå¯èƒ½ä¸å†æ˜¯è¡Œç¼“å†²çš„ï¼Œè€Œæ˜¯å˜ä¸ºå…¨ç¼“å†²çš„ã€‚è¿™æ„å‘³ç€ç¼“å†²åŒºå¯èƒ½ä¼šåœ¨å¡«æ»¡æ—¶åˆ·æ–°ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡é‡åˆ°æ¢è¡Œç¬¦æ—¶åˆ·æ–°ã€‚å¦‚æœç¼“å†²åŒºè¶³å¤Ÿå¤§ï¼Œä»¥è‡³äºå¯ä»¥å®¹çº³æ‰€æœ‰çš„ Hello è¾“å‡ºï¼Œé‚£ä¹ˆforkçš„æ—¶å€™å­è¿›ç¨‹ä¹Ÿä¼šå¤åˆ¶ç¼“å†²åŒºï¼Œå¯¼è‡´æœ€åæ¯ä¸ªè¿›ç¨‹ä¸­çš„ç¼“å†²åŒºéƒ½æœ‰2ä¸ªHelloï¼Œæœ€åè¾“å‡ºä¸º8ä¸ªã€‚ å¦‚æœä¸ºäº†ç¡®ä¿ç¼“å†²åŒºåœ¨éœ€è¦çš„æ—¶å€™è¢«åˆ·æ–°ï¼Œå¯ä»¥åœ¨ printf è°ƒç”¨ä¹‹åæ˜¾å¼åœ°è°ƒç”¨ fflush(stdout) æ¥åˆ·æ–°æ ‡å‡†è¾“å‡ºç¼“å†²åŒºã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ‰€æœ‰çš„è¾“å‡ºéƒ½è¢«ç«‹å³å†™å…¥ï¼Œè€Œä¸ä¼šå—åˆ°ç¼“å†²è¡Œä¸ºçš„å½±å“ã€‚ #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e int main(int argc, char *argv[]) { int n = 2; for (int i = 0; i \u003c n; i++) { fork(); printf(\"Hello\\n\"); fflush(stdout); } for (int i = 0; i \u003c n; i++) { wait(NULL); } return 0; } 1.2.3 fork ğŸ’£ #include \u003cstdio.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e int main(int argc, char *argv[]) { while(1) { fork(); } return 0; } è¿™æ®µä»£ç ä¼šæ— é™å¾ªç¯åœ°è°ƒç”¨ fork() å‡½æ•°ï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ã€‚ç”±äºæ¯æ¬¡ fork() è°ƒç”¨éƒ½ä¼šæˆåŠŸåˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œè€Œä¸”è¿™ä¸ªæ–°è¿›ç¨‹åˆä¼šç«‹å³è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯å¹¶å†æ¬¡è°ƒç”¨ fork()ï¼Œå› æ­¤è¿›ç¨‹çš„æ•°é‡ä¼šä»¥æŒ‡æ•°é€Ÿåº¦å¢é•¿ï¼Œå¾ˆå¿«å°±ä¼šè€—å°½ç³»ç»Ÿçš„å¯ç”¨èµ„æºã€‚ ç»å¯¹ä¸è¦åœ¨ä»»ä½•ç”Ÿäº§ç¯å¢ƒæˆ–æ‚¨æ²¡æœ‰æƒé™çš„ä»»ä½•ç³»ç»Ÿä¸Šè¿è¡Œforkç‚¸å¼¹ã€‚ ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:1:2","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 vfork ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:2:0","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.1 åŸºæœ¬ä»‹ç» æè¿° #include \u003csys/types.h\u003e #include \u003cunistd.h\u003e pid_t vfork(void); vfork() ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œä¸ fork() ç±»ä¼¼ï¼Œä½†å®ƒä½¿ç”¨çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè€Œä¸æ˜¯å¤åˆ¶çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚vfork() è°ƒç”¨åï¼Œçˆ¶è¿›ç¨‹ä¼šé˜»å¡ï¼Œç›´åˆ°å­è¿›ç¨‹è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œäº† exit å‡½æ•°ã€‚è¿™æ˜¯å› ä¸ºå­è¿›ç¨‹éœ€è¦ç‹¬å çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚ä¸€ã€‚åœ¨å­è¿›ç¨‹è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œäº† exit å‡½æ•°ä¹‹åï¼Œå­è¿›ç¨‹å°†è·å¾—è‡ªå·±çš„å†…å­˜ç©ºé—´ã€‚ è¿”å›å€¼ å’Œforkä¸€è‡´ é‡ç‚¹ vfork() åˆ›å»ºçš„å­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„ç¯å¢ƒï¼Œä½†ä¸ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„å †æ ˆã€‚ åœ¨å­è¿›ç¨‹æ‰§è¡Œè¿™äº›execæˆ–exitæ“ä½œä¹‹å‰ï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å¯èƒ½ä¼šè®¿é—®ç›¸åŒçš„å†…å­˜åœ°å€ï¼Œè¿™å¯èƒ½å¯¼è‡´æ•°æ®ç«äº‰å’Œä¸ä¸€è‡´ã€‚ åœ¨ vfork() è°ƒç”¨æˆåŠŸåï¼Œå­è¿›ç¨‹åº”è¯¥ç«‹å³è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œ exit å‡½æ•°ã€‚å¦‚æœåœ¨å­è¿›ç¨‹ä¸­ä¿®æ”¹é™¤äº†ç”¨äºå­˜å‚¨ä» vfork() è¿”å›å€¼çš„ pid_t ç±»å‹å˜é‡ä¹‹å¤–çš„ä»»ä½•æ•°æ®ï¼Œæˆ–è€…ä»è°ƒç”¨ vfork() çš„å‡½æ•°è¿”å›ï¼Œæˆ–åœ¨æˆåŠŸè°ƒç”¨ _exit() æˆ– exec() å‡½æ•°æ—ä¸­çš„ä¸€ä¸ªå‡½æ•°ä¹‹å‰è°ƒç”¨å…¶ä»–ä»»ä½•å‡½æ•°ï¼Œåˆ™è¡Œä¸ºæ˜¯æœªå®šä¹‰çš„ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–è¡¨ç°å‡ºä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚ å› æ­¤ï¼Œä½¿ç”¨ vfork() æ—¶ï¼Œå¿…é¡»ç¡®ä¿å­è¿›ç¨‹åœ¨è°ƒç”¨ exec å‡½æ•°æˆ–æ‰§è¡Œ exit å‡½æ•°ä¹‹å‰ä¸æ‰§è¡Œä»»ä½•å¯èƒ½å½±å“å…±äº«å†…å­˜çš„æ“ä½œã€‚ vfork() ç³»ç»Ÿè°ƒç”¨ä¼šé˜»å¡çˆ¶è¿›ç¨‹ï¼Œç›´åˆ°å­è¿›ç¨‹å®Œæˆ exec è°ƒç”¨æˆ– exit è°ƒç”¨ã€‚çˆ¶è¿›ç¨‹ä¸éœ€è¦æ˜¾å¼è°ƒç”¨ wait() æˆ– waitpid() æ¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸã€‚ ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:2:1","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2.2 éªŒè¯vforkå…±äº«å†…å­˜ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cunistd.h\u003e #include \u003csys/wait.h\u003e #include \u003cstring.h\u003e #include \u003cassert.h\u003e int main() { // åœ¨çˆ¶è¿›ç¨‹ä¸­åˆ†é…å†…å­˜å¹¶åˆå§‹åŒ– char *buffer = malloc(1024); assert(buffer != NULL); memset(buffer, 'A', 1024); // ä½¿ç”¨vforkåˆ›å»ºå­è¿›ç¨‹ pid_t pid = vfork(); if (pid \u003c 0) { perror(\"vfork error\"); exit(EXIT_FAILURE); } else if (pid == 0) { // å­è¿›ç¨‹ printf(\"Child process: PID = %d\\n\", getpid()); // ä¿®æ”¹å†…å®¹ memset(buffer, 'B', 1024); // å­è¿›ç¨‹ char * const argv[] = {\"/bin/echo\", \"Hello, Linux!\", NULL}; char * const envp[] = {NULL}; // æ‰§è¡Œexecå‡½æ•° execve(argv[0], argv, envp); } else { // çˆ¶è¿›ç¨‹ printf(\"Parent process: PID = %d, child's PID = %d\\n\", getpid(), pid); // éªŒè¯å†…å­˜å†…å®¹æ˜¯å¦è¢«å­è¿›ç¨‹ä¿®æ”¹ for (int i = 0; i \u003c 1024; i++) { if (buffer[i] != 'B') { printf(\"Memory corruption detected at index %d\\n\", i); exit(EXIT_FAILURE); } } printf(\"Memory is consistent\\n\"); } return 0; } è¿™ä¸ªç¨‹åºçš„ç›®çš„æ˜¯éªŒè¯åœ¨ vfork() ä¹‹åï¼Œå­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹æ˜¯å¦å…±äº«å†…å­˜ã€‚é¦–å…ˆåœ¨çˆ¶è¿›ç¨‹ä¸­åˆ†é…ä¸€å—å†…å­˜ ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸ºå­—ç¬¦ â€˜Aâ€™ã€‚ç„¶åï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨ vfork() åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚åœ¨å­è¿›ç¨‹ä¸­ï¼Œç¨‹åºè¯•å›¾å°†å†…å®¹ä¿®æ”¹ä¸ºå­—ç¬¦ â€˜Bâ€™ï¼Œå¹¶æ‰§è¡Œ execve()ã€‚åœ¨çˆ¶è¿›ç¨‹ä¸­ï¼Œç¨‹åºæ£€æŸ¥ç¼“å†²åŒºçš„å†…å®¹æ˜¯å¦è¢«ä¿®æ”¹ä¸ºå­—ç¬¦ â€˜Bâ€™ï¼Œä»¥éªŒè¯å†…å­˜æ˜¯å¦è¢«æ­£ç¡®å…±äº«ã€‚ ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:2:2","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 clone ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:3:0","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.1 åŸºæœ¬ä»‹ç» æè¿° #define _GNU_SOURCE #include \u003csched.h\u003e int clone(int (*fn)(void *), void *child_stack, int flags, void *arg, ... /* pid_t *parent_tid, void *tls, pid_t *child_tid */ ); cloneä¸forkç±»ä¼¼ï¼Œæ˜¯ç”¨äºåˆ›å»ºæ–°è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä½†cloneæä¾›äº†æ›´ç²¾ç¡®çš„æ§åˆ¶ï¼Œå¯ä»¥ç¡®å®šåœ¨è°ƒç”¨è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰å’Œå­è¿›ç¨‹ä¹‹é—´å…±äº«å“ªäº›æ‰§è¡Œä¸Šä¸‹æ–‡çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œè°ƒç”¨è€…å¯ä»¥æ§åˆ¶ä¸¤ä¸ªè¿›ç¨‹æ˜¯å¦å…±äº«è™šæ‹Ÿåœ°å€ç©ºé—´ã€æ–‡ä»¶æè¿°ç¬¦è¡¨å’Œä¿¡å·å¤„ç†ç¨‹åºè¡¨ã€‚è¿™äº›ç³»ç»Ÿè°ƒç”¨è¿˜å…è®¸å°†æ–°çš„å­è¿›ç¨‹æ”¾ç½®åœ¨å•ç‹¬çš„å‘½åç©ºé—´ä¸­ã€‚ å‚æ•° fnæ˜¯æŒ‡å‘æ–°è¿›ç¨‹è¦æ‰§è¡Œçš„å‡½æ•°çš„æŒ‡é’ˆï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª void* å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª int ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªè¿”å›å€¼å°†è¢« clone ç³»ç»Ÿè°ƒç”¨æ•è·ï¼Œå¹¶ä½œä¸ºå­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼› child_stackæ˜¯æ–°è¿›ç¨‹çš„å †æ ˆåœ°å€ï¼Œç”±äºå­è¿›ç¨‹å’Œè°ƒç”¨è¿›ç¨‹å¯èƒ½å…±äº«å†…å­˜ï¼Œå› æ­¤å­è¿›ç¨‹ä¸å¯èƒ½ä¸è°ƒç”¨è¿›ç¨‹åœ¨åŒä¸€å †æ ˆä¸­æ‰§è¡Œã€‚è°ƒç”¨è¿›ç¨‹å¿…é¡»ä¸ºå­å †æ ˆè®¾ç½®å†…å­˜ç©ºé—´ï¼Œå¹¶å°†æŒ‡å‘è¯¥ç©ºé—´çš„æŒ‡é’ˆä¼ é€’ç»™clone()ã€‚ flagså¯ä»¥è®¾ç½®æ–°è¿›ç¨‹çš„å±æ€§ï¼ˆé€šè¿‡äºŒè¿›åˆ¶ä½è®¾ç½®ï¼‰ï¼ŒåŒ…æ‹¬æ˜¯å¦ä¸åŸè¿›ç¨‹å…±äº«åœ°å€ç©ºé—´ï¼ˆCLONE_VMï¼‰ã€æ˜¯å¦å…±äº«æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼ˆCLONE_FILESï¼‰ã€æ˜¯å¦å…±äº«ä¿¡å·å¤„ç†å™¨ï¼ˆCLONE_SIGHANDï¼‰ç­‰ç­‰ï¼› int flags = CLONE_VM | CLONE_FS | CLONE_FILES | CLONE_SIGHAND | CLONE_THREAD | CLONE_SYSVSEM | CLONE_SETTLS; æ ‡å¿— å«ä¹‰ CLONE_PARENT åˆ›å»ºçš„å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹æ˜¯è°ƒç”¨è€…çš„çˆ¶è¿›ç¨‹ï¼Œæ–°è¿›ç¨‹ä¸åˆ›å»ºå®ƒçš„è¿›ç¨‹æˆäº†â€œå…„å¼Ÿâ€è€Œä¸æ˜¯â€œçˆ¶å­â€ CLONE_FS å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬rootã€å½“å‰ç›®å½•ã€umask CLONE_FILES å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰è¡¨ CLONE_NEWNS åœ¨æ–°çš„namespaceå¯åŠ¨å­è¿›ç¨‹ï¼Œnamespaceæè¿°äº†è¿›ç¨‹çš„æ–‡ä»¶hierarchy CLONE_SIGHAND å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„ä¿¡å·å¤„ç†ï¼ˆsignal handlerï¼‰è¡¨ CLONE_PTRACE è‹¥çˆ¶è¿›ç¨‹è¢«traceï¼Œå­è¿›ç¨‹ä¹Ÿè¢«trace CLONE_VFORK çˆ¶è¿›ç¨‹è¢«æŒ‚èµ·ï¼Œç›´è‡³å­è¿›ç¨‹é‡Šæ”¾è™šæ‹Ÿå†…å­˜èµ„æº CLONE_VM å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹è¿è¡Œäºç›¸åŒçš„å†…å­˜ç©ºé—´ CLONE_PID å­è¿›ç¨‹åœ¨åˆ›å»ºæ—¶PIDä¸çˆ¶è¿›ç¨‹ä¸€è‡´ CLONE_THREAD Linux 2.4ä¸­å¢åŠ ä»¥æ”¯æŒPOSIXçº¿ç¨‹æ ‡å‡†ï¼Œå­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«ç›¸åŒçš„çº¿ç¨‹ç¾¤ argæ˜¯ä¼ é€’ç»™æ–°è¿›ç¨‹çš„å‚æ•°ï¼› å¯é€‰å‚æ•°ï¼ŒåŒ…æ‹¬ pid_t *parent_tidç­‰ã€‚ è¿”å›å€¼ æˆåŠŸæ—¶ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„ PIDã€‚å¤±è´¥æ—¶ï¼Œçˆ¶è¿›ç¨‹è¿”å› $-1$ï¼Œä¸åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶é€‚å½“è®¾ç½® errnoã€‚ é‡ç‚¹ clone å¯ä»¥åˆ›å»ºæ–°çš„è¿›ç¨‹æˆ–çº¿ç¨‹ï¼ŒLinuxåˆ›å»ºçº¿ç¨‹ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨å°±æ˜¯cloneã€‚è€Œ fork å’Œvforkåªèƒ½åˆ›å»ºè¿›ç¨‹ã€‚è¿™æ„å‘³ç€ clone å¯ä»¥åœ¨å•ä¸ªè¿›ç¨‹ä¸­åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œè€Œ fork åˆ™æ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ã€‚ clone æä¾›æ¯” fork å’Œ vfork æ›´å¤šçš„é€‰é¡¹ï¼Œå¯ä»¥æŒ‡å®šå­è¿›ç¨‹æˆ–çº¿ç¨‹çš„å †æ ˆã€ä¿¡å·å¤„ç†ã€æƒé™ç­‰ã€‚ clone çš„ä½¿ç”¨æ¯” fork å’Œ vfork æ›´å¤æ‚ï¼Œéœ€è¦æ­£ç¡®è®¾ç½® flagsã€child_stackã€parent_pidptrã€ptrã€stack_size å’Œ tls ç­‰å‚æ•°ã€‚ ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:3:1","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3.2 cloneä½¿ç”¨ #define _GNU_SOURCE #include \u003csched.h\u003e #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cstring.h\u003e #include \u003csys/wait.h\u003e #include \u003cunistd.h\u003e #define STACK_SIZE (1024 * 1024) /* Stack size for cloned child */ // å®ï¼Œç®€åŒ–é”™è¯¯å¤„ç† #define ERREXIT(msg) { perror(msg); exit(EXIT_FAILURE); } // å®‰å…¨åˆ†é…å†…å­˜å‡½æ•°ï¼Œåˆ†é…å¤±è´¥æŠ¥å‘Šé”™è¯¯ #define CHECKALLOC(ptr, msg) ({ void *p = ptr; if (p == NULL) {ERREXIT(msg);} p;}) /* * å­è¿›ç¨‹å‡½æ•° * params: æ¥å—ä¸€ä¸ªvoid *ç±»å‹å‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œåé¢çš„å£°æ˜æ˜¯ç”¨äºå‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå‚æ•°æ˜¯æœªè¢«ä½¿ç”¨çš„ */ static int childFunc(void *arg __attribute__((unused))) { puts(\"child: start\"); sleep(2); puts(\"child: terminate\"); return 0; /* Child terminates now */ } int main(int argc, char *argv[]) { /* Start of stack buffer */ char **stacks; /* Child process's pids */ pid_t *pids; size_t nproc, i; // æ¥å—ä¸¤ä¸ªå‚æ•° if (argc != 2) { puts(\"Wrong way to execute the program:\\n\" \"\\t\\t./waitpid nProcesses\\n\" \"example:\\t./waitpid 2\"); return EXIT_FAILURE; } // åˆå§‹åŒ–nprocï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„å­è¿›ç¨‹æ•° nproc = atol(argv[1]); /* Process count */ // åˆ†é…å†…å­˜ç©ºé—´ stacks = CHECKALLOC(malloc(nproc * sizeof(void *)), \"malloc\"); pids = CHECKALLOC(malloc(nproc * sizeof(pid_t)), \"malloc\"); for (i = 0; i \u003c nproc; i++) { char *stackTop; /* End of stack buffer */ stacks[i] = CHECKALLOC(malloc(STACK_SIZE), \"stack malloc\"); // å¾—åˆ°æ ˆé¡¶ä½ç½® stackTop = stacks[i] + STACK_SIZE; /* * åˆ›å»ºå­è¿›ç¨‹ * ç¬¬ä¸€ä¸ªæ ‡å¿—è¡¨ç¤ºåœ¨å­è¿›ç¨‹æ¸…é™¤çº¿ç¨‹ç»„IDï¼ˆTIDï¼‰ï¼Œç›®çš„æ˜¯ä¸ºäº†é¿å…å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹æˆ–å…¶ä»–å­è¿›ç¨‹çš„çº¿ç¨‹ç»„IDå†²çª * ç¬¬äºŒä¸ªè¡¨ç¤ºå‘Šè¯‰åœ¨å­è¿›ç¨‹ä¸­è®¾ç½®çº¿ç¨‹IDï¼Œç›®çš„æ˜¯ä¸ºäº†å…è®¸çˆ¶è¿›ç¨‹åœ¨å­è¿›ç¨‹ä¸­è¿½è¸ªçº¿ç¨‹ * å‘Šè¯‰ clone ç³»ç»Ÿè°ƒç”¨åœ¨å­è¿›ç¨‹ä¸­é‡æ–°å®‰è£…ä¿¡å·å¤„ç†ç¨‹åºï¼Œç›®çš„æ˜¯ä¸ºäº†å…è®¸å­è¿›ç¨‹æ•è·å’Œå¤„ç†ä¿¡å·ï¼Œè€Œä¸æ˜¯ä¼ é€’ç»™çˆ¶è¿›ç¨‹ã€‚ */ pids[i] = clone(childFunc, stackTop, CLONE_CHILD_CLEARTID | CLONE_CHILD_SETTID | SIGCHLD, NULL); if (pids[i] == -1) ERREXIT(\"clone\"); printf(\"clone() returned %ld\\n\", (long)pids[i]); } sleep(1); // ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹ for (i = 0; i \u003c nproc; i++) { // ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­è¿›ç¨‹idï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä¸å…³å¿ƒå­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºç­‰å¾…ä»»ä½•å­è¿›ç¨‹ if (waitpid(pids[i], NULL, 0) == -1) ERREXIT(\"waitpid\"); printf(\"child %ld has terminated\\n\", (long)pids[i]); } // å›æ”¶å†…å­˜ç©ºé—´ for (i = 0; i \u003c nproc; i++) free(stacks[i]); free(stacks); free(pids); return EXIT_SUCCESS; } è¿è¡Œï¼šgcc clone-example.c \u0026\u0026 ./a.out 5ï¼Œå…¶ä¸­5ä¸ºnprocï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„è¿›ç¨‹æ•°ã€‚ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š ","date":"2022-01-21","objectID":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/:3:2","tags":["Linux","ç³»ç»Ÿè°ƒç”¨"],"title":"Linux ç³»ç»Ÿè°ƒç”¨å‡½æ•°forkã€vforkã€cloneè¯¦è§£","uri":"/posts/08.linux-forkvforkclone%E8%AF%A6%E8%A7%A3/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"1 1. é€šç”¨åŸºç¡€çŸ¥è¯† æŸ¥è¯¢æŒ‡ä»¤å‘½ä»¤helpï¼Œé€šè¿‡æŒ‡ä»¤å --helpæˆ–è€…man æŒ‡ä»¤åã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥è¯¢lsè¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°ç”¨æ³•ä»¥åŠä½œç”¨ï¼Œå³é€šè¿‡ls --helpå³å¯å¾—åˆ°å¦‚ä¸‹ï¼š ctrl cï¼šå–æ¶ˆå‘½ä»¤ï¼Œå¹¶ä¸”æ¢è¡Œã€‚ ctrl uï¼šæ¸…ç©ºæœ¬è¡Œå‘½ä»¤ tabï¼šè¡¥å…¨å‘½ä»¤å’Œæ–‡ä»¶åï¼Œå¦‚æœè¡¥å…¨ä¸äº†å°±å¿«é€ŸæŒ‰ä¸¤ä¸‹tabé”®ï¼Œå¯ä»¥æ˜¾ç¤ºå¤‡é€‰é¡¹ã€‚ ","date":"2022-01-21","objectID":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/:1:0","tags":["Linux"],"title":"Linuxå¸¸ç”¨æ–‡ä»¶ç®¡ç†å‘½ä»¤","uri":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"2 2. æ–‡ä»¶åŸºç¡€æ“ä½œ æ³¨æ„äº‹é¡¹ å¦‚æœæ–‡ä»¶åæˆ–è€…æ–‡ä»¶å¤¹åå­˜åœ¨ç©ºæ ¼æˆ–è€…ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œæˆ‘ä»¬è¦è¿›è¡Œè½¬ç§»è¡¨ç¤ºï¼Œå³é€šè¿‡è½¬ç§»å­—ç¬¦\\æ¥å®ç°ã€‚ åˆ›å»ºæ–‡ä»¶å¤¹ï¼šmkdir [-p][dirNmae] å…¶ä¸­-pç¡®ä¿ç›®å½•åç§°ä¸€å®šå­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±ä¼šåˆ›å»ºä¸€ä¸ªã€‚ åˆ›å»ºæ–‡ä»¶ï¼štouch [dirName + fileName] æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹æˆ–è€…æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼šls [å‚æ•°][dirName] å…¶ä¸­æ˜¾ç¤ºçš„è“è‰²æ˜¯æ–‡ä»¶å¤¹ï¼Œç™½è‰²æ˜¯æ™®é€šæ–‡ä»¶ï¼Œç»¿è‰²æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚å›¾ï¼š å‚æ•°æœ‰ï¼š -aæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶åŠç›®å½• (. å¼€å¤´çš„éšè—æ–‡ä»¶ä¹Ÿä¼šåˆ—å‡º) -lé™¤æ–‡ä»¶åç§°å¤–ï¼Œäº¦å°†æ–‡ä»¶å‹æ€ã€æƒé™ã€æ‹¥æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰èµ„è®¯è¯¦ç»†åˆ—å‡º -r å°†æ–‡ä»¶ä»¥ç›¸åæ¬¡åºæ˜¾ç¤º(åŸå®šä¾è‹±æ–‡å­—æ¯æ¬¡åº) -t å°†æ–‡ä»¶ä¾å»ºç«‹æ—¶é—´ä¹‹å…ˆåæ¬¡åºåˆ—å‡º -A åŒ -a ï¼Œä½†ä¸åˆ—å‡º â€œ.â€ (ç›®å‰ç›®å½•) åŠ â€œ..â€ (çˆ¶ç›®å½•) -F åœ¨åˆ—å‡ºçš„æ–‡ä»¶åç§°ååŠ ä¸€ç¬¦å·ï¼›ä¾‹å¦‚å¯æ‰§è¡Œæ¡£åˆ™åŠ  â€œ*â€, ç›®å½•åˆ™åŠ  â€œ/â€ -R è‹¥ç›®å½•ä¸‹æœ‰æ–‡ä»¶ï¼Œåˆ™ä»¥ä¸‹ä¹‹æ–‡ä»¶äº¦çš†ä¾åºåˆ—å‡º æ˜¾ç¤ºç›®å‰æ‰€åœ¨çš„å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„åç§°ï¼špwd åˆ‡æ¢å½“å‰å·¥ä½œç›®å½•ï¼šcd [dirName] å…¶ä¸­dirNameå¯ä¸ºç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºï¼Œé»˜è®¤è¿”å›å®¶ç›®å½•ã€‚cd -ä¼šè¿”å›ä¹‹å‰çš„å·¥ä½œç›®å½• åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼šrm [dirName] [options]ï¼Œ å…¶ä¸­é€‰é¡¹åŒ…æ‹¬ï¼š ` -i` åˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤ã€‚ -f å³ä½¿åŸæ¡£æ¡ˆå±æ€§è®¾ä¸ºå”¯è¯»ï¼Œäº¦ç›´æ¥åˆ é™¤ï¼Œæ— éœ€é€ä¸€ç¡®è®¤ã€‚ -r å°†ç›®å½•åŠä»¥ä¸‹ä¹‹æ¡£æ¡ˆäº¦é€ä¸€åˆ é™¤,é€’å½’æ‰€æœ‰çš„å­ç›®å½•,é€ä¸€è¯¢é—®ã€‚ ä¸€èˆ¬åˆ é™¤æ™®é€šæ–‡ä»¶ç›´æ¥ä½¿ç”¨rm [dirName] åˆ›å»ºç¼–å†™æ–‡ä»¶ï¼švim [dirName] åˆ›å»ºå¥½ä¹‹åä¼šè‡ªåŠ¨è¿›å…¥æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬äº‹å†™ä¸åŠ¨ä¸œè¥¿çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¾“å…¥å°å†™å­—æ¯iï¼ˆä¸ºinsertçš„ç¼©å†™ï¼‰å³å¯å†™å…¥ï¼Œå†™å®Œä¹‹åå¦‚ä½•ä¿å­˜ï¼Ÿæˆ‘ä»¬å…ˆéœ€è¦æŒ‰ESCé”®é”ä½æ–‡ä»¶ï¼Œå†è¾“å…¥:wqå³å¯ï¼Œè¿™ä¸ªå‘½ä»¤å°±æ˜¯ä¿å­˜å¹¶é€€å‡ºçš„æ„æ€ã€‚ æŸ¥çœ‹æ–‡ä»¶ï¼šcat [dirName] å¤åˆ¶æ–‡ä»¶ï¼šcp [options] source dest å…¶ä¸­å‚æ•°è¯´æ˜ï¼š -aï¼šæ­¤é€‰é¡¹é€šå¸¸åœ¨å¤åˆ¶ç›®å½•æ—¶ä½¿ç”¨ï¼Œå®ƒä¿ç•™é“¾æ¥ã€æ–‡ä»¶å±æ€§ï¼Œå¹¶å¤åˆ¶ç›®å½•ä¸‹çš„æ‰€æœ‰å†…å®¹ã€‚å…¶ä½œç”¨ç­‰äºdpRå‚æ•°ç»„åˆã€‚ -dï¼šå¤åˆ¶æ—¶ä¿ç•™é“¾æ¥ã€‚è¿™é‡Œæ‰€è¯´çš„é“¾æ¥ç›¸å½“äº Windows ç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼ã€‚ -fï¼šè¦†ç›–å·²ç»å­˜åœ¨çš„ç›®æ ‡æ–‡ä»¶è€Œä¸ç»™å‡ºæç¤ºã€‚ -iï¼šä¸ -f é€‰é¡¹ç›¸åï¼Œåœ¨è¦†ç›–ç›®æ ‡æ–‡ä»¶ä¹‹å‰ç»™å‡ºæç¤ºï¼Œè¦æ±‚ç”¨æˆ·ç¡®è®¤æ˜¯å¦è¦†ç›–ï¼Œå›ç­” y æ—¶ç›®æ ‡æ–‡ä»¶å°†è¢«è¦†ç›–ã€‚ -pï¼šé™¤å¤åˆ¶æ–‡ä»¶çš„å†…å®¹å¤–ï¼Œè¿˜æŠŠä¿®æ”¹æ—¶é—´å’Œè®¿é—®æƒé™ä¹Ÿå¤åˆ¶åˆ°æ–°æ–‡ä»¶ä¸­ã€‚ -rï¼šè‹¥ç»™å‡ºçš„æºæ–‡ä»¶æ˜¯ä¸€ä¸ªç›®å½•æ–‡ä»¶ï¼Œæ­¤æ—¶å°†å¤åˆ¶è¯¥ç›®å½•ä¸‹æ‰€æœ‰çš„å­ç›®å½•å’Œæ–‡ä»¶ã€‚å¤åˆ¶ç›®å½•çš„æ—¶å€™ä¸€å®šè¦æ·»åŠ çš„å‚æ•° -lï¼šä¸å¤åˆ¶æ–‡ä»¶ï¼Œåªæ˜¯ç”Ÿæˆé“¾æ¥æ–‡ä»¶ã€‚ å³cp = å¤åˆ¶+ç²˜è´´+é‡å‘½åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸ªä¾‹å­cp a/tmp.txt b/tmp2.txtï¼Œé‚£ä¹ˆä¼šä»aä¸­çš„ tmp.txtå¤åˆ¶åˆ°bä¸­å¹¶é‡å‘½åä¸ºtmp2.txtã€‚ ä¸ºæ–‡ä»¶æˆ–ç›®å½•æ”¹åã€æˆ–å°†æ–‡ä»¶æˆ–ç›®å½•ç§»å…¥å…¶å®ƒä½ç½®ï¼šmv [options] source destã€‚ å¦‚æœéœ€è¦é‡å‘½åï¼Œå°±åœ¨åé¢åŠ ä¸Šæ–°çš„æ–‡ä»¶åã€‚ å…¶ä¸­å‚æ•°è¯´æ˜ -b: å½“ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•å­˜åœ¨æ—¶ï¼Œåœ¨æ‰§è¡Œè¦†ç›–å‰ï¼Œä¼šä¸ºå…¶åˆ›å»ºä¸€ä¸ªå¤‡ä»½ã€‚ -i: å¦‚æœæŒ‡å®šç§»åŠ¨çš„æºç›®å½•æˆ–æ–‡ä»¶ä¸ç›®æ ‡çš„ç›®å½•æˆ–æ–‡ä»¶åŒåï¼Œåˆ™ä¼šå…ˆè¯¢é—®æ˜¯å¦è¦†ç›–æ—§æ–‡ä»¶ï¼Œè¾“å…¥ y è¡¨ç¤ºç›´æ¥è¦†ç›–ï¼Œè¾“å…¥ n è¡¨ç¤ºå–æ¶ˆè¯¥æ“ä½œã€‚ -f: å¦‚æœæŒ‡å®šç§»åŠ¨çš„æºç›®å½•æˆ–æ–‡ä»¶ä¸ç›®æ ‡çš„ç›®å½•æˆ–æ–‡ä»¶åŒåï¼Œä¸ä¼šè¯¢é—®ï¼Œç›´æ¥è¦†ç›–æ—§æ–‡ä»¶ã€‚ -n: ä¸è¦è¦†ç›–ä»»ä½•å·²å­˜åœ¨çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚ -uï¼šå½“æºæ–‡ä»¶æ¯”ç›®æ ‡æ–‡ä»¶æ–°æˆ–è€…ç›®æ ‡æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼Œæ‰æ‰§è¡Œç§»åŠ¨æ“ä½œã€‚ ","date":"2022-01-21","objectID":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/:2:0","tags":["Linux"],"title":"Linuxå¸¸ç”¨æ–‡ä»¶ç®¡ç†å‘½ä»¤","uri":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"3 ç¼–è¯‘è¿è¡ŒC/C++æ–‡ä»¶ ç¼–è¯‘ g++ æ–‡ä»¶å.cpp -o æ–‡ä»¶å -std=ç‰ˆæœ¬ ä¾‹å¦‚:g++ main.cpp -o main -std=c++11 å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯åœ¨AC Terminalé‡Œé¢æ˜¯ç”¨ä¸äº†ä¸‡èƒ½å¤´æ–‡ä»¶çš„ã€‚ è¿è¡Œ ./æ–‡ä»¶åï¼Œå³å¯è¿è¡Œã€‚ ","date":"2022-01-21","objectID":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/:3:0","tags":["Linux"],"title":"Linuxå¸¸ç”¨æ–‡ä»¶ç®¡ç†å‘½ä»¤","uri":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/"},{"categories":["ç³»ç»Ÿæ¶æ„"],"content":"4 å‚è€ƒæ–‡çŒ® yæ€»LinuxåŸºç¡€è¯¾ ","date":"2022-01-21","objectID":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/:4:0","tags":["Linux"],"title":"Linuxå¸¸ç”¨æ–‡ä»¶ç®¡ç†å‘½ä»¤","uri":"/posts/02.linux%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/"},{"categories":["å·¥å…·"],"content":"1 tmuxä½¿ç”¨æ•™ç¨‹ ","date":"2022-01-21","objectID":"/posts/01.tmux%E6%95%99%E7%A8%8B/:1:0","tags":["Tmux"],"title":"Tmuxæ•™ç¨‹","uri":"/posts/01.tmux%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.1 tmuxå®‰è£… # Ubuntu æˆ– Debian $ sudo apt-get install tmux # CentOS æˆ– Fedora $ sudo yum install tmux # Mac $ brew install tmux ","date":"2022-01-21","objectID":"/posts/01.tmux%E6%95%99%E7%A8%8B/:1:1","tags":["Tmux"],"title":"Tmuxæ•™ç¨‹","uri":"/posts/01.tmux%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.2 tmuxç®€ä»‹ tmuxæ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„ç»ˆç«¯å¤ç”¨å™¨ï¼ˆterminal multiplexerï¼‰ï¼Œå…¶å¯ä»¥ä½¿ç”¨ä¸€ç³»åˆ—çš„ç»ˆç«¯sessionï¼Œå®ƒä½¿æ‚¨å¯ä»¥åœ¨ä¸€ä¸ªç»ˆç«¯ä¸­çš„å¤šä¸ªç¨‹åºä¹‹é—´è½»æ¾åˆ‡æ¢ã€åˆ†ç¦»å®ƒä»¬ï¼ˆå®ƒä»¬ç»§ç»­åœ¨åå°è¿è¡Œï¼‰å¹¶å°†å®ƒä»¬é‡æ–°é™„åŠ åˆ°ä¸åŒçš„ç»ˆç«¯ã€‚ sessionï¼šæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨windowså‘½ä»¤è¡Œä¸­æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œç„¶åè¾“å…¥å‘½ä»¤å®ç°ä¸è®¡ç®—æœºçš„äº¤æµã€‚è€Œè¿™ç§ç”¨æˆ·ä¸è®¡ç®—æœºçš„è¿™ç§ä¸´æ—¶çš„äº¤äº’å°±å«åšsessionã€‚ tmuxçš„ä¸»è¦åŠŸèƒ½æœ‰ï¼š åˆ†å±ï¼Œå³å…è®¸åœ¨å•ä¸ªçª—å£ä¸­è®¿é—®å¤šä¸ªä¼šè¯ã€‚è¿™å¯¹æˆ‘ä»¬åŒæ—¶è¿è¡Œå¤šä¸ªå‘½ä»¤è¡Œç¨‹åºéå¸¸æœ‰ç”¨ã€‚ å…è®¸æ–­å¼€Terminalè¿æ¥åï¼Œç»§ç»­è¿è¡Œè¿›ç¨‹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶éšåœ°æ”¾å¿ƒçš„è¿›è¡Œæ“ä½œï¼Œå³ä½¿å·¥ä½œè¿›è¡Œåˆ°ä¸€åŠçªç„¶æ–­å¼€ï¼Œæˆ‘ä»¬æ‰“å¼€tmuxä»å¯ä»¥é‡æ–°è¿›å…¥åˆ°æ“ä½œç°åœºã€‚ ä¼šè¯å…±äº«ï¼ˆé€‚ç”¨äºç»“å¯¹ç¼–ç¨‹æˆ–è€…è¿œç¨‹æ•™å­¦ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å°†tmuxçš„ä¼šè¯åœ°å€åˆ†äº«ç»™å…¶ä»–äººï¼Œè¿™æ ·ä»–ä»¬å°±å¯ä»¥é€šè¿‡SSHæ¥å…¥è¯¥ä¼šè¯ã€‚æ›´éªšçš„æ˜¯ï¼Œå¦‚æœä½ è¦ç»™å…¶ä»–äººæ¼”ç¤ºè¿œç¨‹æœåŠ¡å™¨çš„æ“ä½œï¼Œä¸å¿…ä¸€ç›´ç›¯ç€å±å¹•ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©tmuxï¼Œä»–å°±å¯ä»¥å®Œå…¨è¿›å…¥ä½ çš„ä¼šè¯ã€‚ å½“ç„¶ï¼Œtmuxçš„åŠŸèƒ½è¿˜æœ‰å¾ˆå¤šï¼Œç›¸æ¯”äºå…¶ä»–çš„ç»ˆç«¯å¤ç”¨å™¨ï¼Œtmuxæ›´æ˜“ç”¨ä¹Ÿæ›´å¼ºå¤§ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å­¦ä¹ tmuxçš„åŸå› ã€‚ ","date":"2022-01-21","objectID":"/posts/01.tmux%E6%95%99%E7%A8%8B/:1:2","tags":["Tmux"],"title":"Tmuxæ•™ç¨‹","uri":"/posts/01.tmux%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.3 tmuxç»“æ„ tmuxæ˜¯é‡‡ç”¨C/Sæ¨¡å‹æ„å»ºçš„ï¼Œæˆ‘ä»¬è¾“å…¥tmuxå³ç›¸å½“äºå¼€å¯äº†ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæ­¤æ—¶é»˜è®¤å°†æ–°å»ºä¸€ä¸ªsessionï¼Œç„¶åå†sessionä¸­æ–°å»ºä¸€ä¸ªwindowï¼Œwindowä¸­æ–°å»ºä¸€ä¸ªpaneã€‚å…¶è”ç³»ä¸ºï¼šä¸€ä¸ªtmuxå¯ä»¥åŒ…å«å¤šä¸ªsessionï¼Œä¸€ä¸ªsessionå¯ä»¥åŒ…å«å¤šä¸ªwindowï¼Œä¸€ä¸ªwindowå¯ä»¥åŒ…å«å¤šä¸ªpaneã€‚ ä»¥ä¸‹å³æ˜¯å®ä¾‹ï¼š tmux: session 0: window 0: pane 0 pane 1 pane 2 â€¦ window 1 window 2 â€¦ session 1 session 2 â€¦ ","date":"2022-01-21","objectID":"/posts/01.tmux%E6%95%99%E7%A8%8B/:1:3","tags":["Tmux"],"title":"Tmuxæ•™ç¨‹","uri":"/posts/01.tmux%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"1.4 tmuxæ“ä½œ æ³¨ï¼šä»¥ä¸‹æ“ä½œå¤§å¤šæ•°éƒ½ä¼šç»™å‡ºå‘½ä»¤å’Œå¯¹åº”çš„å¿«æ·é”®ï¼Œå¦‚æœç”¨äºå­¦ä¹ ï¼Œå»ºè®®ä¸¤ç§æ“ä½œéƒ½è¦å­¦ä¼šï¼Œä½†åœ¨å¹³å¸¸æ“ä½œä¸­ï¼Œä½¿ç”¨å¿«æ·é”®æ˜¯æ›´æ–¹ä¾¿çš„ã€‚ 1.4.1 å‰ç¼€é”® tmuxæä¾›äº†å¾ˆå¤šçš„å¿«æ·é”®ã€‚ç‰¹åˆ«çš„æ˜¯æ‰€æœ‰çš„å¿«æ·é”®éƒ½éœ€è¦é€šè¿‡å‰ç¼€é”®å”¤èµ·ï¼Œé»˜è®¤çš„å¿«æ·é”®ä¸ºctrl + bã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡tmux list-keyså‘½ä»¤æ¥æŸ¥çœ‹æ‰€æœ‰å¿«æ·é”®æŒ‡ä»¤ã€‚ å½“ç„¶å¦‚æœè§‰å¾—ctrl + bä¸å¥½ç”¨ï¼Œä¹ æƒ¯ç”¨å…¶ä»–çš„é”®ï¼Œè¿™é‡Œæä¾›ä¿®æ”¹å‰ç¼€é”®çš„æ–¹æ³•å¦‚ä¸‹ï¼š # é¦–å…ˆæ‰“å¼€æ–‡ä»¶~/.tmux.conf vim ~/.tmux.conf # è®¾ç½®å‰ç¼€ä¸ºCtrl + aã€‚ set -g prefix C-a # è§£é™¤Ctrl + bä¸å‰ç¼€çš„å¯¹åº”å…³ç³»ã€‚ unbind C-b # ç»‘å®šctrl + a æˆä¸ºæ–°çš„æŒ‡ä»¤å‰ç¼€ã€‚ bind C-a send-prefix #ç„¶åè®©å®ƒç”Ÿæ•ˆã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥é‡å¯è®©å®ƒç”Ÿæ•ˆã€‚ source ~/.tmux.conf 1.4.2 ä¼šè¯(session)æ“ä½œ æ–°å»ºä¼šè¯ï¼štmux new -s sessionNameã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸ºsessionNameçš„ä¼šè¯äº†ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç®€å†™ä¸ºtmuxï¼Œè¿™æ ·ä¼šæ–°å»ºä¸€ä¸ªæ— åç§°çš„ä¼šè¯ã€‚ä½†ä¸ºäº†æˆ‘ä»¬æ–¹ä¾¿ç®¡ç†ï¼Œæ‰€ä»¥å»ºè®®è¿˜æ˜¯æŒ‡å®šä¼šè¯åç§°ã€‚ æ–­å¼€å½“å‰ä¼šè¯ï¼štmux detachã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–­å¼€å½“å‰ä¼šè¯ï¼Œä½†æ˜¯ä¼šè¯ è¿˜æ˜¯ä¼šåœ¨åå°è¿è¡Œã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¿«æ·é”®ï¼šå…ˆæŒ‰ctrl + bï¼Œå†æŒ‰ ctrl + då³å¯é€€å‡ºã€‚ æ³¨æ„ï¼šè¿™ä¸ªå¹¶æ²¡æœ‰çœŸæ­£çš„å…³é—­ä¼šè¯ã€‚ è¿›å…¥å·²å­˜åœ¨çš„ä¼šè¯ï¼štmux a -t sessionNameæˆ–è€…ç›´æ¥è¾“å…¥tmux aã€‚ å‰è€…å¯ä»¥æŒ‡å®šè¿›å…¥çš„sessionNameä¼šè¯ï¼Œè€Œåè€…æ˜¯é»˜è®¤è¿›å…¥ç¬¬ä¸€ä¸ªä¼šè¯ã€‚å…¶ä¸­çš„aå‘½ä»¤å®é™…ä¸Šå°±æ˜¯attachï¼Œæˆ‘ä»¬å¯ä»¥ç®€å†™ä¸ºaã€‚ å…³é—­ä¼šè¯ï¼štmux kill -session -t sessionNameæˆ–è€…tmux kill -serverã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨tmuxçš„killå‘½ä»¤ï¼Œå…¶ä¸­killå‘½ä»¤æœ‰å››ç§ï¼škill -pane, kill -server, kill -session, kill windowã€‚æ ¹æ®éœ€æ±‚æˆ‘ä»¬ä½¿ç”¨è‡ªå·±éœ€è¦çš„å‘½ä»¤ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ ¹æ®å‰é¢çš„è”ç³»ï¼Œæˆ‘ä»¬å…³é—­äº†sessionï¼Œé‚£ä¹ˆå…¶ä¸­çš„æ‰€æœ‰paneå’Œwindowä¹Ÿéƒ½ä¸å­˜åœ¨äº†ï¼ŒåŒç†å…³é—­server,é‚£ä¹ˆæ‰€æœ‰sessionä¹Ÿéƒ½ä¸å­˜åœ¨äº†ã€‚æ‰€ä»¥è¿™é‡Œå³æ˜¯ä½¿ç”¨kill -sessionå’Œkill -serverï¼Œå‰è€…å…³é—­sessionNameè¿™ä¸ªä¼šè¯ï¼Œåè€…å…³é—­æ‰€æœ‰çš„ä¼šè¯ã€‚ æŸ¥çœ‹æ‰€æœ‰çš„ä¼šè¯ï¼štmux lsã€‚ åˆ‡æ¢ä¼šè¯ï¼šswitchå‘½ä»¤ç”¨äºåˆ‡æ¢ä¼šè¯ã€‚ # ä½¿ç”¨ä¼šè¯ç¼–å·æ¥åˆ‡æ¢ tmux switch -t 0 # ä½¿ç”¨ä¼šè¯åç§°æ¥åˆ‡æ¢ tmux switch -t sessionName é‡å‘½åä¼šè¯ï¼štmux rename-session -t sessionName new Nameã€‚ å¸¸ç”¨ä¼šè¯æ“ä½œå¿«æ·é”®ã€‚ å‰ç¼€ æŒ‡ä»¤ åŠŸèƒ½ Ctrl+b` | d | æ–­å¼€å½“å‰ä¼šè¯ | Ctrl+b` | D | é€‰æ‹©è¦æ–­å¼€çš„ä¼šè¯ | Ctrl+b` | $ | é‡å‘½åå½“å‰ä¼šè¯ | Ctrl+b` | s | ï¿½ï¿½å‡ºå½“å‰ä¼šè¯ç”¨äºé€‰æ‹©å¹¶åˆ‡æ¢ | Ctrl+b` | r | å¼ºåˆ¶é‡è½½å½“å‰ä¼šè¯ | Ctrl+b` | trl + z | æŒ‚èµ·å½“å‰ä¼šè¯ | tmuxä¸­å¤åˆ¶/ç²˜è´´æ–‡æœ¬çš„é€šç”¨æ–¹æ³•ã€‚ (1).æŒ‰ä¸‹Ctrl + bå‰ç¼€é”®ï¼Œç„¶åæŒ‰[ï¼› (2).ç”¨é¼ æ ‡é€‰ä¸­æ–‡æœ¬ï¼Œç„¶åè¢«é€‰ä¸­çš„æ–‡æœ¬ä¼šè¢«è‡ªåŠ¨å¤åˆ¶åˆ°tmuxçš„å‰ªè´´æ¿ï¼› (3).æŒ‰ä¸‹Ctrl + båå‰ç¼€é”®ï¼Œç„¶åæŒ‰]ï¼Œä¼šè‡ªåŠ¨å°†å‰ªè´´æ¿çš„å†…å®¹ç²˜è´´åˆ°å…‰æ ‡å¤„ã€‚ 1.4.3 çª—å£(window)æ“ä½œ æ–°å»ºçª—å£ï¼štmux new-window -n windowNameã€‚ å¦‚æ­¤æˆ‘ä»¬å¯åˆ›å»ºä¸€ä¸ªæ–°çš„åä¸ºwindowNameçš„çª—å£ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥tmux new-windowæ¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰æŒ‡å®šåç§°çš„çª—å£ã€‚ åˆ›å»ºä¸€ä¸ªæ–°çª—å£åï¼ŒåŸçª—å£æˆ‘ä»¬æ˜¯çœ‹ä¸åˆ°äº†çš„ï¼Œä½†ä¾ç„¶å­˜åœ¨ã€‚ åˆ‡æ¢çª—å£ï¼štmux select-window -t windowNameã€‚ é‡å‘½åçª—å£ï¼štmux rename-window windowNameã€‚ å¸¸ç”¨çª—å£æ“ä½œå¿«æ·é”®ã€‚ å‰ç¼€ æŒ‡ä»¤ åŠŸèƒ½ Ctrl+b` | c | æ–°å»ºçª—å£ | Ctrl+b` | \u0026 | å…³é—­å½“å‰çª—å£ï¼Œéœ€è¦è¾“å…¥y or nç¡®è®¤ | Ctrl+b` | number\u003eç¼–å· | åˆ‡æ¢åˆ°æŒ‡å®šç¼–å·çš„çª—å£ | Ctrl+b` | p | åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªçª—å£ | Ctrl+b` | n | åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£ | Ctrl+b` | w | æ˜¾ç¤ºçª—å£åˆ—è¡¨ç”¨äºåˆ‡æ¢ã€‚ | Ctrl+b` | ,ï¼ˆé€—å·ï¼‰ | é‡å‘½åå½“å‰çª—å£ | Ctrl+b` | . | ä¿®æ”¹å½“å‰çª—å£ç¼–å·ï¼ˆé€‚ç”¨äºçª—å£æ’åºï¼‰ | Ctrl+b` | f | ï¿½ï¿½é€Ÿå®šä½åˆ°çª—å£ï¼ˆè¾“å…¥å…³é”®å­—åŒ¹é…çª—å£ï¼‰ | 1.4.4 é¢æ¿(pane)æ“ä½œ åˆ’åˆ†é¢æ¿ã€‚ æ³¨æ„ï¼Œæ­¤åˆ’åˆ†æ˜¯é’ˆå¯¹å½“å‰é€‰ä¸­çš„é¢æ¿ï¼Œé¢æ¿å¯ä»¥æ— é™åˆ’åˆ†ã€‚ # åˆ’åˆ†æˆä¸Šä¸‹ä¸¤ä¸ªé¢æ¿ tmux split-window #åˆ’åˆ†æˆå·¦å³ä¸¤ä¸ªé¢æ¿ tmux split-window -h åˆ‡æ¢é¢æ¿ã€‚ tmux select-paneå‘½ä»¤ç”¨æ¥ç§»åŠ¨å…‰æ ‡ä½ç½®ï¼Œè¿™ä¸ªæ›´ä¸¥è°¨çš„è¯´åº”è¯¥æ˜¯åˆ‡æ¢å…‰æ ‡ï¼Œå› ä¸ºæˆ‘ä»¬çš„å…‰æ ‡æ­£å¥½å¯ä»¥é€‰ä¸­é¢æ¿ï¼Œå³å¯ä»¥é€šè¿‡é¼ æ ‡ç‚¹å‡»é€‰ä¸­ã€‚å½“ç„¶ï¼Œå‰è€…è¿‡äºç®€å•ä¸”æ²¡æœ‰é€¼æ ¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¿«æ·é”®æˆ–è€…å‘½ä»¤æ¥å®ç°ã€‚ # å…‰æ ‡åˆ‡æ¢åˆ°ä¸Šæ–¹é¢æ¿ tmux select-pane -U # å…‰æ ‡åˆ‡æ¢åˆ°ä¸‹æ–¹é¢æ¿ tmux select-pane -D # å…‰æ ‡åˆ‡æ¢åˆ°å·¦æ–¹é¢æ¿ tmux select-pane -L # å…‰æ ‡åˆ‡æ¢åˆ°å³æ–¹é¢æ¿ tmux select-pane -R äº¤æ¢é¢æ¿ä½ç½®ã€‚ tmux swap-paneå¯ç”¨äºäº¤æ¢é¢æ¿ä½ç½®ã€‚åŒåˆ‡æ¢é¢æ¿å·®ä¸å¤šçš„å½¢å¼ã€‚ # ä¸Šç§» tmux swap-pane -U # ä¸‹ç§» tmux swap-pane -D # å·¦ç§» tmux swap-pane -L # å³ç§» tmux swap-pane -R å¸¸ç”¨é¢æ¿æ“ä½œå¿«æ·é”®ã€‚ å‰ç¼€ æŒ‡ä»¤ æè¿° Ctrl+b` | \" | å½“å‰é¢æ¿ä¸Šä¸‹ä¸€åˆ†ä¸ºäºŒï¼Œä¸‹ä¾§æ–°å»ºé¢æ¿ | Ctrl+b` | % | å½“å‰é¢æ¿å·¦å³ä¸€åˆ†ä¸ºäºŒï¼Œå³ä¾§æ–°å»ºé¢æ¿ | Ctrl+b` | x | å…³é—­å½“å‰é¢æ¿ï¼ˆå…³é—­å‰éœ€è¾“å…¥y or nç¡®è®¤ï¼‰ | Ctrl+b` | z | æœ€å¤§åŒ–å½“å‰é¢æ¿ï¼Œå†é‡å¤ä¸€æ¬¡æŒ‰é”®åæ¢å¤æ­£å¸¸ï¼ˆv1.8ç‰ˆæœ¬æ–°å¢ï¼‰ | Ctrl+b` | ! | ï¿½ï¿½å½“å‰é¢æ¿ç§»åŠ¨åˆ°æ–°çš„çª—å£æ‰“å¼€ï¼ˆåŸçª—å£ä¸­å­˜åœ¨ä¸¤ä¸ªåŠä»¥ä¸Šé¢æ¿æœ‰æ•ˆï¼‰ | Ctrl+b` | ; | åˆ‡æ¢åˆ°æœ€åä¸€æ¬¡ä½¿ç”¨çš„é¢æ¿ | Ctrl+b` | q | æ˜¾ç¤ºé¢æ¿ç¼–å·ï¼Œåœ¨ç¼–å·æ¶ˆå¤±å‰è¾“å…¥å¯¹åº”çš„æ•°å­—å¯åˆ‡æ¢åˆ°ç›¸åº”çš„é¢æ¿ | Ctrl+b` | æ–¹å‘é”® | ç§»åŠ¨å…‰æ ‡åˆ‡æ¢é¢æ¿ | Ctrl+b` | hjkl(åˆ†åˆ«ä»£è¡¨å·¦ä¸‹ä¸Šå³)` | ç§»åŠ¨å…‰æ ‡åˆ‡æ¢é¢æ¿ | Ctrl+b` | { | å‘å‰ç½®æ¢å½“å‰é¢æ¿ | Ctrl+b` | } | å‘åç½®æ¢å½“å‰é¢æ¿ | Ctrl+b` | Ctrl+o | é¡ºæ—¶é’ˆæ—‹è½¬å½“å‰çª—å£ä¸­çš„æ‰€æœ‰é¢æ¿ | Ctrl+b` | o | é€‰æ‹©ä¸‹ä¸€é¢æ¿ | Ctrl+b` | ç©ºæ ¼é”® | åœ¨è‡ªå¸¦çš„é¢æ¿å¸ƒå±€ä¸­å¾ªç¯åˆ‡æ¢ | Ctrl+b` | Alt+æ–¹å‘é”® | ä»¥5ä¸ªå•å…ƒæ ¼ä¸ºå•ä½è°ƒæ•´å½“å‰é¢æ¿è¾¹ç¼˜ | Ctrl+b` | Ctrl+æ–¹å‘é”® | ä»¥1ä¸ªå•å…ƒæ ¼ä¸ºå•ä½è°ƒæ•´å½“å‰é¢æ¿è¾¹ç¼˜ï¼ˆMacä¸‹è¢«ç³»ç»Ÿå¿«æ·é”®è¦†ç›–ï¼‰ | Ctrl+b` | t | æ˜¾ç¤ºæ—¶é’Ÿ | ","date":"2022-01-21","objectID":"/posts/01.tmux%E6%95%99%E7%A8%8B/:1:4","tags":["Tmux"],"title":"Tmuxæ•™ç¨‹","uri":"/posts/01.tmux%E6%95%99%E7%A8%8B/"},{"categories":["å·¥å…·"],"content":"2 å‚è€ƒæ–‡çŒ® Tmux ä½¿ç”¨æ•™ç¨‹-é˜®ä¸€å³° Tmuxä½¿ç”¨æ‰‹å†Œ-è·¯æ˜“æ–¯ tmuxä½¿ç”¨æ•™ç¨‹-å°å¯ä¸ƒ ","date":"2022-01-21","objectID":"/posts/01.tmux%E6%95%99%E7%A8%8B/:2:0","tags":["Tmux"],"title":"Tmuxæ•™ç¨‹","uri":"/posts/01.tmux%E6%95%99%E7%A8%8B/"},{"categories":["é—®é¢˜è®°å½•"],"content":"1 æ‰“å¼€DOSBoxé…ç½®æ–‡ä»¶ DOSBoxçš„é…ç½®æ–‡ä»¶åä¸ºDOSBOX ç‰ˆæœ¬å· Optionsï¼Œå¯¹äºæœ‰çš„ç‰ˆæœ¬é…ç½®æ–‡ä»¶å¥½åƒåä¸ºbc31.confã€‚åœ¨DOSBOXçš„å®‰è£…ç›®å½•ä¸‹ï¼Œåç¼€ä¸º.batã€‚ç›´æ¥ç”¨è®°äº‹æœ¬æ‰“å¼€è¿›è¡Œä¿®æ”¹å³å¯ã€‚ ","date":"2021-09-27","objectID":"/posts/02.%E4%BF%AE%E6%94%B9dosbox%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%8C%82%E8%BD%BD%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/:1:0","tags":["DOSBox"],"title":"ä¿®æ”¹DOSBoxé…ç½®æ–‡ä»¶ï¼ˆè°ƒæ•´çª—å£å¤§å°ï¼ŒæŒ‚è½½ç¨‹åºè‡ªåŠ¨è¿è¡Œï¼‰","uri":"/posts/02.%E4%BF%AE%E6%94%B9dosbox%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%8C%82%E8%BD%BD%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/"},{"categories":["é—®é¢˜è®°å½•"],"content":"2 è°ƒæ•´çª—å£å¤§å° åœ¨å®é™…ä½¿ç”¨DOSBoxçš„æ—¶å€™ï¼Œé€šå¸¸ä¼šè§‰å¾—DOSBoxçš„çª—å£æœ‰ç‚¹å°ï¼š æˆ‘ä»¬åˆä¸èƒ½ç›´æ¥è°ƒèŠ‚ã€‚è¿™ä¸ªæ—¶å€™æœ‰ä¸¤ç§æ–¹æ³•è°ƒèŠ‚ï¼š Alt+Enterè¿›å…¥å…¨å±æ¨¡å¼ã€‚ è¿™ç§æ–¹æ³•æ¯”è¾ƒåˆ«æ‰­ï¼Œä¸è¿‡æ–¹ä¾¿å¿«æ·ã€‚ åˆ©ç”¨é…ç½®æ–‡ä»¶ä¿®æ”¹ã€‚ è¿›å…¥é…ç½®æ–‡ä»¶åå®šä½åˆ°ï¼š ç¬¬ä¸€ä¸ªå‚æ•°fullscreenä»£è¡¨æ˜¯å¦å¡«å……å±å¹•ï¼Œå…¶æ˜¯å¦è¿›å…¥å…¨å±æ¨¡å¼ã€‚å¦‚æœä½ å–œæ¬¢ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™é‡Œä¿®æ”¹ï¼Œè¿™æ ·æ¯æ¬¡è¿›å…¥éƒ½æ˜¯å…¨å±æ¨¡å¼äº†ã€‚ ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯è°ƒèŠ‚å…¨å±æ¨¡å¼ä¸‹çš„ç‰¹å¾ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸å†ä½œä»‹ç»äº†ã€‚ å…³é”®åœ¨äºwindowresolutionå’Œoutputï¼Œåˆ†åˆ«ä¸ºçª—å£åˆ†è¾¨ç‡å’Œè¾“å‡ºã€‚ æˆ‘ä»¬å°†åˆ†è¾¨ç‡è°ƒä¸º1280x1080ï¼ˆåˆ†è¾¨ç‡å¯ä»¥æ ¹æ®è‡ªå·±å®é™…éœ€è¦è¿›è¡Œè°ƒèŠ‚ï¼‰,åŒæ—¶éœ€è¦å°†è¾“å‡ºæ”¹ä¸ºopengl,å³å¼€å¯æ¸²æŸ“ã€‚ ä¿å­˜é‡å¯DOSBoxå¦‚ä¸‹ï¼š ","date":"2021-09-27","objectID":"/posts/02.%E4%BF%AE%E6%94%B9dosbox%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%8C%82%E8%BD%BD%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/:2:0","tags":["DOSBox"],"title":"ä¿®æ”¹DOSBoxé…ç½®æ–‡ä»¶ï¼ˆè°ƒæ•´çª—å£å¤§å°ï¼ŒæŒ‚è½½ç¨‹åºè‡ªåŠ¨è¿è¡Œï¼‰","uri":"/posts/02.%E4%BF%AE%E6%94%B9dosbox%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%8C%82%E8%BD%BD%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/"},{"categories":["é—®é¢˜è®°å½•"],"content":"3 æŒ‚è½½ç¨‹åºè‡ªåŠ¨è¿è¡Œ å½“æˆ‘ä»¬æ²¡æœ‰æ‰“å¼€DOSBoxçš„æ—¶å€™è¿›å…¥çš„æ˜¯Zç›˜ï¼Œå³DOSBoxçš„è™šæ‹ŸZç›˜ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æœ¬åœ°çš„masmæ–‡ä»¶å¤¹ç”¨æ¥æ‰§è¡Œæ±‡ç¼–ç¨‹åºå’Œä½¿ç”¨debugç­‰æ“ä½œã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬é€šå¸¸çš„æ–¹æ³•æ˜¯å¯ä»¥å°†masmæ–‡ä»¶å¤¹æŒ‚è½½ä¸ºDOSBoxçš„Cç›˜ï¼Œå³è¾“å…¥mount c d:\\masmå³å¯å°†d:\\masmæŒ‚è½½åˆ°Cç›˜ã€‚é€šä¿—çš„ç†è§£ï¼Œè¯¥æ–‡ä»¶å¤¹ä¹‹åå°±æ˜¯DOSBoxçš„Cç›˜äº†ã€‚æˆ‘ä»¬ç”¨doså‘½ä»¤c:è¿›å…¥Cç›˜å³å¯ä½¿ç”¨masmæ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹äº†ã€‚ æ‰€ä»¥ä»¥ä¸Šæ“ä½œä¸ºï¼š mount c d:\\masm c: é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ¯æ¬¡æ‰“å¼€éƒ½è¦è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼Œé‚£æœªå…å¤ªç´¯äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯å°†ä¸¤æ¡è¯­å¥æ·»åŠ åˆ°é…ç½®æ–‡ä»¶çš„æ–‡ä»¶æœ«å°¾å¤„ã€‚ ä¿å­˜é‡æ–°æ‰“å¼€DOSBoxä¹‹åä¸ºï¼š å½“ç„¶ï¼Œå¦‚æœä½ æƒ³æŒ‚è½½å…¶ä»–çš„ç¨‹åºç…§æ­¤æ“ä½œå³å¯å®ç°ã€‚ ","date":"2021-09-27","objectID":"/posts/02.%E4%BF%AE%E6%94%B9dosbox%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%8C%82%E8%BD%BD%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/:3:0","tags":["DOSBox"],"title":"ä¿®æ”¹DOSBoxé…ç½®æ–‡ä»¶ï¼ˆè°ƒæ•´çª—å£å¤§å°ï¼ŒæŒ‚è½½ç¨‹åºè‡ªåŠ¨è¿è¡Œï¼‰","uri":"/posts/02.%E4%BF%AE%E6%94%B9dosbox%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%8C%82%E8%BD%BD%E7%A8%8B%E5%BA%8F%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/"},{"categories":null,"content":"Lruihao's friends","date":"2021-09-19","objectID":"/friends/","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":" Â Subscribe ours https://lruihao.cn/friends/opml.xml ","date":"2021-09-19","objectID":"/friends/:0:0","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":"1 å¤±æ•ˆéˆæ¥ å…¬ç¤ºä¸€å€‹æœˆå¾Œåˆªé™¤ï¼Œå¦‚æ›´æ›åŸŸåè«‹åŠæ™‚è¯ç¹«ï¼ liyangzone.com: ç„¡å¦¨è¨ªå•ã€‚ ayou10031.com: ç„¡å¦¨è¨ªå•ã€‚ ","date":"2021-09-19","objectID":"/friends/:1:0","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":"2 åŸºæœ¬è³‡è¨Š ç¶²çµ¡ IDï¼šLruihao é ­åƒï¼šhttps://lruihao.cn/images/avatar.jpg URLï¼šhttps://lruihao.cn æè¿°ï¼šè èœçœ¾é•· - ã€Œä¸æ€•è¬äººé˜»æ“‹ï¼Œåªæ€•è‡ªå·±æŠ•é™ã€ ","date":"2021-09-19","objectID":"/friends/:2:0","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":"3 å‹æƒ…æé†’ è©•è«–ç•™è¨€å¿…è¦å…§å®¹å¦‚ä¸‹ï¼š ```yaml - nickname: \u003cyour nickname\u003e avatar: \u003cyour avatar\u003e url: \u003cyour site link\u003e description: \u003cdescription of your site\u003e ``` Notice äº’æ›å‹éˆè«‹æŒ‰ä»¥ä¸Šæ ¼å¼åœ¨è©•è«–ç•™è¨€ã€‚ï¼ˆåƒ…é™å€‹äººéå•†æ¥­éƒ¨è½æ ¼/ç¶²ç«™ï¼‰ Â ç¶²ç«™å¤±æ•ˆã€åœæ­¢ç¶­è­·ã€å…§å®¹ä¸ç•¶éƒ½å¯èƒ½è¢«å–æ¶ˆé€£çµï¼ é‚£äº›ä¸å°Šé‡ä»–äººå‹å‹•æˆæœï¼Œè½‰è¼‰ä¸åŠ å‡ºè™•çš„ï¼Œæˆ–æƒ¡æ„è¡Œç‚ºçš„ç¶²ç«™ï¼Œé‚„è«‹ä½ ä¸è¦ä¾†é€²è¡Œäº¤æ›äº†ã€‚ ","date":"2021-09-19","objectID":"/friends/:3:0","tags":null,"title":"å‹æƒ…éˆæ¥","uri":"/friends/"},{"categories":null,"content":"äº’è”ç½‘çš„å¹¿å¤§æœ‹å‹ä»¬ï¼Œæ¬¢è¿å…‰ä¸´æˆ‘çš„å°åšå®¢ï¼æ¬¢è¿ç•™è¨€ï¼","date":"2021-09-13","objectID":"/guestbook/","tags":null,"title":"ç•™è¨€","uri":"/guestbook/"},{"categories":null,"content":" Welcome äº’è”ç½‘çš„å››æµ·å®¾æœ‹ï¼Œæˆ‘æ˜¯HeZephyrï¼Œæ¬¢è¿æ‚¨è…ä¸´æˆ‘çš„ä¸€æ–¹å°å¤©åœ°ï¼ åœ¨æ­¤ï¼Œè¯šé‚€æ‚¨ç•™ä¸‹å®è´µç¬”å¢¨ï¼Œè®©æˆ‘ä»¬æºæ‰‹å¹¶è‚©ï¼Œå…±æ¢çŸ¥è¯†ä¹‹æµ·ï¼ŒåŒç»˜æ™ºæ…§é•¿å·ã€‚ ä¸‹é¢ï¼Œè¯·å…è®¸æˆ‘ä¸ºæ‚¨å‘ˆä¸Šä¸€é¦–åƒå¤ç»å”±ï¼š ã€Šå°†è¿›é…’ã€‹ å›ä¸è§é»„æ²³ä¹‹æ°´å¤©ä¸Šæ¥ï¼Œå¥”æµåˆ°æµ·ä¸å¤å›ã€‚ å›ä¸è§é«˜å ‚æ˜é•œæ‚²ç™½å‘ï¼Œæœå¦‚é’ä¸æš®æˆé›ªã€‚ äººç”Ÿå¾—æ„é¡»å°½æ¬¢ï¼Œè«ä½¿é‡‘æ¨½ç©ºå¯¹æœˆã€‚ å¤©ç”Ÿæˆ‘æå¿…æœ‰ç”¨ï¼Œåƒé‡‘æ•£å°½è¿˜å¤æ¥ã€‚ çƒ¹ç¾Šå®°ç‰›ä¸”ä¸ºä¹ï¼Œä¼šé¡»ä¸€é¥®ä¸‰ç™¾æ¯ã€‚ â€”â€” æç™½ åœ¨æ¬£èµè¿™é¦–è¯—æ­Œçš„åŒæ—¶ï¼Œä¸å¦¨ç‚¹å‡»ä¸‹æ–¹çš„éŸ³ä¹æ’­æ”¾å™¨ï¼Œè®©ç¾å¦™çš„æ—‹å¾‹é™ªä¼´æ‚¨çš„é˜…è¯»ä¹‹æ—…ã€‚ æ¸©é¦¨æç¤ºï¼ŒéŸ³ä¹è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·å¸¦å¥½è€³æœºï½ From playlist, Powered By mmt-netease ç»™åšä¸»ä¹°æ¯å¡å¸ƒå¥‡è¯ºï½ èµèµ æ”¯ä»˜å® å¾®ä¿¡ ","date":"2021-09-13","objectID":"/guestbook/:0:0","tags":null,"title":"ç•™è¨€","uri":"/guestbook/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 å‰è¨€ å­¦äº†è¿™ä¹ˆä¹…ï¼Œè¯´çœŸçš„ï¼ŒåŠ¨æ€è§„åˆ’æ˜¯ä¸€ä¸ªç‰¹åˆ«éš¾çš„é¢†åŸŸï¼Œè€ŒçŠ¶å‹$DP$æˆ‘æ„Ÿè§‰æ˜¯å…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒéš¾çš„åˆ†æ”¯ï¼Œå…¶ä¸­çš„çŠ¶æ€å®šä¹‰ã€çŠ¶æ€è½¬ç§»ã€çŠ¶æ€è®¡ç®—éƒ½æ˜¯éš¾ç‚¹ã€‚å¦‚æœè¦å®Œå…¨ææ‡‚çŠ¶å‹$DP$æ˜¯éœ€è¦èŠ±å¾ˆå¤šæ—¶é—´å»å¸æ”¶å»å®è·µçš„ï¼Œæ‰€ä»¥å»ºè®®è¯»è€…å¤šåˆ·$DP$é¢˜ã€‚åŒæ—¶ï¼Œå­¦ä¹ æœ¬æ–‡çš„å…ˆä¿®çŸ¥è¯†ä¸ºäºŒè¿›åˆ¶ä½è¿ç®—æ“ä½œã€åŸºç¡€åŠ¨æ€è§„åˆ’å’ŒåŠ¨æ€è§„åˆ’çš„åˆ†æã€‚è¿™é‡ŒæŒ‡è·¯ä¸€ç¯‡äºŒè¿›åˆ¶è®²è§£$blog$:ç‚¹è¿™é‡Œã€‚ ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:1:0","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 çŠ¶æ€å‹ç¼© æˆ‘ä»¬çŸ¥é“çŠ¶æ€å‹ç¼©ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯éœ€è¦è€ƒè™‘çš„çŠ¶æ€éå¸¸å¤šï¼Œæˆ‘ä»¬å¦‚æœç”¨å¹³å¸¸çš„æ€æƒ³å»è¡¨ç¤ºçŠ¶æ€ï¼Œé‚£æ˜¯éå¸¸ä¸ç°å®çš„ï¼Œåœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½ä¸å…è®¸ï¼Œæˆ‘ä»¬ä½¿ç”¨æŸç§æ–¹æ³•ï¼Œä»¥æœ€å°çš„ä»£ä»·è¡¨ç¤ºæŸç§çŠ¶æ€ã€‚ é‚£ä¹ˆï¼Œè¿™é€šå¸¸æ˜¯ç”¨è¿›åˆ¶æ¥è¡¨ç¤ºçŠ¶æ€çš„ï¼Œè€Œé€‰æ‹©å‡ è¿›åˆ¶åˆ™æ ¹æ®è¦æ±‚ä½¿ç”¨çš„å¯¹è±¡çš„ç‚¹çš„çŠ¶æ€æœ‰å‡ ç§ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰$0$å’Œ$1$ï¼Œæˆ‘ä»¬åˆ™æ˜¯ç”¨äºŒè¿›åˆ¶æ¥è¡¨ç¤ºï¼Œå½“ç„¶ä¹Ÿæœ‰å…¶ä»–è¿›åˆ¶çš„é¢˜ï¼Œåœ¨ä¾‹é¢˜ä¸­ä¼šåˆ—ä¸¾ï¼Œéœ€è¦æˆ‘ä»¬çµæ´»å˜é€šï¼Œä¸»è¦è°ˆäºŒè¿›åˆ¶ã€‚ é‚£ä¹ˆå¦‚ä½•ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºçŠ¶æ€å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°ï¼ŒäºŒè¿›åˆ¶ä¸Šæ˜¯æŒ‰ä½åˆ†çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯ä¸€ä½å¯ä»¥çœ‹æˆä¸€ä¸ªç‚¹ï¼Œè€Œç‚¹ä¸Šçš„å–å€¼åˆ™ä¸ºè¯¥ç‚¹çš„çŠ¶æ€æˆ–è€…é€‰æ‹©ã€‚ä¾‹å¦‚$00001001$è¿™ä¸ªçŠ¶æ€åˆ™è¡¨ç¤ºç¬¬ä¸€ä¸ªç‚¹å’Œç¬¬å››ä¸ªç‚¹çŠ¶æ€ä¸º$1$ï¼Œå…¶ä½™çš„ç‚¹çŠ¶æ€ä¸º$0$ã€‚æ‰€ä»¥æŒ‰ç…§è¿™ç§æ€æƒ³ï¼Œæˆ‘ä»¬èƒ½æŠ½è±¡çš„è¡¨ç¤ºå‡ºä¸€ä¸ªå¾ˆå¤æ‚çš„çŠ¶æ€ï¼Œå®ç°äº†æ—¶é—´å’Œç©ºé—´çš„ä¼˜åŒ–ã€‚ çŸ¥é“äº†è¿™ä¸ªï¼Œæˆ‘ä»¬å°±æŒ‰ç…§æ­£å¸¸åŠ¨æ€è§„åˆ’çš„æ€æƒ³å»å†™è¿™ç±»é¢˜ç›®å³å¯ã€‚ ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:2:0","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 ä½¿ç”¨åœºæ™¯ ç”±ä¸Šæˆ‘ä»¬çŸ¥é“ï¼ŒçŠ¶æ€å‹ç¼©å…¶å®æ˜¯æœ‰é€‚ç”¨ç¯å¢ƒçš„ï¼š çŠ¶æ€éœ€è¦æœ‰ä¸€å®šçš„çŠ¶æ€å•å…ƒã€‚ å³ä¸€ä¸ªçŠ¶æ€åº”è¯¥æ˜¯ä¿å­˜ä¸€ä¸ªé›†åˆï¼Œå…¶ä¸­çš„å…ƒç´ å€¼å¯¹åº”ç€$0$æˆ–$1$ï¼Œä¾‹å¦‚æˆ‘ä»¬å¸¸è§çš„æ£‹ç›˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨$0$æˆ–$1$æ¥è¡¨ç¤ºæ£‹å­çš„æ”¾ç½®çŠ¶æ€ã€‚è€Œæ•´ä¸ªé›†åˆå³æ˜¯ä¸€ä¸ª$01$ä¸²ï¼Œå³äºŒè¿›åˆ¶æ•°ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨åè¿›åˆ¶è¡¨ç¤ºã€‚é‚£ä¹ˆæˆ‘ä»¬å†è¿›è¡ŒçŠ¶æ€è½¬ç§»æˆ–è€…åˆ¤æ–­çš„æ—¶å€™ï¼Œéœ€è¦å…ˆå°†åè¿›åˆ¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œå†å°†äºŒè¿›åˆ¶è½¬åŒ–ä¸ºåè¿›åˆ¶ã€‚ é¢˜ç›®ä¸­é™åˆ¶çš„é›†åˆå¤§å°ä¸ä¼šè¶…è¿‡$20$ã€‚ è¿™æ˜¯æœ€æ˜¾è‘—çš„ç‰¹å¾ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“å¦‚æœç”¨äºŒè¿›åˆ¶è¡¨ç¤ºçŠ¶æ€ï¼Œé‚£ä¹ˆé›†åˆå¤§å°ä¸º$20$çš„äºŒè¿›åˆ¶çŠ¶æ€æœ‰$2^{20} - 1$ï¼Œå·²ç»è¾¾åˆ°$1e7$çš„æ•°é‡çº§äº†ã€‚ å…·æœ‰åŠ¨æ€è§„åˆ’çš„ç‰¹æ€§ã€‚ å¯¹äºåŠ¨æ€è§„åˆ’ï¼Œä¸€èˆ¬éƒ½æ˜¯è¦æ±‚æœ€ä¼˜åŒ–æŸä¸ªå€¼ï¼Œå…·æœ‰æœ€ä¼˜å­ç»“æ„çš„æ€§è´¨ã€‚åŒæ—¶ä¹Ÿéœ€è¦æ»¡è¶³çŠ¶æ€è½¬ç§»çš„ç‰¹æ€§ï¼Œè€Œä¸æ˜¯å‰ä¸€ä¸ªçŠ¶æ€æ¯«æ— å…³ç³»çš„ã€‚ ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:3:0","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 å¸¸ç”¨æ¨¡æ¿ ä¸‹é¢çš„æ¨¡æ¿é€‚ç”¨äºå¤§å¤šæ•°é¢˜ç›®ï¼Œç‰¹æ®Šé¢˜ç›®éœ€è¦çµæ´»å˜åŠ¨ï¼Œæ€»ä¹‹ï¼Œå¤šåˆ·é¢˜è‡ªç„¶å°±éƒ½ä¼šäº†ã€‚ int n; int maxn = 1 \u003c\u003c n;//æ€»çŠ¶æ€æ•°ã€‚ //æšä¸¾å·²æœ‰çš„é›†åˆæ•°ã€‚æŒ‰ç…§çŠ¶æ€è½¬ç§»çš„é¡ºåºï¼Œä¸€èˆ¬ä»å°ç¼–å·åˆ°å¤§ç¼–å·ã€‚ for(int i = 1; i \u003c= m; ++ i){ //æšä¸¾å½“å‰é›†åˆä¸­çš„çŠ¶æ€ã€‚ for(int j = 0; j \u003c maxn; ++ j){ //åˆ¤æ–­å½“å‰é›†åˆæ˜¯å¦å¤„äºåˆæ³•çŠ¶æ€ï¼Œé€šå¸¸æˆ‘ä»¬éœ€ç”¨ä¸€ä¸ªæ•°ç»„æå‰å¤„ç†å¥½ã€‚å¦‚gæ•°ç»„; if(å½“å‰çŠ¶æ€æ˜¯å¦åˆæ ¼){ for(int k = 0; k \u003c maxn; ++ k){ //æšä¸¾ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€ã€‚ if(ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€æ˜¯å¦åˆæ ¼ + ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€å’Œå½“å‰çŠ¶æ€çš„é›†åˆæ˜¯å¦äº§ç”Ÿäº†å†²çª){ åˆ—å†™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚ } } } } } } ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:4:0","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5 ç»å…¸ä¾‹é¢˜ ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:5:0","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.1 5.1 USACO06NOV Corn Fields G é¢˜é¢ å†œåœºä¸»Johnæ–°ä¹°äº†ä¸€å—é•¿æ–¹å½¢çš„æ–°ç‰§åœºï¼Œè¿™å—ç‰§åœºè¢«åˆ’åˆ†æˆMè¡ŒNåˆ—(1 â‰¤ M â‰¤ 12; 1 â‰¤ N â‰¤ 12)ï¼Œæ¯ä¸€æ ¼éƒ½æ˜¯ä¸€å—æ­£æ–¹å½¢çš„åœŸåœ°ã€‚Johnæ‰“ç®—åœ¨ç‰§åœºä¸Šçš„æŸå‡ æ ¼é‡Œç§ä¸Šç¾å‘³çš„è‰ï¼Œä¾›ä»–çš„å¥¶ç‰›ä»¬äº«ç”¨ã€‚ é—æ†¾çš„æ˜¯ï¼Œæœ‰äº›åœŸåœ°ç›¸å½“è´«ç˜ ï¼Œä¸èƒ½ç”¨æ¥ç§è‰ã€‚å¹¶ä¸”ï¼Œå¥¶ç‰›ä»¬å–œæ¬¢ç‹¬å ä¸€å—è‰åœ°çš„æ„Ÿè§‰ï¼Œäºæ˜¯Johnä¸ä¼šé€‰æ‹©ä¸¤å—ç›¸é‚»çš„åœŸåœ°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰å“ªä¸¤å—è‰åœ°æœ‰å…¬å…±è¾¹ã€‚ Johnæƒ³çŸ¥é“ï¼Œå¦‚æœä¸è€ƒè™‘è‰åœ°çš„æ€»å—æ•°ï¼Œé‚£ä¹ˆï¼Œä¸€å…±æœ‰å¤šå°‘ç§ç§æ¤æ–¹æ¡ˆå¯ä¾›ä»–é€‰æ‹©ï¼Ÿï¼ˆå½“ç„¶ï¼ŒæŠŠæ–°ç‰§åœºå®Œå…¨è’åºŸä¹Ÿæ˜¯ä¸€ç§æ–¹æ¡ˆï¼‰ è¾“å…¥æ ¼å¼ ç¬¬ä¸€è¡Œï¼šä¸¤ä¸ªæ•´æ•°Må’ŒNï¼Œç”¨ç©ºæ ¼éš”å¼€ã€‚ ç¬¬2åˆ°ç¬¬M+1è¡Œï¼šæ¯è¡ŒåŒ…å«Nä¸ªç”¨ç©ºæ ¼éš”å¼€çš„æ•´æ•°ï¼Œæè¿°äº†æ¯å—åœŸåœ°çš„çŠ¶æ€ã€‚ç¬¬i+1è¡Œæè¿°äº†ç¬¬iè¡Œçš„åœŸåœ°ï¼Œæ‰€æœ‰æ•´æ•°å‡ä¸º0æˆ–1ï¼Œæ˜¯1çš„è¯ï¼Œè¡¨ç¤ºè¿™å—åœŸåœ°è¶³å¤Ÿè‚¥æ²ƒï¼Œ0åˆ™è¡¨ç¤ºè¿™å—åœŸåœ°ä¸é€‚åˆç§è‰ã€‚ è¾“å‡ºæ ¼å¼ ä¸€ä¸ªæ•´æ•°ï¼Œå³ç‰§åœºåˆ†é…æ€»æ–¹æ¡ˆæ•°é™¤ä»¥100,000,000çš„ä½™æ•°ã€‚ è¾“å…¥ 2 3 1 1 1 0 1 0 è¾“å‡º 9 è§£é¢˜æ€è·¯ æˆ‘ä»¬å…ˆä½œå‡ºè§„å®šï¼Œå®šä¹‰$n$ä»£è¡¨çš„æ˜¯è¡Œï¼Œ$m$ä»£è¡¨çš„æ˜¯åˆ—ã€‚é‚£ä¹ˆç‰§åœºå¤§å°å°±æ˜¯$n\\times m$ã€‚æˆ‘ä»¬çœ‹åˆ°æ•°æ®èŒƒå›´,$n,m$éƒ½ç‰¹åˆ«å°ï¼ŒåŒæ—¶æ‰€æ±‚ä¸ºæ–¹æ¡ˆæ•°ï¼Œè¿™å¾ˆç¬¦åˆçŠ¶å‹DPçš„é€‚ç”¨æ¡ä»¶ã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹æˆä¸€ä¸ªæœªçŸ¥é›†åˆï¼Œè€Œé›†åˆçš„å¤§å°è‡ªç„¶å°±æ˜¯åˆ—$m$ã€‚å¯¹äºæ¯ä¸€ä¸ªå•å…ƒï¼Œå…¶å–å€¼èŒƒå›´ä¸º$0,1$ï¼Œè€Œ$1$ä»£è¡¨æ”¾ç½®å¥¶ç‰›ï¼Œ$0$ä»£è¡¨ä¸æ”¾ç½®å¥¶ç‰›ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªç„¶å¯ä»¥ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œé‚£ä¹ˆçŠ¶æ€æ€»æ•°å°±æ˜¯$(1 Â« m) - 1$ã€‚ å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­æ˜¯å¦åˆæ ¼ï¼Œè€Œå…¶ä¸­æ˜ç¡®ä¸èƒ½é€‰æ‹©ä¸¤å—ç›¸é‚»çš„åœŸåœ°ï¼Œåœ¨é›†åˆå†…ï¼Œå³ç›¸é‚»ä½ä¸èƒ½å…¨ä¸º$1$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†$g$æ•°ç»„ï¼Œå¤„ç†æ–¹å¼å³ä¸º:g[i] = !(i \u0026 (i \u003c\u003c 1))ï¼›åŒæ ·ï¼Œæˆ‘ä»¬è¿˜åº”è¯¥çŸ¥æ™“åœŸåœ°çš„çŠ¶å†µï¼Œå› ä¸ºæ¯•ç«Ÿåªæœ‰åœŸåœ°è‚¥æ²ƒæ‰å¯ä»¥æ”¾ç½®å¥¶ç‰›ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ª$st$æ•°ç»„åˆ¤æ–­ï¼Œé›†åˆä¸é›†åˆä¹‹é—´ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è€ƒè™‘ç›¸é‚»ä½ä¸èƒ½å…¨ä¸º$1$ï¼Œæ‰€ä»¥åœ¨æšä¸¾ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€ä¹Ÿéœ€è¦ä¸¥æ ¼åˆ¤æ–­ã€‚å¯¹äºçŠ¶æ€å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨$f[i][j]$è¡¨ç¤ºç¬¬$i$è¡Œä¸”çŠ¶æ€ä¸º$j$çš„æ–¹æ¡ˆæ•°ã€‚å¯¹äºçŠ¶æ€è½¬ç§»ï¼Œå‡è®¾ä¸Šä¸€è¡ŒçŠ¶æ€ä¸º$k$ï¼Œåˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š $f[i][j] += f[i - 1][k]$ å…·ä½“è§$AC$ä»£ç ã€‚ ACä»£ç  /** *@filename:Corn Field G *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-28 16:50 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int N = 10 + 5,M = 10 + 5; const int P = 1e8; int n,m;//nè¡Œmåˆ—çš„åœŸåœ°ã€‚ int a[N][M],st[N];//aä»£è¡¨åœŸåœ°ï¼Œstä»£è¡¨æ¯ä¸€è¡Œçš„åœŸåœ°çŠ¶å†µã€‚ bool g[1 \u003c\u003c N];//gå¾—åˆ°æ‰€æœ‰çŠ¶æ€ä¸­çš„åˆæ³•çŠ¶æ€ã€‚ int f[N][1 \u003c\u003c N];//f[i][j]è¡¨ç¤ºçš„åˆ™æ˜¯ç¬¬iè¡Œä¸”çŠ¶æ€ä¸ºjçš„æ–¹æ¡ˆæ•°ï¼Œæ˜¯ç”±ä¸Šä¸€è¡Œè½¬ç§»è¿‡æ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸Šä¸€è¡Œçš„çŠ¶æ€ä¸ºkã€‚ //åˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºf[i][j] += f[i - 1][k];//å…¶ä¸­jå’Œkå¿…é¡»æ»¡è¶³æ¡ä»¶ã€‚ void solve(){ } int main(){ scanf(\"%d%d\", \u0026n, \u0026m); for(int i = 1; i \u003c= n; ++ i){ for(int j = 1; j \u003c= m; ++ j){ scanf(\"%d\", \u0026a[i][j]); } } //å¾—åˆ°æ¯ä¸€è¡Œçš„åœŸåœ°çŠ¶å†µã€‚ for(int i = 1; i \u003c= n; ++ i){ for(int j = 1; j \u003c= m; ++ j){ st[i] = (st[i] \u003c\u003c 1) + a[i][j]; } } //å¾—åˆ°æ‰€æœ‰çŠ¶æ€ä¸­çš„åˆæ³•çŠ¶æ€ã€‚ int maxn = 1 \u003c\u003c m;//æ€»çŠ¶æ€ã€‚ f[0][0] = 1;//åˆå§‹åŒ–ï¼Œè¿™ç§ä¹Ÿç®—ä¸€ç§ã€‚ for(int i = 0; i \u003c maxn; ++ i){ g[i] = !( i \u0026 (i \u003c\u003c 1));//ç”±äºä¸èƒ½ç›¸é‚»ï¼Œæ‰€ä»¥æˆ‘ä»¬å·¦ç§»åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚ } for(int i = 1; i \u003c= n; ++ i){ //æšä¸¾æ¯ä¸€è¡Œã€‚ for(int j = 0; j \u003c maxn; ++ j){ //æšä¸¾æ¯ä¸€è¡Œçš„çŠ¶æ€ï¼Œåˆ¤æ–­æ­¤çŠ¶æ€æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚1.ä¸èƒ½ç›¸é‚»ã€‚2.æ˜¯å…¨éƒ¨çŠ¶æ€çš„å­é›†ã€‚ if(g[j] \u0026\u0026 (j \u0026 st[i]) == j){ //å¦‚æœç¬¦åˆæ¡ä»¶ã€‚åˆ™æˆ‘ä»¬å»åˆ¤æ–­ä¸Šä¸€è¡Œæ˜¯å¦ç¬¦åˆã€‚ for(int k = 0; k \u003c maxn; ++ k){ //æšä¸¾ä¸Šä¸€è¡ŒçŠ¶æ€ã€‚æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬æ— éœ€åˆ¤æ–­ä¸Šä¸€è¡ŒçŠ¶æ€æ˜¯å¦å­˜åœ¨ï¼Œå› ä¸ºä¸å­˜åœ¨å³ä¸º0. //åªéœ€è¦åˆ¤æ–­jå’Œkæ˜¯å¦å­˜åœ¨ç›¸é‚»è‰åœ°ã€‚ if(!(j \u0026 k)){ f[i][j] = (f[i][j] + f[i - 1][k]) % P; } } } } } int ans = 0; for(int j = 0; j \u003c maxn; ++ j){ ans = (ans + f[n][j]) % P; } printf(\"%d\\n\", ans); solve(); return 0; } ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:5:1","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.2 5.2 åƒå¥¶é…ª é¢˜é¢ æˆ¿é—´é‡Œæ”¾ç€$n$å—å¥¶é…ªã€‚ä¸€åªå°è€é¼ è¦æŠŠå®ƒä»¬éƒ½åƒæ‰ï¼Œé—®è‡³å°‘è¦è·‘å¤šå°‘è·ç¦»ï¼Ÿè€é¼ ä¸€å¼€å§‹åœ¨ $(0,0)$ç‚¹å¤„ã€‚ è¾“å…¥æ ¼å¼ ç¬¬ä¸€è¡Œæœ‰ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå¥¶é…ªçš„æ•°é‡ nã€‚ ç¬¬ 22 åˆ°ç¬¬ (n + 1)è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªå®æ•°ï¼Œç¬¬ $(i + 1)$è¡Œçš„å®æ•°åˆ†åˆ«è¡¨ç¤ºç¬¬ $i$ å—å¥¶é…ªçš„æ¨ªçºµåæ ‡ $x_i, y_i$ã€‚ è¾“å‡ºæ ¼å¼ è¾“å‡ºä¸€è¡Œä¸€ä¸ªå®æ•°ï¼Œè¡¨ç¤ºè¦è·‘çš„æœ€å°‘è·ç¦»ï¼Œä¿ç•™ 2ä½å°æ•°ã€‚ è¾“å…¥ #1 4 1 1 1 -1 -1 1 -1 -1 è¾“å‡º #1 7.41 æ•°æ®è§„æ¨¡ä¸çº¦å®š å¯¹äºå…¨éƒ¨çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ $1\\leq n\\leq 15ï¼Œ|x_i|, |y_i| \\leq 200$ï¼Œå°æ•°ç‚¹åæœ€å¤šæœ‰ 3ä½æ•°å­—ã€‚ æç¤º å¯¹äºä¸¤ä¸ªç‚¹$$ (x_1,y_1)ï¼Œ(x_2, y_2)$$ï¼Œä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»å…¬å¼ä¸º$\\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$ã€‚ è§£é¢˜æ€è·¯ åŒæ ·ï¼Œæ ¹æ®æ•°æ®é‡ç­‰ä¿¡æ¯æˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°è¿™æ˜¯ä¸€ä¸ªçŠ¶å‹$DP$ã€‚å¥¶é…ªçš„çŠ¶æ€æ— éä¸¤ç§$0,1$ï¼Œè€Œæ ¹æ®é¢˜æ„æˆ‘ä»¬çš„é›†åˆæ•°é‡åªæœ‰$1$ä¸ªï¼Œé›†åˆå¤§å°è‡ªç„¶æ˜¯å¥¶é…ªçš„æ•°é‡ï¼Œè€Œå¥¶é…ªæœ‰$n$ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬çš„é›†åˆæƒ…å†µä¹Ÿæœ‰$(1 Â« n)-1$ç§ï¼ŒåŒæ ·åœ¨æ­¤é¢˜æˆ‘ä»¬éœ€è¦å…ˆåˆå§‹åŒ–å¥½å¥¶é…ªçš„åˆæ³•çŠ¶æ€ï¼Œç”¨$g$æ•°ç»„è¡¨ç¤ºï¼Œæ›´ä¸¥æ ¼çš„è¯´ï¼Œ$g[i]$è¡¨ç¤ºç¬¬$i$ä¸ªå¥¶é…ªæ‰€åœ¨çš„äºŒè¿›åˆ¶ä¸­çš„ä½ç½®ï¼Œç”¨åè¿›åˆ¶æ•°è¡¨ç¤º ã€‚ç”±äºæˆ‘ä»¬è¿˜éœ€è¦è®¡ç®—è·ç¦»ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æ¯ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ä¹Ÿæ±‚å‡ºæ¥ï¼Œç”¨$dist$æ•°ç»„é¢„å¤„ç†å¥¶é…ªä¹‹é—´çš„è·ç¦»ä»¥åŠèµ·ç‚¹ä¸å„ä¸ªå¥¶é…ªçš„è·ç¦»ã€‚ é‚£ä¹ˆåœ¨çŠ¶æ€å®šä¹‰ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨$f[i][j]$è¡¨ç¤ºå½“å‰ä¸º$i$çŠ¶æ€ï¼Œä¸”å¤„äºç¬¬$j$ä¸ªå¥¶é…ªçš„æœ€å°è·ç¦»ï¼Œæ•…çŠ¶æ€è½¬ç§»æ–¹ç¨‹æ˜“çŸ¥ä¸ºï¼š $f[i][j]=min(f[i][j],f[i-g[j]][k]+dist[k][j])$ æ®æ­¤ï¼Œé¢˜ç›®å¯è§£ï¼Œå…·ä½“çœ‹ä»£ç ã€‚ ACä»£ç  /** *@filename:åƒå¥¶é…ª *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-30 14:20 **/ #include \u003cbits/stdc++.h\u003e #define x first #define y second using namespace std; typedef long long ll; typedef pair\u003cdouble,double\u003e pdd; const int N = 16; const int P = 1e9+7; int n; pdd a[N]; double dist[N][N];//dist[i][j]è¡¨ç¤ºç¬¬iä¸ªå¥¶é…ªåˆ°ç¬¬jä¸ªå¥¶é…ªçš„è·ç¦»ã€‚ int g[1 \u003c\u003c N];//å¥¶é…ªçš„çŠ¶æ€ã€‚ double f[1 \u003c\u003c N][N];//f[i][j]è¡¨ç¤ºå½“å‰ä¸ºiçŠ¶æ€ï¼Œä¸”å¤„äºç¬¬jä¸ªå¥¶é…ªçš„æœ€å°è·ç¦»ã€‚ pdd st; double get(pdd a,pdd b){ return sqrt(pow(a.x - b.x,2) + pow(a.y - b.y,2)); } void solve(){ //å…ˆè®¡ç®—è·ç¦»ã€‚ st.x = 0,st.y = 0; for(int i = 1; i \u003c= n; ++ i){ dist[0][i] = get(st,a[i]); } for(int i = 1; i \u003c= n; ++ i){ for(int j = 1; j \u003c= n; ++ j){ dist[i][j] = get(a[i],a[j]); } } int maxn = 1 \u003c\u003c n; //åˆå§‹åŒ–å¥¶é…ªçš„çŠ¶æ€ã€‚ g[1] = 1; for(int i = 2; i \u003c= n; ++ i){ g[i] = g[i - 1] \u003c\u003c 1; } //åˆå§‹åŒ–æœ€å¤§å€¼ã€‚ fill(f[0],f[0] + (1 \u003c\u003c N) * N,0x3f3f3f3f); //ç¡®å®šåªåƒäº†ä¸€ä¸ªå¥¶é…ªçš„è·ç¦»ã€‚ for(int i = 1; i \u003c= n; ++ i){ f[g[i]][i] = dist[0][i]; } f[0][0] = 0;//æœ€å¼€å§‹è‡ªç„¶ä¸º0ï¼Œ0. for(int i = 0; i \u003c maxn ; ++ i){ //æšä¸¾æ‰€æœ‰çŠ¶æ€ã€‚ for(int j = 1; j \u003c= n; ++ j){ if(i \u0026 g[j]){ //è¯¥çŠ¶æ€å¦‚æœåŒ…å«æ­¤å¥¶é…ªå°±è·³è¿‡ã€‚ for(int k = 1; k \u003c= n; ++ k){ if(k != j \u0026\u0026 i \u0026 g[k]){ //è¯´æ˜ç¬¦åˆæ¡ä»¶ã€‚ f[i][j] = min(f[i][j],f[i - g[j]][k] + dist[k][j]);//è¿›è¡ŒçŠ¶æ€è½¬ç§»ã€‚ } } } } } double maxx = 0x3f3f3f3f; for(int i = 1; i \u003c= n; ++ i){ maxx = min(maxx,f[maxn - 1][i]); } printf(\"%.2lf\\n\",maxx); } int main(){ scanf(\"%d\", \u0026n); for(int i = 1; i \u003c= n; ++ i){ scanf(\"%lf%lf\", \u0026a[i].x, \u0026a[i].y); } solve(); return 0; } ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:5:2","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.3 5.3 USACO13NOV No Change G é¢˜é¢ çº¦ç¿°åˆ°å•†åœºè´­ç‰©ï¼Œä»–çš„é’±åŒ…é‡Œæœ‰K(1 \u003c= K \u003c= 16)ä¸ªç¡¬å¸ï¼Œé¢å€¼çš„èŒƒå›´æ˜¯1..100,000,000ã€‚ çº¦ç¿°æƒ³æŒ‰é¡ºåºä¹° Nä¸ªç‰©å“(1 \u003c= N \u003c= 100,000)ï¼Œç¬¬iä¸ªç‰©å“éœ€è¦èŠ±è´¹c(i)å—é’±ï¼Œ(1 \u003c= c(i) \u003c= 10,000)ã€‚ åœ¨ä¾æ¬¡è¿›è¡Œçš„è´­ä¹°Nä¸ªç‰©å“çš„è¿‡ç¨‹ä¸­ï¼Œçº¦ç¿°å¯ä»¥éšæ—¶åœä¸‹æ¥ä»˜æ¬¾ï¼Œæ¯æ¬¡ä»˜æ¬¾åªç”¨ä¸€ä¸ªç¡¬å¸ï¼Œæ”¯ä»˜è´­ä¹°çš„å†…å®¹æ˜¯ä»ä¸Šä¸€æ¬¡æ”¯ä»˜åå¼€å§‹åˆ°ç°åœ¨çš„è¿™äº›æ‰€æœ‰ç‰©å“ï¼ˆå‰ææ˜¯è¯¥ç¡¬å¸è¶³ä»¥æ”¯ä»˜è¿™äº›ç‰©å“çš„è´¹ç”¨ï¼‰ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå•†åœºçš„æ”¶é“¶æœºåäº†ï¼Œå¦‚æœçº¦ç¿°æ”¯ä»˜çš„ç¡¬å¸é¢å€¼å¤§äºæ‰€éœ€çš„è´¹ç”¨ï¼Œä»–ä¸ä¼šå¾—åˆ°ä»»ä½•æ‰¾é›¶ã€‚ è¯·è®¡ç®—å‡ºåœ¨è´­ä¹°å®ŒNä¸ªç‰©å“åï¼Œçº¦ç¿°æœ€å¤šå‰©ä¸‹å¤šå°‘é’±ã€‚å¦‚æœæ— æ³•å®Œæˆè´­ä¹°ï¼Œè¾“å‡º-1 è¾“å…¥æ ¼å¼ *Line 1: Two integers, K and N. * Lines 2..1+K: Each line contains the amount of money of one of FJâ€™s coins. * Lines 2+K..1+N+K: These N lines contain the costs of FJâ€™s intended purchases. è¾“å‡ºæ ¼å¼ * Line 1: The maximum amount of money FJ can end up with, or -1 if FJ cannot complete all of his purchases. è¾“å…¥ #1 3 6 12 15 10 6 3 3 2 3 7 è¾“å‡º #1 12 è¯´æ˜/æç¤º FJ has 3 coins of values 12, 15, and 10. He must make purchases in sequence of value 6, 3, 3, 2, 3, and 7. FJ spends his 10-unit coin on the first two purchases, then the 15-unit coin on the remaining purchases. This leaves him with the 12-unit coin. è§£é¢˜æ€è·¯ æ­¤é¢˜çŠ¶æ€å®šä¹‰æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºå®é™…ä¸Šæˆ‘ä»¬åªåœ¨ä¹äº†ç¡¬å¸çš„èŠ±è´¹ï¼Œè¿™å·²ç»æ˜¯ä¸€ä¸ªé›†åˆäº†ï¼ŒèŠ±è´¹ä¸º$1$ä¸èŠ±è´¹ä¸º$0$ï¼Œè€Œå…¶ä»–å¹¶ä¸ç”¨åœ¨ä¹ã€‚æ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨$f[i]$è¡¨ç¤ºåœ¨$i$çŠ¶æ€ä¸‹èƒ½å¤Ÿè´­ä¹°çš„æœ€å¤§ç‰©å“æ•°ã€‚æ­¤é¢˜éš¾ç‚¹åœ¨äºçŠ¶æ€è½¬ç§»ã€‚åŒæ ·åœ¨æ­¤é¢˜æˆ‘ä»¬éœ€è¦å…ˆåˆå§‹åŒ–å¥½ç¡¬å¸çš„åˆæ³•çŠ¶æ€ï¼Œç”¨$g$æ•°ç»„è¡¨ç¤ºï¼Œæ›´ä¸¥æ ¼çš„è¯´ï¼Œ$g[i]$è¡¨ç¤ºç¬¬$i$ä¸ªç¡¬å¸æ‰€åœ¨çš„äºŒè¿›åˆ¶ä¸­çš„ä½ç½®ã€‚ç”¨åè¿›åˆ¶æ•°è¡¨ç¤ºã€‚ä¸ºäº†æ–¹ä¾¿å¤„ç†ï¼Œæˆ‘ä»¬éœ€è¦ç”¨å‰ç¼€å’Œæ¥ä¼˜åŒ–æœ¬é¢˜ï¼Œå› ä¸ºåœ¨å¤„ç†è¿‡ç¨‹ä¸­æˆ‘ä»¬éšæ—¶éƒ½è¦è®¡ç®—å½“å‰å·²æœ‰çš„æ€»ä»·å€¼èƒ½å¤Ÿæ¢å–å¤šå°‘ç‰©å“ã€‚ åŒæ ·ï¼Œåœ¨çŠ¶æ€è½¬ç§»æ–¹é¢ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å‰é¢çš„çŠ¶æ€å¾—åˆ°åè€…çš„çŠ¶æ€ï¼Œè€Œç”±äºæˆ‘ä»¬æ˜¯ä»å°åˆ°å¤§æšä¸¾çŠ¶æ€çš„ï¼Œæ•…ä¸€å®šå¯ä»¥åˆ©ç”¨å‰é¢çš„çŠ¶æ€è€Œä¸ä¼šå‡ºç°å‰é¢çŠ¶æ€ä¸æ˜¯æœ€ä¼˜è§£ï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ç§çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥æ’é™¤ä¸€ä¸ªç¡¬å¸è·å–å‰é¢çš„æœ€ä¼˜è§£ï¼Œå³æšä¸¾è¯¥çŠ¶æ€å·²æœ‰çš„ç¡¬å¸ï¼Œé€šè¿‡å¼‚æˆ–æ’é™¤ï¼Œæœ€ååˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰€èƒ½è´­ä¹°çš„æœ€å¤§å€¼å¾—åˆ°æœ€ä¼˜è§£ã€‚ è¯´èµ·æ¥æœ‰ç‚¹ä¹±ï¼Œè¯¦æƒ…å¯è§$AC$ä»£ç ã€‚ ACä»£ç  /** *@filename:No_Change_G *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-28 17:14 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int N = 1000000 + 5,K = 20; const int P = 1e9+7; int n,k; int g[K];//æ¯ä¸ªç¡¬å¸çš„çŠ¶æ€ã€‚ int w[K];//ç¡¬å¸çš„ä»·å€¼ int sum[N];//ç‰©å“ä»·å€¼çš„å‰ç¼€å’Œã€‚ int ans; int f[1 \u003c\u003c K];//f[i]è¡¨ç¤ºåœ¨içŠ¶æ€ä¸‹èƒ½å¤Ÿè´­ä¹°çš„æœ€å¤§ç‰©å“æ•°ã€‚ void solve(){ //åˆå§‹åŒ–ç¡¬å¸çŠ¶æ€ã€‚ g[1] = 1; for(int i = 2; i \u003c= k; ++ i){ g[i] = g[i -1] \u003c\u003c 1; } int maxn = 1 \u003c\u003c k;//å¾—åˆ° for(int i = 0; i \u003c maxn; ++ i){ //æšä¸¾æ¯ä¸€ç§çŠ¶æ€ã€‚ for(int j = 1; j \u003c= k; ++ j){ //æšä¸¾æ‰€æœ‰çš„ç¡¬å¸ã€‚ if(i \u0026 g[j]){ //è¯´æ˜è¯¥ç¡¬å¸åœ¨å½“å‰çŠ¶æ€ä½¿ç”¨è¿‡ã€‚ int te = f[i ^ g[j]];//è·å–è¯¥çŠ¶æ€ä¸ä½¿ç”¨jèƒ½è·å¾—çš„ç‰©å“æ•°ã€‚ te = upper_bound(sum + 1,sum + n + 1,sum[te] + w[j]) - sum;//è¿™é‡Œéœ€è¦å‡1. f[i] = max(f[i],te - 1); } } } ll maxx = -2,temp; for(int i = 0; i \u003c maxn; ++ i){ if(f[i] == n){ //è¯´æ˜è¯¥çŠ¶æ€èƒ½å¤Ÿå°†æ‰€æœ‰ç‰©å“éƒ½ä¹°å®Œã€‚ temp = 0; for(int j = 1; j \u003c= k; ++ j){ if(i \u0026 g[j]){ temp += w[j]; } } maxx = max(maxx,ans - temp); } } if(maxx \u003c 0)printf(\"%d\\n\", -1); else printf(\"%d\\n\",maxx); } int main(){ scanf(\"%d%d\", \u0026k , \u0026n); for(int i = 1; i \u003c= k; ++ i){ scanf(\"%d\", \u0026w[i]); ans += w[i];//æ±‚ç¡¬å¸æ€»ä»·å€¼ã€‚ } for(int i = 1; i \u003c= n; ++ i){ scanf(\"%d\", \u0026sum[i]); sum[i] += sum[i - 1]; } solve(); return 0; } ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:5:3","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.4 5.4 SCOI2005äº’ä¸ä¾µçŠ¯ é¢˜é¢ åœ¨NÃ—Nçš„æ£‹ç›˜é‡Œé¢æ”¾Kä¸ªå›½ç‹ï¼Œä½¿ä»–ä»¬äº’ä¸æ”»å‡»ï¼Œå…±æœ‰å¤šå°‘ç§æ‘†æ”¾æ–¹æ¡ˆã€‚å›½ç‹èƒ½æ”»å‡»åˆ°å®ƒä¸Šä¸‹å·¦å³ï¼Œä»¥åŠå·¦ä¸Šå·¦ä¸‹å³ä¸Šå³ä¸‹å…«ä¸ªæ–¹å‘ä¸Šé™„è¿‘çš„å„ä¸€ä¸ªæ ¼å­ï¼Œå…±8ä¸ªæ ¼å­ã€‚ è¾“å…¥æ ¼å¼ åªæœ‰ä¸€è¡Œï¼ŒåŒ…å«ä¸¤ä¸ªæ•°Nï¼ŒK ï¼ˆ 1 \u003c=N \u003c=9, 0 \u003c= K \u003c= N * Nï¼‰ è¾“å‡ºæ ¼å¼ æ‰€å¾—çš„æ–¹æ¡ˆæ•° è¾“å…¥ #1 3 2 è¾“å‡º #1 16 è§£é¢˜æ€è·¯ è¿™é“é¢˜è·Ÿ$5.1$ä¾‹é¢˜æœ‰ç‚¹ç›¸ä¼¼ï¼Œåªä¸è¿‡è¿™é‡Œå¤šäº†å·¦ä¸Šå·¦ä¸‹å³ä¸Šå³ä¸‹è¿™å‡ ä¸ªç‚¹ï¼Œå¤„ç†æ–¹æ³•ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ¯ä¸ªçŠ¶æ€çš„æ”¾ç½®å›½ç‹æ•°ï¼Œæ‰€ä»¥è¿™æˆ‘ä»¬éœ€è¦é¢„å¤„ç†ã€‚å®šä¹‰çŠ¶æ€$f[i][j][k]$è¡¨ç¤ºåœ¨ç¬¬$i$è¡Œä¸”å¤„äº$j$çŠ¶æ€æ—¶å·²ç»æ”¾ç½®äº†$k$ä¸ªå›½ç‹ã€‚å…¶ä»–çš„å¤„ç†æ–¹å¼å’Œ$5.1$ç›¸åŒï¼Œè¿™é‡Œä¸ä½œå™è¿°ï¼Œå¯è§$AC$ä»£ç ã€‚ ACä»£ç  /** *@filename:äº’ä¸ä¾µçŠ¯ *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-31 16:32 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int N = 10; const int P = 1e9+7; int n,m; int tot,num[1 \u003c\u003c N];//num[i]è¡¨ç¤ºç¬¬iç§å¯è¡ŒçŠ¶æ€çš„å›½ç‹æ‰€æ”¾æ•°é‡ã€‚ ll f[N][1 \u003c\u003c N][N * N];//f[i][j][k]è¡¨ç¤ºå‰iè¡Œï¼Œå½“å‰å¤„äºjçŠ¶æ€ä¸”å·²ç»æ”¾ç½®äº†kä¸ªå›½ç‹ã€‚ int get(int x){ //è·å–è¯¥çŠ¶æ€æœ‰å¤šå°‘å›½ç‹ã€‚ int sum = 0; for(int i = 0; i \u003c n; ++ i){ sum += (x \u0026 1); x \u003e\u003e= 1; } return sum; } void init(){ int maxn = 1 \u003c\u003c n; for(int i = 0; i \u003c maxn; ++ i){ if(i \u0026 (i \u003c\u003c 1))continue;//è¯´æ˜å­˜åœ¨ç›¸é‚»çš„ã€‚ num[i] = get(i); f[1][i][num[i]] = 1; } } void solve(){ init(); int maxn = 1 \u003c\u003c n; for(int i = 2; i \u003c= n; ++ i){ for(int j = 0; j \u003c maxn; ++ j){ //æšä¸¾æ‰€æœ‰çŠ¶æ€ã€‚ if(j \u0026 (j \u003c\u003c 1))continue; for(int k = 0; k \u003c maxn; ++ k){ //æšä¸¾ä¸Šä¸€è¡Œçš„æ‰€æœ‰çŠ¶æ€ã€‚ if(((k \u0026 (k \u003c\u003c 1)) || j \u0026 k || ((j \u003c\u003c 1) \u0026 k) || (j \u0026 (k \u003c\u003c 1)))){ continue; } for(int cnt = num[j]; cnt \u003c= m; ++ cnt){ f[i][j][cnt] += f[i - 1][k][cnt - num[j]]; } } } } ll ans = 0; for(int i= 0; i \u003c maxn; ++ i){ ans += f[n][i][m]; } printf(\"%lld\\n\",ans); } int main(){ scanf(\"%d %d\", \u0026n, \u0026m); solve(); return 0; } ","date":"2021-05-31","objectID":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/:5:4","tags":["çŠ¶å‹DP"],"title":"çŠ¶å‹DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£","uri":"/posts/02.%E7%8A%B6%E5%8E%8Bdp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 ä½è¿ç®—æ¦‚è¿° æˆ‘ä»¬çŸ¥é“ï¼Œè®¡ç®—æœºä¸­çš„æ•°åœ¨å†…å­˜ä¸­éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶å½¢å¼è¿›è¡Œå­˜å‚¨çš„ ï¼Œè€Œä½è¿ç®—å°±æ˜¯ç›´æ¥å¯¹æ•´æ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œï¼Œå› æ­¤å…¶æ‰§è¡Œæ•ˆç‡éå¸¸é«˜ï¼Œåœ¨ç¨‹åºä¸­å°½é‡ä½¿ç”¨ä½è¿ç®—è¿›è¡Œæ“ä½œï¼Œè¿™ä¼šå¤§å¤§æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚ é‚£ä¹ˆï¼Œæ¶‰åŠä½è¿ç®—çš„è¿ç®—ç¬¦å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š ç¬¦å· æè¿° è¿ç®—è§„åˆ™ å®ä¾‹ï¼ˆä»¥å››ä½äºŒè¿›åˆ¶æ•°ä¸ºä¾‹ï¼‰ \u0026 ä¸ ä¸¤ä¸ªä½éƒ½ä¸º1æ—¶ï¼Œç»“æœæ‰ä¸º1ã€‚ $0001\u00260001=1,0001\u00260000=0,0000\u00260000=0000$ | æˆ– ä¸¤ä¸ªä½éƒ½ä¸º0æ—¶ï¼Œç»“æœæ‰ä¸º0ã€‚ $0001|0001=0001,0001|0000=0001,0000|0000=0000$ ^ å¼‚æˆ– ä¸¤ä¸ªä½ç›¸åŒä¸º0ï¼Œç›¸å¼‚ä¸º1ã€‚ $0001 \\wedge0001=0000,0001\\wedge0000=1,0000\\wedge 0000=0$ ~ å–å 0å˜1ï¼Œ1å˜0ã€‚ $\\sim0=1,\\sim 1 = 0$ Â« å·¦ç§» å„äºŒè¿›ä½å…¨éƒ¨å·¦ç§»è‹¥å¹²ä½ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥0ã€‚ $0001Â«k=0100ï¼Œk=2$ï¼Œ$k$æ˜¯å·¦ç§»çš„ä½æ•°ï¼Œè¿™é‡Œ$k=2$ Â» å³ç§» å„äºŒè¿›ä½å…¨éƒ¨å³ç§»è‹¥å¹²ä½ï¼Œå¯¹æ— ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥0ï¼Œæœ‰ç¬¦å·æ•°ï¼Œå³ç§»è¡¥$1$ã€‚ $0100Â»k=0001ï¼Œk=2$ï¼Œ$k$æ˜¯å³ç§»çš„ä½æ•°ï¼Œè¿™é‡Œ$k=2$ çœ‹å®Œï¼Œä½ å¯èƒ½ä¼šè§‰å¾—æŒºç®€å•çš„ï¼Œ ä½†ä½è¿ç®—çš„éš¾ç‚¹å¹¶ä¸åœ¨è¿™ï¼Œè€Œåœ¨äºå…¶æ€§è´¨ã€é«˜çº§æ“ä½œå’Œå®ƒçš„åº”ç”¨ã€‚ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:1:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 ä½è¿ç®—çš„æ€§è´¨ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:2:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.1 è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ ä¼˜å…ˆçº§éœ€è¦å¼„æ¸…æ¥šï¼Œå¦‚æœä¸å¤ªæ¸…æ¥šå¯ä»¥åŠ å°æ‹¬å·ç¡®ä¿æ˜¯æƒ³è¦çš„è¿ç®—é¡ºåºï¼Œè¿™é‡Œåªæ˜¯ç›¸å¯¹ä¼˜å…ˆçº§ï¼Œå³åªæ˜¯å’Œä¸€äº›å¸¸ç”¨çš„ç®—æœ¯è¿ç®—ç¬¦åšæ¯”è¾ƒã€‚ ä¼˜å…ˆçº§ è¿ç®—ç¬¦ ç»“åˆæ–¹å‘ 1 $-ï¼ˆç¬¦å·è¿ç®—ç¬¦ï¼‰,\\simï¼ˆå–åè¿ç®—ç¬¦ï¼‰ï¼Œ ++ï¼ˆè‡ªå¢ï¼‰ï¼Œâ€“ï¼ˆè‡ªå‡ï¼‰$ ä»å³åˆ°å·¦ 2 $*ï¼ˆä¹˜ï¼‰,/ï¼ˆé™¤ï¼‰,%ï¼ˆå–ä½™ï¼‰$ ä»å·¦åˆ°å³ 3 $+ï¼ˆåŠ ï¼‰,-ï¼ˆå‡ï¼‰$ ä»å·¦åˆ°å³ 4 $Â«ï¼ˆå·¦ç§»ï¼‰ï¼ŒÂ»ï¼ˆå³ç§»ï¼‰$ ä»å·¦åˆ°å³ 5 $\u003eï¼ˆå¤§äºï¼‰,\u003c(å°äº),\u003e=(å¤§äºç­‰äº),\u003c=(å°äºç­‰äº)$ ä»å·¦åˆ°å³ 6 $==(ç­‰äº),!=ï¼ˆä¸ç­‰äºï¼‰$ ä»å·¦åˆ°å³ 7 $\u0026ï¼ˆæŒ‰ä½ä¸ï¼‰$ ä»å·¦åˆ°å³ 8 $\\wedge (æŒ‰ä½å¼‚æˆ–)$ ä»å·¦åˆ°å³ 9 $|(æŒ‰ä½æˆ–)$ ä»å·¦åˆ°å³ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:2:1","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.2 ä½è¿ç®—ç¬¦çš„è¿ç®—å¾‹ å…¬å¼åç§° è¿ç®—è§„åˆ™ äº¤æ¢å¾‹ $A\u0026B=B\u0026A ,A\\wedge B=B\\wedgeA$ ç»“åˆå¾‹ï¼ˆæ³¨æ„ç»“åˆå¾‹åªèƒ½åœ¨åŒç¬¦å·ä¸‹è¿›è¡Œï¼‰ $(A\u0026B)\u0026C=A\u0026(B\u0026C)$ ç­‰å¹‚å¾‹ $A\u0026A=Aï¼ŒA|A=A$ é›¶å¾‹ $A\u00260=0$ äº’è¡¥å¾‹ï¼ˆæ³¨æ„ï¼Œè¿™ä¸åŒäºé€»è¾‘è¿ç®—ï¼‰ $A\u0026\\sim A=0, A|\\sim A=-1$ åŒä¸€å¾‹ $A|0=A, A\\wedge 0 =A$ ä»¥ä¸Šä»…ä¸ºå·²è¯æ˜çš„è¿ç®—å¾‹ï¼ˆå¯èƒ½å­˜åœ¨é—æ¼ï¼‰ï¼Œå…¶ä½™çš„åšä¸»å‡è®¤ä¸ºæ˜¯ä¸ç¬¦åˆä¸æˆç«‹çš„ï¼Œæ³¨æ„ï¼šåƒä¸‡ä¸è¦å°†é€»è¾‘è¿ç®—çš„è¿ç®—å¾‹æˆ–è€…å…¶ä»–çš„è¿ç®—å¾‹ä¸è¿™æ··ä¸ºä¸€è°ˆã€‚ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:2:2","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 ä½è¿ç®—é«˜çº§æ“ä½œ å¦‚ä¸‹è¡¨ï¼Œè¯·è¯»è€…è®¤çœŸé˜…è¯»ç†è§£ï¼Œåœ¨é˜…è¯»çš„è¿‡ç¨‹ä¸­å¯ä»¥å¯¹ç¤ºä¾‹è¿›è¡Œè¿ç®—ã€‚ åŠŸèƒ½ ç¤ºä¾‹ ä½è¿ç®— å»æ‰æœ€åä¸€ä½ $0100-\u003e0010$ $xÂ»1$ åœ¨æœ€ååŠ ä¸€ä¸ª$0$ $0100-\u003e1000$ $xÂ«1$ åœ¨æœ€ååŠ ä¸€ä¸ª1 $0100-\u003e1001$ $(xÂ«1)+1$ å°†æœ€åä¸€ä½å˜ä¸º$1$ $0100-\u003e0101$ $x|1$ å°†æœ€åä¸€ä½å˜ä¸º$0$ $0101-\u003e0100$ï¼Œè¿™é‡Œå®é™…ä¸Šå°±æ˜¯å…ˆç¡®ä¿æœ€ä½ä½å˜ä¸º$1$ï¼Œå†å‡å»$1$ã€‚ $(x|1)-1$ æœ€åä¸€ä½å–å $0100-\u003e0101$ ï¼Œåˆ©ç”¨å¼‚æˆ–æ€§è´¨ï¼Œå…¶ä¸­é™¤æœ€åä¸€ä½å…¶ä½™ä¸å˜ã€‚ $x\\wedge1$ æŠŠå³æ•°çš„ç¬¬$k$ä½å˜ä¸º$1$ $0001-\u003e1001,k=4$ $x|(1Â«(k-1))$ æŠŠå³æ•°çš„ç¬¬$k$ä½å˜ä¸º$0$ $1001-\u003e0001,k=4$ï¼Œè¿™ä¸ªæ“ä½œå®é™…ä¸Šå°±æ˜¯å…ˆå¾—åˆ°äº†$1000$ï¼Œç„¶åå–åå¾—åˆ°$0111$ï¼Œæœ€ååˆ©ç”¨æŒ‰ä½ä¸çš„æ€§è´¨å…¶ä½™ä½ä¸å˜ï¼Œæœ€é«˜ä½ä¸º$0$ $x\u0026(\\sim(1Â«(k-1)))$ æŠŠå³æ•°çš„ç¬¬$k$ä½å–å $1000-\u003e0000,k=4$ï¼Œåˆ©ç”¨å¼‚æˆ–æ€§è´¨ $x\\wedge (1Â«(k-1))$ ç”±äºè¡¨é•¿é™åˆ¶ï¼Œè¿™é‡Œæ¥ä¸‹è¡¨ç»§ç»­ï¼š åŠŸèƒ½ ç¤ºä¾‹ ä½è¿ç®— å–æœ«$k$ä½ $1011-\u003e0011,k=2$ $x\u0026((1Â«k)-1)$ å–å³æ•°çš„ç¬¬$k$ä½ $1011-\u003e0001,k=4$ï¼Œå³ç§»$k-1$ä½åˆ™æ˜¯å»æ‰äº†æœ€åçš„$k-1$ä½ï¼Œæˆ‘ä»¬åˆ©ç”¨æŒ‰ä½ä¸å³å¯å°†å…¶æå–å‡ºæ¥ $xÂ»(k-1)\u00261$ æŠŠæœ«$k$ä½å…¨å˜ä¸º$1$ $1000-\u003e1111,k=3$ $x|((1Â«k)-1)$ æŠŠæœ«$k$ä½å–å $0101-\u003e1010,k=4$ $x\\wedge ((1Â«k)-1)$ æŠŠå³è¾¹è¿ç»­çš„$1$å˜ä¸º$0$ $0111-\u003e0000$ ï¼Œæ³¨æ„æ˜¯å³èµ·è¿ç»­çš„$1$ $x\u0026(x+1)$ æŠŠå³èµ·çš„ç¬¬ä¸€ä¸ª$0$å˜ä¸º$1$ $0011-\u003e0111$ $x|(x+1)$ æŠŠå³èµ·è¿ç»­çš„$0$å˜ä¸º$1$ $1000-\u003e1111$ï¼Œæ³¨æ„æ˜¯å³èµ·è¿ç»­çš„$0$ $x|(x-1)$ å–å³è¾¹è¿ç»­çš„$1$ $1011-\u003e0011$ $(x\\wedge (x+1))Â»1$ å»æ‰å³èµ·çš„ç¬¬ä¸€ä¸ª$1$çš„å·¦è¾¹ $1101-\u003e0001$ $x\u0026(x\\wedge (x-1))$ å½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯ä¸€äº›å¸¸ç”¨çš„ï¼Œå¹¶ä¸æ˜¯å…¨éƒ¨ï¼Œä½è¿ç®—çš„ç¥å¥‡è¿œä¸æ­¢äºæ­¤ã€‚ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:3:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 è´Ÿæ•°çš„ä½è¿ç®— é¦–å…ˆï¼Œæˆ‘ä»¬è¦çŸ¥é“ï¼Œåœ¨è®¡ç®—æœºä¸­ï¼Œè¿ç®—æ˜¯ä½¿ç”¨çš„äºŒè¿›åˆ¶è¡¥ç ï¼Œè€Œæ­£æ•°çš„è¡¥ç æ˜¯å®ƒæœ¬èº«ï¼Œè´Ÿæ•°çš„è¡¥ç åˆ™æ˜¯ç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™æŒ‰ä½å–åï¼Œæœ€åå†$+1$å¾—åˆ°çš„ï¼Œ ä¾‹å¦‚ï¼š $15$,åŸç :$00001111\\space$è¡¥ç :$00001111$ $-15$,åŸç :$10001111\\space$è¡¥ç :$11110001$ é‚£ä¹ˆå¯¹äºè´Ÿæ•°çš„ä½è¿ç®—è€Œè¨€ï¼Œå®ƒä»¬çš„æ“ä½œéƒ½æ˜¯å»ºç«‹åœ¨è¡¥ç ä¸Šçš„ï¼Œå¾—åˆ°çš„è¿ç®—ç»“æœæ˜¯è¡¥ç ï¼Œæœ€åå°†è¡¥ç ç»“æœè½¬åŒ–æˆä¸€ä¸ªæ™®é€šçš„åè¿›åˆ¶æ•°ç»“æœã€‚ ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºæœ‰ç¬¦å·æ•°çš„å³ç§»æ“ä½œï¼Œä¸åŒçš„å¤„ç†å™¨æ¶æ„å¯èƒ½æœ‰ä¸åŒçš„è§„å®šã€‚åœ¨æŸäº›æ¶æ„ä¸­ï¼ˆå¦‚x86ï¼‰ï¼Œå¦‚æœå¯¹æœ‰ç¬¦å·æ•°æ‰§è¡Œç®—æœ¯å³ç§»ï¼ˆarithmetic right shiftï¼‰ï¼Œåˆ™é«˜ä½ç©ºå‡ºæ¥çš„ä½ç½®ä¼šè¡¥ä¸Šç¬¦å·ä½ï¼›å¯¹äºæ— ç¬¦å·æ•°çš„å³ç§»æ“ä½œï¼Œæ‰€æœ‰æ¶æ„éƒ½éµå¾ªç›¸åŒçš„è§„åˆ™ï¼šé«˜ä½ç©ºå‡ºæ¥çš„ä½ç½®ä¼šè¡¥0ã€‚ä¾‹å¦‚å¯¹äº$-15$ï¼Œå…¶è¡¥ç ä¸º$11110001,$å³ç§»ä¸€ä½$(-15Â»1)$å¾—åˆ°çš„æ˜¯$11111000$ï¼Œå³$-8$ï¼Œå…¶ä»–çš„åŒç†ã€‚ åœ¨å¤§å¤šæ•°ç°ä»£å¤„ç†å™¨ä¸Šï¼Œæ— è®ºæ˜¯æœ‰ç¬¦å·æ•°è¿˜æ˜¯æ— ç¬¦å·æ•°ï¼Œå·¦ç§»æ“ä½œæ€»æ˜¯å°†ç©ºå‡ºæ¥çš„ä½ä½è¡¥0ã€‚ è¿™é‡Œæˆ‘ä»¬ä»‹ç»å‡ ä¸ªç‰¹æ®Šçš„æ€§è´¨ï¼š å¿«é€Ÿåˆ¤æ–­æ˜¯å¦ä¸º$-1$ åœ¨é“¾å¼å‰å‘æ˜Ÿä¸­ï¼Œæˆ‘ä»¬åˆå§‹åŒ–$head$æ•°ç»„ä¸º$-1$ï¼Œæœ€ååˆ¤æ–­æ˜¯å¦éå†å®Œ$u$çš„æ‰€æœ‰è¾¹æ—¶ï¼Œå³åˆ¤æ–­$i$æ˜¯å¦ä¸º$-1$ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨$\\sim i$å³å¯ã€‚åŸå› å°±åœ¨äº$-1$çš„è¡¥ç æ˜¯$11111111$ï¼ŒæŒ‰ä½å–åå°±å˜ä¸º$00000000$ï¼Œè¿™å®é™…ä¸Šå°±æ˜¯$0$ã€‚ å–æœ€ä½ä½çš„$1$ï¼Œlowbitå‡½æ•° ä¹Ÿå°±æ˜¯$x\u0026(-x)$ï¼Œè¿™åœ¨æ ‘çŠ¶æ•°ç»„ä¸­èµ·ç€å·¨å¤§ä½œç”¨ï¼Œè¿™é‡ŒæŒ‡è·¯ä¸€ç¯‡æ ‘çŠ¶æ•°ç»„è®²è§£$blog$:ç‚¹è¿™é‡Œï¼Œæˆ‘ä»¬æ¥è¯æ˜ä¸€ä¸‹ï¼Œè¿™é‡Œå–$x=15$ï¼Œå¯¹äº$15\u0026(-15)$ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨è¡¥ç ä¸Šè¿›è¡Œè¿ç®—å¾—åˆ°çš„æ˜¯$00000001$ï¼Œéœ€è¦æ³¨æ„äºŒå…ƒè¿ç®—çš„ç¬¦å·ä½æˆ‘ä»¬éœ€è¦è¿›è¡Œè¿ç®—ã€‚ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:4:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5 ä½è¿ç®—çš„ä¸€äº›åº”ç”¨ ä½è¿ç®—å®ç°ä¹˜é™¤æ³• å°†$x$å·¦ç§»ä¸€ä½å®ç°$\\times 2$ï¼Œå°†$x$å³ç§»ä¸€ä½å®ç°$\\div2$ã€‚ $aÂ«1 \\equiv a*2$ $a Â»1 \\equiv a/2$ ä½è¿ç®—äº¤æ¢ä¸¤æ•´æ•° void swap(int \u0026a,int \u0026b){ a ^= b; b ^= a; a ^= b; } è¿™æ•ˆç‡éå¸¸é«˜ï¼Œæˆ‘ä»¬æ¥å‰–æå…¶åŸç†ï¼Œå¯¹äº$a=a\\wedge b$ï¼Œåˆ™$b = b\\wedge(a\\wedge b)$ï¼Œæ ¹æ®äº¤æ¢å¾‹ä»¥åŠå¼‚æˆ–æ€§è´¨ï¼Œå¾—$b=b\\wedge b\\wedge a=0\\wedge a=a$ï¼ŒåŒç†$a=(a\\wedge b)\\wedge a=0\\wedge b=b$ã€‚è¿™æ ·å°±å®ç°äº†äº¤æ¢æ“ä½œã€‚ ä½è¿ç®—åˆ¤æ–­å¥‡å¶æ•° æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨äºŒè¿›åˆ¶ä¸­ï¼Œæœ€ä½ä½å†³å®šäº†æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æå–å‡ºæœ€ä½ä½çš„å€¼ï¼Œå³ä¸$1$ç›¸ä¸å³å¯å®ç°ç›®çš„ï¼Œä¸º$0$åˆ™æ˜¯å¶æ•°ï¼Œä¸º$1$åˆ™æ˜¯å¥‡æ•°ã€‚ ä½è¿ç®—æ”¹å˜æ­£è´Ÿæ€§å’Œæ±‚ç»å¯¹å€¼ int change(int a){ return ~ a + 1; } å¯¹äºæ­£æ•°è€Œè¨€ï¼Œè¡¥ç å°±æ˜¯åŸç ï¼Œæ‰€ä»¥æŒ‰ä½å–åå†$+1$åˆ™å¾—åˆ°å¯¹åº”çœŸå€¼è´Ÿæ•°çš„è¡¥ç ï¼Œè€Œå¯¹äºè´Ÿæ•°ï¼Œå…¶è¡¥ç è¿›è¡ŒæŒ‰ä½å–åå†$+1$åˆ™å¾—åˆ°å¯¹åº”çœŸå€¼æ­£æ•°çš„è¡¥ç ï¼Œå˜ä¸ºåŸç ã€‚é‚£ä¹ˆçŸ¥é“è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥ç‰¹åˆ¤æ˜¯å¦ä¸ºè´Ÿæ•° ==ï¼ˆè¿™é‡Œé€šè¿‡å³ç§»$31$ä½ï¼Œè‹¥ä¸ºæ­£æ•°ï¼Œåˆ™å¾—åˆ°çš„æ˜¯$0$ï¼Œè‹¥ä¸ºè´Ÿæ•°ï¼Œåˆ™å¾—åˆ°çš„æ˜¯$-1$ï¼Œè€Œ$0$çš„è¡¥ç ä¸º$0000$,$-1$çš„è¡¥ç ä¸º$1111$ï¼Œæ ¹æ®å¼‚æˆ–æ€§è´¨å³å¯åˆ¤æ–­æ„Ÿè°¢è¯»è€… ï¼ˆæ¢ã€‚ï¼‰æŒ‡å‡ºé”™è¯¯ï¼Œè¿™é‡Œåº”è¯¥æ˜¯è¦è¿›è¡ŒæŒ‰ä½å–åæ“ä½œï¼Œè¿™æ ·å¦‚æœä¸ºè´Ÿæ•°åˆ¤æ–­ç»“æœæ‰ä¸º0 ã€‚ï¼‰== ï¼Œåˆ©ç”¨æ¡ä»¶è¡¨è¾¾å¼å°±å¯ä»¥æ ¹æ®åˆ¤æ–­ç»“æœæ±‚ç»å¯¹å€¼äº†ã€‚å¦‚ä¸‹ï¼š int abs(int a){ return ~(a \u003e\u003e 31) ? a : ~a + 1; } ä½è¿ç®—å®ç°å¯¹$p$å–ä½™ï¼ˆpä¸º$2^k$ï¼‰ int mod(int a,int p){ return a \u0026 (p - 1); } å–ä½™å®é™…ä¸Šå°±æ˜¯èˆå»å¤§äºç­‰äº$p$çš„ä½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¿ç•™åœ¨$p$èŒƒå›´å†…çš„æ•°ã€‚ç”±äºæˆ‘ä»¬é™å®šäº†$p$ä¸º$2^k$ï¼Œæ‰€ä»¥$(p - 1)$ä¸€å®šæ˜¯å°†å°äº$p$çš„æœ€é«˜ä½å…¨éƒ¨å˜ä¸ºäº†$1$ï¼Œè¿™æ ·å†è¿›è¡Œä¸æ“ä½œå³å¯å¾—åˆ°ä½™æ•°ã€‚ ä½è¿ç®—ç»Ÿè®¡äºŒè¿›åˆ¶æ•°$1$çš„ä¸ªæ•° int count(int x){ int cnt = 0; while(x){ x = x \u0026 (x - 1); cnt ++; } return cnt; } å¯¹äºä»»æ„çš„$x$ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶åï¼Œæ˜¯å½¢å¦‚è¿™æ ·çš„æ•°å­—ï¼š$aaâ€¦aa10â€¦00$ï¼Œä»å³å‘å·¦æ•°æœ‰ä»»æ„å¤šä¸ª$0$ï¼Œç›´åˆ°é‡è§ç¬¬ä¸€ä¸ª$1$ï¼Œå­—æ¯$a$ç”¨æ¥å ä½ï¼Œä»£è¡¨$1$å·¦è¾¹çš„ä»»æ„æ•°å­—ã€‚$x-1$è½¬æ¢æˆäºŒè¿›åˆ¶åï¼Œæ˜¯å½¢å¦‚è¿™æ ·çš„æ•°å­—ï¼š$aaâ€¦aa01â€¦11$ï¼Œä»å³å‘å·¦æ•°ï¼ŒåŸæ¥çš„ä»»æ„å¤šä¸ª$0$éƒ½å˜æˆ$1$ï¼ŒåŸæ¥çš„ç¬¬ä¸€ä¸ª$1$ï¼Œå˜æˆ$0$ï¼Œå­—æ¯$a$éƒ¨åˆ†ä¸å˜ã€‚å¯¹$x$ å’Œ $x-1$ è¿›è¡Œ æŒ‰ä½ä¸ è®¡ç®—ï¼Œä¼šå¾—åˆ°ï¼š$aaâ€¦aa00â€¦00$ï¼Œä»å³å‘å·¦æ•°ï¼ŒåŸæ¥çš„ç¬¬ä¸€ä¸ª$1$å˜æˆäº†$0$ï¼Œå­—æ¯aéƒ¨åˆ†ä¸å˜ã€‚æ‰€ä»¥ $x \u0026 (x-1)$ç›¸å½“äºæ¶ˆé™¤äº† $x$ ä»å³å‘å·¦æ•°é‡åˆ°çš„ç¬¬ä¸€ä¸ª$1$ã€‚é‚£ä¹ˆï¼Œ$x$è½¬æ¢æˆäºŒè¿›åˆ¶ååŒ…å«å¤šå°‘ä¸ª$1$ï¼Œcountå‡½æ•°é‡Œçš„å¾ªç¯å°±ä¼šè¿›è¡Œå¤šå°‘æ¬¡ï¼Œç›´åˆ°$x$æ‰€æœ‰çš„$1$éƒ½è¢«â€œæ¶ˆé™¤â€ã€‚ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:5:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6 ä½è¿ç®—ä¾‹é¢˜ ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:6:0","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6.1 æ›´æ–°äºŒè¿›åˆ¶ä½ é¢˜é¢ ç»™å‡ºä¸¤ä¸ª32ä½çš„æ•´æ•°Nå’ŒMï¼Œä»¥åŠä¸¤ä¸ªäºŒè¿›åˆ¶ä½çš„ä½ç½®iå’Œjã€‚å†™ä¸€ä¸ªæ–¹æ³•æ¥ä½¿å¾—Nä¸­çš„ç¬¬iåˆ°jä½ç­‰äºMï¼ˆMä¼šæ˜¯Nä¸­ä»ç¬¬iä¸ºå¼€å§‹åˆ°ç¬¬jä½çš„å­ä¸²ï¼‰ æ ·ä¾‹ï¼š è¾“å…¥: N=(10000000000)2 M=(10101)2 i=2 j=6 è¾“å‡º: N=(10001010100)2 è¾“å…¥: N=(10000000000)2 M=(11111)2 i=2 j=6 è¾“å‡º: N=(10001111100)2 è§£é¢˜æ€è·¯ ç»“åˆæ‰€å­¦ï¼Œæˆ‘ä»¬çš„æ€è·¯åº”è¯¥å°±æ˜¯å…ˆå°†ç¬¬$i$ä½åˆ°ç¬¬$j$ä½å…¨éƒ¨å˜ä¸º$0$ï¼Œå†å°†ä¸å·¦ç§»$i$ä½çš„$M$è¿›è¡Œæˆ–æ“ä½œã€‚ ACä»£ç  class Solution { public: int updateBits(int n, int m, int i, int j) { // å¾ªç¯éå†ä»ç¬¬ i ä½åˆ°ç¬¬ j ä½ for(int pos = i; pos \u003c= j; pos ++ ){ // å°† n çš„ç¬¬ pos ä½è®¾ä¸º 0 // ~(1 \u003c\u003c pos) åˆ›å»ºä¸€ä¸ªåœ¨ç¬¬ pos ä½ä¸º 0 å…¶ä»–ä½ä¸º 1 çš„æ©ç  // ç„¶åä½¿ç”¨æŒ‰ä½ä¸è¿ç®—ç¬¦ï¼ˆ\u0026ï¼‰æ¥å°† n çš„ç¬¬ pos ä½è®¾ç½®ä¸º 0 n \u0026= ~(1 \u003c\u003c pos); } // å°† m å·¦ç§» i ä½ï¼Œä½¿ m çš„ä½ä½å¯¹é½åˆ° n çš„ç¬¬ i ä½ // ç„¶åä½¿ç”¨æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼ˆ|ï¼‰åˆå¹¶ n å’Œ m // è¿™æ · n çš„ç¬¬ i åˆ°ç¬¬ j ä½å°±è¢« m çš„ç›¸åº”ä½æ‰€æ›¿æ¢ return n | (m \u003c\u003c i); } }; ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:6:1","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6.2 A+Bé—®é¢˜ é¢˜é¢ ç»™å‡ºä¸¤ä¸ªæ•´æ•° a å’Œ b , æ±‚ä»–ä»¬çš„å’Œå¹¶ä»¥æ•´æ•°ï¼ˆintï¼‰çš„å½¢å¼è¿”å›ã€‚ä¸èƒ½ä½¿ç”¨ + ç­‰æ•°å­¦è¿ç®—ç¬¦ã€‚ æ ·ä¾‹ï¼š è¾“å…¥ï¼š a = 1 b = 2 è¾“å‡ºï¼š 3 è¾“å…¥ï¼š a = -1 b = 1 è¾“å‡ºï¼š 0 è§£é¢˜æ€è·¯ è¿™é¢˜æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¼‚æˆ–æ“ä½œæ¥å®ç°ï¼Œå› ä¸ºå¼‚æˆ–æ“ä½œæœ‰ä¸€ä¸ªåˆ«åå«ä¸è¿›ä½åŠ æ³•ã€‚é‚£ä¹ˆè¿›ä½æ“ä½œæˆ‘ä»¬å®é™…ä¸Šå°±å¯ä»¥é€šè¿‡$a\u0026b$æ¥å®ç°ï¼Œå› ä¸º$a\u0026b$å¾—åˆ°çš„éƒ½æ˜¯$a$å’Œ$b$ä¸Šéƒ½æœ‰çš„$1$ï¼Œæˆ‘ä»¬å†å·¦ç§»å³å¾—åˆ°çš„æ˜¯è¿›ä½ä¹‹åçš„ç»“æœï¼Œæ‰€ä»¥$a+b=(a\\wedge b)+(a\u0026bÂ«1)$ã€‚é€šè¿‡è¿™æ ·æ¨¡æ‹Ÿç«–å¼åŠ æ³•æ“ä½œå³å¯ã€‚ ACä»£ç  class Solution { public: int aplusb(int a, int b) { // å½“æ²¡æœ‰è¿›ä½éœ€è¦å¤„ç†æ—¶å¾ªç¯ç»“æŸ while(b != 0){ // temp_a å­˜å‚¨ a å’Œ b çš„æŒ‰ä½å¼‚æˆ–ç»“æœï¼Œè¿™ç›¸å½“äºä¸å¸¦è¿›ä½çš„åŠ æ³• int temp_a = a ^ b; // temp_b å­˜å‚¨ a å’Œ b çš„æŒ‰ä½ä¸ç»“æœå¹¶å·¦ç§»ä¸€ä½ï¼Œè¿™ç›¸å½“äºè®¡ç®—è¿›ä½ // å› ä¸ºåªæœ‰ä¸¤ä¸ªä½éƒ½æ˜¯1æ—¶æ‰ä¼šäº§ç”Ÿè¿›ä½ int temp_b = (a \u0026 b) \u003c\u003c 1; // æ›´æ–° a ä¸ºä¸å¸¦è¿›ä½çš„åŠ æ³•ç»“æœ a = temp_a; // æ›´æ–° b ä¸ºè¿›ä½ b = temp_b; } // å½“æ²¡æœ‰è¿›ä½æ—¶ï¼Œa ä¸­å­˜å‚¨äº†æœ€ç»ˆç»“æœï¼Œè¿”å› a return a; } }; ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:6:2","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6.3 O(1)æ—¶é—´æ£€æµ‹2çš„å¹‚æ¬¡ é¢˜é¢ ç”¨ O(1) æ—¶é—´æ£€æµ‹æ•´æ•° n æ˜¯å¦æ˜¯ 2 çš„å¹‚æ¬¡ã€‚ æ ·ä¾‹ n=4ï¼Œè¿”å› true; n=5ï¼Œè¿”å› false. æŒ‘æˆ˜ O(1) æ—¶é—´å¤æ‚åº¦ è§£é¢˜æ€è·¯ é¦–å…ˆæˆ‘ä»¬çŸ¥é“$2^k$æ˜¯å¤§äº$0$çš„ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç‰¹åˆ¤ï¼ŒåŒç†ï¼Œ$2^k$çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­åªæœ‰$1$ä¸ª$1$ï¼Œæ•…æˆ‘ä»¬å¯ä»¥åˆ©ç”¨$x\u0026(x-1)$æ¥æ¶ˆé™¤å”¯ä¸€çš„$1$åˆ¤æ–­æ˜¯å¦ç­‰äº$0$å³å¯ã€‚ ACä»£ç  class Solution { public: bool checkPowerOf2(int n) { // æ£€æŸ¥ n æ˜¯å¦å¤§äº 0 // 2 çš„å¹‚å¿…é¡»æ˜¯æ­£æ•°ï¼Œå› ä¸º 0 å’Œè´Ÿæ•°éƒ½ä¸æ˜¯ 2 çš„å¹‚ // æ£€æŸ¥ n å’Œ n - 1 çš„æŒ‰ä½ä¸æ“ä½œæ˜¯å¦ä¸º 0 // å¦‚æœ n æ˜¯ 2 çš„å¹‚ï¼Œåˆ™å…¶äºŒè¿›åˆ¶è¡¨ç¤ºä¸­åªæœ‰ä¸€ä¸ª 1 // ä¾‹å¦‚ 2 (10), 4 (100), 8 (1000) // å½“ n æ˜¯ 2 çš„å¹‚æ—¶ï¼Œn - 1 çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯ n çš„æœ€é«˜ä½ 1 å˜ä¸º 0ï¼Œ // å…¶ä½™ä½ä» 0 å˜ä¸º 1ï¼Œä¾‹å¦‚ 2 (10) - 1 = 1 (01), 4 (100) - 1 = 3 (011) // å› æ­¤ n \u0026 (n - 1) å°†å¾—åˆ° 0 return n \u003e 0 \u0026\u0026 (n \u0026 (n - 1)) == 0; } }; ","date":"2021-05-28","objectID":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/:6:3","tags":["ä½è¿ç®—"],"title":"ä½è¿ç®—å…¨é¢æ€»ç»“","uri":"/posts/01.%E4%BD%8D%E8%BF%90%E7%AE%97%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"ä¸ä¼šæ•°ä½$DP$çš„è¿™é‡ŒæŒ‡è·¯ä¸€ç¯‡ä»‹ç»éå¸¸è¯¦ç»†çš„æ•°ä½$DP$çš„$blog$:ç‚¹è¿™é‡Œã€‚ é“¾æ¥ æ¨7ä¸æˆå¦» é¢˜é¢ å•èº«! ä¾ç„¶å•èº«ï¼ å‰å“¥ä¾ç„¶å•èº«ï¼ DSçº§ç å†œå‰å“¥ä¾ç„¶å•èº«ï¼ æ‰€ä»¥ï¼Œä»–ç”Ÿå¹³æœ€æ¨æƒ…äººèŠ‚ï¼Œä¸ç®¡æ˜¯214è¿˜æ˜¯77ï¼Œä»–éƒ½è®¨åŒï¼ å‰å“¥è§‚å¯Ÿäº†214å’Œ77è¿™ä¸¤ä¸ªæ•°ï¼Œå‘ç°ï¼š $2+1+4=7$ã€€$7+7=72$ $77=711$ æœ€ç»ˆï¼Œä»–å‘ç°åŸæ¥è¿™ä¸€åˆ‡å½’æ ¹åˆ°åº•éƒ½æ˜¯å› ä¸ºå’Œ7æœ‰å…³ï¼æ‰€ä»¥ï¼Œä»–ç°åœ¨ç”šè‡³è®¨åŒä¸€åˆ‡å’Œ7æœ‰å…³çš„æ•°ï¼ä»€ä¹ˆæ ·çš„æ•°å’Œ7æœ‰å…³å‘¢ï¼Ÿå¦‚æœä¸€ä¸ªæ•´æ•°ç¬¦åˆä¸‹é¢3ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´è¿™ä¸ªæ•´æ•°å’Œ7æœ‰å…³â€”â€” 1ã€æ•´æ•°ä¸­æŸä¸€ä½æ˜¯7ï¼› 2ã€æ•´æ•°çš„æ¯ä¸€ä½åŠ èµ·æ¥çš„å’Œæ˜¯7çš„æ•´æ•°å€ï¼› 3ã€è¿™ä¸ªæ•´æ•°æ˜¯7çš„æ•´æ•°å€ï¼› ç°åœ¨é—®é¢˜æ¥äº†ï¼šå‰å“¥æƒ³çŸ¥é“åœ¨ä¸€å®šåŒºé—´å†…å’Œ7æ— å…³çš„æ•°å­—çš„å¹³æ–¹å’Œã€‚ Input è¾“å…¥æ•°æ®çš„ç¬¬ä¸€è¡Œæ˜¯caseæ•°T(1 \u003c= T \u003c= 50)ï¼Œç„¶åæ¥ä¸‹æ¥çš„Tè¡Œè¡¨ç¤ºTä¸ªcase;æ¯ä¸ªcaseåœ¨ä¸€è¡Œå†…åŒ…å«ä¸¤ä¸ªæ­£æ•´æ•°L, R(1 \u003c= L \u003c= R \u003c= 10^18)ã€‚ Output è¯·è®¡ç®—[L,R]ä¸­å’Œ7æ— å…³çš„æ•°å­—çš„å¹³æ–¹å’Œï¼Œå¹¶å°†ç»“æœå¯¹10^9 + 7 æ±‚æ¨¡åè¾“å‡ºã€‚ Sample Input 3 1 9 10 11 17 17 Sample Output 236 221 0 è§£é¢˜æ€è·¯ æ ¹æ®é¢˜æ„æˆ‘ä»¬åšå‡ºé¢„å¤„ç†ï¼Œåˆ©ç”¨é—«å¼$DP$åˆ†ææ³•åˆ†æå¦‚ä¸‹ï¼š ä»¥ä¸Šåªæ˜¯ç®€å•åˆ†æï¼Œæˆ‘ä»¬è¿˜å¹¶æ²¡æœ‰çœŸæ­£çš„è¿›è¡ŒçŠ¶æ€è½¬ç§»å’Œè®¡ç®—ï¼Œé‚£ä¹ˆæ ¹æ®é¢˜æ„ï¼Œé¦–å…ˆæ˜¯éœ€è¦çŸ¥é“æ•´æ•°çš„æ¯ä¸€ä½åŠ èµ·æ¥çš„å’Œæ˜¯$7$çš„æ•´æ•°å€ä»¥åŠè¯¥æ•´æ•°æ˜¯$7$çš„æ•´æ•°å€ï¼Œè¿™ä¸ªå¥½å¤„ç†ï¼Œåœ¨æˆ‘ä»¬çš„å‰é¢çš„é¢˜ä¸­æœ‰ç±»ä¼¼çš„é¢˜å‹ï¼Œè¿™å·²ç»åœ¨æˆ‘ä»¬çš„$f$æ•°ç»„çš„ç¬¬ä¸‰ç»´å’Œç¬¬å››ç»´äº†ã€‚æ‰€ä»¥éš¾ç‚¹å°±åœ¨äºæ€ä¹ˆå¤„ç†æ•´æ•°çš„å¹³æ–¹å’Œã€‚æˆ‘ä»¬çœ‹ä¸‹é¢çš„å…¬å¼æ¨å¯¼ï¼š æˆ‘ä»¬ç”¨$jA$æ¥è¡¨ç¤º$i$ä½æ•°ï¼Œè€Œå…¶ä¸­çš„$A$ä¸º$i-1$ä½æ•°ã€‚è®¾è¿™ä¸ªçŠ¶æ€æœ‰$t$ä¸ªç¬¦åˆè¦æ±‚çš„æ•°ï¼Œåˆ†åˆ«æ˜¯$A_1$~$A_t$ã€‚ é‚£ä¹ˆï¼Œå¹³æ–¹å’Œæ˜“å¾—ä¸ºï¼š $(jA_1)^2+(jA_2)^2+(jA_3)^2+â€¦+(jA_{t-1})^2+(jA_t)^2$ ï¼ˆæˆ‘ä»¬åˆ†å‰²è¡¨ç¤ºå°†$A$æå–å‡ºæ¥ã€‚ï¼‰ $=(j10^{i-1}+A_1)^2+(j10^{i-1}+A_2)^2+(j10^{i-1}+A_3)^2+â€¦+(j10^{i-1}+A_{t-1})^2+(j*10^{i-1}+A_t)^2$ ï¼ˆå¹³æ–¹å’Œå…¬å¼ï¼‰ $=t*(j10^{i-1})^2+2(j10^{i-1})(A_1+â€¦+A_t)+(A_1^2+â€¦+A^2)$ è¿™æ ·ï¼Œåœ¨è¿™ä¸ªå¼å­ä¸­ï¼Œç”±äº$j$å·²çŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘ç°$f$æ•°ç»„éœ€è¦ä¿å­˜ä¸‰ä¸ªå€¼ã€‚$A$çš„$0$æ¬¡æ–¹ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯ç¬¦åˆè¦æ±‚çš„æ•°ï¼Œ$A$çš„$1$æ¬¡æ–¹ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯ç¬¦åˆè¦æ±‚çš„é™¤å»$j$çš„$i-1$ä½æ•°ç›¸åŠ ï¼Œ$A$çš„$2$æ¬¡æ–¹ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯ç¬¦åˆè¦æ±‚çš„é™¤å»$j$çš„$i-1$ä½æ•°å¹³æ–¹ç›¸åŠ ã€‚æˆ‘ä»¬åˆ†åˆ«ç”¨$s_0,s_1,s_2$ åˆ†åˆ«ä»£è¡¨ä¸Šè¿°çš„ä¸‰ä¸ªå€¼ã€‚ é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬éœ€è¦æ€ä¹ˆæ±‚$s_1$ï¼Œå¦‚ä¸‹ï¼š æ³¨ï¼šè¿™é‡Œçš„$s_1$ä¸º$i+1$ä½çš„$s_1$ï¼Œè€Œå®ƒå­˜å‚¨çš„å°±æ˜¯$i$ä½çš„$A$ã€‚ $jA_1+â€¦+jA_t$ $=j*10^{i-1}+(A_1+â€¦+A_t)$ æ‰€ä»¥æˆ‘ä»¬çš„$f$åº”è¯¥æ˜¯ä¸€ä¸ªç»“æ„ä½“æ•°ç»„ï¼Œå®ƒéœ€è¦å­˜å–$s_0,s_1,s_2$ã€‚é‚£ä¹ˆé¢„å¤„ç†æ ¹æ®ä¸Šè¿°åˆ†æå…¶å®å°±ç®€å•äº†ã€‚é‚£ä¹ˆå°±æŒ‰ç…§æ•°ä½$DP$çš„å¥—è·¯è§£å†³è¿™é“é¢˜å³å¯ã€‚éœ€è¦æ³¨æ„è¿™é“é¢˜å¥½å¤šå‘ç‚¹ï¼Œå¤šå–æ¨¡ï¼Œè¶³å¤Ÿç»†å¿ƒæ‰å¯ä»¥è§£å†³ã€‚ï¼ˆè°ƒ$Bug$è°ƒäº†å¥½ä¹…ã€‚å¿«ç»æœ›äº†ã€‚ï¼‰ ä»£ç  /** *@filename:æ¨7ä¸æˆå¦» *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-12 21:19 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int N = 20; const ll P = 1e9+7; //éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ€§è´¨ã€‚ //1.ä¸å«7. //2.å„ä½æ•°å­—ä¹‹å’Œæ¨¡7ä¸ä¸º0.an-1+...+a0%7!=0. //3.è¯¥æ•°æ¨¡7ä¸ä¸º0.an-1*pow(10,n-1)+...+a0+pow(10,0)%7!=0 struct F{ ll s0,s1,s2;//s0ä¸ºç¬¦åˆè¦æ±‚çš„æ•°ã€‚s1ä¸ºç¬¦åˆè¦æ±‚çš„æ•°1æ¬¡æ–¹ä¹‹å’Œï¼Œs2ä¸ºç¬¦åˆè¦æ±‚çš„æ•°çš„2æ¬¡æ–¹ä¹‹å’Œã€‚ }f[N][10][7][7];//f[i][j][k][u]è¡¨ç¤ºæ€»å…±æœ‰iä½æ•°ä¸”æœ€é«˜ä½æ˜¯jï¼Œè¯¥æ•°å€¼æ¨¡7ä¸ºkï¼Œå„ä½æ•°æ•°å­—ä¹‹å’Œæ¨¡7ä¸ºuçš„æ‰€æœ‰æ•°çš„s0,s1,s2. //è¿›è¡Œåˆå§‹åŒ–ã€‚ int t;//æµ‹è¯•æ•°ã€‚ ll l,r; ll power7[N],power9[N];//power7[i]å­˜å‚¨10^iä½™7çš„ä½™æ•°ï¼Œpower9[i]å­˜å‚¨10^iä½™Pçš„ä½™æ•°ã€‚ ll mod(ll x,ll y){ return (x%y+y)%y; } void init(){ //ç¡®å®šåˆå§‹å€¼ï¼Œä½æ•°ä¸º1çš„æƒ…å†µã€‚ for(int j=0;j\u003c10;j++){ if(j==7)continue; //æ ¹æ®æ€§è´¨æ’é™¤ä¸ç¬¦åˆè¦æ±‚çš„ã€‚ F \u0026v=f[1][j][j%7][j%7];//è¿™é‡Œç”¨å¼•ç”¨å‡å°‘ä»£ç é‡ã€‚ v.s0++; v.s1+=j; v.s2+=j*j; } ll power = 10;//è¾…åŠ©ä½œç”¨ï¼Œè¡¨ç¤º10çš„i-1æ¬¡æ–¹ã€‚ for(int i=2;i\u003cN;i++,power*=10){ for(int j=0;j\u003c10;j++){ if(j==7)continue;//æ’é™¤ä¸ç¬¦åˆè¦æ±‚çš„æ•°ã€‚ for(int k=0;k\u003c7;k++){ for(int u=0;u\u003c7;u++){ for(int q=0;q\u003c10;q++){ //æšä¸¾i-1çš„æœ€é«˜ä½ã€‚ if(q==7)continue; F \u0026x=f[i][j][k][u],y=f[i-1][q][mod(k-j*(power%7),7)][mod(u-j,7)]; //s0,s1,s2éƒ½æ˜¯é€šè¿‡å…¬å¼å°±ç®—å¾—åˆ°ã€‚ x.s0=mod(x.s0+y.s0,P); x.s1=mod(x.s1+1LL*j%P*(power%P)%P*y.s0%P+y.s1,P); x.s2=mod(x.s2+ 1LL*j%P*y.s0%P*(power%P)%P*j%P*(power%P)%P+ 1LL*y.s1%P*2%P*j%P*(power%P)%P+y.s2,P); } } } } } //è¿™é‡Œå¤„ç†ä¸ºäº†æ–¹ä¾¿ä»¥åŠé™ä½æ—¶é—´å¤æ‚åº¦ã€‚ power7[0]=1,power9[0]=1; for(int i=1;i\u003cN;i++){ power7[i]=power7[i-1]*10%7; power9[i]=power9[i-1]*10%P; } } F get(int i,int j,int k,int u){ //å› ä¸ºf[i][j][k][u]æ˜¯æœ¬èº«æ¨¡7ç­‰äºkï¼Œä¸”å„ä½æ•°ä¹‹å’Œæ¨¡7ç­‰äºuçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„é›†åˆã€‚ ll s0=0,s1=0,s2=0; for(int x=0;x\u003c7;x++){ for(int y=0;y\u003c7;y++){ if(x==k||y==u)continue; F v=f[i][j][x][y]; s0=mod(s0+v.s0,P); s1=mod(s1+v.s1,P); s2=mod(s2+v.s2,P); } } return {s0,s1,s2}; } ll dp(ll n){ if(!n)return 0;//0çš„å¹³æ–¹å’Œä¸º0. vector\u003cint\u003e a; ll temp=n%P;//å¤‡ä»½ä¸€ä¸ªnï¼Œä¾›åé¢åˆ¤æ–­nä½¿ç”¨ã€‚ while(n)a.push_back(n%10),n/=10; ll last_a=0,last_b=0;//è¿™é‡Œæˆ‘ä»¬éœ€è¦å­˜å‚¨å‰ç¼€çš„æœ¬èº«å€¼å’Œå‰ç¼€çš„ä¸ªä½æ•°ä¹‹å’Œã€‚ ll ans=0;//ç­”æ¡ˆã€‚ for(int i=a.size()-1;i\u003e=0;i--){ int x=a[i]; for(int j=0;j\u003cx;j++){ //èµ°å·¦åˆ†æ”¯ã€‚ if(j==7)continue; //æˆ‘ä»¬éœ€è¦å°†ç¬¦åˆæ¡ä»¶çš„æ•°ç­›å‡ºæ¥ï¼Œè¿™é‡Œè¦ç”¨åˆ°ä¸€ä¸ªgetå‡½æ•°ã€‚ //æ±‚å¾—æœ¬èº«æ¨¡7ä¸ç­‰äºaï¼Œå¹¶ä¸”å„ä½æ•°ä¹‹å’Œæ¨¡7ä¸ç­‰bçš„é›†åˆï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨é¢„å¤„ç†å‡ºæ¥çš„ç»“æ„ä½“ int k=mod(-last_a*power7[i+1],7),u=mod(-last_b,7); F v=get(i+1,j,k,u); //cout\u003c\u003cv.s0\u003c\u003c\" \"\u003c\u003cv.s1\u003c\u003c\" \"\u003c\u003cv.s2\u003c\u003cendl; //æ ¹æ®å…¬å¼æ±‚è§£s2. //jå°±æ˜¯last_a. ans=mod(ans+ 1LL*(last_a%P)*(last_a%P)%P*(power9[i+1]%P)%P*(power9[i+1]%P)%P*v.s0%P+ 1LL*2*last_a%P*(power9[i+1]%P)%P*v.s1%P+ v.s2,P); //cout\u003c\u003cans\u003c\u003cendl; } //åˆ¤æ–­xã€‚ if(x==7)break; //èµ°å³åˆ†æ”¯æ›´æ–°ã€‚ last_a=last_a*10+x; last_b+=x; //åˆ¤æ–­è‡ªå·±æœ¬èº«æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚ if(!i\u0026\u0026last_a%7\u0026\u0026last_b%7){ ans=mod(ans+temp*temp%P,P); } } return ans; } int main(){ init(); cin\u003e\u003et; while(t--){ cin\u003e\u003el\u003e\u003er; cout\u003c\u003cmod(dp(r)-dp(l-1),P)\u003c\u003cendl; } return 0; } /* 1 1 1000000000000000000 */ ","date":"2021-05-13","objectID":"/posts/03.hdu-4507-%E6%81%A87%E4%B8%8D%E6%88%90%E5%A6%BB-%E6%95%B0%E4%BD%8Ddp%E5%A5%97%E8%B7%AF%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/:0:0","tags":["æ•°ä½DP"],"title":"HDU 4507 æ¨7ä¸æˆå¦» ï¼ˆæ•°ä½DPå¥—è·¯é¢˜ï¼‰","uri":"/posts/03.hdu-4507-%E6%81%A87%E4%B8%8D%E6%88%90%E5%A6%BB-%E6%95%B0%E4%BD%8Ddp%E5%A5%97%E8%B7%AF%E9%A2%98%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 æ•°ä½DPä»‹ç» æ•°ä½DPå¾€å¾€éƒ½æ˜¯è¿™æ ·çš„é¢˜å‹ï¼Œç»™å®šä¸€ä¸ªé—­åŒºé—´$[l,r]$ï¼Œè®©ä½ æ±‚è¿™ä¸ªåŒºé—´ä¸­æ»¡è¶³æŸç§æ¡ä»¶çš„æ•°çš„æ€»æ•°ã€‚è€Œè¿™ä¸ªåŒºé—´å¯èƒ½å¾ˆå¤§ï¼Œç®€å•çš„æš´åŠ›ä»£ç å¦‚ä¸‹ï¼š int ans=0; for(int i=l;i\u003c=r;i++){ if(check(i))ans++; } æˆ‘ä»¬å‘ç°ï¼Œè‹¥åŒºé—´é•¿åº¦è¶…è¿‡$1e8$ï¼Œæˆ‘ä»¬æš´åŠ›æšä¸¾å°±ä¼šè¶…æ—¶äº†ï¼Œè€Œæ•°ä½$DP$åˆ™å¯ä»¥è§£å†³è¿™æ ·çš„é¢˜å‹ã€‚æ•°ä½$DP$å®é™…ä¸Šå°±æ˜¯åœ¨æ•°ä½ä¸Šè¿›è¡Œ$DP$ã€‚ ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:1:0","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 æ•°ä½DPè§£æ³• æ•°ä½$DP$å°±æ˜¯æ¢ä¸€ç§æš´åŠ›æšä¸¾çš„æ–¹å¼ï¼Œä½¿å¾—æ–°çš„æšä¸¾æ–¹å¼ç¬¦åˆ$DP$çš„æ€§è´¨ï¼Œç„¶åé¢„å¤„ç†å¥½å³å¯ã€‚æˆ‘ä»¬æ¥çœ‹ï¼šæˆ‘ä»¬å¯ä»¥ç”¨$f(n)$è¡¨ç¤º$[0,n]$çš„æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆå¯¹äº$[l,r]$æˆ‘ä»¬å°±å¯ä»¥ç”¨$[l,r]\\iff f(r)-f(l-1)$ï¼Œç›¸å½“äºå‰ç¼€å’Œæ€æƒ³ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦æ±‚å‡º$f(n)$å³å¯ã€‚é‚£ä¹ˆæ•°ä½$DP$å…³é”®çš„æ€æƒ³å°±æ˜¯ä»æ ‘çš„è§’åº¦æ¥è€ƒè™‘ã€‚å°†æ•°æ‹†åˆ†æˆä½ï¼Œä»é«˜ä½åˆ°ä½ä½å¼€å§‹æšä¸¾ã€‚æˆ‘ä»¬å¯ä»¥è§†$N$ä¸º$n$ä½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‹†åˆ†$N:a_{n}ã€a_{n-1}â€¦a_1$ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åˆ†è§£å»ºæ ‘ï¼Œå¦‚ä¸‹ã€‚ä¹‹åæˆ‘ä»¬å°±å¯ä»¥é¢„å¤„ç†å†æ±‚è§£$f(n)$äº†ï¼Œä¸ªäººè®¤ä¸ºæ±‚è§£$f(n)$æ˜¯æœ€éš¾çš„ä¸€æ­¥ã€‚ å¬å®Œæ˜¯ä¸æ˜¯æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬å¯ä»¥æ¥ç‚¹é¢˜ç›®ç»ƒä¹ ä¸€ä¸‹ï¼Œåšå®Œå°±ä¼šå‘ç°äº†æ•°ä½$DP$çš„å¥—è·¯äº†ã€‚ ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:2:0","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 æ•°ä½DPç»å…¸ä¾‹é¢˜ ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:0","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.1 3.1 åº¦çš„æ•°é‡ é¢˜é¢ æ±‚ç»™å®šåŒºé—´$ [X,Y]$ ä¸­æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„æ•´æ•°ä¸ªæ•°ï¼šè¿™ä¸ªæ•°æ°å¥½ç­‰äº $K$ ä¸ªäº’ä¸ç›¸ç­‰çš„ $B$ çš„æ•´æ•°æ¬¡å¹‚ä¹‹å’Œã€‚ä¾‹å¦‚ï¼Œè®¾ $X=15,Y=20,K=2,B=2$ï¼Œåˆ™æœ‰ä¸”ä»…æœ‰ä¸‹åˆ—ä¸‰ä¸ªæ•°æ»¡è¶³é¢˜æ„ï¼š $17=2^4+2^0$ $18=2^4+2^1$ $20=2^4+2^2$ è¾“å…¥æ ¼å¼ ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° X å’Œ Yï¼Œæ¥ä¸‹æ¥ä¸¤è¡ŒåŒ…å«æ•´æ•° $K$ å’Œ $B$ã€‚ è¾“å‡ºæ ¼å¼ åªåŒ…å«ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ»¡è¶³æ¡ä»¶çš„æ•°çš„ä¸ªæ•°ã€‚ æ•°æ®èŒƒå›´ $1â‰¤Xâ‰¤Yâ‰¤2^{31}âˆ’1,$ $1â‰¤Kâ‰¤20,$ $2â‰¤Bâ‰¤10$ è¾“å…¥æ ·ä¾‹ï¼š 15 20 2 2 è¾“å‡ºæ ·ä¾‹ï¼š 3 è§£é¢˜æ€è·¯ æ­¤é¢˜å®é™…ä¸Šå°±æ˜¯å°†åè¿›åˆ¶æ•°è½¬åŒ–ä¸º$B$è¿›åˆ¶æ•°ï¼Œåˆ¤æ–­ä½æ•°ä¸Šçš„å€¼æ˜¯å¦ä¸º$1$ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è§†$N$ä¸º$n$ä½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‹†åˆ†$N:a_{n}ã€a_{n-1}â€¦a_1$ã€‚ä»æ ‘çš„è§’åº¦è€ƒè™‘ï¼šæˆ‘ä»¬è®¾$N=76543210,B=10$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»é«˜ä½å¾€æœ€ä½ä½å¼€å§‹æšä¸¾å¦‚ä¸‹ï¼›æšä¸¾$a_n$æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼š èµ°å³è¾¹åˆ†æ”¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¡«$7(a_n)$ï¼Œè€Œé¢˜ç›®è¦æ±‚æ¯ä¸€ä½åªèƒ½å¡«$1$æˆ–è€…$0$,è€Œ$a_n\u003e1$ï¼Œæ‰€ä»¥ä¸æ˜¯åˆæ³•æ–¹æ¡ˆï¼Œæˆ‘ä»¬ç›´æ¥å‰”é™¤ã€‚ èµ°å·¦è¾¹åˆ†æ”¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¡«$0$~$6$ï¼Œå³$0-{a_n}-1$ï¼Œé‚£ä¹ˆç”±äºæ¯ä¸€ä½åªèƒ½å¡«$1$æˆ–è€…$0$ï¼Œæ‰€ä»¥æˆ‘ä»¬ç´¯åŠ è¿™ä¸¤ç§é€‰æ‹©çš„æ–¹æ¡ˆã€‚ è®°ä½ï¼Œèµ°åˆ°äº†å·¦è¾¹åˆ†æ”¯æ˜¯å¯ä»¥ç›´æ¥ç´¯åŠ çš„ã€‚ æ‰€ä»¥æˆ‘ä»¬å®é™…ä¸Šè¿˜æ˜¯è¦åšä¸€ä¸ªé¢„å¤„ç†çš„ï¼Œæˆ‘ä»¬ç”¨$f[i][j]$è¡¨ç¤ºè¿˜å‰©ä¸‹$i$ä½æ²¡æœ‰å¡«ï¼Œä¸”éœ€è¦å¡«å†™$j$ä¸ª$1$çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆåœ¨$(i,j)$è¿™ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¡«$1$ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„çŠ¶æ€å°±æ˜¯$f[i-1][j-1]$ï¼Œè€Œå¦‚æœå¡«$0$ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„çŠ¶æ€å°±æ˜¯$f[i-1][j]$ï¼Œé‚£ä¹ˆçŠ¶æ€è½¬ç§»æ–¹ç¨‹å°±æ˜¯$f[i][j]=f[i-1][j]+f[i][j-1]$ã€‚è€Œåˆå§‹çŠ¶æ€å³æ˜¯å½“$j=0$æ—¶ï¼Œ$f[i][0]=1$ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é¢„å¤„ç†$f$æ•°ç»„äº†ã€‚ å¤„ç†å®Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ¨¡æ‹Ÿåšäº†ã€‚ ä»£ç  /** *@filename:åº¦çš„æ•°é‡ *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-12 11:23 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int maxn = 100000 + 5; const int mod = 1e9+7; int l,r,k,b; int f[35][35]; //é¦–å…ˆæˆ‘ä»¬å…ˆé¢„å¤„ç†fæ•°ç»„ã€‚å…¶ä¸­f[i][j]è¡¨ç¤ºå‰©ä¸‹è¿˜æœ‰iä¸ªæ²¡å¡«ï¼Œéœ€è¦å¡«å†™jä¸ª1çš„æ–¹æ¡ˆæ•°ã€‚ void init(){ for(int i=0;i\u003c35;i++){ for(int j=0;j\u003c=i;j++){ if(!j)f[i][j]=1; else{ f[i][j]=f[i-1][j]+f[i-1][j-1]; } } } } int dp(int n){ //æ±‚è§£f(n)ã€‚æˆ‘ä»¬éœ€è¦é¿å…nä¸º0çš„æƒ…å†µï¼Œè¿™é‡Œéœ€è¦ç‰¹åˆ¤ã€‚ if(!n)return 0; vector\u003cint\u003e nums;//å°†nåˆ†å‰²ï¼Œå­˜å‚¨ä½æ•°ã€‚ while(n){ nums.push_back(n%b); n/=b; } int ans=0;//ç­”æ¡ˆã€‚ int last=0;//å‰é¢çš„ä¿¡æ¯ï¼Œè¿™é‡Œä»£è¡¨çš„æ˜¯å‰é¢åˆ†æ”¯é€‰å–äº†å¤šå°‘ä¸ª1. for(int i=nums.size()-1;i\u003e=0;i--){ int x=nums[i]; if(x){ //è¯´æ˜x\u003e0ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å·¦è¾¹åˆ†æ”¯å¡«0. ans+=f[i][k-last]; if(x\u003e1){ //å½“x\u003e1æˆ‘ä»¬æ‰å¯ä»¥æšä¸¾å·¦è¾¹åˆ†æ”¯å¡«1. if(k-last-1\u003e=0){ //å¦‚æœè¿˜å¯ä»¥å¡«1çš„è¯ã€‚ ans+=f[i][k-last-1]; } break;//å› ä¸ºå³è¾¹åˆ†æ”¯åªèƒ½ä¸º0æˆ–1ï¼Œæ‰€ä»¥ä¸ç¬¦åˆæ¡ä»¶ã€‚breakã€‚ } else{ //å½“x=1å°±å¯ä»¥è¿›å…¥å³è¾¹çš„åˆ†æ”¯ç»§ç»­è®¨è®ºã€‚ last++; if(last\u003ek)break; } } //è€ƒè™‘åˆ°æœ€åä¸€ä½ï¼Œå¦‚æœç¬¦åˆæ¡ä»¶é‚£ä¹ˆæœ«ä½å¡«0ä¹Ÿç®—ä¸€ç§æ–¹æ¡ˆã€‚ if(!i\u0026\u0026last==k)ans++; } return ans; } void solve(){ } int main(){ cin\u003e\u003el\u003e\u003er\u003e\u003ek\u003e\u003eb; init(); cout\u003c\u003cdp(r)-dp(l-1)\u003c\u003cendl; solve(); return 0; } ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:1","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.2 3.2 è®¡æ•°é—®é¢˜ é¢˜é¢ ç»™å®šä¸¤ä¸ªæ•´æ•° a å’Œ bï¼Œæ±‚ a å’Œ b ä¹‹é—´çš„æ‰€æœ‰æ•°å­—ä¸­ 0âˆ¼90âˆ¼9 çš„å‡ºç°æ¬¡æ•°ã€‚ ä¾‹å¦‚ï¼Œ$a=1024ï¼Œb=1032$ï¼Œåˆ™ a å’Œ b ä¹‹é—´å…±æœ‰ 99 ä¸ªæ•°å¦‚ä¸‹ï¼š 1024 1025 1026 1027 1028 1029 1030 1031 1032 å…¶ä¸­ 0 å‡ºç° 10æ¬¡ï¼Œ1 å‡ºç° 10 æ¬¡ï¼Œ2 å‡ºç° 7 æ¬¡ï¼Œ3 å‡ºç° 3 æ¬¡ç­‰ç­‰â€¦ è¾“å…¥æ ¼å¼ è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚ æ¯ç»„æµ‹è¯•æ•°æ®å ä¸€è¡Œï¼ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° a å’Œ bã€‚ å½“è¯»å…¥ä¸€è¡Œä¸º 0 0 æ—¶ï¼Œè¡¨ç¤ºè¾“å…¥ç»ˆæ­¢ï¼Œä¸”è¯¥è¡Œä¸ä½œå¤„ç†ã€‚ è¾“å‡ºæ ¼å¼ æ¯ç»„æ•°æ®è¾“å‡ºä¸€ä¸ªç»“æœï¼Œæ¯ä¸ªç»“æœå ä¸€è¡Œã€‚ æ¯ä¸ªç»“æœåŒ…å«åä¸ªç”¨ç©ºæ ¼éš”å¼€çš„æ•°å­—ï¼Œç¬¬ä¸€ä¸ªæ•°å­—è¡¨ç¤º 0 å‡ºç°çš„æ¬¡æ•°ï¼Œç¬¬äºŒä¸ªæ•°å­—è¡¨ç¤º 1 å‡ºç°çš„æ¬¡æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚ æ•°æ®èŒƒå›´ $0\u003ca,b\u003c1000000000\u003ca,b\u003c100000000$ è¾“å…¥æ ·ä¾‹ï¼š 1 10 44 497 346 542 1199 1748 1496 1403 1004 503 1714 190 1317 854 1976 494 1001 1960 0 0 è¾“å‡ºæ ·ä¾‹ï¼š 1 2 1 1 1 1 1 1 1 1 85 185 185 185 190 96 96 96 95 93 40 40 40 93 136 82 40 40 40 40 115 666 215 215 214 205 205 154 105 106 16 113 19 20 114 20 20 19 19 16 107 105 100 101 101 197 200 200 200 200 413 1133 503 503 503 502 502 417 402 412 196 512 186 104 87 93 97 97 142 196 398 1375 398 398 405 499 499 495 488 471 294 1256 296 296 296 296 287 286 286 247 è§£é¢˜æ€è·¯ æˆ‘ä»¬éœ€è¦é¢„å¤„ç†$f$æ•°ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨$f[i,j,u]$è¡¨ç¤º$i$ä½ï¼Œæœ€é«˜ä½ä¸º$j$çš„æ•°æ‹¥æœ‰$u$çš„ä¸ªæ•°ã€‚é‚£ä¹ˆå¦‚æœ$j$ä¸ç­‰äº$u$æ—¶ï¼Œåˆ™$f[i][j][u]+=f[i-1][k][u],0\\leq k \\leq 9$ã€‚è¿™ä¸ªåº”è¯¥ä¸éš¾ç†è§£ï¼Œå› ä¸ºè¿™ä¸ªçŠ¶æ€å°±æ˜¯ç”±ä¹‹å‰çš„çŠ¶æ€å¾—åˆ°çš„ã€‚ è€Œå½“$j$ç­‰äº$u$æ—¶ï¼Œé‚£ä¹ˆåŒæ ·ä¹Ÿå¯ä»¥ç”±ä¹‹å‰çš„$9$ä¸ªçŠ¶æ€å¾—åˆ°ã€‚ä¸º$f[i][j][u]+=f[i-1][k][u],0\\leq k \\leq 9$ã€‚è®°ä½ï¼Œæˆ‘ä»¬æ˜¯è¿˜æ²¡æœ‰è®¡ç®—æœ€é«˜ä½çš„$u$ä¸ªæ•°çš„ï¼Œå› ä¸ºæœ€é«˜ä½æœ¬èº«å°±ä¸º$u$ï¼Œä¹Ÿæ˜¯ä¸€ç§å¯èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸Šã€‚é‚£ä¹ˆæ€»å…±æœ‰$10^{i-1}$å¤šçš„æ•°ï¼Œæ‰€ä»¥å¢åŠ çš„uçš„æ•°é‡ä¸º$10^{i-1}$ã€‚åˆå§‹çŠ¶æ€å°±æ˜¯$f[1][i][i]=1$ï¼Œåˆ°è¿™ï¼Œæˆ‘ä»¬çš„$f$æ•°ç»„å°±åˆå§‹åŒ–å®Œäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ã€‚å°±æ˜¯æ‹†ä½åˆ†æ”¯çš„æ•°ä½$DP$å¥—è·¯è®¨è®ºäº†ï¼Œè¿™é‡Œä¸åœ¨å™è¿°ï¼Œä»£ç é™„è¯¦ç»†æ³¨é‡Šã€‚ ä»£ç  /** *@filename:è®¡æ•°é—®é¢˜ *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-12 13:12 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int maxn = 100000 + 5; const int mod = 1e9+7; int l,r; int f[11][10][10];//é¢„å¤„ç†fæ•°ç»„ã€‚å…¶ä¸­f[i][j][u]è¡¨ç¤ºiä½æœ€é«˜ä½ä¸ºjçš„æ•°æ‹¥æœ‰uçš„ä¸ªæ•°ã€‚ void init(){ for(int i=0;i\u003c10;i++)f[1][i][i]=1; for(int i=2;i\u003c11;i++){ for(int j=0;j\u003c10;j++){ for(int u=0;u\u003c10;u++){ //åˆ¤æ–­jæ˜¯å¦ç­‰äºuã€‚ if(j==u)f[i][j][u]+=pow(10,i-1); for(int k=0;k\u003c10;k++){ f[i][j][u]+=f[i-1][k][u]; } } } } } ll dp(int n,int u){ //1~n,æ±‚xçš„å‡ºç°æ¬¡æ•°ã€‚ if(!n)return u?0:1;//ç‰¹åˆ¤næ˜¯å¦ä¸º0.æ ¹æ®uçš„å€¼ç¡®å®šè¿”å›å€¼ã€‚ vector\u003cint\u003e nums;//å­˜å‚¨åˆ†å‰²åçš„ä½æ•°ã€‚ while(n)nums.push_back(n%10),n/=10; int last=0;//lastè®°å½•å‰é¢uå‡ºç°çš„æ¬¡æ•°ã€‚ ll ans=0;//ç­”æ¡ˆã€‚ for(int i=nums.size()-1;i\u003e=0;i--){ int x=nums[i]; //å·¦è¾¹åˆ†æ”¯ï¼Œ0~xã€‚ for(int j=(i==nums.size()-1);j\u003cx;j++){ //ç”±äºæ­¤é¢˜ä¸èƒ½æœ‰å‰å¯¼0. ans+=f[i+1][j][u];//æ³¨æ„è¿™é‡Œiéœ€è¦+1ï¼Œå› ä¸ºæˆ‘ä»¬iä¸‹æ ‡ä»0å¼€å§‹ã€‚è€Œä½æ•°ä»1å¼€å§‹ã€‚ } //èµ°å·¦è¾¹åˆ†æ”¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åŠ ä¸Šå‰é¢çš„ä¸ªæ•°ã€‚æ³¨æ„è¿™é‡Œéœ€è¦ä¹˜ä¸Šxï¼Œå› ä¸ºå·¦è¾¹åˆ†æ”¯æœ‰xä¸­é€‰æ‹©ã€‚ ans+=x*last*pow(10,i); if(x==u)last++;//è®°å½•lastã€‚ if(!i)ans+=last;//åŠ ä¸Šè¿™ä¸ªæ•°æœ¬èº«å«æœ‰çš„ã€‚ } //ç”±äºæˆ‘ä»¬å‰é¢éƒ½æ˜¯æšä¸¾nä½æ•°çš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»Ÿè®¡æ‰€æœ‰0~n-1ä½æ•°çš„æ–¹æ¡ˆæ•°é‡ã€‚ //ä¾‹å¦‚000011æ˜¯ä¸åˆæ³•çš„ï¼Œä½†11æ˜¯åˆæ³•çš„ã€‚ //è¿™ä¸€æ­¥ç¡®å®å¾ˆå®¹æ˜“å¿½ç•¥ï¼Œæ²¡åŠæ³•ï¼Œæ•°ä½DPå°±æ˜¯è¿™ä¹ˆéš¾ã€‚ for(int i=1;i\u003cnums.size();i++){ for(int j=(i!=1);j\u003c=9;j++){ ans+=f[i][j][u]; } } return ans; } void solve(){ } int main(){ init(); while(cin\u003e\u003el\u003e\u003er\u0026\u0026(l||r)){ if(l\u003er)swap(l,r); for(int i=0;i\u003c=9;i++){ cout\u003c\u003cdp(r,i)-dp(l-1,i); i==9?cout\u003c\u003cendl:cout\u003c\u003c\" \"; } } solve(); return 0; } ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:2","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.3 3.3 æ•°å­—æ¸¸æˆ é¢˜é¢ ç§‘åé‡Œæœ€è¿‘å¾ˆæµè¡Œæ•°å­—æ¸¸æˆã€‚ æŸäººå‘½åäº†ä¸€ç§ä¸é™æ•°ï¼Œè¿™ç§æ•°å­—å¿…é¡»æ»¡è¶³ä»å·¦åˆ°å³å„ä½æ•°å­—å‘ˆéä¸‹é™å…³ç³»ï¼Œå¦‚ 123ï¼Œ446ã€‚ ç°åœ¨å¤§å®¶å†³å®šç©ä¸€ä¸ªæ¸¸æˆï¼ŒæŒ‡å®šä¸€ä¸ªæ•´æ•°é—­åŒºé—´ [a,b]ï¼Œé—®è¿™ä¸ªåŒºé—´å†…æœ‰å¤šå°‘ä¸ªä¸é™æ•°ã€‚ è¾“å…¥æ ¼å¼ è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚ æ¯ç»„æ•°æ®å ä¸€è¡Œï¼ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° a å’Œ bã€‚ è¾“å‡ºæ ¼å¼ æ¯è¡Œç»™å‡ºä¸€ç»„æµ‹è¯•æ•°æ®çš„ç­”æ¡ˆï¼Œå³ [a,b] ä¹‹é—´æœ‰å¤šå°‘ä¸é™æ•°ã€‚ æ•°æ®èŒƒå›´ $1â‰¤ a â‰¤ b â‰¤2^{31}âˆ’1$ æ ·ä¾‹è¾“å…¥ 1 9 1 19 æ ·ä¾‹è¾“å‡º 9 18 è§£é¢˜æ€è·¯ åŒæ ·çš„å¥—è·¯ï¼Œ å…ˆé¢„å¤„ç†$f$æ•°ç»„ï¼Œæˆ‘ä»¬ç”¨$f[i][j]$è¡¨ç¤º$i$ä½æ•°ï¼Œä¸”æœ€é«˜ä½ä¸º$j$çš„ä¸é™æ•°æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥åˆ—å†™ä¸€ä¸‹çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œå¯¹äº$f[i][j]$ï¼Œè¦æ»¡è¶³ä¸é™æ•°çš„è¦æ±‚ï¼Œåˆ™$f[i-1][k]$ï¼Œ$k$éœ€æ»¡è¶³$j \\leq k \\leq 9$ï¼Œé‚£ä¹ˆè‡ªç„¶$f[i][j]=\\sum_{k=j}^9 f[i-1][k]$ã€‚è€Œåˆå§‹çŠ¶æ€è‡ªç„¶æ˜¯$f[1][j]=1$ã€‚é¢„å¤„ç†å®Œä¹‹åï¼Œæˆ‘ä»¬å°±å¥½åšäº†ï¼Œç›´æ¥æŒ‰æ•°ä½$DP$çš„æ€æƒ³å¤„ç†å³å¯ã€‚ä»£ç é™„è¯¦ç»†æ³¨é‡Šã€‚ ä»£ç  /** *@filename:æ•°å­—æ¸¸æˆ *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-12 14:57 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int maxn = 100000 + 5; const int mod = 1e9+7; int l,r; int f[11][11];//é¢„å¤„ç†fæ•°ç»„ã€‚å…¶ä¸­f[i][j]è¡¨ç¤ºiä½æ•°ï¼Œä¸”æœ€é«˜ä½ä¸ºjçš„ä¸é™æ•°æ–¹æ¡ˆæ•°ã€‚ void init(){ for(int i=1;i\u003c10;i++)f[1][i]=1; for(int i=2;i\u003c11;i++){ for(int j=0;j\u003c10;j++){ for(int k=j;k\u003c10;k++){ f[i][j]+=f[i-1][k]; } } } } int dp(int n){ //1~nï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç‰¹åˆ¤n=0ã€‚ if(!n)return 0; vector\u003cint\u003e nums;//å­˜å‚¨åˆ†å‰²ä½æ•°ã€‚ while(n)nums.push_back(n%10),n/=10; int last=0;//lastå­˜å‚¨ä¸Šä¸€ä½çš„æœ€å¤§å€¼ã€‚ int ans=0;//ç­”æ¡ˆã€‚ for(int i=nums.size()-1;i\u003e=0;i--){ int x=nums[i]; //èµ°å·¦è¾¹çš„åˆ†æ”¯ã€‚å› ä¸ºè¦ä¿æŒä¸é™åºï¼Œæ‰€ä»¥æˆ‘ä»¬j\u003e=lastã€‚ for(int j=last;j\u003cx;j++){ ans+=f[i+1][j];//æ³¨æ„æ˜¯i+1ä½ã€‚ } if(last\u003ex)break;//è¯´æ˜ä¸Šä¸€ä½æ¯”xå¤§ï¼Œä¸èƒ½æ„æˆé™åºäº†ï¼Œç›´æ¥é€€å‡ºã€‚ last=x;//èµ°å³åˆ†æ”¯äº†ï¼Œæ›´æ–°lastã€‚ if(!i)ans++;//å…¨éƒ¨æšä¸¾å®Œäº†ï¼Œè‡ªèº«ä¹ŸåŒæ ·æ„æˆäº†ä¸€ç§æ–¹æ¡ˆã€‚ } return ans; } int main(){ init(); while(cin\u003e\u003el\u003e\u003er){ cout\u003c\u003cdp(r)-dp(l-1)\u003c\u003cendl; } return 0; } ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:3","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.4 3.4 windyæ•° é¢˜é¢ windy å®šä¹‰äº†ä¸€ç§ windy æ•°ã€‚ ä¸å«å‰å¯¼é›¶ä¸”ç›¸é‚»ä¸¤ä¸ªæ•°å­—ä¹‹å·®è‡³å°‘ä¸º 2 çš„æ­£æ•´æ•°è¢«ç§°ä¸º windy æ•°ã€‚windy æƒ³çŸ¥é“ï¼Œåœ¨ a å’Œ b ä¹‹é—´ï¼ŒåŒ…æ‹¬ a å’Œ b ï¼Œæ€»å…±æœ‰å¤šå°‘ä¸ª windy æ•°ï¼Ÿ è¾“å…¥æ ¼å¼ è¾“å…¥åªæœ‰ä¸€è¡Œä¸¤ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤º a å’Œ bã€‚ è¾“å‡ºæ ¼å¼ è¾“å‡ºä¸€è¡Œä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚ è¾“å…¥è¾“å‡ºæ ·ä¾‹ è¾“å…¥ #1 1 10 è¾“å‡º #1 9 è¾“å…¥ #2 25 50 è¾“å‡º #2 20 è¯´æ˜/æç¤º æ•°æ®è§„æ¨¡ä¸çº¦å®š å¯¹äºå…¨éƒ¨çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ $1 \\leq a \\leq b \\leq 2 \\times 10^9$ã€‚ è§£é¢˜æ€è·¯ åŒæ ·ï¼Œæˆ‘ä»¬å…ˆè¿›è¡Œé¢„å¤„ç†$f$æ•°ç»„ï¼Œå…¶ä¸­$f[i][j]$è¡¨ç¤º$i$ä½ï¼Œå…¶ä¸­æœ€é«˜ä½ä¸º$j$çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆæ ¹æ®é¢˜æ„ï¼ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹å³ä¸º$f[i][j]=\\sum_{}f[i-1][k]$ï¼Œå…¶ä¸­$0 \\leq k \\leq 9 \\space and \\space abs(k-j)\u003e=2$ã€‚è€Œåˆå§‹çŠ¶æ€å³ä¸º$dp[1][i]=1$ã€‚é¢„å¤„ç†å®Œä¹‹åå°±å¥½å¤„ç†äº†ï¼Œè¿™é‡Œä¸å†æä¾›æ€è·¯ï¼Œè¯·å¤§å®¶è‡ªå·±ç”»å‡ºæ ‘ç»“æ„å¹¶å®Œæˆæ­¤é¢˜ã€‚ ä»£ç  /** *@filename:windyæ•° *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-12 15:43 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int maxn = 100000 + 5; const int mod = 1e9+7; int l,r; int f[11][10];//fæ•°ç»„ã€‚å…¶ä¸­f[i][j]è¡¨ç¤ºiä½ï¼Œå…¶ä¸­æœ€é«˜ä½ä¸ºjçš„æ–¹æ¡ˆæ•°ã€‚ void init(){ for(int i=0;i\u003c10;i++)f[1][i]=1; for(int i=2;i\u003c11;i++){ for(int j=0;j\u003c10;j++){ for(int k=0;k\u003c10;k++){ if(abs(k-j)\u003e=2){ f[i][j]+=f[i-1][k]; } } } } } int dp(int n){ if(!n){ //ç‰¹åˆ¤nä¸º0çš„æƒ…å†µï¼Œé¿å…å¯¹ä¹‹åæ“ä½œé€ æˆå½±å“ã€‚ return 0; } vector\u003cint\u003e nums;//å­˜å‚¨åˆ†å‰²ä½æ•°ã€‚ int last=-2;//å­˜å‚¨ä¸Šä¸€ä½çš„å€¼ã€‚è¿™é‡Œåˆå€¼ä¸º-2,æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦ç¡®å®š1å¯ä»¥ã€‚ int ans=0;//ç­”æ¡ˆã€‚ while(n)nums.push_back(n%10),n/=10; for(int i=nums.size()-1;i\u003e=0;i--){ int x=nums[i]; //å·¦åˆ†æ”¯ã€‚ for(int j=(i==nums.size()-1);j\u003cx;j++){ if(abs(j-last)\u003e=2){ //è¯´æ˜ç¬¦åˆè¦æ±‚ã€‚ ans+=f[i+1][j]; } } if(abs(x-last)\u003c2)break;//ä¸æ»¡è¶³è¦å»ã€‚ last=x; if(!i)ans++;//æšä¸¾åˆ°æœ€åä¸€ä½ï¼Œè‡ªèº«ä¹Ÿå½¢æˆäº†ä¸€ç§æ–¹æ¡ˆã€‚ } //ç‰¹æ®Šæšä¸¾æœ‰å‰å¯¼0çš„æ•°ã€‚ for(int i=1;i\u003cnums.size();i++){ for(int j=1;j\u003c=9;j++){ ans+=f[i][j]; } } return ans; } void solve(){ } int main(){ init(); cin\u003e\u003el\u003e\u003er; cout\u003c\u003cdp(r)-dp(l-1)\u003c\u003cendl; solve(); return 0; } ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:4","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.5 3.5 æ•°å­—æ¸¸æˆâ…¡ é¢˜é¢ ç”±äºç§‘åé‡Œæœ€è¿‘çœŸçš„å¾ˆæµè¡Œæ•°å­—æ¸¸æˆã€‚ æŸäººåˆå‘½åäº†ä¸€ç§å–æ¨¡æ•°ï¼Œè¿™ç§æ•°å­—å¿…é¡»æ»¡è¶³å„ä½æ•°å­—ä¹‹å’Œ$modN$ä¸º 0ã€‚ ç°åœ¨å¤§å®¶åˆè¦ç©æ¸¸æˆäº†ï¼ŒæŒ‡å®šä¸€ä¸ªæ•´æ•°é—­åŒºé—´ [a.b]ï¼Œé—®è¿™ä¸ªåŒºé—´å†…æœ‰å¤šå°‘ä¸ªå–æ¨¡æ•°ã€‚ æ•°æ®èŒƒå›´ $1â‰¤a,bâ‰¤2^{31}âˆ’1$, $1â‰¤N\u003c100$ æ ·ä¾‹ è¾“å…¥ 1 19 9 è¾“å‡º 2 è§£é¢˜æ€è·¯ è™½ç„¶è¿™é“é¢˜çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†æ˜¯æœ¬è´¨è¿˜æ˜¯è¿˜æ˜¯æ•°ä½DPçš„å¥—è·¯ï¼Œåªä¸è¿‡ç°åœ¨æ€§è´¨æ˜¯æ»¡è¶³å„ä½æ•°å­—ä¹‹å’Œ$mod N$ä¸º0ã€‚é‚£ä¹ˆæ­¤é¢˜å®é™…ä¸Šå›°éš¾ç‚¹åœ¨äºé¢„å¤„ç†ï¼Œæˆ‘ä»¬å‘ç°é¢„å¤„ç†è¿™å…¶å®å°±æ˜¯ä¸€ä¸ª$dp$ï¼Œæˆ‘ä»¬ç”¨é—«å¼$DP$åˆ†ææ³•åˆ†æå¦‚ä¸‹ï¼š æˆ‘ä»¬å¾—åˆ°è¿™ä¸ª$f$æ•°ç»„æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœæˆ‘ç°åœ¨å·²çŸ¥å‰é¢çš„ä½æ•°ç›¸åŠ ä¸º$last$ï¼Œåœ¨å·¦åˆ†æ”¯å¤„ï¼Œç”±äºåé¢çš„æ•°å¯ä»¥éšä¾¿æšä¸¾ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªæ€§è´¨ç›´æ¥ç´¯åŠ $f[i+1][j][mod(-last,p)]$å³å¯å¾—åˆ°ç§ç±»æ•°ã€‚æ•…æ­¤æŒ‰ç…§æ•°ä½$DP$æ­¥éª¤æ˜“è§£ã€‚ ä»£ç  /** *@filename:æ•°å­—æ¸¸æˆâ…¡ *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-12 18:23 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int maxn = 100000 + 5; int l,r,p; int f[12][12][110];//f[i][j][k]è¡¨ç¤ºiä½æ•°ï¼Œæœ€é«˜ä½æ˜¯jï¼Œå…¶æ¨¡nçš„ä½™æ•°æ˜¯kçš„æ–¹æ¡ˆæ•°ã€‚ //é¢„å¤„ç†ä¹Ÿæ˜¯ä¸€ä¸ªdpè¿‡ç¨‹ã€‚ int mod(int x,int y){ //ç”±äºc++ä¸­çš„%è´Ÿæ•°ä¼šå¾—åˆ°è´Ÿæ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åšä¸€ä¸ªåç§»ã€‚ return (x%y+y)%y; } void init(){ memset(f,0,sizeof(f)); //é¢„å¤„ç†fæ•°ç»„ã€‚ for(int i=0;i\u003c10;i++)f[1][i][i%p]++; for(int i=2;i\u003c12;i++){ for(int j=0;j\u003c10;j++){ for(int k=0;k\u003cp;k++){ for(int x=0;x\u003c10;x++){ f[i][j][k]+=f[i-1][x][mod(k-j,p)]; } } } } } int dp(int n){ if(!n)return 1; vector\u003cint\u003e a;//å­˜å‚¨åˆ‡å‡ºæ¥çš„ä½æ•°ã€‚ while(n)a.push_back(n%10),n/=10; int last=0;//lastå­˜å‚¨å‰é¢æ•°å­—ä¹‹å’Œã€‚ int ans=0; for(int i=a.size()-1;i\u003e=0;i--){ int x=a[i]; for(int j=0;j\u003cx;j++){ //èµ°å·¦è¾¹åˆ†æ”¯ã€‚ä¸ºäº†å‡‘æˆæ¨¡nä½™0ï¼Œåˆ™æ¥ä¸‹æ¥çš„æ‰€æœ‰ä½æ•°ç›¸åŠ +lastæ¨¡nä¸º0ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸ª-lastå³å¯ã€‚ ans+=f[i+1][j][mod(-last,p)]; } last+=x; if(!i\u0026\u0026last%p==0)ans++;//åˆ¤æ–­æœ¬èº«æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚ } return ans; } void solve(){ } int main(){ while(cin\u003e\u003el\u003e\u003er\u003e\u003ep){ init(); cout\u003c\u003cdp(r)-dp(l-1)\u003c\u003cendl; } solve(); return 0; } ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:5","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.6 3.6 ä¸è¦62 é¢˜é¢ æ­å·äººç§°é‚£äº›å‚»ä¹ä¹ç²˜å—’å—’çš„äººä¸º62ï¼ˆéŸ³ï¼šlaoerï¼‰ã€‚ æ­å·äº¤é€šç®¡ç†å±€ç»å¸¸ä¼šæ‰©å……ä¸€äº›çš„å£«è½¦ç‰Œç…§ï¼Œæ–°è¿‘å‡ºæ¥ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼Œä»¥åä¸Šç‰Œç…§ï¼Œä¸å†å«æœ‰ä¸å‰åˆ©çš„æ•°å­—äº†ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥æ¶ˆé™¤ä¸ªåˆ«çš„å£«å¸æœºå’Œä¹˜å®¢çš„å¿ƒç†éšœç¢ï¼Œæ›´å®‰å…¨åœ°æœåŠ¡å¤§ä¼—ã€‚ ä¸å‰åˆ©çš„æ•°å­—ä¸ºæ‰€æœ‰å«æœ‰4æˆ–62çš„å·ç ã€‚ä¾‹å¦‚ï¼š 62315 73418 88914 éƒ½å±äºä¸å‰åˆ©å·ç ã€‚ä½†æ˜¯ï¼Œ61152è™½ç„¶å«æœ‰6å’Œ2ï¼Œä½†ä¸æ˜¯62è¿å·ï¼Œæ‰€ä»¥ä¸å±äºä¸å‰åˆ©æ•°å­—ä¹‹åˆ—ã€‚ ä½ çš„ä»»åŠ¡æ˜¯ï¼Œå¯¹äºæ¯æ¬¡ç»™å‡ºçš„ä¸€ä¸ªç‰Œç…§åŒºé—´å·ï¼Œæ¨æ–­å‡ºäº¤ç®¡å±€ä»Šæ¬¡åˆè¦å®é™…ä¸Šç»™å¤šå°‘è¾†æ–°çš„å£«è½¦ä¸Šç‰Œç…§äº†ã€‚ Input è¾“å…¥çš„éƒ½æ˜¯æ•´æ•°å¯¹nã€mï¼ˆ0\u003cnâ‰¤m\u003c1000000ï¼‰ï¼Œå¦‚æœé‡åˆ°éƒ½æ˜¯0çš„æ•´æ•°å¯¹ï¼Œåˆ™è¾“å…¥ç»“æŸã€‚ Output å¯¹äºæ¯ä¸ªæ•´æ•°å¯¹ï¼Œè¾“å‡ºä¸€ä¸ªä¸å«æœ‰ä¸å‰åˆ©æ•°å­—çš„ç»Ÿè®¡ä¸ªæ•°ï¼Œè¯¥æ•°å€¼å ä¸€è¡Œä½ç½®ã€‚ Sample Input 1 100 0 0 Sample Output 80 è§£é¢˜æ€è·¯ è¿™é“é¢˜ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºé¢„å¤„ç†è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°ã€‚ç”¨$f[i][j]$è¡¨ç¤º$i$ä½æ•°å­—ä¸”æœ€é«˜ä½ä¸º$j$çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬æ’é™¤æ‰ç‰¹æ®Šæƒ…å†µè¿›è¡ŒçŠ¶æ€è½¬ç§»å³å¯ã€‚ä»£ç é™„è¯¦ç»†æ³¨é‡Šã€‚ ä»£ç  /** *@filename:ä¸è¦62 *@author: pursuit *@csdn:unique_pursuit *@email: 2825841950@qq.com *@created: 2021-05-12 19:56 **/ #include \u003cbits/stdc++.h\u003e using namespace std; typedef long long ll; const int maxn = 100000 + 5; const int mod = 1e9+7; int l,r; int f[11][11];//f[i][j]è¡¨ç¤ºiä½æ•°ä¸”æœ€é«˜ä½ä¸ºjçš„æ–¹æ¡ˆæ•°ã€‚ //é‚£ä¹ˆæˆ‘ä»¬æ¥å¯¹è¿™ä¸ªè¿›è¡Œåˆ†æï¼Œå¯¹äºf[i][j]è¿™ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬æ ¹æ®é¢˜æ„æˆ‘ä»¬è½¬ç§»çš„f[i-1][k]å¿…é¡»æ»¡è¶³k!=4,j!=4. //å¹¶ä¸”jk!=62. void init(){ for(int i=0;i\u003c10;i++)f[1][i]=1; //æ’é™¤4çš„æƒ…å†µã€‚ f[1][4]=0; for(int i=2;i\u003c11;i++){ for(int j=0;j\u003c10;j++){ if(j==4)continue; for(int k=0;k\u003c10;k++){ if((j==6\u0026\u0026k==2)||k==4)continue; f[i][j]+=f[i-1][k]; } } } } int dp(int n){ if(!n)return 1; vector\u003cint\u003e a;//å­˜å‚¨åˆ†å‰²ä½æ•°ã€‚ int ans=0,last=0;//lastä¿å­˜ä¸Šä¸€ä½çš„å€¼ã€‚ while(n)a.push_back(n%10),n/=10; for(int i=a.size()-1;i\u003e=0;i--){ int x=a[i]; for(int j=0;j\u003cx;j++){ //èµ°å·¦è¾¹åˆ†æ”¯ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ã€‚ if(j==4||(j==2\u0026\u0026last==6))continue; ans+=f[i+1][j]; } if(x==4||(last==6\u0026\u0026x==2))break; last=x; if(!i)ans++; } return ans; } void solve(){ } int main(){ init(); while(cin\u003e\u003el\u003e\u003er\u0026\u0026(l||r)){ cout\u003c\u003cdp(r)-dp(l-1)\u003c\u003cendl; solve(); } return 0; } ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:6","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.7 3.7 æ¨7ä¸æˆå¦» ç”±äºæ­¤é¢˜å¤ªè¿‡å˜æ€ï¼Œå·²å•å¼€ä¸€ç¯‡blogè®²è§£ï¼š ç‚¹è¿™é‡Œã€‚ ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:3:7","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 æ•°ä½DPæ€»ç»“ åšäº†è¿™ä¹ˆå¤šçš„é¢˜ï¼Œæˆ‘ä»¬å‘ç°æ•°ä½$DP$ç¡®å®æ˜¯æœ‰å¥—è·¯çš„ï¼Œéš¾ç‚¹å°±åœ¨äºé¢„å¤„ç†ï¼Œé€šå¸¸å°±æ˜¯è¦ç”¨$DP$æ¥é¢„å¤„ç†ï¼Œè¿™é‡Œæ¨èå¤§å®¶å­¦ä¸€ä¸‹é—«å¼$DP$åˆ†ææ³•ã€‚é¢„å¤„ç†å®Œä¹‹åï¼Œå°±å¯ä»¥å¥—è·¯åšé¢˜äº†ã€‚å½“ç„¶ï¼Œå­¦$DP$ä¸€å®šè¦å¤šåˆ·é¢˜ï¼Œæ‰€ä»¥è¯·å„ä½ä¸€å®šè¦å¤šå¤šåˆ·é¢˜å“¦ï¼ ","date":"2021-05-12","objectID":"/posts/01.%E6%95%B0%E4%BD%8Ddp/:4:0","tags":["æ•°ä½DP"],"title":"æ•°ä½DPå­¦ä¹ æ•´ç†","uri":"/posts/01.%E6%95%B0%E4%BD%8Ddp/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 é—®é¢˜å¼•å…¥ æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜:ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªæ•°åˆ—$a$ï¼Œä½ éœ€è¦è¿›è¡Œä¸‹é¢ä¸¤ç§æ“ä½œï¼š å°†æŸä¸€ä¸ªæ•°åŠ ä¸Š $x$ æ±‚å‡ºæŸåŒºé—´$[l,r]$æ¯ä¸€ä¸ªæ•°çš„å’Œ æ•°åˆ—é•¿åº¦ä¸º$n( 1\\leq n \\leq 10^5)$ï¼Œæ“ä½œæ€»æ•°ä¸º$p(1\\leq p \\leq 10^5)$ï¼Œæ—¶é—´é™åˆ¶ä¸º$1s$ï¼Œå¦‚æœæ˜¯ä½ ä½ è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æš´åŠ›èƒ½å¦å‡ºå¥‡è¿¹ï¼Œå¯¹äºå•ç‚¹ä¿®æ”¹æ“ä½œï¼Œæˆ‘ä»¬ç¡®å®èƒ½åœ¨$O(1)$çš„æ—¶é—´å®Œæˆï¼Œè€Œå¯¹äºåŒºé—´æ±‚å’Œæ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬ç´¯åŠ æ±‚å’Œçš„æ—¶é—´å¤æ‚åº¦ä¸º$O(r-l+1)$ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œé«˜è¾¾$O(n)$ ï¼Œè¿™æ ·ç®—ä¸‹æ¥ï¼Œå¤„ç†è¿™ä¸ªé—®é¢˜éœ€è¦$O(np)$çš„æ—¶é—´å¤æ‚åº¦ï¼Œ$1s$æ˜¯å¤„ç†ä¸å®Œçš„ã€‚ é‚£ä¹ˆï¼ŒåŒºé—´æ±‚å’Œå‰ç¼€å’Œåˆæ˜¯å¦å¯ä»¥å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœç”¨å‰ç¼€å’Œå¤„ç†å®é™…ä¸Šå°±æ˜¯è®©åŒºé—´æ±‚å’Œå˜ä¸º$O(1)$ï¼Œè€Œè®©å•ç‚¹ä¿®æ”¹å°±å˜ä¸º$O(n)$äº†ï¼Œè¿™æ ·å¹¶æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚æ‰€ä»¥æš´åŠ›åšæ³•è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚ å­¦è¿‡çº¿æ®µæ ‘çš„åŒå­¦ä¸€å®šçŸ¥é“æ€ä¹ˆå†™è¿™é“é¢˜ï¼Œæ²¡å­¦è¿‡çš„å¯ä»¥å»å­¦ä¹ ä¸‹ï¼Œè¿™é‡ŒæŒ‡è·¯ä¸€ç¯‡$blog$:çº¿æ®µæ ‘å…¥é—¨ ä½†æ˜¯ï¼Œè¿™é“é¢˜ç”¨çº¿æ®µæ ‘æœªå…ä¹Ÿå¤ªå¤§æå°ç”¨äº†,å†µä¸”çº¿æ®µæ ‘çš„ä»£ç é‡ä¹Ÿååˆ†å¤šï¼Œæ‰€ä»¥æ ‘çŠ¶æ•°ç»„å°±å‡ºç°äº†ï¼Œä»£ç é‡å°‘ï¼Œç®€å•æ˜“å®ç°ã€‚æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ã€‚ ","date":"2021-04-27","objectID":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/:1:0","tags":["æ ‘çŠ¶æ•°ç»„"],"title":"æ ‘çŠ¶æ•°ç»„è¯¦è§£(ä¸€ç»´+äºŒç»´+å·®åˆ†+å‰ç¼€å’Œ+å…¬å¼ä¼˜åŒ–)","uri":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 æ ‘çŠ¶æ•°ç»„ï¼ˆå•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ï¼‰ æ ‘çŠ¶æ•°ç»„ç®€å•å‰–æ å…¶ä¸­$A$æ•°ç»„æ˜¯åŸæ•°ç»„ï¼Œè€Œ$C$æ•°ç»„å°±æ˜¯æ ‘çŠ¶æ•°ç»„ã€‚ä¸ºä»€ä¹ˆè¦ä¸€å¼€å§‹å°±æ”¾å›¾å‘¢ï¼Ÿæˆ‘ä»¬æ¥å‘ç°ä¸€ä¸‹å®ƒä»¬çš„è§„å¾‹ï¼š $C1 = A1$ $C2 = A1+A2$ $C3 = A3$ $C4 = A1+A2+A3+A4$ $C5 = A5$ $C6 = A5+A6$ $C7 = A7$ $C8 = A1+A2+A3+A4+A5+A6+A7+A8$ æˆ‘ä»¬ä¸éš¾å‘ç°ï¼š$C[i] = A[i - 2^k+1] + A[i - 2^k+2] + â€¦ + A[i];$ï¼Œ //$k$ä¸º$i$çš„äºŒè¿›åˆ¶ä¸­ä»æœ€ä½ä½åˆ°é«˜ä½è¿ç»­é›¶çš„é•¿åº¦ï¼Œæ¢å¥è¯è¯´ï¼Œ$C[i]$ç®¡è¾–äº†åŒ…æ‹¬$A[i]$è‡ªå·±çš„å‰$2^k$ä¸ªå…ƒç´  ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœå¯¹æŸä¸ªå…ƒç´ æ›´æ”¹äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ›´æ”¹ç®¡è¾–äº†è¿™ä¸ªå…ƒç´ çš„$C$ï¼Œé‚£ä¹ˆå¦‚æœå¯¹æŸä¸ªåŒºé—´$[l,r]$æ±‚å’Œï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›¸å½“äºæ±‚$SUM[r]-SUM[l-1]$ï¼Œè€Œæ±‚$SUM[i]$ä¹Ÿç‰¹åˆ«ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚$i$è¿™ä¸ªç‚¹ç®¡è¾–çš„åŒºé—´å’Œ$C[i]$å¹¶ç»Ÿè®¡ï¼Œå†å¾€å‰è·³åˆ°æœªè¢«$i$ç®¡è¾–çš„åŒºé—´ç´¯åŠ $C$å³å¯ï¼Œç›´åˆ°åˆ°è¾¾æ•°ç»„å¤´éƒ¨ã€‚ä¹Ÿå°±æ˜¯$SUM[i] = C[i] + C[i-2^{k_1 }]+ C[(i - 2^k_1) - 2^k_2] + â€¦..ï¼›$ã€‚ lowbitå‡½æ•°æ±‚è§£$2^k$ é‚£ä¹ˆå…³é”®çš„ä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬æ€ä¹ˆæ±‚$2^k$ï¼Œæˆ‘ä»¬çŸ¥é“$k$ä¸º$i$çš„äºŒè¿›åˆ¶ä¸­ä»æœ€ä½ä½åˆ°é«˜ä½è¿ç»­é›¶çš„é•¿åº¦ï¼Œæ‰€ä»¥$2^k=i\u0026(i-1)$ï¼Œè¿™é‡Œä¸äºˆè¯æ˜ã€‚æ±‚$2^k$ä¸€èˆ¬ç”¨ä¸€ä¸ªå‡½æ•°æ¥æè¿°ï¼Œå³$lowbit$ã€‚å¦‚ä¸‹ï¼š int lowbit(int x){ return x\u0026(-x); } addå‡½æ•°ï¼šå•ç‚¹ä¿®æ”¹ å¯¹äºå•ç‚¹ä¿®æ”¹ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¾ˆå¥½å¤„ç†ï¼Œåªéœ€è¦å°†ç®¡è¾–è¿™ä¸ªç‚¹çš„$C$å…¨éƒ¨åŠ ä¸Š$x$å³å¯ï¼Œå¦‚ä¸‹ï¼š void add(int pos,int x){ while(pos\u003c=n){ c[pos]+=x; pos+=lowbit(pos); } } getSumå‡½æ•°ï¼šåŒºé—´æ±‚å’Œ åŒºé—´æ±‚å’Œå°±æ˜¯ä¸Šæ–‡ä¸­åˆ©ç”¨çš„åŸç†ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½å®ç°ï¼Œæˆ‘ä»¬é¦–å…ˆè¦èƒ½æ±‚å‰$i$ä¸ªå…ƒç´ çš„å’Œï¼Œå¦‚ä¸‹ï¼š int getSum(int pos){ int ans=0; while(pos\u003e0){ ans+=c[pos]; pos-=lowbit(pos); } return ans; } â€‹ é‚£ä¹ˆï¼Œ$[l,r]$åŒºé—´çš„å’Œè‡ªç„¶æ˜“å¾—ï¼Œå³ä¸ºï¼šgetSum(r)-getSum(l-1)ã€‚ æ—¶é—´å¤æ‚åº¦åˆ†æ ä¸éš¾ï¼Œå‘ç°ï¼Œæ ‘çŠ¶æ•°ç»„å®é™…ä¸Šå°±æ˜¯ä¸€æ£µæ ‘ï¼Œå…¶æœ‰$n$ä¸ªç»“ç‚¹ï¼Œé‚£ä¹ˆæ˜“çŸ¥åœ¨å•ç‚¹ä¿®æ”¹å’ŒåŒºé—´æ±‚å’Œçš„é—®é¢˜å¤„ç†ä¸Šéƒ½èƒ½åœ¨$O(log_2n)$çš„æ—¶é—´å†…å®Œæˆã€‚æ‰€ä»¥æ€»ä½“æ—¶é—´å¤æ‚åº¦ä¸º$O(nlog_2n)$ï¼Œæ˜¯éå¸¸æœ‰æ•ˆçš„ã€‚ ","date":"2021-04-27","objectID":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/:2:0","tags":["æ ‘çŠ¶æ•°ç»„"],"title":"æ ‘çŠ¶æ•°ç»„è¯¦è§£(ä¸€ç»´+äºŒç»´+å·®åˆ†+å‰ç¼€å’Œ+å…¬å¼ä¼˜åŒ–)","uri":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 å·®åˆ†æ ‘çŠ¶æ•°ç»„ï¼ˆåŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢ï¼‰ åŸç† æˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“å·®åˆ†æ•°ç»„æ˜¯ä»€ä¹ˆï¼Œå’Œå‰ç¼€å’Œæ•°ç»„å…¶å®ç¦»ä¸å¼€å…³ç³»ï¼Œ$c[i]=SUM[i]-SUM[i-1]$ï¼Œå…¶ä¸­åŸæ•°ç»„ç›¸å½“äºå¯ä»¥çœ‹æˆæ˜¯å­˜å‚¨äº†ç›¸é‚»ä¸¤ä¸ªå‰ç¼€å’Œçš„å·®å€¼ï¼Œé‚£ä¹ˆæ˜ å°„åˆ°å·®åˆ†æ•°ç»„ï¼ˆå› ä¸ºåŸæ•°ç»„å¯ä»¥çœ‹æˆæ˜¯å­˜å‚¨äº†å·®åˆ†æ•°ç»„çš„å‰ç¼€å’Œï¼‰æˆ‘ä»¬å¯ä»¥çœ‹æˆå°±æ˜¯å­˜å‚¨äº†ç›¸é‚»ä¸¤ä¸ªæ•°ä¹‹é—´çš„å·®å€¼ï¼Œå³$d[i]=c[i]-c[i-1]$ï¼Œè€Œ$d[1]=c[1]-c[0]=c[1]$ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªå…³ç³»å¯ä»¥æ¨å¯¼å‡º:$a[i]=d[1]+d[2]+â€¦+d[i]$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ˜¯å°†å•ç‚¹æŸ¥è¯¢è½¬åŒ–ä¸ºåŒºé—´æ±‚å’Œäº†ï¼Œé‚£ä¹ˆå¦‚æœå¯¹äºåŒºé—´ä¿®æ”¹å‘¢ï¼Ÿå¯¹äºå·®åˆ†æ•°ç»„ï¼Œå‡è®¾ä¿®æ”¹åŒºé—´$[l,r]$ï¼Œè®©è¿™ä¸ªåŒºé—´æ¯ä¸ªå…ƒç´ $+x$ï¼Œæˆ‘ä»¬åªéœ€è¦æ›´æ”¹$d[l]=d[l]+x$ï¼Œ$d[r+1]=d[r+1]-x$ï¼Œè¿™æ ·æˆ‘ä»¬ä¿è¯åªä¼šå½±å“åˆ°$[l,r]$è¿™ä¸ªåŒºé—´çš„å…ƒç´ ã€‚æ•…æˆ‘ä»¬é€šè¿‡å·®åˆ†æŠŠè¿™ä¸ªåŒºé—´ä¿®æ”¹ã€å•ç‚¹æŸ¥è¯¢çš„é—®é¢˜è½¬åŒ–ä¸ºå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å­˜å‚¨çš„æ ‘çŠ¶æ•°ç»„å®é™…å’Œæ˜¯å“ªä¸ªå­˜å‚¨æ˜¯å·®åˆ†æ•°ç»„çš„æ ‘çŠ¶æ•°ç»„ã€‚ ","date":"2021-04-27","objectID":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/:3:0","tags":["æ ‘çŠ¶æ•°ç»„"],"title":"æ ‘çŠ¶æ•°ç»„è¯¦è§£(ä¸€ç»´+äºŒç»´+å·®åˆ†+å‰ç¼€å’Œ+å…¬å¼ä¼˜åŒ–)","uri":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 å·®åˆ†æ ‘çŠ¶æ•°ç»„+å…¬å¼ä¼˜åŒ–ï¼ˆåŒºé—´ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ï¼‰ åŸç† åˆšåˆšç»“æŸäº†åˆ©ç”¨å·®åˆ†å®ç°åŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢ï¼Œè€Œå¯¹äºåŒºé—´æŸ¥è¯¢ï¼Œè¿™ç¡®å®ä¹Ÿæ˜¯ä¸ªé—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬çŸ¥é“äº†åŒºé—´æŸ¥è¯¢ï¼Œå®é™…ä¸Šè¿™ç§ç±»å‹çš„é¢˜æˆ‘ä»¬å°±æ²¡å¿…è¦ä½¿ç”¨çº¿æ®µæ ‘å»å†™äº†ï¼Œç›´æ¥ç”¨æ ‘çŠ¶æ•°ç»„å°±å¯ä»¥è§£å†³ã€‚æˆ‘ä»¬æ¥çœ‹ï¼Œå®é™…ä¸Šè¿˜æ˜¯åˆ©ç”¨å·®åˆ†æ•°ç»„ï¼Œé‚£ä¹ˆå¦‚ä½•å°†åŒºé—´æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿå˜ä¸º$O(log_2n)$å‘¢ï¼ŒåŒºé—´æŸ¥è¯¢çš„åŸºç¡€æ˜¯å¿«é€Ÿæ±‚å‡ºæ•°ç»„$a[1:n]$çš„å‰ç¼€å’Œï¼Œè€Œæ˜¾ç„¶æ•°ç»„$a[1:n]$çš„å‰ç¼€å’Œä¸º $$a[1]+a[2]+â€¦+a[i]=d[1]i+d[2](i-1)+â€¦+d[i]1=d[1](i+1)+d[2](i+1)+â€¦+d[i](i+1)-(d[1]*1+d[2]*2+â€¦+d[i]i)\\ =(i+1)(d[1]+d[2]+â€¦+d[i])-(d[1]*1+d[2]*2+â€¦+d[i]*i)$$ ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥åœ¨åŸæ¥çš„æ•°ç»„$c[i]$è®°å½•$d[i]$çš„åŸºç¡€ä¸Šã€‚å†å¼€ä¸€ä¸ªæ•°ç»„è®°å½•$d[i]*i$å³å¯ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®ç°äº†åŒºé—´æŸ¥è¯¢ã€‚ ","date":"2021-04-27","objectID":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/:4:0","tags":["æ ‘çŠ¶æ•°ç»„"],"title":"æ ‘çŠ¶æ•°ç»„è¯¦è§£(ä¸€ç»´+äºŒç»´+å·®åˆ†+å‰ç¼€å’Œ+å…¬å¼ä¼˜åŒ–)","uri":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5 äºŒç»´æ ‘çŠ¶æ•°ç»„ï¼ˆå•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ï¼‰ è§£é‡Š æ•°ç»„$C[x]$è®°å½•äº†çš„æ˜¯å³ç«¯ç‚¹ä¸º$x$ã€é•¿åº¦ä¸º$lowbit(x)$çš„åŒºé—´çš„åŒºé—´å’Œã€‚é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥ç±»ä¼¼åœ°å®šä¹‰$C[x][y]$è®°å½•çš„æ˜¯å³ä¸‹è§’ä¸º$(x,y)$ï¼Œé«˜ä¸º $lowbit(x)$ï¼Œå®½ä¸º$lowbit(y) $çš„åŒºé—´çš„åŒºé—´å’Œã€‚é‚£ä¹ˆæŒ‰ç…§ä¸€ç»´æ ‘çŠ¶æ•°ç»„å»å¤„ç†å³å¯ï¼Œè¿™é‡Œç»™å‡ºè¿™ä¸‰ä¸ªå‡½æ•°ã€‚ $lowbit$å‡½æ•° int lowbit(int x){ return x\u0026(-x); } $add$å‡½æ•° void add(int x,int y,int value){ //åœ¨(x,y)å¤„å¢åŠ value. for(int i=x;i\u003c=n;i+=lowbit(i)){ for(int j=y;j\u003c=n;j+=lowbit(j)){ c[i][j]+=value; } } } $getSum$å‡½æ•° int getSum(int x,int y){ //å¦‚æœæ±‚è§£[x1,y1]~[x2,y2]ä¹‹é—´çš„å’Œï¼Œé‚£ä¹ˆå°±æ˜¯getSum(x2,y2)-getSum(x2,y1)-getSum(x1,y2)+getSum(x1,y1). int ans=0; for(int i=x;i\u003e0;i-=lowbit(i)){ for(int j=y;j\u003e0;j-=lowbit(j)){ ans+=c[i][j]; } } return ans=0; } ","date":"2021-04-27","objectID":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/:5:0","tags":["æ ‘çŠ¶æ•°ç»„"],"title":"æ ‘çŠ¶æ•°ç»„è¯¦è§£(ä¸€ç»´+äºŒç»´+å·®åˆ†+å‰ç¼€å’Œ+å…¬å¼ä¼˜åŒ–)","uri":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6 äºŒç»´å·®åˆ†æ ‘çŠ¶æ•°ç»„ï¼ˆåŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢ï¼‰ äºŒç»´å·®åˆ†æ ‘çŠ¶æ•°ç»„æ¨å¯¼ å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“äºŒç»´å·®åˆ†æ•°ç»„æ€ä¹ˆè¡¨ç¤ºï¼Œé‚£ä¹ˆè¿˜æ˜¯å’ŒäºŒç»´å‰ç¼€å’Œæ•°ç»„è”ç³»èµ·æ¥ï¼Œå³$c[i,j]=SUM[i,j]-SUM[i-1,j]-SUM[i,j-1]+SUM[i-1,j-1]$ï¼ŒåŸæ•°ç»„å®é™…ä¸Šå°±å¯ä»¥çœ‹åšæ˜¯å­˜å‚¨äº†$(i,j)$çš„å‰ç¼€å’Œä¸$(i-1,j)$å’Œ$(i,j-1)$çš„å‰ç¼€å’Œçš„å·®å€¼ã€‚ é‚£ä¹ˆæ˜ å°„åˆ°äºŒç»´å·®åˆ†æ•°ç»„å³æ˜¯$d[i,j]=c[i,j]-c[i-1,j]-c[i,j-1]+c[i-1,j-1]$ï¼Œå…¶ä¸­$d[1,1]=c[1,1]$ï¼Œé‚£ä¹ˆ$c[n][m]=\\sum_{i=1}^{n}\\sum_{j=1}^{m}d[i][j]$ï¼Œæ‰€ä»¥å¯¹äºåŒºé—´ä¿®æ”¹ï¼Œæˆ‘ä»¬æ˜¯ç»™$(x_1,y_1),(x_2,y_2)$ä¹‹é—´å½¢æˆçš„çŸ©é˜µåŠ ä¸Š$x$ï¼Œé‚£ä¹ˆå®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦å˜åŠ¨å››ä¸ªç‚¹ï¼Œ$d[x_1][x_2]+=x,d[x_1][y_2]-=x,d[x_2][y_1]-=x,d[x_2][y_2]+=x$ ï¼Œé‚£ä¹ˆè¿™æ ·å°±å’Œä¸€ç»´å·®åˆ†æ•°ç»„ä¸€æ ·äº†ï¼ŒåŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢é—®é¢˜æˆ‘ä»¬åˆ©ç”¨äºŒç»´å·®åˆ†æ•°ç»„å°±å¯ä»¥è½¬åŒ–ä¸ºå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢äº†ï¼Œæˆ‘ä»¬çš„æ ‘çŠ¶æ•°ç»„åˆ™æ˜¯å»ºç«‹äºŒç»´å·®åˆ†æ ‘çŠ¶æ•°ç»„ã€‚é‚£ä¹ˆè¿™æ ·è¿™ä¸‰ä¸ªå‡½æ•°åŒç†ä¹Ÿå¾ˆç®€å•çš„å°±å¯ä»¥å†™å‡ºæ¥äº†ã€‚ ","date":"2021-04-27","objectID":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/:6:0","tags":["æ ‘çŠ¶æ•°ç»„"],"title":"æ ‘çŠ¶æ•°ç»„è¯¦è§£(ä¸€ç»´+äºŒç»´+å·®åˆ†+å‰ç¼€å’Œ+å…¬å¼ä¼˜åŒ–)","uri":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"7 äºŒç»´å·®åˆ†æ ‘çŠ¶æ•°ç»„+å…¬å¼æ¨å¯¼ï¼ˆåŒºé—´ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ï¼‰ æ¨å¯¼ å’Œä¸€ç»´çš„ä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ±‚è§£$(x_1,y_1)$å’Œ$(x_2,y_2)$å½¢æˆçŸ©é˜µçš„å’Œï¼ŒåŒæ—¶åˆè¦å®ç°åŒºé—´ä¿®æ”¹ï¼Œé‚£ä¹ˆåœ¨åŸæœ‰çš„äºŒç»´å·®åˆ†æ ‘çŠ¶æ•°ç»„æ˜¯è¡Œä¸é€šçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å°†åŒºé—´æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿé™ä¸º$log_2n$ï¼Œæˆ‘ä»¬çŸ¥é“$SUM[i][j]=\\sum_{x=1}^i\\sum_{y=1}^ja[x][y]$ï¼Œè€Œ$a[x][y]=\\sum_{u=1}^x\\sum_{v=1}^yd[u][v]$ï¼Œåˆ™$SUM[i][j]=\\sum_{x=1}^i\\sum_{y=1}^j\\sum_{u=1}^x\\sum_{v=1}^yd[u][v]$ï¼Œç”±äºè¿™ä¸ªå…¬å¼éå¸¸å¤æ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸€ç»´å·®åˆ†æ ‘çŠ¶æ•°ç»„é‚£æ ·æ¥ç»Ÿè®¡$d[u][v]$å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œæˆ‘ä»¬å‘ç°ï¼Œä»$a[1][1]$åˆ°$a[i][j]$ï¼Œ$d[1][1]$éƒ½éœ€è¦å‡ºç°ä¸€æ¬¡ï¼Œåˆ™$d[1][1]$å‡ºç°äº†$i\\times j$æ¬¡ï¼Œé‚£ä¹ˆåŒç†$d[1][2]$å‡ºç°äº†$i*(j-1)$æ¬¡ï¼Œå…¶ä½™åŒç­‰è§„å¾‹ã€‚æ‰€ä»¥ $$SUM[i][j]=\\sum_{x=1}^i\\sum_{y=1}^jd[x][y](i+1-x)(j+1-y)$$ ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥å°†è¿™æ ·æ‹†åˆ†æˆå››ä¸ªéƒ¨åˆ†ï¼Œå³ $$SUM[i][j]=(i+1)(j+1)\\sum_{x=1}^i\\sum_{y=1}^jd[x][y]-(j+1)\\sum_{x=1}^i\\sum_{y=1}^jxd[x][y]-(i+1) \\sum_{x=1}^i\\sum_{y=1}^jyd[x][y]+\\sum_{x=1}^i\\sum_{y=1}^jxyd[x][y] $$ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨åŸæ¥$C1[i][j]$è®°å½•$d[i][j]$çš„åŸºç¡€ä¸Šï¼Œå†å¼€ä¸‰ä¸ªæ ‘çŠ¶æ•°ç»„è®°å½•$d[i][j]*i,d[i][j]*j,d[i][j]*ij$å³å¯ã€‚è¿™æ ·å°±å¯ä»¥é€šè¿‡æ•°ç»„$a[i][j]$çš„å·®åˆ†æ•°ç»„$d[i][j]$æ¥å¾—åˆ°$a[i][j]$çš„å‰ç¼€å’Œæ•°ç»„$SUM[i][j]$äº†ã€‚ ","date":"2021-04-27","objectID":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/:7:0","tags":["æ ‘çŠ¶æ•°ç»„"],"title":"æ ‘çŠ¶æ•°ç»„è¯¦è§£(ä¸€ç»´+äºŒç»´+å·®åˆ†+å‰ç¼€å’Œ+å…¬å¼ä¼˜åŒ–)","uri":"/posts/02.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E8%AF%A6%E8%A7%A3/"},{"categories":["é—®é¢˜è®°å½•"],"content":"ç”±äºåšä¸»æœ€è¿‘ç”±CBè½¬åˆ°Vscodeäº†ï¼Œå¯æ˜¯å‘ç°æˆ‘æœ€çˆ±ç”¨çš„ä¸‡èƒ½å¤´æ–‡ä»¶\u003cbits/stdc++.h\u003eä½¿ç”¨ä¸äº†ã€‚äºæ˜¯æˆ‘æ‰¾äº†å„ç§åŠæ³•ï¼Œç»ˆäºè§£å†³äº†ã€‚ä¸ºäº†å¸®åŠ©åˆ°åŒæ ·é‡åˆ°è¿™æ ·é—®é¢˜çš„ä½ ä»¬ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œåˆ—å‡ºè¯¦ç»†è§£å†³æ–¹æ³•ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è¦çŸ¥é“é—®é¢˜æ ¹æºæ‰€åœ¨ï¼Œä¸ºä»€ä¹ˆå¼•å…¥iostreamå¯ä»¥ï¼Œè€Œå¼•å…¥bits/stdc++.hä¸è¡Œï¼Œæˆ‘ä»¬ç‚¹å‡»é¼ æ ‡å³é”®å¯¹è¿™ä¸¤ä¸ªå¤´æ–‡ä»¶è½¬åˆ°å®šä¹‰ã€‚ å‘ç°å°è¯•ä¸‡èƒ½å¤´æ–‡ä»¶çš„æ—¶å€™æ˜¾ç¤ºæœªå®šä¹‰ï¼Œè€Œå°è¯•isotreamçš„æ—¶å€™è·³è½¬åˆ°ï¼š æˆ‘ä»¬å‘ç°ï¼Œè¿™å³æ˜¯iostreamå¤´æ–‡ä»¶çš„å®šä¹‰ï¼Œè¿™é‡Œç»™å‡ºäº†å®ƒçš„è·¯å¾„ã€‚æˆ‘ä»¬çœ‹çœ‹å®ƒåœ¨ä»€ä¹ˆæ–‡ä»¶ä¸‹ã€‚ å³é”®é€‰æ‹©åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ˜¾ç¤ºã€‚æˆ‘ä»¬çœ‹åˆ°å¦‚ä¸‹ï¼š è¿™äº›éƒ½æ˜¯å¥½å¤šå¤´æ–‡ä»¶çš„å®šä¹‰ï¼Œæˆ‘ä»¬vscodeå¼•å…¥å¤´æ–‡ä»¶éƒ½æ˜¯ä»è¿™é‡Œå¯»æ‰¾å¼•å…¥çš„ã€‚ é‚£ä¹ˆæˆ‘ä»¬è¯•æƒ³ï¼Œå¦‚æœæˆ‘ä»¬æŠŠbits/stdc++.hå¤´æ–‡ä»¶çš„å®šä¹‰ç»™å‡ºï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥å¼•å…¥äº†ï¼Ÿåœ¨å®˜ç½‘ï¼Œæœ‰bits/stdc++.hå¤´æ–‡ä»¶çš„å†…å®¹ï¼Œè¿™é‡Œè´´å‡ºå¦‚ä¸‹ï¼š // C++ includes used for precompiling -*- C++ -*- // Copyright (C) 2003-2014 Free Software Foundation, Inc. This file is part of the GNU ISO C++ Library. This library is free// software; you can redistribute it and/or modify it under the// terms of the GNU General Public License as published by the// Free Software Foundation; either version 3, or (at your option)// any later version. // This library is distributed in the hope that it will be useful,// but WITHOUT ANY WARRANTY; without even the implied warranty of// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the// GNU General Public License for more details. // Under Section 7 of GPL version 3, you are granted additional// permissions described in the GCC Runtime Library Exception, version// 3.1, as published by the Free Software Foundation. // You should have received a copy of the GNU General Public License and// a copy of the GCC Runtime Library Exception along with this program;// see the files COPYING3 and COPYING.RUNTIME respectively. If not, see// \u003chttp://www.gnu.org/licenses/\u003e. /** @file stdc++.h * This is an implementation file for a precompiled header. */ // 17.4.1.2 Headers // C #ifndef _GLIBCXX_NO_ASSERT #include \u003ccassert\u003e #endif #include \u003ccctype\u003e #include \u003ccerrno\u003e #include \u003ccfloat\u003e #include \u003cciso646\u003e #include \u003cclimits\u003e #include \u003cclocale\u003e #include \u003ccmath\u003e #include \u003ccsetjmp\u003e #include \u003ccsignal\u003e #include \u003ccstdarg\u003e #include \u003ccstddef\u003e #include \u003ccstdio\u003e #include \u003ccstdlib\u003e #include \u003ccstring\u003e #include \u003cctime\u003e #if __cplusplus \u003e= 201103L #include \u003cccomplex\u003e #include \u003ccfenv\u003e #include \u003ccinttypes\u003e #include \u003ccstdalign\u003e #include \u003ccstdbool\u003e #include \u003ccstdint\u003e #include \u003cctgmath\u003e #include \u003ccwchar\u003e #include \u003ccwctype\u003e #endif // C++ #include \u003calgorithm\u003e #include \u003cbitset\u003e #include \u003ccomplex\u003e #include \u003cdeque\u003e #include \u003cexception\u003e #include \u003cfstream\u003e #include \u003cfunctional\u003e #include \u003ciomanip\u003e #include \u003cios\u003e #include \u003ciosfwd\u003e #include \u003ciostream\u003e #include \u003cistream\u003e #include \u003citerator\u003e #include \u003climits\u003e #include \u003clist\u003e #include \u003clocale\u003e #include \u003cmap\u003e #include \u003cmemory\u003e #include \u003cnew\u003e #include \u003cnumeric\u003e #include \u003costream\u003e #include \u003cqueue\u003e #include \u003cset\u003e #include \u003csstream\u003e #include \u003cstack\u003e #include \u003cstdexcept\u003e #include \u003cstreambuf\u003e #include \u003cstring\u003e #include \u003ctypeinfo\u003e #include \u003cutility\u003e #include \u003cvalarray\u003e #include \u003cvector\u003e #if __cplusplus \u003e= 201103L #include \u003carray\u003e #include \u003catomic\u003e #include \u003cchrono\u003e #include \u003ccondition_variable\u003e #include \u003cforward_list\u003e #include \u003cfuture\u003e #include \u003cinitializer_list\u003e #include \u003cmutex\u003e #include \u003crandom\u003e #include \u003cratio\u003e #include \u003cregex\u003e #include \u003cscoped_allocator\u003e #include \u003csystem_error\u003e #include \u003cthread\u003e #include \u003ctuple\u003e #include \u003ctypeindex\u003e #include \u003ctype_traits\u003e #include \u003cunordered_map\u003e #include \u003cunordered_set\u003e #endif è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œæˆ‘ä»¬çŸ¥é“/(æ–œæ†)å…¶å®ä»£è¡¨ç›®å½•çš„ï¼Œä¹Ÿå°±æ˜¯è¯´stdc++.hæ‰æ˜¯å¤´æ–‡ä»¶åï¼Œå®ƒåœ¨bitsè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯æ–°å»ºä¸€ä¸ªåä¸ºbitsçš„æ–‡ä»¶å¤¹ã€‚ç„¶ååœ¨vscodeä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼šstdc++.hï¼Œå°†æˆ‘ä»¬ä¸Šé¢ä¸‡èƒ½å¤´æ–‡ä»¶çš„å®šä¹‰å¤åˆ¶åˆ°è¯¥æ–‡ä»¶ã€‚ä¿å­˜åœ¨bitsæ–‡ä»¶ç›®å½•ä¸‹å³å¯ã€‚ æˆ‘ä»¬æµ‹è¯•helloworldç¨‹åºï¼Œå‘ç°å¯ä»¥ä½¿ç”¨ã€‚é—®é¢˜è§£å†³ã€‚ ","date":"2021-03-12","objectID":"/posts/01.%E8%A7%A3%E5%86%B3vscode%E4%B8%AD%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8%E4%B8%87%E8%83%BD%E5%A4%B4%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98/:0:0","tags":["Vscode","ç«èµ›"],"title":"è§£å†³VSCodeä¸­ä¸èƒ½ä½¿ç”¨ä¸‡èƒ½å¤´æ–‡ä»¶çš„é—®é¢˜","uri":"/posts/01.%E8%A7%A3%E5%86%B3vscode%E4%B8%AD%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8%E4%B8%87%E8%83%BD%E5%A4%B4%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98/"},{"categories":["æŠ€å·§"],"content":"1 å¸¸ç”¨è®¾ç½® æŒ‰ä½Ctrlæ»šæ»šè½®ï¼Œä»£ç çš„å­—ä½“ä¼šéšä½ å¿ƒæ„å˜å¤§å˜å°ã€‚ åœ¨ç¼–è¾‘åŒºæŒ‰ä½å³é”®å¯æ‹–åŠ¨ä»£ç ï¼Œçœå»æ‹‰ï¼ˆå°¤å…¶æ˜¯æ¨ªå‘ï¼‰æ»šåŠ¨æ¡ä¹‹éº»çƒ¦ï¼›ç›¸å…³è®¾ç½®ï¼šMouse Drag Scrollingã€‚ Ctrl+Då¯å¤åˆ¶å½“å‰è¡Œæˆ–é€‰ä¸­å—ã€‚ Ctrl+Shift+Cæ³¨é‡Šæ‰å½“å‰è¡Œæˆ–é€‰ä¸­å—ï¼ŒCtrl+Shift+Xåˆ™è§£é™¤æ³¨é‡Šã€‚ Tabç¼©è¿›å½“å‰è¡Œæˆ–é€‰ä¸­å—,Shift+Tabå‡å°‘ç¼©è¿›ã€‚ å¯æ‹–åŠ¨é€‰ä¸­å—ä½¿å…¶ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼ŒæŒ‰ä½Ctrlåˆ™ä¸ºå¤åˆ¶åˆ°æ–°ä½ç½®ã€‚ æŒ‰ä¸‹Atlï¼Œå†æ‹–åŠ¨é¼ æ ‡ï¼Œå¯ä»¥å®ç°éƒ¨åˆ†é€‰æ‹©ï¼ˆå³åªé€‰ä¸­ä¸€ä¸ªåŒºåŸŸå†…çš„å­—ç¬¦ï¼Œè€Œä¸ä¼šåŒ…å«å®ƒä»¬æ‰€åœ¨è¡Œçš„å…¶ä»–å­—ç¬¦)ã€‚ éœ€è¦æ›´å¤§ç¼–è¾‘ç©ºé—´æ—¶ï¼ŒF2å’ŒShift+F2åˆ†åˆ«å¯ä»¥æ˜¾éšä¸‹æ–¹Logs \u0026 othersæ å’Œå·¦æ–¹çš„Managementæ ã€‚ Ctrl+Rå¯ä»¥æ›¿æ¢ï¼› ","date":"2020-11-24","objectID":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/:1:0","tags":["CodeBlocks"],"title":"CodeBlockså¿«æ·é”®åŠä¸€äº›å¸¸ç”¨è®¾ç½®","uri":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/"},{"categories":["æŠ€å·§"],"content":"2 ä¼˜åŒ–ä»£ç è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼š è¿›Settingsé‡Œçš„Editorï¼šåœ¨Code-completion and symbol browserä¸­ï¼Œ å°†Automatically launch when typed # letterä¸­çš„4æ”¹æˆ2ï¼Œè¿™æ ·æ‰“ä¸¤ä¸ªå­—æ¯å°±ä¼šæœ‰æç¤ºäº†ã€‚ å°†Keyword sets to additionally includeä¸­1åˆ°9éƒ½å‹¾ä¸Šï¼ˆå¯åœ¨Syntax highlighting çš„keywordsâ€¦ä¸­è®¾ç½®ï¼Œå…¶ä¸­1æ˜¯C++å…³é”®å­—ï¼Œ3æ˜¯Doxygenå…³é”®å­—ï¼›æˆ‘æ›¾å°†wxWidgetsçš„ç±»åéƒ½åŠ å…¥7å¹¶è®¾ç½®ç›¸åº”çš„å­—ä½“ï¼ˆç²—é»‘ ä½“ï¼‰ï¼Œçœ‹ä»£ç æ—¶ç‰¹åˆ«çˆ½ï¼‰ å°†Delay for auto-kick-in when typing [.::-\u003e]æ‹‰åˆ° 200msï¼Œè¿™æ ·å¿«ç‚¹å‡ºæ¥æç¤º é€‰ä¸­Case-sensitive matchï¼Œé˜²æ­¢ä¸€äº›æ— å…³çš„ä¸œè¥¿å¹²æ‰°ï¼Œå¦‚æœä½ æƒ³å®ƒå¸®ä½ çº æ­£å¤§å°å†™ï¼Œé‚£å°±å»æ‰å‹¾ è®¾ç½®å¿«æ·é”®ï¼š è¿›Settingsé‡Œçš„Editorï¼š åœ¨Keyboard short-cutsä¸­å°†Edit-\u003eCode completeçš„å¿«æ·é”®ç”±Ctrl+Spaceæ”¹ä¸ºAlt+/ï¼Œå› ä¸ºå‰è€…ä¸ä¸­æ–‡è¾“å…¥æ³•åˆ‡æ¢å†²çªï¼Œè¯¥å¿«æ·é”®ä¸ºå·²ç»è¾“å…¥çš„ï¼ˆä¸æ˜¯æ­£åœ¨è¾“å…¥çš„ï¼‰è¯æä¾›è‡ªåŠ¨å®Œæˆã€‚ ","date":"2020-11-24","objectID":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/:2:0","tags":["CodeBlocks"],"title":"CodeBlockså¿«æ·é”®åŠä¸€äº›å¸¸ç”¨è®¾ç½®","uri":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/"},{"categories":["æŠ€å·§"],"content":"3 å¤šå­¦ä¸€æ‹› çœ‹Abbreviationä¸€æ ï¼Œé‡Œé¢å®šä¹‰äº†è®¸å¤šç¼©å†™ï¼ˆè¿˜å¯ä»¥è‡ªå®šä¹‰ï¼‰ï¼Œåªè¦è¾“å…¥è¿™äº›ç¼©å†™ï¼Œå¹¶æŒ‰Ctrl+Jï¼Œå°±å¯ä»¥è‡ªåŠ¨å®Œæˆå¸¸ç”¨çš„ä»£ç æ¡†æ¶ï¼Œå¹¶å°†å…‰æ ‡æ”¾åœ¨æ°å½“çš„åœ°æ–¹ï¼ˆè‡ªå®šä¹‰æ—¶ç”¨|è¡¨è¾¾ï¼‰ã€‚å¸¸ç”¨çš„æœ‰ï¼šguardã€classã€switchç­‰ã€‚ å¦‚æœä½ å£°æ˜äº†ä¸€ä¸ªç±»ï¼Œä½ å¯ä»¥åœ¨cppæ–‡ä»¶ä¸­å³å‡»ï¼ŒInsert-\u003eAll class methods without implementationâ€¦æ¥æ’å…¥ä½ è¿˜æ²¡å®šä¹‰çš„æ–¹æ³•çš„å®šä¹‰ï¼ˆçœå»ä¸å°‘æ‰“å­—çš„åŠŸå¤«å“¦ï¼‰ï¼Œä¹Ÿå¯ä½¿ç”¨Insert-\u003eClass Method declaration/implementationâ€¦æ¥æ’å…¥ä¸€ä¸ªæ–¹æ³•çš„å£°æ˜æˆ–å®šä¹‰ã€‚ ","date":"2020-11-24","objectID":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/:3:0","tags":["CodeBlocks"],"title":"CodeBlockså¿«æ·é”®åŠä¸€äº›å¸¸ç”¨è®¾ç½®","uri":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/"},{"categories":["æŠ€å·§"],"content":"4 å¯¼èˆªç›¸å…³ Ctrl+G åˆ°è¾¾æŒ‡å®šè¡Œï¼ŒALT+G åˆ°è¾¾æŒ‡å®šæ–‡ä»¶ï¼ŒCtrl+Alt+G åˆ°è¾¾æŒ‡å®šå‡½æ•°ï¼ˆæ”¯æŒå¤´æ–‡ä»¶ä¸­çš„å‡½æ•°å®šä¹‰ï¼‰ï¼ŒF11 åˆ‡æ¢æºæ–‡ä»¶ä¸å¤´æ–‡ä»¶ã€‚ Ctrl+PageUp åˆ°è¾¾ä¸Šä¸€ä¸ªå‡½æ•°ï¼ŒCtrl+PageDown åˆ°è¾¾ä¸‹ä¸€ä¸ªå‡½æ•°ã€‚ Ctrl+B æ·»åŠ ä¹¦ç­¾ï¼ŒAlt+PageUpå’ŒAlt+PageDownå¯ä»¥åˆ‡æ¢ä¹¦ç­¾ã€‚ Ctrl+Shift+Bå¯æ‰¾åˆ°åŒ¹é…çš„æ‹¬å·ã€‚ çœ‹é•¿ä»£ç æ—¶ï¼Œå¯å³å‡»ï¼ŒFolding-\u003eFold Allï¼Œç„¶åæ…¢æ…¢å±•å¼€æ¥çœ‹ï¼Œä¹Ÿå¯å……åˆ†åˆ©ç”¨å·¦æ–¹Managementæ çš„Symbolæµè§ˆå™¨ã€‚ åœ¨ä¸€ä¸ªå˜é‡ã€å‡½æ•°æˆ–å®ä¸Šå³å‡»ï¼Œä¸‰ä¸ªä»¥Findå¼€å¤´çš„èœå•é¡¹ï¼Œåˆ†åˆ«å¯ä»¥ä¸ºä½ è½¬åˆ°å®ƒçš„å£°æ˜ã€å®šä¹‰å’Œæ‰¾åˆ°æ‰€æœ‰å‡ºç°çš„åœ°æ–¹ï¼ˆæŒ‰F2åœ¨ä¸‹æ–¹Thread Searché‚£é‡ŒæŸ¥çœ‹ï¼‰ã€‚ å…¶ä»–ï¼š General Settingsä¸­å¯ä»¥è®¾ç½®ç¼©è¿›ã€è‡ªåŠ¨æ¢è¡Œç­‰ç»†èŠ‚ã€‚ è®©Code::Blocksæ°¸è¿œè®°ä½ä½ çš„Layoutï¼Œå°¤å…¶æ˜¯debugçš„layoutï¼Œå–„ç”¨debugå·¥å…·æ ã€‚ å¤‡ä»½C:/Documents and Settings/[ä½ çš„ç”¨æˆ·å]/Application Data/codeblocks/Default.confï¼Œå¦‚é‡é‡è£…ï¼Œå°†å…¶æ”¾åœ¨codeblocks.exeæ‰€åœ¨ç›®å½•ï¼Œå°±ä¸ä¼šä¸¢å¤±ä½ çš„é…ç½®ï¼›è¿™æ ·ä¹Ÿå¯ä»¥ æ‰“é€ å‡ºCode::Blocksçš„ç»¿è‰²ç‰ˆã€‚ Ctrl+L å‰ªåˆ‡é€‰ä¸­è¡Œ F11 åˆ‡æ¢æºæ–‡ä»¶ä¸å¤´æ–‡ä»¶ F10 å…¨å± Ctrl+Shift+B æ‹¬å·åŒ¹é… æŒ‰ä¸‹ATLï¼Œå†æ‹–åŠ¨é¼ æ ‡ï¼Œå¯ä»¥å®ç°éƒ¨åˆ†é€‰æ‹© Ctrl+B æ·»åŠ ä¹¦ç­¾ï¼ŒALT+PageUpå’ŒPageDownå¯ä»¥åˆ‡æ¢ä¹¦ç­¾ã€‚ Ctrl+G åˆ°è¾¾æŒ‡å®šè¡Œ ALT+G åˆ°è¾¾æŒ‡å®šæ–‡ä»¶ Ctrl+Alt+G åˆ°è¾¾æŒ‡å®šå‡½æ•°ï¼ˆæ”¯æŒå¤´æ–‡ä»¶ä¸­çš„å‡½æ•°å®šä¹‰ï¼‰ Ctrl+PageUp åˆ°è¾¾ä¸Šä¸€ä¸ªå‡½æ•° Ctrl+PageDown åˆ°è¾¾ä¸‹ä¸€ä¸ªå‡½æ•° ","date":"2020-11-24","objectID":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/:4:0","tags":["CodeBlocks"],"title":"CodeBlockså¿«æ·é”®åŠä¸€äº›å¸¸ç”¨è®¾ç½®","uri":"/posts/03.codeblocks%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%AE%BE%E7%BD%AE/"},{"categories":["æŠ€å·§"],"content":"1 cinã€coutä¼˜åŒ– åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ std::cin/std::cout æ˜¯æä¸ºè¿Ÿç¼“çš„è¾“å…¥/è¾“å‡ºæ–¹å¼ï¼Œè€Œ scanf/printf æ¯” std::cin/std::cout å¿«å¾—å¤šã€‚ å¯æ˜¯ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿå¦‚æœæˆ‘æ›´ä¹ æƒ¯ä½¿ç”¨C++çš„è¾“å‡ºæ–¹å¼ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•è§£å†³è¾“å…¥è¾“å‡ºç¼“æ…¢çš„é—®é¢˜å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œcinä¸stdinæ€»æ˜¯ä¿æŒåŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸¤ç§æ–¹æ³•å¯ä»¥æ··ç”¨ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ–‡ä»¶æŒ‡é’ˆæ··ä¹±ï¼ŒåŒæ—¶coutå’Œstdoutä¹Ÿä¸€æ ·ï¼Œä¸¤è€…æ··ç”¨ä¸ä¼šè¾“å‡ºé¡ºåºé”™ä¹±ã€‚ç”±äºè¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥å¯¼è‡´cinå’Œcoutæœ‰è®¸å¤šé¢å¤–çš„å¼€é”€ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç¦ç”¨è¿™ä¸ªç‰¹æ€§å‘¢ï¼Ÿ ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:1:0","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"2 å…³é—­åŒæ­¥/è§£é™¤ç»‘å®š std::ios::sync_with_stdio(false) è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªâ€œæ˜¯å¦å…¼å®¹ stdioâ€çš„å¼€å…³ï¼ŒC++ ä¸ºäº†å…¼å®¹ Cï¼Œä¿è¯ç¨‹åºåœ¨ä½¿ç”¨äº† printf å’Œ std::cout çš„æ—¶å€™ä¸å‘ç”Ÿæ··ä¹±ï¼Œå°†è¾“å‡ºæµç»‘åˆ°äº†ä¸€èµ·ã€‚ è¿™å…¶å®æ˜¯ C++ ä¸ºäº†å…¼å®¹è€Œé‡‡å–çš„ä¿å®ˆæªæ–½ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿›è¡Œ IO æ“ä½œä¹‹å‰å°† stdio è§£é™¤ç»‘å®šï¼Œä½†æ˜¯åœ¨è¿™æ ·åšä¹‹åè¦æ³¨æ„ä¸èƒ½åŒæ—¶ä½¿ç”¨ std::cin/std::cout å’Œ scanf/printfã€‚æ›´ä¸¥æ ¼çš„æ¥è¯´ï¼šå…³é—­ä¹‹åC++ IOå’ŒC IO ä¸¤è€…ä¸èƒ½æ··ç”¨ï¼Œå¦åˆ™ä¼šé€ æˆIOæ··ä¹±ã€‚ ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:2:0","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"3 tieå‡½æ•°åŠ é€Ÿ è¿˜æœ‰ä¸€ç§å½±å“é€Ÿåº¦çš„åŸå› æ˜¯ï¼šåœ¨é»˜è®¤çš„æƒ…å†µä¸‹ std::cin ç»‘å®šçš„æ˜¯ std::cout ï¼Œæ¯æ¬¡æ‰§è¡Œ Â« æ“ä½œç¬¦çš„æ—¶å€™éƒ½è¦è°ƒç”¨ flush() ï¼Œè¿™æ ·ä¼šå¢åŠ  IO è´Ÿæ‹…ã€‚ tie æ˜¯å°†ä¸¤ä¸ª stream ç»‘å®šçš„å‡½æ•°ï¼Œç©ºå‚æ•°çš„è¯è¿”å›å½“å‰çš„è¾“å‡ºæµæŒ‡é’ˆã€‚ å¯ä»¥é€šè¿‡ std::cin.tie(0) å’Œstd:cout.tie(0)ï¼ˆ0 è¡¨ç¤º NULLï¼‰æ¥è§£é™¤ std::cin ä¸ std::cout çš„ç»‘å®šï¼Œè¿›ä¸€æ­¥åŠ å¿«æ‰§è¡Œæ•ˆç‡ã€‚ åœ¨è¿™ä¸¤ç§æƒ…å†µä¼˜åŒ–ä¸‹ï¼Œstd::cinå’Œstd::coutçš„é€Ÿåº¦å°±å’Œscanfå’ŒprintfåŸºæœ¬ä¸€æ ·äº†ï¼Œç”šè‡³æ›´å¿«ã€‚ std::ios::sync_with_stdio(false); std::cin.tie(0); std::cout.tie(0); //å¦‚æœç¼–è¯‘å¼€å¯äº† C++11 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå»ºè®®ä½¿ç”¨ std::cin.tie(nullptr); æ³¨æ„ï¼š scanf å’Œ printf ä¾ç„¶æœ‰ä¼˜åŒ–çš„ç©ºé—´ï¼Œè¿™å°±æ˜¯æœ¬ç« æ‰€ä»‹ç»çš„å†…å®¹â€”â€”è¾“å…¥å’Œè¾“å‡ºä¼˜åŒ–ã€‚ æ³¨æ„ï¼Œæ¥ä¸‹æ¥ä»‹ç»çš„è¾“å…¥å’Œè¾“å‡ºä¼˜åŒ–å‡é’ˆå¯¹æ•´å‹æ•°æ®ï¼ˆå‡½æ•°å®ç°è¯»å†™ï¼‰ï¼Œè‹¥è¦æ”¯æŒå…¶ä»–ç±»å‹çš„æ•°æ®ï¼ˆå¦‚æµ®ç‚¹æ•°ï¼‰ï¼Œå¯è‡ªè¡ŒæŒ‰ç…§æœ¬é¡µé¢ä»‹ç»çš„ä¼˜åŒ–åŸç†æ¥ç¼–å†™ä»£ç ã€‚ ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:3:0","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"4 æ›´å¿«çš„è¾“å…¥ä¼˜åŒ–getchar() ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:4:0","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"4.1 åŸç† ä¼—æ‰€å‘¨çŸ¥ï¼Œ getchar æ˜¯ç”¨æ¥è¯»å…¥ 1 byte çš„æ•°æ®å¹¶å°†å…¶è½¬æ¢ä¸º char ç±»å‹çš„å‡½æ•°ï¼Œä¸”é€Ÿåº¦å¾ˆå¿«ï¼Œæ•…å¯ä»¥ç”¨â€œè¯»å…¥å­—ç¬¦â€”â€”è½¬æ¢ä¸ºæ•´å‹â€æ¥ä»£æ›¿ç¼“æ…¢çš„è¯»å…¥ æ¯ä¸ªæ•´æ•°ç”±ä¸¤éƒ¨åˆ†ç»„æˆâ€”â€”ç¬¦å·å’Œæ•°å­—ï¼Œæ•´æ•°çš„ â€˜+â€™ é€šå¸¸æ˜¯çœç•¥çš„ï¼Œä¸”ä¸ä¼šå¯¹åé¢æ•°å­—æ‰€ä»£è¡¨çš„å€¼äº§ç”Ÿå½±å“ï¼Œè€Œ â€˜-â€™ ä¸å¯çœç•¥ï¼Œå› æ­¤è¦è¿›è¡Œåˆ¤å®šã€‚ 10 è¿›åˆ¶æ•´æ•°ä¸­æ˜¯ä¸å«ç©ºæ ¼æˆ–é™¤ 0~9 å’Œæ­£è´Ÿå·å¤–çš„å…¶ä»–å­—ç¬¦çš„ï¼Œå› æ­¤åœ¨è¯»å…¥ä¸åº”å­˜åœ¨äºæ•´æ•°ä¸­çš„å­—ç¬¦ï¼ˆé€šå¸¸ä¸ºç©ºæ ¼ï¼‰æ—¶ï¼Œå°±å¯ä»¥åˆ¤å®šå·²ç»è¯»å…¥ç»“æŸ C å’Œ C++ è¯­è¨€åˆ†åˆ«åœ¨ ctype.h å’Œ cctype å¤´æ–‡ä»¶ä¸­ï¼Œæä¾›äº†å‡½æ•° isdigit , è¿™ä¸ªå‡½æ•°ä¼šæ£€æŸ¥ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸ºåè¿›åˆ¶æ•°å­—å­—ç¬¦ï¼Œæ˜¯åˆ™è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚å¯¹åº”çš„ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ isdigit(ch) ä»£æ›¿ ch \u003e= â€˜0â€™ \u0026\u0026 ch \u003c= â€˜9â€™ ï¼Œè€Œå¯ä»¥ä½¿ç”¨ !isdigit(ch) ä»£æ›¿ ch \u003câ€˜0â€™ || ch\u003e â€˜9â€™ã€‚ ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:4:1","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"4.2 ä»£ç å®ç°è¾“å…¥å‡½æ•°read() int read() { int x = 0, w = 1; char ch = 0; //æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦ä¸ºåè¿›åˆ¶æ•°å­—å­—ç¬¦å¯ä»¥ä½¿ç”¨isdight()å‡½æ•°æ¥åˆ¤æ–­ï¼Œè¿™é‡Œä¸å†å±•ç¤ºã€‚ while (ch \u003c '0' || ch \u003e '9') { // ch ä¸æ˜¯æ•°å­—æ—¶ if (ch == '-') w = -1; // åˆ¤æ–­æ˜¯å¦ä¸ºè´Ÿ ch = getchar(); // ç»§ç»­è¯»å…¥ } while (ch \u003e= '0' \u0026\u0026 ch \u003c= '9') { // ch æ˜¯æ•°å­—æ—¶ï¼Œæˆ‘ä»¬è¾“å…¥ç»“æŸæ ‡å¿—ä¸ºç©ºæ ¼æˆ–å›è½¦ã€‚ x = x * 10 + (ch - '0'); // å°†æ–°è¯»å…¥çš„æ•°å­—â€™åŠ â€™åœ¨ x çš„åé¢ // æ­¤å¤„ä¹Ÿå¯ä»¥ä½¿ç”¨ (x\u003c\u003c3)+(x\u003c\u003c1) çš„å†™æ³•æ¥ä»£æ›¿ x*10 å³ï¼šx=(x\u003c\u003c3)+(x\u003c\u003c1)+(ch-'0');ç”¨ä½è¿ç®—æ•ˆç‡æ›´é«˜ï¼Œè¿™é‡Œç›¸å½“äºx*8+x*2+(ch-'0'); //åˆ©ç”¨ASCIIç è½¬æ¢ä¸ºå¯¹åº”æ•°å­—ã€‚ ch = getchar(); // ç»§ç»­è¯»å…¥ } return x * w; // æ•°å­— * æ­£è´Ÿå· = å®é™…æ•°å€¼ } ä¸¾ä¾‹ ï¼šæˆ‘ä»¬è¾“å…¥æ•°æ®æ—¶å¯ä»¥è¿™æ ·è°ƒç”¨readå‡½æ•°:num=read()ã€‚ ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:4:2","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"5 æ›´å¿«çš„è¾“å‡ºä¼˜åŒ–putchar() ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:5:0","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"5.1 åŸç† åŒæ ·æ˜¯ä¼—æ‰€å‘¨çŸ¥ï¼Œ putchar æ˜¯ç”¨æ¥è¾“å‡ºå•ä¸ªå­—ç¬¦çš„å‡½æ•°,å› æ­¤å°†æ•°å­—çš„æ¯ä¸€ä½è½¬åŒ–ä¸ºå­—ç¬¦è¾“å‡ºä»¥åŠ é€Ÿ,è¦æ³¨æ„çš„æ˜¯ï¼Œè´Ÿå·è¦å•ç‹¬åˆ¤æ–­è¾“å‡ºï¼Œå¹¶ä¸”æ¯æ¬¡ %ï¼ˆmodï¼‰å–å‡ºçš„æ˜¯æ•°å­—æœ«ä½ï¼Œå› æ­¤è¦å€’åºè¾“å‡ºã€‚ ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:5:1","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æŠ€å·§"],"content":"5.2 ä»£ç å®ç° é€’å½’ç‰ˆ void write(int x) { if (x \u003c 0) { // åˆ¤è´Ÿ + è¾“å‡ºè´Ÿå· + å˜åŸæ•°ä¸ºæ­£æ•° x = -x; putchar('-'); } if (x \u003e 9) write(x / 10); // é€’å½’ï¼Œå°†é™¤æœ€åä¸€ä½å¤–çš„å…¶ä»–éƒ¨åˆ†æ”¾åˆ°é€’å½’ä¸­è¾“å‡º putchar(x % 10 + '0'); // å·²ç»è¾“å‡ºï¼ˆé€’å½’ï¼‰å®Œ x æœ«ä½å‰çš„æ‰€æœ‰æ•°å­—ï¼Œè¾“å‡ºæœ«ä½ } ç”±äºé€’å½’çš„ä»»åŠ¡é‡æ¯”è¾ƒå¤§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ˆæ¥å®ç°éé€’å½’ã€‚ éé€’å½’ç‰ˆ inline void write(int x) { static int sta[35]; int top = 0; do { sta[top++] = x % 10, x /= 10;//å°†å–å‡ºçš„å…ƒç´ å…¥æ ˆã€‚ } while (x); while (top) putchar(sta[--top] + 48); //ç”±äºæˆ‘ä»¬è¦è¾“å‡ºå­—ç¬¦ï¼Œè¿™é‡Œè¿›è¡Œè½¬æ¢ï¼š 48 æ˜¯ '0' } OKï¼Œè¿™å°±æ˜¯ç»å…¸çš„è¾“å…¥è¾“å‡ºçš„ä¼˜åŒ–åšæ³•ï¼Œé€šå¸¸cfæ¦œä¸Šçš„å¤§ä½¬ç”¨çš„éƒ½æ˜¯åé¢è¿™ç§æ–¹æ³•ï¼Œè¿™ç¡®å®å¾ˆå¿«ï¼Œæ¯”scanfå’Œprintfå¿«äº†çº¦$1/3$äº†å§ã€‚æˆ‘è‡ªå·±å¸¸ç”¨çš„å°±æ˜¯ç¬¬ä¸€ç§ä¼˜åŒ–æ–¹æ³•ï¼Œé€šå¸¸æˆ‘ä¼šåˆ©ç”¨å®å®šä¹‰æ¥é¿å…è¿™ä¹ˆç¹çï¼Œå¦‚ï¼š#define IOS ios::sync_with_stdio(false);cin.tie(0); cout.tie(0) é‚£ä¹ˆï¼Œåœ¨ä¸»å‡½æ•°ç›´æ¥ä½¿ç”¨IOS;è¯­å¥å³å¯å®ç°ä¼˜åŒ–åŠŸèƒ½ã€‚ ","date":"2020-08-18","objectID":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/:5:2","tags":["ä¼˜åŒ–","ç«èµ›"],"title":"ç®—æ³•ç«èµ›å¸¸ç”¨æŠ€å·§â€”â€”è¾“å…¥è¾“å‡ºä¼˜åŒ–ï¼ˆé˜²æ­¢TLEï¼‰","uri":"/posts/04.%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E4%BC%98%E5%8C%96%E9%98%B2%E6%AD%A2tle/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 ç®€ä»‹ Kruskalç®—æ³•æ˜¯ä¸€ç§ç”¨æ¥æŸ¥æ‰¾æœ€å°ç”Ÿæˆæ ‘ï¼ˆ$MST$ï¼‰çš„ç®—æ³•ï¼Œç”±Joseph Kruskalåœ¨1956å¹´å‘è¡¨ã€‚æ±‚æœ€å°ç”Ÿæˆæ ‘çš„ç®—æ³•å¸¸ç”¨æœ‰ä¸¤ç§ï¼šKruskalç®—æ³•å’ŒPrimç®—æ³•ã€‚è¿™é‡ŒæŒ‡è·¯ä¸€ç¯‡Primç®—æ³•çš„è¯¦è§£blogï¼šhttps://blog.csdn.net/hzf0701/article/details/107927858ã€‚ä¸Primç®—æ³•ä¸åŒçš„æ˜¯ï¼Œè¯¥ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å½’å¹¶è¾¹ï¼Œè€ŒPrimç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å½’å¹¶ç‚¹ã€‚è¿™é‡Œæˆ‘ä»¬ä¼šåœ¨åé¢çš„å®ç°è¿‡ç¨‹ä¸­çœ‹åˆ°ã€‚ ","date":"2020-08-11","objectID":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:1:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Kruskalç®—æ³•è¯¦è§£","uri":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 æ„é€ è¿‡ç¨‹ å‡è®¾è¿é€šç½‘$N=(V,E)$ï¼Œå°†$N$ä¸­çš„è¾¹æŒ‰æƒå€¼ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ã€‚ â‘ åˆå§‹çŠ¶æ€ä¸ºåªæœ‰$n$ä¸ªé¡¶ç‚¹è€Œæ— è¾¹çš„éè¿é€šå›¾$T=(V,{})$ï¼Œå›¾ä¸­æ¯ä¸ªé¡¶ç‚¹è‡ªæˆä¸€ä¸ªè¿é€šåˆ†é‡ã€‚ â‘¡åœ¨$E$ä¸­é€‰æ‹©æƒå€¼æœ€å°çš„è¾¹ï¼Œè‹¥è¯¥è¾¹ä¾é™„çš„é¡¶ç‚¹è½åœ¨$T$ä¸­ä¸åŒçš„è¿é€šåˆ†é‡ä¸Šï¼ˆå³ä¸å½¢æˆå›è·¯ï¼‰ï¼Œåˆ™å°†æ­¤è¾¹å°†å…¥åˆ°$T$ä¸­ï¼Œå¦åˆ™èˆå»æ­¤è¾¹è€Œé€‰æ‹©ä¸‹ä¸€æ¡æƒå€¼æœ€å°çš„è¾¹ã€‚ â‘¢é‡å¤â‘¡ï¼Œç›´åˆ°$T$ä¸­æ‰€æœ‰çš„é¡¶ç‚¹éƒ½åœ¨åŒä¸€è¿é€šåˆ†é‡ä¸Šä¸ºæ­¢ã€‚ è¿™ä¸ªç®—æ³•çš„æ„é€ è¿‡ç¨‹ååˆ†ç®€æ´æ˜äº†ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿™æ ·çš„æ„é€ è¿‡ç¨‹èƒ½å¦å½¢æˆæœ€å°ç”Ÿæˆæ ‘å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ç¬¬äºŒä¸ªæ­¥éª¤ï¼Œå› ä¸ºæˆ‘ä»¬é€‰å–çš„è¾¹çš„é¡¶ç‚¹æ˜¯ä¸åŒçš„è¿é€šåˆ†é‡ï¼Œä¸”è¾¹æƒå€¼æ˜¯æœ€å°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¿è¯åŠ å…¥çš„è¾¹éƒ½ä¸ä½¿å¾—$T$æœ‰å›è·¯ï¼Œä¸”æƒå€¼ä¹Ÿæœ€å°ã€‚è¿™æ ·æœ€åå½“æ‰€æœ‰çš„è¿é€šåˆ†é‡éƒ½ç›¸åŒæ—¶ï¼Œå³æ‰€æœ‰çš„é¡¶ç‚¹éƒ½åœ¨ç”Ÿæˆæ ‘ä¸­è¢«è¿æ¥æˆåŠŸäº†ï¼Œæˆ‘ä»¬æ„é€ æˆçš„æ ‘ä¹Ÿå°±æ˜¯æœ€å°ç”Ÿæˆæ ‘äº†ã€‚ ","date":"2020-08-11","objectID":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Kruskalç®—æ³•è¯¦è§£","uri":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 ç¤ºä¾‹ ","date":"2020-08-11","objectID":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:3:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Kruskalç®—æ³•è¯¦è§£","uri":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 ç®—æ³•å®ç° æ­¥éª¤ï¼š â‘ å°†å­˜å‚¨è¾¹çš„æ•°ç»„tempæŒ‰æƒå€¼ä»å°åˆ°å¤§æ’åºï¼Œæ³¨æ„è¿›è¡Œè¿ç®—ç¬¦é‡è½½ã€‚ â‘¡åˆå§‹åŒ–è¿é€šåˆ†é‡æ•°ç»„$verx$ã€‚ â‘¢ä¾æ¬¡æŸ¥çœ‹æ•°ç»„tempçš„è¾¹ï¼Œå¾ªç¯æ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚ ä¾æ¬¡ä»æ’å¥½åºçš„æ•°ç»„tempä¸­é€‰å‡ºä¸€æ¡è¾¹$(u,v)$ï¼› åœ¨$verx$ä¸­åˆ†åˆ«æŸ¥æ‰¾$u$å’Œ$v$æ‰€åœ¨çš„è¿é€šåˆ†é‡$v_1å’Œv_2$ï¼Œè¿›è¡Œåˆ¤æ–­ã€‚ å¦‚æœ$v_1$å’Œ$v_2$ä¸ç­‰ï¼Œè¯´æ˜æ‰€é€‰çš„ä¸¤ä¸ªé¡¶ç‚¹åˆ†åˆ«å±äºä¸åŒçš„è¿é€šåˆ†é‡ï¼Œåˆ™å°†æ­¤è¾¹å­˜å…¥æœ€å°ç”Ÿæˆæ ‘$tree$ï¼Œå¹¶åˆå¹¶$v_1$å’Œ$v_2$è¿™ä¸ªä¸¤ä¸ªè¿é€šåˆ†é‡ã€‚ å¦‚æœ$v_1$å’Œ$v_2$ç›¸ç­‰ï¼Œåˆ™è¯´æ˜æ‰€é€‰çš„ä¸¤ä¸ªé¡¶ç‚¹å±äºåŒä¸€ä¸ªè¿é€šåˆ†é‡ï¼Œèˆå»æ­¤è¾¹è€Œé€‰æ‹©ä¸‹ä¸€æ¡æƒå€¼æœ€å°çš„è¾¹ã€‚ #include\u003cbits/stdc++.h\u003e //POJä¸æ”¯æŒ #define rep(i,a,n) for (int i=a;i\u003c=n;i++)//iä¸ºå¾ªç¯å˜é‡ï¼Œaä¸ºåˆå§‹å€¼ï¼Œnä¸ºç•Œé™å€¼ï¼Œé€’å¢ #define per(i,a,n) for (int i=a;i\u003e=n;i--)//iä¸ºå¾ªç¯å˜é‡ï¼Œ aä¸ºåˆå§‹å€¼ï¼Œnä¸ºç•Œé™å€¼ï¼Œé€’å‡ã€‚ #define pb push_back #define IOS ios::sync_with_stdio(false);cin.tie(0); cout.tie(0) #define fi first #define se second #define mp make_pair using namespace std; const int inf = 0x3f3f3f3f;//æ— ç©·å¤§ const int maxn = 1e5;//æœ€å¤§å€¼ã€‚ typedef long long ll; typedef long double ld; typedef pair\u003cll, ll\u003e pll; typedef pair\u003cint, int\u003e pii; //*******************************åˆ†å‰²çº¿ï¼Œä»¥ä¸Šä¸ºè‡ªå®šä¹‰ä»£ç æ¨¡æ¿***************************************// struct edge{ int s;//è¾¹çš„èµ·å§‹é¡¶ç‚¹ã€‚ int e;//è¾¹çš„ç»ˆç«¯é¡¶ç‚¹ã€‚ int w;//è¾¹æƒå€¼ã€‚ bool operator \u003c (const edge \u0026a){ return w\u003ca.w; } }; edge temp[maxn];//ä¸´æ—¶æ•°ç»„å­˜å‚¨è¾¹ã€‚ int verx[maxn];//è¾…åŠ©æ•°ç»„ï¼Œåˆ¤æ–­æ˜¯å¦è¿é€šã€‚ edge tree[maxn];//æœ€å°ç”Ÿæˆæ ‘ã€‚ int n,m;//n*nçš„å›¾ï¼Œmæ¡è¾¹ã€‚ int cnt;//ç»Ÿè®¡ç”Ÿæˆç»“ç‚¹ä¸ªæ•°ï¼Œè‹¥ä¸æ»¡è¶³nä¸ªï¼Œåˆ™ç”Ÿæˆå¤±è´¥ã€‚ int sum;//æœ€å°ç”Ÿæˆæ ‘æƒå€¼æ€»å’Œã€‚ void print(){ //æ‰“å°æœ€å°ç”Ÿæˆæ ‘å‡½æ•°ã€‚ cout\u003c\u003c\"æœ€å°ç”Ÿæˆæ ‘çš„æƒå€¼æ€»å’Œä¸ºï¼š\"\u003c\u003csum\u003c\u003cendl; rep(i,0,cnt-1){ cout\u003c\u003ctree[i].s\u003c\u003c\" \"\u003c\u003ctree[i].e\u003c\u003c\"è¾¹æƒå€¼ä¸º\"\u003c\u003ctree[i].w\u003c\u003cendl; } } void Kruskal(){ rep(i,1,n) verx[i]=i;//è¿™é‡Œè¡¨ç¤ºå„é¡¶ç‚¹è‡ªæˆä¸€ä¸ªè¿é€šåˆ†é‡ã€‚ cnt=0;sum=0; sort(temp,temp+m);//å°†è¾¹æŒ‰æƒå€¼æ’åˆ—ã€‚ int v1,v2; rep(i,0,m-1){ v1=verx[temp[i].s]; v2=verx[temp[i].e]; if(v1!=v2){ tree[cnt].s=temp[i].s;tree[cnt].e=temp[i].e;tree[cnt].w=temp[i].w;//å¹¶å…¥æœ€å°ç”Ÿæˆæ ‘ã€‚ rep(j,1,n){ //åˆå¹¶v1å’Œv2çš„ä¸¤ä¸ªåˆ†é‡ï¼Œå³ä¸¤ä¸ªé›†åˆç»Ÿä¸€ç¼–å·ã€‚ if(verx[j]==v2)verx[j]=v1; //é»˜è®¤é›†åˆç¼–å·ä¸ºv2çš„æ”¹ä¸ºv1. } sum+=tree[cnt].w; cnt++; } } //ç»“æŸåŒå±‚forå¾ªç¯ä¹‹åå¾—åˆ°treeå³æ˜¯æœ€å°ç”Ÿæˆæ ‘ã€‚ print(); } int main(){ //freopen(\"in.txt\", \"r\", stdin);//æäº¤çš„æ—¶å€™è¦æ³¨é‡Šæ‰ IOS; while(cin\u003e\u003en\u003e\u003em){ int u,v,w; rep(i,0,m-1){ cin\u003e\u003eu\u003e\u003ev\u003e\u003ew; temp[i].s=u;temp[i].e=v;temp[i].w=w; } Kruskal(); } return 0; } ","date":"2020-08-11","objectID":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:4:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Kruskalç®—æ³•è¯¦è§£","uri":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5 ç®—æ³•åˆ†æ å¯¹äºæœ‰$m$æ¡è¾¹å’Œ$n$ä¸ªé¡¶ç‚¹çš„å›¾ã€‚åœ¨$for$å¾ªç¯ä¸­æœ€è€—æ—¶çš„æ“ä½œå°±æ˜¯åˆå¹¶ä¸¤ä¸ªä¸åŒçš„è¿é€šåˆ†é‡ï¼Œç¬¬ä¸€ä¸ªå¾ªç¯è¯­å¥çš„é¢‘åº¦ä¸º$m$ï¼Œç¬¬äºŒä¸ªå¾ªç¯ç”±äºå­˜åœ¨$if$è¯­å¥ï¼Œæ‰€ä»¥å¹³å‡é¢‘åº¦æ˜¯$log_2n$ï¼Œæ‰€ä»¥è¯¥ç®—æ³•çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º$O(mlog_2n)$ï¼Œæ•…å’ŒPrimç®—æ³•ç›¸æ¯” æ­¤ç®—æ³•é€‚åˆç”¨äºç¨€ç–å›¾ã€‚ ","date":"2020-08-11","objectID":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:5:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Kruskalç®—æ³•è¯¦è§£","uri":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6 æµ‹è¯• ä»¥ç¤ºä¾‹æ•°æ®ä¸ºæµ‹è¯•æ ·ä¾‹ï¼š 7 11 1 2 7 1 4 5 2 4 9 2 3 8 2 5 7 4 5 15 4 6 6 6 7 11 5 6 8 5 7 9 3 5 5 æµ‹è¯•ç»“æœå¦‚å›¾ï¼š ","date":"2020-08-11","objectID":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:6:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Kruskalç®—æ³•è¯¦è§£","uri":"/posts/03.kruskal%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"å‰è¨€ï¼šç†è§£çº¿æ®µæ ‘ç€å®èŠ±äº†æˆ‘å¾ˆå¤šæ—¶é—´ï¼Œä¸»è¦ä¹‹å‰ä¸€ç›´æœ‰ä¸ªè¯¯åŒºï¼Œå°±æ˜¯å¯¹çº¿æ®µæ ‘ä¸­å­˜å‚¨çš„ä¿¡æ¯ï¼Œæˆ‘è®¤ä¸ºåªèƒ½æ˜¯åŒºé—´å’Œï¼Œå¯ä¸‡ä¸‡æ²¡æƒ³åˆ°å‘€ï¼Œå®ƒè¿˜å¯ä»¥æ˜¯åˆ«çš„ä¸œè¥¿ï¼šåŒºé—´æœ€å°å€¼ã€åŒºé—´æœ€å¤§å€¼ç­‰ç­‰å‘€ï¼Œæˆ‘è¡¨ç¤ºğŸ‘¤(å·²é»‘åŒ–)ï¼Œå¥½äº†ï¼Œè¨€å½’æ­£ä¼ ï¼Œåšä¸»æ˜¯å®Œå…¨ç†è§£äº†çº¿æ®µæ ‘ä¹‹åæ‰æœ‰å‹‡æ°”å†™è¿™ç¯‡æ–‡ç« çš„ï¼Œæ‰€ä»¥æˆ‘æ˜¯æ ¹æ®ä¸€ä¸ªå®Œå…¨åˆå­¦è€…åˆ°ç†è§£çº¿æ®µæ ‘çš„è¿‡ç¨‹æ¥å†™ä¸‹è¿™ç¯‡æ–‡ç« çš„ï¼Œä¸ä¼šåƒå…¶ä»–æ–‡ç« ä¸€ä¸‹éš¾ä»¥ç†è§£ï¼Œå½“ç„¶ï¼Œæœ¬æ–‡ä¹Ÿåªæ˜¯æˆ‘å­¦ä¹ æ•´ç†çš„ï¼Œå¦‚æœæœ‰é”™è¯¯çš„è¯ï¼Œè¿˜è¯·è¯„è®ºåŒºç•™è¨€æˆ–ç§ä¿¡æˆ‘ï¼Œå…±åŒè¿›æ­¥ã€‚ çº¿æ®µæ ‘è®²è§£å…±æœ‰ä¸¤ç¯‡ï¼Œè¿™ä¸€ç¯‡ä¸ºå…¥é—¨ï¼Œå¦ä¸€ç¯‡ä¸ºè¿›é˜¶ã€‚ ","date":"2020-08-07","objectID":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/:0:0","tags":["çº¿æ®µæ ‘"],"title":"çº¿æ®µæ ‘å…¥é—¨","uri":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 ä»€ä¹ˆæ˜¯çº¿æ®µæ ‘ï¼Ÿ çº¿æ®µæ ‘çš„åŸºæœ¬æ¦‚å¿µ åœ¨æ·±å…¥å­¦ä¹ çº¿æ®µæ ‘ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£çº¿æ®µæ ‘æ˜¯ä»€ä¹ˆï¼Ÿçº¿æ®µæ ‘æœ¬è´¨ä¹Ÿæ˜¯ä¸€é¢—äºŒå‰æœç´¢æ ‘ï¼Œä¹Ÿè¢«è®¤ä¸ºæ˜¯åŒºé—´æ ‘ï¼ˆå³æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸€æ®µåŒºé—´ï¼Œæˆ‘ä»¬ä¹Ÿè®¤ä¸ºæ˜¯çº¿æ®µï¼‰ã€‚é‚£æœ‰å°ä¼™ä¼´å¯èƒ½å°±è¦é—®äº†ï¼Œä»€ä¹ˆæ˜¯äºŒå‰æœç´¢æ ‘ï¼ŸäºŒå‰æœç´¢æ ‘é¡¾åæ€ä¹‰ï¼šå‰ææ˜¯ä¸€é¢—äºŒå‰æ ‘ï¼Œå®ƒçš„æ¯ä¸ªç»“ç‚¹åº¦éƒ½å°äºç­‰äº2ï¼Œå³æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­æ ‘ã€‚å…¶æ¬¡å°±æ˜¯æœç´¢ï¼Œè¿™æ˜¯å…³é”®ï¼Œæˆ‘ä»¬è¿™ä¸ªçº¿æ®µæ ‘åœ¨å…¶ä¸­éƒ½æœ‰ä¸€ä¸ªåŒºé—´ï¼Œé‚£ä¹ˆæœç´¢å³æ˜¯å¯ä»¥åœ¨è¿™ä¸ªåŒºé—´ä¸Šæœç´¢ä½ æƒ³è¦çš„å€¼ï¼Œè¿™å°±æ˜¯æœç´¢ï¼Œå…¶ä¸­ï¼Œæ¯ä¸ªç»“ç‚¹å­˜å‚¨çš„ä¿¡æ¯æ˜¯ç”±ä½ æ¥å®šçš„ï¼Œå¦‚æœä½ æƒ³æ±‚åŒºé—´å’Œï¼Œé‚£ä¹ˆå°±å¯ä»¥å­˜å‚¨åŒºé—´å’Œï¼Œå¦‚æœä½ æƒ³æ±‚åŒºé—´æœ€å¤§å€¼ï¼Œé‚£ä¹ˆä½ å¯ä»¥å­˜å‚¨åŒºé—´æœ€å¤§å€¼ï¼Œåªè¦å¯è¡Œï¼Œä½ éƒ½å¯ä»¥è¿›è¡Œä½ æƒ³è¦çš„æ“ä½œã€‚ çº¿æ®µæ ‘çš„æ³¨æ„äº‹é¡¹ åœ¨ç»™å®šäº†å¤§å°ç»™å®šäº†å¶å­ç»“ç‚¹æ•°ç›®çš„æ—¶å€™è¿™ä¸ªçº¿æ®µæ ‘å°±å·²ç»ç¡®å®šäº†ï¼Œæˆ‘ä»¬ä¸èƒ½è¿›è¡Œæ·»åŠ å’Œåˆ é™¤å…ƒç´ ï¼Œä¸æ˜¯è¯´ä¸èƒ½å¯¹å·²æœ‰å¶å­ç»“ç‚¹èµ‹å€¼ï¼Œæ˜¯ä¸èƒ½å¯¹å…¶è¿›è¡Œæ‰©å¤§æˆ–è€…å‡å°ã€‚å› ä¸ºåœ¨å¤§å¤šæ•°æƒ…å†µä¸­ï¼Œå¯¹äºçº¿æ®µæ ‘æ¥è¯´ï¼ŒåŒºé—´æœ¬èº«éƒ½æ˜¯å›ºå®šçš„ï¼Œä¸è€ƒè™‘æ–°å¢å’Œåˆ é™¤å…ƒç´ ã€‚æ‰€ä»¥ç”¨æ•°ç»„å­˜å‚¨çš„è¯ï¼Œç›´æ¥ç”¨é™æ€æ•°ç»„å°±å¥½äº†ï¼Œä¸ç”¨åŠ¨æ€æ•°ç»„ã€‚ çº¿æ®µæ ‘çš„å¤§å°ä¸€å®šè¦å¼€å¶å­ç»“ç‚¹æ•°ç›®ï¼ˆå³åŸæœ‰ç‚¹å¯¹ç‚¹çš„æ•°æ®æ•°ç»„å¤§å°ï¼‰çš„å››å€ã€‚ä¾‹å¦‚å¶å­ç»“ç‚¹æ•°ç›®æ˜¯maxnï¼Œé‚£ä¹ˆæˆ‘ä»¬é€šå¸¸ä¼šå¼€çº¿æ®µæ ‘çš„å¤§å°ä¸ºmaxnÂ«2ã€‚å› ä¸ºçº¿æ®µæ ‘ä¹Ÿæ˜¯ä¸€é¢—å®Œå…¨äºŒå‰æ ‘ï¼Œå½“æœ€å¤§çš„æ—¶å€™å¯èƒ½æ˜¯æ»¡äºŒå‰æ ‘ã€‚æˆ‘ä»¬æ¥è¯æ˜ä¸€ä¸‹ï¼Œæˆ‘ä»¬è¿™æ ·æƒ³ï¼šæœ€æ·±ä¸€å±‚çš„æ•°ç›®æ˜¯nï¼Œåˆ™æ­¤çº¿æ®µæ ‘çš„é«˜åº¦ä¸º$\\lceil$$\\log_2n\\rceil$,æˆ‘ä»¬å¯çŸ¥$\\lceil$$\\log_2n\\rceil$ $\\leq$ $log_2n+1$ã€‚é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡ç„¶åé€šè¿‡ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼ï¼ˆ$\\frac{a_1(1-q^x)}{1-q}$ï¼‰æ±‚å¾—äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œå…·ä½“å…¬å¼ä¸º$\\frac{1*(1-2^x)}{1-2}$ï¼Œï¼ˆ$x$ä¸ºæ ‘çš„å±‚æ•°ï¼Œä¸ºæ ‘çš„é«˜åº¦$+1$ï¼‰ï¼ŒåŒ–ç®€å¯å¾—$2^{log_2n+1+1}-1$,æ•´ç†ä¹‹åå³ä¸º$4n$ï¼ˆè¿‘ä¼¼è®¡ç®—å¿½ç•¥æ‰-1) æˆ‘ä»¬è¿›è¡Œä¹˜é™¤æ³•è¿ç®—çš„æ—¶å€™è¦ä½¿ç”¨ä½è¿ç®—ï¼ˆÂ« Â»ä¸€å®šè¦ä»”ç»†ç†è§£è¿™ä¸¤ä¸ªè¿ç®—ç¬¦ï¼‰ï¼Œè€Œé¿å…ä½¿ç”¨åŸºæœ¬çš„æ•°å­¦è¿ç®—ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šé¢‘ç¹ä½¿ç”¨ç»“ç‚¹åæ ‡æ›´æ–°ï¼Œç”¨ä½è¿ç®—ä¼šæ›´å¿«ä¸€ç‚¹ï¼Œè€Œä¸”è¿˜å¯ä»¥é˜²WRã€‚ åœ¨è¡¨ç¤ºåæ ‡çš„æ—¶å€™ï¼Œè‹¥ä¸€ä¸ªç»“ç‚¹ä¸‹æ ‡ä¸ºiï¼Œé‚£ä¹ˆå®ƒçš„çˆ¶èŠ‚ç‚¹å°±æ˜¯iÂ»1ã€‚å¦‚æœè¿™ä¸ªç»“ç‚¹æ˜¯è¿™ä¸ªçˆ¶èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œé‚£ä¹ˆå³å­©å­ä¸‹æ ‡å°±æ˜¯i+1ã€‚å¦‚æœè¿™ä¸ªç»“ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­©å­ï¼Œé‚£ä¹ˆå·¦å­©å­çš„ä¸‹æ ‡å°±æ˜¯i-1ã€‚é‚£ä¸ªè¿™ä¸ªç»“ç‚¹çš„å·¦å­©å­ä¸‹æ ‡å°±æ˜¯iÂ«1ï¼Œå³å­©å­ä¸‹æ ‡å°±æ˜¯(iÂ«1)=1ï¼ˆè¿™é‡Œä¸€å®šè¦ä½¿ç”¨æ‹¬å·æ”¹å˜è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼Œå› ä¸ºä½è¿ç®—çš„ä¼˜å…ˆçº§å±å®ä½ã€‚ï¼‰ è¦æ ¹æ®ä½ æƒ³è§£å†³çš„é—®é¢˜æ¥è®¾ç½®ç»“ç‚¹çš„æ•°æ®ä¿¡æ¯ã€‚åŒºé—´æ±‚å’Œå’ŒåŒºé—´æœ€å€¼æ‰€è¿›è¡Œçš„æ˜¯ä¸å¤ªä¸€æ ·çš„ï¼Œæ‰€æ›´æ”¹çš„ä¿¡æ¯ä¹Ÿéƒ½è¦æ³¨æ„ï¼Œä½†éƒ½æ˜¯ä¸€ä¸ªæœ¬è´¨ï¼Œå°±æ˜¯ä»ä¸‹å¾€ä¸Šæ›´æ–°ï¼Œåˆ°è¾¾æ ¹èŠ‚ç‚¹å°±é€€å‡ºã€‚ çº¿æ®µæ ‘ä¸ä¸€å®šæ˜¯æ»¡äºŒå‰æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿æ®µæ ‘çš„å¶å­ç»“ç‚¹ä¸ä¸€å®šæ˜¯åœ¨æœ€åä¸€å±‚ã€‚çº¿æ®µæ ‘ä¹Ÿä¸ä¸€å®šæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼ˆåˆ‡è®°ï¼ï¼‰ã€‚ä½†æˆ‘ä»¬å¯ä»¥æŠŠçº¿æ®µæ ‘çœ‹æˆæ˜¯æ»¡äºŒå‰æ ‘ï¼Œå¯¹äºä¸å­˜åœ¨çš„ç»“ç‚¹æˆ‘ä»¬è§†ä¸ºç©ºå°±è¡Œã€‚ çº¿æ®µæ ‘èƒ½è§£å†³çš„é—®é¢˜ çº¿æ®µæ ‘çš„é€‚ç”¨èŒƒå›´å¾ˆå¹¿ï¼Œå¯ä»¥åœ¨çº¿ç»´æŠ¤ä¿®æ”¹ä»¥åŠæŸ¥è¯¢åŒºé—´ä¸Šçš„æœ€å€¼ï¼Œæ±‚å’Œã€‚ä½¿ç”¨ä¸€ç»´çº¿æ®µæ ‘å¯ä»¥å¿«é€Ÿçš„æŸ¥æ‰¾æŸä¸€ä¸ªèŠ‚ç‚¹åœ¨è‹¥å¹²æ¡çº¿æ®µä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(logN)ã€‚çº¿æ®µæ ‘æ›´å¯ä»¥æ‰©å……åˆ°äºŒç»´çº¿æ®µæ ‘ï¼ˆçŸ©é˜µæ ‘ï¼‰å’Œä¸‰ç»´çº¿æ®µæ ‘ï¼ˆç©ºé—´æ ‘ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ä½œè®²è§£ã€‚ï¼ˆå…¶å®åšä¸»ä¹Ÿæš‚æ—¶ä¸ä¼šğŸ˜„ï¼‰ ä½ é—®æˆ‘çº¿æ®µæ ‘ç®—ä»€ä¹ˆä¸œè¥¿ï¼Ÿä»Šå¤©æˆ‘å°±å‘Šè¯‰ä½ ï¼Œå•ç‚¹ã€åŒºé—´æœ´ç´ æŸ¥è¯¢å¤„ç†åšçš„æˆ‘çº¿æ®µæ ‘èƒ½åšï¼å•ç‚¹ã€åŒºé—´æœ´ç´ æŸ¥è¯¢æ²¡æœ‰çš„é€Ÿåº¦æˆ‘æœ‰ï¼è¿™å°±æ˜¯çº¿æ®µæ ‘ã€‚ï¼ˆæˆ˜æœ¯åä»°ï¼‰ ","date":"2020-08-07","objectID":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/:1:0","tags":["çº¿æ®µæ ‘"],"title":"çº¿æ®µæ ‘å…¥é—¨","uri":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 çº¿æ®µæ ‘çš„åŸºæœ¬å†…å®¹ æˆ‘ä»¬å…ˆçœ‹ä¸€é¢—çº¿æ®µæ ‘ï¼š ä¸ç„¶å‘ç°çº¿æ®µæ ‘çš„ç‰¹ç‚¹ï¼Œæ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªå€¼å’ŒåŒºé—´ï¼Œæ¯ä¸ªç»“ç‚¹çš„å·¦å³å­©å­éƒ½å­˜å‚¨äº†çˆ¶ç»“ç‚¹çš„ä¸€åŠçš„åŒºé—´ï¼Œä¸”å®ƒä»¬çš„åºå·æ˜¯æŒ‰ç…§å±‚æ¬¡é¡ºåºç¼–å·çš„ã€‚åœ¨æ—¥å¸¸å¤„ç†ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯ä½¿ç”¨ç»“æ„ä½“æ•°ç»„æ¥ä½œä¸ºçº¿æ®µæ ‘çš„å­˜å‚¨ç»“æ„ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸‹æ ‡çš„å…³ç³»æ¥æ‰¾åˆ°çˆ¶èŠ‚ç‚¹å’Œå­©å­ç»“ç‚¹äº†ã€‚ä¾‹å¦‚æˆ‘ä»¬å·²çŸ¥ä¸€ä¸ªç»“ç‚¹çš„ä¸‹æ ‡ä¸ºiï¼Œé‚£ä¹ˆï¼š å¯¹äºçˆ¶ç»“ç‚¹ï¼šiÂ»1ï¼ˆè¿™ä¸ªè¿›è¡Œçš„æ“ä½œå…¶å®å°±æ˜¯i/2ï¼Œå‰é¢æåˆ°ï¼Œè¿™æ ·ä¼šå¿«å¾ˆå¤šï¼‰ å…·ä½“è¯æ˜ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠçº¿æ®µæ ‘çœ‹æˆä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ï¼ˆç©ºç»“ç‚¹ä¹Ÿå½“ä½œä½¿ç”¨ï¼‰å¯¹äºä»»æ„ä¸€ä¸ªç»“ç‚¹iæ¥è¯´ï¼Œå®ƒæ‰€åœ¨æ­¤äºŒå‰æ ‘çš„$log_2i$ å±‚ï¼Œåˆ™æ­¤å±‚å…±æœ‰$2^{log2(i)}$ä¸ªç»“ç‚¹ï¼ŒåŒæ ·å¯¹äºkçš„å·¦å­æ ‘é‚£å±‚æ¥è¯´æœ‰$2^{log_2{k}+1}$ä¸ªç»“ç‚¹ï¼Œåˆ™ç»“ç‚¹kå’Œå·¦å­æ ‘é—´éš”äº†$22^{log_2(i)}-i + 2(i-2^{log_2(k)})$ä¸ªç»“ç‚¹ï¼Œç„¶åè¿™å°±å¾ˆç®€å•å°±å¾—åˆ°$k+22^{log_2(k)}-k + 2(k-2^{log2(k)}) = 2*k$çš„å…³ç³»äº†å§ï¼Œå³å­æ ‘ä¹Ÿå°±ç­‰äºå·¦å­æ ‘ç»“ç‚¹+1ã€‚ å¯¹äºå·¦å­©å­ç»“ç‚¹ï¼šå·¦å­©å­ä¸‹æ ‡ï¼šiÂ«1ï¼ˆè¿™äº›æ˜¯åŒç†çš„ï¼Œå³æ˜¯ç”±çˆ¶ç»“ç‚¹æ¨å­©å­ç»“ç‚¹ã€‚ï¼‰ å¯¹äºå³å­©å­ç»“ç‚¹ï¼šå³å­©å­ä¸‹æ ‡ï¼šiÂ«1|1 äº†è§£äº†è¿™äº›å…³ç³»ï¼Œæˆ‘ä»¬æ˜¯æœ‰èƒ½åŠ›å»å»ºç«‹ä¸€é¢—çº¿æ®µæ ‘çš„ï¼Œå› ä¸ºçº¿æ®µæ ‘ä¹Ÿæ˜¯æ ‘ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªç„¶å¯ä»¥åˆ©ç”¨é€’å½’çš„æ€æƒ³å»å»ºæ ‘ï¼Œä¸ä¼šå¾ˆéš¾ï¼Œæˆ‘ä¹Ÿå†™å…¨äº†æ³¨é‡Šã€‚ const int maxn = 1e5;//æœ€å¤§å€¼ã€‚ struct Node{ int left; //å·¦ç«¯ç‚¹ int right; //å³ç«¯ç‚¹ int value;//ä»£è¡¨åŒºé—´[left,right]çš„ä¿¡æ¯ï¼Œå¯ä»¥æ˜¯åŒºé—´å’Œï¼Œä¹Ÿå¯ä»¥æ˜¯åŒºé—´æœ€å€¼ã€‚ }node[maxn\u003c\u003c2];//è¿™é‡Œæˆ‘ä»¬è¦å¼€4å€å¤§å°ï¼Œé˜²æ­¢æ•°æ®æº¢å‡º int father[maxn];//å­˜å‚¨åŸæ¥æ•°æ®åœ¨çº¿æ®µæ ‘ä¸­çš„ä¸‹æ ‡ï¼Œæ˜“äºä»ä¸‹å‘ä¸Šæ›´æ–°åŒºé—´æ•°æ®ã€‚ä¾‹å¦‚father[i]è¡¨ç¤ºåŸæ¥çš„ç¬¬iä¸ªæ•°æ®åœ¨çº¿æ®µæ ‘ä¸­çš„ä¸‹æ ‡ï¼Œè¿™äº›åœ¨çº¿æ®µæ ‘ä¸­éƒ½æ˜¯å¶å­ç»“ç‚¹ã€‚ void BuildTree(int i,int l,int r){ node[i].left=l;node[i].right=r;//å­˜å‚¨å„è‡ªç»“ç‚¹çš„åŒºé—´ node[i].value=0; //åˆå§‹åŒ–ä¸º0. if(l==r){ //è¯´æ˜å·²ç»åˆ°äº†å¶å­ç»“ç‚¹ã€‚ father[l]=i;//å­˜å‚¨ä¸‹æ ‡ã€‚ return; } BuildTree(i\u003c\u003c1,l,(l+r)/2); //é€’å½’åˆå§‹åŒ–å·¦å­æ ‘ BuildTree((i\u003c\u003c1)+1,(l+r)/2+1,r);//é€’å½’åˆå§‹åŒ–å³å­æ ‘ã€‚ } è¿™æ ·ï¼Œæˆ‘ä»¬çš„çº¿æ®µæ ‘å°±å»ºå¥½äº†ã€‚æˆ‘ä»¬æ¥çœ‹çº¿æ®µæ ‘æœ‰å“ªäº›åŸºæœ¬æ“ä½œå§ã€‚ ","date":"2020-08-07","objectID":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/:2:0","tags":["çº¿æ®µæ ‘"],"title":"çº¿æ®µæ ‘å…¥é—¨","uri":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 çº¿æ®µæ ‘çš„åŸºæœ¬æ“ä½œ æˆ‘ä»¬è¿™é‡Œä»¥ç»“ç‚¹çš„å€¼valueä»£è¡¨åŒºé—´å’Œæ¥å¤„ç†ã€‚ ","date":"2020-08-07","objectID":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/:3:0","tags":["çº¿æ®µæ ‘"],"title":"çº¿æ®µæ ‘å…¥é—¨","uri":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.1 ç‚¹æ›´æ–° è¿™å¾ˆå¥½åŠï¼Œæœ‰æ²¡æœ‰æ³¨æ„æˆ‘ä»¬æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªfatheræ•°ç»„ï¼Œå¦‚æœæˆ‘åœ¨åŸæ•°ç»„ä¸­ä¿®æ”¹ç¬¬iä¸ªå…ƒç´ çš„å€¼ï¼Œæˆ‘ä»¬æ˜¯ç›´æ¥å¯ä»¥node[father[i]].value=wï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨fatheræ•°ç»„çš„å¥½å¤„ï¼Œé‚£ä½ å¯èƒ½ä¼šé—®äº†ï¼Œæˆ‘ä»¬è¿™æ ·æ˜¯ä¸æ˜¯è¦ä½¿ç”¨ä¸‰ä¸ªæ•°ç»„ï¼Ÿå¤§å¯ä¸å¿…ï¼Œæˆ‘ä»¬æ²¡å¿…è¦ç»™åŸæœ‰æ•°æ®å¼€ä¸€ä¸ªæ•°ç»„å­˜æ”¾ï¼Œå› ä¸ºæˆ‘ä»¬æœ¬èº«å°±å·²ç»æŠŠæ•°æ®æ”¾åœ¨çº¿æ®µæ ‘ä¸­äº†ï¼Œä¸ç®¡çº¿æ®µæ ‘ä¸­å­˜æ”¾çš„æ˜¯åŒºé—´å’Œè¿˜æ˜¯åŒºé—´æœ€å€¼ï¼Œå¯¹äºå¶å­ç»“ç‚¹æ¥è¯´ï¼Œå®ƒå°±æ˜¯æœ¬èº«ã€‚é‚£ä¹ˆæˆ‘ä»¬åŠ å…¥äº†ç‚¹ï¼Œè‡ªç„¶ä¹Ÿè¦æ›´æ–°æ•´æ£µæ ‘ï¼Œé‚£æœ‰å…³è¿™ä¸ªå¶å­ç»“ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„è‡ªç„¶å…¨éƒ¨éƒ½æ˜¯è¦æ›´æ–°çš„ï¼Œæˆ‘ä»¬åˆ™æ˜¯ä»ä¸‹å¾€ä¸Šåˆ©ç”¨é€’å½’æ€æƒ³æ¥æ›´æ–°çš„ã€‚ void UpdateTree(int ri){ if(ri==1){ return; } int fi=ri\u003e\u003e1;//è·å¾—çˆ¶ç»“ç‚¹ä¸‹æ ‡ã€‚ node[fi].value=node[fi\u003c\u003c1].value+node[fi\u003c\u003c1|1].value;//ä¸¤æ®µåŒºé—´æ€»å’Œã€‚ UpdateTree(fi); } ","date":"2020-08-07","objectID":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/:3:1","tags":["çº¿æ®µæ ‘"],"title":"çº¿æ®µæ ‘å…¥é—¨","uri":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.2 åŒºé—´æŸ¥è¯¢ æˆ‘ä»¬æœ‰äº†çº¿æ®µæ ‘ï¼Œå¯å´ä¸å¯¹å®ƒè¿›è¡Œç›¸å…³æŸ¥è¯¢ï¼Œé‚£è¿™é¢—çº¿æ®µæ ‘ä¹Ÿåªæ˜¯ç²¾è‡´çš„èŠ±ç“¶è€Œå·²ã€‚æˆ‘ä»¬æœ€é‡è¦çš„å°±æ˜¯è¿›è¡ŒåŒºé—´æŸ¥è¯¢ï¼Œç°åœ¨å¦‚æœæˆ‘æƒ³çŸ¥é“æŸä¸ªåŒºé—´å’Œçš„è¯ï¼Œæˆ‘ä»¬åº”è¯¥æ€æ ·æ¥å¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“æ ¹èŠ‚ç‚¹æ˜¯å­˜æ”¾äº†æ•´ä¸ªåŒºé—´çš„ä¿¡æ¯ï¼Œç„¶åå®ƒçš„å­©å­ç»“ç‚¹åˆ™å­˜æ”¾äº†å®ƒä¸€åŠåŒºé—´çš„ä¿¡æ¯ï¼Œè¿™æ ·åˆ™æ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬ä»æ ¹èŠ‚ç‚¹å¼€å§‹è‡ªä¸Šå¾€ä¸‹æŸ¥è¯¢å³å¯ã€‚æˆ‘ä»¬æœ¬ç€ä¸‹é¢çš„æ€æƒ³å°±ä¸€ç›®äº†ç„¶äº†ã€‚ 1ã€å¦‚æœè¿™ä¸ªåŒºé—´è¢«å®Œå…¨åŒ…æ‹¬åœ¨ç›®æ ‡åŒºé—´é‡Œé¢ï¼Œç›´æ¥è¿”å›è¿™ä¸ªåŒºé—´çš„å€¼ 2ã€å¦‚æœè¿™ä¸ªåŒºé—´çš„å·¦å„¿å­å’Œç›®æ ‡åŒºé—´æœ‰äº¤é›†ï¼Œé‚£ä¹ˆæœç´¢å·¦å„¿å­ 3ã€å¦‚æœè¿™ä¸ªåŒºé—´çš„å³å„¿å­å’Œç›®æ ‡åŒºé—´æœ‰äº¤é›†ï¼Œé‚£ä¹ˆæœç´¢å³å„¿å­ OKï¼Œæ•´æ´»ã€‚ //åŒºé—´æŸ¥è¯¢ï¼Œè°ƒç”¨å‡½æ•°æ—¶ä¸ºQueryTree(1,l,r)ï¼Œå³ä»æ ¹èŠ‚ç‚¹è‡ªä¸Šå¾€ä¸‹æŸ¥è¯¢ã€‚ int QueryTree(int i,int l,int r){ int sum=0; if(l==node[i].left\u0026\u0026r==node[i].right){ //å¦‚æœåˆšå¥½å°±æ˜¯è¿™ä¸ªåŒºé—´ï¼Œæˆ‘ä»¬ç›´æ¥è¿”å›ã€‚ sum+=node[i].value; return sum; } i=i\u003c\u003c1; if(l\u003c=node[i].right){ //è¯´æ˜éƒ¨åˆ†åŒ…å«å·¦å­æ ‘ if(r\u003c=node[i].right){ //è¯´æ˜å…¨åŒ…å«åœ¨å·¦å­æ ‘ã€‚ sum+=QueryTree(i,l,r); } else{ sum+=QueryTree(i,l,node[i].right); } } i+=1; if(r\u003e=node[i].left){ //è¯´æ˜éƒ¨åˆ†åŒ…å«å³å­æ ‘ if(l\u003e=node[i].left){ //è¯´æ˜å…¨åŒ…å«åœ¨å³å­æ ‘ã€‚ sum+=QueryTree(i,l,r); } else{ sum+=QueryTree(i,node[i].left,r); } } return sum; //è¿”å›æ±‚å¾—çš„åŒºé—´å’Œã€‚ } åŒºé—´æŸ¥è¯¢ä¸æ–­äºŒåˆ†ï¼Œæ˜“çŸ¥æ—¶é—´å¤æ‚åº¦ä¸ºO($log_2n$)ã€‚ çº¿æ®µæ ‘çš„åŸºæœ¬æ“ä½œå°±æ˜¯è¿™äº›ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯å…¥é—¨ï¼Œçµæ´»ä½¿ç”¨çº¿æ®µæ ‘ä»¥åŠæ›´æ·±å±‚æ¬¡çš„åˆ©ç”¨çº¿æ®µæ ‘çš„é“è·¯è¿˜å¾ˆé•¿ï¼Œæˆ‘ä»¬ä¸€èµ·åŠ æ²¹ï¼ ä¸»å‡½æ•°éƒ¨åˆ†æµ‹è¯•ï¼š int main(){ freopen(\"in.txt\", \"r\", stdin);//æäº¤çš„æ—¶å€™è¦æ³¨é‡Šæ‰ ios::sync_with_stdio(false);//æ‰“æ¶ˆiostreamä¸­è¾“å…¥è¾“å‡ºç¼“å­˜ï¼ŒèŠ‚çœæ—¶é—´ã€‚ cin.tie(0); cout.tie(0);//å¯ä»¥é€šè¿‡tie(0)ï¼ˆ0è¡¨ç¤ºNULLï¼‰æ¥è§£é™¤cinä¸coutçš„ç»‘å®šï¼Œè¿›ä¸€æ­¥åŠ å¿«æ‰§è¡Œæ•ˆç‡ã€‚ int n,m,g; while(cin\u003e\u003en\u003e\u003em){ BuildTree(1,1,n); rep(i,1,n){ cin\u003e\u003eg; node[father[i]].value=g; UpdateTree(father[i]); } char ch; int a,b; while(m--){ cin\u003e\u003ech\u003e\u003ea\u003e\u003eb; if(ch=='Q'){ cout\u003c\u003cQueryTree(1,a,b)\u003c\u003cendl;; } else{ node[father[a]].value=b; UpdateTree(father[a]); } } } return 0; } æµ‹è¯•æ•°æ®ï¼š 6 5 2 3 8 23 1 9 Q 1 6 S 2 3 Q 1 6 S 3 4 Q 1 6 æµ‹è¯•ç»“æœï¼š ","date":"2020-08-07","objectID":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/:3:2","tags":["çº¿æ®µæ ‘"],"title":"çº¿æ®µæ ‘å…¥é—¨","uri":"/posts/01.%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"PSï¼šæ­¤ç®—æ³•ä¸èƒ½ç”¨äºæ±‚è´Ÿæƒå›¾ï¼Œè¦æ±‚æ‰€æœ‰è¾¹çš„æƒé‡éƒ½ä¸ºéè´Ÿå€¼ã€‚ ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:0:0","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 ç®€ä»‹ è¿ªæ°æ–¯ç‰¹æ‹‰ç®—æ³•(Dijkstra)æ˜¯ç”±è·å…°è®¡ç®—æœºç§‘å­¦å®¶ç‹„å…‹æ–¯ç‰¹æ‹‰äº1959 å¹´æå‡ºçš„ï¼Œå› æ­¤åˆå«ç‹„å…‹æ–¯ç‰¹æ‹‰ç®—æ³•ã€‚è¿™æ˜¯ä»ä¸€ä¸ªé¡¶ç‚¹åˆ°å…¶ä½™å„é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œè§£å†³çš„æ˜¯æœ‰æƒå›¾ä¸­æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚è¿ªæ°æ–¯ç‰¹æ‹‰ç®—æ³•ä¸»è¦ç‰¹ç‚¹æ˜¯ä»èµ·å§‹ç‚¹å¼€å§‹ï¼Œé‡‡ç”¨è´ªå¿ƒç®—æ³•çš„ç­–ç•¥ï¼Œæ¯æ¬¡éå†åˆ°å§‹ç‚¹è·ç¦»æœ€è¿‘ä¸”æœªè®¿é—®è¿‡çš„é¡¶ç‚¹çš„é‚»æ¥èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰©å±•åˆ°ç»ˆç‚¹ä¸ºæ­¢ã€‚ ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:1:0","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 ç®—æ³•æ€æƒ³ä¸åŸç† dijkstraç®—æ³•æ€æƒ³æ˜¯åŸºäºè´ªå¿ƒç®—æ³•æ€æƒ³çš„ã€‚æ‰€è°“è´ªå¿ƒç®—æ³•å³å§‹ç»ˆä¿æŒå½“å‰è¿­ä»£è§£ä¸ºå½“å‰æœ€ä¼˜è§£ã€‚æ„æ€å°±æ˜¯åœ¨å·²çŸ¥çš„æ¡ä»¶ä¸‹æˆ–æ˜¯å½“å‰æ‹¥æœ‰çš„å…¨éƒ¨æ¡ä»¶ä¸‹ä¿è¯æœ€ä¼˜è§£ï¼Œè‹¥åœ¨æ­¤åçš„è¿­ä»£ä¸­ç”±äºåŠ å…¥äº†æ–°çš„æ¡ä»¶ä½¿å¾—äº§ç”Ÿäº†æ›´ä¼˜è§£åˆ™æ›¿ä»£æ­¤å‰çš„æœ€ä¼˜è§£ã€‚é€šè¿‡ä¸æ–­çš„è¿­ä»£ä¸æ–­ä¿è¯æ¯æ¬¡è¿­ä»£çš„ç»“æœéƒ½æ˜¯å½“å‰æœ€ä¼˜è§£ï¼Œé‚£ä¹ˆå½“è¿­ä»£åˆ°æœ€åä¸€è½®æ—¶å¾—åˆ°çš„å°±ä¼šæ˜¯å…¨å±€æœ€ä¼˜è§£ã€‚ ç”±äºä¸‹ä¸€è½®è¿­ä»£ä¼šå‚è€ƒä¸Šä¸€è½®çš„æœ€ä¼˜è§£ï¼Œå› æ­¤æ¯ä¸€è½®çš„è¿­ä»£çš„å·¥ä½œé‡åŸºæœ¬ä¸€è‡´ï¼Œé™ä½äº†æ•´ä½“å·¥ä½œçš„å¤æ‚æ€§ã€‚ åœ¨æœ€çŸ­è·¯å¾„çš„é—®é¢˜ä¸­ï¼Œå±€éƒ¨æœ€ä¼˜è§£å³å½“å‰çš„æœ€çŸ­è·¯å¾„æˆ–è€…è¯´æ˜¯åœ¨å½“å‰çš„å·²çŸ¥æ¡ä»¶ä¸‹èµ·ç‚¹åˆ°å…¶ä½™å„ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚å…³é”®å°±åœ¨äºå·²çŸ¥æ¡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯Dijkstraç®—æ³•æœ€ç²¾å¦™çš„åœ°æ–¹ã€‚æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ã€‚ å¯¹äºDijkstraç®—æ³•ï¼Œæˆ‘ä»¬å‡è®¾åˆå§‹é›†åˆï¼ˆä¹Ÿå°±æ˜¯åˆå§‹æ¡ä»¶ï¼‰ä¸å­˜åœ¨ä»»ä½•é¡¶ç‚¹çš„ï¼Œå³æ‰€æœ‰é¡¶ç‚¹ä¹‹é—´æ˜¯ä¸å­˜åœ¨ä»»ä½•è·¯å¾„çš„ï¼Œå³æˆ‘ä»¬è®¤ä¸ºæ‰€æœ‰é¡¶ç‚¹ä¹‹é—´çš„è·ç¦»éƒ½æ˜¯æ— ç©·å¤§ã€‚é‚£ä¹ˆå¼€å§‹åŠ å…¥æ–°çš„æ¡ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬å·²çŸ¥æºç‚¹è·æºç‚¹è·ç¦»æœ€å°ï¼Œæ‰€ä»¥åŠ å…¥è¿›å»ï¼Œå¹¶åŠ å…¥å®ƒçš„è¾¹ï¼Œåœ¨è¯¥æ¡ä»¶ä¸‹ï¼Œæ›´æ–°è¯¥æºç‚¹åˆ°å…¶ä½™é¡¶ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œé€‰å‡ºæ²¡æœ‰åŠ å…¥åˆ°å·²çŸ¥é›†åˆçš„è·æºç‚¹è·ç¦»æœ€å°çš„ç‚¹ï¼Œæ­¤ç‚¹æœ€çŸ­è·ç¦»ä¹Ÿè¢«ç¡®å®šäº†ï¼ˆå› ä¸ºå…¶ä»–è·¯å¾„éƒ½æ¯”è¿™æ¡è·¯å¾„å¤§ï¼Œæ— æ³•é€šè¿‡å…¶ä»–è·¯å¾„é—´æ¥åˆ°è¾¾è¿™ä¸ªé¡¶ç‚¹ä½¿å¾—è·¯å¾„æ›´å°ï¼‰ï¼Œç„¶ååŠ å…¥è¯¥ç‚¹ä¸å…¶ä½™è¿˜æœªåŠ å…¥å·²çŸ¥æ¡ä»¶é¡¶ç‚¹çš„è¾¹ï¼Œå¹¶ä»¥è¯¥ç‚¹è¿­ä»£åˆ·æ–°æœ€çŸ­è·ç¦»ã€‚å†é‡å¤ä»¥ä¸Šæ“ä½œï¼Œç›´è‡³æ‰€æœ‰é¡¶ç‚¹éƒ½åŠ å…¥å·²çŸ¥æ¡ä»¶é›†åˆã€‚ ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:0","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 å…·ä½“æ­¥éª¤ é€‰æ‹©èµ·ç‚¹$start$ä¸ç»ˆç‚¹$end$ï¼› æ‰€æœ‰ç‚¹é™¤èµ·ç‚¹å¤–åŠ å…¥æœªçŸ¥é›†åˆï¼Œå¹¶å°†èµ·ç‚¹åŠ å…¥å·²çŸ¥é›†åˆï¼Œå³è‡³æ ‡å¿—ä½ä¸ºçœŸï¼Œæ„ä¸ºå·²ç¡®å®šè¯¥ç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·¯å¾„ï¼› åˆå§‹åŒ–è®¡ç®—ï¼Œæ›´æ–°èµ·ç‚¹ä¸å…¶ä»–å„ç‚¹çš„è€—è´¹$dis(start,n)$; åœ¨æœªçŸ¥é›†åˆä¸­ï¼Œé€‰æ‹©dis(start,n)ä¸­å€¼æœ€å°çš„ç‚¹xï¼Œå°†xåŠ å…¥å·²çŸ¥é›†åˆã€‚ å¯¹äºå‰©ä½™é¡¶ç‚¹ä¸­ï¼Œè®¡ç®—$dis(start,n)\u003edis(start,x)+dis(x,n)$ è‹¥çœŸåˆ™$dis(start,n)=dis(start,x)+dis(x,n)$ï¼Œæ­¤æ—¶startä¸nç‚¹è·¯å¾„ç»è¿‡xç‚¹ã€‚å¾ªç¯ç›´è‡³goalç‚¹åŠ å…¥å·²çŸ¥åˆ—è¡¨ï¼Œå–å¾—$dis(start,goal)$å³ä¸ºæœ€çŸ­è·ç¦»ã€‚ ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:3:0","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 åŠ¨æ€å±•ç¤º ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:4:0","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5 ä¸€èˆ¬ä»£ç å®ç°ï¼ˆä»¥é‚»æ¥çŸ©é˜µä¸ºä¾‹ï¼‰ ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:5:0","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.1 åŸºæœ¬æ•°æ® const int inf=0x3f3f3f3f; //ä»£è¡¨æ— ç©·å¤§ã€‚ const int maxn=100;//æœ€å¤§é¡¶ç‚¹æ•° int n,m;//nä¸ªé¡¶ç‚¹ï¼Œmæ¡è¾¹ã€‚ bool visited[maxn];//åˆ¤æ–­æ˜¯å¦ç¡®å®šåˆ°æºç‚¹çš„æœ€ç»ˆæœ€çŸ­è·ç¦»ã€‚ int graph[maxn][maxn];//å¸¦æƒå›¾ int dis[maxn];//é¡¶ç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·ç¦»ã€‚ int start,goal;//èµ·ç‚¹ä¸ç›®æ ‡ç‚¹ã€‚ ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:5:1","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.2 åˆå§‹åŒ– void init(){ memset(visited,false,sizeof(visited)); for(int i=1;i\u003c=n;i++){ dis[i]=graph[start][i];//åˆå§‹åŒ–disæ•°ç»„ã€‚ } } ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:5:2","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.3 dijkstraç®—æ³•æ ¸å¿ƒ void dijkstra(){ //æºç‚¹ä¸ºæºç‚¹startã€‚ int minn;//è®°å½•æ¯è¶Ÿæœ€çŸ­è·¯å¾„ä¸­æœ€å°çš„è·¯å¾„å€¼ã€‚ int pos;//è®°å½•å¾—åˆ°çš„minnæ‰€å¯¹åº”çš„ä¸‹æ ‡ã€‚ init();//è°ƒç”¨åˆå§‹åŒ–å‡½æ•°ã€‚ visited[start]=true; for(int i=1;i\u003c=n;i++){ //å°†nä¸ªé¡¶ç‚¹ä¾æ¬¡åŠ å…¥åˆ¤æ–­ã€‚ minn=inf; for(int j=1;j\u003c=n;j++){ if(!visited[j]\u0026\u0026dis[j]\u003cminn){ minn=dis[j]; pos=j; } } //ç»è¿‡è¿™è¶Ÿforå¾ªç¯åæˆ‘ä»¬æ‰¾åˆ°çš„å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç‚¹ï¼Œå¯ä»¥ç¡®å®šè¿™ç‚¹åˆ°æºç‚¹çš„æœ€ç»ˆæœ€çŸ­è·ç¦»äº†ã€‚ visited[pos]=true;//æˆ‘ä»¬å°†æ­¤ç‚¹å¹¶å…¥å·²çŸ¥é›†åˆã€‚ //æ¥ä¸‹æ¥å°±æ˜¯æ›´æ–°disæ•°ç»„äº†ï¼Œä¹Ÿå°±æ˜¯å½“å‰æœ€çŸ­è·ç¦»ï¼Œè¿™éƒ½æ˜¯é’ˆå¯¹è¿˜æ²¡æœ‰å¹¶å…¥å·²çŸ¥é›†åˆçš„ç‚¹ã€‚ for(int j=1;j\u003c=n;j++){ if(!visited[j]\u0026\u0026dis[j]\u003edis[pos]+graph[pos][j]) dis[j]=dis[pos]+graph[pos][j]; } } //é€€å‡ºå¾ªç¯åï¼Œæ‰€æœ‰çš„ç‚¹éƒ½å·²å¹¶å…¥å·²çŸ¥é›†åˆä¸­ï¼Œå¾—åˆ°çš„disæ•°ç»„ä¹Ÿå°±æ˜¯æœ€ç»ˆæœ€çŸ­è·ç¦»äº†ã€‚ cout\u003c\u003cdis[goal]\u003c\u003cendl;//è¾“å‡ºç›®æ ‡ç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚ } ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:5:3","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"5.4 ä¸»å‡½æ•°ä¸å¤´æ–‡ä»¶ç­‰ #include\u003cbits/stdc++.h\u003e using namespace std; int main() { while(cin\u003e\u003en\u003e\u003em){ memset(graph,inf,sizeof(graph)); int u,v,w; for(int i=0;i\u003cm;i++){ cin\u003e\u003eu\u003e\u003ev\u003e\u003ew; // graph[u][v]=w;//æœ‰å‘å›¾ graph[u][v]=graph[v][u]=w;//æ— å‘å›¾ } cin\u003e\u003estart\u003e\u003egoal;//è¾“å…¥èµ·ç‚¹ä¸ç»ˆç‚¹ã€‚ dijkstra(); } return 0; } ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:5:4","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"6 æ‹“å±• å¦‚æœä½ å­¦ä¼šäº†dijkstraï¼Œé‚£æ­å–œä½ æˆåŠŸçªç ´äº†ä¸€å…³ã€‚ä½†æ˜¯ï¼Œæ²¡æœ‰ä¼˜åŒ–çš„dijkstraç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œå¦‚æœé¡¶ç‚¹å¾ˆå¤šè¾¹å¾ˆå°‘å‘¢ç­‰ç­‰å¡é‚»æ¥çŸ©é˜µçš„é¢˜ï¼Œé‚£ä¹ˆå»ºè®®ä½ è¿˜æ˜¯è¦å­¦ä¸€ä¸‹dijkstraçš„ä¼˜åŒ–ç‰ˆäº†ã€‚è¯¦æƒ…ç‚¹å‡»ï¼šDijkstraç®—æ³•ä¼˜åŒ–~~ä½ ä¸€å®šå¯ä»¥çœ‹æ‡‚çš„å››ç§è¿›é˜¶ä¼˜åŒ– ","date":"2020-07-29","objectID":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:6:0","tags":["æœ€çŸ­è·¯"],"title":"Dijkstraç®—æ³•æ•™ç¨‹","uri":"/posts/02.dijkstra%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 æœ€å°ç”Ÿæˆæ ‘ï¼ˆMSTï¼‰ åœ¨ä¸€ç»™å®šçš„æ— å‘å›¾$G = (V, E)$ ä¸­ï¼Œ$(u, v)$ä»£è¡¨è¿æ¥é¡¶ç‚¹$u$ ä¸é¡¶ç‚¹ $v$ çš„è¾¹ï¼Œè€Œ $w(u, v)$ ä»£è¡¨æ­¤è¾¹çš„æƒé‡ï¼Œè‹¥å­˜åœ¨ $T$ ä¸º $E$ çš„å­é›†ä¸”ä¸ºæ— å¾ªç¯å›¾ï¼Œä½¿å¾— $w(T)$ æœ€å°ï¼Œåˆ™æ­¤ $T$ ä¸º $G$ çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œå› ä¸º$T$æ˜¯ç”±å›¾$G$äº§ç”Ÿçš„ã€‚ æœ€å°ç”Ÿæˆæ ‘å…¶å®æ˜¯æœ€å°æƒé‡ç”Ÿæˆæ ‘çš„ç®€ç§°ã€‚æˆ‘ä»¬ç§°æ±‚å–è¯¥ç”Ÿæˆæ ‘çš„é—®é¢˜æˆä¸ºæœ€å°ç”Ÿæˆæ ‘é—®é¢˜ã€‚ä¸€ä¸ªè¿é€šå›¾å¯èƒ½æœ‰å¤šä¸ªç”Ÿæˆæ ‘ã€‚å½“å›¾ä¸­çš„è¾¹å…·æœ‰æƒå€¼æ—¶ï¼Œæ€»ä¼šæœ‰ä¸€ä¸ªç”Ÿæˆæ ‘çš„è¾¹çš„æƒå€¼ä¹‹å’Œå°äºæˆ–è€…ç­‰äºå…¶å®ƒç”Ÿæˆæ ‘çš„è¾¹çš„æƒå€¼ä¹‹å’Œã€‚å¹¿ä¹‰ä¸Šè€Œè¨€ï¼Œå¯¹äºéè¿é€šæ— å‘å›¾æ¥è¯´ï¼Œå®ƒçš„æ¯ä¸€è¿é€šåˆ†é‡åŒæ ·æœ‰æœ€å°ç”Ÿæˆæ ‘ï¼Œå®ƒä»¬çš„å¹¶è¢«ç§°ä¸ºæœ€å°ç”Ÿæˆæ£®æ—ã€‚ä»¥æœ‰çº¿ç”µè§†ç”µç¼†çš„æ¶è®¾ä¸ºä¾‹ï¼Œè‹¥åªèƒ½æ²¿ç€è¡—é“å¸ƒçº¿ï¼Œåˆ™ä»¥è¡—é“ä¸ºè¾¹ï¼Œè€Œè·¯å£ä¸ºé¡¶ç‚¹ï¼Œå…¶ä¸­å¿…ç„¶æœ‰ä¸€æœ€å°ç”Ÿæˆæ ‘èƒ½ä½¿å¸ƒçº¿æˆæœ¬æœ€ä½ã€‚ å¦‚å›¾ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªå¹³é¢å›¾ï¼Œå›¾ä¸­é»‘è‰²çº¿æè¿°çš„å°±æ˜¯æœ€å°ç”Ÿæˆæ ‘ï¼Œå®ƒçš„æƒå€¼ä¹‹å’Œå°äºå…¶ä»–çš„ç”Ÿæˆæ ‘ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•æ¥æ±‚æœ€å°ç”Ÿæˆæ ‘å‘¢ï¼Œç”±æœ€å°ç”Ÿæˆæ ‘çš„å®šä¹‰æˆ‘ä»¬å¯ä»¥çŸ¥é“æ„å»ºæœ€å°ç”Ÿæˆæ ‘æ˜¯å¯ä»¥åˆ©ç”¨è´ªå¿ƒç®—æ³•å»å®ç°çš„ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ä»‹ç»çš„ä¸¤ç§ç®—æ³•ä¹Ÿéƒ½æ˜¯åˆ©ç”¨è´ªå¿ƒç®—æ³•å»æ±‚å¾—$MST$çš„ã€‚å› ä¸ºè´ªå¿ƒç®—æ³•çš„ç­–ç•¥å°±æ˜¯åœ¨æ¯ä¸€æ­¥å°½å¯èƒ½å¤šçš„é€‰æ‹©ä¸­é€‰æ‹©æœ€ä¼˜çš„ï¼Œåœ¨å½“å‰çœ‹æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œè¿™ç§ç­–ç•¥è™½ç„¶ä¸€èˆ¬ä¸èƒ½åœ¨å…¨å±€ä¸­å¯»æ‰¾åˆ°æœ€ä¼˜è§£ï¼Œä½†æ˜¯å¯¹äºæœ€å°ç”Ÿæˆæ ‘é—®é¢˜æ¥è¯´ï¼Œå®ƒçš„ç¡®å¯ä»¥æ‰¾åˆ°ä¸€é¢—æƒé‡æœ€å°çš„æ ‘ã€‚ ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:1:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 Primç®—æ³• ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:0","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.1 ç®€ä»‹ æ™®é‡Œå§†ç®—æ³•ï¼ˆPrimâ€™s algorithmï¼‰ï¼Œå›¾è®ºä¸­çš„ä¸€ç§ç®—æ³•ï¼Œå¯åœ¨åŠ æƒè¿é€šå›¾é‡Œæœç´¢æœ€å°ç”Ÿæˆæ ‘ã€‚æ„å³ç”±æ­¤ç®—æ³•æœç´¢åˆ°çš„è¾¹å­é›†æ‰€æ„æˆçš„æ ‘ä¸­ï¼Œä¸ä½†åŒ…æ‹¬äº†è¿é€šå›¾é‡Œçš„æ‰€æœ‰é¡¶ç‚¹ï¼Œä¸”å…¶æ‰€æœ‰è¾¹çš„æƒå€¼ä¹‹å’Œäº¦ä¸ºæœ€å°ã€‚è¯¥ç®—æ³•äº1930å¹´ç”±æ·å…‹æ•°å­¦å®¶æ²ƒä¼Šæ·èµ«Â·äºšå°”å°¼å…‹å‘ç°ï¼›å¹¶åœ¨1957å¹´ç”±ç¾å›½è®¡ç®—æœºç§‘å­¦å®¶ç½—ä¼¯ç‰¹Â·æ™®é‡Œå§†ç‹¬ç«‹å‘ç°ï¼›1959å¹´ï¼Œè‰¾å…¹æ ¼Â·è¿ªç§‘æ–¯å½»å†æ¬¡å‘ç°äº†è¯¥ç®—æ³•ã€‚å› æ­¤ï¼Œåœ¨æŸäº›åœºåˆï¼Œæ™®é‡Œå§†ç®—æ³•åˆè¢«ç§°ä¸ºDJPç®—æ³•ã€äºšå°”å°¼å…‹ç®—æ³•æˆ–æ™®é‡Œå§†ï¼äºšå°”å°¼å…‹ç®—æ³•ã€‚ï¼ˆæ¥æºäºç»´åŸºç™¾ç§‘ï¼‰ ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:1","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.2 å…·ä½“æ­¥éª¤ Primç®—æ³•æ˜¯åˆ©ç”¨è´ªå¿ƒç®—æ³•å®ç°çš„ï¼Œæˆ‘ä»¬ç¡®å®šæ ¹èŠ‚ç‚¹ï¼Œä»è¿™ä¸ªç»“ç‚¹å‡ºå‘ã€‚æ™®é‡Œå§†ç®—æ³•æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤é€æ­¥æ‰©å¤§æ ‘ä¸­æ‰€å«é¡¶ç‚¹çš„æ•°ç›®ï¼Œç›´åˆ°éåŠè¿é€šå›¾çš„æ‰€æœ‰é¡¶ç‚¹ã€‚ä¸‹é¢æè¿°æˆ‘ä»¬å‡è®¾$N=(V,E)$æ˜¯è¿é€šç½‘ï¼Œ$TE$æ˜¯$N$ä¸Šæœ€å°ç”Ÿæˆæ ‘ä¸­è¾¹çš„é›†åˆã€‚ â‘  $U={u_0}(u_0âˆˆV) ,TE= {}$ã€‚ â€‹ â‘¡ åœ¨æ‰€æœ‰$uâˆˆU,vâˆˆ(V-U)$çš„è¾¹$(u,v)âˆˆE$æ‰¾åˆ°ä¸€æ¡æƒå€¼æœ€å°çš„è¾¹$(u_0,v_0)$å¹¶å…¥é›†åˆ$TE$ï¼ŒåŒæ—¶$v_0$å¹¶å…¥é›†åˆ$U$ã€‚ â‘¢ é‡å¤â‘¡æ­¥éª¤ï¼ŒçŸ¥é“$U=V$ä¸ºæ­¢ã€‚ æ­¤æ—¶$TE$ä¸­å¿…æœ‰$n-1$æ¡è¾¹ï¼Œåˆ™$T=(V,TE)$å³ä¸ºæˆ‘ä»¬æ±‚å¾—çš„$N$çš„æœ€å°ç”Ÿæˆæ ‘ã€‚ ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:2","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.3 ç®—æ³•ç¤ºä¾‹å›¾ ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:3","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.4 ç®—æ³•å®ç° æˆ‘ä»¬å¦‚æœå¯¹Dijkstraç®—æ³•å¾ˆç†Ÿæ‚‰çš„è¯ï¼ŒPrimç®—æ³•ä¹Ÿå¾ˆå¥½å®ç°äº†ï¼Œå®ƒä»¬éƒ½æ˜¯åˆ©ç”¨äº†ä¸€æ ·çš„æ€è·¯ï¼Œä½†å´ä¸ç›¸åŒã€‚æˆ‘ä»¬ç”¨åˆ©ç”¨$lowcost$æ•°ç»„æ¥è¡¨ç¤ºåˆ°é›†åˆä¸­æœ€è¿‘çš„è·ç¦»ï¼Œç”¨$closest$æ•°ç»„æ¥è¡¨ç¤ºæœ€å°ç”Ÿæˆæ ‘çš„è¾¹ã€‚æ€ä¹ˆæ¥è¡¨ç¤ºå‘¢ï¼Ÿæˆ‘ä»¬ç”¨é¡¶ç‚¹æ¥å½¢å®¹è¾¹ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯$closet$æ•°ç»„ã€‚å…¶ä¸­$closest[i]$è¡¨ç¤ºçš„å€¼å°±æ˜¯ä¸$i$é¡¶ç‚¹ç›¸é‚»è¾¹çš„é¡¶ç‚¹åºå·ã€‚å…·ä½“çœ‹ä»£ç ï¼ˆé™„å¸¦æ‰“å°æœ€å°ç”Ÿæˆæ ‘ä»£ç ï¼‰ã€‚ #include\u003cbits/stdc++.h\u003e //POJä¸æ”¯æŒ #define rep(i,a,n) for (int i=a;i\u003c=n;i++)//iä¸ºå¾ªç¯å˜é‡ï¼Œaä¸ºåˆå§‹å€¼ï¼Œnä¸ºç•Œé™å€¼ï¼Œé€’å¢ #define per(i,a,n) for (int i=a;i\u003e=n;i--)//iä¸ºå¾ªç¯å˜é‡ï¼Œ aä¸ºåˆå§‹å€¼ï¼Œnä¸ºç•Œé™å€¼ï¼Œé€’å‡ã€‚ #define pb push_back #define IOS ios::sync_with_stdio(false);cin.tie(0); cout.tie(0) #define fi first #define se second #define mp make_pair using namespace std; const int inf = 0x3f3f3f3f;//æ— ç©·å¤§ const int maxn = 1e3;//æœ€å¤§å€¼ã€‚ typedef long long ll; typedef long double ld; typedef pair\u003cll, ll\u003e pll; typedef pair\u003cint, int\u003e pii; //*******************************åˆ†å‰²çº¿ï¼Œä»¥ä¸Šä¸ºè‡ªå®šä¹‰ä»£ç æ¨¡æ¿***************************************// int n,m;//å›¾çš„å¤§å°å’Œè¾¹æ•°ã€‚ int graph[maxn][maxn];//å›¾ int lowcost[maxn],closest[maxn];//lowcost[i]è¡¨ç¤ºiåˆ°è·ç¦»é›†åˆæœ€è¿‘çš„è·ç¦»ï¼Œclosest[i]è¡¨ç¤ºiä¸ä¹‹ç›¸è¿è¾¹çš„é¡¶ç‚¹åºå·ã€‚ int sum;//è®¡ç®—æœ€å°ç”Ÿæˆæ ‘çš„æƒå€¼æ€»å’Œã€‚ void Prim(int s){ //åˆå§‹åŒ–æ“ä½œï¼Œè·å–åŸºæœ¬ä¿¡æ¯ã€‚ rep(i,1,n){ if(i==s) lowcost[i]=0; else lowcost[i]=graph[s][i]; closest[i]=s; } int minn,pos;//è·ç¦»é›†åˆæœ€è¿‘çš„è¾¹ï¼Œposä»£è¡¨è¯¥ç‚¹çš„ç»ˆè¾¹ä¸‹æ ‡ã€‚ sum=0; rep(i,1,n){ minn=inf; rep(j,1,n){ //æ‰¾å‡ºè·ç¦»ç‚¹é›†åˆæœ€è¿‘çš„è¾¹ã€‚ if(lowcost[j]!=0\u0026\u0026lowcost[j]\u003cminn){ minn=lowcost[j]; pos=j; } } if(minn==inf)break;//è¯´æ˜æ²¡æœ‰æ‰¾åˆ°ã€‚ sum+=minn;//è®¡ç®—æœ€å°ç”Ÿæˆæ ‘çš„æƒå€¼ä¹‹å’Œã€‚ lowcost[pos]=0;//åŠ å…¥ç‚¹é›†åˆã€‚ rep(j,1,n){ //ç”±äºç‚¹é›†åˆä¸­åŠ å…¥äº†æ–°çš„ç‚¹ï¼Œæˆ‘ä»¬è¦å»æ›´æ–°ã€‚ if(lowcost[j]!=0\u0026\u0026graph[pos][j]\u003clowcost[j]){ lowcost[j]=graph[pos][j]; closest[j]=pos;//æ”¹å˜ä¸é¡¶ç‚¹jç›¸è¿çš„é¡¶ç‚¹åºå·ã€‚ } } } cout\u003c\u003csum\u003c\u003cendl;//closestæ•°ç»„å°±æ˜¯æˆ‘ä»¬è¦çš„æœ€å°ç”Ÿæˆæ ‘ã€‚å®ƒä»£è¡¨çš„å°±æ˜¯è¾¹ã€‚ } void print(int s){ //æ‰“å°æœ€å°ç”Ÿæˆæ ‘ã€‚ int temp; rep(i,1,n){ //ç­‰äºsè‡ªç„¶ä¸ç®—ï¼Œæ•…é™¤å»è¿™ä¸ªä¸ºn-1æ¡è¾¹ã€‚ if(i!=s){ temp=closest[i]; cout\u003c\u003ctemp\u003c\u003c\"-\u003e\"\u003c\u003ci\u003c\u003c\"è¾¹æƒå€¼ä¸ºï¼š\"\u003c\u003cgraph[temp][i]\u003c\u003cendl; } } } int main(){ //freopen(\"in.txt\", \"r\", stdin);//æäº¤çš„æ—¶å€™è¦æ³¨é‡Šæ‰ IOS; while(cin\u003e\u003en\u003e\u003em){ memset(graph,inf,sizeof(graph));//åˆå§‹åŒ–ã€‚ int u,v,w;//ä¸´æ—¶å˜é‡ã€‚ rep(i,1,m){ cin\u003e\u003eu\u003e\u003ev\u003e\u003ew; //è§†æƒ…å†µè€Œè®ºï¼Œæˆ‘è¿™é‡Œä»¥æ— å‘å›¾ä¸ºä¾‹ã€‚ graph[u][v]=graph[v][u]=w; } //ä»»å–æ ¹ç»“ç‚¹ï¼Œæˆ‘è¿™é‡Œé»˜è®¤å–1. Prim(1); print(1);//æ‰“å°æœ€å°ç”Ÿæˆæ ‘ã€‚ } return 0; } ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:4","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.5 ç®—æ³•åˆ†æ å¯¹äºæ­¤ç®—æ³•ï¼Œæˆ‘ä»¬å›¾ä¸­æœ‰$n$ä¸ªé¡¶ç‚¹ï¼Œåˆ™ç¬¬ä¸€ä¸ªè¿›è¡Œåˆå§‹åŒ–çš„å¾ªç¯è¯­å¥çš„é¢‘åº¦ä¸º$n$,ç¬¬äºŒä¸ªå¾ªç¯è¯­å¥çš„é¢‘åº¦ä¸º$n$ï¼Œä½†å…¶ä¸­ç¬¬äºŒä¸ªå¾ªç¯ä¸­æœ‰ä¸¤ä¸ªå†…å¾ªç¯ï¼šç¬¬ä¸€ä¸ªæ˜¯åœ¨$lowcost$ä¸­æ±‚æœ€å°å€¼ï¼Œå…¶é¢‘åº¦ä¸º$n$ï¼Œç¬¬äºŒä¸ªæ˜¯é‡æ–°é€‰æ‹©å…·æœ‰æœ€å°æƒå€¼çš„è¾¹ï¼Œé¢‘åº¦ä¸º$n$ï¼Œç”±æ­¤æˆ‘ä»¬å¯çŸ¥Primç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œä¸å›¾ä¸­çš„è¾¹æ•°æ— å…³ï¼Œæ•…ååˆ†é€‚åˆäºç¨ å¯†å›¾ã€‚ ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:5","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.6 æµ‹è¯• æˆ‘ä»¬ç”¨ç¤ºä¾‹æ¥æµ‹è¯•ï¼š 7 11 1 2 7 1 4 5 2 4 9 2 3 8 2 5 7 4 5 15 4 6 6 6 7 11 5 6 8 5 7 9 3 5 5 æµ‹è¯•ç»“æœå¦‚å›¾ï¼š ","date":"2020-07-29","objectID":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:6","tags":["æœ€å°ç”Ÿæˆæ ‘"],"title":"Primç®—æ³•è¯¦è§£","uri":"/posts/04.prim%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 ç®€ä»‹ Floydç®—æ³•åˆç§°ä¸ºæ’ç‚¹æ³•ï¼Œæ˜¯ä¸€ç§åˆ©ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³å¯»æ‰¾ç»™å®šçš„åŠ æƒå›¾ä¸­å¤šæºç‚¹ä¹‹é—´æœ€çŸ­è·¯å¾„çš„ç®—æ³•ï¼Œå¯ä»¥æ­£ç¡®å¤„ç†æœ‰å‘å›¾æˆ–æ— å‘å›¾æˆ–è´Ÿæƒï¼ˆä½†ä¸å¯å­˜åœ¨è´Ÿæƒå›è·¯)çš„æœ€çŸ­è·¯å¾„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿè¢«ç”¨äºè®¡ç®—æœ‰å‘å›¾çš„ä¼ é€’é—­åŒ…ã€‚è¯¥ç®—æ³•åç§°ä»¥åˆ›å§‹äººä¹‹ä¸€ã€1978å¹´å›¾çµå¥–è·å¾—è€…ã€æ–¯å¦ç¦å¤§å­¦è®¡ç®—æœºç§‘å­¦ç³»æ•™æˆç½—ä¼¯ç‰¹Â·å¼—æ´›ä¼Šå¾·å‘½åã€‚ ","date":"2020-07-27","objectID":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:1:0","tags":["æœ€çŸ­è·¯"],"title":"Floydç®—æ³•æ•™ç¨‹","uri":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 ç®—æ³•åŸç† åœ¨ç»™å‡ºçš„ä¸€å¼ å…·æœ‰æƒå€¼å›¾ä¸­ï¼Œæˆ‘ä»¬å·²çŸ¥æ¯ä¸ªé¡¶ç‚¹vä¸æ¯ä¸ªé¡¶ç‚¹uä¸­çš„æœ€çŸ­è·ç¦»(å³ä½¿æ— æ³•åˆ°è¾¾ï¼Œæˆ‘ä»¬ä¹Ÿè®¤ä¸ºæ˜¯æœ‰è·ç¦»çš„ï¼Œä½†è·ç¦»ä¸ºæ— ç©·å¤§ï¼‰ã€‚å¯¹äºæœ€çŸ­è·ç¦»è¡¨ç¤ºï¼Œæˆ‘ä»¬ç”¨dis[v][u]æ¥è¡¨ç¤ºé¡¶ç‚¹våˆ°é¡¶ç‚¹uçš„æœ€çŸ­è·ç¦»ï¼Œä¸€å¼€å§‹æ²¡è¿›è¡Œä»»ä½•æ“ä½œæ—¶ï¼Œåˆ™è¡¨ç¤ºä»–ä»¬çš„æœ€çŸ­è·ç¦»ï¼Œå°±æ˜¯é¡¶ç‚¹våˆ°è¾¾é¡¶ç‚¹uçš„ç›´æ¥è·ç¦»ã€‚ OKï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ç°åœ¨æœ‰ä¸€ä¸ªä¸­è½¬ç«™ï¼ˆä¸­è½¬é¡¶ç‚¹tempï¼‰ï¼Œæˆ‘å…ˆä»é¡¶ç‚¹våˆ°è¾¾é¡¶ç‚¹tempï¼Œå†ä»é¡¶ç‚¹tempåˆ°è¾¾é¡¶ç‚¹uï¼Œåˆ™è¿™æ®µè·ç¦»æˆ‘ä»¬å¯ä»¥è¡¨ç¤ºä¸ºdis[v][temp]+dis[temp][u]ï¼Œå¦‚æœè¿™æ®µè·ç¦»æ¯”æˆ‘ä»¬ç›®å‰çš„ç›´æ¥åˆ°è¾¾æ–¹å¼æ›´å°çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸å°±å¯ä»¥æ›´æ–°æˆ‘ä»¬çš„æœ€çŸ­è·ç¦»dis[v][u]äº†å—ï¼Ÿé‚£ä¹ˆtempè¿™ä¸ªä¸­è½¬é¡¶ç‚¹å¯ä»¥æ˜¯å›¾ä¸­çš„æ‰€æœ‰é¡¶ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ–­æŠŠæ‰€æœ‰é¡¶ç‚¹æ’å…¥ä½œä¸ºä¸­è½¬é¡¶ç‚¹ï¼Œå†ä¸æ–­æ›´æ–°æœ€çŸ­è·ç¦»ï¼Œæœ€åï¼Œå¾—åˆ°çš„dis[n][n]è‡ªç„¶æ˜¯å¤šæºç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„äº†ã€‚æˆ‘ä»¬ç”±ä¸Šè¿°æ¨å¯¼ä¹Ÿå¯æ±‚å¾—æˆ‘ä»¬çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹dis[v][u]=min(dis[v][u],dis[v][temp]+dis[temp][u])ï¼Œè¿™å°±æ˜¯Floydç®—æ³•çš„æ€æƒ³ä¸åŸç†ï¼Œä¸æ–­æ’å…¥ä¸­è½¬é¡¶ç‚¹ï¼Œåˆ©ç”¨åŠ¨æ€è§„åˆ’æ€æƒ³æ¥å®ç°ã€‚ è¿™é‡Œæˆ‘ä»¬è¿˜è¦è®°å½•æœ€çŸ­è·¯å¾„çš„æ–¹æ¡ˆï¼Œé’ˆå¯¹æœ‰äº›è¦æ±‚æœ€çŸ­è·¯å¾„æ–¹æ¡ˆçš„é¢˜ï¼Œæˆ‘ä»¬ç”¨path[v][u]çš„å€¼æ¥è®°å½•é¡¶ç‚¹våˆ°é¡¶ç‚¹uçš„ä¸­è½¬é¡¶ç‚¹ï¼Œè‹¥ä¸º-1åˆ™è¡¨ç¤ºæ— ä¸­è½¬é¡¶ç‚¹ã€‚ ","date":"2020-07-27","objectID":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:2:0","tags":["æœ€çŸ­è·¯"],"title":"Floydç®—æ³•æ•™ç¨‹","uri":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 é‚»æ¥çŸ©é˜µè§£é¢˜æ¨¡æ¿ å­˜å‚¨ç»“æ„ï¼š const int maxn=1000;//maxnè¡¨ç¤ºå›¾çš„æœ€å¤§é¡¶ç‚¹æ•° int graph[maxn][maxn]; int n;//å›¾çš„å®é™…é¡¶ç‚¹æ•° int dis[maxn][maxn];//æœ€çŸ­è·ç¦» const int inf=0x3f3f3f3f;//ä»£è¡¨æ— ç©·å¤§ int path[maxn][maxn];//è®°å½•ä¸­è½¬é¡¶ç‚¹ //Floydç®—æ³•æ ¸å¿ƒ void floyd(int n){ //é¡¶ç‚¹æ•°ç›®ã€‚ int i,j,k;//å¾ªç¯å˜é‡ã€‚ memset(dis,inf,sizeof(dis));//è°ƒç”¨è¿™ä¸ªå‡½æ•°éœ€åŒ…å«memory.hå¤´æ–‡ä»¶ memset(path,-1,sizeof(path)); for(i=0;i\u003cn;i++){ for(int j=0;j\u003cn;j++){ //åˆå§‹åŒ–disã€‚ dis[i][j]=graph[i][j]; } } for(k=0;k\u003cn;k++){ //ä¸æ–­æ’ç‚¹ for(i=0;i\u003cn;i++){ for(j=0;j\u003cn;j++){ //å¯¹å›¾ä¸­æ‰€æœ‰ç‚¹ä¹‹é—´çš„æœ€çŸ­è·ç¦»è¿›è¡Œæ›´æ–°ã€‚ if(dis[i][j]\u003edis[i][k]+dis[k][j]){ path[i][j]=k;//è®°å½•ä¸­è½¬é¡¶ç‚¹ã€‚ dis[i][j]=dis[i][k]+dis[k][j];//æ›´æ–°ã€‚ } } } } } æˆ‘ä»¬ç°åœ¨æ¥è¾“å‡ºæœ€çŸ­è·¯å¾„ï¼Œç”±äºæˆ‘ä»¬è®°å½•äº†ä¸­è½¬é¡¶ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å€ŸåŠ©æˆ‘ä»¬æ±‚å¾—çš„pathæ•°ç»„æ¥å®ç°ã€‚å¦‚æœpath[i][j]çš„å€¼ä¸ä¸º-1çš„è¯ï¼Œè¯´æ˜è¿™ä¸ªå€¼å°±ä¸ºä¸­è½¬é¡¶ç‚¹ï¼Œå¯è¿™æ ·æœ€çŸ­è·¯å¾„å°±æ±‚å‡ºæ¥äº†å—ï¼Ÿæ˜¾ç„¶ä¸æ˜¯ï¼Œæˆ‘ä»¬è¿˜è¦ç»§ç»­åˆ¤æ–­iå’Œkä¹‹é—´ä»¥åŠkå’Œjä¹‹é—´æœ‰æ²¡æœ‰ä¸­è½¬é¡¶ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é€’å½’æ€æƒ³æ¥å®ç°è¿™ä¸ªæ–¹æ³•è¾“å‡ºæœ€çŸ­è·¯å¾„ã€‚ void print_path(int i,int j){ int k=path[i][j]; if(k==-1) //è¯´æ˜æ²¡æœ‰ä¸­è½¬é¡¶ç‚¹ï¼Œç›´æ¥è¿”å›. return; print_path(i,k);//å¯»æ‰¾iå’Œkä¹‹é—´ cout\u003c\u003ck\u003c\u003c\",\"; print_path(k,j);//å¯»æ‰¾kå’Œjä¹‹é—´ } æœ€åï¼Œå†è®¾ç½®ä¸€ä¸ªæ‰“å°æˆ‘ä»¬æ‰€æ±‚çš„ç»“æœçš„æ–¹æ³•ï¼Œæ¯”è¾ƒç®€å•ï¼Œæ ¸å¿ƒå°±æ˜¯ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ã€‚ void print_result(){ int i,j; for(i=0;i\u003cn;i++){ for(j=0;j\u003cn;j++){ if(dis[i][j]==inf){ //æˆ‘ä»¬å…ˆå‰è¯´è¿‡ï¼Œæ— æ³•åˆ°è¾¾æˆ‘ä»¬è®¾ç½®è·ç¦»ä¸ºæ— ç©·å¤§ï¼Œåˆ™ä»–ä»¬ä¹‹å‰æ²¡æœ‰è·¯å¾„ cout\u003c\u003ci\u003c\u003c\"å’Œ\"\u003c\u003cj\u003c\u003c\"ä¹‹é—´æ²¡æœ‰è·¯å¾„\"\u003c\u003cendl; } else{ cout\u003c\u003ci\u003c\u003c\"å’Œ\"\u003c\u003cj\u003c\u003c\"çš„æœ€çŸ­è·¯å¾„ä¸º\"\u003c\u003cdis[i][j]\u003c\u003cendl; cout\u003c\u003c\"è·¯å¾„æ–¹æ¡ˆä¸ºï¼š\"\u003c\u003ci\u003c\u003c\",\"; print_path(i,j); cout\u003c\u003cj\u003c\u003cendl; } } } } ","date":"2020-07-27","objectID":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:3:0","tags":["æœ€çŸ­è·¯"],"title":"Floydç®—æ³•æ•™ç¨‹","uri":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"4 é‚»æ¥è¡¨è§£é¢˜æ¨¡æ¿ å­˜å‚¨ç»“æ„ï¼š const int maxn=1000; typedef struct arc{ //è¾¹çš„ä¿¡æ¯ int adjust;//è¯¥è¾¹æ‰€æŒ‡å‘çš„é¡¶ç‚¹ã€‚ int weight;//è¯¥è¾¹çš„æƒå€¼ã€‚ struct arc *next;//æŒ‡å‘ä¸€æ¡è¾¹ã€‚ }arc,*arclink; typedef struct vex{ arclink firstarc;//è¯¥é¡¶ç‚¹çš„ç¬¬ä¸€æ¡è¾¹ã€‚ }vex,vexs[maxn]; typedef struct graph{ vexs adj; int arcnum;//è¾¹æ•° int vexnum;//é¡¶ç‚¹æ•° }graph; graph G; //åˆå§‹åŒ–æ“ä½œå°±ä¸åœ¨è¿™å†™äº†ï¼Œæœ€çŸ­è·ç¦»è¿˜æ˜¯ç”¨dis[maxn][maxn]è¡¨ç¤ºï¼Œä¸­è½¬ç«™é¡¶ç‚¹ç”¨path[maxn][maxn]æ¯•ç«Ÿæˆ‘ä»¬çš„æ ¸å¿ƒæ˜¯è§£å†³Floydç®—æ³•ã€‚ void floyd(){ int i,j,k; //åˆå§‹åŒ–dis for(i=0;i\u003cG.vexnum;i++){ for(j=0;j\u003cG.vexnum;j++){ if(i==j)dis[i][j]=0; else dis[i][j]=inf; } } memset(path,-1,sizeof(path));//åˆå§‹åŒ–pathæ•°ç»„ arclink *p;//è¾…åŠ©ä½œç”¨ for(i=0;i\u003cG.vexnum;i++){ p=G.adj[i].firstarc; while(p){ //æ­¤æ“ä½œæ˜¯ä¸ºäº†è®°å½•æ‰€æœ‰é¡¶ç‚¹ä¹‹é—´çš„è·ç¦» dis[i][s-\u003eadjust]=s-\u003ewight; s=s-\u003enext; } } //åˆ°äº†è¿™ä¸€æ­¥ï¼Œå°±è·Ÿä¸Šé¢çš„æ˜¯ä¸€æ ·äº†ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»å¾—åˆ°äº†disæ•°ç»„å’Œpathæ•°ç»„çš„å€¼äº†ã€‚ä¸‹é¢åˆ©ç”¨dpå¹¶è®°å½•ä¸­è½¬é¡¶ç‚¹ï¼ŒåŒç§å¥—è·¯ã€‚ } ","date":"2020-07-27","objectID":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/:4:0","tags":["æœ€çŸ­è·¯"],"title":"Floydç®—æ³•æ•™ç¨‹","uri":"/posts/01.floyd%E7%AE%97%E6%B3%95%E6%95%99%E7%A8%8B/"},{"categories":["æŠ€å·§"],"content":"1 èœå•æ  æ–‡ä»¶ï¼šalt+F ç¼–è¾‘ï¼šalt+E æ®µè½ï¼šalt+P æ ¼å¼ï¼šalt+O è§†å›¾ï¼šalt+V ä¸»é¢˜ï¼šalt+T å¸®åŠ©ï¼šalt+H ","date":"2020-07-09","objectID":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/:1:0","tags":["Typora"],"title":"Typoraå¸¸ç”¨å¿«æ·é”®","uri":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"categories":["æŠ€å·§"],"content":"2 æ–‡ä»¶æ“ä½œ æ–°å»ºï¼šCtrl+N æ–°å»ºçª—å£ï¼šCtrl+Shift+N æ‰“å¼€ï¼šCtrl+O å¿«é€Ÿæ‰“å¼€ï¼šCtrl+P ä¿å­˜ï¼šCtrl+S å¦å­˜ä¸ºï¼šCtrl+Shift+S åå¥½ï¼šCtrl+, å…³é—­ï¼šCtrl+W ","date":"2020-07-09","objectID":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/:2:0","tags":["Typora"],"title":"Typoraå¸¸ç”¨å¿«æ·é”®","uri":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"categories":["æŠ€å·§"],"content":"3 ç¼–è¾‘ æ’¤é”€ï¼šCtrl+Z é‡åšï¼šCtrl+Y å‰ªåˆ‡ï¼šCtrl+X å¤åˆ¶ï¼šCtrl+C ç²˜è´´ï¼šCtrl+V å¤åˆ¶ä¸ºMarkDownï¼šCtrl+Shift+C ç²˜è´´ä¸ºçº¯æ–‡æœ¬ï¼šCtrl+Shift+V å…¨é€‰ï¼šCtrl+A é€‰ä¸­å½“å‰è¡Œ/å¥ï¼šCtrl+L é€‰ä¸­å½“å‰æ ¼å¼æ–‡æœ¬ï¼šCtrl+E é€‰ä¸­å½“å‰è¯ï¼šCtrl+D è·³è½¬åˆ°æ–‡é¦–ï¼šCtrl+Home è·³è½¬åˆ°æ‰€é€‰å†…å®¹ï¼šCtrl+J è·³è½¬åˆ°æ–‡æœ«ï¼šCtrl+End æŸ¥æ‰¾ï¼šCtrl+F æŸ¥æ‰¾ä¸‹ä¸€ä¸ªï¼šF3 æŸ¥æ‰¾ä¸Šä¸€ä¸ªï¼šShift+F3 æ›¿æ¢ï¼šCtrl+H ","date":"2020-07-09","objectID":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/:3:0","tags":["Typora"],"title":"Typoraå¸¸ç”¨å¿«æ·é”®","uri":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"categories":["æŠ€å·§"],"content":"4 æ®µè½ æ ‡é¢˜ï¼šCtrl+1/2/3/4/5 æ®µè½ï¼šCtrl+0 å¢å¤§æ ‡é¢˜çº§åˆ«ï¼šCtrl+= å‡å°‘æ ‡é¢˜çº§åˆ«ï¼šCtrl+- è¡¨æ ¼ï¼šCtrl+T ä»£ç å—ï¼šCtrl+Shift+K å…¬å¼å—ï¼šCtrl+Shift+M å¼•ç”¨ï¼šCtrl+Shift+Q æœ‰åºåˆ—è¡¨ï¼šCtrl+Shift+[ æ— åºåˆ—è¡¨ï¼šCtrl+Shift+] å¢åŠ ç¼©è¿›ï¼šCtrl+] å‡å°‘ç¼©è¿›ï¼šCtrl+[ ","date":"2020-07-09","objectID":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/:4:0","tags":["Typora"],"title":"Typoraå¸¸ç”¨å¿«æ·é”®","uri":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"categories":["æŠ€å·§"],"content":"5 æ ¼å¼ åŠ ç²—ï¼šCtrl+B æ–œä½“ï¼šCtrl+I ä¸‹åˆ’çº¿ï¼šCtrl+U ä»£ç ï¼šCtrl+Shift+` åˆ é™¤çº¿ï¼šAlt+Shift+5 è¶…é“¾æ¥ï¼šCtrl+K å›¾åƒï¼šCtrl+Shift+I æ¸…é™¤æ ·å¼ï¼šCtrl+ ","date":"2020-07-09","objectID":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/:5:0","tags":["Typora"],"title":"Typoraå¸¸ç”¨å¿«æ·é”®","uri":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"categories":["æŠ€å·§"],"content":"6 è§†å›¾ æ˜¾ç¤ºéšè—ä¾§è¾¹æ ï¼šCtrl+Shift+L å¤§çº²è§†å›¾ï¼šCtrl+Shift+1 æ–‡æ¡£åˆ—è¡¨è§†å›¾ï¼šCtrl+Shift+2 æ–‡ä»¶æ ‘è§†å›¾ï¼šCtrl+Shift+3 æºä»£ç æ¨¡å¼ï¼šCtrl+/ ä¸“æ³¨æ¨¡å¼ï¼šF8 æ‰“å­—æœºæ¨¡å¼ï¼šF9 åˆ‡æ¢å…¨å±ï¼šF11 å®é™…å¤§å°ï¼šCtrl+Shift+0 æ”¾å¤§ï¼šCtrl+Shift+= ç¼©å°ï¼šCtrl+Shift+- åº”ç”¨å†…çª—å£åˆ‡æ¢ï¼šCtrl+Tab æ‰“å¼€DevToolsï¼šShift+F12 ","date":"2020-07-09","objectID":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/:6:0","tags":["Typora"],"title":"Typoraå¸¸ç”¨å¿«æ·é”®","uri":"/posts/02.typora%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"1 äºŒåˆ†æœç´¢å‡å¤©è¯ è½¬è‡ªï¼šlabuladong ","date":"2020-01-21","objectID":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/:1:0","tags":["æŸ¥æ‰¾"],"title":"äºŒåˆ†æŸ¥æ‰¾çš„å¥‡æŠ€æ·«å·§","uri":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2 æ‰‹å†™äºŒåˆ†æŸ¥æ‰¾æ¨¡æ¿ äºŒåˆ†æ¨¡æ¿ä¸€å…±æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«é€‚ç”¨äºä¸åŒæƒ…å†µã€‚ ç®—æ³•æ€è·¯ï¼šå‡è®¾ç›®æ ‡å€¼åœ¨é—­åŒºé—´$[l, r]$ä¸­ï¼Œ æ¯æ¬¡å°†åŒºé—´é•¿åº¦ç¼©å°ä¸€åŠï¼Œå½“$l = r$æ—¶ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†ç›®æ ‡å€¼ã€‚ ","date":"2020-01-21","objectID":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/:2:0","tags":["æŸ¥æ‰¾"],"title":"äºŒåˆ†æŸ¥æ‰¾çš„å¥‡æŠ€æ·«å·§","uri":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.1 ç‰ˆæœ¬1 å½“æˆ‘ä»¬å°†åŒºé—´$[l, r]$åˆ’åˆ†æˆ$[l, mid]$å’Œ$[mid + 1, r]$æ—¶ï¼Œå…¶æ›´æ–°æ“ä½œæ˜¯$r = mid$æˆ–è€…$l = mid + 1$;ï¼Œè®¡ç®—$mid$æ—¶ä¸éœ€è¦åŠ $1$ã€‚ bool check(int x) { ... ... } int binary_search_1(int l, int r) { while (l \u003c r) { int mid = (l + r) \u003e\u003e 1; if (check(mid)) { r = mid; } else { l = mid + 1; } } return l; } ","date":"2020-01-21","objectID":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/:2:1","tags":["æŸ¥æ‰¾"],"title":"äºŒåˆ†æŸ¥æ‰¾çš„å¥‡æŠ€æ·«å·§","uri":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"2.2 ç‰ˆæœ¬2 å½“æˆ‘ä»¬å°†åŒºé—´$[l, r]$åˆ’åˆ†æˆ$[l, mid-1]$å’Œ$[mid, r]$æ—¶ï¼Œå…¶æ›´æ–°æ“ä½œæ˜¯$r = mid - 1$æˆ–è€…$l = mid$;ï¼Œæ­¤æ—¶ä¸ºäº†é˜²æ­¢æ­»å¾ªç¯ï¼Œè®¡ç®—$mid$æ—¶éœ€è¦åŠ $1$ã€‚ bool check(int x) { ... ... } int binary_search_2(int l, int r) { while (l \u003c r) { int mid = (l + r + 1) \u003e\u003e 1; if (check(mid)) { // checkä¸ºåˆ¤æ–­å‡½æ•°ï¼Œæˆ‘ä»¬è‡ªå·±æ‰‹å†™çš„è§„åˆ™ l = mid; } else { r = mid - 1; } } return l; } ","date":"2020-01-21","objectID":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/:2:2","tags":["æŸ¥æ‰¾"],"title":"äºŒåˆ†æŸ¥æ‰¾çš„å¥‡æŠ€æ·«å·§","uri":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3 åˆ©ç”¨C++è‡ªå¸¦çš„lower_boundå’Œupper_boundå‡½æ•° ","date":"2020-01-21","objectID":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/:3:0","tags":["æŸ¥æ‰¾"],"title":"äºŒåˆ†æŸ¥æ‰¾çš„å¥‡æŠ€æ·«å·§","uri":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.1 è‡ªå¸¦å‡½æ•°æºç  lower_boundï¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æŒ‡å‘[first, last)ä¸å°äºvalçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœèŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ æ¯”è¾ƒå°äºvalï¼Œåˆ™å‡½æ•°è¿”å›lastã€‚ template \u003cclass ForwardIterator, class T\u003e ForwardIterator lower_bound (ForwardIterator first, ForwardIterator last, const T\u0026 val) { ForwardIterator it; iterator_traits\u003cForwardIterator\u003e::difference_type count, step; count = distance(first,last); while (count\u003e0) { it = first; step=count/2; advance (it,step); if (*it\u003cval) { // or: if (comp(*it,val)), for version (2) first=++it; count-=step+1; } else count=step; } return first; } upper_boundï¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æŒ‡å‘[first, last)å¤§äºvalçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœèŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ æ¯”è¾ƒéƒ½ä¸å¤§äºvalï¼Œåˆ™å‡½æ•°è¿”å›lastã€‚ template \u003cclass ForwardIterator, class T\u003e ForwardIterator upper_bound (ForwardIterator first, ForwardIterator last, const T\u0026 val) { ForwardIterator it; iterator_traits\u003cForwardIterator\u003e::difference_type count, step; count = std::distance(first,last); while (count\u003e0) { it = first; step=count/2; std::advance (it,step); if (!(val\u003c*it)) // or: if (!comp(val,*it)), for version (2) { first=++it; count-=step+1; } else count=step; } return first; } æ ¹æ®æºç ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥ä½¿ç”¨å®ƒä»¬ï¼Œä¸ç”¨è‡ªå·±æ‰‹å†™äº†ï¼Œä½†å¦‚æœéœ€è¦è‡ªå®šä¹‰æ¯”è¾ƒè§„åˆ™ï¼Œå®é™…ä¸Šå°±æ˜¯éœ€è¦æˆ‘ä»¬å®ç°ä¸€ä¸ªcheckå‡½æ•°å³å¯ã€‚ ","date":"2020-01-21","objectID":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/:3:1","tags":["æŸ¥æ‰¾"],"title":"äºŒåˆ†æŸ¥æ‰¾çš„å¥‡æŠ€æ·«å·§","uri":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"},{"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•"],"content":"3.2 è¿›é˜¶â€”è‡ªå®šä¹‰æ¯”è¾ƒè§„åˆ™ åœ¨ C++ ä¸­æœ‰å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼Œæ— éå°±æ˜¯ä¸‰ç§æƒ…å†µï¼š å¯¹ä¸€ä¸ªè‡ªå®šä¹‰çš„ struct é‡å†™å®ƒçš„ operator \u003c æ–¹æ³• å®šä¹‰ä¸€ä¸ª``Comparator`å‡½æ•° å®šä¹‰ä¸€ä¸ªComparatorç»“æ„ä½“å¯¹è±¡ è‡ªå®šä¹‰ç»“æ„ä½“ å¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªstructï¼Œç„¶åæƒ³è¦å¯¹å…¶æ’åºåˆä¸æƒ³é¢å¤–å†™ä¸€ä¸ªæ¯”è¾ƒå™¨ï¼Œé‚£ä¹ˆæœ€å¥½å®ç°å®ƒçš„ operaotr \u003c æ–¹æ³•ã€‚ struct node{ string s; node(string s) { this-\u003es = s; } bool operator \u003c (const node \u0026a) const { // æ³¨æ„è¿™ä¸¤ä¸ªconstï¼Œå¿…é¡»è¦åŠ ä¸Šï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œå‰è€…constæ˜¯èƒ½æ¥æ”¶éconstå’Œconstçš„å®å‚ï¼Œåè€…constæ˜¯è¡¨æ˜è¯¥å‡½æ•°ä¸ä¼šä¿®æ”¹ç±»æˆå‘˜å˜é‡ã€‚ return this-\u003es.size() \u003c a.s.size(); } }; è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨äº†ã€‚å¦‚ä¸‹ï¼š vector\u003cnode\u003e v(10, node(\"111\")); int pos = lower_bound(v.begin(), v.end(), node(\"111\")) - v.begin(); å‡½æ•°æ¯”è¾ƒå™¨ å¯ä»¥é€šè¿‡ç¼–å†™ä¸€ä¸ªå¤–éƒ¨çš„æ¯”è¾ƒå™¨å‡½æ•°ï¼Œå®ç° \u003c åŠŸèƒ½ã€‚ struct node{ string s; node(string s) { this-\u003es = s; } }; bool cmp(const string \u0026s1, const string \u0026s2) { return s1.size() \u003c s2.size(); } è¿™ä¸ªé€šå¸¸ç”¨äºè‡ªå®šä¹‰æ’åºï¼Œå…¶ä»–çš„ä¼šæŠ¥é”™ï¼Œåº”è¯¥æ˜¯ä¸æ”¯æŒå‡½æ•°æ¯”è¾ƒå™¨ï¼Œè¯»è€…å¯è‡ªè¡Œå°è¯•ã€‚ vector\u003cstring\u003e v(10, \"111\"); sort(v.begin(), v.end(), cmp); å‡½æ•°å¯¹è±¡æ¯”è¾ƒå™¨ æ‰€è°“å‡½æ•°å¯¹è±¡æ˜¯æŒ‡å®ç°äº† operator () çš„ç±»æˆ–è€…ç»“æ„ä½“ã€‚å¯ä»¥ç”¨è¿™æ ·çš„ä¸€ä¸ªå¯¹è±¡æ¥ä»£æ›¿å‡½æ•°ä½œä¸ºæ¯”è¾ƒå™¨ã€‚ struct cmper { bool operator() (const string \u0026s1, const string \u0026s2) const { return s1.size() \u003c s2.size(); } }; è¿™ä¸ªé€šå¸¸ç”¨äºè‡ªå®šä¹‰æ’åºï¼Œå…¶ä»–çš„ä¼šæŠ¥é”™ï¼Œåº”è¯¥æ˜¯ä¸æ”¯æŒå‡½æ•°æ¯”è¾ƒå™¨ï¼Œè¯»è€…å¯è‡ªè¡Œå°è¯•ã€‚ vector\u003cstring\u003e v(10, \"111\"); sort(v.begin(), v.end(), cmper()); ","date":"2020-01-21","objectID":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/:3:2","tags":["æŸ¥æ‰¾"],"title":"äºŒåˆ†æŸ¥æ‰¾çš„å¥‡æŠ€æ·«å·§","uri":"/posts/01.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"}]