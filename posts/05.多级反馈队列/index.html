<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>多级反馈队列 | ZephyrHe</title><meta name=author content="HeZephyr">
<meta name=author-link content="https://github.com/HeZephyr"><meta name=description content="github地址
1 Note/Translation
  
    
  


基本规则
MLFQ有许多不同的队列，每个队列分配了不同的优先级。在任何给定时间，准备运行的作业都位于单个队列上。 MLFQ 使用优先级来决定在给定时间应运行哪个作业：选择运行具有较高优先级的作业（即较高队列上的作业）。当然，一个队列上可能有多个作业，即具有相同的优先级，这种情况则对这些工作使用RR调度。则MLFQ基本规则如下："><meta name=keywords content='OS'><meta itemprop=name content="多级反馈队列"><meta itemprop=description content="github地址
1 Note/Translation 基本规则
MLFQ有许多不同的队列，每个队列分配了不同的优先级。在任何给定时间，准备运行的作业都位于单个队列上。 MLFQ 使用优先级来决定在给定时间应运行哪个作业：选择运行具有较高优先级的作业（即较高队列上的作业）。当然，一个队列上可能有多个作业，即具有相同的优先级，这种情况则对这些工作使用RR调度。则MLFQ基本规则如下："><meta itemprop=datePublished content="2024-04-25T22:33:29+00:00"><meta itemprop=dateModified content="2024-10-15T10:56:04+00:00"><meta itemprop=wordCount content="7347"><meta itemprop=image content="https://hezephyr.github.io/images/apple-devices-preview.webp"><meta itemprop=keywords content="OS"><meta property="og:url" content="https://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/"><meta property="og:site_name" content="ZephyrHe"><meta property="og:title" content="多级反馈队列"><meta property="og:description" content="github地址
1 Note/Translation 基本规则
MLFQ有许多不同的队列，每个队列分配了不同的优先级。在任何给定时间，准备运行的作业都位于单个队列上。 MLFQ 使用优先级来决定在给定时间应运行哪个作业：选择运行具有较高优先级的作业（即较高队列上的作业）。当然，一个队列上可能有多个作业，即具有相同的优先级，这种情况则对这些工作使用RR调度。则MLFQ基本规则如下："><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-25T22:33:29+00:00"><meta property="article:modified_time" content="2024-10-15T10:56:04+00:00"><meta property="article:tag" content="OS"><meta property="og:image" content="https://hezephyr.github.io/images/apple-devices-preview.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hezephyr.github.io/images/apple-devices-preview.webp"><meta name=twitter:title content="多级反馈队列"><meta name=twitter:description content="github地址
1 Note/Translation 基本规则
MLFQ有许多不同的队列，每个队列分配了不同的优先级。在任何给定时间，准备运行的作业都位于单个队列上。 MLFQ 使用优先级来决定在给定时间应运行哪个作业：选择运行具有较高优先级的作业（即较高队列上的作业）。当然，一个队列上可能有多个作业，即具有相同的优先级，这种情况则对这些工作使用RR调度。则MLFQ基本规则如下："><meta name=application-name content="Zephyr's Blog"><meta name=apple-mobile-web-app-title content="Zephyr's Blog"><meta name=theme-color data-light=#ffffff data-dark=#252627 content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/><link rel=prev href=https://hezephyr.github.io/posts/04.cpu%E8%B0%83%E5%BA%A6/><link rel=next href=https://hezephyr.github.io/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://unpkg.com/@fortawesome/fontawesome-free@6.4.2/css/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://unpkg.com/@fortawesome/fontawesome-free@6.4.2/css/all.min.css></noscript><link rel=preload href=https://unpkg.com/animate.css@4.1.1/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://unpkg.com/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"多级反馈队列","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/hezephyr.github.io\/posts\/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97\/"},"image":[{"@type":"ImageObject","url":"https:\/\/hezephyr.github.io\/images\/apple-devices-preview.webp","width":2880,"height":1508}],"genre":"posts","keywords":"OS","wordcount":7347,"url":"https:\/\/hezephyr.github.io\/posts\/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97\/","datePublished":"2024-04-25T22:33:29+00:00","dateModified":"2024-10-15T10:56:04+00:00","license":"本站内容采用 CC BY-NC-SA 4.0 国际许可协议。","publisher":{"@type":"Organization","name":"Lruihao","logo":"https:\/\/hezephyr.github.io\/images\/avatar.jpg"},"author":{"@type":"Person","name":"HeZephyr"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title=ZephyrHe><img loading=lazy src=/images/logo.png alt=ZephyrHe data-title=ZephyrHe width=26 height=26 class=logo style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>HeZephyr</span></a><span class=header-subtitle>贺志飞的博客</span></div><nav><ul class=menu><li class="menu-item has-children"><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class=menu-item><a class=menu-link href=/friends/ title=友情链接><i class="fa-solid fa-users-viewfinder fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/guestbook/><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> 留言</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-signature fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=ZephyrHe><img loading=lazy src=/images/logo.png alt=ZephyrHe data-title=ZephyrHe width=26 height=26 class=logo style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>HeZephyr</span></a><span class=header-subtitle>贺志飞的博客</span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li></ul></li><li class=menu-item><a class=menu-link href=/friends/ title=友情链接><i class="fa-solid fa-users-viewfinder fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/guestbook/><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> 留言</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-signature fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item text-center"><a class=menu-link href=https://github.com/HeZephyr/HeZephyr.github.io title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=/posts/ title=Posts>文章</a></li><li class="breadcrumb-item active" aria-current=page>多级反馈队列</li></ol></nav><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name data-collections=合集>OSTEP</span>
<span class=collection-count>39</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/ title=进程介绍>进程介绍</a></li><li class=collection-item><a href=/posts/02.%E8%BF%9B%E7%A8%8Bapi/ title=进程API>进程API</a></li><li class=collection-item><a href=/posts/03.%E6%9C%89%E9%99%90%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C/ title=有限直接执行>有限直接执行</a></li><li class=collection-item><a href=/posts/04.cpu%E8%B0%83%E5%BA%A6/ title=CPU调度>CPU调度</a></li><li class=collection-item><span class=active title=多级反馈队列>多级反馈队列</span></li><li class=collection-item><a href=/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/ title=比例份额调度>比例份额调度</a></li><li class=collection-item><a href=/posts/07.%E5%A4%9Acpu%E8%B0%83%E5%BA%A6/ title=多CPU调度>多CPU调度</a></li><li class=collection-item><a href=/posts/08.%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4/ title=地址空间>地址空间</a></li><li class=collection-item><a href=/posts/09.%E5%86%85%E5%AD%98api/ title=内存API>内存API</a></li><li class=collection-item><a href=/posts/10.%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/ title=地址转换>地址转换</a></li><li class=collection-item><a href=/posts/11.%E6%AE%B5/ title=段>段</a></li><li class=collection-item><a href=/posts/12.%E7%A9%BA%E9%97%B2%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86/ title=空闲空间管理>空闲空间管理</a></li><li class=collection-item><a href=/posts/13.%E9%A1%B5/ title=页>页</a></li><li class=collection-item><a href=/posts/14.%E5%BF%AB%E8%A1%A8/ title=快表>快表</a></li><li class=collection-item><a href=/posts/15.%E9%AB%98%E7%BA%A7%E9%A1%B5%E8%A1%A8/ title=高级页表>高级页表</a></li><li class=collection-item><a href=/posts/16.%E9%A1%B5%E9%9D%A2%E4%BA%A4%E6%8D%A2/ title=页面交换>页面交换</a></li><li class=collection-item><a href=/posts/17.%E4%BA%A4%E6%8D%A2%E7%AD%96%E7%95%A5/ title=交换策略>交换策略</a></li><li class=collection-item><a href=/posts/18.%E5%AE%8C%E6%95%B4vm%E7%B3%BB%E7%BB%9F/ title=完整VM系统>完整VM系统</a></li><li class=collection-item><a href=/posts/19.%E5%B9%B6%E5%8F%91%E5%92%8C%E7%BA%BF%E7%A8%8B/ title=并发和线程>并发和线程</a></li><li class=collection-item><a href=/posts/20.%E7%BA%BF%E7%A8%8Bapi/ title=线程API>线程API</a></li><li class=collection-item><a href=/posts/21.%E9%94%81/ title=锁>锁</a></li><li class=collection-item><a href=/posts/22.%E9%94%81%E5%AE%9A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/ title=锁定数据结构>锁定数据结构</a></li><li class=collection-item><a href=/posts/23.%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F/ title=条件变量>条件变量</a></li><li class=collection-item><a href=/posts/24.%E4%BF%A1%E5%8F%B7%E9%87%8F/ title=信号量>信号量</a></li><li class=collection-item><a href=/posts/25.%E5%B9%B6%E5%8F%91bug/ title=并发bug>并发bug</a></li><li class=collection-item><a href=/posts/26.%E5%9F%BA%E4%BA%8E%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%B9%B6%E5%8F%91/ title=基于事件的并发>基于事件的并发</a></li><li class=collection-item><a href=/posts/27.io%E8%AE%BE%E5%A4%87/ title=IO设备>IO设备</a></li><li class=collection-item><a href=/posts/28.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E5%99%A8/ title=硬盘驱动器>硬盘驱动器</a></li><li class=collection-item><a href=/posts/29.%E5%BB%89%E4%BB%B7%E7%A3%81%E7%9B%98%E5%86%97%E4%BD%99%E9%98%B5%E5%88%97/ title=廉价磁盘冗余阵列>廉价磁盘冗余阵列</a></li><li class=collection-item><a href=/posts/30.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/ title=文件和目录>文件和目录</a></li><li class=collection-item><a href=/posts/31.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0/ title=文件系统实现>文件系统实现</a></li><li class=collection-item><a href=/posts/32.%E5%BF%AB%E9%80%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/ title=快速文件系统>快速文件系统</a></li><li class=collection-item><a href=/posts/33.fsck%E5%92%8C%E6%97%A5%E5%BF%97/ title=FSCK和日志>FSCK和日志</a></li><li class=collection-item><a href=/posts/34.%E6%97%A5%E5%BF%97%E7%BB%93%E6%9E%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/ title=日志结构文件系统>日志结构文件系统</a></li><li class=collection-item><a href=/posts/35.%E5%9F%BA%E4%BA%8E%E9%97%AA%E5%AD%98%E7%9A%84ssd/ title=基于闪存的SSD>基于闪存的SSD</a></li><li class=collection-item><a href=/posts/36.%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E4%BF%9D%E6%8A%A4/ title=数据完整性和保护>数据完整性和保护</a></li><li class=collection-item><a href=/posts/37.%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/ title=分布式系统>分布式系统</a></li><li class=collection-item><a href=/posts/38.%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/ title=网络文件系统>网络文件系统</a></li><li class=collection-item><a href=/posts/39.andrew%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/ title=Andrew文件系统>Andrew文件系统</a></li></ul><div class=collection-nav-simple><a href=/posts/04.cpu%E8%B0%83%E5%BA%A6/ class=collection-nav-item rel=prev title=CPU调度><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>5/39</span><a href=/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/ class=collection-nav-item rel=next title=比例份额调度><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>多级反馈队列</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/HeZephyr title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img loading=lazy src="https://cn.gravatar.com/avatar/65f6ab71abcb9d540eb32a2704884927?s=32&amp;d=mp" alt=HeZephyr data-title=HeZephyr width=20 height=20 class=avatar style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'>&nbsp;HeZephyr</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/ class=post-category title="分类 - 系统架构"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 系统架构</a> 和 <a href=/collections/ostep/ class=post-collection title="合集 - OSTEP"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> OSTEP</a></span></div><div class=post-meta-line><span title="发布于 2024-04-25 22:33:29"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2024-04-25>2024-04-25</time></span>&nbsp;<span title="更新于 2024-10-15 10:56:04"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2024-10-15>2024-10-15</time></span>&nbsp;<span title="7347 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 7400 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 15 分钟</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=多级反馈队列>
<i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ol><li><a href=#notetranslation>Note/Translation</a></li><li><a href=#program-explanation>Program Explanation</a></li><li><a href=#qa>QA</a></li></ol></nav></div></div><div class=content id=content data-end-flag="「本文完，更多内容汇总在我的 GitHub与CSDN，持续更新，求关注、求 star、求订阅！」"><p><a href=https://github.com/unique-pure/ostep/tree/main/Virtualization/05.Multi-level%20Feedback target=_blank rel="external nofollow noopener noreferrer">github地址<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p><h2 id=notetranslation class=heading-element><span>1 Note/Translation</span>
<a href=#notetranslation class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ul><li><p>基本规则</p><p>MLFQ有许多不同的队列，每个队列分配了不同的优先级。在任何给定时间，准备运行的作业都位于单个队列上。 MLFQ 使用优先级来决定在给定时间应运行哪个作业：选择运行具有较高优先级的作业（即较高队列上的作业）。当然，一个队列上可能有多个作业，即具有相同的优先级，这种情况则对这些工作使用RR调度。则MLFQ基本规则如下：</p><ul><li>$\text{Rule}\space1:\text{If Priority(A)>Priority(B),A runs (B doesn&rsquo;t).}$</li><li>$\text{Rule}\space1:\text{If Priority(A)=Priority(B),A and B run in RR.}$</li></ul></li><li><p>MLFQ例子</p><p>如果我们要展示给定时刻队列的样子，我们可能会看到如下所示的内容（图 8.1）。图中，两个作业（A 和 B）的优先级最高，作业 C 处于中间，作业 D 的优先级最低。鉴于我们目前对 MLFQ 工作原理的了解，调度程序只会在 A 和 B 之间交替时间片，因为它们是系统中优先级最高的作业；可怜的工作 C 和 D 根本无法运行！</p><img src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/MLFQ-simple-example.png alt=image-20240327093937017 style=zoom:50%></li><li><p>尝试#1：怎么改变作业的优先级</p><p>现在，我们必须决定 MLFQ 将如何在作业的生命周期内更改作业的优先级（以及它所在的队列）。为此，我们必须牢记我们的工作负载：短期运行的交互式作业（可能经常放弃 CPU），以及一些需要大量 CPU 时间但运行时间较长的“CPU 密集型”作业。其中响应时间并不重要。这是我们对优先级调整算法的第一次尝试：</p><ul><li>$\text{Rule 3: When a job enters the system, it is placed at the highest
priority (the topmost queue).}$</li><li>$\text{Rule 4a: If a job uses up an entire time slice while running, its pri-
ority is reduced (i.e., it moves down one queue).}$</li><li>$\text{Rule 4b: If a job gives up the CPU before the time slice is up, it stays
at the same priority level.}$</li></ul></li><li><p>例子#1.1：单个长时间运行的作业</p><p>首先，我们来看看当系统中有一项长期运行的工作时会发生什么情况。下图显示了在三队列调度程序中该作业随时间发生的变化。</p><img src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Long-running%20Job%20Over%20Time.png alt=image-20240327094644615 style=zoom:50%><p>如示例所示，作业以最高优先级（Q2）进入。经过 $\text{10ms}$ 的单个时间片后，调度程序将作业的优先级降低了一个，因此作业的优先级为 Q1。在 Q1 上运行一个时间片后，作业最终被降到系统中的最低优先级（Q0），并保持不变。</p></li><li><p>例子#1.2：加入一个短作业</p><p>在这个例子中，有两个作业：A是一个长期运行的CPU密集型作业，B是一个短期运行的交互作业。假设A已经运行了一段时间，然后B才到达，这样会发生什么？MLFQ是否会近似于B的SJF？</p><p>如下图所示，A（黑色显示）在最低优先级队列中运行（任何长期运行的 CPU 密集型作业都是如此）；B（灰色显示）在 T = 100 时到达，因此会插入到最高队列，由于其运行时间很短（仅20ms），B 在到达底层队列之前完成，分两个时间片；然后 A 恢复运行（低优先级）。</p><img src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Along alt=image-20240327095115109 style=zoom:50%><p>从这个例子中，你有望理解算法的一个主要目标：因为它不知道一项作业是短作业还是长期作业，所以它首先假定它可能是短作业，从而给予该作业高优先级。如果它确实是短作业，它就会快速运行并完成；如果它不是短作业，它就会在队列中缓慢移动，从而很快证明自己是一个长期运行的更类似批处理的进程。通过这种方式，MLFQ 近似于 SJF。</p></li><li><p>例子#1.3：关于I/O</p><p>如上文规则 4b 所述，如果进程在用完其时间片之前放弃了处理器，我们会将其保持在相同的优先级。这条规则的用意很简单：例如，如果一个交互式作业正在进行大量的 I/O（比如等待键盘或鼠标的用户输入），那么它就会在其时间片完成之前放弃 CPU；在这种情况下，我们不希望惩罚该作业，因此只需将其保持在同一优先级即可。</p><p>下图举例说明了这种方法的工作原理，交互式作业 B（灰色显示）只需要 CPU 1 ms，然后执行 I/O，与长期运行的批处理作业 A（黑色显示）争夺 CPU。MLFQ 方法将 B 保持在最高优先级，因为 B 一直在释放 CPU；如果 B 是交互式作业，MLFQ 将进一步实现快速运行交互式作业的目标。</p><p><a class=lightgallery href="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/A?size=large" data-thumbnail="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/A?size=small" data-sub-html="<h2>image-20240327113455587</h2>"><img loading=lazy src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/A alt=image-20240327113455587 srcset="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/A?size=small, https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/A?size=medium 1.5x, https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/A?size=large 2x" data-title=image-20240327113455587 class="suffix-invalid suffix-invalid__small suffix-invalid__large" style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'></a></p></li><li><p>我们现在设计的MLFQ存在的问题</p><p>这样，我们就有了一个基本的 MLFQ。它似乎做得相当不错，在长时间运行的作业之间公平地共享 CPU，并让短时间或 I/O 密集型交互式作业快速运行。遗憾的是，我们迄今为止开发的方法存在严重缺陷。</p><ol><li>饥饿问题：如果系统存在太多交互作业，它们将会共同消耗所有CPU时间，这样长时间运行的作业将不会获得任何CPU时间（即饥饿）。</li><li>欺骗调度程序：聪明的用户可以重写程序，玩弄调度程序。即是指偷偷摸摸地欺骗调度程序，让调度程序给你分配更多的资源。我们所描述的算法很容易受到以下攻击：在时间片结束前，进行一次 I/O 操作（对某个你并不关心的文件），从而放弃 CPU；这样做可以让你保持在同一队列中，从而获得更多的 CPU 时间。如果操作得当（例如，运行 99% 的时间片后才放弃 CPU），作业几乎可以垄断 CPU。</li><li>程序行为改变：一个程序可能会随着时间的推移而改变其行为；原来的 CPU 约束可能会过渡到交互阶段。采用我们目前的方法，这样的作业就会倒霉，不会像系统中的其他交互式作业一样得到处理。</li></ol></li><li><p>尝试#2：优先级提升</p><p>让我们试着改变规则，看看能否避免 &ldquo;饥饿 &ldquo;问题。为了保证占用 CPU 的作业能取得一些进展（即使进展不大），我们可以做些什么？简单来说，就是定期提升系统中所有作业的优先级。实现这一点的方法有很多，但我们只需做一件简单的事：把所有作业都扔到最上面的队列中；因此，我们需要一条新规则：</p><ul><li>$\text{Rule 5: After some time period S, move all the jobs in the system
to the topmost queue.}$</li></ul><p>我们的新规则同时解决了两个问题。首先，保证了进程不会饥饿：作业排在队列的最前面，就能与其他高优先级作业以循环方式共享 CPU，从而最终获得服务。其次，如果受 CPU 限制的作业已开始交互，调度程序会在其获得优先级提升后对其进行适当处理。</p></li><li><p>例子#2.1：竞争CPU</p><p>在这种情况下，我们仅展示一个长时间运行的作业与两个短时间运行的交互式作业竞争 CPU 时的行为。下图显示了两个图表。在左边，没有优先级提升，因此一旦两个短期作业到达，长期运行的作业就会陷入饥饿；右边，每 50 毫秒就有一次优先级提升（这个值可能太小，但这里用于示例），因此我们至少保证长时间运行的作业会取得一些进展，提升到每 50 毫秒设置一次最高优先级，从而定期运行。</p><img src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Without(Left)-and-With(right)-Priority-Boost.png alt=image-20240327124352031 style=zoom:50%><p>当然，增加时间段S会带来一个明显的问题：S应该设置为什么？ John Ousterhout，一位受人尊敬的系统研究员 ，过去常常将系统中的此类值称为“巫术常量”，因为它们似乎需要某种形式的黑魔法才能正确设置它们。不幸的是，S有那种味道。如果设置得太高，长时间运行的作业可能会陷入困境；太低，交互式作业可能无法获得适当的 CPU 份额。</p></li><li><p>尝试#3：更好的计算</p><p>现在，我们还有一个问题要解决：如何防止调度程序被玩弄？正如你可能已经猜到的，真正的罪魁祸首是Rule 4a 和 4b，它们允许作业在时间片到期前放弃 CPU，从而保留其优先级。那么我们该怎么办呢？解决办法是在 MLFQ 的每一级更好地计算 CPU 时间。调度程序不应该忘记进程在特定级别上使用了多少时间片，而应该进行跟踪；一旦进程用完了分配的时间片，就会被降级到下一个优先级队列。至于进程是在一个长的时间段内使用时间片，还是在许多小的时间段内使用时间片，这并不重要。因此，我们将规则 4a 和 4b 重写为以下单一规则：</p><ul><li>$\text{Rule 4: Once a job uses up its time allotment at a given level (re-
gardless of how many times it has given up the CPU), its priority is
reduced (i.e., it moves down one queue).}$</li></ul></li><li><p>例子#3.1：旧规则和新规则对比</p><p>下图显示了当工作负载试图利用旧规则 4a 和 4b（左侧）以及新的反玩弄规则 4 来玩弄调度程序时会发生的情况。如果没有任何防止玩弄的保护措施，进程可以在时间片结束前发出 I/O，从而支配 CPU 时间。有了这种保护措施，无论进程的 I/O 行为如何，它都会在队列中缓慢移动，从而无法获得不公平的 CPU 占有率。</p><p><a class=lightgallery href="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Gaming-Tolerance.png?size=large" data-thumbnail="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Gaming-Tolerance.png?size=small" data-sub-html="<h2>image-20240327125632640</h2>"><img loading=lazy src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Gaming-Tolerance.png alt=image-20240327125632640 srcset="https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Gaming-Tolerance.png?size=small, https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Gaming-Tolerance.png?size=medium 1.5x, https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Gaming-Tolerance.png?size=large 2x" data-title=image-20240327125632640 style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'></a></p><img src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Lower-Priority-Long-Quanta.png alt=image-20240327125456705 style=zoom:50%></li><li><p>调整 MLFQ 及其他问题</p><p>MLFQ 调度还存在其他一些问题。一个大问题是如何为这样的调度器设置参数。例如，应该有多少个队列？每个队列的时间片应该有多大？为了避免饥饿并考虑到行为的变化，应该多久提升一次优先级？这些问题都没有简单的答案，因此只有在工作负载方面积累一定的经验，然后对调度程序进行调整，才能取得令人满意的平衡。</p><p>例如，大多数 MLFQ 变体都允许在不同队列中使用不同的时间片长度。高优先级队列的时间片通常较短；毕竟它们由交互式作业组成，因此在它们之间快速交替是合理的（例如 10 毫秒或更少）。相比之下，低优先级队列包含的是占用 CPU 的长期运行作业；因此，较长的时间片（如 100 毫秒）也很有效。下图显示了一个例子，其中两个作业在最高队列运行 20 毫秒（时间片为 10 毫秒），在中间队列运行 40 毫秒（时间片为 20 毫秒），在最低队列运行 40 毫秒。</p><img src=https://raw.githubusercontent.com/unique-pure/NewPicGoLibrary/main/img/Lower-Priority-Long-Quanta.png alt=image-20240327125456705 style=zoom:50%><p><strong>Solaris MLFQ</strong> 实现——分时调度类（TS）——特别容易配置；它提供了一组表，可以准确确定进程的优先级在其整个生命周期中如何更改、每个时间片的长度以及提高作业优先级的频率；管理员可以修改该表以使调度程序以不同的方式运行。该表的默认值为 60 个队列，时间片长度从 20 毫秒（最高优先级）缓慢增加到几百毫秒（最低），并且优先级大约每 1 秒左右提升一次。</p><p>其他 MLFQ 调度器并不使用本章所述的表格或精确规则，而是使用数学公式来调整优先级。例如，FreeBSD 调度器（4.3 版）使用一个公式来计算作业当前的优先级，该公式基于进程使用了多少 CPU ；此外，使用率会随着时间的推移而衰减，从而以与本文所述不同的方式提供所需的优先级提升。最后，许多调度器还有一些你可能会遇到的其他功能。例如，有些调度器为操作系统工作保留最高优先级；因此，典型的用户作业永远无法获得系统中的最高优先级。有些系统还允许用户通过一些建议来帮助设置优先级；例如，通过使用命令行实用程序 nice，你可以（在一定程度上）提高或降低作业的优先级，从而增加或减少它在任何特定时间运行的机会。</p></li><li><p>MLFQ总结</p><p>我们已经描述了多级反馈队列（MLFQ）的调度方法。希望你现在能明白它为什么叫这个名字：它有多级队列，并使用反馈来确定给定作业的优先级。历史是它的指南：关注作业在一段时间内的表现，并相应地处理它们。在本章中，MLFQ 规则的精炼集在此重现，供大家欣赏：</p><ul><li>$\text{Rule 1: If Priority(A) > Priority(B), A runs (B doesn’t).}$</li><li>$\text{Rule 2: If Priority(A) = Priority(B), A and B run in round-robin fash-
ion using the time slice (quantum length) of the given queue.}$</li><li>$\text{Rule 3: When a job enters the system, it is placed at the highest
priority (the topmost queue).}$</li><li>$\text{Rule 4: Once a job uses up its time allotment at a given level (re-
gardless of how many times it has given up the CPU), its priority is
reduced (i.e., it moves down one queue).}$</li><li>$\text{Rule 5: After some time period S, move all the jobs in the system
to the topmost queue.}$</li></ul><p>MLFQ 很有趣，原因如下：它不要求先验了解作业的性质，而是观察作业的执行情况并相应地确定其优先级。通过这种方式，它成功地实现了两全其美：它可以为短时间运行的交互式作业提供出色的整体性能（类似于 SJF/STCF），并且对于长时间运行的 CPU 密集型工作负载来说，它是公平的并取得进步。因此，许多系统，包括 BSD UNIX 衍生系统 、Solaris 以及 Windows NT 和后续的 Windows 操作系统，都使用某种形式的 MLFQ 作为其基本调度程序。</p></li></ul><h2 id=program-explanation class=heading-element><span>2 Program Explanation</span>
<a href=#program-explanation class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>这个程序 mlfq.py 允许您查看本章中介绍的 MLFQ 调度程序的行为方式。和以前一样，您可以使用它来使用随机种子为自己生成问题，或者使用它构建一个精心设计的实验，以了解 MLFQ 在不同情况下的工作原理。要运行该程序，请键入：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>❯ python mlfq.py</span></span></code></pre></td></tr></table></div></div><p>使用参数-h查看选项帮助：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>❯</span> <span class=n>python</span> <span class=n>mlfq</span><span class=o>.</span><span class=n>py</span> <span class=o>-</span><span class=n>h</span>
</span></span><span class=line><span class=cl><span class=n>Usage</span><span class=p>:</span> <span class=n>mlfq</span><span class=o>.</span><span class=n>py</span> <span class=p>[</span><span class=n>options</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Options</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>h</span><span class=p>,</span> <span class=o>--</span><span class=n>help</span>            <span class=n>show</span> <span class=n>this</span> <span class=n>help</span> <span class=n>message</span> <span class=ow>and</span> <span class=n>exit</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>s</span> <span class=n>SEED</span><span class=p>,</span> <span class=o>--</span><span class=nb>seed</span><span class=o>=</span><span class=n>SEED</span>  <span class=n>the</span> <span class=n>random</span> <span class=nb>seed</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>n</span> <span class=n>NUMQUEUES</span><span class=p>,</span> <span class=o>--</span><span class=n>numQueues</span><span class=o>=</span><span class=n>NUMQUEUES</span>
</span></span><span class=line><span class=cl>                        <span class=n>number</span> <span class=n>of</span> <span class=n>queues</span> <span class=ow>in</span> <span class=n>MLFQ</span> <span class=p>(</span><span class=k>if</span> <span class=ow>not</span> <span class=n>using</span> <span class=o>-</span><span class=n>Q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>q</span> <span class=n>QUANTUM</span><span class=p>,</span> <span class=o>--</span><span class=n>quantum</span><span class=o>=</span><span class=n>QUANTUM</span>
</span></span><span class=line><span class=cl>                        <span class=n>length</span> <span class=n>of</span> <span class=n>time</span> <span class=n>slice</span> <span class=p>(</span><span class=k>if</span> <span class=ow>not</span> <span class=n>using</span> <span class=o>-</span><span class=n>Q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>a</span> <span class=n>ALLOTMENT</span><span class=p>,</span> <span class=o>--</span><span class=n>allotment</span><span class=o>=</span><span class=n>ALLOTMENT</span>
</span></span><span class=line><span class=cl>                        <span class=n>length</span> <span class=n>of</span> <span class=n>allotment</span> <span class=p>(</span><span class=k>if</span> <span class=ow>not</span> <span class=n>using</span> <span class=o>-</span><span class=n>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>Q</span> <span class=n>QUANTUMLIST</span><span class=p>,</span> <span class=o>--</span><span class=n>quantumList</span><span class=o>=</span><span class=n>QUANTUMLIST</span>
</span></span><span class=line><span class=cl>                        <span class=n>length</span> <span class=n>of</span> <span class=n>time</span> <span class=n>slice</span> <span class=n>per</span> <span class=n>queue</span> <span class=n>level</span><span class=p>,</span> <span class=n>specified</span> <span class=n>as</span>
</span></span><span class=line><span class=cl>                        <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>,</span><span class=n>z</span><span class=p>,</span><span class=o>...</span> <span class=n>where</span> <span class=n>x</span> <span class=n>is</span> <span class=n>the</span> <span class=n>quantum</span> <span class=n>length</span> <span class=k>for</span> <span class=n>the</span>
</span></span><span class=line><span class=cl>                        <span class=n>highest</span> <span class=n>priority</span> <span class=n>queue</span><span class=p>,</span> <span class=n>y</span> <span class=n>the</span> <span class=n>next</span> <span class=n>highest</span><span class=p>,</span> <span class=ow>and</span> <span class=n>so</span>
</span></span><span class=line><span class=cl>                        <span class=n>forth</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>A</span> <span class=n>ALLOTMENTLIST</span><span class=p>,</span> <span class=o>--</span><span class=n>allotmentList</span><span class=o>=</span><span class=n>ALLOTMENTLIST</span>
</span></span><span class=line><span class=cl>                        <span class=n>length</span> <span class=n>of</span> <span class=n>time</span> <span class=n>allotment</span> <span class=n>per</span> <span class=n>queue</span> <span class=n>level</span><span class=p>,</span> <span class=n>specified</span> <span class=n>as</span>
</span></span><span class=line><span class=cl>                        <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>,</span><span class=n>z</span><span class=p>,</span><span class=o>...</span> <span class=n>where</span> <span class=n>x</span> <span class=n>is</span> <span class=n>the</span> <span class=c1># of time slices for the</span>
</span></span><span class=line><span class=cl>                        <span class=n>highest</span> <span class=n>priority</span> <span class=n>queue</span><span class=p>,</span> <span class=n>y</span> <span class=n>the</span> <span class=n>next</span> <span class=n>highest</span><span class=p>,</span> <span class=ow>and</span> <span class=n>so</span>
</span></span><span class=line><span class=cl>                        <span class=n>forth</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>j</span> <span class=n>NUMJOBS</span><span class=p>,</span> <span class=o>--</span><span class=n>numJobs</span><span class=o>=</span><span class=n>NUMJOBS</span>
</span></span><span class=line><span class=cl>                        <span class=n>number</span> <span class=n>of</span> <span class=n>jobs</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>system</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>m</span> <span class=n>MAXLEN</span><span class=p>,</span> <span class=o>--</span><span class=n>maxlen</span><span class=o>=</span><span class=n>MAXLEN</span>
</span></span><span class=line><span class=cl>                        <span class=nb>max</span> <span class=n>run</span><span class=o>-</span><span class=n>time</span> <span class=n>of</span> <span class=n>a</span> <span class=n>job</span> <span class=p>(</span><span class=k>if</span> <span class=n>randomly</span> <span class=n>generating</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>M</span> <span class=n>MAXIO</span><span class=p>,</span> <span class=o>--</span><span class=n>maxio</span><span class=o>=</span><span class=n>MAXIO</span>
</span></span><span class=line><span class=cl>                        <span class=nb>max</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>frequency</span> <span class=n>of</span> <span class=n>a</span> <span class=n>job</span> <span class=p>(</span><span class=k>if</span> <span class=n>randomly</span> <span class=n>generating</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>B</span> <span class=n>BOOST</span><span class=p>,</span> <span class=o>--</span><span class=n>boost</span><span class=o>=</span><span class=n>BOOST</span>
</span></span><span class=line><span class=cl>                        <span class=n>how</span> <span class=n>often</span> <span class=n>to</span> <span class=n>boost</span> <span class=n>the</span> <span class=n>priority</span> <span class=n>of</span> <span class=n>all</span> <span class=n>jobs</span> <span class=n>back</span> <span class=n>to</span>
</span></span><span class=line><span class=cl>                        <span class=n>high</span> <span class=n>priority</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>i</span> <span class=n>IOTIME</span><span class=p>,</span> <span class=o>--</span><span class=n>iotime</span><span class=o>=</span><span class=n>IOTIME</span>
</span></span><span class=line><span class=cl>                        <span class=n>how</span> <span class=n>long</span> <span class=n>an</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>should</span> <span class=n>last</span> <span class=p>(</span><span class=n>fixed</span> <span class=n>constant</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>S</span><span class=p>,</span> <span class=o>--</span><span class=n>stay</span>            <span class=n>reset</span> <span class=ow>and</span> <span class=n>stay</span> <span class=n>at</span> <span class=n>same</span> <span class=n>priority</span> <span class=n>level</span> <span class=n>when</span> <span class=n>issuing</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>I</span><span class=p>,</span> <span class=o>--</span><span class=n>iobump</span>          <span class=k>if</span> <span class=n>specified</span><span class=p>,</span> <span class=n>jobs</span> <span class=n>that</span> <span class=n>finished</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>move</span> <span class=n>immediately</span>
</span></span><span class=line><span class=cl>                        <span class=n>to</span> <span class=n>front</span> <span class=n>of</span> <span class=n>current</span> <span class=n>queue</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>l</span> <span class=n>JLIST</span><span class=p>,</span> <span class=o>--</span><span class=n>jlist</span><span class=o>=</span><span class=n>JLIST</span>
</span></span><span class=line><span class=cl>                        <span class=n>a</span> <span class=n>comma</span><span class=o>-</span><span class=n>separated</span> <span class=n>list</span> <span class=n>of</span> <span class=n>jobs</span> <span class=n>to</span> <span class=n>run</span><span class=p>,</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>form</span>
</span></span><span class=line><span class=cl>                        <span class=n>x1</span><span class=p>,</span><span class=n>y1</span><span class=p>,</span><span class=n>z1</span><span class=p>:</span><span class=n>x2</span><span class=p>,</span><span class=n>y2</span><span class=p>,</span><span class=n>z2</span><span class=p>:</span><span class=o>...</span> <span class=n>where</span> <span class=n>x</span> <span class=n>is</span> <span class=n>start</span> <span class=n>time</span><span class=p>,</span> <span class=n>y</span> <span class=n>is</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>                        <span class=n>time</span><span class=p>,</span> <span class=ow>and</span> <span class=n>z</span> <span class=n>is</span> <span class=n>how</span> <span class=n>often</span> <span class=n>the</span> <span class=n>job</span> <span class=n>issues</span> <span class=n>an</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span><span class=n>c</span>                    <span class=n>compute</span> <span class=n>answers</span> <span class=k>for</span> <span class=n>me</span></span></span></code></pre></td></tr></table></div></div><p>使用模拟器有几种不同的方法，一种方法是生成一些随机作业，然后看看您是否可以弄清楚它们在给定 MLFQ 调度程序的情况下将如何表现。例如，如果您想创建随机生成的三作业工作负载，您只需运行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>❯</span> <span class=n>python</span> <span class=n>mlfq</span><span class=o>.</span><span class=n>py</span> <span class=o>-</span><span class=n>j</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>Here</span> <span class=n>is</span> <span class=n>the</span> <span class=n>list</span> <span class=n>of</span> <span class=n>inputs</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>jobs</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>queues</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>allotments</span> <span class=k>for</span> <span class=n>queue</span>  <span class=mi>2</span> <span class=n>is</span>   <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>quantum</span> <span class=n>length</span> <span class=k>for</span> <span class=n>queue</span>  <span class=mi>2</span> <span class=n>is</span>  <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>allotments</span> <span class=k>for</span> <span class=n>queue</span>  <span class=mi>1</span> <span class=n>is</span>   <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>quantum</span> <span class=n>length</span> <span class=k>for</span> <span class=n>queue</span>  <span class=mi>1</span> <span class=n>is</span>  <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>allotments</span> <span class=k>for</span> <span class=n>queue</span>  <span class=mi>0</span> <span class=n>is</span>   <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>quantum</span> <span class=n>length</span> <span class=k>for</span> <span class=n>queue</span>  <span class=mi>0</span> <span class=n>is</span>  <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>boost</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>ioTime</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>stayAfterIO</span> <span class=n>False</span>
</span></span><span class=line><span class=cl><span class=n>OPTIONS</span> <span class=n>iobump</span> <span class=n>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>For</span> <span class=n>each</span> <span class=n>job</span><span class=p>,</span> <span class=n>three</span> <span class=n>defining</span> <span class=n>characteristics</span> <span class=n>are</span> <span class=n>given</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>startTime</span> <span class=p>:</span> <span class=n>at</span> <span class=n>what</span> <span class=n>time</span> <span class=n>does</span> <span class=n>the</span> <span class=n>job</span> <span class=n>enter</span> <span class=n>the</span> <span class=n>system</span>
</span></span><span class=line><span class=cl>  <span class=n>runTime</span>   <span class=p>:</span> <span class=n>the</span> <span class=n>total</span> <span class=n>CPU</span> <span class=n>time</span> <span class=n>needed</span> <span class=n>by</span> <span class=n>the</span> <span class=n>job</span> <span class=n>to</span> <span class=n>finish</span>
</span></span><span class=line><span class=cl>  <span class=n>ioFreq</span>    <span class=p>:</span> <span class=n>every</span> <span class=n>ioFreq</span> <span class=n>time</span> <span class=n>units</span><span class=p>,</span> <span class=n>the</span> <span class=n>job</span> <span class=n>issues</span> <span class=n>an</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=n>the</span> <span class=n>I</span><span class=o>/</span><span class=n>O</span> <span class=n>takes</span> <span class=n>ioTime</span> <span class=n>units</span> <span class=n>to</span> <span class=n>complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Job</span> <span class=n>List</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>Job</span>  <span class=mi>0</span><span class=p>:</span> <span class=n>startTime</span>   <span class=mi>0</span> <span class=o>-</span> <span class=n>runTime</span>  <span class=mi>84</span> <span class=o>-</span> <span class=n>ioFreq</span>   <span class=mi>7</span>
</span></span><span class=line><span class=cl>  <span class=n>Job</span>  <span class=mi>1</span><span class=p>:</span> <span class=n>startTime</span>   <span class=mi>0</span> <span class=o>-</span> <span class=n>runTime</span>  <span class=mi>42</span> <span class=o>-</span> <span class=n>ioFreq</span>   <span class=mi>3</span>
</span></span><span class=line><span class=cl>  <span class=n>Job</span>  <span class=mi>2</span><span class=p>:</span> <span class=n>startTime</span>   <span class=mi>0</span> <span class=o>-</span> <span class=n>runTime</span>  <span class=mi>51</span> <span class=o>-</span> <span class=n>ioFreq</span>   <span class=mi>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Compute</span> <span class=n>the</span> <span class=n>execution</span> <span class=n>trace</span> <span class=k>for</span> <span class=n>the</span> <span class=n>given</span> <span class=n>workloads</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>If</span> <span class=n>you</span> <span class=n>would</span> <span class=n>like</span><span class=p>,</span> <span class=n>also</span> <span class=n>compute</span> <span class=n>the</span> <span class=n>response</span> <span class=ow>and</span> <span class=n>turnaround</span>
</span></span><span class=line><span class=cl><span class=n>times</span> <span class=k>for</span> <span class=n>each</span> <span class=n>of</span> <span class=n>the</span> <span class=n>jobs</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>the</span> <span class=o>-</span><span class=n>c</span> <span class=n>flag</span> <span class=n>to</span> <span class=n>get</span> <span class=n>the</span> <span class=n>exact</span> <span class=n>results</span> <span class=n>when</span> <span class=n>you</span> <span class=n>are</span> <span class=n>finished</span><span class=o>.</span></span></span></code></pre></td></tr></table></div></div><p>这会在具有多个默认设置的默认数量的队列上生成三个作业（根据指定）的随机工作负载。如果您使用 (-c) 上的求解选项再次运行，您将看到与上面相同的打印输出，以及以下内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Execution Trace:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[ time 0 ] JOB BEGINS by JOB 0
</span></span><span class=line><span class=cl>[ time 0 ] JOB BEGINS by JOB 1
</span></span><span class=line><span class=cl>[ time 0 ] JOB BEGINS by JOB 2
</span></span><span class=line><span class=cl>[ time 0 ] Run JOB 0 at PRIORITY 2 [ TICKS 9 ALLOT 1 TIME 83 (of 84) ]
</span></span><span class=line><span class=cl>[ time 1 ] Run JOB 0 at PRIORITY 2 [ TICKS 8 ALLOT 1 TIME 82 (of 84) ]
</span></span><span class=line><span class=cl>[ time 2 ] Run JOB 0 at PRIORITY 2 [ TICKS 7 ALLOT 1 TIME 81 (of 84) ]
</span></span><span class=line><span class=cl>[ time 3 ] Run JOB 0 at PRIORITY 2 [ TICKS 6 ALLOT 1 TIME 80 (of 84) ]
</span></span><span class=line><span class=cl>[ time 4 ] Run JOB 0 at PRIORITY 2 [ TICKS 5 ALLOT 1 TIME 79 (of 84) ]
</span></span><span class=line><span class=cl>[ time 5 ] Run JOB 0 at PRIORITY 2 [ TICKS 4 ALLOT 1 TIME 78 (of 84) ]
</span></span><span class=line><span class=cl>[ time 6 ] Run JOB 0 at PRIORITY 2 [ TICKS 3 ALLOT 1 TIME 77 (of 84) ]
</span></span><span class=line><span class=cl>[ time 7 ] IO_START by JOB 0
</span></span><span class=line><span class=cl>IO DONE
</span></span><span class=line><span class=cl>[ time 7 ] Run JOB 1 at PRIORITY 2 [ TICKS 9 ALLOT 1 TIME 41 (of 42) ]
</span></span><span class=line><span class=cl>[ time 8 ] Run JOB 1 at PRIORITY 2 [ TICKS 8 ALLOT 1 TIME 40 (of 42) ]
</span></span><span class=line><span class=cl>[ time 9 ] Run JOB 1 at PRIORITY 2 [ TICKS 7 ALLOT 1 TIME 39 (of 42) ]
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Final statistics:
</span></span><span class=line><span class=cl>  Job  0: startTime   0 - response   0 - turnaround 175
</span></span><span class=line><span class=cl>  Job  1: startTime   0 - response   7 - turnaround 191
</span></span><span class=line><span class=cl>  Job  2: startTime   0 - response   9 - turnaround 168
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Avg  2: startTime n/a - response 5.33 - turnaround 178.00</span></span></code></pre></td></tr></table></div></div><p>该跟踪以毫秒为单位准确显示了调度程序决定执行的操作。在此示例中，它首先运行作业 0 7 毫秒，直到作业 0 发出 I/O；这是完全可以预测的，因为作业 0 的 I/O 频率设置为 7 ms，这意味着它每运行 7 ms，就会发出一个 I/O 并等待其完成后再继续。此时，调度程序切换到作业 1，该作业在发出 I/O 之前仅运行 2 毫秒。调度程序以这种方式打印整个执行跟踪，最后还计算每个作业的响应时间和周转时间以及平均值。</p><p>您还可以控制模拟的各个其他方面。例如，您可以指定系统中希望有多少个队列 (-n) 以及所有这些队列的时间片长度应该是多少 (-q)；如果您想要更多的控制和每个队列不同的时间片长度，您可以使用 -Q 指定每个队列的时间片的长度，例如， -Q 10,20,30] 模拟具有三个队列的调度程序，最高优先级队列具有 10 毫秒时间片，次高优先级队列具有 20 毫秒时间片，低优先级队列具有 30 毫秒时间片。</p><p>您也可以单独控制每个队列的时间分配量。可以使用 -a 对所有队列进行设置，或使用 -A 对每个队列进行设置，例如 -A 20,40,60 将每个队列的时间分配分别设置为 20ms、40ms 和 60ms。请注意，虽然本章讨论的是时间方面的分配，但这里是根据时间片的数量来完成的，即，如果给定队列的时间片长度为 10 毫秒，并且分配为 2，则作业可以运行在优先级下降之前，在该队列级别持续 2 个时间片（20 毫秒）。</p><p>如果您随机生成作业，您还可以控制它们运行的​​时间 (-m) 或它们生成 I/O 的频率 (-M)。但是，如果您希望更多地控制系统中运行的作业的确切特征，则可以使用 -l（小写 L）或 &ndash;jlist，它允许您指定要模拟的确切作业集。该列表的格式为：x1,y1,z1:x2,y2,z2:&mldr; 其中 x 是作业的开始时间，y 是运行时间（即需要多少 CPU 时间），z I/O 频率（即运行 z ms 后，作业发出 I/O；如果 z 为 0，则不发出 I/O）。
例如，如果您想重新创建图 8.3 中的示例，您可以指定一个作业列表，如下所示：
<code>python mlfq.py --jlist 0,180,0:100,20,0 -q 10</code></p><p>以这种方式运行模拟器会创建一个三级 MLFQ，每个级别都有 10 毫秒的时间片。创建了两个作业：作业 0 在时间 0 启动，总共运行 180 毫秒，并且从不发出 I/O；作业 1 从 100 毫秒开始，仅需要 20 毫秒的 CPU 时间即可完成，而且从不发出 I/O。</p><p>最后，还有另外三个令人感兴趣的参数。 -B 参数如果设置为非零值，则在调用时每 N 毫秒将所有作业提升到最高优先级队列：</p><p>调度程序使用此功能来避免饥饿，如本章中所讨论的。但是，默认情况下它是关闭的。</p><p>-S 标志调用旧规则 4a 和 4b，这意味着如果作业在完成其时间片之前发出 I/O，则当它恢复执行时，它将返回到相同的优先级队列，并且其完整分配完好无损。这可以玩弄调度器。</p><p>最后，您可以使用 -i 标志轻松更改 I/O 持续的时间。默认情况下，在此简单模型中，每个 I/O 需要 5 毫秒的固定时间或使用此标志设置的任何时间。</p><p>您还可以使用 -I 标志尝试将刚刚完成 I/O 的作业移动到它们所在队列的头部还是后面。看看吧，很好玩！</p><h2 id=qa class=heading-element><span>3 QA</span>
<a href=#qa class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li>仅使用两个作业和两个队列运行一些随机生成的问题；计算每个的 MLFQ 执行轨迹。通过限制每个作业的长度和关闭 I/O 让您的生活更轻松。<blockquote><p>例子：<code>python mlfq.py -n 2 -j 2 -m 20 -M 0 -s 66</code>
Job List:
Job 0: startTime 0 - runTime 2 - ioFreq 0
Job 1: startTime 0 - runTime 5 - ioFreq 0
Execution Trace:
[ time 0 ] JOB BEGINS by JOB 0
[ time 0 ] JOB BEGINS by JOB 1
[ time 0 ] Run JOB 0 at PRIORITY 1 [ TICKS 9 ALLOT 1 TIME 1 (of 2) ]
[ time 1 ] Run JOB 0 at PRIORITY 1 [ TICKS 8 ALLOT 1 TIME 0 (of 2) ]
[ time 2 ] FINISHED JOB 0
[ time 2 ] Run JOB 1 at PRIORITY 1 [ TICKS 9 ALLOT 1 TIME 4 (of 5) ]
[ time 3 ] Run JOB 1 at PRIORITY 1 [ TICKS 8 ALLOT 1 TIME 3 (of 5) ]
[ time 4 ] Run JOB 1 at PRIORITY 1 [ TICKS 7 ALLOT 1 TIME 2 (of 5) ]
[ time 5 ] Run JOB 1 at PRIORITY 1 [ TICKS 6 ALLOT 1 TIME 1 (of 5) ]
[ time 6 ] Run JOB 1 at PRIORITY 1 [ TICKS 5 ALLOT 1 TIME 0 (of 5) ]
[ time 7 ] FINISHED JOB 1
Final statistics:
Job 0: startTime 0 - response 0 - turnaround 2
Job 1: startTime 0 - response 2 - turnaround 7
Avg 1: startTime n/a - response 1.00 - turnaround 4.50</p></blockquote></li><li>您将如何运行调度程序来重现本章中的每个示例？<blockquote><p>// Figure 8.2 Long-running Job Over Time
<code>>python mlfq.py -n 3 -q 10 -l 0,200,0 -c</code>
// Figure 8.3 Along Came An Interactive Job
<code>>python mlfq.py -n 3 -q 10 -l 0,180,0:100,20,0 -c</code>
// Figure 8.4 A Mixed I/O-intensive and CPU-intensive Workload
<code>>python mlfq.py -n 3 -q 10 -l 0,175,0:50,25,1 -i 5 -S -c</code>
// Figure 8.5 without priority boost
<code>>python mlfq.py -n 3 -q 10 -l 0,120,0:100,50,1:100,50,1 -i 1 -S -c</code>
// Figure 8.5 with priority boost
<code>python mlfq.py -n 3 -q 10 -l 0,120,0:100,50,1:100,50,1 -i 1 -S -B 50 -c</code>
// Figure 8.6 without gaming tolerance
<code>> python mlfq.py -n 3 -q 10 -i 1 -S -l 0,200,0:80,100,9 -c</code>
// Figure 8.6 with gaming tolerance
<code>python mlfq.py -n 3 -q 10 -i 1 -l 0,200,0:80,100,9 -c</code>
// Figure 8.7 Lower Priority, Longer Quanta
<code>python mlfq.py -n 3 -a 2 -Q 10,20,40 -l 0,200,0:0,200,0 -c</code></p></blockquote></li><li>如何配置调度程序参数以使其像循环调度程序一样运行？<blockquote><p>同一队列上的作业是按时间分片的，因此答案是只有一个队列。</p></blockquote></li><li>使用两个作业和调度程序参数制作一个工作负载，以便一个作业利用旧的规则 4a 和 4b（使用 -S 参数打开）来欺骗调度程序并在特定的情况下获得 99% 的 CPU 占用率时间间隔。<blockquote><p>首先，使用 -i 将 I/O 时间设置为 1，然后确保 CPU hog 在 100 个点击时间片长度的第 99 个点击时调用 I/O 操作。另外，包含 -I 标志以确保 CPU 占用者在 I/O 请求完成时重新获得控制权： <code>python mlfq.py -S -i 1 -l 0,297,99:0,60,0 -q 100 -n 3 -I -c</code></p></blockquote></li><li>给定一个系统，其最高队列的时间片长度为 10 毫秒，您需要多久将作业提升回最高优先级（使用 -B 标志）才能保证单个长时间运行的作业（并且可能会饥饿）作业至少获得 5% 的 CPU 资源？<blockquote><p>如果每 10 毫秒就有一个新的 10 毫秒长作业到达 - 如图 8.5（左）所示，每 200 个时钟周期提升可确保长进程将运行 10/200 个 CPU 周期 = 5%。</p></blockquote></li><li>调度中出现的一个问题是在队列的哪一端添加刚刚完成 I/O 的作业； -I 参数更改此调度模拟器的此行为。尝试一些工作负载，看看是否可以看到此参数的效果。<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>python mlfq.py -n <span class=m>2</span> -q <span class=m>10</span> -l 0,50,0:0,50,11 -i <span class=m>1</span> -S -c
</span></span><span class=line><span class=cl>python mlfq.py -n <span class=m>2</span> -q <span class=m>10</span> -l 0,50,0:0,50,11 -i <span class=m>1</span> -S -I -c</span></span></code></pre></td></tr></table></div></div>使用<code>-I</code>的周转时间下降了很多。</li></ol></div><hr class=awesome-hr><h2 id=see-also>相关内容</h2><ul><li><a href=/posts/04.cpu%E8%B0%83%E5%BA%A6/ title=CPU调度>CPU调度</a></li><li><a href=/posts/01.%E8%BF%9B%E7%A8%8B%E4%BB%8B%E7%BB%8D/ title=进程介绍>进程介绍</a></li><li><a href=/posts/03.%E6%9C%89%E9%99%90%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C/ title=有限直接执行>有限直接执行</a></li><li><a href=/posts/02.%E8%BF%9B%E7%A8%8Bapi/ title=进程API>进程API</a></li><li><a href=/posts/02.c%E8%AF%AD%E8%A8%80%E5%A6%82%E4%BD%95%E4%BB%8E%E4%B8%80%E5%AE%9A%E8%8C%83%E5%9B%B4%E5%86%85%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E6%95%B4%E6%95%B0/ title=如何使用C语言从一定范围内生成随机整数？>如何使用C语言从一定范围内生成随机整数？</a></li></ul><div class=post-reward><div class=comment>Buy me a coffee~</div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward><i class="fa-solid fa-qrcode fa-fw" aria-hidden=true></i>赞赏</label><div class=reward-ways data-mode=fixed><div><img loading=lazy src=/images/alipay.png alt="HeZephyr 支付宝" data-title="HeZephyr 支付宝" style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span data-animation>支付宝</span></div><div><img loading=lazy src=/images/wechatpay.jpg alt="HeZephyr 微信" data-title="HeZephyr 微信" style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span data-animation>微信</span></div></div></div><div class=collection-card><div class="collection-title text-secondary">收录于 <a href=/collections/ostep/><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> <span>合集・OSTEP</span></span></a> 39</div><div class=collection-nav><a href=/posts/04.cpu%E8%B0%83%E5%BA%A6/ class=collection-nav-item rel=prev title=CPU调度><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i><span>CPU调度</span>
</a><a href=/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/ class=collection-nav-item rel=next title=比例份额调度><span>比例份额调度</span><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2024-10-15 10:56:04">更新于 2024-10-15&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span><span><a href="https://github.com/HeZephyr/HeZephyr.github.io/blob/docs/content/posts/_develop/_system/ostep/05.%e5%a4%9a%e7%ba%a7%e5%8f%8d%e9%a6%88%e9%98%9f%e5%88%97.md?plain=1" title=查看源码 target=_blank rel="external nofollow noopener noreferrer" class=link-to-source>查看源码</a></span><span><a href=https://github.com/HeZephyr/HeZephyr.github.io/edit/docs/content/posts/_develop/_system/ostep/05.%e5%a4%9a%e7%ba%a7%e5%8f%8d%e9%a6%88%e9%98%9f%e5%88%97.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span><span><a href="https://github.com/HeZephyr/HeZephyr.github.io/issues/new?title=[BUG]%20%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7c%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97%7c%0A%7cURL%7chttps://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/%7c%0A%7cFilename%7chttps://github.com/HeZephyr/HeZephyr.github.io/blob/docs/content/posts/_develop/_system/ostep/05.%e5%a4%9a%e7%ba%a7%e5%8f%8d%e9%a6%88%e9%98%9f%e5%88%97.md?plain=1%7c" title=报告问题 target=_blank rel="external nofollow noopener noreferrer" class=link-to-report>报告问题</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/ data-title=多级反馈队列 data-hashtags=OS><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/ data-hashtag=OS><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Linkedin" data-sharer=linkedin data-url=https://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/><i class="fa-brands fa-linkedin fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/ data-title=多级反馈队列><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 百度" data-sharer=baidu data-url=https://hezephyr.github.io/posts/05.%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E9%98%9F%E5%88%97/ data-title=多级反馈队列><i data-svg-src=https://unpkg.com/simple-icons@9.19.0/icons/baidu.svg aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/os/ class=post-tag title="标签 - OS">OS</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/06.%E6%AF%94%E4%BE%8B%E4%BB%BD%E9%A2%9D%E8%B0%83%E5%BA%A6/ class=post-nav-item rel=prev title=比例份额调度><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>比例份额调度</a>
<a href=/posts/04.cpu%E8%B0%83%E5%BA%A6/ class=post-nav-item rel=next title=CPU调度>CPU调度<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=HeZephyr/HeZephyr.github.io data-repo-id=R_kgDOMb2HgQ data-category=General data-category-id=DIC_kwDOMb2Hgc4ChPAb data-mapping=title data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.135.0"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.3.9-RC"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2020 - 2024</span><span class=author itemprop=copyrightHolder>
<a href=https://github.com/HeZephyr target=_blank rel="external nofollow noopener noreferrer">HeZephyr</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title=网站运行中……><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="ms-1 d-none">博客已运行</span><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor order-first"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/HeZephyr title="View on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#8581dd;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=https://unpkg.com/lightgallery@2.7.2/css/lightgallery-bundle.min.css><link rel=preload href=https://unpkg.com/katex@0.16.10/dist/katex.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://unpkg.com/katex@0.16.10/dist/katex.min.css></noscript><link rel=stylesheet href=https://unpkg.com/cookieconsent@3.1.1/build/cookieconsent.min.css><link rel=stylesheet href=https://unpkg.com/pace-js@1.2.4/themes/blue/pace-theme-minimal.css><script src=https://unpkg.com/autocomplete.js@0.38.1/dist/autocomplete.min.js defer></script><script src=https://unpkg.com/algoliasearch@4.20.0/dist/algoliasearch-lite.umd.js defer></script><script src=https://unpkg.com/instant.page@5.2.0/instantpage.js async defer type=module></script><script src=https://unpkg.com/lightgallery@2.7.2/lightgallery.min.js defer></script><script src=https://unpkg.com/lightgallery@2.7.2/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=https://unpkg.com/lightgallery@2.7.2/plugins/zoom/lg-zoom.min.js defer></script><script src=https://unpkg.com/sharer.js@0.5.1/sharer.min.js async defer></script><script src=https://unpkg.com/katex@0.16.10/dist/katex.min.js defer></script><script src=https://unpkg.com/katex@0.16.10/dist/contrib/auto-render.min.js defer></script><script src=https://unpkg.com/katex@0.16.10/dist/contrib/copy-tex.min.js defer></script><script src=https://unpkg.com/katex@0.16.10/dist/contrib/mhchem.min.js defer></script><script src=https://unpkg.com/cookieconsent@3.1.1/build/cookieconsent.min.js defer></script><script src=https://unpkg.com/pangu@4.0.7/dist/browser/pangu.min.js defer></script><script src=https://unpkg.com/cell-watermark@1.0.3/src/watermark.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script src=https://unpkg.com/pace-js@1.2.4/pace.min.js async defer></script><script src=/js/flyfish.js defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:50},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark_dimmed",lightTheme:"light",origin:"https://giscus.app"}},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"},{display:!1,left:"$",right:"$"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{algoliaAppID:"LKM6MKQ6NB",algoliaIndex:"index",algoliaSearchKey:"c9bb91e3a1318f3c9efae98daa87bca5",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"},siteTime:"2020-06-10T15:42:01+08:00",version:"v0.3.9-RC",watermark:{colspacing:30,content:'<img style="height: 0.85rem;" src="/logo.png" alt="logo" /> 贺志飞',enable:!0,fontfamily:"LiuJianMaoCao-Regular, 钟齐流江毛草",fontsize:1.1,height:20,opacity:.0125,rotate:15,rowspacing:60,width:150}}</script><script src=/js/theme.min.js defer></script><script src=/js/custom.min.js defer></script></body></html>